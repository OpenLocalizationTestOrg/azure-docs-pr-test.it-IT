---
title: Inoltrare i dati dei processi di Automazione di Azure a OMS Log Analytics | Documentazione Microsoft
description: "Questo articolo illustra come inviare lo stato e i flussi del processo del runbook a Log Analytics di Microsoft Operations Management Suite per fornire informazioni e funzionalità di gestione aggiuntive."
services: automation
documentationcenter: 
author: MGoedtel
manager: carmonm
editor: tysonn
ms.assetid: c12724c6-01a9-4b55-80ae-d8b7b99bd436
ms.service: automation
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 06/02/2017
ms.author: magoedte
ms.openlocfilehash: 2c0ca7fc332963e5a5db3c20c400ed877ae0cc54
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 07/11/2017
---
# <a name="forward-job-status-and-job-streams-from-automation-to-log-analytics-oms"></a><span data-ttu-id="27345-103">Inoltrare lo stato e i flussi del processo da Automazione a Log Analytics (OMS)</span><span class="sxs-lookup"><span data-stu-id="27345-103">Forward job status and job streams from Automation to Log Analytics (OMS)</span></span>
<span data-ttu-id="27345-104">Automazione può inviare lo stato e i flussi del processo del runbook all'area di lavoro Log Analytics di Microsoft Operations Management Suite (OMS).</span><span class="sxs-lookup"><span data-stu-id="27345-104">Automation can send runbook job status and job streams to your Microsoft Operations Management Suite (OMS) Log Analytics workspace.</span></span>  <span data-ttu-id="27345-105">I log e i flussi di processo sono visibili nel portale di Azure o con PowerShell per i singoli processi e ciò consente di eseguire analisi semplici.</span><span class="sxs-lookup"><span data-stu-id="27345-105">Job logs and job streams are visible in the Azure portal, or with PowerShell, for individual jobs and this allows you to perform simple investigations.</span></span> <span data-ttu-id="27345-106">Con Log Analytics è ora possibile:</span><span class="sxs-lookup"><span data-stu-id="27345-106">Now with Log Analytics you can:</span></span>

* <span data-ttu-id="27345-107">Ottenere informazioni dettagliate sui processi di Automazione.</span><span class="sxs-lookup"><span data-stu-id="27345-107">Get insight on your Automation jobs</span></span>
* <span data-ttu-id="27345-108">Attivare un messaggio e-mail o un avviso in base allo stato del processo del runbook, ad esempio non riuscito o sospeso.</span><span class="sxs-lookup"><span data-stu-id="27345-108">Trigger an email or alert based on your runbook job status (for example, failed or suspended)</span></span>
* <span data-ttu-id="27345-109">Scrivere query avanzate nei flussi del processo.</span><span class="sxs-lookup"><span data-stu-id="27345-109">Write advanced queries across your job streams</span></span>
* <span data-ttu-id="27345-110">Correlare i processi tra account di Automazione.</span><span class="sxs-lookup"><span data-stu-id="27345-110">Correlate jobs across Automation accounts</span></span>
* <span data-ttu-id="27345-111">Visualizzare la cronologia dei processi nel tempo.</span><span class="sxs-lookup"><span data-stu-id="27345-111">Visualize your job history over time</span></span>     

## <a name="prerequisites-and-deployment-considerations"></a><span data-ttu-id="27345-112">Prerequisiti e considerazioni sulla distribuzione</span><span class="sxs-lookup"><span data-stu-id="27345-112">Prerequisites and deployment considerations</span></span>
<span data-ttu-id="27345-113">Per iniziare a inviare i log di Automazione a Log Analytics, sono necessari gli elementi seguenti:</span><span class="sxs-lookup"><span data-stu-id="27345-113">To start sending your Automation logs to Log Analytics, you need:</span></span>

1. <span data-ttu-id="27345-114">La versione di novembre 2016 o versioni successive di [Azure PowerShell](https://docs.microsoft.com/powershell/azureps-cmdlets-docs/) (v 2.3.0).</span><span class="sxs-lookup"><span data-stu-id="27345-114">The November 2016 or later release of [Azure PowerShell](https://docs.microsoft.com/powershell/azureps-cmdlets-docs/) (v2.3.0).</span></span>
2. <span data-ttu-id="27345-115">Un'area di lavoro di Log Analytics.</span><span class="sxs-lookup"><span data-stu-id="27345-115">A Log Analytics workspace.</span></span> <span data-ttu-id="27345-116">Per altre informazioni, vedere [Introduzione a Log Analytics](../log-analytics/log-analytics-get-started.md).</span><span class="sxs-lookup"><span data-stu-id="27345-116">For more information, see [Get started with Log Analytics](../log-analytics/log-analytics-get-started.md).</span></span> 
3. <span data-ttu-id="27345-117">Il valore ResourceId dell'account di Automazione di Azure.</span><span class="sxs-lookup"><span data-stu-id="27345-117">The ResourceId for your Azure Automation account</span></span>

<span data-ttu-id="27345-118">Per trovare il valore ResourceId dell'account di Automazione di Azure e l'area di lavoro di Log Analytics eseguire questo comando PowerShell:</span><span class="sxs-lookup"><span data-stu-id="27345-118">To find the ResourceId for your Azure Automation account and Log Analytics workspace, run the following PowerShell:</span></span>

```powershell
# Find the ResourceId for the Automation Account
Find-AzureRmResource -ResourceType "Microsoft.Automation/automationAccounts"

# Find the ResourceId for the Log Analytics workspace
Find-AzureRmResource -ResourceType "Microsoft.OperationalInsights/workspaces"
```

<span data-ttu-id="27345-119">Se si hanno più account di automazione o aree di lavoro, nell'output dei comandi precedenti trovare il *nome* necessario per configurare e copiare il valore di *ResourceId*.</span><span class="sxs-lookup"><span data-stu-id="27345-119">If you have multiple Automation accounts, or workspaces, in the output of the preceding commands, find the *Name* you need to configure and copy the value for *ResourceId*.</span></span>

<span data-ttu-id="27345-120">Per trovare il *nome* dell'account di Automazione, nel portale di Azure selezionare l'account di Automazione dal pannello **Account di Automazione** e selezionare **Tutte le impostazioni**.</span><span class="sxs-lookup"><span data-stu-id="27345-120">If you need to find the *Name* of your Automation account, in the Azure portal select your Automation account from the **Automation account** blade and select **All settings**.</span></span>  <span data-ttu-id="27345-121">Nel pannello **Tutte le impostazioni** selezionare **Proprietà** in **Impostazioni account**.</span><span class="sxs-lookup"><span data-stu-id="27345-121">From the **All settings** blade, under **Account Settings** select **Properties**.</span></span>  <span data-ttu-id="27345-122">Nel pannello **Proprietà** è possibile prendere nota di questi valori.</span><span class="sxs-lookup"><span data-stu-id="27345-122">In the **Properties** blade, you can note these values.</span></span><br> <span data-ttu-id="27345-123">![Proprietà dell'account di Automazione](media/automation-manage-send-joblogs-log-analytics/automation-account-properties.png).</span><span class="sxs-lookup"><span data-stu-id="27345-123">![Automation Account properties](media/automation-manage-send-joblogs-log-analytics/automation-account-properties.png).</span></span>

## <a name="set-up-integration-with-log-analytics"></a><span data-ttu-id="27345-124">Configurare l'integrazione con Log Analytics</span><span class="sxs-lookup"><span data-stu-id="27345-124">Set up integration with Log Analytics</span></span>
1. <span data-ttu-id="27345-125">Nel computer locale avviare **Windows PowerShell** dalla schermata **Start**.</span><span class="sxs-lookup"><span data-stu-id="27345-125">On your computer, start **Windows PowerShell** from the **Start** screen.</span></span>  
2. <span data-ttu-id="27345-126">Copiare e incollare il comando PowerShell seguente e modificare il valore per `$workspaceId` e `$automationAccountId`.</span><span class="sxs-lookup"><span data-stu-id="27345-126">Copy and paste the following PowerShell, and edit the value for the `$workspaceId` and `$automationAccountId`.</span></span>  <span data-ttu-id="27345-127">Per il parametro `-Environment`, i valori validi sono *AzureCloud* o *AzureUSGovernment*, a seconda dell'ambiente cloud usato.</span><span class="sxs-lookup"><span data-stu-id="27345-127">For the `-Environment` parameter, valid values are *AzureCloud* or *AzureUSGovernment* depending on the cloud environment you are working in.</span></span>     

```powershell
[cmdletBinding()]
    Param
    (
        [Parameter(Mandatory=$True)]
        [ValidateSet("AzureCloud","AzureUSGovernment")]
        [string]$Environment="AzureCloud"
    )

#Check to see which cloud environment to sign into.
Switch ($Environment)
   {
       "AzureCloud" {Login-AzureRmAccount}
       "AzureUSGovernment" {Login-AzureRmAccount -EnvironmentName AzureUSGovernment} 
   }

# if you have one Log Analytics workspace you can use the following command to get the resource id of the workspace
$workspaceId = (Get-AzureRmOperationalInsightsWorkspace).ResourceId

$automationAccountId = "/SUBSCRIPTIONS/ec11ca60-1234-491e-5678-0ea07feae25c/RESOURCEGROUPS/DEMO/PROVIDERS/MICROSOFT.AUTOMATION/ACCOUNTS/DEMO" 

Set-AzureRmDiagnosticSetting -ResourceId $automationAccountId -WorkspaceId $workspaceId -Enabled $true

```

<span data-ttu-id="27345-128">Dopo aver eseguito questo script, i record in Log Analytics verranno visualizzati entro 10 minuti dalla scrittura di nuovi log o flussi di processo.</span><span class="sxs-lookup"><span data-stu-id="27345-128">After running this script, you will see records in Log Analytics within 10 minutes of new JobLogs or JobStreams being written.</span></span>

<span data-ttu-id="27345-129">Per visualizzare i log, eseguire la seguente query nella ricerca log Log Analytics: `Type=AzureDiagnostics ResourceProvider="MICROSOFT.AUTOMATION"`</span><span class="sxs-lookup"><span data-stu-id="27345-129">To see the logs, run the following query in Log Analytics log search: `Type=AzureDiagnostics ResourceProvider="MICROSOFT.AUTOMATION"`</span></span>

### <a name="verify-configuration"></a><span data-ttu-id="27345-130">Verificare la configurazione</span><span class="sxs-lookup"><span data-stu-id="27345-130">Verify configuration</span></span>
<span data-ttu-id="27345-131">Per verificare che l'account di Automazione invii i log all'area di lavoro di Log Analytics, accertarsi che la diagnostica sia impostata correttamente nell'account di Automazione usando il comando PowerShell seguente:</span><span class="sxs-lookup"><span data-stu-id="27345-131">To confirm that your Automation account is sending logs to your Log Analytics workspace, check that diagnostics are set correctly on the Automation account using the following PowerShell:</span></span>

```powershell
[cmdletBinding()]
    Param
    (
        [Parameter(Mandatory=$True)]
        [ValidateSet("AzureCloud","AzureUSGovernment")]
        [string]$Environment="AzureCloud"
    )

#Check to see which cloud environment to sign into.
Switch ($Environment)
   {
       "AzureCloud" {Login-AzureRmAccount}
       "AzureUSGovernment" {Login-AzureRmAccount -EnvironmentName AzureUSGovernment} 
   }
# if you have one Log Analytics workspace you can use the following command to get the resource id of the workspace
$workspaceId = (Get-AzureRmOperationalInsightsWorkspace).ResourceId

$automationAccountId = "/SUBSCRIPTIONS/ec11ca60-1234-491e-5678-0ea07feae25c/RESOURCEGROUPS/DEMO/PROVIDERS/MICROSOFT.AUTOMATION/ACCOUNTS/DEMO" 

Get-AzureRmDiagnosticSetting -ResourceId $automationAccountId
```

<span data-ttu-id="27345-132">Nell'output verificare quanto segue:</span><span class="sxs-lookup"><span data-stu-id="27345-132">In the output ensure that:</span></span>
+ <span data-ttu-id="27345-133">In *Logs*, il valore per *Enabled* deve essere impostato su *True*</span><span class="sxs-lookup"><span data-stu-id="27345-133">Under *Logs*, the value for *Enabled* is *True*</span></span>
+ <span data-ttu-id="27345-134">Il valore di *WorkspaceId* deve essere impostato sul valore ResourceId dell'area di lavoro di Log Analytics</span><span class="sxs-lookup"><span data-stu-id="27345-134">The value of *WorkspaceId* is set to the ResourceId of your Log Analytics workspace</span></span>


## <a name="log-analytics-records"></a><span data-ttu-id="27345-135">Record di Log Analytics</span><span class="sxs-lookup"><span data-stu-id="27345-135">Log Analytics records</span></span>
<span data-ttu-id="27345-136">La diagnostica di Automazione di Azure crea due tipi di record in Log Analytics che vengono contrassegnati con il tag **Type=AzureDiagnostics**.</span><span class="sxs-lookup"><span data-stu-id="27345-136">Diagnostics from Azure Automation creates two types of records in Log Analytics and are tagged as **Type=AzureDiagnostics**.</span></span>

### <a name="job-logs"></a><span data-ttu-id="27345-137">Log del processo</span><span class="sxs-lookup"><span data-stu-id="27345-137">Job Logs</span></span>
| <span data-ttu-id="27345-138">Proprietà</span><span class="sxs-lookup"><span data-stu-id="27345-138">Property</span></span> | <span data-ttu-id="27345-139">Descrizione</span><span class="sxs-lookup"><span data-stu-id="27345-139">Description</span></span> |
| --- | --- |
| <span data-ttu-id="27345-140">TimeGenerated</span><span class="sxs-lookup"><span data-stu-id="27345-140">TimeGenerated</span></span> |<span data-ttu-id="27345-141">Data e ora di esecuzione del processo del runbook.</span><span class="sxs-lookup"><span data-stu-id="27345-141">Date and time when the runbook job executed.</span></span> |
| <span data-ttu-id="27345-142">RunbookName_s</span><span class="sxs-lookup"><span data-stu-id="27345-142">RunbookName_s</span></span> |<span data-ttu-id="27345-143">Il nome del runbook.</span><span class="sxs-lookup"><span data-stu-id="27345-143">The name of the runbook.</span></span> |
| <span data-ttu-id="27345-144">Caller_s</span><span class="sxs-lookup"><span data-stu-id="27345-144">Caller_s</span></span> |<span data-ttu-id="27345-145">Chi ha avviato l'operazione.</span><span class="sxs-lookup"><span data-stu-id="27345-145">Who initiated the operation.</span></span>  <span data-ttu-id="27345-146">I valori possibili sono un indirizzo di posta elettronica o il sistema per i processi pianificati.</span><span class="sxs-lookup"><span data-stu-id="27345-146">Possible values are either an email address or system for scheduled jobs.</span></span> |
| <span data-ttu-id="27345-147">Tenant_g</span><span class="sxs-lookup"><span data-stu-id="27345-147">Tenant_g</span></span> | <span data-ttu-id="27345-148">GUID che identifica il tenant del chiamante.</span><span class="sxs-lookup"><span data-stu-id="27345-148">GUID that identifies the tenant for the Caller.</span></span> |
| <span data-ttu-id="27345-149">JobId_g</span><span class="sxs-lookup"><span data-stu-id="27345-149">JobId_g</span></span> |<span data-ttu-id="27345-150">Il GUID che rappresenta l'ID del processo del runbook.</span><span class="sxs-lookup"><span data-stu-id="27345-150">GUID that is the Id of the runbook job.</span></span> |
| <span data-ttu-id="27345-151">ResultType</span><span class="sxs-lookup"><span data-stu-id="27345-151">ResultType</span></span> |<span data-ttu-id="27345-152">Lo stato del processo di runbook.</span><span class="sxs-lookup"><span data-stu-id="27345-152">The status of the runbook job.</span></span>  <span data-ttu-id="27345-153">I valori possibili sono:</span><span class="sxs-lookup"><span data-stu-id="27345-153">Possible values are:</span></span><br><span data-ttu-id="27345-154">- Avviato</span><span class="sxs-lookup"><span data-stu-id="27345-154">- Started</span></span><br><span data-ttu-id="27345-155">- Interrotto</span><span class="sxs-lookup"><span data-stu-id="27345-155">- Stopped</span></span><br><span data-ttu-id="27345-156">- Sospeso</span><span class="sxs-lookup"><span data-stu-id="27345-156">- Suspended</span></span><br><span data-ttu-id="27345-157">- Non riuscito</span><span class="sxs-lookup"><span data-stu-id="27345-157">- Failed</span></span><br><span data-ttu-id="27345-158">- Completato</span><span class="sxs-lookup"><span data-stu-id="27345-158">- Completed</span></span> |
| <span data-ttu-id="27345-159">Categoria</span><span class="sxs-lookup"><span data-stu-id="27345-159">Category</span></span> | <span data-ttu-id="27345-160">La classificazione del tipo di dati.</span><span class="sxs-lookup"><span data-stu-id="27345-160">Classification of the type of data.</span></span>  <span data-ttu-id="27345-161">Per Automazione, il valore è JobLogs.</span><span class="sxs-lookup"><span data-stu-id="27345-161">For Automation, the value is JobLogs.</span></span> |
| <span data-ttu-id="27345-162">OperationName</span><span class="sxs-lookup"><span data-stu-id="27345-162">OperationName</span></span> | <span data-ttu-id="27345-163">Specifica il tipo di operazione eseguita in Azure.</span><span class="sxs-lookup"><span data-stu-id="27345-163">Specifies the type of operation performed in Azure.</span></span>  <span data-ttu-id="27345-164">Per Automazione, il valore è Job.</span><span class="sxs-lookup"><span data-stu-id="27345-164">For Automation, the value is Job.</span></span> |
| <span data-ttu-id="27345-165">Risorsa</span><span class="sxs-lookup"><span data-stu-id="27345-165">Resource</span></span> | <span data-ttu-id="27345-166">Nome dell'account di Automazione</span><span class="sxs-lookup"><span data-stu-id="27345-166">Name of the Automation account</span></span> |
| <span data-ttu-id="27345-167">SourceSystem</span><span class="sxs-lookup"><span data-stu-id="27345-167">SourceSystem</span></span> | <span data-ttu-id="27345-168">Modo in cui Log Analytics ha raccolto i dati.</span><span class="sxs-lookup"><span data-stu-id="27345-168">How Log Analytics collected the data.</span></span> <span data-ttu-id="27345-169">È sempre *Azure* per la diagnostica di Azure.</span><span class="sxs-lookup"><span data-stu-id="27345-169">Always *Azure* for Azure diagnostics.</span></span> |
| <span data-ttu-id="27345-170">ResultDescription</span><span class="sxs-lookup"><span data-stu-id="27345-170">ResultDescription</span></span> |<span data-ttu-id="27345-171">Descrive lo stato del risultato del processo di runbook.</span><span class="sxs-lookup"><span data-stu-id="27345-171">Describes the runbook job result state.</span></span>  <span data-ttu-id="27345-172">I valori possibili sono:</span><span class="sxs-lookup"><span data-stu-id="27345-172">Possible values are:</span></span><br><span data-ttu-id="27345-173">- Processo avviato</span><span class="sxs-lookup"><span data-stu-id="27345-173">- Job is started</span></span><br><span data-ttu-id="27345-174">- Processo non riuscito</span><span class="sxs-lookup"><span data-stu-id="27345-174">- Job Failed</span></span><br><span data-ttu-id="27345-175">- Processo completato</span><span class="sxs-lookup"><span data-stu-id="27345-175">- Job Completed</span></span> |
| <span data-ttu-id="27345-176">CorrelationId</span><span class="sxs-lookup"><span data-stu-id="27345-176">CorrelationId</span></span> |<span data-ttu-id="27345-177">Il GUID che rappresenta l'ID di correlazione del processo di runbook.</span><span class="sxs-lookup"><span data-stu-id="27345-177">GUID that is the Correlation Id of the runbook job.</span></span> |
| <span data-ttu-id="27345-178">ResourceId</span><span class="sxs-lookup"><span data-stu-id="27345-178">ResourceId</span></span> |<span data-ttu-id="27345-179">Specifica l'ID risorsa dell'account di Automazione di Azure del runbook.</span><span class="sxs-lookup"><span data-stu-id="27345-179">Specifies the Azure Automation account resource id of the runbook.</span></span> |
| <span data-ttu-id="27345-180">SubscriptionId</span><span class="sxs-lookup"><span data-stu-id="27345-180">SubscriptionId</span></span> | <span data-ttu-id="27345-181">ID della sottoscrizione di Azure (GUID) per l'account di Automazione.</span><span class="sxs-lookup"><span data-stu-id="27345-181">The Azure subscription Id (GUID) for the Automation account.</span></span> |
| <span data-ttu-id="27345-182">ResourceGroup</span><span class="sxs-lookup"><span data-stu-id="27345-182">ResourceGroup</span></span> | <span data-ttu-id="27345-183">Nome del gruppo di risorse dell'account di Automazione.</span><span class="sxs-lookup"><span data-stu-id="27345-183">Name of the resource group for the Automation account.</span></span> |
| <span data-ttu-id="27345-184">ResourceProvider</span><span class="sxs-lookup"><span data-stu-id="27345-184">ResourceProvider</span></span> | <span data-ttu-id="27345-185">MICROSOFT.AUTOMATION</span><span class="sxs-lookup"><span data-stu-id="27345-185">MICROSOFT.AUTOMATION</span></span> |
| <span data-ttu-id="27345-186">ResourceType</span><span class="sxs-lookup"><span data-stu-id="27345-186">ResourceType</span></span> | <span data-ttu-id="27345-187">AUTOMATIONACCOUNTS</span><span class="sxs-lookup"><span data-stu-id="27345-187">AUTOMATIONACCOUNTS</span></span> |


### <a name="job-streams"></a><span data-ttu-id="27345-188">Flussi del processo</span><span class="sxs-lookup"><span data-stu-id="27345-188">Job Streams</span></span>
| <span data-ttu-id="27345-189">Proprietà</span><span class="sxs-lookup"><span data-stu-id="27345-189">Property</span></span> | <span data-ttu-id="27345-190">Descrizione</span><span class="sxs-lookup"><span data-stu-id="27345-190">Description</span></span> |
| --- | --- |
| <span data-ttu-id="27345-191">TimeGenerated</span><span class="sxs-lookup"><span data-stu-id="27345-191">TimeGenerated</span></span> |<span data-ttu-id="27345-192">Data e ora di esecuzione del processo del runbook.</span><span class="sxs-lookup"><span data-stu-id="27345-192">Date and time when the runbook job executed.</span></span> |
| <span data-ttu-id="27345-193">RunbookName_s</span><span class="sxs-lookup"><span data-stu-id="27345-193">RunbookName_s</span></span> |<span data-ttu-id="27345-194">Il nome del runbook.</span><span class="sxs-lookup"><span data-stu-id="27345-194">The name of the runbook.</span></span> |
| <span data-ttu-id="27345-195">Caller_s</span><span class="sxs-lookup"><span data-stu-id="27345-195">Caller_s</span></span> |<span data-ttu-id="27345-196">Chi ha avviato l'operazione.</span><span class="sxs-lookup"><span data-stu-id="27345-196">Who initiated the operation.</span></span>  <span data-ttu-id="27345-197">I valori possibili sono un indirizzo di posta elettronica o il sistema per i processi pianificati.</span><span class="sxs-lookup"><span data-stu-id="27345-197">Possible values are either an email address or system for scheduled jobs.</span></span> |
| <span data-ttu-id="27345-198">StreamType_s</span><span class="sxs-lookup"><span data-stu-id="27345-198">StreamType_s</span></span> |<span data-ttu-id="27345-199">Il tipo di flusso del processo.</span><span class="sxs-lookup"><span data-stu-id="27345-199">The type of job stream.</span></span> <span data-ttu-id="27345-200">I valori possibili sono:</span><span class="sxs-lookup"><span data-stu-id="27345-200">Possible values are:</span></span><br><span data-ttu-id="27345-201">- Avanzamento</span><span class="sxs-lookup"><span data-stu-id="27345-201">-Progress</span></span><br><span data-ttu-id="27345-202">- Output</span><span class="sxs-lookup"><span data-stu-id="27345-202">- Output</span></span><br><span data-ttu-id="27345-203">- Avviso</span><span class="sxs-lookup"><span data-stu-id="27345-203">- Warning</span></span><br><span data-ttu-id="27345-204">- Errore</span><span class="sxs-lookup"><span data-stu-id="27345-204">- Error</span></span><br><span data-ttu-id="27345-205">- Debug</span><span class="sxs-lookup"><span data-stu-id="27345-205">- Debug</span></span><br><span data-ttu-id="27345-206">- Dettagliato</span><span class="sxs-lookup"><span data-stu-id="27345-206">- Verbose</span></span> |
| <span data-ttu-id="27345-207">Tenant_g</span><span class="sxs-lookup"><span data-stu-id="27345-207">Tenant_g</span></span> | <span data-ttu-id="27345-208">GUID che identifica il tenant del chiamante.</span><span class="sxs-lookup"><span data-stu-id="27345-208">GUID that identifies the tenant for the Caller.</span></span> |
| <span data-ttu-id="27345-209">JobId_g</span><span class="sxs-lookup"><span data-stu-id="27345-209">JobId_g</span></span> |<span data-ttu-id="27345-210">Il GUID che rappresenta l'ID del processo del runbook.</span><span class="sxs-lookup"><span data-stu-id="27345-210">GUID that is the Id of the runbook job.</span></span> |
| <span data-ttu-id="27345-211">ResultType</span><span class="sxs-lookup"><span data-stu-id="27345-211">ResultType</span></span> |<span data-ttu-id="27345-212">Lo stato del processo di runbook.</span><span class="sxs-lookup"><span data-stu-id="27345-212">The status of the runbook job.</span></span>  <span data-ttu-id="27345-213">I valori possibili sono:</span><span class="sxs-lookup"><span data-stu-id="27345-213">Possible values are:</span></span><br><span data-ttu-id="27345-214">- In corso</span><span class="sxs-lookup"><span data-stu-id="27345-214">- In Progress</span></span> |
| <span data-ttu-id="27345-215">Categoria</span><span class="sxs-lookup"><span data-stu-id="27345-215">Category</span></span> | <span data-ttu-id="27345-216">La classificazione del tipo di dati.</span><span class="sxs-lookup"><span data-stu-id="27345-216">Classification of the type of data.</span></span>  <span data-ttu-id="27345-217">Per Automazione, il valore è JobStreams.</span><span class="sxs-lookup"><span data-stu-id="27345-217">For Automation, the value is JobStreams.</span></span> |
| <span data-ttu-id="27345-218">OperationName</span><span class="sxs-lookup"><span data-stu-id="27345-218">OperationName</span></span> | <span data-ttu-id="27345-219">Specifica il tipo di operazione eseguita in Azure.</span><span class="sxs-lookup"><span data-stu-id="27345-219">Specifies the type of operation performed in Azure.</span></span>  <span data-ttu-id="27345-220">Per Automazione, il valore è Job.</span><span class="sxs-lookup"><span data-stu-id="27345-220">For Automation, the value is Job.</span></span> |
| <span data-ttu-id="27345-221">Risorsa</span><span class="sxs-lookup"><span data-stu-id="27345-221">Resource</span></span> | <span data-ttu-id="27345-222">Nome dell'account di Automazione</span><span class="sxs-lookup"><span data-stu-id="27345-222">Name of the Automation account</span></span> |
| <span data-ttu-id="27345-223">SourceSystem</span><span class="sxs-lookup"><span data-stu-id="27345-223">SourceSystem</span></span> | <span data-ttu-id="27345-224">Modo in cui Log Analytics ha raccolto i dati.</span><span class="sxs-lookup"><span data-stu-id="27345-224">How Log Analytics collected the data.</span></span> <span data-ttu-id="27345-225">È sempre *Azure* per la diagnostica di Azure.</span><span class="sxs-lookup"><span data-stu-id="27345-225">Always *Azure* for Azure diagnostics.</span></span> |
| <span data-ttu-id="27345-226">ResultDescription</span><span class="sxs-lookup"><span data-stu-id="27345-226">ResultDescription</span></span> |<span data-ttu-id="27345-227">Include il flusso di output dal runbook.</span><span class="sxs-lookup"><span data-stu-id="27345-227">Includes the output stream from the runbook.</span></span> |
| <span data-ttu-id="27345-228">CorrelationId</span><span class="sxs-lookup"><span data-stu-id="27345-228">CorrelationId</span></span> |<span data-ttu-id="27345-229">Il GUID che rappresenta l'ID di correlazione del processo di runbook.</span><span class="sxs-lookup"><span data-stu-id="27345-229">GUID that is the Correlation Id of the runbook job.</span></span> |
| <span data-ttu-id="27345-230">ResourceId</span><span class="sxs-lookup"><span data-stu-id="27345-230">ResourceId</span></span> |<span data-ttu-id="27345-231">Specifica l'ID risorsa dell'account di Automazione di Azure del runbook.</span><span class="sxs-lookup"><span data-stu-id="27345-231">Specifies the Azure Automation account resource id of the runbook.</span></span> |
| <span data-ttu-id="27345-232">SubscriptionId</span><span class="sxs-lookup"><span data-stu-id="27345-232">SubscriptionId</span></span> | <span data-ttu-id="27345-233">ID della sottoscrizione di Azure (GUID) per l'account di Automazione.</span><span class="sxs-lookup"><span data-stu-id="27345-233">The Azure subscription Id (GUID) for the Automation account.</span></span> |
| <span data-ttu-id="27345-234">ResourceGroup</span><span class="sxs-lookup"><span data-stu-id="27345-234">ResourceGroup</span></span> | <span data-ttu-id="27345-235">Nome del gruppo di risorse dell'account di Automazione.</span><span class="sxs-lookup"><span data-stu-id="27345-235">Name of the resource group for the Automation account.</span></span> |
| <span data-ttu-id="27345-236">ResourceProvider</span><span class="sxs-lookup"><span data-stu-id="27345-236">ResourceProvider</span></span> | <span data-ttu-id="27345-237">MICROSOFT.AUTOMATION</span><span class="sxs-lookup"><span data-stu-id="27345-237">MICROSOFT.AUTOMATION</span></span> |
| <span data-ttu-id="27345-238">ResourceType</span><span class="sxs-lookup"><span data-stu-id="27345-238">ResourceType</span></span> | <span data-ttu-id="27345-239">AUTOMATIONACCOUNTS</span><span class="sxs-lookup"><span data-stu-id="27345-239">AUTOMATIONACCOUNTS</span></span> |

## <a name="viewing-automation-logs-in-log-analytics"></a><span data-ttu-id="27345-240">Visualizzazione dei log di Automazione in Log Analytics</span><span class="sxs-lookup"><span data-stu-id="27345-240">Viewing Automation Logs in Log Analytics</span></span>
<span data-ttu-id="27345-241">Dopo avere avviato l'invio di log di processo di Automazione a Log Analytics, si vedrà quali operazioni è possibile eseguire con questi log in Log Analytics.</span><span class="sxs-lookup"><span data-stu-id="27345-241">Now that you have started sending your Automation job logs to Log Analytics, let’s see what you can do with these logs inside Log Analytics.</span></span>

<span data-ttu-id="27345-242">Per visualizzare i log eseguire questa query: `Type=AzureDiagnostics ResourceProvider="MICROSOFT.AUTOMATION"`</span><span class="sxs-lookup"><span data-stu-id="27345-242">To see the logs, run the following query: `Type=AzureDiagnostics ResourceProvider="MICROSOFT.AUTOMATION"`</span></span>

### <a name="send-an-email-when-a-runbook-job-fails-or-suspends"></a><span data-ttu-id="27345-243">Inviare un messaggio di posta elettronica quando un processo del runbook non riesce o viene sospeso</span><span class="sxs-lookup"><span data-stu-id="27345-243">Send an email when a runbook job fails or suspends</span></span>
<span data-ttu-id="27345-244">Uno dei clienti più importanti chiede di poter inviare un messaggio di posta elettronica o un SMS quando si verificano problemi con un processo del runbook.</span><span class="sxs-lookup"><span data-stu-id="27345-244">One of our top customer asks is for the ability to send an email or a text when something goes wrong with a runbook job.</span></span>   

<span data-ttu-id="27345-245">Per creare una regola di avviso, è necessario creare prima di tutto una ricerca nei log per trovare i record del processo del runbook che dovranno richiamare l'avviso.</span><span class="sxs-lookup"><span data-stu-id="27345-245">To create an alert rule, you start by creating a log search for the runbook job records that should invoke the alert.</span></span>  <span data-ttu-id="27345-246">Fare clic su pulsante **Avviso** per creare e configurare la regola di avviso.</span><span class="sxs-lookup"><span data-stu-id="27345-246">Click the **Alert** button to create and configure the alert rule.</span></span>

1. <span data-ttu-id="27345-247">Dalla pagina della panoramica di Log Analytics fare clic su **Ricerca log**.</span><span class="sxs-lookup"><span data-stu-id="27345-247">From the Log Analytics Overview page, click **Log Search**.</span></span>
2. <span data-ttu-id="27345-248">Creare una query di ricerca log per l'avviso digitando quanto segue nel campo query: `Type=AzureDiagnostics ResourceProvider="MICROSOFT.AUTOMATION" Category=JobLogs (ResultType=Failed OR ResultType=Suspended)`. È anche possibile raggruppare in base al valore RunbookName usando: `Type=AzureDiagnostics ResourceProvider="MICROSOFT.AUTOMATION" Category=JobLogs (ResultType=Failed OR ResultType=Suspended) | measure Count() by RunbookName_s`</span><span class="sxs-lookup"><span data-stu-id="27345-248">Create a log search query for your alert by typing the following search into the query field:  `Type=AzureDiagnostics ResourceProvider="MICROSOFT.AUTOMATION" Category=JobLogs (ResultType=Failed OR ResultType=Suspended)`  You can also group by the RunbookName by using: `Type=AzureDiagnostics ResourceProvider="MICROSOFT.AUTOMATION" Category=JobLogs (ResultType=Failed OR ResultType=Suspended) | measure Count() by RunbookName_s`</span></span>   

   <span data-ttu-id="27345-249">Se sono stati configurati log da più account di Automazione o sottoscrizioni nell'area di lavoro, è possibile raggruppare gli avvisi per sottoscrizione o account di Automazione.</span><span class="sxs-lookup"><span data-stu-id="27345-249">If you have set up logs from more than one Automation account or subscription to your workspace, you can group your alerts by subscription and Automation account.</span></span>  <span data-ttu-id="27345-250">Il nome dell'account di automazione può essere derivato dal campo Risorsa nella ricerca di JobLogs.</span><span class="sxs-lookup"><span data-stu-id="27345-250">Automation account name can be derived from the Resource field in the search of JobLogs.</span></span>  
3. <span data-ttu-id="27345-251">Per aprire la schermata **Aggiungi regola di avviso** fare clic su **Avviso** nella parte superiore della pagina.</span><span class="sxs-lookup"><span data-stu-id="27345-251">To open the **Add Alert Rule** screen, click **Alert** at the top of the page.</span></span> <span data-ttu-id="27345-252">Per altre informazioni sulle opzioni per la configurazione dell'avviso, vedere [Avvisi in Log Analytics](../log-analytics/log-analytics-alerts.md#alert-rules).</span><span class="sxs-lookup"><span data-stu-id="27345-252">For further details on the options to configure the alert, see [Alerts in Log Analytics](../log-analytics/log-analytics-alerts.md#alert-rules).</span></span>

### <a name="find-all-jobs-that-have-completed-with-errors"></a><span data-ttu-id="27345-253">Trovare tutti i processi completati con errori</span><span class="sxs-lookup"><span data-stu-id="27345-253">Find all jobs that have completed with errors</span></span>
<span data-ttu-id="27345-254">Oltre agli avvisi per gli errori, è possibile determinare quando un processo del runbook presenta un errore non irreversibile.</span><span class="sxs-lookup"><span data-stu-id="27345-254">In addition to alerting on failures, you can find when a runbook job has a non-terminating error.</span></span> <span data-ttu-id="27345-255">In questi casi PowerShell produce un flusso di errore, ma gli errori non irreversibili non comportano la sospensione o l'esito negativo del processo.</span><span class="sxs-lookup"><span data-stu-id="27345-255">In these cases PowerShell produces an error stream, but the non-terminating errors do not cause your job to suspend or fail.</span></span>    

1. <span data-ttu-id="27345-256">Nell'area di lavoro di Log Analytics fare clic su **Ricerca log**.</span><span class="sxs-lookup"><span data-stu-id="27345-256">In your Log Analytics workspace, click **Log Search**.</span></span>
2. <span data-ttu-id="27345-257">Nel campo delle query digitare `Type=AzureDiagnostics ResourceProvider="MICROSOFT.AUTOMATION" Category=JobStreams StreamType_s=Error | measure count() by JobId_g` e quindi fare clic su **Search**.</span><span class="sxs-lookup"><span data-stu-id="27345-257">In the query field, type `Type=AzureDiagnostics ResourceProvider="MICROSOFT.AUTOMATION" Category=JobStreams StreamType_s=Error | measure count() by JobId_g` and then click **Search**.</span></span>

### <a name="view-job-streams-for-a-job"></a><span data-ttu-id="27345-258">Visualizzare flussi del processo per un processo</span><span class="sxs-lookup"><span data-stu-id="27345-258">View job streams for a job</span></span>
<span data-ttu-id="27345-259">Quando si esegue il debug di un processo, è consigliabile esaminarne anche i flussi.</span><span class="sxs-lookup"><span data-stu-id="27345-259">When you are debugging a job, you may also want to look into the job streams.</span></span>  <span data-ttu-id="27345-260">La query seguente illustra tutti i flussi per un singolo processo con GUID 2ebd22ea-e05e-4eb9-9d76-d73cbd4356e0:</span><span class="sxs-lookup"><span data-stu-id="27345-260">The following query shows all the streams for a single job with GUID 2ebd22ea-e05e-4eb9-9d76-d73cbd4356e0:</span></span>   

`Type=AzureDiagnostics ResourceProvider="MICROSOFT.AUTOMATION" Category=JobStreams JobId_g="2ebd22ea-e05e-4eb9-9d76-d73cbd4356e0" | sort TimeGenerated | select ResultDescription`

### <a name="view-historical-job-status"></a><span data-ttu-id="27345-261">Visualizzare lo stato cronologico del processo</span><span class="sxs-lookup"><span data-stu-id="27345-261">View historical job status</span></span>
<span data-ttu-id="27345-262">Infine, è consigliabile visualizzare la cronologia dei processi nel tempo.</span><span class="sxs-lookup"><span data-stu-id="27345-262">Finally, you may want to visualize your job history over time.</span></span>  <span data-ttu-id="27345-263">È possibile usare questa query per cercare lo stato dei processi nel tempo.</span><span class="sxs-lookup"><span data-stu-id="27345-263">You can use this query to search for the status of your jobs over time.</span></span>

`Type=AzureDiagnostics ResourceProvider="MICROSOFT.AUTOMATION" Category=JobLogs NOT(ResultType="started") | measure Count() by ResultType interval 1hour`  
<br> <span data-ttu-id="27345-264">![Grafico dello stato cronologico del processo OMS](media/automation-manage-send-joblogs-log-analytics/historical-job-status-chart.png)</span><span class="sxs-lookup"><span data-stu-id="27345-264">![OMS Historical Job Status Chart](media/automation-manage-send-joblogs-log-analytics/historical-job-status-chart.png)</span></span><br>

## <a name="summary"></a><span data-ttu-id="27345-265">Riepilogo</span><span class="sxs-lookup"><span data-stu-id="27345-265">Summary</span></span>
<span data-ttu-id="27345-266">Inviando i dati di stato e flusso dei processi di Automazione a Log Analytics è possibile ottenere maggiori informazioni sullo stato dei processi di Automazione:</span><span class="sxs-lookup"><span data-stu-id="27345-266">By sending your Automation job status and stream data to Log Analytics, you can get better insight into the status of your Automation jobs by:</span></span>
+ <span data-ttu-id="27345-267">Configurando avvisi che segnalino la presenza di un problema</span><span class="sxs-lookup"><span data-stu-id="27345-267">Setting up alerts to notify you when there is an issue</span></span>
+ <span data-ttu-id="27345-268">Usando viste personalizzate e query di ricerca per visualizzare i risultati del runbook, lo stato dei processi del runbook e altri indicatori chiave o metriche correlati.</span><span class="sxs-lookup"><span data-stu-id="27345-268">Using custom views and search queries to visualize your runbook results, runbook job status, and other related key indicators or metrics.</span></span>  

<span data-ttu-id="27345-269">Log Analytics offre maggiore visibilità operativa ai processi di Automazione e può consentire di gestire gli eventi imprevisti in modo più veloce.</span><span class="sxs-lookup"><span data-stu-id="27345-269">Log Analytics provides greater operational visibility to your Automation jobs and can help address incidents quicker.</span></span>  

## <a name="next-steps"></a><span data-ttu-id="27345-270">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="27345-270">Next steps</span></span>
* <span data-ttu-id="27345-271">Per alte informazioni su come creare query di ricerca diverso ed esaminare i log del processo di automazione con Log Analytics, vedere [Ricerche nei log in Log Analytics](../log-analytics/log-analytics-log-searches.md)</span><span class="sxs-lookup"><span data-stu-id="27345-271">To learn more about how to construct different search queries and review the Automation job logs with Log Analytics, see [Log searches in Log Analytics](../log-analytics/log-analytics-log-searches.md)</span></span>
* <span data-ttu-id="27345-272">Per informazioni su come creare e recuperare l'output e i messaggi di errore da runbook, vedere [Output di runbook e messaggi in automazione di Azure](automation-runbook-output-and-messages.md)</span><span class="sxs-lookup"><span data-stu-id="27345-272">To understand how to create and retrieve output and error messages from runbooks, see [Runbook output and messages](automation-runbook-output-and-messages.md)</span></span>
* <span data-ttu-id="27345-273">Per maggiori informazioni sull'esecuzione dei runbook, su come monitorare i processi dei runbook e su altri dettagli tecnici, vedere come tenere traccia del processo di un runbook in [Esecuzione di runbook in Automazione di Azure](automation-runbook-execution.md)</span><span class="sxs-lookup"><span data-stu-id="27345-273">To learn more about runbook execution, how to monitor runbook jobs, and other technical details, see [Track a runbook job](automation-runbook-execution.md)</span></span>
* <span data-ttu-id="27345-274">Per altre informazioni su Log Analytics di OMS e sulle origini di raccolta dati, vedere la [panoramica della raccolta dati di Archiviazione di Azure in Log Analytics](../log-analytics/log-analytics-azure-storage.md)</span><span class="sxs-lookup"><span data-stu-id="27345-274">To learn more about OMS Log Analytics and data collection sources, see [Collecting Azure storage data in Log Analytics overview](../log-analytics/log-analytics-azure-storage.md)</span></span>
