---
title: Integrazione di Automazione di Azure con controllo del codice sorgente di Visual Studio Team Services | Microsoft Docs
description: Questo scenario illustra l'impostazione dell'integrazione con un account di Automazione di Azure e controllo del codice sorgente di Visual Studio Team Services.
services: automation
documentationcenter: 
author: eamono
manager: 
editor: 
keywords: Azure PowerShell, VSTS, controllo del codice sorgente, automazione
ms.assetid: a43b395a-e740-41a3-ae62-40eac9d0ec00
ms.service: automation
ms.workload: infrastructure-services
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 01/24/2017
ms.openlocfilehash: 01f9c01c9e04e02dbb548b68cf99684ba6ddd57e
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 07/11/2017
---
# <a name="azure-automation-scenario---automation-source-control-integration-with-visual-studio-team-services"></a><span data-ttu-id="c5e57-104">Scenario di Automazione di Azure - Integrazione del controllo del codice sorgente con Visual Studio Team Services</span><span class="sxs-lookup"><span data-stu-id="c5e57-104">Azure Automation scenario - Automation source control integration with Visual Studio Team Services</span></span>

<span data-ttu-id="c5e57-105">In questo scenario, è presente un progetto di Visual Studio Team Services che si usa per gestire i runbook di Automazione di Azure o le configurazioni DSC nel controllo del codice sorgente.</span><span class="sxs-lookup"><span data-stu-id="c5e57-105">In this scenario, you have a Visual Studio Team Services project that you are using to manage Azure Automation runbooks or DSC configurations under source control.</span></span>
<span data-ttu-id="c5e57-106">Questo articolo descrive come integrare VSTS con l'ambiente di Automazione di Azure in modo che venga eseguita l'integrazione continuata per ogni archiviazione.</span><span class="sxs-lookup"><span data-stu-id="c5e57-106">This article describes how to integrate VSTS with your Azure Automation environment so that continuous integration happens for each check-in.</span></span>

## <a name="getting-the-scenario"></a><span data-ttu-id="c5e57-107">Come ottenere lo scenario</span><span class="sxs-lookup"><span data-stu-id="c5e57-107">Getting the scenario</span></span>

<span data-ttu-id="c5e57-108">Questo scenario è costituito da due runbook di PowerShell che è possibile importare direttamente dalla [raccolta di runbook](automation-runbook-gallery.md) nel portale di Azure o scaricare da [PowerShell Gallery](https://www.powershellgallery.com).</span><span class="sxs-lookup"><span data-stu-id="c5e57-108">This scenario consists of two PowerShell runbooks that you can import directly from the [Runbook Gallery](automation-runbook-gallery.md) in the Azure portal or download from the [PowerShell Gallery](https://www.powershellgallery.com).</span></span>

### <a name="runbooks"></a><span data-ttu-id="c5e57-109">Runbook</span><span class="sxs-lookup"><span data-stu-id="c5e57-109">Runbooks</span></span>

<span data-ttu-id="c5e57-110">Runbook</span><span class="sxs-lookup"><span data-stu-id="c5e57-110">Runbook</span></span> | <span data-ttu-id="c5e57-111">Descrizione</span><span class="sxs-lookup"><span data-stu-id="c5e57-111">Description</span></span>| 
--------|------------|
<span data-ttu-id="c5e57-112">Sincronizzazione VSTS</span><span class="sxs-lookup"><span data-stu-id="c5e57-112">Sync-VSTS</span></span> | <span data-ttu-id="c5e57-113">Importare runbook o configurazioni dal controllo del codice sorgente VSTS al termine di un'archiviazione.</span><span class="sxs-lookup"><span data-stu-id="c5e57-113">Import runbooks or configurations from VSTS source control when a check-in is done.</span></span> <span data-ttu-id="c5e57-114">Se eseguito manualmente, importerà e pubblicherà tutti i runbook o le configurazioni nell'account di automazione.</span><span class="sxs-lookup"><span data-stu-id="c5e57-114">If run manually, it will import and publish all runbooks or configurations into the Automation account.</span></span>| 
<span data-ttu-id="c5e57-115">Sincronizzazione VSTSGit</span><span class="sxs-lookup"><span data-stu-id="c5e57-115">Sync-VSTSGit</span></span> | <span data-ttu-id="c5e57-116">Importare runbook o configurazioni da VSTS nel controllo del codice sorgente Git al termine di un'archiviazione.</span><span class="sxs-lookup"><span data-stu-id="c5e57-116">Import runbooks or configurations from VSTS under Git source control when a check-in is done.</span></span> <span data-ttu-id="c5e57-117">Se eseguito manualmente, importerà e pubblicherà tutti i runbook o le configurazioni nell'account di automazione.</span><span class="sxs-lookup"><span data-stu-id="c5e57-117">If run manually, it will import and publish all runbooks or configurations into the Automation account.</span></span>|

### <a name="variables"></a><span data-ttu-id="c5e57-118">Variabili</span><span class="sxs-lookup"><span data-stu-id="c5e57-118">Variables</span></span>

<span data-ttu-id="c5e57-119">Variabile</span><span class="sxs-lookup"><span data-stu-id="c5e57-119">Variable</span></span> | <span data-ttu-id="c5e57-120">Descrizione</span><span class="sxs-lookup"><span data-stu-id="c5e57-120">Description</span></span>|
-----------|------------|
<span data-ttu-id="c5e57-121">VSToken</span><span class="sxs-lookup"><span data-stu-id="c5e57-121">VSToken</span></span> | <span data-ttu-id="c5e57-122">Protegge l'asset della variabile creato che contiene il token di accesso personale VSTS.</span><span class="sxs-lookup"><span data-stu-id="c5e57-122">Secure variable asset you will create that contains the VSTS personal access token.</span></span> <span data-ttu-id="c5e57-123">È possibile imparare a creare un token di accesso personale VSTS nella [pagina di autenticazione VSTS](https://www.visualstudio.com/en-us/docs/integrate/get-started/auth/overview).</span><span class="sxs-lookup"><span data-stu-id="c5e57-123">You can learn how to create a VSTS personal access token on the [VSTS authentication page](https://www.visualstudio.com/en-us/docs/integrate/get-started/auth/overview).</span></span> 
## <a name="installing-and-configuring-this-scenario"></a><span data-ttu-id="c5e57-124">Installazione e configurazione dello scenario</span><span class="sxs-lookup"><span data-stu-id="c5e57-124">Installing and configuring this scenario</span></span>

<span data-ttu-id="c5e57-125">Creare un [token di accesso personale](https://www.visualstudio.com/en-us/docs/integrate/get-started/auth/overview) in VSTS, che verrà usato per sincronizzare i runbook o le configurazioni nell'account di automazione.</span><span class="sxs-lookup"><span data-stu-id="c5e57-125">Create a [personal access token](https://www.visualstudio.com/en-us/docs/integrate/get-started/auth/overview) in VSTS that you will use to sync the runbooks or configurations into your automation account.</span></span>

![](media/automation-scenario-source-control-integration-with-VSTS/VSTSPersonalToken.png) 

<span data-ttu-id="c5e57-126">Creare una [variabile protetta](automation-variables.md) nell'account di automazione per contenere il token di accesso personale in modo che il runbook possa eseguire l'autenticazione in VSTS e sincronizzare i runbook o le configurazioni nell'account di automazione.</span><span class="sxs-lookup"><span data-stu-id="c5e57-126">Create a [secure variable](automation-variables.md) in your automation account to hold the personal access token so that the runbook can authenticate to VSTS and sync the runbooks or configurations into the Automation account.</span></span> <span data-ttu-id="c5e57-127">È possibile denominare questo token VSToken.</span><span class="sxs-lookup"><span data-stu-id="c5e57-127">You can name this VSToken.</span></span> 

![](media/automation-scenario-source-control-integration-with-VSTS/VSTSTokenVariable.png)

<span data-ttu-id="c5e57-128">Importare il runbook che sincronizzerà i runbook o le configurazioni nell'account di automazione.</span><span class="sxs-lookup"><span data-stu-id="c5e57-128">Import the runbook that will sync your runbooks or configurations into the automation account.</span></span> <span data-ttu-id="c5e57-129">È possibile usare il [runbook di esempio VSTS](https://www.powershellgallery.com/packages/Sync-VSTS/1.0/DisplayScript) oppure il [runbook di esempio VSTS con Git] (https://www.powershellgallery.com/packages/Sync-VSTSGit/1.0/DisplayScript) da PowerShellGallery.com a seconda se si usa il controllo del codice sorgente VSTS o VSTS con Git ed eseguire la distribuzione al proprio account di automazione.</span><span class="sxs-lookup"><span data-stu-id="c5e57-129">You can use the [VSTS sample runbook](https://www.powershellgallery.com/packages/Sync-VSTS/1.0/DisplayScript) or the [VSTS with Git sample runbook] (https://www.powershellgallery.com/packages/Sync-VSTSGit/1.0/DisplayScript) from the PowerShellGallery.com depending on if you use VSTS source control or VSTS with Git and deploy to your automation account.</span></span>

![](media/automation-scenario-source-control-integration-with-VSTS/VSTSPowerShellGallery.png)

<span data-ttu-id="c5e57-130">È ora possibile [pubblicare](automation-creating-importing-runbook.md#publishing-a-runbook) questo runbook in modo da creare un webhook.</span><span class="sxs-lookup"><span data-stu-id="c5e57-130">You can now [publish](automation-creating-importing-runbook.md#publishing-a-runbook) this runbook so you can create a webhook.</span></span> 
![](media/automation-scenario-source-control-integration-with-VSTS/VSTSPublishRunbook.png)

<span data-ttu-id="c5e57-131">Creare un [webhook](automation-webhooks.md) per questo runbook di sincronizzazione VSTS e inserire i parametri come illustrato di seguito.</span><span class="sxs-lookup"><span data-stu-id="c5e57-131">Create a [webhook](automation-webhooks.md) for this Sync-VSTS runbook and fill in the parameters as shown below.</span></span> <span data-ttu-id="c5e57-132">Assicurarsi di copiare l'url del webhook, poiché sarà necessario per un hook del servizio in VSTS.</span><span class="sxs-lookup"><span data-stu-id="c5e57-132">Make sure you copy the webhook url as you will need it for a service hook in VSTS.</span></span> <span data-ttu-id="c5e57-133">VSAccessTokenVariableName è il nome (VSToken) della variabile protetta creata in precedenza per contenere il token di accesso personale.</span><span class="sxs-lookup"><span data-stu-id="c5e57-133">The VSAccessTokenVariableName is the name (VSToken) of the secure variable that you created earlier to hold the personal access token.</span></span> 

<span data-ttu-id="c5e57-134">L'integrazione con VSTS (Sync-VSTS.ps1) richiederà i parametri seguenti.</span><span class="sxs-lookup"><span data-stu-id="c5e57-134">Integrating with VSTS (Sync-VSTS.ps1) will take the following parameters.</span></span>
### <a name="sync-vsts-parameters"></a><span data-ttu-id="c5e57-135">Parametri di sincronizzazione VSTS</span><span class="sxs-lookup"><span data-stu-id="c5e57-135">Sync-VSTS Parameters</span></span>

<span data-ttu-id="c5e57-136">.</span><span class="sxs-lookup"><span data-stu-id="c5e57-136">Parameter</span></span> | <span data-ttu-id="c5e57-137">Descrizione</span><span class="sxs-lookup"><span data-stu-id="c5e57-137">Description</span></span>| 
--------|------------|
<span data-ttu-id="c5e57-138">WebhookData</span><span class="sxs-lookup"><span data-stu-id="c5e57-138">WebhookData</span></span> | <span data-ttu-id="c5e57-139">Questo file conterrà le informazioni di archiviazione inviate dall'hook del servizio VSTS.</span><span class="sxs-lookup"><span data-stu-id="c5e57-139">This will contain the checkin information sent from the VSTS service hook.</span></span> <span data-ttu-id="c5e57-140">È necessario lasciare vuoto questo parametro.</span><span class="sxs-lookup"><span data-stu-id="c5e57-140">You should leave this parameter blank.</span></span>| 
<span data-ttu-id="c5e57-141">ResourceGroup</span><span class="sxs-lookup"><span data-stu-id="c5e57-141">ResourceGroup</span></span> | <span data-ttu-id="c5e57-142">Nome del gruppo di risorse in cui si trova l'account di automazione.</span><span class="sxs-lookup"><span data-stu-id="c5e57-142">This is the name of the resource group that the automation account is in.</span></span>|
<span data-ttu-id="c5e57-143">AutomationAccountName</span><span class="sxs-lookup"><span data-stu-id="c5e57-143">AutomationAccountName</span></span> | <span data-ttu-id="c5e57-144">Nome dell'account di automazione che verrà sincronizzato con VSTS.</span><span class="sxs-lookup"><span data-stu-id="c5e57-144">The name of the automation account that will sync with VSTS.</span></span>|
<span data-ttu-id="c5e57-145">VSFolder</span><span class="sxs-lookup"><span data-stu-id="c5e57-145">VSFolder</span></span> | <span data-ttu-id="c5e57-146">Nome della cartella in VSTS, in cui sono presenti i runbook e le configurazioni.</span><span class="sxs-lookup"><span data-stu-id="c5e57-146">The name of the folder in VSTS where the runbooks and configurations exist.</span></span>|
<span data-ttu-id="c5e57-147">VSAccount</span><span class="sxs-lookup"><span data-stu-id="c5e57-147">VSAccount</span></span> | <span data-ttu-id="c5e57-148">Nome dell'account di Visual Studio Team Services.</span><span class="sxs-lookup"><span data-stu-id="c5e57-148">The name of the Visual Studio Team Services account.</span></span>| 
<span data-ttu-id="c5e57-149">VSAccessTokenVariableName</span><span class="sxs-lookup"><span data-stu-id="c5e57-149">VSAccessTokenVariableName</span></span> | <span data-ttu-id="c5e57-150">Nome della variabile protetta (VSToken) che contiene il token di accesso personale VSTS.</span><span class="sxs-lookup"><span data-stu-id="c5e57-150">The name of the secure variable (VSToken) that holds the VSTS personal access token.</span></span>| 


![](media/automation-scenario-source-control-integration-with-VSTS/VSTSWebhook.png)

<span data-ttu-id="c5e57-151">Se si usa VSTS con GIT (Sync-VSTSGit.ps1), saranno necessari i parametri seguenti.</span><span class="sxs-lookup"><span data-stu-id="c5e57-151">If you are using VSTS with GIT (Sync-VSTSGit.ps1) it will take the following parameters.</span></span>

<span data-ttu-id="c5e57-152">.</span><span class="sxs-lookup"><span data-stu-id="c5e57-152">Parameter</span></span> | <span data-ttu-id="c5e57-153">Descrizione</span><span class="sxs-lookup"><span data-stu-id="c5e57-153">Description</span></span>|
--------|------------|
<span data-ttu-id="c5e57-154">WebhookData</span><span class="sxs-lookup"><span data-stu-id="c5e57-154">WebhookData</span></span> | <span data-ttu-id="c5e57-155">Questo file conterrà le informazioni di archiviazione inviate dall'hook del servizio VSTS.</span><span class="sxs-lookup"><span data-stu-id="c5e57-155">This will contain the checkin information sent from the VSTS service hook.</span></span> <span data-ttu-id="c5e57-156">È necessario lasciare vuoto questo parametro.</span><span class="sxs-lookup"><span data-stu-id="c5e57-156">You should leave this parameter blank.</span></span>| <span data-ttu-id="c5e57-157">ResourceGroup</span><span class="sxs-lookup"><span data-stu-id="c5e57-157">ResourceGroup</span></span> | <span data-ttu-id="c5e57-158">Nome del gruppo di risorse in cui si trova l'account di automazione.</span><span class="sxs-lookup"><span data-stu-id="c5e57-158">This the name of the resource group that the automation account is in.</span></span>|
<span data-ttu-id="c5e57-159">AutomationAccountName</span><span class="sxs-lookup"><span data-stu-id="c5e57-159">AutomationAccountName</span></span> | <span data-ttu-id="c5e57-160">Nome dell'account di automazione che verrà sincronizzato con VSTS.</span><span class="sxs-lookup"><span data-stu-id="c5e57-160">The name of the automation account that will sync with VSTS.</span></span>|
<span data-ttu-id="c5e57-161">VSAccount</span><span class="sxs-lookup"><span data-stu-id="c5e57-161">VSAccount</span></span> | <span data-ttu-id="c5e57-162">Nome dell'account di Visual Studio Team Services.</span><span class="sxs-lookup"><span data-stu-id="c5e57-162">The name of the Visual Studio Team Services account.</span></span>|
<span data-ttu-id="c5e57-163">VSProject</span><span class="sxs-lookup"><span data-stu-id="c5e57-163">VSProject</span></span> | <span data-ttu-id="c5e57-164">Nome del progetto in VSTS, in cui sono presenti i runbook e le configurazioni.</span><span class="sxs-lookup"><span data-stu-id="c5e57-164">The name of the project in VSTS where the runbooks and configurations exist.</span></span>|
<span data-ttu-id="c5e57-165">GitRepo</span><span class="sxs-lookup"><span data-stu-id="c5e57-165">GitRepo</span></span> | <span data-ttu-id="c5e57-166">Nome del repository Git.</span><span class="sxs-lookup"><span data-stu-id="c5e57-166">The name of the Git repository.</span></span>|
<span data-ttu-id="c5e57-167">GitBranch</span><span class="sxs-lookup"><span data-stu-id="c5e57-167">GitBranch</span></span> | <span data-ttu-id="c5e57-168">Nome del branch nel repository Git VSTS.</span><span class="sxs-lookup"><span data-stu-id="c5e57-168">The name of the branch in VSTS Git repository.</span></span>|
<span data-ttu-id="c5e57-169">Cartella</span><span class="sxs-lookup"><span data-stu-id="c5e57-169">Folder</span></span> | <span data-ttu-id="c5e57-170">Nome della cartella nel branch Git VSTS.</span><span class="sxs-lookup"><span data-stu-id="c5e57-170">The name of the folder in VSTS Git branch.</span></span>|
<span data-ttu-id="c5e57-171">VSAccessTokenVariableName</span><span class="sxs-lookup"><span data-stu-id="c5e57-171">VSAccessTokenVariableName</span></span> | <span data-ttu-id="c5e57-172">Nome della variabile protetta (VSToken) che contiene il token di accesso personale VSTS.</span><span class="sxs-lookup"><span data-stu-id="c5e57-172">The name of the secure variable (VSToken) that holds the VSTS personal access token.</span></span>|

![](media/automation-scenario-source-control-integration-with-VSTS/VSTSGitWebhook.png)

<span data-ttu-id="c5e57-173">Creare un hook del servizio in VSTS per le archiviazioni alla cartella che attiva il webhook all'archiviazione del codice.</span><span class="sxs-lookup"><span data-stu-id="c5e57-173">Create a service hook in VSTS for check-ins to the folder that triggers this webhook on code check-in.</span></span> <span data-ttu-id="c5e57-174">Selezionare Web hook come servizio con cui eseguire l'integrazione quando si crea una nuova sottoscrizione.</span><span class="sxs-lookup"><span data-stu-id="c5e57-174">Select Web Hooks as the service to integrate with when you create a new subscription.</span></span> <span data-ttu-id="c5e57-175">È possibile acquisire familiarità con gli hook del servizio nella [documentazione relativa agli hook del servizio VSTS](https://www.visualstudio.com/en-us/docs/marketplace/integrate/service-hooks/get-started).</span><span class="sxs-lookup"><span data-stu-id="c5e57-175">You can learn more about service hooks on [VSTS Service Hooks documentation](https://www.visualstudio.com/en-us/docs/marketplace/integrate/service-hooks/get-started).</span></span>
![](media/automation-scenario-source-control-integration-with-VSTS/VSTSServiceHook.png)

<span data-ttu-id="c5e57-176">A questo punto si sarà in grado di eseguire tutte le archiviazioni dei runbook e delle configurazioni in VSTS e di sincronizzarle automaticamente nell'account di automazione.</span><span class="sxs-lookup"><span data-stu-id="c5e57-176">You should now be able to do all check-ins of your runbooks and configurations into VSTS and have these automatically sync’d into your automation account.</span></span>

![](media/automation-scenario-source-control-integration-with-VSTS/VSTSSyncRunbookOutput.png)

<span data-ttu-id="c5e57-177">Se si esegue manualmente questo runbook senza che sia attivato da VSTS, è possibile lasciare vuoto il parametro webhookdata in modo che sia eseguita una sincronizzazione completa dalla cartella VSTS specificata.</span><span class="sxs-lookup"><span data-stu-id="c5e57-177">If you run this runbook manually without being triggered by VSTS, you can leave the webhookdata parameter empty and it will do a full sync from the VSTS folder specified.</span></span>

<span data-ttu-id="c5e57-178">Se si desidera disinstallare lo scenario, rimuovere l'hook del servizio da VSTS, eliminare il runbook e la variabile VSToken.</span><span class="sxs-lookup"><span data-stu-id="c5e57-178">If you wish to uninstall the scenario, remove the service hook from VSTS, delete the runbook, and the VSToken variable.</span></span>
