---
title: aaaDesigning applicazioni altamente disponibili, utilizzando l'archiviazione con ridondanza geografica di Azure e accesso in lettura (RA-GRS) | Documenti Microsoft
description: "Come tooarchitect di archiviazione Azure RA-GRS toouse applicazioni a disponibilità elevata flessibilità sufficiente interruzioni toohandle."
services: storage
documentationcenter: .net
author: robinsh
manager: timlt
editor: tysonn
ms.assetid: 8f040b0f-8926-4831-ac07-79f646f31926
ms.service: storage
ms.workload: storage
ms.tgt_pltfrm: na
ms.devlang: dotnet
ms.topic: article
ms.date: 1/19/2017
ms.author: robinsh
ms.openlocfilehash: e4a9fe7ef33eecd894408b3c1ef59920a248d1bd
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/06/2017
---
# <a name="designing-highly-available-applications-using-ra-grs"></a><span data-ttu-id="c1d59-103">Progettazione di applicazioni a disponibilità elevata con RA-GRS</span><span class="sxs-lookup"><span data-stu-id="c1d59-103">Designing Highly Available Applications using RA-GRS</span></span>

<span data-ttu-id="c1d59-104">Una funzionalità comune delle infrastrutture basate su cloud è che offrono una piattaforma a disponibilità elevata per l'hosting di applicazioni.</span><span class="sxs-lookup"><span data-stu-id="c1d59-104">A common feature of cloud-based infrastructures is that they provide a highly available platform for hosting applications.</span></span> <span data-ttu-id="c1d59-105">Gli sviluppatori di applicazioni basate su cloud è necessario considerare attentamente come tooleverage agli utenti di tootheir questa piattaforma toodeliver applicazioni a disponibilità elevata.</span><span class="sxs-lookup"><span data-stu-id="c1d59-105">Developers of cloud-based applications must consider carefully how tooleverage this platform toodeliver highly available applications tootheir users.</span></span> <span data-ttu-id="c1d59-106">Questo articolo illustra in modo specifico su come gli sviluppatori possono utilizzare hello Azure archiviazione l'accesso in lettura archiviazione con ridondanza geografica (RA-GRS) toomake le applicazioni non è più disponibile.</span><span class="sxs-lookup"><span data-stu-id="c1d59-106">This article focuses specifically on how developers can use hello Azure Storage Read Access Geo Redundant Storage (RA-GRS) toomake their applications more available.</span></span>

<span data-ttu-id="c1d59-107">Sono disponibili quattro opzioni di ridondanza: archiviazione con ridondanza locale (LRS), archiviazione con ridondanza della zona (ZRS), archiviazione con ridondanza geografica (GRS) e archiviazione con ridondanza geografica e accesso in lettura (RA-GRS).</span><span class="sxs-lookup"><span data-stu-id="c1d59-107">There are four choices for redundancy – LRS (Locally Redundant Storage), ZRS (Zone Redundant Storage), GRS (Geo-Redundant Storage), and RA-GRS (Read Access Geo-Redundant Storage).</span></span> <span data-ttu-id="c1d59-108">Verrà toodiscuss GRS e RA-GRS in questo articolo.</span><span class="sxs-lookup"><span data-stu-id="c1d59-108">We are going toodiscuss GRS and RA-GRS in this article.</span></span> <span data-ttu-id="c1d59-109">Con l'archiviazione con ridondanza geografica, vengono mantenute tre copie dei dati nell'area primaria di hello selezionato durante l'impostazione di account di archiviazione hello.</span><span class="sxs-lookup"><span data-stu-id="c1d59-109">With GRS, three copies of your data are kept in hello primary region you selected when setting up hello storage account.</span></span> <span data-ttu-id="c1d59-110">Altre tre copie vengono mantenute in modo asincrono in un'area secondaria specificata da Azure.</span><span class="sxs-lookup"><span data-stu-id="c1d59-110">Three additional copies are maintained asynchronously in a secondary region specified by Azure.</span></span> <span data-ttu-id="c1d59-111">RA-GRS è hello equivale all'archiviazione con ridondanza geografica, ad eccezione del fatto che si dispone di accesso in lettura toohello secondario copia.</span><span class="sxs-lookup"><span data-stu-id="c1d59-111">RA-GRS is hello same thing as GRS except that you have read access toohello secondary copy.</span></span> <span data-ttu-id="c1d59-112">Per ulteriori informazioni sulle opzioni di ridondanza di archiviazione di Azure diversi hello, vedere [replica di archiviazione Azure](https://docs.microsoft.com/en-us/azure/storage/storage-redundancy).</span><span class="sxs-lookup"><span data-stu-id="c1d59-112">For more information about hello different Azure Storage redundancy options, see [Azure Storage replication](https://docs.microsoft.com/en-us/azure/storage/storage-redundancy).</span></span> <span data-ttu-id="c1d59-113">Hello replica viene inoltre hello associazioni di aree di hello primario e secondario.</span><span class="sxs-lookup"><span data-stu-id="c1d59-113">hello replication article also shows hello pairings of hello primary and secondary regions.</span></span>

<span data-ttu-id="c1d59-114">Sono disponibili i frammenti di codice inclusi in questo articolo e un esempio completo tooa di collegamento alla fine di hello che è possibile scaricare ed eseguire.</span><span class="sxs-lookup"><span data-stu-id="c1d59-114">There are code snippets included in this article, and a link tooa complete sample at hello end that you can download and run.</span></span>

## <a name="key-features-of-ra-grs"></a><span data-ttu-id="c1d59-115">Funzionalità principali dell'archiviazione con ridondanza geografica e accesso in lettura</span><span class="sxs-lookup"><span data-stu-id="c1d59-115">Key features of RA-GRS</span></span>

<span data-ttu-id="c1d59-116">Prima di descrivere come toouse archiviazione RA-GRS, esaminiamo le proprietà e comportamento.</span><span class="sxs-lookup"><span data-stu-id="c1d59-116">Before we talk about how toouse RA-GRS storage, let's talk about its properties and behavior.</span></span>

* <span data-ttu-id="c1d59-117">Archiviazione di Azure mantiene una copia di sola lettura di dati hello memorizzati nell'area primaria in un'area secondaria; come indicato in precedenza, il servizio di archiviazione hello determina posizione hello di un'area secondaria hello.</span><span class="sxs-lookup"><span data-stu-id="c1d59-117">Azure Storage maintains a read-only copy of hello data you store in your primary region in a secondary region; as noted above, hello storage service determines hello location of hello secondary region.</span></span>

* <span data-ttu-id="c1d59-118">copia di sola lettura Hello è [alla fine coerente](https://en.wikipedia.org/wiki/Eventual_consistency) con dati hello nell'area primaria hello.</span><span class="sxs-lookup"><span data-stu-id="c1d59-118">hello read-only copy is [eventually consistent](https://en.wikipedia.org/wiki/Eventual_consistency) with hello data in hello primary region.</span></span>

* <span data-ttu-id="c1d59-119">Per BLOB, tabelle e code, è possibile eseguire una query area secondaria di hello per un *ora dell'ultima sincronizzazione* valore che indica quando la replica ultimo hello dall'area secondaria di hello toohello primario si è verificato.</span><span class="sxs-lookup"><span data-stu-id="c1d59-119">For blobs, tables, and queues, you can query hello secondary region for a *Last Sync Time* value that tells you when hello last replication from hello primary toohello secondary region occurred.</span></span> <span data-ttu-id="c1d59-120">Questa operazione non è supportata per Archiviazione file di Azure, che non ha attualmente l'archiviazione con ridondanza geografica e accesso in lettura.</span><span class="sxs-lookup"><span data-stu-id="c1d59-120">(This is not supported for Azure File storage, which doesn't have RA-GRS redundancy at this time.)</span></span>

* <span data-ttu-id="c1d59-121">È possibile utilizzare hello libreria Client di archiviazione toointeract con dati hello in una regione di hello primario o secondario.</span><span class="sxs-lookup"><span data-stu-id="c1d59-121">You can use hello Storage Client Library toointeract with hello data in either hello primary or secondary region.</span></span> <span data-ttu-id="c1d59-122">È inoltre possibile reindirizzare lettura richiede automaticamente area secondaria toohello caso di timeout di un'area primaria toohello di richiesta di lettura.</span><span class="sxs-lookup"><span data-stu-id="c1d59-122">You can also redirect read requests automatically toohello secondary region if a read request toohello primary region times out.</span></span>

* <span data-ttu-id="c1d59-123">Se si verifica un problema importante avere effetto sull'accessibilità hello dei dati di hello nell'area primaria hello, hello team di Azure può attivare un failover geografico, a quel punto le voci DNS di hello verso l'area primaria toohello saranno modificate toopoint toohello secondario area.</span><span class="sxs-lookup"><span data-stu-id="c1d59-123">If there is a major issue affecting hello accessibility of hello data in hello primary region, hello Azure team may trigger a geo-failover, at which point hello DNS entries pointing toohello primary region will be changed toopoint toohello secondary region.</span></span>

* <span data-ttu-id="c1d59-124">Se si verifica un failover geografico, Azure verrà selezionare un nuovo percorso secondario percorso toothat di hello dati di replica, quindi scegliere tooit di voci DNS secondario hello.</span><span class="sxs-lookup"><span data-stu-id="c1d59-124">If a geo-failover occurs, Azure will select a new secondary location and replicate hello data toothat location, then point hello secondary DNS entries tooit.</span></span> <span data-ttu-id="c1d59-125">endpoint secondario Hello sarà disponibile fino a quando l'account di archiviazione hello abbia terminato la replica.</span><span class="sxs-lookup"><span data-stu-id="c1d59-125">hello secondary endpoint will be unavailable until hello storage account has finished replicating.</span></span> <span data-ttu-id="c1d59-126">Per ulteriori informazioni, vedere [quali toodo se si verifica un'interruzione di servizio di archiviazione Azure](https://docs.microsoft.com/en-us/azure/storage/storage-disaster-recovery-guidance).</span><span class="sxs-lookup"><span data-stu-id="c1d59-126">For more information, please see [What toodo if an Azure Storage outage occurs](https://docs.microsoft.com/en-us/azure/storage/storage-disaster-recovery-guidance).</span></span>

## <a name="application-design-considerations-when-using-ra-grs"></a><span data-ttu-id="c1d59-127">Considerazioni sulla progettazione di applicazioni quando si usa l'archiviazione con ridondanza geografica e accesso in lettura</span><span class="sxs-lookup"><span data-stu-id="c1d59-127">Application design considerations when using RA-GRS</span></span>

<span data-ttu-id="c1d59-128">scopo principale di Hello di questo articolo è tooshow è come un'applicazione che continuerà toofunction (anche se in una capacità limitata) anche in caso di hello di un errore grave nel file di dati primario hello toodesign center.</span><span class="sxs-lookup"><span data-stu-id="c1d59-128">hello main purpose of this article is tooshow you how toodesign an application that will continue toofunction (albeit in a limited capacity) even in hello event of a major disaster at hello primary data center.</span></span> <span data-ttu-id="c1d59-129">Questo scopo è avente il temporaneo toohandle applicazione o problemi con esecuzione prolungata mentre si è verificato un problema di commutazione tooread dall'area secondaria hello e passa indietro quando l'area primaria hello sarà nuovamente disponibile.</span><span class="sxs-lookup"><span data-stu-id="c1d59-129">You do this by having your application toohandle transient or long-running issues by switching tooread from hello secondary region while there is a problem, and switching back when hello primary region is available again.</span></span>

### <a name="using-eventually-consistent-data"></a><span data-ttu-id="c1d59-130">Uso di dati con coerenza finale</span><span class="sxs-lookup"><span data-stu-id="c1d59-130">Using eventually consistent data</span></span>

<span data-ttu-id="c1d59-131">Questa soluzione proposta presuppone che sia accettabile tooreturn ciò che potrebbe essere l'applicazione chiamante toohello di dati non aggiornati.</span><span class="sxs-lookup"><span data-stu-id="c1d59-131">This proposed solution assumes that it is okay tooreturn what could be stale data toohello calling application.</span></span> <span data-ttu-id="c1d59-132">Poiché dati secondari hello sono alla fine coerenti, è possibile che dati hello è stata scritta toohello primario ma hello aggiornamento toohello secondario del termine non replicare quando l'area primaria hello è diventato inaccessibile.</span><span class="sxs-lookup"><span data-stu-id="c1d59-132">Because hello secondary data is eventually consistent, it is possible that hello data was written toohello primary but hello update toohello secondary had not finished replicating when hello primary region became inaccessible.</span></span>

<span data-ttu-id="c1d59-133">Ad esempio, il cliente è stato possibile inviare un aggiornamento che ha esito positivo e quindi hello primario può scendere prima aggiornamento hello viene propagato toohello secondario.</span><span class="sxs-lookup"><span data-stu-id="c1d59-133">For example, your customer could submit an update that is successful, and then hello primary could go down before hello update is propagated toohello secondary.</span></span> <span data-ttu-id="c1d59-134">In questo caso, se il cliente di hello chiede quindi backup dei dati hello tooread, ricevuti dati non aggiornati di hello anziché dati hello aggiornato.</span><span class="sxs-lookup"><span data-stu-id="c1d59-134">In this case, if hello customer then asks tooread hello data back, he receives hello stale data instead of hello updated data.</span></span> <span data-ttu-id="c1d59-135">È necessario decidere se questa situazione è accettabile e in tal caso, come viene verrà messaggio cliente hello.</span><span class="sxs-lookup"><span data-stu-id="c1d59-135">You must decide if this is acceptable, and if so, how you will message hello customer.</span></span> <span data-ttu-id="c1d59-136">Verrà visualizzato come toocheck hello ora dell'ultima sincronizzazione dati secondario di hello più avanti in questo articolo di toosee se hello secondario è aggiornato.</span><span class="sxs-lookup"><span data-stu-id="c1d59-136">You'll see how toocheck hello Last Sync Time on hello secondary data later in this article toosee if hello secondary is up-to-date.</span></span>

### <a name="handling-services-separately-or-all-together"></a><span data-ttu-id="c1d59-137">Gestione separata o collettiva dei servizi</span><span class="sxs-lookup"><span data-stu-id="c1d59-137">Handling services separately or all together</span></span>

<span data-ttu-id="c1d59-138">Anche se probabilmente non è possibile che toobecome un servizio non disponibile mentre hello altri servizi sono ancora completamente funzionale.</span><span class="sxs-lookup"><span data-stu-id="c1d59-138">While not likely, it is possible for one service toobecome unavailable while hello other services are still fully functional.</span></span> <span data-ttu-id="c1d59-139">È possibile handle hello tentativi e modalità di sola lettura per ogni servizio separatamente (BLOB, code, tabelle) oppure è possibile gestire i tentativi in modo generico per tutti i servizi di archiviazione hello insieme.</span><span class="sxs-lookup"><span data-stu-id="c1d59-139">You can handle hello retries and read-only mode for each service separately (blobs, queues, tables), or you can handle retries generically for all hello storage services together.</span></span>

<span data-ttu-id="c1d59-140">Ad esempio, se si usa code e BLOB nell'applicazione, si può decidere tooput errori non irreversibile toohandle di codice separato per ognuno di essi.</span><span class="sxs-lookup"><span data-stu-id="c1d59-140">For example, if you use queues and blobs in your application, you may decide tooput in separate code toohandle retryable errors for each of these.</span></span> <span data-ttu-id="c1d59-141">Quindi se viene ricevuto un nuovo tentativo dal servizio blob hello, ma il servizio di Accodamento di hello sta ancora lavorando, sarà interessata solo hello in parte l'applicazione che gestisce i BLOB.</span><span class="sxs-lookup"><span data-stu-id="c1d59-141">Then if you get a retry from hello blob service, but hello queue service is still working, only hello part of your application that handles blobs will be impacted.</span></span> <span data-ttu-id="c1d59-142">Se si decide di toohandle servizio di archiviazione di tutti i tentativi in modo generico e un servizio di chiamata toohello blob restituisce un errore non irreversibile, quindi ne risentirà richieste tooboth hello blob servizio e il servizio di Accodamento di hello.</span><span class="sxs-lookup"><span data-stu-id="c1d59-142">If you decide toohandle all storage service retries generically and a call toohello blob service returns a retryable error, then requests tooboth hello blob service and hello queue service will be impacted.</span></span>

<span data-ttu-id="c1d59-143">Ciò dipende in definitiva, complessità hello dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="c1d59-143">Ultimately, this depends on hello complexity of your application.</span></span> <span data-ttu-id="c1d59-144">È possibile decidere di non gli errori di hello toohandle dal servizio, ma invece di leggere le richieste per tutti i servizi toohello secondario area di archiviazione e di eseguire un'applicazione hello in modalità di sola lettura quando viene rilevato un problema con qualsiasi servizio di archiviazione nell'area primaria hello tooredirect.</span><span class="sxs-lookup"><span data-stu-id="c1d59-144">You may decide not toohandle hello failures by service, but instead tooredirect read requests for all storage services toohello secondary region and run hello application in read-only mode when you detect a problem with any storage service in hello primary region.</span></span>

### <a name="other-considerations"></a><span data-ttu-id="c1d59-145">Altre considerazioni</span><span class="sxs-lookup"><span data-stu-id="c1d59-145">Other considerations</span></span>

<span data-ttu-id="c1d59-146">Questi sono hello altre considerazioni si parlerà in rest hello di questo articolo.</span><span class="sxs-lookup"><span data-stu-id="c1d59-146">These are hello other considerations we will discuss in hello rest of this article.</span></span>

*   <span data-ttu-id="c1d59-147">La gestione dei tentativi di richieste di lettura utilizzando il modello di interruttore hello</span><span class="sxs-lookup"><span data-stu-id="c1d59-147">Handling retries of read requests using hello Circuit Breaker pattern</span></span>

*   <span data-ttu-id="c1d59-148">I dati alla fine coerente e hello ora dell'ultima sincronizzazione</span><span class="sxs-lookup"><span data-stu-id="c1d59-148">Eventually-consistent data and hello Last Sync Time</span></span>

*   <span data-ttu-id="c1d59-149">Test</span><span class="sxs-lookup"><span data-stu-id="c1d59-149">Testing</span></span>

## <a name="running-your-application-in-read-only-mode"></a><span data-ttu-id="c1d59-150">Esecuzione dell'applicazione in modalità di sola lettura</span><span class="sxs-lookup"><span data-stu-id="c1d59-150">Running your application in read-only mode</span></span>

<span data-ttu-id="c1d59-151">toouse archiviazione RA-GRS, deve essere in grado di toohandle sia impossibile le richieste di lettura e non è stato possibile di richieste di aggiornamento (con aggiornamento in questo caso pertanto gli inserimenti, aggiornamenti ed eliminazioni).</span><span class="sxs-lookup"><span data-stu-id="c1d59-151">toouse RA-GRS storage, you must be able toohandle both failed read requests and failed update requests (with update in this case meaning inserts, updates, and deletions).</span></span> <span data-ttu-id="c1d59-152">Se hello ha esito negativo centro dati principale, di lettura delle richieste può essere reindirizzato toohello data center secondario, ma le richieste di aggiornamento non è possibile perché hello secondario è di sola lettura.</span><span class="sxs-lookup"><span data-stu-id="c1d59-152">If hello primary data center fails, read requests can be redirected toohello secondary data center, but update requests cannot because hello secondary is read only.</span></span> <span data-ttu-id="c1d59-153">Per questo motivo, è necessario alcuni toorun modo l'applicazione in modalità di sola lettura.</span><span class="sxs-lookup"><span data-stu-id="c1d59-153">For this reason, you need some way toorun your application in read-only mode.</span></span>

<span data-ttu-id="c1d59-154">Ad esempio, è possibile impostare un flag che verrà controllato prima dell'invio di qualsiasi servizio di archiviazione toohello le richieste di aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="c1d59-154">For example, you can set a flag that will be checked before submitting any update requests toohello storage service.</span></span> <span data-ttu-id="c1d59-155">Quando una delle richieste di aggiornamento hello, è possibile ignorarlo e restituire un cliente toohello risposta appropriata.</span><span class="sxs-lookup"><span data-stu-id="c1d59-155">When one of hello update requests comes through, you can skip it and return an appropriate response toohello customer.</span></span> <span data-ttu-id="c1d59-156">È possibile anche desidera toodisable completamente determinate funzionalità finché non viene risolto il problema di hello e avvisare gli utenti che tali funzionalità sono temporaneamente non disponibile.</span><span class="sxs-lookup"><span data-stu-id="c1d59-156">You may even want toodisable certain features altogether until hello problem is resolved and notify users that those features are temporarily unavailable.</span></span>

<span data-ttu-id="c1d59-157">Se si decide di separatamente toohandle errori per ogni servizio, è necessario anche toohandle hello possibilità toorun l'applicazione in modalità di sola lettura dal servizio.</span><span class="sxs-lookup"><span data-stu-id="c1d59-157">If you decide toohandle errors for each service separately, you will also need toohandle hello ability toorun your application in read-only mode by service.</span></span> <span data-ttu-id="c1d59-158">È possibile che i flag di sola lettura per ogni servizio che può essere abilitato e disabilitato e handle hello flag appropriati nelle posizioni appropriate di hello nel codice.</span><span class="sxs-lookup"><span data-stu-id="c1d59-158">You could have read-only flags for each service that can be enabled and disabled and handle hello appropriate flag in hello appropriate places in your code.</span></span>

<span data-ttu-id="c1d59-159">Toorun in grado di corso l'applicazione in modalità di sola lettura con un altro vantaggio: consente di definire funzionalità limitate per hello possibilità tooensure durante un aggiornamento dell'applicazione principale.</span><span class="sxs-lookup"><span data-stu-id="c1d59-159">Being able toorun your application in read-only mode has another side benefit – it gives you hello ability tooensure limited functionality during a major application upgrade.</span></span> <span data-ttu-id="c1d59-160">È possibile attivare toorun l'applicazione in sola lettura e la modalità e punto toohello data center secondario, assicurando che nessun utente è l'accesso ai dati di hello nell'area primaria hello mentre si apportano gli aggiornamenti.</span><span class="sxs-lookup"><span data-stu-id="c1d59-160">You can trigger your application toorun in read-only mode and point toohello secondary data center, ensuring nobody is accessing hello data in hello primary region while you're making upgrades.</span></span>

## <a name="handling-updates-when-running-in-read-only-mode"></a><span data-ttu-id="c1d59-161">Gestione degli aggiornamenti durante l'esecuzione in modalità di sola lettura</span><span class="sxs-lookup"><span data-stu-id="c1d59-161">Handling updates when running in read-only mode</span></span>

<span data-ttu-id="c1d59-162">Esistono diversi modi toohandle aggiornamento richieste durante l'esecuzione in modalità di sola lettura.</span><span class="sxs-lookup"><span data-stu-id="c1d59-162">There are many ways toohandle update requests when running in read-only mode.</span></span> <span data-ttu-id="c1d59-163">Questi modi non verranno illustrati nei dettagli, ma in linea generale vengono presi in considerazione due modelli.</span><span class="sxs-lookup"><span data-stu-id="c1d59-163">We won't cover this comprehensively, but generally, there are a couple of patterns that you consider.</span></span>

1.  <span data-ttu-id="c1d59-164">È possibile rispondere utente tooyour e segnalando che non attualmente implica l'accettazione degli aggiornamenti.</span><span class="sxs-lookup"><span data-stu-id="c1d59-164">You can respond tooyour user and tell them you are not currently accepting updates.</span></span> <span data-ttu-id="c1d59-165">Ad esempio, un sistema di gestione dei contatti potrebbe consentire ai clienti informazioni di contatto tooaccess ma non effettuare aggiornamenti.</span><span class="sxs-lookup"><span data-stu-id="c1d59-165">For example, a contact management system could enable customers tooaccess contact information but not make updates.</span></span>

2.  <span data-ttu-id="c1d59-166">È possibile accodare gli aggiornamenti in un'altra area.</span><span class="sxs-lookup"><span data-stu-id="c1d59-166">You can enqueue your updates in another region.</span></span> <span data-ttu-id="c1d59-167">In questo caso, sarebbe scrivere la coda tooa le richieste di aggiornamento in sospeso in un'area diversa e quindi di avere tali richieste tooprocess un modo dopo hello data center principale viene portato nuovamente online.</span><span class="sxs-lookup"><span data-stu-id="c1d59-167">In this case, you would write your pending update requests tooa queue in a different region, and then have a way tooprocess those requests after hello primary data center comes online again.</span></span> <span data-ttu-id="c1d59-168">In questo scenario, è necessario comunicare hello cliente che ha richiesto l'aggiornamento hello è in coda per l'elaborazione successiva.</span><span class="sxs-lookup"><span data-stu-id="c1d59-168">In this scenario, you should let hello customer know that hello update requested is queued for later processing.</span></span>

3.  <span data-ttu-id="c1d59-169">È possibile scrivere gli aggiornamenti tooa account di archiviazione in un'altra area.</span><span class="sxs-lookup"><span data-stu-id="c1d59-169">You can write your updates tooa storage account in another region.</span></span> <span data-ttu-id="c1d59-170">Quando hello data center principale torna online, è possibile eseguire un toomerge modo gli aggiornamenti dati hello primario, a seconda della struttura di hello dei dati di hello.</span><span class="sxs-lookup"><span data-stu-id="c1d59-170">Then when hello primary data center comes back online, you can have a way toomerge those updates into hello primary data, depending on hello structure of hello data.</span></span> <span data-ttu-id="c1d59-171">Ad esempio, se si siano creando un file separato con un indicatore di data/ora nel nome hello, è possibile copiare tali area primaria toohello backup di file.</span><span class="sxs-lookup"><span data-stu-id="c1d59-171">For example, if you are creating separate files with a date/time stamp in hello name, you can copy those files back toohello primary region.</span></span> <span data-ttu-id="c1d59-172">Questa procedura funziona per alcuni carichi di lavoro, ad esempio dati di registrazione e iOT.</span><span class="sxs-lookup"><span data-stu-id="c1d59-172">This works for some workloads such as logging and iOT data.</span></span>

## <a name="handling-retries"></a><span data-ttu-id="c1d59-173">Gestione dei tentativi</span><span class="sxs-lookup"><span data-stu-id="c1d59-173">Handling retries</span></span>

<span data-ttu-id="c1d59-174">Come si possono identificare gli errori non irreversibili?</span><span class="sxs-lookup"><span data-stu-id="c1d59-174">How do you know which errors are retryable?</span></span> <span data-ttu-id="c1d59-175">Viene determinato dalla libreria client di archiviazione hello.</span><span class="sxs-lookup"><span data-stu-id="c1d59-175">This is determined by hello storage client library.</span></span> <span data-ttu-id="c1d59-176">Ad esempio, un errore 404 (risorsa non trovata) non è non irreversibile nuovo tentativo in corso, non è probabilmente tooresult in caso di esito positivo.</span><span class="sxs-lookup"><span data-stu-id="c1d59-176">For example, a 404 error (resource not found) is not retryable because retrying it is not likely tooresult in success.</span></span> <span data-ttu-id="c1d59-177">In hello invece un errore 500 è non irreversibile perché si tratta di un errore del server, e può essere semplicemente un problema temporaneo.</span><span class="sxs-lookup"><span data-stu-id="c1d59-177">On hello other hand, a 500 error is retryable because it is a server error, and it may simply be a transient issue.</span></span> <span data-ttu-id="c1d59-178">Per ulteriori dettagli, consultare hello [aprire codice sorgente per la classe ExponentialRetry hello](https://github.com/Azure/azure-storage-net/blob/87b84b3d5ee884c7adc10e494e2c7060956515d0/Lib/Common/RetryPolicies/ExponentialRetry.cs) nella libreria client di archiviazione .NET hello.</span><span class="sxs-lookup"><span data-stu-id="c1d59-178">For more details, check out hello [open source code for hello ExponentialRetry class](https://github.com/Azure/azure-storage-net/blob/87b84b3d5ee884c7adc10e494e2c7060956515d0/Lib/Common/RetryPolicies/ExponentialRetry.cs) in hello .NET storage client library.</span></span> <span data-ttu-id="c1d59-179">(Cercare hello metodo ShouldRetry).</span><span class="sxs-lookup"><span data-stu-id="c1d59-179">(Look for hello ShouldRetry method.)</span></span>

### <a name="read-requests"></a><span data-ttu-id="c1d59-180">Richieste di lettura</span><span class="sxs-lookup"><span data-stu-id="c1d59-180">Read requests</span></span>

<span data-ttu-id="c1d59-181">Se si è verificato un problema con l'archiviazione primaria, le richieste di lettura possono essere reindirizzato toosecondary archiviazione.</span><span class="sxs-lookup"><span data-stu-id="c1d59-181">Read requests can be redirected toosecondary storage if there is a problem with primary storage.</span></span> <span data-ttu-id="c1d59-182">Come indicato in precedenza in [utilizzando infine i dati coerenti](#using-eventually-consistent-data), deve essere accettabile per toopotentially l'applicazione di leggere i dati non aggiornati.</span><span class="sxs-lookup"><span data-stu-id="c1d59-182">As noted above in [Using Eventually Consistent Data](#using-eventually-consistent-data), it must be acceptable for your application toopotentially read stale data.</span></span> <span data-ttu-id="c1d59-183">Se si utilizza hello storage client library tooaccess dati RA-GRS, è possibile specificare il comportamento di ripetizione hello di una richiesta di lettura impostando un valore per hello **LocationMode** tooone delle proprietà seguenti hello:</span><span class="sxs-lookup"><span data-stu-id="c1d59-183">If you are using hello storage client library tooaccess RA-GRS data, you can specify hello retry behavior of a read request by setting a value for hello **LocationMode** property tooone of hello following:</span></span>

*   <span data-ttu-id="c1d59-184">**Localizzazione PrimaryOnly** (hello predefinito)</span><span class="sxs-lookup"><span data-stu-id="c1d59-184">**PrimaryOnly** (hello default)</span></span>

*   <span data-ttu-id="c1d59-185">**PrimaryThenSecondary**</span><span class="sxs-lookup"><span data-stu-id="c1d59-185">**PrimaryThenSecondary**</span></span>

*   <span data-ttu-id="c1d59-186">**SecondaryOnly**</span><span class="sxs-lookup"><span data-stu-id="c1d59-186">**SecondaryOnly**</span></span>

*   <span data-ttu-id="c1d59-187">**SecondaryThenPrimary**</span><span class="sxs-lookup"><span data-stu-id="c1d59-187">**SecondaryThenPrimary**</span></span>

<span data-ttu-id="c1d59-188">Quando si imposta hello **LocationMode** troppo**PrimaryThenSecondary**, se hello iniziale leggere endpoint primario toohello di richiesta ha esito negativo con un errore non irreversibile, il client di hello esegue automaticamente un'altra lettura endpoint secondario toohello della richiesta.</span><span class="sxs-lookup"><span data-stu-id="c1d59-188">When you set hello **LocationMode** too**PrimaryThenSecondary**, if hello initial read request toohello primary endpoint fails with a retryable error, hello client automatically makes another read request toohello secondary endpoint.</span></span> <span data-ttu-id="c1d59-189">Se l'errore hello è un timeout del server, client hello avrà toowait per hello timeout tooexpire prima di ricevere un errore non irreversibile dal servizio hello.</span><span class="sxs-lookup"><span data-stu-id="c1d59-189">If hello error is a server timeout, then hello client will have toowait for hello timeout tooexpire before it receives a retryable error from hello service.</span></span>

<span data-ttu-id="c1d59-190">Sono disponibili essenzialmente due scenari tooconsider quando si decide come toorespond tooa: errore non irreversibile:</span><span class="sxs-lookup"><span data-stu-id="c1d59-190">There are basically two scenarios tooconsider when you are deciding how toorespond tooa retryable error:</span></span>

*   <span data-ttu-id="c1d59-191">Si tratta di un problema di tipo isolato e l'endpoint primario di richieste successive toohello non restituirà un errore non irreversibile.</span><span class="sxs-lookup"><span data-stu-id="c1d59-191">This is an isolated problem and subsequent requests toohello primary endpoint will not return a retryable error.</span></span> <span data-ttu-id="c1d59-192">Un esempio di questa situazione può verificarsi in caso di errore di rete temporaneo.</span><span class="sxs-lookup"><span data-stu-id="c1d59-192">An example of where this might happen is when there is a transient network error.</span></span>

    <span data-ttu-id="c1d59-193">In questo scenario, non ci sono controindicazioni significativo delle prestazioni in presenza di **LocationMode** impostare troppo**PrimaryThenSecondary** come questo errore si verifica raramente.</span><span class="sxs-lookup"><span data-stu-id="c1d59-193">In this scenario, there is no significant performance penalty in having **LocationMode** set too**PrimaryThenSecondary** as this only happens infrequently.</span></span>

*   <span data-ttu-id="c1d59-194">Si tratta di un problema con almeno uno dei servizi di archiviazione hello in area primaria hello e servizio di toothat tutte le successive richieste nell'area primaria hello sono errori non irreversibili tooreturn probabile per un periodo di tempo.</span><span class="sxs-lookup"><span data-stu-id="c1d59-194">This is a problem with at least one of hello storage services in hello primary region and all subsequent requests toothat service in hello primary region are likely tooreturn retryable errors for a period of time.</span></span> <span data-ttu-id="c1d59-195">Un esempio di questo oggetto è se l'area primaria hello è completamente accessibile.</span><span class="sxs-lookup"><span data-stu-id="c1d59-195">An example of this is if hello primary region is completely inaccessible.</span></span>

    <span data-ttu-id="c1d59-196">In questo scenario, è una riduzione delle prestazioni, poiché tutte le richieste di lettura verranno provare innanzitutto l'endpoint primario hello, attendere hello timeout tooexpire, quindi passare l'endpoint secondario toohello.</span><span class="sxs-lookup"><span data-stu-id="c1d59-196">In this scenario, there is a performance penalty because all your read requests will try hello primary endpoint first, wait for hello timeout tooexpire, then switch toohello secondary endpoint.</span></span>

<span data-ttu-id="c1d59-197">Per questi scenari, è necessario identificare che sia presente un problema con l'endpoint primario hello in corso e inviare tutte le richieste di lettura direttamente hello toohello endpoint secondario impostando **LocationMode** proprietà troppo **SecondaryOnly**.</span><span class="sxs-lookup"><span data-stu-id="c1d59-197">For these scenarios, you should identify that there is an ongoing issue with hello primary endpoint and send all read requests directly toohello secondary endpoint by setting hello **LocationMode** property too**SecondaryOnly**.</span></span> <span data-ttu-id="c1d59-198">In questo momento, è necessario modificare anche toorun applicazione hello in modalità di sola lettura.</span><span class="sxs-lookup"><span data-stu-id="c1d59-198">At this time, you should also change hello application toorun in read-only mode.</span></span> <span data-ttu-id="c1d59-199">Questo approccio è noto come hello [modello di interruttore](https://msdn.microsoft.com/library/dn589784.aspx).</span><span class="sxs-lookup"><span data-stu-id="c1d59-199">This approach is known as hello [Circuit Breaker Pattern](https://msdn.microsoft.com/library/dn589784.aspx).</span></span>

### <a name="update-requests"></a><span data-ttu-id="c1d59-200">Richieste di aggiornamento</span><span class="sxs-lookup"><span data-stu-id="c1d59-200">Update requests</span></span>

<span data-ttu-id="c1d59-201">modello di interruttore Hello può anche essere applicato tooupdate richieste.</span><span class="sxs-lookup"><span data-stu-id="c1d59-201">hello Circuit Breaker pattern can also be applied tooupdate requests.</span></span> <span data-ttu-id="c1d59-202">Tuttavia, le richieste di aggiornamento non possono essere reindirizzato toosecondary archiviazione, che è di sola lettura.</span><span class="sxs-lookup"><span data-stu-id="c1d59-202">However, update requests cannot be redirected toosecondary storage, which is read-only.</span></span> <span data-ttu-id="c1d59-203">Per queste richieste, è consigliabile lasciare hello **LocationMode** impostata troppo**localizzazione PrimaryOnly** (hello predefinito).</span><span class="sxs-lookup"><span data-stu-id="c1d59-203">For these requests, you should leave hello **LocationMode** property set too**PrimaryOnly** (hello default).</span></span> <span data-ttu-id="c1d59-204">toohandle questi errori, è possibile applicare un richiede toothese metrica –, ad esempio 10 errori in una riga e quando la soglia viene raggiunta, un'applicazione hello in modalità di sola lettura.</span><span class="sxs-lookup"><span data-stu-id="c1d59-204">toohandle these errors, you can apply a metric toothese requests – such as 10 failures in a row – and when your threshold is met, switch hello application into read-only mode.</span></span> <span data-ttu-id="c1d59-205">È possibile utilizzare hello stessi metodi per la restituzione di modalità tooupdate come quelle descritte di seguito nella sezione successiva di hello sul modello di interruttore hello.</span><span class="sxs-lookup"><span data-stu-id="c1d59-205">You can use hello same methods for returning tooupdate mode as those described below in hello next section about hello Circuit Breaker pattern.</span></span>

## <a name="circuit-breaker-pattern"></a><span data-ttu-id="c1d59-206">Modello a interruttore</span><span class="sxs-lookup"><span data-stu-id="c1d59-206">Circuit Breaker pattern</span></span>

<span data-ttu-id="c1d59-207">Utilizzando il modello di interruttore hello nell'applicazione può impedirne Ritenta un'operazione che è probabile che toofail ripetutamente.</span><span class="sxs-lookup"><span data-stu-id="c1d59-207">Using hello Circuit Breaker pattern in your application can prevent it from retrying an operation that is likely toofail repeatedly.</span></span> <span data-ttu-id="c1d59-208">Consente di hello applicazione toocontinue toorun piuttosto che occupano tempo durante l'operazione di hello viene ripetuta in modo esponenziale.</span><span class="sxs-lookup"><span data-stu-id="c1d59-208">It allows hello application toocontinue toorun rather than taking up time while hello operation is retried exponentially.</span></span> <span data-ttu-id="c1d59-209">Verifica inoltre rileva se l'errore hello è stato risolto, in cui un'applicazione hello ora possibile provare a ripetere l'operazione di hello.</span><span class="sxs-lookup"><span data-stu-id="c1d59-209">It also detects when hello fault has been fixed, at which time hello application can try hello operation again.</span></span>

### <a name="how-tooimplement-hello-circuit-breaker-pattern"></a><span data-ttu-id="c1d59-210">Come tooimplement hello modello di interruttore</span><span class="sxs-lookup"><span data-stu-id="c1d59-210">How tooimplement hello circuit breaker pattern</span></span>

<span data-ttu-id="c1d59-211">tooidentify che si verifica un problema con un endpoint primario in corso, è possibile monitorare la frequenza con cui client hello rileva errori non irreversibili.</span><span class="sxs-lookup"><span data-stu-id="c1d59-211">tooidentify that there is an ongoing problem with a primary endpoint, you can monitor how frequently hello client encounters retryable errors.</span></span> <span data-ttu-id="c1d59-212">Poiché ogni case è diversa, occorre toodecide soglia hello desiderate toouse per endpoint secondario toohello tooswitch decisione hello e l'esecuzione di un'applicazione hello in modalità di sola lettura.</span><span class="sxs-lookup"><span data-stu-id="c1d59-212">Because each case is different, you have toodecide on hello threshold you want toouse for hello decision tooswitch toohello secondary endpoint and run hello application in read-only mode.</span></span> <span data-ttu-id="c1d59-213">Ad esempio, è possibile decidere commutatore hello tooperform se sono presenti errori di 10 in una riga con operazioni non riuscite.</span><span class="sxs-lookup"><span data-stu-id="c1d59-213">For example, you could decide tooperform hello switch if there are 10 failures in a row with no successes.</span></span> <span data-ttu-id="c1d59-214">Un altro esempio è tooswitch se hanno esito negativo 90% delle richieste di hello in un periodo di 2 minuti.</span><span class="sxs-lookup"><span data-stu-id="c1d59-214">Another example is tooswitch if 90% of hello requests in a 2-minute period fail.</span></span>

<span data-ttu-id="c1d59-215">Per primo scenario hello, è semplicemente possibile mantenere un numero di errori di hello e nel caso di esito positivo prima di raggiungere hello toozero di back-conteggio massimo, impostare hello.</span><span class="sxs-lookup"><span data-stu-id="c1d59-215">For hello first scenario, you can simply keep a count of hello failures, and if there is a success before reaching hello maximum, set hello count back toozero.</span></span> <span data-ttu-id="c1d59-216">Per secondo scenario hello, tooimplement unidirezionale è toouse hello MemoryCache oggetto (.NET).</span><span class="sxs-lookup"><span data-stu-id="c1d59-216">For hello second scenario, one way tooimplement it is toouse hello MemoryCache object (in .NET).</span></span> <span data-ttu-id="c1d59-217">Per ogni richiesta, aggiungere una cache toohello CacheItem, hello valore toosuccess (1) o avere esito negativo (0) e too2 minuti di hello scadenza ora dall'ora (o qualunque sia il vincolo di tempo).</span><span class="sxs-lookup"><span data-stu-id="c1d59-217">For each request, add a CacheItem toohello cache, set hello value toosuccess (1) or fail (0), and set hello expiration time too2 minutes from now (or whatever your time constraint is).</span></span> <span data-ttu-id="c1d59-218">Quando viene raggiunta l'ora di scadenza della voce, la voce hello viene rimosso automaticamente.</span><span class="sxs-lookup"><span data-stu-id="c1d59-218">When an entry's expiration time is reached, hello entry is automatically removed.</span></span> <span data-ttu-id="c1d59-219">Sarà così disponibile una finestra continua di 2 minuti.</span><span class="sxs-lookup"><span data-stu-id="c1d59-219">This will give you a rolling 2-minute window.</span></span> <span data-ttu-id="c1d59-220">Ogni volta che si apportata un servizio di archiviazione toohello richiesta, utilizzare innanzitutto una query Linq in hello MemoryCache oggetto toocalculate hello percentuale di successo somma i valori hello e dividendo per il conteggio di hello.</span><span class="sxs-lookup"><span data-stu-id="c1d59-220">Each time you make a request toohello storage service, you first use a Linq query across hello MemoryCache object toocalculate hello percent success by summing hello values and dividing by hello count.</span></span> <span data-ttu-id="c1d59-221">Quando la percentuale di successo hello scende sotto una determinata soglia (ad esempio il 10%), impostare hello **LocationMode** proprietà per richieste di lettura troppo**SecondaryOnly** e passa in modalità di sola lettura prima di un'applicazione hello continuare.</span><span class="sxs-lookup"><span data-stu-id="c1d59-221">When hello percent success drops below some threshold (such as 10%), set hello **LocationMode** property for read requests too**SecondaryOnly** and switch hello application into read-only mode before continuing.</span></span>

<span data-ttu-id="c1d59-222">soglia di Hello degli errori utilizzata toodetermine quando l'opzione hello toomake può variare rispetto a tooservice servizio dell'applicazione, pertanto è consigliabile rendendoli parametri configurabili.</span><span class="sxs-lookup"><span data-stu-id="c1d59-222">hello threshold of errors used toodetermine when toomake hello switch may vary from service tooservice in your application, so you should consider making them configurable parameters.</span></span> <span data-ttu-id="c1d59-223">Si tratta anche se si decide di separatamente gli errori non irreversibili toohandle da ogni servizio o come una sola, come descritto in precedenza.</span><span class="sxs-lookup"><span data-stu-id="c1d59-223">This is also where you decide toohandle retryable errors from each service separately or as one, as discussed previously.</span></span>

<span data-ttu-id="c1d59-224">Un'altra considerazione riguarda la modalità toohandle più istanze di un'applicazione e quali toodo quando si rilevano errori non irreversibili in ogni istanza.</span><span class="sxs-lookup"><span data-stu-id="c1d59-224">Another consideration is how toohandle multiple instances of an application, and what toodo when you detect retryable errors in each instance.</span></span> <span data-ttu-id="c1d59-225">Ad esempio, è possibile 20 macchine virtuali in esecuzione con hello caricamento dell'applicazione stessa.</span><span class="sxs-lookup"><span data-stu-id="c1d59-225">For example, you may have 20 VMs running with hello same application loaded.</span></span> <span data-ttu-id="c1d59-226">Ogni istanza viene gestita separatamente?</span><span class="sxs-lookup"><span data-stu-id="c1d59-226">Do you handle each instance separately?</span></span> <span data-ttu-id="c1d59-227">Se un'istanza avvia problemi, si desidera toolimit hello risposta toojust di un'istanza o si desidera tootry toohave tutte le istanze di rispondono in hello stesso quando un'istanza dispone di un problema?</span><span class="sxs-lookup"><span data-stu-id="c1d59-227">If one instance starts having problems, do you want toolimit hello response toojust that one instance, or do you want tootry toohave all instances respond in hello same way when one instance has a problem?</span></span> <span data-ttu-id="c1d59-228">La gestione di istanze di hello separatamente è molto più semplice che sta tentando di risposta hello toocoordinate tra di loro, ma la procedura dipende dall'architettura dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="c1d59-228">Handling hello instances separately is much simpler than trying toocoordinate hello response across them, but how you do this depends on your application's architecture.</span></span>

### <a name="options-for-monitoring-hello-error-frequency"></a><span data-ttu-id="c1d59-229">Opzioni per il monitoraggio frequenza di errore hello</span><span class="sxs-lookup"><span data-stu-id="c1d59-229">Options for monitoring hello error frequency</span></span>

<span data-ttu-id="c1d59-230">Esistono tre opzioni per il monitoraggio frequenza hello di tentativi nell'area primaria di hello in ordine toodetermine quando tooswitch area secondaria toohello e modifica hello toorun applicazione in modalità di sola lettura.</span><span class="sxs-lookup"><span data-stu-id="c1d59-230">You have three main options for monitoring hello frequency of retries in hello primary region in order toodetermine when tooswitch over toohello secondary region and change hello application toorun in read-only mode.</span></span>

*   <span data-ttu-id="c1d59-231">Aggiungere un gestore per hello [ **nuovo tentativo in corso** ](http://msdn.microsoft.com/en-us/library/microsoft.windowsazure.storage.operationcontext.retrying.aspx) evento hello [ **OperationContext** ](http://msdn.microsoft.com/en-us/library/microsoft.windowsazure.storage.operationcontext.aspx) dell'oggetto il passaggio delle richieste di archiviazione tooyour: si tratta di hello metodo visualizzato in questo articolo e utilizzato nel hello che accompagna di esempio.</span><span class="sxs-lookup"><span data-stu-id="c1d59-231">Add a handler for hello [**Retrying**](http://msdn.microsoft.com/en-us/library/microsoft.windowsazure.storage.operationcontext.retrying.aspx) event on hello [**OperationContext**](http://msdn.microsoft.com/en-us/library/microsoft.windowsazure.storage.operationcontext.aspx) object you pass tooyour storage requests – this is hello method displayed in this article and used in hello accompanying sample.</span></span> <span data-ttu-id="c1d59-232">Questi eventi vengono attivati ogni volta che il client hello Ritenta una richiesta, che consente la frequenza con cui tootrack client hello rileva errori non irreversibili in un endpoint primario.</span><span class="sxs-lookup"><span data-stu-id="c1d59-232">These events fire whenever hello client retries a request, enabling you tootrack how often hello client encounters retryable errors on a primary endpoint.</span></span>

    ```csharp 
    operationContext.Retrying += (sender, arguments) =>
    {
        // Retrying in hello primary region
        if (arguments.Request.Host == primaryhostname)
            ...
    };
    ```

*   <span data-ttu-id="c1d59-233">In hello [ **Evaluate** ](http://msdn.microsoft.com/en-us/library/microsoft.windowsazure.storage.retrypolicies.iextendedretrypolicy.evaluate.aspx) metodo in un criterio di ripetizione di tentativi personalizzati, è possibile eseguire codice personalizzato ogni volta che un nuovo tentativo viene eseguito.</span><span class="sxs-lookup"><span data-stu-id="c1d59-233">In hello [**Evaluate**](http://msdn.microsoft.com/en-us/library/microsoft.windowsazure.storage.retrypolicies.iextendedretrypolicy.evaluate.aspx) method in a custom retry policy, you can run custom code whenever a retry takes place.</span></span> <span data-ttu-id="c1d59-234">In aggiunta toorecording quando si verifica un nuovo tentativo, questo consente hello opportunità toomodify il comportamento del nuovo tentativo.</span><span class="sxs-lookup"><span data-stu-id="c1d59-234">In addition toorecording when a retry happens, this also gives you hello opportunity toomodify your retry behavior.</span></span>

    ```csharp 
    public RetryInfo Evaluate(RetryContext retryContext,
    OperationContext operationContext)
    {
        var statusCode = retryContext.LastRequestResult.HttpStatusCode;
        if (retryContext.CurrentRetryCount >= this.maximumAttempts
        || ((statusCode &gt;= 300 && statusCode &lt; 500 && statusCode != 408)
        || statusCode == 501 // Not Implemented
        || statusCode == 505 // Version Not Supported
            ))
        {
        // Do not retry
            return null;
        }

        // Monitor retries in hello primary location
        ...

        // Determine RetryInterval and TargetLocation
        RetryInfo info =
            CreateRetryInfo(retryContext.CurrentRetryCount);

        return info;
    }
    ```

*   <span data-ttu-id="c1d59-235">terzo approccio Hello è un componente di monitoraggio personalizzato nell'applicazione che esegue il ping continuamente l'endpoint di archiviazione primaria fittizio tooimplement leggere le richieste (ad esempio leggendo un blob di piccole dimensioni) toodetermine relativa integrità.</span><span class="sxs-lookup"><span data-stu-id="c1d59-235">hello third approach is tooimplement a custom monitoring component in your application that continually pings your primary storage endpoint with dummy read requests (such as reading a small blob) toodetermine its health.</span></span> <span data-ttu-id="c1d59-236">Questa operazione impiegherà alcune risorse, ma non molte.</span><span class="sxs-lookup"><span data-stu-id="c1d59-236">This would take up some resources, but not a significant amount.</span></span> <span data-ttu-id="c1d59-237">Quando viene rilevato un problema che raggiunge la soglia, quindi eseguire switch hello troppo**SecondaryOnly** e modalità di sola lettura.</span><span class="sxs-lookup"><span data-stu-id="c1d59-237">When a problem is discovered that reaches your threshold, you would then perform hello switch too**SecondaryOnly** and read-only mode.</span></span>

<span data-ttu-id="c1d59-238">A un certo punto, si desidererà endpoint primario di tooswitch toousing indietro hello e consentire gli aggiornamenti.</span><span class="sxs-lookup"><span data-stu-id="c1d59-238">At some point, you will want tooswitch back toousing hello primary endpoint and allowing updates.</span></span> <span data-ttu-id="c1d59-239">Se si utilizza uno dei primi due metodi hello elencati in precedenza, è possibile passare l'endpoint primario toohello indietro e abilitare la modalità di aggiornamento dopo un periodo di tempo selezionato arbitrariamente o numero di operazioni è stata eseguita.</span><span class="sxs-lookup"><span data-stu-id="c1d59-239">If using one of hello first two methods listed above, you could simply switch back toohello primary endpoint and enable update mode after an arbitrarily selected amount of time or number of operations has been performed.</span></span> <span data-ttu-id="c1d59-240">È possibile quindi consentire torna tramite la logica di ripetizione hello.</span><span class="sxs-lookup"><span data-stu-id="c1d59-240">You can then let it go through hello retry logic again.</span></span> <span data-ttu-id="c1d59-241">Se il problema hello è stato risolto, verrà continuare endpoint primario del toouse hello e consentire gli aggiornamenti.</span><span class="sxs-lookup"><span data-stu-id="c1d59-241">If hello problem has been fixed, it will continue toouse hello primary endpoint and allow updates.</span></span> <span data-ttu-id="c1d59-242">Se è ancora un problema, ancora una volta passa endpoint secondario toohello indietro e modalità di sola lettura dopo criteri hello che è stata impostata.</span><span class="sxs-lookup"><span data-stu-id="c1d59-242">If there is still a problem, it will once more switch back toohello secondary endpoint and read-only mode after failing hello criteria you've set.</span></span>

<span data-ttu-id="c1d59-243">Per terzo scenario hello, quando endpoint di archiviazione primario hello ping nuovamente esito positivo, è possibile attivare torna hello troppo**localizzazione PrimaryOnly** e continuare a consentire gli aggiornamenti.</span><span class="sxs-lookup"><span data-stu-id="c1d59-243">For hello third scenario, when pinging hello primary storage endpoint becomes successful again, you can trigger hello switch back too**PrimaryOnly** and continue allowing updates.</span></span>

## <a name="handling-eventually-consistent-data"></a><span data-ttu-id="c1d59-244">Gestione di dati con coerenza finale</span><span class="sxs-lookup"><span data-stu-id="c1d59-244">Handling eventually consistent data</span></span>

<span data-ttu-id="c1d59-245">RA-GRS funziona mediante la replica di transazioni dall'area secondaria di hello toohello primario.</span><span class="sxs-lookup"><span data-stu-id="c1d59-245">RA-GRS works by replicating transactions from hello primary toohello secondary region.</span></span> <span data-ttu-id="c1d59-246">Il processo di replica garantisce la hello dei dati nell'area secondaria hello *alla fine coerente*.</span><span class="sxs-lookup"><span data-stu-id="c1d59-246">This replication process guarantees that hello data in hello secondary region is *eventually consistent*.</span></span> <span data-ttu-id="c1d59-247">Ciò significa che tutte le transazioni di hello nell'area primaria hello verranno infine visualizzate nell'area secondaria hello, ma che potrebbe verificarsi un ritardo prima che vengano visualizzati e che non vi è alcuna garanzia transazioni hello arrivare in area secondaria di hello in hello stesso ordine che in cui sono stati originariamente installati nell'area primaria hello.</span><span class="sxs-lookup"><span data-stu-id="c1d59-247">This means that all hello transactions in hello primary region will eventually appear in hello secondary region, but that there may be a lag before they appear, and that there is no guarantee hello transactions arrive in hello secondary region in hello same order as that in which they were originally applied in hello primary region.</span></span> <span data-ttu-id="c1d59-248">Se le transazioni arrivano in area secondaria di hello non in ordine, si *potrebbe* prendere in considerazione i dati in toobe area secondaria hello in uno stato incoerente finché il servizio hello è aggiornato.</span><span class="sxs-lookup"><span data-stu-id="c1d59-248">If your transactions arrive in hello secondary region out of order, you *may* consider your data in hello secondary region toobe in an inconsistent state until hello service catches up.</span></span>

<span data-ttu-id="c1d59-249">Hello nella tabella seguente viene illustrato un esempio di cosa potrebbe accadere quando si aggiorna i dettagli di hello di toomake un dipendente un membro di hello *amministratori* ruolo.</span><span class="sxs-lookup"><span data-stu-id="c1d59-249">hello following table shows an example of what might happen when you update hello details of an employee toomake her a member of hello *administrators* role.</span></span> <span data-ttu-id="c1d59-250">Per i migliori risultati hello di questo esempio, è necessario aggiornare hello **dipendente** entità e aggiornare un **ruolo di amministratore** entità con un conteggio del numero totale di hello degli amministratori.</span><span class="sxs-lookup"><span data-stu-id="c1d59-250">For hello sake of this example, this requires you update hello **employee** entity and update an **administrator role** entity with a count of hello total number of administrators.</span></span> <span data-ttu-id="c1d59-251">Si noti come hello applicati gli aggiornamenti sono disponibili nell'area secondaria hello.</span><span class="sxs-lookup"><span data-stu-id="c1d59-251">Notice how hello updates are applied out of order in hello secondary region.</span></span>

| <span data-ttu-id="c1d59-252">**Ora**</span><span class="sxs-lookup"><span data-stu-id="c1d59-252">**Time**</span></span> | <span data-ttu-id="c1d59-253">**Transazione**</span><span class="sxs-lookup"><span data-stu-id="c1d59-253">**Transaction**</span></span>                                            | <span data-ttu-id="c1d59-254">**Replica**</span><span class="sxs-lookup"><span data-stu-id="c1d59-254">**Replication**</span></span>                       | <span data-ttu-id="c1d59-255">**Ora ultima sincronizzazione**</span><span class="sxs-lookup"><span data-stu-id="c1d59-255">**Last Sync Time**</span></span> | <span data-ttu-id="c1d59-256">**Risultato**</span><span class="sxs-lookup"><span data-stu-id="c1d59-256">**Result**</span></span> |
|----------|------------------------------------------------------------|---------------------------------------|--------------------|------------| 
| <span data-ttu-id="c1d59-257">T0</span><span class="sxs-lookup"><span data-stu-id="c1d59-257">T0</span></span>       | <span data-ttu-id="c1d59-258">Transazione A:</span><span class="sxs-lookup"><span data-stu-id="c1d59-258">Transaction A:</span></span> <br> <span data-ttu-id="c1d59-259">Inserimento dell'entità</span><span class="sxs-lookup"><span data-stu-id="c1d59-259">Insert employee</span></span> <br> <span data-ttu-id="c1d59-260">employee nell'area primaria</span><span class="sxs-lookup"><span data-stu-id="c1d59-260">entity in primary</span></span> |                                   |                    | <span data-ttu-id="c1d59-261">La transazione A inserito tooprimary,</span><span class="sxs-lookup"><span data-stu-id="c1d59-261">Transaction A inserted tooprimary,</span></span><br> <span data-ttu-id="c1d59-262">non ancora replicata.</span><span class="sxs-lookup"><span data-stu-id="c1d59-262">not replicated yet.</span></span> |
| <span data-ttu-id="c1d59-263">T1</span><span class="sxs-lookup"><span data-stu-id="c1d59-263">T1</span></span>       |                                                            | <span data-ttu-id="c1d59-264">Transazione A</span><span class="sxs-lookup"><span data-stu-id="c1d59-264">Transaction A</span></span> <br> <span data-ttu-id="c1d59-265">replicata</span><span class="sxs-lookup"><span data-stu-id="c1d59-265">replicated to</span></span><br> <span data-ttu-id="c1d59-266">nell'area secondaria</span><span class="sxs-lookup"><span data-stu-id="c1d59-266">secondary</span></span> | <span data-ttu-id="c1d59-267">T1</span><span class="sxs-lookup"><span data-stu-id="c1d59-267">T1</span></span> | <span data-ttu-id="c1d59-268">La transazione replicata toosecondary.</span><span class="sxs-lookup"><span data-stu-id="c1d59-268">Transaction A replicated toosecondary.</span></span> <br><span data-ttu-id="c1d59-269">Ora ultima sincronizzazione aggiornata.</span><span class="sxs-lookup"><span data-stu-id="c1d59-269">Last Sync Time updated.</span></span>    |
| <span data-ttu-id="c1d59-270">T2</span><span class="sxs-lookup"><span data-stu-id="c1d59-270">T2</span></span>       | <span data-ttu-id="c1d59-271">Transazione B:</span><span class="sxs-lookup"><span data-stu-id="c1d59-271">Transaction B:</span></span><br><span data-ttu-id="c1d59-272">Aggiornamento</span><span class="sxs-lookup"><span data-stu-id="c1d59-272">Update</span></span><br> <span data-ttu-id="c1d59-273">dell'entità employee</span><span class="sxs-lookup"><span data-stu-id="c1d59-273">employee entity</span></span><br> <span data-ttu-id="c1d59-274">nell'area primaria</span><span class="sxs-lookup"><span data-stu-id="c1d59-274">in primary</span></span>  |                                | <span data-ttu-id="c1d59-275">T1</span><span class="sxs-lookup"><span data-stu-id="c1d59-275">T1</span></span>                 | <span data-ttu-id="c1d59-276">Transazione B scritte tooprimary,</span><span class="sxs-lookup"><span data-stu-id="c1d59-276">Transaction B written tooprimary,</span></span><br> <span data-ttu-id="c1d59-277">non ancora replicata.</span><span class="sxs-lookup"><span data-stu-id="c1d59-277">not replicated yet.</span></span>  |
| <span data-ttu-id="c1d59-278">T3</span><span class="sxs-lookup"><span data-stu-id="c1d59-278">T3</span></span>       | <span data-ttu-id="c1d59-279">Transazione C:</span><span class="sxs-lookup"><span data-stu-id="c1d59-279">Transaction C:</span></span><br> <span data-ttu-id="c1d59-280">Aggiornamento</span><span class="sxs-lookup"><span data-stu-id="c1d59-280">Update</span></span> <br><span data-ttu-id="c1d59-281">entità</span><span class="sxs-lookup"><span data-stu-id="c1d59-281">administrator</span></span><br><span data-ttu-id="c1d59-282">administrator role nell'area</span><span class="sxs-lookup"><span data-stu-id="c1d59-282">role entity in</span></span><br><span data-ttu-id="c1d59-283">primaria</span><span class="sxs-lookup"><span data-stu-id="c1d59-283">primary</span></span> |                    | <span data-ttu-id="c1d59-284">T1</span><span class="sxs-lookup"><span data-stu-id="c1d59-284">T1</span></span>                 | <span data-ttu-id="c1d59-285">Transazione C scritta tooprimary,</span><span class="sxs-lookup"><span data-stu-id="c1d59-285">Transaction C written tooprimary,</span></span><br> <span data-ttu-id="c1d59-286">non ancora replicata.</span><span class="sxs-lookup"><span data-stu-id="c1d59-286">not replicated yet.</span></span>  |
| <span data-ttu-id="c1d59-287">*T4*</span><span class="sxs-lookup"><span data-stu-id="c1d59-287">*T4*</span></span>     |                                                       | <span data-ttu-id="c1d59-288">Transazione C</span><span class="sxs-lookup"><span data-stu-id="c1d59-288">Transaction C</span></span> <br><span data-ttu-id="c1d59-289">replicata</span><span class="sxs-lookup"><span data-stu-id="c1d59-289">replicated to</span></span><br> <span data-ttu-id="c1d59-290">nell'area secondaria</span><span class="sxs-lookup"><span data-stu-id="c1d59-290">secondary</span></span> | <span data-ttu-id="c1d59-291">T1</span><span class="sxs-lookup"><span data-stu-id="c1d59-291">T1</span></span>         | <span data-ttu-id="c1d59-292">Transazione C replicata toosecondary.</span><span class="sxs-lookup"><span data-stu-id="c1d59-292">Transaction C replicated toosecondary.</span></span><br><span data-ttu-id="c1d59-293">LastSyncTime non aggiornato perché</span><span class="sxs-lookup"><span data-stu-id="c1d59-293">LastSyncTime not updated because</span></span> <br><span data-ttu-id="c1d59-294">la transazione B non è stata ancora replicata.</span><span class="sxs-lookup"><span data-stu-id="c1d59-294">transaction B has not been replicated yet.</span></span>|
| <span data-ttu-id="c1d59-295">*T5*</span><span class="sxs-lookup"><span data-stu-id="c1d59-295">*T5*</span></span>     | <span data-ttu-id="c1d59-296">Lettura delle entità</span><span class="sxs-lookup"><span data-stu-id="c1d59-296">Read entities</span></span> <br><span data-ttu-id="c1d59-297">dall'area secondaria</span><span class="sxs-lookup"><span data-stu-id="c1d59-297">from secondary</span></span>                           |                                  | <span data-ttu-id="c1d59-298">T1</span><span class="sxs-lookup"><span data-stu-id="c1d59-298">T1</span></span>                 | <span data-ttu-id="c1d59-299">Si ottiene hello valore non aggiornato per dipendente</span><span class="sxs-lookup"><span data-stu-id="c1d59-299">You get hello stale value for employee</span></span> <br> <span data-ttu-id="c1d59-300">employee perché la transazione B</span><span class="sxs-lookup"><span data-stu-id="c1d59-300">entity because transaction B hasn't</span></span> <br> <span data-ttu-id="c1d59-301">non è stata ancora replicata.</span><span class="sxs-lookup"><span data-stu-id="c1d59-301">replicated yet.</span></span> <span data-ttu-id="c1d59-302">Ottenere hello nuovo valore per</span><span class="sxs-lookup"><span data-stu-id="c1d59-302">You get hello new value for</span></span><br> <span data-ttu-id="c1d59-303">l'entità administrator role perché C è stata</span><span class="sxs-lookup"><span data-stu-id="c1d59-303">administrator role entity because C has</span></span><br> <span data-ttu-id="c1d59-304">replicata.</span><span class="sxs-lookup"><span data-stu-id="c1d59-304">replicated.</span></span> <span data-ttu-id="c1d59-305">Ora ultima sincronizzazione non ancora</span><span class="sxs-lookup"><span data-stu-id="c1d59-305">Last Sync Time still hasn't</span></span><br> <span data-ttu-id="c1d59-306">aggiornata perché la transazione B</span><span class="sxs-lookup"><span data-stu-id="c1d59-306">been updated because transaction B</span></span><br> <span data-ttu-id="c1d59-307">non è stata replicata.</span><span class="sxs-lookup"><span data-stu-id="c1d59-307">hasn't replicated.</span></span> <span data-ttu-id="c1d59-308">È possibile stabilire che</span><span class="sxs-lookup"><span data-stu-id="c1d59-308">You can tell the</span></span><br><span data-ttu-id="c1d59-309">l'entità administrator role è incoerente</span><span class="sxs-lookup"><span data-stu-id="c1d59-309">administrator role entity is inconsistent</span></span> <br><span data-ttu-id="c1d59-310">essendo hello entità data/ora dopo</span><span class="sxs-lookup"><span data-stu-id="c1d59-310">because hello entity date/time is after</span></span> <br><span data-ttu-id="c1d59-311">Hello ora dell'ultima sincronizzazione.</span><span class="sxs-lookup"><span data-stu-id="c1d59-311">hello Last Sync Time.</span></span> |
| <span data-ttu-id="c1d59-312">*T6*</span><span class="sxs-lookup"><span data-stu-id="c1d59-312">*T6*</span></span>     |                                                      | <span data-ttu-id="c1d59-313">Transazione B</span><span class="sxs-lookup"><span data-stu-id="c1d59-313">Transaction B</span></span><br> <span data-ttu-id="c1d59-314">replicata</span><span class="sxs-lookup"><span data-stu-id="c1d59-314">replicated to</span></span><br> <span data-ttu-id="c1d59-315">nell'area secondaria</span><span class="sxs-lookup"><span data-stu-id="c1d59-315">secondary</span></span> | <span data-ttu-id="c1d59-316">T6</span><span class="sxs-lookup"><span data-stu-id="c1d59-316">T6</span></span>                 | <span data-ttu-id="c1d59-317">*T6*: tutte le transazioni fino alla C sono</span><span class="sxs-lookup"><span data-stu-id="c1d59-317">*T6* – All transactions through C have</span></span> <br><span data-ttu-id="c1d59-318">state replicate, ora ultima sincronizzazione</span><span class="sxs-lookup"><span data-stu-id="c1d59-318">been replicated, Last Sync Time</span></span><br> <span data-ttu-id="c1d59-319">aggiornata.</span><span class="sxs-lookup"><span data-stu-id="c1d59-319">is updated.</span></span> |

<span data-ttu-id="c1d59-320">In questo esempio, si supponga hello client commutatori tooreading dall'area secondaria di hello al T5.</span><span class="sxs-lookup"><span data-stu-id="c1d59-320">In this example, assume hello client switches tooreading from hello secondary region at T5.</span></span> <span data-ttu-id="c1d59-321">È possibile leggere correttamente hello **ruolo di amministratore** entità in questo momento, ma l'entità hello contiene un valore per il conteggio di hello degli amministratori che non è coerenza con il numero di hello di **dipendente** entità in questa fase, che sono contrassegnati come amministratori nell'area secondaria hello.</span><span class="sxs-lookup"><span data-stu-id="c1d59-321">It can successfully read hello **administrator role** entity at this time, but hello entity contains a value for hello count of administrators that is not consistent with hello number of **employee** entities that are marked as administrators in hello secondary region at this time.</span></span> <span data-ttu-id="c1d59-322">Il client può visualizzare questo valore, con rischio di hello è costituito da informazioni incoerenti.</span><span class="sxs-lookup"><span data-stu-id="c1d59-322">Your client could simply display this value, with hello risk that it is inconsistent information.</span></span> <span data-ttu-id="c1d59-323">In alternativa, hello client potrebbe tentare toodetermine tale hello **ruolo di amministratore** è in uno stato potenzialmente incoerente perché si sono verificati nell'ordine errato hello aggiornamenti e quindi comunicare utente hello del fact.</span><span class="sxs-lookup"><span data-stu-id="c1d59-323">Alternatively, hello client could attempt toodetermine that hello **administrator role** is in a potentially inconsistent state because hello updates have happened out of order, and then inform hello user of this fact.</span></span>

<span data-ttu-id="c1d59-324">toorecognize che dispone di dati potenzialmente non coerenti, hello può utilizzare hello valori di hello *ora dell'ultima sincronizzazione* che è possibile ottenere in qualsiasi momento eseguendo una query su un servizio di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="c1d59-324">toorecognize that it has potentially inconsistent data, hello client can use hello value of hello *Last Sync Time* that you can get at any time by querying a storage service.</span></span> <span data-ttu-id="c1d59-325">In questo modo si hello ora dati hello nell'area secondaria hello ultimo coerente e quando è applicato servizio hello tutti hello transazioni toothat precedente punto nel tempo.</span><span class="sxs-lookup"><span data-stu-id="c1d59-325">This tells you hello time when hello data in hello secondary region was last consistent and when hello service had applied all hello transactions prior toothat point in time.</span></span> <span data-ttu-id="c1d59-326">Nell'esempio hello illustrato in precedenza, dopo che il servizio hello inserito hello **dipendente** entità nell'area secondaria hello, hello ora dell'ultima sincronizzazione è troppo*T1*.</span><span class="sxs-lookup"><span data-stu-id="c1d59-326">In hello example shown above, after hello service inserts hello **employee** entity in hello secondary region, hello last sync time is set too*T1*.</span></span> <span data-ttu-id="c1d59-327">Rimane *T1* fino a quando il servizio di hello Aggiorna hello **dipendente** entità nell'area secondaria di hello quando si imposta troppo*T6*.</span><span class="sxs-lookup"><span data-stu-id="c1d59-327">It remains at *T1* until hello service updates hello **employee** entity in hello secondary region when it is set too*T6*.</span></span> <span data-ttu-id="c1d59-328">Se il client di hello recupera hello quando legge entità hello all'ora dell'ultima sincronizzazione *T5*, è possibile confrontarlo con timestamp hello in entità hello.</span><span class="sxs-lookup"><span data-stu-id="c1d59-328">If hello client retrieves hello last sync time when it reads hello entity at *T5*, it can compare it with hello timestamp on hello entity.</span></span> <span data-ttu-id="c1d59-329">Se il timestamp di hello nell'entità hello è successiva a quella hello ultima sincronizzazione riuscita, quindi hello entità si trova in uno stato potenzialmente non coerente ed effettuare qualunque sia l'azione appropriata di hello per l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="c1d59-329">If hello timestamp on hello entity is later than hello last sync time, then hello entity is in a potentially inconsistent state, and you can take whatever is hello appropriate action for your application.</span></span> <span data-ttu-id="c1d59-330">L'utilizzo del campo, è necessario conoscere quando hello ultimo aggiornamento toohello primaria è stata completata.</span><span class="sxs-lookup"><span data-stu-id="c1d59-330">Using this field requires that you know when hello last update toohello primary was completed.</span></span>

## <a name="testing"></a><span data-ttu-id="c1d59-331">Test</span><span class="sxs-lookup"><span data-stu-id="c1d59-331">Testing</span></span>

<span data-ttu-id="c1d59-332">È importante tootest che l'applicazione si comporta come previsto quando si verificano errori non irreversibili.</span><span class="sxs-lookup"><span data-stu-id="c1d59-332">It's important tootest that your application behaves as expected when it encounters retryable errors.</span></span> <span data-ttu-id="c1d59-333">Ad esempio, è necessario tootest che hello toohello Opzioni applicazione secondaria e in modalità di sola lettura quando viene rilevato un problema e torna quando area primaria hello diventa nuovamente disponibile.</span><span class="sxs-lookup"><span data-stu-id="c1d59-333">For example, you need tootest that hello application switches toohello secondary and into read-only mode when it detects a problem, and switches back when hello primary region becomes available again.</span></span> <span data-ttu-id="c1d59-334">toodo, è necessario un toosimulate riproducibile gli errori e controllare la frequenza con cui si verificano.</span><span class="sxs-lookup"><span data-stu-id="c1d59-334">toodo this, you need a way toosimulate retryable errors and control how often they occur.</span></span>

<span data-ttu-id="c1d59-335">È possibile utilizzare [Fiddler](http://www.telerik.com/fiddler) toointercept e modificare le risposte HTTP in uno script.</span><span class="sxs-lookup"><span data-stu-id="c1d59-335">You can use [Fiddler](http://www.telerik.com/fiddler) toointercept and modify HTTP responses in a script.</span></span> <span data-ttu-id="c1d59-336">Questo script è possibile identificare le risposte provenienti dall'endpoint primario e modificare tooone codice stato HTTP di hello che hello che libreria Client di archiviazione riconosce come un errore non irreversibile.</span><span class="sxs-lookup"><span data-stu-id="c1d59-336">This script can identify responses that come from your primary endpoint and change hello HTTP status code tooone that hello Storage Client Library recognizes as a retryable error.</span></span> <span data-ttu-id="c1d59-337">Frammento di codice seguente illustra un semplice esempio di script Fiddler che intercetta le richieste di tooread risposte contro hello **employeedata** tooreturn tabella stato 502:</span><span class="sxs-lookup"><span data-stu-id="c1d59-337">This code snippet shows a simple example of a Fiddler script that intercepts responses tooread requests against hello **employeedata** table tooreturn a 502 status:</span></span>

```java
static function OnBeforeResponse(oSession: Session) {
    ...
    if ((oSession.hostname == "\[yourstorageaccount\].table.core.windows.net")
      && (oSession.PathAndQuery.StartsWith("/employeedata?$filter"))) {
        oSession.responseCode = 502;
    }
}
```

<span data-ttu-id="c1d59-338">È possibile estendere questo esempio toointercept una gamma più ampia di richieste e modificare solo hello **responseCode** alcuni di essi toobetter simulare uno scenario reale.</span><span class="sxs-lookup"><span data-stu-id="c1d59-338">You could extend this example toointercept a wider range of requests and only change hello **responseCode** on some of them toobetter simulate a real-world scenario.</span></span> <span data-ttu-id="c1d59-339">Per ulteriori informazioni sulla personalizzazione script Fiddler, vedere [la modifica di una richiesta o risposta](http://docs.telerik.com/fiddler/KnowledgeBase/FiddlerScript/ModifyRequestOrResponse) in hello documentazione Fiddler.</span><span class="sxs-lookup"><span data-stu-id="c1d59-339">For more information about customizing Fiddler scripts, see [Modifying a Request or Response](http://docs.telerik.com/fiddler/KnowledgeBase/FiddlerScript/ModifyRequestOrResponse) in hello Fiddler documentation.</span></span>

<span data-ttu-id="c1d59-340">Se sono state apportate le soglie di hello per l'applicazione tooread sola modalità configurabile di commutazione, sarà più facile tootest hello il comportamento con volumi di transazioni non di produzione.</span><span class="sxs-lookup"><span data-stu-id="c1d59-340">If you have made hello thresholds for switching your application tooread-only mode configurable, it will be easier tootest hello behavior with non-production transaction volumes.</span></span>

## <a name="next-steps"></a><span data-ttu-id="c1d59-341">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="c1d59-341">Next Steps</span></span>

* <span data-ttu-id="c1d59-342">Per ulteriori informazioni sull'accesso in lettura con ridondanza geografica, incluso un altro esempio di impostazione hello LastSyncTime, vedere [opzioni di ridondanza di archiviazione di Azure Windows e accesso in lettura l'archiviazione con ridondanza geografica](https://blogs.msdn.microsoft.com/windowsazurestorage/2013/12/11/windows-azure-storage-redundancy-options-and-read-access-geo-redundant-storage/).</span><span class="sxs-lookup"><span data-stu-id="c1d59-342">For more information about Read Access Geo-Redundancy, including another example of how hello LastSyncTime is set, please see [Windows Azure Storage Redundancy Options and Read Access Geo Redundant Storage](https://blogs.msdn.microsoft.com/windowsazurestorage/2013/12/11/windows-azure-storage-redundancy-options-and-read-access-geo-redundant-storage/).</span></span>

* <span data-ttu-id="c1d59-343">Per un esempio completo che illustra come toomake hello commutatore avanti e indietro tra gli endpoint di hello primari e secondari, vedere [esempi di Azure-utilizzo hello modello di interruttore con archiviazione RA-GRS](https://github.com/Azure-Samples/storage-dotnet-circuit-breaker-pattern-ha-apps-using-ra-grs).</span><span class="sxs-lookup"><span data-stu-id="c1d59-343">For a complete sample showing how toomake hello switch back and forth between hello Primary and Secondary endpoints, please see [Azure Samples – Using hello Circuit Breaker Pattern with RA-GRS storage](https://github.com/Azure-Samples/storage-dotnet-circuit-breaker-pattern-ha-apps-using-ra-grs).</span></span>
