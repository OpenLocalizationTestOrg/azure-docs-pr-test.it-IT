---
title: Data Lake archivio Hive ottimizzazione linee guida sulle prestazioni aaaAzure | Documenti Microsoft
description: Linee guida per l'ottimizzazione delle prestazioni di Hive in Azure Data Lake Store
services: data-lake-store
documentationcenter: 
author: stewu
manager: amitkul
editor: stewu
ms.assetid: ebde7b9f-2e51-4d43-b7ab-566417221335
ms.service: data-lake-store
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: big-data
ms.date: 12/19/2016
ms.author: stewu
ms.openlocfilehash: e44daeb6ad3b64e893c709df63b56444a330729f
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/06/2017
---
# <a name="performance-tuning-guidance-for-hive-on-hdinsight-and-azure-data-lake-store"></a><span data-ttu-id="d7a6f-103">Linee guida per l'ottimizzazione delle prestazioni di Hive in HDInsight e di Azure Data Lake Store</span><span class="sxs-lookup"><span data-stu-id="d7a6f-103">Performance tuning guidance for Hive on HDInsight and Azure Data Lake Store</span></span>

<span data-ttu-id="d7a6f-104">le impostazioni predefinite di Hello sono state impostate tooprovide buone prestazioni in molti casi di utilizzo diversi.</span><span class="sxs-lookup"><span data-stu-id="d7a6f-104">hello default settings have been set tooprovide good performance across many different use cases.</span></span>  <span data-ttu-id="d7a6f-105">Per le query con utilizzo intensivo dei / o, Hive può essere ottimizzato tooget migliori prestazioni con ADLS.</span><span class="sxs-lookup"><span data-stu-id="d7a6f-105">For I/O intensive queries, Hive can be tuned tooget better performance with ADLS.</span></span>  

## <a name="prerequisites"></a><span data-ttu-id="d7a6f-106">Prerequisiti</span><span class="sxs-lookup"><span data-stu-id="d7a6f-106">Prerequisites</span></span>

* <span data-ttu-id="d7a6f-107">**Una sottoscrizione di Azure**.</span><span class="sxs-lookup"><span data-stu-id="d7a6f-107">**An Azure subscription**.</span></span> <span data-ttu-id="d7a6f-108">Vedere [Ottenere una versione di valutazione gratuita di Azure](https://azure.microsoft.com/pricing/free-trial/).</span><span class="sxs-lookup"><span data-stu-id="d7a6f-108">See [Get Azure free trial](https://azure.microsoft.com/pricing/free-trial/).</span></span>
* <span data-ttu-id="d7a6f-109">**Un account Azure Data Lake Store**.</span><span class="sxs-lookup"><span data-stu-id="d7a6f-109">**An Azure Data Lake Store account**.</span></span> <span data-ttu-id="d7a6f-110">Per istruzioni su come toocreate uno, vedere [introduzione archivio Azure Data Lake](data-lake-store-get-started-portal.md)</span><span class="sxs-lookup"><span data-stu-id="d7a6f-110">For instructions on how toocreate one, see [Get started with Azure Data Lake Store](data-lake-store-get-started-portal.md)</span></span>
* <span data-ttu-id="d7a6f-111">**Cluster di Azure HDInsight** con accesso tooa account archivio Data Lake.</span><span class="sxs-lookup"><span data-stu-id="d7a6f-111">**Azure HDInsight cluster** with access tooa Data Lake Store account.</span></span> <span data-ttu-id="d7a6f-112">Vedere [Creare un cluster HDInsight con Data Lake Store tramite il portale di Azure](data-lake-store-hdinsight-hadoop-use-portal.md).</span><span class="sxs-lookup"><span data-stu-id="d7a6f-112">See [Create an HDInsight cluster with Data Lake Store](data-lake-store-hdinsight-hadoop-use-portal.md).</span></span> <span data-ttu-id="d7a6f-113">Assicurarsi di abilitare Desktop remoto per il cluster hello.</span><span class="sxs-lookup"><span data-stu-id="d7a6f-113">Make sure you enable Remote Desktop for hello cluster.</span></span>
* <span data-ttu-id="d7a6f-114">**Esecuzione di Hive in HDInsight**.</span><span class="sxs-lookup"><span data-stu-id="d7a6f-114">**Running Hive on HDInsight**.</span></span>  <span data-ttu-id="d7a6f-115">toolearn sull'esecuzione di processi Hive in HDInsight, vedere [utilizzare Hive in HDInsight] (https://docs.microsoft.com/en-us/azure/hdinsight/hdinsight-use-hive)</span><span class="sxs-lookup"><span data-stu-id="d7a6f-115">toolearn about running Hive jobs on HDInsight, see [Use Hive on HDInsight] (https://docs.microsoft.com/en-us/azure/hdinsight/hdinsight-use-hive)</span></span>
* <span data-ttu-id="d7a6f-116">**Linee guida per l'ottimizzazione delle prestazioni in ADLS**.</span><span class="sxs-lookup"><span data-stu-id="d7a6f-116">**Performance tuning guidelines on ADLS**.</span></span>  <span data-ttu-id="d7a6f-117">Per i concetti generali relativi alle prestazioni, vedere [Linee guida per l'ottimizzazione delle prestazioni in Data Lake Store](https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-performance-tuning-guidance)</span><span class="sxs-lookup"><span data-stu-id="d7a6f-117">For general performance concepts, see [Data Lake Store Performance Tuning Guidance](https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-performance-tuning-guidance)</span></span>

## <a name="parameters"></a><span data-ttu-id="d7a6f-118">parameters</span><span class="sxs-lookup"><span data-stu-id="d7a6f-118">Parameters</span></span>

<span data-ttu-id="d7a6f-119">Di seguito sono hello più importanti impostazioni tootune per migliorare le prestazioni di ADLS:</span><span class="sxs-lookup"><span data-stu-id="d7a6f-119">Here are hello most important settings tootune for improved ADLS performance:</span></span>

* <span data-ttu-id="d7a6f-120">**hive.tez.Container.Size** : quantità di hello di memoria utilizzata da ogni attività.</span><span class="sxs-lookup"><span data-stu-id="d7a6f-120">**hive.tez.container.size** – hello amount of memory used by each tasks</span></span>

* <span data-ttu-id="d7a6f-121">**tez.grouping.min-size**: la dimensione minima di ciascun mapper</span><span class="sxs-lookup"><span data-stu-id="d7a6f-121">**tez.grouping.min-size** – minimum size of each mapper</span></span>

* <span data-ttu-id="d7a6f-122">**tez.grouping.max-size**: la dimensione massima di ciascun mapper</span><span class="sxs-lookup"><span data-stu-id="d7a6f-122">**tez.grouping.max-size** – maximum size of each mapper</span></span>

* <span data-ttu-id="d7a6f-123">**hive.exec.reducer.bytes.per.reducer**: la dimensione di ciascun riduttore</span><span class="sxs-lookup"><span data-stu-id="d7a6f-123">**hive.exec.reducer.bytes.per.reducer** – size of each reducer</span></span>

<span data-ttu-id="d7a6f-124">**hive.tez.Container.Size** -dimensione del contenitore hello determina la quantità di memoria disponibile per ogni attività.</span><span class="sxs-lookup"><span data-stu-id="d7a6f-124">**hive.tez.container.size** - hello container size determines how much memory is available for each task.</span></span>  <span data-ttu-id="d7a6f-125">Si tratta di input principale di hello per il controllo della concorrenza hello nell'Hive.</span><span class="sxs-lookup"><span data-stu-id="d7a6f-125">This is hello main input for controlling hello concurrency in Hive.</span></span>  

<span data-ttu-id="d7a6f-126">**dimensioni tez.Grouping.min** : questo parametro consente di dimensioni minime di hello tooset di ogni mapper.</span><span class="sxs-lookup"><span data-stu-id="d7a6f-126">**tez.grouping.min-size** – This parameter allows you tooset hello minimum size of each mapper.</span></span>  <span data-ttu-id="d7a6f-127">Se il numero di hello di BizTalk Mapper che sceglie Tez è minore del valore di questo parametro hello, Tez utilizzerà il valore di hello impostato.</span><span class="sxs-lookup"><span data-stu-id="d7a6f-127">If hello number of mappers that Tez chooses is smaller than hello value of this parameter, then Tez will use hello value set here.</span></span>  

<span data-ttu-id="d7a6f-128">**dimensioni tez.Grouping.max** – parametro hello consente dimensioni massime di hello tooset di ogni mapper.</span><span class="sxs-lookup"><span data-stu-id="d7a6f-128">**tez.grouping.max-size** – hello parameter allows you tooset hello maximum size of each mapper.</span></span>  <span data-ttu-id="d7a6f-129">Se il numero di hello di BizTalk Mapper che sceglie Tez è superiore rispetto al valore di questo parametro hello, Tez utilizzerà il valore di hello impostato.</span><span class="sxs-lookup"><span data-stu-id="d7a6f-129">If hello number of mappers that Tez chooses is larger than hello value of this parameter, then Tez will use hello value set here.</span></span>  

<span data-ttu-id="d7a6f-130">**hive.Exec.REDUCER.bytes.per.REDUCER** : questo parametro imposta dimensioni hello di ogni reducer.</span><span class="sxs-lookup"><span data-stu-id="d7a6f-130">**hive.exec.reducer.bytes.per.reducer** – This parameter sets hello size of each reducer.</span></span>  <span data-ttu-id="d7a6f-131">Per impostazione predefinita, ogni riduttore ha una dimensione di 256 MB.</span><span class="sxs-lookup"><span data-stu-id="d7a6f-131">By default, each reducer is 256MB.</span></span>  

## <a name="guidance"></a><span data-ttu-id="d7a6f-132">Indicazioni</span><span class="sxs-lookup"><span data-stu-id="d7a6f-132">Guidance</span></span>

<span data-ttu-id="d7a6f-133">**Impostare hive.exec.reducer.bytes.per.reducer** : valore predefinito di hello funziona bene quando i dati di hello non compressi.</span><span class="sxs-lookup"><span data-stu-id="d7a6f-133">**Set hive.exec.reducer.bytes.per.reducer** – hello default value works well when hello data is uncompressed.</span></span>  <span data-ttu-id="d7a6f-134">Per i dati compressi, si dovrebbero ridurre dimensioni hello del reducer hello.</span><span class="sxs-lookup"><span data-stu-id="d7a6f-134">For data that is compressed, you should reduce hello size of hello reducer.</span></span>  

<span data-ttu-id="d7a6f-135">**Set hive.tez.container.size**: in ciascun nodo, la memoria viene specificata da yarn.nodemanager.resource.memory-mb e dovrebbe essere impostata correttamente nel cluster HDI per impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="d7a6f-135">**Set hive.tez.container.size** – In each node, memory is specified by yarn.nodemanager.resource.memory-mb and should be correctly set on HDI cluster by default.</span></span>  <span data-ttu-id="d7a6f-136">Per ulteriori informazioni sull'impostazione hello appropriata per la memoria in YARN, vedere questo [post](https://docs.microsoft.com/en-us/azure/hdinsight/hdinsight-hadoop-hive-out-of-memory-error-oom).</span><span class="sxs-lookup"><span data-stu-id="d7a6f-136">For additional information on setting hello appropriate memory in YARN, see this [post](https://docs.microsoft.com/en-us/azure/hdinsight/hdinsight-hadoop-hive-out-of-memory-error-oom).</span></span>

<span data-ttu-id="d7a6f-137">I carichi di lavoro con utilizzo intensivo dei / o possono trarre vantaggio dal parallelismo riducendo la dimensione del contenitore Tez hello.</span><span class="sxs-lookup"><span data-stu-id="d7a6f-137">I/O intensive workloads can benefit from more parallelism by decreasing hello Tez container size.</span></span> <span data-ttu-id="d7a6f-138">In questo modo utente hello più contenitori di cui aumenta la concorrenza.</span><span class="sxs-lookup"><span data-stu-id="d7a6f-138">This gives hello user more containers which increases concurrency.</span></span>  <span data-ttu-id="d7a6f-139">Tuttavia, alcune query di Hive richiedono una notevole quantità di memoria (ad esempio MapJoin).</span><span class="sxs-lookup"><span data-stu-id="d7a6f-139">However, some Hive queries require a significant amount of memory (e.g. MapJoin).</span></span>  <span data-ttu-id="d7a6f-140">Se l'attività hello non dispone di sufficiente memoria, si otterrà un'eccezione di memoria insufficiente durante il runtime.</span><span class="sxs-lookup"><span data-stu-id="d7a6f-140">If hello task does not have enough memory, you will get an out of memory exception during runtime.</span></span>  <span data-ttu-id="d7a6f-141">Se si ricevono eccezioni di memoria insufficiente, è necessario aumentare la memoria hello.</span><span class="sxs-lookup"><span data-stu-id="d7a6f-141">If you receive out of memory exceptions, then you should increase hello memory.</span></span>   

<span data-ttu-id="d7a6f-142">numero di simultanee Hello parallelismo delle attività in esecuzione verrà associato per la memoria YARN totale hello.</span><span class="sxs-lookup"><span data-stu-id="d7a6f-142">hello concurrent number of tasks running or parallelism will be bounded by hello total YARN memory.</span></span>  <span data-ttu-id="d7a6f-143">numero di Hello di contenitori YARN indicherà il numero di attività simultanee è possibile eseguire.</span><span class="sxs-lookup"><span data-stu-id="d7a6f-143">hello number of YARN containers will dictate how many concurrent tasks can run.</span></span>  <span data-ttu-id="d7a6f-144">memoria YARN toofind hello per ogni nodo, è possibile passare tooAmbari.</span><span class="sxs-lookup"><span data-stu-id="d7a6f-144">toofind hello YARN memory per node, you can go tooAmbari.</span></span>  <span data-ttu-id="d7a6f-145">Passare tooYARN e visualizzare scheda configurazioni hello.  memoria YARN Hello viene visualizzato in questa finestra.</span><span class="sxs-lookup"><span data-stu-id="d7a6f-145">Navigate tooYARN and view hello Configs tab.  hello YARN memory is displayed in this window.</span></span>  

        Total YARN memory = nodes * YARN memory per node
        # of YARN containers = Total YARN memory / Tez container size
<span data-ttu-id="d7a6f-146">le prestazioni di chiave tooimproving Hello usando ADLS sono concorrenza hello tooincrease quanto possibile.</span><span class="sxs-lookup"><span data-stu-id="d7a6f-146">hello key tooimproving performance using ADLS is tooincrease hello concurrency as much as possible.</span></span>  <span data-ttu-id="d7a6f-147">Tez calcola automaticamente il numero di hello di attività che devono essere creati in modo non è necessario tooset è.</span><span class="sxs-lookup"><span data-stu-id="d7a6f-147">Tez automatically calculates hello number of tasks that should be created so you do not need tooset it.</span></span>   

## <a name="example-calculation"></a><span data-ttu-id="d7a6f-148">Calcolo di esempio</span><span class="sxs-lookup"><span data-stu-id="d7a6f-148">Example Calculation</span></span>

<span data-ttu-id="d7a6f-149">Si supponga di disporre di un cluster D14 a 8 nodi.</span><span class="sxs-lookup"><span data-stu-id="d7a6f-149">Let’s say you have an 8 node D14 cluster.</span></span>  

    Total YARN memory = nodes * YARN memory per node
    Total YARN memory = 8 nodes * 96GB = 768GB
    # of YARN containers = 768GB / 3072MB = 256

## <a name="limitations"></a><span data-ttu-id="d7a6f-150">Limitazioni</span><span class="sxs-lookup"><span data-stu-id="d7a6f-150">Limitations</span></span>
<span data-ttu-id="d7a6f-151">**Limitazione di Azure Data Lake Store**</span><span class="sxs-lookup"><span data-stu-id="d7a6f-151">**ADLS throttling**</span></span> 

<span data-ttu-id="d7a6f-152">UIf si riscontra hello Limita larghezza di banda fornita da ADLS, iniziare toosee errori di attività.</span><span class="sxs-lookup"><span data-stu-id="d7a6f-152">UIf you hit hello limits of bandwidth provided by ADLS, you would start toosee task failures.</span></span> <span data-ttu-id="d7a6f-153">Ciò può essere constatato verificando la presenza di errori di limitazione nei log delle attività.</span><span class="sxs-lookup"><span data-stu-id="d7a6f-153">This could be identified by observing throttling errors in task logs.</span></span>  <span data-ttu-id="d7a6f-154">È possibile ridurre il parallelismo hello mediante l'aumento delle dimensioni del contenitore Tez.</span><span class="sxs-lookup"><span data-stu-id="d7a6f-154">You can decrease hello parallelism by increasing Tez container size.</span></span>  <span data-ttu-id="d7a6f-155">Se occorre maggiore concorrenza per il processo, contattare Microsoft.</span><span class="sxs-lookup"><span data-stu-id="d7a6f-155">If you need more concurrency for your job, please contact us.</span></span>   

<span data-ttu-id="d7a6f-156">toocheck se sono recupero limitate, è necessario il debug di hello tooenable registrazione sul lato client hello.</span><span class="sxs-lookup"><span data-stu-id="d7a6f-156">toocheck if you are getting throttled, you need tooenable hello debug logging on hello client side.</span></span> <span data-ttu-id="d7a6f-157">Di seguito viene indicato come procedere:</span><span class="sxs-lookup"><span data-stu-id="d7a6f-157">Here’s how you can do that:</span></span>

1. <span data-ttu-id="d7a6f-158">Inserire hello seguente proprietà nelle proprietà log4j hello nella configurazione di Hive. Questa operazione può essere eseguita dalla vista Ambari: log4j.logger.com.microsoft.azure.datalake.store=DEBUG riavviare tutti i nodi di hello/servizio per effetto di tootake configurazione hello.</span><span class="sxs-lookup"><span data-stu-id="d7a6f-158">Put hello following property in hello log4j properties in Hive config. This can be done from Ambari view: log4j.logger.com.microsoft.azure.datalake.store=DEBUG Restart all hello nodes/service for hello config tootake effect.</span></span>

2. <span data-ttu-id="d7a6f-159">Se sono recupero limitate, codice di errore HTTP 429 hello nel file di log hive hello verrà visualizzato.</span><span class="sxs-lookup"><span data-stu-id="d7a6f-159">If you are getting throttled, you’ll see hello HTTP 429 error code in hello hive log file.</span></span> <span data-ttu-id="d7a6f-160">file di log hive Hello è /tmp/&lt;utente&gt;/hive.log</span><span class="sxs-lookup"><span data-stu-id="d7a6f-160">hello hive log file is in /tmp/&lt;user&gt;/hive.log</span></span>

## <a name="further-information-on-hive-tuning"></a><span data-ttu-id="d7a6f-161">Ulteriori informazioni sull'ottimizzazione di Hive</span><span class="sxs-lookup"><span data-stu-id="d7a6f-161">Further information on Hive tuning</span></span>

<span data-ttu-id="d7a6f-162">Ecco alcuni articoli di blog che consentiranno di ottimizzare le query di Hive:</span><span class="sxs-lookup"><span data-stu-id="d7a6f-162">Here are a few blogs that will help tune your Hive queries:</span></span>
* [<span data-ttu-id="d7a6f-163">Ottimizzare le query Hive per Hadoop in HDInsight</span><span class="sxs-lookup"><span data-stu-id="d7a6f-163">Optimize Hive queries for Hadoop in HDInsight</span></span>](https://azure.microsoft.com/en-us/documentation/articles/hdinsight-hadoop-optimize-hive-query/)
* [<span data-ttu-id="d7a6f-164">Risoluzione dei problemi di prestazioni delle query Hive</span><span class="sxs-lookup"><span data-stu-id="d7a6f-164">Troubleshooting Hive query performance</span></span>](https://blogs.msdn.microsoft.com/bigdatasupport/2015/08/13/troubleshooting-hive-query-performance-in-hdinsight-hadoop-cluster/)
* [<span data-ttu-id="d7a6f-165">Discussione Ignite sull'ottimizzazione di Hive in HDInsight</span><span class="sxs-lookup"><span data-stu-id="d7a6f-165">Ignite talk on optimize Hive on HDInsight</span></span>](https://channel9.msdn.com/events/Machine-Learning-and-Data-Sciences-Conference/Data-Science-Summit-2016/MSDSS25)
