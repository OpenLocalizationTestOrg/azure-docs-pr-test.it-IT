---
title: Modello di hosting di Azure Service Fabric | Microsoft Docs
description: Questo articolo descrive la relazione tra le repliche (o istanze) di un servizio Servic Fabric distribuito e il processo host del servizio.
services: service-fabric
documentationcenter: .net
author: harahma
manager: timlt
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 04/15/2017
ms.author: harahma
ms.openlocfilehash: ca7092a06a9ffce8383ca8bc9f70ce312cdf9de4
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 07/11/2017
---
# <a name="service-fabric-hosting-model"></a><span data-ttu-id="55381-103">Modello di hosting di Service Fabric</span><span class="sxs-lookup"><span data-stu-id="55381-103">Service Fabric hosting model</span></span>
<span data-ttu-id="55381-104">Questo articolo offre una panoramica dei modelli di hosting delle applicazioni offerti da Service Fabric e descrive le differenze tra i modelli **Processo condiviso** ed **Exclusive Process** (Processo esclusivo).</span><span class="sxs-lookup"><span data-stu-id="55381-104">This article provides an overview of application hosting models provided by Service Fabric, and describes the differences between the **Shared Process** and **Exclusive Process** models.</span></span> <span data-ttu-id="55381-105">Descrive l'aspetto di un'applicazione in un nodo di Service Fabric e la relazione tra le repliche (o istanze) del servizio e il processo host del servizio.</span><span class="sxs-lookup"><span data-stu-id="55381-105">It describes how a deployed application looks on a Service Fabric node and relationship between replicas (or instances) of the service and the service-host process.</span></span>

<span data-ttu-id="55381-106">Prima di procedere, verificare di avere acquisito familiarità con il [modello applicativo di Service Fabric][a1] e di aver compreso i diversi concetti e le relazioni esistenti tra di essi.</span><span class="sxs-lookup"><span data-stu-id="55381-106">Before proceeding further, make sure that you are familiar with [Service Fabric Application Model][a1] and understand various concepts and relation among them.</span></span> 

> [!NOTE]
> <span data-ttu-id="55381-107">In questo articolo, per semplicità, a meno che non indicato in modo esplicito:</span><span class="sxs-lookup"><span data-stu-id="55381-107">In this article, for simplicity, unless explicitly mentioned:</span></span>
>
> - <span data-ttu-id="55381-108">Tutti gli usi del termine *replica* si riferiscono sia a una replica di un servizio con stato che a un'istanza di un servizio senza stato.</span><span class="sxs-lookup"><span data-stu-id="55381-108">All uses of word *replica* refers to both a replica of a stateful service or an instance of a statless service.</span></span>
> - <span data-ttu-id="55381-109">*CodePackage* viene trattato in modo equivalente al processo *ServiceHost* che registra un *ServiceType* e ospita repliche dei servizi di tale *ServiceType*.</span><span class="sxs-lookup"><span data-stu-id="55381-109">*CodePackage* is treated equivalent to *ServiceHost* process that registers a *ServiceType* and hosts replicas of services of that *ServiceType*.</span></span>
>

<span data-ttu-id="55381-110">Per comprendere il servizio di hosting, esaminare l'esempio seguente.</span><span class="sxs-lookup"><span data-stu-id="55381-110">To understand the hosting model, let us walk through an example.</span></span> <span data-ttu-id="55381-111">Si supponga di avere un *ApplicationType* 'MyAppType' con un *ServiceType* 'MyServiceType' fornito dal *ServicePackage* 'MyServicePackage' che ha un *CodePackage* 'MyCodePackage' che registra *ServiceType* 'MyServiceType' quando viene eseguito.</span><span class="sxs-lookup"><span data-stu-id="55381-111">Let us say, we have an *ApplicationType* 'MyAppType' which has a *ServiceType* 'MyServiceType' which is provided by *ServicePackage* 'MyServicePackage' which has a *CodePackage* 'MyCodePackage' which registers *ServiceType* 'MyServiceType' when it runs.</span></span>

<span data-ttu-id="55381-112">Si supponga inoltre di avere un cluster a 3 nodi e di creare un'*applicazione* **fabric:/App1** di tipo 'MyAppType'.</span><span class="sxs-lookup"><span data-stu-id="55381-112">Let's say we have a 3 node cluster and we create an *application* **fabric:/App1** of type 'MyAppType'.</span></span> <span data-ttu-id="55381-113">All'interno di questa *applicazione* **fabric:/App1** viene creato un servizio **fabric:/App1/ServiceA** di tipo 'MyServiceType' con 2 partizioni, **P1** & **P2**, e 3 repliche per partizione.</span><span class="sxs-lookup"><span data-stu-id="55381-113">Inside this *application* **fabric:/App1** we create a service **fabric:/App1/ServiceA** of type 'MyServiceType' which has 2 partitions (say **P1** & **P2**) and 3 replicas per partition.</span></span> <span data-ttu-id="55381-114">Il diagramma seguente mostra la visualizzazione di questa applicazione distribuita in un nodo.</span><span class="sxs-lookup"><span data-stu-id="55381-114">The following diagram shows the view of this application as it ends up deployed on a node.</span></span>

<span data-ttu-id="55381-115"><center>
![Visualizzazione del nodo dell'applicazione distribuita][node-view-one]
</center></span><span class="sxs-lookup"><span data-stu-id="55381-115"><center>
![Node view of deployed application][node-view-one]
</center></span></span>

<span data-ttu-id="55381-116">Service Fabric ha attivato 'MyServicePackage' che ha avviato 'MyCodePackage'. Quest'ultimo ospita repliche da entrambe le partizioni, ovvero **P1** & **P2**.</span><span class="sxs-lookup"><span data-stu-id="55381-116">Service Fabric activated 'MyServicePackage' which started 'MyCodePackage' which is hosting replicas from both the partitions i.e. **P1** & **P2**.</span></span> <span data-ttu-id="55381-117">Si noti che tutti i nodi del cluster avranno la stessa visualizzazione poiché è stato scelto un numero di repliche per partizione uguale al numero di nodi del cluster.</span><span class="sxs-lookup"><span data-stu-id="55381-117">Note that all the nodes in the cluster will have same view since we chose number of replicas per partition equal to number of nodes in the cluster.</span></span> <span data-ttu-id="55381-118">Viene ora creato un altro servizio **fabric:/App1/ServiceB** nell'applicazione **fabric:/App1** con una partizione, **P3**, e 3 repliche per partizione.</span><span class="sxs-lookup"><span data-stu-id="55381-118">Let's create another service **fabric:/App1/ServiceB** in application **fabric:/App1** which has 1 partition (say **P3**) and 3 replicas per partition.</span></span> <span data-ttu-id="55381-119">Il diagramma seguente mostra la nuova visualizzazione del nodo:</span><span class="sxs-lookup"><span data-stu-id="55381-119">Following diagram shows the new view on the node:</span></span>

<span data-ttu-id="55381-120"><center>
![Visualizzazione del nodo dell'applicazione distribuita][node-view-two]
</center></span><span class="sxs-lookup"><span data-stu-id="55381-120"><center>
![Node view of deployed application][node-view-two]
</center></span></span>

<span data-ttu-id="55381-121">Come è possibile notare, Service Fabric posiziona la nuova replica per la partizione **P3** del servizio **fabric:/App1/ServiceB** nell'attivazione esistente di 'MyServicePackage'.</span><span class="sxs-lookup"><span data-stu-id="55381-121">As we can see Service Fabric placed the new replica for partition **P3** of service **fabric:/App1/ServiceB** in the existing activation of 'MyServicePackage'.</span></span> <span data-ttu-id="55381-122">Viene ora creata un'altra *applicazione* **fabric:/App2** di tipo 'MyAppType'. All'interno di **fabric:/App2** viene creato il servizio **fabric:/App2/ServiceA** con due partizioni, **P4** & **P5**, e 3 repliche per partizione.</span><span class="sxs-lookup"><span data-stu-id="55381-122">Now lets create another *application* **fabric:/App2** of type 'MyAppType' and inside **fabric:/App2** create service **fabric:/App2/ServiceA** which has 2 partitions (say **P4** & **P5**) and 3 replicas per partition.</span></span> <span data-ttu-id="55381-123">La figura seguente mostra la nuova visualizzazione del nodo:</span><span class="sxs-lookup"><span data-stu-id="55381-123">Following diagrams shows the new node view:</span></span>

<span data-ttu-id="55381-124"><center>
![Visualizzazione del nodo dell'applicazione distribuita][node-view-three]
</center></span><span class="sxs-lookup"><span data-stu-id="55381-124"><center>
![Node view of deployed application][node-view-three]
</center></span></span>

<span data-ttu-id="55381-125">Questa volta Service Fabric ha attivato una nuova copia di 'MyServicePackage', che a sua volta avvia una nuova copia di 'MyCodePackage'. Repliche di entrambe le partizioni del servizio **fabric:/App2/ServiceA**, ovvero **P4** & **P5**, vengono posizionate in questa nuova copia 'MyCodePackage'.</span><span class="sxs-lookup"><span data-stu-id="55381-125">This time Service Fabric has activated a new copy of 'MyServicePackage' which starts a new copy of 'MyCodePackage' and replicas from both partitions of service **fabric:/App2/ServiceA** (i.e. **P4** & **P5**) are placed in this new copy 'MyCodePackage'.</span></span>

## <a name="shared-process-model"></a><span data-ttu-id="55381-126">Modello Processo condiviso</span><span class="sxs-lookup"><span data-stu-id="55381-126">Shared process model</span></span>
<span data-ttu-id="55381-127">Quanto descritto in precedenza è il modello di hosting predefinito offerto da Service Fabric ed è denominato **Processo condiviso**.</span><span class="sxs-lookup"><span data-stu-id="55381-127">What we saw above is the default hosting model provided by Service Fabric and is referred to as **Shared Process** model.</span></span> <span data-ttu-id="55381-128">In questo modello, per una determinata *applicazione* soltanto una copia di un determinato *ServicePackage* viene attivata in un *Nodo* (che avvia tutti i *CodePackage* in esso contenuti). Tutte le repliche di tutti i servizi di un *ServiceType* specificato vengono posizionate nel *CodePackage* che registra tale *ServiceType*.</span><span class="sxs-lookup"><span data-stu-id="55381-128">In this model, for a given *application*, only one copy of a given *ServicePackage* is activated on a *Node* (which starts all the *CodePackages* contained in it) and all the replicas of all services of a given  *ServiceType* are placed in the *CodePackage* that registers that *ServiceType*.</span></span> <span data-ttu-id="55381-129">In altre parole, tutte le repliche di tutti i servizi di un determinato *ServiceType* condividono lo stesso processo.</span><span class="sxs-lookup"><span data-stu-id="55381-129">In other words, all the replicas of all services of a given *ServiceType* share the same process.</span></span>

## <a name="exclusive-process-model"></a><span data-ttu-id="55381-130">Modello Exclusive Process (Processo esclusivo)</span><span class="sxs-lookup"><span data-stu-id="55381-130">Exclusive process model</span></span>
<span data-ttu-id="55381-131">L'alto modello di hosting offerto da Service Fabric è il modello **Exclusive Process** (Processo esclusivo).</span><span class="sxs-lookup"><span data-stu-id="55381-131">The other hosting model provided by Service Fabric is **Exclusive Process** model.</span></span> <span data-ttu-id="55381-132">In questo modello, su un determinato *Nodo*, per posizionare ciascuna replica Service Fabric attiva una nuova copia di *ServicePackage*, che avvia tutti i *CodePackage* in esso contenuti. La replica viene posizionata nel *CodePackage* che ha registrato il *ServiceType* del servizio a cui la appartiene la replica.</span><span class="sxs-lookup"><span data-stu-id="55381-132">In this model, on a given *Node*, for placing each replica, Service Fabric activates a new copy of *ServicePackage* (which starts all the *CodePackages* contained in it) and replica is placed in the *CodePackage* that registered the *ServiceType* of the service to which replica belongs.</span></span> <span data-ttu-id="55381-133">In altri termini, ogni replica si trova nel proprio processo dedicato.</span><span class="sxs-lookup"><span data-stu-id="55381-133">In other words, each replica lives in its own dedicated process.</span></span> 

<span data-ttu-id="55381-134">Questo modello è supportato a partire dalla versione 5.6 di Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="55381-134">This model is supported starting version 5.6 of Service Fabric.</span></span> <span data-ttu-id="55381-135">È possibile scegliere il modello **Exclusive Process** (Processo esclusivo) al momento della creazione del servizio (mediante [PowerShell][p1], [REST][r1] o [FabricClient][c1]) specificando **ServicePackageActivationMode** come 'ExclusiveProcess'.</span><span class="sxs-lookup"><span data-stu-id="55381-135">**Exclusive Process** model can be chosen at the time of creating the service (using [PowerShell][p1], [REST][r1] or [FabricClient][c1]) by specifying **ServicePackageActivationMode** as 'ExclusiveProcess'.</span></span>

```powershell
PS C:\>New-ServiceFabricService -ApplicationName "fabric:/App1" -ServiceName "fabric:/App1/ServiceA" -ServiceTypeName "MyServiceType" -Stateless -PartitionSchemeSingleton -InstanceCount -1 -ServicePackageActivationMode "ExclusiveProcess"
```

```csharp
var serviceDescription = new StatelessServiceDescription
{
    ApplicationName = new Uri("fabric:/App1"),
    ServiceName = new Uri("fabric:/App1/ServiceA"),
    ServiceTypeName = "MyServiceType",
    PartitionSchemeDescription = new SingletonPartitionSchemeDescription(),
    InstanceCount = -1,
    ServicePackageActivationMode = ServicePackageActivationMode.ExclusiveProcess
};

var fabricClient = new FabricClient(clusterEndpoints);
await fabricClient.ServiceManager.CreateServiceAsync(serviceDescription);
```

<span data-ttu-id="55381-136">Se nel manifesto dell'applicazione è presente un servizio predefinito, è possibile scegliere il modello **Exclusive Process** (Processo esclusivo) specificando l'attributo **ServicePackageActivationMode**, come mostrato di seguito:</span><span class="sxs-lookup"><span data-stu-id="55381-136">If you have a default service in your application manifest, you can choose **Exclusive Process** model by specifying **ServicePackageActivationMode** attribute as shown below:</span></span>

```xml
<DefaultServices>
  <Service Name="MyService" ServicePackageActivationMode="ExclusiveProcess">
    <StatelessService ServiceTypeName="MyServiceType" InstanceCount="1">
      <SingletonPartition/>
    </StatelessService>
  </Service>
</DefaultServices>
```
<span data-ttu-id="55381-137">Continuando con l'esempio precedente, viene ora creato un altro servizio **fabric:/App1/ServiceC** nell'applicazione **fabric:/App1** che ha 2 partizioni, **P6** & **P7**, e 3 repliche per partizione con **ServicePackageActivationMode** impostato su 'ExclusiveProcess'.</span><span class="sxs-lookup"><span data-stu-id="55381-137">Continuing with our example above, lets create another service **fabric:/App1/ServiceC** in application **fabric:/App1** which has 2 partitions (say **P6** & **P7**) and 3 replicas per partition with **ServicePackageActivationMode** set to 'ExclusiveProcess'.</span></span> <span data-ttu-id="55381-138">Il diagramma seguente mostra la nuova visualizzazione del nodo:</span><span class="sxs-lookup"><span data-stu-id="55381-138">Following diagram shows new view on the node:</span></span>

<span data-ttu-id="55381-139"><center>
![Visualizzazione del nodo dell'applicazione distribuita][node-view-four]
</center></span><span class="sxs-lookup"><span data-stu-id="55381-139"><center>
![Node view of deployed application][node-view-four]
</center></span></span>

<span data-ttu-id="55381-140">Come è possibile notare, Service Fabric ha attivato due nuove copie di 'MyServicePackage', una per ciascuna replica dalle partizioni **P6** & **P7**, e ha posizionato ciascuna replica nella relativa copia dedicata di *CodePackage*.</span><span class="sxs-lookup"><span data-stu-id="55381-140">As you can see, Service Fabric activated two new copies of 'MyServicePackage' (one for each replica from partition **P6** & **P7**) and placed each replica in its dedicated copy of *CodePackage*.</span></span> <span data-ttu-id="55381-141">Un altro aspetto da sottolineare e che, quando si usa il modello **Exclusive Process** (Processo esclusivo), per una determinata *applicazione* possono essere attive in un *Nodo* più copie di un *ServicePackage* specificato.</span><span class="sxs-lookup"><span data-stu-id="55381-141">Another thing to note here is, when **Exclusive Process** model is used, for a given *application*, multiple copies of a given *ServicePackage* can be active on a *Node*.</span></span> <span data-ttu-id="55381-142">Nell'esempio precedente è possibile notare che le tre copie di 'MyServicePackage' sono attive per **fabric:/App1**.</span><span class="sxs-lookup"><span data-stu-id="55381-142">In above example, we see that three copies of 'MyServicePackage' are active for **fabric:/App1**.</span></span> <span data-ttu-id="55381-143">A ciascuna di queste copie di 'MyServicePackage' è associato un **ServicePackageAtivationId** che identifica la copia all'interno dell'*applicazione* **fabric:/App1**.</span><span class="sxs-lookup"><span data-stu-id="55381-143">Each of these active copies of 'MyServicePackage' has a **ServicePackageAtivationId** associated with it which identifies that copy within *application* **fabric:/App1**.</span></span>

<span data-ttu-id="55381-144">Quando per un'*applicazione*, ad esempio **fabric:/App2** nell'esempio precedente, viene usato soltanto il modello **Processo condiviso**, è presente una sola copia attiva di *ServicePackage* su un *Nodo* e il **ServicePackageAtivationId** per questa attivazione di *ServicePackage* è 'empty string'.</span><span class="sxs-lookup"><span data-stu-id="55381-144">When only **Shared Process** model is used for an *application*, like **fabric:/App2** in above example, there is only one active copy of *ServicePackage* on a *Node* and **ServicePackageAtivationId** for this activation of *ServicePackage* is 'empty string'.</span></span>

> [!NOTE]
>- <span data-ttu-id="55381-145">Il modello di hosting **Processo condiviso** corrisponde a **ServicePackageAtivationMode** uguale a **SharedProcess**.</span><span class="sxs-lookup"><span data-stu-id="55381-145">**Shared Process** hosting model corresponds to **ServicePackageAtivationMode** equal **SharedProcess**.</span></span> <span data-ttu-id="55381-146">Si tratta del modello di hosting predefinito e non è necessario specificare il valore **ServicePackageAtivationMode** al momento della creazione del servizio.</span><span class="sxs-lookup"><span data-stu-id="55381-146">This is the default hosting model and **ServicePackageAtivationMode** need not be specified at the time of creating the service.</span></span>
>
>- <span data-ttu-id="55381-147">Il modello di hosting **Exclusive Process** (Processo esclusivo) corrisponde a **ServicePackageAtivationMode** uguale a **ExclusiveProcess** e deve essere specificato in modo esplicito al momento della creazione del servizio.</span><span class="sxs-lookup"><span data-stu-id="55381-147">**Exclusive Process** hosting model corresponds to **ServicePackageAtivationMode** equal **ExclusiveProcess** and need to be explicitly specified at the time of creating the service.</span></span> 
>
>- <span data-ttu-id="55381-148">Per conoscere il modello di hosting del servizio è possibile eseguire una query su [descrizione servizio][p2] e cercare il valore di **ServicePackageAtivationMode**.</span><span class="sxs-lookup"><span data-stu-id="55381-148">Hosting model of a service can be known by querying the [service description][p2] and looking at value of **ServicePackageAtivationMode**.</span></span>
>
>

## <a name="working-with-deployed-service-package"></a><span data-ttu-id="55381-149">Utilizzo del pacchetto del servizio distribuito</span><span class="sxs-lookup"><span data-stu-id="55381-149">Working with deployed service package</span></span>
<span data-ttu-id="55381-150">Una copia attiva di un *ServicePackage* su un nodo viene definita [pacchetto del servizio distribuito][p3].</span><span class="sxs-lookup"><span data-stu-id="55381-150">An active copy of a *ServicePackage* on a node is referred as [deployed service package][p3].</span></span> <span data-ttu-id="55381-151">Come illustrato in precedenza, quando per la creazione di servizi viene usato il modello **Exclusive Process** (Processo esclusivo), per una determinata *applicazione* possono essere presenti più pacchetti del servizio distribuiti per lo stesso *ServicePackage*.</span><span class="sxs-lookup"><span data-stu-id="55381-151">As previously mentioned above, when **Exclusive Process** model is used for creating services, for a given *application*, there could be multiple deployed service packages for the same *ServicePackage*.</span></span> <span data-ttu-id="55381-152">Durante l'esecuzione di operazioni specifiche del pacchetto del servizio distribuito, ad esempio la [creazione di report sull'integrità di un pacchetto del servizio distribuito][p4] o il [riavvio di un pacchetto di codice di un pacchetto del servizio distribuito][p5] e così via, per identificare uno specifico pacchetto del servizio distribuito è necessario specificare il **ServicePackageActivationId**.</span><span class="sxs-lookup"><span data-stu-id="55381-152">While performing operations specific to deployed service package like [reporting health of a deployed service package][p4] or [restarting code package of a deployed service package][p5] etc., **ServicePackageActivationId** needs to be provided to identify a specific deployed service package.</span></span>

 <span data-ttu-id="55381-153">È possibile ottenere il **ServicePackageActivationId** di un pacchetto del servizio distribuito eseguendo una query sull'elenco di [pacchetti del servizio distribuiti][p3] su un nodo.</span><span class="sxs-lookup"><span data-stu-id="55381-153">**ServicePackageActivationId** of a deployed service package can be obtained by querying the list of [deployed service packages][p3] on a node.</span></span> <span data-ttu-id="55381-154">Quando si eseguono query sui [tipi di servizi distribuiti][p6], le [repliche distribuite][p7] e i [pacchetti di codice distribuiti][p8] su un nodo, il risultato della query contiene anche il **ServicePackageActivationId** del pacchetto del servizio distribuito padre.</span><span class="sxs-lookup"><span data-stu-id="55381-154">When querying [deployed service types][p6], [deployed replicas][p7] and [deployed code packages][p8] on a node, the query result also contains the **ServicePackageActivationId** of parent deployed service package.</span></span>

> [!NOTE]
>- <span data-ttu-id="55381-155">In base al modello di hosting **Processo condiviso**, in un determinato *nodo* per un'*applicazione* specificata viene attivata una sola copia di un *ServicePackage*.</span><span class="sxs-lookup"><span data-stu-id="55381-155">Under **Shared Process** hosting model, on a given *node*, for a given *application*, only one copy of a *ServicePackage* is activated.</span></span> <span data-ttu-id="55381-156">Il **ServicePackageActivationId** di tale copia è uguale a *empty string* e non è necessario specificarlo quando si eseguono operazioni correlate al pacchetto del servizio distribuito.</span><span class="sxs-lookup"><span data-stu-id="55381-156">It has **ServicePackageActivationId** equal to *empty string* and need not be specified while performing deployed service package related operations.</span></span> 
>
> - <span data-ttu-id="55381-157">In base al modello di hosting **Exclusive Process** (Processo esclusivo), in un determinato *nodo* per un'*applicazione* specificata possono essere attive una o più copie di un *ServicePackage*.</span><span class="sxs-lookup"><span data-stu-id="55381-157">Under **Exclusive Process** hosting model, on a given *node*, for a given *application*, one or more copies of a *ServicePackage* can be active.</span></span> <span data-ttu-id="55381-158">Ciascuna attivazione ha un **ServicePackageActivationId** *non-empty*, che deve essere specificato quando si eseguono operazioni correlate al pacchetto del servizio distribuito.</span><span class="sxs-lookup"><span data-stu-id="55381-158">Each activation has a *non-empty* **ServicePackageActivationId** and needs to be specified while performing deployed service package related operations.</span></span> 
>
> - <span data-ttu-id="55381-159">Se il **ServicePackageActivationId** non viene specificato, viene usata l'impostazione predefinita 'empty string'.</span><span class="sxs-lookup"><span data-stu-id="55381-159">If **ServicePackageActivationId** is ommited it defaults to 'empty string'.</span></span> <span data-ttu-id="55381-160">Se è presente un pacchetto del servizio distribuito attivato in base al modello **Processo condiviso**, l'operazione verrà eseguita su tale pacchetto. In caso contrario, tale operazione avrà esito negativo.</span><span class="sxs-lookup"><span data-stu-id="55381-160">If a deployed service package that was activated under **Shared Process** model is present, then operation will be performed on it, otherwise the operation will fail.</span></span>
>
> - <span data-ttu-id="55381-161">Non è consigliabile eseguire una query e quindi memorizzare nella cache il **ServicePackageActivationId**. Questo infatti viene generato dinamicamente e può cambiare per diversi motivi.</span><span class="sxs-lookup"><span data-stu-id="55381-161">It is not recommended to query once and cache **ServicePackageActivationId** as it is dynamically generated and can change for various reasons.</span></span> <span data-ttu-id="55381-162">Prima di eseguire un'operazione che richiede il **ServicePackageActivationId**, è necessario eseguire una query sull'[elenco di pacchetti del servizio distribuiti][p3] su un nodo e quindi usare il *ServicePackageActivationId** del risultato della query per eseguire l'operazione originale.</span><span class="sxs-lookup"><span data-stu-id="55381-162">Before performing an operation that needs **ServicePackageActivationId**, you should first query the list of [deployed service packages][p3] on a node and then use *ServicePackageActivationId** from query result to perform the original operation.</span></span>
>
>

## <a name="guest-executable-and-container-applications"></a><span data-ttu-id="55381-163">Applicazioni eseguibili guest e contenitore</span><span class="sxs-lookup"><span data-stu-id="55381-163">Guest executable and container applications</span></span>
<span data-ttu-id="55381-164">Service Fabric tratta le applicazioni di tipo [eseguibile guest][a2] e [contenitore][a3] come servizi senza stato indipendenti. In altri termini, in *ServiceHost* non è presente alcun runtime di Service Fabric (processo o contenitore).</span><span class="sxs-lookup"><span data-stu-id="55381-164">Service Fabric treats [Guest executable][a2] and [container][a3] applications as statless services which are self-contained i.e. there is no Service Fabric runtime in *ServiceHost* (a process or container).</span></span> <span data-ttu-id="55381-165">Dal momento che si tratta di servizi indipendenti, il numero di repliche per *ServiceHost* non è applicabile.</span><span class="sxs-lookup"><span data-stu-id="55381-165">Since these services are self-contained, number of replicas per *ServiceHost* is not applicable for these services.</span></span> <span data-ttu-id="55381-166">La configurazione usata più comunemente con questi servizi è una partizione singola con [InstanceCount][c2] uguale a -1. In altri termini, su ciascun nodo del cluster è in esecuzione una copia del codice del servizio.</span><span class="sxs-lookup"><span data-stu-id="55381-166">The most common configuration used with these services is single-partition with [InstanceCount][c2] equal to -1 (i.e. one copy of the service code running on each node of cluster).</span></span> 

<span data-ttu-id="55381-167">Il valore **ServicePackageActivationMode** predefinito per questi servizi è **SharedProcess**: Service Fabric attiva una sola copia di *ServicePackage* su un *Nodo* per una determinata *applicazione*. Questo significa che una sola copia del codice del servizio sarà in esecuzione su un *Nodo*.</span><span class="sxs-lookup"><span data-stu-id="55381-167">The default **ServicePackageActivationMode** for these services is **SharedProcess** in which case Service Fabric only activates one copy of *ServicePackage* on a *Node* for a given *application* which means only one copy of service code will run a *Node*.</span></span> <span data-ttu-id="55381-168">Se quando si creano più servizi (da *Service1* a *ServiceN*) di *ServiceType* (specificato in *ServiceManifest*) si vuole che su un *Nodo* vengano eseguite più copie del codice del servizio oppure, se il servizio ha più partizioni, al momento della creazione del servizio è necessario specificare **ServicePackageActivationMode** come **ExclusiveProcess**.</span><span class="sxs-lookup"><span data-stu-id="55381-168">If you want multiple copies of your service code to run on a *Node* when you create multiple services (*Service1* to *ServiceN*) of *ServiceType* (specified in *ServiceManifest*) or when your service is multi-partitioned, you should specify **ServicePackageActivationMode** as **ExclusiveProcess** at the time of creating the service.</span></span>

## <a name="changing-hosting-model-of-an-existing-service"></a><span data-ttu-id="55381-169">Modifica del modello di hosting di un servizio esistente</span><span class="sxs-lookup"><span data-stu-id="55381-169">Changing hosting model of an existing service</span></span>
<span data-ttu-id="55381-170">La modifica del modello di hosting di un servizio esistente da **Processo condiviso** a **Exclusive Process** (Processo esclusivo) e viceversa tramite un meccanismo di aggiornamento (o una specifica predefinita del servizio nel manifesto dell'applicazione) non è attualmente supportata.</span><span class="sxs-lookup"><span data-stu-id="55381-170">Changing hosting model of an existing service from **Shared Process** to **Exclusive Process** and vice-versa through upgrade or update mechanism (or in default service specification in application manifest) is currently not supported.</span></span> <span data-ttu-id="55381-171">Il supporto per questa funzionalità è previsto per una versione futura.</span><span class="sxs-lookup"><span data-stu-id="55381-171">Support for this feature will come in future versions.</span></span>

## <a name="choosing-between-shared-process-and-exclusive-process-model"></a><span data-ttu-id="55381-172">Scelta tra i modelli Processo condiviso ed Exclusive Process (Processo esclusivo)</span><span class="sxs-lookup"><span data-stu-id="55381-172">Choosing between shared process and exclusive process model</span></span>
<span data-ttu-id="55381-173">Entrambi questi modelli di hosting presentano vantaggi e svantaggi e gli utenti devono scegliere quello più adatto alle specifiche esigenze.</span><span class="sxs-lookup"><span data-stu-id="55381-173">Both these hosting models have its pros and cons and user needs to evaluate which one fits their requirements best.</span></span> <span data-ttu-id="55381-174">Il modello **Processo condiviso** consente un migliore utilizzo delle risorse del sistema operativo in quanto viene generato un numero minore di processi, più repliche all'interno dello stesso processo possono condividere le porte e così via. Se, tuttavia, una delle repliche genera un errore per cui l'host del servizio deve essere arrestato, tale errore avrà un impatto negativo su tutte le altre repliche nello stesso processo.</span><span class="sxs-lookup"><span data-stu-id="55381-174">**Shared Process** model enables better utilization of OS resources because fewer processes are spawned, multiple replicas in the same process can share ports, etc. However, if one of the replicas hits an error where it needs to bring down the service host, it will impact all other replicas in same process.</span></span>

 <span data-ttu-id="55381-175">Il modello **Exclusive Process** (Processo esclusivo) offre un migliore isolamento con ciascuna replica in un proprio processo e un errore di una replica non avrà conseguenze sulle altre repliche.</span><span class="sxs-lookup"><span data-stu-id="55381-175">**Exclusive Process** model provides better isolation with every replica in its own process and a misbehaving replica will not impact other replicas.</span></span> <span data-ttu-id="55381-176">Questo risulta utile nei casi in cui la condivisione delle porte non è supportata dal protocollo di comunicazione.</span><span class="sxs-lookup"><span data-stu-id="55381-176">It comes in handy for cases where port sharing is not supported by the communication protocol.</span></span> <span data-ttu-id="55381-177">Rende inoltre più semplice l'applicazione della governance delle risorse a livello di replica.</span><span class="sxs-lookup"><span data-stu-id="55381-177">It facilitates the ability to apply resource governance at replica level.</span></span> <span data-ttu-id="55381-178">D'altra parte, il modello**Exclusive Process** (Processo esclusivo) utilizza una maggiore quantità di risorse del sistema operativo e genera un processo per ciascuna replica sul nodo.</span><span class="sxs-lookup"><span data-stu-id="55381-178">On the other hand, **Exclusive Process** will consume more OS resources as it spawns one process for each replica on the node.</span></span>

## <a name="exclusive-process-model-and-application-model-considerations"></a><span data-ttu-id="55381-179">Considerazioni sul modello Exclusive Process (Processo esclusivo) e sul modello dell'applicazione</span><span class="sxs-lookup"><span data-stu-id="55381-179">Exclusive process model and application model considerations</span></span>
<span data-ttu-id="55381-180">Il metodo consigliato per modellare l'applicazione in Service Fabric consiste nel mantenere un *ServiceType* per *ServicePackage*. Questo modello offre buoni risultati per la maggior parte delle applicazioni.</span><span class="sxs-lookup"><span data-stu-id="55381-180">The recommended way to model your application in Service Fabric is to keep one *ServiceType* per *ServicePackage* and this model works well for most of the applications.</span></span> 

<span data-ttu-id="55381-181">Tuttavia, per abilitare scenari speciali in cui non è opportuno avere un *ServiceType* per *ServicePackage*, Service Fabric consente di avere più di un *ServiceType* per *ServicePackage*. Un *CodePackage*, inoltre, può registrare più di un *ServiceType*.</span><span class="sxs-lookup"><span data-stu-id="55381-181">However, to enable special scenarios where one *ServiceType* per *ServicePackage* may not be desirable, functionally, Service Fabric allows to have more than one *ServiceType* per *ServicePackage* (and one *CodePackage* can register more than one *ServiceType*).</span></span> <span data-ttu-id="55381-182">Di seguito sono descritti alcuni scenari in cui queste configurazioni possono essere utili:</span><span class="sxs-lookup"><span data-stu-id="55381-182">Following are some of the scenarios where these configurations can be useful:</span></span>

- <span data-ttu-id="55381-183">Si desidera ottimizzare l'utilizzo delle risorse del sistema operativo generando un minor numero di processi e aumentando la densità di replica per processo.</span><span class="sxs-lookup"><span data-stu-id="55381-183">You want to optimize OS resource utilization by spawning fewer processes and having higher replica density per process.</span></span>
- <span data-ttu-id="55381-184">Le repliche da diversi ServiceType devono condividere alcuni dati comuni caratterizzati da un alto costo di inizializzazione o memoria.</span><span class="sxs-lookup"><span data-stu-id="55381-184">Replicas from different ServiceTypes need to share some common data that has a high initialization or memory cost.</span></span>
- <span data-ttu-id="55381-185">Si usa una versione gratuita di un servizio e si vuole limitare l'utilizzo delle risorse inserendo tutte le repliche del servizio nello stesso processo.</span><span class="sxs-lookup"><span data-stu-id="55381-185">You have a free service offering and you want to put a limit on resource utilization by putting all replicas of the service in same process.</span></span>

<span data-ttu-id="55381-186">Il modello di hosting **Exclusive Process** (Processo esclusivo) non è coerente con il modello dell'applicazione con più *ServiceType* per *ServicePackage*.</span><span class="sxs-lookup"><span data-stu-id="55381-186">**Exclusive Process** hosting model is not coherent with application model having multiple *ServiceTypes* per *ServicePackage*.</span></span> <span data-ttu-id="55381-187">Questo si verifica perché la configurazione con più *ServiceType* per *ServicePackage* è progettata per ottenere una maggiore condivisione delle risorse e consentire un aumento della densità di replica per processo.</span><span class="sxs-lookup"><span data-stu-id="55381-187">This is because multiple *ServiceTypes* per *ServicePackage* is designed to achieve higher resource sharing among replicas and enables higher replica density per process.</span></span> <span data-ttu-id="55381-188">Si tratta dell'opposto del risultato per cui è stato progettato il modello **Exclusive Process** (Processo esclusivo).</span><span class="sxs-lookup"><span data-stu-id="55381-188">This is contrary to what **Exclusive Process** model is designed to achieve.</span></span>

<span data-ttu-id="55381-189">Si consideri il caso di più *ServiceType* per *ServicePackage* con un diverso *CodePackage* che registra ciascun *ServiceType*.</span><span class="sxs-lookup"><span data-stu-id="55381-189">Consider the case of multiple *ServiceTypes* per *ServicePackage* with different *CodePackage* registering each *ServiceType*.</span></span> <span data-ttu-id="55381-190">Si supponga di avere un *ServicePackage* 'MultiTypeServicePackge' con due *CodePackage*:</span><span class="sxs-lookup"><span data-stu-id="55381-190">Let's say we have a *ServicePackage* 'MultiTypeServicePackge' which has two *CodePackages*:</span></span>

- <span data-ttu-id="55381-191">'MyCodePackageA', che registra il *ServiceType* 'MyServiceTypeA'.</span><span class="sxs-lookup"><span data-stu-id="55381-191">'MyCodePackageA' which registers *ServiceType* 'MyServiceTypeA'.</span></span>
- <span data-ttu-id="55381-192">'MyCodePackageB', che registra il *ServiceType* 'MyServiceTypeB'.</span><span class="sxs-lookup"><span data-stu-id="55381-192">'MyCodePackageB' which registers *ServiceType* 'MyServiceTypeB'.</span></span>

<span data-ttu-id="55381-193">A questo punto viene creata un'*applicazione* **fabric:/SpecialApp**. All'interno di **fabric:/SpecialApp** vengono quindi creati i due servizi seguenti con il modello **Exclusive Process** (Processo esclusivo):</span><span class="sxs-lookup"><span data-stu-id="55381-193">Now, lets say, we create an *application* **fabric:/SpecialApp** and inside **fabric:/SpecialApp** we create following two services with **Exclusive Process** model:</span></span>

- <span data-ttu-id="55381-194">Servizio **fabric:/SpecialApp/ServiceA** di tipo 'MyServiceTypeA' con due partizioni, **P1** e **P2**, e 3 repliche per partizione.</span><span class="sxs-lookup"><span data-stu-id="55381-194">Service **fabric:/SpecialApp/ServiceA** of type 'MyServiceTypeA' with two partitions (say **P1** and **P2**) and 3 replicas per partition.</span></span>
- <span data-ttu-id="55381-195">Servizio **fabric:/SpecialApp/ServiceB** di tipo 'MyServiceTypeB' con due partizioni, **P3** e **P4**, e 3 repliche per partizione.</span><span class="sxs-lookup"><span data-stu-id="55381-195">Service **fabric:/SpecialApp/ServiceB** of type 'MyServiceTypeB' with two partitions (say **P3** and **P4**) and 3 replicas per partition.</span></span>

<span data-ttu-id="55381-196">Su un determinato nodo, i servizi avranno due repliche ciascuno.</span><span class="sxs-lookup"><span data-stu-id="55381-196">On a given node, both the services will have two replicas each.</span></span> <span data-ttu-id="55381-197">Poiché per creare i servizi è stato usato il modello **Exclusive Process** (Processo esclusivo), Service Fabric attiverà una copia di 'MyServicePackge' per ogni replica.</span><span class="sxs-lookup"><span data-stu-id="55381-197">Since we used **Exclusive Process** model to create the services, Service Fabric will activate a new copy of 'MyServicePackge' for each replica.</span></span> <span data-ttu-id="55381-198">Ogni attivazione di 'MultiTypeServicePackge' avvierà una copia di 'MyCodePackageA' e 'MyCodePackageB'.</span><span class="sxs-lookup"><span data-stu-id="55381-198">Each activation of 'MultiTypeServicePackge' will start a copy of 'MyCodePackageA' and 'MyCodePackageB'.</span></span> <span data-ttu-id="55381-199">Tuttavia, solo uno tra 'MyCodePackageA' e 'MyCodePackageB' ospiterà la replica per la quale è stato attivato 'MultiTypeServicePackge'.</span><span class="sxs-lookup"><span data-stu-id="55381-199">However, only one of 'MyCodePackageA' or 'MyCodePackageB' will host the replica for which 'MultiTypeServicePackge' was activated.</span></span> <span data-ttu-id="55381-200">Il diagramma seguente mostra la visualizzazione del nodo:</span><span class="sxs-lookup"><span data-stu-id="55381-200">Following diagram shows the node view:</span></span>

<span data-ttu-id="55381-201"><center>
![Visualizzazione del nodo dell'applicazione distribuita][node-view-five]
</center></span><span class="sxs-lookup"><span data-stu-id="55381-201"><center>
![Node view of deployed application][node-view-five]
</center></span></span>

 <span data-ttu-id="55381-202">Come si può notare, nell'attivazione di 'MultiTypeServicePackge' per la replica della partizione **P1** del servizio **fabric:/SpecialApp/ServiceA**, 'MyCodePackageA' ospita la replica mentre 'MyCodePackageB' è semplicemente in esecuzione.</span><span class="sxs-lookup"><span data-stu-id="55381-202">As we can see, in the activation of 'MultiTypeServicePackge' for replica of partition **P1** of service **fabric:/SpecialApp/ServiceA**, 'MyCodePackageA' is hosting the replica and 'MyCodePackageB' is just up and running.</span></span> <span data-ttu-id="55381-203">Analogamente, nell'attivazione di 'MultiTypeServicePackge' per la replica della partizione **P3** del servizio **fabric:/SpecialApp/ServiceB**, 'MyCodePackageB' ospita la replica mentre 'MyCodePackageA' è semplicemente in esecuzione.</span><span class="sxs-lookup"><span data-stu-id="55381-203">Similarly, in activation of 'MultiTypeServicePackge' for replica of partition **P3** of service **fabric:/SpecialApp/ServiceB**, 'MyCodePackageB' is hosting the replica and 'MyCodePackageA' is just up and running and so on.</span></span> <span data-ttu-id="55381-204">Di conseguenza, più alto è il numero di *CodePackage* (che registrano *ServiceType* differenti) per *ServicePackage*, più elevato sarà l'utilizzo ridondante delle risorse.</span><span class="sxs-lookup"><span data-stu-id="55381-204">Hence, more the number of *CodePackages* (registering different *ServiceTypes*) per *ServicePackage*, higher will be redundant resource usage.</span></span> 
 
 <span data-ttu-id="55381-205">D'altra parte, se si creano i servizi **fabric:/SpecialApp/ServiceA** e **fabric:/SpecialApp/ServiceB** con il modello **Processo condiviso**, Service Fabric attiverà soltanto una copia di 'MultiTypeServicePackge' per l'*applicazione* **fabric:/SpecialApp** (come mostrato in precedenza).</span><span class="sxs-lookup"><span data-stu-id="55381-205">On the other hand if we create services **fabric:/SpecialApp/ServiceA** and **fabric:/SpecialApp/ServiceB** with **Shared Process** model, Service Fabric will activate only one copy of 'MultiTypeServicePackge' for *application* **fabric:/SpecialApp** (as we saw previously).</span></span> <span data-ttu-id="55381-206">'MyCodePackageA' ospiterà tutte le repliche del servizio **fabric:/SpecialApp/ServiceA** (o, per maggiore precisione, di qualsiasi servizio di tipo 'MyServiceTypeA') e 'MyCodePackageB' ospiterà tutte le repliche del servizio **fabric:/SpecialApp/ServiceB** (o, per maggiore precisione, di qualsiasi servizio di tipo 'MyServiceTypeB').</span><span class="sxs-lookup"><span data-stu-id="55381-206">'MyCodePackageA' will host all replicas for service **fabric:/SpecialApp/ServiceA** (or of any service of type 'MyServiceTypeA' to be more precise) and 'MyCodePackageB' will host all replicas for service **fabric:/SpecialApp/ServiceB** (or of any service of type 'MyServiceTypeB' to be more precise).</span></span> <span data-ttu-id="55381-207">Il diagramma seguente mostra la visualizzazione del nodo in questa impostazione:</span><span class="sxs-lookup"><span data-stu-id="55381-207">Following diagram shows the node view in this setting:</span></span> 

<span data-ttu-id="55381-208"><center>
![Visualizzazione del nodo dell'applicazione distribuita][node-view-six]
</center></span><span class="sxs-lookup"><span data-stu-id="55381-208"><center>
![Node view of deployed application][node-view-six]
</center></span></span>

<span data-ttu-id="55381-209">Nell'esempio precedente, si potrebbe pensare che, se 'MyCodePackageA' registra sia 'MyServiceTypeA' che 'MyServiceTypeB' e non è presente alcun 'MyCodePackageB', non sarà in esecuzione alcun *CodePackage* ridondante.</span><span class="sxs-lookup"><span data-stu-id="55381-209">In the above example, you might think if 'MyCodePackageA' registers both 'MyServiceTypeA' and 'MyServiceTypeB' and there is no 'MyCodePackageB', then there will be no redundant *CodePackage* running.</span></span> <span data-ttu-id="55381-210">Si tratta di una considerazione corretta, ma, come indicato in precedenza, questo modello di applicazione non è coerente con il modello di hosting **Exclusive Process** (Processo esclusivo).</span><span class="sxs-lookup"><span data-stu-id="55381-210">This is correct, however, as mentioned previously, this application model does not align with **Exclusive Process** hosting model.</span></span> <span data-ttu-id="55381-211">Se l'obiettivo consiste nell'inserire ogni replica in un proprio processo dedicato, la registrazione di entrambi i *ServiceType* da parte dello stesso *CodePackage* non è necessaria e l'inserimento di ciascun *ServiceType* nel proprio *ServicePacakge* è una scelta più naturale.</span><span class="sxs-lookup"><span data-stu-id="55381-211">If goal is to put each replica in its own dedicated process then registering both *ServiceTypes* from same *CodePackage* is not needed and putting each *ServiceType* in its own *ServicePacakge* is a more natural choice.</span></span>

## <a name="next-steps"></a><span data-ttu-id="55381-212">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="55381-212">Next steps</span></span>
<span data-ttu-id="55381-213">[Creare il pacchetto di un'applicazione][a4] e prepararlo per la distribuzione.</span><span class="sxs-lookup"><span data-stu-id="55381-213">[Package an application][a4] and get it ready to deploy.</span></span>

<span data-ttu-id="55381-214">[Distribuire e rimuovere applicazioni con PowerShell][a5]: descrive come usare PowerShell per gestire le istanze dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="55381-214">[Deploy and remove applications][a5] describes how to use PowerShell to manage application instances.</span></span>

<!--Image references-->
[node-view-one]: ./media/service-fabric-hosting-model/node-view-one.png
[node-view-two]: ./media/service-fabric-hosting-model/node-view-two.png
[node-view-three]: ./media/service-fabric-hosting-model/node-view-three.png
[node-view-four]: ./media/service-fabric-hosting-model/node-view-four.png
[node-view-five]: ./media/service-fabric-hosting-model/node-view-five.png
[node-view-six]: ./media/service-fabric-hosting-model/node-view-six.png

<!--Link references--In actual articles, you only need a single period before the slash-->
[a1]: service-fabric-application-model.md
[a2]: service-fabric-deploy-existing-app.md
[a3]: service-fabric-containers-overview.md
[a4]: service-fabric-package-apps.md
[a5]: service-fabric-deploy-remove-applications.md

[r1]: https://docs.microsoft.com/rest/api/servicefabric/sfclient-api-createservice

[c1]: https://docs.microsoft.com/dotnet/api/system.fabric.fabricclient.servicemanagementclient.createserviceasync
[c2]: https://docs.microsoft.com/dotnet/api/system.fabric.description.statelessservicedescription.instancecount

[p1]: https://docs.microsoft.com/powershell/servicefabric/vlatest/new-servicefabricservice
[p2]: https://docs.microsoft.com/powershell/servicefabric/vlatest/get-servicefabricservicedescription
[p3]: https://docs.microsoft.com/powershell/servicefabric/vlatest/get-servicefabricdeployedservicePackage
[p4]: https://docs.microsoft.com/powershell/servicefabric/vlatest/send-servicefabricdeployedservicepackagehealthreport
[p5]: https://docs.microsoft.com/powershell/servicefabric/vlatest/restart-servicefabricdeployedcodepackage
[p6]: https://docs.microsoft.com/powershell/servicefabric/vlatest/get-servicefabricdeployedservicetype
[p7]: https://docs.microsoft.com/powershell/servicefabric/vlatest/get-servicefabricdeployedreplica
[p8]: https://docs.microsoft.com/powershell/servicefabric/vlatest/get-servicefabricdeployedcodepackage