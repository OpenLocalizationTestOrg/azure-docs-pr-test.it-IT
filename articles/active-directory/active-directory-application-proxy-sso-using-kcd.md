---
title: Single Sign-On con il proxy di applicazione | Documentazione Microsoft
description: Descrive come fornire accesso Single Sign-On mediante il proxy di applicazione di Azure AD.
services: active-directory
documentationcenter: 
author: kgremban
manager: femila
ms.assetid: ded0d9c9-45f6-47d7-bd0f-3f7fd99ab621
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/25/2017
ms.author: kgremban
ms.reviewer: harshja
ms.custom: H1Hack27Feb2017, it-pro
ms.openlocfilehash: 149af1f68e574f78127a9c2de8a0e79ed8774d29
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/18/2017
---
# <a name="kerberos-constrained-delegation-for-single-sign-on-to-your-apps-with-application-proxy"></a><span data-ttu-id="62045-103">Delega vincolata Kerberos per l'accesso Single Sign-On alle app con il proxy di applicazione</span><span class="sxs-lookup"><span data-stu-id="62045-103">Kerberos Constrained Delegation for single sign-on to your apps with Application Proxy</span></span>

<span data-ttu-id="62045-104">È possibile fornire l'accesso single sign-on per le applicazioni locali pubblicate mediante il proxy di applicazione che sono protette con l'autenticazione integrata di Windows.</span><span class="sxs-lookup"><span data-stu-id="62045-104">You can provide single sign-on for on-premises applications published through Application Proxy that are secured with Integrated Windows Authentication.</span></span> <span data-ttu-id="62045-105">Queste applicazioni richiedono un ticket Kerberos per l'accesso.</span><span class="sxs-lookup"><span data-stu-id="62045-105">These applications require a Kerberos ticket for access.</span></span> <span data-ttu-id="62045-106">Il proxy di applicazione usa la delega vincolata Kerberos (KCD) per supportare queste applicazioni.</span><span class="sxs-lookup"><span data-stu-id="62045-106">Application Proxy uses Kerberos Constrained Delegation (KCD) to support these applications.</span></span> 

<span data-ttu-id="62045-107">È possibile abilitare l'accesso Single Sign-On alle applicazioni tramite l'autenticazione integrata di Windows (IWA) concedendo ai connettori proxy dell'applicazione l'autorizzazione per rappresentare gli utenti in Active Directory.</span><span class="sxs-lookup"><span data-stu-id="62045-107">You can enable single sign-on to your applications using Integrated Windows Authentication (IWA) by giving Application Proxy connectors permission in Active Directory to impersonate users.</span></span> <span data-ttu-id="62045-108">I connettori usano questa autorizzazione per inviare e ricevere token per loro conto.</span><span class="sxs-lookup"><span data-stu-id="62045-108">The connectors use this permission to send and receive tokens on their behalf.</span></span>

## <a name="how-single-sign-on-with-kcd-works"></a><span data-ttu-id="62045-109">Funzionamento di Single Sign-On con KCD</span><span class="sxs-lookup"><span data-stu-id="62045-109">How single sign-on with KCD works</span></span>
<span data-ttu-id="62045-110">Questo diagramma illustra il flusso quando un utente tenta di accedere a un'applicazione locale che usa l'autenticazione integrata di Windows.</span><span class="sxs-lookup"><span data-stu-id="62045-110">This diagram explains the flow when a user attempts to access an on-prem application that uses IWA.</span></span>

![Diagramma del flusso di autenticazione di Microsoft AAD](./media/active-directory-application-proxy-sso-using-kcd/AuthDiagram.png)

1. <span data-ttu-id="62045-112">L'utente immette l'URL per accedere all'applicazione locale tramite il proxy di applicazione.</span><span class="sxs-lookup"><span data-stu-id="62045-112">The user enters the URL to access the on-prem application through Application Proxy.</span></span>
2. <span data-ttu-id="62045-113">Il proxy di applicazione reindirizza la richiesta ai servizi di autenticazione di Azure AD per la preautenticazione.</span><span class="sxs-lookup"><span data-stu-id="62045-113">Application Proxy redirects the request to Azure AD authentication services to preauthenticate.</span></span> <span data-ttu-id="62045-114">A questo punto, Azure AD applica gli eventuali criteri di autenticazione e autorizzazione appropriati, ad esempio l'autenticazione a più fattori.</span><span class="sxs-lookup"><span data-stu-id="62045-114">At this point, Azure AD applies any applicable authentication and authorization policies, such as multifactor authentication.</span></span> <span data-ttu-id="62045-115">Se l'utente viene convalidato, Azure AD crea un token e lo invia all'utente.</span><span class="sxs-lookup"><span data-stu-id="62045-115">If the user is validated, Azure AD creates a token and sends it to the user.</span></span>
3. <span data-ttu-id="62045-116">L'utente passa il token al proxy di applicazione.</span><span class="sxs-lookup"><span data-stu-id="62045-116">The user passes the token to Application Proxy.</span></span>
4. <span data-ttu-id="62045-117">Il proxy di applicazione convalida il token e recupera il nome dell'entità utente (UPN) da esso e invia la richiesta, il nome dell'entità utente e il nome dell'entità servizio (SPN) al connettore tramite un canale sicuro con doppia autenticazione.</span><span class="sxs-lookup"><span data-stu-id="62045-117">Application Proxy validates the token and retrieves the User Principal Name (UPN) from it, and then sends the request, the UPN, and the Service Principal Name (SPN) to the Connector through a dually authenticated secure channel.</span></span>
5. <span data-ttu-id="62045-118">Il connettore esegue la negoziazione della delega vincolata Kerberos con l'istanza di Active Directory locale, rappresentando l'utente per ottenere un token Kerberos per l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="62045-118">The Connector performs Kerberos Constrained Delegation (KCD) negotiation with the on-prem AD, impersonating the user to get a Kerberos token to the application.</span></span>
6. <span data-ttu-id="62045-119">Active Directory invia il token Kerberos per l'applicazione al connettore.</span><span class="sxs-lookup"><span data-stu-id="62045-119">Active Directory sends the Kerberos token for the application to the Connector.</span></span>
7. <span data-ttu-id="62045-120">Il connettore invia la richiesta originale al server dell'applicazione, usando il token Kerberos ricevuto da Active Directory.</span><span class="sxs-lookup"><span data-stu-id="62045-120">The Connector sends the original request to the application server, using the Kerberos token it received from AD.</span></span>
8. <span data-ttu-id="62045-121">L'applicazione invia la risposta al connettore, che viene quindi restituita al servizio proxy di applicazione e infine all'utente.</span><span class="sxs-lookup"><span data-stu-id="62045-121">The application sends the response to the Connector, which is then returned to the Application Proxy service and finally to the user.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="62045-122">Prerequisiti</span><span class="sxs-lookup"><span data-stu-id="62045-122">Prerequisites</span></span>
<span data-ttu-id="62045-123">Prima di iniziare a usare SSO per le applicazioni IWA, verificare che l'ambiente sia pronto con le impostazioni e configurazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="62045-123">Before you get started with single sign-on for IWA applications, make sure your environment is ready with the following settings and configurations:</span></span>

* <span data-ttu-id="62045-124">Le app, ad esempio le app Web SharePoint, devono essere impostate per usare l'autenticazione integrata di Windows.</span><span class="sxs-lookup"><span data-stu-id="62045-124">Your apps, like SharePoint Web apps, are set to use Integrated Windows Authentication.</span></span> <span data-ttu-id="62045-125">Per altre informazioni, vedere [Attivare il supporto per l'autenticazione Kerberos](https://technet.microsoft.com/library/dd759186.aspx). Per SharePoint, vedere [Pianificare l'autenticazione Kerberos in SharePoint 2013](https://technet.microsoft.com/library/ee806870.aspx).</span><span class="sxs-lookup"><span data-stu-id="62045-125">For more information, see [Enable Support for Kerberos Authentication](https://technet.microsoft.com/library/dd759186.aspx), or for SharePoint see [Plan for Kerberos authentication in SharePoint 2013](https://technet.microsoft.com/library/ee806870.aspx).</span></span>
* <span data-ttu-id="62045-126">Tutte le app devono avere [nomi delle entità servizio](https://social.technet.microsoft.com/wiki/contents/articles/717.service-principal-names-spns-setspn-syntax-setspn-exe.aspx).</span><span class="sxs-lookup"><span data-stu-id="62045-126">All your apps have [Service Principal Names](https://social.technet.microsoft.com/wiki/contents/articles/717.service-principal-names-spns-setspn-syntax-setspn-exe.aspx).</span></span>
* <span data-ttu-id="62045-127">Il server che esegue il connettore e il server che esegue l'app devono essere aggiunti a un dominio e appartenere allo stesso dominio o a domini trusting.</span><span class="sxs-lookup"><span data-stu-id="62045-127">The server running the Connector and the server running the app are domain joined and part of the same domain or trusting domains.</span></span> <span data-ttu-id="62045-128">Per altre informazioni sull'aggiunta a un dominio, vedere [Aggiungere un computer a un dominio](https://technet.microsoft.com/library/dd807102.aspx).</span><span class="sxs-lookup"><span data-stu-id="62045-128">For more information on domain join, see [Join a Computer to a Domain](https://technet.microsoft.com/library/dd807102.aspx).</span></span>
* <span data-ttu-id="62045-129">Il server che esegue il connettore deve avere accesso in lettura all'attributo TokenGroupsGlobalAndUniversal per gli utenti.</span><span class="sxs-lookup"><span data-stu-id="62045-129">The server running the Connector has access to read the TokenGroupsGlobalAndUniversal attribute for users.</span></span> <span data-ttu-id="62045-130">Questa impostazione predefinita potrebbe essere interessata dalla protezione avanzata dell'ambiente.</span><span class="sxs-lookup"><span data-stu-id="62045-130">This default setting might have been impacted by security hardening the environment.</span></span>

### <a name="configure-active-directory"></a><span data-ttu-id="62045-131">Configurare Active Directory</span><span class="sxs-lookup"><span data-stu-id="62045-131">Configure Active Directory</span></span>
<span data-ttu-id="62045-132">La configurazione di Active Directory varia a seconda del fatto che il connettore proxy di applicazione e il server dell'applicazione si trovino nello stesso dominio o meno.</span><span class="sxs-lookup"><span data-stu-id="62045-132">The Active Directory configuration varies, depending on whether your Application Proxy connector and the application server are in the same domain or not.</span></span>

#### <a name="connector-and-application-server-in-the-same-domain"></a><span data-ttu-id="62045-133">Connettore e server applicazione nello stesso dominio</span><span class="sxs-lookup"><span data-stu-id="62045-133">Connector and application server in the same domain</span></span>
1. <span data-ttu-id="62045-134">In Active Directory passare a **Strumenti** > **Utenti e computer**.</span><span class="sxs-lookup"><span data-stu-id="62045-134">In Active Directory, go to **Tools** > **Users and Computers**.</span></span>
2. <span data-ttu-id="62045-135">Selezionare il server che esegue il connettore.</span><span class="sxs-lookup"><span data-stu-id="62045-135">Select the server running the connector.</span></span>
3. <span data-ttu-id="62045-136">Fare clic con il pulsante destro del mouse su **Proprietà** > **Delega**.</span><span class="sxs-lookup"><span data-stu-id="62045-136">Right-click and select **Properties** > **Delegation**.</span></span>
4. <span data-ttu-id="62045-137">Selezionare **Computer attendibile per la delega solo ai servizi specificati**.</span><span class="sxs-lookup"><span data-stu-id="62045-137">Select **Trust this computer for delegation to specified services only**.</span></span> 
5. <span data-ttu-id="62045-138">In **Servizi ai quali l'account può presentare credenziali delegate** aggiungere il valore per l'identità SPN del server applicazioni.</span><span class="sxs-lookup"><span data-stu-id="62045-138">Under **Services to which this account can present delegated credentials** add the value for the SPN identity of the application server.</span></span> <span data-ttu-id="62045-139">In questo modo il connettore proxy di applicazione può rappresentare gli utenti in AD nei confronti delle applicazioni definite nell'elenco.</span><span class="sxs-lookup"><span data-stu-id="62045-139">This enables the Application Proxy Connector to impersonate users in AD against the applications defined in the list.</span></span>

   ![Schermata della finestra delle proprietà per Connector-SVR](./media/active-directory-application-proxy-sso-using-kcd/Properties.jpg)

#### <a name="connector-and-application-server-in-different-domains"></a><span data-ttu-id="62045-141">Connettore e server applicazione in domini differenti</span><span class="sxs-lookup"><span data-stu-id="62045-141">Connector and application server in different domains</span></span>
1. <span data-ttu-id="62045-142">Per un elenco dei prerequisiti necessari per usare la delega vincolata Kerberos tra domini, vedere [Delega vincolata Kerberos tra domini](https://technet.microsoft.com/library/hh831477.aspx).</span><span class="sxs-lookup"><span data-stu-id="62045-142">For a list of prerequisites for working with KCD across domains, see [Kerberos Constrained Delegation across domains](https://technet.microsoft.com/library/hh831477.aspx).</span></span>
2. <span data-ttu-id="62045-143">Usare la proprietà `principalsallowedtodelegateto` sul server del connettore per fare in modo che il proxy di applicazione deleghi per il server del connettore.</span><span class="sxs-lookup"><span data-stu-id="62045-143">Use the `principalsallowedtodelegateto` property on the Connector server to enable the Application Proxy to delegate for the Connector server.</span></span> <span data-ttu-id="62045-144">Il server dell'applicazione è `sharepointserviceaccount` e il server delegante è `connectormachineaccount`.</span><span class="sxs-lookup"><span data-stu-id="62045-144">The application server is `sharepointserviceaccount` and the delegating server is `connectormachineaccount`.</span></span> <span data-ttu-id="62045-145">Per Windows 2012 R2, usare questo codice come esempio:</span><span class="sxs-lookup"><span data-stu-id="62045-145">For Windows 2012 R2, use this code as an example:</span></span>

        $connector= Get-ADComputer -Identity connectormachineaccount -server dc.connectordomain.com

        Set-ADComputer -Identity sharepointserviceaccount -PrincipalsAllowedToDelegateToAccount $connector

        Get-ADComputer sharepointserviceaccount -Properties PrincipalsAllowedToDelegateToAccount

<span data-ttu-id="62045-146">Sharepointserviceaccount può essere l'account del computer SPS o un account del servizio tramite cui è in esecuzione il pool di app SPS.</span><span class="sxs-lookup"><span data-stu-id="62045-146">Sharepointserviceaccount can be the SPS machine account or a service account under which the SPS app pool is running.</span></span>

## <a name="configure-single-sign-on"></a><span data-ttu-id="62045-147">Configura accesso Single Sign-On</span><span class="sxs-lookup"><span data-stu-id="62045-147">Configure single sign-on</span></span> 
1. <span data-ttu-id="62045-148">Pubblicare l'applicazione seguendo le istruzioni contenute in [Pubblicare le applicazioni con il proxy di applicazione](application-proxy-publish-azure-portal.md).</span><span class="sxs-lookup"><span data-stu-id="62045-148">Publish your application according to the instructions described in [Publish applications with Application Proxy](application-proxy-publish-azure-portal.md).</span></span> <span data-ttu-id="62045-149">Assicurarsi di selezionare **Azure Active Directory** come **Metodo di autenticazione preliminare**.</span><span class="sxs-lookup"><span data-stu-id="62045-149">Make sure to select **Azure Active Directory** as the **Preauthentication Method**.</span></span>
2. <span data-ttu-id="62045-150">Quando l'applicazione viene visualizzata nell'elenco delle applicazioni aziendali, selezionarla e fare clic su **Single Sign-On**.</span><span class="sxs-lookup"><span data-stu-id="62045-150">After your application appears in the list of enterprise applications, select it and click **Single sign-on**.</span></span>
3. <span data-ttu-id="62045-151">Impostare la modalità Single Sign-On su **Autenticazione integrata di Windows**.</span><span class="sxs-lookup"><span data-stu-id="62045-151">Set the single sign-on mode to **Integrated Windows Authentication**.</span></span>  
4. <span data-ttu-id="62045-152">Immettere l’ **SPN dell'applicazione interna** del server dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="62045-152">Enter the **Internal Application SPN** of the application server.</span></span> <span data-ttu-id="62045-153">In questo esempio l'SPN per l'applicazione pubblicata è http/www.contoso.com. Questo nome SPN deve essere nell'elenco dei servizi a cui il connettore può presentare credenziali delegate.</span><span class="sxs-lookup"><span data-stu-id="62045-153">In this example, the SPN for our published application is http/www.contoso.com. This SPN needs to be in the list of services to which the connector can present delegated credentials.</span></span> 
5. <span data-ttu-id="62045-154">Scegliere l'**identità di accesso delegato** che il connettore userà per conto degli utenti.</span><span class="sxs-lookup"><span data-stu-id="62045-154">Choose the **Delegated Login Identity** for the connector to use on behalf of your users.</span></span> <span data-ttu-id="62045-155">Per altre informazioni, vedere [Utilizzo dell'accesso Single Sign-On quando le identità cloud e locali non sono identiche](#Working-with-different-on-premises-and-cloud-identities)</span><span class="sxs-lookup"><span data-stu-id="62045-155">For more information, see [Working with different on-premises and cloud identities](#Working-with-different-on-premises-and-cloud-identities)</span></span>

   ![Configurazione avanzata dell'applicazione](./media/active-directory-application-proxy-sso-using-kcd/cwap_auth2.png)  


## <a name="sso-for-non-windows-apps"></a><span data-ttu-id="62045-157">Accesso Single Sign-On per app non Windows</span><span class="sxs-lookup"><span data-stu-id="62045-157">SSO for non-Windows apps</span></span>
<span data-ttu-id="62045-158">Il flusso di delega Kerberos nel proxy di applicazione di Azure AD inizia quando Azure AD autentica l'utente nel cloud.</span><span class="sxs-lookup"><span data-stu-id="62045-158">The Kerberos delegation flow in Azure AD Application Proxy starts when Azure AD authenticates the user in the cloud.</span></span> <span data-ttu-id="62045-159">Quando la richiesta arriva in locale, il connettore del proxy dell'applicazione di Azure AD rilascia un ticket Kerberos per conto dell'utente tramite l'interazione con Active Directory locale.</span><span class="sxs-lookup"><span data-stu-id="62045-159">Once the request arrives on-premises, the Azure AD Application Proxy connector issues a Kerberos ticket on behalf of the user by interacting with the local Active Directory.</span></span> <span data-ttu-id="62045-160">Questo processo è definito come delega vincolata Kerberos.</span><span class="sxs-lookup"><span data-stu-id="62045-160">This process is referred to as Kerberos Constrained Delegation (KCD).</span></span> <span data-ttu-id="62045-161">Nella fase successiva, viene inviata una richiesta all'applicazione back-end con il ticket Kerberos.</span><span class="sxs-lookup"><span data-stu-id="62045-161">In the next phase, a request is sent to the backend application with this Kerberos ticket.</span></span> <span data-ttu-id="62045-162">Esistono vari protocolli che definiscono la modalità di invio di tali richieste.</span><span class="sxs-lookup"><span data-stu-id="62045-162">There are several protocols that define how to send such requests.</span></span> <span data-ttu-id="62045-163">La maggior parte dei server non Windows prevede l'uso del protocollo Negotiate/SPNego, al momento supportato nel proxy di applicazione di Azure AD.</span><span class="sxs-lookup"><span data-stu-id="62045-163">Most non-Windows servers expect Negotiate/SPNego that is now supported on Azure AD Application Proxy.</span></span>

<span data-ttu-id="62045-164">Per altre informazioni su Kerberos, vedere [All you want to know about Kerberos Constrained Delegation (KCD)](https://blogs.technet.microsoft.com/applicationproxyblog/2015/09/21/all-you-want-to-know-about-kerberos-constrained-delegation-kcd) (Tutto quello che si desidera sapere sulla delega vincolata Kerberos (KCD)).</span><span class="sxs-lookup"><span data-stu-id="62045-164">For more information about Kerberos, see [All you want to know about Kerberos Constrained Delegation (KCD)](https://blogs.technet.microsoft.com/applicationproxyblog/2015/09/21/all-you-want-to-know-about-kerberos-constrained-delegation-kcd).</span></span>

<span data-ttu-id="62045-165">Le app non Windows usano generalmente nomi utente o nomi account SAM invece di indirizzi e-mail di dominio.</span><span class="sxs-lookup"><span data-stu-id="62045-165">Non-Windows apps typically user usernames or SAM account names instead of domain email addresses.</span></span> <span data-ttu-id="62045-166">Se questa situazione si applica alle applicazioni, è necessario configurare il campo dell'identità di accesso delegata in modo che connetta le identità del cloud alle identità delle applicazioni.</span><span class="sxs-lookup"><span data-stu-id="62045-166">If that situation applies to your applications, you need to configure the delegated login identity field to connect your cloud identities to your application identities.</span></span> 

## <a name="working-with-different-on-premises-and-cloud-identities"></a><span data-ttu-id="62045-167">Utilizzo dell'accesso Single Sign-On quando le identità cloud e locali non sono identiche</span><span class="sxs-lookup"><span data-stu-id="62045-167">Working with different on-premises and cloud identities</span></span>
<span data-ttu-id="62045-168">Il proxy di applicazione presuppone che gli utenti dispongano della stessa identità nel cloud e in locale.</span><span class="sxs-lookup"><span data-stu-id="62045-168">Application Proxy assumes that users have exactly the same identity in the cloud and on-premises.</span></span> <span data-ttu-id="62045-169">Se non è questo il caso, è comunque possibile usare la delega vincolata Kerberos per Single Sign-On.</span><span class="sxs-lookup"><span data-stu-id="62045-169">If that's not the case, you can can still use KCD for single sign-on.</span></span> <span data-ttu-id="62045-170">Configurare un'**identità di accesso delegata** per ogni applicazione in modo da specificare le identità da usare durante l'esecuzione del Single Sign-On.</span><span class="sxs-lookup"><span data-stu-id="62045-170">Configure a **Delegated login identity** for each application to specify which identity should be used when performing single sign-on.</span></span>  

<span data-ttu-id="62045-171">Questa funzionalità consente a molte organizzazioni con diverse identità locali e cloud di disporre dell'accesso Single Sign-On dal cloud ad applicazioni locali senza richiedere agli utenti di immettere nomi utente e password diversi.</span><span class="sxs-lookup"><span data-stu-id="62045-171">This capability allows many organizations that have different on-premises and cloud identities to have SSO from the cloud to on-premises apps without requiring the users to enter different usernames and passwords.</span></span> <span data-ttu-id="62045-172">Sono incluse organizzazioni che:</span><span class="sxs-lookup"><span data-stu-id="62045-172">This includes organizations that:</span></span>

* <span data-ttu-id="62045-173">Hanno più domini internamente (joe@us.contoso.com, joe@eu.contoso.com) e un singolo dominio nel cloud (joe@contoso.com).</span><span class="sxs-lookup"><span data-stu-id="62045-173">Have multiple domains internally (joe@us.contoso.com, joe@eu.contoso.com) and a single domain in the cloud (joe@contoso.com).</span></span>
* <span data-ttu-id="62045-174">Hanno un nome di dominio non instradabile internamente (joe@contoso.usa) e un dominio valido nel cloud.</span><span class="sxs-lookup"><span data-stu-id="62045-174">Have non-routable domain name internally (joe@contoso.usa) and a legal one in the cloud.</span></span>
* <span data-ttu-id="62045-175">Non usano nomi di dominio internamente (joe).</span><span class="sxs-lookup"><span data-stu-id="62045-175">Do not use domain names internally (joe)</span></span>
* <span data-ttu-id="62045-176">Usano diversi alias locali e nel cloud.</span><span class="sxs-lookup"><span data-stu-id="62045-176">Use different aliases on-prem and in the cloud.</span></span> <span data-ttu-id="62045-177">Ad esempio, joe-johns@contoso.com e joej@contoso.com</span><span class="sxs-lookup"><span data-stu-id="62045-177">For example, joe-johns@contoso.com vs. joej@contoso.com</span></span>  

<span data-ttu-id="62045-178">Con il proxy di applicazione è possibile selezionare l'identità da usare per ottenere il ticket Kerberos.</span><span class="sxs-lookup"><span data-stu-id="62045-178">With Application Proxy, you can select which identity to use to obtain the Kerberos ticket.</span></span> <span data-ttu-id="62045-179">Questa impostazione viene configurata per ogni applicazione.</span><span class="sxs-lookup"><span data-stu-id="62045-179">This setting is per application.</span></span> <span data-ttu-id="62045-180">Alcune di queste opzioni sono appropriate per i sistemi che non accettano il formato di indirizzo di posta elettronica, altre sono concepite per l'accesso alternativo.</span><span class="sxs-lookup"><span data-stu-id="62045-180">Some of these options are suitable for systems that do not accept email address format, others are designed for alternative login.</span></span>

![Schermata del parametro dell'identità di accesso delegata](./media/active-directory-application-proxy-sso-using-kcd/app_proxy_sso_diff_id_upn.png)

<span data-ttu-id="62045-182">Se si usa l'identità di accesso delegata, il valore potrebbe non essere univoco per tutti i domini o tutte le foreste dell'organizzazione.</span><span class="sxs-lookup"><span data-stu-id="62045-182">If delegated login identity is used, the value might not be unique across all the domains or forests in your organization.</span></span> <span data-ttu-id="62045-183">Per evitare questo problema, pubblicare queste applicazioni due volte usando due gruppi di connettori diversi.</span><span class="sxs-lookup"><span data-stu-id="62045-183">You can avoid this issue by publishing these applications twice using two different Connector groups.</span></span> <span data-ttu-id="62045-184">Poiché ogni applicazione dispone di un pubblico di utenti diversi, è possibile unire i connettori a un altro dominio.</span><span class="sxs-lookup"><span data-stu-id="62045-184">Since each application has a different user audience, you can join its Connectors to a different domain.</span></span>

### <a name="configure-sso-for-different-identities"></a><span data-ttu-id="62045-185">Configurare Single Sign-On per diverse identità</span><span class="sxs-lookup"><span data-stu-id="62045-185">Configure SSO for different identities</span></span>
1. <span data-ttu-id="62045-186">Configurare le impostazioni di Azure AD Connect in modo che l'identità principale sia l'indirizzo di posta elettronica (mail).</span><span class="sxs-lookup"><span data-stu-id="62045-186">Configure Azure AD Connect settings so the main identity is the email address (mail).</span></span> <span data-ttu-id="62045-187">Ciò avviene come parte del processo di personalizzazione, modificando il campo **Nome dell'entità utente** nelle impostazioni di sincronizzazione.</span><span class="sxs-lookup"><span data-stu-id="62045-187">This is done as part of the customize process, by changing the **User Principal Name** field in the sync settings.</span></span> <span data-ttu-id="62045-188">Queste impostazioni determinano inoltre il modo in cui gli utenti accedono a Office 365, dispositivi Windows 10 e altre applicazioni che usano Azure AD come archivio di identità.</span><span class="sxs-lookup"><span data-stu-id="62045-188">These settings also determine how users log in to Office365, Windows10 devices, and other applications that use Azure AD as their identity store.</span></span>  
   <span data-ttu-id="62045-189">![Schermata di identificazione degli utenti - Elenco a discesa Nome dell'entità utente](./media/active-directory-application-proxy-sso-using-kcd/app_proxy_sso_diff_id_connect_settings.png)</span><span class="sxs-lookup"><span data-stu-id="62045-189">![Identifying users screenshot - User Principal Name dropdown](./media/active-directory-application-proxy-sso-using-kcd/app_proxy_sso_diff_id_connect_settings.png)</span></span>  
2. <span data-ttu-id="62045-190">Nelle impostazioni di configurazione dell'applicazione che si desidera modificare, selezionare l' **Identità di accesso delegata** da usare:</span><span class="sxs-lookup"><span data-stu-id="62045-190">In the Application Configuration settings for the application you would like to modify, select the **Delegated Login Identity** to be used:</span></span>

   * <span data-ttu-id="62045-191">Nome dell'entità utente (ad esempio joe@contoso.com)</span><span class="sxs-lookup"><span data-stu-id="62045-191">User Principal Name (for example, joe@contoso.com)</span></span>
   * <span data-ttu-id="62045-192">Nome alternativo dell'entità utente (ad esempio joed@contoso.local)</span><span class="sxs-lookup"><span data-stu-id="62045-192">Alternate User Principal Name (for example, joed@contoso.local)</span></span>
   * <span data-ttu-id="62045-193">Parte del nome utente del nome dell'entità utente (ad esempio joe)</span><span class="sxs-lookup"><span data-stu-id="62045-193">Username part of User Principal Name (for example, joe)</span></span>
   * <span data-ttu-id="62045-194">Parte del nome utente del nome alternativo dell'entità utente (ad esempio joe)</span><span class="sxs-lookup"><span data-stu-id="62045-194">Username part of Alternate User Principal Name (for example, joed)</span></span>
   * <span data-ttu-id="62045-195">Nome account SAM locale: in base alla configurazione del controller di dominio locale</span><span class="sxs-lookup"><span data-stu-id="62045-195">On-premises SAM account name (depends on the domain controller configuration)</span></span>

### <a name="troubleshooting-sso-for-different-identities"></a><span data-ttu-id="62045-196">Risoluzione dei problemi di accesso Single Sign-On per diverse identità</span><span class="sxs-lookup"><span data-stu-id="62045-196">Troubleshooting SSO for different identities</span></span>
<span data-ttu-id="62045-197">Se si verifica un errore nel processo di accesso Single Sign-On, l'errore viene visualizzato nel log eventi del computer connettore, come illustrato in [Risoluzione dei problemi](application-proxy-back-end-kerberos-constrained-delegation-how-to.md).</span><span class="sxs-lookup"><span data-stu-id="62045-197">If there is an error in the SSO process, it appears in the connector machine event log as explained in [Troubleshooting](application-proxy-back-end-kerberos-constrained-delegation-how-to.md).</span></span>
<span data-ttu-id="62045-198">In alcuni casi, tuttavia, la richiesta viene inviata correttamente all'applicazione back-end mentre l'applicazione risponde in numerose altre risposte HTTP.</span><span class="sxs-lookup"><span data-stu-id="62045-198">But, in some cases, the request is successfully sent to the backend application while this application replies in various other HTTP responses.</span></span> <span data-ttu-id="62045-199">Per la risoluzione di problemi di questo tipo, è consigliabile iniziare esaminando il numero di eventi 24029 sul computer connettore nel registro eventi di sessione del proxy di applicazione.</span><span class="sxs-lookup"><span data-stu-id="62045-199">Troubleshooting these cases should start by examining event number 24029 on the connector machine in the Application Proxy session event log.</span></span> <span data-ttu-id="62045-200">L'identità utente usata per la delega viene visualizzata nel campo "utente" dei dettagli dell'evento.</span><span class="sxs-lookup"><span data-stu-id="62045-200">The user identity that was used for delegation appears in the “user” field within the event details.</span></span> <span data-ttu-id="62045-201">Per attivare il log della sessione, scegliere **Visualizza registri analitici e di debug** dal menu di visualizzazione del Visualizzatore eventi.</span><span class="sxs-lookup"><span data-stu-id="62045-201">To turn on session log, select **Show analytic and debug logs** in the event viewer view menu.</span></span>

## <a name="next-steps"></a><span data-ttu-id="62045-202">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="62045-202">Next steps</span></span>

* [<span data-ttu-id="62045-203">Come configurare un'applicazione proxy di applicazione per l'uso della delega vincolata Kerberos</span><span class="sxs-lookup"><span data-stu-id="62045-203">How to configure an Application Proxy application to use Kerberos Constrained Delegation</span></span>](application-proxy-back-end-kerberos-constrained-delegation-how-to.md)
* [<span data-ttu-id="62045-204">Risolvere i problemi che si verificano con il proxy di applicazione</span><span class="sxs-lookup"><span data-stu-id="62045-204">Troubleshoot issues you're having with Application Proxy</span></span>](active-directory-application-proxy-troubleshoot.md)


<span data-ttu-id="62045-205">Per le notizie e gli aggiornamenti più recenti, vedere [Application Proxy blog](http://blogs.technet.com/b/applicationproxyblog/)</span><span class="sxs-lookup"><span data-stu-id="62045-205">For the latest news and updates, check out the [Application Proxy blog](http://blogs.technet.com/b/applicationproxyblog/)</span></span>

