---
title: Scenari di autenticazione per Azure AD | Documentazione Microsoft
description: "Panoramica dei cinque più comuni scenari di autenticazione per Azure Active Directory (AAD)"
services: active-directory
documentationcenter: dev-center-name
author: skwan
manager: mbaldwin
editor: 
ms.assetid: 0c84e7d0-16aa-4897-82f2-f53c6c990fd9
ms.service: active-directory
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: identity
ms.date: 04/27/2017
ms.author: skwan
ms.custom: aaddev
ms.openlocfilehash: 2f9410bdaa037f1839cf7c12c3532b51be669ed5
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/18/2017
---
# <a name="authentication-scenarios-for-azure-ad"></a><span data-ttu-id="97b2d-103">Scenari di autenticazione per Azure AD</span><span class="sxs-lookup"><span data-stu-id="97b2d-103">Authentication Scenarios for Azure AD</span></span>
<span data-ttu-id="97b2d-104">Azure Active Directory (AD) semplifica l'autenticazione per gli sviluppatori fornendo le identità come servizio, con il supporto per protocolli standard del settore come OAuth 2.0 e OpenID Connect, nonché librerie open source per diverse piattaforme che permettono di iniziare rapidamente a creare codice.</span><span class="sxs-lookup"><span data-stu-id="97b2d-104">Azure Active Directory (Azure AD) simplifies authentication for developers by providing identity as a service, with support for industry-standard protocols such as OAuth 2.0 and OpenID Connect, as well as open source libraries for different platforms to help you start coding quickly.</span></span> <span data-ttu-id="97b2d-105">Questo documento include informazioni utili per comprendere i diversi scenari supportati da Azure AD, oltre a illustrare come iniziare.</span><span class="sxs-lookup"><span data-stu-id="97b2d-105">This document will help you understand the various scenarios Azure AD supports and will show you how to get started.</span></span> <span data-ttu-id="97b2d-106">Il documento è suddiviso nelle sezioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="97b2d-106">It’s divided into the following sections:</span></span>

* [<span data-ttu-id="97b2d-107">Nozioni di base sull'autenticazione in Azure AD.</span><span class="sxs-lookup"><span data-stu-id="97b2d-107">Basics of Authentication in Azure AD</span></span>](#basics-of-authentication-in-azure-ad)
* [<span data-ttu-id="97b2d-108">Attestazioni nei token di sicurezza di Azure AD</span><span class="sxs-lookup"><span data-stu-id="97b2d-108">Claims in Azure AD Security Tokens</span></span>](#claims-in-azure-ad-security-tokens)
* [<span data-ttu-id="97b2d-109">Nozioni di base sulla registrazione di un'applicazione in Azure AD</span><span class="sxs-lookup"><span data-stu-id="97b2d-109">Basics of Registering an Application in Azure AD</span></span>](#basics-of-registering-an-application-in-azure-ad)
* [<span data-ttu-id="97b2d-110">Scenari e tipi di applicazione</span><span class="sxs-lookup"><span data-stu-id="97b2d-110">Application Types and Scenarios</span></span>](#application-types-and-scenarios)
  
  * [<span data-ttu-id="97b2d-111">Da Web browser ad applicazione Web</span><span class="sxs-lookup"><span data-stu-id="97b2d-111">Web Browser to Web Application</span></span>](#web-browser-to-web-application)
  * [<span data-ttu-id="97b2d-112">Applicazione a singola pagina (SPA)</span><span class="sxs-lookup"><span data-stu-id="97b2d-112">Single Page Application (SPA)</span></span>](#single-page-application-spa)
  * [<span data-ttu-id="97b2d-113">Da applicazione nativa ad API Web</span><span class="sxs-lookup"><span data-stu-id="97b2d-113">Native Application to Web API</span></span>](#native-application-to-web-api)
  * [<span data-ttu-id="97b2d-114">Da applicazione Web ad API Web</span><span class="sxs-lookup"><span data-stu-id="97b2d-114">Web Application to Web API</span></span>](#web-application-to-web-api)
  * [<span data-ttu-id="97b2d-115">Da daemon o applicazione server ad API Web</span><span class="sxs-lookup"><span data-stu-id="97b2d-115">Daemon or Server Application to Web API</span></span>](#daemon-or-server-application-to-web-api)

## <a name="basics-of-authentication-in-azure-ad"></a><span data-ttu-id="97b2d-116">Nozioni di base sull'autenticazione in Azure AD.</span><span class="sxs-lookup"><span data-stu-id="97b2d-116">Basics of Authentication in Azure AD</span></span>
<span data-ttu-id="97b2d-117">Se non si ha familiarità con i concetti di base dell'autenticazione in Azure AD, leggere questa sezione.</span><span class="sxs-lookup"><span data-stu-id="97b2d-117">If you are unfamiliar with basic concepts of authentication in Azure AD, read this section.</span></span> <span data-ttu-id="97b2d-118">In caso contrario, è possibile passare alla sezione [Scenari e tipi di applicazione](#application-types-and-scenarios).</span><span class="sxs-lookup"><span data-stu-id="97b2d-118">Otherwise, you may want to skip down to [Application Types and Scenarios](#application-types-and-scenarios).</span></span>

<span data-ttu-id="97b2d-119">Si consideri lo scenario più semplice in cui è necessaria l'identità: un utente deve eseguire l'autenticazione a un'applicazione Web da un Web browser.</span><span class="sxs-lookup"><span data-stu-id="97b2d-119">Let’s consider the most basic scenario where identity is required: a user in a web browser needs to authenticate to a web application.</span></span> <span data-ttu-id="97b2d-120">Questo scenario è descritto più dettagliatamente nella sezione [Da Web browser ad applicazione Web](#web-browser-to-web-application) , ma è un punto di partenza utile per illustrare le funzionalità di Azure AD e definire i concetti relativi al funzionamento dello scenario.</span><span class="sxs-lookup"><span data-stu-id="97b2d-120">This scenario is described in greater detail in the [Web Browser to Web Application](#web-browser-to-web-application) section, but it’s a useful starting point to illustrate the capabilities of Azure AD and conceptualize how the scenario works.</span></span> <span data-ttu-id="97b2d-121">Per questo scenario considerare il diagramma seguente:</span><span class="sxs-lookup"><span data-stu-id="97b2d-121">Consider the following diagram for this scenario:</span></span>

![Panoramica dell'accesso all'applicazione Web](./media/active-directory-authentication-scenarios/basics_of_auth_in_aad.png)

<span data-ttu-id="97b2d-123">Tenendo presente il diagramma riportato sopra, ecco cosa occorre sapere sui vari componenti:</span><span class="sxs-lookup"><span data-stu-id="97b2d-123">With the diagram above in mind, here’s what you need to know about its various components:</span></span>

* <span data-ttu-id="97b2d-124">Azure AD è il provider di identità, che si occupa della verifica dell'identità degli utenti e delle applicazioni presenti in una directory aziendale e infine rilascia i token di sicurezza, se l'autenticazione di tali utenti e applicazioni riesce.</span><span class="sxs-lookup"><span data-stu-id="97b2d-124">Azure AD is the identity provider, responsible for verifying the identity of users and applications that exist in an organization’s directory, and ultimately issuing security tokens upon successful authentication of those users and applications.</span></span>
* <span data-ttu-id="97b2d-125">Un'applicazione per la quale è previsto l'outsourcing dell'autenticazione ad Azure AD deve essere registrata in Azure AD, che registra e identifica in modo univoco l'app nella directory.</span><span class="sxs-lookup"><span data-stu-id="97b2d-125">An application that wants to outsource authentication to Azure AD must be registered in Azure AD, which registers and uniquely identifies the app in the directory.</span></span>
* <span data-ttu-id="97b2d-126">Gli sviluppatori possono usare le librerie di autenticazione open source di Azure AD per semplificare l'autenticazione gestendo direttamente i dettagli del protocollo.</span><span class="sxs-lookup"><span data-stu-id="97b2d-126">Developers can use the open source Azure AD authentication libraries to make authentication easy by handling the protocol details for you.</span></span> <span data-ttu-id="97b2d-127">Per altre informazioni, vedere [Librerie di autenticazione di Azure Active Directory](active-directory-authentication-libraries.md) .</span><span class="sxs-lookup"><span data-stu-id="97b2d-127">See [Azure Active Directory Authentication Libraries](active-directory-authentication-libraries.md) for more information.</span></span>

<span data-ttu-id="97b2d-128">• Dopo l'autenticazione di un utente, l'applicazione deve convalidare il token di sicurezza dell'utente per verificare che per l'autenticazione le parti previste sia riuscita.</span><span class="sxs-lookup"><span data-stu-id="97b2d-128">• Once a user has been authenticated, the application must validate the user’s security token to ensure that authentication was successful for the intended parties.</span></span> <span data-ttu-id="97b2d-129">Gli sviluppatori possono usare le librerie di autenticazione fornite per gestire la convalida dei token da Azure AD, inclusi i token Web JSON (JWT) o SAML 2.0.</span><span class="sxs-lookup"><span data-stu-id="97b2d-129">Developers can use the provided authentication libraries to handle validation of any token from Azure AD, including JSON Web Tokens (JWT) or SAML 2.0.</span></span> <span data-ttu-id="97b2d-130">Per eseguire manualmente la convalida, vedere la documentazione relativa al [Gestore dei token JWT](https://msdn.microsoft.com/library/dn205065.aspx) .</span><span class="sxs-lookup"><span data-stu-id="97b2d-130">If you want to perform validation manually, see the [JWT Token Handler](https://msdn.microsoft.com/library/dn205065.aspx) documentation.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="97b2d-131">Azure AD usa la crittografia a chiave pubblica per firmare i token e verificarne la validità.</span><span class="sxs-lookup"><span data-stu-id="97b2d-131">Azure AD uses public key cryptography to sign tokens and verify that they are valid.</span></span> <span data-ttu-id="97b2d-132">Per altre informazioni sulla logica richiesta nell'applicazione per assicurare che sia sempre aggiornata con le chiavi più recenti, vedere [Informazioni importanti sul rollover della chiave di firma in Azure AD](active-directory-signing-key-rollover.md) .</span><span class="sxs-lookup"><span data-stu-id="97b2d-132">See [Important Information About Signing Key Rollover in Azure AD](active-directory-signing-key-rollover.md) for more information on the necessary logic you must have in your application to ensure it’s always updated with the latest keys.</span></span>
> 
> 

<span data-ttu-id="97b2d-133">• Il flusso di richieste e risposte per il processo di autenticazione dipende dal protocollo di autenticazione in uso, ad esempio OAuth 2.0, OpenID Connect, WS-Federation o SAML 2.0.</span><span class="sxs-lookup"><span data-stu-id="97b2d-133">• The flow of requests and responses for the authentication process is determined by the authentication protocol that was used, such as OAuth 2.0, OpenID Connect, WS-Federation, or SAML 2.0.</span></span> <span data-ttu-id="97b2d-134">Questi protocolli sono descritti in dettaglio nell'argomento [Protocolli di autenticazione di Azure Active Directory](active-directory-authentication-protocols.md) e nelle sezioni successive.</span><span class="sxs-lookup"><span data-stu-id="97b2d-134">These protocols are discussed in more detail in the [Azure Active Directory Authentication Protocols](active-directory-authentication-protocols.md) topic and in the sections below.</span></span>

> [!NOTE]
> <span data-ttu-id="97b2d-135">Azure AD supporta gli standard OAuth 2.0 e OpenID Connect che fanno un uso intensivo dei token di connessione, inclusi quelli rappresentati come JWT</span><span class="sxs-lookup"><span data-stu-id="97b2d-135">Azure AD supports the OAuth 2.0 and OpenID Connect standards that make extensive use of bearer tokens, including bearer tokens represented as JWTs.</span></span> <span data-ttu-id="97b2d-136">Un token di connessione è un token di sicurezza leggero che consente al "portatore" di accedere a una risorsa protetta.</span><span class="sxs-lookup"><span data-stu-id="97b2d-136">A bearer token is a lightweight security token that grants the “bearer” access to a protected resource.</span></span> <span data-ttu-id="97b2d-137">In questo senso, per "portatore" si intende qualsiasi parte che sia in grado di presentare il token.</span><span class="sxs-lookup"><span data-stu-id="97b2d-137">In this sense, the “bearer” is any party that can present the token.</span></span> <span data-ttu-id="97b2d-138">Anche se il rilascio del token di connessione è condizionato dal completamento del processo di autenticazione in Azure AD, se non vengono adottate le misure necessarie per proteggere il token durante la trasmissione e l'archiviazione, è possibile che venga intercettato e usato da parti non autorizzate.</span><span class="sxs-lookup"><span data-stu-id="97b2d-138">Though a party must first authenticate with Azure AD to receive the bearer token, if the required steps are not taken to secure the token in transmission and storage, it can be intercepted and used by an unintended party.</span></span> <span data-ttu-id="97b2d-139">Molti token di sicurezza hanno meccanismi integrati per prevenire l'uso non autorizzato, ma i token di connessione ne sono sprovvisti e devono essere trasportati su un canale protetto, ad esempio Transport Layer Security (HTTPS).</span><span class="sxs-lookup"><span data-stu-id="97b2d-139">While some security tokens have a built-in mechanism for preventing unauthorized parties from using them, bearer tokens do not have this mechanism and must be transported in a secure channel such as transport layer security (HTTPS).</span></span> <span data-ttu-id="97b2d-140">Se un token di connessione viene trasmesso senza essere protetto, un utente malintenzionato potrebbe usare un attacco "man in the middle" per acquisire il token e usarlo per l'accesso non autorizzato a una risorsa protetta.</span><span class="sxs-lookup"><span data-stu-id="97b2d-140">If a bearer token is transmitted in the clear, a man-in the middle attack can be used by a malicious party to acquire the token and use it for an unauthorized access to a protected resource.</span></span> <span data-ttu-id="97b2d-141">Gli stessi principi di sicurezza si applicano quando un token di connessione viene archiviato o memorizzato nella cache per un uso futuro.</span><span class="sxs-lookup"><span data-stu-id="97b2d-141">The same security principles apply when storing or caching bearer tokens for later use.</span></span> <span data-ttu-id="97b2d-142">Assicurarsi sempre che l'applicazione trasmetta ed archivi i token di connessione in modo sicuro.</span><span class="sxs-lookup"><span data-stu-id="97b2d-142">Always ensure that your application transmits and stores bearer tokens in a secure manner.</span></span> <span data-ttu-id="97b2d-143">Per altre considerazioni sulla sicurezza dei token di connessione, vedere la [sezione 5 della specifica RFC 6750](http://tools.ietf.org/html/rfc6750).</span><span class="sxs-lookup"><span data-stu-id="97b2d-143">For more security considerations on bearer tokens, see [RFC 6750 Section 5](http://tools.ietf.org/html/rfc6750).</span></span>
> 
> 

<span data-ttu-id="97b2d-144">Dopo avere delineato i concetti di base, è possibile passare alle sezioni seguenti per comprendere il funzionamento del provisioning in Azure AD e gli scenari comuni supportati da Azure AD.</span><span class="sxs-lookup"><span data-stu-id="97b2d-144">Now that you have an overview of the basics, read the sections below to understand how provisioning works in Azure AD and the common scenarios Azure AD supports.</span></span>

## <a name="claims-in-azure-ad-security-tokens"></a><span data-ttu-id="97b2d-145">Attestazioni nei token di sicurezza di Azure AD</span><span class="sxs-lookup"><span data-stu-id="97b2d-145">Claims in Azure AD Security Tokens</span></span>
<span data-ttu-id="97b2d-146">I token di sicurezza emessi da Azure AD contengono attestazioni o asserzioni di informazioni sull'oggetto autenticato.</span><span class="sxs-lookup"><span data-stu-id="97b2d-146">Security tokens issued by Azure AD contain claims, or assertions of information about the subject that has been authenticated.</span></span> <span data-ttu-id="97b2d-147">L'applicazione può usare tali attestazioni per varie attività.</span><span class="sxs-lookup"><span data-stu-id="97b2d-147">These claims can be used by the application for various tasks.</span></span> <span data-ttu-id="97b2d-148">Ad esempio, possono essere usate per convalidare il token, identificare il tenant di directory dell'oggetto, visualizzare informazioni relative all'utente, determinare l'autorizzazione dell'oggetto e così via.</span><span class="sxs-lookup"><span data-stu-id="97b2d-148">For example, they can be used to validate the token, identify the subject's directory tenant, display user information, determine the subject's authorization, and so on.</span></span> <span data-ttu-id="97b2d-149">Le attestazioni presenti in un determinato token di sicurezza dipendono dal tipo di token, dal tipo di credenziali usate per autenticare l'utente e dalla configurazione dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="97b2d-149">The claims present in any given security token are dependent upon the type of token, the type of credential used to authenticate the user, and the application configuration.</span></span> <span data-ttu-id="97b2d-150">La tabella seguente fornisce una breve descrizione dei tipi di attestazione generati da Azure AD.</span><span class="sxs-lookup"><span data-stu-id="97b2d-150">A brief description of each type of claim emitted by Azure AD is provided in the table below.</span></span> <span data-ttu-id="97b2d-151">Per altre informazioni, fare riferimento a [Token e tipi di attestazioni supportati](active-directory-token-and-claims.md).</span><span class="sxs-lookup"><span data-stu-id="97b2d-151">For more information, refer to [Supported Token and Claim Types](active-directory-token-and-claims.md).</span></span>

| <span data-ttu-id="97b2d-152">Attestazione</span><span class="sxs-lookup"><span data-stu-id="97b2d-152">Claim</span></span> | <span data-ttu-id="97b2d-153">Descrizione</span><span class="sxs-lookup"><span data-stu-id="97b2d-153">Description</span></span> |
| --- | --- |
| <span data-ttu-id="97b2d-154">ID applicazione</span><span class="sxs-lookup"><span data-stu-id="97b2d-154">Application ID</span></span> |<span data-ttu-id="97b2d-155">Identifica l'applicazione che usa il token.</span><span class="sxs-lookup"><span data-stu-id="97b2d-155">Identifies the application that is using the token.</span></span> |
| <span data-ttu-id="97b2d-156">Destinatari</span><span class="sxs-lookup"><span data-stu-id="97b2d-156">Audience</span></span> |<span data-ttu-id="97b2d-157">Identifica la risorsa di destinazione del token.</span><span class="sxs-lookup"><span data-stu-id="97b2d-157">Identifies the recipient resource the token is intended for.</span></span> |
| <span data-ttu-id="97b2d-158">Riferimento alla classe contesto di autenticazione applicazione</span><span class="sxs-lookup"><span data-stu-id="97b2d-158">Application Authentication Context Class Reference</span></span> |<span data-ttu-id="97b2d-159">Indica la modalità di autenticazione del client (client pubblico e client riservato).</span><span class="sxs-lookup"><span data-stu-id="97b2d-159">Indicates how the client was authenticated (public client vs. confidential client).</span></span> |
| <span data-ttu-id="97b2d-160">Istante di autenticazione</span><span class="sxs-lookup"><span data-stu-id="97b2d-160">Authentication Instant</span></span> |<span data-ttu-id="97b2d-161">Registra la data e l'ora in cui è avvenuta l'autenticazione.</span><span class="sxs-lookup"><span data-stu-id="97b2d-161">Records the date and time when the authentication occurred.</span></span> |
| <span data-ttu-id="97b2d-162">Metodo di autenticazione</span><span class="sxs-lookup"><span data-stu-id="97b2d-162">Authentication Method</span></span> |<span data-ttu-id="97b2d-163">Indica la modalità di autenticazione dell'oggetto del token (password, certificato e così via).</span><span class="sxs-lookup"><span data-stu-id="97b2d-163">Indicates how the subject of the token was authenticated (password, certificate, etc.).</span></span> |
| <span data-ttu-id="97b2d-164">Nome</span><span class="sxs-lookup"><span data-stu-id="97b2d-164">First Name</span></span> |<span data-ttu-id="97b2d-165">Fornisce il nome dell'utente come è impostato in Azure AD.</span><span class="sxs-lookup"><span data-stu-id="97b2d-165">Provides the given name of the user as set in Azure AD.</span></span> |
| <span data-ttu-id="97b2d-166">Gruppi</span><span class="sxs-lookup"><span data-stu-id="97b2d-166">Groups</span></span> |<span data-ttu-id="97b2d-167">Contiene gli ID oggetto dei gruppi di Azure AD di cui l'utente è membro.</span><span class="sxs-lookup"><span data-stu-id="97b2d-167">Contains object Ids of Azure AD groups the user is a member of.</span></span> |
| <span data-ttu-id="97b2d-168">Provider di identità</span><span class="sxs-lookup"><span data-stu-id="97b2d-168">Identity Provider</span></span> |<span data-ttu-id="97b2d-169">Registra il provider di identità che ha autenticato l'oggetto del token.</span><span class="sxs-lookup"><span data-stu-id="97b2d-169">Records the identity provider that authenticated the subject of the token.</span></span> |
| <span data-ttu-id="97b2d-170">Issued At</span><span class="sxs-lookup"><span data-stu-id="97b2d-170">Issued At</span></span> |<span data-ttu-id="97b2d-171">Registra l'ora in cui il token è stato emesso. Spesso usata per l'aggiornamento del token.</span><span class="sxs-lookup"><span data-stu-id="97b2d-171">Records the time at which the token was issued, often used for token freshness.</span></span> |
| <span data-ttu-id="97b2d-172">Issuer</span><span class="sxs-lookup"><span data-stu-id="97b2d-172">Issuer</span></span> |<span data-ttu-id="97b2d-173">Identifica il servizio token di sicurezza che ha emesso il token, nonché il tenant di Azure AD.</span><span class="sxs-lookup"><span data-stu-id="97b2d-173">Identifies the STS that emitted the token as well as the Azure AD tenant.</span></span> |
| <span data-ttu-id="97b2d-174">Cognome</span><span class="sxs-lookup"><span data-stu-id="97b2d-174">Last Name</span></span> |<span data-ttu-id="97b2d-175">Fornisce il cognome dell'utente come è impostato in Azure AD.</span><span class="sxs-lookup"><span data-stu-id="97b2d-175">Provides the surname of the user as set in Azure AD.</span></span> |
| <span data-ttu-id="97b2d-176">Nome</span><span class="sxs-lookup"><span data-stu-id="97b2d-176">Name</span></span> |<span data-ttu-id="97b2d-177">Fornisce un valore leggibile che identifica l'oggetto del token.</span><span class="sxs-lookup"><span data-stu-id="97b2d-177">Provides a human readable value that identifies the subject of the token.</span></span> |
| <span data-ttu-id="97b2d-178">ID oggetto</span><span class="sxs-lookup"><span data-stu-id="97b2d-178">Object Id</span></span> |<span data-ttu-id="97b2d-179">Contiene un identificatore univoco e non modificabile dell'oggetto in Azure AD.</span><span class="sxs-lookup"><span data-stu-id="97b2d-179">Contains an immutable, unique identifier of the subject in Azure AD.</span></span> |
| <span data-ttu-id="97b2d-180">Ruoli</span><span class="sxs-lookup"><span data-stu-id="97b2d-180">Roles</span></span> |<span data-ttu-id="97b2d-181">Contiene i nomi descrittivi dei ruoli applicazione di Azure AD concessi all'utente.</span><span class="sxs-lookup"><span data-stu-id="97b2d-181">Contains friendly names of Azure AD Application Roles that the user has been granted.</span></span> |
| <span data-ttu-id="97b2d-182">Scope</span><span class="sxs-lookup"><span data-stu-id="97b2d-182">Scope</span></span> |<span data-ttu-id="97b2d-183">Indica le autorizzazioni concesse all'applicazione client.</span><span class="sxs-lookup"><span data-stu-id="97b2d-183">Indicates the permissions granted to the client application.</span></span> |
| <span data-ttu-id="97b2d-184">Oggetto</span><span class="sxs-lookup"><span data-stu-id="97b2d-184">Subject</span></span> |<span data-ttu-id="97b2d-185">Indica l'entità su cui il token rilascia informazioni.</span><span class="sxs-lookup"><span data-stu-id="97b2d-185">Indicates the principal about which the token asserts information.</span></span> |
| <span data-ttu-id="97b2d-186">ID tenant</span><span class="sxs-lookup"><span data-stu-id="97b2d-186">Tenant Id</span></span> |<span data-ttu-id="97b2d-187">Contiene un identificatore univoco e non modificabile del tenant di directory che ha emesso il token.</span><span class="sxs-lookup"><span data-stu-id="97b2d-187">Contains an immutable, unique identifier of the directory tenant that issued the token.</span></span> |
| <span data-ttu-id="97b2d-188">Durata del token</span><span class="sxs-lookup"><span data-stu-id="97b2d-188">Token Lifetime</span></span> |<span data-ttu-id="97b2d-189">Definisce l'intervallo di tempo entro il quale un token è valido.</span><span class="sxs-lookup"><span data-stu-id="97b2d-189">Defines the time interval within which a token is valid.</span></span> |
| <span data-ttu-id="97b2d-190">Nome dell'entità utente</span><span class="sxs-lookup"><span data-stu-id="97b2d-190">User Principal Name</span></span> |<span data-ttu-id="97b2d-191">Contiene il nome dell'entità utente dell'oggetto.</span><span class="sxs-lookup"><span data-stu-id="97b2d-191">Contains the user principal name of the subject.</span></span> |
| <span data-ttu-id="97b2d-192">Versione</span><span class="sxs-lookup"><span data-stu-id="97b2d-192">Version</span></span> |<span data-ttu-id="97b2d-193">Contiene il numero di versione del token.</span><span class="sxs-lookup"><span data-stu-id="97b2d-193">Contains the version number of the token.</span></span> |

## <a name="basics-of-registering-an-application-in-azure-ad"></a><span data-ttu-id="97b2d-194">Nozioni di base sulla registrazione di un'applicazione in Azure AD </span><span class="sxs-lookup"><span data-stu-id="97b2d-194">Basics of Registering an Application in Azure AD</span></span>
<span data-ttu-id="97b2d-195">Le applicazioni che usano l'outsourcing per l'autenticazione ad Azure AD devono essere registrate in una directory.</span><span class="sxs-lookup"><span data-stu-id="97b2d-195">Any application that outsources authentication to Azure AD must be registered in a directory.</span></span> <span data-ttu-id="97b2d-196">Questo passaggio include la comunicazione ad Azure AD delle informazioni sull'applicazione, compresi l'URL in cui si trova, l'URL per l'invio delle risposte dopo l'autenticazione, l'URI per identificare l'applicazione e così via.</span><span class="sxs-lookup"><span data-stu-id="97b2d-196">This step involves telling Azure AD about your application, including the URL where it’s located, the URL to send replies after authentication, the URI to identify your application, and more.</span></span> <span data-ttu-id="97b2d-197">Queste informazioni sono necessarie per alcune ragioni fondamentali:</span><span class="sxs-lookup"><span data-stu-id="97b2d-197">This information is required for a few key reasons:</span></span>

* <span data-ttu-id="97b2d-198">Azure AD ha bisogno delle coordinate per comunicare con l'applicazione durante la gestione dell'accesso o lo scambio di token,</span><span class="sxs-lookup"><span data-stu-id="97b2d-198">Azure AD needs coordinates to communicate with the application when handling sign-on or exchanging tokens.</span></span> <span data-ttu-id="97b2d-199">tra cui:</span><span class="sxs-lookup"><span data-stu-id="97b2d-199">These include the following:</span></span>
  
  * <span data-ttu-id="97b2d-200">URI ID applicazione: l'identificatore di un'applicazione.</span><span class="sxs-lookup"><span data-stu-id="97b2d-200">Application ID URI: The identifier for an application.</span></span> <span data-ttu-id="97b2d-201">Questo valore viene inviato ad Azure AD durante l'autenticazione per specificare le applicazioni per cui il chiamante richiede un token.</span><span class="sxs-lookup"><span data-stu-id="97b2d-201">This value is sent to Azure AD during authentication to indicate which application the caller wants a token for.</span></span> <span data-ttu-id="97b2d-202">Questo valore è inoltre incluso nel token per indicare all'applicazione che era la destinazione prevista.</span><span class="sxs-lookup"><span data-stu-id="97b2d-202">Additionally, this value is included in the token so that the application knows it was the intended target.</span></span>
  * <span data-ttu-id="97b2d-203">URL di risposta e URI di reindirizzamento: nel caso di un'API Web o di un'applicazione Web, l'URL di risposta è il percorso a cui Azure AD invierà la risposta di autenticazione, compreso un token se l'autenticazione è riuscita.</span><span class="sxs-lookup"><span data-stu-id="97b2d-203">Reply URL and Redirect URI: In the case of a web API or web application, the Reply URL is the location to which Azure AD will send the authentication response, including a token if authentication was successful.</span></span> <span data-ttu-id="97b2d-204">Nel caso di un'applicazione nativa, l'URI di reindirizzamento è un identificatore univoco a cui Azure AD reindirizzerà l'agente utente in una richiesta OAuth 2.0.</span><span class="sxs-lookup"><span data-stu-id="97b2d-204">In the case of a native application, the Redirect URI is a unique identifier to which Azure AD will redirect the user-agent in an OAuth 2.0 request.</span></span>
  * <span data-ttu-id="97b2d-205">ID applicazione: l'ID di un'applicazione, che viene generato da Azure AD quando l'applicazione viene registrata.</span><span class="sxs-lookup"><span data-stu-id="97b2d-205">Application ID: The ID for an application, which is generated by Azure AD when the application is registered.</span></span> <span data-ttu-id="97b2d-206">Quando viene richiesto un codice di autorizzazione o token, l'ID applicazione e la chiave vengono inviati ad Azure AD durante l'autenticazione.</span><span class="sxs-lookup"><span data-stu-id="97b2d-206">When requesting an authorization code or token, the Application ID and key are sent to Azure AD during authentication.</span></span>
  * <span data-ttu-id="97b2d-207">Chiave: la chiave inviata insieme a un ID applicazione durante l'autenticazione ad Azure AD per chiamare un'API Web.</span><span class="sxs-lookup"><span data-stu-id="97b2d-207">Key: The key that is sent along with a Application ID when authenticating to Azure AD to call a web API.</span></span>
* <span data-ttu-id="97b2d-208">Azure AD deve assicurarsi che l'applicazione disponga delle autorizzazioni necessarie per accedere ai dati della directory, ad altre applicazioni nell'organizzazione e così via.</span><span class="sxs-lookup"><span data-stu-id="97b2d-208">Azure AD needs to ensure the application has the required permissions to access your directory data, other applications in your organization, and so on</span></span>

<span data-ttu-id="97b2d-209">Per comprendere meglio il provisioning, è utile chiarire che esistono due categorie di applicazioni che possono essere sviluppate e integrate con Azure AD:</span><span class="sxs-lookup"><span data-stu-id="97b2d-209">Provisioning becomes clearer when you understand that there are two categories of applications that can be developed and integrated with Azure AD:</span></span>

* <span data-ttu-id="97b2d-210">Applicazione con un singolo tenant: un'applicazione con un singolo tenant è destinata all'uso in una organizzazione.</span><span class="sxs-lookup"><span data-stu-id="97b2d-210">Single tenant application: A single tenant application is intended for use in one organization.</span></span> <span data-ttu-id="97b2d-211">In genere si tratta di applicazioni line-of-business scritte da uno sviluppatore aziendale.</span><span class="sxs-lookup"><span data-stu-id="97b2d-211">These are typically line-of-business (LoB) applications written by an enterprise developer.</span></span> <span data-ttu-id="97b2d-212">Un'applicazione con un singolo tenant deve essere accessibile solo agli utenti di una directory e quindi è necessario eseguirne il provisioning in una sola directory.</span><span class="sxs-lookup"><span data-stu-id="97b2d-212">A single tenant application only needs to be accessed by users in one directory, and as a result, it only needs to be provisioned in one directory.</span></span> <span data-ttu-id="97b2d-213">Queste applicazioni sono generalmente registrate da uno sviluppatore dell'organizzazione.</span><span class="sxs-lookup"><span data-stu-id="97b2d-213">These applications are typically registered by a developer in the organization.</span></span>
* <span data-ttu-id="97b2d-214">Applicazione multi-tenant: un'applicazione multi-tenant è destinata all'uso in molte organizzazioni, non solo in una.</span><span class="sxs-lookup"><span data-stu-id="97b2d-214">Multi-tenant application: A multi-tenant application is intended for use in many organizations, not just one organization.</span></span> <span data-ttu-id="97b2d-215">Si tratta generalmente di applicazioni SaaS (Software-as-a-Service) scritte da un fornitore di software indipendente (ISV).</span><span class="sxs-lookup"><span data-stu-id="97b2d-215">These are typically software-as-a-service (SaaS) applications written by an independent software vendor (ISV).</span></span> <span data-ttu-id="97b2d-216">È necessario eseguire il provisioning delle applicazioni multi-tenant in ogni directory in cui verranno usate ed è richiesto il consenso dell'utente o dell'amministratore per registrarle.</span><span class="sxs-lookup"><span data-stu-id="97b2d-216">Multi-tenant applications need to be provisioned in each directory where they will be used, which requires user or administrator consent to register them.</span></span> <span data-ttu-id="97b2d-217">Questo processo di consenso inizia quando un'applicazione viene registrata nella directory e può accedere all'API Graph o magari a un'altra API Web.</span><span class="sxs-lookup"><span data-stu-id="97b2d-217">This consent process starts when an application has been registered in the directory and is given access to the Graph API or perhaps another web API.</span></span> <span data-ttu-id="97b2d-218">Quando un utente o amministratore di un'altra organizzazione esegue l'accesso per usare l'applicazione, viene visualizzata una finestra di dialogo in cui sono indicate le autorizzazioni richieste dall'applicazione.</span><span class="sxs-lookup"><span data-stu-id="97b2d-218">When a user or administrator from a different organization signs up to use the application, they are presented with a dialog that displays the permissions the application requires.</span></span> <span data-ttu-id="97b2d-219">L'utente o amministratore può quindi concedere il consenso all'applicazione, in modo da fornirle l'accesso ai dati indicati e infine di registrarla nella propria directory.</span><span class="sxs-lookup"><span data-stu-id="97b2d-219">The user or administrator can then consent to the application, which gives the application access to the stated data, and finally registers the application in their directory.</span></span> <span data-ttu-id="97b2d-220">Per altre informazioni, vedere [Panoramica del framework di consenso](active-directory-integrating-applications.md#overview-of-the-consent-framework).</span><span class="sxs-lookup"><span data-stu-id="97b2d-220">For more information, see [Overview of the Consent Framework](active-directory-integrating-applications.md#overview-of-the-consent-framework).</span></span>

<span data-ttu-id="97b2d-221">Quando si sviluppa un'applicazione multi-tenant invece di un'applicazione con un singolo tenant, occorre considerare qualche altro aspetto.</span><span class="sxs-lookup"><span data-stu-id="97b2d-221">Some additional considerations arise when developing a multi-tenant application instead of a single tenant application.</span></span> <span data-ttu-id="97b2d-222">Ad esempio, se l'applicazione viene resa disponibile agli utenti in più directory, è necessario un meccanismo per determinare il tenant attivo.</span><span class="sxs-lookup"><span data-stu-id="97b2d-222">For example, if you are making your application available to users in multiple directories, you need a mechanism to determine which tenant they’re in.</span></span> <span data-ttu-id="97b2d-223">Un'applicazione con un singolo tenant deve solo cercare un utente nella propria directory, mentre un'applicazione multi-tenant deve identificare un utente specifico in tutte le directory in Azure AD.</span><span class="sxs-lookup"><span data-stu-id="97b2d-223">A single tenant application only needs to look in its own directory for a user, while a multi-tenant application needs to identify a specific user from all the directories in Azure AD.</span></span> <span data-ttu-id="97b2d-224">A questo scopo, Azure AD fornisce un endpoint di autenticazione comune in cui qualsiasi applicazione multi-tenant può indirizzare le richieste di accesso, invece di un endpoint specifico di un tenant.</span><span class="sxs-lookup"><span data-stu-id="97b2d-224">To accomplish this task, Azure AD provides a common authentication endpoint where any multi-tenant application can direct sign-in requests, instead of a tenant-specific endpoint.</span></span> <span data-ttu-id="97b2d-225">Questo endpoint è https://login.microsoftonline.com/common per tutte le directory in Azure AD, mentre un endpoint specifico del tenant potrebbe essere https://login.microsoftonline.com/contoso.onmicrosoft.com. L'endpoint comune deve essere valutato con particolare attenzione durante lo sviluppo di un'applicazione, perché occorrerà la logica necessaria per gestire più tenant durante l'accesso, la disconnessione e la convalida dei token.</span><span class="sxs-lookup"><span data-stu-id="97b2d-225">This endpoint is https://login.microsoftonline.com/common for all directories in Azure AD, whereas a tenant-specific endpoint might be https://login.microsoftonline.com/contoso.onmicrosoft.com. The common endpoint is especially important to consider when developing your application because you’ll need the necessary logic to handle multiple tenants during sign-in, sign-out, and token validation.</span></span>

<span data-ttu-id="97b2d-226">Se si sviluppa un'applicazione con un singolo tenant, ma si intende metterla a disposizione di molte organizzazioni, è possibile modificare facilmente l'applicazione e la relativa configurazione in Azure AD per fare in modo che supporti più tenant.</span><span class="sxs-lookup"><span data-stu-id="97b2d-226">If you are currently developing a single tenant application but want to make it available to many organizations, you can easily make changes to the application and its configuration in Azure AD to make it multi-tenant capable.</span></span> <span data-ttu-id="97b2d-227">Azure AD usa inoltre la stessa chiave di firma per tutti i token in tutte le directory, a prescindere dal fatto che si fornisca l'autenticazione in un'applicazione con un singolo tenant o multi-tenant.</span><span class="sxs-lookup"><span data-stu-id="97b2d-227">In addition, Azure AD uses the same signing key for all tokens in all directories, whether you are providing authentication in a single tenant or multi-tenant application.</span></span>

<span data-ttu-id="97b2d-228">Ogni scenario indicati in questo documento include una sottosezione in cui sono descritti i relativi requisiti di provisioning.</span><span class="sxs-lookup"><span data-stu-id="97b2d-228">Each scenario listed in this document includes a sub-section that describes its provisioning requirements.</span></span> <span data-ttu-id="97b2d-229">Per informazioni più dettagliate sul provisioning di un'applicazione in Azure AD e sulle differenze tra applicazioni con un singolo tenant e applicazioni multi-tenant, vedere [Applicazioni di integrazione con Azure Active Directory](active-directory-integrating-applications.md) .</span><span class="sxs-lookup"><span data-stu-id="97b2d-229">For more in-depth information about provisioning an application in Azure AD and the differences between single and multi-tenant applications, see [Integrating Applications with Azure Active Directory](active-directory-integrating-applications.md) for more information.</span></span> <span data-ttu-id="97b2d-230">Di seguito sono illustrati gli scenari di applicazione più comuni in Azure AD.</span><span class="sxs-lookup"><span data-stu-id="97b2d-230">Continue reading to understand the common application scenarios in Azure AD.</span></span>

## <a name="application-types-and-scenarios"></a><span data-ttu-id="97b2d-231">Scenari e tipi di applicazione</span><span class="sxs-lookup"><span data-stu-id="97b2d-231">Application Types and Scenarios</span></span>
<span data-ttu-id="97b2d-232">Tutti gli scenari descritti in questo documento possono essere sviluppati con vari linguaggi e piattaforme.</span><span class="sxs-lookup"><span data-stu-id="97b2d-232">Each of the scenarios described in this document can be developed using various languages and platforms.</span></span> <span data-ttu-id="97b2d-233">Sono tutti supportati da esempi di codice completo disponibili nella [guida agli esempi di codice](active-directory-code-samples.md) o direttamente dal corrispondente [archivio di esempio GitHub](https://github.com/Azure-Samples?utf8=%E2%9C%93&query=active-directory).</span><span class="sxs-lookup"><span data-stu-id="97b2d-233">They are all backed by complete code samples which are available in our [Code Samples guide](active-directory-code-samples.md), or directly from the corresponding [GitHub sample repositories](https://github.com/Azure-Samples?utf8=%E2%9C%93&query=active-directory).</span></span> <span data-ttu-id="97b2d-234">Inoltre, se l'applicazione necessita di una parte o di un segmento specifico di uno scenario end-to-end, nella maggior parte dei casi è possibile aggiungere tale funzionalità in modo indipendente.</span><span class="sxs-lookup"><span data-stu-id="97b2d-234">In addition, if your application needs a specific piece or segment of an end-to-end scenario, in most cases that functionality can be added independently.</span></span> <span data-ttu-id="97b2d-235">Ad esempio, se si ha un'applicazione nativa che chiama un'API Web, è possibile aggiungere facilmente un'applicazione Web che chiama la stessa API Web.</span><span class="sxs-lookup"><span data-stu-id="97b2d-235">For example, if you have a native application that calls a web API, you can easily add a web application that also calls the web API.</span></span> <span data-ttu-id="97b2d-236">Il diagramma seguente illustra questi scenari e tipi di applicazione e viene indicato come aggiungere i vari componenti:</span><span class="sxs-lookup"><span data-stu-id="97b2d-236">The following diagram illustrates these scenarios and application types, and how different components can be added:</span></span>

![Scenari e tipi di applicazione](./media/active-directory-authentication-scenarios/application_types_and_scenarios.png)

<span data-ttu-id="97b2d-238">Azure AD supporta i cinque scenari di applicazione principali descritti di seguito:</span><span class="sxs-lookup"><span data-stu-id="97b2d-238">These are the five primary application scenarios supported by Azure AD:</span></span>

* <span data-ttu-id="97b2d-239">[Da Web browser ad applicazione Web](#web-browser-to-web-application): un'utente deve accedere a un'applicazione Web protetta da Azure AD.</span><span class="sxs-lookup"><span data-stu-id="97b2d-239">[Web Browser to Web Application](#web-browser-to-web-application): A user needs to sign in to a web application that is secured by Azure AD.</span></span>
* <span data-ttu-id="97b2d-240">[Applicazione a pagina singola](#single-page-application-spa): un'utente deve accedere a un'applicazione a pagina singola protetta da Azure AD.</span><span class="sxs-lookup"><span data-stu-id="97b2d-240">[Single Page Application (SPA)](#single-page-application-spa): A user needs to sign in to a single page application that is secured by Azure AD.</span></span>
* <span data-ttu-id="97b2d-241">[Da applicazione nativa ad API Web](#native-application-to-web-api): un'applicazione nativa in esecuzione su un telefono, tablet o PC deve autenticare un utente per ottenere risorse da un'API Web protetta da Azure AD.</span><span class="sxs-lookup"><span data-stu-id="97b2d-241">[Native Application to Web API](#native-application-to-web-api): A native application that runs on a phone, tablet, or PC needs to authenticate a user to get resources from a web API that is secured by Azure AD.</span></span>
* <span data-ttu-id="97b2d-242">[Da applicazione Web ad API Web](#web-application-to-web-api): un'applicazione Web deve ottenere risorse da un'API Web protetta da Azure AD.</span><span class="sxs-lookup"><span data-stu-id="97b2d-242">[Web Application to Web API](#web-application-to-web-api): A web application needs to get resources from a web API secured by Azure AD.</span></span>
* <span data-ttu-id="97b2d-243">[Da daemon o applicazione server ad API Web](#daemon-or-server-application-to-web-api): un'applicazione daemon o un'applicazione server priva di interfaccia utente Web deve ottenere risorse da un'API Web protetta da Azure AD.</span><span class="sxs-lookup"><span data-stu-id="97b2d-243">[Daemon or Server Application to Web API](#daemon-or-server-application-to-web-api): A daemon application or a server application with no web user interface needs to get resources from a web API secured by Azure AD.</span></span>

### <a name="web-browser-to-web-application"></a><span data-ttu-id="97b2d-244">Da Web browser ad applicazione Web</span><span class="sxs-lookup"><span data-stu-id="97b2d-244">Web Browser to Web Application</span></span>
<span data-ttu-id="97b2d-245">Questa sezione descrive un'applicazione che autentica un utente in un Web browser per un'applicazione Web.</span><span class="sxs-lookup"><span data-stu-id="97b2d-245">This section describes an application that authenticates a user in a web browser to a web application.</span></span> <span data-ttu-id="97b2d-246">In questo scenario l'applicazione Web indirizza il browser dell'utente per l'accesso ad Azure AD.</span><span class="sxs-lookup"><span data-stu-id="97b2d-246">In this scenario, the web application directs the user’s browser to sign them in to Azure AD.</span></span> <span data-ttu-id="97b2d-247">Tramite il browser dell'utente Azure AD restituisce una risposta di accesso che contiene attestazioni sull'utente in un token di sicurezza.</span><span class="sxs-lookup"><span data-stu-id="97b2d-247">Azure AD returns a sign-in response through the user’s browser, which contains claims about the user in a security token.</span></span> <span data-ttu-id="97b2d-248">Questo scenario supporta l'accesso mediante i protocolli WS-Federation, SAML 2.0 e OpenID Connect.</span><span class="sxs-lookup"><span data-stu-id="97b2d-248">This scenario supports sign-on using the WS-Federation, SAML 2.0, and OpenID Connect protocols.</span></span>

#### <a name="diagram"></a><span data-ttu-id="97b2d-249">Diagramma</span><span class="sxs-lookup"><span data-stu-id="97b2d-249">Diagram</span></span>
![Flusso di autenticazione da browser ad applicazione Web](./media/active-directory-authentication-scenarios/web_browser_to_web_api.png)

#### <a name="description-of-protocol-flow"></a><span data-ttu-id="97b2d-251">Descrizione del flusso del protocollo</span><span class="sxs-lookup"><span data-stu-id="97b2d-251">Description of Protocol Flow</span></span>
1. <span data-ttu-id="97b2d-252">Quando un utente visita l'applicazione e deve eseguire l'accesso, viene reindirizzato tramite una richiesta di accesso all'endpoint di autenticazione in Azure AD.</span><span class="sxs-lookup"><span data-stu-id="97b2d-252">When a user visits the application and needs to sign in, they are redirected via a sign-in request to the authentication endpoint in Azure AD.</span></span>
2. <span data-ttu-id="97b2d-253">L'utente accede nella pagina di accesso.</span><span class="sxs-lookup"><span data-stu-id="97b2d-253">The user signs in on the sign-in page.</span></span>
3. <span data-ttu-id="97b2d-254">Se l'autenticazione riesce, Azure AD crea un token di autenticazione e restituisce una risposta di accesso all'URL di risposta dell'applicazione configurato nel Portale di Azure.</span><span class="sxs-lookup"><span data-stu-id="97b2d-254">If authentication is successful, Azure AD creates an authentication token and returns a sign-in response to the application’s Reply URL that was configured in the Azure Portal.</span></span> <span data-ttu-id="97b2d-255">Per un'applicazione di produzione, questo URL di risposta deve essere HTTPS.</span><span class="sxs-lookup"><span data-stu-id="97b2d-255">For a production application, this Reply URL should be HTTPS.</span></span> <span data-ttu-id="97b2d-256">Il token restituito include le attestazioni sull'utente e Azure AD richieste dall'applicazione per convalidare il token.</span><span class="sxs-lookup"><span data-stu-id="97b2d-256">The returned token includes claims about the user and Azure AD that are required by the application to validate the token.</span></span>
4. <span data-ttu-id="97b2d-257">L'applicazione convalida il token usando le informazioni sulla chiave di firma pubblica e sull'autorità emittente disponibili nel documento metadati federazione per Azure AD.</span><span class="sxs-lookup"><span data-stu-id="97b2d-257">The application validates the token by using a public signing key and issuer information available at the federation metadata document for Azure AD.</span></span> <span data-ttu-id="97b2d-258">Dopo la convalida del token da parte dell'applicazione, Azure AD avvia una nuova sessione con l'utente.</span><span class="sxs-lookup"><span data-stu-id="97b2d-258">After the application validates the token, Azure AD starts a new session with the user.</span></span> <span data-ttu-id="97b2d-259">La sessione consente all'utente di accedere all'applicazione fino alla scadenza.</span><span class="sxs-lookup"><span data-stu-id="97b2d-259">This session allows the user to access the application until it expires.</span></span>

#### <a name="code-samples"></a><span data-ttu-id="97b2d-260">Esempi di codice</span><span class="sxs-lookup"><span data-stu-id="97b2d-260">Code Samples</span></span>
<span data-ttu-id="97b2d-261">Vedere gli esempi di codice per gli scenari Da Web Browser ad applicazione Web.</span><span class="sxs-lookup"><span data-stu-id="97b2d-261">See the code samples for Web Browser to Web Application scenarios.</span></span> <span data-ttu-id="97b2d-262">Consultare spesso questa pagina perché vengono aggiunti regolarmente nuovi esempi.</span><span class="sxs-lookup"><span data-stu-id="97b2d-262">And, check back frequently -- we add new samples all the time.</span></span> <span data-ttu-id="97b2d-263">[Da Web browser ad applicazione Web](active-directory-code-samples.md#web-browser-to-web-application).</span><span class="sxs-lookup"><span data-stu-id="97b2d-263">[Web Browser to Web Application](active-directory-code-samples.md#web-browser-to-web-application).</span></span>

#### <a name="registering"></a><span data-ttu-id="97b2d-264">Registrazione</span><span class="sxs-lookup"><span data-stu-id="97b2d-264">Registering</span></span>
* <span data-ttu-id="97b2d-265">Singolo tenant: se si crea un'applicazione solo per la propria organizzazione, è necessario registrarla nella directory aziendale tramite il Portale di Azure.</span><span class="sxs-lookup"><span data-stu-id="97b2d-265">Single Tenant: If you are building an application just for your organization, it must be registered in your company’s directory by using the Azure Portal.</span></span>
* <span data-ttu-id="97b2d-266">Multi-tenant: se si crea un'applicazione che può essere usata da utenti esterni all'organizzazione, è necessario registrarla nella directory aziendale, ma anche nella directory delle singole organizzazioni che useranno l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="97b2d-266">Multi-Tenant: If you are building an application that can be used by users outside your organization, it must be registered in your company’s directory, but also must be registered in each organization’s directory that will be using the application.</span></span> <span data-ttu-id="97b2d-267">Per rendere disponibile l'applicazione nella propria directory, è possibile includere un processo di accesso per i clienti che permetta loro di concedere il consenso all'applicazione.</span><span class="sxs-lookup"><span data-stu-id="97b2d-267">To make your application available in their directory, you can include a sign-up process for your customers that enables them to consent to your application.</span></span> <span data-ttu-id="97b2d-268">Al momento dell'iscrizione all'applicazione, viene visualizzata una finestra di dialogo in cui sono indicate le autorizzazioni richieste dall'applicazione e quindi viene presentata l'opzione per il consenso.</span><span class="sxs-lookup"><span data-stu-id="97b2d-268">When they sign up for your application, they will be presented with a dialog that shows the permissions the application requires, and then the option to consent.</span></span> <span data-ttu-id="97b2d-269">A seconda delle autorizzazioni richieste, è possibile che il consenso debba essere fornito da un amministratore dell'altra organizzazione.</span><span class="sxs-lookup"><span data-stu-id="97b2d-269">Depending on the required permissions, an administrator in the other organization may be required to give consent.</span></span> <span data-ttu-id="97b2d-270">Quando l'utente o l'amministratore acconsente, l'applicazione viene registrata nella directory.</span><span class="sxs-lookup"><span data-stu-id="97b2d-270">When the user or administrator consents, the application is registered in their directory.</span></span> <span data-ttu-id="97b2d-271">Per ulteriori informazioni, vedere [Integrazione di applicazioni con Azure Active Directory](active-directory-integrating-applications.md).</span><span class="sxs-lookup"><span data-stu-id="97b2d-271">For more information, see [Integrating Applications with Azure Active Directory](active-directory-integrating-applications.md).</span></span>

#### <a name="token-expiration"></a><span data-ttu-id="97b2d-272">Scadenza del token</span><span class="sxs-lookup"><span data-stu-id="97b2d-272">Token Expiration</span></span>
<span data-ttu-id="97b2d-273">La sessione dell'utente scade al termine del periodo di validità del token emesso da Azure AD.</span><span class="sxs-lookup"><span data-stu-id="97b2d-273">The user’s session expires when the lifetime of the token issued by Azure AD expires.</span></span> <span data-ttu-id="97b2d-274">Se necessario, l'applicazione può abbreviare questo periodo di validità, ad esempio disconnettendo gli utenti dopo un determinato tempo di inattività.</span><span class="sxs-lookup"><span data-stu-id="97b2d-274">Your application can shorten this time period if desired, such as signing out users based on a period of inactivity.</span></span> <span data-ttu-id="97b2d-275">Quando la sessione scade, all'utente viene chiesto di accedere di nuovo.</span><span class="sxs-lookup"><span data-stu-id="97b2d-275">When the session expires, the user will be prompted to sign in again.</span></span>

### <a name="single-page-application-spa"></a><span data-ttu-id="97b2d-276">Applicazione a singola pagina (SPA)</span><span class="sxs-lookup"><span data-stu-id="97b2d-276">Single Page Application (SPA)</span></span>
<span data-ttu-id="97b2d-277">Questa sezione descrive l'autenticazione per un'applicazione a pagina singola che utilizza Azure AD e la concessione di autorizzazione implicita OAuth 2.0 per proteggere il back-end dell'API Web.</span><span class="sxs-lookup"><span data-stu-id="97b2d-277">This section describes authentication for a Single Page Application, that uses Azure AD and the OAuth 2.0 implicit authorization grant to secure its web API back end.</span></span> <span data-ttu-id="97b2d-278">Le applicazioni a singola pagina sono in genere strutturate come un livello di presentazione JavaScript (front-end) eseguito nel browser e un back-end dell'API Web eseguito in un server e che implementa la logica di business dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="97b2d-278">Single Page Applications are typically structured as a JavaScript presentation layer (front end) that runs in the browser and a Web API back end that runs on a server and implements the application’s business logic.</span></span> <span data-ttu-id="97b2d-279">Per ulteriori informazioni sulla concessione di autorizzazione implicita e per stabilire se sia adatta allo scenario della propria applicazione, vedere [Informazioni sul flusso di concessione implicita OAuth2 in Azure Active Directory](active-directory-dev-understanding-oauth2-implicit-grant.md).</span><span class="sxs-lookup"><span data-stu-id="97b2d-279">To learn more about the implicit authorization grant, and help you decide whether it's right for your application scenario, see [Understanding the OAuth2 implicit grant flow in Azure Active Directory](active-directory-dev-understanding-oauth2-implicit-grant.md).</span></span>

<span data-ttu-id="97b2d-280">In questo scenario, quando l'utente accede, il front-end JavaScript utilizza [Active Directory Authentication Library per JavaScript (ADAL.JS)](https://github.com/AzureAD/azure-activedirectory-library-for-js/tree/dev) e la concessione di autorizzazione implicita per ottenere un token ID (id_token) da Azure AD.</span><span class="sxs-lookup"><span data-stu-id="97b2d-280">In this scenario, when the user signs in, the JavaScript front end uses [Active Directory Authentication Library for JavaScript (ADAL.JS)](https://github.com/AzureAD/azure-activedirectory-library-for-js/tree/dev) and the implicit authorization grant to obtain an ID token (id_token) from Azure AD.</span></span> <span data-ttu-id="97b2d-281">Il token viene memorizzato nella cache e il client lo associa alla richiesta come token di connessione quando si effettuano chiamate al relativo back-end dell'API Web, protetto tramite il middleware OWIN.</span><span class="sxs-lookup"><span data-stu-id="97b2d-281">The token is cached and the client attaches it to the request as the bearer token when making calls to its Web API back end, which is secured using the OWIN middleware.</span></span> 

#### <a name="diagram"></a><span data-ttu-id="97b2d-282">Diagramma</span><span class="sxs-lookup"><span data-stu-id="97b2d-282">Diagram</span></span>
![Diagramma Applicazione a singola pagina (SPA)](./media/active-directory-authentication-scenarios/single_page_app.png)

#### <a name="description-of-protocol-flow"></a><span data-ttu-id="97b2d-284">Descrizione del flusso del protocollo</span><span class="sxs-lookup"><span data-stu-id="97b2d-284">Description of Protocol Flow</span></span>
1. <span data-ttu-id="97b2d-285">L'utente passa all'applicazione Web.</span><span class="sxs-lookup"><span data-stu-id="97b2d-285">The user navigates to the web application.</span></span>
2. <span data-ttu-id="97b2d-286">L'applicazione restituisce al browser il front-end JavaScript (livello di presentazione).</span><span class="sxs-lookup"><span data-stu-id="97b2d-286">The application returns the JavaScript front end (presentation layer) to the browser.</span></span>
3. <span data-ttu-id="97b2d-287">L'utente avvia l'accesso, ad esempio facendo clic su un collegamento di accesso.</span><span class="sxs-lookup"><span data-stu-id="97b2d-287">The user initiates sign in, for example by clicking a sign in link.</span></span> <span data-ttu-id="97b2d-288">Il browser invia una richiesta GET all'endpoint di autorizzazione di Azure AD per richiedere un token ID.</span><span class="sxs-lookup"><span data-stu-id="97b2d-288">The browser sends a GET to the Azure AD authorization endpoint to request an ID token.</span></span> <span data-ttu-id="97b2d-289">Nei parametri di query di questa richiesta sono inclusi l'URL di risposta e l'ID applicazione.</span><span class="sxs-lookup"><span data-stu-id="97b2d-289">This request includes the application ID and reply URL in the query parameters.</span></span>
4. <span data-ttu-id="97b2d-290">Azure AD convalida l'URL di risposta confrontandolo con l'URL di risposta registrato, configurato nel Portale di Azure.</span><span class="sxs-lookup"><span data-stu-id="97b2d-290">Azure AD validates the Reply URL against the registered Reply URL that was configured in the Azure Portal.</span></span>
5. <span data-ttu-id="97b2d-291">L'utente accede nella pagina di accesso.</span><span class="sxs-lookup"><span data-stu-id="97b2d-291">The user signs in on the sign-in page.</span></span>
6. <span data-ttu-id="97b2d-292">Se l'autenticazione riesce, Azure AD crea un token ID e lo restituisce come frammento di URL (#) all'URL di risposta dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="97b2d-292">If authentication is successful, Azure AD creates an ID token and returns it as a URL fragment (#) to the application’s Reply URL.</span></span> <span data-ttu-id="97b2d-293">Per un'applicazione di produzione, questo URL di risposta deve essere HTTPS.</span><span class="sxs-lookup"><span data-stu-id="97b2d-293">For a production application, this Reply URL should be HTTPS.</span></span> <span data-ttu-id="97b2d-294">Il token restituito include le attestazioni sull'utente e Azure AD richieste dall'applicazione per convalidare il token.</span><span class="sxs-lookup"><span data-stu-id="97b2d-294">The returned token includes claims about the user and Azure AD that are required by the application to validate the token.</span></span>
7. <span data-ttu-id="97b2d-295">Il codice client di JavaScript in esecuzione nel browser estrae il token dalla risposta per usarlo nella protezione delle chiamate al back-end dell'API Web dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="97b2d-295">The JavaScript client code running in the browser extracts the token from the response to use in securing calls to the application’s web API back end.</span></span>
8. <span data-ttu-id="97b2d-296">Il browser chiama il back-end dell'API Web dell'applicazione con il token di accesso nell'intestazione dell'autorizzazione.</span><span class="sxs-lookup"><span data-stu-id="97b2d-296">The browser calls the application’s web API back end with the access token in the authorization header.</span></span>

#### <a name="code-samples"></a><span data-ttu-id="97b2d-297">Esempi di codice</span><span class="sxs-lookup"><span data-stu-id="97b2d-297">Code Samples</span></span>
<span data-ttu-id="97b2d-298">Vedere gli esempi di codice per gli scenari di applicazioni a singola pagina (SPA).</span><span class="sxs-lookup"><span data-stu-id="97b2d-298">See the code samples for Single Page Application (SPA) scenarios.</span></span> <span data-ttu-id="97b2d-299">Assicurarsi di consultare spesso questa pagina perché vengono aggiunti regolarmente nuovi esempi.</span><span class="sxs-lookup"><span data-stu-id="97b2d-299">Be sure to check back frequently -- we add new samples all the time.</span></span> <span data-ttu-id="97b2d-300">[Applicazione a singola pagina (SPA)](active-directory-code-samples.md#single-page-application-spa).</span><span class="sxs-lookup"><span data-stu-id="97b2d-300">[Single Page Application (SPA)](active-directory-code-samples.md#single-page-application-spa).</span></span>

#### <a name="registering"></a><span data-ttu-id="97b2d-301">Registrazione</span><span class="sxs-lookup"><span data-stu-id="97b2d-301">Registering</span></span>
* <span data-ttu-id="97b2d-302">Singolo tenant: se si crea un'applicazione solo per la propria organizzazione, è necessario registrarla nella directory aziendale tramite il Portale di Azure.</span><span class="sxs-lookup"><span data-stu-id="97b2d-302">Single Tenant: If you are building an application just for your organization, it must be registered in your company’s directory by using the Azure Portal.</span></span>
* <span data-ttu-id="97b2d-303">Multi-tenant: se si crea un'applicazione che può essere usata da utenti esterni all'organizzazione, è necessario registrarla nella directory aziendale, ma anche nella directory delle singole organizzazioni che useranno l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="97b2d-303">Multi-Tenant: If you are building an application that can be used by users outside your organization, it must be registered in your company’s directory, but also must be registered in each organization’s directory that will be using the application.</span></span> <span data-ttu-id="97b2d-304">Per rendere disponibile l'applicazione nella propria directory, è possibile includere un processo di accesso per i clienti che permetta loro di concedere il consenso all'applicazione.</span><span class="sxs-lookup"><span data-stu-id="97b2d-304">To make your application available in their directory, you can include a sign-up process for your customers that enables them to consent to your application.</span></span> <span data-ttu-id="97b2d-305">Al momento dell'iscrizione all'applicazione, viene visualizzata una finestra di dialogo in cui sono indicate le autorizzazioni richieste dall'applicazione e quindi viene presentata l'opzione per il consenso.</span><span class="sxs-lookup"><span data-stu-id="97b2d-305">When they sign up for your application, they will be presented with a dialog that shows the permissions the application requires, and then the option to consent.</span></span> <span data-ttu-id="97b2d-306">A seconda delle autorizzazioni richieste, è possibile che il consenso debba essere fornito da un amministratore dell'altra organizzazione.</span><span class="sxs-lookup"><span data-stu-id="97b2d-306">Depending on the required permissions, an administrator in the other organization may be required to give consent.</span></span> <span data-ttu-id="97b2d-307">Quando l'utente o l'amministratore acconsente, l'applicazione viene registrata nella directory.</span><span class="sxs-lookup"><span data-stu-id="97b2d-307">When the user or administrator consents, the application is registered in their directory.</span></span> <span data-ttu-id="97b2d-308">Per ulteriori informazioni, vedere [Integrazione di applicazioni con Azure Active Directory](active-directory-integrating-applications.md).</span><span class="sxs-lookup"><span data-stu-id="97b2d-308">For more information, see [Integrating Applications with Azure Active Directory](active-directory-integrating-applications.md).</span></span>

<span data-ttu-id="97b2d-309">Dopo la registrazione dell'applicazione, è necessario configurarla per l'uso del protocollo di concessione implicita OAuth 2.0.</span><span class="sxs-lookup"><span data-stu-id="97b2d-309">After registering the application, it must be configured to use OAuth 2.0 Implicit Grant protocol.</span></span> <span data-ttu-id="97b2d-310">Per impostazione predefinita, questo protocollo è disabilitato per le applicazioni.</span><span class="sxs-lookup"><span data-stu-id="97b2d-310">By default, this protocol is disabled for applications.</span></span> <span data-ttu-id="97b2d-311">Per abilitare il protocollo di concessione implicita OAuth2 per l'applicazione, modificare il manifesto dell'applicazione dal Portale di Azure e impostare il valore "oauth2AllowImplicitFlow" su vero.</span><span class="sxs-lookup"><span data-stu-id="97b2d-311">To enable the OAuth2 Implicit Grant protocol for your application, edit its application manifest from the Azure Portal and set the “oauth2AllowImplicitFlow” value to true.</span></span> <span data-ttu-id="97b2d-312">Per istruzioni dettagliare, vedere la sezione relativa all' [abilitazione della concessione implicita OAuth 2.0 per le applicazioni a singola pagina](active-directory-integrating-applications.md).</span><span class="sxs-lookup"><span data-stu-id="97b2d-312">For detailed instructions, see [Enabling OAuth 2.0 Implicit Grant for Single Page Applications](active-directory-integrating-applications.md).</span></span>

#### <a name="token-expiration"></a><span data-ttu-id="97b2d-313">Scadenza del token</span><span class="sxs-lookup"><span data-stu-id="97b2d-313">Token Expiration</span></span>
<span data-ttu-id="97b2d-314">Quando si usa ADAL.js per gestire l'autenticazione con Azure AD, è possibile sfruttare i vantaggi offerti da varie funzionalità che facilitano l'aggiornamento di un token scaduto e consentono di ottenere token per risorse API Web aggiuntive che possono essere chiamate dall'applicazione.</span><span class="sxs-lookup"><span data-stu-id="97b2d-314">When you use ADAL.js to manage authentication with Azure AD, you benefit from several features that facilitate refreshing an expired token as well as getting tokens for additional web API resources that may be called by the application.</span></span> <span data-ttu-id="97b2d-315">Se l'utente viene autenticato correttamente con Azure AD, per tale utente viene stabilita una sessione protetta da un cookie tra il browser e Azure AD.</span><span class="sxs-lookup"><span data-stu-id="97b2d-315">When the user successfully authenticates with Azure AD, a session secured by a cookie is established for the user between the browser and Azure AD.</span></span> <span data-ttu-id="97b2d-316">Tenere presente che la sessione esiste tra l'utente e Azure AD e non tra l'utente e l'applicazione Web in esecuzione sul server.</span><span class="sxs-lookup"><span data-stu-id="97b2d-316">It’s important to note that the session exists between the user and Azure AD and not between the user and the web application running on the server.</span></span> <span data-ttu-id="97b2d-317">Quando un token scade, ADAL.js usa questa sessione per ottenere automaticamente un altro token.</span><span class="sxs-lookup"><span data-stu-id="97b2d-317">When a token expires, ADAL.js uses this session to silently obtain another token.</span></span> <span data-ttu-id="97b2d-318">Ciò avviene usando un iFrame nascosto per inviare e ricevere la richiesta tramite il protocollo di concessione implicita OAuth.</span><span class="sxs-lookup"><span data-stu-id="97b2d-318">It does this by using a hidden iFrame to send and receive the request using the OAuth Implicit Grant protocol.</span></span> <span data-ttu-id="97b2d-319">ADAL.js può anche usare lo stesso meccanismo per ottenere automaticamente i token di accesso da Azure AD per altre risorse API Web chiamate dall'applicazione, purché queste risorse supportino la condivisione di risorse tra le origini (CORS), siano registrate nella directory dell'utente e sia stato assegnato dall'utente qualsiasi consenso richiesto durante l'accesso.</span><span class="sxs-lookup"><span data-stu-id="97b2d-319">ADAL.js can also use this same mechanism to silently obtain access tokens from Azure AD for other web API resources that the application calls as long as these resources support cross-origin resource sharing (CORS), are registered in the user’s directory, and any required consent was given by the user during sign-in.</span></span>

### <a name="native-application-to-web-api"></a><span data-ttu-id="97b2d-320">Da applicazione nativa ad API Web</span><span class="sxs-lookup"><span data-stu-id="97b2d-320">Native Application to Web API</span></span>
<span data-ttu-id="97b2d-321">Questa sezione descrive un'applicazione nativa che chiama un'API Web per conto di un utente.</span><span class="sxs-lookup"><span data-stu-id="97b2d-321">This section describes a native application that calls a web API on behalf of a user.</span></span> <span data-ttu-id="97b2d-322">Questo scenario è basato sul tipo di concessione del codice di autorizzazione OAuth 2.0 con un client pubblico, come descritto nella sezione 4.1 della [specifica OAuth 2.0](http://tools.ietf.org/html/rfc6749).</span><span class="sxs-lookup"><span data-stu-id="97b2d-322">This scenario is built on the OAuth 2.0 authorization code grant type with a public client, as described in section 4.1 of the [OAuth 2.0 specification](http://tools.ietf.org/html/rfc6749).</span></span> <span data-ttu-id="97b2d-323">L'applicazione nativa ottiene un token di accesso per l'utente tramite il protocollo OAuth 2.0.</span><span class="sxs-lookup"><span data-stu-id="97b2d-323">The native application obtains an access token for the user by using the OAuth 2.0 protocol.</span></span> <span data-ttu-id="97b2d-324">Questo token di accesso viene quindi inviato nella richiesta all'API Web, che autorizza l'utente e restituisce la risorsa desiderata.</span><span class="sxs-lookup"><span data-stu-id="97b2d-324">This access token is then sent in the request to the web API, which authorizes the user and returns the desired resource.</span></span>

#### <a name="diagram"></a><span data-ttu-id="97b2d-325">Diagramma</span><span class="sxs-lookup"><span data-stu-id="97b2d-325">Diagram</span></span>
![Diagramma Da applicazione nativa ad API Web](./media/active-directory-authentication-scenarios/native_app_to_web_api.png)

#### <a name="authentication-flow-for-native-application-to-api"></a><span data-ttu-id="97b2d-327">Flusso di autenticazione all'API per l'applicazione nativa</span><span class="sxs-lookup"><span data-stu-id="97b2d-327">Authentication flow for native application to API</span></span>
#### <a name="description-of-protocol-flow"></a><span data-ttu-id="97b2d-328">Descrizione del flusso del protocollo</span><span class="sxs-lookup"><span data-stu-id="97b2d-328">Description of Protocol Flow</span></span>
<span data-ttu-id="97b2d-329">Se si usano le librerie di autenticazione AD, la maggior parte dei dettagli del protocollo descritti di seguito viene gestita automaticamente, ad esempio i popup del browser, la memorizzazione dei token nella cache e la gestione dei token di aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="97b2d-329">If you are using the AD Authentication Libraries, most of the protocol details described below are handled for you, such as the browser pop-up, token caching, and handling of refresh tokens.</span></span>

1. <span data-ttu-id="97b2d-330">Con un popup del browser l'applicazione nativa invia una richiesta all'endpoint di autorizzazione in Azure AD.</span><span class="sxs-lookup"><span data-stu-id="97b2d-330">Using a browser pop-up, the native application makes a request to the authorization endpoint in Azure AD.</span></span> <span data-ttu-id="97b2d-331">Questa richiesta include l'ID applicazione e l'URI di reindirizzamento dell'applicazione nativa, come illustrato nel Portale di Azure, nonché l'URI ID dell'applicazione per l'API Web.</span><span class="sxs-lookup"><span data-stu-id="97b2d-331">This request includes the Application ID and the redirect URI of the native application as shown in the Azure Portal, and the application ID URI for the web API.</span></span> <span data-ttu-id="97b2d-332">Se l'utente non ha ancora eseguito l'accesso, verrà richiesto di accedere di nuovo.</span><span class="sxs-lookup"><span data-stu-id="97b2d-332">If the user hasn’t already signed in, they are prompted to sign in again</span></span>
2. <span data-ttu-id="97b2d-333">Azure AD autentica l'utente.</span><span class="sxs-lookup"><span data-stu-id="97b2d-333">Azure AD authenticates the user.</span></span> <span data-ttu-id="97b2d-334">Se si tratta di un'applicazione multi-tenant il cui uso richiede il consenso, verrà chiesto all'utente di fornire il consenso, se non l'ha già fatto.</span><span class="sxs-lookup"><span data-stu-id="97b2d-334">If it is a multi-tenant application and consent is required to use the application, the user will be required to consent if they haven’t already done so.</span></span> <span data-ttu-id="97b2d-335">Dopo che è stato fornito il consenso e l'autenticazione riesce, Azure AD restituisce un codice di autenticazione all'URI di reindirizzamento dell'applicazione client.</span><span class="sxs-lookup"><span data-stu-id="97b2d-335">After granting consent and upon successful authentication, Azure AD issues an authorization code response back to the client application’s redirect URI.</span></span>
3. <span data-ttu-id="97b2d-336">Quando Azure AD restituisce un codice di autorizzazione all'URI di reindirizzamento, l'applicazione interrompe l'interazione con il browser ed estrae il codice di autorizzazione dalla risposta.</span><span class="sxs-lookup"><span data-stu-id="97b2d-336">When Azure AD issues an authorization code response back to the redirect URI, the client application stops browser interaction and extracts the authorization code from the response.</span></span> <span data-ttu-id="97b2d-337">Con questo codice di autorizzazione l'applicazione client invia una richiesta all'endpoint token di Azure AD che include il codice di autorizzazione, dettagli sull'applicazione client (ID applicazione e URI di reindirizzamento) e la risorsa desiderata (URI ID applicazione per l'API Web).</span><span class="sxs-lookup"><span data-stu-id="97b2d-337">Using this authorization code, the client application sends a request to Azure AD’s token endpoint that includes the authorization code, details about the client application (Application ID and redirect URI), and the desired resource (application ID URI for the web API).</span></span>
4. <span data-ttu-id="97b2d-338">Il codice di autorizzazione e le informazioni sull'applicazione client e l'API Web vengono convalidati da Azure AD.</span><span class="sxs-lookup"><span data-stu-id="97b2d-338">The authorization code and information about the client application and web API are validated by Azure AD.</span></span> <span data-ttu-id="97b2d-339">Se la convalida riesce, Azure AD restituisce tue token: un token di accesso JWT e un token di aggiornamento JWT.</span><span class="sxs-lookup"><span data-stu-id="97b2d-339">Upon successful validation, Azure AD returns two tokens: a JWT access token and a JWT refresh token.</span></span> <span data-ttu-id="97b2d-340">Azure AD restituisce anche informazioni di base sull'utente, ad esempio il nome visualizzato e l'ID tenant.</span><span class="sxs-lookup"><span data-stu-id="97b2d-340">In addition, Azure AD returns basic information about the user, such as their display name and tenant ID.</span></span>
5. <span data-ttu-id="97b2d-341">Su HTTPS l'applicazione client usa il token di accesso JWT restituito per aggiungere la stringa JWT con una designazione "Bearer" nell'intestazione dell'autorizzazione della richiesta all'API Web.</span><span class="sxs-lookup"><span data-stu-id="97b2d-341">Over HTTPS, the client application uses the returned JWT access token to add the JWT string with a “Bearer” designation in the Authorization header of the request to the web API.</span></span> <span data-ttu-id="97b2d-342">L'API Web convalida quindi il token JWT e, se la convalida riesce, restituisce la risorsa desiderata.</span><span class="sxs-lookup"><span data-stu-id="97b2d-342">The web API then validates the JWT token, and if validation is successful, returns the desired resource.</span></span>
6. <span data-ttu-id="97b2d-343">Alla scadenza del token di accesso l'applicazione client riceverà un errore che indica che l'utente deve ripetere il processo di autenticazione.</span><span class="sxs-lookup"><span data-stu-id="97b2d-343">When the access token expires, the client application will receive an error that indicates the user needs to authenticate again.</span></span> <span data-ttu-id="97b2d-344">Se l'applicazione ha un token di aggiornamento valido, può essere usato per acquisire un nuovo token di accesso senza richiedere all'utente di ripetere l'accesso.</span><span class="sxs-lookup"><span data-stu-id="97b2d-344">If the application has a valid refresh token, it can be used to acquire a new access token without prompting the user to sign in again.</span></span> <span data-ttu-id="97b2d-345">Se il token di aggiornamento scade, l'applicazione dovrà autenticare di nuovo l'utente in modo interattivo.</span><span class="sxs-lookup"><span data-stu-id="97b2d-345">If the refresh token expires, the application will need to interactively authenticate the user once again.</span></span>

> [!NOTE]
> <span data-ttu-id="97b2d-346">Il token di aggiornamento emesso da Azure AD può essere usato per accedere a più risorse.</span><span class="sxs-lookup"><span data-stu-id="97b2d-346">The refresh token issued by Azure AD can be used to access multiple resources.</span></span> <span data-ttu-id="97b2d-347">Ad esempio, se un'applicazione client è autorizzata a chiamare due API Web, il token di aggiornamento può essere usato per ottenere un token di accesso anche all'altra API Web.</span><span class="sxs-lookup"><span data-stu-id="97b2d-347">For example, if you have a client application that has permission to call two web APIs, the refresh token can be used to get an access token to the other web API as well.</span></span>
> 
> 

#### <a name="code-samples"></a><span data-ttu-id="97b2d-348">Esempi di codice</span><span class="sxs-lookup"><span data-stu-id="97b2d-348">Code Samples</span></span>
<span data-ttu-id="97b2d-349">Vedere gli esempi di codice per gli scenari Da applicazione nativa ad API Web.</span><span class="sxs-lookup"><span data-stu-id="97b2d-349">See the code samples for Native Application to Web API scenarios.</span></span> <span data-ttu-id="97b2d-350">Consultare spesso questa pagina perché vengono aggiunti regolarmente nuovi esempi.</span><span class="sxs-lookup"><span data-stu-id="97b2d-350">And, check back frequently -- we add new samples all the time.</span></span> <span data-ttu-id="97b2d-351">[Da applicazione nativa ad API Web](active-directory-code-samples.md#native-application-to-web-api).</span><span class="sxs-lookup"><span data-stu-id="97b2d-351">[Native Application to Web API](active-directory-code-samples.md#native-application-to-web-api).</span></span>

#### <a name="registering"></a><span data-ttu-id="97b2d-352">Registrazione</span><span class="sxs-lookup"><span data-stu-id="97b2d-352">Registering</span></span>
* <span data-ttu-id="97b2d-353">Singolo tenant: l'applicazione nativa e l'API Web devono essere registrate nella stessa directory in Azure AD.</span><span class="sxs-lookup"><span data-stu-id="97b2d-353">Single Tenant: Both the native application and the web API must be registered in the same directory in Azure AD.</span></span> <span data-ttu-id="97b2d-354">L'API Web può essere configurata per esporre un set di autorizzazioni, che vengono usate per limitare l'accesso dell'applicazione nativa alle relative risorse.</span><span class="sxs-lookup"><span data-stu-id="97b2d-354">The web API can be configured to expose a set of permissions, which are used to limit the native application’s access to its resources.</span></span> <span data-ttu-id="97b2d-355">L'applicazione client seleziona quindi le autorizzazioni desiderate dal menu a discesa "Autorizzazioni per altre applicazioni" nel Portale di Azure.</span><span class="sxs-lookup"><span data-stu-id="97b2d-355">The client application then selects the desired permissions from the “Permissions to Other Applications” drop-down menu in the Azure Portal.</span></span>
* <span data-ttu-id="97b2d-356">Multi-tenant: prima di tutto, l'applicazione nativa è stata registrata solo nella directory dello sviluppatore o dell'editore.</span><span class="sxs-lookup"><span data-stu-id="97b2d-356">Multi-Tenant: First, the native application only ever registered in the developer or publisher’s directory.</span></span> <span data-ttu-id="97b2d-357">Quindi, l'applicazione nativa viene configurata per indicare le autorizzazioni necessarie per il funzionamento.</span><span class="sxs-lookup"><span data-stu-id="97b2d-357">Second, the native application is configured to indicate the permissions it requires to be functional.</span></span> <span data-ttu-id="97b2d-358">Questo elenco di autorizzazioni richieste viene visualizzato in una finestra di dialogo quando un utente o amministratore nella directory di destinazione concede il consenso all'applicazione, rendendola disponibile per la propria organizzazione.</span><span class="sxs-lookup"><span data-stu-id="97b2d-358">This list of required permissions is shown in a dialog when a user or administrator in the destination directory gives consent to the application, which makes it available to their organization.</span></span> <span data-ttu-id="97b2d-359">Alcune applicazioni richiedono solo autorizzazioni a livello utente, che possono essere concesse da qualsiasi utente dell'organizzazione.</span><span class="sxs-lookup"><span data-stu-id="97b2d-359">Some applications require just user-level permissions, which any user in the organization can consent to.</span></span> <span data-ttu-id="97b2d-360">Altre applicazioni richiedono autorizzazioni a livello amministratore, che non possono essere concesse dagli utenti dell'organizzazione.</span><span class="sxs-lookup"><span data-stu-id="97b2d-360">Other applications require administrator-level permissions, which a user in the organization cannot consent to.</span></span> <span data-ttu-id="97b2d-361">Solo un amministratore di directory può concedere il consenso alle applicazioni che richiedono questo livello di autorizzazione.</span><span class="sxs-lookup"><span data-stu-id="97b2d-361">Only a directory administrator can give consent to applications that require this level of permissions.</span></span> <span data-ttu-id="97b2d-362">Quando l'utente o l'amministratore acconsente, solo l'API Web viene registrata nella directory.</span><span class="sxs-lookup"><span data-stu-id="97b2d-362">When the user or administrator consents, only the web API is registered in their directory.</span></span> <span data-ttu-id="97b2d-363">Per ulteriori informazioni, vedere [Integrazione di applicazioni con Azure Active Directory](active-directory-integrating-applications.md).</span><span class="sxs-lookup"><span data-stu-id="97b2d-363">For more information, see [Integrating Applications with Azure Active Directory](active-directory-integrating-applications.md).</span></span>

#### <a name="token-expiration"></a><span data-ttu-id="97b2d-364">Scadenza del token</span><span class="sxs-lookup"><span data-stu-id="97b2d-364">Token Expiration</span></span>
<span data-ttu-id="97b2d-365">Quando l'applicazione nativa usa il proprio codice di autorizzazione per ottenere un token di accesso JWT, riceve anche un token di aggiornamento JWT.</span><span class="sxs-lookup"><span data-stu-id="97b2d-365">When the native application uses its authorization code to get a JWT access token, it also receives a JWT refresh token.</span></span> <span data-ttu-id="97b2d-366">Quando il token di accesso scade, è possibile usare il token di aggiornamento per autenticare di nuovo l'utente senza richiedere di ripetere l'accesso.</span><span class="sxs-lookup"><span data-stu-id="97b2d-366">When the access token expires, the refresh token can be used to re-authenticate the user without requiring them to sign in again.</span></span> <span data-ttu-id="97b2d-367">Questo token di aggiornamento viene quindi usato per autenticare l'utente, con conseguente emissione di un nuovo token di accesso e un nuovo token di aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="97b2d-367">This refresh token is then used to authenticate the user, which results in a new access token and refresh token.</span></span>

### <a name="web-application-to-web-api"></a><span data-ttu-id="97b2d-368">Da applicazione Web ad API Web</span><span class="sxs-lookup"><span data-stu-id="97b2d-368">Web Application to Web API</span></span>
<span data-ttu-id="97b2d-369">Questa sezione descrive un'applicazione Web che deve ottenere risorse da un'API Web.</span><span class="sxs-lookup"><span data-stu-id="97b2d-369">This section describes a web application that needs to get resources from a web API.</span></span> <span data-ttu-id="97b2d-370">In questo scenario esistono due tipi di identità che l'applicazione Web può usare per autenticare e chiamare l'API Web: un'identità applicazione e un'identità utente delegato.</span><span class="sxs-lookup"><span data-stu-id="97b2d-370">In this scenario, there are two identity types that the web application can use to authenticate and call the web API: an application identity, or a delegated user identity.</span></span>

<span data-ttu-id="97b2d-371">*Identità applicazione:* questo scenario usa la concessione di credenziali client OAuth 2.0 per l'autenticazione come applicazione e l'accesso all'API Web.</span><span class="sxs-lookup"><span data-stu-id="97b2d-371">*Application identity:* This scenario uses OAuth 2.0 client credentials grant to authenticate as the application and access the web API.</span></span> <span data-ttu-id="97b2d-372">Quando si usa un'identità applicazione, l'API Web può solo rilevare la chiamata dell'applicazione Web, perché non riceve informazioni relative all'utente.</span><span class="sxs-lookup"><span data-stu-id="97b2d-372">When using an application identity, the web API can only detect that the web application is calling it, as the web API does not receive any information about the user.</span></span> <span data-ttu-id="97b2d-373">Se l'applicazione riceve informazioni relative all'utente, queste vengono inviate tramite il protocollo applicativo e non sono firmate da Azure AD.</span><span class="sxs-lookup"><span data-stu-id="97b2d-373">If the application receives information about the user, it will be sent via the application protocol, and it is not signed by Azure AD.</span></span> <span data-ttu-id="97b2d-374">L'API Web confida che l'applicazione Web abbia autenticato l'utente.</span><span class="sxs-lookup"><span data-stu-id="97b2d-374">The web API trusts that the web application authenticated the user.</span></span> <span data-ttu-id="97b2d-375">Per questo motivo il modello è definito sottosistema attendibile.</span><span class="sxs-lookup"><span data-stu-id="97b2d-375">For this reason, this pattern is called a trusted subsystem.</span></span>

<span data-ttu-id="97b2d-376">*Identità utente delegato:* lo scenario può essere eseguito in due modi, ovvero OpenID Connect e concessione di codice di autorizzazione OAuth 2.0 con un client riservato.</span><span class="sxs-lookup"><span data-stu-id="97b2d-376">*Delegated user identity:* This scenario can be accomplished in two ways: OpenID Connect, and OAuth 2.0 authorization code grant with a confidential client.</span></span> <span data-ttu-id="97b2d-377">L'applicazione Web ottiene un token di accesso per l'utente, dimostrando all'API Web che l'utente è stato autenticato nell'applicazione Web e che l'applicazione Web è riuscita a ottenere un'identità utente delegato per chiamare l'API Web.</span><span class="sxs-lookup"><span data-stu-id="97b2d-377">The web application obtains an access token for the user, which proves to the web API that the user successfully authenticated to the web application and that the web application was able to obtain a delegated user identity to call the web API.</span></span> <span data-ttu-id="97b2d-378">Questo token di accesso viene inviato nella richiesta all'API Web, che autorizza l'utente e restituisce la risorsa desiderata.</span><span class="sxs-lookup"><span data-stu-id="97b2d-378">This access token is sent in the request to the web API, which authorizes the user and returns the desired resource.</span></span>

#### <a name="diagram"></a><span data-ttu-id="97b2d-379">Diagramma</span><span class="sxs-lookup"><span data-stu-id="97b2d-379">Diagram</span></span>
![Diagramma Da applicazione Web ad API Web](./media/active-directory-authentication-scenarios/web_app_to_web_api.png)

#### <a name="description-of-protocol-flow"></a><span data-ttu-id="97b2d-381">Descrizione del flusso del protocollo</span><span class="sxs-lookup"><span data-stu-id="97b2d-381">Description of Protocol Flow</span></span>
<span data-ttu-id="97b2d-382">Nel flusso che segue sono illustrati i tipi di identità applicazione e identità utente delegato.</span><span class="sxs-lookup"><span data-stu-id="97b2d-382">Both the application identity and delegated user identity types are discussed in the flow below.</span></span> <span data-ttu-id="97b2d-383">La differenza fondamentale consiste nel fatto che l'identità utente delegato deve acquisire un codice di autorizzazione prima che l'utente possa ottenere l'accesso all'API Web.</span><span class="sxs-lookup"><span data-stu-id="97b2d-383">The key difference between them is that the delegated user identity must first acquire an authorization code before the user can sign-in and gain access to the web API.</span></span>

##### <a name="application-identity-with-oauth-20-client-credentials-grant"></a><span data-ttu-id="97b2d-384">Identità applicazione con concessione delle credenziali client OAuth 2.0</span><span class="sxs-lookup"><span data-stu-id="97b2d-384">Application Identity with OAuth 2.0 Client Credentials Grant</span></span>
1. <span data-ttu-id="97b2d-385">Un utente esegue l'accesso ad Azure AD nell'applicazione Web (vedere la sezione precedente [Da Web browser ad applicazione Web](#web-browser-to-web-application) ).</span><span class="sxs-lookup"><span data-stu-id="97b2d-385">A user is signed in to Azure AD in the web application (see the [Web Browser to Web Application](#web-browser-to-web-application) above).</span></span>
2. <span data-ttu-id="97b2d-386">L'applicazione Web deve acquisire un token di accesso per l'autenticazione nell'API Web e il recupero della risorsa desiderata.</span><span class="sxs-lookup"><span data-stu-id="97b2d-386">The web application needs to acquire an access token so that it can authenticate to the web API and retrieve the desired resource.</span></span> <span data-ttu-id="97b2d-387">Esegue una richiesta all'endpoint token di Azure AD, fornendo credenziali, ID applicazione e URI ID applicazione dell'API Web.</span><span class="sxs-lookup"><span data-stu-id="97b2d-387">It makes a request to Azure AD’s token endpoint, providing the credential, Application ID, and web API’s application ID URI.</span></span>
3. <span data-ttu-id="97b2d-388">Azure AD autentica l'applicazione e restituisce un token di accesso JWT usato per chiamare l'API Web.</span><span class="sxs-lookup"><span data-stu-id="97b2d-388">Azure AD authenticates the application and returns a JWT access token that is used to call the web API.</span></span>
4. <span data-ttu-id="97b2d-389">Su HTTPS l'applicazione Web usa il token di accesso JWT restituito per aggiungere la stringa JWT con una designazione "Bearer" nell'intestazione dell'autorizzazione della richiesta all'API Web.</span><span class="sxs-lookup"><span data-stu-id="97b2d-389">Over HTTPS, the web application uses the returned JWT access token to add the JWT string with a “Bearer” designation in the Authorization header of the request to the web API.</span></span> <span data-ttu-id="97b2d-390">L'API Web convalida quindi il token JWT e, se la convalida riesce, restituisce la risorsa desiderata.</span><span class="sxs-lookup"><span data-stu-id="97b2d-390">The web API then validates the JWT token, and if validation is successful, returns the desired resource.</span></span>

##### <a name="delegated-user-identity-with-openid-connect"></a><span data-ttu-id="97b2d-391">Identità utente delegato con OpenID Connect</span><span class="sxs-lookup"><span data-stu-id="97b2d-391">Delegated User Identity with OpenID Connect</span></span>
1. <span data-ttu-id="97b2d-392">Un utente esegue l'accesso all'applicazione Web usando Azure AD (vedere la sezione precedente [Da Web browser ad applicazione Web](#web-browser-to-web-application) ).</span><span class="sxs-lookup"><span data-stu-id="97b2d-392">A user is signed in to a web application using Azure AD (see the [Web Browser to Web Application](#web-browser-to-web-application) section above).</span></span> <span data-ttu-id="97b2d-393">Se l'utente dell'applicazione Web non ha ancora concesso il consenso perché l'applicazione Web chiami l'API Web per suo conto, dovrà acconsentire.</span><span class="sxs-lookup"><span data-stu-id="97b2d-393">If the user of the web application has not yet consented to allowing the web application to call the web API on its behalf, the user will need to consent.</span></span> <span data-ttu-id="97b2d-394">L'applicazione visualizzerà le autorizzazioni richieste e, se si tratta di autorizzazione a livello amministratore, un utente normale della directory non potrà concedere il consenso.</span><span class="sxs-lookup"><span data-stu-id="97b2d-394">The application will display the permissions it requires, and if any of these are administrator-level permissions, a normal user in the directory will not be able to consent.</span></span> <span data-ttu-id="97b2d-395">Questo processo di consenso è valido solo per le applicazioni multi-tenant, non per le applicazioni con un singolo tenant, perché l'applicazione avrà già le autorizzazioni necessarie.</span><span class="sxs-lookup"><span data-stu-id="97b2d-395">This consent process only applies to multi-tenant applications, not single tenant applications, as the application will already have the necessary permissions.</span></span> <span data-ttu-id="97b2d-396">Quando l'utente ha eseguito l'accesso, l'applicazione Web ha ricevuto un token ID con le informazioni relative all'utente, nonché un codice di autorizzazione.</span><span class="sxs-lookup"><span data-stu-id="97b2d-396">When the user signed in, the web application received an ID token with information about the user, as well as an authorization code.</span></span>
2. <span data-ttu-id="97b2d-397">Con il codice di autorizzazione rilasciato da Azure AD, l'applicazione Web invia una richiesta all'endpoint token di Azure AD che include il codice di autorizzazione, dettagli sull'applicazione client (ID applicazione e URI di reindirizzamento) e la risorsa desiderata (URI ID applicazione per l'API Web).</span><span class="sxs-lookup"><span data-stu-id="97b2d-397">Using the authorization code issued by Azure AD, the web application sends a request to Azure AD’s token endpoint that includes the authorization code, details about the client application (Application ID and redirect URI), and the desired resource (application ID URI for the web API).</span></span>
3. <span data-ttu-id="97b2d-398">Il codice di autorizzazione e le informazioni sull'applicazione Web e l'API Web vengono convalidati da Azure AD.</span><span class="sxs-lookup"><span data-stu-id="97b2d-398">The authorization code and information about the web application and web API are validated by Azure AD.</span></span> <span data-ttu-id="97b2d-399">Se la convalida riesce, Azure AD restituisce tue token: un token di accesso JWT e un token di aggiornamento JWT.</span><span class="sxs-lookup"><span data-stu-id="97b2d-399">Upon successful validation, Azure AD returns two tokens: a JWT access token and a JWT refresh token.</span></span>
4. <span data-ttu-id="97b2d-400">Su HTTPS l'applicazione Web usa il token di accesso JWT restituito per aggiungere la stringa JWT con una designazione "Bearer" nell'intestazione dell'autorizzazione della richiesta all'API Web.</span><span class="sxs-lookup"><span data-stu-id="97b2d-400">Over HTTPS, the web application uses the returned JWT access token to add the JWT string with a “Bearer” designation in the Authorization header of the request to the web API.</span></span> <span data-ttu-id="97b2d-401">L'API Web convalida quindi il token JWT e, se la convalida riesce, restituisce la risorsa desiderata.</span><span class="sxs-lookup"><span data-stu-id="97b2d-401">The web API then validates the JWT token, and if validation is successful, returns the desired resource.</span></span>

##### <a name="delegated-user-identity-with-oauth-20-authorization-code-grant"></a><span data-ttu-id="97b2d-402">Identità utente delegato con concessione del codice di autorizzazione OAuth 2.0</span><span class="sxs-lookup"><span data-stu-id="97b2d-402">Delegated User Identity with OAuth 2.0 Authorization Code Grant</span></span>
1. <span data-ttu-id="97b2d-403">Un utente ha già eseguito l'accesso all'applicazione Web, il cui meccanismo di autenticazione è indipendente da Azure AD.</span><span class="sxs-lookup"><span data-stu-id="97b2d-403">A user is already signed in to a web application, whose authentication mechanism is independent of Azure AD.</span></span>
2. <span data-ttu-id="97b2d-404">L'applicazione Web richiede un codice di autorizzazione per acquisire un token di accesso, quindi invia una richiesta tramite il browser all'endpoint di autorizzazione di Azure AD, fornendo l'ID applicazione e l'URI di reindirizzamento per l'applicazione Web al termine dell'autenticazione.</span><span class="sxs-lookup"><span data-stu-id="97b2d-404">The web application requires an authorization code to acquire an access token, so it issues a request through the browser to Azure AD’s authorization endpoint, providing the Application ID and redirect URI for the web application after successful authentication.</span></span> <span data-ttu-id="97b2d-405">L'utente accede ad Azure AD.</span><span class="sxs-lookup"><span data-stu-id="97b2d-405">The user signs in to Azure AD.</span></span>
3. <span data-ttu-id="97b2d-406">Se l'utente dell'applicazione Web non ha ancora concesso il consenso perché l'applicazione Web chiami l'API Web per suo conto, dovrà acconsentire.</span><span class="sxs-lookup"><span data-stu-id="97b2d-406">If the user of the web application has not yet consented to allowing the web application to call the web API on its behalf, the user will need to consent.</span></span> <span data-ttu-id="97b2d-407">L'applicazione visualizzerà le autorizzazioni richieste e, se si tratta di autorizzazione a livello amministratore, un utente normale della directory non potrà concedere il consenso.</span><span class="sxs-lookup"><span data-stu-id="97b2d-407">The application will display the permissions it requires, and if any of these are administrator-level permissions, a normal user in the directory will not be able to consent.</span></span> <span data-ttu-id="97b2d-408">Il consenso si applica sia all'applicazione a tenant singolo che multi-tenant.</span><span class="sxs-lookup"><span data-stu-id="97b2d-408">This consent applies to both single and multi-tenant application.</span></span>  <span data-ttu-id="97b2d-409">In un'applicazione a tenant singolo l'amministratore può eseguire il consenso dell'amministratore per acconsentire per conto degli utenti.</span><span class="sxs-lookup"><span data-stu-id="97b2d-409">In the single tenant case, an admin can perform admin consent to consent on behalf of their users.</span></span>  <span data-ttu-id="97b2d-410">Per questa operazione è possibile usare il pulsante `Grant Permissions` nel [portale di Azure](https://portal.azure.com).</span><span class="sxs-lookup"><span data-stu-id="97b2d-410">This can be done using the `Grant Permissions` button in the [Azure Portal](https://portal.azure.com).</span></span> 
4. <span data-ttu-id="97b2d-411">Quando l'utente concede il consenso, l'applicazione Web riceve il codice di autorizzazione necessario per acquisire un token di accesso.</span><span class="sxs-lookup"><span data-stu-id="97b2d-411">After the user has consented, the web application receives the authorization code that it needs to acquire an access token.</span></span>
5. <span data-ttu-id="97b2d-412">Con il codice di autorizzazione rilasciato da Azure AD, l'applicazione Web invia una richiesta all'endpoint token di Azure AD che include il codice di autorizzazione, dettagli sull'applicazione client (ID applicazione e URI di reindirizzamento) e la risorsa desiderata (URI ID applicazione per l'API Web).</span><span class="sxs-lookup"><span data-stu-id="97b2d-412">Using the authorization code issued by Azure AD, the web application sends a request to Azure AD’s token endpoint that includes the authorization code, details about the client application (Application ID and redirect URI), and the desired resource (application ID URI for the web API).</span></span>
6. <span data-ttu-id="97b2d-413">Il codice di autorizzazione e le informazioni sull'applicazione Web e l'API Web vengono convalidati da Azure AD.</span><span class="sxs-lookup"><span data-stu-id="97b2d-413">The authorization code and information about the web application and web API are validated by Azure AD.</span></span> <span data-ttu-id="97b2d-414">Se la convalida riesce, Azure AD restituisce tue token: un token di accesso JWT e un token di aggiornamento JWT.</span><span class="sxs-lookup"><span data-stu-id="97b2d-414">Upon successful validation, Azure AD returns two tokens: a JWT access token and a JWT refresh token.</span></span>
7. <span data-ttu-id="97b2d-415">Su HTTPS l'applicazione Web usa il token di accesso JWT restituito per aggiungere la stringa JWT con una designazione "Bearer" nell'intestazione dell'autorizzazione della richiesta all'API Web.</span><span class="sxs-lookup"><span data-stu-id="97b2d-415">Over HTTPS, the web application uses the returned JWT access token to add the JWT string with a “Bearer” designation in the Authorization header of the request to the web API.</span></span> <span data-ttu-id="97b2d-416">L'API Web convalida quindi il token JWT e, se la convalida riesce, restituisce la risorsa desiderata.</span><span class="sxs-lookup"><span data-stu-id="97b2d-416">The web API then validates the JWT token, and if validation is successful, returns the desired resource.</span></span>

#### <a name="code-samples"></a><span data-ttu-id="97b2d-417">Esempi di codice</span><span class="sxs-lookup"><span data-stu-id="97b2d-417">Code Samples</span></span>
<span data-ttu-id="97b2d-418">Vedere gli esempi di codice per gli scenari Da applicazione Web ad API Web.</span><span class="sxs-lookup"><span data-stu-id="97b2d-418">See the code samples for Web Application to Web API scenarios.</span></span> <span data-ttu-id="97b2d-419">Consultare spesso questa pagina perché vengono aggiunti regolarmente nuovi esempi.</span><span class="sxs-lookup"><span data-stu-id="97b2d-419">And, check back frequently -- we add new samples all the time.</span></span> <span data-ttu-id="97b2d-420">[Da applicazione Web ad API Web](active-directory-code-samples.md#web-application-to-web-api).</span><span class="sxs-lookup"><span data-stu-id="97b2d-420">Web [Application to Web API](active-directory-code-samples.md#web-application-to-web-api).</span></span>

#### <a name="registering"></a><span data-ttu-id="97b2d-421">Registrazione</span><span class="sxs-lookup"><span data-stu-id="97b2d-421">Registering</span></span>
* <span data-ttu-id="97b2d-422">Singolo tenant: in entrambi i casi (identità applicazione e identità utente delegato), l'applicazione Web e l'API Web devono essere registrate nella stessa directory in Azure AD.</span><span class="sxs-lookup"><span data-stu-id="97b2d-422">Single Tenant: For both the application identity and delegated user identity cases, the web application and the web API must be registered in the same directory in Azure AD.</span></span> <span data-ttu-id="97b2d-423">L'API Web può essere configurata per esporre un set di autorizzazioni, che vengono usate per limitare l'accesso dell'applicazione Web alle relative risorse.</span><span class="sxs-lookup"><span data-stu-id="97b2d-423">The web API can be configured to expose a set of permissions, which are used to limit the web application’s access to its resources.</span></span> <span data-ttu-id="97b2d-424">Se viene usato il tipo di identità utente delegato, l'applicazione Web deve selezionare le autorizzazioni desiderate dal menu a discesa "Autorizzazioni per altre applicazioni" nel Portale di Azure.</span><span class="sxs-lookup"><span data-stu-id="97b2d-424">If a delegated user identity type is being used, the web application needs to select the desired permissions from the “Permissions to Other Applications” drop-down menu in the Azure Portal.</span></span> <span data-ttu-id="97b2d-425">Questo passaggio non è necessario se viene usato il tipo di identità applicazione.</span><span class="sxs-lookup"><span data-stu-id="97b2d-425">This step is not required if the application identity type is being used.</span></span>
* <span data-ttu-id="97b2d-426">Multi-tenant: per prima cosa, l'applicazione Web viene configurata per indicare le autorizzazioni necessarie per il funzionamento.</span><span class="sxs-lookup"><span data-stu-id="97b2d-426">Multi-Tenant: First, the web application is configured to indicate the permissions it requires to be functional.</span></span> <span data-ttu-id="97b2d-427">Questo elenco di autorizzazioni richieste viene visualizzato in una finestra di dialogo quando un utente o amministratore nella directory di destinazione concede il consenso all'applicazione, rendendola disponibile per la propria organizzazione.</span><span class="sxs-lookup"><span data-stu-id="97b2d-427">This list of required permissions is shown in a dialog when a user or administrator in the destination directory gives consent to the application, which makes it available to their organization.</span></span> <span data-ttu-id="97b2d-428">Alcune applicazioni richiedono solo autorizzazioni a livello utente, che possono essere concesse da qualsiasi utente dell'organizzazione.</span><span class="sxs-lookup"><span data-stu-id="97b2d-428">Some applications require just user-level permissions, which any user in the organization can consent to.</span></span> <span data-ttu-id="97b2d-429">Altre applicazioni richiedono autorizzazioni a livello amministratore, che non possono essere concesse dagli utenti dell'organizzazione.</span><span class="sxs-lookup"><span data-stu-id="97b2d-429">Other applications require administrator-level permissions, which a user in the organization cannot consent to.</span></span> <span data-ttu-id="97b2d-430">Solo un amministratore di directory può concedere il consenso alle applicazioni che richiedono questo livello di autorizzazione.</span><span class="sxs-lookup"><span data-stu-id="97b2d-430">Only a directory administrator can give consent to applications that require this level of permissions.</span></span> <span data-ttu-id="97b2d-431">Quando l'utente o l'amministratore acconsente, l'applicazione Web e l'API Web vengono registrate nella directory.</span><span class="sxs-lookup"><span data-stu-id="97b2d-431">When the user or administrator consents, the web application and the web API are both registered in their directory.</span></span>

#### <a name="token-expiration"></a><span data-ttu-id="97b2d-432">Scadenza del token</span><span class="sxs-lookup"><span data-stu-id="97b2d-432">Token Expiration</span></span>
<span data-ttu-id="97b2d-433">Quando l'applicazione Web usa il proprio codice di autorizzazione per ottenere un token di accesso JWT, riceve anche un token di aggiornamento JWT.</span><span class="sxs-lookup"><span data-stu-id="97b2d-433">When the web application uses its authorization code to get a JWT access token, it also receives a JWT refresh token.</span></span> <span data-ttu-id="97b2d-434">Quando il token di accesso scade, è possibile usare il token di aggiornamento per autenticare di nuovo l'utente senza richiedere di ripetere l'accesso.</span><span class="sxs-lookup"><span data-stu-id="97b2d-434">When the access token expires, the refresh token can be used to re-authenticate the user without requiring them to sign in again.</span></span> <span data-ttu-id="97b2d-435">Questo token di aggiornamento viene quindi usato per autenticare l'utente, con conseguente emissione di un nuovo token di accesso e un nuovo token di aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="97b2d-435">This refresh token is then used to authenticate the user, which results in a new access token and refresh token.</span></span>

### <a name="daemon-or-server-application-to-web-api"></a><span data-ttu-id="97b2d-436">Da daemon o applicazione server ad API Web</span><span class="sxs-lookup"><span data-stu-id="97b2d-436">Daemon or Server Application to Web API</span></span>
<span data-ttu-id="97b2d-437">Questa sezione descrive un'applicazione daemon o server che deve ottenere risorse da un'API Web.</span><span class="sxs-lookup"><span data-stu-id="97b2d-437">This section describes a daemon or server application that needs to get resources from a web API.</span></span> <span data-ttu-id="97b2d-438">A questa sezione sono applicabili due sottoscenari: un'applicazione daemon che deve chiamare un'API Web, basata sul tipo di concessione di credenziali client OAuth 2.0, e un'applicazione server (ad esempio un'API Web) che deve chiamare un'API Web, basata sulla bozza di specifica OAuth 2.0 On-Behalf-Of.</span><span class="sxs-lookup"><span data-stu-id="97b2d-438">There are two sub-scenarios that apply to this section: A daemon that needs to call a web API, built on OAuth 2.0 client credentials grant type; and a server application (such as a web API) that needs to call a web API, built on OAuth 2.0 On-Behalf-Of draft specification.</span></span>

<span data-ttu-id="97b2d-439">Per lo scenario in cui un'applicazione daemon deve chiamare un'API Web, è importante comprendere alcuni aspetti.</span><span class="sxs-lookup"><span data-stu-id="97b2d-439">For the scenario when a daemon application needs to call a web API, it’s important to understand a few things.</span></span> <span data-ttu-id="97b2d-440">Prima di tutto, l'interazione utente non è possibile con un'applicazione daemon, che richiede che l'applicazione abbia una propria identità.</span><span class="sxs-lookup"><span data-stu-id="97b2d-440">First, user interaction is not possible with a daemon application, which requires the application to have its own identity.</span></span> <span data-ttu-id="97b2d-441">Un esempio di applicazione daemon è un processo batch oppure un servizio del sistema operativo in esecuzione in background.</span><span class="sxs-lookup"><span data-stu-id="97b2d-441">An example of a daemon application is a batch job, or an operating system service running in the background.</span></span> <span data-ttu-id="97b2d-442">Questo tipo di applicazione richiede un token di accesso usando la relativa identità applicazione e presentando l'ID applicazione, le credenziali (password o certificato) e l'URI ID dell'applicazione ad Azure AD.</span><span class="sxs-lookup"><span data-stu-id="97b2d-442">This type of application requests an access token by using its application identity and presenting its Application ID, credential (password or certificate), and application ID URI to Azure AD.</span></span> <span data-ttu-id="97b2d-443">Dopo l'autenticazione, il daemon riceve un token di accesso da Azure AD, che viene quindi usato per chiamare l'API Web.</span><span class="sxs-lookup"><span data-stu-id="97b2d-443">After successful authentication, the daemon receives an access token from Azure AD, which is then used to call the web API.</span></span>

<span data-ttu-id="97b2d-444">Per lo scenario in cui un'applicazione server deve chiamare un'API Web, è utile usare un esempio.</span><span class="sxs-lookup"><span data-stu-id="97b2d-444">For the scenario when a server application needs to call a web API, it’s helpful to use an example.</span></span> <span data-ttu-id="97b2d-445">Si supponga che un utente abbia eseguito l'autenticazione in un'applicazione nativa e che questa abbia l'esigenza di chiamare un'API Web.</span><span class="sxs-lookup"><span data-stu-id="97b2d-445">Imagine that a user has authenticated on a native application, and this native application needs to call a web API.</span></span> <span data-ttu-id="97b2d-446">Azure AD rilascia un token di accesso JWT per chiamare l'API Web.</span><span class="sxs-lookup"><span data-stu-id="97b2d-446">Azure AD issues a JWT access token to call the web API.</span></span> <span data-ttu-id="97b2d-447">Se l'API Web deve chiamare un'altra API Web a valle, può usare il flusso "on-behalf-of" per delegare l'identità dell'utente ed eseguire l'autenticazione nell'API Web di secondo livello.</span><span class="sxs-lookup"><span data-stu-id="97b2d-447">If the web API needs to call another downstream web API, it can use the on-behalf-of flow to delegate the user’s identity and authenticate to the second-tier web API.</span></span>

#### <a name="diagram"></a><span data-ttu-id="97b2d-448">Diagramma</span><span class="sxs-lookup"><span data-stu-id="97b2d-448">Diagram</span></span>
![Diagramma Da daemon o applicazione server ad API Web](./media/active-directory-authentication-scenarios/daemon_server_app_to_web_api.png)

#### <a name="description-of-protocol-flow"></a><span data-ttu-id="97b2d-450">Descrizione del flusso del protocollo</span><span class="sxs-lookup"><span data-stu-id="97b2d-450">Description of Protocol Flow</span></span>
##### <a name="application-identity-with-oauth-20-client-credentials-grant"></a><span data-ttu-id="97b2d-451">Identità applicazione con concessione delle credenziali client OAuth 2.0</span><span class="sxs-lookup"><span data-stu-id="97b2d-451">Application Identity with OAuth 2.0 Client Credentials Grant</span></span>
1. <span data-ttu-id="97b2d-452">Per prima cosa, l'applicazione server deve eseguire l'autenticazione in Azure AD senza intervento dell'utente, ad esempio senza finestra di dialogo di accesso interattiva.</span><span class="sxs-lookup"><span data-stu-id="97b2d-452">First, the server application needs to authenticate with Azure AD as itself, without any human interaction such as an interactive sign-on dialog.</span></span> <span data-ttu-id="97b2d-453">Esegue una richiesta all'endpoint token di Azure AD, fornendo credenziali, ID applicazione e URI ID applicazione.</span><span class="sxs-lookup"><span data-stu-id="97b2d-453">It makes a request to Azure AD’s token endpoint, providing the credential, Application ID, and application ID URI.</span></span>
2. <span data-ttu-id="97b2d-454">Azure AD autentica l'applicazione e restituisce un token di accesso JWT usato per chiamare l'API Web.</span><span class="sxs-lookup"><span data-stu-id="97b2d-454">Azure AD authenticates the application and returns a JWT access token that is used to call the web API.</span></span>
3. <span data-ttu-id="97b2d-455">Su HTTPS l'applicazione Web usa il token di accesso JWT restituito per aggiungere la stringa JWT con una designazione "Bearer" nell'intestazione dell'autorizzazione della richiesta all'API Web.</span><span class="sxs-lookup"><span data-stu-id="97b2d-455">Over HTTPS, the web application uses the returned JWT access token to add the JWT string with a “Bearer” designation in the Authorization header of the request to the web API.</span></span> <span data-ttu-id="97b2d-456">L'API Web convalida quindi il token JWT e, se la convalida riesce, restituisce la risorsa desiderata.</span><span class="sxs-lookup"><span data-stu-id="97b2d-456">The web API then validates the JWT token, and if validation is successful, returns the desired resource.</span></span>

##### <a name="delegated-user-identity-with-oauth-20-on-behalf-of-draft-specification"></a><span data-ttu-id="97b2d-457">Identità utente delegato con la bozza di specifica OAuth 2.0 On-Behalf-Of</span><span class="sxs-lookup"><span data-stu-id="97b2d-457">Delegated User Identity with OAuth 2.0 On-Behalf-Of Draft Specification</span></span>
<span data-ttu-id="97b2d-458">Il flusso descritto di seguito presuppone che un utente abbia eseguito l'autenticazione in un'altra applicazione (ad esempio un'applicazione nativa) e che la relativa identità utente sia stata usata per acquisire un token di accesso all'API Web di primo livello.</span><span class="sxs-lookup"><span data-stu-id="97b2d-458">The flow discussed below assumes that a user has been authenticated on another application (such as a native application), and their user identity has been used to acquire an access token to the first-tier web API.</span></span>

1. <span data-ttu-id="97b2d-459">L'applicazione nativa invia il token di accesso all'API Web di primo livello.</span><span class="sxs-lookup"><span data-stu-id="97b2d-459">The native application sends the access token to the first-tier web API.</span></span>
2. <span data-ttu-id="97b2d-460">L'API Web di primo livello invia una richiesta all'endpoint token di Azure AD, inviando l'ID applicazione e le credenziali, oltre al token di accesso dell'utente.</span><span class="sxs-lookup"><span data-stu-id="97b2d-460">The first-tier web API sends a request to Azure AD’s token endpoint, providing its Application ID and credentials, as well as the user’s access token.</span></span> <span data-ttu-id="97b2d-461">Inoltre, la richiesta viene inviata con un parametro on_behalf_of che indica che l'API Web richiede nuovi token per chiamare un'API Web a valle per conto dell'utente originale.</span><span class="sxs-lookup"><span data-stu-id="97b2d-461">In addition, the request is sent with an on_behalf_of parameter that indicates the web API is requesting new tokens to call a downstream web API on behalf of the original user.</span></span>
3. <span data-ttu-id="97b2d-462">Azure AD verifica che l'API Web di primo livello sia autorizzata ad accedere all'API Web di secondo livello e convalidi la richiesta, restituendo un token di accesso JWT e un token di aggiornamento JWT all'API Web di primo livello.</span><span class="sxs-lookup"><span data-stu-id="97b2d-462">Azure AD verifies that the first-tier web API has permissions to access the second-tier web API and validates the request, returning a JWT access token and a JWT refresh token to the first-tier web API.</span></span>
4. <span data-ttu-id="97b2d-463">Su HTTPS, l'API Web di primo livello chiama l'API Web di secondo livello aggiungendo la stringa del token all'intestazione dell'autorizzazione nella richiesta.</span><span class="sxs-lookup"><span data-stu-id="97b2d-463">Over HTTPS, the first-tier web API then calls the second-tier web API by appending the token string in the Authorization header in the request.</span></span> <span data-ttu-id="97b2d-464">L'API Web di primo livello può continuare a chiamare l'API Web di secondo livello finché il token di accesso e i token di aggiornamento sono validi.</span><span class="sxs-lookup"><span data-stu-id="97b2d-464">The first-tier web API can continue to call the second-tier web API as long as the access token and refresh tokens are valid.</span></span>

#### <a name="code-samples"></a><span data-ttu-id="97b2d-465">Esempi di codice</span><span class="sxs-lookup"><span data-stu-id="97b2d-465">Code Samples</span></span>
<span data-ttu-id="97b2d-466">Vedere gli esempi di codice per gli scenari Da applicazione daemon o server ad API Web.</span><span class="sxs-lookup"><span data-stu-id="97b2d-466">See the code samples for Daemon or Server Application to Web API scenarios.</span></span> <span data-ttu-id="97b2d-467">Consultare spesso questa pagina perché vengono aggiunti regolarmente nuovi esempi.</span><span class="sxs-lookup"><span data-stu-id="97b2d-467">And, check back frequently -- we add new samples all the time.</span></span> [<span data-ttu-id="97b2d-468">Applicazione server o daemon ad API Web</span><span class="sxs-lookup"><span data-stu-id="97b2d-468">Server or Daemon Application to Web API</span></span>](active-directory-code-samples.md#server-or-daemon-application-to-web-api)

#### <a name="registering"></a><span data-ttu-id="97b2d-469">Registrazione</span><span class="sxs-lookup"><span data-stu-id="97b2d-469">Registering</span></span>
* <span data-ttu-id="97b2d-470">Singolo tenant: in entrambi i casi (identità applicazione e identità utente delegato), l'applicazione daemon o server deve essere registrata nella stessa directory in Azure AD.</span><span class="sxs-lookup"><span data-stu-id="97b2d-470">Single Tenant: For both the application identity and delegated user identity cases, the daemon or server application must be registered in the same directory in Azure AD.</span></span> <span data-ttu-id="97b2d-471">L'API Web può essere configurata per esporre un set di autorizzazioni, che vengono usate per limitare l'accesso del daemon o del server alle relative risorse.</span><span class="sxs-lookup"><span data-stu-id="97b2d-471">The web API can be configured to expose a set of permissions, which are used to limit the daemon or server’s access to its resources.</span></span> <span data-ttu-id="97b2d-472">Se viene usato il tipo di identità utente delegato, l'applicazione server deve selezionare le autorizzazioni desiderate dal menu a discesa "Autorizzazioni per altre applicazioni" nel Portale di Azure.</span><span class="sxs-lookup"><span data-stu-id="97b2d-472">If a delegated user identity type is being used, the server application needs to select the desired permissions from the “Permissions to Other Applications” drop-down menu in the Azure Portal.</span></span> <span data-ttu-id="97b2d-473">Questo passaggio non è necessario se viene usato il tipo di identità applicazione.</span><span class="sxs-lookup"><span data-stu-id="97b2d-473">This step is not required if the application identity type is being used.</span></span>
* <span data-ttu-id="97b2d-474">Multi-tenant: per prima cosa, l'applicazione daemon o server viene configurata per indicare le autorizzazioni necessarie per il funzionamento.</span><span class="sxs-lookup"><span data-stu-id="97b2d-474">Multi-Tenant: First, the daemon or server application is configured to indicate the permissions it requires to be functional.</span></span> <span data-ttu-id="97b2d-475">Questo elenco di autorizzazioni richieste viene visualizzato in una finestra di dialogo quando un utente o amministratore nella directory di destinazione concede il consenso all'applicazione, rendendola disponibile per la propria organizzazione.</span><span class="sxs-lookup"><span data-stu-id="97b2d-475">This list of required permissions is shown in a dialog when a user or administrator in the destination directory gives consent to the application, which makes it available to their organization.</span></span> <span data-ttu-id="97b2d-476">Alcune applicazioni richiedono solo autorizzazioni a livello utente, che possono essere concesse da qualsiasi utente dell'organizzazione.</span><span class="sxs-lookup"><span data-stu-id="97b2d-476">Some applications require just user-level permissions, which any user in the organization can consent to.</span></span> <span data-ttu-id="97b2d-477">Altre applicazioni richiedono autorizzazioni a livello amministratore, che non possono essere concesse dagli utenti dell'organizzazione.</span><span class="sxs-lookup"><span data-stu-id="97b2d-477">Other applications require administrator-level permissions, which a user in the organization cannot consent to.</span></span> <span data-ttu-id="97b2d-478">Solo un amministratore di directory può concedere il consenso alle applicazioni che richiedono questo livello di autorizzazione.</span><span class="sxs-lookup"><span data-stu-id="97b2d-478">Only a directory administrator can give consent to applications that require this level of permissions.</span></span> <span data-ttu-id="97b2d-479">Quando l'utente o l'amministratore acconsente, entrambe le API Web vengono registrate nella directory.</span><span class="sxs-lookup"><span data-stu-id="97b2d-479">When the user or administrator consents, both of the web APIs are registered in their directory.</span></span>

#### <a name="token-expiration"></a><span data-ttu-id="97b2d-480">Scadenza del token</span><span class="sxs-lookup"><span data-stu-id="97b2d-480">Token Expiration</span></span>
<span data-ttu-id="97b2d-481">Quando la prima applicazione usa il proprio codice di autorizzazione per ottenere un token di accesso JWT, riceve anche un token di aggiornamento JWT.</span><span class="sxs-lookup"><span data-stu-id="97b2d-481">When the first application uses its authorization code to get a JWT access token, it also receives a JWT refresh token.</span></span> <span data-ttu-id="97b2d-482">Quando il token di accesso scade, è possibile usare il token di aggiornamento per autenticare di nuovo l'utente senza richiedere l'immissione delle credenziali.</span><span class="sxs-lookup"><span data-stu-id="97b2d-482">When the access token expires, the refresh token can be used to re-authenticate the user without prompting for credentials.</span></span> <span data-ttu-id="97b2d-483">Questo token di aggiornamento viene quindi usato per autenticare l'utente, con conseguente emissione di un nuovo token di accesso e un nuovo token di aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="97b2d-483">This refresh token is then used to authenticate the user, which results in a new access token and refresh token.</span></span>

## <a name="see-also"></a><span data-ttu-id="97b2d-484">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="97b2d-484">See Also</span></span>
[<span data-ttu-id="97b2d-485">Guida per gli sviluppatori di Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="97b2d-485">Azure Active Directory Developer's Guide</span></span>](active-directory-developers-guide.md)

[<span data-ttu-id="97b2d-486">Esempi di codice di Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="97b2d-486">Azure Active Directory Code Samples</span></span>](active-directory-code-samples.md)

[<span data-ttu-id="97b2d-487">Informazioni importanti sul rollover della chiave di firma in Azure AD</span><span class="sxs-lookup"><span data-stu-id="97b2d-487">Important Information About Signing Key Rollover in Azure AD</span></span>](active-directory-signing-key-rollover.md)

[<span data-ttu-id="97b2d-488">OAuth 2.0 in Azure AD</span><span class="sxs-lookup"><span data-stu-id="97b2d-488">OAuth 2.0 in Azure AD</span></span>](https://msdn.microsoft.com/library/azure/dn645545.aspx)

