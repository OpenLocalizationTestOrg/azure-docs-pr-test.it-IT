---
title: Monitoraggio degli endpoint di Gestione traffico di Azure | Microsoft Docs
description: "Questo articolo illustra in che modo Gestione traffico usa il monitoraggio e il failover automatico degli endpoint per consentire ai clienti di Azure di distribuire applicazioni a disponibilità elevata"
services: traffic-manager
documentationcenter: 
author: kumudd
manager: timlt
editor: 
ms.assetid: fff25ac3-d13a-4af9-8916-7c72e3d64bc7
ms.service: traffic-manager
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 06/22/2017
ms.author: kumud
ms.openlocfilehash: 5ce000814f2f5899a7338fdefb39c4873c006b1d
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 07/11/2017
---
# <a name="traffic-manager-endpoint-monitoring"></a><span data-ttu-id="06381-103">Monitoraggio degli endpoint di Gestione traffico</span><span class="sxs-lookup"><span data-stu-id="06381-103">Traffic Manager endpoint monitoring</span></span>

<span data-ttu-id="06381-104">Gestione traffico di Azure include il monitoraggio degli endpoint e il failover automatico degli endpoint.</span><span class="sxs-lookup"><span data-stu-id="06381-104">Azure Traffic Manager includes built-in endpoint monitoring and automatic endpoint failover.</span></span> <span data-ttu-id="06381-105">Questa funzionalità consente di distribuire applicazioni a disponibilità elevata resilienti agli errori di endpoint, inclusi gli errori di area di Azure.</span><span class="sxs-lookup"><span data-stu-id="06381-105">This feature helps you deliver high-availability applications that are resilient to endpoint failure, including Azure region failures.</span></span>

## <a name="configure-endpoint-monitoring"></a><span data-ttu-id="06381-106">Configurare il monitoraggio degli endpoint</span><span class="sxs-lookup"><span data-stu-id="06381-106">Configure endpoint monitoring</span></span>

<span data-ttu-id="06381-107">Per configurare il monitoraggio degli endpoint è necessario specificare le seguenti impostazioni nel profilo di Gestione traffico:</span><span class="sxs-lookup"><span data-stu-id="06381-107">To configure endpoint monitoring, you must specify the following settings on your Traffic Manager profile:</span></span>

* <span data-ttu-id="06381-108">**Protocollo**.</span><span class="sxs-lookup"><span data-stu-id="06381-108">**Protocol**.</span></span> <span data-ttu-id="06381-109">Scegliere HTTP, HTTPS o TCP come protocollo che Gestione traffico usa quando esegue il sondaggio dell'endpoint per verificarne l'integrità.</span><span class="sxs-lookup"><span data-stu-id="06381-109">Choose HTTP, HTTPS, or TCP as the protocol that Traffic Manager uses when probing your endpoint to check its health.</span></span> <span data-ttu-id="06381-110">Il monitoraggio HTTPS non verifica la validità del certificato SSL, ma solo la presenza.</span><span class="sxs-lookup"><span data-stu-id="06381-110">HTTPS monitoring does not verify whether your SSL certificate is valid--it only checks that the certificate is present.</span></span>
* <span data-ttu-id="06381-111">**Porta**.</span><span class="sxs-lookup"><span data-stu-id="06381-111">**Port**.</span></span> <span data-ttu-id="06381-112">scegliere la porta usata per la richiesta.</span><span class="sxs-lookup"><span data-stu-id="06381-112">Choose the port used for the request.</span></span>
* <span data-ttu-id="06381-113">**Percorso**.</span><span class="sxs-lookup"><span data-stu-id="06381-113">**Path**.</span></span> <span data-ttu-id="06381-114">Questa impostazione di configurazione è valida solo per i protocolli HTTP e HTTPS, per i quali è necessario specificare l'impostazione del percorso.</span><span class="sxs-lookup"><span data-stu-id="06381-114">This configuration setting is valid only for the HTTP and HTTPS protocols, for which specifying the path setting is required.</span></span> <span data-ttu-id="06381-115">Se si specifica questa impostazione per il protocollo di monitoraggio TCP, viene generato un errore.</span><span class="sxs-lookup"><span data-stu-id="06381-115">Providing this setting for the TCP monitoring protocol results in an error.</span></span> <span data-ttu-id="06381-116">Per il protocollo TCP specificare il percorso relativo e il nome della pagina Web o il file a cui accede il monitoraggio.</span><span class="sxs-lookup"><span data-stu-id="06381-116">For TCP protocol, give the relative path and the name of the webpage or the file that the monitoring accesses.</span></span> <span data-ttu-id="06381-117">Una barra (/) è una voce valida per il percorso relativo.</span><span class="sxs-lookup"><span data-stu-id="06381-117">A forward slash (/) is a valid entry for the relative path.</span></span> <span data-ttu-id="06381-118">Questo valore implica che il file sia nella directory radice (impostazione predefinita).</span><span class="sxs-lookup"><span data-stu-id="06381-118">This value implies that the file is in the root directory (default).</span></span>
* <span data-ttu-id="06381-119">**Intervallo sondaggio**.</span><span class="sxs-lookup"><span data-stu-id="06381-119">**Probing Interval**.</span></span> <span data-ttu-id="06381-120">Questo valore specifica la frequenza con cui viene controllata l'integrità di un endpoint dall'agente di sondaggio di Gestione traffico.</span><span class="sxs-lookup"><span data-stu-id="06381-120">This value specifies how often an endpoint is checked for its health from a Traffic Manager probing agent.</span></span> <span data-ttu-id="06381-121">È possibile specificare due valori qui: 30 secondi (sondaggio normale) e 10 secondi (sondaggio veloce).</span><span class="sxs-lookup"><span data-stu-id="06381-121">You can specify two values here: 30 seconds (normal probing) and 10 seconds (fast probing).</span></span> <span data-ttu-id="06381-122">Se non viene specificato alcun valore, il profilo imposta un valore predefinito di 30 secondi.</span><span class="sxs-lookup"><span data-stu-id="06381-122">If no values are provided, the profile sets to a default value of 30 seconds.</span></span> <span data-ttu-id="06381-123">Per altre informazioni sui prezzi per il sondaggio rapido, visitare la pagina dei [prezzi per Gestione traffico](https://azure.microsoft.com/pricing/details/traffic-manager).</span><span class="sxs-lookup"><span data-stu-id="06381-123">Visit the [Traffic Manager Pricing](https://azure.microsoft.com/pricing/details/traffic-manager) page to learn more about fast probing pricing.</span></span>
* <span data-ttu-id="06381-124">**Numero di errori tollerati**.</span><span class="sxs-lookup"><span data-stu-id="06381-124">**Tolerated Number of Failures**.</span></span> <span data-ttu-id="06381-125">Questo valore specifica il numero di errori tollerati da un agente di sondaggio di Gestione traffico prima di contrassegnare l'endpoint come non integro.</span><span class="sxs-lookup"><span data-stu-id="06381-125">This value specifies how many failures a Traffic Manager probing agent tolerates before marking that endpoint as unhealthy.</span></span> <span data-ttu-id="06381-126">Il valore può essere compreso tra 0 e 9.</span><span class="sxs-lookup"><span data-stu-id="06381-126">Its value can range between 0 and 9.</span></span> <span data-ttu-id="06381-127">Un valore pari a 0 indica che un singolo errore di monitoraggio può far sì che l'endpoint venga contrassegnato come non integro.</span><span class="sxs-lookup"><span data-stu-id="06381-127">A value of 0 means a single monitoring failure can cause that endpoint to be marked as unhealthy.</span></span> <span data-ttu-id="06381-128">Se non si specifica alcun valore, viene usato il valore predefinito di 3.</span><span class="sxs-lookup"><span data-stu-id="06381-128">If no value is specified, it uses the default value of 3.</span></span>
* <span data-ttu-id="06381-129">**Timeout di monitoraggio**.</span><span class="sxs-lookup"><span data-stu-id="06381-129">**Monitoring Timeout**.</span></span> <span data-ttu-id="06381-130">Questa proprietà specifica la quantità di tempo che l'agente di sondaggio di Gestione traffico deve attendere prima di considerare il controllo come un errore quando un sondaggio di controllo di integrità viene inviato all'endpoint.</span><span class="sxs-lookup"><span data-stu-id="06381-130">This property specifies the amount of time the Traffic Manager probing agent should wait before considering that check a failure when a health check probe is sent to the endpoint.</span></span> <span data-ttu-id="06381-131">Se l'intervallo sondaggio è impostato su 30 secondi, è possibile impostare il valore di timeout tra 5 e 10 secondi.</span><span class="sxs-lookup"><span data-stu-id="06381-131">If the Probing Interval is set to 30 seconds, then you can set the Timeout value between 5 and 10 seconds.</span></span> <span data-ttu-id="06381-132">Se non si specifica alcun valore, viene usato il valore predefinito di 10 secondi.</span><span class="sxs-lookup"><span data-stu-id="06381-132">If no value is specified, it uses a default value of 10 seconds.</span></span> <span data-ttu-id="06381-133">Se l'intervallo sondaggio è impostato su 10 secondi, è possibile impostare il valore di timeout tra 5 e 9 secondi.</span><span class="sxs-lookup"><span data-stu-id="06381-133">If the Probing Interval is set to 10 seconds, then you can set the Timeout value between 5 and 9 seconds.</span></span> <span data-ttu-id="06381-134">Se non si specifica alcun valore di timeout, viene usato il valore predefinito di 9 secondi.</span><span class="sxs-lookup"><span data-stu-id="06381-134">If no Timeout value is specified, it uses a default value of 9 seconds.</span></span>

![Monitoraggio degli endpoint di Gestione traffico](./media/traffic-manager-monitoring/endpoint-monitoring-settings.png)

<span data-ttu-id="06381-136">**Figura 1: Monitoraggio degli endpoint di Gestione traffico**</span><span class="sxs-lookup"><span data-stu-id="06381-136">**Figure 1:  Traffic Manager endpoint monitoring**</span></span>

## <a name="how-endpoint-monitoring-works"></a><span data-ttu-id="06381-137">Funzionamento del monitoraggio degli endpoint</span><span class="sxs-lookup"><span data-stu-id="06381-137">How endpoint monitoring works</span></span>

<span data-ttu-id="06381-138">Se il protocollo di monitoraggio è impostato come HTTP o HTTPS, l'agente di sondaggio di Gestione traffico esegue una richiesta GET all'endpoint usando il protocollo, la porta e il percorso relativo specificati.</span><span class="sxs-lookup"><span data-stu-id="06381-138">If the monitoring protocol is set as HTTP or HTTPS, the Traffic Manager probing agent makes a GET request to the endpoint using the protocol, port, and relative path given.</span></span> <span data-ttu-id="06381-139">Se ottiene una risposta 200-OK, l'endpoint viene considerato integro.</span><span class="sxs-lookup"><span data-stu-id="06381-139">If it gets back a 200-OK response, then that endpoint is considered healthy.</span></span> <span data-ttu-id="06381-140">Se la risposta è un valore diverso, oppure se non viene ricevuta alcuna risposta entro il periodo di timeout specificato, l'agente di sondaggio di Gestione traffico esegue un nuovo tentativo in base all'impostazione Numero di tentativi tollerati. Se quindi questa impostazione è pari a 0, non viene eseguito alcun altro tentativo.</span><span class="sxs-lookup"><span data-stu-id="06381-140">If the response is a different value, or, if no response is received within the timeout period specified, then the Traffic Manager probing agent re-attempts according to the Tolerated Number of Failures setting (no re-attempts are done if this setting is 0).</span></span> <span data-ttu-id="06381-141">Se il numero di tentativi consecutivi non riusciti è superiore all'impostazione di Numero di tentativi tollerati, l'endpoint viene contrassegnato come non integro.</span><span class="sxs-lookup"><span data-stu-id="06381-141">If the number of consecutive failures is higher than the Tolerated Number of Failures setting, then that endpoint is marked as unhealthy.</span></span> 

<span data-ttu-id="06381-142">Se il protocollo di monitoraggio è TCP, l'agente di sondaggio di Gestione traffico avvia una richiesta di connessione TCP usando la porta specificata.</span><span class="sxs-lookup"><span data-stu-id="06381-142">If the monitoring protocol is TCP, the Traffic Manager probing agent initiates a TCP connection request using the port specified.</span></span> <span data-ttu-id="06381-143">Se l'endpoint risponde alla richiesta con una risposta per stabilire la connessione, il controllo integrità viene contrassegnato come esito positivo e l'agente di sondaggio di Gestione traffico reimposta la connessione TCP.</span><span class="sxs-lookup"><span data-stu-id="06381-143">If the endpoint responds to the request with a response to establish the connection, that health check is marked as a success and the Traffic Manager probing agent resets the TCP connection.</span></span> <span data-ttu-id="06381-144">Se la risposta è un valore diverso, oppure se non viene ricevuta alcuna risposta entro il periodo di timeout specificato, l'agente di sondaggio di Gestione traffico esegue un nuovo tentativo in base all'impostazione Numero di tentativi tollerati. Se quindi questa impostazione è pari a 0, non viene eseguito alcun altro tentativo.</span><span class="sxs-lookup"><span data-stu-id="06381-144">If the response is a different value, or if no response is received within the timeout period specified, the Traffic Manager probing agent re-attempts according to the Tolerated Number of Failures setting (no re-attempts are made if this setting is 0).</span></span> <span data-ttu-id="06381-145">Se il numero di tentativi consecutivi non riusciti è superiore all'impostazione di Numero di errori tollerati, l'endpoint viene contrassegnato come non integro.</span><span class="sxs-lookup"><span data-stu-id="06381-145">If the number of consecutive failures is higher than the Tolerated Number of Failures setting, then that endpoint is marked unhealthy.</span></span>

<span data-ttu-id="06381-146">In tutti i casi, i sondaggi di Gestione traffico da più posizioni e la determinazione di errori consecutivi avvengono all'interno di ogni area.</span><span class="sxs-lookup"><span data-stu-id="06381-146">In all cases, Traffic Manager probes from multiple locations and the consecutive failure determination happens within each region.</span></span> <span data-ttu-id="06381-147">Questo significa anche che gli endpoint ricevono sondaggi di integrità da Gestione traffico con una frequenza maggiore rispetto all'impostazione usata per l'intervallo di sondaggio.</span><span class="sxs-lookup"><span data-stu-id="06381-147">This also means that endpoints are receiving health probes from Traffic Manager with a higher frequency than the setting used for Probing Interval.</span></span>

>[!NOTE]
><span data-ttu-id="06381-148">Per il protocollo di monitoraggio HTTP o HTTPS, una pratica comune sul lato endpoint consiste nell'implementare una pagina personalizzata all'interno dell'applicazione, ad esempio /health.aspx.</span><span class="sxs-lookup"><span data-stu-id="06381-148">For HTTP or HTTPS monitoring protocol, a common practice on the endpoint side is to implement a custom page within your application - for example, /health.aspx.</span></span> <span data-ttu-id="06381-149">Usando questo percorso per il monitoraggio, è possibile eseguire controlli specifici dell'applicazione, ad esempio il controllo dei contatori delle prestazioni o la verifica della disponibilità del database.</span><span class="sxs-lookup"><span data-stu-id="06381-149">Using this path for monitoring, you can perform application-specific checks, such as checking performance counters or verifying database availability.</span></span> <span data-ttu-id="06381-150">In base a questi controlli personalizzati, la pagina restituisce un codice di stato HTTP appropriato.</span><span class="sxs-lookup"><span data-stu-id="06381-150">Based on these custom checks, the page returns an appropriate HTTP status code.</span></span>

<span data-ttu-id="06381-151">Tutti gli endpoint in un profilo di Gestione traffico condividono le impostazioni di monitoraggio.</span><span class="sxs-lookup"><span data-stu-id="06381-151">All endpoints in a Traffic Manager profile share monitoring settings.</span></span> <span data-ttu-id="06381-152">Se è necessario usare impostazioni di monitoraggio diverse per i vari endpoint, è possibile creare i [profili nidificati di Gestione traffico](traffic-manager-nested-profiles.md#example-5-per-endpoint-monitoring-settings).</span><span class="sxs-lookup"><span data-stu-id="06381-152">If you need to use different monitoring settings for different endpoints, you can create [nested Traffic Manager profiles](traffic-manager-nested-profiles.md#example-5-per-endpoint-monitoring-settings).</span></span>

## <a name="endpoint-and-profile-status"></a><span data-ttu-id="06381-153">Stato di endpoint e profili</span><span class="sxs-lookup"><span data-stu-id="06381-153">Endpoint and profile status</span></span>

<span data-ttu-id="06381-154">Gli endpoint e i profili di Gestione traffico possono essere abilitati e disabilitati.</span><span class="sxs-lookup"><span data-stu-id="06381-154">You can enable and disable Traffic Manager profiles and endpoints.</span></span> <span data-ttu-id="06381-155">Tuttavia, lo stato degli endpoint può cambiare anche a causa di impostazioni e processi automatici di Gestione traffico.</span><span class="sxs-lookup"><span data-stu-id="06381-155">However, a change in endpoint status also might occur as a result of Traffic Manager automated settings and processes.</span></span>

### <a name="endpoint-status"></a><span data-ttu-id="06381-156">Stato endpoint</span><span class="sxs-lookup"><span data-stu-id="06381-156">Endpoint status</span></span>

<span data-ttu-id="06381-157">È possibile abilitare o disabilitare un endpoint specifico.</span><span class="sxs-lookup"><span data-stu-id="06381-157">You can enable or disable a specific endpoint.</span></span> <span data-ttu-id="06381-158">Il servizio sottostante, che potrebbe essere ancora integro, non è interessato.</span><span class="sxs-lookup"><span data-stu-id="06381-158">The underlying service, which might still be healthy, is unaffected.</span></span> <span data-ttu-id="06381-159">La modifica dello stato dell'endpoint controlla la disponibilità dell'endpoint nel profilo di Gestione traffico.</span><span class="sxs-lookup"><span data-stu-id="06381-159">Changing the endpoint status controls the availability of the endpoint in the Traffic Manager profile.</span></span> <span data-ttu-id="06381-160">Quando un endpoint è associato allo stato Disabled, Gestione traffico non ne verifica l'integrità e l'endpoint non viene incluso in una risposta DNS.</span><span class="sxs-lookup"><span data-stu-id="06381-160">When an endpoint status is disabled, Traffic Manager does not check its health and the endpoint is not included in a DNS response.</span></span>

### <a name="profile-status"></a><span data-ttu-id="06381-161">Stato profilo</span><span class="sxs-lookup"><span data-stu-id="06381-161">Profile status</span></span>

<span data-ttu-id="06381-162">Usando l'impostazione dello stato del profilo è possibile abilitare o disabilitare un profilo specifico.</span><span class="sxs-lookup"><span data-stu-id="06381-162">Using the profile status setting, you can enable or disable a specific profile.</span></span> <span data-ttu-id="06381-163">Mentre lo stato dell'endpoint interessa un solo endpoint, lo stato del profilo interessa l'intero profilo, che include tutti gli endpoint.</span><span class="sxs-lookup"><span data-stu-id="06381-163">While endpoint status affects a single endpoint, profile status affects the entire profile, including all endpoints.</span></span> <span data-ttu-id="06381-164">Quando si disabilita un profilo, l'integrità degli endpoint non viene verificata e nessun endpoint viene incluso in una risposta DNS.</span><span class="sxs-lookup"><span data-stu-id="06381-164">When you disable a profile, the endpoints are not checked for health and no endpoints are included in a DNS response.</span></span> <span data-ttu-id="06381-165">Per la query DNS viene restituito un codice di risposta [NXDOMAIN](https://tools.ietf.org/html/rfc2308).</span><span class="sxs-lookup"><span data-stu-id="06381-165">An [NXDOMAIN](https://tools.ietf.org/html/rfc2308) response code is returned for the DNS query.</span></span>

### <a name="endpoint-monitor-status"></a><span data-ttu-id="06381-166">Endpoint monitor status (Stato monitoraggio endpoint)</span><span class="sxs-lookup"><span data-stu-id="06381-166">Endpoint monitor status</span></span>

<span data-ttu-id="06381-167">Il valore relativo allo stato di monitoraggio dell'endpoint viene generato da Gestione traffico per indicare lo stato corrente dell'endpoint.</span><span class="sxs-lookup"><span data-stu-id="06381-167">Endpoint monitor status is a Traffic Manager-generated value that shows the status of the endpoint.</span></span> <span data-ttu-id="06381-168">Questa impostazione non può essere modificata manualmente.</span><span class="sxs-lookup"><span data-stu-id="06381-168">You cannot change this setting manually.</span></span> <span data-ttu-id="06381-169">Lo stato del monitoraggio dell'endpoint è una combinazione dei risultati del monitoraggio dell'endpoint e dello stato dell'endpoint configurato.</span><span class="sxs-lookup"><span data-stu-id="06381-169">The endpoint monitor status is a combination of the results of endpoint monitoring and the configured endpoint status.</span></span> <span data-ttu-id="06381-170">La tabella seguente indica i valori possibili dello stato di monitoraggio degli endpoint:</span><span class="sxs-lookup"><span data-stu-id="06381-170">The possible values of endpoint monitor status are shown in the following table:</span></span>

| <span data-ttu-id="06381-171">Stato profilo</span><span class="sxs-lookup"><span data-stu-id="06381-171">Profile status</span></span> | <span data-ttu-id="06381-172">Stato endpoint</span><span class="sxs-lookup"><span data-stu-id="06381-172">Endpoint status</span></span> | <span data-ttu-id="06381-173">Endpoint monitor status (Stato monitoraggio endpoint)</span><span class="sxs-lookup"><span data-stu-id="06381-173">Endpoint monitor status</span></span> | <span data-ttu-id="06381-174">Note</span><span class="sxs-lookup"><span data-stu-id="06381-174">Notes</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="06381-175">Disabled</span><span class="sxs-lookup"><span data-stu-id="06381-175">Disabled</span></span> |<span data-ttu-id="06381-176">Enabled</span><span class="sxs-lookup"><span data-stu-id="06381-176">Enabled</span></span> |<span data-ttu-id="06381-177">Inactive</span><span class="sxs-lookup"><span data-stu-id="06381-177">Inactive</span></span> |<span data-ttu-id="06381-178">Il profilo è stato disabilitato.</span><span class="sxs-lookup"><span data-stu-id="06381-178">The profile has been disabled.</span></span> <span data-ttu-id="06381-179">Anche se lo stato dell'endpoint è Enabled, se lo stato del profilo è Disabled, quest'ultimo avrà la precedenza.</span><span class="sxs-lookup"><span data-stu-id="06381-179">Although the endpoint status is Enabled, the profile status (Disabled) takes precedence.</span></span> <span data-ttu-id="06381-180">Gli endpoint nei profili disabilitati non vengono monitorati.</span><span class="sxs-lookup"><span data-stu-id="06381-180">Endpoints in disabled profiles are not monitored.</span></span> <span data-ttu-id="06381-181">Per la query DNS viene restituito un codice di risposta NXDOMAIN.</span><span class="sxs-lookup"><span data-stu-id="06381-181">An NXDOMAIN response code is returned for the DNS query.</span></span> |
| <span data-ttu-id="06381-182">&lt;qualsiasi&gt;</span><span class="sxs-lookup"><span data-stu-id="06381-182">&lt;any&gt;</span></span> |<span data-ttu-id="06381-183">Disabled</span><span class="sxs-lookup"><span data-stu-id="06381-183">Disabled</span></span> |<span data-ttu-id="06381-184">Disabled</span><span class="sxs-lookup"><span data-stu-id="06381-184">Disabled</span></span> |<span data-ttu-id="06381-185">L'endpoint è stato disabilitato.</span><span class="sxs-lookup"><span data-stu-id="06381-185">The endpoint has been disabled.</span></span> <span data-ttu-id="06381-186">Gli endpoint disabilitati non vengono monitorati.</span><span class="sxs-lookup"><span data-stu-id="06381-186">Disabled endpoints are not monitored.</span></span> <span data-ttu-id="06381-187">L'endpoint non è incluso nelle risposte DNS e pertanto non riceve traffico.</span><span class="sxs-lookup"><span data-stu-id="06381-187">The endpoint is not included in DNS responses, therefore, it does not receive traffic.</span></span> |
| <span data-ttu-id="06381-188">Enabled</span><span class="sxs-lookup"><span data-stu-id="06381-188">Enabled</span></span> |<span data-ttu-id="06381-189">Enabled</span><span class="sxs-lookup"><span data-stu-id="06381-189">Enabled</span></span> |<span data-ttu-id="06381-190">Online</span><span class="sxs-lookup"><span data-stu-id="06381-190">Online</span></span> |<span data-ttu-id="06381-191">L'endpoint è monitorato e integro.</span><span class="sxs-lookup"><span data-stu-id="06381-191">The endpoint is monitored and is healthy.</span></span> <span data-ttu-id="06381-192">È incluso nelle risposte DNS ed è in grado di ricevere traffico.</span><span class="sxs-lookup"><span data-stu-id="06381-192">It is included in DNS responses and can receive traffic.</span></span> |
| <span data-ttu-id="06381-193">Enabled</span><span class="sxs-lookup"><span data-stu-id="06381-193">Enabled</span></span> |<span data-ttu-id="06381-194">Enabled</span><span class="sxs-lookup"><span data-stu-id="06381-194">Enabled</span></span> |<span data-ttu-id="06381-195">Degraded</span><span class="sxs-lookup"><span data-stu-id="06381-195">Degraded</span></span> |<span data-ttu-id="06381-196">I controlli di integrità del monitoraggio dell'endpoint hanno esito negativo.</span><span class="sxs-lookup"><span data-stu-id="06381-196">Endpoint monitoring health checks are failing.</span></span> <span data-ttu-id="06381-197">L'endpoint non è incluso nelle risposte DNS e non riceve traffico.</span><span class="sxs-lookup"><span data-stu-id="06381-197">The endpoint is not included in DNS responses and does not receive traffic.</span></span> <br><span data-ttu-id="06381-198">Un'eccezione a questa situazione è quando tutti gli endpoint sono danneggiati. In questo caso tutti gli elementi vengono considerati da restituire nella risposta alla query.</span><span class="sxs-lookup"><span data-stu-id="06381-198">An exception to this is if all endpoints are degraded, in which case all of them are considered to be returned in the query response).</span></span></br>|
| <span data-ttu-id="06381-199">Enabled</span><span class="sxs-lookup"><span data-stu-id="06381-199">Enabled</span></span> |<span data-ttu-id="06381-200">Enabled</span><span class="sxs-lookup"><span data-stu-id="06381-200">Enabled</span></span> |<span data-ttu-id="06381-201">CheckingEndpoint</span><span class="sxs-lookup"><span data-stu-id="06381-201">CheckingEndpoint</span></span> |<span data-ttu-id="06381-202">L'endpoint è monitorato, ma i risultati del primo test non sono ancora pervenuti.</span><span class="sxs-lookup"><span data-stu-id="06381-202">The endpoint is monitored, but the results of the first probe have not been received yet.</span></span> <span data-ttu-id="06381-203">CheckingEndpoint è un stato temporaneo che in genere si verifica immediatamente dopo l'aggiunta o l'abilitazione di un endpoint nel profilo.</span><span class="sxs-lookup"><span data-stu-id="06381-203">CheckingEndpoint is a temporary state that usually occurs immediately after adding or enabling an endpoint in the profile.</span></span> <span data-ttu-id="06381-204">Un endpoint con questo stato viene incluso nelle risposte DNS e può ricevere traffico.</span><span class="sxs-lookup"><span data-stu-id="06381-204">An endpoint in this state is included in DNS responses and can receive traffic.</span></span> |
| <span data-ttu-id="06381-205">Enabled</span><span class="sxs-lookup"><span data-stu-id="06381-205">Enabled</span></span> |<span data-ttu-id="06381-206">Enabled</span><span class="sxs-lookup"><span data-stu-id="06381-206">Enabled</span></span> |<span data-ttu-id="06381-207">Arrestato</span><span class="sxs-lookup"><span data-stu-id="06381-207">Stopped</span></span> |<span data-ttu-id="06381-208">Il servizio cloud o l'app Web cui punta l'endpoint non è in esecuzione.</span><span class="sxs-lookup"><span data-stu-id="06381-208">The cloud service or web app that the endpoint points to is not running.</span></span> <span data-ttu-id="06381-209">Verificare le impostazioni del servizio cloud o dell'app Web.</span><span class="sxs-lookup"><span data-stu-id="06381-209">Check the cloud service or web app settings.</span></span> <span data-ttu-id="06381-210">Questa situazione può verificarsi anche se l'endpoint è di tipo annidato e il profilo figlio è disabilitato o non è attivo.</span><span class="sxs-lookup"><span data-stu-id="06381-210">This can also happen if the endpoint is of type nested endpoint and the child profile is disabled or is inactive.</span></span> <br><span data-ttu-id="06381-211">Gli endpoint con stato Interrotto non vengono monitorati.</span><span class="sxs-lookup"><span data-stu-id="06381-211">An endpoint with a Stopped status is not monitored.</span></span> <span data-ttu-id="06381-212">Non è incluso nelle risposte DNS e non riceve traffico.</span><span class="sxs-lookup"><span data-stu-id="06381-212">It is not included in DNS responses and does not receive traffic.</span></span> <span data-ttu-id="06381-213">Un'eccezione a questa situazione è quando tutti gli endpoint sono danneggiati. In questo caso tutti gli elementi vengono considerati da restituire nella risposta alla query.</span><span class="sxs-lookup"><span data-stu-id="06381-213">An exception to this is if all endpoints are degraded, in which case all of them will be considered to be returned in the query response.</span></span></br>|

<span data-ttu-id="06381-214">Per informazioni dettagliate su come viene calcolato lo stato del monitoraggio degli endpoint nidificati, vedere [Profili nidificati di Gestione traffico](traffic-manager-nested-profiles.md).</span><span class="sxs-lookup"><span data-stu-id="06381-214">For details about how endpoint monitor status is calculated for nested endpoints, see [nested Traffic Manager profiles](traffic-manager-nested-profiles.md).</span></span>

### <a name="profile-monitor-status"></a><span data-ttu-id="06381-215">Stato monitoraggio profilo</span><span class="sxs-lookup"><span data-stu-id="06381-215">Profile monitor status</span></span>

<span data-ttu-id="06381-216">Lo stato di monitoraggio del profilo è una combinazione dei valori relativi allo stato del profilo configurato e allo stato di monitoraggio di tutti gli endpoint.</span><span class="sxs-lookup"><span data-stu-id="06381-216">The profile monitor status is a combination of the configured profile status and the endpoint monitor status values for all endpoints.</span></span> <span data-ttu-id="06381-217">I possibili valori sono descritti nella tabella seguente:</span><span class="sxs-lookup"><span data-stu-id="06381-217">The possible values are described in the following table:</span></span>

| <span data-ttu-id="06381-218">Stato profilo (come configurato)</span><span class="sxs-lookup"><span data-stu-id="06381-218">Profile status (as configured)</span></span> | <span data-ttu-id="06381-219">Endpoint monitor status (Stato monitoraggio endpoint)</span><span class="sxs-lookup"><span data-stu-id="06381-219">Endpoint monitor status</span></span> | <span data-ttu-id="06381-220">Stato monitoraggio profilo</span><span class="sxs-lookup"><span data-stu-id="06381-220">Profile monitor status</span></span> | <span data-ttu-id="06381-221">Note</span><span class="sxs-lookup"><span data-stu-id="06381-221">Notes</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="06381-222">Disabled</span><span class="sxs-lookup"><span data-stu-id="06381-222">Disabled</span></span> |<span data-ttu-id="06381-223">&lt;qualsiasi&gt; o un profilo senza endpoint definiti.</span><span class="sxs-lookup"><span data-stu-id="06381-223">&lt;any&gt; or a profile with no defined endpoints.</span></span> |<span data-ttu-id="06381-224">Disabled</span><span class="sxs-lookup"><span data-stu-id="06381-224">Disabled</span></span> |<span data-ttu-id="06381-225">Il profilo è stato disabilitato.</span><span class="sxs-lookup"><span data-stu-id="06381-225">The profile has been disabled.</span></span> |
| <span data-ttu-id="06381-226">Enabled</span><span class="sxs-lookup"><span data-stu-id="06381-226">Enabled</span></span> |<span data-ttu-id="06381-227">Almeno un endpoint è associato allo stato Degraded.</span><span class="sxs-lookup"><span data-stu-id="06381-227">The status of at least one endpoint is Degraded.</span></span> |<span data-ttu-id="06381-228">Degraded</span><span class="sxs-lookup"><span data-stu-id="06381-228">Degraded</span></span> |<span data-ttu-id="06381-229">Esaminare i valori di stato dei singoli endpoint per determinare quali endpoint richiedono attenzione.</span><span class="sxs-lookup"><span data-stu-id="06381-229">Review the individual endpoint status values to determine which endpoints require further attention.</span></span> |
| <span data-ttu-id="06381-230">Enabled</span><span class="sxs-lookup"><span data-stu-id="06381-230">Enabled</span></span> |<span data-ttu-id="06381-231">Almeno un endpoint è associato allo stato Online.</span><span class="sxs-lookup"><span data-stu-id="06381-231">The status of at least one endpoint is Online.</span></span> <span data-ttu-id="06381-232">Nessun endpoint presenta lo stato Degraded.</span><span class="sxs-lookup"><span data-stu-id="06381-232">No endpoints have a Degraded status.</span></span> |<span data-ttu-id="06381-233">Online</span><span class="sxs-lookup"><span data-stu-id="06381-233">Online</span></span> |<span data-ttu-id="06381-234">Il servizio sta accettando il traffico.</span><span class="sxs-lookup"><span data-stu-id="06381-234">The service is accepting traffic.</span></span> <span data-ttu-id="06381-235">Non è necessaria alcuna azione.</span><span class="sxs-lookup"><span data-stu-id="06381-235">No further action is required.</span></span> |
| <span data-ttu-id="06381-236">Enabled</span><span class="sxs-lookup"><span data-stu-id="06381-236">Enabled</span></span> |<span data-ttu-id="06381-237">Almeno un endpoint è associato allo stato CheckingEndpoint.</span><span class="sxs-lookup"><span data-stu-id="06381-237">The status of at least one endpoint is CheckingEndpoint.</span></span> <span data-ttu-id="06381-238">Nessun endpoint presenta lo stato Online o Degraded.</span><span class="sxs-lookup"><span data-stu-id="06381-238">No endpoints are in Online or Degraded status.</span></span> |<span data-ttu-id="06381-239">CheckingEndpoints</span><span class="sxs-lookup"><span data-stu-id="06381-239">CheckingEndpoints</span></span> |<span data-ttu-id="06381-240">Questo stato di transizione si verifica quando un profilo viene creato o abilitato.</span><span class="sxs-lookup"><span data-stu-id="06381-240">This transition state occurs when a profile if created or enabled.</span></span> <span data-ttu-id="06381-241">Viene verificata l'integrità dell'endpoint per la prima volta.</span><span class="sxs-lookup"><span data-stu-id="06381-241">The endpoint health is being checked for the first time.</span></span> |
| <span data-ttu-id="06381-242">Enabled</span><span class="sxs-lookup"><span data-stu-id="06381-242">Enabled</span></span> |<span data-ttu-id="06381-243">Tutti gli endpoint del profilo presentano lo stato Disabled o Stopped oppure nel profilo non sono definiti endpoint.</span><span class="sxs-lookup"><span data-stu-id="06381-243">The statuses of all endpoints in the profile are either Disabled or Stopped, or the profile has no defined endpoints.</span></span> |<span data-ttu-id="06381-244">Inactive</span><span class="sxs-lookup"><span data-stu-id="06381-244">Inactive</span></span> |<span data-ttu-id="06381-245">Non ci sono endpoint attivi, ma il profilo presenta lo stato Enabled.</span><span class="sxs-lookup"><span data-stu-id="06381-245">No endpoints are active, but the profile is still Enabled.</span></span> |

## <a name="endpoint-failover-and-recovery"></a><span data-ttu-id="06381-246">Failover e ripristino degli endpoint</span><span class="sxs-lookup"><span data-stu-id="06381-246">Endpoint failover and recovery</span></span>

<span data-ttu-id="06381-247">Gestione traffico verifica periodicamente l'integrità di ogni endpoint, inclusi gli endpoint non integri.</span><span class="sxs-lookup"><span data-stu-id="06381-247">Traffic Manager periodically checks the health of every endpoint, including unhealthy endpoints.</span></span> <span data-ttu-id="06381-248">Rileva quando un endpoint diventa integro e lo reinserisce nella rotazione.</span><span class="sxs-lookup"><span data-stu-id="06381-248">Traffic Manager detects when an endpoint becomes healthy and brings it back into rotation.</span></span>

<span data-ttu-id="06381-249">Un endpoint non è integro quando si verifica uno degli eventi seguenti:</span><span class="sxs-lookup"><span data-stu-id="06381-249">An endpoint is unhealthy when any of the following events occur:</span></span>
- <span data-ttu-id="06381-250">Se il protocollo di monitoraggio è HTTP o HTTPS:</span><span class="sxs-lookup"><span data-stu-id="06381-250">If the monitoring protocol is HTTP or HTTPS:</span></span>
    - <span data-ttu-id="06381-251">Viene ricevuta una risposta non 200, incluso un codice 2xx diverso o un reindirizzamento 301/302.</span><span class="sxs-lookup"><span data-stu-id="06381-251">A non-200 response is received (including a different 2xx code, or a 301/302 redirect).</span></span>
- <span data-ttu-id="06381-252">Se il protocollo di monitoraggio è TCP:</span><span class="sxs-lookup"><span data-stu-id="06381-252">If the monitoring protocol is TCP:</span></span> 
    - <span data-ttu-id="06381-253">Viene ricevuta una risposta diversa da ACK o SYN-ACK in risposta alla richiesta di sincronizzazione inviata da Gestione traffico per tentare di stabilire una connessione.</span><span class="sxs-lookup"><span data-stu-id="06381-253">A response other than ACK or SYN-ACK is received in response to the SYNC request sent by Traffic Manager to attempt a connection establishment.</span></span>
- <span data-ttu-id="06381-254">Timeout.</span><span class="sxs-lookup"><span data-stu-id="06381-254">Timeout.</span></span> 
- <span data-ttu-id="06381-255">Qualsiasi altro problema di connessione che determina l'irraggiungibilità dell'endpoint.</span><span class="sxs-lookup"><span data-stu-id="06381-255">Any other connection issue resulting in the endpoint being not reachable.</span></span>

<span data-ttu-id="06381-256">Per ulteriori informazioni su come risolvere i problemi relativi ai controlli non riusciti, vedere [Risoluzione dei problemi relativi allo stato Danneggiato di Gestione traffico](traffic-manager-troubleshooting-degraded.md).</span><span class="sxs-lookup"><span data-stu-id="06381-256">For more information about troubleshooting failed checks, see [Troubleshooting Degraded status on Azure Traffic Manager](traffic-manager-troubleshooting-degraded.md).</span></span> 

<span data-ttu-id="06381-257">La sequenza temporale seguente nella Figura 2 è una descrizione dettagliata del processo di monitoraggio dell'endpoint di Gestione traffico con le seguenti impostazioni: il protocollo di monitoraggio è HTTP, l'intervallo di sondaggio è 30 secondi, il numero di errori tollerati è 3, il valore di timeout è 10 secondi e il TTL del DNS è 30 secondi.</span><span class="sxs-lookup"><span data-stu-id="06381-257">The following timeline in Figure 2 is a detailed description of the monitoring process of Traffic Manager endpoint that has the following settings: monitoring protocol is HTTP, probing interval is 30 seconds, number of tolerated failures is 3, timeout value is 10 seconds, and DNS TTL is 30 seconds.</span></span>

![Sequenza di failover e failback degli endpoint di Gestione traffico](./media/traffic-manager-monitoring/timeline.png)

<span data-ttu-id="06381-259">**Figura 2: Sequenza di failover e ripristino degli endpoint di Gestione traffico**</span><span class="sxs-lookup"><span data-stu-id="06381-259">**Figure 2:  Traffic manager endpoint failover and recovery sequence**</span></span>

1. <span data-ttu-id="06381-260">**GET**.</span><span class="sxs-lookup"><span data-stu-id="06381-260">**GET**.</span></span> <span data-ttu-id="06381-261">Per ogni endpoint, il sistema di monitoraggio di Gestione traffico esegue una richiesta GET sul percorso specificato nelle impostazioni di monitoraggio.</span><span class="sxs-lookup"><span data-stu-id="06381-261">For each endpoint, the Traffic Manager monitoring system performs a GET request on the path specified in the monitoring settings.</span></span>
2. <span data-ttu-id="06381-262">**200 OK**.</span><span class="sxs-lookup"><span data-stu-id="06381-262">**200 OK**.</span></span> <span data-ttu-id="06381-263">il sistema di monitoraggio prevede la restituzione di un messaggio HTTP 200 OK entro 10 secondi.</span><span class="sxs-lookup"><span data-stu-id="06381-263">The monitoring system expects an HTTP 200 OK message to be returned within 10 seconds.</span></span> <span data-ttu-id="06381-264">Alla ricezione della risposta, il sistema riconosce la disponibilità del servizio.</span><span class="sxs-lookup"><span data-stu-id="06381-264">When it receives this response, it recognizes that the service is available.</span></span>
3. <span data-ttu-id="06381-265">**30 secondi tra i controlli**.</span><span class="sxs-lookup"><span data-stu-id="06381-265">**30 seconds between checks**.</span></span> <span data-ttu-id="06381-266">Il controllo di integrità dell'endpoint viene ripetuto ogni 30 secondi.</span><span class="sxs-lookup"><span data-stu-id="06381-266">The endpoint health check is repeated every 30 seconds.</span></span>
4. <span data-ttu-id="06381-267">**Servizio non disponibile**.</span><span class="sxs-lookup"><span data-stu-id="06381-267">**Service unavailable**.</span></span> <span data-ttu-id="06381-268">il servizio diventa non disponibile.</span><span class="sxs-lookup"><span data-stu-id="06381-268">The service becomes unavailable.</span></span> <span data-ttu-id="06381-269">Gestione traffico non avrà informazioni fino al successivo controllo di integrità.</span><span class="sxs-lookup"><span data-stu-id="06381-269">Traffic Manager will not know until the next health check.</span></span>
5. <span data-ttu-id="06381-270">**Tenta di accedere al percorso di monitoraggio**.</span><span class="sxs-lookup"><span data-stu-id="06381-270">**Attempts to access the monitoring path**.</span></span> <span data-ttu-id="06381-271">il sistema di monitoraggio esegue una richiesta GET, ma non riceve risposte entro il periodo di timeout di 10 secondi oppure riceve una risposta diversa da 200.</span><span class="sxs-lookup"><span data-stu-id="06381-271">The monitoring system performs a GET request, but does not receive a response within the timeout period of 10 seconds (alternatively, a non-200 response may be received).</span></span> <span data-ttu-id="06381-272">Il sistema esegue quindi altri tre tentativi a intervalli di 30 secondi.</span><span class="sxs-lookup"><span data-stu-id="06381-272">It then tries three more times, at 30-second intervals.</span></span> <span data-ttu-id="06381-273">Se uno dei tentativi ha esito positivo, il conteggio viene azzerato.</span><span class="sxs-lookup"><span data-stu-id="06381-273">If one of the tries is successful, then the number of tries is reset.</span></span>
6. <span data-ttu-id="06381-274">**Stato impostato su Degraded**.</span><span class="sxs-lookup"><span data-stu-id="06381-274">**Status set to Degraded**.</span></span> <span data-ttu-id="06381-275">al quarto errore consecutivo, il sistema di monitoraggio contrassegna lo stato dell'endpoint non disponibile come Degraded.</span><span class="sxs-lookup"><span data-stu-id="06381-275">After a fourth consecutive failure, the monitoring system marks the unavailable endpoint status as Degraded.</span></span>
7. <span data-ttu-id="06381-276">**Traffico deviato ad altri endpoint**.</span><span class="sxs-lookup"><span data-stu-id="06381-276">**Traffic is diverted to other endpoints**.</span></span> <span data-ttu-id="06381-277">vengono aggiornati i server dei nomi DNS di Gestione traffico, che non restituisce più l'endpoint in risposta alle query DNS.</span><span class="sxs-lookup"><span data-stu-id="06381-277">The Traffic Manager DNS name servers are updated and Traffic Manager no longer returns the endpoint in response to DNS queries.</span></span> <span data-ttu-id="06381-278">Le nuove connessioni vengono indirizzate ad altri endpoint disponibili.</span><span class="sxs-lookup"><span data-stu-id="06381-278">New connections are directed to other, available endpoints.</span></span> <span data-ttu-id="06381-279">Tuttavia, le risposte DNS precedenti che includono questo endpoint possono essere ancora memorizzate nella cache da server DNS e client DNS ricorsivi.</span><span class="sxs-lookup"><span data-stu-id="06381-279">However, previous DNS responses that include this endpoint may still be cached by recursive DNS servers and DNS clients.</span></span> <span data-ttu-id="06381-280">I client continuano a usare l'endpoint fino alla scadenza della cache DNS.</span><span class="sxs-lookup"><span data-stu-id="06381-280">Clients continue to use the endpoint until the DNS cache expires.</span></span> <span data-ttu-id="06381-281">Quando la cache DNS scade i client eseguono nuove query DNS, indirizzate a endpoint diversi.</span><span class="sxs-lookup"><span data-stu-id="06381-281">As the DNS cache expires, clients make new DNS queries and are directed to different endpoints.</span></span> <span data-ttu-id="06381-282">La durata della cache è determinata dall'impostazione TTL definita nel profilo di Gestione traffico, ad esempio 30 secondi.</span><span class="sxs-lookup"><span data-stu-id="06381-282">The cache duration is controlled by the TTL setting in the Traffic Manager profile, for example, 30 seconds.</span></span>
8. <span data-ttu-id="06381-283">**I controlli di integrità proseguono**.</span><span class="sxs-lookup"><span data-stu-id="06381-283">**Health checks continue**.</span></span> <span data-ttu-id="06381-284">Gestione traffico continua a controllare l'integrità dell'endpoint finché si trova nello stato Degraded.</span><span class="sxs-lookup"><span data-stu-id="06381-284">Traffic Manager continues to check the health of the endpoint while it has a Degraded status.</span></span> <span data-ttu-id="06381-285">Gestione traffico rileva quando l'endpoint ritorna integro.</span><span class="sxs-lookup"><span data-stu-id="06381-285">Traffic Manager detects when the endpoint returns to health.</span></span>
9. <span data-ttu-id="06381-286">**Il servizio ritorna online**.</span><span class="sxs-lookup"><span data-stu-id="06381-286">**Service comes back online**.</span></span> <span data-ttu-id="06381-287">il servizio diventa disponibile.</span><span class="sxs-lookup"><span data-stu-id="06381-287">The service becomes available.</span></span> <span data-ttu-id="06381-288">L'endpoint mantiene lo stato Degraded in Gestione traffico finché il sistema di monitoraggio non esegue il controllo di integrità successivo.</span><span class="sxs-lookup"><span data-stu-id="06381-288">The endpoint retains its Degraded status in Traffic Manager until the monitoring system performs its next health check.</span></span>
10. <span data-ttu-id="06381-289">**Ripresa del traffico al servizio**.</span><span class="sxs-lookup"><span data-stu-id="06381-289">**Traffic to service resumes**.</span></span> <span data-ttu-id="06381-290">Gestione traffico invia una richiesta GET e riceve una risposta di stato 200 OK,</span><span class="sxs-lookup"><span data-stu-id="06381-290">Traffic Manager sends a GET request and receives a 200 OK status response.</span></span> <span data-ttu-id="06381-291">Il servizio è tornato a uno stato integro.</span><span class="sxs-lookup"><span data-stu-id="06381-291">The service has returned to a healthy state.</span></span> <span data-ttu-id="06381-292">I server dei nomi di Gestione traffico vengono aggiornati di nuovo e iniziano a distribuire il nome DNS del servizio nelle risposte DNS.</span><span class="sxs-lookup"><span data-stu-id="06381-292">The Traffic Manager name servers are updated, and they begin to hand out the service's DNS name in DNS responses.</span></span> <span data-ttu-id="06381-293">Il traffico torna all'endpoint non appena scadono le risposte DNS memorizzate nella cache che restituiscono altri endpoint e le connessioni esistenti verso altri endpoint vengono interrotte.</span><span class="sxs-lookup"><span data-stu-id="06381-293">Traffic returns to the endpoint as cached DNS responses that return other endpoints expire, and as existing connections to other endpoints are terminated.</span></span>

    > [!NOTE]
    > <span data-ttu-id="06381-294">Poiché lavora a livello di DNS, Gestione traffico non può influenzare le connessioni esistenti verso qualsiasi endpoint.</span><span class="sxs-lookup"><span data-stu-id="06381-294">Because Traffic Manager works at the DNS level, it cannot influence existing connections to any endpoint.</span></span> <span data-ttu-id="06381-295">Quando indirizza il traffico tra gli endpoint, modificando le impostazioni del profilo oppure durante il failover o il failback, Gestione traffico indirizza le nuove connessioni agli endpoint disponibili.</span><span class="sxs-lookup"><span data-stu-id="06381-295">When it directs traffic between endpoints (either by changed profile settings, or during failover or failback), Traffic Manager directs new connections to available endpoints.</span></span> <span data-ttu-id="06381-296">Tuttavia, altri endpoint possono continuare a ricevere il traffico tramite le connessioni esistenti finché tali sessioni non vengono terminate.</span><span class="sxs-lookup"><span data-stu-id="06381-296">However, other endpoints might continue to receive traffic via existing connections until those sessions are terminated.</span></span> <span data-ttu-id="06381-297">Per consentire lo smaltimento del traffico dalle connessioni esistenti, le applicazioni devono limitare la durata della sessione usata con ogni endpoint.</span><span class="sxs-lookup"><span data-stu-id="06381-297">To enable traffic to drain from existing connections, applications should limit the session duration used with each endpoint.</span></span>

## <a name="traffic-routing-methods"></a><span data-ttu-id="06381-298">Metodi di routing del traffico</span><span class="sxs-lookup"><span data-stu-id="06381-298">Traffic-routing methods</span></span>

<span data-ttu-id="06381-299">Un endpoint il cui stato è Degraded non viene restituito nella risposta alle query DNS.</span><span class="sxs-lookup"><span data-stu-id="06381-299">When an endpoint has a Degraded status, it is no longer returned in response to DNS queries.</span></span> <span data-ttu-id="06381-300">Viene invece scelto e restituito un endpoint alternativo.</span><span class="sxs-lookup"><span data-stu-id="06381-300">Instead, an alternative endpoint is chosen and returned.</span></span> <span data-ttu-id="06381-301">Il metodo di routing del traffico configurato nel profilo determina il modo in cui viene scelto l'endpoint alternativo.</span><span class="sxs-lookup"><span data-stu-id="06381-301">The traffic-routing method configured in the profile determines how the alternative endpoint is chosen.</span></span>

* <span data-ttu-id="06381-302">**Priorità**.</span><span class="sxs-lookup"><span data-stu-id="06381-302">**Priority**.</span></span> <span data-ttu-id="06381-303">gli endpoint formano un elenco con priorità.</span><span class="sxs-lookup"><span data-stu-id="06381-303">Endpoints form a prioritized list.</span></span> <span data-ttu-id="06381-304">Viene sempre restituito il primo endpoint disponibile nell'elenco.</span><span class="sxs-lookup"><span data-stu-id="06381-304">The first available endpoint on the list is always returned.</span></span> <span data-ttu-id="06381-305">Se lo stato di un endpoint è Degraded, viene restituito il successivo endpoint disponibile.</span><span class="sxs-lookup"><span data-stu-id="06381-305">If an endpoint status is Degraded, then the next available endpoint is returned.</span></span>
* <span data-ttu-id="06381-306">**Ponderato**.</span><span class="sxs-lookup"><span data-stu-id="06381-306">**Weighted**.</span></span> <span data-ttu-id="06381-307">Viene scelto in modo casuale uno degli endpoint disponibili, in base ai pesi assegnati e ai pesi degli altri endpoint disponibili.</span><span class="sxs-lookup"><span data-stu-id="06381-307">Any available endpoint is chosen at random based on their assigned weights and the weights of the other available endpoints.</span></span>
* <span data-ttu-id="06381-308">**Prestazioni**.</span><span class="sxs-lookup"><span data-stu-id="06381-308">**Performance**.</span></span> <span data-ttu-id="06381-309">Viene restituito l'endpoint più vicino all'utente finale.</span><span class="sxs-lookup"><span data-stu-id="06381-309">The endpoint closest to the end user is returned.</span></span> <span data-ttu-id="06381-310">Se tale endpoint non è disponibile, viene scelto in modo casuale un endpoint tra tutti gli altri endpoint disponibili.</span><span class="sxs-lookup"><span data-stu-id="06381-310">If that endpoint is unavailable, an endpoint is randomly chosen from all the other available endpoints.</span></span> <span data-ttu-id="06381-311">La scelta casuale di un endpoint evita un errore a catena che può verificarsi in caso di overload del successivo endpoint più vicino.</span><span class="sxs-lookup"><span data-stu-id="06381-311">Choosing a random endpoint avoids a cascading failure that can occur when the next-closest endpoint becomes overloaded.</span></span> <span data-ttu-id="06381-312">È possibile configurare piani di failover alternativi per il routing del traffico con il metodo Prestazioni usando [profili di Gestione traffico nidificati](traffic-manager-nested-profiles.md#example-4-controlling-performance-traffic-routing-between-multiple-endpoints-in-the-same-region).</span><span class="sxs-lookup"><span data-stu-id="06381-312">You can configure alternative failover plans for performance traffic-routing by using [nested Traffic Manager profiles](traffic-manager-nested-profiles.md#example-4-controlling-performance-traffic-routing-between-multiple-endpoints-in-the-same-region).</span></span>
* <span data-ttu-id="06381-313">**Geografico**.</span><span class="sxs-lookup"><span data-stu-id="06381-313">**Geographic**.</span></span> <span data-ttu-id="06381-314">Viene restituito l'endpoint mappato per fornire la posizione geografica in base all'IP della richiesta di query.</span><span class="sxs-lookup"><span data-stu-id="06381-314">The endpoint mapped to serve the geographic location based on the query request IP’s is returned.</span></span> <span data-ttu-id="06381-315">Se tale endpoint non è disponibile, non verrà selezionato un altro endpoint per eseguire il failover, poiché un'area geografica può essere mappata solo a un endpoint in un profilo. Per altre informazioni, vedere le [domande frequenti](traffic-manager-FAQs.md#traffic-manager-geographic-traffic-routing-method).</span><span class="sxs-lookup"><span data-stu-id="06381-315">If that endpoint is unavailable, another endpoint will not be selected to failover to, since a geographic location can be mapped only to one endpoint in a profile (more details are in the [FAQ](traffic-manager-FAQs.md#traffic-manager-geographic-traffic-routing-method)).</span></span> <span data-ttu-id="06381-316">Come procedura consigliata, quando si usa il routing geografico, si consiglia ai clienti di usare profili di Gestione traffico annidati con più di un endpoint come endpoint del profilo.</span><span class="sxs-lookup"><span data-stu-id="06381-316">As a best practice, when using geographic routing, we recommend customers to use nested Traffic Manager profiles with more than one endpoint as the endpoints of the profile.</span></span>

<span data-ttu-id="06381-317">Per altre informazioni, vedere [Metodi di routing del traffico di Gestione traffico](traffic-manager-routing-methods.md).</span><span class="sxs-lookup"><span data-stu-id="06381-317">For more information, see [Traffic Manager traffic-routing methods](traffic-manager-routing-methods.md).</span></span>

> [!NOTE]
> <span data-ttu-id="06381-318">Un'eccezione al normale comportamento del routing del traffico si verifica quando lo stato di tutti gli endpoint idonei risulta Degraded.</span><span class="sxs-lookup"><span data-stu-id="06381-318">One exception to normal traffic-routing behavior occurs when all eligible endpoints have a degraded status.</span></span> <span data-ttu-id="06381-319">Gestione traffico effettua un tentativo e *risponde come se tutti gli endpoint con stato Degraded fossero in realtà Online*,</span><span class="sxs-lookup"><span data-stu-id="06381-319">Traffic Manager makes a "best effort" attempt and *responds as if all the Degraded status endpoints actually are in an online state*.</span></span> <span data-ttu-id="06381-320">una condizione preferibile all'alternativa di non restituire endpoint nella risposta DNS.</span><span class="sxs-lookup"><span data-stu-id="06381-320">This behavior is preferable to the alternative, which would be to not return any endpoint in the DNS response.</span></span> <span data-ttu-id="06381-321">Gli endpoint disabilitati o arrestati non vengono monitorati, di conseguenza non sono considerati idonei per il traffico.</span><span class="sxs-lookup"><span data-stu-id="06381-321">Disabled or Stopped endpoints are not monitored, therefore, they are not considered eligible for traffic.</span></span>
>
> <span data-ttu-id="06381-322">Questa condizione è in genere causata da una configurazione non corretta del servizio, ad esempio:</span><span class="sxs-lookup"><span data-stu-id="06381-322">This condition is commonly caused by improper configuration of the service, such as:</span></span>
>
> * <span data-ttu-id="06381-323">Un elenco di controllo di accesso [ACL] che blocca i controlli di integrità di Gestione traffico.</span><span class="sxs-lookup"><span data-stu-id="06381-323">An access control list [ACL] blocking the Traffic Manager health checks.</span></span>
> * <span data-ttu-id="06381-324">Una configurazione non corretta del protocollo o della porta di monitoraggio nel profilo di Gestione traffico.</span><span class="sxs-lookup"><span data-stu-id="06381-324">An improper configuration of the monitoring port or protocol in the Traffic manager profile.</span></span>
>
> <span data-ttu-id="06381-325">La conseguenza di questo comportamento è che se i controlli di integrità di Gestione traffico non sono configurati in modo appropriato, dal routing del traffico potrebbe sembrare che Gestione traffico *funzioni* correttamente.</span><span class="sxs-lookup"><span data-stu-id="06381-325">The consequence of this behavior is that if Traffic Manager health checks are not configured correctly, it might appear from the traffic routing as though Traffic Manager *is* working properly.</span></span> <span data-ttu-id="06381-326">In questo caso il failover degli endpoint non viene tuttavia eseguito, con ripercussioni sulla disponibilità complessiva dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="06381-326">However, in this case, endpoint failover cannot happen which affects overall application availability.</span></span> <span data-ttu-id="06381-327">È importante verificare che il profilo indichi lo stato Online e non Degraded.</span><span class="sxs-lookup"><span data-stu-id="06381-327">It is important to check that the profile shows an Online status, not a Degraded status.</span></span> <span data-ttu-id="06381-328">Lo stato Online indica che i controlli di integrità di Gestione traffico funzionano come previsto.</span><span class="sxs-lookup"><span data-stu-id="06381-328">An Online status indicates that the Traffic Manager health checks are working as expected.</span></span>

<span data-ttu-id="06381-329">Per altre informazioni su come risolvere i problemi relativi ai controlli di integrità non riusciti, vedere [Risoluzione dei problemi relativi allo stato danneggiato di Gestione traffico](traffic-manager-troubleshooting-degraded.md).</span><span class="sxs-lookup"><span data-stu-id="06381-329">For more information about troubleshooting failed health checks, see [Troubleshooting Degraded status on Azure Traffic Manager](traffic-manager-troubleshooting-degraded.md).</span></span>



## <a name="next-steps"></a><span data-ttu-id="06381-330">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="06381-330">Next steps</span></span>

<span data-ttu-id="06381-331">Informazioni sul [funzionamento di Gestione traffico](traffic-manager-how-traffic-manager-works.md)</span><span class="sxs-lookup"><span data-stu-id="06381-331">Learn [how Traffic Manager works](traffic-manager-how-traffic-manager-works.md)</span></span>

<span data-ttu-id="06381-332">Ulteriori informazioni sui [metodi di routing del traffico](traffic-manager-routing-methods.md) supportati da Gestione traffico</span><span class="sxs-lookup"><span data-stu-id="06381-332">Learn more about the [traffic-routing methods](traffic-manager-routing-methods.md) supported by Traffic Manager</span></span>

<span data-ttu-id="06381-333">Informazioni su come [creare un profilo di Gestione traffico](traffic-manager-manage-profiles.md)</span><span class="sxs-lookup"><span data-stu-id="06381-333">Learn how to [create a Traffic Manager profile](traffic-manager-manage-profiles.md)</span></span>

<span data-ttu-id="06381-334">[Risoluzione dei problemi relativi allo stato Degraded](traffic-manager-troubleshooting-degraded.md) di un endpoint di Gestione traffico</span><span class="sxs-lookup"><span data-stu-id="06381-334">[Troubleshoot Degraded status](traffic-manager-troubleshooting-degraded.md) on a Traffic Manager endpoint</span></span>
