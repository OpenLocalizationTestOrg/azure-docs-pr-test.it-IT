---
title: Elaborare i dati del sensore veicolo con Apache Storm in HDInsight | Documentazione Microsoft
description: Informazioni su come elaborare i dati del sensore veicolo dagli hub eventi usando Apache Storm in HDInsight Aggiungere i dati del modello da Azure Cosmos DB e archiviarne l'output nella memoria.
services: hdinsight,documentdb,notification-hubs
documentationcenter: 
author: Blackmist
manager: jhubbard
editor: cgronlun
ms.assetid: 78980635-8bef-4c33-96c3-fae50e932e31
ms.service: hdinsight
ms.custom: hdinsightactive
ms.devlang: java
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: big-data
ms.date: 05/03/2017
ms.author: larryfr
ms.openlocfilehash: 8e8ebc724e1c70e8fcd56312adef5da2342373ea
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 07/11/2017
---
# <a name="process-vehicle-sensor-data-from-azure-event-hubs-using-apache-storm-on-hdinsight"></a><span data-ttu-id="ebb81-104">Elaborare i dati del sensore veicolo dagli hub eventi di Azure usando Apache Storm in HDInsight</span><span class="sxs-lookup"><span data-stu-id="ebb81-104">Process vehicle sensor data from Azure Event Hubs using Apache Storm on HDInsight</span></span>

<span data-ttu-id="ebb81-105">Informazioni su come elaborare i dati del sensore veicolo dagli hub eventi di Azure usando Apache Storm in HDInsight</span><span class="sxs-lookup"><span data-stu-id="ebb81-105">Learn how to process vehicle sensor data from Azure Event Hubs using Apache Storm on HDInsight.</span></span> <span data-ttu-id="ebb81-106">In questo esempio vengono letti i dati del sensore da Hub eventi di Azure e vengono arricchiti tali dati facendo riferimento a quelli archiviati in Azure Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="ebb81-106">This example reads sensor data from Azure Event Hubs, enriches the data by referencing data stored in Azure Cosmos DB.</span></span> <span data-ttu-id="ebb81-107">I dati vengono infine archiviati in Archiviazione di Azure usando il file system Hadoop (HDFS).</span><span class="sxs-lookup"><span data-stu-id="ebb81-107">The data is stored into Azure Storage using the Hadoop File System (HDFS).</span></span>

![HDInsight e il diagramma dell'architettura IoT (Internet of Things)](./media/hdinsight-storm-iot-eventhub-documentdb/iot.png)

## <a name="overview"></a><span data-ttu-id="ebb81-109">Panoramica</span><span class="sxs-lookup"><span data-stu-id="ebb81-109">Overview</span></span>

<span data-ttu-id="ebb81-110">L'aggiunta di sensori ai veicoli consente di prevedere problemi alle apparecchiature in base alle tendenze dei dati cronologici,</span><span class="sxs-lookup"><span data-stu-id="ebb81-110">Adding sensors to vehicles allows you to predict equipment problems based on historical data trends.</span></span> <span data-ttu-id="ebb81-111">nonché di apportare miglioramenti a future versioni in base all'analisi dei modelli di utilizzo.</span><span class="sxs-lookup"><span data-stu-id="ebb81-111">It also allows you to make improvements to future versions based on usage pattern analysis.</span></span> <span data-ttu-id="ebb81-112">È necessario poter caricare i dati da tutti i veicoli in Hadoop in modo rapido ed efficiente prima di eseguire l'elaborazione MapReduce.</span><span class="sxs-lookup"><span data-stu-id="ebb81-112">You must be able to quickly and efficiently load the data from all vehicles into Hadoop before MapReduce processing can occur.</span></span> <span data-ttu-id="ebb81-113">Inoltre, può essere utile eseguire analisi in tempo reale per i percorsi di errore critico, quali temperatura del motore, freni e così via.</span><span class="sxs-lookup"><span data-stu-id="ebb81-113">Additionally, you may wish to do analysis for critical failure paths (engine temperature, brakes, etc.) in real time.</span></span>

<span data-ttu-id="ebb81-114">Hub eventi di Azure è progettato per gestire l'ingente volume di dati generati dai sensori.</span><span class="sxs-lookup"><span data-stu-id="ebb81-114">Azure Event Hubs is built to handle the massive volume of data generated by sensors.</span></span> <span data-ttu-id="ebb81-115">È possibile usare Apache Storm per caricare ed elaborare i dati prima di archiviarli in HDFS.</span><span class="sxs-lookup"><span data-stu-id="ebb81-115">Apache Storm can be used to load and process the data before storing it into HDFS.</span></span>

## <a name="solution"></a><span data-ttu-id="ebb81-116">Soluzione</span><span class="sxs-lookup"><span data-stu-id="ebb81-116">Solution</span></span>

<span data-ttu-id="ebb81-117">I dati di telemetria relativi a temperatura del motore, temperatura ambiente e velocità del veicolo vengono registrati dai sensori.</span><span class="sxs-lookup"><span data-stu-id="ebb81-117">Telemetry data for engine temperature, ambient temperature, and vehicle speed is recorded by sensors.</span></span> <span data-ttu-id="ebb81-118">Vengono quindi inviati a Hub eventi insieme al numero identificativo del veicolo (numero di telaio) e a un timestamp.</span><span class="sxs-lookup"><span data-stu-id="ebb81-118">Data is then sent to Event Hubs along with the car's Vehicle Identification Number (VIN) and a time stamp.</span></span> <span data-ttu-id="ebb81-119">A questo punto, una topologia Storm in esecuzione in un cluster Apache Storm in HDInsight legge i dati, li elabora e li archivia in HDFS.</span><span class="sxs-lookup"><span data-stu-id="ebb81-119">From there, a Storm Topology running on an Apache Storm on HDInsight cluster reads the data, processes it, and stores it into HDFS.</span></span>

<span data-ttu-id="ebb81-120">Durante l'elaborazione viene usato il numero identificativo del veicolo per recuperare informazioni sul modello da Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="ebb81-120">During processing, the VIN is used to retrieve model information from Cosmos DB.</span></span> <span data-ttu-id="ebb81-121">Questi dati vengono aggiunti al flusso di dati prima dell'archiviazione.</span><span class="sxs-lookup"><span data-stu-id="ebb81-121">This data is added to the data stream before it is stored.</span></span>

<span data-ttu-id="ebb81-122">I componenti usati nella topologia Storm sono:</span><span class="sxs-lookup"><span data-stu-id="ebb81-122">The components used in the Storm Topology are:</span></span>

* <span data-ttu-id="ebb81-123">**EventHubSpout** : legge i dati dagli hub eventi di Azure</span><span class="sxs-lookup"><span data-stu-id="ebb81-123">**EventHubSpout** - reads data from Azure Event Hubs</span></span>
* <span data-ttu-id="ebb81-124">**TypeConversionBolt**: converte la stringa JSON da Hub eventi in una tupla contenente i dati del sensore seguenti:</span><span class="sxs-lookup"><span data-stu-id="ebb81-124">**TypeConversionBolt** - converts the JSON string from Event Hubs into a tuple containing the following sensor data:</span></span>
    * <span data-ttu-id="ebb81-125">engineTemperature</span><span class="sxs-lookup"><span data-stu-id="ebb81-125">Engine temperature</span></span>
    * <span data-ttu-id="ebb81-126">Temperatura ambiente</span><span class="sxs-lookup"><span data-stu-id="ebb81-126">Ambient temperature</span></span>
    * <span data-ttu-id="ebb81-127">speed</span><span class="sxs-lookup"><span data-stu-id="ebb81-127">Speed</span></span>
    * <span data-ttu-id="ebb81-128">vin</span><span class="sxs-lookup"><span data-stu-id="ebb81-128">VIN</span></span>
    * <span data-ttu-id="ebb81-129">Timestamp</span><span class="sxs-lookup"><span data-stu-id="ebb81-129">Timestamp</span></span>
* <span data-ttu-id="ebb81-130">**DataReferencBolt**: cerca il modello del veicolo in Cosmos DB usando il numero identificativo del veicolo</span><span class="sxs-lookup"><span data-stu-id="ebb81-130">**DataReferencBolt** - looks up the vehicle model from Cosmos DB using the VIN</span></span>
* <span data-ttu-id="ebb81-131">**WasbStoreBolt** : archivia i dati in HDFS (Archiviazione di Azure)</span><span class="sxs-lookup"><span data-stu-id="ebb81-131">**WasbStoreBolt** - stores the data to HDFS (Azure Storage)</span></span>

<span data-ttu-id="ebb81-132">Di seguito è riportato un diagramma di questa soluzione:</span><span class="sxs-lookup"><span data-stu-id="ebb81-132">The following image is a diagram of this solution:</span></span>

![topologia storm](./media/hdinsight-storm-iot-eventhub-documentdb/iottopology.png)

## <a name="implementation"></a><span data-ttu-id="ebb81-134">Implementazione</span><span class="sxs-lookup"><span data-stu-id="ebb81-134">Implementation</span></span>

<span data-ttu-id="ebb81-135">Una soluzione completa e automatizzata per questo scenario è disponibile nel repository di [esempi relativi a Storm in HDInsight](https://github.com/hdinsight/hdinsight-storm-examples) su GitHub.</span><span class="sxs-lookup"><span data-stu-id="ebb81-135">A complete, automated solution for this scenario is available as part of the [HDInsight-Storm-Examples](https://github.com/hdinsight/hdinsight-storm-examples) repository on GitHub.</span></span> <span data-ttu-id="ebb81-136">Per usare questo esempio, attenersi alla procedura riportata in [IoTExample README. MD](https://github.com/hdinsight/hdinsight-storm-examples/blob/master/IotExample/README.md).</span><span class="sxs-lookup"><span data-stu-id="ebb81-136">To use this example, follow the steps in the [IoTExample README.MD](https://github.com/hdinsight/hdinsight-storm-examples/blob/master/IotExample/README.md).</span></span>

## <a name="next-steps"></a><span data-ttu-id="ebb81-137">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="ebb81-137">Next Steps</span></span>

<span data-ttu-id="ebb81-138">Per altri esempi di topologie Storm, vedere [Topologie di esempio per Storm in HDInsight](hdinsight-storm-example-topology.md).</span><span class="sxs-lookup"><span data-stu-id="ebb81-138">For more example Storm topologies, see [Example topologies for Storm on HDInsight](hdinsight-storm-example-topology.md).</span></span>

