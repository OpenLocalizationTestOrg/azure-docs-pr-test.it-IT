---
title: Aggiornamento delle applicazioni di Service Fabric | Documentazione Microsoft
description: "Questo articolo fornisce un'introduzione all'aggiornamento di un'applicazione di Service Fabric, inclusa la scelta delle modalità di aggiornamento e dei controlli di integrità eseguiti."
services: service-fabric
documentationcenter: .net
author: mani-ramaswamy
manager: timlt
editor: 
ms.assetid: 803c9c63-373a-4d6a-8ef2-ea97e16e88dd
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 8/9/2017
ms.author: subramar
ms.openlocfilehash: 4c2752bee8e9a859b23dbf47662d15798b551bb5
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/18/2017
---
# <a name="service-fabric-application-upgrade"></a><span data-ttu-id="ef0fc-103">Aggiornamento di un'applicazione di infrastruttura di servizi</span><span class="sxs-lookup"><span data-stu-id="ef0fc-103">Service Fabric application upgrade</span></span>
<span data-ttu-id="ef0fc-104">Un'applicazione di Azure Service Fabric è una raccolta di servizi.</span><span class="sxs-lookup"><span data-stu-id="ef0fc-104">An Azure Service Fabric application is a collection of services.</span></span> <span data-ttu-id="ef0fc-105">Durante un aggiornamento, Service Fabric confronta il nuovo [manifesto dell'applicazione](service-fabric-application-model.md#describe-an-application) con la versione precedente e determina quali servizi dell'applicazione richiedono aggiornamenti.</span><span class="sxs-lookup"><span data-stu-id="ef0fc-105">During an upgrade, Service Fabric compares the new [application manifest](service-fabric-application-model.md#describe-an-application) with the previous version and determines which services in the application require updates.</span></span> <span data-ttu-id="ef0fc-106">Service Fabric confronta i numeri di versione nel manifesto del servizio con quelli della versione precedente.</span><span class="sxs-lookup"><span data-stu-id="ef0fc-106">Service Fabric compares the version numbers in the service manifests with the version numbers in the previous version.</span></span> <span data-ttu-id="ef0fc-107">Se un servizio non è cambiato, non viene aggiornato.</span><span class="sxs-lookup"><span data-stu-id="ef0fc-107">If a service has not changed, that service is not upgraded.</span></span>

## <a name="rolling-upgrades-overview"></a><span data-ttu-id="ef0fc-108">Panoramica degli aggiornamenti in sequenza</span><span class="sxs-lookup"><span data-stu-id="ef0fc-108">Rolling upgrades overview</span></span>
<span data-ttu-id="ef0fc-109">In un aggiornamento in sequenza di un'applicazione l'operazione viene eseguita in fasi.</span><span class="sxs-lookup"><span data-stu-id="ef0fc-109">In a rolling application upgrade, the upgrade is performed in stages.</span></span> <span data-ttu-id="ef0fc-110">In ogni fase l'aggiornamento viene applicato a un subset di nodi del cluster denominato dominio di aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="ef0fc-110">At each stage, the upgrade is applied to a subset of nodes in the cluster, called an update domain.</span></span> <span data-ttu-id="ef0fc-111">In questo modo l'applicazione continua a essere disponibile durante l'aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="ef0fc-111">As a result, the application remains available throughout the upgrade.</span></span> <span data-ttu-id="ef0fc-112">È possibile che durante l'aggiornamento il cluster contenga una combinazione di versioni precedenti e nuove.</span><span class="sxs-lookup"><span data-stu-id="ef0fc-112">During the upgrade, the cluster may contain a mix of the old and new versions.</span></span>

<span data-ttu-id="ef0fc-113">Per questo motivo è necessario che le due versioni siano compatibili con le versioni precedenti e successive.</span><span class="sxs-lookup"><span data-stu-id="ef0fc-113">For that reason, the two versions must be forward and backward compatible.</span></span> <span data-ttu-id="ef0fc-114">In caso contrario, l'amministratore di applicazioni deve organizzare un aggiornamento in più fasi per mantenere la disponibilità.</span><span class="sxs-lookup"><span data-stu-id="ef0fc-114">If they are not compatible, the application administrator is responsible for staging a multiple-phase upgrade to maintain availability.</span></span> <span data-ttu-id="ef0fc-115">In un aggiornamento a più fasi come primo passaggio si esegue l'aggiornamento a una versione intermedia dell'applicazione che sia compatibile con la versione precedente.</span><span class="sxs-lookup"><span data-stu-id="ef0fc-115">In a multiple-phase upgrade, the first step is upgrading to an intermediate version of the application that is compatible with the previous version.</span></span> <span data-ttu-id="ef0fc-116">Come secondo passaggio si esegue l'aggiornamento alla versione finale, non più compatibile con la versione di pre-aggiornamento ma compatibile con la versione intermedia.</span><span class="sxs-lookup"><span data-stu-id="ef0fc-116">The second step is to upgrade the final version that breaks compatibility with the pre-update version, but is compatible with the intermediate version.</span></span>

<span data-ttu-id="ef0fc-117">I domini di aggiornamento vengono specificati nel manifesto del cluster quando si configura il cluster.</span><span class="sxs-lookup"><span data-stu-id="ef0fc-117">Update domains are specified in the cluster manifest when you configure the cluster.</span></span> <span data-ttu-id="ef0fc-118">I domini di aggiornamento non ricevono gli aggiornamenti in un ordine particolare.</span><span class="sxs-lookup"><span data-stu-id="ef0fc-118">Update domains do not receive updates in a particular order.</span></span> <span data-ttu-id="ef0fc-119">Un dominio di aggiornamento è un'unità logica di distribuzione per un'applicazione.</span><span class="sxs-lookup"><span data-stu-id="ef0fc-119">An update domain is a logical unit of deployment for an application.</span></span> <span data-ttu-id="ef0fc-120">I domini di aggiornamento consentono ai servizi di garantire disponibilità elevata durante un aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="ef0fc-120">Update domains allow the services to remain at high availability during an upgrade.</span></span>

<span data-ttu-id="ef0fc-121">Gli aggiornamenti non in sequenza sono possibili qualora l'aggiornamento venga applicato a tutti i nodi del cluster, ad esempio nel caso in cui l'applicazione disponga di un solo dominio di aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="ef0fc-121">Non-rolling upgrades are possible if the upgrade is applied to all nodes in the cluster, which is the case when the application has only one update domain.</span></span> <span data-ttu-id="ef0fc-122">Questo approccio non è consigliato perché durante l'aggiornamento il servizio rimane inattivo e non disponibile.</span><span class="sxs-lookup"><span data-stu-id="ef0fc-122">This approach is not recommended, since the service goes down and isn't available at the time of upgrade.</span></span> <span data-ttu-id="ef0fc-123">Azure, inoltre, non offre alcuna garanzia per i casi in cui un cluster è configurato con un solo dominio di aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="ef0fc-123">Additionally, Azure doesn't provide any guarantees when a cluster is set up with only one update domain.</span></span>

## <a name="health-checks-during-upgrades"></a><span data-ttu-id="ef0fc-124">Controlli di integrità durante gli aggiornamenti</span><span class="sxs-lookup"><span data-stu-id="ef0fc-124">Health checks during upgrades</span></span>
<span data-ttu-id="ef0fc-125">Per un aggiornamento devono essere impostati criteri di integrità oppure possono essere usati valori predefiniti.</span><span class="sxs-lookup"><span data-stu-id="ef0fc-125">For an upgrade, health policies have to be set (or default values may be used).</span></span> <span data-ttu-id="ef0fc-126">Un aggiornamento viene considerato riuscito quando tutti i domini di aggiornamento vengono aggiornati entro i valori di timeout specificati e risultano integri.</span><span class="sxs-lookup"><span data-stu-id="ef0fc-126">An upgrade is termed successful when all update domains are upgraded within the specified time-outs, and when all update domains are deemed healthy.</span></span>  <span data-ttu-id="ef0fc-127">Un dominio di aggiornamento integro significa che ha superato tutti i controlli di integrità specificati nei criteri di integrità.</span><span class="sxs-lookup"><span data-stu-id="ef0fc-127">A healthy update domain means that the update domain passed all the health checks specified in the health policy.</span></span> <span data-ttu-id="ef0fc-128">Un criterio di integrità, ad esempio, può richiedere che tutti i servizi all'interno di un'istanza dell'applicazione siano *integri*, secondo quanto definito per l'integrità da Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="ef0fc-128">For example, a health policy may mandate that all services within an application instance must be *healthy*, as health is defined by Service Fabric.</span></span>

<span data-ttu-id="ef0fc-129">I criteri e i controlli di integrità durante l'aggiornamento da parte dell’infrastruttura di servizi sono indipendenti dai servizi e dalle applicazioni.</span><span class="sxs-lookup"><span data-stu-id="ef0fc-129">Health policies and checks during upgrade by Service Fabric are service and application agnostic.</span></span> <span data-ttu-id="ef0fc-130">In altre parole, non vengono eseguiti test specifici per i servizi.</span><span class="sxs-lookup"><span data-stu-id="ef0fc-130">That is, no service-specific tests are done.</span></span>  <span data-ttu-id="ef0fc-131">Ad esempio il servizio potrebbe avere un requisito di velocità effettiva, ma Service Fabric non dispone delle informazioni per verificare la velocità effettiva.</span><span class="sxs-lookup"><span data-stu-id="ef0fc-131">For example, your service might have a throughput requirement, but Service Fabric does not have the information to check throughput.</span></span> <span data-ttu-id="ef0fc-132">Per informazioni sui controlli che vengono eseguiti, vedere gli [articoli sull'integrità](service-fabric-health-introduction.md) .</span><span class="sxs-lookup"><span data-stu-id="ef0fc-132">Refer to the [health articles](service-fabric-health-introduction.md) for the checks that are performed.</span></span> <span data-ttu-id="ef0fc-133">I controlli eseguiti durante l'aggiornamento includono test di verifica che il pacchetto dell'applicazione sia stato copiato correttamente, che l'istanza sia stata avviata e così via.</span><span class="sxs-lookup"><span data-stu-id="ef0fc-133">The checks that happen during an upgrade include tests for whether the application package was copied correctly, whether the instance was started, and so on.</span></span>

<span data-ttu-id="ef0fc-134">L'integrità dell'applicazione è un'aggregazione delle entità figlio dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="ef0fc-134">The application health is an aggregation of the child entities of the application.</span></span> <span data-ttu-id="ef0fc-135">In breve, Service Fabric valuta l'integrità dell'applicazione tramite l'integrità segnalata per l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="ef0fc-135">In short, Service Fabric evaluates the health of the application through the health that is reported on the application.</span></span> <span data-ttu-id="ef0fc-136">In questo modo, può valutare anche l'integrità di tutti i servizi relativi all'applicazione.</span><span class="sxs-lookup"><span data-stu-id="ef0fc-136">It also evaluates the health of all the services for the application this way.</span></span> <span data-ttu-id="ef0fc-137">In alternativa, Service Fabric può valutare l'integrità dei servizi aggregando l'integrità degli elementi figlio, ad esempio la replica dei servizi.</span><span class="sxs-lookup"><span data-stu-id="ef0fc-137">Service Fabric further evaluates the health of the application services by aggregating the health of their children, such as the service replica.</span></span> <span data-ttu-id="ef0fc-138">Se il criterio di integrità dell'applicazione è soddisfatto, l'aggiornamento può continuare.</span><span class="sxs-lookup"><span data-stu-id="ef0fc-138">Once the application health policy is satisfied, the upgrade can proceed.</span></span> <span data-ttu-id="ef0fc-139">In caso contrario, l'aggiornamento dell'applicazione ha esito negativo.</span><span class="sxs-lookup"><span data-stu-id="ef0fc-139">If the health policy is violated, the application upgrade fails.</span></span>

## <a name="upgrade-modes"></a><span data-ttu-id="ef0fc-140">Modalità di aggiornamento</span><span class="sxs-lookup"><span data-stu-id="ef0fc-140">Upgrade modes</span></span>
<span data-ttu-id="ef0fc-141">La modalità consigliata per l'aggiornamento dell'applicazione è la modalità monitorata, il metodo più comune.</span><span class="sxs-lookup"><span data-stu-id="ef0fc-141">The mode that we recommend for application upgrade is the monitored mode, which is the commonly used mode.</span></span> <span data-ttu-id="ef0fc-142">che esegue l'aggiornamento di un dominio di aggiornamento e, se vengono superati tutti i controlli di integrità (in base ai criteri specificati), passa automaticamente al dominio di aggiornamento successivo.</span><span class="sxs-lookup"><span data-stu-id="ef0fc-142">Monitored mode performs the upgrade on one update domain, and if all health checks pass (per the policy specified), moves on to the next update domain automatically.</span></span>  <span data-ttu-id="ef0fc-143">In caso di esito negativo e/o di timeout dei controlli di integrità, viene eseguito il rollback dell'aggiornamento del dominio di aggiornamento oppure la modalità cambia in UnmonitoredManual.</span><span class="sxs-lookup"><span data-stu-id="ef0fc-143">If health checks fail and/or time-outs are reached, the upgrade is either rolled back for the update domain, or the mode is changed to unmonitored manual.</span></span> <span data-ttu-id="ef0fc-144">È possibile configurare l'aggiornamento in modo che venga scelta una di queste due modalità per gli aggiornamenti non riusciti.</span><span class="sxs-lookup"><span data-stu-id="ef0fc-144">You can configure the upgrade to choose one of those two modes for failed upgrades.</span></span> 

<span data-ttu-id="ef0fc-145">La modalità UnmonitoredManual richiede l'intervento manuale dopo ogni aggiornamento eseguito in un dominio di aggiornamento per passare al dominio di aggiornamento successivo.</span><span class="sxs-lookup"><span data-stu-id="ef0fc-145">Unmonitored manual mode needs manual intervention after every upgrade on an update domain, to kick off the upgrade on the next update domain.</span></span> <span data-ttu-id="ef0fc-146">Non viene eseguito alcun controllo di integrità su Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="ef0fc-146">No Service Fabric health checks are performed.</span></span> <span data-ttu-id="ef0fc-147">L'amministratore esegue i controlli di integrità o di stato previsti prima di avviare l'aggiornamento nel dominio di aggiornamento successivo.</span><span class="sxs-lookup"><span data-stu-id="ef0fc-147">The administrator performs the health or status checks before starting the upgrade in the next update domain.</span></span>

## <a name="upgrade-default-services"></a><span data-ttu-id="ef0fc-148">Aggiornare i servizi predefiniti</span><span class="sxs-lookup"><span data-stu-id="ef0fc-148">Upgrade default services</span></span>
<span data-ttu-id="ef0fc-149">I servizi predefiniti all'interno dell'applicazione Service Fabric possono essere aggiornati durante il processo di aggiornamento di un'applicazione.</span><span class="sxs-lookup"><span data-stu-id="ef0fc-149">Default services within Service Fabric application can be upgraded during the upgrade process of an application.</span></span> <span data-ttu-id="ef0fc-150">I servizi predefiniti sono definiti nel [manifesto dell'applicazione](service-fabric-application-model.md#describe-an-application).</span><span class="sxs-lookup"><span data-stu-id="ef0fc-150">Default services are defined in the [application manifest](service-fabric-application-model.md#describe-an-application).</span></span> <span data-ttu-id="ef0fc-151">Le regole standard di aggiornamento dei servizi predefiniti sono:</span><span class="sxs-lookup"><span data-stu-id="ef0fc-151">The standard rules of upgrading default services are:</span></span>

1. <span data-ttu-id="ef0fc-152">I servizi predefiniti nel nuovo [manifesto dell'applicazione](service-fabric-application-model.md#describe-an-application) che non esistono nel cluster vengono creati.</span><span class="sxs-lookup"><span data-stu-id="ef0fc-152">Default services in the new [application manifest](service-fabric-application-model.md#describe-an-application) that do not exist in the cluster are created.</span></span>
> [!TIP]
> <span data-ttu-id="ef0fc-153">È necessario impostare [EnableDefaultServicesUpgrade](service-fabric-cluster-fabric-settings.md#fabric-settings-that-you-can-customize) su true per abilitare le regole seguenti.</span><span class="sxs-lookup"><span data-stu-id="ef0fc-153">[EnableDefaultServicesUpgrade](service-fabric-cluster-fabric-settings.md#fabric-settings-that-you-can-customize) needs to be set to true to enable the following rules.</span></span> <span data-ttu-id="ef0fc-154">Questa funzionalità è supportata dalla versione 5.5.</span><span class="sxs-lookup"><span data-stu-id="ef0fc-154">This feature is supported from v5.5.</span></span>

2. <span data-ttu-id="ef0fc-155">I servizi predefiniti che esistono sia nel [manifesto dell'applicazione](service-fabric-application-model.md#describe-an-application) precedente sia nella nuova versione vengono aggiornati.</span><span class="sxs-lookup"><span data-stu-id="ef0fc-155">Default services existing in both previous [application manifest](service-fabric-application-model.md#describe-an-application) and new version are updated.</span></span> <span data-ttu-id="ef0fc-156">Le descrizioni dei servizi della nuova versione sovrascrivono quelle già presenti nel cluster.</span><span class="sxs-lookup"><span data-stu-id="ef0fc-156">Service descriptions in the new version would overwrite those already in the cluster.</span></span> <span data-ttu-id="ef0fc-157">L'aggiornamento di un'applicazione subisce automaticamente il rollback in caso di errore dell'aggiornamento del servizio predefinito.</span><span class="sxs-lookup"><span data-stu-id="ef0fc-157">Application upgrade would rollback automatically upon updating default service failure.</span></span>
3. <span data-ttu-id="ef0fc-158">I servizi predefiniti del [manifesto dell'applicazione](service-fabric-application-model.md#describe-an-application) precedente che non sono presenti nella nuova versione vengono eliminati.</span><span class="sxs-lookup"><span data-stu-id="ef0fc-158">Default services in the previous [application manifest](service-fabric-application-model.md#describe-an-application) but not in the new version are deleted.</span></span> <span data-ttu-id="ef0fc-159">**Si noti che questa eliminazione dei servizi predefiniti non è reversibile.**</span><span class="sxs-lookup"><span data-stu-id="ef0fc-159">**Note that this deleting default services can not be reverted.**</span></span>

<span data-ttu-id="ef0fc-160">In caso di rollback dell'aggiornamento di un'applicazione, i servizi predefiniti vengono riportati allo stato precedente l'avvio dell'aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="ef0fc-160">In case of an application upgrade is rolled back, default services are reverted to the status before upgrade started.</span></span> <span data-ttu-id="ef0fc-161">I servizi eliminati non possono in alcun caso essere creati.</span><span class="sxs-lookup"><span data-stu-id="ef0fc-161">But deleted services can never be created.</span></span>

## <a name="application-upgrade-flowchart"></a><span data-ttu-id="ef0fc-162">Diagramma di flusso di aggiornamento di un'applicazione</span><span class="sxs-lookup"><span data-stu-id="ef0fc-162">Application upgrade flowchart</span></span>
<span data-ttu-id="ef0fc-163">Il diagramma di flusso che segue questo paragrafo aiuta a capire il processo di aggiornamento di un'applicazione di Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="ef0fc-163">The flowchart following this paragraph can help you understand the upgrade process of a Service Fabric application.</span></span> <span data-ttu-id="ef0fc-164">In particolare, il flusso descrive in che modo i valori di timeout, ad esempio *HealthCheckStableDuration*, *HealthCheckRetryTimeout* e *UpgradeHealthCheckInterval*, consentono di verificare se l'aggiornamento in un dominio di aggiornamento viene considerato riuscito o non riuscito.</span><span class="sxs-lookup"><span data-stu-id="ef0fc-164">In particular, the flow describes how the time-outs, including *HealthCheckStableDuration*, *HealthCheckRetryTimeout*, and *UpgradeHealthCheckInterval*, help control when the upgrade in one update domain is considered a success or a failure.</span></span>

![Processo di aggiornamento per un'applicazione di Service Fabric][image]

## <a name="next-steps"></a><span data-ttu-id="ef0fc-166">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="ef0fc-166">Next steps</span></span>
<span data-ttu-id="ef0fc-167">[Esercitazione sull'aggiornamento di un'applicazione di Service Fabric tramite Visual Studio](service-fabric-application-upgrade-tutorial.md) descrive la procedura di aggiornamento di un'applicazione con Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="ef0fc-167">[Upgrading your Application Using Visual Studio](service-fabric-application-upgrade-tutorial.md) walks you through an application upgrade using Visual Studio.</span></span>

<span data-ttu-id="ef0fc-168">[Aggiornamento di un'applicazione di Service Fabric mediante PowerShell](service-fabric-application-upgrade-tutorial-powershell.md) descrive la procedura di aggiornamento di un'applicazione tramite PowerShell.</span><span class="sxs-lookup"><span data-stu-id="ef0fc-168">[Upgrading your Application Using Powershell](service-fabric-application-upgrade-tutorial-powershell.md) walks you through an application upgrade using PowerShell.</span></span>

<span data-ttu-id="ef0fc-169">Controllare l’aggiornamento dell'applicazione tramite [Parametri di aggiornamento](service-fabric-application-upgrade-parameters.md).</span><span class="sxs-lookup"><span data-stu-id="ef0fc-169">Control how your application upgrades by using [Upgrade Parameters](service-fabric-application-upgrade-parameters.md).</span></span>

<span data-ttu-id="ef0fc-170">Rendere compatibili gli aggiornamenti dell'applicazione imparando a usare [Serializzazione dei dati](service-fabric-application-upgrade-data-serialization.md).</span><span class="sxs-lookup"><span data-stu-id="ef0fc-170">Make your application upgrades compatible by learning how to use [Data Serialization](service-fabric-application-upgrade-data-serialization.md).</span></span>

<span data-ttu-id="ef0fc-171">Per informazioni su come usare funzionalità avanzate durante l'aggiornamento dell'applicazione, vedere [Argomenti avanzati](service-fabric-application-upgrade-advanced.md).</span><span class="sxs-lookup"><span data-stu-id="ef0fc-171">Learn how to use advanced functionality while upgrading your application by referring to [Advanced Topics](service-fabric-application-upgrade-advanced.md).</span></span>

<span data-ttu-id="ef0fc-172">Per informazioni su come risolvere problemi comuni negli aggiornamenti dell'applicazione, vedere i passaggi indicati in [Risoluzione dei problemi relativi agli aggiornamenti dell'applicazione](service-fabric-application-upgrade-troubleshooting.md).</span><span class="sxs-lookup"><span data-stu-id="ef0fc-172">Fix common problems in application upgrades by referring to the steps in [Troubleshooting Application Upgrades](service-fabric-application-upgrade-troubleshooting.md).</span></span>

[image]: media/service-fabric-application-upgrade/service-fabric-application-upgrade-flowchart.png
