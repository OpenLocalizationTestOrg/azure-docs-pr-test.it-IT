---
title: architettura di Azure HDInsight unita aaaDomain | Documenti Microsoft
description: Informazioni su come tooplan dominio HDInsight.
services: hdinsight
documentationcenter: 
author: saurinsh
manager: jhubbard
editor: cgronlun
tags: azure-portal
ms.assetid: 7dc6847d-10d4-4b5c-9c83-cc513cf91965
ms.service: hdinsight
ms.custom: hdinsightactive
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: big-data
ms.date: 02/03/2017
ms.author: saurinsh
ms.openlocfilehash: 1c3ecedf3739b4f8fa54160225be9c1d6e2ca6cc
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/06/2017
---
# <a name="plan-azure-domain-joined-hadoop-clusters-in-hdinsight"></a><span data-ttu-id="5464d-103">Pianificare cluster Hadoop aggiunti a un dominio di Azure in HDInsight</span><span class="sxs-lookup"><span data-stu-id="5464d-103">Plan Azure domain-joined Hadoop clusters in HDInsight</span></span>

<span data-ttu-id="5464d-104">Hello Hadoop tradizionale è un cluster singolo utente.</span><span class="sxs-lookup"><span data-stu-id="5464d-104">hello traditional Hadoop is a single-user cluster.</span></span> <span data-ttu-id="5464d-105">adatto alla maggior parte delle aziende con team di piccole dimensioni che compilano carichi di lavoro di dati di grandi dimensioni.</span><span class="sxs-lookup"><span data-stu-id="5464d-105">It is suitable for most companies that have smaller application teams building large data workloads.</span></span> <span data-ttu-id="5464d-106">Man mano che aumenta la diffusione di Hadoop, molte aziende stanno passando a un modello in cui i cluster sono gestiti da team IT e condivisi tra più team di sviluppo.</span><span class="sxs-lookup"><span data-stu-id="5464d-106">As Hadoop gains popularity, many enterprises are moving toward a model in which clusters are managed by IT teams and multiple application teams share clusters.</span></span> <span data-ttu-id="5464d-107">Di conseguenza, le funzionalità che coinvolgono cluster multiutente sono tra hello più funzionalità richieste in Azure HDInsight.</span><span class="sxs-lookup"><span data-stu-id="5464d-107">Thus, functionalities involving multiuser clusters are among hello most requested functionalities in Azure HDInsight.</span></span>

<span data-ttu-id="5464d-108">Invece di compilare il proprio multiutente autenticazione e autorizzazione, HDInsight si basa su hello più provider di identità, Active Directory (AD).</span><span class="sxs-lookup"><span data-stu-id="5464d-108">Instead of building its own multiuser authentication and authorization, HDInsight relies on hello most popular identity provider--Active Directory (AD).</span></span> <span data-ttu-id="5464d-109">Hello potenti funzionalità per la sicurezza Active Directory può essere utilizzato toomanage autorizzazione multiutente in HDInsight.</span><span class="sxs-lookup"><span data-stu-id="5464d-109">hello powerful security functionality in AD can be used toomanage multiuser authorization in HDInsight.</span></span> <span data-ttu-id="5464d-110">Grazie all'integrazione di HDInsight con Active Directory, è possibile comunicare con i cluster hello utilizzando le credenziali di Active Directory.</span><span class="sxs-lookup"><span data-stu-id="5464d-110">By integrating HDInsight with AD, you can communicate with hello clusters by using your AD credentials.</span></span> <span data-ttu-id="5464d-111">HDInsight esegue il mapping di un annuncio utente tooa Hadoop utente locale, in modo da tutti i servizi in esecuzione su HDInsight di hello (Ambari, Hive Spark thrift di server, cane, server e altri) funzionare senza problemi per l'utente autenticato hello.</span><span class="sxs-lookup"><span data-stu-id="5464d-111">HDInsight maps an AD user tooa local Hadoop user, so all hello services running on HDInsight (Ambari, Hive server, Ranger, Spark thrift server, and others) work seamlessly for hello authenticated user.</span></span>

## <a name="integrate-hdinsight-with-ad-and-ad-on-iaas-vm"></a><span data-ttu-id="5464d-112">Integrazione di HDInsight con AD e AD nella macchina virtuale IaaS</span><span class="sxs-lookup"><span data-stu-id="5464d-112">Integrate HDInsight with AD and AD on IaaS VM</span></span>

<span data-ttu-id="5464d-113">Grazie all'integrazione di HDInsight con Azure Active Directory o Active Directory in VM Iaas, i nodi del cluster HDInsight hello sono aggiunti a un dominio tooa dominio.</span><span class="sxs-lookup"><span data-stu-id="5464d-113">By integrating HDInsight with Azure AD or AD on Iaas VM, hello HDInsight cluster nodes are domain-joined tooa domain.</span></span> <span data-ttu-id="5464d-114">HDInsight crea le entità servizio per hello servizi Hadoop in esecuzione nel cluster hello e li inserisce in un'unità organizzativa specificata (OU) in Azure Active Directory o Active Directory in VM IaaS.</span><span class="sxs-lookup"><span data-stu-id="5464d-114">HDInsight creates service principals for hello Hadoop services running on hello cluster and places them within a specified organizational unit (OU) in Azure AD or AD on IaaS VM.</span></span> <span data-ttu-id="5464d-115">HDInsight crea anche i mapping DNS inversi nel dominio hello hello indirizzi IP dei nodi di hello toohello aggiunti a un dominio.</span><span class="sxs-lookup"><span data-stu-id="5464d-115">HDInsight also creates reverse DNS mappings in hello domain for hello IP addresses of hello nodes that are joined toohello domain.</span></span>

<span data-ttu-id="5464d-116">È possibile eseguire questa configurazione usando più architetture.</span><span class="sxs-lookup"><span data-stu-id="5464d-116">You can achieve this setup by using multiple architectures.</span></span> <span data-ttu-id="5464d-117">È possibile scegliere tra hello seguendo le architetture.</span><span class="sxs-lookup"><span data-stu-id="5464d-117">You can choose from hello following architectures.</span></span>

<span data-ttu-id="5464d-118">**HDInsight integrato con Active Directory in esecuzione in Azure IaaS**</span><span class="sxs-lookup"><span data-stu-id="5464d-118">**HDInsight integrated with AD running on Azure IaaS**</span></span>

<span data-ttu-id="5464d-119">Si tratta di architettura più semplice di hello per l'integrazione di HDInsight con Active Directory.</span><span class="sxs-lookup"><span data-stu-id="5464d-119">This is hello simplest architecture for integrating HDInsight with Active Directory.</span></span> <span data-ttu-id="5464d-120">Hello controller di dominio Active Directory viene eseguito su uno (o più) macchine virtuali (VM) in Azure.</span><span class="sxs-lookup"><span data-stu-id="5464d-120">hello AD domain controller runs on one (or multiple) virtual machines (VMs) in Azure.</span></span> <span data-ttu-id="5464d-121">che in genere si trovano in una rete virtuale.</span><span class="sxs-lookup"><span data-stu-id="5464d-121">These VMs are usually in a virtual network.</span></span> <span data-ttu-id="5464d-122">Impostare un'altra rete virtuale per il cluster HDInsight hello.</span><span class="sxs-lookup"><span data-stu-id="5464d-122">You set up another virtual network for hello HDInsight cluster.</span></span> <span data-ttu-id="5464d-123">Per HDInsight toohave tooActive una visibilità di Directory, è necessario toopeer queste reti virtuali tramite [peering per rete virtuale a](../virtual-network/virtual-network-create-peering.md).</span><span class="sxs-lookup"><span data-stu-id="5464d-123">For HDInsight toohave a line of sight tooActive Directory, you need toopeer these virtual networks by using [VNet-to-VNet peering](../virtual-network/virtual-network-create-peering.md).</span></span> <span data-ttu-id="5464d-124">Se si crea hello Active Directory in ARM, è possibile creare hello Active Directory e hello di HDInsight nella stessa rete virtuale e non è necessario toodo peering.</span><span class="sxs-lookup"><span data-stu-id="5464d-124">If you create hello Active Directory in ARM, then you can create hello Active Directory and HDInsight in hello same VNet and you don't need toodo peering.</span></span> 

![Topologia del cluster HDInsight aggiunto a un dominio](./media/hdinsight-domain-joined-architecture/hdinsight-domain-joined-architecture_1.png)

> [!NOTE]
> <span data-ttu-id="5464d-126">In questa architettura, è possibile utilizzare l'archivio Azure Data Lake con i cluster di HDInsight hello.</span><span class="sxs-lookup"><span data-stu-id="5464d-126">In this architecture, you cannot use Azure Data Lake Store with hello HDInsight cluster.</span></span>


<span data-ttu-id="5464d-127">Prerequisiti per Active Directory:</span><span class="sxs-lookup"><span data-stu-id="5464d-127">Prerequisites for Active Directory:</span></span>

* <span data-ttu-id="5464d-128">Un [unità organizzativa](../active-directory-domain-services/active-directory-ds-admin-guide-create-ou.md) devono essere creati, in cui posizionare hello macchine virtuali del cluster HDInsight e le entità di servizio utilizzate dal cluster hello hello.</span><span class="sxs-lookup"><span data-stu-id="5464d-128">An [organizational unit](../active-directory-domain-services/active-directory-ds-admin-guide-create-ou.md) must be created, within which you place hello HDInsight cluster VMs and hello service principals used by hello cluster.</span></span>
* <span data-ttu-id="5464d-129">È necessario configurare [Lightweight Directory Access Protocol](../active-directory-domain-services/active-directory-ds-admin-guide-configure-secure-ldap.md) (LDAP) per comunicare con AD.</span><span class="sxs-lookup"><span data-stu-id="5464d-129">[Lightweight Directory Access Protocols](../active-directory-domain-services/active-directory-ds-admin-guide-configure-secure-ldap.md) (LDAPs) must be set up for communicating with AD.</span></span> <span data-ttu-id="5464d-130">Hello certificato utilizzato tooset backup LDAPS deve essere un certificato reale (non un certificato autofirmato).</span><span class="sxs-lookup"><span data-stu-id="5464d-130">hello certificate used tooset up LDAPS must be a real certificate (not a self-signed certificate).</span></span>
* <span data-ttu-id="5464d-131">Le zone DNS inverse devono essere create nel dominio hello per intervallo di indirizzi IP hello della subnet di HDInsight hello (ad esempio, 10.2.0.0/24 nell'immagine precedente hello).</span><span class="sxs-lookup"><span data-stu-id="5464d-131">Reverse DNS zones must be created on hello domain for hello IP address range of hello HDInsight subnet (for example, 10.2.0.0/24 in hello previous picture).</span></span>
* <span data-ttu-id="5464d-132">È necessario un account del servizio o un account utente.</span><span class="sxs-lookup"><span data-stu-id="5464d-132">A service account or a user account is needed.</span></span> <span data-ttu-id="5464d-133">Utilizzare questo cluster di HDInsight hello toocreate account.</span><span class="sxs-lookup"><span data-stu-id="5464d-133">Use this account toocreate hello HDInsight cluster.</span></span> <span data-ttu-id="5464d-134">Questo account deve disporre di hello queste autorizzazioni:</span><span class="sxs-lookup"><span data-stu-id="5464d-134">This account must have hello following permissions:</span></span>

    - <span data-ttu-id="5464d-135">Oggetti entità servizio toocreate di autorizzazioni e gli oggetti computer all'interno di un'unità organizzativa hello</span><span class="sxs-lookup"><span data-stu-id="5464d-135">Permissions toocreate service principal objects and machine objects within hello organizational unit</span></span>
    - <span data-ttu-id="5464d-136">Autorizzazioni toocreate inversa DNS le regole del proxy</span><span class="sxs-lookup"><span data-stu-id="5464d-136">Permissions toocreate reverse DNS proxy rules</span></span>
    - <span data-ttu-id="5464d-137">Dominio di Active Directory toohello macchine toojoin autorizzazioni</span><span class="sxs-lookup"><span data-stu-id="5464d-137">Permissions toojoin machines toohello Active Directory domain</span></span>

<span data-ttu-id="5464d-138">**HDInsight integrato con Azure AD solo cloud**</span><span class="sxs-lookup"><span data-stu-id="5464d-138">**HDInsight integrated with cloud-only Azure AD**</span></span>

<span data-ttu-id="5464d-139">Per Azure AD solo cloud, configurare un controller di dominio in modo che HDInsight possa essere integrato con Azure AD.</span><span class="sxs-lookup"><span data-stu-id="5464d-139">For cloud-only Azure AD, configure a domain controller so that HDInsight can be integrated with Azure AD.</span></span> <span data-ttu-id="5464d-140">A tale scopo è possibile usare [Azure Active Directory Domain Services](../active-directory-domain-services/active-directory-ds-overview.md).</span><span class="sxs-lookup"><span data-stu-id="5464d-140">This is achieved by using [Azure Active Directory Domain Services](../active-directory-domain-services/active-directory-ds-overview.md) (Azure AD DS).</span></span> <span data-ttu-id="5464d-141">Azure Active Directory crea macchine del controller di dominio nel cloud hello e fornisce gli indirizzi IP per loro.</span><span class="sxs-lookup"><span data-stu-id="5464d-141">Azure AD DS creates domain controller machines on hello cloud and provides IP addresses for them.</span></span> <span data-ttu-id="5464d-142">Per garantire disponibilità elevata, crea due controller di dominio.</span><span class="sxs-lookup"><span data-stu-id="5464d-142">It creates two domain controllers for high availability.</span></span>

<span data-ttu-id="5464d-143">Attualmente, Azure Active Directory Domain Services esiste solo in reti virtuali classiche</span><span class="sxs-lookup"><span data-stu-id="5464d-143">Currently, Azure AD DS exists only in classic virtual networks.</span></span> <span data-ttu-id="5464d-144">È accessibile solo tramite hello portale di Azure classico.</span><span class="sxs-lookup"><span data-stu-id="5464d-144">It is only accessible by using hello Azure classic portal.</span></span> <span data-ttu-id="5464d-145">HDInsight è presente una rete virtuale nel portale di Azure, che deve toobe hello Hello peering con la rete virtuale classica hello utilizzando peering per rete virtuale a.</span><span class="sxs-lookup"><span data-stu-id="5464d-145">hello HDInsight virtual network exists in hello Azure portal, which needs toobe peered with hello classic virtual network by using VNet-to-VNet peering.</span></span>

> [!NOTE]
> <span data-ttu-id="5464d-146">Peering tra una rete virtuale classica e rete virtuale è necessario che entrambe le reti virtuali siano un gestore delle risorse Azure hello stessa regione e hello nella stessa sottoscrizione di Azure.</span><span class="sxs-lookup"><span data-stu-id="5464d-146">Peering between a classic virtual network and an Azure Resource Manager virtual network requires that both virtual networks are in hello same region and under hello same Azure subscription.</span></span>

![Topologia del cluster HDInsight aggiunto a un dominio](./media/hdinsight-domain-joined-architecture/hdinsight-domain-joined-architecture_2.png)

<span data-ttu-id="5464d-148">Prerequisiti per Azure AD:</span><span class="sxs-lookup"><span data-stu-id="5464d-148">Prerequisites for Azure AD:</span></span>

* <span data-ttu-id="5464d-149">Un [unità organizzativa](../active-directory-domain-services/active-directory-ds-admin-guide-create-ou.md) deve essere creato in cui posizionare hello macchine virtuali del cluster HDInsight e le entità di servizio utilizzate dal cluster hello hello.</span><span class="sxs-lookup"><span data-stu-id="5464d-149">An [organizational unit](../active-directory-domain-services/active-directory-ds-admin-guide-create-ou.md) must be created within which you place hello HDInsight cluster VMs and hello service principals used by hello cluster.</span></span>
* <span data-ttu-id="5464d-150">I protocolli [LDAP](../active-directory-domain-services/active-directory-ds-admin-guide-configure-secure-ldap.md) devono essere impostati durante la configurazione di Azure Active Directory Domain Services.</span><span class="sxs-lookup"><span data-stu-id="5464d-150">[LDAPS](../active-directory-domain-services/active-directory-ds-admin-guide-configure-secure-ldap.md) must be set up when you configure Azure AD DS.</span></span> <span data-ttu-id="5464d-151">Hello certificato utilizzato tooset backup LDAPS deve essere un certificato reale (non un certificato autofirmato).</span><span class="sxs-lookup"><span data-stu-id="5464d-151">hello certificate used tooset up LDAPS must be a real certificate (not a self-signed certificate).</span></span>
* <span data-ttu-id="5464d-152">Le zone DNS inverse devono essere create nel dominio hello per intervallo di indirizzi IP hello della subnet di HDInsight hello (ad esempio, 10.2.0.0/24 nell'immagine precedente hello).</span><span class="sxs-lookup"><span data-stu-id="5464d-152">Reverse DNS zones must be created on hello domain for hello IP address range of hello HDInsight subnet (for example, 10.2.0.0/24 in hello previous picture).</span></span>
* <span data-ttu-id="5464d-153">[Gli hash delle password](../active-directory-domain-services/active-directory-ds-getting-started-password-sync.md) devono essere sincronizzati da tooAzure AD Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="5464d-153">[Password hashes](../active-directory-domain-services/active-directory-ds-getting-started-password-sync.md) must be synced from Azure AD tooAzure AD DS.</span></span>
* <span data-ttu-id="5464d-154">È necessario un account del servizio o un account utente.</span><span class="sxs-lookup"><span data-stu-id="5464d-154">A service account or a user account is needed.</span></span> <span data-ttu-id="5464d-155">Utilizzare questo cluster di HDInsight hello toocreate account.</span><span class="sxs-lookup"><span data-stu-id="5464d-155">Use this account toocreate hello HDInsight cluster.</span></span> <span data-ttu-id="5464d-156">Questo account deve disporre di hello queste autorizzazioni:</span><span class="sxs-lookup"><span data-stu-id="5464d-156">This account must have hello following permissions:</span></span>

    - <span data-ttu-id="5464d-157">Oggetti entità servizio toocreate di autorizzazioni e gli oggetti computer all'interno di un'unità organizzativa hello</span><span class="sxs-lookup"><span data-stu-id="5464d-157">Permissions toocreate service principal objects and machine objects within hello organizational unit</span></span>
    - <span data-ttu-id="5464d-158">Autorizzazioni toocreate inversa DNS le regole del proxy</span><span class="sxs-lookup"><span data-stu-id="5464d-158">Permissions toocreate reverse DNS proxy rules</span></span>
    - <span data-ttu-id="5464d-159">Dominio di Azure AD toohello macchine toojoin autorizzazioni</span><span class="sxs-lookup"><span data-stu-id="5464d-159">Permissions toojoin machines toohello Azure AD domain</span></span>

## <a name="next-steps"></a><span data-ttu-id="5464d-160">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="5464d-160">Next steps</span></span>
* <span data-ttu-id="5464d-161">tooconfigure un cluster di HDInsight appartenenti a un dominio, vedere [configurare cluster di HDInsight dominio](hdinsight-domain-joined-configure.md).</span><span class="sxs-lookup"><span data-stu-id="5464d-161">tooconfigure a domain-joined HDInsight cluster, see [Configure domain-joined HDInsight clusters](hdinsight-domain-joined-configure.md).</span></span>
* <span data-ttu-id="5464d-162">i cluster HDInsight dominio toomanage, vedere [la gestione dei cluster HDInsight dominio](hdinsight-domain-joined-manage.md).</span><span class="sxs-lookup"><span data-stu-id="5464d-162">toomanage domain-joined HDInsight clusters, see [Manage domain-joined HDInsight clusters](hdinsight-domain-joined-manage.md).</span></span>
* <span data-ttu-id="5464d-163">tooconfigure Hive criteri e l'esecuzione delle query Hive, vedere [Hive configurare criteri per i cluster HDInsight dominio](hdinsight-domain-joined-run-hive.md).</span><span class="sxs-lookup"><span data-stu-id="5464d-163">tooconfigure Hive policies and run Hive queries, see [Configure Hive policies for domain-joined HDInsight clusters](hdinsight-domain-joined-run-hive.md).</span></span>
* <span data-ttu-id="5464d-164">le query Hive toorun utilizzando SSH nel dominio cluster HDInsight, vedere [utilizzo di SSH con HDInsight](hdinsight-hadoop-linux-use-ssh-unix.md).</span><span class="sxs-lookup"><span data-stu-id="5464d-164">toorun Hive queries by using SSH on domain-joined HDInsight clusters, see [Use SSH with HDInsight](hdinsight-hadoop-linux-use-ssh-unix.md).</span></span>
