---
title: Cause comuni del riciclo dei ruoli del servizio cloud | Documentazione Microsoft
description: "Un ruolo del servizio cloud che viene riciclato improvvisamente può causare tempi di inattività significativi. Ecco alcuni problemi comuni che causano il riciclo dei ruoli, che possono essere utili per ridurre i tempi di inattività."
services: cloud-services
documentationcenter: 
author: simonxjx
manager: felixwu
editor: 
tags: top-support-issue
ms.assetid: 533930d1-8035-4402-b16a-cf887b2c4f85
ms.service: cloud-services
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: tbd
ms.date: 7/26/2017
ms.author: v-six
ms.openlocfilehash: e55009c72b977ee4a30f6c71043bde483849f78f
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/29/2017
---
# <a name="common-issues-that-cause-roles-to-recycle"></a><span data-ttu-id="c4947-104">Problemi comuni che comportano il riciclo dei ruoli</span><span class="sxs-lookup"><span data-stu-id="c4947-104">Common issues that cause roles to recycle</span></span>
<span data-ttu-id="c4947-105">Questo articolo illustra alcune delle cause comuni dei problemi di distribuzione e fornisce suggerimenti per consentirne la risoluzione.</span><span class="sxs-lookup"><span data-stu-id="c4947-105">This article discusses some of the common causes of deployment problems and provides troubleshooting tips to help you resolve these problems.</span></span> <span data-ttu-id="c4947-106">La presenza di un problema con un'applicazione viene evidenziata se l'istanza del ruolo non si avvia o se lo stato passa ciclicamente da inizializzazione a occupato e arresto.</span><span class="sxs-lookup"><span data-stu-id="c4947-106">An indication that a problem exists with an application is when the role instance fails to start, or it cycles between the initializing, busy, and stopping states.</span></span>

[!INCLUDE [support-disclaimer](../../includes/support-disclaimer.md)]

## <a name="missing-runtime-dependencies"></a><span data-ttu-id="c4947-107">Dipendenze di runtime mancanti</span><span class="sxs-lookup"><span data-stu-id="c4947-107">Missing runtime dependencies</span></span>
<span data-ttu-id="c4947-108">Se un ruolo nell'applicazione si basa su un'assembly che non fa parte di .NET Framework o della libreria gestita di Azure, è necessario includere tale assembly in modo esplicito nel pacchetto dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="c4947-108">If a role in your application relies on any assembly that is not part of the .NET Framework or the Azure managed library, you must explicitly include that assembly in the application package.</span></span> <span data-ttu-id="c4947-109">Tenere presente che in Azure non sono disponibili per impostazione predefinita altri framework di Microsoft.</span><span class="sxs-lookup"><span data-stu-id="c4947-109">Keep in mind that other Microsoft frameworks are not available on Azure by default.</span></span> <span data-ttu-id="c4947-110">Se il ruolo si basa su un framework di questo tipo, è necessario aggiungere tali assembly al pacchetto dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="c4947-110">If your role relies on such a framework, you must add those assemblies to the application package.</span></span>

<span data-ttu-id="c4947-111">Prima di compilare e includere in un pacchetto l'applicazione, verificare quanto segue:</span><span class="sxs-lookup"><span data-stu-id="c4947-111">Before you build and package your application, verify the following:</span></span>

* <span data-ttu-id="c4947-112">Se si usa Visual Studio, assicurarsi che la proprietà **Copia localmente** sia impostata su **True** per ogni assembly di riferimento nel progetto che non fa parte di Azure SDK o .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="c4947-112">If using Visual studio, make sure the **Copy Local** property is set to **True** for each referenced assembly in your project that is not part of the Azure SDK or the .NET Framework.</span></span>
* <span data-ttu-id="c4947-113">Verificare che il file web.config non faccia riferimento ad alcun assembly inutilizzato nell'elemento di compilazione.</span><span class="sxs-lookup"><span data-stu-id="c4947-113">Make sure the web.config file does not reference any unused assemblies in the compilation element.</span></span>
* <span data-ttu-id="c4947-114">La proprietà **Azione di compilazione** di ciascun file con estensione cshtml è impostata su **Contenuto**.</span><span class="sxs-lookup"><span data-stu-id="c4947-114">The **Build Action** of every .cshtml file is set to **Content**.</span></span> <span data-ttu-id="c4947-115">Ciò garantisce che i file vengano visualizzati correttamente nel pacchetto e consente la visualizzazione anche di altri file di riferimento.</span><span class="sxs-lookup"><span data-stu-id="c4947-115">This ensures that the files will appear correctly in the package and enables other referenced files to appear in the package.</span></span>

## <a name="assembly-targets-wrong-platform"></a><span data-ttu-id="c4947-116">Riferimento dell'assembly alla piattaforma errata</span><span class="sxs-lookup"><span data-stu-id="c4947-116">Assembly targets wrong platform</span></span>
<span data-ttu-id="c4947-117">Azure è un ambiente a 64 bit,</span><span class="sxs-lookup"><span data-stu-id="c4947-117">Azure is a 64-bit environment.</span></span> <span data-ttu-id="c4947-118">pertanto gli assembly .NET compilati per una destinazione a 32 bit non funzioneranno in Azure.</span><span class="sxs-lookup"><span data-stu-id="c4947-118">Therefore, .NET assemblies compiled for a 32-bit target won't work on Azure.</span></span>

## <a name="role-throws-unhandled-exceptions-while-initializing-or-stopping"></a><span data-ttu-id="c4947-119">Generazione di eccezioni non gestite da parte del ruolo durante l'inizializzazione o l'arresto</span><span class="sxs-lookup"><span data-stu-id="c4947-119">Role throws unhandled exceptions while initializing or stopping</span></span>
<span data-ttu-id="c4947-120">Eventuali eccezioni generate dai metodi della classe [RoleEntryPoint], che include i metodi [OnStart], [OnStop] e [Run], sono eccezioni non gestite.</span><span class="sxs-lookup"><span data-stu-id="c4947-120">Any exceptions that are thrown by the methods of the [RoleEntryPoint] class, which includes the [OnStart], [OnStop], and [Run] methods, are unhandled exceptions.</span></span> <span data-ttu-id="c4947-121">Se si verifica un'eccezione non gestita in uno di questi metodi, il ruolo verrà riciclato.</span><span class="sxs-lookup"><span data-stu-id="c4947-121">If an unhandled exception occurs in one of these methods, the role will recycle.</span></span> <span data-ttu-id="c4947-122">Se il ruolo viene riciclato più volte, è possibile che venga generata un'eccezione non gestita a ogni tentativo di avvio.</span><span class="sxs-lookup"><span data-stu-id="c4947-122">If the role is recycling repeatedly, it may be throwing an unhandled exception each time it tries to start.</span></span>

## <a name="role-returns-from-run-method"></a><span data-ttu-id="c4947-123">Restituzioni del ruolo dal metodo Run</span><span class="sxs-lookup"><span data-stu-id="c4947-123">Role returns from Run method</span></span>
<span data-ttu-id="c4947-124">È previsto che il metodo [Run] , venga eseguito in modo illimitato.</span><span class="sxs-lookup"><span data-stu-id="c4947-124">The [Run] method is intended to run indefinitely.</span></span> <span data-ttu-id="c4947-125">Se tramite il codice viene eseguito l'override del metodo [Run] , il codice deve essere sospeso per un periodo illimitato.</span><span class="sxs-lookup"><span data-stu-id="c4947-125">If your code overrides the [Run] method, it should sleep indefinitely.</span></span> <span data-ttu-id="c4947-126">Se tramite il metodo [Run] viene restituito un valore, il ruolo viene riciclato.</span><span class="sxs-lookup"><span data-stu-id="c4947-126">If the [Run] method returns, the role recycles.</span></span>

## <a name="incorrect-diagnosticsconnectionstring-setting"></a><span data-ttu-id="c4947-127">Impostazione di DiagnosticsConnectionString errata</span><span class="sxs-lookup"><span data-stu-id="c4947-127">Incorrect DiagnosticsConnectionString setting</span></span>
<span data-ttu-id="c4947-128">Se l'applicazione usa Diagnostica di Azure, il file cscfg deve specificare l'impostazione di configurazione `DiagnosticsConnectionString` .</span><span class="sxs-lookup"><span data-stu-id="c4947-128">If application uses Azure Diagnostics, your service configuration file must specify the `DiagnosticsConnectionString` configuration setting.</span></span> <span data-ttu-id="c4947-129">Questa impostazione deve specificare una connessione HTTPS all'account di archiviazione in Azure.</span><span class="sxs-lookup"><span data-stu-id="c4947-129">This setting should specify an HTTPS connection to your storage account in Azure.</span></span>

<span data-ttu-id="c4947-130">Per assicurarsi che l'impostazione `DiagnosticsConnectionString` sia corretta, prima di distribuire il pacchetto dell'applicazione in Azure, verificare quanto segue:</span><span class="sxs-lookup"><span data-stu-id="c4947-130">To ensure that your `DiagnosticsConnectionString` setting is correct before you deploy your application package to Azure, verify the following:</span></span>  

* <span data-ttu-id="c4947-131">L'impostazione `DiagnosticsConnectionString` punti a un account di archiviazione valido in Azure.</span><span class="sxs-lookup"><span data-stu-id="c4947-131">The `DiagnosticsConnectionString` setting points to a valid storage account in Azure.</span></span>  
  <span data-ttu-id="c4947-132">Per impostazione predefinita, questa impostazione punta all'account di archiviazione emulato, pertanto è necessario modificarla in modo esplicito prima di distribuire il pacchetto dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="c4947-132">By default, this setting points to the emulated storage account, so you must explicitly change this setting before you deploy your application package.</span></span> <span data-ttu-id="c4947-133">Se non si modifica questa impostazione, viene generata un'eccezione quando l'istanza del ruolo tenta di avviare il monitoraggio di diagnostica.</span><span class="sxs-lookup"><span data-stu-id="c4947-133">If you do not change this setting, an exception is thrown when the role instance attempts to start the diagnostic monitor.</span></span> <span data-ttu-id="c4947-134">Ciò potrebbe comportare il riciclo illimitato dell'istanza del ruolo.</span><span class="sxs-lookup"><span data-stu-id="c4947-134">This may cause the role instance to recycle indefinitely.</span></span>
* <span data-ttu-id="c4947-135">La stringa di connessione viene specificata nel [formato](../storage/common/storage-configure-connection-string.md)seguente.</span><span class="sxs-lookup"><span data-stu-id="c4947-135">The connection string is specified in the following [format](../storage/common/storage-configure-connection-string.md).</span></span> <span data-ttu-id="c4947-136">Il protocollo deve essere specificato come HTTPS. Sostituire *MyAccountName* con il nome dell'account di archiviazione e *MyAccountKey* con la chiave di accesso dell'account:</span><span class="sxs-lookup"><span data-stu-id="c4947-136">(The protocol must be specified as HTTPS.) Replace *MyAccountName* with the name of your storage account, and *MyAccountKey* with your access key:</span></span>    

        DefaultEndpointsProtocol=https;AccountName=MyAccountName;AccountKey=MyAccountKey

  <span data-ttu-id="c4947-137">Se l'applicazione viene sviluppata usando Strumenti di Azure per Microsoft Visual Studio, è possibile usare le pagine delle proprietà per impostare questo valore.</span><span class="sxs-lookup"><span data-stu-id="c4947-137">If you are developing your application by using Azure Tools for Microsoft Visual Studio, you can use the property pages to set this value.</span></span>

## <a name="exported-certificate-does-not-include-private-key"></a><span data-ttu-id="c4947-138">Chiave privata non inclusa nel certificato esportato</span><span class="sxs-lookup"><span data-stu-id="c4947-138">Exported certificate does not include private key</span></span>
<span data-ttu-id="c4947-139">Per eseguire un ruolo Web in SSL, è necessario assicurarsi che nel certificato di gestione esportato sia inclusa la chiave privata.</span><span class="sxs-lookup"><span data-stu-id="c4947-139">To run a web role under SSL, you must ensure that your exported management certificate includes the private key.</span></span> <span data-ttu-id="c4947-140">Se si usa *Gestione certificati di Windows* per esportare il certificato, selezionare **Sì** per l'opzione **Esporta la chiave privata**.</span><span class="sxs-lookup"><span data-stu-id="c4947-140">If you use the *Windows Certificate Manager* to export the certificate, be sure to select **Yes** for the **Export the private key** option.</span></span> <span data-ttu-id="c4947-141">Il certificato deve essere esportato nel formato con estensione PFX, l'unico attualmente supportato.</span><span class="sxs-lookup"><span data-stu-id="c4947-141">The certificate must be exported in the PFX format, which is the only format currently supported.</span></span>

## <a name="next-steps"></a><span data-ttu-id="c4947-142">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="c4947-142">Next steps</span></span>
<span data-ttu-id="c4947-143">Altri [articoli sulla risoluzione dei problemi](https://azure.microsoft.com/documentation/articles/?tag=top-support-issue&product=cloud-services) per i servizi cloud.</span><span class="sxs-lookup"><span data-stu-id="c4947-143">View more [troubleshooting articles](https://azure.microsoft.com/documentation/articles/?tag=top-support-issue&product=cloud-services) for cloud services.</span></span>

<span data-ttu-id="c4947-144">Per altri scenari di riciclo dei ruoli, vedere la [serie di blog di Kevin Williamson](http://blogs.msdn.com/b/kwill/archive/2013/08/09/windows-azure-paas-compute-diagnostics-data.aspx).</span><span class="sxs-lookup"><span data-stu-id="c4947-144">View more role recycling scenarios at [Kevin Williamson's blog series](http://blogs.msdn.com/b/kwill/archive/2013/08/09/windows-azure-paas-compute-diagnostics-data.aspx).</span></span>

[RoleEntryPoint]: https://msdn.microsoft.com/library/microsoft.windowsazure.serviceruntime.roleentrypoint.aspx
[OnStart]: https://msdn.microsoft.com/library/microsoft.windowsazure.serviceruntime.roleentrypoint.onstart.aspx
[OnStop]: https://msdn.microsoft.com/library/microsoft.windowsazure.serviceruntime.roleentrypoint.onstop.aspx
[Run]: https://msdn.microsoft.com/library/microsoft.windowsazure.serviceruntime.roleentrypoint.run.aspx
