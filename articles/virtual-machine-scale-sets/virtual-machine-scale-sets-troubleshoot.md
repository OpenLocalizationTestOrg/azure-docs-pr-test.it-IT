---
title: "scalabilità automatica aaaTroubleshoot con set di scalabilità di macchine virtuali | Documenti Microsoft"
description: "Informazioni sulla risoluzione dei problemi di scalabilità automatica con set di scalabilità di macchine virtuali. Comprendere i problemi tipici e come tooresolve li."
services: virtual-machine-scale-sets
documentationcenter: 
author: gbowerman
manager: timlt
editor: 
tags: azure-resource-manager
ms.assetid: c7d87b72-ee24-4e52-9377-a42f337f76fa
ms.service: virtual-machine-scale-sets
ms.workload: na
ms.tgt_pltfrm: windows
ms.devlang: na
ms.topic: article
ms.date: 10/28/2016
ms.author: guybo
ms.openlocfilehash: 4c9a70992348d87fb43646421a90a027bf400a17
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/06/2017
---
# <a name="troubleshooting-autoscale-with-virtual-machine-scale-sets"></a><span data-ttu-id="84d55-104">Risoluzione dei problemi di scalabilità automatica con set di scalabilità di macchine virtuali</span><span class="sxs-lookup"><span data-stu-id="84d55-104">Troubleshooting autoscale with Virtual Machine Scale Sets</span></span>
<span data-ttu-id="84d55-105">**Problema** – creato un'infrastruttura per la scalabilità automatica di gestione di risorse di Azure utilizzando il set di scalabilità di macchine Virtuali, ad esempio per la distribuzione di un modello simile al seguente: https://github.com/Azure/azure-quickstart-templates/tree/master/201- autoscale-bottle vmss sono definite le regole di scalabilità e tutto funziona bene, ad eccezione del fatto che, indipendentemente da quanto carico inserire hello macchine virtuali, non scalabilità automatica.</span><span class="sxs-lookup"><span data-stu-id="84d55-105">**Problem** – you’ve created an autoscaling infrastructure in Azure Resource Manager using VM Scale Sets –  for example by deploying a template like this: https://github.com/Azure/azure-quickstart-templates/tree/master/201-vmss-bottle-autoscale  – you have your scale rules defined and it works great, except that no matter how much load you put on hello VMs, it won’t autoscale.</span></span>

## <a name="troubleshooting-steps"></a><span data-ttu-id="84d55-106">Passaggi per la risoluzione dei problemi</span><span class="sxs-lookup"><span data-stu-id="84d55-106">Troubleshooting steps</span></span>
<span data-ttu-id="84d55-107">Alcuni aspetti tooconsider includono:</span><span class="sxs-lookup"><span data-stu-id="84d55-107">Some things tooconsider include:</span></span>

* <span data-ttu-id="84d55-108">Il numero di core ogni macchina virtuale presenta e si sta caricando a ogni core? modello di avvio rapido di Azure esempio Hello precedente dispone di uno script do_work.php, che consente di caricare un singolo core.</span><span class="sxs-lookup"><span data-stu-id="84d55-108">How many cores does each VM have, and are you loading each core? hello example Azure Quickstart template above has a do_work.php script, which loads a single core.</span></span> <span data-ttu-id="84d55-109">Se si usa una macchina virtuale di maggiore di un singolo core dimensioni della macchina virtuale come Standard_A1 o D1, sarà necessario toorun il carico corrente più volte.</span><span class="sxs-lookup"><span data-stu-id="84d55-109">If you’re using a VM bigger than a single core VM size like Standard_A1 or D1 then you’d need toorun this load multiple times.</span></span> <span data-ttu-id="84d55-110">Per verificare il numero di core delle macchine virtuali, vedere [Dimensioni delle macchine virtuali in Azure](../virtual-machines/windows/sizes.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json)</span><span class="sxs-lookup"><span data-stu-id="84d55-110">Check how many cores your VMs by reviewing [Sizes for Windows virtual machines in Azure](../virtual-machines/windows/sizes.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json)</span></span>
* <span data-ttu-id="84d55-111">Quanti macchine virtuali nel Set di scalabilità di macchine Virtuali, hello si eseguono operazioni su ciascuna di esse?</span><span class="sxs-lookup"><span data-stu-id="84d55-111">How many VMs in hello VM Scale Set, are you doing work on each one?</span></span>
  
    <span data-ttu-id="84d55-112">Scalabilità evento avrà luogo solo quando hello medio della CPU tra **tutti** hello macchine virtuali in un set di scalabilità supera hello valore soglia, nel corso del tempo di hello interno definiti nelle regole di scalabilità automatica hello.</span><span class="sxs-lookup"><span data-stu-id="84d55-112">A scale out event will only take place when hello average CPU across **all** hello VMs in a scale set exceeds hello threshold value, over hello time internal defined in hello autoscale rules.</span></span>
* <span data-ttu-id="84d55-113">Sono stati persi eventi di scalabilità?</span><span class="sxs-lookup"><span data-stu-id="84d55-113">Did you miss any scale events?</span></span>
  
    <span data-ttu-id="84d55-114">Controllare i log di controllo di hello in hello portale di Azure per gli eventi di scala.</span><span class="sxs-lookup"><span data-stu-id="84d55-114">Check hello audit logs in hello Azure portal for scale events.</span></span> <span data-ttu-id="84d55-115">Potrebbero essersi verificati un aumento e poi una riduzione delle prestazioni non rilevati.</span><span class="sxs-lookup"><span data-stu-id="84d55-115">Maybe there was a scale up and a scale down which was missed.</span></span> <span data-ttu-id="84d55-116">È possibile filtrare per "Scalabilità".</span><span class="sxs-lookup"><span data-stu-id="84d55-116">You can filter by “Scale”..</span></span>
  
    ![Log di controllo][audit]
* <span data-ttu-id="84d55-118">Le soglie di aumento e riduzione del numero di istanze sono sufficientemente diverse?</span><span class="sxs-lookup"><span data-stu-id="84d55-118">Are your scale-in and scale-out thresholds sufficiently different?</span></span>
  
    <span data-ttu-id="84d55-119">Si supponga di che impostare una regola tooscale quando utilizzo medio della CPU è superiore al 50% più di 5 minuti e tooscale in quando utilizzo medio della CPU è inferiore al 50%.</span><span class="sxs-lookup"><span data-stu-id="84d55-119">Suppose you set a rule tooscale out when average CPU is greater than 50% over 5 minutes, and tooscale in when average CPU is less than 50%.</span></span> <span data-ttu-id="84d55-120">Si verificherebbe un problema "Ali" quando l'utilizzo della CPU è toothis Chiudi soglia, le azioni di scalabilità hello costantemente aumentare e ridurre le dimensioni del set di hello.</span><span class="sxs-lookup"><span data-stu-id="84d55-120">This would cause a “flapping” problem when CPU usage is close toothis threshold, with scale actions constantly increasing and decreasing hello size of hello set.</span></span> <span data-ttu-id="84d55-121">Per questo motivo, il servizio di scalabilità automatica hello tenta tooprevent "instabile", che possono verificarsi come non sulla scalabilità.</span><span class="sxs-lookup"><span data-stu-id="84d55-121">Because of this, hello autoscale service tries tooprevent “flapping”, which can manifest as not scaling.</span></span> <span data-ttu-id="84d55-122">Verificare pertanto che la scalabilità orizzontale e le soglie di scala sono sufficientemente diversi tooallow liberare spazio tra il ridimensionamento.</span><span class="sxs-lookup"><span data-stu-id="84d55-122">Therefore make sure your scale-out and scale-in thresholds are sufficiently different tooallow some space in between scaling.</span></span>
* <span data-ttu-id="84d55-123">È stato scritto un modello JSON personalizzato?</span><span class="sxs-lookup"><span data-stu-id="84d55-123">Did you write your own JSON template?</span></span>
  
    <span data-ttu-id="84d55-124">È facile toomake errori, quindi iniziare con un modello di hello uno oltre la quale viene dimostrato toowork e apportare piccole modifiche incrementali.</span><span class="sxs-lookup"><span data-stu-id="84d55-124">It is easy toomake mistakes, so start with a template like hello one above which is proven toowork, and make small incremental changes.</span></span> 
* <span data-ttu-id="84d55-125">È possibile eseguire manualmente l'aumento o la riduzione del numero di istanze?</span><span class="sxs-lookup"><span data-stu-id="84d55-125">Can you manually scale in or out?</span></span>
  
    <span data-ttu-id="84d55-126">Provare hello ridistribuzione risorsa Set di scalabilità della macchina virtuale con un diverso "capacità" impostazione toochange hello del numero di macchine virtuali manualmente.</span><span class="sxs-lookup"><span data-stu-id="84d55-126">Try redeploying hello VM Scale Set resource with a different “capacity” setting toochange hello number of VMs manually.</span></span> <span data-ttu-id="84d55-127">Un toodo modello di esempio si tratta di seguito: https://github.com/Azure/azure-quickstart-templates/tree/master/201-vmss-scale-existing: potrebbe essere necessario tooedit hello modello toomake che disponga di hello stesso computer di dimensioni, il Set di scalabilità utilizza.</span><span class="sxs-lookup"><span data-stu-id="84d55-127">An example template toodo this is here: https://github.com/Azure/azure-quickstart-templates/tree/master/201-vmss-scale-existing – you may need tooedit hello template toomake sure it has hello same machine size as your Scale Set is using.</span></span> <span data-ttu-id="84d55-128">Se è stato possibile modificare manualmente numero hello di macchine virtuali, si saprà problema hello è isolato tooautoscale.</span><span class="sxs-lookup"><span data-stu-id="84d55-128">If you can successfully change hello number of VMs manually, then you know hello problem is isolated tooautoscale.</span></span>
* <span data-ttu-id="84d55-129">Controllare il Microsoft.Compute/virtualMachineScaleSet e le risorse Insights hello [Esplora inventario risorse di Azure](https://resources.azure.com/)</span><span class="sxs-lookup"><span data-stu-id="84d55-129">Check your Microsoft.Compute/virtualMachineScaleSet, and Microsoft.Insights resources in hello [Azure Resource Explorer](https://resources.azure.com/)</span></span>
  
    <span data-ttu-id="84d55-130">Si tratta di un indispensabile risoluzione dei problemi dello strumento che illustra hello lo stato delle risorse di gestione risorse di Azure.</span><span class="sxs-lookup"><span data-stu-id="84d55-130">This is an indispensable troubleshooting tool which shows you hello state of your Azure Resource Manager resources.</span></span> <span data-ttu-id="84d55-131">Fare clic sulla sottoscrizione e osservare hello si debbano risolvere problemi di gruppo di risorse.</span><span class="sxs-lookup"><span data-stu-id="84d55-131">Click on your subscription and look at hello Resource Group you are troubleshooting.</span></span> <span data-ttu-id="84d55-132">Nel provider di risorse di calcolo hello cercare hello Set di scalabilità macchina virtuale è stato creato e verificare hello Vista istanza, che mostra lo stato di una distribuzione di hello.</span><span class="sxs-lookup"><span data-stu-id="84d55-132">Under hello Compute resource provider look at hello VM Scale Set you created and check hello Instance View, which shows you hello state of a deployment.</span></span> <span data-ttu-id="84d55-133">Controllare inoltre visualizzazione dell'istanza hello di macchine virtuali in hello Set di scalabilità della macchina virtuale.</span><span class="sxs-lookup"><span data-stu-id="84d55-133">Also check hello instance view of VMs in hello VM Scale Set.</span></span> <span data-ttu-id="84d55-134">Quindi andare nel provider di risorse Insights hello e verificare le regole di scalabilità automatica hello visualizzate correttamente.</span><span class="sxs-lookup"><span data-stu-id="84d55-134">Then go into hello Microsoft.Insights resource provider and check hello autoscale rules look good.</span></span>
* <span data-ttu-id="84d55-135">Hello estensione diagnostica utilizzo e la creazione di dati sulle prestazioni?</span><span class="sxs-lookup"><span data-stu-id="84d55-135">Is hello Diagnostic extension working and emitting performance data?</span></span>
  
    <span data-ttu-id="84d55-136">**Aggiornamento:** Azure scalabilità automatica sono stata avanzata toouse pipeline le metriche che non richiede più un toobe estensione di diagnostica installata basato su un host.</span><span class="sxs-lookup"><span data-stu-id="84d55-136">**Update:** Azure autoscale has been enhanced toouse a host based metrics pipeline which no longer requires a diagnostics extension toobe installed.</span></span> <span data-ttu-id="84d55-137">Ciò significa hello prossime paragrafi non sono più valide se si crea un'applicazione per la scalabilità automatica tramite la nuova pipeline di hello.</span><span class="sxs-lookup"><span data-stu-id="84d55-137">This means hello next few paragraphs no longer apply if you create an autoscaling application using hello new pipeline.</span></span> <span data-ttu-id="84d55-138">È un esempio di modelli di Azure che sono stati della pipeline di host hello toouse convertito: https://github.com/Azure/azure-quickstart-templates/tree/master/201-vmss-bottle-autoscale.</span><span class="sxs-lookup"><span data-stu-id="84d55-138">An example of Azure templates which have been converted toouse hello host pipeline is: https://github.com/Azure/azure-quickstart-templates/tree/master/201-vmss-bottle-autoscale.</span></span> 
  
    <span data-ttu-id="84d55-139">Utilizzo di metriche basata su host per la scalabilità automatica è preferibile per hello seguenti motivi:</span><span class="sxs-lookup"><span data-stu-id="84d55-139">Using host based metrics for autoscale is better for hello following reasons:</span></span>
  
  * <span data-ttu-id="84d55-140">Meno parti mobili come estensioni di diagnostica non è necessario toobe installato.</span><span class="sxs-lookup"><span data-stu-id="84d55-140">Fewer moving parts as no diagnostics extensions need toobe installed.</span></span>
  * <span data-ttu-id="84d55-141">Modelli più semplici.</span><span class="sxs-lookup"><span data-stu-id="84d55-141">Simpler templates.</span></span> <span data-ttu-id="84d55-142">Aggiungere modello di set di scalabilità tooan di regole di scalabilità automatica insights esistente.</span><span class="sxs-lookup"><span data-stu-id="84d55-142">Just add insights autoscale rules tooan existing scale set template.</span></span>
  * <span data-ttu-id="84d55-143">Creazione di report più affidabile e avvio più veloce delle nuove macchine virtuali.</span><span class="sxs-lookup"><span data-stu-id="84d55-143">More reliable reporting and faster launching of new VMs.</span></span>
    
    <span data-ttu-id="84d55-144">Hello solo motivi per cui che è opportuno tookeep utilizza un'estensione di diagnostica sarebbe se è necessario memoria diagnostica reporting/scalabilità.</span><span class="sxs-lookup"><span data-stu-id="84d55-144">hello only reasons you might want tookeep using a diagnostic extension would be if you need memory diagnostics reporting/scaling.</span></span> <span data-ttu-id="84d55-145">Le metriche basate su host non creano report della memoria.</span><span class="sxs-lookup"><span data-stu-id="84d55-145">Host based metrics doesn't report memory.</span></span>
    
    <span data-ttu-id="84d55-146">Tenendo in considerazione, se si siano ancora utilizzando le estensioni di diagnostica per il ridimensionamento automatico solo seguire rest hello di questo articolo.</span><span class="sxs-lookup"><span data-stu-id="84d55-146">With that in mind, only follow hello rest of this article if you are still using diagnostic extensions for your autoscaling.</span></span>
    
    <span data-ttu-id="84d55-147">Scalabilità automatica in Azure Resource Manager può funzionare (ma non dispone più di) tramite un'estensione di macchina virtuale denominata hello estensione di diagnostica.</span><span class="sxs-lookup"><span data-stu-id="84d55-147">Autoscale in Azure Resource Manager can work (but no longer has to) by means of a VM extension called hello Diagnostics Extension.</span></span> <span data-ttu-id="84d55-148">Account di archiviazione delle tooa di prestazioni dati definite nel modello hello emette.</span><span class="sxs-lookup"><span data-stu-id="84d55-148">It emits performance data tooa storage account you define in hello template.</span></span> <span data-ttu-id="84d55-149">Questi dati vengono quindi aggregati dal servizio di monitoraggio di Azure hello.</span><span class="sxs-lookup"><span data-stu-id="84d55-149">This data is then aggregated by hello Azure Monitor service.</span></span>
    
    <span data-ttu-id="84d55-150">Se hello servizio Insights non è possibile leggere i dati da hello macchine virtuali, si suppone che toosend un messaggio di posta elettronica, ad esempio, se le macchine virtuali hello verso il basso, controlla la posta elettronica (Buongiorno quello specificato durante la creazione di account Azure hello).</span><span class="sxs-lookup"><span data-stu-id="84d55-150">If hello Insights service can’t read data from hello VMs, it is supposed toosend you an email – for example if hello VMs were down, so check your email (hello one you specified when creating hello Azure account).</span></span>
    
    <span data-ttu-id="84d55-151">È anche possibile passare ed esamina i dati di hello.</span><span class="sxs-lookup"><span data-stu-id="84d55-151">You can also go and look at hello data yourself.</span></span> <span data-ttu-id="84d55-152">Esaminare hello account di archiviazione Azure tramite una finestra di esplorazione cloud.</span><span class="sxs-lookup"><span data-stu-id="84d55-152">Look at hello Azure storage account using a cloud explorer.</span></span> <span data-ttu-id="84d55-153">Ad esempio usando hello [Visual Studio Cloud Explorer](https://visualstudiogallery.msdn.microsoft.com/aaef6e67-4d99-40bc-aacf-662237db85a2), accedi e selezionare hello sottoscrizione di Azure in uso e hello account di archiviazione di diagnostica nome a cui fa riferimento in hello definizione di estensione di diagnostica della distribuzione modello...</span><span class="sxs-lookup"><span data-stu-id="84d55-153">For example using hello [Visual Studio Cloud Explorer](https://visualstudiogallery.msdn.microsoft.com/aaef6e67-4d99-40bc-aacf-662237db85a2), log in and pick hello Azure subscription you’re using, and hello Diagnostics storage account name referenced in hello Diagnostics extension definition in your deployment template..</span></span>
    
    ![Cloud Explorer][explorer]
    
    <span data-ttu-id="84d55-155">In questo caso, si noterà una serie di tabelle in cui l'archiviazione dei dati di hello da ogni macchina virtuale.</span><span class="sxs-lookup"><span data-stu-id="84d55-155">Here you will see a bunch of tables where hello data from each VM is being stored.</span></span> <span data-ttu-id="84d55-156">Accettando Linux e hello metrica CPU ad esempio, esaminare le righe più recenti di hello.</span><span class="sxs-lookup"><span data-stu-id="84d55-156">Taking Linux and hello CPU metric as an example, look at hello most recent rows.</span></span> <span data-ttu-id="84d55-157">Hello Visual Studio cloud explorer supporta un linguaggio di query, pertanto è possibile eseguire una query come "Timestamp gt datetime'2016-02-02T21:20:00Z'" toomake certi di disporre di eventi più recenti di hello (Presupponi che ora è in UTC).</span><span class="sxs-lookup"><span data-stu-id="84d55-157">hello Visual Studio cloud explorer supports a query language so you can run a query like “Timestamp gt datetime’2016-02-02T21:20:00Z’” toomake sure you get hello most recent events (assume time is in UTC).</span></span> <span data-ttu-id="84d55-158">Hello i dati visualizzati in vi corrispondono toohello scalabilità configuri le regole?</span><span class="sxs-lookup"><span data-stu-id="84d55-158">Does hello data you see in there correspond toohello scale rules you set up?</span></span> <span data-ttu-id="84d55-159">Nel seguente esempio hello hello della CPU per macchina 20 avviato aumenta too100% nel hello ultimi 5 minuti...</span><span class="sxs-lookup"><span data-stu-id="84d55-159">In hello example below, hello CPU for machine 20 started increasing too100% over hello last 5 minutes..</span></span>
    
    ![Tabelle di archiviazione][tables]
    
    <span data-ttu-id="84d55-161">Se dati hello non sono presente, è presente il problema di hello è con estensione di diagnostica hello in esecuzione in macchine virtuali hello.</span><span class="sxs-lookup"><span data-stu-id="84d55-161">If hello data is not there, then it implies hello problem is with hello diagnostic extension running in hello VMs.</span></span> <span data-ttu-id="84d55-162">Se i dati di hello sono presente, significa che si verifica un problema con le regole di scalabilità o con il servizio di Insights hello.</span><span class="sxs-lookup"><span data-stu-id="84d55-162">If hello data is there, it implies there is either a problem with your scale rules, or with hello Insights service.</span></span> <span data-ttu-id="84d55-163">Verificare lo [Stato di Azure](https://azure.microsoft.com/status/).</span><span class="sxs-lookup"><span data-stu-id="84d55-163">Check [Azure Status](https://azure.microsoft.com/status/).</span></span>
    
    <span data-ttu-id="84d55-164">Una volta superata questi passaggi, se si verificano ancora problemi di scalabilità automatica è possibile provare forum hello [MSDN](https://social.msdn.microsoft.com/forums/azure/home?category=windowsazureplatform%2Cazuremarketplace%2Cwindowsazureplatformctp), o [overflow dello Stack](http://stackoverflow.com/questions/tagged/azure), o una chiamata al supporto di log.</span><span class="sxs-lookup"><span data-stu-id="84d55-164">Once you’ve been through these steps, if you are still having autoscale problems you could try hello forums on [MSDN](https://social.msdn.microsoft.com/forums/azure/home?category=windowsazureplatform%2Cazuremarketplace%2Cwindowsazureplatformctp), or [Stack overflow](http://stackoverflow.com/questions/tagged/azure), or log a support call.</span></span> <span data-ttu-id="84d55-165">Essere preparata tooshare hello modello e una visualizzazione dei dati delle prestazioni hello.</span><span class="sxs-lookup"><span data-stu-id="84d55-165">Be prepared tooshare hello template and a view of hello performance data.</span></span>

[audit]: ./media/virtual-machine-scale-sets-troubleshoot/image3.png
[explorer]: ./media/virtual-machine-scale-sets-troubleshoot/image1.png
[tables]: ./media/virtual-machine-scale-sets-troubleshoot/image4.png
