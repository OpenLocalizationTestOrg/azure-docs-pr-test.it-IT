---
title: ripristino di emergenza Database aaaSQL | Documenti Microsoft
description: "Informazioni su come un database da un'interruzione del Data Center regionale con toorecover hello Database SQL di Azure la replica geografica attiva e funzionalità di ripristino a livello geografico."
services: sql-database
documentationcenter: 
author: anosov1960
manager: jhubbard
editor: monicar
ms.assetid: 4800960e-3f9d-40ce-9e55-fb7f2784c067
ms.service: sql-database
ms.custom: business continuity
ms.devlang: NA
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 04/14/2017
ms.author: sashan
ms.openlocfilehash: bae08485863067748107ec4808e52d8e88e2de0d
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/06/2017
---
# <a name="restore-an-azure-sql-database-or-failover-tooa-secondary"></a><span data-ttu-id="bc92b-103">Ripristinare un Database SQL di Azure o il failover tooa è secondario</span><span class="sxs-lookup"><span data-stu-id="bc92b-103">Restore an Azure SQL Database or failover tooa secondary</span></span>
<span data-ttu-id="bc92b-104">Database SQL di Azure offre hello funzionalità per il ripristino di un'interruzione di seguito:</span><span class="sxs-lookup"><span data-stu-id="bc92b-104">Azure SQL Database offers hello following capabilities for recovering from an outage:</span></span>

* [<span data-ttu-id="bc92b-105">Replica geografica attiva</span><span class="sxs-lookup"><span data-stu-id="bc92b-105">Active geo-replication</span></span>](sql-database-geo-replication-overview.md)
* [<span data-ttu-id="bc92b-106">Ripristino geografico</span><span class="sxs-lookup"><span data-stu-id="bc92b-106">Geo-restore</span></span>](sql-database-recovery-using-backups.md#point-in-time-restore)

<span data-ttu-id="bc92b-107">toolearn sugli scenari di continuità aziendale e le funzionalità di hello per supportare questi scenari, vedere [la continuità aziendale](sql-database-business-continuity.md).</span><span class="sxs-lookup"><span data-stu-id="bc92b-107">toolearn about business continuity scenarios and hello features supporting these scenarios, see [Business continuity](sql-database-business-continuity.md).</span></span>

### <a name="prepare-for-hello-event-of-an-outage"></a><span data-ttu-id="bc92b-108">Preparazione per l'evento hello di interruzione</span><span class="sxs-lookup"><span data-stu-id="bc92b-108">Prepare for hello event of an outage</span></span>
<span data-ttu-id="bc92b-109">Per il successo con l'area dati di ripristino tooanother con replica geografica attiva o i backup con ridondanza geografica, è necessario tooprepare un server in un altro data center interruzione toobecome hello nuovo server primario deve hello devono verificarsi nonché passaggi ben definiti testato e documentato tooensure un ripristino senza problemi.</span><span class="sxs-lookup"><span data-stu-id="bc92b-109">For success with recovery tooanother data region using either active geo-replication or geo-redundant backups, you need tooprepare a server in another data center outage toobecome hello new primary server should hello need arise as well as have well-defined steps documented and tested tooensure a smooth recovery.</span></span> <span data-ttu-id="bc92b-110">La procedura di preparazione comprende:</span><span class="sxs-lookup"><span data-stu-id="bc92b-110">These preparation steps include:</span></span>

* <span data-ttu-id="bc92b-111">Identificare i server logici disponibili hello in un'altra area toobecome hello nuovo server primario.</span><span class="sxs-lookup"><span data-stu-id="bc92b-111">Identify hello logical server in another region toobecome hello new primary server.</span></span> <span data-ttu-id="bc92b-112">Con la replica geografica attiva, questo sarà almeno uno e forse ogni server secondario hello.</span><span class="sxs-lookup"><span data-stu-id="bc92b-112">With active geo-replication, this will be at least one and perhaps each of hello secondary servers.</span></span> <span data-ttu-id="bc92b-113">Per il ripristino geografico, si tratterà in genere un server in hello [area abbinata](../best-practices-availability-paired-regions.md) per area hello in cui si trova il database.</span><span class="sxs-lookup"><span data-stu-id="bc92b-113">For geo-restore, this will generally be a server in hello [paired region](../best-practices-availability-paired-regions.md) for hello region in which your database is located.</span></span>
* <span data-ttu-id="bc92b-114">Identificare e facoltativamente definire, regole del firewall a livello di server hello necessarie in per gli utenti tooaccess hello nuovo database primario.</span><span class="sxs-lookup"><span data-stu-id="bc92b-114">Identify, and optionally define, hello server-level firewall rules needed on for users tooaccess hello new primary database.</span></span>
* <span data-ttu-id="bc92b-115">Determinare come verrà tooredirect utenti toohello nuovo server primario, ad esempio la modifica di stringhe di connessione oppure modificando le voci DNS.</span><span class="sxs-lookup"><span data-stu-id="bc92b-115">Determine how you are going tooredirect users toohello new primary server, such as by changing connection strings or by changing DNS entries.</span></span>
* <span data-ttu-id="bc92b-116">Identificare e, facoltativamente, creare, hello gli account di accesso che deve essere presente nel database master di hello nel nuovo server primario hello e verificare che questi account di accesso dispone delle autorizzazioni appropriate nel database master hello, se presente.</span><span class="sxs-lookup"><span data-stu-id="bc92b-116">Identify, and optionally create, hello logins that must be present in hello master database on hello new primary server, and ensure these logins have appropriate permissions in hello master database, if any.</span></span> <span data-ttu-id="bc92b-117">Per altre informazioni, vedere [Come gestire la sicurezza del database SQL di Azure dopo il ripristino di emergenza](sql-database-geo-replication-security-config.md)</span><span class="sxs-lookup"><span data-stu-id="bc92b-117">For more information, see [SQL Database security after disaster recovery](sql-database-geo-replication-security-config.md)</span></span>
* <span data-ttu-id="bc92b-118">Identificare le regole di avviso che saranno necessario toobe toomap aggiornato toohello nuovo database primario.</span><span class="sxs-lookup"><span data-stu-id="bc92b-118">Identify alert rules that will need toobe updated toomap toohello new primary database.</span></span>
* <span data-ttu-id="bc92b-119">Configurazione del controllo di hello documento sul database primario corrente hello</span><span class="sxs-lookup"><span data-stu-id="bc92b-119">Document hello auditing configuration on hello current primary database</span></span>
* <span data-ttu-id="bc92b-120">[Esercitazione per il ripristino di emergenza](sql-database-disaster-recovery-drills.md).</span><span class="sxs-lookup"><span data-stu-id="bc92b-120">Perform a [disaster recovery drill](sql-database-disaster-recovery-drills.md).</span></span> <span data-ttu-id="bc92b-121">toosimulate un'interruzione del servizio per il ripristino geografico, è possibile eliminare o rinominare un errore di connettività di hello origine database toocause dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="bc92b-121">toosimulate an outage for geo-restore, you can delete or rename hello source database toocause application connectivity failure.</span></span> <span data-ttu-id="bc92b-122">toosimulate un'interruzione del servizio per la replica geografica attiva, è possibile disabilitare l'applicazione web hello o macchina virtuale connessa toohello database o il failover hello database toocause applicazione gli errori di connettività.</span><span class="sxs-lookup"><span data-stu-id="bc92b-122">toosimulate an outage for active geo-replication, you can disable hello web application or virtual machine connected toohello database or failover hello database toocause application connectivity failures.</span></span>

## <a name="when-tooinitiate-recovery"></a><span data-ttu-id="bc92b-123">Quando il ripristino tooinitiate</span><span class="sxs-lookup"><span data-stu-id="bc92b-123">When tooinitiate recovery</span></span>
<span data-ttu-id="bc92b-124">operazione di ripristino Hello influisce su un'applicazione hello.</span><span class="sxs-lookup"><span data-stu-id="bc92b-124">hello recovery operation impacts hello application.</span></span> <span data-ttu-id="bc92b-125">Richiede la modifica di reindirizzamento tramite DNS o stringa di connessione SQL hello e può provocare la perdita permanente dei dati.</span><span class="sxs-lookup"><span data-stu-id="bc92b-125">It requires changing hello SQL connection string or redirection using DNS and could result in permanent data loss.</span></span> <span data-ttu-id="bc92b-126">Pertanto, deve essere eseguita solo quando l'interruzione hello è probabilmente toolast più obiettivo tempo di ripristino dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="bc92b-126">Therefore, it should be done only when hello outage is likely toolast longer than your application's recovery time objective.</span></span> <span data-ttu-id="bc92b-127">Quando l'applicazione hello è distribuito tooproduction che occorre eseguire il monitoraggio regolare dell'integrità delle applicazioni hello e utilizzare hello tooassert punti di ripristino hello è garantito di dati seguenti:</span><span class="sxs-lookup"><span data-stu-id="bc92b-127">When hello application is deployed tooproduction you should perform regular monitoring of hello application health and use hello following data points tooassert that hello recovery is warranted:</span></span>

1. <span data-ttu-id="bc92b-128">Errore di connettività permanente dal database toohello livello di applicazione hello.</span><span class="sxs-lookup"><span data-stu-id="bc92b-128">Permanent connectivity failure from hello application tier toohello database.</span></span>
2. <span data-ttu-id="bc92b-129">Hello portale di Azure viene visualizzato un avviso su un evento imprevisto nell'area di hello con effetti estesi.</span><span class="sxs-lookup"><span data-stu-id="bc92b-129">hello Azure portal shows an alert about an incident in hello region with broad impact.</span></span>
3. <span data-ttu-id="bc92b-130">server di Database SQL di Azure Hello viene contrassegnato come danneggiato.</span><span class="sxs-lookup"><span data-stu-id="bc92b-130">hello Azure SQL Database server is marked as degraded.</span></span>

<span data-ttu-id="bc92b-131">A seconda l'applicazione tolleranza toodowntime e possibili business responsabilità dell'utente è possibile considerare le opzioni di ripristino seguenti hello.</span><span class="sxs-lookup"><span data-stu-id="bc92b-131">Depending on your application tolerance toodowntime and possible business liability you can consider hello following recovery options.</span></span>

<span data-ttu-id="bc92b-132">Hello utilizzare [Get Recoverable Database](https://msdn.microsoft.com/library/dn800985.aspx) (*LastAvailableBackupDate*) punto di ripristino di replica geografica tooget hello più recente.</span><span class="sxs-lookup"><span data-stu-id="bc92b-132">Use hello [Get Recoverable Database](https://msdn.microsoft.com/library/dn800985.aspx) (*LastAvailableBackupDate*) tooget hello latest Geo-replicated restore point.</span></span>

## <a name="wait-for-service-recovery"></a><span data-ttu-id="bc92b-133">Attendere il ripristino del servizio</span><span class="sxs-lookup"><span data-stu-id="bc92b-133">Wait for service recovery</span></span>
<span data-ttu-id="bc92b-134">Hello Azure i team lavorano attentamente la disponibilità del servizio toorestore come rapidamente possibile, ma a seconda della causa radice di hello può richiedere ore o giorni.</span><span class="sxs-lookup"><span data-stu-id="bc92b-134">hello Azure teams work diligently toorestore service availability as quickly as possible but depending on hello root cause it can take hours or days.</span></span>  <span data-ttu-id="bc92b-135">Se l'applicazione può tollerare i tempi di inattività significativi è semplicemente possibile attendere toocomplete ripristino hello.</span><span class="sxs-lookup"><span data-stu-id="bc92b-135">If your application can tolerate significant downtime you can simply wait for hello recovery toocomplete.</span></span> <span data-ttu-id="bc92b-136">In tal caso, non è necessaria alcuna azione da parte dell'utente.</span><span class="sxs-lookup"><span data-stu-id="bc92b-136">In this case, no action on your part is required.</span></span> <span data-ttu-id="bc92b-137">È possibile visualizzare lo stato del servizio corrente hello nel nostro [Dashboard di integrità del servizio di Azure](https://azure.microsoft.com/status/).</span><span class="sxs-lookup"><span data-stu-id="bc92b-137">You can see hello current service status on our [Azure Service Health Dashboard](https://azure.microsoft.com/status/).</span></span> <span data-ttu-id="bc92b-138">Dopo il ripristino di hello dell'area di hello verrà ripristinata la disponibilità dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="bc92b-138">After hello recovery of hello region your application’s availability will be restored.</span></span>

## <a name="fail-over-toogeo-replicated-secondary-database"></a><span data-ttu-id="bc92b-139">Eseguire il failover toogeo alla replica di database secondario</span><span class="sxs-lookup"><span data-stu-id="bc92b-139">Fail over toogeo-replicated secondary database</span></span>
<span data-ttu-id="bc92b-140">Se i tempi di inattività dell'applicazione possono comportare una responsabilità aziendale, è consigliabile usare database con replica geografica nell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="bc92b-140">If your application’s downtime can result in business liability you should be using geo-replicated database(s) in your application.</span></span> <span data-ttu-id="bc92b-141">Disponibilità di ripristino tooquickly applicazione hello in un'area diversa in caso di interruzione verrà attivata.</span><span class="sxs-lookup"><span data-stu-id="bc92b-141">It will enable hello application tooquickly restore availability in a different region in case of an outage.</span></span> <span data-ttu-id="bc92b-142">Informazioni su come troppo[configurare la replica geografica](sql-database-geo-replication-portal.md).</span><span class="sxs-lookup"><span data-stu-id="bc92b-142">Learn how too[configure geo-replication](sql-database-geo-replication-portal.md).</span></span>

<span data-ttu-id="bc92b-143">database di disponibilità toorestore di hello è necessario tooinitiate hello failover toohello replica geografica secondaria usando uno dei metodi di hello è supportato.</span><span class="sxs-lookup"><span data-stu-id="bc92b-143">toorestore availability of hello database(s) you need tooinitiate hello failover toohello geo-replicated secondary using one of hello supported methods.</span></span>

<span data-ttu-id="bc92b-144">Utilizzare uno dei seguenti guide toofail sul database secondario di replica geografica tooa hello:</span><span class="sxs-lookup"><span data-stu-id="bc92b-144">Use one of hello following guides toofail over tooa geo-replicated secondary database:</span></span>

* [<span data-ttu-id="bc92b-145">Eseguire il failover tooa replica geografica secondaria, tramite il portale di Azure</span><span class="sxs-lookup"><span data-stu-id="bc92b-145">Fail over tooa geo-replicated secondary using Azure Portal</span></span>](sql-database-geo-replication-portal.md)
* [<span data-ttu-id="bc92b-146">Eseguire il failover tooa replica geografica secondaria tramite PowerShell</span><span class="sxs-lookup"><span data-stu-id="bc92b-146">Fail over tooa geo-replicated secondary using PowerShell</span></span>](scripts/sql-database-setup-geodr-and-failover-database-powershell.md)
* [<span data-ttu-id="bc92b-147">Eseguire il failover tooa replica geografica secondaria utilizzando T-SQL</span><span class="sxs-lookup"><span data-stu-id="bc92b-147">Fail over tooa geo-replicated secondary using T-SQL</span></span>](sql-database-geo-replication-transact-sql.md)

## <a name="recover-using-geo-restore"></a><span data-ttu-id="bc92b-148">Ripristino tramite il ripristino geografico</span><span class="sxs-lookup"><span data-stu-id="bc92b-148">Recover using geo-restore</span></span>
<span data-ttu-id="bc92b-149">Se i tempi di inattività dell'applicazione non comporta la responsabilità di business è possibile utilizzare [ripristino a livello geografico](sql-database-recovery-using-backups.md) come toorecover un metodo al database dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="bc92b-149">If your application’s downtime does not result in business liability you can use [geo-restore](sql-database-recovery-using-backups.md) as a method toorecover your application database(s).</span></span> <span data-ttu-id="bc92b-150">Crea una copia del database hello dal relativo backup con ridondanza geografica più recente.</span><span class="sxs-lookup"><span data-stu-id="bc92b-150">It creates a copy of hello database from its latest geo-redundant backup.</span></span>

## <a name="configure-your-database-after-recovery"></a><span data-ttu-id="bc92b-151">Configurare il database dopo il ripristino</span><span class="sxs-lookup"><span data-stu-id="bc92b-151">Configure your database after recovery</span></span>
<span data-ttu-id="bc92b-152">Se si utilizza la replica geografica failover o toorecover ripristino a livello geografico di un'interruzione, è necessario assicurarsi che i nuovi database hello connettività toohello sia configurato correttamente in modo che può essere ripresi funzione normale applicazione hello.</span><span class="sxs-lookup"><span data-stu-id="bc92b-152">If you are using either geo-replication failover or geo-restore toorecover from an outage, you must make sure that hello connectivity toohello new databases is properly configured so that hello normal application function can be resumed.</span></span> <span data-ttu-id="bc92b-153">Questo è un elenco di controllo di tooget attività di produzione del database ripristinato pronta.</span><span class="sxs-lookup"><span data-stu-id="bc92b-153">This is a checklist of tasks tooget your recovered database production ready.</span></span>

### <a name="update-connection-strings"></a><span data-ttu-id="bc92b-154">Aggiornare le stringhe di connessione</span><span class="sxs-lookup"><span data-stu-id="bc92b-154">Update connection strings</span></span>
<span data-ttu-id="bc92b-155">Poiché il database ripristinato si trova in un server diverso, è necessario tooupdate di connessione stringa toopoint toothat server dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="bc92b-155">Because your recovered database will reside in a different server, you need tooupdate your application’s connection string toopoint toothat server.</span></span>

<span data-ttu-id="bc92b-156">Per ulteriori informazioni sulla modifica di stringhe di connessione, vedere il linguaggio di sviluppo appropriata hello per le [raccolta connessioni](sql-database-libraries.md).</span><span class="sxs-lookup"><span data-stu-id="bc92b-156">For more information about changing connection strings, see hello appropriate development language for your [connection library](sql-database-libraries.md).</span></span>

### <a name="configure-firewall-rules"></a><span data-ttu-id="bc92b-157">Configurare le regole firewall</span><span class="sxs-lookup"><span data-stu-id="bc92b-157">Configure Firewall Rules</span></span>
<span data-ttu-id="bc92b-158">È necessario assicurarsi che le regole del firewall hello configurata nel server e in corrispondenza di hello database quelli che sono stati configurati nel server primario di hello e database primario toomake.</span><span class="sxs-lookup"><span data-stu-id="bc92b-158">You need toomake sure that hello firewall rules configured on server and on hello database match those that were configured on hello primary server and primary database.</span></span> <span data-ttu-id="bc92b-159">Per altre informazioni, vedere [Procedura: Configurare le impostazioni del firewall (Database SQL di Azure)](sql-database-configure-firewall-settings.md).</span><span class="sxs-lookup"><span data-stu-id="bc92b-159">For more information, see [How to: Configure Firewall Settings (Azure SQL Database)](sql-database-configure-firewall-settings.md).</span></span>

### <a name="configure-logins-and-database-users"></a><span data-ttu-id="bc92b-160">Configurare gli account di accesso e gli utenti del database</span><span class="sxs-lookup"><span data-stu-id="bc92b-160">Configure logins and database users</span></span>
<span data-ttu-id="bc92b-161">È necessario che tutti gli accessi hello utilizzati dall'applicazione nel server siano presenti hello che ospita il database ripristinato toomake.</span><span class="sxs-lookup"><span data-stu-id="bc92b-161">You need toomake sure that all hello logins used by your application exist on hello server which is hosting your recovered database.</span></span> <span data-ttu-id="bc92b-162">Per altre informazioni, vedere [Configurazione della sicurezza per la replica geografica](sql-database-geo-replication-security-config.md).</span><span class="sxs-lookup"><span data-stu-id="bc92b-162">For more information, see [Security Configuration for geo-replication](sql-database-geo-replication-security-config.md).</span></span>

> [!NOTE]
> <span data-ttu-id="bc92b-163">È necessario configurare e testare le regole del firewall del server e gli account di accesso (con le relative autorizzazioni) durante un'analisi di ripristino di emergenza.</span><span class="sxs-lookup"><span data-stu-id="bc92b-163">You should configure and test your server firewall rules and logins (and their permissions) during a disaster recovery drill.</span></span> <span data-ttu-id="bc92b-164">Questi oggetti a livello di server e la configurazione potrebbe non essere disponibile durante un'interruzione di hello.</span><span class="sxs-lookup"><span data-stu-id="bc92b-164">These server-level objects and their configuration may not be available during hello outage.</span></span>
> 
> 

### <a name="setup-telemetry-alerts"></a><span data-ttu-id="bc92b-165">Avvisi di telemetria di configurazione</span><span class="sxs-lookup"><span data-stu-id="bc92b-165">Setup telemetry alerts</span></span>
<span data-ttu-id="bc92b-166">È necessario che le impostazioni della regola di avviso esistenti siano aggiornati toomap toohello ripristinati database hello diversi server e toomake.</span><span class="sxs-lookup"><span data-stu-id="bc92b-166">You need toomake sure your existing alert rule settings are updated toomap toohello recovered database and hello different server.</span></span>

<span data-ttu-id="bc92b-167">Per altre informazioni sulle regole di avviso per il database, vedere [Ricevere notifiche di avviso](../monitoring-and-diagnostics/insights-receive-alert-notifications.md) e [Tracciare l’integrità del servizio](../monitoring-and-diagnostics/insights-service-health.md).</span><span class="sxs-lookup"><span data-stu-id="bc92b-167">For more information about database alert rules, see [Receive Alert Notifications](../monitoring-and-diagnostics/insights-receive-alert-notifications.md) and [Track Service Health](../monitoring-and-diagnostics/insights-service-health.md).</span></span>

### <a name="enable-auditing"></a><span data-ttu-id="bc92b-168">Attivare il controllo</span><span class="sxs-lookup"><span data-stu-id="bc92b-168">Enable auditing</span></span>
<span data-ttu-id="bc92b-169">Se il controllo è obbligatorio tooaccess del database, è necessario tooenable controllo dopo il ripristino di database hello.</span><span class="sxs-lookup"><span data-stu-id="bc92b-169">If auditing is required tooaccess your database, you need tooenable Auditing after hello database recovery.</span></span> <span data-ttu-id="bc92b-170">Per altre informazioni, vedere l'articolo sul [controllo del database](sql-database-auditing.md).</span><span class="sxs-lookup"><span data-stu-id="bc92b-170">For more information, see [Database auditing](sql-database-auditing.md).</span></span>

## <a name="next-steps"></a><span data-ttu-id="bc92b-171">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="bc92b-171">Next steps</span></span>
* <span data-ttu-id="bc92b-172">toolearn sui backup di Database di SQL Azure automatizzati, vedere [backup automatici di Database SQL](sql-database-automated-backups.md)</span><span class="sxs-lookup"><span data-stu-id="bc92b-172">toolearn about Azure SQL Database automated backups, see [SQL Database automated backups](sql-database-automated-backups.md)</span></span>
* <span data-ttu-id="bc92b-173">toolearn sugli scenari di progettazione e il ripristino di continuità aziendale, vedere [gli scenari di continuità](sql-database-business-continuity.md)</span><span class="sxs-lookup"><span data-stu-id="bc92b-173">toolearn about business continuity design and recovery scenarios, see [Continuity scenarios](sql-database-business-continuity.md)</span></span>
* <span data-ttu-id="bc92b-174">toolearn sull'utilizzo di backup automatico per il ripristino, vedere [ripristinare un database dai backup avviate dal servizio hello](sql-database-recovery-using-backups.md)</span><span class="sxs-lookup"><span data-stu-id="bc92b-174">toolearn about using automated backups for recovery, see [restore a database from hello service-initiated backups](sql-database-recovery-using-backups.md)</span></span>

