---
title: aaaSAP HANA Azure Backup a livello file | Documenti Microsoft
description: Esistono due opzioni principali per il backup di SAP HANA su macchine virtuali di Azure e questo articolo descrive il backup di SAP HANA di Azure a livello di file.
services: virtual-machines-linux
documentationcenter: 
author: hermanndms
manager: timlt
editor: 
ms.service: virtual-machines-linux
ms.devlang: NA
ms.topic: article
ums.tgt_pltfrm: vm-linux
ms.workload: infrastructure-services
ms.date: 3/13/2017
ms.author: rclaus
ms.openlocfilehash: d5a55de5634ac7724e7fd0fa3760c6c408c3db74
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/06/2017
---
# <a name="sap-hana-azure-backup-on-file-level"></a><span data-ttu-id="0dacc-103">Backup di SAP HANA di Azure a livello di file</span><span class="sxs-lookup"><span data-stu-id="0dacc-103">SAP HANA Azure Backup on file level</span></span>

## <a name="introduction"></a><span data-ttu-id="0dacc-104">Introduzione</span><span class="sxs-lookup"><span data-stu-id="0dacc-104">Introduction</span></span>

<span data-ttu-id="0dacc-105">Questo articolo fa parte di una serie di tre articoli correlati dedicati al backup di SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="0dacc-105">This is part of a three-part series of related articles on SAP HANA backup.</span></span> <span data-ttu-id="0dacc-106">[Guida al backup per SAP HANA in macchine virtuali di Azure](./sap-hana-backup-guide.md) fornisce una panoramica e informazioni sulle attività iniziali e [SAP HANA backup basato su snapshot di archiviazione](./sap-hana-backup-storage-snapshots.md) copre hello opzione di archiviazione basato su snapshot backup.</span><span class="sxs-lookup"><span data-stu-id="0dacc-106">[Backup guide for SAP HANA on Azure Virtual Machines](./sap-hana-backup-guide.md) provides an overview and information on getting started, and [SAP HANA backup based on storage snapshots](./sap-hana-backup-storage-snapshots.md) covers hello storage snapshot-based backup option.</span></span>

<span data-ttu-id="0dacc-107">Esaminando hello dimensioni di macchina virtuale di Azure, si può osservare che un GS5 consente 64 dischi dati collegati.</span><span class="sxs-lookup"><span data-stu-id="0dacc-107">Looking at hello Azure VM sizes, one can see that a GS5 allows 64 attached data disks.</span></span> <span data-ttu-id="0dacc-108">Per sistemi SAP HANA di grandi dimensioni, un numero significativo di dischi potrebbe essere già usato per i file di log e di dati, possibilmente in combinazione con RAID software per la velocità effettiva IO ottimale dei dischi.</span><span class="sxs-lookup"><span data-stu-id="0dacc-108">For large SAP HANA systems, a significant number of disks might already be taken for data and log files, possibly in combination with software RAID for optimal disk IO throughput.</span></span> <span data-ttu-id="0dacc-109">quindi domanda Hello è dove toostore SAP HANA backup di file, che potrebbe riempirsi dati hello collegato dischi nel tempo?</span><span class="sxs-lookup"><span data-stu-id="0dacc-109">hello question then is where toostore SAP HANA backup files, which could fill up hello attached data disks over time?</span></span> <span data-ttu-id="0dacc-110">Vedere [dimensioni per le macchine virtuali Linux in Azure](../../linux/sizes.md) per le tabelle di dimensioni di hello macchina virtuale di Azure.</span><span class="sxs-lookup"><span data-stu-id="0dacc-110">See [Sizes for Linux virtual machines in Azure](../../linux/sizes.md) for hello Azure VM size tables.</span></span>

<span data-ttu-id="0dacc-111">Al momento, non è disponibile alcuna integrazione del backup di SAP HANA con il servizio di Backup di Azure.</span><span class="sxs-lookup"><span data-stu-id="0dacc-111">There is no SAP HANA backup integration available with Azure Backup service at this time.</span></span> <span data-ttu-id="0dacc-112">modalità standard di Hello toomanage backup/ripristino a livello di file hello è con un backup basato su file SAP HANA Studio o mediante istruzioni SQL di SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="0dacc-112">hello standard way toomanage backup/restore at hello file level is with a file-based backup via SAP HANA Studio or via SAP HANA SQL statements.</span></span> <span data-ttu-id="0dacc-113">Per altre informazioni, vedere [SAP HANA SQL and System Views Reference](https://help.sap.com/hana/SAP_HANA_SQL_and_System_Views_Reference_en.pdf) (Riferimento alle visualizzazioni del sistema e di SQL SAP HANA).</span><span class="sxs-lookup"><span data-stu-id="0dacc-113">See [SAP HANA SQL and System Views Reference](https://help.sap.com/hana/SAP_HANA_SQL_and_System_Views_Reference_en.pdf) for more information.</span></span>

![In questa figura Mostra finestra di dialogo di hello della voce di menu backup hello in Studio di SAP HANA](media/sap-hana-backup-file-level/image022.png)

<span data-ttu-id="0dacc-115">In questa figura Mostra finestra di dialogo di hello della voce di menu backup hello in Studio di SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="0dacc-115">This figure shows hello dialog of hello backup menu item in SAP HANA Studio.</span></span> <span data-ttu-id="0dacc-116">Quando si sceglie di tipo &quot;file&quot; toospecify uno è un percorso nel sistema di file hello in SAP HANA scrive i file di backup hello.</span><span class="sxs-lookup"><span data-stu-id="0dacc-116">When choosing type &quot;file,&quot; one has toospecify a path in hello file system where SAP HANA writes hello backup files.</span></span> <span data-ttu-id="0dacc-117">Funzionamento del ripristino hello allo stesso modo.</span><span class="sxs-lookup"><span data-stu-id="0dacc-117">Restore works hello same way.</span></span>

<span data-ttu-id="0dacc-118">Sebbene questa scelta sia semplice e diretta, è opportuno presentare alcune considerazioni.</span><span class="sxs-lookup"><span data-stu-id="0dacc-118">While this choice sounds simple and straight forward, there are some considerations.</span></span> <span data-ttu-id="0dacc-119">Come accennato in precedenza, una macchina virtuale di Azure presenta una limitazione nel numero di dischi di dati che è possibile collegare.</span><span class="sxs-lookup"><span data-stu-id="0dacc-119">As mentioned before, an Azure VM has a limitation of number of data disks that can be attached.</span></span> <span data-ttu-id="0dacc-120">Potrebbe non essere capacità toostore SAP HANA i file di backup nei sistemi file hello hello macchina virtuale, a seconda delle dimensioni di hello di hello database e disco requisiti velocità effettiva, che potrebbe comportare software RAID con striping tra dati di più dischi.</span><span class="sxs-lookup"><span data-stu-id="0dacc-120">There might not be capacity toostore SAP HANA backup files on hello file systems of hello VM, depending on hello size of hello database and disk throughput requirements, which might involve software RAID using striping across multiple data disks.</span></span> <span data-ttu-id="0dacc-121">Più avanti in questo articolo vengono fornite varie opzioni per lo spostamento di questi file di backup e per la gestione delle limitazioni relative alle dimensioni dei file e delle prestazioni durante la gestione di terabyte di dati.</span><span class="sxs-lookup"><span data-stu-id="0dacc-121">Various options for moving these backup files, and managing file size restrictions and performance when handling terabytes of data, are provided later in this article.</span></span>

<span data-ttu-id="0dacc-122">Un'altra opzione, che offre più libertà in relazione alla capacità totale, è l'Archiviazione BLOB di Azure.</span><span class="sxs-lookup"><span data-stu-id="0dacc-122">Another option, which offers more freedom regarding total capacity, is Azure blob storage.</span></span> <span data-ttu-id="0dacc-123">Mentre un singolo blob è inoltre limitati too1 TB, capacità totale di hello di un contenitore blob singolo è attualmente 500 TB.</span><span class="sxs-lookup"><span data-stu-id="0dacc-123">While a single blob is also restricted too1 TB, hello total capacity of a single blob container is currently 500 TB.</span></span> <span data-ttu-id="0dacc-124">Inoltre, offre ai clienti hello scelte tooselect cosiddetti &quot;sporadico&quot; blob di archiviazione, che offre un vantaggio di costo.</span><span class="sxs-lookup"><span data-stu-id="0dacc-124">Additionally, it gives customers hello choice tooselect so-called &quot;cool&quot; blob storage, which has a cost benefit.</span></span> <span data-ttu-id="0dacc-125">Vedere [Archivio BLOB di Azure: livelli di archiviazione ad accesso frequente e sporadico](../../../storage/blobs/storage-blob-storage-tiers.md) per altre informazioni sull'archiviazione BLOB ad accesso sporadico.</span><span class="sxs-lookup"><span data-stu-id="0dacc-125">See [Azure Blob Storage: Hot and cool storage tiers](../../../storage/blobs/storage-blob-storage-tiers.md) for details about cool blob storage.</span></span>

<span data-ttu-id="0dacc-126">Per motivi di sicurezza aggiuntivi, utilizzare un backup di archiviazione replicata geograficamente account toostore hello SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="0dacc-126">For additional safety, use a geo-replicated storage account toostore hello SAP HANA backups.</span></span> <span data-ttu-id="0dacc-127">Per dettagli sulla replica dell'account di archiviazione, vedere [Replica di Archiviazione di Azure](../../../storage/common/storage-redundancy.md).</span><span class="sxs-lookup"><span data-stu-id="0dacc-127">See [Azure Storage replication](../../../storage/common/storage-redundancy.md) for details about storage account replication.</span></span>

<span data-ttu-id="0dacc-128">È possibile posizionare dischi rigidi virtuali dedicati per i backup di SAP HANA in un account di archiviazione di backup apposito con replica geografica.</span><span class="sxs-lookup"><span data-stu-id="0dacc-128">One could place dedicated VHDs for SAP HANA backups in a dedicated backup storage account that is geo-replicated.</span></span> <span data-ttu-id="0dacc-129">In caso contrario uno è stato possibile copiare i dischi rigidi virtuali hello che conserva i backup di SAP HANA hello account di archiviazione replicata geograficamente tooa o account di archiviazione tooa in un'area diversa.</span><span class="sxs-lookup"><span data-stu-id="0dacc-129">Or else one could copy hello VHDs that keep hello SAP HANA backups tooa geo-replicated storage account, or tooa storage account that is in a different region.</span></span>

## <a name="azure-backup-agent"></a><span data-ttu-id="0dacc-130">Agente di Backup di Azure</span><span class="sxs-lookup"><span data-stu-id="0dacc-130">Azure backup agent</span></span>

<span data-ttu-id="0dacc-131">Azure backup offre hello opzione toonot solo eseguire il backup completo le macchine virtuali, ma anche file e directory tramite l'agente backup hello, che ha installato nel sistema operativo guest hello toobe.</span><span class="sxs-lookup"><span data-stu-id="0dacc-131">Azure backup offers hello option toonot only back up complete VMs, but also files and directories via hello backup agent, which has toobe installed on hello guest OS.</span></span> <span data-ttu-id="0dacc-132">Ma a partire dal 2016 dicembre, l'agente è supportato solo in Windows (vedere [backup tooAzure un client o Server Windows con modello di distribuzione di gestione risorse di hello](../../../backup/backup-configure-vault.md)).</span><span class="sxs-lookup"><span data-stu-id="0dacc-132">But as of December 2016, this agent is only supported on Windows (see [Back up a Windows Server or client tooAzure using hello Resource Manager deployment model](../../../backup/backup-configure-vault.md)).</span></span>

<span data-ttu-id="0dacc-133">Una soluzione alternativa è toofirst copia i file di backup di SAP HANA tooa macchina virtuale Windows in Azure (ad esempio, tramite la condivisione SAMBA) e quindi utilizzare hello agente Azure backup da qui.</span><span class="sxs-lookup"><span data-stu-id="0dacc-133">A workaround is toofirst copy SAP HANA backup files tooa Windows VM on Azure (for example, via SAMBA share) and then use hello Azure backup agent from there.</span></span> <span data-ttu-id="0dacc-134">Sebbene sia tecnicamente possibile, potrebbe aggiungere complessità e rallentare backup hello o ripristinare processo abbastanza a causa di copia toohello tra hello Linux e macchina virtuale di Windows hello.</span><span class="sxs-lookup"><span data-stu-id="0dacc-134">While it is technically possible, it would add complexity and slow down hello backup or restore process quite a bit due toohello copy between hello Linux and hello Windows VM.</span></span> <span data-ttu-id="0dacc-135">Non è consigliabile toofollow questo approccio.</span><span class="sxs-lookup"><span data-stu-id="0dacc-135">It is not recommended toofollow this approach.</span></span>

## <a name="azure-blobxfer-utility-details"></a><span data-ttu-id="0dacc-136">Dettagli sull'utilità di blobxfer di Azure</span><span class="sxs-lookup"><span data-stu-id="0dacc-136">Azure blobxfer utility details</span></span>

<span data-ttu-id="0dacc-137">toostore directory e file in archiviazione di Azure, è possibile utilizzare CLI o PowerShell, o sviluppare uno strumento utilizzando uno dei hello [Azure SDK](https://azure.microsoft.com/downloads/).</span><span class="sxs-lookup"><span data-stu-id="0dacc-137">toostore directories and files on Azure storage, one could use CLI or PowerShell, or develop a tool using one of hello [Azure SDKs](https://azure.microsoft.com/downloads/).</span></span> <span data-ttu-id="0dacc-138">È inoltre disponibile un'utilità, pronto all'uso di AzCopy, per la copia di archiviazione dei dati tooAzure, ma è solo Windows (vedere [trasferire i dati con l'utilità della riga di comando AzCopy hello](../../../storage/common/storage-use-azcopy.md)).</span><span class="sxs-lookup"><span data-stu-id="0dacc-138">There is also a ready-to-use utility, AzCopy, for copying data tooAzure storage, but it is Windows only (see [Transfer data with hello AzCopy Command-Line Utility](../../../storage/common/storage-use-azcopy.md)).</span></span>

<span data-ttu-id="0dacc-139">Blobxfer è stato pertanto usato per la copia dei file di backup di SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="0dacc-139">Therefore blobxfer was used for copying SAP HANA backup files.</span></span> <span data-ttu-id="0dacc-140">Si tratta di una risorsa open source, usata da molti clienti negli ambienti di produzione e disponibile su [GitHub](https://github.com/Azure/blobxfer).</span><span class="sxs-lookup"><span data-stu-id="0dacc-140">It is open source, used by many customers in production environments, and available on [GitHub](https://github.com/Azure/blobxfer).</span></span> <span data-ttu-id="0dacc-141">Questo strumento consente dati toocopy direttamente tooeither Azure blob storage o una condivisione di file di Azure.</span><span class="sxs-lookup"><span data-stu-id="0dacc-141">This tool allows one toocopy data directly tooeither Azure blob storage or Azure file share.</span></span> <span data-ttu-id="0dacc-142">Offre anche una gamma di funzionalità utili, ad esempio hash md5 o parallelismo automatico durante la copia di una directory con più file.</span><span class="sxs-lookup"><span data-stu-id="0dacc-142">It also offers a range of useful features, like md5 hash or automatic parallelism when copying a directory with multiple files.</span></span>

## <a name="sap-hana-backup-performance"></a><span data-ttu-id="0dacc-143">Prestazioni del backup SAP HANA</span><span class="sxs-lookup"><span data-stu-id="0dacc-143">SAP HANA backup performance</span></span>

![Questa schermata è della console backup di SAP HANA hello in Studio di SAP HANA](media/sap-hana-backup-file-level/image023.png)

<span data-ttu-id="0dacc-145">Questa schermata è della console backup di SAP HANA hello in Studio di SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="0dacc-145">This screenshot is of hello SAP HANA backup console in SAP HANA Studio.</span></span> <span data-ttu-id="0dacc-146">Backup di circa 42 minuti toodo hello impiegato di hello 230 GB su un disco di archiviazione standard Azure singolo associata toohello HANA VM utilizzando XFS file system.</span><span class="sxs-lookup"><span data-stu-id="0dacc-146">It took about 42 minutes toodo hello backup of hello 230 GB on a single Azure standard storage disk attached toohello HANA VM using XFS file system.</span></span>

![Questa schermata è di YaST nella macchina virtuale di test di hello SAP HANA](media/sap-hana-backup-file-level/image024.png)

<span data-ttu-id="0dacc-148">Questa schermata è YaST nella macchina virtuale di test SAP HANA hello.</span><span class="sxs-lookup"><span data-stu-id="0dacc-148">This screenshot is of YaST on hello SAP HANA test VM.</span></span> <span data-ttu-id="0dacc-149">Come indicato in precedenza, si può osservare disco singolo hello di 1 TB per il backup di SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="0dacc-149">One can see hello 1-TB single disk for SAP HANA backup as mentioned before.</span></span> <span data-ttu-id="0dacc-150">Impiegato circa 42 minuti toobackup 230 GB.</span><span class="sxs-lookup"><span data-stu-id="0dacc-150">It took about 42 minutes toobackup 230 GB.</span></span> <span data-ttu-id="0dacc-151">Sono stati anche associati cinque dischi da 200 GB ed è stato creato il RAID software md0 RAID, con striping su questi cinque dischi di dati di Azure.</span><span class="sxs-lookup"><span data-stu-id="0dacc-151">In addition, five 200-GB disks were attached and software RAID md0 created, with striping on top of these five Azure data disks.</span></span>

![Ripetizione hello stesso backup RAID software con striping in cinque collegati dischi di dati standard di archiviazione Azure](media/sap-hana-backup-file-level/image025.png)

<span data-ttu-id="0dacc-153">Hello ripetuta stesso backup RAID software con striping in cinque associata ora backup hello portati dischi dati di archiviazione di Azure standard da 42 minuti verso il basso too10 minuti.</span><span class="sxs-lookup"><span data-stu-id="0dacc-153">Repeating hello same backup on software RAID with striping across five attached Azure standard storage data disks brought hello backup time from 42 minutes down too10 minutes.</span></span> <span data-ttu-id="0dacc-154">sono stati collegati dischi di Hello senza memorizzazione nella cache toohello macchina virtuale.</span><span class="sxs-lookup"><span data-stu-id="0dacc-154">hello disks were attached without caching toohello VM.</span></span> <span data-ttu-id="0dacc-155">Pertanto è evidente l'importanza produttività di scrittura su disco per l'ora del backup hello.</span><span class="sxs-lookup"><span data-stu-id="0dacc-155">So it is obvious how important disk write throughput is for hello backup time.</span></span> <span data-ttu-id="0dacc-156">Uno può quindi commutatore tooAzure premium archiviazione toofurther accelerare il processo di hello per ottenere prestazioni ottimali.</span><span class="sxs-lookup"><span data-stu-id="0dacc-156">One could then switch tooAzure premium storage toofurther accelerate hello process for optimal performance.</span></span> <span data-ttu-id="0dacc-157">In generale, l'Archiviazione Premium di Azure deve essere usata per i sistemi di produzione.</span><span class="sxs-lookup"><span data-stu-id="0dacc-157">In general, Azure premium storage should be used for production systems.</span></span>

## <a name="copy-sap-hana-backup-files-tooazure-blob-storage"></a><span data-ttu-id="0dacc-158">Copiare l'archiviazione blob tooAzure i file di backup di SAP HANA</span><span class="sxs-lookup"><span data-stu-id="0dacc-158">Copy SAP HANA backup files tooAzure blob storage</span></span>

<span data-ttu-id="0dacc-159">Come di dicembre 2016, hello meglio i file di backup opzione tooquickly archivio SAP HANA è archiviazione blob di Azure.</span><span class="sxs-lookup"><span data-stu-id="0dacc-159">As of December 2016, hello best option tooquickly store SAP HANA backup files is Azure blob storage.</span></span> <span data-ttu-id="0dacc-160">Un contenitore blob singolo ha un limite di 500 TB, è sufficiente per la maggior parte dei sistemi SAP HANA, in esecuzione in una macchina virtuale GS5 in Azure, i backup di SAP HANA sufficienti tookeep.</span><span class="sxs-lookup"><span data-stu-id="0dacc-160">One single blob container has a limit of 500 TB, enough for most SAP HANA systems, running in a GS5 VM on Azure, tookeep sufficient SAP HANA backups.</span></span> <span data-ttu-id="0dacc-161">I clienti hanno scelto di hello tra &quot;frequente&quot; e &quot;freddo&quot; nell'archiviazione blob (vedere [archiviazione Blob di Azure: a caldo e interessanti livelli di archiviazione](../../../storage/blobs/storage-blob-storage-tiers.md)).</span><span class="sxs-lookup"><span data-stu-id="0dacc-161">Customers have hello choice between &quot;hot&quot; and &quot;cold&quot; blob storage (see [Azure Blob Storage: Hot and cool storage tiers](../../../storage/blobs/storage-blob-storage-tiers.md)).</span></span>

<span data-ttu-id="0dacc-162">Con lo strumento blobxfer hello, è facile toocopy file di backup SAP HANA hello direttamente tooAzure nell'archiviazione blob.</span><span class="sxs-lookup"><span data-stu-id="0dacc-162">With hello blobxfer tool, it is easy toocopy hello SAP HANA backup files directly tooAzure blob storage.</span></span>

![Qui si possono osservare file hello di un backup completo del file SAP HANA](media/sap-hana-backup-file-level/image026.png)

<span data-ttu-id="0dacc-164">Qui si possono osservare file hello di un backup completo del file SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="0dacc-164">Here one can see hello files of a full SAP HANA file backup.</span></span> <span data-ttu-id="0dacc-165">Esistono quattro file uno più grande hello è approssimativamente di 230 GB.</span><span class="sxs-lookup"><span data-stu-id="0dacc-165">There are four files and hello biggest one has roughly 230 GB.</span></span>

![Impiegato circa 3.000 secondi toocopy hello 230 GB tooan standard account blob contenitore di archiviazione Azure](media/sap-hana-backup-file-level/image027.png)

<span data-ttu-id="0dacc-167">Nel test iniziale hello non usa l'hash md5, impiegato circa 3.000 secondi toocopy hello 230 GB tooan standard account blob contenitore di archiviazione Azure.</span><span class="sxs-lookup"><span data-stu-id="0dacc-167">Not using md5 hash in hello initial test, it took roughly 3000 seconds toocopy hello 230 GB tooan Azure standard storage account blob container.</span></span>

![In questa schermata, uno può vedere come appare nel portale di Azure hello](media/sap-hana-backup-file-level/image028.png)

<span data-ttu-id="0dacc-169">In questa schermata, si può osservare come appare nel portale di Azure hello.</span><span class="sxs-lookup"><span data-stu-id="0dacc-169">In this screenshot, one can see how it looks on hello Azure portal.</span></span> <span data-ttu-id="0dacc-170">Un contenitore blob denominato &quot;sap hana-i-backup&quot; è stato creato e include i quattro hello, che rappresentano i file di backup di hello SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="0dacc-170">A blob container named &quot;sap-hana-backups&quot; was created and includes hello four blobs, which represent hello SAP HANA backup files.</span></span> <span data-ttu-id="0dacc-171">Uno di essi ha una dimensione di circa 230 GB.</span><span class="sxs-lookup"><span data-stu-id="0dacc-171">One of them has a size of roughly 230 GB.</span></span>

<span data-ttu-id="0dacc-172">console di backup HANA Studio Hello consente una dimensione massima del file di hello toorestrict HANA dei file di backup.</span><span class="sxs-lookup"><span data-stu-id="0dacc-172">hello HANA Studio backup console allows one toorestrict hello max file size of HANA backup files.</span></span> <span data-ttu-id="0dacc-173">Nell'ambiente di esempio hello, prestazioni migliorate, rendendo possibili toohave file più i backup più piccoli, anziché un file di 230 GB di grandi dimensioni.</span><span class="sxs-lookup"><span data-stu-id="0dacc-173">In hello sample environment, it improved performance by making it possible toohave multiple smaller backup files, instead of one large 230-GB file.</span></span>

![L'impostazione del limite di dimensioni file di backup di hello hello HANA lato &#39; t migliorare i tempi di backup hello](media/sap-hana-backup-file-level/image029.png)

<span data-ttu-id="0dacc-175">L'impostazione del limite di dimensioni file di backup di hello hello HANA lato &#39; t tempi hello backup, perché i file hello vengono scritti in modo sequenziale, come illustrato nella figura seguente.</span><span class="sxs-lookup"><span data-stu-id="0dacc-175">Setting hello backup file size limit on hello HANA side doesn&#39;t improve hello backup time, because hello files are written sequentially as shown in this figure.</span></span> <span data-ttu-id="0dacc-176">limite delle dimensioni file Hello è stato impostato too60 GB, in modo backup hello creati quattro file di dati di grandi dimensioni anziché hello 230 GB file singolo.</span><span class="sxs-lookup"><span data-stu-id="0dacc-176">hello file size limit was set too60 GB, so hello backup created four large data files instead of hello 230-GB single file.</span></span>

![parallelismo tootest dello strumento blobxfer hello, hello dimensione massima del file per i backup HANA impostato quindi too15 GB](media/sap-hana-backup-file-level/image030.png)

<span data-ttu-id="0dacc-178">parallelismo tootest dello strumento blobxfer hello, hello dimensione massima del file per i backup HANA impostato quindi too15 GB, che hanno comportato 19 file di backup.</span><span class="sxs-lookup"><span data-stu-id="0dacc-178">tootest parallelism of hello blobxfer tool, hello max file size for HANA backups was then set too15 GB, which resulted in 19 backup files.</span></span> <span data-ttu-id="0dacc-179">Questa configurazione attivata la modalità tempo hello per l'archiviazione blob di blobxfer toocopy hello 230 GB tooAzure da 3.000 secondi verso il basso too875 secondi.</span><span class="sxs-lookup"><span data-stu-id="0dacc-179">This configuration brought hello time for blobxfer toocopy hello 230 GB tooAzure blob storage from 3000 seconds down too875 seconds.</span></span>

<span data-ttu-id="0dacc-180">Il risultato è dovuto toohello il limite di 60 MB/sec per la scrittura di un blob di Azure.</span><span class="sxs-lookup"><span data-stu-id="0dacc-180">This result is due toohello limit of 60 MB/sec for writing an Azure blob.</span></span> <span data-ttu-id="0dacc-181">Il parallelismo tramite più BLOB risolve collo di bottiglia hello, ma non esiste un svantaggio: miglioramento delle prestazioni di hello blobxfer strumento toocopy tutti questi tooAzure HANA con i file di backup nell'archiviazione blob inserisce carico hello HANA VM e rete hello.</span><span class="sxs-lookup"><span data-stu-id="0dacc-181">Parallelism via multiple blobs solves hello bottleneck, but there is a downside: increasing performance of hello blobxfer tool toocopy all these HANA backup files tooAzure blob storage puts load on both hello HANA VM and hello network.</span></span> <span data-ttu-id="0dacc-182">Ne è interessato il funzionamento del sistema HANA.</span><span class="sxs-lookup"><span data-stu-id="0dacc-182">Operation of HANA system becomes impacted.</span></span>

## <a name="blob-copy-of-dedicated-azure-data-disks-in-backup-software-raid"></a><span data-ttu-id="0dacc-183">Copia di BLOB dei dischi di dati di Azure dedicati nel RAID software di backup</span><span class="sxs-lookup"><span data-stu-id="0dacc-183">Blob copy of dedicated Azure data disks in backup software RAID</span></span>

<span data-ttu-id="0dacc-184">A differenza di hello manuale VM disco backup dei dati, con questo approccio uno non eseguire il backup di tutti i dischi dati hello in una macchina virtuale toosave hello intero SAP installazione, inclusi i dati HANA HANA registra i file e i file di configurazione.</span><span class="sxs-lookup"><span data-stu-id="0dacc-184">Unlike hello manual VM data disk backup, in this approach one does not back up all hello data disks on a VM toosave hello whole SAP installation, including HANA data, HANA log files, and config files.</span></span> <span data-ttu-id="0dacc-185">Al contrario, hello idea è RAID software toohave dedicato con striping tra più dischi rigidi virtuali dati Azure per archiviare un backup completo del file SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="0dacc-185">Instead, hello idea is toohave dedicated software RAID with striping across multiple Azure data VHDs for storing a full SAP HANA file backup.</span></span> <span data-ttu-id="0dacc-186">Una copia solo i dischi che dispone di backup di SAP HANA hello.</span><span class="sxs-lookup"><span data-stu-id="0dacc-186">One copies only these disks, which have hello SAP HANA backup.</span></span> <span data-ttu-id="0dacc-187">Può facilmente essere conservate in un account di archiviazione di backup HANA dedicato o collegato tooa dedicato &quot;backup Gestione VM&quot; per un'ulteriore elaborazione.</span><span class="sxs-lookup"><span data-stu-id="0dacc-187">They could easily be kept in a dedicated HANA backup storage account, or attached tooa dedicated &quot;backup management VM&quot; for further processing.</span></span>

![Sono stati copiati tutti i dischi rigidi virtuali interessati utilizzando hello * * start-azurestorageblobcopy * * il comando di PowerShell](media/sap-hana-backup-file-level/image031.png)

<span data-ttu-id="0dacc-189">Dopo il RAID software toohello backup locale hello è stato completato, tutti i dischi rigidi virtuali interessati sono stati copiati utilizzando hello **inizio azurestorageblobcopy** comando di PowerShell (vedere [inizio AzureStorageBlobCopy](/powershell/module/azure.storage/start-azurestorageblobcopy)).</span><span class="sxs-lookup"><span data-stu-id="0dacc-189">After hello backup toohello local software RAID was completed, all VHDs involved were copied using hello **start-azurestorageblobcopy** PowerShell command (see [Start-AzureStorageBlobCopy](/powershell/module/azure.storage/start-azurestorageblobcopy)).</span></span> <span data-ttu-id="0dacc-190">Poiché influisce solo sul sistema file hello dedicato per mantenere i file di backup hello, non esistono alcun problemi relativi a SAP HANA dati o log della coerenza del file su disco hello.</span><span class="sxs-lookup"><span data-stu-id="0dacc-190">As it only affects hello dedicated file system for keeping hello backup files, there are no concerns about SAP HANA data or log file consistency on hello disk.</span></span> <span data-ttu-id="0dacc-191">Un vantaggio di questo comando è che funziona mentre hello VM rimane online.</span><span class="sxs-lookup"><span data-stu-id="0dacc-191">A benefit of this command is that it works while hello VM stays online.</span></span> <span data-ttu-id="0dacc-192">toobe determinati che nessun processo scrive un set di backup di striping toohello, essere toounmount assicurarsi prima hello copia del blob e crearla nuovamente in seguito.</span><span class="sxs-lookup"><span data-stu-id="0dacc-192">toobe certain that no process writes toohello backup stripe set, be sure toounmount it before hello blob copy, and mount it again afterwards.</span></span> <span data-ttu-id="0dacc-193">O è Impossibile utilizzare un appropriato troppo&quot;bloccare&quot; sistema file hello.</span><span class="sxs-lookup"><span data-stu-id="0dacc-193">Or one could use an appropriate way too&quot;freeze&quot; hello file system.</span></span> <span data-ttu-id="0dacc-194">Ad esempio, tramite xfs\_bloccare per hello XFS del file system.</span><span class="sxs-lookup"><span data-stu-id="0dacc-194">For example, via xfs\_freeze for hello XFS file system.</span></span>

![Questa schermata Mostra elenco hello di BLOB nel contenitore di dischi rigidi virtuali hello sul hello portale di Azure](media/sap-hana-backup-file-level/image032.png)

<span data-ttu-id="0dacc-196">Questa schermata Mostra elenco hello di BLOB in hello &quot;dischi rigidi virtuali&quot; contenitore nel portale di Azure hello.</span><span class="sxs-lookup"><span data-stu-id="0dacc-196">This screenshot shows hello list of blobs in hello &quot;vhds&quot; container on hello Azure portal.</span></span> <span data-ttu-id="0dacc-197">schermata Hello Mostra hello cinque dischi rigidi virtuali, che sono stati collegati toohello SAP HANA server VM tooserve come hello software RAID tookeep SAP HANA i file di backup.</span><span class="sxs-lookup"><span data-stu-id="0dacc-197">hello screenshot shows hello five VHDs, which were attached toohello SAP HANA server VM tooserve as hello software RAID tookeep SAP HANA backup files.</span></span> <span data-ttu-id="0dacc-198">Viene inoltre cinque copie, che sono state eseguite tramite comando di copia blob hello hello.</span><span class="sxs-lookup"><span data-stu-id="0dacc-198">It also shows hello five copies, which were taken via hello blob copy command.</span></span>

![A scopo di test, le copie di dischi RAID software di backup di SAP HANA hello hello sono stati macchina virtuale del server collegato toohello app](media/sap-hana-backup-file-level/image033.png)

<span data-ttu-id="0dacc-200">A scopo di test, copie hello di dischi RAID software di backup di SAP HANA hello sono macchina virtuale del server collegato toohello app.</span><span class="sxs-lookup"><span data-stu-id="0dacc-200">For testing purposes, hello copies of hello SAP HANA backup software RAID disks were attached toohello app server VM.</span></span>

![il server di app Hello VM è stato arrestato copie del disco di hello tooattach](media/sap-hana-backup-file-level/image034.png)

<span data-ttu-id="0dacc-202">il server di app Hello VM è stato arrestato tooattach hello disco copie.</span><span class="sxs-lookup"><span data-stu-id="0dacc-202">hello app server VM was shut down tooattach hello disk copies.</span></span> <span data-ttu-id="0dacc-203">Dopo l'avvio hello macchine Virtuali, dischi hello e hello RAID, sono stati rilevati correttamente (montato tramite UUID).</span><span class="sxs-lookup"><span data-stu-id="0dacc-203">After starting hello VM, hello disks and hello RAID were discovered correctly (mounted via UUID).</span></span> <span data-ttu-id="0dacc-204">Solo il punto di montaggio hello è manca, cui è stato creato tramite partitioner YaST hello.</span><span class="sxs-lookup"><span data-stu-id="0dacc-204">Only hello mount point was missing, which was created via hello YaST partitioner.</span></span> <span data-ttu-id="0dacc-205">In seguito le copie dei file di backup SAP HANA hello è diventata visibile sul livello del sistema operativo.</span><span class="sxs-lookup"><span data-stu-id="0dacc-205">Afterwards hello SAP HANA backup file copies became visible on OS level.</span></span>

## <a name="copy-sap-hana-backup-files-toonfs-share"></a><span data-ttu-id="0dacc-206">Copiare i file di backup di SAP HANA tooNFS condividere</span><span class="sxs-lookup"><span data-stu-id="0dacc-206">Copy SAP HANA backup files tooNFS share</span></span>

<span data-ttu-id="0dacc-207">toolessen hello potenziale impatto sulle hello sistema SAP HANA da un punto di vista dello spazio su disco o di prestazioni, è potrà considerare l'archiviazione dei file di backup SAP HANA hello in una condivisione NFS.</span><span class="sxs-lookup"><span data-stu-id="0dacc-207">toolessen hello potential impact on hello SAP HANA system from a performance or disk space perspective, one might consider storing hello SAP HANA backup files on an NFS share.</span></span> <span data-ttu-id="0dacc-208">Tecnicamente funziona, ma significa utilizzando una seconda macchina virtuale di Azure come host di hello di hello che condivisioni NFS.</span><span class="sxs-lookup"><span data-stu-id="0dacc-208">Technically it works, but it means using a second Azure VM as hello host of hello NFS share.</span></span> <span data-ttu-id="0dacc-209">Non deve essere di piccole dimensioni di macchina virtuale, a causa di larghezza di banda della rete VM toohello.</span><span class="sxs-lookup"><span data-stu-id="0dacc-209">It should not be a small VM size, due toohello VM network bandwidth.</span></span> <span data-ttu-id="0dacc-210">Sarebbe più utile quindi tooshut verso il basso questo &quot;backup VM&quot; e portarlo solo per l'esecuzione di backup di SAP HANA hello.</span><span class="sxs-lookup"><span data-stu-id="0dacc-210">It would make sense then tooshut down this &quot;backup VM&quot; and only bring it up for executing hello SAP HANA backup.</span></span> <span data-ttu-id="0dacc-211">La scrittura in una condivisione NFS condivisione inserita carico sulla rete di hello e impatto hello sistema SAP HANA, ma semplicemente la gestione di file di backup in un secondo momento nel hello hello &quot;backup VM&quot; non influirebbe sistema SAP HANA hello affatto.</span><span class="sxs-lookup"><span data-stu-id="0dacc-211">Writing on an NFS share puts load on hello network and impacts hello SAP HANA system, but merely managing hello backup files afterwards on hello &quot;backup VM&quot; would not influence hello SAP HANA system at all.</span></span>

![Una condivisione NFS da un'altra macchina virtuale di Azure è stato montato toohello macchina virtuale del server SAP HANA](media/sap-hana-backup-file-level/image035.png)

<span data-ttu-id="0dacc-213">caso d'uso tooverify hello NFS, una condivisione NFS da un'altra macchina virtuale di Azure è stato montato toohello macchina virtuale del server SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="0dacc-213">tooverify hello NFS use case, an NFS share from another Azure VM was mounted toohello SAP HANA server VM.</span></span> <span data-ttu-id="0dacc-214">Non è stata applicata alcuna ottimizzazione NFS particolare.</span><span class="sxs-lookup"><span data-stu-id="0dacc-214">There was no special NFS tuning applied.</span></span>

![Backup di 1 ora e 46 minuti toodo hello impiegato direttamente](media/sap-hana-backup-file-level/image036.png)

<span data-ttu-id="0dacc-216">condivisione NFS Hello è un set di striping veloce, ad esempio hello nel server SAP HANA hello.</span><span class="sxs-lookup"><span data-stu-id="0dacc-216">hello NFS share was a fast stripe set, like hello one on hello SAP HANA server.</span></span> <span data-ttu-id="0dacc-217">Tuttavia, sono stati impiegati 1 ora e hello toodo 46 minuti backup direttamente in una condivisione NFS hello invece di 10 minuti, durante la scrittura di un set di striping locale tooa.</span><span class="sxs-lookup"><span data-stu-id="0dacc-217">Nevertheless, it took 1 hour and 46 minutes toodo hello backup directly on hello NFS share instead of 10 minutes, when writing tooa local stripe set.</span></span>

![In alternativa Hello non è stata molto più rapidamente in 1 ora e 43 minuti](media/sap-hana-backup-file-level/image037.png)

<span data-ttu-id="0dacc-219">condivisioni NFS alternativa Hello di eseguire un set di striping locale tooa backup e copia toohello sul livello del sistema operativo (una semplice **cp - avr** comando) non è stata molto più rapidamente.</span><span class="sxs-lookup"><span data-stu-id="0dacc-219">hello alternative of doing a backup tooa local stripe set and copying toohello NFS share on OS level (a simple **cp -avr** command) wasn't much quicker.</span></span> <span data-ttu-id="0dacc-220">Ha impiegato 1 ora e 43 minuti.</span><span class="sxs-lookup"><span data-stu-id="0dacc-220">It took 1 hour and 43 minutes.</span></span>

<span data-ttu-id="0dacc-221">In modo funziona, ma le prestazioni non è stata utile per test di backup di hello 230 GB.</span><span class="sxs-lookup"><span data-stu-id="0dacc-221">So it works, but performance wasn't good for hello 230-GB backup test.</span></span> <span data-ttu-id="0dacc-222">La situazione dovrebbe essere ancora più grave per più terabyte.</span><span class="sxs-lookup"><span data-stu-id="0dacc-222">It would look even worse for multi terabytes.</span></span>

## <a name="copy-sap-hana-backup-files-tooazure-file-service"></a><span data-ttu-id="0dacc-223">Servizio file tooAzure di SAP HANA i file di backup di copia</span><span class="sxs-lookup"><span data-stu-id="0dacc-223">Copy SAP HANA backup files tooAzure file service</span></span>

<span data-ttu-id="0dacc-224">È possibile toomount condividere un file di Azure all'interno di una macchina virtuale Linux di Azure.</span><span class="sxs-lookup"><span data-stu-id="0dacc-224">It is possible toomount an Azure file share inside an Azure Linux VM.</span></span> <span data-ttu-id="0dacc-225">articolo Hello [come archiviazione di File di Azure con Linux toouse](../../../storage/files/storage-how-to-use-files-linux.md) fornisce informazioni dettagliate su come toodo è.</span><span class="sxs-lookup"><span data-stu-id="0dacc-225">hello article [How toouse Azure File storage with Linux](../../../storage/files/storage-how-to-use-files-linux.md) provides details on how toodo it.</span></span> <span data-ttu-id="0dacc-226">Tenere presente che esiste attualmente un limite di quota di 5 TB di una condivisione di file di Azure e un limite di dimensione del file di 1 TB per ogni file.</span><span class="sxs-lookup"><span data-stu-id="0dacc-226">Keep in mind that there is currently a 5-TB quota limit of one Azure file share, and a file size limit of 1 TB per file.</span></span> <span data-ttu-id="0dacc-227">Per altre informazioni sui limiti di archiviazione, vedere [Obiettivi di scalabilità e prestazioni per Archiviazione di Azure](../../../storage/common/storage-scalability-targets.md).</span><span class="sxs-lookup"><span data-stu-id="0dacc-227">See [Azure Storage Scalability and Performance Targets](../../../storage/common/storage-scalability-targets.md) for information on storage limits.</span></span>

<span data-ttu-id="0dacc-228">I test hanno dimostrato, tuttavia, che il backup di SAP HANA non funziona direttamente con questo tipo di montaggio CIFS.</span><span class="sxs-lookup"><span data-stu-id="0dacc-228">Tests have shown, however, that SAP HANA backup doesn&#39;t currently work directly with this kind of CIFS mount.</span></span> <span data-ttu-id="0dacc-229">Nella [Nota SAP 1820529](https://launchpad.support.sap.com/#/notes/1820529) si dichiara anche che il CIFS non è consigliato.</span><span class="sxs-lookup"><span data-stu-id="0dacc-229">It is also stated in [SAP Note 1820529](https://launchpad.support.sap.com/#/notes/1820529) that CIFS is not recommended.</span></span>

![In questa figura mostra un errore nella finestra di dialogo backup hello in Studio di SAP HANA](media/sap-hana-backup-file-level/image038.png)

<span data-ttu-id="0dacc-231">In questa figura mostra un errore nella finestra di dialogo backup hello in Studio di SAP HANA, durante il tentativo di tooback direttamente tooa condivisione di file di Azure montato CIFS.</span><span class="sxs-lookup"><span data-stu-id="0dacc-231">This figure shows an error in hello backup dialog in SAP HANA Studio, when trying tooback up directly tooa CIFS-mounted Azure file share.</span></span> <span data-ttu-id="0dacc-232">In modo che uno è toodo un backup standard di SAP HANA in un file system di macchina virtuale prima e quindi di file di backup di copia hello da tooAzure sono servizio file.</span><span class="sxs-lookup"><span data-stu-id="0dacc-232">So one has toodo a standard SAP HANA backup into a VM file system first, and then copy hello backup files from there tooAzure file service.</span></span>

![Questa figura mostra che richiedeva 929 secondi toocopy 19 SAP HANA file di backup](media/sap-hana-backup-file-level/image039.png)

<span data-ttu-id="0dacc-234">Questa figura mostra impiegato sui 929 secondi toocopy 19 SAP HANA i file di backup con una dimensione totale di circa condivisione di file di Azure toohello 230 GB.</span><span class="sxs-lookup"><span data-stu-id="0dacc-234">This figure shows that it took about 929 seconds toocopy 19 SAP HANA backup files with a total size of roughly 230 GB toohello Azure file share.</span></span>

![struttura di directory di origine Hello nella macchina virtuale di SAP HANA hello è stato copiato toohello condivisione di file di Azure](media/sap-hana-backup-file-level/image040.png)

<span data-ttu-id="0dacc-236">In questa schermata, si può osservare che hello origine struttura di directory hello SAP HANA VM è stato copiato toohello condivisione di file di Azure: una directory (hana\_backup\_fsl\_15 gb) e 19 singoli file di backup.</span><span class="sxs-lookup"><span data-stu-id="0dacc-236">In this screenshot, one can see that hello source directory structure on hello SAP HANA VM was copied toohello Azure file share: one directory (hana\_backup\_fsl\_15gb) and 19 individual backup files.</span></span>

<span data-ttu-id="0dacc-237">Archiviare i file di backup di SAP HANA nel file di Azure potrebbe essere un'opzione interessano in futuro hello durante i backup dei file di SAP HANA supporta direttamente.</span><span class="sxs-lookup"><span data-stu-id="0dacc-237">Storing SAP HANA backup files on Azure files could be an interesting option in hello future when SAP HANA file backups support it directly.</span></span> <span data-ttu-id="0dacc-238">Quando non è più possibile toomount i file di Azure tramite NFS e limite massimo di quota hello è notevolmente superiore a 5 TB.</span><span class="sxs-lookup"><span data-stu-id="0dacc-238">Or when it becomes possible toomount Azure files via NFS and hello maximum quota limit is considerably higher than 5 TB.</span></span>

## <a name="next-steps"></a><span data-ttu-id="0dacc-239">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="0dacc-239">Next steps</span></span>
* <span data-ttu-id="0dacc-240">La [Guida del backup di SAP HANA in Macchine virtuali di Azure](sap-hana-backup-guide.md) offre una panoramica e informazioni introduttive.</span><span class="sxs-lookup"><span data-stu-id="0dacc-240">[Backup guide for SAP HANA on Azure Virtual Machines](sap-hana-backup-guide.md) gives an overview and information on getting started.</span></span>
* <span data-ttu-id="0dacc-241">[Backup di SAP HANA in base agli snapshot di archiviazione](sap-hana-backup-storage-snapshots.md) descrive hello archiviazione basata su snapshot opzione di backup.</span><span class="sxs-lookup"><span data-stu-id="0dacc-241">[SAP HANA backup based on storage snapshots](sap-hana-backup-storage-snapshots.md) describes hello storage snapshot-based backup option.</span></span>
* <span data-ttu-id="0dacc-242">toolearn tooestablish la disponibilità elevata e piano di ripristino di emergenza di SAP HANA in Azure (istanze di grandi dimensioni), vedere [SAP HANA (istanze di grandi dimensioni) ad alto disponibilità e ripristino di emergenza in Azure](hana-overview-high-availability-disaster-recovery.md).</span><span class="sxs-lookup"><span data-stu-id="0dacc-242">toolearn how tooestablish high availability and plan for disaster recovery of SAP HANA on Azure (large instances), see [SAP HANA (large instances) high availability and disaster recovery on Azure](hana-overview-high-availability-disaster-recovery.md).</span></span>
