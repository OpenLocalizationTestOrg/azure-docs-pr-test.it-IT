---
title: Errore di allocazione del servizio Cloud aaaTroubleshooting | Documenti Microsoft
description: Risoluzione dei problemi relativi ad errori di allocazione quando si distribuiscono servizi Cloud in Azure
services: azure-service-management, cloud-services
documentationcenter: 
author: simonxjx
manager: felixwu
editor: 
tags: top-support-issue
ms.assetid: 529157eb-e4a1-4388-aa2b-09e8b923af74
ms.service: cloud-services
ms.workload: na
ms.tgt_pltfrm: ibiza
ms.devlang: na
ms.topic: article
ms.date: 7/26/2017
ms.author: v-six
ms.openlocfilehash: dfd5cc4663ccc6ed1b27ca9df579182737363b0e
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/06/2017
---
# <a name="troubleshooting-allocation-failure-when-you-deploy-cloud-services-in-azure"></a><span data-ttu-id="32e13-103">Risoluzione dei problemi relativi ad errori di allocazione quando si distribuiscono servizi Cloud in Azure</span><span class="sxs-lookup"><span data-stu-id="32e13-103">Troubleshooting allocation failure when you deploy Cloud Services in Azure</span></span>
## <a name="summary"></a><span data-ttu-id="32e13-104">Riepilogo</span><span class="sxs-lookup"><span data-stu-id="32e13-104">Summary</span></span>
<span data-ttu-id="32e13-105">Quando si distribuisce tooa istanze servizio Cloud o aggiungere istanze del ruolo di lavoro o un nuovo sito web, Microsoft Azure alloca le risorse di calcolo.</span><span class="sxs-lookup"><span data-stu-id="32e13-105">When you deploy instances tooa Cloud Service or add new web or worker role instances, Microsoft Azure allocates compute resources.</span></span> <span data-ttu-id="32e13-106">In alcuni casi, possono verificarsi errori durante l'esecuzione di queste operazioni anche prima di raggiungere i limiti di hello sottoscrizione di Azure.</span><span class="sxs-lookup"><span data-stu-id="32e13-106">You may occasionally receive errors when performing these operations even before you reach hello Azure subscription limits.</span></span> <span data-ttu-id="32e13-107">In questo articolo vengono illustrate le cause di alcune delle comuni errori di allocazione hello hello e suggerisce una possibile risoluzione.</span><span class="sxs-lookup"><span data-stu-id="32e13-107">This article explains hello causes of some of hello common allocation failures and suggests possible remediation.</span></span> <span data-ttu-id="32e13-108">informazioni di Hello potrebbero essere utile anche quando si pianifica la distribuzione hello dei servizi.</span><span class="sxs-lookup"><span data-stu-id="32e13-108">hello information may also be useful when you plan hello deployment of your services.</span></span>

[!INCLUDE [support-disclaimer](../../includes/support-disclaimer.md)]

### <a name="background--how-allocation-works"></a><span data-ttu-id="32e13-109">Informazioni preliminari: come funziona l'allocazione</span><span class="sxs-lookup"><span data-stu-id="32e13-109">Background – How allocation works</span></span>
<span data-ttu-id="32e13-110">server Hello in Data Center di Azure vengono partizionati in cluster.</span><span class="sxs-lookup"><span data-stu-id="32e13-110">hello servers in Azure datacenters are partitioned into clusters.</span></span> <span data-ttu-id="32e13-111">Una nuova richiesta di allocazione del servizio cloud viene eseguita in più cluster.</span><span class="sxs-lookup"><span data-stu-id="32e13-111">A new cloud service allocation request is attempted in multiple clusters.</span></span> <span data-ttu-id="32e13-112">Quando hello prima istanza è tooa distribuiti servizio cloud (in gestione temporanea o produzione), servizio cloud Ottiene cluster tooa bloccati.</span><span class="sxs-lookup"><span data-stu-id="32e13-112">When hello first instance is deployed tooa cloud service(in either staging or production), that cloud service gets pinned tooa cluster.</span></span> <span data-ttu-id="32e13-113">Ulteriormente le distribuzioni per il servizio cloud hello avverrà in hello stesso cluster.</span><span class="sxs-lookup"><span data-stu-id="32e13-113">Any further deployments for hello cloud service will happen in hello same cluster.</span></span> <span data-ttu-id="32e13-114">In questo articolo, si farà riferimento toothis come "aggiunto tooa cluster".</span><span class="sxs-lookup"><span data-stu-id="32e13-114">In this article, we'll refer toothis as "pinned tooa cluster".</span></span> <span data-ttu-id="32e13-115">Diagramma 1 riportato di seguito viene illustrato il caso di hello di un'allocazione normale che viene eseguito un tentativo di più cluster; Diagramma 2 di viene illustrato il caso di hello di un'allocazione tooCluster bloccati che 2 in quanto in cui è hello CS_1 di servizio Cloud esistente è ospitato.</span><span class="sxs-lookup"><span data-stu-id="32e13-115">Diagram 1 below illustrates hello case of a normal allocation which is attempted in multiple clusters; Diagram 2 illustrates hello case of an allocation that's pinned tooCluster 2 because that's where hello existing Cloud Service CS_1 is hosted.</span></span>

![Diagramma di allocazione](./media/cloud-services-allocation-failure/Allocation1.png)

### <a name="why-allocation-failure-happens"></a><span data-ttu-id="32e13-117">Perché si verifica un errore di allocazione</span><span class="sxs-lookup"><span data-stu-id="32e13-117">Why allocation failure happens</span></span>
<span data-ttu-id="32e13-118">Quando una richiesta di allocazione è bloccata tooa cluster, è una maggiore probabilità di esito positivo toofind liberare le risorse in quanto il pool di risorse disponibili hello è limitato tooa cluster.</span><span class="sxs-lookup"><span data-stu-id="32e13-118">When an allocation request is pinned tooa cluster, there's a higher chance of failing toofind free resources since hello available resource pool is limited tooa cluster.</span></span> <span data-ttu-id="32e13-119">Inoltre, se la richiesta di allocazione è bloccata tooa cluster, ma il tipo di hello della risorsa richiesta non è supportato da tale cluster, la richiesta avrà esito negativo anche se dispone di cluster hello risorsa gratuita.</span><span class="sxs-lookup"><span data-stu-id="32e13-119">Furthermore, if your allocation request is pinned tooa cluster but hello type of resource you requested is not supported by that cluster, your request will fail even if hello cluster has free resource.</span></span> <span data-ttu-id="32e13-120">Diagramma 3 riportato di seguito viene illustrato case hello in cui un'allocazione aggiunta non riesce perché non dispone di liberare le risorse cluster solo candidato hello.</span><span class="sxs-lookup"><span data-stu-id="32e13-120">Diagram 3 below illustrates hello case where a pinned allocation fails because hello only candidate cluster does not have free resources.</span></span> <span data-ttu-id="32e13-121">Figura 4 viene illustrata case hello in cui un'allocazione aggiunta non riesce perché non supporta i cluster candidato solo hello hello richiesto dimensioni delle macchine Virtuali, anche se sono presenti cluster hello liberare risorse.</span><span class="sxs-lookup"><span data-stu-id="32e13-121">Diagram 4 illustrates hello case where a pinned allocation fails because hello only candidate cluster does not support hello requested VM size, even though hello cluster has free resources.</span></span>

![Errore di allocazione bloccata](./media/cloud-services-allocation-failure/Allocation2.png)

## <a name="troubleshooting-allocation-failure-for-cloud-services"></a><span data-ttu-id="32e13-123">Risoluzione di problemi di allocazione non riuscita per i servizi cloud</span><span class="sxs-lookup"><span data-stu-id="32e13-123">Troubleshooting allocation failure for cloud services</span></span>
### <a name="error-message"></a><span data-ttu-id="32e13-124">Messaggio di errore</span><span class="sxs-lookup"><span data-stu-id="32e13-124">Error Message</span></span>
<span data-ttu-id="32e13-125">Si può vedere hello seguente messaggio di errore:</span><span class="sxs-lookup"><span data-stu-id="32e13-125">You may see hello following error message:</span></span>

    "Azure operation '{operation id}' failed with code Compute.ConstrainedAllocationFailed. Details: Allocation failed; unable toosatisfy constraints in request. hello requested new service deployment is bound tooan Affinity Group, or it targets a Virtual Network, or there is an existing deployment under this hosted service. Any of these conditions constrains hello new deployment toospecific Azure resources. Please retry later or try reducing hello VM size or number of role instances. Alternatively, if possible, remove hello aforementioned constraints or try deploying tooa different region."

### <a name="common-issues"></a><span data-ttu-id="32e13-126">Problemi comuni</span><span class="sxs-lookup"><span data-stu-id="32e13-126">Common Issues</span></span>
<span data-ttu-id="32e13-127">Di seguito sono hello allocazione scenari comuni che causano un'allocazione richiesta toobe bloccati tooa singolo cluster.</span><span class="sxs-lookup"><span data-stu-id="32e13-127">Here are hello common allocation scenarios that cause an allocation request toobe pinned tooa single cluster.</span></span>

* <span data-ttu-id="32e13-128">La distribuzione tooStaging Slot - se un servizio cloud dispone di una distribuzione in uno slot, quindi hello intero servizio cloud è bloccato tooa specifico cluster.</span><span class="sxs-lookup"><span data-stu-id="32e13-128">Deploying tooStaging Slot - If a cloud service has a deployment in either slot, then hello entire cloud service is pinned tooa specific cluster.</span></span>  <span data-ttu-id="32e13-129">Ciò significa che se una distribuzione già esiste nello slot di produzione hello, quindi una nuova distribuzione di gestione temporanea può solo essere allocata nella stessa cluster come slot di produzione hello hello.</span><span class="sxs-lookup"><span data-stu-id="32e13-129">This means that if a deployment already exists in hello production slot, then a new staging deployment can only be allocated in hello same cluster as hello production slot.</span></span> <span data-ttu-id="32e13-130">Se il cluster hello è quasi capacità, la richiesta hello potrebbe non riuscire.</span><span class="sxs-lookup"><span data-stu-id="32e13-130">If hello cluster is nearing capacity, hello request may fail.</span></span>
* <span data-ttu-id="32e13-131">Scalabilità: aggiunta di nuove istanze tooan esistente-servizio cloud deve allocare in hello stesso cluster.</span><span class="sxs-lookup"><span data-stu-id="32e13-131">Scaling - Adding new instances tooan existing cloud service must allocate in hello same cluster.</span></span>  <span data-ttu-id="32e13-132">Le piccole richieste di ridimensionamento in genere possono essere allocate, ma non è sempre possibile.</span><span class="sxs-lookup"><span data-stu-id="32e13-132">Small scaling requests can usually be allocated, but not always.</span></span> <span data-ttu-id="32e13-133">Se il cluster hello è quasi capacità, la richiesta hello potrebbe non riuscire.</span><span class="sxs-lookup"><span data-stu-id="32e13-133">If hello cluster is nearing capacity, hello request may fail.</span></span>
* <span data-ttu-id="32e13-134">Gruppo di affinità - un nuovo servizio cloud vuoto tooan di distribuzione può essere allocato dall'infrastruttura di hello in un cluster in tale area, a meno che il servizio di cloud hello è il gruppo di affinità tooan bloccati.</span><span class="sxs-lookup"><span data-stu-id="32e13-134">Affinity Group - A new deployment tooan empty cloud service can be allocated by hello fabric in any cluster in that region, unless hello cloud service is pinned tooan affinity group.</span></span> <span data-ttu-id="32e13-135">Le distribuzioni toohello verrà ritentato stesso gruppo di affinità hello dello stesso cluster.</span><span class="sxs-lookup"><span data-stu-id="32e13-135">Deployments toohello same affinity group will be attempted on hello same cluster.</span></span> <span data-ttu-id="32e13-136">Se il cluster hello è quasi capacità, la richiesta hello potrebbe non riuscire.</span><span class="sxs-lookup"><span data-stu-id="32e13-136">If hello cluster is nearing capacity, hello request may fail.</span></span>
* <span data-ttu-id="32e13-137">Gruppo di affinità di rete virtuale - reti virtuali precedenti sono stati collegati tooaffinity gruppi anziché aree e i servizi cloud in queste reti virtuali sarebbe toohello aggiunto gruppo di affinità cluster.</span><span class="sxs-lookup"><span data-stu-id="32e13-137">Affinity Group vNet - Older Virtual Networks were tied tooaffinity groups instead of regions, and cloud services in these Virtual Networks would be pinned toohello affinity group cluster.</span></span> <span data-ttu-id="32e13-138">Tentativo di tipo toothis le distribuzioni di rete virtuale nel cluster hello bloccato.</span><span class="sxs-lookup"><span data-stu-id="32e13-138">Deployments toothis type of virtual network will be attempted on hello pinned cluster.</span></span> <span data-ttu-id="32e13-139">Se il cluster hello è quasi capacità, la richiesta hello potrebbe non riuscire.</span><span class="sxs-lookup"><span data-stu-id="32e13-139">If hello cluster is nearing capacity, hello request may fail.</span></span>

## <a name="solutions"></a><span data-ttu-id="32e13-140">Soluzioni</span><span class="sxs-lookup"><span data-stu-id="32e13-140">Solutions</span></span>
1. <span data-ttu-id="32e13-141">Ridistribuzione tooa nuovo servizio cloud, questa soluzione è probabilmente toobe più efficace in quanto consente di hello piattaforma toochoose di tutti i cluster in tale area.</span><span class="sxs-lookup"><span data-stu-id="32e13-141">Redeploy tooa new cloud service - This solution is likely toobe most successful as it allows hello platform toochoose from all clusters in that region.</span></span>

   * <span data-ttu-id="32e13-142">Distribuire il carico di lavoro hello tooa nuovo servizio cloud</span><span class="sxs-lookup"><span data-stu-id="32e13-142">Deploy hello workload tooa new cloud service</span></span>  
   * <span data-ttu-id="32e13-143">Aggiornare hello CNAME o un record toopoint traffico toohello nuovo servizio cloud</span><span class="sxs-lookup"><span data-stu-id="32e13-143">Update hello CNAME or A record toopoint traffic toohello new cloud service</span></span>
   * <span data-ttu-id="32e13-144">Una volta zero il traffico verrà toohello vecchio sito, è possibile eliminare il servizio cloud precedente di hello.</span><span class="sxs-lookup"><span data-stu-id="32e13-144">Once zero traffic is going toohello old site, you can delete hello old cloud service.</span></span> <span data-ttu-id="32e13-145">Questa soluzione non deve causare tempi di inattività.</span><span class="sxs-lookup"><span data-stu-id="32e13-145">This solution should incur zero downtime.</span></span>
2. <span data-ttu-id="32e13-146">Eliminazione di produzione e gli slot di gestione temporanea: questa soluzione verrà mantenuto il nome DNS esistente, ma verrà applicazione tooyour tempi di inattività.</span><span class="sxs-lookup"><span data-stu-id="32e13-146">Delete both production and staging slots - This solution will preserve your existing DNS name, but will cause downtime tooyour application.</span></span>

   * <span data-ttu-id="32e13-147">Eliminare la produzione hello e slot di un servizio cloud esistente di gestione temporanea in modo che il servizio di cloud hello è vuoto, quindi</span><span class="sxs-lookup"><span data-stu-id="32e13-147">Delete hello production and staging slots of an existing cloud service so that hello cloud service is empty, and then</span></span>
   * <span data-ttu-id="32e13-148">Creare una nuova distribuzione nel servizio cloud esistente hello.</span><span class="sxs-lookup"><span data-stu-id="32e13-148">Create a new deployment in hello existing cloud service.</span></span> <span data-ttu-id="32e13-149">Si tenterà nuovamente tooallocation in tutti i cluster in area hello.</span><span class="sxs-lookup"><span data-stu-id="32e13-149">This will re-attempt tooallocation on all clusters in hello region.</span></span> <span data-ttu-id="32e13-150">Assicurarsi di servizio cloud hello non è il gruppo di affinità collegati tooan.</span><span class="sxs-lookup"><span data-stu-id="32e13-150">Ensure hello cloud service is not tied tooan affinity group.</span></span>
3. <span data-ttu-id="32e13-151">Indirizzo IP riservato - questa soluzione consentirà di preservare l'IP esistenti indirizzo, ma verrà applicazione tooyour tempi di inattività.</span><span class="sxs-lookup"><span data-stu-id="32e13-151">Reserved IP -  This solution will preserve your existing IP address, but will cause downtime tooyour application.</span></span>  

   * <span data-ttu-id="32e13-152">Creare un ReservedIP per la distribuzione esistente utilizzando Powershell</span><span class="sxs-lookup"><span data-stu-id="32e13-152">Create a ReservedIP for your existing deployment using Powershell</span></span>

     ```
     New-AzureReservedIP -ReservedIPName {new reserved IP name} -Location {location} -ServiceName {existing service name}
     ```
   * <span data-ttu-id="32e13-153">Seguire #2 di sopra, rendendo toospecify che hello nuovo indirizzo IP riservato in CSCFG del servizio hello.</span><span class="sxs-lookup"><span data-stu-id="32e13-153">Follow #2 from above, making sure toospecify hello new ReservedIP in hello service's CSCFG.</span></span>
4. <span data-ttu-id="32e13-154">Rimuovere il gruppo di affinità per le nuove distribuzioni: i gruppi di affinità non sono più consigliati.</span><span class="sxs-lookup"><span data-stu-id="32e13-154">Remove affinity group for new deployments - Affinity Groups are no longer recommended.</span></span> <span data-ttu-id="32e13-155">Seguire i passaggi per #1 sopra toodeploy un nuovo servizio cloud.</span><span class="sxs-lookup"><span data-stu-id="32e13-155">Follow steps for #1 above toodeploy a new cloud service.</span></span> <span data-ttu-id="32e13-156">Assicurarsi che il servizio cloud non sia in un gruppo di affinità.</span><span class="sxs-lookup"><span data-stu-id="32e13-156">Ensure cloud service is not in an affinity group.</span></span>
5. <span data-ttu-id="32e13-157">Convertire tooa internazionali rete virtuale, vedere la sezione [come toomigrate da gruppi di affinità tooa internazionali rete virtuale (VNet)](../virtual-network/virtual-networks-migrate-to-regional-vnet.md).</span><span class="sxs-lookup"><span data-stu-id="32e13-157">Convert tooa Regional Virtual Network - See [How toomigrate from Affinity Groups tooa Regional Virtual Network (VNet)](../virtual-network/virtual-networks-migrate-to-regional-vnet.md).</span></span>
