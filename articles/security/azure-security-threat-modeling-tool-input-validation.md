---
title: 'Convalida dell''input: Microsoft Threat Modeling Tool - Azure | Microsoft Docs'
description: Procedure di mitigazione delle minacce esposte in Threat Modeling Tool
services: security
documentationcenter: na
author: RodSan
manager: RodSan
editor: RodSan
ms.assetid: na
ms.service: security
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 08/17/2017
ms.author: rodsan
ms.openlocfilehash: b7ce6f353cf8cf48d5fb038ee77b0d3fdae16fb7
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/29/2017
---
# <a name="security-frame-input-validation--mitigations"></a><span data-ttu-id="a8300-103">Infrastruttura di sicurezza: convalida dell'input - Procedure di mitigazione</span><span class="sxs-lookup"><span data-stu-id="a8300-103">Security Frame: Input Validation | Mitigations</span></span> 
| <span data-ttu-id="a8300-104">Prodotto o servizio</span><span class="sxs-lookup"><span data-stu-id="a8300-104">Product/Service</span></span> | <span data-ttu-id="a8300-105">Articolo</span><span class="sxs-lookup"><span data-stu-id="a8300-105">Article</span></span> |
| --------------- | ------- |
| <span data-ttu-id="a8300-106">**Applicazione Web**</span><span class="sxs-lookup"><span data-stu-id="a8300-106">**Web Application**</span></span> | <ul><li>[<span data-ttu-id="a8300-107">Disabilitare gli script XSLT per tutte le trasformazioni con fogli di stile non attendibili</span><span class="sxs-lookup"><span data-stu-id="a8300-107">Disable XSLT scripting for all transforms using untrusted style sheets</span></span>](#disable-xslt)</li><li>[<span data-ttu-id="a8300-108">Verificare che ogni pagina che potrebbe includere contenuti controllabili dall'utente rifiuti esplicitamente l'analisi MIME automatica</span><span class="sxs-lookup"><span data-stu-id="a8300-108">Ensure that each page that could contain user controllable content opts out of automatic MIME sniffing</span></span>](#out-sniffing)</li><li>[<span data-ttu-id="a8300-109">Applicare la protezione avanzata o la disabilitazione della risoluzione di entità XML</span><span class="sxs-lookup"><span data-stu-id="a8300-109">Harden or Disable XML Entity Resolution</span></span>](#xml-resolution)</li><li>[<span data-ttu-id="a8300-110">Verifica della canonizzazione degli URL nelle applicazioni che utilizzano http.sys</span><span class="sxs-lookup"><span data-stu-id="a8300-110">Applications utilizing http.sys perform URL canonicalization verification</span></span>](#app-verification)</li><li>[<span data-ttu-id="a8300-111">Verificare la presenza dei controlli appropriati quando si accettano file dagli utenti</span><span class="sxs-lookup"><span data-stu-id="a8300-111">Ensure appropriate controls are in place when accepting files from users</span></span>](#controls-users)</li><li>[<span data-ttu-id="a8300-112">Verificare che nell'applicazione Web vengano usati parametri indipendenti dai tipi per l'accesso ai dati</span><span class="sxs-lookup"><span data-stu-id="a8300-112">Ensure that type-safe parameters are used in Web Application for data access</span></span>](#typesafe)</li><li>[<span data-ttu-id="a8300-113">Usare classi di associazione di modelli separate o elenchi di filtri di associazione per prevenire la vulnerabilità dell'assegnazione di massa in MVC</span><span class="sxs-lookup"><span data-stu-id="a8300-113">Use separate model binding classes or binding filter lists to prevent MVC mass assignment vulnerability</span></span>](#binding-mvc)</li><li>[<span data-ttu-id="a8300-114">Codificare l'output Web non attendibile prima del rendering</span><span class="sxs-lookup"><span data-stu-id="a8300-114">Encode untrusted web output prior to rendering</span></span>](#rendering)</li><li>[<span data-ttu-id="a8300-115">Eseguire la convalida dell'input e applicare filtri a tutte le proprietà del modello di tipo stringa</span><span class="sxs-lookup"><span data-stu-id="a8300-115">Perform input validation and filtering on all string type Model properties</span></span>](#typemodel)</li><li>[<span data-ttu-id="a8300-116">Applicazione della purificazione nei campi modulo che accettano tutti i caratteri, ad esempio un editor di testo RTF</span><span class="sxs-lookup"><span data-stu-id="a8300-116">Sanitization should be applied on form fields that accept all characters, e.g, rich text editor</span></span>](#richtext)</li><li>[<span data-ttu-id="a8300-117">Non assegnare elementi DOM a sink senza codifica incorporata</span><span class="sxs-lookup"><span data-stu-id="a8300-117">Do not assign DOM elements to sinks that do not have inbuilt encoding</span></span>](#inbuilt-encode)</li><li>[<span data-ttu-id="a8300-118">Convalidare come chiusi o sicuri tutti i reindirizzamenti nell'applicazione</span><span class="sxs-lookup"><span data-stu-id="a8300-118">Validate all redirects within the application are closed or done safely</span></span>](#redirect-safe)</li><li>[<span data-ttu-id="a8300-119">Implementare la convalida dell'input in un tutti i parametri di tipo stringa accettati dai metodi del controller</span><span class="sxs-lookup"><span data-stu-id="a8300-119">Implement input validation on all string type parameters accepted by Controller methods</span></span>](#string-method)</li><li>[<span data-ttu-id="a8300-120">Impostare il limite massimo di timeout per l'elaborazione di espressioni regolari per impedire attacchi DoS causati da espressioni regolari errate</span><span class="sxs-lookup"><span data-stu-id="a8300-120">Set upper limit timeout for regular expression processing to prevent DoS due to bad regular expressions</span></span>](#dos-expression)</li><li>[<span data-ttu-id="a8300-121">Evitare di usare Html.Raw nelle visualizzazioni Razor</span><span class="sxs-lookup"><span data-stu-id="a8300-121">Avoid using Html.Raw in Razor views</span></span>](#html-razor)</li></ul> | 
| <span data-ttu-id="a8300-122">**Database**</span><span class="sxs-lookup"><span data-stu-id="a8300-122">**Database**</span></span> | <ul><li>[<span data-ttu-id="a8300-123">Non usare query dinamiche nelle stored procedure</span><span class="sxs-lookup"><span data-stu-id="a8300-123">Do not use dynamic queries in stored procedures</span></span>](#stored-proc)</li></ul> |
| <span data-ttu-id="a8300-124">**API Web**</span><span class="sxs-lookup"><span data-stu-id="a8300-124">**Web API**</span></span> | <ul><li>[<span data-ttu-id="a8300-125">Verificare l'esecuzione della convalida dei modelli nei metodi di API Web</span><span class="sxs-lookup"><span data-stu-id="a8300-125">Ensure that model validation is done on Web API methods</span></span>](#validation-api)</li><li>[<span data-ttu-id="a8300-126">Implementare la convalida dell'input in tutti i parametri di tipo stringa accettati dai metodi di API Web</span><span class="sxs-lookup"><span data-stu-id="a8300-126">Implement input validation on all string type parameters accepted by Web API methods</span></span>](#string-api)</li><li>[<span data-ttu-id="a8300-127">Verificare che nell'API Web vengano usati parametri indipendenti dai tipi per l'accesso ai dati</span><span class="sxs-lookup"><span data-stu-id="a8300-127">Ensure that type-safe parameters are used in Web API for data access</span></span>](#typesafe-api)</li></ul> | 
| <span data-ttu-id="a8300-128">**Azure Document DB**</span><span class="sxs-lookup"><span data-stu-id="a8300-128">**Azure Document DB**</span></span> | <ul><li>[<span data-ttu-id="a8300-129">Usare query SQL con parametri per DocumentDB</span><span class="sxs-lookup"><span data-stu-id="a8300-129">Use parametrized SQL queries for DocumentDB</span></span>](#sql-docdb)</li></ul> | 
| <span data-ttu-id="a8300-130">**WCF**</span><span class="sxs-lookup"><span data-stu-id="a8300-130">**WCF**</span></span> | <ul><li>[<span data-ttu-id="a8300-131">WCF: convalida dell'input tramite l'associazione allo schema</span><span class="sxs-lookup"><span data-stu-id="a8300-131">WCF Input validation through Schema binding</span></span>](#schema-binding)</li><li>[<span data-ttu-id="a8300-132">WCF: convalida dell'input tramite controlli parametro</span><span class="sxs-lookup"><span data-stu-id="a8300-132">WCF- Input validation through Parameter Inspectors</span></span>](#parameters)</li></ul> |

## <span data-ttu-id="a8300-133"><a id="disable-xslt"></a>Disabilitare gli script XSLT per tutte le trasformazioni con fogli di stile non attendibili</span><span class="sxs-lookup"><span data-stu-id="a8300-133"><a id="disable-xslt"></a>Disable XSLT scripting for all transforms using untrusted style sheets</span></span>

| <span data-ttu-id="a8300-134">Titolo</span><span class="sxs-lookup"><span data-stu-id="a8300-134">Title</span></span>                   | <span data-ttu-id="a8300-135">Dettagli</span><span class="sxs-lookup"><span data-stu-id="a8300-135">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="a8300-136">**Componente**</span><span class="sxs-lookup"><span data-stu-id="a8300-136">**Component**</span></span>               | <span data-ttu-id="a8300-137">Applicazione Web.</span><span class="sxs-lookup"><span data-stu-id="a8300-137">Web Application</span></span> | 
| <span data-ttu-id="a8300-138">**Fase SDL**</span><span class="sxs-lookup"><span data-stu-id="a8300-138">**SDL Phase**</span></span>               | <span data-ttu-id="a8300-139">Compilare</span><span class="sxs-lookup"><span data-stu-id="a8300-139">Build</span></span> |  
| <span data-ttu-id="a8300-140">**Tecnologie applicabili**</span><span class="sxs-lookup"><span data-stu-id="a8300-140">**Applicable Technologies**</span></span> | <span data-ttu-id="a8300-141">Generico</span><span class="sxs-lookup"><span data-stu-id="a8300-141">Generic</span></span> |
| <span data-ttu-id="a8300-142">**Attributes (Attributi) (Attributi)**</span><span class="sxs-lookup"><span data-stu-id="a8300-142">**Attributes**</span></span>              | <span data-ttu-id="a8300-143">N/D</span><span class="sxs-lookup"><span data-stu-id="a8300-143">N/A</span></span>  |
| <span data-ttu-id="a8300-144">**Riferimenti**</span><span class="sxs-lookup"><span data-stu-id="a8300-144">**References**</span></span>              | <span data-ttu-id="a8300-145">[Sicurezza XSLT ](https://msdn.microsoft.com/library/ms763800(v=vs.85).aspx), [Proprietà XsltSettings.EnableScript](http://msdn.microsoft.com/library/system.xml.xsl.xsltsettings.enablescript.aspx)</span><span class="sxs-lookup"><span data-stu-id="a8300-145">[XSLT Security](https://msdn.microsoft.com/library/ms763800(v=vs.85).aspx), [XsltSettings.EnableScript Property](http://msdn.microsoft.com/library/system.xml.xsl.xsltsettings.enablescript.aspx)</span></span> |
| <span data-ttu-id="a8300-146">**Passaggi**</span><span class="sxs-lookup"><span data-stu-id="a8300-146">**Steps**</span></span> | <span data-ttu-id="a8300-147">XSLT supporta l'inserimento di script all'interno dei fogli di stile con l'elemento `<msxml:script>`.</span><span class="sxs-lookup"><span data-stu-id="a8300-147">XSLT supports scripting inside style sheets using the `<msxml:script>` element.</span></span> <span data-ttu-id="a8300-148">Ciò consente di usare funzioni personalizzate in una trasformazione XSLT.</span><span class="sxs-lookup"><span data-stu-id="a8300-148">This allows custom functions to be used in an XSLT transformation.</span></span> <span data-ttu-id="a8300-149">Lo script viene eseguito nel contesto del processo che esegue la trasformazione.</span><span class="sxs-lookup"><span data-stu-id="a8300-149">The script is executed under the context of the process performing the transform.</span></span> <span data-ttu-id="a8300-150">Lo script XSLT può essere disabilitato in un ambiente non attendibile per impedire l'esecuzione di codice non attendibile.</span><span class="sxs-lookup"><span data-stu-id="a8300-150">XSLT script must be disabled when in an untrusted environment to prevent execution of untrusted code.</span></span> <span data-ttu-id="a8300-151">*Se si usa .NET*, gli script XSLT sono disabilitati per impostazione predefinita. È tuttavia necessario verificare che non siano stati abilitati in modo esplicito tramite la proprietà `XsltSettings.EnableScript`.</span><span class="sxs-lookup"><span data-stu-id="a8300-151">*If using .NET:* XSLT scripting is disabled by default; however, you must ensure that it has not been explicitly enabled through the `XsltSettings.EnableScript` property.</span></span>|

### <a name="example"></a><span data-ttu-id="a8300-152">Esempio</span><span class="sxs-lookup"><span data-stu-id="a8300-152">Example</span></span> 

```C#
XsltSettings settings = new XsltSettings();
settings.EnableScript = true; // WRONG: THIS SHOULD BE SET TO false
```

### <a name="example"></a><span data-ttu-id="a8300-153">Esempio</span><span class="sxs-lookup"><span data-stu-id="a8300-153">Example</span></span>
<span data-ttu-id="a8300-154">Se si usa MSXML 6.0, gli script XSLT sono disabilitati per impostazione predefinita. È tuttavia necessario verificare che non siano stati abilitati in modo esplicito tramite la proprietà AllowXsltScript dell'oggetto DOM XML.</span><span class="sxs-lookup"><span data-stu-id="a8300-154">If you are using using MSXML 6.0, XSLT scripting is disabled by default; however, you must ensure that it has not been explicitly enabled through the XML DOM object property AllowXsltScript.</span></span> 

```C#
doc.setProperty("AllowXsltScript", true); // WRONG: THIS SHOULD BE SET TO false
```

### <a name="example"></a><span data-ttu-id="a8300-155">Esempio</span><span class="sxs-lookup"><span data-stu-id="a8300-155">Example</span></span>
<span data-ttu-id="a8300-156">Se si usa MSXML 5 o versione inferiore, gli script XSLT sono abilitati per impostazione predefinita e devono essere disabilitati in modo esplicito.</span><span class="sxs-lookup"><span data-stu-id="a8300-156">If you are using MSXML 5 or below, XSLT scripting is enabled by default and you must explicitly disable it.</span></span> <span data-ttu-id="a8300-157">Impostare la proprietà AllowXsltScript dell'oggetto DOM XML su false.</span><span class="sxs-lookup"><span data-stu-id="a8300-157">Set the XML DOM object property AllowXsltScript to false.</span></span> 

```C#
doc.setProperty("AllowXsltScript", false); // CORRECT. Setting to false disables XSLT scripting.
```

## <span data-ttu-id="a8300-158"><a id="out-sniffing"></a>Verificare che ogni pagina che potrebbe includere contenuti controllabili dall'utente rifiuti esplicitamente l'analisi MIME automatica</span><span class="sxs-lookup"><span data-stu-id="a8300-158"><a id="out-sniffing"></a>Ensure that each page that could contain user controllable content opts out of automatic MIME sniffing</span></span>

| <span data-ttu-id="a8300-159">Titolo</span><span class="sxs-lookup"><span data-stu-id="a8300-159">Title</span></span>                   | <span data-ttu-id="a8300-160">Dettagli</span><span class="sxs-lookup"><span data-stu-id="a8300-160">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="a8300-161">**Componente**</span><span class="sxs-lookup"><span data-stu-id="a8300-161">**Component**</span></span>               | <span data-ttu-id="a8300-162">Applicazione Web.</span><span class="sxs-lookup"><span data-stu-id="a8300-162">Web Application</span></span> | 
| <span data-ttu-id="a8300-163">**Fase SDL**</span><span class="sxs-lookup"><span data-stu-id="a8300-163">**SDL Phase**</span></span>               | <span data-ttu-id="a8300-164">Compilare</span><span class="sxs-lookup"><span data-stu-id="a8300-164">Build</span></span> |  
| <span data-ttu-id="a8300-165">**Tecnologie applicabili**</span><span class="sxs-lookup"><span data-stu-id="a8300-165">**Applicable Technologies**</span></span> | <span data-ttu-id="a8300-166">Generico</span><span class="sxs-lookup"><span data-stu-id="a8300-166">Generic</span></span> |
| <span data-ttu-id="a8300-167">**Attributes (Attributi) (Attributi)**</span><span class="sxs-lookup"><span data-stu-id="a8300-167">**Attributes**</span></span>              | <span data-ttu-id="a8300-168">N/D</span><span class="sxs-lookup"><span data-stu-id="a8300-168">N/A</span></span>  |
| <span data-ttu-id="a8300-169">**Riferimenti**</span><span class="sxs-lookup"><span data-stu-id="a8300-169">**References**</span></span>              | <span data-ttu-id="a8300-170">[IE8 Security Part V: Comprehensive Protection](http://blogs.msdn.com/ie/archive/2008/07/02/ie8-security-part-v-comprehensive-protection.aspx) (Sicurezza di IE8 parte V: protezione completa)</span><span class="sxs-lookup"><span data-stu-id="a8300-170">[IE8 Security Part V - Comprehensive Protection](http://blogs.msdn.com/ie/archive/2008/07/02/ie8-security-part-v-comprehensive-protection.aspx)</span></span>  |
| <span data-ttu-id="a8300-171">**Passaggi**</span><span class="sxs-lookup"><span data-stu-id="a8300-171">**Steps**</span></span> | <p><span data-ttu-id="a8300-172">Per ogni pagina che potrebbe includere contenuti controllabili dall'utente, è necessario usare l'intestazione HTTP `X-Content-Type-Options:nosniff`.</span><span class="sxs-lookup"><span data-stu-id="a8300-172">For each page that could contain user controllable content, you must use the HTTP Header `X-Content-Type-Options:nosniff`.</span></span> <span data-ttu-id="a8300-173">Per rispettare questo requisito, è possibile impostare l'intestazione necessaria pagina per pagina solo per le pagine che potrebbero includere contenuti controllabili dall'utente oppure eseguire l'impostazione a livello globale per tutte le pagine nell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="a8300-173">To comply with this requirement, you can either set the required header page by page for only those pages that might contain user-controllable content, or you can set it globally for all pages in the application.</span></span></p><p><span data-ttu-id="a8300-174">A ogni tipo di file fornito da un server Web è associato un [tipo MIME](http://en.wikipedia.org/wiki/Mime_type) (denominato anche *content-type*) che descrive la natura del contenuto (immagine, testo, applicazione e così via).</span><span class="sxs-lookup"><span data-stu-id="a8300-174">Each type of file delivered from a web server has an associated [MIME type](http://en.wikipedia.org/wiki/Mime_type) (also called a *content-type*) that describes the nature of the content (that is, image, text, application, etc.)</span></span></p><p><span data-ttu-id="a8300-175">L'intestazione X-Content-Type-Options è un'intestazione HTTP che consente agli sviluppatori di specificare che il contenuto non deve essere sottoposto ad analisi MIME.</span><span class="sxs-lookup"><span data-stu-id="a8300-175">The X-Content-Type-Options header is an HTTP header that allows developers to specify that their content should not be MIME-sniffed.</span></span> <span data-ttu-id="a8300-176">Questa intestazione è progettata per mitigare gli attacchi basati sull'analisi MIME.</span><span class="sxs-lookup"><span data-stu-id="a8300-176">This header is designed to mitigate MIME-Sniffing attacks.</span></span> <span data-ttu-id="a8300-177">Il supporto per questa intestazione è stato aggiunto in Internet Explorer 8 (IE8).</span><span class="sxs-lookup"><span data-stu-id="a8300-177">Support for this header was added in Internet Explorer 8 (IE8)</span></span></p><p><span data-ttu-id="a8300-178">Solo gli utenti di Internet Explorer 8 (IE8) potranno usufruire di X-Content-Type-Options.</span><span class="sxs-lookup"><span data-stu-id="a8300-178">Only users of Internet Explorer 8 (IE8) will benefit from X-Content-Type-Options.</span></span> <span data-ttu-id="a8300-179">Le versioni precedenti di Internet Explorer attualmente non rispettano l'intestazione X-Content-Type-Options.</span><span class="sxs-lookup"><span data-stu-id="a8300-179">Previous versions of Internet Explorer do not currently respect the X-Content-Type-Options header</span></span></p><p><span data-ttu-id="a8300-180">Internet Explorer 8 e le versioni successive sono gli unici browser principali che implementano una funzionalità di rifiuto esplicito dell'analisi MIME.</span><span class="sxs-lookup"><span data-stu-id="a8300-180">Internet Explorer 8 (and later) are the only major browsers to implement a MIME-sniffing opt-out feature.</span></span> <span data-ttu-id="a8300-181">Se e quando gli altri browser principali (Firefox, Safari e Chrome) implementeranno funzionalità simili, questa raccomandazione verrà aggiornata per includere anche la sintassi per tali browser.</span><span class="sxs-lookup"><span data-stu-id="a8300-181">If and when other major browsers (Firefox, Safari, Chrome) implement similar features, this recommendation will be updated to include syntax for those browsers as well</span></span></p>|

### <a name="example"></a><span data-ttu-id="a8300-182">Esempio</span><span class="sxs-lookup"><span data-stu-id="a8300-182">Example</span></span>
<span data-ttu-id="a8300-183">Per abilitare l'intestazione necessaria a livello globale per tutte le pagine nell'applicazione, eseguire una di queste operazioni:</span><span class="sxs-lookup"><span data-stu-id="a8300-183">To enable the required header globally for all pages in the application, you can do one of the following:</span></span> 

* <span data-ttu-id="a8300-184">Aggiungere l'intestazione nel file web.config se l'applicazione è ospitata da Internet Information Services (IIS) 7</span><span class="sxs-lookup"><span data-stu-id="a8300-184">Add the header in the web.config file if the application is hosted by Internet Information Services (IIS) 7</span></span> 

```
<system.webServer> 
  <httpProtocol> 
    <customHeaders> 
      <add name=""X-Content-Type-Options"" value=""nosniff""/>
    </customHeaders>
  </httpProtocol>
</system.webServer> 
```

* <span data-ttu-id="a8300-185">Aggiungere l'intestazione tramite Application\_BeginRequest globale</span><span class="sxs-lookup"><span data-stu-id="a8300-185">Add the header through the global Application\_BeginRequest</span></span> 

``` 
void Application_BeginRequest(object sender, EventArgs e)
{
  this.Response.Headers[""X-Content-Type-Options""] = ""nosniff"";
} 
```

* <span data-ttu-id="a8300-186">Implementare un modulo HTTP personalizzato</span><span class="sxs-lookup"><span data-stu-id="a8300-186">Implement custom HTTP module</span></span> 

``` 
public class XContentTypeOptionsModule : IHttpModule 
  {
    #region IHttpModule Members 
    public void Dispose() 
    { 

    } 
    public void Init(HttpApplication context)
    { 
      context.PreSendRequestHeaders += newEventHandler(context_PreSendRequestHeaders); 
    } 
    #endregion 
    void context_PreSendRequestHeaders(object sender, EventArgs e) 
      { 
        HttpApplication application = sender as HttpApplication; 
        if (application == null) 
          return; 
        if (application.Response.Headers[""X-Content-Type-Options ""] != null) 
          return; 
        application.Response.Headers.Add(""X-Content-Type-Options "", ""nosniff""); 
      } 
  } 

``` 

* <span data-ttu-id="a8300-187">È possibile abilitare l'intestazione necessaria solo per pagine specifiche aggiungendola a singole risposte:</span><span class="sxs-lookup"><span data-stu-id="a8300-187">You can enable the required header only for specific pages by adding it to individual responses:</span></span> 

```
this.Response.Headers[""X-Content-Type-Options""] = ""nosniff""; 
``` 

## <span data-ttu-id="a8300-188"><a id="xml-resolution"></a>Applicare la protezione avanzata o la disabilitazione della risoluzione di entità XML</span><span class="sxs-lookup"><span data-stu-id="a8300-188"><a id="xml-resolution"></a>Harden or Disable XML Entity Resolution</span></span>

| <span data-ttu-id="a8300-189">Titolo</span><span class="sxs-lookup"><span data-stu-id="a8300-189">Title</span></span>                   | <span data-ttu-id="a8300-190">Dettagli</span><span class="sxs-lookup"><span data-stu-id="a8300-190">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="a8300-191">**Componente**</span><span class="sxs-lookup"><span data-stu-id="a8300-191">**Component**</span></span>               | <span data-ttu-id="a8300-192">Applicazione Web.</span><span class="sxs-lookup"><span data-stu-id="a8300-192">Web Application</span></span> | 
| <span data-ttu-id="a8300-193">**Fase SDL**</span><span class="sxs-lookup"><span data-stu-id="a8300-193">**SDL Phase**</span></span>               | <span data-ttu-id="a8300-194">Compilare</span><span class="sxs-lookup"><span data-stu-id="a8300-194">Build</span></span> |  
| <span data-ttu-id="a8300-195">**Tecnologie applicabili**</span><span class="sxs-lookup"><span data-stu-id="a8300-195">**Applicable Technologies**</span></span> | <span data-ttu-id="a8300-196">Generico</span><span class="sxs-lookup"><span data-stu-id="a8300-196">Generic</span></span> |
| <span data-ttu-id="a8300-197">**Attributes (Attributi) (Attributi)**</span><span class="sxs-lookup"><span data-stu-id="a8300-197">**Attributes**</span></span>              | <span data-ttu-id="a8300-198">N/D</span><span class="sxs-lookup"><span data-stu-id="a8300-198">N/A</span></span>  |
| <span data-ttu-id="a8300-199">**Riferimenti**</span><span class="sxs-lookup"><span data-stu-id="a8300-199">**References**</span></span>              | <span data-ttu-id="a8300-200">[Espansione di entità XML](http://capec.mitre.org/data/definitions/197.html), [Attacchi Denial of Service e difese in XML](http://msdn.microsoft.com/magazine/ee335713.aspx), [Cenni preliminari sulla sicurezza MSXML](http://msdn.microsoft.com/library/ms754611(v=VS.85).aspx), [Procedure consigliate per la protezione del codice MSXML](http://msdn.microsoft.com/library/ms759188(VS.85).aspx), [Informazioni di riferimento sul protocollo NSXMLParserDelegate](http://developer.apple.com/library/ios/#documentation/cocoa/reference/NSXMLParserDelegate_Protocol/Reference/Reference.html), [Risoluzione di riferimenti esterni](https://msdn.microsoft.com/library/5fcwybb2.aspx)</span><span class="sxs-lookup"><span data-stu-id="a8300-200">[XML Entity Expansion](http://capec.mitre.org/data/definitions/197.html), [XML Denial of Service Attacks and Defenses](http://msdn.microsoft.com/magazine/ee335713.aspx), [MSXML Security Overview](http://msdn.microsoft.com/library/ms754611(v=VS.85).aspx), [Best Practices for Securing MSXML Code](http://msdn.microsoft.com/library/ms759188(VS.85).aspx), [NSXMLParserDelegate Protocol Reference](http://developer.apple.com/library/ios/#documentation/cocoa/reference/NSXMLParserDelegate_Protocol/Reference/Reference.html), [Resolving External References](https://msdn.microsoft.com/library/5fcwybb2.aspx)</span></span> |
| <span data-ttu-id="a8300-201">**Passaggi**</span><span class="sxs-lookup"><span data-stu-id="a8300-201">**Steps**</span></span>| <p><span data-ttu-id="a8300-202">Nonostante non sia largamente usata, esiste una funzionalità di XML che consente al parser XML di espandere macro entità con valori definiti all'interno del documento stesso o da origini esterne.</span><span class="sxs-lookup"><span data-stu-id="a8300-202">Although it is not widely used, there is a feature of XML that allows the XML parser to expand macro entities with values defined either within the document itself or from external sources.</span></span> <span data-ttu-id="a8300-203">Ad esempio, il documento potrebbe definire un'entità "companyname" con il valore "Microsoft" in modo che ogni occorrenza del testo "&companyname;" nel documento venga automaticamente sostituita con il testo "Microsoft".</span><span class="sxs-lookup"><span data-stu-id="a8300-203">For example, the document might define an entity "companyname" with the value "Microsoft," so that every time the text "&companyname;" appears in the document, it is automatically replaced with the text Microsoft.</span></span> <span data-ttu-id="a8300-204">In alternativa, il documento potrebbe definire un'entità "MSFTStock" che fa riferimento a un servizio Web esterno per recuperare il valore corrente delle azioni Microsoft.</span><span class="sxs-lookup"><span data-stu-id="a8300-204">Or, the document might define an entity "MSFTStock" that references an external web service to fetch the current value of Microsoft stock.</span></span></p><p><span data-ttu-id="a8300-205">Ogni occorrenza di "&MSFTStock;" nel documento verrà quindi automaticamente sostituita con il prezzo corrente del titolo azionario.</span><span class="sxs-lookup"><span data-stu-id="a8300-205">Then any time "&MSFTStock;" appears in the document, it is automatically replaced with the current stock price.</span></span> <span data-ttu-id="a8300-206">Questa funzionalità può tuttavia essere usata in modo improprio per creare condizioni di Denial of Service (DoS).</span><span class="sxs-lookup"><span data-stu-id="a8300-206">However, this functionality can be abused to create denial of service (DoS) conditions.</span></span> <span data-ttu-id="a8300-207">Un utente malintenzionato è possibile nidificare più entità per creare un'espansione esponenziale XML di validità che utilizza tutta la memoria disponibile nel sistema.</span><span class="sxs-lookup"><span data-stu-id="a8300-207">An attacker can nest multiple entities to create an exponential expansion XML bomb that consumes all available memory on the system.</span></span> </p><p><span data-ttu-id="a8300-208">In alternativa, può creare un riferimento esterno che trasmette una quantità infinita di dati o semplicemente blocca il thread.</span><span class="sxs-lookup"><span data-stu-id="a8300-208">Alternatively, he can create an external reference that streams back an infinite amount of data or that simply hangs the thread.</span></span> <span data-ttu-id="a8300-209">Di conseguenza, tutti i team devono disabilitare interamente la risoluzione di entità XML interne e/o esterne se non viene usata dall'applicazione oppure, se tale funzionalità è assolutamente necessaria, limitare manualmente la quantità di memoria e di tempo utilizzabile dall'applicazione per la risoluzione di entità.</span><span class="sxs-lookup"><span data-stu-id="a8300-209">As a result, all teams must disable internal and/or external XML entity resolution entirely if their application does not use it, or manually limit the amount of memory and time that the application can consume for entity resolution if this functionality is absolutely necessary.</span></span> <span data-ttu-id="a8300-210">Se la risoluzione di entità non è richiesta dall'applicazione, disabilitarla.</span><span class="sxs-lookup"><span data-stu-id="a8300-210">If entity resolution is not required by your application, then disable it.</span></span> </p>|

### <a name="example"></a><span data-ttu-id="a8300-211">Esempio</span><span class="sxs-lookup"><span data-stu-id="a8300-211">Example</span></span>
<span data-ttu-id="a8300-212">Per il codice .NET Framework, è possibile usare gli approcci seguenti:</span><span class="sxs-lookup"><span data-stu-id="a8300-212">For .NET Framework code, you can use the following approaches:</span></span>

```C#
XmlTextReader reader = new XmlTextReader(stream);
reader.ProhibitDtd = true;

XmlReaderSettings settings = new XmlReaderSettings();
settings.ProhibitDtd = true;
XmlReader reader = XmlReader.Create(stream, settings);

// for .NET 4
XmlReaderSettings settings = new XmlReaderSettings();
settings.DtdProcessing = DtdProcessing.Prohibit;
XmlReader reader = XmlReader.Create(stream, settings);
```
<span data-ttu-id="a8300-213">Si noti che il valore predefinito di `ProhibitDtd` in `XmlReaderSettings` è true, ma in `XmlTextReader` è false.</span><span class="sxs-lookup"><span data-stu-id="a8300-213">Note that the default value of `ProhibitDtd` in `XmlReaderSettings` is true, but in `XmlTextReader` it is false.</span></span> <span data-ttu-id="a8300-214">Se si usa XmlReaderSettings, non è necessario impostare ProhibitDtd su true in modo esplicito, ma è consigliabile ai fini della sicurezza.</span><span class="sxs-lookup"><span data-stu-id="a8300-214">If you are using XmlReaderSettings, you do not need to set ProhibitDtd to true explicitly, but it is recommended for safety sake that you do.</span></span> <span data-ttu-id="a8300-215">Si noti anche che la classe XmlDocument consente la risoluzione di entità per impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="a8300-215">Also note that the XmlDocument class allows entity resolution by default.</span></span> 

### <a name="example"></a><span data-ttu-id="a8300-216">Esempio</span><span class="sxs-lookup"><span data-stu-id="a8300-216">Example</span></span>
<span data-ttu-id="a8300-217">Per disabilitare la risoluzione di entità per le classi XmlDocument, usare l'overload `XmlDocument.Load(XmlReader)` del metodo Load e impostare le proprietà appropriate nell'argomento XmlReader per disabilitare la risoluzione, come illustrato nel codice seguente:</span><span class="sxs-lookup"><span data-stu-id="a8300-217">To disable entity resolution for XmlDocuments, use the `XmlDocument.Load(XmlReader)` overload of the Load method and set the appropriate properties in the XmlReader argument to disable resolution, as illustrated in the following code:</span></span> 

```C#
XmlReaderSettings settings = new XmlReaderSettings();
settings.ProhibitDtd = true;
XmlReader reader = XmlReader.Create(stream, settings);
XmlDocument doc = new XmlDocument();
doc.Load(reader);
```

### <a name="example"></a><span data-ttu-id="a8300-218">Esempio</span><span class="sxs-lookup"><span data-stu-id="a8300-218">Example</span></span>
<span data-ttu-id="a8300-219">Se non è possibile disabilitare la risoluzione di entità per l'applicazione, impostare la proprietà XmlReaderSettings.MaxCharactersFromEntities su un valore ragionevole in base alle esigenze dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="a8300-219">If disabling entity resolution is not possible for your application, set the XmlReaderSettings.MaxCharactersFromEntities property to a reasonable value according to your application's needs.</span></span> <span data-ttu-id="a8300-220">Verrà così limitato l'impatto dei potenziali attacchi DoS con espansione esponenziale.</span><span class="sxs-lookup"><span data-stu-id="a8300-220">This will limit the impact of potential exponential expansion DoS attacks.</span></span> <span data-ttu-id="a8300-221">Il codice seguente offre un esempio di questo approccio:</span><span class="sxs-lookup"><span data-stu-id="a8300-221">The following code provides an example of this approach:</span></span> 

```C#
XmlReaderSettings settings = new XmlReaderSettings();
settings.ProhibitDtd = false;
settings.MaxCharactersFromEntities = 1000;
XmlReader reader = XmlReader.Create(stream, settings);
```

### <a name="example"></a><span data-ttu-id="a8300-222">Esempio</span><span class="sxs-lookup"><span data-stu-id="a8300-222">Example</span></span>
<span data-ttu-id="a8300-223">Se è necessario risolvere entità incorporate ma non entità esterne, impostare la proprietà XmlReaderSettings.XmlResolver su null.</span><span class="sxs-lookup"><span data-stu-id="a8300-223">If you need to resolve inline entities but do not need to resolve external entities, set the XmlReaderSettings.XmlResolver property to null.</span></span> <span data-ttu-id="a8300-224">Ad esempio:</span><span class="sxs-lookup"><span data-stu-id="a8300-224">For example:</span></span> 

```C#
XmlReaderSettings settings = new XmlReaderSettings();
settings.ProhibitDtd = false;
settings.MaxCharactersFromEntities = 1000;
settings.XmlResolver = null;
XmlReader reader = XmlReader.Create(stream, settings);
```
<span data-ttu-id="a8300-225">Si noti che in MSXML6, la proprietà ProhibitDTD è impostata su true (in modo da disabilitare l'elaborazione DTD) per impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="a8300-225">Note that in MSXML6, ProhibitDTD is set to true (disabling DTD processing) by default.</span></span> <span data-ttu-id="a8300-226">Per il codice Apple OSX/iOS, è possibile usare due parser XML: NSXMLParser e libXML2.</span><span class="sxs-lookup"><span data-stu-id="a8300-226">For Apple OSX/iOS code, there are two XML parsers you can use: NSXMLParser and libXML2.</span></span> 

## <span data-ttu-id="a8300-227"><a id="app-verification"></a>Verifica della canonizzazione degli URL nelle applicazioni che utilizzano http.sys</span><span class="sxs-lookup"><span data-stu-id="a8300-227"><a id="app-verification"></a>Applications utilizing http.sys perform URL canonicalization verification</span></span>

| <span data-ttu-id="a8300-228">Titolo</span><span class="sxs-lookup"><span data-stu-id="a8300-228">Title</span></span>                   | <span data-ttu-id="a8300-229">Dettagli</span><span class="sxs-lookup"><span data-stu-id="a8300-229">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="a8300-230">**Componente**</span><span class="sxs-lookup"><span data-stu-id="a8300-230">**Component**</span></span>               | <span data-ttu-id="a8300-231">Applicazione Web.</span><span class="sxs-lookup"><span data-stu-id="a8300-231">Web Application</span></span> | 
| <span data-ttu-id="a8300-232">**Fase SDL**</span><span class="sxs-lookup"><span data-stu-id="a8300-232">**SDL Phase**</span></span>               | <span data-ttu-id="a8300-233">Compilare</span><span class="sxs-lookup"><span data-stu-id="a8300-233">Build</span></span> |  
| <span data-ttu-id="a8300-234">**Tecnologie applicabili**</span><span class="sxs-lookup"><span data-stu-id="a8300-234">**Applicable Technologies**</span></span> | <span data-ttu-id="a8300-235">Generico</span><span class="sxs-lookup"><span data-stu-id="a8300-235">Generic</span></span> |
| <span data-ttu-id="a8300-236">**Attributes (Attributi) (Attributi)**</span><span class="sxs-lookup"><span data-stu-id="a8300-236">**Attributes**</span></span>              | <span data-ttu-id="a8300-237">N/D</span><span class="sxs-lookup"><span data-stu-id="a8300-237">N/A</span></span>  |
| <span data-ttu-id="a8300-238">**Riferimenti**</span><span class="sxs-lookup"><span data-stu-id="a8300-238">**References**</span></span>              | <span data-ttu-id="a8300-239">N/D</span><span class="sxs-lookup"><span data-stu-id="a8300-239">N/A</span></span>  |
| <span data-ttu-id="a8300-240">**Passaggi**</span><span class="sxs-lookup"><span data-stu-id="a8300-240">**Steps**</span></span> | <p><span data-ttu-id="a8300-241">Tutte le applicazioni che usano http.sys devono seguire le linee guida seguenti:</span><span class="sxs-lookup"><span data-stu-id="a8300-241">Any application that uses http.sys should follow these guidelines:</span></span></p><ul><li><span data-ttu-id="a8300-242">Limitare la lunghezza degli URL a non oltre 16.384 caratteri (ASCII o Unicode).</span><span class="sxs-lookup"><span data-stu-id="a8300-242">Limit the URL length to no more than 16,384 characters (ASCII or Unicode).</span></span> <span data-ttu-id="a8300-243">Questa è la lunghezza massima assoluta degli URL in base all'impostazione predefinita di Internet Information Services (IIS) 6.</span><span class="sxs-lookup"><span data-stu-id="a8300-243">This is the absolute maximum URL length based on the default Internet Information Services (IIS) 6 setting.</span></span> <span data-ttu-id="a8300-244">Se possibile, i siti Web devono cercare di mantenere una lunghezza inferiore a tale massimo.</span><span class="sxs-lookup"><span data-stu-id="a8300-244">Websites should strive for a length shorter than this if possible</span></span></li><li><span data-ttu-id="a8300-245">Usare le classi di I/O file standard di .NET Framework (come FileStream), perché sfruttano le regole di canonizzazione di .NET FX.</span><span class="sxs-lookup"><span data-stu-id="a8300-245">Use the standard .NET Framework file I/O classes (such as FileStream) as these will take advantage of the canonicalization rules in the .NET FX</span></span></li><li><span data-ttu-id="a8300-246">Compilare in modo esplicito un elenco di nomi file noti consentiti.</span><span class="sxs-lookup"><span data-stu-id="a8300-246">Explicitly build an allow-list of known filenames</span></span></li><li><span data-ttu-id="a8300-247">Rifiutare in modo esplicito i nomi file noti che non verranno gestiti con rifiuti tramite UrlScan, ossia i file con estensione exe, bat, cmd, com, htw, ida, idq, htr, idc, shtm[l], stm, printer, ini, pol e dat.</span><span class="sxs-lookup"><span data-stu-id="a8300-247">Explicitly reject known filetypes you will not serve UrlScan rejects: exe, bat, cmd, com, htw, ida, idq, htr, idc, shtm[l], stm, printer, ini, pol, dat files</span></span></li><li><span data-ttu-id="a8300-248">Rilevare le eccezioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="a8300-248">Catch the following exceptions:</span></span><ul><li><span data-ttu-id="a8300-249">System.ArgumentException (per i nomi di dispositivo)</span><span class="sxs-lookup"><span data-stu-id="a8300-249">System.ArgumentException (for device names)</span></span></li><li><span data-ttu-id="a8300-250">System.NotSupportedException (per i flussi di dati)</span><span class="sxs-lookup"><span data-stu-id="a8300-250">System.NotSupportedException (for data streams)</span></span></li><li><span data-ttu-id="a8300-251">System.IO.FileNotFoundException (per i nomi file preceduti da carattere di escape non validi)</span><span class="sxs-lookup"><span data-stu-id="a8300-251">System.IO.FileNotFoundException (for invalid escaped filenames)</span></span></li><li><span data-ttu-id="a8300-252">System.IO.DirectoryNotFoundException (per le directory precedute da carattere di escape non valide)</span><span class="sxs-lookup"><span data-stu-id="a8300-252">System.IO.DirectoryNotFoundException (for invalid escaped dirs)</span></span></li></ul></li><li><span data-ttu-id="a8300-253">*Non* chiamare API di I/O file Win32.</span><span class="sxs-lookup"><span data-stu-id="a8300-253">*Do not* call out to Win32 file I/O APIs.</span></span> <span data-ttu-id="a8300-254">In caso di URL non valido, restituire automaticamente un errore 400 all'utente e registrare l'errore effettivo.</span><span class="sxs-lookup"><span data-stu-id="a8300-254">On an invalid URL gracefully return a 400 error to the user, and log the real error.</span></span></li></ul>|

## <span data-ttu-id="a8300-255"><a id="controls-users"></a>Verificare la presenza dei controlli appropriati quando si accettano file dagli utenti</span><span class="sxs-lookup"><span data-stu-id="a8300-255"><a id="controls-users"></a>Ensure appropriate controls are in place when accepting files from users</span></span>

| <span data-ttu-id="a8300-256">Titolo</span><span class="sxs-lookup"><span data-stu-id="a8300-256">Title</span></span>                   | <span data-ttu-id="a8300-257">Dettagli</span><span class="sxs-lookup"><span data-stu-id="a8300-257">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="a8300-258">**Componente**</span><span class="sxs-lookup"><span data-stu-id="a8300-258">**Component**</span></span>               | <span data-ttu-id="a8300-259">Applicazione Web.</span><span class="sxs-lookup"><span data-stu-id="a8300-259">Web Application</span></span> | 
| <span data-ttu-id="a8300-260">**Fase SDL**</span><span class="sxs-lookup"><span data-stu-id="a8300-260">**SDL Phase**</span></span>               | <span data-ttu-id="a8300-261">Compilare</span><span class="sxs-lookup"><span data-stu-id="a8300-261">Build</span></span> |  
| <span data-ttu-id="a8300-262">**Tecnologie applicabili**</span><span class="sxs-lookup"><span data-stu-id="a8300-262">**Applicable Technologies**</span></span> | <span data-ttu-id="a8300-263">Generico</span><span class="sxs-lookup"><span data-stu-id="a8300-263">Generic</span></span> |
| <span data-ttu-id="a8300-264">**Attributes (Attributi) (Attributi)**</span><span class="sxs-lookup"><span data-stu-id="a8300-264">**Attributes**</span></span>              | <span data-ttu-id="a8300-265">N/D</span><span class="sxs-lookup"><span data-stu-id="a8300-265">N/A</span></span>  |
| <span data-ttu-id="a8300-266">**Riferimenti**</span><span class="sxs-lookup"><span data-stu-id="a8300-266">**References**</span></span>              | <span data-ttu-id="a8300-267">[Unrestricted File Upload](https://www.owasp.org/index.php/Unrestricted_File_Upload) (Caricamento di file senza restrizioni), [File Signature Table](http://www.garykessler.net/library/file_sigs.html) (Tabella delle firme dei file)</span><span class="sxs-lookup"><span data-stu-id="a8300-267">[Unrestricted File Upload](https://www.owasp.org/index.php/Unrestricted_File_Upload), [File Signature Table](http://www.garykessler.net/library/file_sigs.html)</span></span> |
| <span data-ttu-id="a8300-268">**Passaggi**</span><span class="sxs-lookup"><span data-stu-id="a8300-268">**Steps**</span></span> | <p><span data-ttu-id="a8300-269">I file caricati rappresentano un rischio significativo per le applicazioni.</span><span class="sxs-lookup"><span data-stu-id="a8300-269">Uploaded files represent a significant risk to applications.</span></span></p><p><span data-ttu-id="a8300-270">Il primo passaggio di numerosi attacchi consiste nell'inserire codice nel sistema da attaccare.</span><span class="sxs-lookup"><span data-stu-id="a8300-270">The first step in many attacks is to get some code to the system to be attacked.</span></span> <span data-ttu-id="a8300-271">È quindi sufficiente trovare un modo per far sì che il codice venga eseguito.</span><span class="sxs-lookup"><span data-stu-id="a8300-271">Then the attack only needs to find a way to get the code executed.</span></span> <span data-ttu-id="a8300-272">Il caricamento di un file consente all'utente malintenzionato di portare a termine il primo passaggio.</span><span class="sxs-lookup"><span data-stu-id="a8300-272">Using a file upload helps the attacker accomplish the first step.</span></span> <span data-ttu-id="a8300-273">Le conseguenze del caricamento di file senza restrizioni possono variare dalla completa acquisizione della proprietà del sistema al sovraccarico del file system o del database, all'inoltro di attacchi ai sistemi back-end e al semplice danneggiamento.</span><span class="sxs-lookup"><span data-stu-id="a8300-273">The consequences of unrestricted file upload can vary, including complete system takeover, an overloaded file system or database, forwarding attacks to back-end systems, and simple defacement.</span></span></p><p><span data-ttu-id="a8300-274">Ciò dipende da come il file caricato viene usato dall'applicazione e soprattutto dalla posizione in cui viene archiviato.</span><span class="sxs-lookup"><span data-stu-id="a8300-274">It depends on what the application does with the uploaded file and especially where it is stored.</span></span> <span data-ttu-id="a8300-275">La convalida sul lato server dei caricamenti di file non è disponibile.</span><span class="sxs-lookup"><span data-stu-id="a8300-275">Server side validation of file uploads is missing.</span></span> <span data-ttu-id="a8300-276">Per la funzionalità di caricamento file devono essere implementati i controlli di sicurezza seguenti:</span><span class="sxs-lookup"><span data-stu-id="a8300-276">Following security controls should be implemented for File Upload functionality:</span></span></p><ul><li><span data-ttu-id="a8300-277">Controllo dell'estensione di file (deve essere accettato solo un set valido di tipi di file consentiti)</span><span class="sxs-lookup"><span data-stu-id="a8300-277">File Extension check (only a valid set of allowed file type should be accepted)</span></span></li><li><span data-ttu-id="a8300-278">Limite di dimensione massima dei file</span><span class="sxs-lookup"><span data-stu-id="a8300-278">Maximum file size limit</span></span></li><li><span data-ttu-id="a8300-279">I file non devono essere caricati in webroot, ma in una directory in un'unità non di sistema</span><span class="sxs-lookup"><span data-stu-id="a8300-279">File should not be uploaded to webroot; the location should be a directory on non-system drive</span></span></li><li><span data-ttu-id="a8300-280">Deve essere seguita la convenzione di denominazione in modo da garantire una certa casualità nel nome del file caricato e impedire le sovrascritture di file</span><span class="sxs-lookup"><span data-stu-id="a8300-280">Naming convention should be followed, such that the uploaded file name have some randomness, so as to prevent file overwrites</span></span></li><li><span data-ttu-id="a8300-281">I file devono essere sottoposti ad analisi antivirus prima della scrittura sul disco</span><span class="sxs-lookup"><span data-stu-id="a8300-281">Files should be scanned for anti-virus before writing to the disk</span></span></li><li><span data-ttu-id="a8300-282">Verificare che il nome file e tutti gli altri metadati (ad esempio, il percorso file) vengano convalidati in relazione alla presenza di caratteri dannosi</span><span class="sxs-lookup"><span data-stu-id="a8300-282">Ensure that the file name and any other metadata (e.g., file path) are validated for malicious characters</span></span></li><li><span data-ttu-id="a8300-283">La firma del formato di file deve essere controllata per impedire a un utente di caricare un file mascherato (ad esempio, caricare un file EXE modificandone l'estensione in txt)</span><span class="sxs-lookup"><span data-stu-id="a8300-283">File format signature should be checked, to prevent a user from uploading a masqueraded file (e.g., uploading an exe file by changing extension to txt)</span></span></li></ul>| 

### <a name="example"></a><span data-ttu-id="a8300-284">Esempio</span><span class="sxs-lookup"><span data-stu-id="a8300-284">Example</span></span>
<span data-ttu-id="a8300-285">Per informazioni dettagliate sull'ultimo punto relativo alla convalida della firma del formato di file, vedere la classe seguente:</span><span class="sxs-lookup"><span data-stu-id="a8300-285">For the last point regarding file format signature validation, refer to the class below for details:</span></span> 

```C#
        private static Dictionary<string, List<byte[]>> fileSignature = new Dictionary<string, List<byte[]>>
                    {
                    { ".DOC", new List<byte[]> { new byte[] { 0xD0, 0xCF, 0x11, 0xE0, 0xA1, 0xB1, 0x1A, 0xE1 } } },
                    { ".DOCX", new List<byte[]> { new byte[] { 0x50, 0x4B, 0x03, 0x04 } } },
                    { ".PDF", new List<byte[]> { new byte[] { 0x25, 0x50, 0x44, 0x46 } } },
                    { ".ZIP", new List<byte[]> 
                                            {
                                              new byte[] { 0x50, 0x4B, 0x03, 0x04 },
                                              new byte[] { 0x50, 0x4B, 0x4C, 0x49, 0x54, 0x55 },
                                              new byte[] { 0x50, 0x4B, 0x53, 0x70, 0x58 },
                                              new byte[] { 0x50, 0x4B, 0x05, 0x06 },
                                              new byte[] { 0x50, 0x4B, 0x07, 0x08 },
                                              new byte[] { 0x57, 0x69, 0x6E, 0x5A, 0x69, 0x70 }
                                                }
                                            },
                    { ".PNG", new List<byte[]> { new byte[] { 0x89, 0x50, 0x4E, 0x47, 0x0D, 0x0A, 0x1A, 0x0A } } },
                    { ".JPG", new List<byte[]>
                                    {
                                              new byte[] { 0xFF, 0xD8, 0xFF, 0xE0 },
                                              new byte[] { 0xFF, 0xD8, 0xFF, 0xE1 },
                                              new byte[] { 0xFF, 0xD8, 0xFF, 0xE8 }
                                    }
                                    },
                    { ".JPEG", new List<byte[]>
                                        { 
                                            new byte[] { 0xFF, 0xD8, 0xFF, 0xE0 },
                                            new byte[] { 0xFF, 0xD8, 0xFF, 0xE2 },
                                            new byte[] { 0xFF, 0xD8, 0xFF, 0xE3 }
                                        }
                                        },
                    { ".XLS", new List<byte[]>
                                            {
                                              new byte[] { 0xD0, 0xCF, 0x11, 0xE0, 0xA1, 0xB1, 0x1A, 0xE1 },
                                              new byte[] { 0x09, 0x08, 0x10, 0x00, 0x00, 0x06, 0x05, 0x00 },
                                              new byte[] { 0xFD, 0xFF, 0xFF, 0xFF }
                                            }
                                            },
                    { ".XLSX", new List<byte[]> { new byte[] { 0x50, 0x4B, 0x03, 0x04 } } },
                    { ".GIF", new List<byte[]> { new byte[] { 0x47, 0x49, 0x46, 0x38 } } }
                };

        public static bool IsValidFileExtension(string fileName, byte[] fileData, byte[] allowedChars)
        {
            if (string.IsNullOrEmpty(fileName) || fileData == null || fileData.Length == 0)
            {
                return false;
            }

            bool flag = false;
            string ext = Path.GetExtension(fileName);
            if (string.IsNullOrEmpty(ext))
            {
                return false;
            }

            ext = ext.ToUpperInvariant();

            if (ext.Equals(".TXT") || ext.Equals(".CSV") || ext.Equals(".PRN"))
            {
                foreach (byte b in fileData)
                {
                    if (b > 0x7F)
                    {
                        if (allowedChars != null)
                        {
                            if (!allowedChars.Contains(b))
                            {
                                return false;
                            }
                        }
                        else
                        {
                            return false;
                        }
                    }
                }

                return true;
            }

            if (!fileSignature.ContainsKey(ext))
            {
                return true;
            }

            List<byte[]> sig = fileSignature[ext];
            foreach (byte[] b in sig)
            {
                var curFileSig = new byte[b.Length];
                Array.Copy(fileData, curFileSig, b.Length);
                if (curFileSig.SequenceEqual(b))
                {
                    flag = true;
                    break;
                }
            }

            return flag;
        }
```

## <span data-ttu-id="a8300-286"><a id="typesafe"></a>Verificare che nell'applicazione Web vengano usati parametri indipendenti dai tipi per l'accesso ai dati</span><span class="sxs-lookup"><span data-stu-id="a8300-286"><a id="typesafe"></a>Ensure that type-safe parameters are used in Web Application for data access</span></span>

| <span data-ttu-id="a8300-287">Titolo</span><span class="sxs-lookup"><span data-stu-id="a8300-287">Title</span></span>                   | <span data-ttu-id="a8300-288">Dettagli</span><span class="sxs-lookup"><span data-stu-id="a8300-288">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="a8300-289">**Componente**</span><span class="sxs-lookup"><span data-stu-id="a8300-289">**Component**</span></span>               | <span data-ttu-id="a8300-290">Applicazione Web.</span><span class="sxs-lookup"><span data-stu-id="a8300-290">Web Application</span></span> | 
| <span data-ttu-id="a8300-291">**Fase SDL**</span><span class="sxs-lookup"><span data-stu-id="a8300-291">**SDL Phase**</span></span>               | <span data-ttu-id="a8300-292">Compilare</span><span class="sxs-lookup"><span data-stu-id="a8300-292">Build</span></span> |  
| <span data-ttu-id="a8300-293">**Tecnologie applicabili**</span><span class="sxs-lookup"><span data-stu-id="a8300-293">**Applicable Technologies**</span></span> | <span data-ttu-id="a8300-294">Generico</span><span class="sxs-lookup"><span data-stu-id="a8300-294">Generic</span></span> |
| <span data-ttu-id="a8300-295">**Attributes (Attributi) (Attributi)**</span><span class="sxs-lookup"><span data-stu-id="a8300-295">**Attributes**</span></span>              | <span data-ttu-id="a8300-296">N/D</span><span class="sxs-lookup"><span data-stu-id="a8300-296">N/A</span></span>  |
| <span data-ttu-id="a8300-297">**Riferimenti**</span><span class="sxs-lookup"><span data-stu-id="a8300-297">**References**</span></span>              | <span data-ttu-id="a8300-298">N/D</span><span class="sxs-lookup"><span data-stu-id="a8300-298">N/A</span></span>  |
| <span data-ttu-id="a8300-299">**Passaggi**</span><span class="sxs-lookup"><span data-stu-id="a8300-299">**Steps**</span></span> | <p><span data-ttu-id="a8300-300">Se si usa la raccolta Parameters, SQL considera l'input come un valore letterale anziché come codice eseguibile.</span><span class="sxs-lookup"><span data-stu-id="a8300-300">If you use the Parameters collection, SQL treats the input is as a literal value rather then as executable code.</span></span> <span data-ttu-id="a8300-301">La raccolta Parameters può essere usata per imporre vincoli di tipo e lunghezza sui dati di input.</span><span class="sxs-lookup"><span data-stu-id="a8300-301">The Parameters collection can be used to enforce type and length constraints on input data.</span></span> <span data-ttu-id="a8300-302">I valori non compresi nell'intervallo attivano un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="a8300-302">Values outside of the range trigger an exception.</span></span> <span data-ttu-id="a8300-303">Se non vengono usati parametri SQL indipendenti dai tipi, gli utenti malintenzionati potrebbero eseguire attacchi di tipo injection incorporati nell'input non filtrato.</span><span class="sxs-lookup"><span data-stu-id="a8300-303">If type-safe SQL parameters are not used, attackers might be able to execute injection attacks that are embedded in the unfiltered input.</span></span></p><p><span data-ttu-id="a8300-304">Quando si costruiscono query SQL, usare parametri indipendenti dai tipi per evitare gli attacchi SQL injection che possono verificarsi con input non filtrato.</span><span class="sxs-lookup"><span data-stu-id="a8300-304">Use type safe parameters when constructing SQL queries to avoid possible SQL injection attacks that can occur with unfiltered input.</span></span> <span data-ttu-id="a8300-305">È possibile usare parametri indipendenti dai tipi con stored procedure e con istruzioni SQL dinamiche.</span><span class="sxs-lookup"><span data-stu-id="a8300-305">You can use type safe parameters with stored procedures and with dynamic SQL statements.</span></span> <span data-ttu-id="a8300-306">I parametri vengono considerati dal database come valori letterali e non come codice eseguibile.</span><span class="sxs-lookup"><span data-stu-id="a8300-306">Parameters are treated as literal values by the database and not as executable code.</span></span> <span data-ttu-id="a8300-307">Viene anche eseguito il controllo del tipo e della lunghezza dei parametri.</span><span class="sxs-lookup"><span data-stu-id="a8300-307">Parameters are also checked for type and length.</span></span></p>|

### <a name="example"></a><span data-ttu-id="a8300-308">Esempio</span><span class="sxs-lookup"><span data-stu-id="a8300-308">Example</span></span> 
<span data-ttu-id="a8300-309">Il codice seguente illustra come usare parametri indipendenti dai tipi con SqlParameterCollection quando si chiama una stored procedure.</span><span class="sxs-lookup"><span data-stu-id="a8300-309">The following code shows how to use type safe parameters with the SqlParameterCollection when calling a stored procedure.</span></span> 

```C#
using System.Data;
using System.Data.SqlClient;

using (SqlConnection connection = new SqlConnection(connectionString))
{ 
DataSet userDataset = new DataSet(); 
SqlDataAdapter myCommand = new SqlDataAdapter(LoginStoredProcedure", connection); 
myCommand.SelectCommand.CommandType = CommandType.StoredProcedure; 
myCommand.SelectCommand.Parameters.Add("@au_id", SqlDbType.VarChar, 11); 
myCommand.SelectCommand.Parameters["@au_id"].Value = SSN.Text; 
myCommand.Fill(userDataset);
}  
```
<span data-ttu-id="a8300-310">Nell'esempio di codice precedente, la lunghezza del valore di input non può essere maggiore di 11 caratteri.</span><span class="sxs-lookup"><span data-stu-id="a8300-310">In the preceding code example, the input value cannot be longer than 11 characters.</span></span> <span data-ttu-id="a8300-311">Se i dati non sono conformi alla lunghezza o al tipo definito dal parametro, la classe SqlParameter genera un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="a8300-311">If the data does not conform to the type or length defined by the parameter, the SqlParameter class throws an exception.</span></span> 

## <span data-ttu-id="a8300-312"><a id="binding-mvc"></a>Usare classi di associazione di modelli separate o elenchi di filtri di associazione per prevenire la vulnerabilità dell'assegnazione di massa in MVC</span><span class="sxs-lookup"><span data-stu-id="a8300-312"><a id="binding-mvc"></a>Use separate model binding classes or binding filter lists to prevent MVC mass assignment vulnerability</span></span>

| <span data-ttu-id="a8300-313">Titolo</span><span class="sxs-lookup"><span data-stu-id="a8300-313">Title</span></span>                   | <span data-ttu-id="a8300-314">Dettagli</span><span class="sxs-lookup"><span data-stu-id="a8300-314">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="a8300-315">**Componente**</span><span class="sxs-lookup"><span data-stu-id="a8300-315">**Component**</span></span>               | <span data-ttu-id="a8300-316">Applicazione Web.</span><span class="sxs-lookup"><span data-stu-id="a8300-316">Web Application</span></span> | 
| <span data-ttu-id="a8300-317">**Fase SDL**</span><span class="sxs-lookup"><span data-stu-id="a8300-317">**SDL Phase**</span></span>               | <span data-ttu-id="a8300-318">Compilare</span><span class="sxs-lookup"><span data-stu-id="a8300-318">Build</span></span> |  
| <span data-ttu-id="a8300-319">**Tecnologie applicabili**</span><span class="sxs-lookup"><span data-stu-id="a8300-319">**Applicable Technologies**</span></span> | <span data-ttu-id="a8300-320">MVC 5, MVC 6</span><span class="sxs-lookup"><span data-stu-id="a8300-320">MVC5, MVC6</span></span> |
| <span data-ttu-id="a8300-321">**Attributes (Attributi) (Attributi)**</span><span class="sxs-lookup"><span data-stu-id="a8300-321">**Attributes**</span></span>              | <span data-ttu-id="a8300-322">N/D</span><span class="sxs-lookup"><span data-stu-id="a8300-322">N/A</span></span>  |
| <span data-ttu-id="a8300-323">**Riferimenti**</span><span class="sxs-lookup"><span data-stu-id="a8300-323">**References**</span></span>              | <span data-ttu-id="a8300-324">[Attributi dei metadati](http://msdn.microsoft.com/library/system.componentmodel.dataannotations.metadatatypeattribute), [Public Key Security Vulnerability And Mitigation](https://github.com/blog/1068-public-key-security-vulnerability-and-mitigation) (Vulnerabilità della sicurezza delle chiavi pubbliche e mitigazione), [Guida completa all'assegnazione di massa in ASP.NET MVC](http://odetocode.com/Blogs/scott/archive/2012/03/11/complete-guide-to-mass-assignment-in-asp-net-mvc.aspx), [Introduzione a Entity Framework con MVC](http://www.asp.net/mvc/tutorials/getting-started-with-ef-using-mvc/implementing-basic-crud-functionality-with-the-entity-framework-in-asp-net-mvc-application#overpost)</span><span class="sxs-lookup"><span data-stu-id="a8300-324">[Metadata Attributes](http://msdn.microsoft.com/library/system.componentmodel.dataannotations.metadatatypeattribute), [Public Key Security Vulnerability And Mitigation](https://github.com/blog/1068-public-key-security-vulnerability-and-mitigation), [Complete Guide to Mass Assignment in ASP.NET MVC](http://odetocode.com/Blogs/scott/archive/2012/03/11/complete-guide-to-mass-assignment-in-asp-net-mvc.aspx), [Getting Started with EF using MVC](http://www.asp.net/mvc/tutorials/getting-started-with-ef-using-mvc/implementing-basic-crud-functionality-with-the-entity-framework-in-asp-net-mvc-application#overpost)</span></span> |
| <span data-ttu-id="a8300-325">**Passaggi**</span><span class="sxs-lookup"><span data-stu-id="a8300-325">**Steps**</span></span> | <ul><li><span data-ttu-id="a8300-326">**Quando è consigliabile controllare eventuali vulnerabilità all'overposting?** Le vulnerabilità all'overposting si possono verificare ovunque si associno classi modello dall'input utente.</span><span class="sxs-lookup"><span data-stu-id="a8300-326">**When should I look for over-posting vulnerabilities? -** Over-posting vulnerabilities can occur any place you bind model classes from user input.</span></span> <span data-ttu-id="a8300-327">I framework come MVC possono rappresentare i dati utente in classi .NET personalizzate, tra cui Plain Old CLR Object (POCO).</span><span class="sxs-lookup"><span data-stu-id="a8300-327">Frameworks like MVC can represent user data in custom .NET classes, including Plain Old CLR Objects (POCOs).</span></span> <span data-ttu-id="a8300-328">MVC popola automaticamente queste classi modello con i dati della richiesta, offrendo una pratica rappresentazione per la gestione dell'input utente.</span><span class="sxs-lookup"><span data-stu-id="a8300-328">MVC automatically populates these model classes with data from the request, providing a convenient representation for dealing with user input.</span></span> <span data-ttu-id="a8300-329">Quando queste classi includono proprietà che non devono essere impostate dall'utente, l'applicazione può essere vulnerabile ad attacchi di overposting, che consentono all'utente un controllo sui dati non previsto dall'applicazione.</span><span class="sxs-lookup"><span data-stu-id="a8300-329">When these classes include properties that should not be set by the user, the application can be vulnerable to over-posting attacks, which allow user control of data that the application never intended.</span></span> <span data-ttu-id="a8300-330">Così come l'associazione di modelli MVC, le tecnologie di accesso a database come i mapper relazionali/a oggetti come Entity Framework spesso supportano anche l'uso di oggetti POCO per rappresentare i dati dei database.</span><span class="sxs-lookup"><span data-stu-id="a8300-330">Like MVC model binding, database access technologies such as object/relational mappers like Entity Framework often also support using POCO objects to represent database data.</span></span> <span data-ttu-id="a8300-331">Queste classi del modello di dati consentono di gestire i dati dei database con la stessa praticità offerta da MVC per la gestione dell'input utente.</span><span class="sxs-lookup"><span data-stu-id="a8300-331">These data model classes provide the same convenience in dealing with database data as MVC does in dealing with user input.</span></span> <span data-ttu-id="a8300-332">Dato che MVC e il database supportano modelli simili, come gli oggetti POCO, le stesse classi sembrano facilmente riusabili per entrambi gli scopi.</span><span class="sxs-lookup"><span data-stu-id="a8300-332">Because both MVC and the database support similar models, like POCO objects, it seems easy to reuse the same classes for both purposes.</span></span> <span data-ttu-id="a8300-333">Questa procedura non riesce a mantenere la separazione dei compiti e offre un'area comune in cui proprietà non previste vengono esposte all'associazione di modelli, consentendo attacchi di overposting.</span><span class="sxs-lookup"><span data-stu-id="a8300-333">This practice fails to preserve separation of concerns, and it is one common area where unintended properties are exposed to model binding, enabling over-posting attacks.</span></span></li><li><span data-ttu-id="a8300-334">**Perché non è consigliabile usare classi modello del database non filtrate come parametri per le azioni MVC?** Perché l'associazione di modelli MVC associa tutti gli elementi nella classe.</span><span class="sxs-lookup"><span data-stu-id="a8300-334">**Why shouldn't I use my unfiltered database model classes as parameters to my MVC actions? -** Because MVC model binding will bind anything in that class.</span></span> <span data-ttu-id="a8300-335">Un utente malintenzionato può inviare una richiesta HTTP includendo anche dati non mostrati nella visualizzazione e questi verranno associati da MVC perché l'azione indica che la classe del database è la forma di dati da accettare come input utente.</span><span class="sxs-lookup"><span data-stu-id="a8300-335">Even if the data does not appear in your view, a malicious user can send an HTTP request with this data included, and MVC will gladly bind it because your action says that database class is the shape of data it should accept for user input.</span></span></li><li><span data-ttu-id="a8300-336">**Perché è necessario prestare attenzione alla forma usata per l'associazione di modelli?** L'uso dell'associazione di modelli ASP.NET MVC con modelli eccessivamente estesi espone un'applicazione ad attacchi di overposting.</span><span class="sxs-lookup"><span data-stu-id="a8300-336">**Why should I care about the shape used for model binding? -** Using ASP.NET MVC model binding with overly broad models exposes an application to over-posting attacks.</span></span> <span data-ttu-id="a8300-337">L'overposting potrebbe consentire a utenti malintenzionati di modificare dati dell'applicazione non previsti dallo sviluppatore, ad esempio sostituendo il prezzo di un articolo o i privilegi di sicurezza di un account.</span><span class="sxs-lookup"><span data-stu-id="a8300-337">Over-posting could enable attackers to change application data beyond what the developer intended, such as overriding the price for an item or the security privileges for an account.</span></span> <span data-ttu-id="a8300-338">Le applicazioni devono usare modelli di associazione specifici dell'azione (o specifici elenchi di filtri delle proprietà consentite) per fornire un contratto esplicito per l'input non attendibile da consentire tramite l'associazione di modelli.</span><span class="sxs-lookup"><span data-stu-id="a8300-338">Applications should use action-specific binding models (or specific allowed property filter lists) to provide an explicit contract for what untrusted input to allow via model binding.</span></span></li><li><span data-ttu-id="a8300-339">**La presenza di modelli di associazione separati è solo una duplicazione del codice?** No, è una separazione dei compiti.</span><span class="sxs-lookup"><span data-stu-id="a8300-339">**Is having separate binding models just duplicating code? -** No, it is a matter of separation of concerns.</span></span> <span data-ttu-id="a8300-340">Se si riusano i modelli del database nei metodi delle azioni, qualsiasi proprietà o proprietà secondaria nella classe potrà essere impostata dall'utente in una richiesta HTTP.</span><span class="sxs-lookup"><span data-stu-id="a8300-340">If you reuse database models in action methods, you are saying any property (or sub-property) in that class can be set by the user in an HTTP request.</span></span> <span data-ttu-id="a8300-341">Se ciò non corrisponde al comportamento desiderato per MVC, è necessario usare un elenco di filtri o una forma di classe separata per indicare a MVC quali dati possono invece provenire dall'input utente.</span><span class="sxs-lookup"><span data-stu-id="a8300-341">If that is not what you want MVC to do, you need a filter list or a separate class shape to show MVC what data can come from user input instead.</span></span></li><li><span data-ttu-id="a8300-342">**Se si usano modelli di associazione separati per l'input utente, è necessario duplicare tutti gli attributi di annotazione dei dati?** Non necessariamente.</span><span class="sxs-lookup"><span data-stu-id="a8300-342">**If I have separate binding models for user input, do I have to duplicate all my data annotation attributes? -** Not necessarily.</span></span> <span data-ttu-id="a8300-343">È possibile usare MetadataTypeAttribute nella classe modello del database per il collegamento ai metadati in una classe di associazione di modelli.</span><span class="sxs-lookup"><span data-stu-id="a8300-343">You can use MetadataTypeAttribute on the database model class to link to the metadata on a model binding class.</span></span> <span data-ttu-id="a8300-344">Si noti soltanto che il tipo a cui fa riferimento MetadataTypeAttribute deve essere un subset del tipo di riferimento (può avere meno proprietà, ma non di più).</span><span class="sxs-lookup"><span data-stu-id="a8300-344">Just note that the type referenced by the MetadataTypeAttribute must be a subset of the referencing type (it can have fewer properties, but not more).</span></span></li><li><span data-ttu-id="a8300-345">**Lo spostamento di dati tra i modelli dell'input utente e i modelli del database è un'attività tediosa. È possibile copiare semplicemente tutte le proprietà con la reflection?** Sì.</span><span class="sxs-lookup"><span data-stu-id="a8300-345">**Moving data back and forth between user input models and database models is tedious. Can I just copy over all properties using reflection? -** Yes.</span></span> <span data-ttu-id="a8300-346">Le uniche proprietà incluse nei modelli di associazione sono quelle che sono state accertate come sicure per l'input utente.</span><span class="sxs-lookup"><span data-stu-id="a8300-346">The only properties that appear in the binding models are the ones you have determined to be safe for user input.</span></span> <span data-ttu-id="a8300-347">Non esistono motivi di sicurezza che impediscono di usare la reflection per copiare tutte le proprietà comuni tra i due modelli.</span><span class="sxs-lookup"><span data-stu-id="a8300-347">There is no security reason that prevents using reflection to copy over all properties that exist in common between these two models.</span></span></li><li><span data-ttu-id="a8300-348">**Come funziona [Bind(Exclude ="â€¦")]? È possibile usare questo attributo anziché modelli di associazione separati?** Questo approccio non è consigliabile.</span><span class="sxs-lookup"><span data-stu-id="a8300-348">**What about [Bind(Exclude ="â€¦")]. Can I use that instead of having separate binding models? -** This approach is not recommended.</span></span> <span data-ttu-id="a8300-349">Usando [Bind(Exclude ="â€¦")], qualsiasi nuova proprietà è associabile per impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="a8300-349">Using [Bind(Exclude ="â€¦")] means that any new property is bindable by default.</span></span> <span data-ttu-id="a8300-350">Quando viene aggiunta una nuova proprietà, è necessario ricordare un passaggio aggiuntivo per garantire la sicurezza e non si ottiene una progettazione sicura per impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="a8300-350">When a new property is added, there is an extra step to remember to keep things secure, rather than having the design be secure by default.</span></span> <span data-ttu-id="a8300-351">Dipendere dal fatto che lo sviluppatore controlli questo elenco ogni volta che viene aggiunta una proprietà è rischioso.</span><span class="sxs-lookup"><span data-stu-id="a8300-351">Depending on the developer checking this list every time a property is added is risky.</span></span></li><li><span data-ttu-id="a8300-352">**[Bind(Include ="â€¦")] è utile per le operazioni di modifica?** No.</span><span class="sxs-lookup"><span data-stu-id="a8300-352">**Is [Bind(Include ="â€¦")] useful for Edit operations? -** No.</span></span> <span data-ttu-id="a8300-353">[Bind(Include ="â€¦")] è adatto solo per operazioni di tipo INSERT, ossia per l'aggiunta di nuovi dati.</span><span class="sxs-lookup"><span data-stu-id="a8300-353">[Bind(Include ="â€¦")] is only suitable for INSERT-style operations (adding new data).</span></span> <span data-ttu-id="a8300-354">Per operazioni di tipo UPDATE, ossia per la revisione dei dati esistenti, usare un altro approccio, come l'uso di modelli di associazione separati o il passaggio di un elenco esplicito delle proprietà consentite a UpdateModel o TryUpdateModel.</span><span class="sxs-lookup"><span data-stu-id="a8300-354">For UPDATE-style operations (revising existing data), use another approach, like having separate binding models or passing an explicit list of allowed properties to UpdateModel or TryUpdateModel.</span></span> <span data-ttu-id="a8300-355">Con l'aggiunta di un attributo [Bind(Include ="â€¦")] in un'operazione di modifica, MVC creerà un'istanza dell'oggetto e imposterà solo le proprietà elencate, mantenendo i valori predefiniti per tutte le altre.</span><span class="sxs-lookup"><span data-stu-id="a8300-355">Adding a [Bind(Include ="â€¦")] attribute on an Edit operation means that MVC will create an object instance and set only the listed properties, leaving all others at their default values.</span></span> <span data-ttu-id="a8300-356">Quando i dati vengono resi persistenti, sostituirà interamente l'entità esistente, reimpostando i valori predefiniti per tutte le proprietà omesse.</span><span class="sxs-lookup"><span data-stu-id="a8300-356">When the data is persisted, it will entirely replace the existing entity, resetting the values for any omitted properties to their defaults.</span></span> <span data-ttu-id="a8300-357">Ad esempio, se la proprietà IsAdmin è stata omessa in un attributo [Bind(Include ="â€¦")] per un'operazione di modifica, qualsiasi utente il cui nome è stato modificato tramite tale azione verrà reimpostato su IsAdmin = false. Qualsiasi utente modificato perderà così lo stato di amministratore.</span><span class="sxs-lookup"><span data-stu-id="a8300-357">For example, if IsAdmin was omitted from a [Bind(Include ="â€¦")] attribute on an Edit operation, any user whose name was edited via this action would be reset to IsAdmin = false (any edited user would lose administrator status).</span></span> <span data-ttu-id="a8300-358">Se si vuole impedire l'aggiornamento di determinate proprietà, usare uno degli altri approcci descritti sopra.</span><span class="sxs-lookup"><span data-stu-id="a8300-358">If you want to prevent updates to certain properties, use one of the other approaches above.</span></span> <span data-ttu-id="a8300-359">Si noti che alcune versioni degli strumenti MVC generano classi controller con [Bind(Include ="â€¦")] nelle azioni di modifica e prevedono che la rimozione di una proprietà dall'elenco impedisca attacchi di overposting.</span><span class="sxs-lookup"><span data-stu-id="a8300-359">Note that some versions of MVC tooling generate controller classes with [Bind(Include ="â€¦")] on Edit actions and imply that removing a property from that list will prevent over-posting attacks.</span></span> <span data-ttu-id="a8300-360">Come descritto sopra, tuttavia, questo approccio non funziona come previsto e reimposta invece i dati nelle proprietà omesse sui valori predefiniti.</span><span class="sxs-lookup"><span data-stu-id="a8300-360">However, as described above, that approach does not work as intended and instead will reset any data in the omitted properties to their default values.</span></span></li><li><span data-ttu-id="a8300-361">**Per le operazioni di creazione, esistono controindicazioni all'uso di [Bind(Include ="â€¦")] anziché di modelli di associazione separati?** Sì.</span><span class="sxs-lookup"><span data-stu-id="a8300-361">**For Create operations, are there any caveats using [Bind(Include ="â€¦")] rather than separate binding models? -** Yes.</span></span> <span data-ttu-id="a8300-362">Per prima cosa, questo approccio non funziona per gli scenari di modifica e richiede quindi la gestione di due approcci separati per la mitigazione di tutte le vulnerabilità all'overposting.</span><span class="sxs-lookup"><span data-stu-id="a8300-362">First this approach does not work for Edit scenarios, requiring maintaining two separate approaches for mitigating all over-posting vulnerabilities.</span></span> <span data-ttu-id="a8300-363">In secondo luogo, i modelli di associazione separati impongono la separazione dei compiti tra la forma usata per l'input utente e la forma usata per la persistenza, una funzionalità non offerta da [Bind(Include ="â€¦")].</span><span class="sxs-lookup"><span data-stu-id="a8300-363">Second, separate binding models enforce separation of concerns between the shape used for user input and the shape used for persistence, something [Bind(Include ="â€¦")] does not do.</span></span> <span data-ttu-id="a8300-364">In terzo luogo, [Bind(Include ="â€¦")] può gestire solo le proprietà di livello superiore e non è quindi possibile consentire solo parti di proprietà secondarie (come "Details.Name") nell'attributo.</span><span class="sxs-lookup"><span data-stu-id="a8300-364">Third, note that [Bind(Include ="â€¦")] can only handle top-level properties; you cannot allow only portions of sub-properties (such as "Details.Name") in the attribute.</span></span> <span data-ttu-id="a8300-365">Infine e forse soprattutto, l'uso di [Bind(Include ="â€¦")] comporta un passaggio aggiuntivo da ricordare ogni volta che la classe viene usata per l'associazione di modelli.</span><span class="sxs-lookup"><span data-stu-id="a8300-365">Finally, and perhaps most importantly, using [Bind(Include ="â€¦")] adds an extra step that must be remembered any time the class is used for model binding.</span></span> <span data-ttu-id="a8300-366">Se un nuovo metodo di azione esegue l'associazione diretta alla classe dati senza includere un attributo [Bind(Include ="â€¦")], può essere vulnerabile ad attacchi di overposting. Di conseguenza, l'approccio [Bind(Include ="â€¦")] è un po' meno sicuro per impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="a8300-366">If a new action method binds to the data class directly and forgets to include a [Bind(Include ="â€¦")] attribute, it can be vulnerable to over-posting attacks, so the [Bind(Include ="â€¦")] approach is somewhat less secure by default.</span></span> <span data-ttu-id="a8300-367">Se si usa [Bind(Include ="â€¦")], ricordare di specificarlo ogni volta che le classi dati vengono incluse come parametri di metodi di azione.</span><span class="sxs-lookup"><span data-stu-id="a8300-367">If you use [Bind(Include ="â€¦")], take care always to remember to specify it every time your data classes appear as action method parameters.</span></span></li><li><span data-ttu-id="a8300-368">**Per le operazioni di creazione, l'inserimento dell'attributo [Bind(Include ="â€¦")] nella classe modello evita di dover ricordare di inserire l'attributo in ogni metodo di azione?** Questo approccio funziona in alcuni casi.</span><span class="sxs-lookup"><span data-stu-id="a8300-368">**For Create operations, what about putting the [Bind(Include ="â€¦")] attribute on the model class itself? Does not this approach avoid the need to remember putting the attribute on every action method? -** This approach works in some cases.</span></span> <span data-ttu-id="a8300-369">L'uso di [Bind(Include ="â€¦")] nel tipo di modello (anziché nei parametri di azione che usano la classe) evita di dover ricordare di includere l'attributo [Bind(Include ="â€¦")] in ogni metodo di azione.</span><span class="sxs-lookup"><span data-stu-id="a8300-369">Using [Bind(Include ="â€¦")] on the model type itself (rather than on action parameters using this class), does avoid the need to remember to include the [Bind(Include ="â€¦")] attribute on every action method.</span></span> <span data-ttu-id="a8300-370">Usando l'attributo direttamente nella classe, si crea di fatto una superficie di attacco separata di tale classe ai fini dell'associazione di modelli.</span><span class="sxs-lookup"><span data-stu-id="a8300-370">Using the attribute directly on the class effectively creates a separate surface area of this class for model binding purposes.</span></span> <span data-ttu-id="a8300-371">Questo approccio, tuttavia, supporta una sola forma di associazione di modelli per classe modello.</span><span class="sxs-lookup"><span data-stu-id="a8300-371">However, this approach only allows for one model binding shape per model class.</span></span> <span data-ttu-id="a8300-372">Se un metodo di azione deve consentire l'associazione di modelli di un campo (come ad esempio un'azione riservata all'amministratore che aggiorna i ruoli utente) mentre le altre azioni devono impedire l'associazione di modelli di tale campo, questo approccio non funziona.</span><span class="sxs-lookup"><span data-stu-id="a8300-372">If one action method needs to allow model binding of a field (for example, an administrator-only action that updates user roles) and other actions need to prevent model binding of this field, this approach will not work.</span></span> <span data-ttu-id="a8300-373">Ogni classe può avere una sola forma di associazione di modelli. Se azioni diverse richiedono forme di associazione di modelli diverse, devono rappresentare queste forme separate usando classi di associazione di modelli separate oppure attributi [Bind(Include ="â€¦")] separati nei metodi di azione.</span><span class="sxs-lookup"><span data-stu-id="a8300-373">Each class can only have one model binding shape; if different actions need different model binding shapes, they need to represent these separate shapes using either separate model binding classes or separate [Bind(Include ="â€¦")] attributes on the action methods.</span></span></li><li><span data-ttu-id="a8300-374">**Che cosa sono i modelli di associazione? Sono uguali ai modelli di visualizzazione?** Si tratta di due concetti correlati.</span><span class="sxs-lookup"><span data-stu-id="a8300-374">**What are binding models? Are they the same thing as view models? -** These are two related concepts.</span></span> <span data-ttu-id="a8300-375">Il termine modello di associazione indica una classe modello usata in un'azione come elenco di parametri, ossia la forma passata dall'associazione di modelli MVC al metodo di azione.</span><span class="sxs-lookup"><span data-stu-id="a8300-375">The term binding model refers to a model class used in an action is parameter list (the shape passed from MVC model binding to the action method).</span></span> <span data-ttu-id="a8300-376">Il termine modello di visualizzazione indica una classe modello passata da un metodo di azione a una visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="a8300-376">The term view model refers to a model class passed from an action method to a view.</span></span> <span data-ttu-id="a8300-377">L'uso di un modello specifico per la visualizzazione è un approccio comune per passare dati da un metodo di azione a una visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="a8300-377">Using a view-specific model is a common approach for passing data from an action method to a view.</span></span> <span data-ttu-id="a8300-378">Spesso, questa forma è particolarmente adatta per l'associazione del modello e il modello di visualizzazione termine consente di fare riferimento lo stesso modello utilizzato in entrambe le posizioni.</span><span class="sxs-lookup"><span data-stu-id="a8300-378">Often, this shape is also suitable for model binding, and the term view model can be used to refer the same model used in both places.</span></span> <span data-ttu-id="a8300-379">Per la precisione, questa procedura riguarda specificamente i modelli di associazione e si concentra sulla forma passata all'azione, rilevante ai fini dell'assegnazione di massa.</span><span class="sxs-lookup"><span data-stu-id="a8300-379">To be precise, this procedure talks specifically about binding models, focusing on the shape passed to the action, which is what matters for mass assignment purposes.</span></span></li></ul>| 

## <span data-ttu-id="a8300-380"><a id="rendering"></a>Codificare l'output Web non attendibile prima del rendering</span><span class="sxs-lookup"><span data-stu-id="a8300-380"><a id="rendering"></a>Encode untrusted web output prior to rendering</span></span>

| <span data-ttu-id="a8300-381">Titolo</span><span class="sxs-lookup"><span data-stu-id="a8300-381">Title</span></span>                   | <span data-ttu-id="a8300-382">Dettagli</span><span class="sxs-lookup"><span data-stu-id="a8300-382">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="a8300-383">**Componente**</span><span class="sxs-lookup"><span data-stu-id="a8300-383">**Component**</span></span>               | <span data-ttu-id="a8300-384">Applicazione Web.</span><span class="sxs-lookup"><span data-stu-id="a8300-384">Web Application</span></span> | 
| <span data-ttu-id="a8300-385">**Fase SDL**</span><span class="sxs-lookup"><span data-stu-id="a8300-385">**SDL Phase**</span></span>               | <span data-ttu-id="a8300-386">Compilare</span><span class="sxs-lookup"><span data-stu-id="a8300-386">Build</span></span> |  
| <span data-ttu-id="a8300-387">**Tecnologie applicabili**</span><span class="sxs-lookup"><span data-stu-id="a8300-387">**Applicable Technologies**</span></span> | <span data-ttu-id="a8300-388">Generico, Web Form, MVC 5, MVC 6</span><span class="sxs-lookup"><span data-stu-id="a8300-388">Generic, Web Forms, MVC5, MVC6</span></span> |
| <span data-ttu-id="a8300-389">**Attributes (Attributi) (Attributi)**</span><span class="sxs-lookup"><span data-stu-id="a8300-389">**Attributes**</span></span>              | <span data-ttu-id="a8300-390">N/D</span><span class="sxs-lookup"><span data-stu-id="a8300-390">N/A</span></span>  |
| <span data-ttu-id="a8300-391">**Riferimenti**</span><span class="sxs-lookup"><span data-stu-id="a8300-391">**References**</span></span>              | <span data-ttu-id="a8300-392">[How to prevent Cross-site scripting in ASP.NET](http://msdn.microsoft.com/library/ms998274.aspx) (Come impedire attacchi tramite script da altri siti in ASP.NET), [Cross-site Scripting](http://cwe.mitre.org/data/definitions/79.html) (Attacchi tramite script da altri siti), [XSS (Cross Site Scripting) Prevention Cheat Sheet](https://www.owasp.org/index.php/XSS_(Cross_Site_Scripting)_Prevention_Cheat_Sheet) (Foglio informativo sulla prevenzione degli attacchi tramite script da altri siti)</span><span class="sxs-lookup"><span data-stu-id="a8300-392">[How to prevent Cross-site scripting in ASP.NET](http://msdn.microsoft.com/library/ms998274.aspx), [Cross-site Scripting](http://cwe.mitre.org/data/definitions/79.html), [XSS (Cross Site Scripting) Prevention Cheat Sheet](https://www.owasp.org/index.php/XSS_(Cross_Site_Scripting)_Prevention_Cheat_Sheet)</span></span> |
| <span data-ttu-id="a8300-393">**Passaggi**</span><span class="sxs-lookup"><span data-stu-id="a8300-393">**Steps**</span></span> | <span data-ttu-id="a8300-394">Gli attacchi tramite script da altri siti (comunemente abbreviati in XSS, Cross-Site Scripting) sono un vettore di attacco per i servizi online o qualsiasi applicazione/componente che utilizza input dal Web.</span><span class="sxs-lookup"><span data-stu-id="a8300-394">Cross-site scripting (commonly abbreviated as XSS) is an attack vector for online services or any application/component that consumes input from the web.</span></span> <span data-ttu-id="a8300-395">Le vulnerabilità XSS possono consentire a un utente malintenzionato di eseguire script sul computer di un altro utente tramite un'applicazione Web vulnerabile.</span><span class="sxs-lookup"><span data-stu-id="a8300-395">XSS vulnerabilities may allow an attacker to execute script on another user's machine through a vulnerable web application.</span></span> <span data-ttu-id="a8300-396">Gli script dannosi possono essere usati per rubare cookie o manomettere in altro modo il computer di una vittima tramite JavaScript.</span><span class="sxs-lookup"><span data-stu-id="a8300-396">Malicious scripts can be used to steal cookies and otherwise tamper with a victim's machine through JavaScript.</span></span> <span data-ttu-id="a8300-397">È possibile impedire attacchi XSS convalidando l'input utente e verificando che il formato e la codifica siano corretti prima di eseguirne il rendering in una pagina Web.</span><span class="sxs-lookup"><span data-stu-id="a8300-397">XSS is prevented by validating user input, ensuring it is well formed and encoding before it is rendered in a web page.</span></span> <span data-ttu-id="a8300-398">La convalida dell'input e la codifica dell'output possono essere eseguite con Web Protection Library.</span><span class="sxs-lookup"><span data-stu-id="a8300-398">Input validation and output encoding can be done by using Web Protection Library.</span></span> <span data-ttu-id="a8300-399">Per il codice gestito (C\#, VB.net e così via), usare uno o più metodi di codifica appropriati di Web Protection (Anti-XSS) Library, a seconda del contesto in cui si manifesta l'input utente:</span><span class="sxs-lookup"><span data-stu-id="a8300-399">For Managed code (C\#, VB.net, etc.), use one or more appropriate encoding methods from the Web Protection (Anti-XSS) Library, depending on the context where the user input gets manifested:</span></span>| 

### <a name="example"></a><span data-ttu-id="a8300-400">Esempio</span><span class="sxs-lookup"><span data-stu-id="a8300-400">Example</span></span>

```C#
* Encoder.HtmlEncode 
* Encoder.HtmlAttributeEncode 
* Encoder.JavaScriptEncode 
* Encoder.UrlEncode
* Encoder.VisualBasicScriptEncode 
* Encoder.XmlEncode 
* Encoder.XmlAttributeEncode 
* Encoder.CssEncode 
* Encoder.LdapEncode 
```

## <span data-ttu-id="a8300-401"><a id="typemodel"></a>Eseguire la convalida dell'input e applicare filtri a tutte le proprietà del modello di tipo stringa</span><span class="sxs-lookup"><span data-stu-id="a8300-401"><a id="typemodel"></a>Perform input validation and filtering on all string type Model properties</span></span>

| <span data-ttu-id="a8300-402">Titolo</span><span class="sxs-lookup"><span data-stu-id="a8300-402">Title</span></span>                   | <span data-ttu-id="a8300-403">Dettagli</span><span class="sxs-lookup"><span data-stu-id="a8300-403">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="a8300-404">**Componente**</span><span class="sxs-lookup"><span data-stu-id="a8300-404">**Component**</span></span>               | <span data-ttu-id="a8300-405">Applicazione Web.</span><span class="sxs-lookup"><span data-stu-id="a8300-405">Web Application</span></span> | 
| <span data-ttu-id="a8300-406">**Fase SDL**</span><span class="sxs-lookup"><span data-stu-id="a8300-406">**SDL Phase**</span></span>               | <span data-ttu-id="a8300-407">Compilare</span><span class="sxs-lookup"><span data-stu-id="a8300-407">Build</span></span> |  
| <span data-ttu-id="a8300-408">**Tecnologie applicabili**</span><span class="sxs-lookup"><span data-stu-id="a8300-408">**Applicable Technologies**</span></span> | <span data-ttu-id="a8300-409">Generico, MVC 5, MVC 6</span><span class="sxs-lookup"><span data-stu-id="a8300-409">Generic, MVC5, MVC6</span></span> |
| <span data-ttu-id="a8300-410">**Attributes (Attributi) (Attributi)**</span><span class="sxs-lookup"><span data-stu-id="a8300-410">**Attributes**</span></span>              | <span data-ttu-id="a8300-411">N/D</span><span class="sxs-lookup"><span data-stu-id="a8300-411">N/A</span></span>  |
| <span data-ttu-id="a8300-412">**Riferimenti**</span><span class="sxs-lookup"><span data-stu-id="a8300-412">**References**</span></span>              | <span data-ttu-id="a8300-413">[Adding Validation](http://www.asp.net/mvc/overview/getting-started/introduction/adding-validation) (Aggiunta della convalida), [Validating Model Data in an MVC Application](http://msdn.microsoft.com/library/dd410404(v=vs.90).aspx) (Convalida dei dati del modello in un'applicazione MVC), [Principi guida per le applicazioni ASP.NET MVC](http://msdn.microsoft.com/magazine/dd942822.aspx)</span><span class="sxs-lookup"><span data-stu-id="a8300-413">[Adding Validation](http://www.asp.net/mvc/overview/getting-started/introduction/adding-validation), [Validating Model Data in an MVC Application](http://msdn.microsoft.com/library/dd410404(v=vs.90).aspx), [Guiding Principles For Your ASP.NET MVC Applications](http://msdn.microsoft.com/magazine/dd942822.aspx)</span></span> |
| <span data-ttu-id="a8300-414">**Passaggi**</span><span class="sxs-lookup"><span data-stu-id="a8300-414">**Steps**</span></span> | <p><span data-ttu-id="a8300-415">Tutti i parametri di input devono essere convalidati prima di essere usati nell'applicazione per garantire la protezione dell'applicazione da input utente dannosi.</span><span class="sxs-lookup"><span data-stu-id="a8300-415">All the input parameters must be validated before they are used in the application to ensure that the application is safeguarded against malicious user inputs.</span></span> <span data-ttu-id="a8300-416">Convalidare i valori di input usando espressioni regolari sul lato server con una strategia di convalida tramite elenchi degli elementi consentiti.</span><span class="sxs-lookup"><span data-stu-id="a8300-416">Validate the input values using regular expression validations on server side with a whitelist validation strategy.</span></span> <span data-ttu-id="a8300-417">I parametri o gli input utente non purificati passati ai metodi possono causare vulnerabilità a code injection.</span><span class="sxs-lookup"><span data-stu-id="a8300-417">Unsanitized user inputs / parameters passed to the methods can cause code injection vulnerabilities.</span></span></p><p><span data-ttu-id="a8300-418">Per le applicazioni Web, i punti di ingresso possono includere anche campi modulo, stringhe di query, cookie, intestazioni HTTP e parametri del servizio Web.</span><span class="sxs-lookup"><span data-stu-id="a8300-418">For web applications, entry points can also include form fields, QueryStrings, cookies, HTTP headers, and web service parameters.</span></span></p><p><span data-ttu-id="a8300-419">All'associazione di modelli devono essere eseguiti i controlli di convalida dell'input seguenti:</span><span class="sxs-lookup"><span data-stu-id="a8300-419">The following input validation checks must be performed upon model binding:</span></span></p><ul><li><span data-ttu-id="a8300-420">Nelle proprietà dei modelli deve essere usata l'annotazione RegularExpression, per l'accettazione dei caratteri e della lunghezza massima consentiti</span><span class="sxs-lookup"><span data-stu-id="a8300-420">The model properties should be annotated with RegularExpression annotation, for accepting allowed characters and maximum permissible length</span></span></li><li><span data-ttu-id="a8300-421">I metodi del controller devono eseguire la convalida ModelState</span><span class="sxs-lookup"><span data-stu-id="a8300-421">The controller methods should perform ModelState validity</span></span></li></ul>|

## <span data-ttu-id="a8300-422"><a id="richtext"></a>Applicazione della purificazione nei campi modulo che accettano tutti i caratteri, ad esempio un editor di testo RTF</span><span class="sxs-lookup"><span data-stu-id="a8300-422"><a id="richtext"></a>Sanitization should be applied on form fields that accept all characters, e.g, rich text editor</span></span>

| <span data-ttu-id="a8300-423">Titolo</span><span class="sxs-lookup"><span data-stu-id="a8300-423">Title</span></span>                   | <span data-ttu-id="a8300-424">Dettagli</span><span class="sxs-lookup"><span data-stu-id="a8300-424">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="a8300-425">**Componente**</span><span class="sxs-lookup"><span data-stu-id="a8300-425">**Component**</span></span>               | <span data-ttu-id="a8300-426">Applicazione Web.</span><span class="sxs-lookup"><span data-stu-id="a8300-426">Web Application</span></span> | 
| <span data-ttu-id="a8300-427">**Fase SDL**</span><span class="sxs-lookup"><span data-stu-id="a8300-427">**SDL Phase**</span></span>               | <span data-ttu-id="a8300-428">Compilare</span><span class="sxs-lookup"><span data-stu-id="a8300-428">Build</span></span> |  
| <span data-ttu-id="a8300-429">**Tecnologie applicabili**</span><span class="sxs-lookup"><span data-stu-id="a8300-429">**Applicable Technologies**</span></span> | <span data-ttu-id="a8300-430">Generico</span><span class="sxs-lookup"><span data-stu-id="a8300-430">Generic</span></span> |
| <span data-ttu-id="a8300-431">**Attributes (Attributi) (Attributi)**</span><span class="sxs-lookup"><span data-stu-id="a8300-431">**Attributes**</span></span>              | <span data-ttu-id="a8300-432">N/D</span><span class="sxs-lookup"><span data-stu-id="a8300-432">N/A</span></span>  |
| <span data-ttu-id="a8300-433">**Riferimenti**</span><span class="sxs-lookup"><span data-stu-id="a8300-433">**References**</span></span>              | <span data-ttu-id="a8300-434">[Encode Unsafe Input](https://msdn.microsoft.com/library/ff647397.aspx#paght000003_step3) (Codificare l'input non sicuro), [HtmlSanitizer](https://github.com/mganss/HtmlSanitizer)</span><span class="sxs-lookup"><span data-stu-id="a8300-434">[Encode Unsafe Input](https://msdn.microsoft.com/library/ff647397.aspx#paght000003_step3), [HTML Sanitizer](https://github.com/mganss/HtmlSanitizer)</span></span> |
| <span data-ttu-id="a8300-435">**Passaggi**</span><span class="sxs-lookup"><span data-stu-id="a8300-435">**Steps**</span></span> | <p><span data-ttu-id="a8300-436">Identificare tutti i tag di markup statici che si vogliono usare.</span><span class="sxs-lookup"><span data-stu-id="a8300-436">Identify all static markup tags that you want to use.</span></span> <span data-ttu-id="a8300-437">Una procedura comune consiste nel limitare la formattazione a elementi HTML sicuri, come `<b>` (grassetto) e `<i>` (corsivo).</span><span class="sxs-lookup"><span data-stu-id="a8300-437">A common practice is to restrict formatting to safe HTML elements, such as `<b>` (bold) and `<i>` (italic).</span></span></p><p><span data-ttu-id="a8300-438">Prima della scrittura dei dati, applicare la codifica HTML.</span><span class="sxs-lookup"><span data-stu-id="a8300-438">Before writing the data, HTML-encode it.</span></span> <span data-ttu-id="a8300-439">In questo modo, eventuali script dannosi diventeranno sicuri perché verranno gestiti come testo anziché come codice eseguibile.</span><span class="sxs-lookup"><span data-stu-id="a8300-439">This makes any malicious script safe by causing it to be handled as text, not as executable code.</span></span></p><ol><li><span data-ttu-id="a8300-440">Disabilitare la convalida delle richieste ASP.NET aggiungendo l'attributo ValidateRequest="false" alla direttiva @ Page</span><span class="sxs-lookup"><span data-stu-id="a8300-440">Disable ASP.NET request validation by the adding the ValidateRequest="false" attribute to the @ Page directive</span></span></li><li><span data-ttu-id="a8300-441">Codificare l'input di stringa con il metodo HtmlEncode</span><span class="sxs-lookup"><span data-stu-id="a8300-441">Encode the string input with the HtmlEncode method</span></span></li><li><span data-ttu-id="a8300-442">Usare StringBuilder e chiamare il relativo metodo Replace per rimuovere in modo selettivo la codifica negli elementi HTML che si vuole consentire</span><span class="sxs-lookup"><span data-stu-id="a8300-442">Use a StringBuilder and call its Replace method to selectively remove the encoding on the HTML elements that you want to permit</span></span></li></ol><p><span data-ttu-id="a8300-443">La direttiva di pagina nei riferimenti disabilita la convalida delle richieste ASP.NET con l'impostazione `ValidateRequest="false"`,</span><span class="sxs-lookup"><span data-stu-id="a8300-443">The page-in the references disables ASP.NET request validation by setting `ValidateRequest="false"`.</span></span> <span data-ttu-id="a8300-444">applica la codifica HTML all'input e consente in modo selettivo `<b>` e `<i>`. In alternativa, è anche possibile usare una libreria .NET per la purificazione HTML.</span><span class="sxs-lookup"><span data-stu-id="a8300-444">It HTML-encodes the input and selectively allows the `<b>` and `<i>` Alternatively, a .NET library for HTML sanitization may also be used.</span></span></p><p><span data-ttu-id="a8300-445">HtmlSanitizer è una libreria .NET per la pulizia di documenti e frammenti HTML dei costrutti che possono causare attacchi XSS.</span><span class="sxs-lookup"><span data-stu-id="a8300-445">HtmlSanitizer is a .NET library for cleaning HTML fragments and documents from constructs that can lead to XSS attacks.</span></span> <span data-ttu-id="a8300-446">Per l'analisi, la manipolazione e il rendering di HTML e CSS usa AngleSharp.</span><span class="sxs-lookup"><span data-stu-id="a8300-446">It uses AngleSharp to parse, manipulate, and render HTML and CSS.</span></span> <span data-ttu-id="a8300-447">È possibile installare HtmlSanitizer come pacchetto NuGet e passare l'input utente attraverso i metodi di purificazione HTML o CSS pertinenti, a seconda dei casi, sul lato server.</span><span class="sxs-lookup"><span data-stu-id="a8300-447">HtmlSanitizer can be installed as a NuGet package, and the user input can be passed through relevant HTML or CSS sanitization methods, as applicable, on the server side.</span></span> <span data-ttu-id="a8300-448">Si noti che la purificazione deve essere presa in considerazione come controllo di sicurezza solo come ultima opzione.</span><span class="sxs-lookup"><span data-stu-id="a8300-448">Please note that Sanitization as a security control should be considered only as a last option.</span></span></p><p><span data-ttu-id="a8300-449">La convalida dell'input e la codifica dell'output sono considerati controlli di sicurezza più efficienti.</span><span class="sxs-lookup"><span data-stu-id="a8300-449">Input validation and Output Encoding are considered better security controls.</span></span></p> |

## <span data-ttu-id="a8300-450"><a id="inbuilt-encode"></a>Non assegnare elementi DOM a sink senza codifica incorporata</span><span class="sxs-lookup"><span data-stu-id="a8300-450"><a id="inbuilt-encode"></a>Do not assign DOM elements to sinks that do not have inbuilt encoding</span></span>

| <span data-ttu-id="a8300-451">Titolo</span><span class="sxs-lookup"><span data-stu-id="a8300-451">Title</span></span>                   | <span data-ttu-id="a8300-452">Dettagli</span><span class="sxs-lookup"><span data-stu-id="a8300-452">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="a8300-453">**Componente**</span><span class="sxs-lookup"><span data-stu-id="a8300-453">**Component**</span></span>               | <span data-ttu-id="a8300-454">Applicazione Web.</span><span class="sxs-lookup"><span data-stu-id="a8300-454">Web Application</span></span> | 
| <span data-ttu-id="a8300-455">**Fase SDL**</span><span class="sxs-lookup"><span data-stu-id="a8300-455">**SDL Phase**</span></span>               | <span data-ttu-id="a8300-456">Compilare</span><span class="sxs-lookup"><span data-stu-id="a8300-456">Build</span></span> |  
| <span data-ttu-id="a8300-457">**Tecnologie applicabili**</span><span class="sxs-lookup"><span data-stu-id="a8300-457">**Applicable Technologies**</span></span> | <span data-ttu-id="a8300-458">Generico</span><span class="sxs-lookup"><span data-stu-id="a8300-458">Generic</span></span> |
| <span data-ttu-id="a8300-459">**Attributes (Attributi) (Attributi)**</span><span class="sxs-lookup"><span data-stu-id="a8300-459">**Attributes**</span></span>              | <span data-ttu-id="a8300-460">N/D</span><span class="sxs-lookup"><span data-stu-id="a8300-460">N/A</span></span>  |
| <span data-ttu-id="a8300-461">**Riferimenti**</span><span class="sxs-lookup"><span data-stu-id="a8300-461">**References**</span></span>              | <span data-ttu-id="a8300-462">N/D</span><span class="sxs-lookup"><span data-stu-id="a8300-462">N/A</span></span>  |
| <span data-ttu-id="a8300-463">**Passaggi**</span><span class="sxs-lookup"><span data-stu-id="a8300-463">**Steps**</span></span> | <span data-ttu-id="a8300-464">Molte funzioni JavaScript non eseguono la codifica per impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="a8300-464">Many javascript functions don't do encoding by default.</span></span> <span data-ttu-id="a8300-465">L'assegnazione di input non attendibile a elementi DOM tramite funzioni di questo tipo può determinare attacchi tramite script da altri siti (XSS).</span><span class="sxs-lookup"><span data-stu-id="a8300-465">When assigning untrusted input to DOM elements via such functions, may result in cross site script (XSS) executions.</span></span>| 

### <a name="example"></a><span data-ttu-id="a8300-466">Esempio</span><span class="sxs-lookup"><span data-stu-id="a8300-466">Example</span></span>
<span data-ttu-id="a8300-467">Gli esempi seguenti non sono sicuri:</span><span class="sxs-lookup"><span data-stu-id="a8300-467">Following are insecure examples:</span></span> 

```
document.getElementByID("div1").innerHtml = value;
$("#userName").html(res.Name);
return $('<div/>').html(value)
$('body').append(resHTML);   
```
<span data-ttu-id="a8300-468">Non usare `innerHtml`. Usare invece `innerText`.</span><span class="sxs-lookup"><span data-stu-id="a8300-468">Don't use `innerHtml`; instead use `innerText`.</span></span> <span data-ttu-id="a8300-469">Analogamente, usare `$("#elm").text()` invece di `$("#elm").html()`.</span><span class="sxs-lookup"><span data-stu-id="a8300-469">Similarly, instead of `$("#elm").html()`, use `$("#elm").text()`</span></span> 

## <span data-ttu-id="a8300-470"><a id="redirect-safe"></a>Convalidare come chiusi o sicuri tutti i reindirizzamenti nell'applicazione</span><span class="sxs-lookup"><span data-stu-id="a8300-470"><a id="redirect-safe"></a>Validate all redirects within the application are closed or done safely</span></span>

| <span data-ttu-id="a8300-471">Titolo</span><span class="sxs-lookup"><span data-stu-id="a8300-471">Title</span></span>                   | <span data-ttu-id="a8300-472">Dettagli</span><span class="sxs-lookup"><span data-stu-id="a8300-472">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="a8300-473">**Componente**</span><span class="sxs-lookup"><span data-stu-id="a8300-473">**Component**</span></span>               | <span data-ttu-id="a8300-474">Applicazione Web.</span><span class="sxs-lookup"><span data-stu-id="a8300-474">Web Application</span></span> | 
| <span data-ttu-id="a8300-475">**Fase SDL**</span><span class="sxs-lookup"><span data-stu-id="a8300-475">**SDL Phase**</span></span>               | <span data-ttu-id="a8300-476">Compilare</span><span class="sxs-lookup"><span data-stu-id="a8300-476">Build</span></span> |  
| <span data-ttu-id="a8300-477">**Tecnologie applicabili**</span><span class="sxs-lookup"><span data-stu-id="a8300-477">**Applicable Technologies**</span></span> | <span data-ttu-id="a8300-478">Generico</span><span class="sxs-lookup"><span data-stu-id="a8300-478">Generic</span></span> |
| <span data-ttu-id="a8300-479">**Attributes (Attributi) (Attributi)**</span><span class="sxs-lookup"><span data-stu-id="a8300-479">**Attributes**</span></span>              | <span data-ttu-id="a8300-480">N/D</span><span class="sxs-lookup"><span data-stu-id="a8300-480">N/A</span></span>  |
| <span data-ttu-id="a8300-481">**Riferimenti**</span><span class="sxs-lookup"><span data-stu-id="a8300-481">**References**</span></span>              | <span data-ttu-id="a8300-482">[The OAuth 2.0 Authorization Framework - Open Redirectors](http://tools.ietf.org/html/rfc6749#section-10.15) (Framework di autorizzazione di OAuth 2.0 - Redirector aperti)</span><span class="sxs-lookup"><span data-stu-id="a8300-482">[The OAuth 2.0 Authorization Framework - Open Redirectors](http://tools.ietf.org/html/rfc6749#section-10.15)</span></span> |
| <span data-ttu-id="a8300-483">**Passaggi**</span><span class="sxs-lookup"><span data-stu-id="a8300-483">**Steps**</span></span> | <p><span data-ttu-id="a8300-484">Se la progettazione dell'applicazione richiede il reindirizzamento a un percorso specificato dall'utente, è necessario vincolare le possibile destinazioni di reindirizzamento a un elenco "sicuro" predefinito di siti o domini.</span><span class="sxs-lookup"><span data-stu-id="a8300-484">Application design requiring redirection to a user-supplied location must constrain the possible redirection targets to a predefined "safe" list of sites or domains.</span></span> <span data-ttu-id="a8300-485">Tutti i reindirizzamenti nell'applicazione devono essere chiusi/sicuri.</span><span class="sxs-lookup"><span data-stu-id="a8300-485">All redirects in the application must be closed/safe.</span></span></p><p><span data-ttu-id="a8300-486">A tale scopo, seguire questa procedura:</span><span class="sxs-lookup"><span data-stu-id="a8300-486">To do this:</span></span></p><ul><li><span data-ttu-id="a8300-487">Identificare tutti i reindirizzamenti.</span><span class="sxs-lookup"><span data-stu-id="a8300-487">Identify all redirects</span></span></li><li><span data-ttu-id="a8300-488">Implementare una procedura di mitigazione appropriata per ogni reindirizzamento.</span><span class="sxs-lookup"><span data-stu-id="a8300-488">Implement an appropriate mitigation for each redirect.</span></span> <span data-ttu-id="a8300-489">Le procedure di mitigazione appropriate includono un elenco elementi consentiti di reindirizzamento o la conferma dell'utente.</span><span class="sxs-lookup"><span data-stu-id="a8300-489">Appropriate mitigations include redirect whitelist or user confirmation.</span></span> <span data-ttu-id="a8300-490">Se un servizio o un sito Web con una vulnerabilità causata da reindirizzamenti aperti usa i provider di identità Facebook/OAuth/OpenID, un utente malintenzionato può rubare il token di accesso di un utente e rappresentare tale utente.</span><span class="sxs-lookup"><span data-stu-id="a8300-490">If a web site or service with an open redirect vulnerability uses Facebook/OAuth/OpenID identity providers, an attacker can steal a user's logon token and impersonate that user.</span></span> <span data-ttu-id="a8300-491">Si tratta di un rischio intrinseco quando si usa OAuth, come documentato nella sezione 10.15 relativa ai reindirizzamenti aperti della specifica RFC 6749 del framework di autorizzazione di OAuth 2.0. Analogamente, le credenziali degli utenti possono essere compromesse da attacchi di spear phishing con reindirizzamenti aperti.</span><span class="sxs-lookup"><span data-stu-id="a8300-491">This is an inherent risk when using OAuth, which is documented in RFC 6749 "The OAuth 2.0 Authorization Framework", Section 10.15 "Open Redirects" Similarly, users' credentials can be compromised by spear phishing attacks using open redirects</span></span></li></ul>|

## <span data-ttu-id="a8300-492"><a id="string-method"></a>Implementare la convalida dell'input in un tutti i parametri di tipo stringa accettati dai metodi del controller</span><span class="sxs-lookup"><span data-stu-id="a8300-492"><a id="string-method"></a>Implement input validation on all string type parameters accepted by Controller methods</span></span>

| <span data-ttu-id="a8300-493">Titolo</span><span class="sxs-lookup"><span data-stu-id="a8300-493">Title</span></span>                   | <span data-ttu-id="a8300-494">Dettagli</span><span class="sxs-lookup"><span data-stu-id="a8300-494">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="a8300-495">**Componente**</span><span class="sxs-lookup"><span data-stu-id="a8300-495">**Component**</span></span>               | <span data-ttu-id="a8300-496">Applicazione Web.</span><span class="sxs-lookup"><span data-stu-id="a8300-496">Web Application</span></span> | 
| <span data-ttu-id="a8300-497">**Fase SDL**</span><span class="sxs-lookup"><span data-stu-id="a8300-497">**SDL Phase**</span></span>               | <span data-ttu-id="a8300-498">Compilare</span><span class="sxs-lookup"><span data-stu-id="a8300-498">Build</span></span> |  
| <span data-ttu-id="a8300-499">**Tecnologie applicabili**</span><span class="sxs-lookup"><span data-stu-id="a8300-499">**Applicable Technologies**</span></span> | <span data-ttu-id="a8300-500">Generico, MVC 5, MVC 6</span><span class="sxs-lookup"><span data-stu-id="a8300-500">Generic, MVC5, MVC6</span></span> |
| <span data-ttu-id="a8300-501">**Attributes (Attributi) (Attributi)**</span><span class="sxs-lookup"><span data-stu-id="a8300-501">**Attributes**</span></span>              | <span data-ttu-id="a8300-502">N/D</span><span class="sxs-lookup"><span data-stu-id="a8300-502">N/A</span></span>  |
| <span data-ttu-id="a8300-503">**Riferimenti**</span><span class="sxs-lookup"><span data-stu-id="a8300-503">**References**</span></span>              | <span data-ttu-id="a8300-504">[Validating Model Data in an MVC Application](http://msdn.microsoft.com/library/dd410404(v=vs.90).aspx) (Convalida dei dati del modello in un'applicazione MVC), [Principi guida per le applicazioni ASP.NET MVC](http://msdn.microsoft.com/magazine/dd942822.aspx)</span><span class="sxs-lookup"><span data-stu-id="a8300-504">[Validating Model Data in an MVC Application](http://msdn.microsoft.com/library/dd410404(v=vs.90).aspx), [Guiding Principles For Your ASP.NET MVC Applications](http://msdn.microsoft.com/magazine/dd942822.aspx)</span></span> |
| <span data-ttu-id="a8300-505">**Passaggi**</span><span class="sxs-lookup"><span data-stu-id="a8300-505">**Steps**</span></span> | <span data-ttu-id="a8300-506">Per i metodi che accettano come argomento solo un tipo di dati primitivo e non modelli, deve essere eseguita la convalida dell'input con un'espressione regolare.</span><span class="sxs-lookup"><span data-stu-id="a8300-506">For methods that just accept primitive data type, and not models as argument,input validation using Regular Expression should be done.</span></span> <span data-ttu-id="a8300-507">In questo caso, è necessario usare Regex.IsMatch con un criterio regex valido.</span><span class="sxs-lookup"><span data-stu-id="a8300-507">Here Regex.IsMatch should be used with a valid regex pattern.</span></span> <span data-ttu-id="a8300-508">Se l'input non corrisponde all'espressione regolare specificata, il controllo dovrà essere interrotto e dovrà essere visualizzato un avviso relativo all'errore di convalida.</span><span class="sxs-lookup"><span data-stu-id="a8300-508">If the input doesn't match the specified Regular Expression, control should not proceed further, and an adequate warning regarding validation failure should be displayed.</span></span>| 

## <span data-ttu-id="a8300-509"><a id="dos-expression"></a>Impostare il limite massimo di timeout per l'elaborazione di espressioni regolari per impedire attacchi DoS causati da espressioni regolari errate</span><span class="sxs-lookup"><span data-stu-id="a8300-509"><a id="dos-expression"></a>Set upper limit timeout for regular expression processing to prevent DoS due to bad regular expressions</span></span>

| <span data-ttu-id="a8300-510">Titolo</span><span class="sxs-lookup"><span data-stu-id="a8300-510">Title</span></span>                   | <span data-ttu-id="a8300-511">Dettagli</span><span class="sxs-lookup"><span data-stu-id="a8300-511">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="a8300-512">**Componente**</span><span class="sxs-lookup"><span data-stu-id="a8300-512">**Component**</span></span>               | <span data-ttu-id="a8300-513">Applicazione Web.</span><span class="sxs-lookup"><span data-stu-id="a8300-513">Web Application</span></span> | 
| <span data-ttu-id="a8300-514">**Fase SDL**</span><span class="sxs-lookup"><span data-stu-id="a8300-514">**SDL Phase**</span></span>               | <span data-ttu-id="a8300-515">Compilare</span><span class="sxs-lookup"><span data-stu-id="a8300-515">Build</span></span> |  
| <span data-ttu-id="a8300-516">**Tecnologie applicabili**</span><span class="sxs-lookup"><span data-stu-id="a8300-516">**Applicable Technologies**</span></span> | <span data-ttu-id="a8300-517">Generico, Web Form, MVC 5, MVC 6</span><span class="sxs-lookup"><span data-stu-id="a8300-517">Generic, Web Forms, MVC5, MVC6</span></span>  |
| <span data-ttu-id="a8300-518">**Attributes (Attributi) (Attributi)**</span><span class="sxs-lookup"><span data-stu-id="a8300-518">**Attributes**</span></span>              | <span data-ttu-id="a8300-519">N/D</span><span class="sxs-lookup"><span data-stu-id="a8300-519">N/A</span></span>  |
| <span data-ttu-id="a8300-520">**Riferimenti**</span><span class="sxs-lookup"><span data-stu-id="a8300-520">**References**</span></span>              | [<span data-ttu-id="a8300-521">Proprietà DefaultRegexMatchTimeout</span><span class="sxs-lookup"><span data-stu-id="a8300-521">DefaultRegexMatchTimeout Property </span></span>](https://msdn.microsoft.com/library/system.web.configuration.httpruntimesection.defaultregexmatchtimeout.aspx) |
| <span data-ttu-id="a8300-522">**Passaggi**</span><span class="sxs-lookup"><span data-stu-id="a8300-522">**Steps**</span></span> | <span data-ttu-id="a8300-523">Per prevenire attacchi Denial of Service contro espressioni regolari create in modo non corretto, che causano un elevato backtracking, impostare il timeout predefinito globale.</span><span class="sxs-lookup"><span data-stu-id="a8300-523">To ensure denial of service attacks against badly created regular expressions, that cause a lot of backtracking, set the global default timeout.</span></span> <span data-ttu-id="a8300-524">Se il tempo necessario per l'elaborazione è superiore al limite massimo definito, verrà generata un'eccezione di timeout.</span><span class="sxs-lookup"><span data-stu-id="a8300-524">If the processing time takes longer than the defined upper limit, it would throw a Timeout exception.</span></span> <span data-ttu-id="a8300-525">In assenza di configurazione, il timeout sarà infinito.</span><span class="sxs-lookup"><span data-stu-id="a8300-525">If nothing is configured, the timeout would be infinite.</span></span>| 

### <a name="example"></a><span data-ttu-id="a8300-526">Esempio</span><span class="sxs-lookup"><span data-stu-id="a8300-526">Example</span></span>
<span data-ttu-id="a8300-527">La configurazione seguente, ad esempio, genera un'eccezione RegexMatchTimeoutException se l'elaborazione richiede più di 5 secondi:</span><span class="sxs-lookup"><span data-stu-id="a8300-527">For example, the following configuration will throw a RegexMatchTimeoutException, if the processing takes more than 5 seconds:</span></span> 

```C#
<httpRuntime targetFramework="4.5" defaultRegexMatchTimeout="00:00:05" />
```

## <span data-ttu-id="a8300-528"><a id="html-razor"></a>Evitare di usare Html.Raw nelle visualizzazioni Razor</span><span class="sxs-lookup"><span data-stu-id="a8300-528"><a id="html-razor"></a>Avoid using Html.Raw in Razor views</span></span>

| <span data-ttu-id="a8300-529">Titolo</span><span class="sxs-lookup"><span data-stu-id="a8300-529">Title</span></span>                   | <span data-ttu-id="a8300-530">Dettagli</span><span class="sxs-lookup"><span data-stu-id="a8300-530">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="a8300-531">**Componente**</span><span class="sxs-lookup"><span data-stu-id="a8300-531">**Component**</span></span>               | <span data-ttu-id="a8300-532">Applicazione Web.</span><span class="sxs-lookup"><span data-stu-id="a8300-532">Web Application</span></span> | 
| <span data-ttu-id="a8300-533">**Fase SDL**</span><span class="sxs-lookup"><span data-stu-id="a8300-533">**SDL Phase**</span></span>               | <span data-ttu-id="a8300-534">Compilare</span><span class="sxs-lookup"><span data-stu-id="a8300-534">Build</span></span> |  
| <span data-ttu-id="a8300-535">**Tecnologie applicabili**</span><span class="sxs-lookup"><span data-stu-id="a8300-535">**Applicable Technologies**</span></span> | <span data-ttu-id="a8300-536">MVC 5, MVC 6</span><span class="sxs-lookup"><span data-stu-id="a8300-536">MVC5, MVC6</span></span> |
| <span data-ttu-id="a8300-537">**Attributes (Attributi) (Attributi)**</span><span class="sxs-lookup"><span data-stu-id="a8300-537">**Attributes**</span></span>              | <span data-ttu-id="a8300-538">N/D</span><span class="sxs-lookup"><span data-stu-id="a8300-538">N/A</span></span>  |
| <span data-ttu-id="a8300-539">**Riferimenti**</span><span class="sxs-lookup"><span data-stu-id="a8300-539">**References**</span></span>              | <span data-ttu-id="a8300-540">N/D</span><span class="sxs-lookup"><span data-stu-id="a8300-540">N/A</span></span>  |
| <span data-ttu-id="a8300-541">Passaggio</span><span class="sxs-lookup"><span data-stu-id="a8300-541">Step</span></span> | <span data-ttu-id="a8300-542">Le pagine Web ASP.Net (Razor) eseguono la codifica HTML automatica.</span><span class="sxs-lookup"><span data-stu-id="a8300-542">ASP.Net WebPages (Razor) perform automatic HTML encoding.</span></span> <span data-ttu-id="a8300-543">A tutte le stringhe stampate da nugget di codice incorporati (blocchi @) viene applicata automaticamente la codifica HTML.</span><span class="sxs-lookup"><span data-stu-id="a8300-543">All strings printed by embedded code nuggets (@ blocks) are automatically HTML-encoded.</span></span> <span data-ttu-id="a8300-544">Quando viene richiamato `HtmlHelper.Raw`, tuttavia, questo metodo restituisce markup senza codifica HTML.</span><span class="sxs-lookup"><span data-stu-id="a8300-544">However, when `HtmlHelper.Raw` Method is invoked, it returns markup that is not HTML encoded.</span></span> <span data-ttu-id="a8300-545">Se viene usato il metodo helper `Html.Raw()`, questo ignora la protezione con codifica automatica fornita da Razor.</span><span class="sxs-lookup"><span data-stu-id="a8300-545">If `Html.Raw()` helper method is used, it bypasses the automatic encoding protection that Razor provides.</span></span>|

### <a name="example"></a><span data-ttu-id="a8300-546">Esempio</span><span class="sxs-lookup"><span data-stu-id="a8300-546">Example</span></span>
<span data-ttu-id="a8300-547">L'esempio seguente non è sicuro:</span><span class="sxs-lookup"><span data-stu-id="a8300-547">Following is an insecure example:</span></span> 

```C#
<div class="form-group">
            @Html.Raw(Model.AccountConfirmText)
        </div>
        <div class="form-group">
            @Html.Raw(Model.PaymentConfirmText)
        </div>
</div>
```
<span data-ttu-id="a8300-548">Non usare `Html.Raw()` a meno che non sia necessario visualizzare markup.</span><span class="sxs-lookup"><span data-stu-id="a8300-548">Do not use `Html.Raw()` unless you need to display markup.</span></span> <span data-ttu-id="a8300-549">Questo metodo non esegue implicitamente la codifica dell'output.</span><span class="sxs-lookup"><span data-stu-id="a8300-549">This method does not perform output encoding implicitly.</span></span> <span data-ttu-id="a8300-550">Usare altri helper ASP.NET, ad esempio `@Html.DisplayFor()`</span><span class="sxs-lookup"><span data-stu-id="a8300-550">Use other ASP.NET helpers e.g., `@Html.DisplayFor()`</span></span> 

## <span data-ttu-id="a8300-551"><a id="stored-proc"></a>Non usare query dinamiche nelle stored procedure</span><span class="sxs-lookup"><span data-stu-id="a8300-551"><a id="stored-proc"></a>Do not use dynamic queries in stored procedures</span></span>

| <span data-ttu-id="a8300-552">Titolo</span><span class="sxs-lookup"><span data-stu-id="a8300-552">Title</span></span>                   | <span data-ttu-id="a8300-553">Dettagli</span><span class="sxs-lookup"><span data-stu-id="a8300-553">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="a8300-554">**Componente**</span><span class="sxs-lookup"><span data-stu-id="a8300-554">**Component**</span></span>               | <span data-ttu-id="a8300-555">Database</span><span class="sxs-lookup"><span data-stu-id="a8300-555">Database</span></span> | 
| <span data-ttu-id="a8300-556">**Fase SDL**</span><span class="sxs-lookup"><span data-stu-id="a8300-556">**SDL Phase**</span></span>               | <span data-ttu-id="a8300-557">Compilare</span><span class="sxs-lookup"><span data-stu-id="a8300-557">Build</span></span> |  
| <span data-ttu-id="a8300-558">**Tecnologie applicabili**</span><span class="sxs-lookup"><span data-stu-id="a8300-558">**Applicable Technologies**</span></span> | <span data-ttu-id="a8300-559">Generico</span><span class="sxs-lookup"><span data-stu-id="a8300-559">Generic</span></span> |
| <span data-ttu-id="a8300-560">**Attributes (Attributi) (Attributi)**</span><span class="sxs-lookup"><span data-stu-id="a8300-560">**Attributes**</span></span>              | <span data-ttu-id="a8300-561">N/D</span><span class="sxs-lookup"><span data-stu-id="a8300-561">N/A</span></span>  |
| <span data-ttu-id="a8300-562">**Riferimenti**</span><span class="sxs-lookup"><span data-stu-id="a8300-562">**References**</span></span>              | <span data-ttu-id="a8300-563">N/D</span><span class="sxs-lookup"><span data-stu-id="a8300-563">N/A</span></span>  |
| <span data-ttu-id="a8300-564">**Passaggi**</span><span class="sxs-lookup"><span data-stu-id="a8300-564">**Steps**</span></span> | <p><span data-ttu-id="a8300-565">Un attacco SQL injection sfrutta le vulnerabilità nella convalida dell'input per eseguire comandi arbitrari nel database.</span><span class="sxs-lookup"><span data-stu-id="a8300-565">A SQL injection attack exploits vulnerabilities in input validation to run arbitrary commands in the database.</span></span> <span data-ttu-id="a8300-566">Può verificarsi quando l'applicazione usa l'input per costruire istruzioni SQL dinamiche per accedere al database,</span><span class="sxs-lookup"><span data-stu-id="a8300-566">It can occur when your application uses input to construct dynamic SQL statements to access the database.</span></span> <span data-ttu-id="a8300-567">nonché se il codice usa stored procedure costituite da stringhe passate contenenti input utente non elaborato.</span><span class="sxs-lookup"><span data-stu-id="a8300-567">It can also occur if your code uses stored procedures that are passed strings that contain raw user input.</span></span> <span data-ttu-id="a8300-568">Con l'attacco SQL injection, l'utente malintenzionato può eseguire comandi arbitrari nel database.</span><span class="sxs-lookup"><span data-stu-id="a8300-568">Using the SQL injection attack, the attacker can execute arbitrary commands in the database.</span></span> <span data-ttu-id="a8300-569">Tutte le istruzioni SQL, incluse quelle nelle stored procedure, devono includere parametri.</span><span class="sxs-lookup"><span data-stu-id="a8300-569">All SQL statements (including the SQL statements in stored procedures) must be parameterized.</span></span> <span data-ttu-id="a8300-570">Le istruzioni SQL con parametri accetteranno senza problemi caratteri con un significato speciale per SQL (come la virgoletta singola) perché sono fortemente tipizzate.</span><span class="sxs-lookup"><span data-stu-id="a8300-570">Parameterized SQL statements will accept characters that have special meaning to SQL (like single quote) without problems because they are strongly typed.</span></span> |

### <a name="example"></a><span data-ttu-id="a8300-571">Esempio</span><span class="sxs-lookup"><span data-stu-id="a8300-571">Example</span></span>
<span data-ttu-id="a8300-572">L'esempio seguente è una stored procedure dinamica non sicura:</span><span class="sxs-lookup"><span data-stu-id="a8300-572">Following is an example of insecure dynamic Stored Procedure:</span></span> 

```C#
CREATE PROCEDURE [dbo].[uspGetProductsByCriteria]
(
  @productName nvarchar(200) = NULL,
  @startPrice float = NULL,
  @endPrice float = NULL
)
AS
 BEGIN
  DECLARE @sql nvarchar(max)
  SELECT @sql = ' SELECT ProductID, ProductName, Description, UnitPrice, ImagePath' +
       ' FROM dbo.Products WHERE 1 = 1 '
       PRINT @sql
  IF @productName IS NOT NULL
     SELECT @sql = @sql + ' AND ProductName LIKE ''%' + @productName + '%'''
  IF @startPrice IS NOT NULL
     SELECT @sql = @sql + ' AND UnitPrice > ''' + CONVERT(VARCHAR(10),@startPrice) + ''''
  IF @endPrice IS NOT NULL
     SELECT @sql = @sql + ' AND UnitPrice < ''' + CONVERT(VARCHAR(10),@endPrice) + ''''

  PRINT @sql
  EXEC(@sql)
 END
```

### <a name="example"></a><span data-ttu-id="a8300-573">Esempio</span><span class="sxs-lookup"><span data-stu-id="a8300-573">Example</span></span>
<span data-ttu-id="a8300-574">Di seguito è riportata la stessa stored procedure implementata in modo sicuro:</span><span class="sxs-lookup"><span data-stu-id="a8300-574">Following is the same stored procedure implemented securely:</span></span> 
```C#
CREATE PROCEDURE [dbo].[uspGetProductsByCriteriaSecure]
(
             @productName nvarchar(200) = NULL,
             @startPrice float = NULL,
             @endPrice float = NULL
)
AS
       BEGIN
             SELECT ProductID, ProductName, Description, UnitPrice, ImagePath
             FROM dbo.Products where
             (@productName IS NULL or ProductName like '%'+ @productName +'%')
             AND
             (@startPrice IS NULL or UnitPrice > @startPrice)
             AND
             (@endPrice IS NULL or UnitPrice < @endPrice)         
       END
```

## <span data-ttu-id="a8300-575"><a id="validation-api"></a>Verificare l'esecuzione della convalida dei modelli nei metodi di API Web</span><span class="sxs-lookup"><span data-stu-id="a8300-575"><a id="validation-api"></a>Ensure that model validation is done on Web API methods</span></span>

| <span data-ttu-id="a8300-576">Titolo</span><span class="sxs-lookup"><span data-stu-id="a8300-576">Title</span></span>                   | <span data-ttu-id="a8300-577">Dettagli</span><span class="sxs-lookup"><span data-stu-id="a8300-577">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="a8300-578">**Componente**</span><span class="sxs-lookup"><span data-stu-id="a8300-578">**Component**</span></span>               | <span data-ttu-id="a8300-579">API Web</span><span class="sxs-lookup"><span data-stu-id="a8300-579">Web API</span></span> | 
| <span data-ttu-id="a8300-580">**Fase SDL**</span><span class="sxs-lookup"><span data-stu-id="a8300-580">**SDL Phase**</span></span>               | <span data-ttu-id="a8300-581">Compilare</span><span class="sxs-lookup"><span data-stu-id="a8300-581">Build</span></span> |  
| <span data-ttu-id="a8300-582">**Tecnologie applicabili**</span><span class="sxs-lookup"><span data-stu-id="a8300-582">**Applicable Technologies**</span></span> | <span data-ttu-id="a8300-583">MVC 5, MVC 6</span><span class="sxs-lookup"><span data-stu-id="a8300-583">MVC5, MVC6</span></span> |
| <span data-ttu-id="a8300-584">**Attributes (Attributi) (Attributi)**</span><span class="sxs-lookup"><span data-stu-id="a8300-584">**Attributes**</span></span>              | <span data-ttu-id="a8300-585">N/D</span><span class="sxs-lookup"><span data-stu-id="a8300-585">N/A</span></span>  |
| <span data-ttu-id="a8300-586">**Riferimenti**</span><span class="sxs-lookup"><span data-stu-id="a8300-586">**References**</span></span>              | <span data-ttu-id="a8300-587">[Model Validation in ASP.NET Web API ](http://www.asp.net/web-api/overview/formats-and-model-binding/model-validation-in-aspnet-web-api) (Convalida dei modelli in un'API Web ASP.NET)</span><span class="sxs-lookup"><span data-stu-id="a8300-587">[Model Validation in ASP.NET Web API ](http://www.asp.net/web-api/overview/formats-and-model-binding/model-validation-in-aspnet-web-api)</span></span> |
| <span data-ttu-id="a8300-588">**Passaggi**</span><span class="sxs-lookup"><span data-stu-id="a8300-588">**Steps**</span></span> | <span data-ttu-id="a8300-589">Quando un client invia dati a un'API Web, è obbligatorio convalidare i dati prima di eseguire qualsiasi elaborazione.</span><span class="sxs-lookup"><span data-stu-id="a8300-589">When a client sends data to a web API, it is mandatory to validate the data before doing any processing.</span></span> <span data-ttu-id="a8300-590">Per le API Web ASP.NET che accettano modelli come input, usare le annotazioni dei dati nei modelli per impostare le regole di convalida nelle proprietà dei modelli.</span><span class="sxs-lookup"><span data-stu-id="a8300-590">For ASP.NET Web APIs which accept models as input, use data annotations on models to set validation rules on the properties of the model.</span></span>|

### <a name="example"></a><span data-ttu-id="a8300-591">Esempio</span><span class="sxs-lookup"><span data-stu-id="a8300-591">Example</span></span>
<span data-ttu-id="a8300-592">Il codice seguente illustra quanto descritto sopra:</span><span class="sxs-lookup"><span data-stu-id="a8300-592">The following code demonstrates the same:</span></span> 

```C#
using System.ComponentModel.DataAnnotations;

namespace MyApi.Models
{
    public class Product
    {
        public int Id { get; set; }
        [Required]
        [RegularExpression(@"^[a-zA-Z0-9]*$", ErrorMessage="Only alphanumeric characters are allowed.")]
        public string Name { get; set; }
        public decimal Price { get; set; }
        [Range(0, 999)]
        public double Weight { get; set; }
    }
}
```

### <a name="example"></a><span data-ttu-id="a8300-593">Esempio</span><span class="sxs-lookup"><span data-stu-id="a8300-593">Example</span></span>
<span data-ttu-id="a8300-594">Nel metodo di azione dei controller dell'API la validità del modello deve essere selezionata in modo esplicito come illustrato di seguito:</span><span class="sxs-lookup"><span data-stu-id="a8300-594">In the action method of the API controllers, validity of the model has to be explicitly checked as shown below:</span></span> 

```C#
namespace MyApi.Controllers
{
    public class ProductsController : ApiController
    {
        public HttpResponseMessage Post(Product product)
        {
            if (ModelState.IsValid)
            {
                // Do something with the product (not shown).

                return new HttpResponseMessage(HttpStatusCode.OK);
            }
            else
            {
                return Request.CreateErrorResponse(HttpStatusCode.BadRequest, ModelState);
            }
        }
    }
}
```

## <span data-ttu-id="a8300-595"><a id="string-api"></a>Implementare la convalida dell'input in tutti i parametri di tipo stringa accettati dai metodi di API Web</span><span class="sxs-lookup"><span data-stu-id="a8300-595"><a id="string-api"></a>Implement input validation on all string type parameters accepted by Web API methods</span></span>

| <span data-ttu-id="a8300-596">Titolo</span><span class="sxs-lookup"><span data-stu-id="a8300-596">Title</span></span>                   | <span data-ttu-id="a8300-597">Dettagli</span><span class="sxs-lookup"><span data-stu-id="a8300-597">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="a8300-598">**Componente**</span><span class="sxs-lookup"><span data-stu-id="a8300-598">**Component**</span></span>               | <span data-ttu-id="a8300-599">API Web</span><span class="sxs-lookup"><span data-stu-id="a8300-599">Web API</span></span> | 
| <span data-ttu-id="a8300-600">**Fase SDL**</span><span class="sxs-lookup"><span data-stu-id="a8300-600">**SDL Phase**</span></span>               | <span data-ttu-id="a8300-601">Compilare</span><span class="sxs-lookup"><span data-stu-id="a8300-601">Build</span></span> |  
| <span data-ttu-id="a8300-602">**Tecnologie applicabili**</span><span class="sxs-lookup"><span data-stu-id="a8300-602">**Applicable Technologies**</span></span> | <span data-ttu-id="a8300-603">Generico, MVC 5, MVC 6</span><span class="sxs-lookup"><span data-stu-id="a8300-603">Generic, MVC 5, MVC 6</span></span> |
| <span data-ttu-id="a8300-604">**Attributes (Attributi) (Attributi)**</span><span class="sxs-lookup"><span data-stu-id="a8300-604">**Attributes**</span></span>              | <span data-ttu-id="a8300-605">N/D</span><span class="sxs-lookup"><span data-stu-id="a8300-605">N/A</span></span>  |
| <span data-ttu-id="a8300-606">**Riferimenti**</span><span class="sxs-lookup"><span data-stu-id="a8300-606">**References**</span></span>              | <span data-ttu-id="a8300-607">[Validating Model Data in an MVC Application](http://msdn.microsoft.com/library/dd410404(v=vs.90).aspx) (Convalida dei dati del modello in un'applicazione MVC), [Principi guida per le applicazioni ASP.NET MVC](http://msdn.microsoft.com/magazine/dd942822.aspx)</span><span class="sxs-lookup"><span data-stu-id="a8300-607">[Validating Model Data in an MVC Application](http://msdn.microsoft.com/library/dd410404(v=vs.90).aspx), [Guiding Principles For Your ASP.NET MVC Applications](http://msdn.microsoft.com/magazine/dd942822.aspx)</span></span> |
| <span data-ttu-id="a8300-608">**Passaggi**</span><span class="sxs-lookup"><span data-stu-id="a8300-608">**Steps**</span></span> | <span data-ttu-id="a8300-609">Per i metodi che accettano come argomento solo un tipo di dati primitivo e non modelli, deve essere eseguita la convalida dell'input con un'espressione regolare.</span><span class="sxs-lookup"><span data-stu-id="a8300-609">For methods that just accept primitive data type, and not models as argument,input validation using Regular Expression should be done.</span></span> <span data-ttu-id="a8300-610">In questo caso, è necessario usare Regex.IsMatch con un criterio regex valido.</span><span class="sxs-lookup"><span data-stu-id="a8300-610">Here Regex.IsMatch should be used with a valid regex pattern.</span></span> <span data-ttu-id="a8300-611">Se l'input non corrisponde all'espressione regolare specificata, il controllo dovrà essere interrotto e dovrà essere visualizzato un avviso relativo all'errore di convalida.</span><span class="sxs-lookup"><span data-stu-id="a8300-611">If the input doesn't match the specified Regular Expression, control should not proceed further, and an adequate warning regarding validation failure should be displayed.</span></span>|

## <span data-ttu-id="a8300-612"><a id="typesafe-api"></a>Verificare che nell'API Web vengano usati parametri indipendenti dai tipi per l'accesso ai dati</span><span class="sxs-lookup"><span data-stu-id="a8300-612"><a id="typesafe-api"></a>Ensure that type-safe parameters are used in Web API for data access</span></span>

| <span data-ttu-id="a8300-613">Titolo</span><span class="sxs-lookup"><span data-stu-id="a8300-613">Title</span></span>                   | <span data-ttu-id="a8300-614">Dettagli</span><span class="sxs-lookup"><span data-stu-id="a8300-614">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="a8300-615">**Componente**</span><span class="sxs-lookup"><span data-stu-id="a8300-615">**Component**</span></span>               | <span data-ttu-id="a8300-616">API Web</span><span class="sxs-lookup"><span data-stu-id="a8300-616">Web API</span></span> | 
| <span data-ttu-id="a8300-617">**Fase SDL**</span><span class="sxs-lookup"><span data-stu-id="a8300-617">**SDL Phase**</span></span>               | <span data-ttu-id="a8300-618">Compilare</span><span class="sxs-lookup"><span data-stu-id="a8300-618">Build</span></span> |  
| <span data-ttu-id="a8300-619">**Tecnologie applicabili**</span><span class="sxs-lookup"><span data-stu-id="a8300-619">**Applicable Technologies**</span></span> | <span data-ttu-id="a8300-620">Generico</span><span class="sxs-lookup"><span data-stu-id="a8300-620">Generic</span></span> |
| <span data-ttu-id="a8300-621">**Attributes (Attributi) (Attributi)**</span><span class="sxs-lookup"><span data-stu-id="a8300-621">**Attributes**</span></span>              | <span data-ttu-id="a8300-622">N/D</span><span class="sxs-lookup"><span data-stu-id="a8300-622">N/A</span></span>  |
| <span data-ttu-id="a8300-623">**Riferimenti**</span><span class="sxs-lookup"><span data-stu-id="a8300-623">**References**</span></span>              | <span data-ttu-id="a8300-624">N/D</span><span class="sxs-lookup"><span data-stu-id="a8300-624">N/A</span></span>  |
| <span data-ttu-id="a8300-625">**Passaggi**</span><span class="sxs-lookup"><span data-stu-id="a8300-625">**Steps**</span></span> | <p><span data-ttu-id="a8300-626">Se si usa la raccolta Parameters, SQL considera l'input come un valore letterale anziché come codice eseguibile.</span><span class="sxs-lookup"><span data-stu-id="a8300-626">If you use the Parameters collection, SQL treats the input is as a literal value rather then as executable code.</span></span> <span data-ttu-id="a8300-627">La raccolta Parameters può essere usata per imporre vincoli di tipo e lunghezza sui dati di input.</span><span class="sxs-lookup"><span data-stu-id="a8300-627">The Parameters collection can be used to enforce type and length constraints on input data.</span></span> <span data-ttu-id="a8300-628">I valori non compresi nell'intervallo attivano un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="a8300-628">Values outside of the range trigger an exception.</span></span> <span data-ttu-id="a8300-629">Se non vengono usati parametri SQL indipendenti dai tipi, gli utenti malintenzionati potrebbero eseguire attacchi di tipo injection incorporati nell'input non filtrato.</span><span class="sxs-lookup"><span data-stu-id="a8300-629">If type-safe SQL parameters are not used, attackers might be able to execute injection attacks that are embedded in the unfiltered input.</span></span></p><p><span data-ttu-id="a8300-630">Quando si costruiscono query SQL, usare parametri indipendenti dai tipi per evitare gli attacchi SQL injection che possono verificarsi con input non filtrato.</span><span class="sxs-lookup"><span data-stu-id="a8300-630">Use type safe parameters when constructing SQL queries to avoid possible SQL injection attacks that can occur with unfiltered input.</span></span> <span data-ttu-id="a8300-631">È possibile usare parametri indipendenti dai tipi con stored procedure e con istruzioni SQL dinamiche.</span><span class="sxs-lookup"><span data-stu-id="a8300-631">You can use type safe parameters with stored procedures and with dynamic SQL statements.</span></span> <span data-ttu-id="a8300-632">I parametri vengono considerati dal database come valori letterali e non come codice eseguibile.</span><span class="sxs-lookup"><span data-stu-id="a8300-632">Parameters are treated as literal values by the database and not as executable code.</span></span> <span data-ttu-id="a8300-633">Viene anche eseguito il controllo del tipo e della lunghezza dei parametri.</span><span class="sxs-lookup"><span data-stu-id="a8300-633">Parameters are also checked for type and length.</span></span></p>|

### <a name="example"></a><span data-ttu-id="a8300-634">Esempio</span><span class="sxs-lookup"><span data-stu-id="a8300-634">Example</span></span>
<span data-ttu-id="a8300-635">Il codice seguente illustra come usare parametri indipendenti dai tipi con SqlParameterCollection quando si chiama una stored procedure.</span><span class="sxs-lookup"><span data-stu-id="a8300-635">The following code shows how to use type safe parameters with the SqlParameterCollection when calling a stored procedure.</span></span> 

```C#
using System.Data;
using System.Data.SqlClient;

using (SqlConnection connection = new SqlConnection(connectionString))
{ 
DataSet userDataset = new DataSet(); 
SqlDataAdapter myCommand = new SqlDataAdapter(LoginStoredProcedure", connection); 
myCommand.SelectCommand.CommandType = CommandType.StoredProcedure; 
myCommand.SelectCommand.Parameters.Add("@au_id", SqlDbType.VarChar, 11); 
myCommand.SelectCommand.Parameters["@au_id"].Value = SSN.Text; 
myCommand.Fill(userDataset);
}  
```
<span data-ttu-id="a8300-636">Nell'esempio di codice precedente, la lunghezza del valore di input non può essere maggiore di 11 caratteri.</span><span class="sxs-lookup"><span data-stu-id="a8300-636">In the preceding code example, the input value cannot be longer than 11 characters.</span></span> <span data-ttu-id="a8300-637">Se i dati non sono conformi alla lunghezza o al tipo definito dal parametro, la classe SqlParameter genera un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="a8300-637">If the data does not conform to the type or length defined by the parameter, the SqlParameter class throws an exception.</span></span> 

## <span data-ttu-id="a8300-638"><a id="sql-docdb"></a>Usare query SQL con parametri per Cosmos DB</span><span class="sxs-lookup"><span data-stu-id="a8300-638"><a id="sql-docdb"></a>Use parametrized SQL queries for Cosmos DB</span></span>

| <span data-ttu-id="a8300-639">Titolo</span><span class="sxs-lookup"><span data-stu-id="a8300-639">Title</span></span>                   | <span data-ttu-id="a8300-640">Dettagli</span><span class="sxs-lookup"><span data-stu-id="a8300-640">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="a8300-641">**Componente**</span><span class="sxs-lookup"><span data-stu-id="a8300-641">**Component**</span></span>               | <span data-ttu-id="a8300-642">Azure DocumentDB</span><span class="sxs-lookup"><span data-stu-id="a8300-642">Azure Document DB</span></span> | 
| <span data-ttu-id="a8300-643">**Fase SDL**</span><span class="sxs-lookup"><span data-stu-id="a8300-643">**SDL Phase**</span></span>               | <span data-ttu-id="a8300-644">Compilare</span><span class="sxs-lookup"><span data-stu-id="a8300-644">Build</span></span> |  
| <span data-ttu-id="a8300-645">**Tecnologie applicabili**</span><span class="sxs-lookup"><span data-stu-id="a8300-645">**Applicable Technologies**</span></span> | <span data-ttu-id="a8300-646">Generico</span><span class="sxs-lookup"><span data-stu-id="a8300-646">Generic</span></span> |
| <span data-ttu-id="a8300-647">**Attributes (Attributi) (Attributi)**</span><span class="sxs-lookup"><span data-stu-id="a8300-647">**Attributes**</span></span>              | <span data-ttu-id="a8300-648">N/D</span><span class="sxs-lookup"><span data-stu-id="a8300-648">N/A</span></span>  |
| <span data-ttu-id="a8300-649">**Riferimenti**</span><span class="sxs-lookup"><span data-stu-id="a8300-649">**References**</span></span>              | <span data-ttu-id="a8300-650">[Announcing SQL Parameterization in DocumentDB](https://azure.microsoft.com/blog/announcing-sql-parameterization-in-documentdb/) (Annuncio della parametrizzazione SQL in DocumentDB)</span><span class="sxs-lookup"><span data-stu-id="a8300-650">[Announcing SQL Parameterization in DocumentDB](https://azure.microsoft.com/blog/announcing-sql-parameterization-in-documentdb/)</span></span> |
| <span data-ttu-id="a8300-651">**Passaggi**</span><span class="sxs-lookup"><span data-stu-id="a8300-651">**Steps**</span></span> | <span data-ttu-id="a8300-652">Nonostante DocumentDB supporti solo query di sola lettura, se le query vengono costruite con la concatenazione con input utente sono comunque possibili attacchi SQL injection.</span><span class="sxs-lookup"><span data-stu-id="a8300-652">Although DocumentDB only supports read-only queries, SQL injection is still possible if queries are constructed by concatenating with user input.</span></span> <span data-ttu-id="a8300-653">Un utente potrebbe ottenere l'accesso a dati a cui non dovrebbe accedere nella stessa raccolta creando query SQL dannose.</span><span class="sxs-lookup"><span data-stu-id="a8300-653">It might be possible for a user to gain access to data they shouldn’t be accessing within the same collection by crafting malicious SQL queries.</span></span> <span data-ttu-id="a8300-654">Se le query vengono costruite in base all'input utente, usare query SQL con parametri.</span><span class="sxs-lookup"><span data-stu-id="a8300-654">Use parameterized SQL queries if queries are constructed based on user input.</span></span> |

## <span data-ttu-id="a8300-655"><a id="schema-binding"></a>WCF: convalida dell'input tramite l'associazione allo schema</span><span class="sxs-lookup"><span data-stu-id="a8300-655"><a id="schema-binding"></a>WCF Input validation through Schema binding</span></span>

| <span data-ttu-id="a8300-656">Titolo</span><span class="sxs-lookup"><span data-stu-id="a8300-656">Title</span></span>                   | <span data-ttu-id="a8300-657">Dettagli</span><span class="sxs-lookup"><span data-stu-id="a8300-657">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="a8300-658">**Componente**</span><span class="sxs-lookup"><span data-stu-id="a8300-658">**Component**</span></span>               | <span data-ttu-id="a8300-659">WCF</span><span class="sxs-lookup"><span data-stu-id="a8300-659">WCF</span></span> | 
| <span data-ttu-id="a8300-660">**Fase SDL**</span><span class="sxs-lookup"><span data-stu-id="a8300-660">**SDL Phase**</span></span>               | <span data-ttu-id="a8300-661">Compilare</span><span class="sxs-lookup"><span data-stu-id="a8300-661">Build</span></span> |  
| <span data-ttu-id="a8300-662">**Tecnologie applicabili**</span><span class="sxs-lookup"><span data-stu-id="a8300-662">**Applicable Technologies**</span></span> | <span data-ttu-id="a8300-663">Generico, .NET Framework 3</span><span class="sxs-lookup"><span data-stu-id="a8300-663">Generic, NET Framework 3</span></span> |
| <span data-ttu-id="a8300-664">**Attributes (Attributi) (Attributi)**</span><span class="sxs-lookup"><span data-stu-id="a8300-664">**Attributes**</span></span>              | <span data-ttu-id="a8300-665">N/D</span><span class="sxs-lookup"><span data-stu-id="a8300-665">N/A</span></span>  |
| <span data-ttu-id="a8300-666">**Riferimenti**</span><span class="sxs-lookup"><span data-stu-id="a8300-666">**References**</span></span>              | [<span data-ttu-id="a8300-667">MSDN</span><span class="sxs-lookup"><span data-stu-id="a8300-667">MSDN</span></span>](https://msdn.microsoft.com/library/ff647820.aspx) |
| <span data-ttu-id="a8300-668">**Passaggi**</span><span class="sxs-lookup"><span data-stu-id="a8300-668">**Steps**</span></span> | <p><span data-ttu-id="a8300-669">L'assenza di convalida espone a diversi attacchi di tipo injection.</span><span class="sxs-lookup"><span data-stu-id="a8300-669">Lack of validation leads to different type injection attacks.</span></span></p><p><span data-ttu-id="a8300-670">La convalida dei messaggi rappresenta una linea di difesa nella protezione di un'applicazione WCF.</span><span class="sxs-lookup"><span data-stu-id="a8300-670">Message validation represents one line of defense in the protection of your WCF application.</span></span> <span data-ttu-id="a8300-671">Con questo approccio, si convalidano i messaggi usando schemi per proteggere le operazioni del servizio WCF dall'attacco di un client non autorizzato.</span><span class="sxs-lookup"><span data-stu-id="a8300-671">With this approach, you validate messages using schemas to protect WCF service operations from attack by a malicious client.</span></span> <span data-ttu-id="a8300-672">Convalidare tutti i messaggi ricevuti dal client per proteggere il client dall'attacco di un servizio dannoso.</span><span class="sxs-lookup"><span data-stu-id="a8300-672">Validate all messages received by the client to protect the client from attack by a malicious service.</span></span> <span data-ttu-id="a8300-673">In questo modo è possibile convalidare i messaggi quando le operazioni utilizzano contratti dati o contratti di messaggio, una funzionalità non supportata dalla convalida dei parametri.</span><span class="sxs-lookup"><span data-stu-id="a8300-673">Message validation makes it possible to validate messages when operations consume message contracts or data contracts, which cannot be done using parameter validation.</span></span> <span data-ttu-id="a8300-674">La convalida dei messaggi consente di creare la logica di convalida all'interno di schemi, offrendo così maggiore flessibilità e riducendo i tempi di sviluppo.</span><span class="sxs-lookup"><span data-stu-id="a8300-674">Message validation allows you to create validation logic inside schemas, thereby providing more flexibility and reducing development time.</span></span> <span data-ttu-id="a8300-675">Gli schemi possono essere riusati in diverse applicazioni all'interno dell'organizzazione, creando standard per la rappresentazione dei dati.</span><span class="sxs-lookup"><span data-stu-id="a8300-675">Schemas can be reused across different applications inside the organization, creating standards for data representation.</span></span> <span data-ttu-id="a8300-676">La convalida dei messaggi consente anche di proteggere le operazioni quando utilizzano tipi di dati più complessi associati a contratti che rappresentano la logica di business.</span><span class="sxs-lookup"><span data-stu-id="a8300-676">Additionally, message validation allows you to protect operations when they consume more complex data types involving contracts representing business logic.</span></span></p><p><span data-ttu-id="a8300-677">Per eseguire la convalida dei messaggi, si compila prima di tutto uno schema che rappresenta le operazioni del servizio e i tipi di dati utilizzati da tali operazioni.</span><span class="sxs-lookup"><span data-stu-id="a8300-677">To perform message validation, you first build a schema that represents the operations of your service and the data types consumed by those operations.</span></span> <span data-ttu-id="a8300-678">Si crea quindi una classe .NET che implementa un controllo messaggio personalizzato del client e un controllo messaggio personalizzato dello strumento di recapito per convalidare i messaggi inviati al servizio o da esso ricevuti.</span><span class="sxs-lookup"><span data-stu-id="a8300-678">You then create a .NET class that implements a custom client message inspector and custom dispatcher message inspector to validate the messages sent/received to/from the service.</span></span> <span data-ttu-id="a8300-679">Successivamente, si implementa un comportamento dell'endpoint personalizzato per abilitare la convalida dei messaggi sia nel client che nel servizio.</span><span class="sxs-lookup"><span data-stu-id="a8300-679">Next, you implement a custom endpoint behavior to enable message validation on both the client and the service.</span></span> <span data-ttu-id="a8300-680">Infine, si implementa un elemento di configurazione personalizzato per la classe che consente di esporre il comportamento dell'endpoint personalizzato esteso nel file di configurazione del servizio o del client.</span><span class="sxs-lookup"><span data-stu-id="a8300-680">Finally, you implement a custom configuration element on the class that allows you to expose the extended custom endpoint behavior in the configuration file of the service or the client"</span></span></p>|

## <span data-ttu-id="a8300-681"><a id="parameters"></a>WCF: convalida dell'input tramite controlli parametro</span><span class="sxs-lookup"><span data-stu-id="a8300-681"><a id="parameters"></a>WCF- Input validation through Parameter Inspectors</span></span>

| <span data-ttu-id="a8300-682">Titolo</span><span class="sxs-lookup"><span data-stu-id="a8300-682">Title</span></span>                   | <span data-ttu-id="a8300-683">Dettagli</span><span class="sxs-lookup"><span data-stu-id="a8300-683">Details</span></span>      |
| ----------------------- | ------------ |
| <span data-ttu-id="a8300-684">**Componente**</span><span class="sxs-lookup"><span data-stu-id="a8300-684">**Component**</span></span>               | <span data-ttu-id="a8300-685">WCF</span><span class="sxs-lookup"><span data-stu-id="a8300-685">WCF</span></span> | 
| <span data-ttu-id="a8300-686">**Fase SDL**</span><span class="sxs-lookup"><span data-stu-id="a8300-686">**SDL Phase**</span></span>               | <span data-ttu-id="a8300-687">Compilare</span><span class="sxs-lookup"><span data-stu-id="a8300-687">Build</span></span> |  
| <span data-ttu-id="a8300-688">**Tecnologie applicabili**</span><span class="sxs-lookup"><span data-stu-id="a8300-688">**Applicable Technologies**</span></span> | <span data-ttu-id="a8300-689">Generico, .NET Framework 3</span><span class="sxs-lookup"><span data-stu-id="a8300-689">Generic, NET Framework 3</span></span> |
| <span data-ttu-id="a8300-690">**Attributes (Attributi) (Attributi)**</span><span class="sxs-lookup"><span data-stu-id="a8300-690">**Attributes**</span></span>              | <span data-ttu-id="a8300-691">N/D</span><span class="sxs-lookup"><span data-stu-id="a8300-691">N/A</span></span>  |
| <span data-ttu-id="a8300-692">**Riferimenti**</span><span class="sxs-lookup"><span data-stu-id="a8300-692">**References**</span></span>              | [<span data-ttu-id="a8300-693">MSDN</span><span class="sxs-lookup"><span data-stu-id="a8300-693">MSDN</span></span>](https://msdn.microsoft.com/library/ff647875.aspx) |
| <span data-ttu-id="a8300-694">**Passaggi**</span><span class="sxs-lookup"><span data-stu-id="a8300-694">**Steps**</span></span> | <p><span data-ttu-id="a8300-695">La convalida dell'input e dei dati rappresenta una linea di difesa importante nella protezione di un'applicazione WCF.</span><span class="sxs-lookup"><span data-stu-id="a8300-695">Input and data validation represents one important line of defense in the protection of your WCF application.</span></span> <span data-ttu-id="a8300-696">È consigliabile convalidare tutti i parametri esposti nelle operazioni del servizio WCF per proteggere il servizio dall'attacco di un client malintenzionato.</span><span class="sxs-lookup"><span data-stu-id="a8300-696">You should validate all parameters exposed in WCF service operations to protect the service from attack by a malicious client.</span></span> <span data-ttu-id="a8300-697">Viceversa, è consigliabile convalidare tutti i valori restituiti ricevuti dal client per proteggere il client dall'attacco di un servizio dannoso.</span><span class="sxs-lookup"><span data-stu-id="a8300-697">Conversely, you should also validate all return values received by the client to protect the client from attack by a malicious service</span></span></p><p><span data-ttu-id="a8300-698">WCF offre diversi punti di estendibilità che consentono di personalizzare il comportamento del runtime WCF creando estensioni personalizzate.</span><span class="sxs-lookup"><span data-stu-id="a8300-698">WCF provides different extensibility points that allow you to customize the WCF runtime behavior by creating custom extensions.</span></span> <span data-ttu-id="a8300-699">I controlli messaggio e i controlli parametro sono due meccanismi di estendibilità usati per ottenere maggiore controllo sui dati che vengono passati tra un client e un servizio.</span><span class="sxs-lookup"><span data-stu-id="a8300-699">Message Inspectors and Parameter Inspectors are two extensibility mechanisms used to gain greater control over the data passing between a client and a service.</span></span> <span data-ttu-id="a8300-700">È consigliabile usare i controlli parametro per la convalida dell'input e i controlli messaggio solo quando è necessario controllare l'intero flusso dei messaggi da e verso un servizio.</span><span class="sxs-lookup"><span data-stu-id="a8300-700">You should use parameter inspectors for input validation and use message inspectors only when you need to inspect the entire message flowing in and out of a service.</span></span></p><p><span data-ttu-id="a8300-701">Per eseguire la convalida dell'input, si compila una classe .NET e si implementa un controllo parametro personalizzato per convalidare i parametri per le operazioni nel servizio.</span><span class="sxs-lookup"><span data-stu-id="a8300-701">To perform input validation, you will build a .NET class and implement a custom parameter inspector in order to validate parameters on operations in your service.</span></span> <span data-ttu-id="a8300-702">Si implementa quindi un comportamento dell'endpoint personalizzato per abilitare la convalida sia nel client che nel servizio.</span><span class="sxs-lookup"><span data-stu-id="a8300-702">You will then implement a custom endpoint behavior to enable validation on both the client and the service.</span></span> <span data-ttu-id="a8300-703">Infine, si implementa un elemento di configurazione personalizzato per la classe che consente di esporre il comportamento dell'endpoint personalizzato esteso nel file di configurazione del servizio o del client.</span><span class="sxs-lookup"><span data-stu-id="a8300-703">Finally, you will implement a custom configuration element on the class that allows you to expose the extended custom endpoint behavior in the configuration file of the service or the client</span></span></p>|
