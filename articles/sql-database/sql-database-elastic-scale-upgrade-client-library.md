---
title: Eseguire l'aggiornamento alla libreria client dei database elastici | Documentazione Microsoft
description: Eseguire l'aggiornamento alle applicazioni e librerie mediante Nuget
services: sql-database
documentationcenter: 
manager: jhubbard
author: ddove
ms.assetid: 0a546510-76e7-465e-9271-f15ff0cfa959
ms.service: sql-database
ms.custom: scale out apps
ms.workload: sql-database
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 03/06/2017
ms.author: ddove
ms.openlocfilehash: 7e28d128645e856c0efa6e4f78d8f9f36982a76c
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 07/11/2017
---
# <a name="upgrade-an-app-to-use-the-latest-elastic-database-client-library"></a><span data-ttu-id="7bb25-103">Aggiornare un'app in modo da usare la libreria client dei database elastici più recente</span><span class="sxs-lookup"><span data-stu-id="7bb25-103">Upgrade an app to use the latest elastic database client library</span></span>
<span data-ttu-id="7bb25-104">Le nuove versioni della [libreria client dei database elastici](sql-database-elastic-database-client-library.md) sono disponibili tramite NuGet e l'interfaccia NuGetPackage Manager in Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="7bb25-104">New versions of the [Elastic Database client library](sql-database-elastic-database-client-library.md) are  available through NuGetand the NuGetPackage Manager interface in Visual Studio.</span></span> <span data-ttu-id="7bb25-105">Gli aggiornamenti contengono correzioni di bug e supporto delle nuove funzionalità della libreria client.</span><span class="sxs-lookup"><span data-stu-id="7bb25-105">Upgrades contain bug fixes and support for new capabilities of the client library.</span></span>

<span data-ttu-id="7bb25-106">**Per la versione più recente** , passare a [Microsoft.Azure.SqlDatabase.ElasticScale.Client](https://www.nuget.org/packages/Microsoft.Azure.SqlDatabase.ElasticScale.Client/).</span><span class="sxs-lookup"><span data-stu-id="7bb25-106">**For the latest version:** Go to [Microsoft.Azure.SqlDatabase.ElasticScale.Client](https://www.nuget.org/packages/Microsoft.Azure.SqlDatabase.ElasticScale.Client/).</span></span>

<span data-ttu-id="7bb25-107">Compilazione dell'applicazione con la nuova libreria, nonché la modifica dei metadati Shard Map Manager esistenti archiviati nei database SQL di Azure in modo che supportino le nuove funzionalità.</span><span class="sxs-lookup"><span data-stu-id="7bb25-107">Rebuild your application with the new library, as well as change your existing Shard Map Manager metadata stored in your Azure SQL Databases to support new features.</span></span>

<span data-ttu-id="7bb25-108">Seguendo l'ordine di questi passaggi è possibile essere sicuri che le versioni precedenti della libreria client non siano più presenti nell'ambiente quando gli oggetti dei metadati vengono aggiornati, e che pertanto dopo l'aggiornamento non saranno creati oggetti di metadati di versioni precedenti.</span><span class="sxs-lookup"><span data-stu-id="7bb25-108">Performing these steps in order ensures that old versions of the client library are no longer present in your environment when metadata objects are updated, which means that old-version metadata objects won’t be created after upgrade.</span></span>   

## <a name="upgrade-steps"></a><span data-ttu-id="7bb25-109">Passaggi dell'aggiornamento</span><span class="sxs-lookup"><span data-stu-id="7bb25-109">Upgrade steps</span></span>
<span data-ttu-id="7bb25-110">**1. Aggiornare le applicazioni.**</span><span class="sxs-lookup"><span data-stu-id="7bb25-110">**1. Upgrade your applications.**</span></span> <span data-ttu-id="7bb25-111">In Visual Studio, scaricare e fare riferimento alla versione più recente della libreria client in tutti i progetti di sviluppo che usano tale libreria; quindi ricompilare e distribuire.</span><span class="sxs-lookup"><span data-stu-id="7bb25-111">In Visual Studio, download and reference the latest client library version into all of your development projects that use the library; then rebuild and deploy.</span></span> 

* <span data-ttu-id="7bb25-112">Nella soluzione Visual Studio in uso selezionare **Strumenti** --> **Gestione pacchetti NuGet** -->  **Gestisci pacchetti NuGet per la soluzione**.</span><span class="sxs-lookup"><span data-stu-id="7bb25-112">In your Visual Studio solution, select **Tools** --> **NuGet Package Manager** -->  **Manage NuGet Packages for Solution**.</span></span> 
* <span data-ttu-id="7bb25-113">(Visual Studio 2013) Nel riquadro sinistro selezionare **Aggiornamenti**, quindi il pulsante **Aggiorna** del pacchetto **Libreria client di scalabilità elastica del database SQL di Azure** che viene visualizzato nella finestra.</span><span class="sxs-lookup"><span data-stu-id="7bb25-113">(Visual Studio 2013) In the left panel, select **Updates**, and then select the **Update** button on the package **Azure SQL Database Elastic Scale Client Library** that appears in the window.</span></span>
* <span data-ttu-id="7bb25-114">(2015 di Visual Studio) Impostare la casella del filtro su **aggiornamento disponibile**.</span><span class="sxs-lookup"><span data-stu-id="7bb25-114">(Visual Studio 2015) Set the Filter box to **Upgrade available**.</span></span> <span data-ttu-id="7bb25-115">Selezionare il pacchetto da aggiornare, e fare clic sul pulsante **Aggiorna** .</span><span class="sxs-lookup"><span data-stu-id="7bb25-115">Select the package to update, and click the **Update** button.</span></span>
* <span data-ttu-id="7bb25-116">(Visual Studio 2017) Nella parte superiore della finestra di dialogo selezionare **Aggiornamenti**.</span><span class="sxs-lookup"><span data-stu-id="7bb25-116">(Visual Studio 2017) At the top of the dialog, select **Updates**.</span></span> <span data-ttu-id="7bb25-117">Selezionare il pacchetto da aggiornare, e fare clic sul pulsante **Aggiorna** .</span><span class="sxs-lookup"><span data-stu-id="7bb25-117">Select the package to update, and click the **Update** button.</span></span>
* <span data-ttu-id="7bb25-118">Compilare e distribuire.</span><span class="sxs-lookup"><span data-stu-id="7bb25-118">Build and Deploy.</span></span> 

<span data-ttu-id="7bb25-119">**2. Aggiornare gli script.**</span><span class="sxs-lookup"><span data-stu-id="7bb25-119">**2. Upgrade your scripts.**</span></span> <span data-ttu-id="7bb25-120">Se si usano script **PowerShell** per gestire le partizioni, [scaricare la nuova versione della libreria](https://www.nuget.org/packages/Microsoft.Azure.SqlDatabase.ElasticScale.Client/) e copiarla nella directory da cui vengono eseguiti gli script.</span><span class="sxs-lookup"><span data-stu-id="7bb25-120">If you are using **PowerShell** scripts to manage shards, [download the new library version](https://www.nuget.org/packages/Microsoft.Azure.SqlDatabase.ElasticScale.Client/) and copy it into the directory from which you execute scripts.</span></span> 

<span data-ttu-id="7bb25-121">**3. Aggiornare il servizio di divisione e unione.**</span><span class="sxs-lookup"><span data-stu-id="7bb25-121">**3. Upgrade your split-merge service.**</span></span> <span data-ttu-id="7bb25-122">Se si usa il servizio di divisione e unione di scalabilità elastica per riorganizzare i dati delle partizioni, [scaricare e distribuire la versione più recente dello strumento](https://www.nuget.org/packages/Microsoft.Azure.SqlDatabase.ElasticScale.Service.SplitMerge/).</span><span class="sxs-lookup"><span data-stu-id="7bb25-122">If you use the elastic database split-merge tool to reorganize sharded data, [download and deploy the latest version of the tool](https://www.nuget.org/packages/Microsoft.Azure.SqlDatabase.ElasticScale.Service.SplitMerge/).</span></span> <span data-ttu-id="7bb25-123">I passaggi dettagliati dell'aggiornamento per il servizio sono disponibili [qui](sql-database-elastic-scale-overview-split-and-merge.md).</span><span class="sxs-lookup"><span data-stu-id="7bb25-123">Detailed upgrade steps for the Service can be found [here](sql-database-elastic-scale-overview-split-and-merge.md).</span></span> 

<span data-ttu-id="7bb25-124">**4. Aggiornare i database di Gestore mappe partizioni**.</span><span class="sxs-lookup"><span data-stu-id="7bb25-124">**4. Upgrade your Shard Map Manager databases**.</span></span> <span data-ttu-id="7bb25-125">Aggiornare i metadati che supportano le mappe delle partizioni nel database SQL di Azure.</span><span class="sxs-lookup"><span data-stu-id="7bb25-125">Upgrade the metadata supporting your Shard Maps in Azure SQL Database.</span></span>  <span data-ttu-id="7bb25-126">Esistono due modi per eseguire questa operazione, tramite PowerShell o C#.</span><span class="sxs-lookup"><span data-stu-id="7bb25-126">There are two ways you can accomplish this, using PowerShell or C#.</span></span> <span data-ttu-id="7bb25-127">Entrambe le opzioni sono mostrate di seguito.</span><span class="sxs-lookup"><span data-stu-id="7bb25-127">Both options are shown below.</span></span>

<span data-ttu-id="7bb25-128">***Opzione 1: aggiornare i metadati tramite PowerShell***</span><span class="sxs-lookup"><span data-stu-id="7bb25-128">***Option 1: Upgrade metadata using PowerShell***</span></span>

1. <span data-ttu-id="7bb25-129">Scaricare l'utility della riga di comando più recente per NuGet da [qui](http://nuget.org/nuget.exe) e salvarla in una cartella.</span><span class="sxs-lookup"><span data-stu-id="7bb25-129">Download the latest command-line utility for NuGet from [here](http://nuget.org/nuget.exe) and save to a folder.</span></span> 
2. <span data-ttu-id="7bb25-130">Aprire un prompt dei comandi, passare alla stessa cartella ed eseguire il comando: `nuget install Microsoft.Azure.SqlDatabase.ElasticScale.Client`</span><span class="sxs-lookup"><span data-stu-id="7bb25-130">Open a Command Prompt, navigate to the same folder, and issue the command: `nuget install Microsoft.Azure.SqlDatabase.ElasticScale.Client`</span></span>
3. <span data-ttu-id="7bb25-131">Passare alla sottocartella contenente la versione DLL appena scaricata, ad esempio: `cd .\Microsoft.Azure.SqlDatabase.ElasticScale.Client.1.0.0\lib\net45`</span><span class="sxs-lookup"><span data-stu-id="7bb25-131">Navigate to the subfolder containing the new client DLL version you have just downloaded, for example: `cd .\Microsoft.Azure.SqlDatabase.ElasticScale.Client.1.0.0\lib\net45`</span></span>
4. <span data-ttu-id="7bb25-132">Scaricare lo scriplet di aggiornamento del client di database elastico dal [Centro script](https://gallery.technet.microsoft.com/scriptcenter/Azure-SQL-Database-Elastic-6442e6a9)e salvarlo nella stessa cartella contenente la DLL.</span><span class="sxs-lookup"><span data-stu-id="7bb25-132">Download the elastic database client upgrade scriptlet from the [Script Center](https://gallery.technet.microsoft.com/scriptcenter/Azure-SQL-Database-Elastic-6442e6a9), and save it into the same folder containing the DLL.</span></span>
5. <span data-ttu-id="7bb25-133">Da quella cartella, eseguire “PowerShell .\upgrade.ps1” dal prompt dei comandi e seguire i prompt.</span><span class="sxs-lookup"><span data-stu-id="7bb25-133">From that folder, run “PowerShell .\upgrade.ps1” from the command prompt and follow the prompts.</span></span>

<span data-ttu-id="7bb25-134">***Opzione 2: aggiornare i metadati tramite C#***</span><span class="sxs-lookup"><span data-stu-id="7bb25-134">***Option 2: Upgrade metadata using C#***</span></span>

<span data-ttu-id="7bb25-135">In alternativa, creare un'applicazione Visual Studio che apre ShardMapManager, scorre tutte le partizioni ed esegue l'aggiornamento dei metadati chiamando i metodi [UpgradeLocalStore](https://msdn.microsoft.com/library/azure/microsoft.azure.sqldatabase.elasticscale.shardmanagement.shardmapmanager.upgradelocalstore.aspx) e [UpgradeGlobalStore](https://msdn.microsoft.com/library/azure/microsoft.azure.sqldatabase.elasticscale.shardmanagement.shardmapmanager.upgradeglobalstore.aspx) come in questo esempio:</span><span class="sxs-lookup"><span data-stu-id="7bb25-135">Alternatively, create a Visual Studio application that opens your ShardMapManager, iterates over all shards, and performs the metadata upgrade by calling the methods [UpgradeLocalStore](https://msdn.microsoft.com/library/azure/microsoft.azure.sqldatabase.elasticscale.shardmanagement.shardmapmanager.upgradelocalstore.aspx) and [UpgradeGlobalStore](https://msdn.microsoft.com/library/azure/microsoft.azure.sqldatabase.elasticscale.shardmanagement.shardmapmanager.upgradeglobalstore.aspx) as in this example:</span></span> 

    ShardMapManager smm =
       ShardMapManagerFactory.GetSqlShardMapManager
       (connStr, ShardMapManagerLoadPolicy.Lazy); 
    smm.UpgradeGlobalStore(); 

    foreach (ShardLocation loc in
     smm.GetDistinctShardLocations()) 
    {   
       smm.UpgradeLocalStore(loc); 
    } 

<span data-ttu-id="7bb25-136">Tali tecniche di aggiornamento dei metadati possono essere applicate più volte senza creare problemi.</span><span class="sxs-lookup"><span data-stu-id="7bb25-136">These techniques for metadata upgrades can be applied multiple times without harm.</span></span> <span data-ttu-id="7bb25-137">Se, ad esempio, una versione client precedente crea inavvertitamente una partizione dopo che è già stato eseguito l'aggiornamento, è possibile eseguire nuovamente l'aggiornamento in tutte le partizioni per garantire che nell'infrastruttura sia presente la versione dei metadati più aggiornata.</span><span class="sxs-lookup"><span data-stu-id="7bb25-137">For example, if an older client version inadvertently creates a shard after you have already updated, you can run upgrade again across all shards to ensure that the latest metadata version is present throughout your infrastructure.</span></span> 

<span data-ttu-id="7bb25-138">**Nota:** le nuove versioni della libreria client pubblicate fino a oggi continuano a funzionare con le versioni precedenti dei metadati di Gestore mappe partizioni sul database SQL di Azure e viceversa.</span><span class="sxs-lookup"><span data-stu-id="7bb25-138">**Note:**  New versions of the client library published to-date continue to work with prior versions of the Shard Map Manager metadata on Azure SQL DB, and vice-versa.</span></span>   <span data-ttu-id="7bb25-139">Tuttavia, per sfruttare alcune delle nuove funzionalità nel client più recente, è necessario aggiornare i metadati.</span><span class="sxs-lookup"><span data-stu-id="7bb25-139">However to take advantage of some of the new features in the latest client, metadata needs to be upgraded.</span></span>   <span data-ttu-id="7bb25-140">Tenere presente che gli aggiornamenti dei metadati non influiscono sui dati utente o sui dati specifici dell'applicazione, solo gli oggetti creati e utilizzati da Gestore mappe partizioni.</span><span class="sxs-lookup"><span data-stu-id="7bb25-140">Note that metadata upgrades will not affect any user-data or application-specific data, only objects created and used by the Shard Map Manager.</span></span>  <span data-ttu-id="7bb25-141">E le applicazioni continuano a funzionare nel corso della sequenza di aggiornamento descritta in precedenza.</span><span class="sxs-lookup"><span data-stu-id="7bb25-141">And applications continue to operate through the upgrade sequence described above.</span></span> 

## <a name="elastic-database-client-version-history"></a><span data-ttu-id="7bb25-142">Cronologia delle versioni del client di database elastico</span><span class="sxs-lookup"><span data-stu-id="7bb25-142">Elastic database client version history</span></span>
<span data-ttu-id="7bb25-143">Per la cronologia delle versioni, passare a [Microsoft.Azure.SqlDatabase.ElasticScale.Client](https://www.nuget.org/packages/Microsoft.Azure.SqlDatabase.ElasticScale.Client/)</span><span class="sxs-lookup"><span data-stu-id="7bb25-143">For version history, go to [Microsoft.Azure.SqlDatabase.ElasticScale.Client](https://www.nuget.org/packages/Microsoft.Azure.SqlDatabase.ElasticScale.Client/)</span></span>

[!INCLUDE [elastic-scale-include](../../includes/elastic-scale-include.md)]

<!--Image references-->
[1]:./media/sql-database-elastic-scale-upgrade-client-library/nuget-upgrade.png

