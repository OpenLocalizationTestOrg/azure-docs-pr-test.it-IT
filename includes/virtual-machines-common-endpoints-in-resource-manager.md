<span data-ttu-id="6370f-101">Nei modelli di distribuzione classica e Resource Manager, l'approccio agli endpoint di Azure è leggermente diverso.</span><span class="sxs-lookup"><span data-stu-id="6370f-101">The approach to Azure endpoints works a little differently between the Classic and Resource Manager deployment models.</span></span> <span data-ttu-id="6370f-102">Nel modello di distribuzione Resource Manager è ora possibile creare filtri di rete che controllano il flusso del traffico in ingresso e in uscita dalle VM.</span><span class="sxs-lookup"><span data-stu-id="6370f-102">In the Resource Manager deployment model, you now have the flexibility to create network filters that control the flow of traffic in and out of your VMs.</span></span> <span data-ttu-id="6370f-103">Questi filtri consentono di creare ambienti di rete complessi, oltre a un endpoint semplice come nel modello di distribuzione classica.</span><span class="sxs-lookup"><span data-stu-id="6370f-103">These filters allow you to create complex networking environments beyond a simple endpoint as in the Classic deployment model.</span></span> <span data-ttu-id="6370f-104">Questo articolo offre una panoramica dei gruppi di sicurezza di rete, delle differenze rispetto all'uso degli endpoint del modello di distribuzione classica, della creazione di regole di filtro e di scenari di distribuzione di esempio.</span><span class="sxs-lookup"><span data-stu-id="6370f-104">This article provides an overview of Network Security Groups and how they differ from using Classic endpoints, creating these filtering rules, and sample deployment scenarios.</span></span>

## <a name="overview-of-resource-manager-deployments"></a><span data-ttu-id="6370f-105">Panoramica delle distribuzioni Resource Manager</span><span class="sxs-lookup"><span data-stu-id="6370f-105">Overview of Resource Manager deployments</span></span>
<span data-ttu-id="6370f-106">Gli endpoint del modello di distribuzione classica sono sostituiti da gruppi di sicurezza di rete e regole dell'elenco di controllo di accesso (ACL).</span><span class="sxs-lookup"><span data-stu-id="6370f-106">Endpoints in the Classic deployment model are replaced by Network Security Groups and access control list (ACL) rules.</span></span> <span data-ttu-id="6370f-107">Le azioni rapide per implementare le regole ACL dei gruppi di sicurezza di rete sono le seguenti:</span><span class="sxs-lookup"><span data-stu-id="6370f-107">Quick steps for implementing Network Security Group ACL rules are:</span></span>

* <span data-ttu-id="6370f-108">Creare un gruppo di sicurezza di rete.</span><span class="sxs-lookup"><span data-stu-id="6370f-108">Create a Network Security Group.</span></span>
* <span data-ttu-id="6370f-109">Definire le regole ACL del gruppo di sicurezza di rete per consentire o impedire il traffico.</span><span class="sxs-lookup"><span data-stu-id="6370f-109">To allow or deny traffic, define your Network Security Group ACL rules.</span></span>
* <span data-ttu-id="6370f-110">Assegnare il gruppo di sicurezza di rete a un'interfaccia di rete o a una subnet di rete virtuale.</span><span class="sxs-lookup"><span data-stu-id="6370f-110">Assign your Network Security Group to a network interface or virtual network subnet.</span></span>

<span data-ttu-id="6370f-111">Se si vuole eseguire anche il port forwarding, è necessario inserire un servizio di bilanciamento del carico a monte della VM e usare regole NAT.</span><span class="sxs-lookup"><span data-stu-id="6370f-111">If you are wanting to also perform port-forwarding, you need to place a load balancer in front of your VM and use NAT rules.</span></span> <span data-ttu-id="6370f-112">Le azioni rapide per implementare un servizio di bilanciamento del carico e regole NAT saranno le seguenti:</span><span class="sxs-lookup"><span data-stu-id="6370f-112">Quick steps for implementing a load balancer and NAT rules would be as follows:</span></span>

* <span data-ttu-id="6370f-113">Creare un servizio di bilanciamento del carico.</span><span class="sxs-lookup"><span data-stu-id="6370f-113">Create a load balancer.</span></span>
* <span data-ttu-id="6370f-114">Creare un pool back-end e aggiungere le VM al pool.</span><span class="sxs-lookup"><span data-stu-id="6370f-114">Create a backend pool and add your VMs to the pool.</span></span>
* <span data-ttu-id="6370f-115">Definire le regole NAT per il port forwarding.</span><span class="sxs-lookup"><span data-stu-id="6370f-115">Define your NAT rules for the required port forwarding.</span></span>
* <span data-ttu-id="6370f-116">Assegnare le regole NAT alle VM.</span><span class="sxs-lookup"><span data-stu-id="6370f-116">Assign your NAT rules to your VMs.</span></span>

## <a name="network-security-group-overview"></a><span data-ttu-id="6370f-117">Panoramica dei gruppi di sicurezza di rete</span><span class="sxs-lookup"><span data-stu-id="6370f-117">Network Security Group overview</span></span>
<span data-ttu-id="6370f-118">I gruppi di sicurezza di rete offrono un livello di sicurezza con cui è possibile consentire a porte e subnet specifiche l'accesso alle VM.</span><span class="sxs-lookup"><span data-stu-id="6370f-118">Network Security Groups provide a layer of security for you to allow specific ports and subnets to access your VMs.</span></span> <span data-ttu-id="6370f-119">In genere è sempre presente un gruppo di sicurezza di rete che fornisce questo livello di sicurezza tra le VM e il mondo esterno.</span><span class="sxs-lookup"><span data-stu-id="6370f-119">You typically always have a Network Security Group providing this layer of security between your VMs and the outside world.</span></span> <span data-ttu-id="6370f-120">I gruppi di sicurezza di rete possono essere applicati a una subnet di rete virtuale o a una specifica interfaccia di rete per una VM.</span><span class="sxs-lookup"><span data-stu-id="6370f-120">Network Security Groups can be applied to a virtual network subnet or a specific network interface for a VM.</span></span> <span data-ttu-id="6370f-121">Invece di creare regole ACL di endpoint, si creano le regole ACL dei gruppi di sicurezza di rete.</span><span class="sxs-lookup"><span data-stu-id="6370f-121">Rather than creating endpoint ACL rules, you now create Network Security Group ACL rules.</span></span> <span data-ttu-id="6370f-122">Tali regole ACL garantiscono un controllo notevolmente superiore rispetto alla semplice creazione di un endpoint per il port forwarding di una determinata porta.</span><span class="sxs-lookup"><span data-stu-id="6370f-122">These ACL rules provide much greater control than simply creating an endpoint to forward a given port.</span></span> <span data-ttu-id="6370f-123">Per altre informazioni, vedere [Informazioni sui gruppi di sicurezza di rete](../articles/virtual-network/virtual-networks-nsg.md).</span><span class="sxs-lookup"><span data-stu-id="6370f-123">For more information, see [What is a Network Security Group?](../articles/virtual-network/virtual-networks-nsg.md)</span></span>

> [!TIP]
> <span data-ttu-id="6370f-124">I gruppi di sicurezza di rete possono essere assegnati a più subnet o interfacce di rete.</span><span class="sxs-lookup"><span data-stu-id="6370f-124">You can assign Network Security Groups to multiple subnets or network interfaces.</span></span> <span data-ttu-id="6370f-125">Non esiste un mapping 1:1.</span><span class="sxs-lookup"><span data-stu-id="6370f-125">There is no 1:1 mapping.</span></span> <span data-ttu-id="6370f-126">È possibile creare un gruppo di sicurezza di rete con un set comune di regole ACL e applicarlo a più subnet o interfacce di rete.</span><span class="sxs-lookup"><span data-stu-id="6370f-126">You can create a Network Security Group with a common set of ACL rules and apply to multiple subnets or network interfaces.</span></span> <span data-ttu-id="6370f-127">Il gruppo di sicurezza di rete può anche essere applicato a risorse all'interno della sottoscrizione, con il [controllo degli accessi in base al ruolo](../articles/active-directory/role-based-access-control-what-is.md).</span><span class="sxs-lookup"><span data-stu-id="6370f-127">Further, Network Security Group can be applied to resources across your subscription (based on [Role Based Access Controls](../articles/active-directory/role-based-access-control-what-is.md).</span></span>

## <a name="load-balancers-overview"></a><span data-ttu-id="6370f-128">Panoramica dei servizi di bilanciamento del carico</span><span class="sxs-lookup"><span data-stu-id="6370f-128">Load Balancers overview</span></span>
<span data-ttu-id="6370f-129">Nel modello di distribuzione classica, tutte le operazioni Network Address Translation (NAT) e di port forwarding in un servizio cloud vengono eseguite da Azure.</span><span class="sxs-lookup"><span data-stu-id="6370f-129">In the Classic deployment model, Azure would perform all the Network Address Translation (NAT) and port forwarding on a Cloud Service for you.</span></span> <span data-ttu-id="6370f-130">Quando si crea un endpoint, si specifica la porta esterna da esporre con la porta interna a cui indirizzare il traffico.</span><span class="sxs-lookup"><span data-stu-id="6370f-130">When creating an endpoint, you would specify the external port to expose along with the internal port to direct traffic to.</span></span> <span data-ttu-id="6370f-131">I gruppi di sicurezza di rete non eseguono autonomamente le stesse operazioni NAT e di port forwarding.</span><span class="sxs-lookup"><span data-stu-id="6370f-131">Network Security Groups by themselves do not perform this same NAT and port forwarding.</span></span> 

<span data-ttu-id="6370f-132">Per consentire la creazione delle regole NAT per il port forwarding, creare un'istanza di Azure Load Balancer nel gruppo di risorse.</span><span class="sxs-lookup"><span data-stu-id="6370f-132">To allow you to create NAT rules for such port forwarding, create an Azure load balancer in your resource group.</span></span> <span data-ttu-id="6370f-133">Il livello di granularità del servizio di bilanciamento del carico è sufficiente a consentire l'applicazione solo a VM specifiche, se necessario.</span><span class="sxs-lookup"><span data-stu-id="6370f-133">Again, the load balancer is granular enough to only apply to specific VMs if needed.</span></span> <span data-ttu-id="6370f-134">Le regole NAT di Azure Load Balancer vengono usate insieme alle regole ACL del gruppo di sicurezza di rete per offrire un livello di flessibilità e controllo nettamente superiore rispetto a quello ottenibile con gli endpoint del servizio cloud.</span><span class="sxs-lookup"><span data-stu-id="6370f-134">The Azure load balancer NAT rules work alongside Network Security Group ACL rules to provide much more flexibility and control than was achievable using Cloud Service endpoints.</span></span> <span data-ttu-id="6370f-135">Per altre informazioni, vedere la panoramica del [servizio di bilanciamento del carico](../articles/load-balancer/load-balancer-overview.md).</span><span class="sxs-lookup"><span data-stu-id="6370f-135">For more information, see the [load balancer overview](../articles/load-balancer/load-balancer-overview.md).</span></span>

## <a name="network-security-group-acl-rules"></a><span data-ttu-id="6370f-136">Regole ACL dei gruppi di sicurezza di rete</span><span class="sxs-lookup"><span data-stu-id="6370f-136">Network Security Group ACL rules</span></span>
<span data-ttu-id="6370f-137">Le regole ACL permettono di definire il traffico consentito in ingresso e in uscita dalla VM in base a porte, intervalli di porte o protocolli specifici.</span><span class="sxs-lookup"><span data-stu-id="6370f-137">ACL rules let you define what traffic can flow in and out of your VM based on specific ports, port ranges, or protocols.</span></span> <span data-ttu-id="6370f-138">Le regole vengono assegnate a singole macchine virtuali o a una subnet.</span><span class="sxs-lookup"><span data-stu-id="6370f-138">Rules are assigned to individual VMs or to a subnet.</span></span> <span data-ttu-id="6370f-139">Lo screenshot seguente contiene un esempio delle regole ACL per un server Web comune:</span><span class="sxs-lookup"><span data-stu-id="6370f-139">The following screenshot is an example of ACL rules for a common webserver:</span></span>

![Elenco di regole ACL di un gruppo di sicurezza di rete](./media/virtual-machines-common-endpoints-in-resource-manager/example-acl-rules.png)

<span data-ttu-id="6370f-141">Le regole ACL vengono applicate in base a una metrica di priorità specificata dall'utente (più il valore è alto, minore è la priorità).</span><span class="sxs-lookup"><span data-stu-id="6370f-141">ACL rules are applied based on a priority metric that you specify - the higher the value, the lower the priority.</span></span> <span data-ttu-id="6370f-142">Ogni gruppo di sicurezza di rete include tre regole predefinite progettate per gestire il flusso del traffico di rete di Azure, con una regola `DenyAllInbound` esplicita come regola finale.</span><span class="sxs-lookup"><span data-stu-id="6370f-142">Every Network Security Group has three default rules that are designed to handle the flow of Azure networking traffic, with an explicit `DenyAllInbound` as the final rule.</span></span> <span data-ttu-id="6370f-143">Alle regole ACL predefinite viene assegnata una priorità bassa in modo che non interferiscano con le regole create dall'utente.</span><span class="sxs-lookup"><span data-stu-id="6370f-143">Default ACL rules are given a low priority to not interfere with rules you create.</span></span>

## <a name="assigning-network-security-groups"></a><span data-ttu-id="6370f-144">Assegnazione dei gruppi di sicurezza di rete</span><span class="sxs-lookup"><span data-stu-id="6370f-144">Assigning Network Security Groups</span></span>
<span data-ttu-id="6370f-145">Un gruppo di sicurezza di rete viene assegnato a una subnet o un'interfaccia di rete.</span><span class="sxs-lookup"><span data-stu-id="6370f-145">You assign a Network Security Group to a subnet or a network interface.</span></span> <span data-ttu-id="6370f-146">Questo approccio consente di ottenere il livello di granularità necessario quando si applicano le regole ACL solo a una specifica VM oppure di assicurarsi che un set comune di regole ACL venga applicato a tutte le VM che fanno parte di una subnet:</span><span class="sxs-lookup"><span data-stu-id="6370f-146">This approach allows you to be as granular as needed when applying your ACL rules to only a specific VM, or ensure a common set of ACL rules are applied to all VMs part of a subnet:</span></span>

![Applicazione di gruppi di sicurezza di rete a interfacce di rete o subnet](./media/virtual-machines-common-endpoints-in-resource-manager/apply-nsg-to-resources.png)

<span data-ttu-id="6370f-148">Il comportamento di un gruppo di sicurezza di rete non cambia a seconda che venga assegnato a una subnet o a un'interfaccia di rete.</span><span class="sxs-lookup"><span data-stu-id="6370f-148">The behavior of the Network Security Group doesn't change depending on being assigned to a subnet or a network interface.</span></span> <span data-ttu-id="6370f-149">Uno scenario di distribuzione comune prevede l'assegnazione del gruppo di sicurezza di rete a una subnet per garantire la conformità di tutte le VM collegate a tale subnet.</span><span class="sxs-lookup"><span data-stu-id="6370f-149">A common deployment scenario has the Network Security Group assigned to a subnet to ensure compliance of all VMs attached to that subnet.</span></span> <span data-ttu-id="6370f-150">Per altre informazioni, vedere l'[applicazione dei gruppi di sicurezza di rete alle risorse](../articles/virtual-network/virtual-networks-nsg.md#associating-nsgs).</span><span class="sxs-lookup"><span data-stu-id="6370f-150">For more information, see [applying Network Security groups to resources](../articles/virtual-network/virtual-networks-nsg.md#associating-nsgs).</span></span>

## <a name="default-behavior-of-network-security-groups"></a><span data-ttu-id="6370f-151">Comportamento predefinito dei gruppi di sicurezza di rete</span><span class="sxs-lookup"><span data-stu-id="6370f-151">Default behavior of Network Security Groups</span></span>
<span data-ttu-id="6370f-152">A seconda di come e quando si crea il gruppo di sicurezza di rete, possono essere create regole predefinite per le VM di Windows per consentire l'accesso RDP sulla porta TCP 3389.</span><span class="sxs-lookup"><span data-stu-id="6370f-152">Depending on how and when you create your Network Security Group, default rules may be created for Windows VMs to permit RDP access on TCP port 3389.</span></span> <span data-ttu-id="6370f-153">Le regole predefinite per le macchine virtuali Linux consentono l'accesso SSH sulla porta TCP 22.</span><span class="sxs-lookup"><span data-stu-id="6370f-153">Default rules for Linux VMs permit SSH access on TCP port 22.</span></span> <span data-ttu-id="6370f-154">Queste regole ACL automatiche vengono create nelle condizioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="6370f-154">These automatic ACL rules are created under the following conditions:</span></span>

* <span data-ttu-id="6370f-155">Se si crea una VM Windows con il portale e si accetta l'azione predefinita per la creazione di un gruppo di sicurezza di rete, viene creata una regola ACL per consentire la porta TCP 3389 (RDP).</span><span class="sxs-lookup"><span data-stu-id="6370f-155">If you create a Windows VM through the portal and accept the default action to create a Network Security Group, an ACL rule to allow TCP port 3389 (RDP) is created.</span></span>
* <span data-ttu-id="6370f-156">Se si crea una VM Linux con il portale e si accetta l'azione predefinita per la creazione di un gruppo di sicurezza di rete, viene creata una regola ACL per consentire la porta TCP 22 (SSH).</span><span class="sxs-lookup"><span data-stu-id="6370f-156">If you create a Linux VM through the portal and accept the default action to create a Network Security Group, an ACL rule to allow TCP port 22 (SSH) is created.</span></span>

<span data-ttu-id="6370f-157">In tutte le altre condizioni, queste regole ACL predefinite non vengono create.</span><span class="sxs-lookup"><span data-stu-id="6370f-157">Under all other conditions, these default ACL rules are not created.</span></span> <span data-ttu-id="6370f-158">Non è possibile connettersi alla VM senza creare regole ACL appropriate.</span><span class="sxs-lookup"><span data-stu-id="6370f-158">You cannot connect to your VM without creating the appropriate ACL rules.</span></span> <span data-ttu-id="6370f-159">Queste condizioni includono le azioni comuni seguenti:</span><span class="sxs-lookup"><span data-stu-id="6370f-159">These conditions include the following common actions:</span></span>

* <span data-ttu-id="6370f-160">Creazione di un gruppo di sicurezza di rete con il portale come azione separata rispetto alla creazione della VM.</span><span class="sxs-lookup"><span data-stu-id="6370f-160">Creating a Network Security Group through the portal as a separate action to creating the VM.</span></span>
* <span data-ttu-id="6370f-161">Creazione di un gruppo di sicurezza di rete a livello di codice con PowerShell, l'interfaccia della riga di comando di Azure, API REST e così via.</span><span class="sxs-lookup"><span data-stu-id="6370f-161">Creating a Network Security Group programmatically through PowerShell, Azure CLI, Rest APIs, etc.</span></span>
* <span data-ttu-id="6370f-162">Creazione di una VM e relativa assegnazione a un gruppo di sicurezza di rete esistente per cui non è già definita la regola ACL appropriata.</span><span class="sxs-lookup"><span data-stu-id="6370f-162">Creating a VM and assigning it to an existing Network Security Group that does not already have the appropriate ACL rule defined.</span></span>

<span data-ttu-id="6370f-163">In tutti i casi indicati, è necessario creare regole ACL per la VM per consentire le connessioni di gestione remota appropriate.</span><span class="sxs-lookup"><span data-stu-id="6370f-163">In all the preceding cases, you need to create ACL rules for your VM to allow the appropriate remote management connections.</span></span>

## <a name="default-behavior-of-a-vm-without-a-network-security-group"></a><span data-ttu-id="6370f-164">Comportamento predefinito di una VM senza un gruppo di sicurezza di rete</span><span class="sxs-lookup"><span data-stu-id="6370f-164">Default behavior of a VM without a Network Security Group</span></span>
<span data-ttu-id="6370f-165">È possibile creare una VM senza creare un gruppo di sicurezza di rete.</span><span class="sxs-lookup"><span data-stu-id="6370f-165">You can create a VM without creating a Network Security Group.</span></span> <span data-ttu-id="6370f-166">In queste situazioni, è possibile connettersi alla VM con RDP o SSH senza creare regole ACL.</span><span class="sxs-lookup"><span data-stu-id="6370f-166">In these situations, you can connect to your VM using RDP or SSH without creating any ACL rules.</span></span> <span data-ttu-id="6370f-167">Analogamente, se è stato installato un servizio Web sulla porta 80, tale servizio è automaticamente accessibile in remoto.</span><span class="sxs-lookup"><span data-stu-id="6370f-167">Similarly, if you installed a web service on port 80, that service is automatically accessible remotely.</span></span> <span data-ttu-id="6370f-168">Tutte le porte della VM sono aperte.</span><span class="sxs-lookup"><span data-stu-id="6370f-168">The VM has all ports open.</span></span>

> [!NOTE]
> <span data-ttu-id="6370f-169">Per le connessioni remote, è comunque necessario un indirizzo IP pubblico assegnato a una VM.</span><span class="sxs-lookup"><span data-stu-id="6370f-169">You still need to have a public IP address assigned to a VM in order for any remote connections.</span></span> <span data-ttu-id="6370f-170">L'assenza di un gruppo di sicurezza di rete per la subnet o l'interfaccia di rete non espone la VM a tutto il traffico esterno.</span><span class="sxs-lookup"><span data-stu-id="6370f-170">Not having a Network Security Group for the subnet or network interface doesn't expose the VM to any external traffic.</span></span> <span data-ttu-id="6370f-171">Quando si crea una VM con il portale, l'azione predefinita prevede la creazione di un nuovo IP pubblico.</span><span class="sxs-lookup"><span data-stu-id="6370f-171">The default action when creating a VM through the portal is to create a new public IP.</span></span> <span data-ttu-id="6370f-172">In tutte le altre forme di creazione di una VM, come PowerShell, l'interfaccia della riga di comando di Azure o un modello di Resource Manager, non viene creato automaticamente un IP pubblico se non esplicitamente richiesto.</span><span class="sxs-lookup"><span data-stu-id="6370f-172">For all other forms of creating a VM such as PowerShell, Azure CLI, or Resource Manager template, a public IP is not automatically created unless explicitly requested.</span></span> <span data-ttu-id="6370f-173">L'azione predefinita con il portale prevede anche la creazione di un gruppo di sicurezza di rete.</span><span class="sxs-lookup"><span data-stu-id="6370f-173">The default action through the portal is also to create a Network Security Group.</span></span> <span data-ttu-id="6370f-174">Con questa azione predefinita non si dovrebbe quindi verificare la situazione di una VM esposta senza filtri di rete.</span><span class="sxs-lookup"><span data-stu-id="6370f-174">This default action means you shouldn't end up in a situation with an exposed VM that has no network filtering in place.</span></span>

## <a name="understanding-load-balancers-and-nat-rules"></a><span data-ttu-id="6370f-175">Informazioni su servizi di bilanciamento del carico e regole NAT</span><span class="sxs-lookup"><span data-stu-id="6370f-175">Understanding Load Balancers and NAT rules</span></span>
<span data-ttu-id="6370f-176">Nel modello di distribuzione classica, è possibile creare endpoint che eseguono anche il port forwarding.</span><span class="sxs-lookup"><span data-stu-id="6370f-176">In the Classic deployment model, you could create endpoints that also performed port forwarding.</span></span> <span data-ttu-id="6370f-177">Quando si crea una macchina virtuale nel modello di distribuzione classica, le regole ACL per RDP o SSH vengono create automaticamente.</span><span class="sxs-lookup"><span data-stu-id="6370f-177">When you create a VM in the Classic deployment model, ACL rules for RDP or SSH would be automatically created.</span></span> <span data-ttu-id="6370f-178">La porta TCP 3389 o la porta TCP 22 rispettivamente non vengono esposte all'esterno.</span><span class="sxs-lookup"><span data-stu-id="6370f-178">These rules would not expose TCP port 3389 or TCP port 22 respectively to the outside world.</span></span> <span data-ttu-id="6370f-179">Viene invece esposta una porta TCP di valore elevato con mapping alla porta interna appropriata.</span><span class="sxs-lookup"><span data-stu-id="6370f-179">Instead, a high-value TCP port would be exposed that maps to the appropriate internal port.</span></span> <span data-ttu-id="6370f-180">È anche possibile creare regole ACL personalizzate in modo analogo, ad esempio esporre un server Web al mondo esterno sulla porta TCP 4280.</span><span class="sxs-lookup"><span data-stu-id="6370f-180">You could also create your own ACL rules in a similar manner, such as expose a webserver on TCP port 4280 to the outside world.</span></span> <span data-ttu-id="6370f-181">Lo screenshot seguente del portale classico illustra queste regole ACL e i mapping delle porte:</span><span class="sxs-lookup"><span data-stu-id="6370f-181">You can see these ACL rules and port mappings in the following screenshot from the Classic portal:</span></span>

![Port forwarding con endpoint del modello di distribuzione classica](./media/virtual-machines-common-endpoints-in-resource-manager/classic-endpoints-port-forwarding.png)

<span data-ttu-id="6370f-183">Con i gruppi di sicurezza di rete, la funzione di port forwarding è gestita da un servizio di bilanciamento del carico.</span><span class="sxs-lookup"><span data-stu-id="6370f-183">With Network Security Groups, that port-forwarding function is handled by a load balancer.</span></span> <span data-ttu-id="6370f-184">Per altre informazioni, vedere la [panoramica dei servizi di bilanciamento del carico in Azure](../articles/load-balancer/load-balancer-overview.md).</span><span class="sxs-lookup"><span data-stu-id="6370f-184">For more information, see [load balancers in Azure](../articles/load-balancer/load-balancer-overview.md).</span></span> <span data-ttu-id="6370f-185">L'esempio seguente illustra un servizio di bilanciamento del carico con una regola NAT per il port forwarding della porta TCP 4222 alla porta TCP 22 interna di una VM:</span><span class="sxs-lookup"><span data-stu-id="6370f-185">The following example shows a load balancer with a NAT rule to perform port-forwarding TCP port 4222 to the internal TCP port 22 a VM:</span></span>

![Regole NAT del servizio di bilanciamento del carico per il port forwarding](./media/virtual-machines-common-endpoints-in-resource-manager/load-balancer-nat-rules.png)

> [!NOTE]
> <span data-ttu-id="6370f-187">Quando si implementa un servizio di bilanciamento del carico, in genere non si assegna un indirizzo IP pubblico alla VM.</span><span class="sxs-lookup"><span data-stu-id="6370f-187">When you implement a load balancer, you typically don't assign the VM itself a public IP address.</span></span> <span data-ttu-id="6370f-188">Al servizio di bilanciamento del carico viene invece assegnato un indirizzo IP pubblico.</span><span class="sxs-lookup"><span data-stu-id="6370f-188">Instead, the load balancer has a public IP address assigned to it.</span></span> <span data-ttu-id="6370f-189">È comunque necessario creare un gruppo di sicurezza di rete e regole ACL per definire il flusso del traffico in ingresso e in uscita dalla VM.</span><span class="sxs-lookup"><span data-stu-id="6370f-189">You still need to create your Network Security Group and ACL rules to define the flow of traffic in and out of your VM.</span></span> <span data-ttu-id="6370f-190">Le regole NAT del servizio di bilanciamento del carico hanno semplicemente lo scopo di definire le porte consentite tramite il servizio di bilanciamento del carico e come vengono distribuite tra le VM back-end.</span><span class="sxs-lookup"><span data-stu-id="6370f-190">The load balancer NAT rules are simply to define what ports are allowed through the load balancer and how they get distributed across the backend VMs.</span></span> <span data-ttu-id="6370f-191">È quindi necessario creare una regola NAT perché il traffico possa transitare attraverso il servizio di bilanciamento del carico.</span><span class="sxs-lookup"><span data-stu-id="6370f-191">As such, you need to create a NAT rule for traffic to flow through the load balancer.</span></span> <span data-ttu-id="6370f-192">Creare una regola ACL del gruppo di sicurezza di rete per consentire al traffico di raggiungere la VM.</span><span class="sxs-lookup"><span data-stu-id="6370f-192">To allow the traffic to reach the VM, create a Network Security Group ACL rule.</span></span>
