---
title: aaaTest failover tooAzure in Site Recovery | Documenti Microsoft
description: Informazioni sull'esecuzione di un failover di test da tooAzure locale
services: site-recovery
documentationcenter: 
author: prateek9us
manager: gauravd
editor: 
ms.assetid: 44813a48-c680-4581-a92e-cecc57cc3b1e
ms.service: site-recovery
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: storage-backup-recovery
ms.date: 07/04/2017
ms.author: pratshar
ms.openlocfilehash: fa0a93f409cc9f2c2c06c2d91c65971dc90c507f
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/06/2017
---
# <a name="test--failover-tooazure-in-site-recovery"></a><span data-ttu-id="d23bb-103">Test Failover tooAzure in Site Recovery</span><span class="sxs-lookup"><span data-stu-id="d23bb-103">Test  Failover tooAzure in Site Recovery</span></span>



<span data-ttu-id="d23bb-104">In questo articolo fornisce informazioni e istruzioni per effettuare un failover di test o un ripristino di emergenza delle macchine virtuali e server fisici che sono protetti con il ripristino del sito, usare Azure come sito di ripristino hello.</span><span class="sxs-lookup"><span data-stu-id="d23bb-104">This article provides information and instructions for doing a test failover or a DR drill of virtual machines and physical servers that are protected with Site Recovery using Azure as hello recovery site.</span></span>

<span data-ttu-id="d23bb-105">Inviare eventuali commenti o domande nella parte inferiore di hello di questo articolo, o di hello [forum sui servizi di ripristino di Azure](https://social.msdn.microsoft.com/forums/azure/home?forum=hypervrecovmgr).</span><span class="sxs-lookup"><span data-stu-id="d23bb-105">Post any comments or questions at hello bottom of this article, or on hello [Azure Recovery Services Forum](https://social.msdn.microsoft.com/forums/azure/home?forum=hypervrecovmgr).</span></span>

<span data-ttu-id="d23bb-106">Failover di test è toovalidate la strategia di replica oppure eseguire un'analisi di ripristino di emergenza senza alcuna perdita di dati o il tempo di inattività.</span><span class="sxs-lookup"><span data-stu-id="d23bb-106">Test failover is run toovalidate your replication strategy or perform a disaster recovery drill without any data loss or downtime.</span></span> <span data-ttu-id="d23bb-107">Effettuare un failover di test non hanno alcun impatto sulla replica in corso di hello o nell'ambiente di produzione.</span><span class="sxs-lookup"><span data-stu-id="d23bb-107">Doing a test failover doesn't have any impact on hello ongoing replication or on your production environment.</span></span> <span data-ttu-id="d23bb-108">Il failover di test può essere eseguito su una macchina virtuale o un [piano di ripristino](site-recovery-create-recovery-plans.md).</span><span class="sxs-lookup"><span data-stu-id="d23bb-108">Test failover can be done either on a virtual machine or a [recovery plan](site-recovery-create-recovery-plans.md).</span></span> <span data-ttu-id="d23bb-109">Al momento della generazione di un failover di test, è necessario test toowhich rete hello toospecify connessione macchine virtuali.</span><span class="sxs-lookup"><span data-stu-id="d23bb-109">When triggering a test failover, you need toospecify hello network toowhich test virtual machines would connect to.</span></span> <span data-ttu-id="d23bb-110">Una volta che viene attivato un failover di test, è possibile monitorare lo stato di avanzamento in hello **processi** pagina.</span><span class="sxs-lookup"><span data-stu-id="d23bb-110">Once a test failover is triggered, you can track progress in hello **Jobs** page.</span></span>  


## <a name="supported-scenarios"></a><span data-ttu-id="d23bb-111">Scenari supportati</span><span class="sxs-lookup"><span data-stu-id="d23bb-111">Supported scenarios</span></span>
<span data-ttu-id="d23bb-112">Test del failover è supportato in tutti gli scenari di distribuzione diverso da [legacy VMware sito tooAzure](site-recovery-vmware-to-azure-classic-legacy.md).</span><span class="sxs-lookup"><span data-stu-id="d23bb-112">Test failover is supported in all deployment scenarios other than [legacy VMware site tooAzure](site-recovery-vmware-to-azure-classic-legacy.md).</span></span> <span data-ttu-id="d23bb-113">Failover di test non è anche supportato quando la macchina virtuale è stata eseguita in tooAzure.</span><span class="sxs-lookup"><span data-stu-id="d23bb-113">Test failover is also not supported when virtual machine has been failed over tooAzure.</span></span>  


## <a name="run-a-test-failover"></a><span data-ttu-id="d23bb-114">Eseguire un failover di test</span><span class="sxs-lookup"><span data-stu-id="d23bb-114">Run a test failover</span></span>
<span data-ttu-id="d23bb-115">Questa procedura viene descritto come toorun un failover di test per il ripristino di un piano.</span><span class="sxs-lookup"><span data-stu-id="d23bb-115">This procedure describes how toorun a test failover for a recovery plan.</span></span> <span data-ttu-id="d23bb-116">In alternativa è possibile eseguire anche il failover di test per una singola macchina tramite conveniente hello su di esso.</span><span class="sxs-lookup"><span data-stu-id="d23bb-116">Alternatively you can also run test failover for a single machine by using hello appropriate option on it.</span></span>

![Failover di test](./media/site-recovery-test-failover-to-azure/TestFailover.png)


1. <span data-ttu-id="d23bb-118">Selezionare **Piani di ripristino** > *nome_pianodiripristino*.</span><span class="sxs-lookup"><span data-stu-id="d23bb-118">Select **Recovery Plans** > *recoveryplan_name*.</span></span> <span data-ttu-id="d23bb-119">Fare clic su **Failover di test**.</span><span class="sxs-lookup"><span data-stu-id="d23bb-119">Click **Test Failover**.</span></span>
1. <span data-ttu-id="d23bb-120">Selezionare un **punto di ripristino** toofailover per.</span><span class="sxs-lookup"><span data-stu-id="d23bb-120">Select a **Recovery Point** toofailover to.</span></span> <span data-ttu-id="d23bb-121">È possibile utilizzare una delle seguenti opzioni hello:</span><span class="sxs-lookup"><span data-stu-id="d23bb-121">You can use one of hello following options:</span></span>
    1.  <span data-ttu-id="d23bb-122">**Ultima elaborazione**: questa opzione viene eseguito il failover tutte le macchine virtuali hello piano toohello ultimo ripristino del punto di ripristino che è già stato elaborato dal servizio Site Recovery.</span><span class="sxs-lookup"><span data-stu-id="d23bb-122">**Latest processed**: This option fails over all virtual machines of hello recovery plan toohello latest recovery point that has already been processed by Site Recovery service.</span></span> <span data-ttu-id="d23bb-123">Quando si esegue il failover di test di una macchina virtuale, viene visualizzato anche i timestamp dell'ultimo punto di ripristino elaborato hello.</span><span class="sxs-lookup"><span data-stu-id="d23bb-123">When you are doing test failover of a virtual machine, time stamp of hello latest processed recovery point is also shown.</span></span> <span data-ttu-id="d23bb-124">Se si esegue il failover di un piano di ripristino, è possibile passare una macchina virtuale tooindividual e osservare **punti di ripristino più recente** riquadro tooget queste informazioni.</span><span class="sxs-lookup"><span data-stu-id="d23bb-124">If you are doing failover of a recovery plan, you can go tooindividual virtual machine and look at **Latest Recovery Points** tile tooget this information.</span></span> <span data-ttu-id="d23bb-125">Come non viene impiegato per l'ora tooprocess hello dati non elaborati, questa opzione offre un'opzione failover RTO (tempo Recovery Time Objective).</span><span class="sxs-lookup"><span data-stu-id="d23bb-125">As no time is spent tooprocess hello unprocessed data, this option provides a low RTO (Recovery Time Objective) failover option.</span></span>
    1.  <span data-ttu-id="d23bb-126">**Versione più recente coerente con app**: questa opzione non funziona su tutte le macchine virtuali di hello piano toohello più recente dell'applicazione ripristino coerenti con punto di ripristino che è già stato elaborato dal servizio Site Recovery.</span><span class="sxs-lookup"><span data-stu-id="d23bb-126">**Latest app-consistent**: This option fails over all virtual machines of hello recovery plan toohello latest application consistent recovery point that has already been processed by Site Recovery service.</span></span> <span data-ttu-id="d23bb-127">Quando si esegue il failover di test di una macchina virtuale, viene visualizzato anche i timestamp dell'ultimo punto di ripristino coerenti con l'applicazione hello.</span><span class="sxs-lookup"><span data-stu-id="d23bb-127">When you are doing test failover of a virtual machine, time stamp of hello latest app-consistent recovery point is also shown.</span></span> <span data-ttu-id="d23bb-128">Se si esegue il failover di un piano di ripristino, è possibile passare una macchina virtuale tooindividual e osservare **punti di ripristino più recente** riquadro tooget queste informazioni.</span><span class="sxs-lookup"><span data-stu-id="d23bb-128">If you are doing failover of a recovery plan, you can go tooindividual virtual machine and look at **Latest Recovery Points** tile tooget this information.</span></span>
    1.  <span data-ttu-id="d23bb-129">**Più recente**: questa opzione Elabora prima tutti i dati che sono stato inviato tooSite ripristino servizio toocreate un punto di ripristino per ogni macchina virtuale prima del failover li tooit hello.</span><span class="sxs-lookup"><span data-stu-id="d23bb-129">**Latest**: This option first processes all hello data that has been sent tooSite Recovery service toocreate a recovery point for each virtual machine before failing them over tooit.</span></span> <span data-ttu-id="d23bb-130">Questa opzione offre hello più basso RPO (Recovery Point Objective) come macchina virtuale hello creato dopo il failover disporrà di tutti i dati di hello che è stata replicata tooSite servizio di ripristino quando hello failover è stato attivato.</span><span class="sxs-lookup"><span data-stu-id="d23bb-130">This option provides hello lowest RPO (Recovery Point Objective) as hello virtual machine created after failover will have all hello data that has been replicated tooSite Recovery service when hello failover was triggered.</span></span>
    1.  <span data-ttu-id="d23bb-131">**Latest multi-VM processed** (Più recente coerente tra più VM elaborato): questa opzione è disponibile solo per i piani di ripristino con almeno una macchina virtuale in cui è abilitata la coerenza tra più macchine virtuali.</span><span class="sxs-lookup"><span data-stu-id="d23bb-131">**Latest multi-VM processed**: This option is only available for recovery plans that have at least one virtual machine with multi-VM consistency ON.</span></span> <span data-ttu-id="d23bb-132">Macchine virtuali che fanno parte di un gruppo failover toohello più recente comuni tra più macchine coerente ripristino della replica del punto.</span><span class="sxs-lookup"><span data-stu-id="d23bb-132">Virtual machines that are part of a replication group failover toohello latest common multi-VM consistent recovery point.</span></span> <span data-ttu-id="d23bb-133">Altre macchine virtuali failover tootheir ultimo elaborati punto di ripristino.</span><span class="sxs-lookup"><span data-stu-id="d23bb-133">Other virtual machines failover tootheir latest processed recovery point.</span></span>  
    1.  <span data-ttu-id="d23bb-134">**Latest multi-VM app-consistent** (Più recente coerente con l'applicazione tra più VM): questa opzione è disponibile solo per i piani di ripristino con almeno una macchina virtuale in cui è abilitata la coerenza tra più macchine virtuali.</span><span class="sxs-lookup"><span data-stu-id="d23bb-134">**Latest multi-VM app-consistent**: This option is only available for recovery plans that have at least one virtual machine with multi-VM consistency ON.</span></span> <span data-ttu-id="d23bb-135">Macchine virtuali che fanno parte di una replica di tipo gruppo failover toohello ultimo comuni tra più macchine coerenti con l'applicazione punto di ripristino.</span><span class="sxs-lookup"><span data-stu-id="d23bb-135">Virtual machines that are part of a replication group failover toohello latest common multi-VM application-consistent recovery point.</span></span> <span data-ttu-id="d23bb-136">Altre macchine virtuali failover tootheir più recente coerente con l'applicazione del punto di ripristino.</span><span class="sxs-lookup"><span data-stu-id="d23bb-136">Other virtual machines failover tootheir latest application-consistent recovery point.</span></span> 
    1.  <span data-ttu-id="d23bb-137">**Custom**: se si sta eseguendo il failover di test di una macchina virtuale, quindi è possibile utilizzare questo punto di recupero specifico tooa toofailover opzione.</span><span class="sxs-lookup"><span data-stu-id="d23bb-137">**Custom**: If you are doing test failover of a virtual machine, then you can use this option toofailover tooa particular recovery point.</span></span>
1. <span data-ttu-id="d23bb-138">Selezionare un **rete virtuale di Azure**: fornire una rete virtuale di Azure in cui verrebbe create hello macchine virtuali di test.</span><span class="sxs-lookup"><span data-stu-id="d23bb-138">Select an **Azure virtual network**: Provide an Azure virtual network where hello test virtual machines would be created.</span></span> <span data-ttu-id="d23bb-139">Il ripristino del sito tenta toocreate macchine virtuali di test in una subnet con stesso nome e con hello stesso IP a quella fornita **di calcolo e rete** impostazioni della macchina virtuale hello.</span><span class="sxs-lookup"><span data-stu-id="d23bb-139">Site Recovery attempts toocreate test virtual machines in a subnet of same name and using hello same IP as that provided in **Compute and Network** settings of hello virtual machine.</span></span> <span data-ttu-id="d23bb-140">Se non è disponibile nella rete virtuale di Azure fornito per il failover di test, hello subnet stesso nome macchina virtuale di test viene creato nella prima subnet hello in ordine alfabetico.</span><span class="sxs-lookup"><span data-stu-id="d23bb-140">If subnet of same name is not available in hello Azure virtual network provided for test failover, then test virtual machine is created in hello first subnet alphabetically.</span></span> <span data-ttu-id="d23bb-141">Se lo stesso IP non è disponibile nella subnet hello, macchina virtuale riceve un altro indirizzo IP disponibile nella subnet hello.</span><span class="sxs-lookup"><span data-stu-id="d23bb-141">If same IP is not available in hello subnet, then virtual machine gets another IP address available in hello subnet.</span></span> <span data-ttu-id="d23bb-142">Per altri dettagli, vedere [questa sezione](#creating-a-network-for-test-failover).</span><span class="sxs-lookup"><span data-stu-id="d23bb-142">Read this section for [more details](#creating-a-network-for-test-failover)</span></span>
1. <span data-ttu-id="d23bb-143">Se sta failover tooAzure e data encryption è abilitato in **chiave di crittografia** certificato selezionare hello emesso quando è abilitata la crittografia dei dati durante l'installazione del Provider.</span><span class="sxs-lookup"><span data-stu-id="d23bb-143">If you're failing over tooAzure and data encryption is enabled, in **Encryption Key** select hello certificate that was issued when you enabled data encryption during Provider installation.</span></span> <span data-ttu-id="d23bb-144">È possibile ignorare questo passaggio se non è stata abilitata la crittografia nella macchina virtuale hello.</span><span class="sxs-lookup"><span data-stu-id="d23bb-144">You can ignore this step if you have not enabled encryption on hello virtual machine.</span></span>
1. <span data-ttu-id="d23bb-145">Avanzamento di failover su hello **processi** scheda. Si dovrebbe essere macchina di replica in grado di toosee hello test nel portale di Azure hello.</span><span class="sxs-lookup"><span data-stu-id="d23bb-145">Track failover progress on hello **Jobs** tab. You should be able toosee hello test replica machine in hello Azure portal.</span></span>
1. <span data-ttu-id="d23bb-146">una connessione RDP sulla macchina virtuale hello tooinitiate, sarà necessario troppo[aggiungere un indirizzo ip pubblico](site-recovery-monitoring-and-troubleshooting.md#adding-a-public-ip-on-a-resource-manager-virtual-machine) su hello interfaccia di rete di hello non riuscita sulla macchina virtuale.</span><span class="sxs-lookup"><span data-stu-id="d23bb-146">tooinitiate an RDP connection on hello virtual machine, you will need too[add a public ip](site-recovery-monitoring-and-troubleshooting.md#adding-a-public-ip-on-a-resource-manager-virtual-machine) on hello network interface of hello failed over virtual machine.</span></span> <span data-ttu-id="d23bb-147">Se viene eseguito il failover macchina virtuale di tooa classica, quindi è necessario troppo[aggiungere un endpoint](../virtual-machines/windows/classic/setup-endpoints.md) sulla porta 3389</span><span class="sxs-lookup"><span data-stu-id="d23bb-147">If you are failing over tooa Classic virtual machine, then you need too[add an endpoint](../virtual-machines/windows/classic/setup-endpoints.md) on port 3389</span></span>
1. <span data-ttu-id="d23bb-148">Al termine, fare clic su **il failover di test di pulizia** nel piano di ripristino hello.</span><span class="sxs-lookup"><span data-stu-id="d23bb-148">Once you're done, click **Cleanup test failover** on hello recovery plan.</span></span> <span data-ttu-id="d23bb-149">In **note** registrare e salvare eventuali commenti associati hello test failover.</span><span class="sxs-lookup"><span data-stu-id="d23bb-149">In **Notes** record and save any observations associated with hello test failover.</span></span> <span data-ttu-id="d23bb-150">Vengono eliminate le macchine virtuali hello creati durante il failover di test.</span><span class="sxs-lookup"><span data-stu-id="d23bb-150">This deletes hello virtual machines that were created during test failover.</span></span>


> [!TIP]
> <span data-ttu-id="d23bb-151">Il ripristino del sito tenta toocreate macchine virtuali di test in una subnet con stesso nome e con hello stesso IP a quella fornita **di calcolo e rete** impostazioni della macchina virtuale hello.</span><span class="sxs-lookup"><span data-stu-id="d23bb-151">Site Recovery attempts toocreate test virtual machines in a subnet of same name and using hello same IP as that provided in **Compute and Network** settings of hello virtual machine.</span></span> <span data-ttu-id="d23bb-152">Se non è disponibile nella rete virtuale di Azure fornito per il failover di test, hello subnet stesso nome macchina virtuale di test viene creato nella prima subnet hello in ordine alfabetico.</span><span class="sxs-lookup"><span data-stu-id="d23bb-152">If subnet of same name is not available in hello Azure virtual network provided for test failover, then test virtual machine is created in hello first subnet alphabetically.</span></span> <span data-ttu-id="d23bb-153">Se hello IP di destinazione fa parte di hello scelto subnet, il ripristino del sito tenta di macchina virtuale toocreate hello test failover utilizzando l'indirizzo IP di destinazione hello.</span><span class="sxs-lookup"><span data-stu-id="d23bb-153">If hello target IP is part of hello chosen subnet, then site recovery tries toocreate hello test failover virtual machine using hello target IP.</span></span> <span data-ttu-id="d23bb-154">Se l'indirizzo IP di destinazione hello non fa parte di hello scelto subnet macchina virtuale di failover di test viene creato utilizzando qualsiasi IP disponibile in hello scelto subnet.</span><span class="sxs-lookup"><span data-stu-id="d23bb-154">If hello target IP is not part of hello chosen subnet then test failover virtual machine gets created using any available IP in hello chosen subnet.</span></span>
>
>

## <a name="test-failover-job"></a><span data-ttu-id="d23bb-155">Processo di failover di test</span><span class="sxs-lookup"><span data-stu-id="d23bb-155">Test failover job</span></span>

![Failover di test](./media/site-recovery-test-failover-to-azure/TestFailoverJob.png)

<span data-ttu-id="d23bb-157">L'attivazione di un failover di test comporta l'esecuzione dei passaggi riportati di seguito.</span><span class="sxs-lookup"><span data-stu-id="d23bb-157">When a test failover is triggered, it involves following steps:</span></span>

1. <span data-ttu-id="d23bb-158">Verifica preliminare: questo passaggio garantisce che siano soddisfatte tutte le condizioni necessarie per il failover.</span><span class="sxs-lookup"><span data-stu-id="d23bb-158">Prerequisites check: This step ensures that all conditions required for failover are met</span></span>
1. <span data-ttu-id="d23bb-159">Failover: Questo passaggio elabora i dati di hello e rende pronti in modo che sia possibile creare esplicitamente una macchina virtuale di Azure.</span><span class="sxs-lookup"><span data-stu-id="d23bb-159">Failover: This step processes hello data and makes it ready so that an Azure virtual machine can be created out of it.</span></span> <span data-ttu-id="d23bb-160">Se si è scelto **più recente** punto di ripristino, questo passaggio Crea un punto di ripristino dai dati di hello inviati toohello servizio.</span><span class="sxs-lookup"><span data-stu-id="d23bb-160">If you have chosen **Latest** recovery point, this step creates a recovery point from hello data that has been sent toohello service.</span></span>
1. <span data-ttu-id="d23bb-161">Start: Questo passaggio viene creata una macchina virtuale di Azure utilizzando dati hello elaborati nel passaggio precedente hello.</span><span class="sxs-lookup"><span data-stu-id="d23bb-161">Start: This step creates an Azure virtual machine using hello data processed in hello previous step.</span></span>

## <a name="time-taken-for-failover"></a><span data-ttu-id="d23bb-162">Tempo impiegato per il failover</span><span class="sxs-lookup"><span data-stu-id="d23bb-162">Time taken for failover</span></span>

<span data-ttu-id="d23bb-163">In alcuni casi, il failover delle macchine virtuali prevede un passaggio intermedio aggiuntiva che in genere richiede circa 8 too10 minuti toocomplete.</span><span class="sxs-lookup"><span data-stu-id="d23bb-163">In certain cases, failover of virtual machines requires an extra intermediate step that usually takes around 8  too10 minutes toocomplete.</span></span> <span data-ttu-id="d23bb-164">Questi casi sono i seguenti:</span><span class="sxs-lookup"><span data-stu-id="d23bb-164">These cases are as following:</span></span>

* <span data-ttu-id="d23bb-165">Macchine virtuali VMware utilizzando una versione di hello meno recente 9.8 servizio di mobilità</span><span class="sxs-lookup"><span data-stu-id="d23bb-165">VMware virtual machines using a version of hello Mobility service older than 9.8</span></span>
* <span data-ttu-id="d23bb-166">Server fisici</span><span class="sxs-lookup"><span data-stu-id="d23bb-166">Physical servers</span></span>
* <span data-ttu-id="d23bb-167">Macchine virtuali VMware Linux</span><span class="sxs-lookup"><span data-stu-id="d23bb-167">VMware Linux virtual machines</span></span>
* <span data-ttu-id="d23bb-168">Macchine virtuali Hyper-V protette come server fisici</span><span class="sxs-lookup"><span data-stu-id="d23bb-168">Hyper-V virtual machines protected as physical servers</span></span>
* <span data-ttu-id="d23bb-169">Macchine virtuali VMware in cui i driver seguenti non sono presenti come driver di avvio</span><span class="sxs-lookup"><span data-stu-id="d23bb-169">VMware virtual machines where following drivers are not present as boot drivers</span></span>
    * <span data-ttu-id="d23bb-170">storvsc</span><span class="sxs-lookup"><span data-stu-id="d23bb-170">storvsc</span></span>
    * <span data-ttu-id="d23bb-171">vmbus</span><span class="sxs-lookup"><span data-stu-id="d23bb-171">vmbus</span></span>
    * <span data-ttu-id="d23bb-172">storflt</span><span class="sxs-lookup"><span data-stu-id="d23bb-172">storflt</span></span>
    * <span data-ttu-id="d23bb-173">intelide</span><span class="sxs-lookup"><span data-stu-id="d23bb-173">intelide</span></span>
    * <span data-ttu-id="d23bb-174">atapi</span><span class="sxs-lookup"><span data-stu-id="d23bb-174">atapi</span></span>
* <span data-ttu-id="d23bb-175">Macchine virtuali VMware che non dispongono del servizio DHCP abilitato indipendentemente che usino indirizzi IP statici o DHCP.</span><span class="sxs-lookup"><span data-stu-id="d23bb-175">VMware virtual machines that don't have DHCP service enabled irrespective of whether they are using DHCP or static IP addresses</span></span>

<span data-ttu-id="d23bb-176">In hello tutti gli altri casi questo passaggio intermedio non è necessario e tempo per il failover hello hello è notevolmente inferiore.</span><span class="sxs-lookup"><span data-stu-id="d23bb-176">In all hello other cases this intermediate step is not required and hello time taken for hello failover is significantly lower.</span></span>


## <a name="creating-a-network-for-test-failover"></a><span data-ttu-id="d23bb-177">Creazione di una rete per il failover di test</span><span class="sxs-lookup"><span data-stu-id="d23bb-177">Creating a network for test failover</span></span>
<span data-ttu-id="d23bb-178">È consigliabile quando si esegue un failover di test scegliere una rete isolata dalla rete di sito di ripristino di produzione fornito nel **di calcolo e rete** impostazioni per la macchina virtuale hello.</span><span class="sxs-lookup"><span data-stu-id="d23bb-178">It is recommended that when you are doing a test failover you choose a network that is isolated from your production recovery site network that you provided in **Compute and Network** settings for hello virtual machine.</span></span> <span data-ttu-id="d23bb-179">Quando si crea una rete virtuale di Azure, per impostazione predefinita è isolata dalle altre reti.</span><span class="sxs-lookup"><span data-stu-id="d23bb-179">By default when you create an Azure virtual network, it is isolated from other networks.</span></span> <span data-ttu-id="d23bb-180">La rete dovrà simulare la rete di produzione:</span><span class="sxs-lookup"><span data-stu-id="d23bb-180">This network should mimic your production network:</span></span>

1. <span data-ttu-id="d23bb-181">Rete di test deve disporre dello stesso numero di subnet a quello della rete di produzione e con hello stesso nome di quelli della subnet hello nella rete di produzione.</span><span class="sxs-lookup"><span data-stu-id="d23bb-181">Test network should have same number of subnets as that in your production network and with hello same name as those of hello subnets in your production network.</span></span>
1. <span data-ttu-id="d23bb-182">Rete di test deve utilizzare hello stesso intervallo IP di rete di produzione.</span><span class="sxs-lookup"><span data-stu-id="d23bb-182">Test network should use hello same IP range as that of your production network.</span></span>
1. <span data-ttu-id="d23bb-183">Hello aggiornamento DNS della rete di Test come hello IP assegnato come IP di destinazione per la macchina virtuale DNS hello in hello **di calcolo e rete** impostazioni.</span><span class="sxs-lookup"><span data-stu-id="d23bb-183">Update hello DNS of hello Test Network as hello IP that you gave as target IP for hello DNS virtual machine under **Compute and Network** settings.</span></span> <span data-ttu-id="d23bb-184">Per altri dettagli, vedere la sezione [Considerazioni sul failover di test per Active Directory](site-recovery-active-directory.md#test-failover-considerations) .</span><span class="sxs-lookup"><span data-stu-id="d23bb-184">Go through [test failover considerations for active directory](site-recovery-active-directory.md#test-failover-considerations) section for more details.</span></span>


## <a name="test-failover-tooa-production-network-on-recovery-site"></a><span data-ttu-id="d23bb-185">Rete di produzione tooa di failover di test nel sito di ripristino</span><span class="sxs-lookup"><span data-stu-id="d23bb-185">Test failover tooa production network on recovery site</span></span>
<span data-ttu-id="d23bb-186">È consigliabile quando si esegue un failover di test scegliere una rete che è diversa dalla rete di sito di ripristino di produzione fornito nel **di calcolo e rete** impostazioni per la macchina virtuale hello.</span><span class="sxs-lookup"><span data-stu-id="d23bb-186">It is recommended that when you are doing a test failover you choose a network that is different from your production recovery site network that you provided in **Compute and Network** settings for hello virtual machine.</span></span> <span data-ttu-id="d23bb-187">Tuttavia, se si vuole toovalidate di connettività di rete end tooend non riuscita sulla macchina virtuale, si noti hello seguenti punti:</span><span class="sxs-lookup"><span data-stu-id="d23bb-187">But if you really want toovalidate end tooend network connectivity in a failed over virtual machine, note hello following points:</span></span>

1. <span data-ttu-id="d23bb-188">Assicurarsi che la macchina virtuale primaria hello viene chiusa quando si esegue il failover di test hello.</span><span class="sxs-lookup"><span data-stu-id="d23bb-188">Make sure that hello primary virtual machine is shutdown when you are doing hello test failover.</span></span> <span data-ttu-id="d23bb-189">Se non si configura questo, saranno presenti due macchine virtuali con hello stessa identità in esecuzione in hello stessa rete in hello contemporaneamente e che può comportare conseguenze tooundesired.</span><span class="sxs-lookup"><span data-stu-id="d23bb-189">If you don't do so, there will be two virtual machines with hello same identity running in hello same network at hello same time and that can lead tooundesired consequences.</span></span>
1. <span data-ttu-id="d23bb-190">Tutte le modifiche apportate in hello test failover delle macchine virtuali andrebbero perse quando si pulizia hello test failover delle macchine virtuali.</span><span class="sxs-lookup"><span data-stu-id="d23bb-190">Any changes that you make into hello test failover virtual machines would be lost when you cleanup hello test failover virtual machines.</span></span> <span data-ttu-id="d23bb-191">Queste modifiche non saranno macchina virtuale primaria replicati toohello indietro.</span><span class="sxs-lookup"><span data-stu-id="d23bb-191">These changes will not be replicated back toohello primary virtual machine.</span></span>
1. <span data-ttu-id="d23bb-192">Questa modalità di esecuzione di test lead tooa i tempi di inattività dell'applicazione di produzione.</span><span class="sxs-lookup"><span data-stu-id="d23bb-192">This way of doing testing leads tooa downtime of your production application.</span></span> <span data-ttu-id="d23bb-193">Agli utenti di un'applicazione hello devono essere richiesto un'applicazione hello utilizzare toonot quando eseguire il drill-hello ripristino di emergenza è in corso.</span><span class="sxs-lookup"><span data-stu-id="d23bb-193">Users of hello application should be asked toonot use hello application when hello DR drill is in progress.</span></span>  



## <a name="prepare-active-directory-and-dns"></a><span data-ttu-id="d23bb-194">Preparare Active Directory e DNS</span><span class="sxs-lookup"><span data-stu-id="d23bb-194">Prepare Active Directory and DNS</span></span>
<span data-ttu-id="d23bb-195">toorun un failover di test per test dell'applicazione, è necessario una copia dell'ambiente Active Directory di produzione hello nell'ambiente di test.</span><span class="sxs-lookup"><span data-stu-id="d23bb-195">toorun a test failover for application testing, you need a copy of hello production Active Directory environment in your test environment.</span></span> <span data-ttu-id="d23bb-196">Per altri dettagli, vedere la sezione [Considerazioni sul failover di test per Active Directory](site-recovery-active-directory.md#test-failover-considerations) .</span><span class="sxs-lookup"><span data-stu-id="d23bb-196">Go through [test failover considerations for active directory](site-recovery-active-directory.md#test-failover-considerations) section for more details.</span></span>

## <a name="prepare-tooconnect-tooazure-vms-after-failover"></a><span data-ttu-id="d23bb-197">Preparazione di macchine virtuali tooAzure tooconnect dopo il failover</span><span class="sxs-lookup"><span data-stu-id="d23bb-197">Prepare tooconnect tooAzure VMs after failover</span></span>

<span data-ttu-id="d23bb-198">Se si desidera tooconnect tooAzure macchine virtuali tramite RDP dopo il failover, assicurarsi che si hello azioni riepilogate nella tabella hello.</span><span class="sxs-lookup"><span data-stu-id="d23bb-198">If you want tooconnect tooAzure VMs using RDP after failover, make sure you do hello actions summarized in hello table.</span></span>

<span data-ttu-id="d23bb-199">**Failover**</span><span class="sxs-lookup"><span data-stu-id="d23bb-199">**Failover**</span></span> | <span data-ttu-id="d23bb-200">**Posizione**</span><span class="sxs-lookup"><span data-stu-id="d23bb-200">**Location**</span></span> | <span data-ttu-id="d23bb-201">**Actions**</span><span class="sxs-lookup"><span data-stu-id="d23bb-201">**Actions**</span></span>
--- | --- | ---
<span data-ttu-id="d23bb-202">**VM di Azure che esegue Windows**</span><span class="sxs-lookup"><span data-stu-id="d23bb-202">**Azure VM running Windows**</span></span> | <span data-ttu-id="d23bb-203">Nel computer locale prima del failover</span><span class="sxs-lookup"><span data-stu-id="d23bb-203">On on-premises machine before failover</span></span> | <span data-ttu-id="d23bb-204">tooaccess hello macchina virtuale di Azure tramite internet hello, abilitare RDP, assicurarsi che TCP e UDP regole vengono aggiunte per hello **pubblica**, e che il protocollo RDP è consentito in **Windows Firewall** > **consentiti App**, per tutti i profili.</span><span class="sxs-lookup"><span data-stu-id="d23bb-204">tooaccess hello Azure VM over hello internet, enable RDP, make sure TCP, and UDP rules are added for hello **Public**, and that RDP is allowed in **Windows Firewall** > **Allowed Apps**, for all profiles.</span></span><br/><br/> <span data-ttu-id="d23bb-205">tooaccess tramite una connessione site-to-site, abilitare RDP nel computer di hello e assicurarsi che il protocollo RDP è consentito in hello **Windows Firewall** -> **consentito App e funzionalità** per  **Dominio e Private** reti.</span><span class="sxs-lookup"><span data-stu-id="d23bb-205">tooaccess over a site-to-site connection, enable RDP on hello machine, and ensure that RDP is allowed in hello **Windows Firewall** -> **Allowed apps and features** for **Domain and Private** networks.</span></span><br/><br/>  <span data-ttu-id="d23bb-206">Assicurarsi che i criteri di rete SAN del sistema operativo hello sono impostato troppo**OnlineAll**.</span><span class="sxs-lookup"><span data-stu-id="d23bb-206">Make sure hello operating system's SAN policy is set too**OnlineAll**.</span></span> <span data-ttu-id="d23bb-207">[Altre informazioni](https://support.microsoft.com/kb/3031135)</span><span class="sxs-lookup"><span data-stu-id="d23bb-207">[Learn more](https://support.microsoft.com/kb/3031135).</span></span><br/><br/> <span data-ttu-id="d23bb-208">Assicurarsi che non sono disponibili aggiornamenti di Windows in sospeso nella macchina virtuale hello quando si avvia un failover.</span><span class="sxs-lookup"><span data-stu-id="d23bb-208">Make sure there are no Windows updates pending on hello virtual machine when you trigger a failover.</span></span> <span data-ttu-id="d23bb-209">Aggiornamento di Windows potrebbe iniziare quando failover e non sarà macchina virtuale di toologin in grado di toohello fino al completamento dell'aggiornamento hello.</span><span class="sxs-lookup"><span data-stu-id="d23bb-209">Windows update might start when you failover and you will not be able toologin toohello virtual machine until hello update completes.</span></span> <br/><br/>
<span data-ttu-id="d23bb-210">**VM di Azure che esegue Windows**</span><span class="sxs-lookup"><span data-stu-id="d23bb-210">**Azure VM running Windows**</span></span> | <span data-ttu-id="d23bb-211">Nella VM di Azure dopo il failover</span><span class="sxs-lookup"><span data-stu-id="d23bb-211">On Azure VM after failover</span></span> | <span data-ttu-id="d23bb-212">Per una macchina virtuale classica, [aggiungere un endpoint pubblico](../virtual-machines/windows/classic/setup-endpoints.md) per hello protocollo RDP (porta 3389)</span><span class="sxs-lookup"><span data-stu-id="d23bb-212">For a classic virtual machine, [add a public endpoint](../virtual-machines/windows/classic/setup-endpoints.md) for hello RDP protocol (port 3389)</span></span><br/><br/>  <span data-ttu-id="d23bb-213">Per una macchina virtuale di Resource Manager, [aggiungere un indirizzo IP pubblico](site-recovery-monitoring-and-troubleshooting.md#adding-a-public-ip-on-a-resource-manager-virtual-machine) nella macchina virtuale.</span><span class="sxs-lookup"><span data-stu-id="d23bb-213">For a Resource Manager virtual machine, [add a public IP](site-recovery-monitoring-and-troubleshooting.md#adding-a-public-ip-on-a-resource-manager-virtual-machine) on it.</span></span><br/><br/> <span data-ttu-id="d23bb-214">Hello regole gruppo di sicurezza di rete sul failover VM hello e hello toowhich subnet di Azure è connesso, è necessario porta RDP toohello tooallow in ingresso connessioni.</span><span class="sxs-lookup"><span data-stu-id="d23bb-214">hello network security group rules on hello failed over VM, and hello Azure subnet toowhich it is connected, need tooallow incoming connections toohello RDP port.</span></span><br/><br/> <span data-ttu-id="d23bb-215">Per una macchina virtuale di gestione delle risorse, è possibile verificare **diagnostica di avvio** toolook in una schermata di macchina virtuale hello</span><span class="sxs-lookup"><span data-stu-id="d23bb-215">For a Resource Manager virtual machine, you can check **Boot diagnostics** toolook at a screenshot of hello virtual machine</span></span><br/><br/> <span data-ttu-id="d23bb-216">Se non è possibile connettersi, verificare che hello macchina virtuale è in esecuzione e quindi esaminare questi [suggerimenti sulla risoluzione dei](http://social.technet.microsoft.com/wiki/contents/articles/31666.troubleshooting-remote-desktop-connection-after-failover-using-asr.aspx).</span><span class="sxs-lookup"><span data-stu-id="d23bb-216">If you can't connect, check that hello VM is running and then look at these [troubleshooting tips](http://social.technet.microsoft.com/wiki/contents/articles/31666.troubleshooting-remote-desktop-connection-after-failover-using-asr.aspx).</span></span><br/><br/>
<span data-ttu-id="d23bb-217">**VM di Azure che esegue Linux**</span><span class="sxs-lookup"><span data-stu-id="d23bb-217">**Azure VM running Linux**</span></span> | <span data-ttu-id="d23bb-218">Nel computer locale prima del failover</span><span class="sxs-lookup"><span data-stu-id="d23bb-218">On on-premises machine before failover</span></span> | <span data-ttu-id="d23bb-219">Verificare che il servizio di Secure Shell su hello Azure VM hello sia impostato toostart automaticamente all'avvio del sistema.</span><span class="sxs-lookup"><span data-stu-id="d23bb-219">Ensure that hello Secure Shell service on hello Azure VM is set toostart automatically on system boot.</span></span><br/><br/> <span data-ttu-id="d23bb-220">Controllare che le regole del firewall consentano un tooit connessione SSH.</span><span class="sxs-lookup"><span data-stu-id="d23bb-220">Check that firewall rules allow an SSH connection tooit.</span></span>
<span data-ttu-id="d23bb-221">**VM di Azure che esegue Linux**</span><span class="sxs-lookup"><span data-stu-id="d23bb-221">**Azure VM running Linux**</span></span> | <span data-ttu-id="d23bb-222">VM di Azure dopo il failover</span><span class="sxs-lookup"><span data-stu-id="d23bb-222">Azure VM after failover</span></span> | <span data-ttu-id="d23bb-223">Hello regole gruppo di sicurezza di rete sul failover VM hello e hello toowhich subnet di Azure è connesso, è necessario porta SSH toohello tooallow in ingresso connessioni.</span><span class="sxs-lookup"><span data-stu-id="d23bb-223">hello network security group rules on hello failed over VM, and hello Azure subnet toowhich it is connected, need tooallow incoming connections toohello SSH port.</span></span><br/><br/> <span data-ttu-id="d23bb-224">Per una macchina virtuale classica, [aggiungere un endpoint pubblico](../virtual-machines/windows/classic/setup-endpoints.md) deve essere creato, le connessioni in ingresso tooallow su hello SSH (porta TCP 22 per impostazione predefinita).</span><span class="sxs-lookup"><span data-stu-id="d23bb-224">For  a classic virtual machine, [add a public endpoint](../virtual-machines/windows/classic/setup-endpoints.md) should be created, tooallow incoming connections on hello SSH port (TCP port 22 by default).</span></span><br/><br/> <span data-ttu-id="d23bb-225">Per una macchina virtuale di Resource Manager, [aggiungere un indirizzo IP pubblico](site-recovery-monitoring-and-troubleshooting.md#adding-a-public-ip-on-a-resource-manager-virtual-machine) nella macchina virtuale.</span><span class="sxs-lookup"><span data-stu-id="d23bb-225">For a Resource Manager virtual machine, [add a public IP](site-recovery-monitoring-and-troubleshooting.md#adding-a-public-ip-on-a-resource-manager-virtual-machine) on it.</span></span><br/><br/> <span data-ttu-id="d23bb-226">Per una macchina virtuale di gestione delle risorse, è possibile verificare **diagnostica di avvio** toolook in una schermata di macchina virtuale hello</span><span class="sxs-lookup"><span data-stu-id="d23bb-226">For a Resource Manager virtual machine, you can check **Boot diagnostics** toolook at a screenshot of hello virtual machine</span></span><br/><br/>



## <a name="next-steps"></a><span data-ttu-id="d23bb-227">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="d23bb-227">Next steps</span></span>
<span data-ttu-id="d23bb-228">Dopo l'esito positivo di un failover di test, si può provare a eseguire un [failover](site-recovery-failover.md).</span><span class="sxs-lookup"><span data-stu-id="d23bb-228">Once you have successfully tried a test failover you can try doing a [failover](site-recovery-failover.md).</span></span>
