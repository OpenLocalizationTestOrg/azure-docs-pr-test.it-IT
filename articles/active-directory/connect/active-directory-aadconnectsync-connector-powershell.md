---
title: Connettore PowerShell | Documentazione Microsoft
description: Questo articolo descrive come configurare il connettore Windows PowerShell di Microsoft.
services: active-directory
documentationcenter: 
author: AndKjell
manager: femila
editor: 
ms.assetid: 6dba8e34-a874-4ff0-90bc-bd2b0a4199b5
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/12/2017
ms.author: billmath
ms.openlocfilehash: 0e5ccf5a38072e31d85bbc63eb0c608b0c34cfc2
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/03/2017
---
# <a name="windows-powershell-connector-technical-reference"></a><span data-ttu-id="12567-103">Documentazione tecnica sul connettore Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="12567-103">Windows PowerShell Connector technical reference</span></span>
<span data-ttu-id="12567-104">Questo articolo descrive il connettore Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="12567-104">This article describes the Windows PowerShell Connector.</span></span> <span data-ttu-id="12567-105">ed è applicabile ai prodotti seguenti:</span><span class="sxs-lookup"><span data-stu-id="12567-105">The article applies to the following products:</span></span>

* <span data-ttu-id="12567-106">Microsoft Identity Manager 2016 (MIM2016)</span><span class="sxs-lookup"><span data-stu-id="12567-106">Microsoft Identity Manager 2016 (MIM2016)</span></span>
* <span data-ttu-id="12567-107">Forefront Identity Manager 2010 R2 (FIM2010R2)</span><span class="sxs-lookup"><span data-stu-id="12567-107">Forefront Identity Manager 2010 R2 (FIM2010R2)</span></span>
  * <span data-ttu-id="12567-108">È necessario usare l'hotfix 4.1.3671.0 o versione successiva ( [KB3092178](https://support.microsoft.com/kb/3092178)).</span><span class="sxs-lookup"><span data-stu-id="12567-108">Must use hotfix 4.1.3671.0 or later [KB3092178](https://support.microsoft.com/kb/3092178).</span></span>

<span data-ttu-id="12567-109">Per MIM2016 e FIM2010R2, il connettore è disponibile come download dall' [Area download Microsoft](http://go.microsoft.com/fwlink/?LinkId=717495).</span><span class="sxs-lookup"><span data-stu-id="12567-109">For MIM2016 and FIM2010R2, the Connector is available as a download from the [Microsoft Download Center](http://go.microsoft.com/fwlink/?LinkId=717495).</span></span>

## <a name="overview-of-the-powershell-connector"></a><span data-ttu-id="12567-110">Panoramica del connettore PowerShell</span><span class="sxs-lookup"><span data-stu-id="12567-110">Overview of the PowerShell Connector</span></span>
<span data-ttu-id="12567-111">Il connettore PowerShell consente di integrare il servizio di sincronizzazione con sistemi esterni che offrono API basate su Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="12567-111">The PowerShell Connector enables you to integrate the synchronization service with external systems that offer Windows PowerShell based APIs.</span></span> <span data-ttu-id="12567-112">Il connettore fornisce un collegamento tra le funzionalità del framework ECMA2 (Extensible Connectivity 2 Management Agent) e Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="12567-112">The connector provides a bridge between the capabilities of the call-based extensible connectivity management agent 2 (ECMA2) framework and Windows PowerShell.</span></span> <span data-ttu-id="12567-113">Per altre informazioni sul framework ECMA, vedere le [informazioni di riferimento su Extensible Connectivity 2.2 Management Agent](https://msdn.microsoft.com/library/windows/desktop/hh859557.aspx).</span><span class="sxs-lookup"><span data-stu-id="12567-113">For more information about the ECMA framework, see the [Extensible Connectivity 2.2 Management Agent Reference](https://msdn.microsoft.com/library/windows/desktop/hh859557.aspx).</span></span>

### <a name="prerequisites"></a><span data-ttu-id="12567-114">Prerequisiti</span><span class="sxs-lookup"><span data-stu-id="12567-114">Prerequisites</span></span>
<span data-ttu-id="12567-115">Prima di usare il connettore, verificare che nel server di sincronizzazione sia disponibile quanto segue:</span><span class="sxs-lookup"><span data-stu-id="12567-115">Before you use the Connector, make sure you have the following on the synchronization server:</span></span>

* <span data-ttu-id="12567-116">Microsoft .NET 4.5.2 Framework o versione successiva</span><span class="sxs-lookup"><span data-stu-id="12567-116">Microsoft .NET 4.5.2 Framework or later</span></span>
* <span data-ttu-id="12567-117">Windows PowerShell 2.0, 3.0 o 4.0</span><span class="sxs-lookup"><span data-stu-id="12567-117">Windows PowerShell 2.0, 3.0, or 4.0</span></span>

<span data-ttu-id="12567-118">I criteri di esecuzione nel server del servizio di sincronizzazione devono essere configurati per consentire al connettore di eseguire script di Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="12567-118">The execution policy on the Synchronization Service server must be configured to allow the connector to run Windows PowerShell scripts.</span></span> <span data-ttu-id="12567-119">Se gli script eseguiti dal connettore non hanno una firma digitale, eseguire questo comando per configurare i criteri di esecuzione: </span><span class="sxs-lookup"><span data-stu-id="12567-119">Unless the scripts the connector runs are digitally signed, configure the execution policy by running this command:</span></span>  
`Set-ExecutionPolicy -ExecutionPolicy RemoteSigned`

## <a name="create-a-new-connector"></a><span data-ttu-id="12567-120">Creare un nuovo connettore</span><span class="sxs-lookup"><span data-stu-id="12567-120">Create a new Connector</span></span>
<span data-ttu-id="12567-121">Per creare un connettore Windows PowerShell nel servizio di sincronizzazione è necessario fornire una serie di script Windows PowerShell che eseguono i passaggi richiesti dal servizio di sincronizzazione.</span><span class="sxs-lookup"><span data-stu-id="12567-121">To create a Windows PowerShell connector in the synchronization service, you must provide a series of Windows PowerShell scripts that execute the steps requested by the synchronization service.</span></span> <span data-ttu-id="12567-122">Gli script da implementare variano a seconda dell'origine dati a cui ci si connette e alla funzionalità richiesta.</span><span class="sxs-lookup"><span data-stu-id="12567-122">Depending on the data source you connect to and the functionality you require, the scripts you must implement varies.</span></span> <span data-ttu-id="12567-123">Questa sezione illustra ogni script che è possibile implementare e quando sono necessari.</span><span class="sxs-lookup"><span data-stu-id="12567-123">This section outlines each of the scripts that can be implemented and when they are required.</span></span>

<span data-ttu-id="12567-124">Il connettore Windows PowerShell è progettato per archiviare ogni script all'interno del database del servizio di sincronizzazione.</span><span class="sxs-lookup"><span data-stu-id="12567-124">The Windows PowerShell connector is designed to store each of the scripts inside the Synchronization Service database.</span></span> <span data-ttu-id="12567-125">Anche se è possibile eseguire gli script archiviati nel file system, è più semplice inserire il corpo di ogni script direttamente nella configurazione del connettore.</span><span class="sxs-lookup"><span data-stu-id="12567-125">While it is possible to run scripts that are stored on the file system, it is easier to insert the body of each script directly in to the connector’s configuration.</span></span>

<span data-ttu-id="12567-126">Per creare un connettore PowerShell, in **Synchronization Service** selezionare **Management Agent** e quindi **Create**.</span><span class="sxs-lookup"><span data-stu-id="12567-126">To Create a PowerShell connector, in **Synchronization Service** select **Management Agent** and **Create**.</span></span> <span data-ttu-id="12567-127">Selezionare il connettore **PowerShell (Microsoft)** .</span><span class="sxs-lookup"><span data-stu-id="12567-127">Select the **PowerShell (Microsoft)** Connector.</span></span>

![Create Connector](./media/active-directory-aadconnectsync-connector-powershell/createconnector.png)

### <a name="connectivity"></a><span data-ttu-id="12567-129">Connettività</span><span class="sxs-lookup"><span data-stu-id="12567-129">Connectivity</span></span>
<span data-ttu-id="12567-130">Specificare i parametri di configurazione per la connessione a un sistema remoto.</span><span class="sxs-lookup"><span data-stu-id="12567-130">Supply configuration parameters for connecting to a remote system.</span></span> <span data-ttu-id="12567-131">Questi valori verranno archiviati in modo sicuro dal servizio di sincronizzazione e resi disponibili per gli script Windows PowerShell quando viene eseguito il connettore.</span><span class="sxs-lookup"><span data-stu-id="12567-131">These values are securely stored by the Synchronization Service and made available to your Windows PowerShell scripts when the connector is run.</span></span>

![Connettività](./media/active-directory-aadconnectsync-connector-powershell/connectivity.png)

<span data-ttu-id="12567-133">È possibile configurare i parametri di connettività seguenti:</span><span class="sxs-lookup"><span data-stu-id="12567-133">You can configure the following Connectivity parameters:</span></span>

<span data-ttu-id="12567-134">**Connettività**</span><span class="sxs-lookup"><span data-stu-id="12567-134">**Connectivity**</span></span>

| <span data-ttu-id="12567-135">Parametro</span><span class="sxs-lookup"><span data-stu-id="12567-135">Parameter</span></span> | <span data-ttu-id="12567-136">Valore predefinito</span><span class="sxs-lookup"><span data-stu-id="12567-136">Default Value</span></span> | <span data-ttu-id="12567-137">Scopo</span><span class="sxs-lookup"><span data-stu-id="12567-137">Purpose</span></span> |
| --- | --- | --- |
| <span data-ttu-id="12567-138">Server</span><span class="sxs-lookup"><span data-stu-id="12567-138">Server</span></span> |<Blank> |<span data-ttu-id="12567-139">Nome del server a cui deve connettersi il connettore.</span><span class="sxs-lookup"><span data-stu-id="12567-139">Server name that the connector should connect to.</span></span> |
| <span data-ttu-id="12567-140">Domain</span><span class="sxs-lookup"><span data-stu-id="12567-140">Domain</span></span> |<Blank> |<span data-ttu-id="12567-141">Dominio delle credenziali da archiviare e usare quando viene eseguito il connettore.</span><span class="sxs-lookup"><span data-stu-id="12567-141">Domain of the credential to store for use when the connector is run.</span></span> |
| <span data-ttu-id="12567-142">Utente</span><span class="sxs-lookup"><span data-stu-id="12567-142">User</span></span> |<Blank> |<span data-ttu-id="12567-143">Nome utente delle credenziali da archiviare e usare quando viene eseguito il connettore.</span><span class="sxs-lookup"><span data-stu-id="12567-143">Username of the credential to store for use when the connector is run.</span></span> |
| <span data-ttu-id="12567-144">Password</span><span class="sxs-lookup"><span data-stu-id="12567-144">Password</span></span> |<Blank> |<span data-ttu-id="12567-145">Password delle credenziali da archiviare e usare quando viene eseguito il connettore.</span><span class="sxs-lookup"><span data-stu-id="12567-145">Password of the credential to store for use when the connector is run.</span></span> |
| <span data-ttu-id="12567-146">Impersonate Connector Account</span><span class="sxs-lookup"><span data-stu-id="12567-146">Impersonate Connector Account</span></span> |<span data-ttu-id="12567-147">False</span><span class="sxs-lookup"><span data-stu-id="12567-147">False</span></span> |<span data-ttu-id="12567-148">Se impostato su True, il servizio di sincronizzazione esegue gli script di Windows PowerShell nel contesto delle credenziali specificate.</span><span class="sxs-lookup"><span data-stu-id="12567-148">When true, the synchronization service runs the Windows PowerShell scripts in the context of the credentials supplied.</span></span> <span data-ttu-id="12567-149">Se possibile, è consigliabile usare il parametro **$Credentials** passato a ogni script anziché la rappresentazione.</span><span class="sxs-lookup"><span data-stu-id="12567-149">When possible, it is recommended that the **$Credentials** parameter is passed to each script is used instead of impersonation.</span></span> <span data-ttu-id="12567-150">Per altre informazioni sulle autorizzazioni aggiuntive necessarie per usare questa opzione, vedere la sezione [Configurazione aggiuntiva per la rappresentazione](#additional-configuration-for-impersonation).</span><span class="sxs-lookup"><span data-stu-id="12567-150">For more information on additional permissions that are required to use this option, see [Additional Configuration for Impersonation](#additional-configuration-for-impersonation).</span></span> |
| <span data-ttu-id="12567-151">Load User Profile When Impersonating</span><span class="sxs-lookup"><span data-stu-id="12567-151">Load User Profile When Impersonating</span></span> |<span data-ttu-id="12567-152">False</span><span class="sxs-lookup"><span data-stu-id="12567-152">False</span></span> |<span data-ttu-id="12567-153">Indica a Windows di caricare il profilo utente delle credenziali del connettore durante la rappresentazione.</span><span class="sxs-lookup"><span data-stu-id="12567-153">Instructs Windows to load the user profile of the connector’s credentials during impersonation.</span></span> <span data-ttu-id="12567-154">Se l'utente rappresentato ha un profilo mobile, il connettore non carica il profilo mobile.</span><span class="sxs-lookup"><span data-stu-id="12567-154">If the impersonated user has a roaming profile, the connector does not load the roaming profile.</span></span> <span data-ttu-id="12567-155">Per altre informazioni sulle autorizzazioni aggiuntive necessarie per usare questo parametro, vedere la sezione [Configurazione aggiuntiva per la rappresentazione](#additional-configuration-for-impersonation).</span><span class="sxs-lookup"><span data-stu-id="12567-155">For more information on additional permissions that are required to use this parameter, see [Additional Configuration for Impersonation](#additional-configuration-for-impersonation).</span></span> |
| <span data-ttu-id="12567-156">Logon Type When Impersonating</span><span class="sxs-lookup"><span data-stu-id="12567-156">Logon Type When Impersonating</span></span> |<span data-ttu-id="12567-157">None</span><span class="sxs-lookup"><span data-stu-id="12567-157">None</span></span> |<span data-ttu-id="12567-158">Tipo di accesso durante la rappresentazione.</span><span class="sxs-lookup"><span data-stu-id="12567-158">Logon type during impersonation.</span></span> <span data-ttu-id="12567-159">Per altre informazioni, vedere la documentazione di [dwLogonType][dw].</span><span class="sxs-lookup"><span data-stu-id="12567-159">For more information, see the [dwLogonType][dw] documentation.</span></span> |
| <span data-ttu-id="12567-160">Signed Scripts Only</span><span class="sxs-lookup"><span data-stu-id="12567-160">Signed Scripts Only</span></span> |<span data-ttu-id="12567-161">False</span><span class="sxs-lookup"><span data-stu-id="12567-161">False</span></span> |<span data-ttu-id="12567-162">Se impostato su True, il connettore Windows PowerShell verifica che ogni script presenti una firma digitale valida.</span><span class="sxs-lookup"><span data-stu-id="12567-162">If true, the Windows PowerShell connector validates that each script has a valid digital signature.</span></span> <span data-ttu-id="12567-163">Se impostato su False, assicurarsi che i criteri di esecuzione di Windows PowerShell per il server del servizio di sincronizzazione siano impostati su RemoteSigned o su Unrestricted.</span><span class="sxs-lookup"><span data-stu-id="12567-163">If false, ensure that the Synchronization Service server’s Windows PowerShell execution policy is RemoteSigned or Unrestricted.</span></span> |

<span data-ttu-id="12567-164">**Modulo comune**</span><span class="sxs-lookup"><span data-stu-id="12567-164">**Common Module**</span></span>  
<span data-ttu-id="12567-165">Il connettore consente di archiviare un modulo di Windows PowerShell condiviso nella configurazione.</span><span class="sxs-lookup"><span data-stu-id="12567-165">The connector allows you to store a shared Windows PowerShell module in the configuration.</span></span> <span data-ttu-id="12567-166">Quando il connettore esegue uno script, il modulo di Windows PowerShell viene estratto nel file system perché possa essere importato da ogni script.</span><span class="sxs-lookup"><span data-stu-id="12567-166">When the connector runs a script, the Windows PowerShell module is extracted to the file system so that it can be imported by each script.</span></span>

<span data-ttu-id="12567-167">Per gli script di importazione, esportazione e sincronizzazione password il modulo comune viene estratto nella cartella MAData del connettore.</span><span class="sxs-lookup"><span data-stu-id="12567-167">For Import, Export, and Password Synchronization scripts, the common module is extracted to the connector’s MAData folder.</span></span> <span data-ttu-id="12567-168">Per gli script di schema, convalida, gerarchia e individuazione della partizione, il modulo comune viene estratto nella cartella %TEMP%.</span><span class="sxs-lookup"><span data-stu-id="12567-168">For Schema, Validation, Hierarchy, and Partition discovery scripts, the common module is extracted to the %TEMP% folder.</span></span> <span data-ttu-id="12567-169">In entrambi i casi, lo script del modulo comune estratto viene denominato in base all'impostazione del nome script del modulo comune.</span><span class="sxs-lookup"><span data-stu-id="12567-169">In both cases, the extracted Common Module script is named according to the Common Module Script Name setting.</span></span>

<span data-ttu-id="12567-170">Per caricare un modulo denominato FIMPowerShellConnectorModule.psm1 dalla cartella MAData, usare l'istruzione seguente: `Import-Module (Join-Path -Path [Microsoft.MetadirectoryServices.MAUtils]::MAFolder -ChildPath "FIMPowerShellConnectorModule.psm1")`</span><span class="sxs-lookup"><span data-stu-id="12567-170">To load a module called FIMPowerShellConnectorModule.psm1 from the MAData folder, use the following statement: `Import-Module (Join-Path -Path [Microsoft.MetadirectoryServices.MAUtils]::MAFolder -ChildPath "FIMPowerShellConnectorModule.psm1")`</span></span>

<span data-ttu-id="12567-171">Per caricare un modulo denominato FIMPowerShellConnectorModule.psm1 dalla cartella %TEMP%, usare l'istruzione seguente: `Import-Module (Join-Path -Path $env:TEMP -ChildPath "FIMPowerShellConnectorModule.psm1")`</span><span class="sxs-lookup"><span data-stu-id="12567-171">To load a module called FIMPowerShellConnectorModule.psm1 from the %TEMP% folder, use the following statement: `Import-Module (Join-Path -Path $env:TEMP -ChildPath "FIMPowerShellConnectorModule.psm1")`</span></span>

<span data-ttu-id="12567-172">**Convalida dei parametri**</span><span class="sxs-lookup"><span data-stu-id="12567-172">**Parameter Validation**</span></span>  
<span data-ttu-id="12567-173">Lo script di convalida è uno script Windows PowerShell facoltativo che può essere usato per verificare la validità dei parametri di configurazione del connettore specificati dall'amministratore.</span><span class="sxs-lookup"><span data-stu-id="12567-173">The Validation Script is an optional Windows PowerShell script that can be used to ensure that connector configuration parameters supplied by the administrator are valid.</span></span> <span data-ttu-id="12567-174">Questo script viene normalmente usato per convalidare le credenziali di connessione e del server, nonché i parametri di connessione.</span><span class="sxs-lookup"><span data-stu-id="12567-174">Validating server, connection credentials, and connectivity parameters are common usages of the validation script.</span></span> <span data-ttu-id="12567-175">Lo script di convalida viene chiamato dopo la modifica delle schede e finestre di dialogo seguenti:</span><span class="sxs-lookup"><span data-stu-id="12567-175">The validation script is called after the following tabs and dialogs are modified:</span></span>

* <span data-ttu-id="12567-176">Connettività</span><span class="sxs-lookup"><span data-stu-id="12567-176">Connectivity</span></span>
* <span data-ttu-id="12567-177">Global Parameters</span><span class="sxs-lookup"><span data-stu-id="12567-177">Global Parameters</span></span>
* <span data-ttu-id="12567-178">Partition Configuration</span><span class="sxs-lookup"><span data-stu-id="12567-178">Partition Configuration</span></span>

<span data-ttu-id="12567-179">Dal connettore, lo script di convalida riceve i parametri seguenti:</span><span class="sxs-lookup"><span data-stu-id="12567-179">The validation script receives the following parameters from the connector:</span></span>

| <span data-ttu-id="12567-180">Name</span><span class="sxs-lookup"><span data-stu-id="12567-180">Name</span></span> | <span data-ttu-id="12567-181">Tipo di dati</span><span class="sxs-lookup"><span data-stu-id="12567-181">Data Type</span></span> | <span data-ttu-id="12567-182">Descrizione</span><span class="sxs-lookup"><span data-stu-id="12567-182">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="12567-183">ConfigParameterPage</span><span class="sxs-lookup"><span data-stu-id="12567-183">ConfigParameterPage</span></span> |<span data-ttu-id="12567-184">[ConfigParameterPage][cpp]</span><span class="sxs-lookup"><span data-stu-id="12567-184">[ConfigParameterPage][cpp]</span></span> |<span data-ttu-id="12567-185">La scheda o la finestra di dialogo di configurazione che ha attivato la richiesta di convalida.</span><span class="sxs-lookup"><span data-stu-id="12567-185">The configuration tab or dialog that triggered the validation request.</span></span> |
| <span data-ttu-id="12567-186">ConfigParameters</span><span class="sxs-lookup"><span data-stu-id="12567-186">ConfigParameters</span></span> |<span data-ttu-id="12567-187">[KeyedCollection][keyk] [stringa, [ConfigParameter][cp]]</span><span class="sxs-lookup"><span data-stu-id="12567-187">[KeyedCollection][keyk] [string, [ConfigParameter][cp]]</span></span> |<span data-ttu-id="12567-188">Tabella dei parametri di configurazione per il connettore.</span><span class="sxs-lookup"><span data-stu-id="12567-188">Table of configuration parameters for the Connector.</span></span> |
| <span data-ttu-id="12567-189">Credenziali</span><span class="sxs-lookup"><span data-stu-id="12567-189">Credential</span></span> |<span data-ttu-id="12567-190">[PSCredential][pscred]</span><span class="sxs-lookup"><span data-stu-id="12567-190">[PSCredential][pscred]</span></span> |<span data-ttu-id="12567-191">Contiene le credenziali immesse dall'amministratore nella scheda Connectivity.</span><span class="sxs-lookup"><span data-stu-id="12567-191">Contains any credentials entered by the administrator on the Connectivity tab.</span></span> |

<span data-ttu-id="12567-192">Lo script di convalida deve restituire un singolo oggetto ParameterValidationResult alla pipeline.</span><span class="sxs-lookup"><span data-stu-id="12567-192">The validation script should return a single ParameterValidationResult object to the pipeline.</span></span>

<span data-ttu-id="12567-193">**Individuazione dello schema**</span><span class="sxs-lookup"><span data-stu-id="12567-193">**Schema Discovery**</span></span>  
<span data-ttu-id="12567-194">Lo script di individuazione dello schema è obbligatorio.</span><span class="sxs-lookup"><span data-stu-id="12567-194">The Schema Discovery script is mandatory.</span></span> <span data-ttu-id="12567-195">Questo script restituisce i tipi di oggetto, gli attributi e i vincoli di attributo usati dal servizio di sincronizzazione durante la configurazione delle regole del flusso di attributi.</span><span class="sxs-lookup"><span data-stu-id="12567-195">This script returns the object types, attributes, and attribute constraints that the Synchronization Service uses when configuring attribute flow rules.</span></span> <span data-ttu-id="12567-196">Lo script di individuazione dello schema viene eseguito durante la creazione del connettore e popola lo schema del connettore.</span><span class="sxs-lookup"><span data-stu-id="12567-196">The Schema Discovery script is run during connector creation and populates the connector’s schema.</span></span> <span data-ttu-id="12567-197">Viene anche usato dall'azione di aggiornamento dello schema in Synchronization Service Manager.</span><span class="sxs-lookup"><span data-stu-id="12567-197">It is also used by the Refresh Schema action in the Synchronization Service Manager.</span></span>

<span data-ttu-id="12567-198">Dal connettore, lo script di individuazione dello schema riceve i parametri seguenti:</span><span class="sxs-lookup"><span data-stu-id="12567-198">The schema discovery script receives the following parameters from the connector:</span></span>

| <span data-ttu-id="12567-199">Name</span><span class="sxs-lookup"><span data-stu-id="12567-199">Name</span></span> | <span data-ttu-id="12567-200">Tipo di dati</span><span class="sxs-lookup"><span data-stu-id="12567-200">Data Type</span></span> | <span data-ttu-id="12567-201">Descrizione</span><span class="sxs-lookup"><span data-stu-id="12567-201">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="12567-202">ConfigParameters</span><span class="sxs-lookup"><span data-stu-id="12567-202">ConfigParameters</span></span> |<span data-ttu-id="12567-203">[KeyedCollection][keyk] [stringa, [ConfigParameter][cp]]</span><span class="sxs-lookup"><span data-stu-id="12567-203">[KeyedCollection][keyk] [string, [ConfigParameter][cp]]</span></span> |<span data-ttu-id="12567-204">Tabella dei parametri di configurazione per il connettore.</span><span class="sxs-lookup"><span data-stu-id="12567-204">Table of configuration parameters for the Connector.</span></span> |
| <span data-ttu-id="12567-205">Credenziali</span><span class="sxs-lookup"><span data-stu-id="12567-205">Credential</span></span> |<span data-ttu-id="12567-206">[PSCredential][pscred]</span><span class="sxs-lookup"><span data-stu-id="12567-206">[PSCredential][pscred]</span></span> |<span data-ttu-id="12567-207">Contiene le credenziali immesse dall'amministratore nella scheda Connectivity.</span><span class="sxs-lookup"><span data-stu-id="12567-207">Contains any credentials entered by the administrator on the Connectivity tab.</span></span> |

<span data-ttu-id="12567-208">Lo script deve restituire un singolo oggetto [Schema][schema] alla pipeline.</span><span class="sxs-lookup"><span data-stu-id="12567-208">The script must return a single [Schema][schema] object to the pipeline.</span></span> <span data-ttu-id="12567-209">L'oggetto Schema è costituito da oggetti [SchemaType][schemaT] che rappresentano i tipi di oggetto, ad esempio utenti e gruppi.</span><span class="sxs-lookup"><span data-stu-id="12567-209">The Schema object is composed of [SchemaType][schemaT] objects that represent object types (for example: users and groups).</span></span> <span data-ttu-id="12567-210">L'oggetto SchemaType contiene una raccolta di oggetti [SchemaAttribute][schemaA] che rappresentano gli attributi, ad esempio nome, cognome e indirizzo postale del tipo.</span><span class="sxs-lookup"><span data-stu-id="12567-210">The SchemaType object holds a collection of [SchemaAttribute][schemaA] objects that represent the attributes (for example: given name, surname, and postal address) of the type.</span></span>

<span data-ttu-id="12567-211">**Altri parametri**</span><span class="sxs-lookup"><span data-stu-id="12567-211">**Additional Parameters**</span></span>  
<span data-ttu-id="12567-212">Oltre alle impostazioni di configurazione standard è possibile definire impostazioni di configurazione personalizzate aggiuntive specifiche dell'istanza del connettore.</span><span class="sxs-lookup"><span data-stu-id="12567-212">In addition to the standard configuration settings, you can define additional custom configuration settings that are specific to the instance of the Connector.</span></span> <span data-ttu-id="12567-213">Questi parametri possono essere specificati a livello di connettore, di partizione o di passaggio di esecuzione e sono accessibili dal relativo script di Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="12567-213">These parameters can be specified at the connector, partition, or run step levels and accessed from the relevant Windows PowerShell script.</span></span> <span data-ttu-id="12567-214">Le impostazioni di configurazione personalizzate possono essere archiviate nel database del servizio di sincronizzazione in formato testo normale o crittografate.</span><span class="sxs-lookup"><span data-stu-id="12567-214">Custom configuration settings can be stored in the Synchronization Service database in plain text format or they may be encrypted.</span></span> <span data-ttu-id="12567-215">Il servizio di sincronizzazione crittografa e decrittografa automaticamente le impostazioni di configurazione protette quando è necessario.</span><span class="sxs-lookup"><span data-stu-id="12567-215">The Synchronization Service automatically encrypts and decrypts secure configuration settings when required.</span></span>

<span data-ttu-id="12567-216">Per specificare impostazioni di configurazione personalizzate, separare il nome di ogni parametro con una virgola (,).</span><span class="sxs-lookup"><span data-stu-id="12567-216">To specify custom configuration settings, separate the name of each parameter with a comma ( , ).</span></span>

<span data-ttu-id="12567-217">Per accedere alle impostazioni di configurazione personalizzate da uno script, è necessario aggiungere come suffisso al nome un carattere di sottolineatura ( \_ ) e l'ambito del parametro (Global, Partition o RunStep).</span><span class="sxs-lookup"><span data-stu-id="12567-217">To access custom configuration settings from a script, you must suffix the name with an underscore ( \_ ) and the scope of the parameter (Global, Partition, or RunStep).</span></span> <span data-ttu-id="12567-218">Ad esempio, per accedere al parametro Global FileName, usare il frammento di codice: `$ConfigurationParameters["FileName_Global"].Value`</span><span class="sxs-lookup"><span data-stu-id="12567-218">For example, to access the Global FileName parameter, use this code snippet: `$ConfigurationParameters["FileName_Global"].Value`</span></span>

### <a name="capabilities"></a><span data-ttu-id="12567-219">Funzionalità</span><span class="sxs-lookup"><span data-stu-id="12567-219">Capabilities</span></span>
<span data-ttu-id="12567-220">La scheda Capabilities della finestra di progettazione dell'agente di gestione definisce il comportamento e le funzionalità del connettore.</span><span class="sxs-lookup"><span data-stu-id="12567-220">The capabilities tab of the Management Agent Designer defines the behavior and functionality of the connector.</span></span> <span data-ttu-id="12567-221">Dopo aver creato il connettore, non sarà più possibile modificare le selezioni effettuate in questa scheda.</span><span class="sxs-lookup"><span data-stu-id="12567-221">The selections made on this tab cannot be modified when the connector has been created.</span></span> <span data-ttu-id="12567-222">La tabella elenca le impostazioni delle funzionalità.</span><span class="sxs-lookup"><span data-stu-id="12567-222">This table lists the capability settings.</span></span>

![Funzionalità](./media/active-directory-aadconnectsync-connector-powershell/capabilities.png)

| <span data-ttu-id="12567-224">Funzionalità</span><span class="sxs-lookup"><span data-stu-id="12567-224">Capability</span></span> | <span data-ttu-id="12567-225">Descrizione</span><span class="sxs-lookup"><span data-stu-id="12567-225">Description</span></span> |
| --- | --- |
| <span data-ttu-id="12567-226">[Distinguished Name Style][dnstyle] (Stile di nome distinto)</span><span class="sxs-lookup"><span data-stu-id="12567-226">[Distinguished Name Style][dnstyle]</span></span> |<span data-ttu-id="12567-227">Indica se il connettore supporta i nomi distinti e il relativo stile.</span><span class="sxs-lookup"><span data-stu-id="12567-227">Indicates if the connector supports distinguished names and if so, what style.</span></span> |
| <span data-ttu-id="12567-228">[Export Type][exportT] (Tipo di esportazione)</span><span class="sxs-lookup"><span data-stu-id="12567-228">[Export Type][exportT]</span></span> |<span data-ttu-id="12567-229">Determina il tipo degli oggetti che vengono presentati allo script di esportazione.</span><span class="sxs-lookup"><span data-stu-id="12567-229">Determines the type of objects that are presented to the Export script.</span></span> <li><span data-ttu-id="12567-230">AttributeReplace: include il set completo di valori per un attributo multivalore quando l'attributo viene modificato.</span><span class="sxs-lookup"><span data-stu-id="12567-230">AttributeReplace – includes the full set of values for a multi-valued attribute when the attribute changes.</span></span></li><li><span data-ttu-id="12567-231">AttributeUpdate: include solo i valori differenziali per un attributo multivalore quando l'attributo viene modificato.</span><span class="sxs-lookup"><span data-stu-id="12567-231">AttributeUpdate – includes only the deltas to a multi-valued attribute when the attribute changes.</span></span></li><li><span data-ttu-id="12567-232">MultivaluedReferenceAttributeUpdate: include un set completo di valori per attributi multivalore non di riferimento e solo i valori differenziali per gli attributi di riferimento con più valori.</span><span class="sxs-lookup"><span data-stu-id="12567-232">MultivaluedReferenceAttributeUpdate - includes a full set of values for non-reference multi-valued attributes and only deltas for multi-valued reference attributes.</span></span></li><li><span data-ttu-id="12567-233">ObjectReplace: include tutti gli attributi per un oggetto quando viene modificato qualsiasi attributo</span><span class="sxs-lookup"><span data-stu-id="12567-233">ObjectReplace – includes all attributes for an object when any attribute changes</span></span></li> |
| <span data-ttu-id="12567-234">[Data Normalization][DataNorm] (Normalizzazione dei dati)</span><span class="sxs-lookup"><span data-stu-id="12567-234">[Data Normalization][DataNorm]</span></span> |<span data-ttu-id="12567-235">Indica al servizio di sincronizzazione di normalizzare gli attributi di ancoraggio prima che vengano forniti agli script.</span><span class="sxs-lookup"><span data-stu-id="12567-235">Instructs the Synchronization Service to normalize anchor attributes before they are provided to scripts.</span></span> |
| <span data-ttu-id="12567-236">[Object Confirmation][oconf] (Conferma degli oggetti)</span><span class="sxs-lookup"><span data-stu-id="12567-236">[Object Confirmation][oconf]</span></span> |<span data-ttu-id="12567-237">Consente di configurare il comportamento dell'importazione in sospeso nel servizio di sincronizzazione.</span><span class="sxs-lookup"><span data-stu-id="12567-237">Configures the pending import behavior in the Synchronization Service.</span></span> <li><span data-ttu-id="12567-238">Normale: il comportamento predefinito che prevede che tutte le modifiche esportate siano confermate tramite l'importazione</span><span class="sxs-lookup"><span data-stu-id="12567-238">Normal – default behavior that expects all exported changes to be confirmed via import</span></span></li><li><span data-ttu-id="12567-239">NoDeleteConfirmation: quando viene eliminato un oggetto, non viene generata alcuna importazione in sospeso.</span><span class="sxs-lookup"><span data-stu-id="12567-239">NoDeleteConfirmation – when an object is deleted, there is no pending import generated.</span></span></li><li><span data-ttu-id="12567-240">NoAddAndDeleteConfirmation: quando viene creato o eliminato un oggetto, non viene generata alcuna importazione in sospeso.</span><span class="sxs-lookup"><span data-stu-id="12567-240">NoAddAndDeleteConfirmation – when an object is created or deleted, there is no pending import generated.</span></span></li> |
| <span data-ttu-id="12567-241">Use DN as Anchor</span><span class="sxs-lookup"><span data-stu-id="12567-241">Use DN as Anchor</span></span> |<span data-ttu-id="12567-242">Se la funzionalità Distinguished Name Style è impostata su LDAP, l'attributo di ancoraggio per lo spazio del connettore è anche il nome distinto.</span><span class="sxs-lookup"><span data-stu-id="12567-242">If the Distinguished Name Style is set to LDAP, the anchor attribute for the connector space is also the distinguished name.</span></span> |
| <span data-ttu-id="12567-243">Concurrent Operations of Several Connectors</span><span class="sxs-lookup"><span data-stu-id="12567-243">Concurrent Operations of Several Connectors</span></span> |<span data-ttu-id="12567-244">Se selezionata, è possibile eseguire contemporaneamente più connettori Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="12567-244">When checked, multiple Windows PowerShell connectors can run simultaneously.</span></span> |
| <span data-ttu-id="12567-245">Partitions</span><span class="sxs-lookup"><span data-stu-id="12567-245">Partitions</span></span> |<span data-ttu-id="12567-246">Se selezionata, il connettore supporta più partizioni e l'individuazione delle partizioni.</span><span class="sxs-lookup"><span data-stu-id="12567-246">When checked, the connector supports multiple partitions and partition discovery.</span></span> |
| <span data-ttu-id="12567-247">Hierarchy</span><span class="sxs-lookup"><span data-stu-id="12567-247">Hierarchy</span></span> |<span data-ttu-id="12567-248">Se selezionata, il connettore supporta una struttura gerarchica di tipo LDAP.</span><span class="sxs-lookup"><span data-stu-id="12567-248">When checked, the connector supports an LDAP style hierarchical structure.</span></span> |
| <span data-ttu-id="12567-249">Enable Import</span><span class="sxs-lookup"><span data-stu-id="12567-249">Enable Import</span></span> |<span data-ttu-id="12567-250">Se selezionata, il connettore importa i dati attraverso gli script di importazione.</span><span class="sxs-lookup"><span data-stu-id="12567-250">When checked, the connector imports data via import scripts.</span></span> |
| <span data-ttu-id="12567-251">Enable Delta Import</span><span class="sxs-lookup"><span data-stu-id="12567-251">Enable Delta Import</span></span> |<span data-ttu-id="12567-252">Se selezionata, il connettore può richiedere i differenziali dagli script di importazione.</span><span class="sxs-lookup"><span data-stu-id="12567-252">When checked, the connector can request deltas from the import scripts.</span></span> |
| <span data-ttu-id="12567-253">Enable Export</span><span class="sxs-lookup"><span data-stu-id="12567-253">Enable Export</span></span> |<span data-ttu-id="12567-254">Se selezionata, il connettore esporta i dati attraverso gli script di esportazione.</span><span class="sxs-lookup"><span data-stu-id="12567-254">When checked, the connector exports data via export scripts.</span></span> |
| <span data-ttu-id="12567-255">Enable Full Export</span><span class="sxs-lookup"><span data-stu-id="12567-255">Enable Full Export</span></span> |<span data-ttu-id="12567-256">Se selezionata, gli script di esportazione supportano l'esportazione dell'intero spazio del connettore.</span><span class="sxs-lookup"><span data-stu-id="12567-256">When checked, the export scripts support exporting the entire connector space.</span></span> <span data-ttu-id="12567-257">Per poter usare questa opzione deve essere selezionata anche l'opzione Enable Export.</span><span class="sxs-lookup"><span data-stu-id="12567-257">To use this option, Enable Export must also be checked.</span></span> |
| <span data-ttu-id="12567-258">No Reference Values In First Export Pass</span><span class="sxs-lookup"><span data-stu-id="12567-258">No Reference Values In First Export Pass</span></span> |<span data-ttu-id="12567-259">Se selezionata, gli attributi di riferimento vengono esportati in un secondo passaggio di esportazione.</span><span class="sxs-lookup"><span data-stu-id="12567-259">When checked, reference attributes are exported in a second export pass.</span></span> |
| <span data-ttu-id="12567-260">Enable Object Rename</span><span class="sxs-lookup"><span data-stu-id="12567-260">Enable Object Rename</span></span> |<span data-ttu-id="12567-261">Se selezionata, è possibile modificare i nomi distinti.</span><span class="sxs-lookup"><span data-stu-id="12567-261">When checked, distinguished names can be modified.</span></span> |
| <span data-ttu-id="12567-262">Delete-Add As Replace</span><span class="sxs-lookup"><span data-stu-id="12567-262">Delete-Add As Replace</span></span> |<span data-ttu-id="12567-263">Se selezionata, le operazioni di eliminazione-aggiunta vengono esportate come una singola sostituzione.</span><span class="sxs-lookup"><span data-stu-id="12567-263">When checked, delete-add operations are exported as a single replacement.</span></span> |
| <span data-ttu-id="12567-264">Enable Password Operations</span><span class="sxs-lookup"><span data-stu-id="12567-264">Enable Password Operations</span></span> |<span data-ttu-id="12567-265">Se selezionata, gli script di sincronizzazione password sono supportati.</span><span class="sxs-lookup"><span data-stu-id="12567-265">When checked, password synchronization scripts are supported.</span></span> |
| <span data-ttu-id="12567-266">Enable Export Password in First Pass</span><span class="sxs-lookup"><span data-stu-id="12567-266">Enable Export Password in First Pass</span></span> |<span data-ttu-id="12567-267">Se selezionata, le password impostate durante il provisioning vengono esportate quando viene creato l'oggetto.</span><span class="sxs-lookup"><span data-stu-id="12567-267">When checked, passwords set during provisioning are exported when the object is created.</span></span> |

### <a name="global-parameters"></a><span data-ttu-id="12567-268">Global Parameters</span><span class="sxs-lookup"><span data-stu-id="12567-268">Global Parameters</span></span>
<span data-ttu-id="12567-269">La scheda Global Parameters (Parametri globali) in Management Agent Designer consente di configurare gli script di Windows PowerShell eseguiti dal connettore.</span><span class="sxs-lookup"><span data-stu-id="12567-269">The Global Parameters tab in the Management Agent Designer enables you to configure the Windows PowerShell scripts that are run by the connector.</span></span> <span data-ttu-id="12567-270">È anche possibile configurare i valori globali per le impostazioni di configurazione personalizzate definite nella scheda Connectivity (Connettività).</span><span class="sxs-lookup"><span data-stu-id="12567-270">You can also configure global values for custom configuration settings defined on the Connectivity tab.</span></span>

<span data-ttu-id="12567-271">**Individuazione della partizione**</span><span class="sxs-lookup"><span data-stu-id="12567-271">**Partition Discovery**</span></span>  
<span data-ttu-id="12567-272">Una partizione è uno spazio dei nomi separato all'interno di uno schema condiviso.</span><span class="sxs-lookup"><span data-stu-id="12567-272">A partition is a separate namespace within one shared schema.</span></span> <span data-ttu-id="12567-273">Ad esempio, in Active Directory ogni dominio è una partizione all'interno di una foresta.</span><span class="sxs-lookup"><span data-stu-id="12567-273">For example, in Active Directory every domain is a partition within one forest.</span></span> <span data-ttu-id="12567-274">Una partizione è il raggruppamento logico per le operazioni di importazione ed esportazione.</span><span class="sxs-lookup"><span data-stu-id="12567-274">A partition is the logical grouping for import and export operations.</span></span> <span data-ttu-id="12567-275">Queste hanno per contesto la partizione e tutte le operazioni vengono eseguite in questo contesto.</span><span class="sxs-lookup"><span data-stu-id="12567-275">Import and Export have partition as a context and all operations happens in this context.</span></span> <span data-ttu-id="12567-276">Le partizioni dovrebbero rappresentare una gerarchia in LDAP.</span><span class="sxs-lookup"><span data-stu-id="12567-276">Partitions are supposed to represent a hierarchy in LDAP.</span></span> <span data-ttu-id="12567-277">Il nome distinto di una partizione viene usato nell'importazione per verificare che tutti gli oggetti restituiti siano all'interno dell'ambito di una partizione.</span><span class="sxs-lookup"><span data-stu-id="12567-277">The distinguished name of a partition is used in import to verify that all returned objects are within the scope of a partition.</span></span> <span data-ttu-id="12567-278">Il nome distinto della partizione viene usato anche durante il provisioning dal metaverse allo spazio connettore per determinare a quale partizione deve essere associato un oggetto durante l'esportazione.</span><span class="sxs-lookup"><span data-stu-id="12567-278">The partition distinguished name is also used during provisioning from the metaverse to the connector space to determine the partition an object should be associated with during export.</span></span>

<span data-ttu-id="12567-279">Dal connettore, lo script di individuazione della partizione riceve i parametri seguenti:</span><span class="sxs-lookup"><span data-stu-id="12567-279">The partition discovery script receives the following parameters from the connector:</span></span>

| <span data-ttu-id="12567-280">Name</span><span class="sxs-lookup"><span data-stu-id="12567-280">Name</span></span> | <span data-ttu-id="12567-281">Tipo di dati</span><span class="sxs-lookup"><span data-stu-id="12567-281">Data Type</span></span> | <span data-ttu-id="12567-282">Descrizione</span><span class="sxs-lookup"><span data-stu-id="12567-282">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="12567-283">ConfigParameters</span><span class="sxs-lookup"><span data-stu-id="12567-283">ConfigParameters</span></span> |<span data-ttu-id="12567-284">[KeyedCollection][keyk][stringa, [ConfigParameter][cp]]</span><span class="sxs-lookup"><span data-stu-id="12567-284">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span></span> |<span data-ttu-id="12567-285">Tabella dei parametri di configurazione per il connettore.</span><span class="sxs-lookup"><span data-stu-id="12567-285">Table of configuration parameters for the Connector.</span></span> |
| <span data-ttu-id="12567-286">Credenziali</span><span class="sxs-lookup"><span data-stu-id="12567-286">Credential</span></span> |<span data-ttu-id="12567-287">[PSCredential][pscred]</span><span class="sxs-lookup"><span data-stu-id="12567-287">[PSCredential][pscred]</span></span> |<span data-ttu-id="12567-288">Contiene le credenziali immesse dall'amministratore nella scheda Connectivity.</span><span class="sxs-lookup"><span data-stu-id="12567-288">Contains any credentials entered by the administrator on the Connectivity tab.</span></span> |

<span data-ttu-id="12567-289">Lo script deve restituire un singolo oggetto [Partition][part] o un oggetto List[T] di oggetti Partition alla pipeline.</span><span class="sxs-lookup"><span data-stu-id="12567-289">The script must return a either a single [Partition][part] object or a List[T] of Partition objects to the pipeline.</span></span>

<span data-ttu-id="12567-290">**Individuazione della gerarchia**</span><span class="sxs-lookup"><span data-stu-id="12567-290">**Hierarchy Discovery**</span></span>  
<span data-ttu-id="12567-291">Lo script di individuazione della gerarchia viene usato solo quando la funzionalità Distinguished Name Style è impostata su LDAP.</span><span class="sxs-lookup"><span data-stu-id="12567-291">The hierarchy discovery script is only used when the Distinguished Name Style capability is LDAP.</span></span> <span data-ttu-id="12567-292">Lo script viene usato per consentire di cercare e selezionare un set di contenitori che verrà considerato all'interno o all'esterno dell'ambito per le operazioni di importazione ed esportazione.</span><span class="sxs-lookup"><span data-stu-id="12567-292">The script is used to allow you to browse and select a set of containers that is considered in or out of scope for import and export operations.</span></span> <span data-ttu-id="12567-293">Lo script deve fornire solo un elenco di nodi figlio diretti del nodo radice specificato per lo script.</span><span class="sxs-lookup"><span data-stu-id="12567-293">The script should only provide a list of nodes that are direct children of the root node supplied to the script.</span></span>

<span data-ttu-id="12567-294">Dal connettore, lo script di individuazione della gerarchia riceve i parametri seguenti:</span><span class="sxs-lookup"><span data-stu-id="12567-294">The hierarchy discovery script receives the following parameters from the connector:</span></span>

| <span data-ttu-id="12567-295">Name</span><span class="sxs-lookup"><span data-stu-id="12567-295">Name</span></span> | <span data-ttu-id="12567-296">Tipo di dati</span><span class="sxs-lookup"><span data-stu-id="12567-296">Data Type</span></span> | <span data-ttu-id="12567-297">Descrizione</span><span class="sxs-lookup"><span data-stu-id="12567-297">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="12567-298">ConfigParameters</span><span class="sxs-lookup"><span data-stu-id="12567-298">ConfigParameters</span></span> |<span data-ttu-id="12567-299">[KeyedCollection][keyk][stringa, [ConfigParameter][cp]]</span><span class="sxs-lookup"><span data-stu-id="12567-299">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span></span> |<span data-ttu-id="12567-300">Tabella dei parametri di configurazione per il connettore.</span><span class="sxs-lookup"><span data-stu-id="12567-300">Table of configuration parameters for the Connector.</span></span> |
| <span data-ttu-id="12567-301">Credenziali</span><span class="sxs-lookup"><span data-stu-id="12567-301">Credential</span></span> |<span data-ttu-id="12567-302">[PSCredential][pscred]</span><span class="sxs-lookup"><span data-stu-id="12567-302">[PSCredential][pscred]</span></span> |<span data-ttu-id="12567-303">Contiene le credenziali immesse dall'amministratore nella scheda Connectivity.</span><span class="sxs-lookup"><span data-stu-id="12567-303">Contains any credentials entered by the administrator on the Connectivity tab.</span></span> |
| <span data-ttu-id="12567-304">ParentNode</span><span class="sxs-lookup"><span data-stu-id="12567-304">ParentNode</span></span> |<span data-ttu-id="12567-305">[HierarchyNode][hn]</span><span class="sxs-lookup"><span data-stu-id="12567-305">[HierarchyNode][hn]</span></span> |<span data-ttu-id="12567-306">Il nodo radice della gerarchia in cui lo script deve restituire nodi figlio diretti.</span><span class="sxs-lookup"><span data-stu-id="12567-306">The root node of the hierarchy under which the script should return direct children.</span></span> |

<span data-ttu-id="12567-307">Lo script deve restituire un singolo oggetto HierarchyNode figlio o un elenco [T] di oggetti HierarchyNode figlio alla pipeline.</span><span class="sxs-lookup"><span data-stu-id="12567-307">The script must return a either a single child HierarchyNode object or a List[T] of child HierarchyNode objects to the pipeline.</span></span>

#### <a name="import"></a><span data-ttu-id="12567-308">Importazione</span><span class="sxs-lookup"><span data-stu-id="12567-308">Import</span></span>
<span data-ttu-id="12567-309">I connettori che supportano operazioni di importazione devono implementare tre script.</span><span class="sxs-lookup"><span data-stu-id="12567-309">Connectors that support import operations must implement three scripts.</span></span>

<span data-ttu-id="12567-310">**Avvio dell'importazione**</span><span class="sxs-lookup"><span data-stu-id="12567-310">**Begin Import**</span></span>  
<span data-ttu-id="12567-311">Lo script di avvio dell'importazione viene eseguito all'inizio di un passaggio di esecuzione dell'importazione.</span><span class="sxs-lookup"><span data-stu-id="12567-311">The begin import script is run at the beginning of an import run step.</span></span> <span data-ttu-id="12567-312">Durante questo passaggio è possibile stabilire una connessione al sistema di origine ed eseguire passaggi preliminari prima di importare dati dal sistema connesso.</span><span class="sxs-lookup"><span data-stu-id="12567-312">During this step, you can establish a connection to the source system and do preparatory steps before importing data from the connected system.</span></span>

<span data-ttu-id="12567-313">Dal connettore, lo script di avvio dell'importazione riceve i parametri seguenti:</span><span class="sxs-lookup"><span data-stu-id="12567-313">The begin import script receives the following parameters from the connector:</span></span>

| <span data-ttu-id="12567-314">Name</span><span class="sxs-lookup"><span data-stu-id="12567-314">Name</span></span> | <span data-ttu-id="12567-315">Tipo di dati</span><span class="sxs-lookup"><span data-stu-id="12567-315">Data Type</span></span> | <span data-ttu-id="12567-316">Descrizione</span><span class="sxs-lookup"><span data-stu-id="12567-316">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="12567-317">ConfigParameters</span><span class="sxs-lookup"><span data-stu-id="12567-317">ConfigParameters</span></span> |<span data-ttu-id="12567-318">[KeyedCollection][keyk][stringa, [ConfigParameter][cp]]</span><span class="sxs-lookup"><span data-stu-id="12567-318">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span></span> |<span data-ttu-id="12567-319">Tabella dei parametri di configurazione per il connettore.</span><span class="sxs-lookup"><span data-stu-id="12567-319">Table of configuration parameters for the Connector.</span></span> |
| <span data-ttu-id="12567-320">Credenziali</span><span class="sxs-lookup"><span data-stu-id="12567-320">Credential</span></span> |<span data-ttu-id="12567-321">[PSCredential][pscred]</span><span class="sxs-lookup"><span data-stu-id="12567-321">[PSCredential][pscred]</span></span> |<span data-ttu-id="12567-322">Contiene le credenziali immesse dall'amministratore nella scheda Connectivity.</span><span class="sxs-lookup"><span data-stu-id="12567-322">Contains any credentials entered by the administrator on the Connectivity tab.</span></span> |
| <span data-ttu-id="12567-323">OpenImportConnectionRunStep</span><span class="sxs-lookup"><span data-stu-id="12567-323">OpenImportConnectionRunStep</span></span> |<span data-ttu-id="12567-324">[OpenImportConnectionRunStep][oicrs]</span><span class="sxs-lookup"><span data-stu-id="12567-324">[OpenImportConnectionRunStep][oicrs]</span></span> |<span data-ttu-id="12567-325">Fornisce informazioni allo script sul tipo di esecuzione dell'importazione (differenziale o completa), la partizione, la gerarchia, la filigrana e la dimensione della pagina prevista.</span><span class="sxs-lookup"><span data-stu-id="12567-325">Informs the script about the type of import run (delta or full), partition, hierarchy, watermark, and expected page size.</span></span> |
| <span data-ttu-id="12567-326">Types</span><span class="sxs-lookup"><span data-stu-id="12567-326">Types</span></span> |<span data-ttu-id="12567-327">[Schema][schema]</span><span class="sxs-lookup"><span data-stu-id="12567-327">[Schema][schema]</span></span> |<span data-ttu-id="12567-328">Schema per lo spazio connettore che verrà importato.</span><span class="sxs-lookup"><span data-stu-id="12567-328">Schema for the connector space that is imported.</span></span> |

<span data-ttu-id="12567-329">Lo script deve restituire un singolo oggetto [OpenImportConnectionResults][oicres] alla pipeline, ad esempio: `Write-Output (New-Object Microsoft.MetadirectoryServices.OpenImportConnectionResults)`</span><span class="sxs-lookup"><span data-stu-id="12567-329">The script must return a single [OpenImportConnectionResults][oicres] object to the pipeline, for example: `Write-Output (New-Object Microsoft.MetadirectoryServices.OpenImportConnectionResults)`</span></span>

<span data-ttu-id="12567-330">**Importazione dei dati**</span><span class="sxs-lookup"><span data-stu-id="12567-330">**Import Data**</span></span>  
<span data-ttu-id="12567-331">Lo script di importazione dei dati viene chiamato dal connettore finché lo script non indica che non ci sono altri dati da importare.</span><span class="sxs-lookup"><span data-stu-id="12567-331">The import data script is called by the connector until the script indicates that there is no more data to import.</span></span> <span data-ttu-id="12567-332">Il connettore Windows PowerShell ha una dimensione della pagina di 9.999 oggetti.</span><span class="sxs-lookup"><span data-stu-id="12567-332">The Windows PowerShell connector has a page size of 9,999 objects.</span></span> <span data-ttu-id="12567-333">Se lo script restituisce più di 9.999 oggetti per l'importazione, è necessario supportare il paging.</span><span class="sxs-lookup"><span data-stu-id="12567-333">If your script returns more than 9,999 objects for import, you must support paging.</span></span> <span data-ttu-id="12567-334">Il connettore espone una proprietà dei dati personalizzata che è possibile usare per archiviare una filigrana in modo che ogni volta che viene chiamato lo script di importazione dei dati, questo riprende l'importazione di oggetti dal punto in cui era stata interrotta.</span><span class="sxs-lookup"><span data-stu-id="12567-334">The connector exposes a custom data property that you can use to a store a watermark so that each time the import data script is called, your script resumes importing objects where it left off.</span></span>

<span data-ttu-id="12567-335">Dal connettore, lo script di importazione dei dati riceve i parametri seguenti:</span><span class="sxs-lookup"><span data-stu-id="12567-335">The import data script receives the following parameters from the connector:</span></span>

| <span data-ttu-id="12567-336">Name</span><span class="sxs-lookup"><span data-stu-id="12567-336">Name</span></span> | <span data-ttu-id="12567-337">Tipo di dati</span><span class="sxs-lookup"><span data-stu-id="12567-337">Data Type</span></span> | <span data-ttu-id="12567-338">Descrizione</span><span class="sxs-lookup"><span data-stu-id="12567-338">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="12567-339">ConfigParameters</span><span class="sxs-lookup"><span data-stu-id="12567-339">ConfigParameters</span></span> |<span data-ttu-id="12567-340">[KeyedCollection][keyk][stringa, [ConfigParameter][cp]]</span><span class="sxs-lookup"><span data-stu-id="12567-340">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span></span> |<span data-ttu-id="12567-341">Tabella dei parametri di configurazione per il connettore.</span><span class="sxs-lookup"><span data-stu-id="12567-341">Table of configuration parameters for the Connector.</span></span> |
| <span data-ttu-id="12567-342">Credenziali</span><span class="sxs-lookup"><span data-stu-id="12567-342">Credential</span></span> |<span data-ttu-id="12567-343">[PSCredential][pscred]</span><span class="sxs-lookup"><span data-stu-id="12567-343">[PSCredential][pscred]</span></span> |<span data-ttu-id="12567-344">Contiene le credenziali immesse dall'amministratore nella scheda Connectivity.</span><span class="sxs-lookup"><span data-stu-id="12567-344">Contains any credentials entered by the administrator on the Connectivity tab.</span></span> |
| <span data-ttu-id="12567-345">GetImportEntriesRunStep</span><span class="sxs-lookup"><span data-stu-id="12567-345">GetImportEntriesRunStep</span></span> |<span data-ttu-id="12567-346">[ImportRunStep][irs]</span><span class="sxs-lookup"><span data-stu-id="12567-346">[ImportRunStep][irs]</span></span> |<span data-ttu-id="12567-347">Contiene la filigrana (CustomData) che può essere usata durante le importazioni di paging e le importazioni differenziali.</span><span class="sxs-lookup"><span data-stu-id="12567-347">Holds the watermark (CustomData) that can be used during paged imports and delta imports.</span></span> |
| <span data-ttu-id="12567-348">OpenImportConnectionRunStep</span><span class="sxs-lookup"><span data-stu-id="12567-348">OpenImportConnectionRunStep</span></span> |<span data-ttu-id="12567-349">[OpenImportConnectionRunStep][oicrs]</span><span class="sxs-lookup"><span data-stu-id="12567-349">[OpenImportConnectionRunStep][oicrs]</span></span> |<span data-ttu-id="12567-350">Fornisce informazioni allo script sul tipo di esecuzione dell'importazione (differenziale o completa), la partizione, la gerarchia, la filigrana e la dimensione della pagina prevista.</span><span class="sxs-lookup"><span data-stu-id="12567-350">Informs the script about the type of import run (delta or full), partition, hierarchy, watermark, and expected page size.</span></span> |
| <span data-ttu-id="12567-351">Types</span><span class="sxs-lookup"><span data-stu-id="12567-351">Types</span></span> |<span data-ttu-id="12567-352">[Schema][schema]</span><span class="sxs-lookup"><span data-stu-id="12567-352">[Schema][schema]</span></span> |<span data-ttu-id="12567-353">Schema per lo spazio connettore che verrà importato.</span><span class="sxs-lookup"><span data-stu-id="12567-353">Schema for the connector space that is imported.</span></span> |

<span data-ttu-id="12567-354">Lo script di importazione dei dati deve scrivere un oggetto List[[CSEntryChange][csec]] nella pipeline.</span><span class="sxs-lookup"><span data-stu-id="12567-354">The import data script must write a List[[CSEntryChange][csec]] object to the pipeline.</span></span> <span data-ttu-id="12567-355">Questa raccolta è costituita da attributi CSEntryChange che rappresentano ogni oggetto da importare.</span><span class="sxs-lookup"><span data-stu-id="12567-355">This collection is composed of CSEntryChange attributes that represent each object being imported.</span></span> <span data-ttu-id="12567-356">Durante l'esecuzione di una importazione completa, questa raccolta deve avere un set completo di oggetti CSEntryChange con tutti gli attributi per ogni oggetto.</span><span class="sxs-lookup"><span data-stu-id="12567-356">During a Full Import run, this collection should have a full set of CSEntryChange objects that have all attributes for every object.</span></span> <span data-ttu-id="12567-357">Durante un'importazione differenziale, l'oggetto CSEntryChange deve contenere i differenziali a livello di attributo per ogni oggetto da importare oppure una rappresentazione completa degli oggetti modificati (modalità di sostituzione).</span><span class="sxs-lookup"><span data-stu-id="12567-357">During a Delta Import, the CSEntryChange object should either contain the attribute level deltas for each object to import, or a complete representation of the objects that have changed (Replace mode).</span></span>

<span data-ttu-id="12567-358">**Fine importazione**</span><span class="sxs-lookup"><span data-stu-id="12567-358">**End Import**</span></span>  
<span data-ttu-id="12567-359">Al termine dell'esecuzione dell'importazione viene eseguito lo script di fine importazione.</span><span class="sxs-lookup"><span data-stu-id="12567-359">At the conclusion of the import run, the End Import script is run.</span></span> <span data-ttu-id="12567-360">che deve eseguire tutte le operazioni di pulizia necessarie, ad esempio chiudere le connessioni ai sistemi e rispondere agli errori.</span><span class="sxs-lookup"><span data-stu-id="12567-360">This script should perform any cleanup tasks necessary (for example, close connections to systems and respond to failures).</span></span>

<span data-ttu-id="12567-361">Dal connettore, lo script di fine importazione riceve i parametri seguenti:</span><span class="sxs-lookup"><span data-stu-id="12567-361">The end import script receives the following parameters from the connector:</span></span>

| <span data-ttu-id="12567-362">Name</span><span class="sxs-lookup"><span data-stu-id="12567-362">Name</span></span> | <span data-ttu-id="12567-363">Tipo di dati</span><span class="sxs-lookup"><span data-stu-id="12567-363">Data Type</span></span> | <span data-ttu-id="12567-364">Descrizione</span><span class="sxs-lookup"><span data-stu-id="12567-364">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="12567-365">ConfigParameters</span><span class="sxs-lookup"><span data-stu-id="12567-365">ConfigParameters</span></span> |<span data-ttu-id="12567-366">[KeyedCollection][keyk][stringa, [ConfigParameter][cp]]</span><span class="sxs-lookup"><span data-stu-id="12567-366">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span></span> |<span data-ttu-id="12567-367">Tabella dei parametri di configurazione per il connettore.</span><span class="sxs-lookup"><span data-stu-id="12567-367">Table of configuration parameters for the Connector.</span></span> |
| <span data-ttu-id="12567-368">Credenziali</span><span class="sxs-lookup"><span data-stu-id="12567-368">Credential</span></span> |<span data-ttu-id="12567-369">[PSCredential][pscred]</span><span class="sxs-lookup"><span data-stu-id="12567-369">[PSCredential][pscred]</span></span> |<span data-ttu-id="12567-370">Contiene le credenziali immesse dall'amministratore nella scheda Connectivity.</span><span class="sxs-lookup"><span data-stu-id="12567-370">Contains any credentials entered by the administrator on the Connectivity tab.</span></span> |
| <span data-ttu-id="12567-371">OpenImportConnectionRunStep</span><span class="sxs-lookup"><span data-stu-id="12567-371">OpenImportConnectionRunStep</span></span> |<span data-ttu-id="12567-372">[OpenImportConnectionRunStep][oicrs]</span><span class="sxs-lookup"><span data-stu-id="12567-372">[OpenImportConnectionRunStep][oicrs]</span></span> |<span data-ttu-id="12567-373">Fornisce informazioni allo script sul tipo di esecuzione dell'importazione (differenziale o completa), la partizione, la gerarchia, la filigrana e la dimensione della pagina prevista.</span><span class="sxs-lookup"><span data-stu-id="12567-373">Informs the script about the type of import run (delta or full), partition, hierarchy, watermark, and expected page size.</span></span> |
| <span data-ttu-id="12567-374">CloseImportConnectionRunStep</span><span class="sxs-lookup"><span data-stu-id="12567-374">CloseImportConnectionRunStep</span></span> |<span data-ttu-id="12567-375">[CloseImportConnectionRunStep][cecrs]</span><span class="sxs-lookup"><span data-stu-id="12567-375">[CloseImportConnectionRunStep][cecrs]</span></span> |<span data-ttu-id="12567-376">Fornisce informazioni allo script sul motivo per cui è stata terminata l'importazione.</span><span class="sxs-lookup"><span data-stu-id="12567-376">Informs the script about the reason the import was ended.</span></span> |

<span data-ttu-id="12567-377">Lo script deve restituire un singolo oggetto [CloseImportConnectionResults][cicres] alla pipeline, ad esempio `Write-Output (New-Object Microsoft.MetadirectoryServices.CloseImportConnectionResults)`</span><span class="sxs-lookup"><span data-stu-id="12567-377">The script must return a single [CloseImportConnectionResults][cicres] object to the pipeline, for example: `Write-Output (New-Object Microsoft.MetadirectoryServices.CloseImportConnectionResults)`</span></span>

#### <a name="export"></a><span data-ttu-id="12567-378">Esporta</span><span class="sxs-lookup"><span data-stu-id="12567-378">Export</span></span>
<span data-ttu-id="12567-379">Come per l'architettura di importazione del connettore, i connettori che supportano l'esportazione devono implementare tre script.</span><span class="sxs-lookup"><span data-stu-id="12567-379">Identical to the import architecture of the connector, connectors that support Export must implement three scripts.</span></span>

<span data-ttu-id="12567-380">**Avvio dell'importazione**</span><span class="sxs-lookup"><span data-stu-id="12567-380">**Begin Export**</span></span>  
<span data-ttu-id="12567-381">Lo script di avvio dell'esportazione viene eseguito all'inizio di un passaggio di esecuzione dell'esportazione.</span><span class="sxs-lookup"><span data-stu-id="12567-381">The begin export script is run at the beginning of an export run step.</span></span> <span data-ttu-id="12567-382">Durante questo passaggio è possibile stabilire una connessione al sistema di origine ed eseguire passaggi preliminari prima di esportare dati nel sistema connesso.</span><span class="sxs-lookup"><span data-stu-id="12567-382">During this step, you can establish a connection to the source system and conduct any preparatory steps before exporting data to the connected system.</span></span>

<span data-ttu-id="12567-383">Dal connettore, lo script di avvio dell'esportazione riceve i parametri seguenti:</span><span class="sxs-lookup"><span data-stu-id="12567-383">The begin export script receives the following parameters from the connector:</span></span>

| <span data-ttu-id="12567-384">Name</span><span class="sxs-lookup"><span data-stu-id="12567-384">Name</span></span> | <span data-ttu-id="12567-385">Tipo di dati</span><span class="sxs-lookup"><span data-stu-id="12567-385">Data Type</span></span> | <span data-ttu-id="12567-386">Descrizione</span><span class="sxs-lookup"><span data-stu-id="12567-386">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="12567-387">ConfigParameters</span><span class="sxs-lookup"><span data-stu-id="12567-387">ConfigParameters</span></span> |<span data-ttu-id="12567-388">[KeyedCollection][keyk][stringa, [ConfigParameter][cp]]</span><span class="sxs-lookup"><span data-stu-id="12567-388">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span></span> |<span data-ttu-id="12567-389">Tabella dei parametri di configurazione per il connettore.</span><span class="sxs-lookup"><span data-stu-id="12567-389">Table of configuration parameters for the Connector.</span></span> |
| <span data-ttu-id="12567-390">Credenziali</span><span class="sxs-lookup"><span data-stu-id="12567-390">Credential</span></span> |<span data-ttu-id="12567-391">[PSCredential][pscred]</span><span class="sxs-lookup"><span data-stu-id="12567-391">[PSCredential][pscred]</span></span> |<span data-ttu-id="12567-392">Contiene le credenziali immesse dall'amministratore nella scheda Connectivity.</span><span class="sxs-lookup"><span data-stu-id="12567-392">Contains any credentials entered by the administrator on the Connectivity tab.</span></span> |
| <span data-ttu-id="12567-393">OpenExportConnectionRunStep</span><span class="sxs-lookup"><span data-stu-id="12567-393">OpenExportConnectionRunStep</span></span> |<span data-ttu-id="12567-394">[OpenExportConnectionRunStep][oecrs]</span><span class="sxs-lookup"><span data-stu-id="12567-394">[OpenExportConnectionRunStep][oecrs]</span></span> |<span data-ttu-id="12567-395">Fornisce informazioni allo script sul tipo di esecuzione dell'esportazione (differenziale o completa), la partizione, la gerarchia e la dimensione della pagina prevista.</span><span class="sxs-lookup"><span data-stu-id="12567-395">Informs the script about the type of export run (delta or full), partition, hierarchy, and expected page size.</span></span> |
| <span data-ttu-id="12567-396">Types</span><span class="sxs-lookup"><span data-stu-id="12567-396">Types</span></span> |<span data-ttu-id="12567-397">[Schema][schema]</span><span class="sxs-lookup"><span data-stu-id="12567-397">[Schema][schema]</span></span> |<span data-ttu-id="12567-398">Schema per lo spazio connettore che verrà esportato.</span><span class="sxs-lookup"><span data-stu-id="12567-398">Schema for the connector space that is exported.</span></span> |

<span data-ttu-id="12567-399">Lo script non deve restituire alcun output alla pipeline.</span><span class="sxs-lookup"><span data-stu-id="12567-399">The script should not return any output to the pipeline.</span></span>

<span data-ttu-id="12567-400">**Esportazione dei dati**</span><span class="sxs-lookup"><span data-stu-id="12567-400">**Export Data**</span></span>  
<span data-ttu-id="12567-401">Il servizio di sincronizzazione chiama lo script di esportazione dei dati per il numero di volte necessario a elaborare tutte le esportazioni in sospeso.</span><span class="sxs-lookup"><span data-stu-id="12567-401">The Synchronization Service calls the Export Data script as many times as is necessary to process all pending exports.</span></span> <span data-ttu-id="12567-402">Se le esportazioni in sospeso dello spazio connettore superano le dimensioni di pagina del connettore, lo script di esportazione dei dati può essere chiamato più volte e anche più volte per lo stesso oggetto.</span><span class="sxs-lookup"><span data-stu-id="12567-402">If the connector space has more pending exports than the connector’s page size, the export data script may be called multiple times and possibly multiple times for the same object.</span></span>

<span data-ttu-id="12567-403">Dal connettore, lo script di esportazione dei dati riceve i parametri seguenti:</span><span class="sxs-lookup"><span data-stu-id="12567-403">The export data script receives the following parameters from the connector:</span></span>

| <span data-ttu-id="12567-404">Name</span><span class="sxs-lookup"><span data-stu-id="12567-404">Name</span></span> | <span data-ttu-id="12567-405">Tipo di dati</span><span class="sxs-lookup"><span data-stu-id="12567-405">Data Type</span></span> | <span data-ttu-id="12567-406">Descrizione</span><span class="sxs-lookup"><span data-stu-id="12567-406">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="12567-407">ConfigParameters</span><span class="sxs-lookup"><span data-stu-id="12567-407">ConfigParameters</span></span> |<span data-ttu-id="12567-408">[KeyedCollection][keyk][stringa, [ConfigParameter][cp]]</span><span class="sxs-lookup"><span data-stu-id="12567-408">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span></span> |<span data-ttu-id="12567-409">Tabella dei parametri di configurazione per il connettore.</span><span class="sxs-lookup"><span data-stu-id="12567-409">Table of configuration parameters for the Connector.</span></span> |
| <span data-ttu-id="12567-410">Credenziali</span><span class="sxs-lookup"><span data-stu-id="12567-410">Credential</span></span> |<span data-ttu-id="12567-411">[PSCredential][pscred]</span><span class="sxs-lookup"><span data-stu-id="12567-411">[PSCredential][pscred]</span></span> |<span data-ttu-id="12567-412">Contiene le credenziali immesse dall'amministratore nella scheda Connectivity.</span><span class="sxs-lookup"><span data-stu-id="12567-412">Contains any credentials entered by the administrator on the Connectivity tab.</span></span> |
| <span data-ttu-id="12567-413">CSEntries</span><span class="sxs-lookup"><span data-stu-id="12567-413">CSEntries</span></span> |<span data-ttu-id="12567-414">IList[CSEntryChange][csec]</span><span class="sxs-lookup"><span data-stu-id="12567-414">IList[CSEntryChange][csec]</span></span> |<span data-ttu-id="12567-415">Elenco di tutti gli oggetti dello spazio del connettore con esportazioni in sospeso da elaborare durante questo passaggio.</span><span class="sxs-lookup"><span data-stu-id="12567-415">List of all the connector space objects with pending exports to be processed during this pass.</span></span> |
| <span data-ttu-id="12567-416">OpenExportConnectionRunStep</span><span class="sxs-lookup"><span data-stu-id="12567-416">OpenExportConnectionRunStep</span></span> |<span data-ttu-id="12567-417">[OpenExportConnectionRunStep][oecrs]</span><span class="sxs-lookup"><span data-stu-id="12567-417">[OpenExportConnectionRunStep][oecrs]</span></span> |<span data-ttu-id="12567-418">Fornisce informazioni allo script sul tipo di esecuzione dell'esportazione (differenziale o completa), la partizione, la gerarchia e la dimensione della pagina prevista.</span><span class="sxs-lookup"><span data-stu-id="12567-418">Informs the script about the type of export run (delta or full), partition, hierarchy, and expected page size.</span></span> |
| <span data-ttu-id="12567-419">Types</span><span class="sxs-lookup"><span data-stu-id="12567-419">Types</span></span> |<span data-ttu-id="12567-420">[Schema][schema]</span><span class="sxs-lookup"><span data-stu-id="12567-420">[Schema][schema]</span></span> |<span data-ttu-id="12567-421">Schema per lo spazio connettore che verrà esportato.</span><span class="sxs-lookup"><span data-stu-id="12567-421">Schema for the connector space that is exported.</span></span> |

<span data-ttu-id="12567-422">Lo script di esportazione dei dati deve restituire un oggetto [PutExportEntriesResults][peeres] alla pipeline.</span><span class="sxs-lookup"><span data-stu-id="12567-422">The export data script must return a [PutExportEntriesResults][peeres] object to the pipeline.</span></span> <span data-ttu-id="12567-423">Questo oggetto non deve necessariamente includere le informazioni sui risultati per ogni connettore esportato a meno che non si verifichi un errore o una modifica dell'attributo di ancoraggio.</span><span class="sxs-lookup"><span data-stu-id="12567-423">This object does not need to include result information for each exported connector unless an error or a change to the anchor attribute occurs.</span></span> <span data-ttu-id="12567-424">Ad esempio, per restituire un oggetto PutExportEntriesResults alla pipeline: `Write-Output (New-Object Microsoft.MetadirectoryServices.PutExportEntriesResults)`</span><span class="sxs-lookup"><span data-stu-id="12567-424">For example, to return a PutExportEntriesResults object to the pipeline: `Write-Output (New-Object Microsoft.MetadirectoryServices.PutExportEntriesResults)`</span></span>

<span data-ttu-id="12567-425">**Fine esportazione**</span><span class="sxs-lookup"><span data-stu-id="12567-425">**End Export**</span></span>  
<span data-ttu-id="12567-426">Al termine dell'esecuzione dell'esportazione viene eseguito lo script di fine esportazione.</span><span class="sxs-lookup"><span data-stu-id="12567-426">At the conclusion of the export run, the End Export script to run.</span></span> <span data-ttu-id="12567-427">che deve eseguire tutte le operazioni di pulizia necessarie, ad esempio chiudere le connessioni ai sistemi e rispondere agli errori.</span><span class="sxs-lookup"><span data-stu-id="12567-427">This script should perform any cleanup tasks necessary (for example, close connections to systems and respond to failures).</span></span>

<span data-ttu-id="12567-428">Dal connettore, lo script di fine esportazione riceve i parametri seguenti:</span><span class="sxs-lookup"><span data-stu-id="12567-428">The end export script receives the following parameters from the connector:</span></span>

| <span data-ttu-id="12567-429">Name</span><span class="sxs-lookup"><span data-stu-id="12567-429">Name</span></span> | <span data-ttu-id="12567-430">Tipo di dati</span><span class="sxs-lookup"><span data-stu-id="12567-430">Data Type</span></span> | <span data-ttu-id="12567-431">Descrizione</span><span class="sxs-lookup"><span data-stu-id="12567-431">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="12567-432">ConfigParameters</span><span class="sxs-lookup"><span data-stu-id="12567-432">ConfigParameters</span></span> |<span data-ttu-id="12567-433">[KeyedCollection][keyk][stringa, [ConfigParameter][cp]]</span><span class="sxs-lookup"><span data-stu-id="12567-433">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span></span> |<span data-ttu-id="12567-434">Tabella dei parametri di configurazione per il connettore.</span><span class="sxs-lookup"><span data-stu-id="12567-434">Table of configuration parameters for the Connector.</span></span> |
| <span data-ttu-id="12567-435">Credenziali</span><span class="sxs-lookup"><span data-stu-id="12567-435">Credential</span></span> |<span data-ttu-id="12567-436">[PSCredential][pscred]</span><span class="sxs-lookup"><span data-stu-id="12567-436">[PSCredential][pscred]</span></span> |<span data-ttu-id="12567-437">Contiene le credenziali immesse dall'amministratore nella scheda Connectivity.</span><span class="sxs-lookup"><span data-stu-id="12567-437">Contains any credentials entered by the administrator on the Connectivity tab.</span></span> |
| <span data-ttu-id="12567-438">OpenExportConnectionRunStep</span><span class="sxs-lookup"><span data-stu-id="12567-438">OpenExportConnectionRunStep</span></span> |<span data-ttu-id="12567-439">[OpenExportConnectionRunStep][oecrs]</span><span class="sxs-lookup"><span data-stu-id="12567-439">[OpenExportConnectionRunStep][oecrs]</span></span> |<span data-ttu-id="12567-440">Fornisce informazioni allo script sul tipo di esecuzione dell'esportazione (differenziale o completa), la partizione, la gerarchia e la dimensione della pagina prevista.</span><span class="sxs-lookup"><span data-stu-id="12567-440">Informs the script about the type of export run (delta or full), partition, hierarchy, and expected page size.</span></span> |
| <span data-ttu-id="12567-441">CloseExportConnectionRunStep</span><span class="sxs-lookup"><span data-stu-id="12567-441">CloseExportConnectionRunStep</span></span> |<span data-ttu-id="12567-442">[CloseExportConnectionRunStep][cecrs]</span><span class="sxs-lookup"><span data-stu-id="12567-442">[CloseExportConnectionRunStep][cecrs]</span></span> |<span data-ttu-id="12567-443">Fornisce informazioni allo script sul motivo per cui è stata terminata l'esportazione.</span><span class="sxs-lookup"><span data-stu-id="12567-443">Informs the script about the reason the export was ended.</span></span> |

<span data-ttu-id="12567-444">Lo script non deve restituire alcun output alla pipeline.</span><span class="sxs-lookup"><span data-stu-id="12567-444">The script should not return any output to the pipeline.</span></span>

#### <a name="password-synchronization"></a><span data-ttu-id="12567-445">Sincronizzazione delle password</span><span class="sxs-lookup"><span data-stu-id="12567-445">Password Synchronization</span></span>
<span data-ttu-id="12567-446">I connettori Windows PowerShell possono essere usati come destinazione per la modifica o la reimpostazione delle password.</span><span class="sxs-lookup"><span data-stu-id="12567-446">Windows PowerShell connectors can be used as a target for password changes/resets.</span></span>

<span data-ttu-id="12567-447">Dal connettore, lo script della password riceve i parametri seguenti:</span><span class="sxs-lookup"><span data-stu-id="12567-447">The password script receives the following parameters from the connector:</span></span>

| <span data-ttu-id="12567-448">Name</span><span class="sxs-lookup"><span data-stu-id="12567-448">Name</span></span> | <span data-ttu-id="12567-449">Tipo di dati</span><span class="sxs-lookup"><span data-stu-id="12567-449">Data Type</span></span> | <span data-ttu-id="12567-450">Descrizione</span><span class="sxs-lookup"><span data-stu-id="12567-450">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="12567-451">ConfigParameters</span><span class="sxs-lookup"><span data-stu-id="12567-451">ConfigParameters</span></span> |<span data-ttu-id="12567-452">[KeyedCollection][keyk][stringa, [ConfigParameter][cp]]</span><span class="sxs-lookup"><span data-stu-id="12567-452">[KeyedCollection][keyk][string, [ConfigParameter][cp]]</span></span> |<span data-ttu-id="12567-453">Tabella dei parametri di configurazione per il connettore.</span><span class="sxs-lookup"><span data-stu-id="12567-453">Table of configuration parameters for the Connector.</span></span> |
| <span data-ttu-id="12567-454">Credenziali</span><span class="sxs-lookup"><span data-stu-id="12567-454">Credential</span></span> |<span data-ttu-id="12567-455">[PSCredential][pscred]</span><span class="sxs-lookup"><span data-stu-id="12567-455">[PSCredential][pscred]</span></span> |<span data-ttu-id="12567-456">Contiene le credenziali immesse dall'amministratore nella scheda Connectivity.</span><span class="sxs-lookup"><span data-stu-id="12567-456">Contains any credentials entered by the administrator on the Connectivity tab.</span></span> |
| <span data-ttu-id="12567-457">Partition</span><span class="sxs-lookup"><span data-stu-id="12567-457">Partition</span></span> |<span data-ttu-id="12567-458">[Partizione][part]</span><span class="sxs-lookup"><span data-stu-id="12567-458">[Partition][part]</span></span> |<span data-ttu-id="12567-459">Partizione della directory in cui si trova CSEntry.</span><span class="sxs-lookup"><span data-stu-id="12567-459">Directory partition that the CSEntry is in.</span></span> |
| <span data-ttu-id="12567-460">CSEntry</span><span class="sxs-lookup"><span data-stu-id="12567-460">CSEntry</span></span> |<span data-ttu-id="12567-461">[CSEntry][cse]</span><span class="sxs-lookup"><span data-stu-id="12567-461">[CSEntry][cse]</span></span> |<span data-ttu-id="12567-462">Voce dello spazio del connettore per l'oggetto che ha ricevuto una modifica o la reimpostazione della password.</span><span class="sxs-lookup"><span data-stu-id="12567-462">Connector space entry for the object that is received a password change or reset.</span></span> |
| <span data-ttu-id="12567-463">OperationType</span><span class="sxs-lookup"><span data-stu-id="12567-463">OperationType</span></span> |<span data-ttu-id="12567-464">String</span><span class="sxs-lookup"><span data-stu-id="12567-464">String</span></span> |<span data-ttu-id="12567-465">Indica se l'operazione è una reimpostazione (**SetPassword**) o una modifica (**ChangePassword**).</span><span class="sxs-lookup"><span data-stu-id="12567-465">Indicates if the operation is a reset (**SetPassword**) or a change (**ChangePassword**).</span></span> |
| <span data-ttu-id="12567-466">PasswordOptions</span><span class="sxs-lookup"><span data-stu-id="12567-466">PasswordOptions</span></span> |<span data-ttu-id="12567-467">[PasswordOptions][pwdopt]</span><span class="sxs-lookup"><span data-stu-id="12567-467">[PasswordOptions][pwdopt]</span></span> |<span data-ttu-id="12567-468">Flag che specifica il comportamento di reimpostazione della password preferito.</span><span class="sxs-lookup"><span data-stu-id="12567-468">Flags that specify the intended password reset behavior.</span></span> <span data-ttu-id="12567-469">Questo parametro è disponibile unicamente se OperationType è **SetPassword**.</span><span class="sxs-lookup"><span data-stu-id="12567-469">This parameter is only available if OperationType is **SetPassword**.</span></span> |
| <span data-ttu-id="12567-470">OldPassword</span><span class="sxs-lookup"><span data-stu-id="12567-470">OldPassword</span></span> |<span data-ttu-id="12567-471">String</span><span class="sxs-lookup"><span data-stu-id="12567-471">String</span></span> |<span data-ttu-id="12567-472">Popolato con la vecchia password dell'oggetto per le operazioni di modifica della password.</span><span class="sxs-lookup"><span data-stu-id="12567-472">Populated with the object’s old password for password changes.</span></span> <span data-ttu-id="12567-473">Questo parametro è disponibile unicamente se OperationType è **ChangePassword**.</span><span class="sxs-lookup"><span data-stu-id="12567-473">This parameter is only available if OperationType is **ChangePassword**.</span></span> |
| <span data-ttu-id="12567-474">NewPassword</span><span class="sxs-lookup"><span data-stu-id="12567-474">NewPassword</span></span> |<span data-ttu-id="12567-475">String</span><span class="sxs-lookup"><span data-stu-id="12567-475">String</span></span> |<span data-ttu-id="12567-476">Popolato con la nuova password dell'oggetto che lo script deve impostare.</span><span class="sxs-lookup"><span data-stu-id="12567-476">Populated with the object’s new password that the script should set.</span></span> |

<span data-ttu-id="12567-477">Lo script della password non deve restituire alcun risultato alla pipeline di Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="12567-477">The password script is not expected to return any results to the Windows PowerShell pipeline.</span></span> <span data-ttu-id="12567-478">Se si verifica un errore nello script della password, lo script genera una delle eccezioni seguenti per segnalare il problema al servizio di sincronizzazione:</span><span class="sxs-lookup"><span data-stu-id="12567-478">If an error occurs in the password script, the script should throw one of the following exceptions to inform the Synchronization Service about the problem:</span></span>

* <span data-ttu-id="12567-479">[PasswordPolicyViolationException][pwdex1]: viene generata se la password non soddisfa i criteri della password nel sistema connesso.</span><span class="sxs-lookup"><span data-stu-id="12567-479">[PasswordPolicyViolationException][pwdex1] – Thrown if the password does not meet the password policy in the connected system.</span></span>
* <span data-ttu-id="12567-480">[PasswordIllFormedException][pwdex2]: viene generata se la password non è accettabile per il sistema connesso.</span><span class="sxs-lookup"><span data-stu-id="12567-480">[PasswordIllFormedException][pwdex2] – Thrown if the password is not acceptable for the connected system.</span></span>
* <span data-ttu-id="12567-481">[PasswordExtension][pwdex3]: viene generata per tutti gli altri errori nello script della password.</span><span class="sxs-lookup"><span data-stu-id="12567-481">[PasswordExtension][pwdex3] – Thrown for all other errors in the password script.</span></span>

## <a name="sample-connectors"></a><span data-ttu-id="12567-482">Connettori di esempio</span><span class="sxs-lookup"><span data-stu-id="12567-482">Sample Connectors</span></span>
<span data-ttu-id="12567-483">Per una panoramica completa dei connettori di esempio disponibili, vedere [Windows PowerShell Connector Sample Connector Collection][samp] (Raccolta di connettori di esempio per Windows PowerShell).</span><span class="sxs-lookup"><span data-stu-id="12567-483">For a complete overview of the available sample connectors, see [Windows PowerShell Connector Sample Connector Collection][samp].</span></span>

## <a name="other-notes"></a><span data-ttu-id="12567-484">Altre note</span><span class="sxs-lookup"><span data-stu-id="12567-484">Other notes</span></span>
### <a name="additional-configuration-for-impersonation"></a><span data-ttu-id="12567-485">Configurazione aggiuntiva per la rappresentazione</span><span class="sxs-lookup"><span data-stu-id="12567-485">Additional Configuration for Impersonation</span></span>
<span data-ttu-id="12567-486">Concedere all'utente rappresentato le seguenti autorizzazioni nel server del servizio di sincronizzazione:</span><span class="sxs-lookup"><span data-stu-id="12567-486">Grant the user that is impersonated the following permissions on the Synchronization Service server:</span></span>

<span data-ttu-id="12567-487">Accesso in scrittura alle chiavi del Registro di sistema seguenti:</span><span class="sxs-lookup"><span data-stu-id="12567-487">Read access to the following registry keys:</span></span>

* <span data-ttu-id="12567-488">HKEY_USERS\\[SynchronizationServiceServiceAccountSID]\Software\Microsoft\PowerShell</span><span class="sxs-lookup"><span data-stu-id="12567-488">HKEY_USERS\\[SynchronizationServiceServiceAccountSID]\Software\Microsoft\PowerShell</span></span>
* <span data-ttu-id="12567-489">HKEY_USERS\\[SynchronizationServiceServiceAccountSID]\Environment</span><span class="sxs-lookup"><span data-stu-id="12567-489">HKEY_USERS\\[SynchronizationServiceServiceAccountSID]\Environment</span></span>

<span data-ttu-id="12567-490">Per determinare l'ID di sicurezza (SID) dell'account di servizio del servizio di sincronizzazione, eseguire i comandi di PowerShell seguenti:</span><span class="sxs-lookup"><span data-stu-id="12567-490">To determine the Security Identifier (SID) of the Synchronization Service service account, run the following PowerShell commands:</span></span>

```
$account = New-Object System.Security.Principal.NTAccount "<domain>\<username>"
$account.Translate([System.Security.Principal.SecurityIdentifier]).Value
```

<span data-ttu-id="12567-491">Accesso in lettura alle cartelle del file system seguenti:</span><span class="sxs-lookup"><span data-stu-id="12567-491">Read access to the following file system folders:</span></span>

* <span data-ttu-id="12567-492">%ProgramFiles%\Microsoft Forefront Identity Manager\2010\Synchronization Service\Extensions</span><span class="sxs-lookup"><span data-stu-id="12567-492">%ProgramFiles%\Microsoft Forefront Identity Manager\2010\Synchronization Service\Extensions</span></span>
* <span data-ttu-id="12567-493">%ProgramFiles%\Microsoft Forefront Identity Manager\2010\Synchronization Service\ExtensionsCache</span><span class="sxs-lookup"><span data-stu-id="12567-493">%ProgramFiles%\Microsoft Forefront Identity Manager\2010\Synchronization Service\ExtensionsCache</span></span>
* <span data-ttu-id="12567-494">%ProgramFiles%\Microsoft Forefront Identity Manager\2010\Synchronization Service\MaData\\{ConnectorName}</span><span class="sxs-lookup"><span data-stu-id="12567-494">%ProgramFiles%\Microsoft Forefront Identity Manager\2010\Synchronization Service\MaData\\{ConnectorName}</span></span>

<span data-ttu-id="12567-495">Sostituire il nome del connettore Windows PowerShell per il segnaposto {ConnectorName}.</span><span class="sxs-lookup"><span data-stu-id="12567-495">Substitute the name of the Windows PowerShell connector for the {ConnectorName} placeholder.</span></span>

## <a name="troubleshooting"></a><span data-ttu-id="12567-496">Risoluzione dei problemi</span><span class="sxs-lookup"><span data-stu-id="12567-496">Troubleshooting</span></span>
* <span data-ttu-id="12567-497">Per informazioni su come abilitare la registrazione per risolvere i problemi relativi al connettore, vedere l'articolo relativo a [come abilitare la traccia ETW per i connettori](http://go.microsoft.com/fwlink/?LinkId=335731).</span><span class="sxs-lookup"><span data-stu-id="12567-497">For information on how to enable logging to troubleshoot the connector, see the [How to Enable ETW Tracing for Connectors](http://go.microsoft.com/fwlink/?LinkId=335731).</span></span>

<!--Reference style links - using these makes the source content way more readable than using inline links-->
[cpp]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.configparameterpage.aspx
[keyk]: https://msdn.microsoft.com/library/ms132438.aspx
[cp]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.configparameter.aspx
[pscred]: https://msdn.microsoft.com/library/system.management.automation.pscredential.aspx
[schema]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.schema.aspx
[schemaT]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.schematype.aspx
[schemaA]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.schemaattribute.aspx
[dnstyle]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.madistinguishednamestyle.aspx
[exportT]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.maexporttype.aspx
[DataNorm]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.manormalizations.aspx
[oconf]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.maobjectconfirmation.aspx
[dw]: https://msdn.microsoft.com/library/windows/desktop/aa378184.aspx
[part]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.partition.aspx
[hn]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.hierarchynode.aspx
[oicrs]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.openimportconnectionrunstep.aspx
[cecrs]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.closeexportconnectionrunstep.aspx
[oicres]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.openimportconnectionresults.aspx
[cecrs]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.closeexportconnectionrunstep.aspx
[cicres]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.closeimportconnectionresults.aspx
[oecrs]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.openexportconnectionrunstep.aspx
[irs]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.importrunstep.aspx
[cse]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.csentry.aspx
[csec]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.csentrychange.aspx
[peeres]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.putexportentriesresults.aspx
[pwdopt]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.passwordoptions.aspx
[pwdex1]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.passwordpolicyviolationexception.aspx
[pwdex2]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.passwordillformedexception.aspx
[pwdex3]: https://msdn.microsoft.com/library/windows/desktop/microsoft.metadirectoryservices.passwordextensionexception.aspx
[samp]: http://go.microsoft.com/fwlink/?LinkId=394291
