---
title: le applicazioni che utilizzano gli argomenti del Bus di servizio di Azure e le sottoscrizioni aaaCreate | Documenti Microsoft
description: "Introduzione toohello funzionalità di pubblicazione-sottoscrizione offerte da sottoscrizioni e gli argomenti del Bus di servizio."
services: service-bus-messaging
documentationcenter: na
author: sethmanheim
manager: timlt
editor: 
ms.assetid: a48fc9b0-b7b0-464e-8187-a517bf8b4eb4
ms.service: service-bus-messaging
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 04/07/2017
ms.author: sethm
ms.openlocfilehash: f6d7de46ace7bd5b49de612db213ced789308d91
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/06/2017
---
# <a name="create-applications-that-use-service-bus-topics-and-subscriptions"></a><span data-ttu-id="7a706-103">Creare applicazioni che usano argomenti e sottoscrizioni del bus di servizio</span><span class="sxs-lookup"><span data-stu-id="7a706-103">Create applications that use Service Bus topics and subscriptions</span></span>
<span data-ttu-id="7a706-104">Il bus di servizio di Azure supporta un set di tecnologie middleware orientate ai messaggi e basate sul cloud, incluso l'accodamento dei messaggi affidabile e la messaggistica di pubblicazione e sottoscrizione permanente.</span><span class="sxs-lookup"><span data-stu-id="7a706-104">Azure Service Bus supports a set of cloud-based, message-oriented middleware technologies including reliable message queuing and durable publish/subscribe messaging.</span></span> <span data-ttu-id="7a706-105">Questo articolo si basa sulle informazioni hello fornite nella [creare applicazioni che utilizzano le code del Bus di servizio](service-bus-create-queues.md) e offre un'introduzione di funzionalità di pubblicazione/sottoscrizione toohello offerte da argomenti del Bus di servizio.</span><span class="sxs-lookup"><span data-stu-id="7a706-105">This article builds on hello information provided in [Create applications that use Service Bus queues](service-bus-create-queues.md) and offers an introduction toohello publish/subscribe capabilities offered by Service Bus topics.</span></span>

## <a name="evolving-retail-scenario"></a><span data-ttu-id="7a706-106">Scenario di vendita al dettaglio in evoluzione</span><span class="sxs-lookup"><span data-stu-id="7a706-106">Evolving retail scenario</span></span>
<span data-ttu-id="7a706-107">In questo articolo continua uno scenario di vendita al dettaglio hello utilizzato [creare applicazioni che utilizzano le code del Bus di servizio](service-bus-create-queues.md).</span><span class="sxs-lookup"><span data-stu-id="7a706-107">This article continues hello retail scenario used in [Create applications that use Service Bus queues](service-bus-create-queues.md).</span></span> <span data-ttu-id="7a706-108">Tenere presente che i dati di vendita da singoli terminali di punto di vendita (POS) devono essere indirizzato tooan sistema di gestione inventario che utilizza tale toodetermine dati quando è toobe un nuovo approvvigionamento.</span><span class="sxs-lookup"><span data-stu-id="7a706-108">Recall that sales data from individual Point of Sale (POS) terminals must be routed tooan inventory management system which uses that data toodetermine when stock has toobe replenished.</span></span> <span data-ttu-id="7a706-109">Ogni terminale segnala i dati di vendita tramite l'invio di messaggi toohello **DataCollectionQueue** coda, in cui rimangono finché vengono ricevuti dal sistema di gestione inventario hello, come illustrato di seguito:</span><span class="sxs-lookup"><span data-stu-id="7a706-109">Each POS terminal reports its sales data by sending messages toohello **DataCollectionQueue** queue, where they remain until they are received by hello inventory management system, as shown here:</span></span>

![Bus di servizio 1](./media/service-bus-create-topics-subscriptions/IC657161.gif)

<span data-ttu-id="7a706-111">tooevolve questo scenario, un nuovo requisito è stato aggiunto il sistema toohello: proprietario del Negozio hello vuole toomonitor in grado di toobe come hello del Negozio in tempo reale.</span><span class="sxs-lookup"><span data-stu-id="7a706-111">tooevolve this scenario, a new requirement has been added toohello system: hello store owner wants toobe able toomonitor how hello store is performing in real time.</span></span>

<span data-ttu-id="7a706-112">tooaddress questo requisito, il sistema hello deve "toccare" disattivare il flusso di dati di vendita hello.</span><span class="sxs-lookup"><span data-stu-id="7a706-112">tooaddress this requirement, hello system must "tap" off hello sales data stream.</span></span> <span data-ttu-id="7a706-113">Si vuole comunque che ogni messaggio inviato da hello POS terminali toobe inviati sistema di gestione inventario toohello come prima, ma si desidera che un'altra copia di ogni messaggio che è possibile utilizzare toopresent hello dashboard toohello archivio utente.</span><span class="sxs-lookup"><span data-stu-id="7a706-113">We still want each message sent by hello POS terminals toobe sent toohello inventory management system as before, but we want another copy of each message that we can use toopresent hello dashboard view toohello store owner.</span></span>

<span data-ttu-id="7a706-114">In situazioni come questa, in cui è necessario toobe ogni messaggio usato da più parti, è possibile utilizzare il Bus di servizio *argomenti*.</span><span class="sxs-lookup"><span data-stu-id="7a706-114">In any situation such as this, in which you require each message toobe consumed by multiple parties, you can use Service Bus *topics*.</span></span> <span data-ttu-id="7a706-115">Argomenti forniscono un modello di pubblicazione/sottoscrizione in cui ogni messaggio pubblicato viene reso disponibile tooone o più sottoscrizioni registrate con l'argomento hello.</span><span class="sxs-lookup"><span data-stu-id="7a706-115">Topics provide a publish/subscribe pattern in which each published message is made available tooone or more subscriptions registered with hello topic.</span></span> <span data-ttu-id="7a706-116">Al contrario, con le code ogni messaggio viene ricevuto da un singolo consumer.</span><span class="sxs-lookup"><span data-stu-id="7a706-116">In contrast, with queues each message is received by a single consumer.</span></span>

<span data-ttu-id="7a706-117">Argomento tooa in hello vengono inviati messaggi come inviati tooa coda.</span><span class="sxs-lookup"><span data-stu-id="7a706-117">Messages are sent tooa topic in hello same way as they are sent tooa queue.</span></span> <span data-ttu-id="7a706-118">Tuttavia, i messaggi non vengono ricevuti dall'argomento hello direttamente. vengono ricevuti dalle sottoscrizioni.</span><span class="sxs-lookup"><span data-stu-id="7a706-118">However, messages are not received from hello topic directly; they are received from subscriptions.</span></span> <span data-ttu-id="7a706-119">È possibile pensare di un argomento tooa sottoscrizione come una coda virtuale che riceve copie dei messaggi hello inviati toothat argomento.</span><span class="sxs-lookup"><span data-stu-id="7a706-119">You can think of a subscription tooa topic as a virtual queue that receives copies of hello messages that are sent toothat topic.</span></span> <span data-ttu-id="7a706-120">I messaggi vengono ricevuti da una sottoscrizione hello stesso modo in cui vengono ricevuti da una coda.</span><span class="sxs-lookup"><span data-stu-id="7a706-120">Messages are received from a subscription hello same way as they are received from a queue.</span></span>

<span data-ttu-id="7a706-121">Tornando toohello uno scenario di vendita al dettaglio, coda hello viene sostituita da un argomento e una sottoscrizione viene aggiunto, è possibile utilizzare il componente di sistema hello Gestione inventario.</span><span class="sxs-lookup"><span data-stu-id="7a706-121">Going back toohello retail scenario, hello queue is replaced by a topic, and a subscription is added, which hello inventory management system component can use.</span></span> <span data-ttu-id="7a706-122">sistema Hello viene visualizzato come segue:</span><span class="sxs-lookup"><span data-stu-id="7a706-122">hello system now appears as follows:</span></span>

![Bus di servizio 2](./media/service-bus-create-topics-subscriptions/IC657165.gif)

<span data-ttu-id="7a706-124">configurazione Hello agisce in modo identico toohello precedente basato su coda progettazione.</span><span class="sxs-lookup"><span data-stu-id="7a706-124">hello configuration here performs identically toohello previous queue-based design.</span></span> <span data-ttu-id="7a706-125">Ovvero, i messaggi inviati argomento toohello sono toohello indirizzato **inventario** sottoscrizione, da cui hello **sistema di gestione inventario** li Usa.</span><span class="sxs-lookup"><span data-stu-id="7a706-125">That is, messages sent toohello topic are routed toohello **Inventory** subscription, from which hello **Inventory Management System** consumes them.</span></span>

<span data-ttu-id="7a706-126">Nel dashboard di gestione hello toosupport ordine, si crea una seconda sottoscrizione in argomento hello, come illustrato di seguito:</span><span class="sxs-lookup"><span data-stu-id="7a706-126">In order toosupport hello management dashboard, we create a second subscription on hello topic, as shown here:</span></span>

![Bus di servizio 3](./media/service-bus-create-topics-subscriptions/IC657166.gif)

<span data-ttu-id="7a706-128">Con questa configurazione, ogni messaggio dai terminali hello POS è reso disponibile tooboth hello **Dashboard** e **inventario** sottoscrizioni.</span><span class="sxs-lookup"><span data-stu-id="7a706-128">With this configuration, each message from hello POS terminals is made available tooboth hello **Dashboard** and **Inventory** subscriptions.</span></span>

## <a name="show-me-hello-code"></a><span data-ttu-id="7a706-129">Mostra il codice hello</span><span class="sxs-lookup"><span data-stu-id="7a706-129">Show me hello code</span></span>
<span data-ttu-id="7a706-130">articolo Hello [creare applicazioni che utilizzano le code del Bus di servizio](service-bus-create-queues.md) viene descritto come toosign fino a un account Azure e creare uno spazio dei nomi del servizio.</span><span class="sxs-lookup"><span data-stu-id="7a706-130">hello article [Create applications that use Service Bus queues](service-bus-create-queues.md) describes how toosign up for an Azure account and create a service namespace.</span></span> <span data-ttu-id="7a706-131">dipendenze di Hello più semplice modo tooreference Bus di servizio è tooinstall hello Bus di servizio [pacchetto Nuget](https://www.nuget.org/packages/WindowsAzure.ServiceBus/).</span><span class="sxs-lookup"><span data-stu-id="7a706-131">hello easiest way tooreference Service Bus dependencies is tooinstall hello Service Bus [Nuget package](https://www.nuget.org/packages/WindowsAzure.ServiceBus/).</span></span> <span data-ttu-id="7a706-132">È inoltre possibile trovare hello le librerie del Bus di servizio come parte di hello Azure SDK.</span><span class="sxs-lookup"><span data-stu-id="7a706-132">You can also find hello Service Bus libraries as part of hello Azure SDK.</span></span> <span data-ttu-id="7a706-133">Hello è possibile scaricare hello [pagina di download di Azure SDK](https://azure.microsoft.com/downloads/).</span><span class="sxs-lookup"><span data-stu-id="7a706-133">hello download is available at hello [Azure SDK download page](https://azure.microsoft.com/downloads/).</span></span>

### <a name="create-hello-topic-and-subscriptions"></a><span data-ttu-id="7a706-134">Creazione di sottoscrizioni e argomento hello</span><span class="sxs-lookup"><span data-stu-id="7a706-134">Create hello topic and subscriptions</span></span>
<span data-ttu-id="7a706-135">Le operazioni di gestione per il Bus di servizio, le entità di messaggistica (code e pubblicazione/sottoscrizione argomenti) vengono eseguite tramite hello [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager#microsoft_servicebus_namespacemanager) classe.</span><span class="sxs-lookup"><span data-stu-id="7a706-135">Management operations for Service Bus messaging entities (queues and publish/subscribe topics) are performed via hello [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager#microsoft_servicebus_namespacemanager) class.</span></span> <span data-ttu-id="7a706-136">Sono necessarie le credenziali appropriate in ordine toocreate un **NamespaceManager** istanza per un determinato spazio dei nomi.</span><span class="sxs-lookup"><span data-stu-id="7a706-136">Appropriate credentials are required in order toocreate a **NamespaceManager** instance for a particular namespace.</span></span> <span data-ttu-id="7a706-137">Il bus di servizio usa un modello di sicurezza basato su [SAS (Shared Access Signature, Firma di accesso condiviso)](service-bus-sas.md).</span><span class="sxs-lookup"><span data-stu-id="7a706-137">Service Bus uses a [Shared Access Signature (SAS)](service-bus-sas.md) based security model.</span></span> <span data-ttu-id="7a706-138">Hello [TokenProvider](/dotnet/api/microsoft.servicebus.tokenprovider#microsoft_servicebus_tokenprovider) classe rappresenta un provider di token di sicurezza con metodi factory incorporati restituzione di alcuni provider di token noti.</span><span class="sxs-lookup"><span data-stu-id="7a706-138">hello [TokenProvider](/dotnet/api/microsoft.servicebus.tokenprovider#microsoft_servicebus_tokenprovider) class represents a security token provider with built-in factory methods returning some well-known token providers.</span></span> <span data-ttu-id="7a706-139">Si userà un [CreateSharedAccessSignatureTokenProvider](/dotnet/api/microsoft.servicebus.tokenprovider#Microsoft_ServiceBus_TokenProvider_CreateSharedAccessSignatureTokenProvider_System_String_) le credenziali di firma di accesso condiviso di metodo toohold hello.</span><span class="sxs-lookup"><span data-stu-id="7a706-139">We’ll use a [CreateSharedAccessSignatureTokenProvider](/dotnet/api/microsoft.servicebus.tokenprovider#Microsoft_ServiceBus_TokenProvider_CreateSharedAccessSignatureTokenProvider_System_String_) method toohold hello SAS credentials.</span></span> <span data-ttu-id="7a706-140">Hello [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager#microsoft_servicebus_namespacemanager) istanza viene quindi costruita con indirizzo di base di spazio dei nomi Service Bus hello e provider di token hello hello.</span><span class="sxs-lookup"><span data-stu-id="7a706-140">hello [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager#microsoft_servicebus_namespacemanager) instance is then constructed with hello base address of hello Service Bus namespace and hello token provider.</span></span>

<span data-ttu-id="7a706-141">Hello [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager#microsoft_servicebus_namespacemanager) classe fornisce metodi toocreate, enumerare ed eliminare entità di messaggistica.</span><span class="sxs-lookup"><span data-stu-id="7a706-141">hello [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager#microsoft_servicebus_namespacemanager) class provides methods toocreate, enumerate and delete messaging entities.</span></span> <span data-ttu-id="7a706-142">Hello codice riportata di seguito viene illustrato come hello **NamespaceManager** istanza viene creata e utilizzata toocreate hello **DataCollectionTopic** argomento.</span><span class="sxs-lookup"><span data-stu-id="7a706-142">hello code that is shown here shows how hello **NamespaceManager** instance is created and used toocreate hello **DataCollectionTopic** topic.</span></span>

```csharp
Uri uri = ServiceBusEnvironment.CreateServiceUri("sb", "test-blog", string.Empty);
string name = "RootManageSharedAccessKey";
string key = "abcdefghijklmopqrstuvwxyz";

TokenProvider tokenProvider = TokenProvider.CreateSharedAccessSignatureTokenProvider(name, key);
NamespaceManager namespaceManager = new NamespaceManager(uri, tokenProvider);

namespaceManager.CreateTopic("DataCollectionTopic");
```

<span data-ttu-id="7a706-143">Si noti che esistono overload di hello [CreateTopic](/dotnet/api/microsoft.servicebus.namespacemanager#Microsoft_ServiceBus_NamespaceManager_CreateTopic_System_String_) metodo che consentono di proprietà tooset di argomento hello.</span><span class="sxs-lookup"><span data-stu-id="7a706-143">Note that there are overloads of hello [CreateTopic](/dotnet/api/microsoft.servicebus.namespacemanager#Microsoft_ServiceBus_NamespaceManager_CreateTopic_System_String_) method that enable you tooset properties of hello topic.</span></span> <span data-ttu-id="7a706-144">Ad esempio, è possibile impostare hello time-to-live (TTL) predefinita per i messaggi inviati toohello argomento.</span><span class="sxs-lookup"><span data-stu-id="7a706-144">For example, you can set hello default time-to-live (TTL) value for messages sent toohello topic.</span></span> <span data-ttu-id="7a706-145">Successivamente, aggiungere hello **inventario** e **Dashboard** sottoscrizioni.</span><span class="sxs-lookup"><span data-stu-id="7a706-145">Next, add hello **Inventory** and **Dashboard** subscriptions.</span></span>

```csharp
namespaceManager.CreateSubscription("DataCollectionTopic", "Inventory");
namespaceManager.CreateSubscription("DataCollectionTopic", "Dashboard");
```

### <a name="send-messages-toohello-topic"></a><span data-ttu-id="7a706-146">Inviare l'argomento toohello messaggi</span><span class="sxs-lookup"><span data-stu-id="7a706-146">Send messages toohello topic</span></span>
<span data-ttu-id="7a706-147">Per le operazioni di runtime su entità del bus di servizio, ad esempio l'invio e la ricezione di messaggi, un'applicazione deve prima creare un oggetto [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory#microsoft_servicebus_messaging_messagingfactory).</span><span class="sxs-lookup"><span data-stu-id="7a706-147">For run-time operations on Service Bus entities; for example, sending and receiving messages, an application must first create a [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory#microsoft_servicebus_messaging_messagingfactory) object.</span></span> <span data-ttu-id="7a706-148">Toohello simile [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager#microsoft_servicebus_namespacemanager) classe hello **MessagingFactory** dall'indirizzo di base di spazio dei nomi servizio hello e provider di token hello hello viene creata l'istanza.</span><span class="sxs-lookup"><span data-stu-id="7a706-148">Similar toohello [NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager#microsoft_servicebus_namespacemanager) class, hello **MessagingFactory** instance is created from hello base address of hello service namespace and hello token provider.</span></span>

```
MessagingFactory factory = MessagingFactory.Create(uri, tokenProvider);
```

<span data-ttu-id="7a706-149">I messaggi inviati tooand ricevuto da argomenti del Bus di servizio, sono istanze di hello [BrokeredMessage](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage) classe.</span><span class="sxs-lookup"><span data-stu-id="7a706-149">Messages sent tooand received from Service Bus topics, are instances of hello [BrokeredMessage](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage) class.</span></span> <span data-ttu-id="7a706-150">Questa classe è costituita da un set di proprietà standard (ad esempio [etichetta](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.label?view=azureservicebus-4.0.0#Microsoft_ServiceBus_Messaging_BrokeredMessage_Label) e [TimeToLive](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.timetolive?view=azureservicebus-4.0.0#Microsoft_ServiceBus_Messaging_BrokeredMessage_TimeToLive)), un dizionario di proprietà dell'applicazione usato toohold e un corpo di dati applicazione arbitrari.</span><span class="sxs-lookup"><span data-stu-id="7a706-150">This class consists of a set of standard properties (such as [Label](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.label?view=azureservicebus-4.0.0#Microsoft_ServiceBus_Messaging_BrokeredMessage_Label) and [TimeToLive](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage.timetolive?view=azureservicebus-4.0.0#Microsoft_ServiceBus_Messaging_BrokeredMessage_TimeToLive)), a dictionary that is used toohold application properties, and a body of arbitrary application data.</span></span> <span data-ttu-id="7a706-151">Un'applicazione può impostare corpo hello passando qualsiasi oggetto serializzabile (hello seguente esempio di viene passata una **SalesData** oggetto che rappresenta i dati di vendita hello dal terminale POS hello), che verrà utilizzato hello [ DataContractSerializer](https://msdn.microsoft.com/library/system.runtime.serialization.datacontractserializer.aspx) oggetto hello tooserialize.</span><span class="sxs-lookup"><span data-stu-id="7a706-151">An application can set hello body by passing in any serializable object (hello following example passes in a **SalesData** object that represents hello sales data from hello POS terminal), which will use hello [DataContractSerializer](https://msdn.microsoft.com/library/system.runtime.serialization.datacontractserializer.aspx) tooserialize hello object.</span></span> <span data-ttu-id="7a706-152">In alternativa, può essere specificato un oggetto [Flusso](https://msdn.microsoft.com/library/system.io.stream.aspx).</span><span class="sxs-lookup"><span data-stu-id="7a706-152">Alternatively, a [Stream](https://msdn.microsoft.com/library/system.io.stream.aspx) object can be provided.</span></span>

```csharp
BrokeredMessage bm = new BrokeredMessage(salesData);
bm.Label = "SalesReport";
bm.Properties["StoreName"] = "Redmond";
bm.Properties["MachineID"] = "POS_1";
```

<span data-ttu-id="7a706-153">argomento con messaggi Hello più semplice modo toosend toohello è toouse [CreateMessageSender](/dotnet/api/microsoft.servicebus.messaging.messagingfactory#Microsoft_ServiceBus_Messaging_MessagingFactory_CreateMessageSender_System_String_) toocreate un [MessageSender](/dotnet/api/microsoft.servicebus.messaging.messagesender) oggetto direttamente da hello [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory) istanza di:</span><span class="sxs-lookup"><span data-stu-id="7a706-153">hello easiest way toosend messages toohello topic is toouse [CreateMessageSender](/dotnet/api/microsoft.servicebus.messaging.messagingfactory#Microsoft_ServiceBus_Messaging_MessagingFactory_CreateMessageSender_System_String_) toocreate a [MessageSender](/dotnet/api/microsoft.servicebus.messaging.messagesender) object directly from hello [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory) instance:</span></span>

```csharp
MessageSender sender = factory.CreateMessageSender("DataCollectionTopic");
sender.Send(bm);
```

### <a name="receive-messages-from-a-subscription"></a><span data-ttu-id="7a706-154">Ricevere messaggi da una sottoscrizione</span><span class="sxs-lookup"><span data-stu-id="7a706-154">Receive messages from a subscription</span></span>
<span data-ttu-id="7a706-155">Le code di toousing simile, tooreceive messaggi da una sottoscrizione è possibile utilizzare un [MessageReceiver](/dotnet/api/microsoft.servicebus.messaging.messagereceiver) oggetto creato direttamente tramite hello [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory) utilizzando [ CreateMessageReceiver](/dotnet/api/microsoft.servicebus.messaging.messagingfactory#Microsoft_ServiceBus_Messaging_MessagingFactory_CreateMessageReceiver_System_String_).</span><span class="sxs-lookup"><span data-stu-id="7a706-155">Similar toousing queues, tooreceive messages from a subscription you can use a [MessageReceiver](/dotnet/api/microsoft.servicebus.messaging.messagereceiver) object which you create directly from hello [MessagingFactory](/dotnet/api/microsoft.servicebus.messaging.messagingfactory) using [CreateMessageReceiver](/dotnet/api/microsoft.servicebus.messaging.messagingfactory#Microsoft_ServiceBus_Messaging_MessagingFactory_CreateMessageReceiver_System_String_).</span></span> <span data-ttu-id="7a706-156">È possibile utilizzare uno di hello due diverse modalità di ricezione (**ReceiveAndDelete** e **PeekLock**), come illustrato in [creare applicazioni che utilizzano le code del Bus di servizio](service-bus-create-queues.md).</span><span class="sxs-lookup"><span data-stu-id="7a706-156">You can use one of hello two different receive modes (**ReceiveAndDelete** and **PeekLock**), as discussed in [Create applications that use Service Bus queues](service-bus-create-queues.md).</span></span>

<span data-ttu-id="7a706-157">Si noti che quando si crea un **MessageReceiver** per le sottoscrizioni, hello *entityPath* parametro è formato hello `topicPath/subscriptions/subscriptionName`.</span><span class="sxs-lookup"><span data-stu-id="7a706-157">Note that when you create a **MessageReceiver** for subscriptions, hello *entityPath* parameter is of hello form `topicPath/subscriptions/subscriptionName`.</span></span> <span data-ttu-id="7a706-158">Pertanto, toocreate un **MessageReceiver** per hello **inventario** sottoscrizione di hello **DataCollectionTopic** argomento *entityPath*deve essere impostato troppo`DataCollectionTopic/subscriptions/Inventory`.</span><span class="sxs-lookup"><span data-stu-id="7a706-158">Therefore, toocreate a **MessageReceiver** for hello **Inventory** subscription of hello **DataCollectionTopic** topic, *entityPath* must be set too`DataCollectionTopic/subscriptions/Inventory`.</span></span> <span data-ttu-id="7a706-159">codice Hello visualizzato come segue:</span><span class="sxs-lookup"><span data-stu-id="7a706-159">hello code appears as follows:</span></span>

```csharp
MessageReceiver receiver = factory.CreateMessageReceiver("DataCollectionTopic/subscriptions/Inventory");
BrokeredMessage receivedMessage = receiver.Receive();
try
{
    ProcessMessage(receivedMessage);
    receivedMessage.Complete();
}
catch (Exception e)
{
    receivedMessage.Abandon();
}
```

## <a name="subscription-filters"></a><span data-ttu-id="7a706-160">Filtri di sottoscrizione</span><span class="sxs-lookup"><span data-stu-id="7a706-160">Subscription filters</span></span>
<span data-ttu-id="7a706-161">Finora, in questo scenario tutti i messaggi inviati argomento toohello vengono effettuati le sottoscrizioni disponibili tooall registrato.</span><span class="sxs-lookup"><span data-stu-id="7a706-161">So far, in this scenario all messages sent toohello topic are made available tooall registered subscriptions.</span></span> <span data-ttu-id="7a706-162">di seguito frase chiave Hello "diventa disponibile."</span><span class="sxs-lookup"><span data-stu-id="7a706-162">hello key phrase here is "made available."</span></span> <span data-ttu-id="7a706-163">Mentre le sottoscrizioni del Bus di servizio vedere tutti i messaggi inviati toohello argomento, è possibile copiare solo un subset della coda di sottoscrizione virtuale toohello tali messaggi.</span><span class="sxs-lookup"><span data-stu-id="7a706-163">While Service Bus subscriptions see all messages sent toohello topic, you can copy only a subset of those messages toohello virtual subscription queue.</span></span> <span data-ttu-id="7a706-164">Questa operazione viene eseguita usando i *filtri* della sottoscrizione.</span><span class="sxs-lookup"><span data-stu-id="7a706-164">This is performed using subscription *filters*.</span></span> <span data-ttu-id="7a706-165">Quando si crea una sottoscrizione, è possibile fornire un'espressione di filtro sotto forma di hello di un predicato di tipo SQL92 opera sulle proprietà del messaggio hello di hello, entrambi hello le proprietà di sistema (ad esempio, [etichetta](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Label)) e un'applicazione hello proprietà, ad esempio **StoreName** nell'esempio precedente hello.</span><span class="sxs-lookup"><span data-stu-id="7a706-165">When you create a subscription, you can supply a filter expression in hello form of a SQL92 style predicate that operates over hello properties of hello message, both hello system properties (for example, [Label](/dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Label)) and hello application properties, such as **StoreName** in hello previous example.</span></span>

<span data-ttu-id="7a706-166">Evoluzione hello scenario tooillustrate questo, un secondo negozio è uno scenario di vendita al dettaglio tooour aggiunto toobe.</span><span class="sxs-lookup"><span data-stu-id="7a706-166">Evolving hello scenario tooillustrate this, a second store is toobe added tooour retail scenario.</span></span> <span data-ttu-id="7a706-167">Sistema di gestione inventario toohello centralizzata toobe indirizzato ancora su dati di vendita da tutti i terminali hello POS da entrambi gli archivi, ma un gestore dell'archivio utilizzando lo strumento dashboard hello è solo interessato prestazioni hello dell'archivio.</span><span class="sxs-lookup"><span data-stu-id="7a706-167">Sales data from all of hello POS terminals from both stores still have toobe routed toohello centralized inventory management system, but a store manager using hello dashboard tool is only interested in hello performance of that store.</span></span> <span data-ttu-id="7a706-168">È possibile utilizzare filtri tooachieve questa sottoscrizione.</span><span class="sxs-lookup"><span data-stu-id="7a706-168">You can use subscription filtering tooachieve this.</span></span> <span data-ttu-id="7a706-169">Si noti che quando i terminali hello POS pubblicano i messaggi, impostano hello **StoreName** proprietà applicazione messaggio hello.</span><span class="sxs-lookup"><span data-stu-id="7a706-169">Note that when hello POS terminals publish messages, they set hello **StoreName** application property on hello message.</span></span> <span data-ttu-id="7a706-170">Ha due archivi, ad esempio **Redmond** e **Seattle**, i terminali hello POS hello Redmond archiviano i dati di vendita messaggi con timestamp un **StoreName** uguale troppo **Redmond**, mentre hello Seattle archivio utilizzare terminali POS un **StoreName** uguale troppo**Seattle**.</span><span class="sxs-lookup"><span data-stu-id="7a706-170">Given two stores, for example **Redmond** and **Seattle**, hello POS terminals in hello Redmond store stamp their sales data messages with a **StoreName** equal too**Redmond**, whereas hello Seattle store POS terminals use a **StoreName** equal too**Seattle**.</span></span> <span data-ttu-id="7a706-171">gestore del negozio di Redmond archiviare solo hello Hello vuole toosee dati dal relativo terminali di punti vendita.</span><span class="sxs-lookup"><span data-stu-id="7a706-171">hello store manager of hello Redmond store only wants toosee data from its POS terminals.</span></span> <span data-ttu-id="7a706-172">sistema Hello visualizzato come segue:</span><span class="sxs-lookup"><span data-stu-id="7a706-172">hello system appears as follows:</span></span>

![Servizio Bus4](./media/service-bus-create-topics-subscriptions/IC657167.gif)

<span data-ttu-id="7a706-174">tooset di questo ciclo, si crea hello **Dashboard** sottoscrizione come indicato di seguito:</span><span class="sxs-lookup"><span data-stu-id="7a706-174">tooset up this routing, you create hello **Dashboard** subscription as follows:</span></span>

```csharp
SqlFilter dashboardFilter = new SqlFilter("StoreName = 'Redmond'");
namespaceManager.CreateSubscription("DataCollectionTopic", "Dashboard", dashboardFilter);
```

<span data-ttu-id="7a706-175">Con questo [filtro di sottoscrizione](/dotnet/api/microsoft.servicebus.messaging.sqlfilter), solo i messaggi hello **StoreName** impostata troppo**Redmond** saranno copiati toohello coda virtuale hello **Dashboard** sottoscrizione.</span><span class="sxs-lookup"><span data-stu-id="7a706-175">With this [subscription filter](/dotnet/api/microsoft.servicebus.messaging.sqlfilter), only messages that have hello **StoreName** property set too**Redmond** will be copied toohello virtual queue for hello **Dashboard** subscription.</span></span> <span data-ttu-id="7a706-176">È molto più toosubscription tuttavia il filtro.</span><span class="sxs-lookup"><span data-stu-id="7a706-176">There is much more toosubscription filtering, however.</span></span> <span data-ttu-id="7a706-177">Le applicazioni possono avere più regole di filtro per ogni sottoscrizione nelle proprietà hello toomodify delle possibilità di toohello di aggiunta di un messaggio quando viene posizionato coda virtuale tooa della sottoscrizione.</span><span class="sxs-lookup"><span data-stu-id="7a706-177">Applications can have multiple filter rules per subscription in addition toohello ability toomodify hello properties of a message as it passes tooa subscription's virtual queue.</span></span>

## <a name="summary"></a><span data-ttu-id="7a706-178">Riepilogo</span><span class="sxs-lookup"><span data-stu-id="7a706-178">Summary</span></span>
<span data-ttu-id="7a706-179">Tutti di hello motivi toouse Accodamento descritti nel [creare applicazioni che utilizzano le code del Bus di servizio](service-bus-create-queues.md) si applicano anche tootopics, in particolare:</span><span class="sxs-lookup"><span data-stu-id="7a706-179">All of hello reasons toouse queuing described in [Create applications that use Service Bus queues](service-bus-create-queues.md) also apply tootopics, specifically:</span></span>

* <span data-ttu-id="7a706-180">Disaccoppiamento temporale: messaggio producer e consumer non è in linea toobe in hello contemporaneamente.</span><span class="sxs-lookup"><span data-stu-id="7a706-180">Temporal decoupling – message producers and consumers do not have toobe online at hello same time.</span></span>
* <span data-ttu-id="7a706-181">Livellamento del carico: i picchi di carico vengono smussati dall'argomento di hello abilitando il provisioning per un carico medio anziché il carico massimo dispendiosa in termini di toobe di applicazioni.</span><span class="sxs-lookup"><span data-stu-id="7a706-181">Load leveling – peaks in load are smoothed out by hello topic enabling consuming applications toobe provisioned for average load instead of peak load.</span></span>
* <span data-ttu-id="7a706-182">Bilanciamento del carico: coda tooa simili, è possibile disporre di più consumer concorrenti in attesa su una singola sottoscrizione, con ogni messaggio passato tooonly consumer hello, in tal modo il bilanciamento del carico.</span><span class="sxs-lookup"><span data-stu-id="7a706-182">Load balancing – similar tooa queue, you can have multiple competing consumers listening on a single subscription, with each message handed off tooonly one of hello consumers, thereby balancing load.</span></span>
* <span data-ttu-id="7a706-183">Regime di controllo: è possibile sviluppare hello messaggistica rete senza influire sull'endpoint esistente. ad esempio, l'aggiunta di sottoscrizioni o modificando i filtri tooa argomento tooallow di nuovi consumer.</span><span class="sxs-lookup"><span data-stu-id="7a706-183">Loose coupling – you can evolve hello messaging network without affecting existing endpoints; for example, adding subscriptions or changing filters tooa topic tooallow for new consumers.</span></span>

## <a name="next-steps"></a><span data-ttu-id="7a706-184">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="7a706-184">Next steps</span></span>

<span data-ttu-id="7a706-185">Vedere [creare applicazioni che utilizzano le code del Bus di servizio](service-bus-create-queues.md) per informazioni su come toouse code in uno scenario di vendita al dettaglio hello POS.</span><span class="sxs-lookup"><span data-stu-id="7a706-185">See [Create applications that use Service Bus queues](service-bus-create-queues.md) for information about how toouse queues in hello POS retail scenario.</span></span>

