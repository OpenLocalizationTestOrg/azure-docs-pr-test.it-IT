---
title: Account di accesso e utenti SQL di Azure | Documentazione Microsoft
description: "Informazioni sulla gestione della sicurezza del database SQL, in particolare la modalità di gestione dell'accesso al database e la sicurezza degli account di accesso tramite l'account delle entità di sicurezza a livello di server."
keywords: sicurezza del database sql, gestione della sicurezza del database, sicurezza degli account di accesso, sicurezza del database, accesso al database
services: sql-database
documentationcenter: 
author: BYHAM
manager: jhubbard
editor: 
tags: 
ms.assetid: 0a65a93f-d5dc-424b-a774-7ed62d996f8c
ms.service: sql-database
ms.custom: security
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: data-management
ms.date: 01/23/2017
ms.author: rickbyh
ms.openlocfilehash: 51edd390c065dd7312ecc54694b5a95ecc11eab8
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 07/11/2017
---
# <a name="controlling-and-granting-database-access"></a><span data-ttu-id="6873a-104">Controllo e concessione dell'accesso al database</span><span class="sxs-lookup"><span data-stu-id="6873a-104">Controlling and granting database access</span></span>

<span data-ttu-id="6873a-105">Dopo aver configurato le regole del firewall, gli utenti possono connettersi a un database SQL come uno degli account di amministratore, il proprietario del database o un utente del database nel database.</span><span class="sxs-lookup"><span data-stu-id="6873a-105">When firewall rules have been configured, people can connect to a SQL Database as one of the administrator accounts, as the database owner, or as a database user in the database.</span></span>  

>  [!NOTE]  
>  <span data-ttu-id="6873a-106">Questo argomento è applicabile al server SQL di Azure e ai database SQL e di SQL Data Warehouse creati nel server SQL di Azure.</span><span class="sxs-lookup"><span data-stu-id="6873a-106">This topic applies to Azure SQL server, and to both SQL Database and SQL Data Warehouse databases that are created on the Azure SQL server.</span></span> <span data-ttu-id="6873a-107">Per semplicità, "database SQL" viene usato per fare riferimento sia al database SQL che al database di SQL Data Warehouse.</span><span class="sxs-lookup"><span data-stu-id="6873a-107">For simplicity, SQL Database is used when referring to both SQL Database and SQL Data Warehouse.</span></span> 
>

> [!TIP]
> <span data-ttu-id="6873a-108">Per un'esercitazione, vedere [Proteggere il database SQL di Azure](sql-database-security-tutorial.md).</span><span class="sxs-lookup"><span data-stu-id="6873a-108">For a tutorial, see [Secure your Azure SQL Database](sql-database-security-tutorial.md).</span></span>
>


## <a name="unrestricted-administrative-accounts"></a><span data-ttu-id="6873a-109">Account amministrativi senza restrizioni</span><span class="sxs-lookup"><span data-stu-id="6873a-109">Unrestricted administrative accounts</span></span>
<span data-ttu-id="6873a-110">Sono disponibili due account amministrativi, **Amministratore del server** e **Amministratore di Active Directory**, che agiscono come amministratori.</span><span class="sxs-lookup"><span data-stu-id="6873a-110">There are two administrative accounts (**Server admin** and **Active Directory admin**) that act as administrators.</span></span> <span data-ttu-id="6873a-111">Per identificare questi account amministrativi per il server SQL, aprire il portale di Azure e passare alle proprietà del server SQL.</span><span class="sxs-lookup"><span data-stu-id="6873a-111">To identify these administrator accounts for your SQL server, open the Azure portal, and navigate to the properties of your SQL server.</span></span>

![Amministratori del server SQL](./media/sql-database-manage-logins/sql-admins.png)

- <span data-ttu-id="6873a-113">**Amministratore del server** </span><span class="sxs-lookup"><span data-stu-id="6873a-113">**Server admin** </span></span>  
<span data-ttu-id="6873a-114">Quando si crea un server SQL di Azure è necessario designare un **accesso amministratore server**.</span><span class="sxs-lookup"><span data-stu-id="6873a-114">When you create an Azure SQL server, you must designate a **Server admin login**.</span></span> <span data-ttu-id="6873a-115">Il server SQL crea l'account come account di accesso nel database master.</span><span class="sxs-lookup"><span data-stu-id="6873a-115">SQL server creates that account as a login in the master database.</span></span> <span data-ttu-id="6873a-116">Tale account, che effettua la connessione con l'autenticazione di SQL Server (nome utente e password),</span><span class="sxs-lookup"><span data-stu-id="6873a-116">This account connects using SQL Server authentication (user name and password).</span></span> <span data-ttu-id="6873a-117">Può esistere un solo account di questo tipo.</span><span class="sxs-lookup"><span data-stu-id="6873a-117">Only one of these accounts can exist.</span></span>   
- <span data-ttu-id="6873a-118">**Amministratore di Azure Active Directory** </span><span class="sxs-lookup"><span data-stu-id="6873a-118">**Azure Active Directory admin** </span></span>  
<span data-ttu-id="6873a-119">È possibile configurare come amministratore anche un account singolo o di gruppo di sicurezza di Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="6873a-119">One Azure Active Directory account, either an individual or security group account, can also be configured as an administrator.</span></span> <span data-ttu-id="6873a-120">La configurazione di un amministratore di Azure AD è facoltativa, ma è necessaria se si vuole usare gli account di Azure AD per la connessione al database SQL.</span><span class="sxs-lookup"><span data-stu-id="6873a-120">It is optional to configure an Azure AD administrator, but an Azure AD administrator must be configured if you want to use Azure AD accounts to connect to SQL Database.</span></span> <span data-ttu-id="6873a-121">Per altre informazioni sulla configurazione dell'accesso con Azure Active Directory, vedere [Connessione al database SQL oppure a SQL Data Warehouse con l'autenticazione di Azure Active Directory](sql-database-aad-authentication.md) e [Supporto di SSMS per l'autenticazione MFA di Azure AD con database SQL e SQL Data Warehouse](sql-database-ssms-mfa-authentication.md).</span><span class="sxs-lookup"><span data-stu-id="6873a-121">For more information about configuring Azure Active Directory access, see [Connecting to SQL Database or SQL Data Warehouse By Using Azure Active Directory Authentication](sql-database-aad-authentication.md) and [SSMS support for Azure AD MFA with SQL Database and SQL Data Warehouse](sql-database-ssms-mfa-authentication.md).</span></span>
 

<span data-ttu-id="6873a-122">Gli account **Amministratore del server** e **Amministratore di Azure Active Directory** hanno le caratteristiche seguenti:</span><span class="sxs-lookup"><span data-stu-id="6873a-122">The **Server admin** and **Azure AD admin** accounts has the following characteristics:</span></span>
- <span data-ttu-id="6873a-123">Questi sono gli unici account che possono connettersi automaticamente a qualsiasi database SQL nel server.</span><span class="sxs-lookup"><span data-stu-id="6873a-123">These are the only accounts that can automatically connect to any SQL Database on the server.</span></span> <span data-ttu-id="6873a-124">Per connettersi a un database utente, gli altri account devono essere il proprietario del database o avere un account utente nel database utente.</span><span class="sxs-lookup"><span data-stu-id="6873a-124">(To connect to a user database, other accounts must either be the owner of the database, or have a user account in the user database.)</span></span>
- <span data-ttu-id="6873a-125">Questi account accedono ai database utente come utente `dbo` e hanno a disposizione tutte le autorizzazioni nei database utente.</span><span class="sxs-lookup"><span data-stu-id="6873a-125">These accounts enter user databases as the `dbo` user and they have all the permissions in the user databases.</span></span> <span data-ttu-id="6873a-126">Anche il proprietario di un database utente accede al database come utente `dbo`.</span><span class="sxs-lookup"><span data-stu-id="6873a-126">(The owner of a user database also enters the database as the `dbo` user.)</span></span> 
- <span data-ttu-id="6873a-127">Questi account non accedono al database `master` come utente `dbo` e hanno autorizzazioni limitate nel database master.</span><span class="sxs-lookup"><span data-stu-id="6873a-127">These accounts do not enter the `master` database as the `dbo` user and they have limited permissions in master.</span></span> 
- <span data-ttu-id="6873a-128">Questi account non sono membri del ruolo predefinito `sysadmin` di SQL Server, che non è disponibile nel database SQL.</span><span class="sxs-lookup"><span data-stu-id="6873a-128">These accounts are not members of the standard SQL Server `sysadmin` fixed server role, which is not available in SQL database.</span></span>  
- <span data-ttu-id="6873a-129">Questi account possono creare, modificare ed eliminare database, account di accesso, utenti nel database master e regole firewall a livello di server.</span><span class="sxs-lookup"><span data-stu-id="6873a-129">These accounts can create, alter, and drop databases, logins, users in master, and server-level firewall rules.</span></span>
- <span data-ttu-id="6873a-130">Questi account possono aggiungere e rimuovere membri per i ruoli `dbmanager` e `loginmanager`.</span><span class="sxs-lookup"><span data-stu-id="6873a-130">These accounts can add and remove members to the `dbmanager` and `loginmanager` roles.</span></span>
- <span data-ttu-id="6873a-131">Questi account possono visualizzare la tabella di sistema `sys.sql_logins`.</span><span class="sxs-lookup"><span data-stu-id="6873a-131">These accounts can view the `sys.sql_logins` system table.</span></span>

### <a name="configuring-the-firewall"></a><span data-ttu-id="6873a-132">Configurazione del firewall</span><span class="sxs-lookup"><span data-stu-id="6873a-132">Configuring the firewall</span></span>
<span data-ttu-id="6873a-133">Quando è configurato un firewall a livello di server per un singolo indirizzo IP o per un intervallo di indirizzi IP, l'**amministratore del server SQL** e l'**amministratore di Azure Active Directory** possono connettersi al database master e a tutti i database utente.</span><span class="sxs-lookup"><span data-stu-id="6873a-133">When the server-level firewall is configured for an individual IP address or range, the **SQL server admin** and the **Azure Active Directory admin** can connect to the master database and all the user databases.</span></span> <span data-ttu-id="6873a-134">Il firewall iniziale a livello di server può essere configurato tramite il [portale di Azure](sql-database-get-started-portal.md), usando [PowerShell](sql-database-get-started-powershell.md) o l'[API REST](https://msdn.microsoft.com/library/azure/dn505712.aspx).</span><span class="sxs-lookup"><span data-stu-id="6873a-134">The initial server-level firewall can be configured through the [Azure portal](sql-database-get-started-portal.md), using [PowerShell](sql-database-get-started-powershell.md) or using the [REST API](https://msdn.microsoft.com/library/azure/dn505712.aspx).</span></span> <span data-ttu-id="6873a-135">Dopo che è stata stabilita una connessione, è possibile configurare anche regole aggiuntive del firewall a livello di server con l'istruzione [Transact-SQL](sql-database-configure-firewall-settings.md).</span><span class="sxs-lookup"><span data-stu-id="6873a-135">Once a connection is made, additional server-level firewall rules can also be configured by using [Transact-SQL](sql-database-configure-firewall-settings.md).</span></span>

### <a name="administrator-access-path"></a><span data-ttu-id="6873a-136">Percorso di accesso degli amministratori</span><span class="sxs-lookup"><span data-stu-id="6873a-136">Administrator access path</span></span>
<span data-ttu-id="6873a-137">Quando il firewall a livello di server è configurato correttamente, l'**amministratore del server SQL** e l'**amministratore di Azure Active Directory** possono connettersi usando strumenti client come SQL Server Management Studio o SQL Server Data Tools.</span><span class="sxs-lookup"><span data-stu-id="6873a-137">When the server-level firewall is properly configured, the **SQL server admin** and the **Azure Active Directory admin** can connect using client tools such as SQL Server Management Studio or SQL Server Data Tools.</span></span> <span data-ttu-id="6873a-138">Solo gli strumenti più recenti offrono tutte le caratteristiche e le funzionalità.</span><span class="sxs-lookup"><span data-stu-id="6873a-138">Only the latest tools provide all the features and capabilities.</span></span> <span data-ttu-id="6873a-139">Il diagramma seguente illustra una configurazione tipica per i due account amministratore.</span><span class="sxs-lookup"><span data-stu-id="6873a-139">The following diagram shows a typical configuration for the two administrator accounts.</span></span>

![Percorso di accesso degli amministratori](./media/sql-database-manage-logins/1sql-db-administrator-access.png)

<span data-ttu-id="6873a-141">Quando viene usata una porta aperta nel firewall a livello di server, gli amministratori possono connettersi a qualsiasi database SQL.</span><span class="sxs-lookup"><span data-stu-id="6873a-141">When using an open port in the server-level firewall, administrators can connect to any SQL Database.</span></span>

### <a name="connecting-to-a-database-by-using-sql-server-management-studio"></a><span data-ttu-id="6873a-142">Connettersi a un database con SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="6873a-142">Connecting to a database by using SQL Server Management Studio</span></span>
<span data-ttu-id="6873a-143">Per una procedura dettagliata sulla creazione di un server, un database, regole del firewall a livello di server e sull'uso di SQL Server Management Studio per eseguire query in un database, vedere [Introduzione ai server del database SQL di Azure, ai database e alle regole del firewall usando il portale di Azure ed SQL Server Management Studio](sql-database-get-started-portal.md).</span><span class="sxs-lookup"><span data-stu-id="6873a-143">For a walk-through of creating a server, a database, server-level firewall rules, and using SQL Server Management Studio to query a database, see [Get started with Azure SQL Database servers, databases, and firewall rules by using the Azure portal and SQL Server Management Studio](sql-database-get-started-portal.md).</span></span>

> [!IMPORTANT]
> <span data-ttu-id="6873a-144">È consigliabile usare sempre la versione più aggiornata di Management Studio per restare sincronizzati con gli aggiornamenti di Microsoft Azure e del database SQL.</span><span class="sxs-lookup"><span data-stu-id="6873a-144">It is recommended that you always use the latest version of Management Studio to remain synchronized with updates to Microsoft Azure and SQL Database.</span></span> <span data-ttu-id="6873a-145">[Aggiornare SQL Server Management Studio](https://msdn.microsoft.com/library/mt238290.aspx).</span><span class="sxs-lookup"><span data-stu-id="6873a-145">[Update SQL Server Management Studio](https://msdn.microsoft.com/library/mt238290.aspx).</span></span>


## <a name="additional-server-level-administrative-roles"></a><span data-ttu-id="6873a-146">Ruoli amministrativi aggiuntivi a livello di server</span><span class="sxs-lookup"><span data-stu-id="6873a-146">Additional server-level administrative roles</span></span>
<span data-ttu-id="6873a-147">Oltre ai ruoli amministrativi a livello di server illustrati in precedenza, il database SQL offre due ruoli amministrativi con restrizioni nel database master, a cui è possibile aggiungere account utente che concedono autorizzazioni per la creazione di database o la gestione degli accessi.</span><span class="sxs-lookup"><span data-stu-id="6873a-147">In addition to the server-level administrative roles discussed previously, SQL Database provides two restricted administrative roles in the master database to which user accounts can be added that grant permissions to either create databases or manage logins.</span></span>

### <a name="database-creators"></a><span data-ttu-id="6873a-148">Autori di database</span><span class="sxs-lookup"><span data-stu-id="6873a-148">Database creators</span></span>
<span data-ttu-id="6873a-149">Uno di questi ruoli amministrativi è il ruolo **dbmanager**.</span><span class="sxs-lookup"><span data-stu-id="6873a-149">One of these administrative roles is the **dbmanager** role.</span></span> <span data-ttu-id="6873a-150">I membri di questo ruolo possono creare nuovi database.</span><span class="sxs-lookup"><span data-stu-id="6873a-150">Members of this role can create new databases.</span></span> <span data-ttu-id="6873a-151">Per usare questo ruolo, creare un utente nel database `master` e quindi aggiungere l'utente al ruolo **dbmanager** del database.</span><span class="sxs-lookup"><span data-stu-id="6873a-151">To use this role, you create a user in the `master` database and then add the user to the **dbmanager** database role.</span></span> <span data-ttu-id="6873a-152">Per creare un database, l'utente deve essere basato su un account di accesso di SQL Server nel database master o essere un utente di database indipendente basato su un utente di Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="6873a-152">To create a database, the user must be a user based on a SQL Server login in the master database or contained database user based on an Azure Active Directory user.</span></span>

1. <span data-ttu-id="6873a-153">Connettersi al database master usando un account amministratore.</span><span class="sxs-lookup"><span data-stu-id="6873a-153">Using an administrator account, connect to the master database.</span></span>
2. <span data-ttu-id="6873a-154">Passaggio facoltativo: creare un account di accesso con autenticazione di SQL Server con l'istruzione [CREATE LOGIN](https://msdn.microsoft.com/library/ms189751.aspx) .</span><span class="sxs-lookup"><span data-stu-id="6873a-154">Optional step: Create a SQL Server authentication login, using the [CREATE LOGIN](https://msdn.microsoft.com/library/ms189751.aspx) statement.</span></span> <span data-ttu-id="6873a-155">Istruzione di esempio:</span><span class="sxs-lookup"><span data-stu-id="6873a-155">Sample statement:</span></span>
   
   ```
   CREATE LOGIN Mary WITH PASSWORD = '<strong_password>';
   ```
   
   > [!NOTE]
   > <span data-ttu-id="6873a-156">Quando si crea un account di accesso o un utente di database indipendente, usare una password complessa.</span><span class="sxs-lookup"><span data-stu-id="6873a-156">Use a strong password when creating a login or contained database user.</span></span> <span data-ttu-id="6873a-157">Per ulteriori informazioni, vedere [Password complesse](https://msdn.microsoft.com/library/ms161962.aspx).</span><span class="sxs-lookup"><span data-stu-id="6873a-157">For more information, see [Strong Passwords](https://msdn.microsoft.com/library/ms161962.aspx).</span></span>
    
   <span data-ttu-id="6873a-158">Per migliorare le prestazioni, gli account di accesso (entità a livello di server) vengono temporaneamente memorizzati nella cache a livello di database.</span><span class="sxs-lookup"><span data-stu-id="6873a-158">To improve performance, logins (server-level principals) are temporarily cached at the database level.</span></span> <span data-ttu-id="6873a-159">Per aggiornare la cache di autenticazione, vedere [DBCC FLUSHAUTHCACHE](https://msdn.microsoft.com/library/mt627793.aspx).</span><span class="sxs-lookup"><span data-stu-id="6873a-159">To refresh the authentication cache, see [DBCC FLUSHAUTHCACHE](https://msdn.microsoft.com/library/mt627793.aspx).</span></span>

3. <span data-ttu-id="6873a-160">Nel database master creare un utente con l'istruzione [CREATE USER](https://msdn.microsoft.com/library/ms173463.aspx) .</span><span class="sxs-lookup"><span data-stu-id="6873a-160">In the master database, create a user by using the [CREATE USER](https://msdn.microsoft.com/library/ms173463.aspx) statement.</span></span> <span data-ttu-id="6873a-161">L'utente può essere un utente di database indipendente con autenticazione di Azure Active Directory (se l'ambiente è stato configurato per l'autenticazione di Azure AD), un utente di database indipendente con autenticazione di SQL Server oppure un utente con autenticazione di SQL Server basato su un account di accesso con autenticazione di SQL Server (creato nel passaggio precedente). Istruzioni di esempio:</span><span class="sxs-lookup"><span data-stu-id="6873a-161">The user can be an Azure Active Directory authentication contained database user (if you have configured your environment for Azure AD authentication), or a SQL Server authentication contained database user, or a SQL Server authentication user based on a SQL Server authentication login (created in the previous step.) Sample statements:</span></span>
   
   ```
   CREATE USER [mike@contoso.com] FROM EXTERNAL PROVIDER;
   CREATE USER Tran WITH PASSWORD = '<strong_password>';
   CREATE USER Mary FROM LOGIN Mary; 
   ```

4. <span data-ttu-id="6873a-162">Aggiungere il nuovo utente al ruolo del database **dbmanager** con l'istruzione [ALTER ROLE](https://msdn.microsoft.com/library/ms189775.aspx) .</span><span class="sxs-lookup"><span data-stu-id="6873a-162">Add the new user, to the **dbmanager** database role by using the [ALTER ROLE](https://msdn.microsoft.com/library/ms189775.aspx) statement.</span></span> <span data-ttu-id="6873a-163">Istruzioni di esempio:</span><span class="sxs-lookup"><span data-stu-id="6873a-163">Sample statements:</span></span>
   
   ```
   ALTER ROLE dbmanager ADD MEMBER Mary; 
   ALTER ROLE dbmanager ADD MEMBER [mike@contoso.com];
   ```
   
   > [!NOTE]
   > <span data-ttu-id="6873a-164">Poiché dbmanager è un ruolo del database nel database master, è possibile aggiungere solo un utente di database al ruolo dbmanager.</span><span class="sxs-lookup"><span data-stu-id="6873a-164">The dbmanager is a database role in master database so you can only add a database user to the dbmanager role.</span></span> <span data-ttu-id="6873a-165">Non si può aggiungere un account di accesso a livello di server a un ruolo a livello di database.</span><span class="sxs-lookup"><span data-stu-id="6873a-165">You cannot add a server-level login to database-level role.</span></span>
    
5. <span data-ttu-id="6873a-166">Se necessario, configurare una regola firewall per consentire la connessione del nuovo utente.</span><span class="sxs-lookup"><span data-stu-id="6873a-166">If necessary, configure a firewall rule to allow the new user to connect.</span></span> <span data-ttu-id="6873a-167">Il nuovo utente può essere gestito da una regola firewall esistente.</span><span class="sxs-lookup"><span data-stu-id="6873a-167">(The new user might be covered by an existing firewall rule.)</span></span>

<span data-ttu-id="6873a-168">L'utente potrà così connettersi al database master e creare nuovi database.</span><span class="sxs-lookup"><span data-stu-id="6873a-168">Now the user can connect to the master database and can create new databases.</span></span> <span data-ttu-id="6873a-169">L'account che crea il database ne diventa il proprietario.</span><span class="sxs-lookup"><span data-stu-id="6873a-169">The account creating the database becomes the owner of the database.</span></span>

### <a name="login-managers"></a><span data-ttu-id="6873a-170">Gestione degli account di accesso</span><span class="sxs-lookup"><span data-stu-id="6873a-170">Login managers</span></span>
<span data-ttu-id="6873a-171">L'altro ruolo amministrativo è il ruolo di gestione degli account di accesso.</span><span class="sxs-lookup"><span data-stu-id="6873a-171">The other administrative role is the login manager role.</span></span> <span data-ttu-id="6873a-172">I membri di questo ruolo possono creare nuovi account di accesso nel database master.</span><span class="sxs-lookup"><span data-stu-id="6873a-172">Members of this role can create new logins in the master database.</span></span> <span data-ttu-id="6873a-173">Se si vuole, è possibile completare la stessa procedura (ovvero creare un account di accesso e aggiungere un utente al ruolo **loginmanager**) per consentire a un utente di creare nuovi account di accesso nel database master.</span><span class="sxs-lookup"><span data-stu-id="6873a-173">If you wish, you can complete the same steps (create a login and user, and add a user to the **loginmanager** role) to enable a user to create new logins in the master.</span></span> <span data-ttu-id="6873a-174">Gli account di accesso non sono generalmente necessari perché è consigliabile usare utenti di database indipendente che eseguono l'autenticazione a livello di database anziché utenti basati su account di accesso.</span><span class="sxs-lookup"><span data-stu-id="6873a-174">Usually logins are not necessary as Microsoft recommends using contained database users, which authenticate at the database-level instead of using users based on logins.</span></span> <span data-ttu-id="6873a-175">Per altre informazioni, vedere [Utenti di database indipendente: rendere portabile un database](https://msdn.microsoft.com/library/ff929188.aspx).</span><span class="sxs-lookup"><span data-stu-id="6873a-175">For more information, see [Contained Database Users - Making Your Database Portable](https://msdn.microsoft.com/library/ff929188.aspx).</span></span>

## <a name="non-administrator-users"></a><span data-ttu-id="6873a-176">Utenti non amministratori</span><span class="sxs-lookup"><span data-stu-id="6873a-176">Non-administrator users</span></span>
<span data-ttu-id="6873a-177">Per gli account non amministratore non è in genere necessario l'accesso al database master.</span><span class="sxs-lookup"><span data-stu-id="6873a-177">Generally, non-administrator accounts do not need access to the master database.</span></span> <span data-ttu-id="6873a-178">Creare utenti di database indipendente a livello di database con l'istruzione [CREATE USER (Transact-SQL)](https://msdn.microsoft.com/library/ms173463.aspx) .</span><span class="sxs-lookup"><span data-stu-id="6873a-178">Create contained database users at the database level using the [CREATE USER (Transact-SQL)](https://msdn.microsoft.com/library/ms173463.aspx) statement.</span></span> <span data-ttu-id="6873a-179">L'utente può essere un utente di database indipendente con autenticazione di Azure Active Directory (se l'ambiente è stato configurato per l'autenticazione di Azure AD), un utente di database indipendente con autenticazione di SQL Server oppure un utente con autenticazione di SQL Server basato su un account di accesso con autenticazione di SQL Server (creato nel passaggio precedente). Per altre informazioni, vedere [Utenti di database indipendente: rendere portabile un database](https://msdn.microsoft.com/library/ff929188.aspx).</span><span class="sxs-lookup"><span data-stu-id="6873a-179">The user can be an Azure Active Directory authentication contained database user (if you have configured your environment for Azure AD authentication), or a SQL Server authentication contained database user, or a SQL Server authentication user based on a SQL Server authentication login (created in the previous step.) For more information, see [Contained Database Users - Making Your Database Portable](https://msdn.microsoft.com/library/ff929188.aspx).</span></span> 

<span data-ttu-id="6873a-180">Per creare utenti, connettersi al database ed eseguire istruzioni simili ai seguenti esempi:</span><span class="sxs-lookup"><span data-stu-id="6873a-180">To create users, connect to the database, and execute statements similar to the following examples:</span></span>

```
CREATE USER Mary FROM LOGIN Mary; 
CREATE USER [mike@contoso.com] FROM EXTERNAL PROVIDER;
```

<span data-ttu-id="6873a-181">Inizialmente, solo gli amministratori o il proprietario del database possono creare utenti.</span><span class="sxs-lookup"><span data-stu-id="6873a-181">Initially, only one of the administrators or the owner of the database can create users.</span></span> <span data-ttu-id="6873a-182">Per autorizzare utenti aggiuntivi a creare nuovi utenti, concedere all'utente selezionato l'autorizzazione `ALTER ANY USER` con un'istruzione come la seguente:</span><span class="sxs-lookup"><span data-stu-id="6873a-182">To authorize additional users to create new users, grant that selected user the `ALTER ANY USER` permission, by using a statement such as:</span></span>

```
GRANT ALTER ANY USER TO Mary;
```

<span data-ttu-id="6873a-183">Per concedere a utenti aggiuntivi il controllo completo del database, rendere tali utenti membri del ruolo predefinito del database **db_owner** con l'istruzione `ALTER ROLE`.</span><span class="sxs-lookup"><span data-stu-id="6873a-183">To give additional users full control of the database, make them a member of the **db_owner** fixed database role using the `ALTER ROLE` statement.</span></span>

> [!NOTE]
> <span data-ttu-id="6873a-184">Il motivo più comune per creare utenti di database basati su account di accesso è la presenza di utenti con autenticazione di SQL Server che devono accedere a più database.</span><span class="sxs-lookup"><span data-stu-id="6873a-184">The most common reason to create database users based on logins, is when you have SQL Server authentication users that need access to multiple databases.</span></span> <span data-ttu-id="6873a-185">Gli utenti basati su account di accesso sono associati all'account di accesso, per il quale viene gestita una sola password.</span><span class="sxs-lookup"><span data-stu-id="6873a-185">Users based on logins are tied to the login, and only one password that is maintained for that login.</span></span> <span data-ttu-id="6873a-186">Gli utenti di database indipendente in singoli database sono ognuno una singola entità che gestisce una propria password.</span><span class="sxs-lookup"><span data-stu-id="6873a-186">Contained database users in individual databases are each individual entities and each maintains its own password.</span></span> <span data-ttu-id="6873a-187">Questo può creare confusione se gli utenti di database indipendente non usano password identiche.</span><span class="sxs-lookup"><span data-stu-id="6873a-187">This can confuse contained database users if they do not maintain their passwords as identical.</span></span>

### <a name="configuring-the-database-level-firewall"></a><span data-ttu-id="6873a-188">Configurazione del firewall a livello di database</span><span class="sxs-lookup"><span data-stu-id="6873a-188">Configuring the database-level firewall</span></span>
<span data-ttu-id="6873a-189">Come procedura consigliata, gli utenti non amministratori dovrebbero avere accesso tramite il firewall solo ai database usati.</span><span class="sxs-lookup"><span data-stu-id="6873a-189">As a best practice, non-administrator users should only have access through the firewall to the databases that they use.</span></span> <span data-ttu-id="6873a-190">Invece di autorizzarne gli indirizzi IP tramite il firewall a livello di server e concedere loro l'accesso a tutti i database, usare l'istruzione [sp_set_database_firewall_rule](https://msdn.microsoft.com/library/dn270010.aspx) per configurare il firewall a livello di database.</span><span class="sxs-lookup"><span data-stu-id="6873a-190">Instead of authorizing their IP addresses through the server-level firewall and giving them access to all databases, use the [sp_set_database_firewall_rule](https://msdn.microsoft.com/library/dn270010.aspx) statement to configure the database-level firewall.</span></span> <span data-ttu-id="6873a-191">Il firewall a livello di database non può essere configurato usando il portale.</span><span class="sxs-lookup"><span data-stu-id="6873a-191">The database-level firewall cannot be configured by using the portal.</span></span>

### <a name="non-administrator-access-path"></a><span data-ttu-id="6873a-192">Percorso di accesso degli utenti non amministratori</span><span class="sxs-lookup"><span data-stu-id="6873a-192">Non-administrator access path</span></span>
<span data-ttu-id="6873a-193">Quando il firewall a livello di database è configurato correttamente, gli utenti di database possono connettersi usando strumenti client come SQL Server Management Studio o SQL Server Data Tools.</span><span class="sxs-lookup"><span data-stu-id="6873a-193">When the database-level firewall is properly configured, the database users can connect using client tools such as SQL Server Management Studio or SQL Server Data Tools.</span></span> <span data-ttu-id="6873a-194">Solo gli strumenti più recenti offrono tutte le caratteristiche e le funzionalità.</span><span class="sxs-lookup"><span data-stu-id="6873a-194">Only the latest tools provide all the features and capabilities.</span></span> <span data-ttu-id="6873a-195">Il diagramma seguente illustra un percorso di accesso tipico degli utenti non amministratori.</span><span class="sxs-lookup"><span data-stu-id="6873a-195">The following diagram shows a typical non-administrator access path.</span></span>

![Percorso di accesso degli utenti non amministratori](./media/sql-database-manage-logins/2sql-db-nonadmin-access.png)

## <a name="groups-and-roles"></a><span data-ttu-id="6873a-197">Gruppi e ruoli</span><span class="sxs-lookup"><span data-stu-id="6873a-197">Groups and roles</span></span>
<span data-ttu-id="6873a-198">In una gestione efficiente degli accessi vengono usate autorizzazioni assegnate a gruppi e ruoli anziché singoli utenti.</span><span class="sxs-lookup"><span data-stu-id="6873a-198">Efficient access management uses permissions assigned to groups and roles instead of individual users.</span></span> 

- <span data-ttu-id="6873a-199">Quando si usa l'autenticazione di Azure Active Directory, inserire gli utenti di Azure Active Directory in un gruppo di Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="6873a-199">When using Azure Active Directory authentication, put Azure Active Directory users into an Azure Active Directory group.</span></span> <span data-ttu-id="6873a-200">Creare un utente di database indipendente per il gruppo.</span><span class="sxs-lookup"><span data-stu-id="6873a-200">Create a contained database user for the group.</span></span> <span data-ttu-id="6873a-201">Inserire uno o più utenti di database in un [ruolo del database](https://msdn.microsoft.com/library/ms189121) e quindi assegnare [autorizzazioni](https://msdn.microsoft.com/library/ms191291.aspx) al ruolo del database.</span><span class="sxs-lookup"><span data-stu-id="6873a-201">Place one or more database users into a [database role](https://msdn.microsoft.com/library/ms189121) and then assign [permissions](https://msdn.microsoft.com/library/ms191291.aspx) to the database role.</span></span>

- <span data-ttu-id="6873a-202">Quando si usa l'autenticazione di SQL Server, creare utenti di database indipendenti nel database.</span><span class="sxs-lookup"><span data-stu-id="6873a-202">When using SQL Server authentication, create contained database users in the database.</span></span> <span data-ttu-id="6873a-203">Inserire uno o più utenti di database in un [ruolo del database](https://msdn.microsoft.com/library/ms189121) e quindi assegnare [autorizzazioni](https://msdn.microsoft.com/library/ms191291.aspx) al ruolo del database.</span><span class="sxs-lookup"><span data-stu-id="6873a-203">Place one or more database users into a [database role](https://msdn.microsoft.com/library/ms189121) and then assign [permissions](https://msdn.microsoft.com/library/ms191291.aspx) to the database role.</span></span>

<span data-ttu-id="6873a-204">I ruoli del database possono essere ruoli predefiniti come **db_owner**, **db_ddladmin**, **db_datawriter**, **db_datareader**, **db_denydatawriter** e **db_denydatareader**.</span><span class="sxs-lookup"><span data-stu-id="6873a-204">The database roles can be the built-in roles such as **db_owner**, **db_ddladmin**, **db_datawriter**, **db_datareader**, **db_denydatawriter**, and **db_denydatareader**.</span></span> <span data-ttu-id="6873a-205">Per concedere autorizzazioni complete a un numero limitato di utenti viene usato comunemente **db_owner**.</span><span class="sxs-lookup"><span data-stu-id="6873a-205">**db_owner** is commonly used to grant full permission to only a few users.</span></span> <span data-ttu-id="6873a-206">Gli altri ruoli predefiniti del database sono utili per ottenere rapidamente un database semplice nello sviluppo, ma non sono consigliabili per la maggior parte dei database di produzione.</span><span class="sxs-lookup"><span data-stu-id="6873a-206">The other fixed database roles are useful for getting a simple database in development quickly, but are not recommended for most production databases.</span></span> <span data-ttu-id="6873a-207">Il ruolo predefinito del database **db_datareader**, ad esempio, concede l'accesso in lettura a tutte le tabelle del database, che in genere è più di quanto strettamente necessario.</span><span class="sxs-lookup"><span data-stu-id="6873a-207">For example, the **db_datareader** fixed database role grants read access to every table in the database, which is usually more than is strictly necessary.</span></span> <span data-ttu-id="6873a-208">È preferibile usare l'istruzione [CREATE ROLE](https://msdn.microsoft.com/library/ms187936.aspx) per creare ruoli del database definiti dall'utente e concedere con attenzione a ogni ruolo le autorizzazioni minime necessarie per le esigenze aziendali.</span><span class="sxs-lookup"><span data-stu-id="6873a-208">It is far better to use the [CREATE ROLE](https://msdn.microsoft.com/library/ms187936.aspx) statement to create your own user-defined database roles and carefully grant each role the least permissions necessary for the business need.</span></span> <span data-ttu-id="6873a-209">Quando un utente è membro di più ruoli, vengono aggregate le autorizzazioni di tutti.</span><span class="sxs-lookup"><span data-stu-id="6873a-209">When a user is a member of multiple roles, they aggregate the permissions of them all.</span></span>

## <a name="permissions"></a><span data-ttu-id="6873a-210">Autorizzazioni</span><span class="sxs-lookup"><span data-stu-id="6873a-210">Permissions</span></span>
<span data-ttu-id="6873a-211">Nel database SQL possono essere concesse o negate singolarmente oltre 100 autorizzazioni.</span><span class="sxs-lookup"><span data-stu-id="6873a-211">There are over 100 permissions that can be individually granted or denied in SQL Database.</span></span> <span data-ttu-id="6873a-212">Molte di queste autorizzazioni sono annidate.</span><span class="sxs-lookup"><span data-stu-id="6873a-212">Many of these permissions are nested.</span></span> <span data-ttu-id="6873a-213">L'autorizzazione `UPDATE` per uno schema, ad esempio, include l'autorizzazione `UPDATE` per ogni tabella all'interno di tale schema.</span><span class="sxs-lookup"><span data-stu-id="6873a-213">For example, the `UPDATE` permission on a schema includes the `UPDATE` permission on each table within that schema.</span></span> <span data-ttu-id="6873a-214">Come nella maggior parte dei sistemi di autorizzazioni, la negazione di un'autorizzazione determina l'override di una concessione.</span><span class="sxs-lookup"><span data-stu-id="6873a-214">As in most permission systems, the denial of a permission overrides a grant.</span></span> <span data-ttu-id="6873a-215">A causa dell'annidamento e del numero delle autorizzazioni, progettare un sistema di autorizzazioni appropriato per proteggere correttamente il database può richiedere un attento studio.</span><span class="sxs-lookup"><span data-stu-id="6873a-215">Because of the nested nature and the number of permissions, it can take careful study to design an appropriate permission system to properly protect your database.</span></span> <span data-ttu-id="6873a-216">Per iniziare, vedere l'elenco di autorizzazioni in [Autorizzazioni (Motore di database)](https://msdn.microsoft.com/library/ms191291.aspx) e la [grafica in formato di poster](http://go.microsoft.com/fwlink/?LinkId=229142) relativa alle autorizzazioni.</span><span class="sxs-lookup"><span data-stu-id="6873a-216">Start with the list of permissions at [Permissions (Database Engine)](https://msdn.microsoft.com/library/ms191291.aspx) and review the [poster size graphic](http://go.microsoft.com/fwlink/?LinkId=229142) of the permissions.</span></span>


### <a name="considerations-and-restrictions"></a><span data-ttu-id="6873a-217">Considerazioni e restrizioni</span><span class="sxs-lookup"><span data-stu-id="6873a-217">Considerations and restrictions</span></span>
<span data-ttu-id="6873a-218">Quando si gestiscono gli accessi e gli utenti nel database SQL, prendere in considerazione quanto segue:</span><span class="sxs-lookup"><span data-stu-id="6873a-218">When managing logins and users in SQL Database, consider the following:</span></span>

* <span data-ttu-id="6873a-219">È necessario essere connessi al database **master** durante l'esecuzione delle istruzioni `CREATE/ALTER/DROP DATABASE`.</span><span class="sxs-lookup"><span data-stu-id="6873a-219">You must be connected to the **master** database when executing the `CREATE/ALTER/DROP DATABASE` statements.</span></span>   
* <span data-ttu-id="6873a-220">L'utente corrispondente all'account di accesso **Amministratore del server** non può essere modificato o eliminato.</span><span class="sxs-lookup"><span data-stu-id="6873a-220">The database user corresponding to the **Server admin** login cannot be altered or dropped.</span></span> 
* <span data-ttu-id="6873a-221">L'inglese americano è la lingua predefinita dell'account di accesso **Amministratore del server**.</span><span class="sxs-lookup"><span data-stu-id="6873a-221">US-English is the default language of the **Server admin** login.</span></span>
* <span data-ttu-id="6873a-222">Soltanto gli amministratori (**amministratore del server** o amministratore di Azure AD) e i membri del ruolo di database **dbmanager** nel database **master** sono autorizzati a eseguire le istruzioni `CREATE DATABASE` e `DROP DATABASE`.</span><span class="sxs-lookup"><span data-stu-id="6873a-222">Only the administrators (**Server admin** login or Azure AD administrator) and the members of the **dbmanager** database role in the **master** database have permission to execute the `CREATE DATABASE` and `DROP DATABASE` statements.</span></span>
* <span data-ttu-id="6873a-223">È necessario essere connessi al database master durante l'esecuzione delle istruzioni `CREATE/ALTER/DROP LOGIN` .</span><span class="sxs-lookup"><span data-stu-id="6873a-223">You must be connected to the master database when executing the `CREATE/ALTER/DROP LOGIN` statements.</span></span> <span data-ttu-id="6873a-224">È tuttavia sconsigliato l'uso di account di accesso.</span><span class="sxs-lookup"><span data-stu-id="6873a-224">However using logins is discouraged.</span></span> <span data-ttu-id="6873a-225">Usare invece gli utenti del database indipendente.</span><span class="sxs-lookup"><span data-stu-id="6873a-225">Use contained database users instead.</span></span>
* <span data-ttu-id="6873a-226">Per connettersi a un database utente è necessario specificare il nome del database nella stringa di connessione.</span><span class="sxs-lookup"><span data-stu-id="6873a-226">To connect to a user database, you must provide the name of the database in the connection string.</span></span>
* <span data-ttu-id="6873a-227">Soltanto gli utenti con accesso dell’entità di livello server e i membri del ruolo del database **loginmanager** nel database **master** sono autorizzati a eseguire le istruzioni `CREATE LOGIN`, `ALTER LOGIN` e `DROP LOGIN`.</span><span class="sxs-lookup"><span data-stu-id="6873a-227">Only the server-level principal login and the members of the **loginmanager** database role in the **master** database have permission to execute the `CREATE LOGIN`, `ALTER LOGIN`, and `DROP LOGIN` statements.</span></span>
* <span data-ttu-id="6873a-228">Quando si esegue le istruzioni `CREATE/ALTER/DROP LOGIN` e `CREATE/ALTER/DROP DATABASE` in un'applicazione ADO.NET, non è consentito utilizzare i comandi con parametri.</span><span class="sxs-lookup"><span data-stu-id="6873a-228">When executing the `CREATE/ALTER/DROP LOGIN` and `CREATE/ALTER/DROP DATABASE` statements in an ADO.NET application, using parameterized commands is not allowed.</span></span> <span data-ttu-id="6873a-229">Per ulteriori informazioni, vedere [Comandi e parametri](https://msdn.microsoft.com/library/ms254953.aspx).</span><span class="sxs-lookup"><span data-stu-id="6873a-229">For more information, see [Commands and Parameters](https://msdn.microsoft.com/library/ms254953.aspx).</span></span>
* <span data-ttu-id="6873a-230">Quando si esegue le istruzioni `CREATE/ALTER/DROP DATABASE` e `CREATE/ALTER/DROP LOGIN`, ognuna di queste istruzioni deve essere l'unica istruzione in un batch Transact-SQL.</span><span class="sxs-lookup"><span data-stu-id="6873a-230">When executing the `CREATE/ALTER/DROP DATABASE` and `CREATE/ALTER/DROP LOGIN` statements, each of these statements must be the only statement in a Transact-SQL batch.</span></span> <span data-ttu-id="6873a-231">In caso contrario, si verifica un errore.</span><span class="sxs-lookup"><span data-stu-id="6873a-231">Otherwise, an error occurs.</span></span> <span data-ttu-id="6873a-232">Ad esempio, il seguente Transact-SQL controlla se il database esiste.</span><span class="sxs-lookup"><span data-stu-id="6873a-232">For example, the following Transact-SQL checks whether the database exists.</span></span> <span data-ttu-id="6873a-233">Se esiste, un’istruzione `DROP DATABASE` viene chiamata per rimuovere il database.</span><span class="sxs-lookup"><span data-stu-id="6873a-233">If it exists, a `DROP DATABASE` statement is called to remove the database.</span></span> <span data-ttu-id="6873a-234">Poiché l’istruzione `DROP DATABASE` non è l'unica istruzione nel batch, l'esecuzione della seguente istruzione Transact-SQL genera un errore.</span><span class="sxs-lookup"><span data-stu-id="6873a-234">Because the `DROP DATABASE` statement is not the only statement in the batch, executing the following Transact-SQL statement results in an error.</span></span>

  ```
  IF EXISTS (SELECT [name]
           FROM   [sys].[databases]
           WHERE  [name] = N'database_name')
  DROP DATABASE [database_name];
  GO
  ```

* <span data-ttu-id="6873a-235">Quando si esegue l’istruzione `CREATE USER` con l’opzione `FOR/FROM LOGIN`, l’istruzione deve essere l'unica in un batch Transact-SQL.</span><span class="sxs-lookup"><span data-stu-id="6873a-235">When executing the `CREATE USER` statement with the `FOR/FROM LOGIN` option, it must be the only statement in a Transact-SQL batch.</span></span>
* <span data-ttu-id="6873a-236">Quando si esegue l’istruzione `ALTER USER` con l’opzione `WITH LOGIN`, l’istruzione deve essere l'unica in un batch Transact-SQL.</span><span class="sxs-lookup"><span data-stu-id="6873a-236">When executing the `ALTER USER` statement with the `WITH LOGIN` option, it must be the only statement in a Transact-SQL batch.</span></span>
* <span data-ttu-id="6873a-237">Per `CREATE/ALTER/DROP` un utente richiede l’autorizzazione `ALTER ANY USER` per il database.</span><span class="sxs-lookup"><span data-stu-id="6873a-237">To `CREATE/ALTER/DROP` a user requires the `ALTER ANY USER` permission on the database.</span></span>
* <span data-ttu-id="6873a-238">Quando il proprietario di un ruolo del database tenta di aggiungere o rimuovere un altro utente del database in o da tale ruolo del database, potrebbe verificarsi il seguente errore: **L’utente o il ruolo 'Name' non esiste nel database.**</span><span class="sxs-lookup"><span data-stu-id="6873a-238">When the owner of a database role tries to add or remove another database user to or from that database role, the following error may occur: **User or role 'Name' does not exist in this database.**</span></span> <span data-ttu-id="6873a-239">Questo errore si verifica perché l'utente non è visibile al proprietario.</span><span class="sxs-lookup"><span data-stu-id="6873a-239">This error occurs because the user is not visible to the owner.</span></span> <span data-ttu-id="6873a-240">Per risolvere questo problema, concedere al proprietario del ruolo l’autorizzazione `VIEW DEFINITION` per l'utente.</span><span class="sxs-lookup"><span data-stu-id="6873a-240">To resolve this issue, grant the role owner the `VIEW DEFINITION` permission on the user.</span></span> 


## <a name="next-steps"></a><span data-ttu-id="6873a-241">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="6873a-241">Next steps</span></span>

- <span data-ttu-id="6873a-242">Per altre informazioni sulle regole del firewall, vedere l'articolo sul [firewall del database SQL di Azure](sql-database-firewall-configure.md).</span><span class="sxs-lookup"><span data-stu-id="6873a-242">To learn more about firewall rules, see [Azure SQL Database Firewall](sql-database-firewall-configure.md).</span></span>
- <span data-ttu-id="6873a-243">Per una panoramica di tutte le funzionalità di sicurezza del database SQL, vedere la [panoramica della sicurezza in SQL](sql-database-security-overview.md).</span><span class="sxs-lookup"><span data-stu-id="6873a-243">For an overview of all the SQL Database security features, see [SQL security overview](sql-database-security-overview.md).</span></span>
- <span data-ttu-id="6873a-244">Per un'esercitazione, vedere [Proteggere il database SQL di Azure](sql-database-security-tutorial.md).</span><span class="sxs-lookup"><span data-stu-id="6873a-244">For a tutorial, see [Secure your Azure SQL Database](sql-database-security-tutorial.md).</span></span>
- <span data-ttu-id="6873a-245">Per informazioni sulle viste e sulle stored procedure, vedere [Creazione di viste e stored procedure](https://msdn.microsoft.com/library/ms365311.aspx)</span><span class="sxs-lookup"><span data-stu-id="6873a-245">For information about views and stored procedures, see [Creating views and stored procedures](https://msdn.microsoft.com/library/ms365311.aspx)</span></span>
- <span data-ttu-id="6873a-246">Per informazioni sulla concessione di accesso a un oggetto di database, vedere [Concessione dell'accesso a un oggetto di database](https://msdn.microsoft.com/library/ms365327.aspx)</span><span class="sxs-lookup"><span data-stu-id="6873a-246">For information about granting access to a database object, see [Granting Access to a Database Object](https://msdn.microsoft.com/library/ms365327.aspx)</span></span>
