---
title: aaaPlanning l'infrastruttura di backup di VM in Azure | Documenti Microsoft
description: Importanti considerazioni relative alla pianificazione di tooback backup di macchine virtuali in Azure
services: backup
documentationcenter: 
author: markgalioto
manager: carmonm
editor: 
keywords: backup di vm, backup di macchine virtuali
ms.assetid: 19d2cf82-1f60-43e1-b089-9238042887a9
ms.service: backup
ms.workload: storage-backup-recovery
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 7/18/2017
ms.author: markgal;trinadhk
ms.openlocfilehash: d11982431610000293038ee6aa7df8e7bc2d8b70
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/06/2017
---
# <a name="plan-your-vm-backup-infrastructure-in-azure"></a><span data-ttu-id="b6a03-104">Pianificare l'infrastruttura di backup delle VM in Azure</span><span class="sxs-lookup"><span data-stu-id="b6a03-104">Plan your VM backup infrastructure in Azure</span></span>
<span data-ttu-id="b6a03-105">In questo articolo fornisce prestazioni e risorsa suggerimenti toohelp si pianifica l'infrastruttura di backup di VM.</span><span class="sxs-lookup"><span data-stu-id="b6a03-105">This article provides performance and resource suggestions toohelp you plan your VM backup infrastructure.</span></span> <span data-ttu-id="b6a03-106">Definisce inoltre gli aspetti chiave del servizio di Backup hello. questi aspetti possono essere fondamentali nella determinazione dell'architettura, la pianificazione della capacità e la pianificazione.</span><span class="sxs-lookup"><span data-stu-id="b6a03-106">It also defines key aspects of hello Backup service; these aspects can be critical in determining your architecture, capacity planning, and scheduling.</span></span> <span data-ttu-id="b6a03-107">Se è stata [preparato l'ambiente](backup-azure-vms-prepare.md), la pianificazione è successivo hello prima di iniziare [tooback le VM](backup-azure-vms.md).</span><span class="sxs-lookup"><span data-stu-id="b6a03-107">If you've [prepared your environment](backup-azure-vms-prepare.md), planning is hello next step before you begin [tooback up VMs](backup-azure-vms.md).</span></span> <span data-ttu-id="b6a03-108">Se sono necessarie ulteriori informazioni sulle macchine virtuali di Azure, vedere hello [macchine virtuali-documentazione](https://azure.microsoft.com/documentation/services/virtual-machines/).</span><span class="sxs-lookup"><span data-stu-id="b6a03-108">If you need more information about Azure virtual machines, see hello [Virtual Machines documentation](https://azure.microsoft.com/documentation/services/virtual-machines/).</span></span>

## <a name="how-does-azure-back-up-virtual-machines"></a><span data-ttu-id="b6a03-109">In che modo Azure esegue il backup delle macchine virtuali?</span><span class="sxs-lookup"><span data-stu-id="b6a03-109">How does Azure back up virtual machines?</span></span>
<span data-ttu-id="b6a03-110">Quando hello servizio Backup di Azure avvia un processo di backup in fase di hello pianificata, attiva hello estensione backup tootake uno snapshot del punto nel tempo.</span><span class="sxs-lookup"><span data-stu-id="b6a03-110">When hello Azure Backup service initiates a backup job at hello scheduled time, it triggers hello backup extension tootake a point-in-time snapshot.</span></span> <span data-ttu-id="b6a03-111">Hello servizio Azure Backup utilizza hello _VMSnapshot_ estensione in Windows e hello _VMSnapshotLinux_ estensione in Linux.</span><span class="sxs-lookup"><span data-stu-id="b6a03-111">hello Azure Backup service uses hello _VMSnapshot_ extension in Windows, and hello _VMSnapshotLinux_ extension in Linux.</span></span> <span data-ttu-id="b6a03-112">estensione Hello viene installato durante il backup di VM prima hello.</span><span class="sxs-lookup"><span data-stu-id="b6a03-112">hello extension is installed during hello first VM backup.</span></span> <span data-ttu-id="b6a03-113">estensione di hello tooinstall, hello VM deve essere in esecuzione.</span><span class="sxs-lookup"><span data-stu-id="b6a03-113">tooinstall hello extension, hello VM must be running.</span></span> <span data-ttu-id="b6a03-114">Se hello VM non è in esecuzione, il servizio di Backup hello crea uno snapshot di hello archiviazione sottostante (poiché non scritte dall'applicazione si verificano durante hello che macchina virtuale è stato arrestato).</span><span class="sxs-lookup"><span data-stu-id="b6a03-114">If hello VM is not running, hello Backup service takes a snapshot of hello underlying storage (since no application writes occur while hello VM is stopped).</span></span>

<span data-ttu-id="b6a03-115">Quando si acquisisce uno snapshot delle macchine virtuali di Windows, il servizio di Backup hello interagisce con hello del servizio Copia Shadow del Volume (VSS) tooget uno snapshot coerenza dei dischi della macchina virtuale hello.</span><span class="sxs-lookup"><span data-stu-id="b6a03-115">When taking a snapshot of Windows VMs, hello Backup service coordinates with hello Volume Shadow Copy Service (VSS) tooget a consistent snapshot of hello virtual machine's disks.</span></span> <span data-ttu-id="b6a03-116">Se esegue il backup di macchine virtuali Linux, è possibile scrivere la propria coerenza tooensure script personalizzati quando si acquisisce uno snapshot macchina virtuale.</span><span class="sxs-lookup"><span data-stu-id="b6a03-116">If you're backing up Linux VMs, you can write your own custom scripts tooensure consistency when taking a VM snapshot.</span></span> <span data-ttu-id="b6a03-117">Dettagli su come richiamare gli script sono forniti più avanti in questo articolo.</span><span class="sxs-lookup"><span data-stu-id="b6a03-117">Details on invoking these scripts are provided later in this article.</span></span>

<span data-ttu-id="b6a03-118">Una volta hello servizio Azure Backup istantanea hello, dati hello sono toohello trasferite insieme di credenziali.</span><span class="sxs-lookup"><span data-stu-id="b6a03-118">Once hello Azure Backup service takes hello snapshot, hello data is transferred toohello vault.</span></span> <span data-ttu-id="b6a03-119">l'efficienza toomaximize servizio hello identifica e i trasferimenti di dati che sono stati modificati dal backup precedente hello solo i blocchi hello.</span><span class="sxs-lookup"><span data-stu-id="b6a03-119">toomaximize efficiency, hello service identifies and transfers only hello blocks of data that have changed since hello previous backup.</span></span>

![Architettura del backup delle macchine virtuali di Azure](./media/backup-azure-vms-introduction/vmbackup-architecture.png)

<span data-ttu-id="b6a03-121">Una volta completato il trasferimento dei dati di hello, snapshot hello viene rimosso e viene creato un punto di ripristino.</span><span class="sxs-lookup"><span data-stu-id="b6a03-121">When hello data transfer is complete, hello snapshot is removed and a recovery point is created.</span></span>

> [!NOTE]
> 1. <span data-ttu-id="b6a03-122">Durante il processo di backup hello Azure Backup non include macchina virtuale toohello di hello disco temporaneo associato.</span><span class="sxs-lookup"><span data-stu-id="b6a03-122">During hello backup process, Azure Backup doesn't include hello temporary disk attached toohello virtual machine.</span></span> <span data-ttu-id="b6a03-123">Per ulteriori informazioni, vedere il blog di hello in [archiviazione temporanea](https://blogs.msdn.microsoft.com/mast/2013/12/06/understanding-the-temporary-drive-on-windows-azure-virtual-machines/).</span><span class="sxs-lookup"><span data-stu-id="b6a03-123">For more information, see hello blog on [temporary storage](https://blogs.msdn.microsoft.com/mast/2013/12/06/understanding-the-temporary-drive-on-windows-azure-virtual-machines/).</span></span>
> 2. <span data-ttu-id="b6a03-124">Poiché Azure Backup ha uno snapshot a livello di archiviazione e trasferimento di snapshot toovault, non modificare chiavi dell'account di archiviazione hello fino al completamento del processo di backup hello.</span><span class="sxs-lookup"><span data-stu-id="b6a03-124">Since Azure Backup takes a storage-level snapshot and transfers that snapshot toovault, do not change hello storage account keys until hello backup job finishes.</span></span>
> 3. <span data-ttu-id="b6a03-125">Per le macchine virtuali premium, copiamo account toostorage di hello snapshot.</span><span class="sxs-lookup"><span data-stu-id="b6a03-125">For premium VMs, we copy hello snapshot toostorage account.</span></span> <span data-ttu-id="b6a03-126">Si tratta di verificare che il servizio di Backup di Azure Ottiene IOPS sufficienti per il trasferimento di dati toovault toomake.</span><span class="sxs-lookup"><span data-stu-id="b6a03-126">This is toomake sure that Azure Backup service gets sufficient IOPS for transferring data toovault.</span></span> <span data-ttu-id="b6a03-127">Questa copia aggiuntiva dell'archiviazione viene addebitata in base alle hello VM dimensione allocata.</span><span class="sxs-lookup"><span data-stu-id="b6a03-127">This additional copy of storage is charged as per hello VM allocated size.</span></span> 
>

### <a name="data-consistency"></a><span data-ttu-id="b6a03-128">Coerenza dei dati</span><span class="sxs-lookup"><span data-stu-id="b6a03-128">Data consistency</span></span>
<span data-ttu-id="b6a03-129">Backup e ripristino dei dati aziendali critici è complicata dal fatto di hello che dati aziendali critici devono eseguire il backup durante le applicazioni di hello che producono hello dati sono in esecuzione.</span><span class="sxs-lookup"><span data-stu-id="b6a03-129">Backing up and restoring business critical data is complicated by hello fact that business critical data must be backed up while hello applications that produce hello data are running.</span></span> <span data-ttu-id="b6a03-130">tooaddress, Backup di Azure supporta i backup coerenti con l'applicazione per Windows e le macchine virtuali Linux</span><span class="sxs-lookup"><span data-stu-id="b6a03-130">tooaddress this, Azure Backup supports application-consistent backups for both Windows and Linux VMs</span></span>
#### <a name="windows-vm"></a><span data-ttu-id="b6a03-131">Macchina virtuale Windows</span><span class="sxs-lookup"><span data-stu-id="b6a03-131">Windows VM</span></span>
<span data-ttu-id="b6a03-132">Backup di Azure esegue backup VSS completi nelle macchine virtuali di Windows (altre informazioni su [backup VSS completi](http://blogs.technet.com/b/filecab/archive/2008/05/21/what-is-the-difference-between-vss-full-backup-and-vss-copy-backup-in-windows-server-2008.aspx)).</span><span class="sxs-lookup"><span data-stu-id="b6a03-132">Azure Backup takes VSS full backups on Windows VMs (read more about [VSS full backup](http://blogs.technet.com/b/filecab/archive/2008/05/21/what-is-the-difference-between-vss-full-backup-and-vss-copy-backup-in-windows-server-2008.aspx)).</span></span> <span data-ttu-id="b6a03-133">tooenable VSS i backup di copia, seguire i set di toobe esigenze chiave del Registro di sistema di hello VM hello.</span><span class="sxs-lookup"><span data-stu-id="b6a03-133">tooenable VSS copy backups, hello following registry key needs toobe set on hello VM.</span></span>

```
[HKEY_LOCAL_MACHINE\SOFTWARE\MICROSOFT\BCDRAGENT]
"USEVSSCOPYBACKUP"="TRUE"
```

#### <a name="linux-vms"></a><span data-ttu-id="b6a03-134">Macchine virtuali di Linux</span><span class="sxs-lookup"><span data-stu-id="b6a03-134">Linux VMs</span></span>
<span data-ttu-id="b6a03-135">Backup di Azure fornisce un framework di scripting.</span><span class="sxs-lookup"><span data-stu-id="b6a03-135">Azure Backup provides a scripting framework.</span></span> <span data-ttu-id="b6a03-136">la coerenza delle applicazioni tooensure durante il backup di macchine virtuali Linux, creare pre- script personalizzati di e post script che controllano il flusso di lavoro backup hello e ambiente.</span><span class="sxs-lookup"><span data-stu-id="b6a03-136">tooensure application consistency when backing up Linux VMs, create custom pre-scripts and post-scripts that control hello backup workflow and environment.</span></span> <span data-ttu-id="b6a03-137">Backup di Azure richiama pre-script di hello prima di creare snapshot VM hello e richiama post-script hello termine del processo di snapshot VM hello.</span><span class="sxs-lookup"><span data-stu-id="b6a03-137">Azure Backup invokes hello pre-script before taking hello VM snapshot and invokes hello post-script once hello VM snapshot job completes.</span></span> <span data-ttu-id="b6a03-138">Per altri dettagli, vedere l'articolo relativo a [backup di macchine con coerenza delle applicazioni usando script di pre-backup e di post-backup](https://docs.microsoft.com/azure/backup/backup-azure-linux-app-consistent).</span><span class="sxs-lookup"><span data-stu-id="b6a03-138">For more details, see [application consistent VM backups using pre-script and post-script](https://docs.microsoft.com/azure/backup/backup-azure-linux-app-consistent).</span></span>
> [!NOTE]
> <span data-ttu-id="b6a03-139">Backup di Azure solo richiama hello scritto cliente pre- e post script.</span><span class="sxs-lookup"><span data-stu-id="b6a03-139">Azure Backup only invokes hello customer-written pre- and post-scripts.</span></span> <span data-ttu-id="b6a03-140">Se gli post- script di e pre-script di hello eseguito correttamente, Backup di Azure contrassegna il punto di ripristino hello come applicazione coerente.</span><span class="sxs-lookup"><span data-stu-id="b6a03-140">If hello pre-script and post-scripts execute successfully, Azure Backup marks hello recovery point as application consistent.</span></span> <span data-ttu-id="b6a03-141">Tuttavia, hello cliente è responsabile della coerenza con l'applicazione hello quando si utilizzano script personalizzati.</span><span class="sxs-lookup"><span data-stu-id="b6a03-141">However, hello customer is ultimately responsible for hello application consistency when using custom scripts.</span></span>
>


<span data-ttu-id="b6a03-142">Questa tabella vengono illustrati tipi di hello di coerenza e hello condizioni che si verificano in durante il backup di macchina virtuale di Azure e procedure di ripristino.</span><span class="sxs-lookup"><span data-stu-id="b6a03-142">This table explains hello types of consistency and hello conditions that they occur under during Azure VM backup and restore procedures.</span></span>

| <span data-ttu-id="b6a03-143">Coerenza</span><span class="sxs-lookup"><span data-stu-id="b6a03-143">Consistency</span></span> | <span data-ttu-id="b6a03-144">Basato su VSS</span><span class="sxs-lookup"><span data-stu-id="b6a03-144">VSS-based</span></span> | <span data-ttu-id="b6a03-145">Spiegazione e dettagli</span><span class="sxs-lookup"><span data-stu-id="b6a03-145">Explanation and details</span></span> |
| --- | --- | --- |
| <span data-ttu-id="b6a03-146">Coerenza con l'applicazione</span><span class="sxs-lookup"><span data-stu-id="b6a03-146">Application consistency</span></span> |<span data-ttu-id="b6a03-147">Sì per Windows</span><span class="sxs-lookup"><span data-stu-id="b6a03-147">Yes for Windows</span></span>|<span data-ttu-id="b6a03-148">La coerenza dell'applicazione è ideale per i carichi di lavoro perché garantisce:</span><span class="sxs-lookup"><span data-stu-id="b6a03-148">Application consistency is ideal for workloads as it ensures that:</span></span><ol><li> <span data-ttu-id="b6a03-149">Hello VM *avvio*.</span><span class="sxs-lookup"><span data-stu-id="b6a03-149">hello VM *boots up*.</span></span> <li><span data-ttu-id="b6a03-150">L' *assenza di qualsiasi danneggiamento*.</span><span class="sxs-lookup"><span data-stu-id="b6a03-150">There is *no corruption*.</span></span> <li><span data-ttu-id="b6a03-151">L'*assenza di perdite di dati*.</span><span class="sxs-lookup"><span data-stu-id="b6a03-151">There is *no data loss*.</span></span><li> <span data-ttu-id="b6a03-152">dati Hello sono coerente toohello applicazione che utilizza dati hello, che include un'applicazione hello in fase di hello del backup, utilizzando uno script pre o post-backup o di VSS.</span><span class="sxs-lookup"><span data-stu-id="b6a03-152">hello data is consistent toohello application that uses hello data, by involving hello application at hello time of backup--using VSS or pre/post script.</span></span></ol> <li><span data-ttu-id="b6a03-153">*Macchine virtuali Windows*-carichi di lavoro di Microsoft più con il writer VSS che eseguono azioni specifiche di un carico di lavoro correlati toodata coerenza.</span><span class="sxs-lookup"><span data-stu-id="b6a03-153">*Windows VMs*- Most Microsoft workloads have VSS writers that do workload-specific actions related toodata consistency.</span></span> <span data-ttu-id="b6a03-154">Ad esempio, Microsoft SQL Server ha un VSS writer che assicura che i file di log delle transazioni toohello scritture hello e database hello vengono eseguite correttamente.</span><span class="sxs-lookup"><span data-stu-id="b6a03-154">For example, Microsoft SQL Server has a VSS writer that ensures that hello writes toohello transaction log file and hello database are done correctly.</span></span> <span data-ttu-id="b6a03-155">Per i backup di macchina virtuale Windows Azure, un punto di ripristino coerenti con l'applicazione, toocreate estensione backup hello deve richiamare hello VSS flusso di lavoro e completarla prima di creare snapshot VM hello.</span><span class="sxs-lookup"><span data-stu-id="b6a03-155">For Azure Windows VM backups, toocreate an application-consistent recovery point, hello backup extension must invoke hello VSS workflow and complete it before taking hello VM snapshot.</span></span> <span data-ttu-id="b6a03-156">Per hello Azure VM snapshot toobe accurato, il writer VSS hello di tutte le applicazioni Azure VM deve essere completata anche.</span><span class="sxs-lookup"><span data-stu-id="b6a03-156">For hello Azure VM snapshot toobe accurate, hello VSS writers of all Azure VM applications must complete as well.</span></span> <span data-ttu-id="b6a03-157">(Ulteriori hello [nozioni di base di VSS](http://blogs.technet.com/b/josebda/archive/2007/10/10/the-basics-of-the-volume-shadow-copy-service-vss.aspx) e approfondimenti dettagli hello di [funzionamento](https://technet.microsoft.com/library/cc785914%28v=ws.10%29.aspx)).</span><span class="sxs-lookup"><span data-stu-id="b6a03-157">(Learn hello [basics of VSS](http://blogs.technet.com/b/josebda/archive/2007/10/10/the-basics-of-the-volume-shadow-copy-service-vss.aspx) and dive deep into hello details of [how it works](https://technet.microsoft.com/library/cc785914%28v=ws.10%29.aspx)).</span></span> </li> <li> <span data-ttu-id="b6a03-158">*Le macchine virtuali Linux*-i clienti possono eseguire [la coerenza delle applicazioni personalizzata tooensure pre- script di e post-](https://docs.microsoft.com/azure/backup/backup-azure-linux-app-consistent).</span><span class="sxs-lookup"><span data-stu-id="b6a03-158">*Linux VMs*- Customers can execute [custom pre-script and post-script tooensure application consistency](https://docs.microsoft.com/azure/backup/backup-azure-linux-app-consistent).</span></span> </li> |
| <span data-ttu-id="b6a03-159">Coerenza del file system</span><span class="sxs-lookup"><span data-stu-id="b6a03-159">File-system consistency</span></span> |<span data-ttu-id="b6a03-160">Sì, per i computer basati su Windows</span><span class="sxs-lookup"><span data-stu-id="b6a03-160">Yes - for Windows-based computers</span></span> |<span data-ttu-id="b6a03-161">Esistono due scenari in cui può essere il punto di ripristino hello *coerente del file system*:</span><span class="sxs-lookup"><span data-stu-id="b6a03-161">There are two scenarios where hello recovery point can be *file-system consistent*:</span></span><ul><li><span data-ttu-id="b6a03-162">Backup di macchine virtuali Linux in Azure, senza script di pre-/post-backup o se lo script di pre-/post-backup non è stato eseguito correttamente.</span><span class="sxs-lookup"><span data-stu-id="b6a03-162">Backups of Linux VMs in Azure, without pre-script/post-script or if pre-script/post-script failed.</span></span> <li><span data-ttu-id="b6a03-163">Errore VSS durante il backup di macchine virtuali di Windows in Azure.</span><span class="sxs-lookup"><span data-stu-id="b6a03-163">VSS failure during backup for Windows VMs in Azure.</span></span></li></ul> <span data-ttu-id="b6a03-164">In entrambi i casi, hello migliore che può essere eseguita è tooensure che:</span><span class="sxs-lookup"><span data-stu-id="b6a03-164">In both these cases, hello best that can be done is tooensure that:</span></span> <ol><li> <span data-ttu-id="b6a03-165">Hello VM *avvio*.</span><span class="sxs-lookup"><span data-stu-id="b6a03-165">hello VM *boots up*.</span></span> <li><span data-ttu-id="b6a03-166">L' *assenza di qualsiasi danneggiamento*.</span><span class="sxs-lookup"><span data-stu-id="b6a03-166">There is *no corruption*.</span></span><li><span data-ttu-id="b6a03-167">L'*assenza di perdite di dati*.</span><span class="sxs-lookup"><span data-stu-id="b6a03-167">There is *no data loss*.</span></span></ol> <span data-ttu-id="b6a03-168">Le applicazioni devono meccanismo tooimplement i propri "correzione" dati hello ripristinato.</span><span class="sxs-lookup"><span data-stu-id="b6a03-168">Applications need tooimplement their own "fix-up" mechanism on hello restored data.</span></span> |
| <span data-ttu-id="b6a03-169">Coerenza dei dati</span><span class="sxs-lookup"><span data-stu-id="b6a03-169">Crash consistency</span></span> |<span data-ttu-id="b6a03-170">No</span><span class="sxs-lookup"><span data-stu-id="b6a03-170">No</span></span> |<span data-ttu-id="b6a03-171">Questa situazione è una macchina virtuale tooa equivalente segnalano un "blocco" (tramite reset software o hardware).</span><span class="sxs-lookup"><span data-stu-id="b6a03-171">This situation is equivalent tooa virtual machine experiencing a "crash" (through either a soft or hard reset).</span></span> <span data-ttu-id="b6a03-172">La coerenza di arresto anomalo del sistema accade solitamente quando hello macchina virtuale di Azure viene arrestato al momento di hello del backup.</span><span class="sxs-lookup"><span data-stu-id="b6a03-172">Crash consistency typically happens when hello Azure virtual machine is shut down at hello time of backup.</span></span> <span data-ttu-id="b6a03-173">Un punto di ripristino coerenti con l'arresto anomalo del sistema non fornisce alcuna garanzia di coerenza hello dei dati di hello intorno a sul supporto di archiviazione - hello dalla prospettiva di hello del sistema operativo hello o un'applicazione hello.</span><span class="sxs-lookup"><span data-stu-id="b6a03-173">A crash-consistent recovery point provides no guarantees around hello consistency of hello data on hello storage medium--either from hello perspective of hello operating system or hello application.</span></span> <span data-ttu-id="b6a03-174">Solo i dati hello esistono già in fase di hello del backup su disco hello acquisiti e il backup.</span><span class="sxs-lookup"><span data-stu-id="b6a03-174">Only hello data that already exists on hello disk at hello time of backup is captured and backed up.</span></span> <br/> <br/> <span data-ttu-id="b6a03-175">Avvio del sistema operativo, seguito dal controllo del disco di hello mentre non esistono garanzie di alcun tipo, in genere, procedure, come chkdsk, toofix eventuali errori di danneggiamento.</span><span class="sxs-lookup"><span data-stu-id="b6a03-175">While there are no guarantees, usually, hello operating system boots, followed by disk-checking procedure, like chkdsk, toofix any corruption errors.</span></span> <span data-ttu-id="b6a03-176">Tutti i dati in memoria e scrive che non sono stati trasferiti toohello disco vengono perse.</span><span class="sxs-lookup"><span data-stu-id="b6a03-176">Any in-memory data or writes that have not been transferred toohello disk are lost.</span></span> <span data-ttu-id="b6a03-177">un'applicazione Hello segue in genere con un proprio meccanismo di verifica nel caso in cui il rollback di dati deve toobe eseguita.</span><span class="sxs-lookup"><span data-stu-id="b6a03-177">hello application typically follows with its own verification mechanism in case data rollback needs toobe done.</span></span> <br><br><span data-ttu-id="b6a03-178">Ad esempio, se il log delle transazioni hello dispone di voci che non sono presenti nel database di hello, quindi hello database software esegue un'operazione di rollback fino a quando non sono coerenti dati hello.</span><span class="sxs-lookup"><span data-stu-id="b6a03-178">As an example, if hello transaction log has entries that are not present in hello database, then hello database software does a rollback until hello data is consistent.</span></span> <span data-ttu-id="b6a03-179">Quando i dati viene distribuiti tra più dischi virtuali (ad esempio i volumi con spanning), un punto di ripristino coerenti con l'arresto anomalo del sistema non fornisce alcuna garanzia di correttezza hello dei dati di hello.</span><span class="sxs-lookup"><span data-stu-id="b6a03-179">When data is spread across multiple virtual disks (like spanned volumes), a crash-consistent recovery point provides no guarantees for hello correctness of hello data.</span></span> |

## <a name="performance-and-resource-utilization"></a><span data-ttu-id="b6a03-180">Prestazioni e utilizzo delle risorse</span><span class="sxs-lookup"><span data-stu-id="b6a03-180">Performance and resource utilization</span></span>
<span data-ttu-id="b6a03-181">Analogamente al software distribuito in locale, è necessario pianificare le esigenze di utilizzo di capacità e risorse durante il backup delle macchine virtuali in Azure.</span><span class="sxs-lookup"><span data-stu-id="b6a03-181">Like backup software that is deployed on-premises, you should plan for capacity and resource utilization needs when backing up VMs in Azure.</span></span> <span data-ttu-id="b6a03-182">Hello [limiti di archiviazione Azure](../azure-subscription-service-limits.md#storage-limits) definire l'impatto di carichi di lavoro toorunning toostructure VM distribuzioni tooget le massime prestazioni con minimo.</span><span class="sxs-lookup"><span data-stu-id="b6a03-182">hello [Azure Storage limits](../azure-subscription-service-limits.md#storage-limits) define how toostructure VM deployments tooget maximum performance with minimum impact toorunning workloads.</span></span>

<span data-ttu-id="b6a03-183">Prestare attenzione toohello limiti di spazio di archiviazione di Azure seguente durante la pianificazione delle prestazioni di backup:</span><span class="sxs-lookup"><span data-stu-id="b6a03-183">Pay attention toohello following Azure Storage limits when planning backup performance:</span></span>

* <span data-ttu-id="b6a03-184">Numero massimo in uscita per account di archiviazione</span><span class="sxs-lookup"><span data-stu-id="b6a03-184">Max egress per storage account</span></span>
* <span data-ttu-id="b6a03-185">Frequenza delle richieste totale per account di archiviazione</span><span class="sxs-lookup"><span data-stu-id="b6a03-185">Total request rate per storage account</span></span>

### <a name="storage-account-limits"></a><span data-ttu-id="b6a03-186">Limiti dell'account di archiviazione</span><span class="sxs-lookup"><span data-stu-id="b6a03-186">Storage account limits</span></span>
<span data-ttu-id="b6a03-187">Dati di backup copiati da un account di archiviazione, aggiunge toohello operazioni di input/output al secondo (IOPS) e in uscita (o una velocità effettiva) metriche hello dell'account di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="b6a03-187">Backup data copied from a storage account, adds toohello input/output operations per second (IOPS) and egress (or throughput) metrics of hello storage account.</span></span> <span data-ttu-id="b6a03-188">AT hello stesso macchine virtuali, ora anche utilizzano IOPS e la velocità effettiva.</span><span class="sxs-lookup"><span data-stu-id="b6a03-188">At hello same time, virtual machines are also consuming IOPS and throughput.</span></span> <span data-ttu-id="b6a03-189">obiettivo di Hello è tooensure Backup e il traffico delle macchine virtuali non superino i limiti dell'account di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="b6a03-189">hello goal is tooensure Backup and virtual machine traffic don't exceed your storage account limits.</span></span>

### <a name="number-of-disks"></a><span data-ttu-id="b6a03-190">Numero di dischi</span><span class="sxs-lookup"><span data-stu-id="b6a03-190">Number of disks</span></span>
<span data-ttu-id="b6a03-191">processo di backup Hello tenta toocomplete un processo di backup più rapidamente possibile.</span><span class="sxs-lookup"><span data-stu-id="b6a03-191">hello backup process tries toocomplete a backup job as quickly as possible.</span></span> <span data-ttu-id="b6a03-192">utilizzando quindi la quantità più elevata possibile di risorse.</span><span class="sxs-lookup"><span data-stu-id="b6a03-192">In doing so, it consumes as many resources as it can.</span></span> <span data-ttu-id="b6a03-193">Tuttavia, tutte le operazioni dei / o sono limitate da hello *velocità effettiva da raggiungere per Blob singolo*, che ha un limite di 60 MB al secondo.</span><span class="sxs-lookup"><span data-stu-id="b6a03-193">However, all I/O operations are limited by hello *Target Throughput for Single Blob*, which has a limit of 60 MB per second.</span></span> <span data-ttu-id="b6a03-194">Processo di backup hello in toomaximize un tentativo di velocità, Cerca tooback backup ognuno dei dischi della macchina virtuale di hello *in parallelo*.</span><span class="sxs-lookup"><span data-stu-id="b6a03-194">In an attempt toomaximize its speed, hello backup process tries tooback up each of hello VM's disks *in parallel*.</span></span> <span data-ttu-id="b6a03-195">Se una macchina virtuale è disponibili quattro dischi, hello tooback tentativi servizio backup di tutti e quattro i dischi in parallelo.</span><span class="sxs-lookup"><span data-stu-id="b6a03-195">If a VM has four disks, hello service attempts tooback up all four disks in parallel.</span></span> <span data-ttu-id="b6a03-196">Hello **numero di dischi** viene eseguito il backup, è importante fattore, hello nella determinazione di traffico di backup di account di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="b6a03-196">hello **number of disks** being backed up, is hello most important factor in determining storage account backup traffic.</span></span>

### <a name="backup-schedule"></a><span data-ttu-id="b6a03-197">Pianificazione dei backup</span><span class="sxs-lookup"><span data-stu-id="b6a03-197">Backup schedule</span></span>
<span data-ttu-id="b6a03-198">Un altro fattore che influisce sulle prestazioni è hello **pianificazione del backup**.</span><span class="sxs-lookup"><span data-stu-id="b6a03-198">An additional factor that impacts performance is hello **backup schedule**.</span></span> <span data-ttu-id="b6a03-199">Se si configurare criteri hello in modo tutte le macchine virtuali vengono eseguito il backup in hello stesso tempo, è stato pianificato un bloccati il traffico.</span><span class="sxs-lookup"><span data-stu-id="b6a03-199">If you configure hello policies so all VMs are backed up at hello same time, you have scheduled a traffic jam.</span></span> <span data-ttu-id="b6a03-200">processo di backup Hello tenta tooback backup di tutti i dischi in parallelo.</span><span class="sxs-lookup"><span data-stu-id="b6a03-200">hello backup process attempts tooback up all disks in parallel.</span></span> <span data-ttu-id="b6a03-201">tooreduce hello backup il traffico proveniente da un account di archiviazione, eseguire il backup diverse macchine virtuali in un momento diverso del giorno hello, senza sovrapposizioni.</span><span class="sxs-lookup"><span data-stu-id="b6a03-201">tooreduce hello backup traffic from a storage account, back up different VMs at different time of hello day, with no overlap.</span></span>

## <a name="capacity-planning"></a><span data-ttu-id="b6a03-202">Pianificazione della capacità</span><span class="sxs-lookup"><span data-stu-id="b6a03-202">Capacity planning</span></span>
<span data-ttu-id="b6a03-203">Combinazione di fattori di hello precedente, è necessario tooplan per esigenze di utilizzo di account di archiviazione hello.</span><span class="sxs-lookup"><span data-stu-id="b6a03-203">Putting hello previous factors together, you need tooplan for hello storage account usage needs.</span></span> <span data-ttu-id="b6a03-204">Scaricare hello [VM backup la pianificazione della capacità del foglio di calcolo di Excel](https://gallery.technet.microsoft.com/Azure-Backup-Storage-a46d7e33) impatto hello toosee del disco e le opzioni di pianificazione di backup.</span><span class="sxs-lookup"><span data-stu-id="b6a03-204">Download hello [VM backup capacity planning Excel spreadsheet](https://gallery.technet.microsoft.com/Azure-Backup-Storage-a46d7e33) toosee hello impact of your disk and backup schedule choices.</span></span>

### <a name="backup-throughput"></a><span data-ttu-id="b6a03-205">Velocità effettiva del backup</span><span class="sxs-lookup"><span data-stu-id="b6a03-205">Backup throughput</span></span>
<span data-ttu-id="b6a03-206">Per ogni disco viene eseguito il backup, Backup di Azure legge blocchi hello sul disco hello e archivi hello solo i dati modificati (backup incrementali).</span><span class="sxs-lookup"><span data-stu-id="b6a03-206">For each disk being backed up, Azure Backup reads hello blocks on hello disk and stores only hello changed data (incremental backup).</span></span> <span data-ttu-id="b6a03-207">Hello nella tabella seguente mostra valori medi della velocità effettiva del servizio di Backup in hello.</span><span class="sxs-lookup"><span data-stu-id="b6a03-207">hello following table shows hello average Backup service throughput values.</span></span> <span data-ttu-id="b6a03-208">Utilizza hello dati seguenti, è possibile stimare quanti hello necessari tooback backup di un disco di una determinata dimensione.</span><span class="sxs-lookup"><span data-stu-id="b6a03-208">Using hello following data, you can estimate hello amount of time needed tooback up a disk of a given size.</span></span>

| <span data-ttu-id="b6a03-209">Operazione di backup</span><span class="sxs-lookup"><span data-stu-id="b6a03-209">Backup operation</span></span> | <span data-ttu-id="b6a03-210">Velocità effettiva ottimale</span><span class="sxs-lookup"><span data-stu-id="b6a03-210">Best-case throughput</span></span> |
| --- | --- |
| <span data-ttu-id="b6a03-211">Backup iniziale</span><span class="sxs-lookup"><span data-stu-id="b6a03-211">Initial backup</span></span> |<span data-ttu-id="b6a03-212">160 Mbps</span><span class="sxs-lookup"><span data-stu-id="b6a03-212">160 Mbps</span></span> |
| <span data-ttu-id="b6a03-213">Backup incrementale (ripristino di emergenza)</span><span class="sxs-lookup"><span data-stu-id="b6a03-213">Incremental backup (DR)</span></span> |<span data-ttu-id="b6a03-214">640 Mbps </span><span class="sxs-lookup"><span data-stu-id="b6a03-214">640 Mbps</span></span> <br><br> <span data-ttu-id="b6a03-215">Velocità effettiva Elimina in modo significativo se hello modificati i dati (che devono toobe backup) è diverse tra dischi hello.</span><span class="sxs-lookup"><span data-stu-id="b6a03-215">Throughput drops significantly if hello changed data (that needs toobe backed up) is dispersed across hello disk.</span></span>|

## <a name="total-vm-backup-time"></a><span data-ttu-id="b6a03-216">Tempo totale di backup della macchina virtuale</span><span class="sxs-lookup"><span data-stu-id="b6a03-216">Total VM backup time</span></span>
<span data-ttu-id="b6a03-217">Mentre la maggior parte del tempo di backup hello viene impiegato per la lettura e la copia dei dati, le altre operazioni contribuiscono toohello tempo totale necessario tooback una macchina virtuale:</span><span class="sxs-lookup"><span data-stu-id="b6a03-217">While most of hello backup time is spent reading and copying data, other operations contribute toohello total time needed tooback up a VM:</span></span>

* <span data-ttu-id="b6a03-218">Necessario troppo tempo[installare o aggiornare l'estensione del backup hello](backup-azure-vms.md).</span><span class="sxs-lookup"><span data-stu-id="b6a03-218">Time needed too[install or update hello backup extension](backup-azure-vms.md).</span></span>
* <span data-ttu-id="b6a03-219">Ora dello snapshot, ovvero hello scattato tootrigger uno snapshot.</span><span class="sxs-lookup"><span data-stu-id="b6a03-219">Snapshot time, which is hello time taken tootrigger a snapshot.</span></span> <span data-ttu-id="b6a03-220">Gli snapshot sono attivate toohello chiusura pianificata ora del backup.</span><span class="sxs-lookup"><span data-stu-id="b6a03-220">Snapshots are triggered close toohello scheduled backup time.</span></span>
* <span data-ttu-id="b6a03-221">Tempo di attesa di coda.</span><span class="sxs-lookup"><span data-stu-id="b6a03-221">Queue wait time.</span></span> <span data-ttu-id="b6a03-222">Poiché il servizio di Backup hello elabora i backup di più clienti, la copia di dati di backup da backup di snapshot toohello o servizi di ripristino dell'insieme di credenziali non venga avviata immediatamente.</span><span class="sxs-lookup"><span data-stu-id="b6a03-222">Since hello Backup service is processing backups from multiple customers, copying backup data from snapshot toohello backup or Recovery Services vault might not start immediately.</span></span> <span data-ttu-id="b6a03-223">Negli orari di punta, attesa hello consente di estendere le ore tooeight scadenza toohello numero di backup in corso di elaborazione.</span><span class="sxs-lookup"><span data-stu-id="b6a03-223">In times of peak load, hello wait can stretch up tooeight hours due toohello number of backups being processed.</span></span> <span data-ttu-id="b6a03-224">Tuttavia, ora backup VM totale hello è inferiore a 24 ore per i criteri di backup giornalieri.</span><span class="sxs-lookup"><span data-stu-id="b6a03-224">However, hello total VM backup time is less than 24 hours for daily backup policies.</span></span>
* <span data-ttu-id="b6a03-225">Tempo di trasferimento di dati, tempo necessario per il backup le modifiche incrementali toocompute hello dal backup precedente del servizio e trasferire tali archiviazione toovault le modifiche.</span><span class="sxs-lookup"><span data-stu-id="b6a03-225">Data transfer time, time needed for backup service toocompute hello incremental changes from previous backup and transfer those changes toovault storage.</span></span>

### <a name="why-am-i-observing-longer12-hours-backup-time"></a><span data-ttu-id="b6a03-226">Perché si registrano tempi di backup superiori alle 12 ore?</span><span class="sxs-lookup"><span data-stu-id="b6a03-226">Why am I observing longer(>12 hours) backup time?</span></span>
<span data-ttu-id="b6a03-227">Backup è costituito da due fasi: esecuzione di snapshot e il trasferimento di hello snapshot toohello insieme di credenziali.</span><span class="sxs-lookup"><span data-stu-id="b6a03-227">Backup consists of two phases: taking snapshots and transferring hello snapshots toohello vault.</span></span> <span data-ttu-id="b6a03-228">Consente di ottimizzare Hello servizio di Backup per l'archiviazione.</span><span class="sxs-lookup"><span data-stu-id="b6a03-228">hello Backup service optimizes for storage.</span></span> <span data-ttu-id="b6a03-229">Durante il trasferimento di insieme di credenziali tooa dati snapshot hello, servizio hello trasferisce solo le modifiche incrementali da snapshot precedente hello.</span><span class="sxs-lookup"><span data-stu-id="b6a03-229">When transferring hello snapshot data tooa vault, hello service only transfers incremental changes from hello previous snapshot.</span></span>  <span data-ttu-id="b6a03-230">modifiche incrementali hello toodetermine, servizio hello calcola checksum hello di blocchi di hello.</span><span class="sxs-lookup"><span data-stu-id="b6a03-230">toodetermine hello incremental changes, hello service computes hello checksum of hello blocks.</span></span> <span data-ttu-id="b6a03-231">Se viene modificato un blocco, blocco hello viene identificato come un blocco di toobe inviati toohello insieme di credenziali.</span><span class="sxs-lookup"><span data-stu-id="b6a03-231">If a block is changed, hello block is identified as a block toobe sent toohello vault.</span></span> <span data-ttu-id="b6a03-232">Esercitazioni di servizio hello ulteriormente in ognuna delle hello identificati blocchi, cercando le opportunità toominimize hello dati tootransfer.</span><span class="sxs-lookup"><span data-stu-id="b6a03-232">Then hello service drills further into each of hello identified blocks, looking for opportunities toominimize hello data tootransfer.</span></span> <span data-ttu-id="b6a03-233">Dopo aver valutato i blocchi modificati tutti, il servizio di hello assegna modifiche hello e li invia insieme di credenziali toohello.</span><span class="sxs-lookup"><span data-stu-id="b6a03-233">After evaluating all changed blocks, hello service coalesces hello changes and sends them toohello vault.</span></span> <span data-ttu-id="b6a03-234">In alcune applicazioni legacy, le scritture frammentate e di piccole dimensioni non sono ottimali per l'archiviazione.</span><span class="sxs-lookup"><span data-stu-id="b6a03-234">In some legacy applications, small, fragmented writes are not optimal for storage.</span></span> <span data-ttu-id="b6a03-235">Se snapshot hello contiene molte operazioni di scrittura di piccole dimensioni, frammentati, servizio hello impiega più tempo di elaborazione dati hello scritti dalle applicazioni hello.</span><span class="sxs-lookup"><span data-stu-id="b6a03-235">If hello snapshot contains many small, fragmented writes, hello service spends additional time processing hello data written by hello applications.</span></span> <span data-ttu-id="b6a03-236">Hello consigliato di blocco di scrittura di applicazioni da Azure, per le applicazioni in esecuzione all'interno di hello macchina virtuale, è un minimo di 8 KB.</span><span class="sxs-lookup"><span data-stu-id="b6a03-236">hello recommended application write block from Azure, for applications running inside hello VM, is a minimum of 8 KB.</span></span> <span data-ttu-id="b6a03-237">Se l'applicazione usa un blocco più piccolo degli 8 KB, le prestazioni del backup ne risentono.</span><span class="sxs-lookup"><span data-stu-id="b6a03-237">If your application uses a block of less than 8 KB, backup performance is effected.</span></span> <span data-ttu-id="b6a03-238">Per informazioni sull'ottimizzazione delle prestazioni di backup tooimprove applicazione, vedere [ottimizzazione di applicazioni per ottenere prestazioni ottimali con l'archiviazione di Azure](../storage/common/storage-premium-storage-performance.md).</span><span class="sxs-lookup"><span data-stu-id="b6a03-238">For help with tuning your application tooimprove backup performance, see [Tuning applications for optimal performance with Azure storage](../storage/common/storage-premium-storage-performance.md).</span></span> <span data-ttu-id="b6a03-239">Se l'articolo di hello sulle prestazioni del backup viene utilizzato negli esempi di archiviazione Premium, materiale sussidiario hello è applicabile per i dischi di archiviazione Standard.</span><span class="sxs-lookup"><span data-stu-id="b6a03-239">Though hello article on backup performance uses Premium storage examples, hello guidance is applicable for Standard storage disks.</span></span>

## <a name="total-restore-time"></a><span data-ttu-id="b6a03-240">Tempo totale di ripristino</span><span class="sxs-lookup"><span data-stu-id="b6a03-240">Total restore time</span></span>
<span data-ttu-id="b6a03-241">Un'operazione di ripristino è costituita da due attività principali sub: copia i dati nuovamente dall'account di archiviazione di hello insieme di credenziali toohello scelto cliente e creazione della macchina virtuale hello.</span><span class="sxs-lookup"><span data-stu-id="b6a03-241">A restore operation consists of two main sub tasks: Copying data back from hello vault toohello chosen customer storage account, and creating hello virtual machine.</span></span> <span data-ttu-id="b6a03-242">La copia dei dati dallo stesso insieme di credenziali hello dipende in cui i backup hello vengono archiviati internamente in Azure e in cui è memorizzato l'account di archiviazione hello cliente.</span><span class="sxs-lookup"><span data-stu-id="b6a03-242">Copying data back from hello vault depends on where hello backups are stored internally in Azure, and where hello customer storage account is stored.</span></span> <span data-ttu-id="b6a03-243">Dipende dal tempo impiegato toocopy dati:</span><span class="sxs-lookup"><span data-stu-id="b6a03-243">Time taken toocopy data depends upon:</span></span>
* <span data-ttu-id="b6a03-244">-Tempo di attesa in coda perché i processi del servizio hello processi di ripristino da più clienti in hello stesso tempo, le richieste di ripristino sono inseriti in una coda.</span><span class="sxs-lookup"><span data-stu-id="b6a03-244">Queue wait time - Since hello service processes restore jobs from multiple customers at hello same time, restore requests are put in a queue.</span></span>
* <span data-ttu-id="b6a03-245">Tempo - copia dei dati dei dati viene copiati dall'account di archiviazione cliente toohello hello insieme di credenziali.</span><span class="sxs-lookup"><span data-stu-id="b6a03-245">Data copy time - Data is copied from hello vault toohello customer storage account.</span></span> <span data-ttu-id="b6a03-246">Ripristinare tempo dipende dal valore di IOPS e velocità effettiva del servizio di Backup di Azure Ottiene account di archiviazione cliente hello selezionato.</span><span class="sxs-lookup"><span data-stu-id="b6a03-246">Restore time depends on IOPS and throughput Azure Backup service gets on hello selected customer storage account.</span></span> <span data-ttu-id="b6a03-247">tooreduce hello la copia di tempo durante il processo di ripristino di hello, selezionare un account di archiviazione non è stato caricato con altri di lettura e scrittura di applicazioni.</span><span class="sxs-lookup"><span data-stu-id="b6a03-247">tooreduce hello copying time during hello restore process, select a storage account not loaded with other application writes and reads.</span></span>

## <a name="best-practices"></a><span data-ttu-id="b6a03-248">Procedure consigliate</span><span class="sxs-lookup"><span data-stu-id="b6a03-248">Best practices</span></span>
<span data-ttu-id="b6a03-249">È consigliabile seguire queste procedure durante la configurazione del backup per le macchine virtuali:</span><span class="sxs-lookup"><span data-stu-id="b6a03-249">We suggest following these practices while configuring backups for virtual machines:</span></span>

* <span data-ttu-id="b6a03-250">Non pianificare le macchine virtuali classiche più di 10 da hello stesso cloud tooback servizio in hello contemporaneamente.</span><span class="sxs-lookup"><span data-stu-id="b6a03-250">Don't schedule more than 10 classic VMs from hello same cloud service tooback up at hello same time.</span></span> <span data-ttu-id="b6a03-251">Se si desidera tooback di più macchine virtuali nello stesso servizio cloud, sfalsare gli orari di inizio backup di hello di un'ora.</span><span class="sxs-lookup"><span data-stu-id="b6a03-251">If you want tooback up multiple VMs from same cloud service, stagger hello backup start times by an hour.</span></span>
* <span data-ttu-id="b6a03-252">Non pianificare più di 40 tooback macchine virtuali di hello contemporaneamente.</span><span class="sxs-lookup"><span data-stu-id="b6a03-252">Do not schedule more than 40 VMs tooback up at hello same time.</span></span>
* <span data-ttu-id="b6a03-253">Pianificare i backup di macchine Virtuali durante le ore non di punta.</span><span class="sxs-lookup"><span data-stu-id="b6a03-253">Schedule VM backups during non-peak hours.</span></span> <span data-ttu-id="b6a03-254">Questo servizio di Backup di hello modo utilizza IOPS per il trasferimento dei dati dall'insieme di credenziali toohello hello cliente storage account.</span><span class="sxs-lookup"><span data-stu-id="b6a03-254">This way hello Backup service uses IOPS for transferring data from hello customer storage account toohello vault.</span></span>
* <span data-ttu-id="b6a03-255">Assicurarsi che un criterio faccia riferimento a VM in più account di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="b6a03-255">Make sure that a policy is applied on VMs spread across different storage accounts.</span></span> <span data-ttu-id="b6a03-256">Si consiglia di non più di 20 totali dischi da un singolo account di archiviazione protetta da hello pianificazione del backup stesso.</span><span class="sxs-lookup"><span data-stu-id="b6a03-256">We suggest no more than 20 total disks from a single storage account be protected by hello same backup schedule.</span></span> <span data-ttu-id="b6a03-257">Se dispone di maggiore di 20 dischi in un account di archiviazione, distribuire tali macchine virtuali tra più criteri tooget hello IOPS richiesto durante la fase di trasferimento hello del processo di backup hello.</span><span class="sxs-lookup"><span data-stu-id="b6a03-257">If you have greater than 20 disks in a storage account, spread those VMs across multiple policies tooget hello required IOPS during hello transfer phase of hello backup process.</span></span>
* <span data-ttu-id="b6a03-258">Non ripristinare una macchina virtuale in esecuzione in account di archiviazione toosame archiviazione Premium.</span><span class="sxs-lookup"><span data-stu-id="b6a03-258">Do not restore a VM running on Premium storage toosame storage account.</span></span> <span data-ttu-id="b6a03-259">Se il processo di operazione di ripristino hello coincide con l'operazione di backup hello, riduce hello IOPS disponibile per il backup.</span><span class="sxs-lookup"><span data-stu-id="b6a03-259">If hello restore operation process coincides with hello backup operation, it reduces hello available IOPS for backup.</span></span>
* <span data-ttu-id="b6a03-260">Per il backup di VM Premium, verificare che l'account di archiviazione che ospita i dischi premium abbia almeno il 50% di spazio disponibile per la gestione temporanea degli snapshot perché il backup sia completato correttamente.</span><span class="sxs-lookup"><span data-stu-id="b6a03-260">For Premium VM backup, ensure that storage account that hosts premium disks has atleast 50% free space for staging snapshot for a successful backup.</span></span> 
* <span data-ttu-id="b6a03-261">Verificare che la versione di python nelle macchine virtuali Linux abilitate per il backup sia la 2.7</span><span class="sxs-lookup"><span data-stu-id="b6a03-261">Make sure that python version on Linux VMs enabled for backup is 2.7</span></span>

## <a name="data-encryption"></a><span data-ttu-id="b6a03-262">Crittografia dei dati</span><span class="sxs-lookup"><span data-stu-id="b6a03-262">Data encryption</span></span>
<span data-ttu-id="b6a03-263">Backup di Azure crittografa i dati come parte del processo di backup hello.</span><span class="sxs-lookup"><span data-stu-id="b6a03-263">Azure Backup does not encrypt data as a part of hello backup process.</span></span> <span data-ttu-id="b6a03-264">Tuttavia, è possibile crittografare i dati all'interno di hello VM e backup hello i dati protetti senza problemi (ulteriori informazioni su [backup dei dati crittografati](backup-azure-vms-encryption.md)).</span><span class="sxs-lookup"><span data-stu-id="b6a03-264">However, you can encrypt data within hello VM and back up hello protected data seamlessly (read more about [backup of encrypted data](backup-azure-vms-encryption.md)).</span></span>

## <a name="calculating-hello-cost-of-protected-instances"></a><span data-ttu-id="b6a03-265">Il calcolo del costo di hello di istanze protette</span><span class="sxs-lookup"><span data-stu-id="b6a03-265">Calculating hello cost of protected instances</span></span>
<span data-ttu-id="b6a03-266">Macchine virtuali di Azure che vengono sottoposti a backup tramite Backup di Azure sono soggette a troppo[dei prezzi di Azure Backup](https://azure.microsoft.com/pricing/details/backup/).</span><span class="sxs-lookup"><span data-stu-id="b6a03-266">Azure virtual machines that are backed up through Azure Backup are subject too[Azure Backup pricing](https://azure.microsoft.com/pricing/details/backup/).</span></span> <span data-ttu-id="b6a03-267">calcolo di istanze protette Hello è basato su hello *effettivo* dimensioni di macchina virtuale di hello è hello somma di tutti i dati di hello nella macchina virtuale hello - escludendo hello "risorsa disco."</span><span class="sxs-lookup"><span data-stu-id="b6a03-267">hello Protected Instances calculation is based on hello *actual* size of hello virtual machine, which is hello sum of all hello data in hello virtual machine--excluding hello “resource disk.”</span></span>

<span data-ttu-id="b6a03-268">Prezzi per il backup delle macchine virtuali è *non* in base alle dimensioni di hello massima supportata per ogni macchina virtuale di dati su disco toohello associata.</span><span class="sxs-lookup"><span data-stu-id="b6a03-268">Pricing for backing up VMs is *not* based on hello maximum supported size for each data disk attached toohello virtual machine.</span></span> <span data-ttu-id="b6a03-269">Piano tariffario è in base hello dati effettivi archiviati nel disco dati hello.</span><span class="sxs-lookup"><span data-stu-id="b6a03-269">Pricing is based on hello actual data stored in hello data disk.</span></span> <span data-ttu-id="b6a03-270">Analogamente, i costi di archiviazione di backup hello sono in base hello quantità di dati archiviati in Azure Backup, ovvero la somma hello di dati effettivo hello in ogni punto di ripristino.</span><span class="sxs-lookup"><span data-stu-id="b6a03-270">Similarly, hello backup storage bill is based on hello amount of data that is stored in Azure Backup, which is hello sum of hello actual data in each recovery point.</span></span>

<span data-ttu-id="b6a03-271">Si prenda ad esempio una macchina virtuale di dimensioni A2-Standard dotata di due dischi dati aggiuntivi con capacità massima di 1 TB ciascuno.</span><span class="sxs-lookup"><span data-stu-id="b6a03-271">For example, take an A2 Standard-sized virtual machine that has two additional data disks with a maximum size of 1 TB each.</span></span> <span data-ttu-id="b6a03-272">Hello nella tabella seguente fornisce i dati di effettivo hello archiviati in ognuno di questi dischi:</span><span class="sxs-lookup"><span data-stu-id="b6a03-272">hello following table gives hello actual data stored on each of these disks:</span></span>

| <span data-ttu-id="b6a03-273">Tipo di disco</span><span class="sxs-lookup"><span data-stu-id="b6a03-273">Disk type</span></span> | <span data-ttu-id="b6a03-274">Dimensioni massime</span><span class="sxs-lookup"><span data-stu-id="b6a03-274">Max size</span></span> | <span data-ttu-id="b6a03-275">Dati effettivi presenti</span><span class="sxs-lookup"><span data-stu-id="b6a03-275">Actual data present</span></span> |
| --- | --- | --- |
| <span data-ttu-id="b6a03-276">Disco del sistema operativo</span><span class="sxs-lookup"><span data-stu-id="b6a03-276">Operating system disk</span></span> |<span data-ttu-id="b6a03-277">1023 GB</span><span class="sxs-lookup"><span data-stu-id="b6a03-277">1023 GB</span></span> |<span data-ttu-id="b6a03-278">17 GB</span><span class="sxs-lookup"><span data-stu-id="b6a03-278">17 GB</span></span> |
| <span data-ttu-id="b6a03-279">Disco locale/Disco risorse</span><span class="sxs-lookup"><span data-stu-id="b6a03-279">Local disk / Resource disk</span></span> |<span data-ttu-id="b6a03-280">135 GB</span><span class="sxs-lookup"><span data-stu-id="b6a03-280">135 GB</span></span> |<span data-ttu-id="b6a03-281">5 GB (non incluso per il backup)</span><span class="sxs-lookup"><span data-stu-id="b6a03-281">5 GB (not included for backup)</span></span> |
| <span data-ttu-id="b6a03-282">Disco dati 1</span><span class="sxs-lookup"><span data-stu-id="b6a03-282">Data disk 1</span></span> |<span data-ttu-id="b6a03-283">1023 GB</span><span class="sxs-lookup"><span data-stu-id="b6a03-283">1023 GB</span></span> |<span data-ttu-id="b6a03-284">30 GB</span><span class="sxs-lookup"><span data-stu-id="b6a03-284">30 GB</span></span> |
| <span data-ttu-id="b6a03-285">Disco dati 2</span><span class="sxs-lookup"><span data-stu-id="b6a03-285">Data disk 2</span></span> |<span data-ttu-id="b6a03-286">1023 GB</span><span class="sxs-lookup"><span data-stu-id="b6a03-286">1023 GB</span></span> |<span data-ttu-id="b6a03-287">0 GB</span><span class="sxs-lookup"><span data-stu-id="b6a03-287">0 GB</span></span> |

<span data-ttu-id="b6a03-288">Hello *effettivo* dimensioni di macchina virtuale hello in questo caso sono 17 GB + 30 GB + 0 GB = 47 GB.</span><span class="sxs-lookup"><span data-stu-id="b6a03-288">hello *actual* size of hello virtual machine in this case is 17 GB + 30 GB + 0 GB = 47 GB.</span></span> <span data-ttu-id="b6a03-289">Questa dimensione di istanza protetta (47 GB) diventa base hello per fattura mensile hello.</span><span class="sxs-lookup"><span data-stu-id="b6a03-289">This Protected Instance size (47 GB) becomes hello basis for hello monthly bill.</span></span> <span data-ttu-id="b6a03-290">Come hello quantità di dati nella macchina virtuale hello cresce, dimensioni di istanza protetta hello utilizzata per le informazioni di fatturazione, di conseguenza.</span><span class="sxs-lookup"><span data-stu-id="b6a03-290">As hello amount of data in hello virtual machine grows, hello Protected Instance size used for billing changes accordingly.</span></span>

<span data-ttu-id="b6a03-291">La fatturazione non viene avviato fino al completamento di backup riuscito prima hello.</span><span class="sxs-lookup"><span data-stu-id="b6a03-291">Billing does not start until hello first successful backup completes.</span></span> <span data-ttu-id="b6a03-292">A questo punto, inizia la fatturazione hello per le istanze protetti sia all'archiviazione.</span><span class="sxs-lookup"><span data-stu-id="b6a03-292">At this point, hello billing for both Storage and Protected Instances begins.</span></span> <span data-ttu-id="b6a03-293">La fatturazione continua finché è *qualsiasi backup dei dati archiviati in un insieme di credenziali* per la macchina virtuale hello.</span><span class="sxs-lookup"><span data-stu-id="b6a03-293">Billing continues as long as there is *any backup data stored in a vault* for hello virtual machine.</span></span> <span data-ttu-id="b6a03-294">Se si arresta la protezione nella macchina virtuale hello, ma esistono dati di backup di macchina virtuale in un insieme di credenziali, la fatturazione continua.</span><span class="sxs-lookup"><span data-stu-id="b6a03-294">If you stop protection on hello virtual machine, but virtual machine backup data exists in a vault, billing continues.</span></span>

<span data-ttu-id="b6a03-295">La fatturazione per una macchina virtuale specificata si arresta solo se la protezione di hello viene interrotta *e* tutti i dati di backup viene eliminato.</span><span class="sxs-lookup"><span data-stu-id="b6a03-295">Billing for a specified virtual machine stops only if hello protection is stopped *and* all backup data is deleted.</span></span> <span data-ttu-id="b6a03-296">Quando si arresta protezione dati e non sono disponibili processi di backup attivi, dimensioni hello dell'ultimo backup VM riuscito hello diventa dimensioni di istanza protetta hello utilizzate per la fattura mensile hello.</span><span class="sxs-lookup"><span data-stu-id="b6a03-296">When protection stops and there are no active backup jobs, hello size of hello last successful VM backup becomes hello Protected Instance size used for hello monthly bill.</span></span>

## <a name="questions"></a><span data-ttu-id="b6a03-297">Domande?</span><span class="sxs-lookup"><span data-stu-id="b6a03-297">Questions?</span></span>
<span data-ttu-id="b6a03-298">Se si hanno domande o se è presente una funzionalità che si desidera toosee incluso, [inviare commenti e suggerimenti](http://aka.ms/azurebackup_feedback).</span><span class="sxs-lookup"><span data-stu-id="b6a03-298">If you have questions, or if there is any feature that you would like toosee included, [send us feedback](http://aka.ms/azurebackup_feedback).</span></span>

## <a name="next-steps"></a><span data-ttu-id="b6a03-299">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="b6a03-299">Next steps</span></span>
* [<span data-ttu-id="b6a03-300">Eseguire il backup di macchine virtuali</span><span class="sxs-lookup"><span data-stu-id="b6a03-300">Back up virtual machines</span></span>](backup-azure-vms.md)
* [<span data-ttu-id="b6a03-301">Gestire i backup delle macchine virtuali</span><span class="sxs-lookup"><span data-stu-id="b6a03-301">Manage virtual machine backup</span></span>](backup-azure-manage-vms.md)
* [<span data-ttu-id="b6a03-302">Ripristino di macchine virtuali</span><span class="sxs-lookup"><span data-stu-id="b6a03-302">Restore virtual machines</span></span>](backup-azure-restore-vms.md)
* [<span data-ttu-id="b6a03-303">Risolvere i problemi relativi al backup delle macchine virtuali di Azure</span><span class="sxs-lookup"><span data-stu-id="b6a03-303">Troubleshoot VM backup issues</span></span>](backup-azure-vms-troubleshoot.md)
