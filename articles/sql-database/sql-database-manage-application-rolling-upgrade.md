---
title: gli aggiornamenti dell'applicazione aaaRolling - Database SQL di Azure | Documenti Microsoft
description: Informazioni su come toouse Database SQL di Azure-replica geografica toosupport aggiornamenti dell'applicazione cloud.
services: sql-database
documentationcenter: 
author: anosov1960
manager: jhubbard
editor: monicar
ms.assetid: 58f42859-1e37-463c-a3d8-a3ca2e867148
ms.service: sql-database
ms.custom: business continuity
ms.devlang: NA
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 07/16/2016
ms.author: sashan
ms.openlocfilehash: 18c56300916d129bff141624cc5c416b500408d4
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/06/2017
---
# <a name="managing-rolling-upgrades-of-cloud-applications-using-sql-database-active-geo-replication"></a><span data-ttu-id="69f30-103">Gestione degli aggiornamenti in sequenza delle applicazioni cloud con la replica geografica attiva del database SQL</span><span class="sxs-lookup"><span data-stu-id="69f30-103">Managing rolling upgrades of cloud applications using SQL Database active geo-replication</span></span>
> [!NOTE]
> <span data-ttu-id="69f30-104">La [replica geografica attiva](sql-database-geo-replication-overview.md) è ora disponibile per tutti i database in tutti i livelli.</span><span class="sxs-lookup"><span data-stu-id="69f30-104">[Active geo-replication](sql-database-geo-replication-overview.md) is now available for all databases in all tiers.</span></span>
> 

<span data-ttu-id="69f30-105">Informazioni su come toouse [-replica geografica](sql-database-geo-replication-overview.md) in Database SQL tooenable gli aggiornamenti dell'applicazione cloud in sequenza.</span><span class="sxs-lookup"><span data-stu-id="69f30-105">Learn how toouse [geo-replication](sql-database-geo-replication-overview.md) in SQL Database tooenable rolling upgrades of your cloud application.</span></span> <span data-ttu-id="69f30-106">L'aggiornamento dovrebbe far parte della pianificazione e della progettazione della continuità aziendale perché è un'operazione che comporta interruzioni.</span><span class="sxs-lookup"><span data-stu-id="69f30-106">Because upgrade is a disruptive operation, it should be part of your business continuity planning and design.</span></span> <span data-ttu-id="69f30-107">In questo articolo che verranno esaminate due metodi diversi di orchestrazione hello processo di aggiornamento e discutere i vantaggi di hello e i vantaggi e svantaggi di ogni opzione.</span><span class="sxs-lookup"><span data-stu-id="69f30-107">In this article we look at two different methods of orchestrating hello upgrade process, and discuss hello benefits and trade-offs of each option.</span></span> <span data-ttu-id="69f30-108">Ai fini di hello di questo articolo si utilizzerà una semplice applicazione costituita da un singolo database di sito web tooa connesso come relativo livello dati.</span><span class="sxs-lookup"><span data-stu-id="69f30-108">For hello purposes of this article we will use a simple application that consists of a web site connected tooa single database as its data tier.</span></span> <span data-ttu-id="69f30-109">L'obiettivo è tooupgrade versione 1 di hello applicazione tooversion 2 senza un impatto significativo sull'esperienza dell'utente finale di hello.</span><span class="sxs-lookup"><span data-stu-id="69f30-109">Our goal is tooupgrade version 1 of hello application tooversion 2 without any significant impact on hello end-user experience.</span></span> 

<span data-ttu-id="69f30-110">Durante la valutazione delle opzioni di aggiornamento hello è opportuno considerare hello seguenti fattori:</span><span class="sxs-lookup"><span data-stu-id="69f30-110">When evaluating hello upgrade options you should consider hello following factors:</span></span>

* <span data-ttu-id="69f30-111">Impatto sulla disponibilità dell'applicazione durante gli aggiornamenti.</span><span class="sxs-lookup"><span data-stu-id="69f30-111">Impact on application availability during upgrades.</span></span> <span data-ttu-id="69f30-112">Funzione applicazione hello quanto tempo può essere limitato o danneggiato.</span><span class="sxs-lookup"><span data-stu-id="69f30-112">How long hello application function may be limited or degraded.</span></span>
* <span data-ttu-id="69f30-113">Possibilità tooroll nuovamente in caso di un aggiornamento non riuscito.</span><span class="sxs-lookup"><span data-stu-id="69f30-113">Ability tooroll back in case of an upgrade failure.</span></span>
* <span data-ttu-id="69f30-114">Vulnerabilità di un'applicazione hello se si verifica un errore irreversibile non correlato durante l'aggiornamento di hello.</span><span class="sxs-lookup"><span data-stu-id="69f30-114">Vulnerability of hello application if an unrelated catastrophic failure occurs during hello upgrade.</span></span>
* <span data-ttu-id="69f30-115">Costo totale.</span><span class="sxs-lookup"><span data-stu-id="69f30-115">Total dollar cost.</span></span>  <span data-ttu-id="69f30-116">Ciò include un'ulteriore ridondanza e i costi incrementali dei componenti di hello temporanea utilizzati dal processo di aggiornamento hello.</span><span class="sxs-lookup"><span data-stu-id="69f30-116">This includes additional redundancy and incremental costs of hello temporary components  used by hello upgrade process.</span></span> 

## <a name="upgrading-applications-that-rely-on-database-backups-for-disaster-recovery"></a><span data-ttu-id="69f30-117">Aggiornamento di applicazioni basate sui backup del database per il ripristino di emergenza</span><span class="sxs-lookup"><span data-stu-id="69f30-117">Upgrading applications that rely on database backups for disaster recovery</span></span>
<span data-ttu-id="69f30-118">Se l'applicazione si basa sul backup automatici del database e utilizza ripristino a livello geografico per il ripristino di emergenza, è in genere distribuito tooa singola regione di Azure.</span><span class="sxs-lookup"><span data-stu-id="69f30-118">If your application relies on automatic database backups and uses geo-restore for disaster recovery, it is usually deployed tooa single Azure region.</span></span> <span data-ttu-id="69f30-119">In questo caso processo di aggiornamento hello implica la creazione di una distribuzione di backup di tutti i componenti coinvolti nell'aggiornamento hello.</span><span class="sxs-lookup"><span data-stu-id="69f30-119">In this case hello upgrade process involves creating a backup deployment of all application components involved in hello upgrade.</span></span> <span data-ttu-id="69f30-120">toominimize hello interruzioni è possibile utilizzare Azure Traffic Manager (WATM) con il profilo di failover hello.</span><span class="sxs-lookup"><span data-stu-id="69f30-120">toominimize hello end-user disruption you will leverage Azure Traffic Manager (WATM) with hello failover profile.</span></span>  <span data-ttu-id="69f30-121">Hello seguente diagramma illustra hello ambiente operativo toohello precedente aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="69f30-121">hello following diagram illustrates hello operational environment prior toohello upgrade process.</span></span> <span data-ttu-id="69f30-122">Hello endpoint <i>contoso 1.azurewebsites.net</i> rappresenta uno slot di produzione dell'applicazione hello necessarie toobe aggiornato.</span><span class="sxs-lookup"><span data-stu-id="69f30-122">hello endpoint <i>contoso-1.azurewebsites.net</i> represents a production slot of hello application that needs toobe upgraded.</span></span> <span data-ttu-id="69f30-123">tooenable hello possibilità tooroll nuovamente hello l'aggiornamento, è necessario creare uno slot di fase con una copia di un'applicazione hello completamente sincronizzata.</span><span class="sxs-lookup"><span data-stu-id="69f30-123">tooenable hello ability tooroll back hello upgrade, you need create a stage slot with a fully synchronized copy of hello application.</span></span> <span data-ttu-id="69f30-124">Hello passaggi seguenti sono un'applicazione hello tooprepare necessarie per l'aggiornamento di hello:</span><span class="sxs-lookup"><span data-stu-id="69f30-124">hello following steps are required tooprepare hello application for hello upgrade:</span></span>

1. <span data-ttu-id="69f30-125">Creare uno slot di fase per l'aggiornamento di hello.</span><span class="sxs-lookup"><span data-stu-id="69f30-125">Create a stage slot for hello upgrade.</span></span> <span data-ttu-id="69f30-126">toodo creare un database secondario (1) e distribuire un sito web identico in hello stessa area di Azure.</span><span class="sxs-lookup"><span data-stu-id="69f30-126">toodo that create a secondary database (1) and deploy an identical web site in hello same Azure region.</span></span> <span data-ttu-id="69f30-127">Monitorare toosee secondario hello se hello seeding processo viene completato.</span><span class="sxs-lookup"><span data-stu-id="69f30-127">Monitor hello secondary toosee if hello seeding process is completed.</span></span>
2. <span data-ttu-id="69f30-128">Creare un profilo di failover in Gestione traffico di Azure con <i>contoso-1.azurewebsites.net</i> come endpoint online e <i>contoso-2.azurewebsites.net</i> come endpoint offline.</span><span class="sxs-lookup"><span data-stu-id="69f30-128">Create a failover profile in WATM with <i>contoso-1.azurewebsites.net</i> as online endpoint and <i>contoso-2.azurewebsites.net</i> as offline.</span></span> 

> [!NOTE]
> <span data-ttu-id="69f30-129">Passaggi di preparazione hello nota non avrà impatto sulle applicazioni hello nello slot di produzione hello e funzionare in modalità di accesso completo.</span><span class="sxs-lookup"><span data-stu-id="69f30-129">Note hello preparation steps will not impact hello application in hello production slot and it can function in full access mode.</span></span>
>  

![Configurazione della replica geografica del database SQL.](media/sql-database-manage-application-rolling-upgrade/Option1-1.png)

<span data-ttu-id="69f30-132">Dopo aver completati i passaggi di preparazione hello applicazione hello è pronta per l'aggiornamento effettivo hello.</span><span class="sxs-lookup"><span data-stu-id="69f30-132">Once hello preparation steps are completed hello application is ready for hello actual upgrade.</span></span> <span data-ttu-id="69f30-133">Hello seguente diagramma illustra i passaggi di hello coinvolti nel processo di aggiornamento hello.</span><span class="sxs-lookup"><span data-stu-id="69f30-133">hello following diagram illustrates hello steps involved in hello upgrade process.</span></span> 

1. <span data-ttu-id="69f30-134">Impostare i database primario hello in hello slot tooread sola modalità di produzione (3).</span><span class="sxs-lookup"><span data-stu-id="69f30-134">Set hello primary database in hello production slot tooread-only mode (3).</span></span> <span data-ttu-id="69f30-135">Ciò garantisce che hello istanza di produzione di un'applicazione hello (V1) rimarrà sola lettura durante l'aggiornamento di hello, impedendo così divergenze di dati hello tra hello V1 e V2 le istanze del database.</span><span class="sxs-lookup"><span data-stu-id="69f30-135">This will guarantee that hello production instance of hello application (V1) will remain read-only during hello upgrade thus preventing hello data divergence between hello V1 and V2 database instances.</span></span>  
2. <span data-ttu-id="69f30-136">Disconnettere i database secondari di hello utilizzando la modalità di terminazione pianificata hello (4).</span><span class="sxs-lookup"><span data-stu-id="69f30-136">Disconnect hello secondary database using hello planned termination mode (4).</span></span> <span data-ttu-id="69f30-137">Creerà una copia indipendente completamente sincronizzata del database primario hello.</span><span class="sxs-lookup"><span data-stu-id="69f30-137">It will create a fully synchronized independent copy of hello primary database.</span></span> <span data-ttu-id="69f30-138">Questo database verrà aggiornato.</span><span class="sxs-lookup"><span data-stu-id="69f30-138">This database will be upgraded.</span></span>
3. <span data-ttu-id="69f30-139">Attivare la modalità di scrittura di tooread hello database primario ed eseguire script di aggiornamento hello nello slot di fase hello (5).</span><span class="sxs-lookup"><span data-stu-id="69f30-139">Turn hello primary database tooread-write mode and run hello upgrade script in hello stage slot  (5).</span></span>     

![Configurazione della replica geografica del database SQL.](media/sql-database-manage-application-rolling-upgrade/Option1-2.png)

<span data-ttu-id="69f30-142">Aggiornamento hello completato, è possibile l'applicazione di hello copia tooswitch pronto hello agli utenti finali toohello gestione temporanea.</span><span class="sxs-lookup"><span data-stu-id="69f30-142">If hello upgrade completed successfully you are now ready tooswitch hello end users toohello staged copy hello application.</span></span> <span data-ttu-id="69f30-143">Ora diventerà lo slot di produzione hello di un'applicazione hello.</span><span class="sxs-lookup"><span data-stu-id="69f30-143">It will now become hello production slot of hello application.</span></span>  <span data-ttu-id="69f30-144">Questo implica alcuni passaggi aggiuntivi, come illustrato nel seguente diagramma hello.</span><span class="sxs-lookup"><span data-stu-id="69f30-144">This involves a few more steps as illustrated on hello following diagram.</span></span>

1. <span data-ttu-id="69f30-145">Opzione endpoint online hello nel profilo di Traffic Manager di AZURE hello troppo<i>contoso 2.azurewebsites.net</i>, la versione V2 toohello punti del sito web di hello (6).</span><span class="sxs-lookup"><span data-stu-id="69f30-145">Switch hello online endpoint in hello WATM profile too<i>contoso-2.azurewebsites.net</i>, which points toohello V2 version of hello web site (6).</span></span> <span data-ttu-id="69f30-146">Ora diventa uno slot di produzione hello con hello V2 applicazione e il traffico degli utenti finali di hello è tooit diretto.</span><span class="sxs-lookup"><span data-stu-id="69f30-146">It now becomes hello production slot with hello V2 application and hello end-user traffic is directed tooit.</span></span>  
2. <span data-ttu-id="69f30-147">Se non è più necessario componenti dell'applicazione hello V1 in modo è possibile rimuoverli (7).</span><span class="sxs-lookup"><span data-stu-id="69f30-147">If you no longer need hello V1 application components so you can safely remove them (7).</span></span>   

![Configurazione della replica geografica del database SQL.](media/sql-database-manage-application-rolling-upgrade/Option1-3.png)

<span data-ttu-id="69f30-150">Se il processo di aggiornamento hello ha esito negativo, ad esempio a causa di errore tooan in uno script di aggiornamento hello slot fase hello da considerare compromessi.</span><span class="sxs-lookup"><span data-stu-id="69f30-150">If hello upgrade process is unsuccessful, for example due tooan error in hello upgrade script, hello stage slot should be considered compromised.</span></span> <span data-ttu-id="69f30-151">tooroll di eseguire il backup hello toohello pre-aggiornamento lo stato dell'applicazione è sufficiente ripristinare un'applicazione hello Access toofull slot produzione di hello.</span><span class="sxs-lookup"><span data-stu-id="69f30-151">tooroll back hello application toohello pre-upgrade state you simply revert hello application in hello production slot toofull access.</span></span> <span data-ttu-id="69f30-152">passaggi Hello vengono visualizzati nel diagramma successivo hello.</span><span class="sxs-lookup"><span data-stu-id="69f30-152">hello steps involved are shown on hello next diagram.</span></span>    

1. <span data-ttu-id="69f30-153">Impostare la modalità di scrittura di tooread hello database copia (8).</span><span class="sxs-lookup"><span data-stu-id="69f30-153">Set hello database copy tooread-write mode (8).</span></span> <span data-ttu-id="69f30-154">Verranno ripristinati hello completo V1 funzionalmente nello slot di produzione hello.</span><span class="sxs-lookup"><span data-stu-id="69f30-154">This will restore hello full V1 functionally in hello production slot.</span></span>
2. <span data-ttu-id="69f30-155">Eseguire l'analisi delle cause principali hello e rimuovere componenti hello compromesso nello slot di fase hello (9).</span><span class="sxs-lookup"><span data-stu-id="69f30-155">Perform hello root cause analysis and remove hello compromised components in hello stage slot (9).</span></span> 

<span data-ttu-id="69f30-156">A questo punto l'applicazione hello è completamente funzionale e passaggi di aggiornamento hello possono essere ripetuti.</span><span class="sxs-lookup"><span data-stu-id="69f30-156">At this point hello application is fully functional and hello upgrade steps can be repeated.</span></span>

> [!NOTE]
> <span data-ttu-id="69f30-157">Hello rollback non richiede modifiche nel profilo di Traffic Manager di AZURE come già punti troppo<i>contoso 1.azurewebsites.net</i> come hello endpoint attivo.</span><span class="sxs-lookup"><span data-stu-id="69f30-157">hello rollback does not require changes in WATM profile as it already points too<i>contoso-1.azurewebsites.net</i> as hello active endpoint.</span></span>
> 
> 

![Configurazione della replica geografica del database SQL.](media/sql-database-manage-application-rolling-upgrade/Option1-4.png)

<span data-ttu-id="69f30-160">chiave Hello **vantaggio** di questa opzione è che è possibile aggiornare un'applicazione in una singola area usando un set di semplici passaggi.</span><span class="sxs-lookup"><span data-stu-id="69f30-160">hello key **advantage** of this option is that you can upgrade an application in a single region using a set of simple steps.</span></span> <span data-ttu-id="69f30-161">costo Hello dell'aggiornamento hello è relativamente bassa.</span><span class="sxs-lookup"><span data-stu-id="69f30-161">hello dollar cost of hello upgrade is relatively low.</span></span> <span data-ttu-id="69f30-162">Hello principale **compromesso** è che se si verifica un errore irreversibile durante lo stato di pre-aggiornamento hello hello aggiornamento ripristino toohello comporterà la distribuzione dell'applicazione hello in un'area diversa e il ripristino database di hello da backup con ripristino a livello geografico.</span><span class="sxs-lookup"><span data-stu-id="69f30-162">hello main **tradeoff** is that if a catastrophic failure occurs during hello upgrade hello recovery toohello pre-upgrade state will involve re-deployment of hello application in a different region and restoring hello database from backup using geo-restore.</span></span> <span data-ttu-id="69f30-163">Questo processo causa tempi di inattività significativi.</span><span class="sxs-lookup"><span data-stu-id="69f30-163">This process will result in significant downtime.</span></span>   

## <a name="upgrading-applications-that-rely-on-database-geo-replication-for-disaster-recovery"></a><span data-ttu-id="69f30-164">Aggiornamento di applicazioni basate sulla replica geografica del database per il ripristino di emergenza</span><span class="sxs-lookup"><span data-stu-id="69f30-164">Upgrading applications that rely on database geo-replication for disaster recovery</span></span>
<span data-ttu-id="69f30-165">Se l'applicazione usa la replica geografica per la continuità aziendale, è distribuito tooat almeno due aree diverse con una distribuzione attiva nell'area primaria e una distribuzione di standby nell'area di Backup.</span><span class="sxs-lookup"><span data-stu-id="69f30-165">If your application leverages geo-replication for business continuity, it is deployed  tooat least two different regions with an active deployment in Primary region and a standby deployment in Backup region.</span></span> <span data-ttu-id="69f30-166">Inoltre fattori toohello indicato in precedenza, processo di aggiornamento hello deve garantire che:</span><span class="sxs-lookup"><span data-stu-id="69f30-166">In addition toohello factors mentioned earlier, hello upgrade process must guarantee that:</span></span>

* <span data-ttu-id="69f30-167">un'applicazione Hello rimane protetta da errori irreversibili in qualsiasi momento durante il processo di aggiornamento hello</span><span class="sxs-lookup"><span data-stu-id="69f30-167">hello application remains protected from catastrophic failures at all times during hello upgrade process</span></span>
* <span data-ttu-id="69f30-168">componenti di archiviazione con ridondanza geografica Hello di un'applicazione hello vengono aggiornati in parallelo con i componenti active hello</span><span class="sxs-lookup"><span data-stu-id="69f30-168">hello geo-redundant components of hello application are upgraded in parallel with hello active components</span></span>

<span data-ttu-id="69f30-169">tooachieve tali obiettivi è possibile utilizzare Azure Traffic Manager (WATM) tramite failover hello profilo con uno attivo e tre gli endpoint di backup.</span><span class="sxs-lookup"><span data-stu-id="69f30-169">tooachieve these goals you will leverage Azure Traffic Manager (WATM) using hello failover profile with one active and three backup endpoints.</span></span>  <span data-ttu-id="69f30-170">Hello seguente diagramma illustra hello ambiente operativo toohello precedente aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="69f30-170">hello following diagram illustrates hello operational environment prior toohello upgrade process.</span></span> <span data-ttu-id="69f30-171">siti web di Hello <i>contoso 1.azurewebsites.net</i> e <i>contoso dr.azurewebsites.net</i> rappresentano uno slot di produzione dell'applicazione hello con ridondanza geografica completa.</span><span class="sxs-lookup"><span data-stu-id="69f30-171">hello web sites <i>contoso-1.azurewebsites.net</i> and <i>contoso-dr.azurewebsites.net</i> represent a production slot of hello application with full geographic redundancy.</span></span> <span data-ttu-id="69f30-172">tooenable hello possibilità tooroll nuovamente hello l'aggiornamento, è necessario creare uno slot di fase con una copia di un'applicazione hello completamente sincronizzata.</span><span class="sxs-lookup"><span data-stu-id="69f30-172">tooenable hello ability tooroll back hello upgrade, you need create a stage slot with a fully synchronized copy of hello application.</span></span> <span data-ttu-id="69f30-173">Poiché è necessario tooensure che un'applicazione hello è possibile ripristinare rapidamente nel caso in cui si verifica un errore irreversibile durante il processo di aggiornamento hello, slot fase hello deve toobe con ridondanza geografica anche.</span><span class="sxs-lookup"><span data-stu-id="69f30-173">Because you need tooensure that hello application can quickly recover in case a catastrophic failure occurs during hello upgrade process, hello stage slot needs toobe geo-redundant as well.</span></span> <span data-ttu-id="69f30-174">Hello passaggi seguenti sono un'applicazione hello tooprepare necessarie per l'aggiornamento di hello:</span><span class="sxs-lookup"><span data-stu-id="69f30-174">hello following steps are required tooprepare hello application for hello upgrade:</span></span>

1. <span data-ttu-id="69f30-175">Creare uno slot di fase per l'aggiornamento di hello.</span><span class="sxs-lookup"><span data-stu-id="69f30-175">Create a stage slot for hello upgrade.</span></span> <span data-ttu-id="69f30-176">toodo creare un database secondario (1) e distribuire una copia identica del sito web hello hello stessa area di Azure.</span><span class="sxs-lookup"><span data-stu-id="69f30-176">toodo that create a secondary database (1) and deploy an identical copy of hello web site in hello same Azure region.</span></span> <span data-ttu-id="69f30-177">Monitorare toosee secondario hello se hello seeding processo viene completato.</span><span class="sxs-lookup"><span data-stu-id="69f30-177">Monitor hello secondary toosee if hello seeding process is completed.</span></span>
2. <span data-ttu-id="69f30-178">Creare un database secondario con ridondanza geografica nello slot di fase hello mediante la replica geografica hello database secondario toohello backup area (è chiamata "concatenate replica geografica").</span><span class="sxs-lookup"><span data-stu-id="69f30-178">Create a geo-redundant secondary database in hello stage slot by geo-replicating hello secondary database toohello backup region (this is called "chained geo-replication").</span></span> <span data-ttu-id="69f30-179">Se il processo di seeding hello è completato (3), monitorare toosee secondario backup hello.</span><span class="sxs-lookup"><span data-stu-id="69f30-179">Monitor hello backup secondary toosee if hello seeding process is completed (3).</span></span>
3. <span data-ttu-id="69f30-180">Creare una copia di standby del sito web hello area backup hello e collegarlo toohello con ridondanza geografica secondario (4).</span><span class="sxs-lookup"><span data-stu-id="69f30-180">Create a standby copy of hello web site in hello backup region and link it toohello geo-redundant secondary (4).</span></span>  
4. <span data-ttu-id="69f30-181">Aggiungere altri endpoint hello <i>contoso 2.azurewebsites.net</i> e <i>contoso 3.azurewebsites.net</i> toohello un profilo di failover in Traffic Manager di AZURE come endpoint offline (5).</span><span class="sxs-lookup"><span data-stu-id="69f30-181">Add hello additional endpoints <i>contoso-2.azurewebsites.net</i> and <i>contoso-3.azurewebsites.net</i> toohello failover profile in WATM as offline endpoints (5).</span></span> 

> [!NOTE]
> <span data-ttu-id="69f30-182">Passaggi di preparazione hello nota non avrà impatto sulle applicazioni hello nello slot di produzione hello e funzionare in modalità di accesso completo.</span><span class="sxs-lookup"><span data-stu-id="69f30-182">Note hello preparation steps will not impact hello application in hello production slot and it can function in full access mode.</span></span>
> 
> 

![Configurazione della replica geografica del database SQL.](media/sql-database-manage-application-rolling-upgrade/Option2-1.png)

<span data-ttu-id="69f30-185">Dopo aver completati i passaggi di preparazione hello, slot fase hello è pronto per l'aggiornamento di hello.</span><span class="sxs-lookup"><span data-stu-id="69f30-185">Once hello preparation steps are completed, hello stage slot is ready for hello upgrade.</span></span> <span data-ttu-id="69f30-186">Hello seguente diagramma illustra i passaggi di aggiornamento hello.</span><span class="sxs-lookup"><span data-stu-id="69f30-186">hello following diagram illustrates hello upgrade steps.</span></span>

1. <span data-ttu-id="69f30-187">Impostare i database primario hello in hello slot tooread sola modalità di produzione (6).</span><span class="sxs-lookup"><span data-stu-id="69f30-187">Set hello primary database in hello production slot tooread-only mode (6).</span></span> <span data-ttu-id="69f30-188">Ciò garantisce che hello istanza di produzione di un'applicazione hello (V1) rimarrà sola lettura durante l'aggiornamento di hello, impedendo così divergenze di dati hello tra hello V1 e V2 le istanze del database.</span><span class="sxs-lookup"><span data-stu-id="69f30-188">This will guarantee that hello production instance of hello application (V1) will remain read-only during hello upgrade thus preventing hello data divergence between hello V1 and V2 database instances.</span></span>  
2. <span data-ttu-id="69f30-189">Disconnettere i database secondari hello in hello stessa regione utilizzando hello in modalità di terminazione (7).</span><span class="sxs-lookup"><span data-stu-id="69f30-189">Disconnect hello secondary database in hello same region using hello planned termination mode (7).</span></span> <span data-ttu-id="69f30-190">Creerà una copia indipendente completamente sincronizzata del database primario hello, che diventerà automaticamente un database primario dopo la terminazione hello.</span><span class="sxs-lookup"><span data-stu-id="69f30-190">It will create a fully synchronized independent copy of hello primary database, which will automatically become a primary after hello termination.</span></span> <span data-ttu-id="69f30-191">Questo database verrà aggiornato.</span><span class="sxs-lookup"><span data-stu-id="69f30-191">This database will be upgraded.</span></span>
3. <span data-ttu-id="69f30-192">Attivare database primario hello in modalità di scrittura di tooread di hello fase slot ed eseguire script di aggiornamento hello (8).</span><span class="sxs-lookup"><span data-stu-id="69f30-192">Turn hello primary database in hello stage slot tooread-write mode and run hello upgrade script (8).</span></span>    

![Configurazione della replica geografica del database SQL.](media/sql-database-manage-application-rolling-upgrade/Option2-2.png)

<span data-ttu-id="69f30-195">Se l'aggiornamento di hello è stata completata correttamente, è possibile tooswitch pronto hello agli utenti finali toohello V2 versione di hello applicazione.</span><span class="sxs-lookup"><span data-stu-id="69f30-195">If hello upgrade completed successfully you are now ready tooswitch hello end users toohello V2 version of hello application.</span></span> <span data-ttu-id="69f30-196">Hello seguente diagramma illustra hello passaggi della procedura.</span><span class="sxs-lookup"><span data-stu-id="69f30-196">hello following diagram illustrates hello steps involved.</span></span>

1. <span data-ttu-id="69f30-197">Opzione endpoint attivo hello nel profilo di Traffic Manager di AZURE hello troppo<i>contoso 2.azurewebsites.net</i>, che ora punta toohello V2 versione del sito web di hello (9).</span><span class="sxs-lookup"><span data-stu-id="69f30-197">Switch hello active endpoint in hello WATM profile too<i>contoso-2.azurewebsites.net</i>, which now points toohello V2 version of hello web site (9).</span></span> <span data-ttu-id="69f30-198">Ora diventa uno slot di produzione con hello V2 applicazione e il traffico dell'utente finale è tooit diretto.</span><span class="sxs-lookup"><span data-stu-id="69f30-198">It now becomes a production slot with hello V2 application and end-user traffic is directed tooit.</span></span> 
2. <span data-ttu-id="69f30-199">Se non è più necessaria un'applicazione hello V1 in modo è possibile rimuoverlo (10 e 11).</span><span class="sxs-lookup"><span data-stu-id="69f30-199">If you no longer need hello V1 application so you can safely remove it (10 and 11).</span></span>  

![Configurazione della replica geografica del database SQL.](media/sql-database-manage-application-rolling-upgrade/Option2-3.png)

<span data-ttu-id="69f30-202">Se il processo di aggiornamento hello ha esito negativo, ad esempio a causa di errore tooan in uno script di aggiornamento hello slot fase hello da considerare compromessi.</span><span class="sxs-lookup"><span data-stu-id="69f30-202">If hello upgrade process is unsuccessful, for example due tooan error in hello upgrade script, hello stage slot should be considered compromised.</span></span> <span data-ttu-id="69f30-203">tooroll di eseguire il backup hello toohello pre-aggiornamento lo stato dell'applicazione è sufficiente ripristinare un'applicazione hello toousing nello slot di produzione hello con accesso completo.</span><span class="sxs-lookup"><span data-stu-id="69f30-203">tooroll back hello application toohello pre-upgrade state you simply revert toousing hello application in hello production slot with full access.</span></span> <span data-ttu-id="69f30-204">passaggi Hello vengono visualizzati nel diagramma successivo hello.</span><span class="sxs-lookup"><span data-stu-id="69f30-204">hello steps involved are shown on hello next diagram.</span></span>    

1. <span data-ttu-id="69f30-205">Copia del database primario set hello in modalità di scrittura di tooread slot produzione hello (12).</span><span class="sxs-lookup"><span data-stu-id="69f30-205">Set hello primary database copy in hello production slot tooread-write mode (12).</span></span> <span data-ttu-id="69f30-206">Verranno ripristinati hello completo V1 funzionalmente nello slot di produzione hello.</span><span class="sxs-lookup"><span data-stu-id="69f30-206">This will restore hello full V1 functionally in hello production slot.</span></span>
2. <span data-ttu-id="69f30-207">Eseguire l'analisi delle cause principali hello e rimuovere componenti hello compromesso nello slot di fase hello (13 e 14).</span><span class="sxs-lookup"><span data-stu-id="69f30-207">Perform hello root cause analysis and remove hello compromised components in hello stage slot (13 and 14).</span></span> 

<span data-ttu-id="69f30-208">A questo punto l'applicazione hello è completamente funzionale e passaggi di aggiornamento hello possono essere ripetuti.</span><span class="sxs-lookup"><span data-stu-id="69f30-208">At this point hello application is fully functional and hello upgrade steps can be repeated.</span></span>

> [!NOTE]
> <span data-ttu-id="69f30-209">Hello rollback non richiede modifiche nel profilo di Traffic Manager di AZURE come già punti troppo <i>contoso 1.azurewebsites.net</i> come hello endpoint attivo.</span><span class="sxs-lookup"><span data-stu-id="69f30-209">hello rollback does not require changes in WATM profile as it already points too <i>contoso-1.azurewebsites.net</i> as hello active endpoint.</span></span>
> 
> 

![Configurazione della replica geografica del database SQL.](media/sql-database-manage-application-rolling-upgrade/Option2-4.png)

<span data-ttu-id="69f30-212">chiave Hello **vantaggio** di questa opzione è che è possibile aggiornare un'applicazione hello sia la copia in parallelo con ridondanza geografica senza compromettere la continuità aziendale durante l'aggiornamento di hello.</span><span class="sxs-lookup"><span data-stu-id="69f30-212">hello key **advantage** of this option is that you can upgrade both hello application and its geo-redundant copy in parallel without compromising your business continuity during hello upgrade.</span></span> <span data-ttu-id="69f30-213">Hello principale **compromesso** è che richiede ridondanza double di ciascun componente dell'applicazione e pertanto comporta un costo superiore.</span><span class="sxs-lookup"><span data-stu-id="69f30-213">hello main **tradeoff** is that it requires double redundancy of each application component and therefore incurs higher dollar cost.</span></span> <span data-ttu-id="69f30-214">e un flusso di lavoro più complesso.</span><span class="sxs-lookup"><span data-stu-id="69f30-214">It also involves a more complicated workflow.</span></span> 

## <a name="summary"></a><span data-ttu-id="69f30-215">Riepilogo</span><span class="sxs-lookup"><span data-stu-id="69f30-215">Summary</span></span>
<span data-ttu-id="69f30-216">diversi metodi di aggiornamento Hello due descritti nell'articolo hello complessità e hello dollaro costo, ma entrambi concentrarsi su riducendo al minimo il tempo di hello quando degli utenti finali di hello è limitate solo tooread operazioni.</span><span class="sxs-lookup"><span data-stu-id="69f30-216">hello two upgrade methods described in hello article differ in complexity and hello dollar cost but they both focus on minimizing hello time when hello end user is limited tooread-only operations.</span></span> <span data-ttu-id="69f30-217">Tale intervallo di tempo direttamente è definito per la durata dello script di aggiornamento hello hello.</span><span class="sxs-lookup"><span data-stu-id="69f30-217">That time is directly defined by hello duration of hello upgrade script.</span></span> <span data-ttu-id="69f30-218">Non dipende dalla dimensione del database hello, hello del livello servizio è stata selezionata, la configurazione del sito web hello e altri fattori che non è possibile controllare facilmente.</span><span class="sxs-lookup"><span data-stu-id="69f30-218">It does not depend on hello database size, hello service tier you chose, hello web site configuration and other factors that you cannot easily control.</span></span> <span data-ttu-id="69f30-219">In questo modo tutti i passaggi di preparazione hello vengono disaccoppiati da operazioni di aggiornamento hello e possono essere eseguiti senza alcun impatto sull'applicazione di produzione hello.</span><span class="sxs-lookup"><span data-stu-id="69f30-219">This is because all hello preparation steps are decoupled from hello upgrade steps and can be done without impacting hello production application.</span></span> <span data-ttu-id="69f30-220">l'efficienza di Hello dello script di aggiornamento hello è fattore essenziale per hello che determina l'esperienza dell'utente finale di hello durante gli aggiornamenti.</span><span class="sxs-lookup"><span data-stu-id="69f30-220">hello efficiency of hello upgrade script is hello key factor that determines hello end-user experience during upgrades.</span></span> <span data-ttu-id="69f30-221">Hello modo migliore per migliorare si concentrare le attività in esecuzione dello script di aggiornamento hello più efficiente possibile.</span><span class="sxs-lookup"><span data-stu-id="69f30-221">So hello best way you can improve it is by focusing your efforts on making hello upgrade script as efficient as possible.</span></span>  

## <a name="next-steps"></a><span data-ttu-id="69f30-222">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="69f30-222">Next steps</span></span>
* <span data-ttu-id="69f30-223">Per la panoramica e gli scenari della continuità aziendale, vedere [Continuità aziendale del database SQL di Azure](sql-database-business-continuity.md).</span><span class="sxs-lookup"><span data-stu-id="69f30-223">For a business continuity overview and scenarios, see [Business continuity overview](sql-database-business-continuity.md).</span></span>
* <span data-ttu-id="69f30-224">toolearn sui backup di Database di SQL Azure automatizzati, vedere [backup automatici di Database SQL](sql-database-automated-backups.md).</span><span class="sxs-lookup"><span data-stu-id="69f30-224">toolearn about Azure SQL Database automated backups, see [SQL Database automated backups](sql-database-automated-backups.md).</span></span>
* <span data-ttu-id="69f30-225">toolearn sull'utilizzo di backup automatico per il ripristino, vedere [ripristinare un database da backup automatizzati](sql-database-recovery-using-backups.md).</span><span class="sxs-lookup"><span data-stu-id="69f30-225">toolearn about using automated backups for recovery, see [restore a database from automated backups](sql-database-recovery-using-backups.md).</span></span>
* <span data-ttu-id="69f30-226">toolearn sulle opzioni di ripristino più veloce, vedere [replica geografica attiva](sql-database-geo-replication-overview.md).</span><span class="sxs-lookup"><span data-stu-id="69f30-226">toolearn about faster recovery options, see [active geo-replication](sql-database-geo-replication-overview.md).</span></span>


