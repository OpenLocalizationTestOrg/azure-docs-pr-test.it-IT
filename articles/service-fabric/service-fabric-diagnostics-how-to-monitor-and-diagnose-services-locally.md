---
title: Eseguire il debug di microservizi di Azure in Windows | Documentazione Microsoft
description: Informazioni su come eseguire il monitoraggio e la diagnosi dei servizi scritti usando Microsoft Azure Service Fabric in un computer di sviluppo locale.
services: service-fabric
documentationcenter: .net
author: dkkapur
manager: timlt
editor: 
ms.assetid: edcc0631-ed2d-45a3-851d-2c4fa0f4a326
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 04/24/2017
ms.author: dekapur
ms.openlocfilehash: 08998340afb2f242b9a268331607b0d1ddb9b0c6
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 07/11/2017
---
# <a name="monitor-and-diagnose-services-in-a-local-machine-development-setup"></a><span data-ttu-id="31763-103">Monitorare e diagnosticare servizi in una configurazione di sviluppo con computer locale</span><span class="sxs-lookup"><span data-stu-id="31763-103">Monitor and diagnose services in a local machine development setup</span></span>
> [!div class="op_single_selector"]
> * [<span data-ttu-id="31763-104">Windows</span><span class="sxs-lookup"><span data-stu-id="31763-104">Windows</span></span>](service-fabric-diagnostics-how-to-monitor-and-diagnose-services-locally.md)
> * [<span data-ttu-id="31763-105">Linux</span><span class="sxs-lookup"><span data-stu-id="31763-105">Linux</span></span>](service-fabric-diagnostics-how-to-monitor-and-diagnose-services-locally-linux.md)
> 
> 

<span data-ttu-id="31763-106">Le operazioni di monitoraggio, rilevamento, diagnosi e risoluzione dei problemi consentono ai servizi di continuare a funzionare con un'interruzione minima dell'esperienza utente.</span><span class="sxs-lookup"><span data-stu-id="31763-106">Monitoring, detecting, diagnosing, and troubleshooting allow for services to continue with minimal disruption to the user experience.</span></span> <span data-ttu-id="31763-107">L'efficienza delle operazioni di monitoraggio e diagnostica, essenziali in un ambiente di produzione distribuito reale, dipenderà tuttavia dall'adozione nella fase di sviluppo dei servizi di un modello analogo che ne assicuri il funzionamento anche nel mondo reale.</span><span class="sxs-lookup"><span data-stu-id="31763-107">While monitoring and diagnostics are critical in an actual deployed production environment, the efficiency will depend on adopting a similar model during development of services to ensure they work when you move to a real-world setup.</span></span> <span data-ttu-id="31763-108">Service Fabric consente agli sviluppatori di servizi di implementare facilmente un sistema di diagnostica in grado di operare senza problemi sia in ambienti di sviluppo costituiti da un unico computer locale sia in configurazioni con cluster di produzione veri e propri.</span><span class="sxs-lookup"><span data-stu-id="31763-108">Service Fabric makes it easy for service developers to implement diagnostics that can seamlessly work across both single-machine local development setups and real-world production cluster setups.</span></span>

## <a name="event-tracing-for-windows"></a><span data-ttu-id="31763-109">Event Tracing for Windows</span><span class="sxs-lookup"><span data-stu-id="31763-109">Event Tracing for Windows</span></span>
<span data-ttu-id="31763-110">[Event Tracing for Windows](https://msdn.microsoft.com/library/windows/desktop/bb968803.aspx) (ETW) è la tecnologia consigliata per il tracciamento dei messaggi in Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="31763-110">[Event Tracing for Windows](https://msdn.microsoft.com/library/windows/desktop/bb968803.aspx) (ETW) is the recommended technology for tracing messages in Service Fabric.</span></span> <span data-ttu-id="31763-111">Alcuni dei vantaggi di ETW sono i seguenti:</span><span class="sxs-lookup"><span data-stu-id="31763-111">Some benefits of using ETW are:</span></span>

* <span data-ttu-id="31763-112">**ETW è veloce.**</span><span class="sxs-lookup"><span data-stu-id="31763-112">**ETW is fast.**</span></span> <span data-ttu-id="31763-113">È stata sviluppata come tecnologia di tracciamento con un impatto minimo sui tempi di esecuzione del codice.</span><span class="sxs-lookup"><span data-stu-id="31763-113">It was built as a tracing technology that has minimal impact on code execution times.</span></span>
* <span data-ttu-id="31763-114">**ETW funziona perfettamente non solo in ambienti di sviluppo locali, ma anche in configurazioni cluster reali.**</span><span class="sxs-lookup"><span data-stu-id="31763-114">**ETW tracing works seamlessly across local development environments and also real-world cluster setups.**</span></span> <span data-ttu-id="31763-115">Questo significa che non è necessario riscrivere il codice di tracciamento quando si è pronti per distribuire il codice in un vero cluster.</span><span class="sxs-lookup"><span data-stu-id="31763-115">This  means you don't have to rewrite your tracing code when you are ready to deploy your code to a real cluster.</span></span>
* <span data-ttu-id="31763-116">**Anche il codice di sistema di Service Fabric usa ETW per il tracciamento interno.**</span><span class="sxs-lookup"><span data-stu-id="31763-116">**Service Fabric system code also uses ETW for internal tracing.**</span></span> <span data-ttu-id="31763-117">In questo modo, è possibile visualizzare le tracce dell'applicazione interfoliate con le tracce di sistema di Service Fabric</span><span class="sxs-lookup"><span data-stu-id="31763-117">This allows you to view your application traces interleaved with Service Fabric system traces.</span></span> <span data-ttu-id="31763-118">ed è più semplice comprendere le sequenze e le correlazioni tra il codice dell'applicazione e gli eventi nel sistema sottostante.</span><span class="sxs-lookup"><span data-stu-id="31763-118">It also helps you to more easily understand the sequences and interrelationships between your application code and events in the underlying system.</span></span>
* <span data-ttu-id="31763-119">**Negli strumenti di Visual Studio per Service Fabric è incorporato il supporto per la visualizzazione degli eventi ETW.**</span><span class="sxs-lookup"><span data-stu-id="31763-119">**There is built-in support in Service Fabric Visual Studio tools to view ETW events.**</span></span> <span data-ttu-id="31763-120">Gli eventi ETW possono essere visualizzati nella visualizzazione Eventi di diagnostica di Visual Studio dopo aver configurato correttamente Visual Studio con Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="31763-120">ETW events appear in the Diagnostic Events view of Visual Studio once Visual Studio is correctly configured with Service Fabric.</span></span> 

## <a name="view-service-fabric-system-events-in-visual-studio"></a><span data-ttu-id="31763-121">Visualizzare gli eventi di sistema di Service Fabric in Visual Studio</span><span class="sxs-lookup"><span data-stu-id="31763-121">View Service Fabric system events in Visual Studio</span></span>
<span data-ttu-id="31763-122">Service Fabric emette eventi ETW per aiutare gli sviluppatori di applicazioni a capire cosa sta accadendo nella piattaforma.</span><span class="sxs-lookup"><span data-stu-id="31763-122">Service Fabric emits ETW events to help application developers understand what's happening in the platform.</span></span> <span data-ttu-id="31763-123">Se necessario, andare avanti e seguire la procedura descritta in [Creare la prima applicazione in Visual Studio](service-fabric-create-your-first-application-in-visual-studio.md).</span><span class="sxs-lookup"><span data-stu-id="31763-123">If you haven't already done so, go ahead and follow the steps in [Creating your first application in Visual Studio](service-fabric-create-your-first-application-in-visual-studio.md).</span></span> <span data-ttu-id="31763-124">per creare ed eseguire un'applicazione in cui il visualizzatore degli eventi di diagnostica mostra i messaggi di traccia.</span><span class="sxs-lookup"><span data-stu-id="31763-124">This information will help you get an application up and running with the Diagnostics Events Viewer showing the trace messages.</span></span>

1. <span data-ttu-id="31763-125">Se la finestra degli eventi di diagnostica non viene visualizzata automaticamente, passare alla scheda **Visualizza** in Visual Studio, scegliere **Altre finestre** e quindi **Visualizzatore eventi di diagnostica**.</span><span class="sxs-lookup"><span data-stu-id="31763-125">If the diagnostics events window does not automatically show, Go to the **View** tab in Visual Studio, choose **Other Windows** and then **Diagnostic Events Viewer**.</span></span>
2. <span data-ttu-id="31763-126">Per ogni evento sono disponibili informazioni di metadati standard che indicano il nodo, l'applicazione e il servizio da cui proviene l'evento.</span><span class="sxs-lookup"><span data-stu-id="31763-126">Each event has standard metadata information that tells you the node, application and service the event is coming from.</span></span> <span data-ttu-id="31763-127">È anche possibile filtrare l'elenco degli eventi usando la casella **Filtra eventi** nella parte superiore della finestra.</span><span class="sxs-lookup"><span data-stu-id="31763-127">You can also filter the list of events by using the **Filter events** box at the top of the events window.</span></span> <span data-ttu-id="31763-128">Ad esempio, è possibile filtrare in base al **nome del nodo** o al **nome del servizio**.</span><span class="sxs-lookup"><span data-stu-id="31763-128">For example, you can filter on **Node Name** or **Service Name.**</span></span> <span data-ttu-id="31763-129">Se si cercano informazioni dettagliate su un evento, è anche possibile sospendere la sessione tramite il pulsante **Pausa** nella parte superiore della finestra degli eventi e riprendere in un secondo momento senza alcuna perdita di eventi.</span><span class="sxs-lookup"><span data-stu-id="31763-129">And when you're looking at event details, you can also pause by using the **Pause** button at the top of the events window and resume later without any loss of events.</span></span>
   
   ![Visualizzatore eventi di diagnostica di Visual Studio](./media/service-fabric-diagnostics-how-to-monitor-and-diagnose-services-locally/DiagEventsExamples2.png)

## <a name="add-your-own-custom-traces-to-the-application-code"></a><span data-ttu-id="31763-131">Aggiungere tracce personalizzate al codice dell'applicazione</span><span class="sxs-lookup"><span data-stu-id="31763-131">Add your own custom traces to the application code</span></span>
<span data-ttu-id="31763-132">I modelli di progetto di Visual Studio per Service Fabric contengono codice di esempio.</span><span class="sxs-lookup"><span data-stu-id="31763-132">The Service Fabric Visual Studio project templates contain sample code.</span></span> <span data-ttu-id="31763-133">Il codice mostra come aggiungere tracce ETW personalizzate al codice dell'applicazione, visibili nel visualizzatore ETW di Visual Studio insieme alle tracce di sistema di Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="31763-133">The code shows how to add custom application code ETW traces that show up in the Visual Studio ETW viewer alongside system traces from Service Fabric.</span></span> <span data-ttu-id="31763-134">Adottando questo metodo, i metadati vengono automaticamente aggiunti alle tracce e il visualizzatore degli eventi di diagnostica di Visual Studio è già configurato per visualizzarli.</span><span class="sxs-lookup"><span data-stu-id="31763-134">The advantage of this method is that metadata is automatically added to traces, and the Visual Studio Diagnostic Events Viewer is already configured to display them.</span></span>

<span data-ttu-id="31763-135">Per i progetti creati a partire da **modelli di servizio** (con o senza stato), è sufficiente cercare l'implementazione `RunAsync`:</span><span class="sxs-lookup"><span data-stu-id="31763-135">For projects created from the **service templates** (stateless or stateful) just search for the `RunAsync` implementation:</span></span>

1. <span data-ttu-id="31763-136">La chiamata a `ServiceEventSource.Current.ServiceMessage` in the `RunAsync` mostra un esempio di una traccia ETW personalizzata del codice dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="31763-136">The call to `ServiceEventSource.Current.ServiceMessage` in the `RunAsync` method shows an example of a custom ETW trace from the application code.</span></span>
2. <span data-ttu-id="31763-137">Nel file **ServiceEventSource.cs** si noterà un overload per il metodo `ServiceEventSource.ServiceMessage`, che è opportuno usare per eventi ad alta frequenza dovuti a motivi di prestazioni.</span><span class="sxs-lookup"><span data-stu-id="31763-137">In the **ServiceEventSource.cs** file, you will find an overload for the `ServiceEventSource.ServiceMessage` method that should be used for high-frequency events due to performance reasons.</span></span>

<span data-ttu-id="31763-138">Per i progetti creati da **modelli di attore** (con o senza stato):</span><span class="sxs-lookup"><span data-stu-id="31763-138">For projects created from the **actor templates** (stateless or stateful):</span></span>

1. <span data-ttu-id="31763-139">Aprire il file **"NomeProgetto".cs** , dove *NomeProgetto* è il nome scelto per il progetto di Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="31763-139">Open the **"ProjectName".cs** file where *ProjectName* is the name you chose for your Visual Studio project.</span></span>  
2. <span data-ttu-id="31763-140">Trovare il codice `ActorEventSource.Current.ActorMessage(this, "Doing Work");` nel metodo *DoWorkAsync* .</span><span class="sxs-lookup"><span data-stu-id="31763-140">Find the code `ActorEventSource.Current.ActorMessage(this, "Doing Work");` in the *DoWorkAsync* method.</span></span>  <span data-ttu-id="31763-141">Questo è un esempio di una traccia ETW personalizzata scritta dal codice dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="31763-141">This is an example of a custom ETW trace written from application code.</span></span>  
3. <span data-ttu-id="31763-142">Nel file **ActorEventSource.cs** si noterà un overload per il metodo `ActorEventSource.ActorMessage`, che è opportuno usare per eventi ad alta frequenza dovuti a motivi di prestazioni.</span><span class="sxs-lookup"><span data-stu-id="31763-142">In file **ActorEventSource.cs**, you will find an overload for the `ActorEventSource.ActorMessage` method that should be used for high-frequency events due to performance reasons.</span></span>

<span data-ttu-id="31763-143">Dopo aver aggiunto il tracciamento ETW personalizzato al codice del servizio, sarà possibile compilare, distribuire ed eseguire nuovamente l'applicazione in modo che gli eventi risultino visibili nel visualizzatore degli eventi di diagnostica.</span><span class="sxs-lookup"><span data-stu-id="31763-143">After adding custom ETW tracing to your service code, you can build, deploy, and run the application again to see your event(s) in the Diagnostic Events Viewer.</span></span> <span data-ttu-id="31763-144">Se si esegue il debug dell'applicazione con **F5**, il visualizzatore verrà aperto automaticamente.</span><span class="sxs-lookup"><span data-stu-id="31763-144">If you debug the application with **F5**, the Diagnostic Events Viewer will open automatically.</span></span>

## <a name="next-steps"></a><span data-ttu-id="31763-145">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="31763-145">Next steps</span></span>
<span data-ttu-id="31763-146">Lo stesso codice di traccia aggiunto all'applicazione precedente per la diagnostica locale potrà essere usato con gli stessi strumenti di cui è possibile avvalersi per visualizzare gli eventi quando si esegue l'applicazione in un cluster di Azure.</span><span class="sxs-lookup"><span data-stu-id="31763-146">The same tracing code that you added to your application above for local diagnostics will work with tools that you can use to view these events when running your application on an Azure cluster.</span></span> <span data-ttu-id="31763-147">Leggere questi articoli che illustrano le diverse opzioni per gli strumenti e descrivono come configurarle.</span><span class="sxs-lookup"><span data-stu-id="31763-147">Check out these articles that discuss the different options for the tools and describe how you can set them up.</span></span>

* [<span data-ttu-id="31763-148">Come raccogliere log con Diagnostica di Azure</span><span class="sxs-lookup"><span data-stu-id="31763-148">How to collect logs with Azure Diagnostics</span></span>](service-fabric-diagnostics-how-to-setup-wad.md)
* [<span data-ttu-id="31763-149">Aggregazione e raccolta di eventi con EventFlow</span><span class="sxs-lookup"><span data-stu-id="31763-149">Event aggregation and collection using EventFlow</span></span>](service-fabric-diagnostics-event-aggregation-eventflow.md)

