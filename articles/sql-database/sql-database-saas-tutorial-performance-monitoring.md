---
title: prestazioni aaaMonitor di molti database SQL di Azure in un'applicazione SaaS multi-tenant | Documenti Microsoft
description: Monitorare e gestire le prestazioni di database e i pool di app di Azure SQL Database Wingtip SaaS hello
keywords: esercitazione database SQL
services: sql-database
documentationcenter: 
author: stevestein
manager: craigg
editor: 
ms.assetid: 
ms.service: sql-database
ms.custom: scale out apps
ms.workload: data-management
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/26/2017
ms.author: sstein
ms.openlocfilehash: f0d7ba456c485b7de249a56abac3cf4be3857285
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/06/2017
---
# <a name="monitor-performance-of-hello-wingtip-saas-application"></a><span data-ttu-id="9acf4-104">Monitorare le prestazioni dell'applicazione SaaS Wingtip hello</span><span class="sxs-lookup"><span data-stu-id="9acf4-104">Monitor performance of hello Wingtip SaaS application</span></span>

<span data-ttu-id="9acf4-105">In questa esercitazione vengono illustrati diversi scenari di gestione delle prestazioni chiave usati nelle applicazioni SaaS.</span><span class="sxs-lookup"><span data-stu-id="9acf4-105">In this tutorial, several key performance management scenarios used in SaaS applications are explored.</span></span> <span data-ttu-id="9acf4-106">Usa un'attività di toosimulate generatore di carico in tutti i database tenant, vengono illustrate funzionalità di monitoraggio incorporate hello e le funzionalità di avvisi di Database SQL e i pool elastici.</span><span class="sxs-lookup"><span data-stu-id="9acf4-106">Using a load generator toosimulate activity across all tenant databases, hello built-in monitoring and alerting features of SQL Database and elastic pools are demonstrated.</span></span>

<span data-ttu-id="9acf4-107">app SaaS Wingtip Hello utilizza un modello di dati single-tenant, in cui per ogni sessione (tenant) ha il proprio database.</span><span class="sxs-lookup"><span data-stu-id="9acf4-107">hello Wingtip SaaS app uses a single-tenant data model, where each venue (tenant) has their own database.</span></span> <span data-ttu-id="9acf4-108">Come molte applicazioni SaaS, hello previsto modello di carico di lavoro tenant è imprevedibile e sporadico.</span><span class="sxs-lookup"><span data-stu-id="9acf4-108">Like many SaaS applications, hello anticipated tenant workload pattern is unpredictable and sporadic.</span></span> <span data-ttu-id="9acf4-109">In altre parole, le vendite di biglietti possono verificarsi in qualsiasi momento.</span><span class="sxs-lookup"><span data-stu-id="9acf4-109">In other words, ticket sales may occur at any time.</span></span> <span data-ttu-id="9acf4-110">tootake vantaggio di questo modello di utilizzo tipico di database, i database vengono distribuiti nel pool di database elastici tenant.</span><span class="sxs-lookup"><span data-stu-id="9acf4-110">tootake advantage of this typical database usage pattern, tenant databases are deployed into elastic database pools.</span></span> <span data-ttu-id="9acf4-111">Pool elastici ottimizzare costi hello di una soluzione di condivisione risorse tra più database.</span><span class="sxs-lookup"><span data-stu-id="9acf4-111">Elastic pools optimize hello cost of a solution by sharing resources across many databases.</span></span> <span data-ttu-id="9acf4-112">Con questo tipo di modello, è importante toomonitor database e tooensure di utilizzo di risorse del pool che carica ragionevolmente sono bilanciati da una serie.</span><span class="sxs-lookup"><span data-stu-id="9acf4-112">With this type of pattern, it's important toomonitor database and pool resource usage tooensure that loads are reasonably balanced across pools.</span></span> <span data-ttu-id="9acf4-113">È inoltre necessario tooensure che singoli database dispongano risorse adeguate, e che i pool non raggiunge le [eDTU](sql-database-what-is-a-dtu.md) limiti.</span><span class="sxs-lookup"><span data-stu-id="9acf4-113">You also need tooensure that individual databases have adequate resources, and that pools are not hitting their [eDTU](sql-database-what-is-a-dtu.md) limits.</span></span> <span data-ttu-id="9acf4-114">In questa esercitazione vengono illustrati modi toomonitor e gestire database e i pool e come tootake azione correttiva in risposta toovariations nel carico di lavoro.</span><span class="sxs-lookup"><span data-stu-id="9acf4-114">This tutorial explores ways toomonitor and manage databases and pools, and how tootake corrective action in response toovariations in workload.</span></span>

<span data-ttu-id="9acf4-115">In questa esercitazione si apprenderà come:</span><span class="sxs-lookup"><span data-stu-id="9acf4-115">In this tutorial you learn how to:</span></span>

> [!div class="checklist"]

> * <span data-ttu-id="9acf4-116">Simulare l'utilizzo nel database tenant hello eseguendo un generatore di carico specificato</span><span class="sxs-lookup"><span data-stu-id="9acf4-116">Simulate usage on hello tenant databases by running a provided load generator</span></span>
> * <span data-ttu-id="9acf4-117">I database tenant hello Monitor come rispondono toohello aumento del carico</span><span class="sxs-lookup"><span data-stu-id="9acf4-117">Monitor hello tenant databases as they respond toohello increase in load</span></span>
> * <span data-ttu-id="9acf4-118">Applicare la scalabilità verticale hello pool elastico nel caricamento del database maggiore toohello risposta</span><span class="sxs-lookup"><span data-stu-id="9acf4-118">Scale up hello Elastic pool in response toohello increased database load</span></span>
> * <span data-ttu-id="9acf4-119">Eseguire il provisioning di una seconda attività di database di saldo tooload pool elastico</span><span class="sxs-lookup"><span data-stu-id="9acf4-119">Provision a second Elastic pool tooload balance database activity</span></span>


<span data-ttu-id="9acf4-120">toocomplete completamento di questa esercitazione, assicurarsi che i hello seguenti prerequisiti:</span><span class="sxs-lookup"><span data-stu-id="9acf4-120">toocomplete this tutorial, make sure hello following prerequisites are completed:</span></span>

* <span data-ttu-id="9acf4-121">app SaaS Wingtip Hello viene distribuita.</span><span class="sxs-lookup"><span data-stu-id="9acf4-121">hello Wingtip SaaS app is deployed.</span></span> <span data-ttu-id="9acf4-122">toodeploy in meno di cinque minuti, vedere [Distribuisci ed esplorare l'applicazione SaaS Wingtip hello](sql-database-saas-tutorial.md)</span><span class="sxs-lookup"><span data-stu-id="9acf4-122">toodeploy in less than five minutes, see [Deploy and explore hello Wingtip SaaS application](sql-database-saas-tutorial.md)</span></span>
* <span data-ttu-id="9acf4-123">Azure PowerShell è installato.</span><span class="sxs-lookup"><span data-stu-id="9acf4-123">Azure PowerShell is installed.</span></span> <span data-ttu-id="9acf4-124">Per informazioni dettagliate, vedere [Introduzione ad Azure PowerShell](https://docs.microsoft.com/powershell/azure/get-started-azureps)</span><span class="sxs-lookup"><span data-stu-id="9acf4-124">For details, see [Getting started with Azure PowerShell](https://docs.microsoft.com/powershell/azure/get-started-azureps)</span></span>

## <a name="introduction-toosaas-performance-management-patterns"></a><span data-ttu-id="9acf4-125">Modelli di gestione delle prestazioni tooSaaS introduzione</span><span class="sxs-lookup"><span data-stu-id="9acf4-125">Introduction tooSaaS performance management patterns</span></span>

<span data-ttu-id="9acf4-126">La gestione delle prestazioni del database consiste di compilazione e l'analisi dei dati delle prestazioni e quindi reazione toothis dati modificando i parametri toomaintain tempi di risposta accettabili per l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="9acf4-126">Managing database performance consists of compiling and analyzing performance data, and then reacting toothis data by adjusting parameters toomaintain an acceptable response time for your application.</span></span> <span data-ttu-id="9acf4-127">Quando si ospitano più tenant, pool di database elastici sono tooprovide un modo economico e gestire le risorse per un gruppo di database con carichi di lavoro imprevedibile.</span><span class="sxs-lookup"><span data-stu-id="9acf4-127">When hosting multiple tenants, Elastic database pools are a cost-effective way tooprovide and manage resources for a group of databases with unpredictable workloads.</span></span> <span data-ttu-id="9acf4-128">Con determinati modelli di carico di lavoro, anche solo due database S3 possono trarre vantaggio dalla gestione in un pool.</span><span class="sxs-lookup"><span data-stu-id="9acf4-128">With certain workload patterns, as few as two S3 databases can benefit from being managed in a pool.</span></span>

![diagramma](./media/sql-database-saas-tutorial-performance-monitoring/app-diagram.png)

<span data-ttu-id="9acf4-130">I pool e dei database hello in pool, devono essere monitorato tooensure rimangono all'interno di intervalli accettabili di prestazioni.</span><span class="sxs-lookup"><span data-stu-id="9acf4-130">Pools, and hello databases in pools, should be monitored tooensure they stay within acceptable ranges of performance.</span></span> <span data-ttu-id="9acf4-131">Ottimizzare hello pool toomeet hello esigenze di configurazione del carico di aggregazione hello di tutti i database, garantendo che siano appropriate per hello hello Edtu del pool di carico di lavoro complessivo.</span><span class="sxs-lookup"><span data-stu-id="9acf4-131">Tune hello pool configuration toomeet hello needs of hello aggregate workload of all databases, ensuring that hello pool eDTUs are appropriate for hello overall workload.</span></span> <span data-ttu-id="9acf4-132">Regola hello per ogni database min e per ogni database eDTU max valori tooappropriate i valori per i requisiti specifici dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="9acf4-132">Adjust hello per-database min and per-database max eDTU values tooappropriate values for your specific application requirements.</span></span>

### <a name="performance-management-strategies"></a><span data-ttu-id="9acf4-133">Strategie per la gestione delle prestazioni</span><span class="sxs-lookup"><span data-stu-id="9acf4-133">Performance management strategies</span></span>

* <span data-ttu-id="9acf4-134">tooavoid con toomanually monitoraggio delle prestazioni, è più efficace troppo**impostare gli avvisi che attivano quando i database o i pool Cometa fuori intervalli normali**.</span><span class="sxs-lookup"><span data-stu-id="9acf4-134">tooavoid having toomanually monitor performance, it’s most effective too**set alerts that trigger when databases or pools stray out of normal ranges**.</span></span>
* <span data-ttu-id="9acf4-135">le fluttuazioni tooshort termine toorespond hello aggregazione livello di prestazioni di un pool di hello **livello di eDTU del pool può essere scalata verso l'alto o verso il basso**.</span><span class="sxs-lookup"><span data-stu-id="9acf4-135">toorespond tooshort-term fluctuations in hello aggregate performance level of a pool, hello **pool eDTU level can be scaled up or down**.</span></span> <span data-ttu-id="9acf4-136">Se si verifica a intervalli regolari o prevedibili, questo fluttuazione **ridimensionamento pool hello può essere pianificato toooccur automaticamente**.</span><span class="sxs-lookup"><span data-stu-id="9acf4-136">If this fluctuation occurs on a regular or predictable basis, **scaling hello pool can be scheduled toooccur automatically**.</span></span> <span data-ttu-id="9acf4-137">Ad esempio, ridurre il numero di eDTU quando il carico di lavoro è notoriamente leggero, ad esempio durante la notte o nei fine settimana.</span><span class="sxs-lookup"><span data-stu-id="9acf4-137">For example, scale down when you know your workload is light, maybe overnight, or during weekends.</span></span>
* <span data-ttu-id="9acf4-138">numero di database, di hello fluttuazioni toolonger termine toorespond o modifiche in **singoli database possono essere spostati in altri pool**.</span><span class="sxs-lookup"><span data-stu-id="9acf4-138">toorespond toolonger-term fluctuations, or changes in hello number of databases, **individual databases can be moved into other pools**.</span></span>
* <span data-ttu-id="9acf4-139">termine tooshort toorespond un aumento *singoli* caricamento del database **singoli database possono essere eseguiti da un pool e assegnati un livello di prestazioni singoli**.</span><span class="sxs-lookup"><span data-stu-id="9acf4-139">toorespond tooshort term increases in *individual* database load **individual databases can be taken out of a pool and assigned an individual performance level**.</span></span> <span data-ttu-id="9acf4-140">Una volta che viene ridotto carico hello, database hello può quindi essere restituito toohello pool.</span><span class="sxs-lookup"><span data-stu-id="9acf4-140">Once hello load is reduced, hello database can then be returned toohello pool.</span></span> <span data-ttu-id="9acf4-141">Quando è noto in anticipo, database possono essere spostati preventivamente tooensure hello database sono sempre inclusi hello risorse che necessarie e tooavoid impatto su altri database nel pool di hello.</span><span class="sxs-lookup"><span data-stu-id="9acf4-141">When this is known in advance, databases can be moved pre-emptively tooensure hello database always has hello resources it needs, and tooavoid impact on other databases in hello pool.</span></span> <span data-ttu-id="9acf4-142">Se questo requisito è stimabile, ad esempio un evento che ha rilevato un urgente di vendite ticket per un evento comune, questo comportamento di gestione può essere integrato in un'applicazione hello.</span><span class="sxs-lookup"><span data-stu-id="9acf4-142">If this requirement is predictable, such as a venue experiencing a rush of ticket sales for a popular event, then this management behavior can be integrated into hello application.</span></span>

<span data-ttu-id="9acf4-143">Hello [portale di Azure](https://portal.azure.com) fornisce avvisi nella maggior parte delle risorse e monitoraggio incorporati.</span><span class="sxs-lookup"><span data-stu-id="9acf4-143">hello [Azure portal](https://portal.azure.com) provides built-in monitoring and alerting on most resources.</span></span> <span data-ttu-id="9acf4-144">Per il database SQL, il monitoraggio e gli avvisi sono disponibili per database e pool.</span><span class="sxs-lookup"><span data-stu-id="9acf4-144">For SQL Database, monitoring and alerting is available on databases and pools.</span></span> <span data-ttu-id="9acf4-145">Questo incorporati di monitoraggio e avviso sono specifici delle risorse, pertanto è comodo toouse per un numero limitato di risorse, ma non è molto utile quando si utilizzano molte risorse.</span><span class="sxs-lookup"><span data-stu-id="9acf4-145">This built-in monitoring and alerting is resource-specific, so it's convenient toouse for small numbers of resources, but is not very convenient when working with many resources.</span></span>

<span data-ttu-id="9acf4-146">Per gli scenari con volumi elevati in cui si lavora con molte risorse, si può usare [Log Analytics (OMS)](sql-database-saas-tutorial-log-analytics.md).</span><span class="sxs-lookup"><span data-stu-id="9acf4-146">For high-volume scenarios where you're working with many reources, [Log Analytics (OMS)](sql-database-saas-tutorial-log-analytics.md) can be used.</span></span> <span data-ttu-id="9acf4-147">Si tratta di un servizio di Azure separato che fornisce funzionalità di analisi per log di diagnostica e dati di telemetria raccolti in un'area di lavoro di Log Analytics.</span><span class="sxs-lookup"><span data-stu-id="9acf4-147">This is a separate Azure service that provides analytics over emitted diagnostic logs and telemetry gathered in a log analytics workspace.</span></span> <span data-ttu-id="9acf4-148">Log Analitica possibile raccogliere dati di telemetria da diversi servizi e tooquery utilizzato e impostare gli avvisi.</span><span class="sxs-lookup"><span data-stu-id="9acf4-148">Log Analytics can collect telemetry from many services and be used tooquery and set alerts.</span></span>

## <a name="get-hello-wingtip-application-source-code-and-scripts"></a><span data-ttu-id="9acf4-149">Ottenere gli script e codice sorgente dell'applicazione hello Wingtip</span><span class="sxs-lookup"><span data-stu-id="9acf4-149">Get hello Wingtip application source code and scripts</span></span>

<span data-ttu-id="9acf4-150">Hello Wingtip SaaS script e codice sorgente dell'applicazione sono disponibili in hello [WingtipSaaS](https://github.com/Microsoft/WingtipSaaS) repository github.</span><span class="sxs-lookup"><span data-stu-id="9acf4-150">hello Wingtip SaaS scripts and application source code are available in hello [WingtipSaaS](https://github.com/Microsoft/WingtipSaaS) github repo.</span></span> <span data-ttu-id="9acf4-151">[I passaggi di script di SaaS Wingtip hello toodownload](sql-database-wtp-overview.md#download-and-unblock-the-wingtip-saas-scripts).</span><span class="sxs-lookup"><span data-stu-id="9acf4-151">[Steps toodownload hello Wingtip SaaS scripts](sql-database-wtp-overview.md#download-and-unblock-the-wingtip-saas-scripts).</span></span>

## <a name="provision-additional-tenants"></a><span data-ttu-id="9acf4-152">Eseguire il provisioning di altri tenant</span><span class="sxs-lookup"><span data-stu-id="9acf4-152">Provision additional tenants</span></span>

<span data-ttu-id="9acf4-153">I pool possono essere conveniente con due database S3, hello più database che si trovano in hello pool hello più economica hello Media effettiva diventa.</span><span class="sxs-lookup"><span data-stu-id="9acf4-153">While pools can be cost-effective with just two S3 databases, hello more databases that are in hello pool hello more cost-effective hello averaging effect becomes.</span></span> <span data-ttu-id="9acf4-154">Per comprendere meglio il funzionamento della gestione e del monitoraggio delle prestazioni su larga scala, per questa esercitazione è necessario distribuire almeno 20 database.</span><span class="sxs-lookup"><span data-stu-id="9acf4-154">For a good understanding of how performance monitoring and management works at scale, this tutorial requires you have at least 20 databases deployed.</span></span>

<span data-ttu-id="9acf4-155">Se già stato eseguito il provisioning un batch di tenant in un'esercitazione precedente, ignorare toohello [simulare l'utilizzo in tutti i database tenant](#simulate-usage-on-all-tenant-databases) sezione.</span><span class="sxs-lookup"><span data-stu-id="9acf4-155">If you already provisioned a batch of tenants in a prior tutorial, skip toohello [Simulate usage on all tenant databases](#simulate-usage-on-all-tenant-databases) section.</span></span>

1. <span data-ttu-id="9acf4-156">Apri... \\Moduli learning\\gestione e monitoraggio delle prestazioni\\*Demo PerformanceMonitoringAndManagement.ps1* in hello *PowerShell ISE*.</span><span class="sxs-lookup"><span data-stu-id="9acf4-156">Open …\\Learning Modules\\Performance Monitoring and Management\\*Demo-PerformanceMonitoringAndManagement.ps1* in hello *PowerShell ISE*.</span></span> <span data-ttu-id="9acf4-157">Mantenere lo script aperto durante l'esecuzione dei vari scenari presentati in questa esercitazione.</span><span class="sxs-lookup"><span data-stu-id="9acf4-157">Keep this script open as you'll run several scenarios during this tutorial.</span></span>
1. <span data-ttu-id="9acf4-158">Impostare **$DemoScenario** = **1**, **Effettuare il provisioning di un batch di tenant**</span><span class="sxs-lookup"><span data-stu-id="9acf4-158">Set **$DemoScenario** = **1**, **Provision a batch of tenants**</span></span>
1. <span data-ttu-id="9acf4-159">Premere **F5** script hello toorun.</span><span class="sxs-lookup"><span data-stu-id="9acf4-159">Press **F5** toorun hello script.</span></span>

<span data-ttu-id="9acf4-160">script Hello distribuirà 17 tenant in meno di cinque minuti.</span><span class="sxs-lookup"><span data-stu-id="9acf4-160">hello script will deploy 17 tenants in less than five minutes.</span></span>

<span data-ttu-id="9acf4-161">Hello *New TenantBatch* script utilizza un set di nidificata o collegato [Gestione risorse](../azure-resource-manager/index.md) modelli per la creazione di un batch di tenant, che per impostazione predefinita consente di copiare database hello **basetenantdb** hello catalogo server toocreate hello nuovo database tenant, quindi viene registrata nel catalogo di hello e infine li inizializza con il tipo di nome e la sede tenant hello.</span><span class="sxs-lookup"><span data-stu-id="9acf4-161">hello *New-TenantBatch* script uses a nested or linked set of [Resource Manager](../azure-resource-manager/index.md) templates that create a batch of tenants, which by default copies hello database **basetenantdb** on hello catalog server toocreate hello new tenant databases, then registers these in hello catalog, and finally initializes them with hello tenant name and venue type.</span></span> <span data-ttu-id="9acf4-162">Ciò è coerente con la modalità di hello hello app esegue il provisioning di un nuovo tenant.</span><span class="sxs-lookup"><span data-stu-id="9acf4-162">This is consistent with hello way hello app provisions a new tenant.</span></span> <span data-ttu-id="9acf4-163">Tutte le modifiche apportate troppo*basetenantdb* vengono applicati tooany stato successivamente eseguito il provisioning di nuovi tenant.</span><span class="sxs-lookup"><span data-stu-id="9acf4-163">Any changes made too*basetenantdb* are applied tooany new tenants provisioned thereafter.</span></span> <span data-ttu-id="9acf4-164">Vedere hello [esercitazione la gestione dello Schema](sql-database-saas-tutorial-schema-management.md) toosee come schema toomake cambia troppo*esistente* tenant database (inclusi hello *basetenantdb* database).</span><span class="sxs-lookup"><span data-stu-id="9acf4-164">See hello [Schema Management tutorial](sql-database-saas-tutorial-schema-management.md) toosee how toomake schema changes too*existing* tenant databases (including hello *basetenantdb* database).</span></span>

## <a name="simulate-usage-on-all-tenant-databases"></a><span data-ttu-id="9acf4-165">Simulare l'utilizzo in tutti i database tenant</span><span class="sxs-lookup"><span data-stu-id="9acf4-165">Simulate usage on all tenant databases</span></span>

<span data-ttu-id="9acf4-166">Hello *Demo PerformanceMonitoringAndManagement.ps1* script viene specificato che simula un carico di lavoro in esecuzione su tutti i database tenant.</span><span class="sxs-lookup"><span data-stu-id="9acf4-166">hello *Demo-PerformanceMonitoringAndManagement.ps1* script is provided that simulates a workload running against all tenant databases.</span></span> <span data-ttu-id="9acf4-167">carico Hello viene generato utilizzando uno degli scenari di hello carico disponibili:</span><span class="sxs-lookup"><span data-stu-id="9acf4-167">hello load is generated using one of hello available load scenarios:</span></span>

| <span data-ttu-id="9acf4-168">Demo</span><span class="sxs-lookup"><span data-stu-id="9acf4-168">Demo</span></span> | <span data-ttu-id="9acf4-169">Scenario</span><span class="sxs-lookup"><span data-stu-id="9acf4-169">Scenario</span></span> |
|:--|:--|
| <span data-ttu-id="9acf4-170">2</span><span class="sxs-lookup"><span data-stu-id="9acf4-170">2</span></span> | <span data-ttu-id="9acf4-171">Generare un carico di intensità normale (circa 40 DTU)</span><span class="sxs-lookup"><span data-stu-id="9acf4-171">Generate normal intensity load (approx. 40 DTU)</span></span> |
| <span data-ttu-id="9acf4-172">3</span><span class="sxs-lookup"><span data-stu-id="9acf4-172">3</span></span> | <span data-ttu-id="9acf4-173">Generare un carico con picchi più lunghi e più frequenti per ogni database</span><span class="sxs-lookup"><span data-stu-id="9acf4-173">Generate load with longer and more frequent bursts per database</span></span>|
| <span data-ttu-id="9acf4-174">4</span><span class="sxs-lookup"><span data-stu-id="9acf4-174">4</span></span> | <span data-ttu-id="9acf4-175">Generare un carico con picchi DTU maggiori per ogni database (circa 80 DTU)</span><span class="sxs-lookup"><span data-stu-id="9acf4-175">Generate load with higher DTU bursts per database (approx. 80 DTU)</span></span>|
| <span data-ttu-id="9acf4-176">5</span><span class="sxs-lookup"><span data-stu-id="9acf4-176">5</span></span> | <span data-ttu-id="9acf4-177">Generare un carico normale e un carico elevato in un singolo tenant (circa 95 DTU)</span><span class="sxs-lookup"><span data-stu-id="9acf4-177">Generate a normal load plus a high load on a single tenant (approx. 95 DTU)</span></span>|
| <span data-ttu-id="9acf4-178">6</span><span class="sxs-lookup"><span data-stu-id="9acf4-178">6</span></span> | <span data-ttu-id="9acf4-179">Generare un carico non bilanciato su più pool</span><span class="sxs-lookup"><span data-stu-id="9acf4-179">Generate unbalanced load across multiple pools</span></span>|

<span data-ttu-id="9acf4-180">Generatore di carico Hello si applica un *sintetica* database tenant tooevery di carico solo della CPU.</span><span class="sxs-lookup"><span data-stu-id="9acf4-180">hello load generator applies a *synthetic* CPU-only load tooevery tenant database.</span></span> <span data-ttu-id="9acf4-181">Generatore di Hello avvia un processo per ogni database tenant, che chiama periodicamente una stored procedure che genera l'errore carico hello.</span><span class="sxs-lookup"><span data-stu-id="9acf4-181">hello generator starts a job for each tenant database, which calls a stored procedure periodically that generates hello load.</span></span> <span data-ttu-id="9acf4-182">all'interno di intervalli, la durata e livelli di carico hello (in Edtu) in tutti i database, simulando attività tenant imprevedibile.</span><span class="sxs-lookup"><span data-stu-id="9acf4-182">hello load levels (in eDTUs), duration, and intervals are varied across all databases, simulating unpredictable tenant activity.</span></span>

1. <span data-ttu-id="9acf4-183">Apri... \\Moduli learning\\gestione e monitoraggio delle prestazioni\\*Demo PerformanceMonitoringAndManagement.ps1* in hello *PowerShell ISE*.</span><span class="sxs-lookup"><span data-stu-id="9acf4-183">Open …\\Learning Modules\\Performance Monitoring and Management\\*Demo-PerformanceMonitoringAndManagement.ps1* in hello *PowerShell ISE*.</span></span> <span data-ttu-id="9acf4-184">Mantenere lo script aperto durante l'esecuzione dei vari scenari presentati in questa esercitazione.</span><span class="sxs-lookup"><span data-stu-id="9acf4-184">Keep this script open as you'll run several scenarios during this tutorial.</span></span>
1. <span data-ttu-id="9acf4-185">Impostare **$DemoScenario** = **2**, *Generare un carico di intensità normale*.</span><span class="sxs-lookup"><span data-stu-id="9acf4-185">Set **$DemoScenario** = **2**, *Generate normal intensity load*.</span></span>
1. <span data-ttu-id="9acf4-186">Premere **F5** tooapply tooall un carico ai database tenant.</span><span class="sxs-lookup"><span data-stu-id="9acf4-186">Press **F5** tooapply a load tooall your tenant databases.</span></span>

<span data-ttu-id="9acf4-187">Wingtip è un'applicazione SaaS e carico di lavoro reale hello in un'app SaaS è in genere sporadici e imprevedibili.</span><span class="sxs-lookup"><span data-stu-id="9acf4-187">Wingtip is a SaaS app, and hello real-world load on a SaaS app is typically sporadic and unpredictable.</span></span> <span data-ttu-id="9acf4-188">toosimulate questo hello carico generatore genera un carico casuale distribuito tra tutti i tenant.</span><span class="sxs-lookup"><span data-stu-id="9acf4-188">toosimulate this, hello load generator produces a randomized load distributed across all tenants.</span></span> <span data-ttu-id="9acf4-189">Hello carico modello tooemerge, eseguire il generatore di carico hello per 3-5 minuti prima di tentare il carico di hello toomonitor in hello le sezioni seguenti sono necessari alcuni minuti.</span><span class="sxs-lookup"><span data-stu-id="9acf4-189">Several minutes are needed for hello load pattern tooemerge, so run hello load generator for 3-5 minutes before attempting toomonitor hello load in hello following sections.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="9acf4-190">Generatore di carico Hello è in esecuzione come una serie di processi nella sessione di PowerShell locale.</span><span class="sxs-lookup"><span data-stu-id="9acf4-190">hello load generator is running as a series of jobs in your local PowerShell session.</span></span> <span data-ttu-id="9acf4-191">Mantenere hello *Demo PerformanceMonitoringAndManagement.ps1* scheda aperta.</span><span class="sxs-lookup"><span data-stu-id="9acf4-191">Keep hello *Demo-PerformanceMonitoringAndManagement.ps1* tab open!</span></span> <span data-ttu-id="9acf4-192">Se si chiude la scheda hello o sospende la macchina, il generatore di carico hello arresta.</span><span class="sxs-lookup"><span data-stu-id="9acf4-192">If you close hello tab, or suspend your machine, hello load generator stops.</span></span> <span data-ttu-id="9acf4-193">Generatore di carico Hello rimane in un *chiamata processo* stato in cui genera carico eventuali nuovi tenant sottoposti a provisioning dopo l'avvio del generatore di hello.</span><span class="sxs-lookup"><span data-stu-id="9acf4-193">hello load generator remains in a *job-invoking* state where it generates load on any new tenants that are provisioned after hello generator is started.</span></span> <span data-ttu-id="9acf4-194">Utilizzare *Ctrl-C* toostop il richiamo di nuovi processi e script di uscita hello.</span><span class="sxs-lookup"><span data-stu-id="9acf4-194">Use *Ctrl-C* toostop invoking new jobs and exit hello script.</span></span> <span data-ttu-id="9acf4-195">Generatore di carico Hello continuerà toorun, ma solo per i tenant esistenti.</span><span class="sxs-lookup"><span data-stu-id="9acf4-195">hello load generator will continue toorun, but only on existing tenants.</span></span>

## <a name="monitor-resource-usage-using-hello-azure-portal"></a><span data-ttu-id="9acf4-196">Monitorare l'utilizzo di risorse utilizzando hello portale di Azure</span><span class="sxs-lookup"><span data-stu-id="9acf4-196">Monitor resource usage using hello Azure portal</span></span>

<span data-ttu-id="9acf4-197">utilizzo delle risorse di hello toomonitor risultati hello caricare viene applicato, aprire il pool di portale toohello hello che contiene i database tenant hello:</span><span class="sxs-lookup"><span data-stu-id="9acf4-197">toomonitor hello resource usage that results from hello load being applied, open hello portal toohello pool containing hello tenant databases:</span></span>

1. <span data-ttu-id="9acf4-198">Aprire hello [portale di Azure](https://portal.azure.com) ed esplorare toohello *tenants1 -&lt;utente&gt;*  server.</span><span class="sxs-lookup"><span data-stu-id="9acf4-198">Open hello [Azure portal](https://portal.azure.com) and browse toohello *tenants1-&lt;USER&gt;* server.</span></span>
1. <span data-ttu-id="9acf4-199">Scorrere verso il basso e individuare i pool elastici, quindi fare clic su **Pool1**.</span><span class="sxs-lookup"><span data-stu-id="9acf4-199">Scroll down and locate elastic pools and click **Pool1**.</span></span> <span data-ttu-id="9acf4-200">Questo pool contiene tutti i database di tenant hello creati finora.</span><span class="sxs-lookup"><span data-stu-id="9acf4-200">This pool contains all hello tenant databases created so far.</span></span>

<span data-ttu-id="9acf4-201">Osservare hello **monitoraggio pool elastico** e **monitoraggio di database elastico** grafici.</span><span class="sxs-lookup"><span data-stu-id="9acf4-201">Observe hello **Elastic pool monitoring** and **Elastic database monitoring** charts.</span></span>

<span data-ttu-id="9acf4-202">Hello utilizzo delle risorse del pool è hello utilizzo di database di aggregazione per tutti i database nel pool di hello.</span><span class="sxs-lookup"><span data-stu-id="9acf4-202">hello pool's resource utilization is hello aggregate database utilization for all databases in hello pool.</span></span> <span data-ttu-id="9acf4-203">Hello database Mostra hello cinque database interessanti:</span><span class="sxs-lookup"><span data-stu-id="9acf4-203">hello database chart shows hello five hottest databases:</span></span>

![](./media/sql-database-saas-tutorial-performance-monitoring/pool1.png)

<span data-ttu-id="9acf4-204">Poiché sono presenti altri database nel pool di hello oltre hello primi cinque, utilizzo pool hello Mostra l'attività che non vengono riportate nel grafico di hello primi cinque database.</span><span class="sxs-lookup"><span data-stu-id="9acf4-204">Because there are additional databases in hello pool beyond hello top five, hello pool utilization shows activity that is not reflected in hello top five databases chart.</span></span> <span data-ttu-id="9acf4-205">Per altri dettagli, fare clic su **Utilizzo risorse database**:</span><span class="sxs-lookup"><span data-stu-id="9acf4-205">For additional details, click **Database Resource Utilization**:</span></span>

![](./media/sql-database-saas-tutorial-performance-monitoring/database-utilization.png)


## <a name="set-performance-alerts-on-hello-pool"></a><span data-ttu-id="9acf4-206">Impostare avvisi sulle prestazioni nel pool di hello</span><span class="sxs-lookup"><span data-stu-id="9acf4-206">Set performance alerts on hello pool</span></span>

<span data-ttu-id="9acf4-207">Impostare un avviso per il pool hello che attiva \>75% l'utilizzo come indicato di seguito:</span><span class="sxs-lookup"><span data-stu-id="9acf4-207">Set an alert on hello pool that triggers on \>75% utilization as follows:</span></span>

1. <span data-ttu-id="9acf4-208">Aprire *Pool1* (su hello *tenants1 -\<utente\>*  server) in hello [portale di Azure](https://portal.azure.com).</span><span class="sxs-lookup"><span data-stu-id="9acf4-208">Open *Pool1* (on hello *tenants1-\<user\>* server) in hello [Azure portal](https://portal.azure.com).</span></span>
1. <span data-ttu-id="9acf4-209">Fare clic su **Regole di avviso** e quindi fare clic su **+ Aggiungi avviso**:</span><span class="sxs-lookup"><span data-stu-id="9acf4-209">Click **Alert Rules**, and then click **+ Add alert**:</span></span>

   ![aggiungere un avviso](media/sql-database-saas-tutorial-performance-monitoring/add-alert.png)

1. <span data-ttu-id="9acf4-211">Specificare un nome, ad esempio **DTU elevate**.</span><span class="sxs-lookup"><span data-stu-id="9acf4-211">Provide a name, such as **High DTU**,</span></span>
1. <span data-ttu-id="9acf4-212">Impostare hello seguenti valori:</span><span class="sxs-lookup"><span data-stu-id="9acf4-212">Set hello following values:</span></span>
   * <span data-ttu-id="9acf4-213">**Metrica = Percentuale eDTU**</span><span class="sxs-lookup"><span data-stu-id="9acf4-213">**Metric = eDTU percentage**</span></span>
   * <span data-ttu-id="9acf4-214">**Condizione = maggiore di** .</span><span class="sxs-lookup"><span data-stu-id="9acf4-214">**Condition = greater than**.</span></span>
   * <span data-ttu-id="9acf4-215">**Soglia = 75**.</span><span class="sxs-lookup"><span data-stu-id="9acf4-215">**Threshold = 75**.</span></span>
   * <span data-ttu-id="9acf4-216">**Periodo = su hello ultimi 30 minuti**.</span><span class="sxs-lookup"><span data-stu-id="9acf4-216">**Period = Over hello last 30 minutes**.</span></span>
1. <span data-ttu-id="9acf4-217">Aggiungere un toohello indirizzo di posta elettronica *amministratore aggiuntive email(s)* casella e fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="9acf4-217">Add an email address toohello *Additional administrator email(s)* box and click **OK**.</span></span>

   ![impostare l'avviso](media/sql-database-saas-tutorial-performance-monitoring/alert-rule.png)


## <a name="scale-up-a-busy-pool"></a><span data-ttu-id="9acf4-219">Potenziare un pool con carico eccessivo</span><span class="sxs-lookup"><span data-stu-id="9acf4-219">Scale up a busy pool</span></span>

<span data-ttu-id="9acf4-220">Se il livello di carico di aggregazione hello aumenta in un punto di toohello pool che potenzia pool hello e viene raggiunto il 100% eDTU, quindi le prestazioni dei singoli database è interessato, potenzialmente rallentare i tempi di risposta delle query per tutti i database nel pool di hello.</span><span class="sxs-lookup"><span data-stu-id="9acf4-220">If hello aggregate load level increases on a pool toohello point that it maxes out hello pool and reaches 100% eDTU usage, then individual database performance is affected, potentially slowing query response times for all databases in hello pool.</span></span>

<span data-ttu-id="9acf4-221">**A breve termine**, prendere in considerazione l'aumento di risorse aggiuntive di hello pool tooprovide o rimozione di database dal pool hello (spostarli tooother pool, o all'esterno di livello di servizio autonomo hello pool tooa).</span><span class="sxs-lookup"><span data-stu-id="9acf4-221">**Short term**, consider scaling up hello pool tooprovide additional resources, or removing databases from hello pool (moving them tooother pools, or out of hello pool tooa stand-alone service tier).</span></span>

<span data-ttu-id="9acf4-222">**Lungo termine**, prendere in considerazione l'ottimizzazione delle query o un indice delle prestazioni del database tooimprove utilizzo.</span><span class="sxs-lookup"><span data-stu-id="9acf4-222">**Longer term**, consider optimizing queries or index usage tooimprove database performance.</span></span> <span data-ttu-id="9acf4-223">A seconda di hello tooperformance sensibilità dell'applicazione emette relativo tooscale prassi migliori un pool di backup prima di raggiungere l'utilizzo di eDTU 100%.</span><span class="sxs-lookup"><span data-stu-id="9acf4-223">Depending on hello application's sensitivity tooperformance issues its best practice tooscale a pool up before it reaches 100% eDTU usage.</span></span> <span data-ttu-id="9acf4-224">Utilizzare un avviso toowarn è in anticipo.</span><span class="sxs-lookup"><span data-stu-id="9acf4-224">Use an alert toowarn you in advance.</span></span>

<span data-ttu-id="9acf4-225">È possibile simulare un pool occupato dall'incremento del carico hello prodotta dal generatore di hello.</span><span class="sxs-lookup"><span data-stu-id="9acf4-225">You can simulate a busy pool by increasing hello load produced by hello generator.</span></span> <span data-ttu-id="9acf4-226">Senza modificare i requisiti di hello di singoli database hello, causando hello database tooburst più di frequente e per il carico di aggregazione hello più lungo, incremento nel pool di hello.</span><span class="sxs-lookup"><span data-stu-id="9acf4-226">Causing hello databases tooburst more frequently, and for longer, increasing hello aggregate load on hello pool without changing hello requirements of hello individual databases.</span></span> <span data-ttu-id="9acf4-227">Ridimensionamento del pool di hello facilmente viene eseguito nel portale di hello o da PowerShell.</span><span class="sxs-lookup"><span data-stu-id="9acf4-227">Scaling up hello pool is easily done in hello portal or from PowerShell.</span></span> <span data-ttu-id="9acf4-228">Questo esercizio Usa il portale di hello.</span><span class="sxs-lookup"><span data-stu-id="9acf4-228">This exercise uses hello portal.</span></span>

1. <span data-ttu-id="9acf4-229">Impostare *$DemoScenario* = **3**, _carico genera con burst più frequenti e più tempo per ogni database_ intensità hello tooincrease di carico di aggregazione hello pool di Hello senza modificare il carico di picco hello necessario per ogni database.</span><span class="sxs-lookup"><span data-stu-id="9acf4-229">Set *$DemoScenario* = **3**, _Generate load with longer and more frequent bursts per database_ tooincrease hello intensity of hello aggregate load on hello pool without changing hello peak load required by each database.</span></span>
1. <span data-ttu-id="9acf4-230">Premere **F5** tooapply tooall un carico ai database tenant.</span><span class="sxs-lookup"><span data-stu-id="9acf4-230">Press **F5** tooapply a load tooall your tenant databases.</span></span>

1. <span data-ttu-id="9acf4-231">Andare troppo**Pool1** in hello portale di Azure.</span><span class="sxs-lookup"><span data-stu-id="9acf4-231">Go too**Pool1** in hello Azure portal.</span></span>

<span data-ttu-id="9acf4-232">Hello monitoraggio maggiore utilizzo di eDTU del pool nel grafico superiore hello.</span><span class="sxs-lookup"><span data-stu-id="9acf4-232">Monitor hello increased pool eDTU usage on hello upper chart.</span></span> <span data-ttu-id="9acf4-233">Sono necessari alcuni minuti per hello nuovo maggiore carico tookick, ma rapidamente dovrebbe pool hello iniziare utilizzo max toohit e come carico hello steadies nel nuovo modello di hello, esegue l'overload rapidamente pool hello.</span><span class="sxs-lookup"><span data-stu-id="9acf4-233">It takes a few minutes for hello new higher load tookick in, but you should quickly see hello pool start toohit max utilization, and as hello load steadies into hello new pattern, it rapidly overloads hello pool.</span></span>

1. <span data-ttu-id="9acf4-234">Fare clic su tooscale pool hello, **configurare pool** nella parte superiore di hello di hello **Pool1** pagina.</span><span class="sxs-lookup"><span data-stu-id="9acf4-234">tooscale up hello pool, click **Configure pool** at hello top of hello **Pool1** page.</span></span>
1. <span data-ttu-id="9acf4-235">Regolare hello **eDTU Pool** impostazione troppo**100**.</span><span class="sxs-lookup"><span data-stu-id="9acf4-235">Adjust hello **Pool eDTU** setting too**100**.</span></span> <span data-ttu-id="9acf4-236">La modifica di eDTU del pool hello non modifica le impostazioni per ogni database hello (che è ancora 50 eDTU massimo per database).</span><span class="sxs-lookup"><span data-stu-id="9acf4-236">Changing hello pool eDTU does not change hello per-database settings (which is still 50 eDTU max per database).</span></span> <span data-ttu-id="9acf4-237">È possibile visualizzare le impostazioni per ogni database hello sul lato destro hello di hello **configurare pool** pagina.</span><span class="sxs-lookup"><span data-stu-id="9acf4-237">You can see hello per-database settings on hello right side of hello **Configure pool** page.</span></span>
1. <span data-ttu-id="9acf4-238">Fare clic su **salvare** pool hello tooscale di toosubmit hello richiesta.</span><span class="sxs-lookup"><span data-stu-id="9acf4-238">Click **Save** toosubmit hello request tooscale hello pool.</span></span>

<span data-ttu-id="9acf4-239">Tornare indietro troppo**Pool1** > **Panoramica** hello tooview grafici di monitoraggio.</span><span class="sxs-lookup"><span data-stu-id="9acf4-239">Go back too**Pool1** > **Overview** tooview hello monitoring charts.</span></span> <span data-ttu-id="9acf4-240">Monitorare l'effetto di hello della specifica del pool di hello maggiore quantità di risorse (anche se con un carico casuale e alcuni database non è sempre toosee facile concludere finché non viene eseguito per un certo tempo).</span><span class="sxs-lookup"><span data-stu-id="9acf4-240">Monitor hello effect of providing hello pool with more resources (although with few databases and a randomized load it’s not always easy toosee conclusively until you run for some time).</span></span> <span data-ttu-id="9acf4-241">Mentre si sta esaminando hello grafici tenere presente il 100% in hello superiore ora grafico rappresenta 100 Edtu, mentre in hello inferiore grafico 100% è ancora 50 Edtu come hello max per ogni database è ancora 50 Edtu.</span><span class="sxs-lookup"><span data-stu-id="9acf4-241">While you are looking at hello charts bear in mind that 100% on hello upper chart now represents 100 eDTUs, while on hello lower chart 100% is still 50 eDTUs as hello per-database max is still 50 eDTUs.</span></span>

<span data-ttu-id="9acf4-242">I database rimangono completamente disponibili durante il processo di hello e online.</span><span class="sxs-lookup"><span data-stu-id="9acf4-242">Databases remain online and fully available throughout hello process.</span></span> <span data-ttu-id="9acf4-243">In hello ultimo momento di ogni database è pronto toobe abilitata con hello nuovo numero di eDTU pool, tutte le connessioni attive vengono interrotte.</span><span class="sxs-lookup"><span data-stu-id="9acf4-243">At hello last moment as each database is ready toobe enabled with hello new pool eDTU, any active connections are broken.</span></span> <span data-ttu-id="9acf4-244">Il codice dell'applicazione deve sempre scritto connessioni tooretry eliminato, quindi si riconnetterà toohello database nel pool di hello con scalabilità verticale.</span><span class="sxs-lookup"><span data-stu-id="9acf4-244">Application code should always be written tooretry dropped connections, and so will reconnect toohello database in hello scaled-up pool.</span></span>

## <a name="load-balance-between-pools"></a><span data-ttu-id="9acf4-245">Bilanciare il carico tra i pool</span><span class="sxs-lookup"><span data-stu-id="9acf4-245">Load balance between pools</span></span>

<span data-ttu-id="9acf4-246">Come un'alternativa tooscaling pool hello, creare un pool di secondo e spostare i database in cui vengono toobalance hello caricare tra hello due pool.</span><span class="sxs-lookup"><span data-stu-id="9acf4-246">As an alternative tooscaling up hello pool, create a second pool and move databases into it toobalance hello load between hello two pools.</span></span> <span data-ttu-id="9acf4-247">Questo nuovo pool di hello devono essere creati in toodo hello prima hello nello stesso server.</span><span class="sxs-lookup"><span data-stu-id="9acf4-247">toodo this hello new pool must be created on hello same server as hello first.</span></span>

1. <span data-ttu-id="9acf4-248">In hello [portale di Azure](https://portal.azure.com)aprire hello **tenants1 -&lt;utente&gt;**  server.</span><span class="sxs-lookup"><span data-stu-id="9acf4-248">In hello [Azure portal](https://portal.azure.com), open hello **tenants1-&lt;USER&gt;** server.</span></span>
1. <span data-ttu-id="9acf4-249">Fare clic su **+ nuovo pool** toocreate un pool di server corrente hello.</span><span class="sxs-lookup"><span data-stu-id="9acf4-249">Click **+ New pool** toocreate a pool on hello current server.</span></span>
1. <span data-ttu-id="9acf4-250">In hello **pool di database elastici** modello:</span><span class="sxs-lookup"><span data-stu-id="9acf4-250">On hello **Elastic database pool** template:</span></span>

    1. <span data-ttu-id="9acf4-251">Impostare **nome** troppo*Pool2*.</span><span class="sxs-lookup"><span data-stu-id="9acf4-251">Set **Name** too*Pool2*.</span></span>
    1. <span data-ttu-id="9acf4-252">Lasciare hello tariffario come **Pool Standard**.</span><span class="sxs-lookup"><span data-stu-id="9acf4-252">Leave hello pricing tier as **Standard Pool**.</span></span>
    1. <span data-ttu-id="9acf4-253">Fare clic su **Configura pool**.</span><span class="sxs-lookup"><span data-stu-id="9acf4-253">Click **Configure pool**,</span></span>
    1. <span data-ttu-id="9acf4-254">Impostare **eDTU Pool** troppo*eDTU 50*.</span><span class="sxs-lookup"><span data-stu-id="9acf4-254">Set **Pool eDTU** too*50 eDTU*.</span></span>
    1. <span data-ttu-id="9acf4-255">Fare clic su **aggiungere database** toosee un elenco di database nel server di hello che può essere aggiunto troppo*Pool2*.</span><span class="sxs-lookup"><span data-stu-id="9acf4-255">Click **Add databases** toosee a list of databases on hello server that can be added too*Pool2*.</span></span>
    1. <span data-ttu-id="9acf4-256">Selezionare qualsiasi toomove 10 database queste toohello nuovo pool e quindi fare clic su **selezionare**.</span><span class="sxs-lookup"><span data-stu-id="9acf4-256">Select any 10 databases toomove these toohello new pool, and then click **Select**.</span></span> <span data-ttu-id="9acf4-257">Se si è in esecuzione il generatore di carico hello, servizio hello già sa che il profilo di prestazioni richiede un più ampio pool di dimensioni predefinite del 50 eDTU hello e consiglia di iniziare con un'impostazione di eDTU 100.</span><span class="sxs-lookup"><span data-stu-id="9acf4-257">If you've been running hello load generator, hello service already knows that your performance profile requires a larger pool than hello default 50 eDTU size and recommends starting with a 100 eDTU setting.</span></span>

    ![Suggerimento](media/sql-database-saas-tutorial-performance-monitoring/configure-pool.png)

    1. <span data-ttu-id="9acf4-259">Per questa esercitazione, lasciare l'impostazione predefinita di hello nella finestra di 50 Edtu e fare clic su **selezionare** nuovamente.</span><span class="sxs-lookup"><span data-stu-id="9acf4-259">For this tutorial, leave hello default at 50 eDTUs, and click **Select** again.</span></span>
    1. <span data-ttu-id="9acf4-260">Selezionare **OK** toocreate hello nuovo pool e toomove hello nei database selezionati al suo interno.</span><span class="sxs-lookup"><span data-stu-id="9acf4-260">Select **OK** toocreate hello new pool and toomove hello selected databases into it.</span></span>

<span data-ttu-id="9acf4-261">Creazione di pool di hello e lo spostamento di database hello richiede alcuni minuti.</span><span class="sxs-lookup"><span data-stu-id="9acf4-261">Creating hello pool and moving hello databases takes a few minutes.</span></span> <span data-ttu-id="9acf4-262">Come i database vengono spostati che rimangono in linea e completamente accessibili fino a quando l'ultimo momento hello a quel punto vengono chiuse tutte le connessioni aperte.</span><span class="sxs-lookup"><span data-stu-id="9acf4-262">As databases are moved they remain online and fully accessible until hello very last moment, at which point any open connections are closed.</span></span> <span data-ttu-id="9acf4-263">Se si dispone di una logica di tentativi, i client si connettono quindi toohello database nel nuovo pool di hello.</span><span class="sxs-lookup"><span data-stu-id="9acf4-263">As long as you have some retry logic, clients will then connect toohello database in hello new pool.</span></span>

<span data-ttu-id="9acf4-264">Sfoglia troppo**Pool2** (su hello *tenants1* server) tooopen hello pool e monitorarne le prestazioni.</span><span class="sxs-lookup"><span data-stu-id="9acf4-264">Browse too**Pool2** (on hello *tenants1* server) tooopen hello pool and monitor its performance.</span></span> <span data-ttu-id="9acf4-265">Se non è visualizzata, attendere per il provisioning di hello nuovo pool toocomplete.</span><span class="sxs-lookup"><span data-stu-id="9acf4-265">If you don't see it, wait for provisioning of hello new pool toocomplete.</span></span>

<span data-ttu-id="9acf4-266">Si nota ora una riduzione dell'utilizzo delle risorse di *Pool1* e un carico simile per *Pool2*.</span><span class="sxs-lookup"><span data-stu-id="9acf4-266">You now see that resource usage on *Pool1* has dropped and that *Pool2* is now similarly loaded.</span></span>

## <a name="manage-performance-of-a-single-database"></a><span data-ttu-id="9acf4-267">Gestire le prestazioni di un database singolo</span><span class="sxs-lookup"><span data-stu-id="9acf4-267">Manage performance of a single database</span></span>

<span data-ttu-id="9acf4-268">Se un singolo database in un pool di cui si verifichi un elevato carico, a seconda della configurazione del pool di hello, può tendono risorse hello toodominate nel pool di hello e l'impatto di altri database.</span><span class="sxs-lookup"><span data-stu-id="9acf4-268">If a single database in a pool experiences a sustained high load, depending on hello pool configuration, it may tend toodominate hello resources in hello pool and impact other databases.</span></span> <span data-ttu-id="9acf4-269">Se l'attività hello è probabilmente toocontinue per un certo tempo, hello database può essere spostato temporaneamente fuori pool hello.</span><span class="sxs-lookup"><span data-stu-id="9acf4-269">If hello activity is likely toocontinue for some time, hello database can be temporarily moved out of hello pool.</span></span> <span data-ttu-id="9acf4-270">In questo modo hello di hello database toohave risorse aggiuntive necessarie e isola da hello altri database.</span><span class="sxs-lookup"><span data-stu-id="9acf4-270">This allows hello database toohave hello extra resources it needs, and isolates it from hello other databases.</span></span>

<span data-ttu-id="9acf4-271">Questo esercizio simula l'effetto di hello di Contoso insieme Hall sottoposto a un carico elevato quando i ticket in vendita per un insieme comune.</span><span class="sxs-lookup"><span data-stu-id="9acf4-271">This exercise simulates hello effect of Contoso Concert Hall experiencing a high load when tickets go on sale for a popular concert.</span></span>

1. <span data-ttu-id="9acf4-272">Aprire hello... \\ *Demo PerformanceMonitoringAndManagement.ps1* script.</span><span class="sxs-lookup"><span data-stu-id="9acf4-272">Open hello …\\*Demo-PerformanceMonitoringAndManagement.ps1* script.</span></span>
1. <span data-ttu-id="9acf4-273">Impostare **$DemoScenario = 5, Generare un carico normale e un carico elevato in un singolo tenant (circa 95 DTU).**</span><span class="sxs-lookup"><span data-stu-id="9acf4-273">Set **$DemoScenario = 5, Generate a normal load plus a high load on a single tenant (approx. 95 DTU).**</span></span>
1. <span data-ttu-id="9acf4-274">Impostare **$SingleTenantDatabaseName = contosoconcerthall**</span><span class="sxs-lookup"><span data-stu-id="9acf4-274">Set **$SingleTenantDatabaseName = contosoconcerthall**</span></span>
1. <span data-ttu-id="9acf4-275">Eseguire tramite script hello **F5**.</span><span class="sxs-lookup"><span data-stu-id="9acf4-275">Execute hello script using **F5**.</span></span>


1. <span data-ttu-id="9acf4-276">In hello [portale di Azure](https://portal.azure.com) aprire **Pool1**.</span><span class="sxs-lookup"><span data-stu-id="9acf4-276">In hello [Azure portal](https://portal.azure.com) open **Pool1**.</span></span>
1. <span data-ttu-id="9acf4-277">Controllare hello **monitoraggio pool elastico** del grafico e cercare hello maggiore utilizzo di eDTU del pool.</span><span class="sxs-lookup"><span data-stu-id="9acf4-277">Inspect hello **Elastic pool monitoring** chart and look for hello increased pool eDTU usage.</span></span> <span data-ttu-id="9acf4-278">Dopo un minuto o due, inizieranno tookick in carichi più elevati hello e rapidamente dovrebbe essere che il pool di hello raggiunge l'utilizzo del 100%.</span><span class="sxs-lookup"><span data-stu-id="9acf4-278">After a minute or two, hello higher load should start tookick in, and you should quickly see that hello pool hits 100% utilization.</span></span>
1. <span data-ttu-id="9acf4-279">Controllare hello **monitoraggio di database elastico** visualizzazione che mostra i database più interessanti hello hello ora precedente.</span><span class="sxs-lookup"><span data-stu-id="9acf4-279">Inspect hello **Elastic database monitoring** display which shows hello hottest databases in hello past hour.</span></span> <span data-ttu-id="9acf4-280">Hello *contosoconcerthall* database non appena vengono visualizzate come uno dei database di hello cinque più interessanti.</span><span class="sxs-lookup"><span data-stu-id="9acf4-280">hello *contosoconcerthall* database should soon appear as one of hello five hottest databases.</span></span>
1. <span data-ttu-id="9acf4-281">**Fare clic su monitoraggio di database elastico hello** **grafico** e aprirla hello **utilizzo delle risorse di Database** pagina in cui è possibile monitorare i database hello.</span><span class="sxs-lookup"><span data-stu-id="9acf4-281">**Click on hello Elastic database monitoring** **chart** and it opens hello **Database Resource Utilization** page where you can monitor any of hello databases.</span></span> <span data-ttu-id="9acf4-282">Ciò consente di isolare visualizzazione hello per hello *contosoconcerthall* database.</span><span class="sxs-lookup"><span data-stu-id="9acf4-282">This lets you isolate hello display for hello *contosoconcerthall* database.</span></span>
1. <span data-ttu-id="9acf4-283">Elenco di hello dei database, fare clic su **contosoconcerthall**.</span><span class="sxs-lookup"><span data-stu-id="9acf4-283">From hello list of databases, click **contosoconcerthall**.</span></span>
1. <span data-ttu-id="9acf4-284">Fare clic su **tariffario (scala Dtu)** tooopen hello **configurare prestazioni** pagina in cui è possibile impostare un livello di prestazioni autonome per database hello.</span><span class="sxs-lookup"><span data-stu-id="9acf4-284">Click **Pricing Tier (scale DTUs)** tooopen hello **Configure performance** page where you can set a stand-alone performance level for hello database.</span></span>
1. <span data-ttu-id="9acf4-285">Fare clic su hello **Standard** scheda Opzioni di scalabilità hello tooopen nel livello Standard hello.</span><span class="sxs-lookup"><span data-stu-id="9acf4-285">Click on hello **Standard** tab tooopen hello scale options in hello Standard tier.</span></span>
1. <span data-ttu-id="9acf4-286">Diapositiva hello **dispositivo di scorrimento DTU** tooright tooselect **100** Dtu.</span><span class="sxs-lookup"><span data-stu-id="9acf4-286">Slide hello **DTU slider** tooright tooselect **100** DTUs.</span></span> <span data-ttu-id="9acf4-287">Notare che questo corrisponde l'obiettivo di servizio toohello, **S3**.</span><span class="sxs-lookup"><span data-stu-id="9acf4-287">Note this corresponds toohello service objective, **S3**.</span></span>
1. <span data-ttu-id="9acf4-288">Fare clic su **applica** toomove hello database dal pool hello e renderlo un *S3 Standard* database.</span><span class="sxs-lookup"><span data-stu-id="9acf4-288">Click **Apply** toomove hello database out of hello pool and make it a *Standard S3* database.</span></span>
1. <span data-ttu-id="9acf4-289">Dopo il ridimensionamento è completata, monitoraggio hello effetto sul database contosoconcerthall hello e Pool1 in pannelli di pool e il database elastici hello.</span><span class="sxs-lookup"><span data-stu-id="9acf4-289">Once scaling is complete, monitor hello effect on hello contosoconcerthall database and Pool1 on hello elastic pool and database blades.</span></span>

<span data-ttu-id="9acf4-290">Una volta che un carico elevato sul database contosoconcerthall hello hello diminuisce è necessario immediatamente restituirla toohello pool tooreduce il costo.</span><span class="sxs-lookup"><span data-stu-id="9acf4-290">Once hello high load on hello contosoconcerthall database subsides you should promptly return it toohello pool tooreduce its cost.</span></span> <span data-ttu-id="9acf4-291">Se non è chiaro che verrà eseguito quando è stato possibile impostare un avviso nel database di hello che verrà attivata quando l'utilizzo DTU scende di sotto di hello per ogni database max pool hello.</span><span class="sxs-lookup"><span data-stu-id="9acf4-291">If it’s unclear when that will happen you could set an alert on hello database that will trigger when its DTU usage drops below hello per-database max on hello pool.</span></span> <span data-ttu-id="9acf4-292">Lo spostamento di un database in un pool è descritto nell'esercizio 5.</span><span class="sxs-lookup"><span data-stu-id="9acf4-292">Moving a database into a pool is described in exercise 5.</span></span>

## <a name="other-performance-management-patterns"></a><span data-ttu-id="9acf4-293">Altri modelli di gestione delle prestazioni</span><span class="sxs-lookup"><span data-stu-id="9acf4-293">Other Performance Management Patterns</span></span>

<span data-ttu-id="9acf4-294">**Scalabilità preventiva** nell'esercizio hello precedente in cui si esplorata come tooscale un database isolato, sapendo quali toolook database per.</span><span class="sxs-lookup"><span data-stu-id="9acf4-294">**Pre-emptive scaling** In hello exercise above where you explored how tooscale an isolated database, you knew which database toolook for.</span></span> <span data-ttu-id="9acf4-295">Se Gestione hello di Contoso insieme Hall era informata Wingtips di vendita ticket imminente hello, database hello potrebbe essere stati spostati all'esterno pool hello preventivamente.</span><span class="sxs-lookup"><span data-stu-id="9acf4-295">If hello management of Contoso Concert Hall had informed Wingtips of hello impending ticket sale, hello database could have been moved out of hello pool pre-emptively.</span></span> <span data-ttu-id="9acf4-296">In caso contrario, probabile che richiede un avviso in pool hello o hello database toospot Qual era il problema.</span><span class="sxs-lookup"><span data-stu-id="9acf4-296">Otherwise, it would likely have required an alert on hello pool or hello database toospot what was happening.</span></span> <span data-ttu-id="9acf4-297">Se non vuoi toolearn informazioni da hello altri tenant nel pool che segnala che di hello di riduzione delle prestazioni.</span><span class="sxs-lookup"><span data-stu-id="9acf4-297">You wouldn’t want toolearn about this from hello other tenants in hello pool complaining of degraded performance.</span></span> <span data-ttu-id="9acf4-298">E se il tenant hello possibile stimare quanti sono necessari ulteriori risorse, è possibile configurare un database di automazione di Azure runbook toomove hello fuori pool hello e quindi di nuovo su una pianificazione definita.</span><span class="sxs-lookup"><span data-stu-id="9acf4-298">And if hello tenant can predict how long they will need additional resources you can set up an Azure Automation runbook toomove hello database out of hello pool and then back in again on a defined schedule.</span></span>

<span data-ttu-id="9acf4-299">**Tenant self-service scalabilità** perché il ridimensionamento è un'attività denominata facilmente tramite l'API di gestione di hello, è possibile facilmente compilare il possibilità hello database tenant tooscale nell'applicazione Web tenant e offrirlo come una funzionalità del servizio SaaS.</span><span class="sxs-lookup"><span data-stu-id="9acf4-299">**Tenant self-service scaling** Because scaling is a task easily called via hello management API, you can easily build hello ability tooscale tenant databases into your tenant-facing application, and offer it as a feature of your SaaS service.</span></span> <span data-ttu-id="9acf4-300">Ad esempio, consentire ai tenant self-administer scalabilità verticale e, forse collegati direttamente fatturazione tootheir!</span><span class="sxs-lookup"><span data-stu-id="9acf4-300">For example, let tenants self-administer scaling up and down, perhaps linked directly tootheir billing!</span></span>

<span data-ttu-id="9acf4-301">**Scalabilità verticale e un pool ai modelli di utilizzo toomatch pianificazione**</span><span class="sxs-lookup"><span data-stu-id="9acf4-301">**Scaling a pool up and down on a schedule toomatch usage patterns**</span></span>

<span data-ttu-id="9acf4-302">In cui l'utilizzo tenant aggregazione segue modelli di utilizzo stimabile, è possibile utilizzare su e giù tooscale di automazione di Azure un pool in base alla pianificazione.</span><span class="sxs-lookup"><span data-stu-id="9acf4-302">Where aggregate tenant usage follows predictable usage patterns, you can use Azure Automation tooscale a pool up and down on a schedule.</span></span> <span data-ttu-id="9acf4-303">Ad esempio, ridurre le prestazioni dopo le 18 e aumentarle di nuovo prima delle 6 nei giorni della settimana in cui è noto che si verifica un calo delle risorse richieste.</span><span class="sxs-lookup"><span data-stu-id="9acf4-303">For example, scale a pool down after 6pm and up again before 6am on weekdays when you know there is a drop in resource requirements.</span></span>



## <a name="next-steps"></a><span data-ttu-id="9acf4-304">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="9acf4-304">Next steps</span></span>

<span data-ttu-id="9acf4-305">In questa esercitazione si apprenderà come:</span><span class="sxs-lookup"><span data-stu-id="9acf4-305">In this tutorial you learn how to:</span></span>

> [!div class="checklist"]
> * <span data-ttu-id="9acf4-306">Simulare l'utilizzo nel database tenant hello eseguendo un generatore di carico specificato</span><span class="sxs-lookup"><span data-stu-id="9acf4-306">Simulate usage on hello tenant databases by running a provided load generator</span></span>
> * <span data-ttu-id="9acf4-307">I database tenant hello Monitor come rispondono toohello aumento del carico</span><span class="sxs-lookup"><span data-stu-id="9acf4-307">Monitor hello tenant databases as they respond toohello increase in load</span></span>
> * <span data-ttu-id="9acf4-308">Applicare la scalabilità verticale hello pool elastico nel caricamento del database maggiore toohello risposta</span><span class="sxs-lookup"><span data-stu-id="9acf4-308">Scale up hello Elastic pool in response toohello increased database load</span></span>
> * <span data-ttu-id="9acf4-309">Eseguire il provisioning di un'attività di database hello secondo del saldo tooload pool elastico</span><span class="sxs-lookup"><span data-stu-id="9acf4-309">Provision a second Elastic pool tooload balance hello database activity</span></span>

[<span data-ttu-id="9acf4-310">Esercitazione sul ripristino di un tenant singolo</span><span class="sxs-lookup"><span data-stu-id="9acf4-310">Restore a single tenant tutorial</span></span>](sql-database-saas-tutorial-restore-single-tenant.md)


## <a name="additional-resources"></a><span data-ttu-id="9acf4-311">Risorse aggiuntive</span><span class="sxs-lookup"><span data-stu-id="9acf4-311">Additional resources</span></span>

* <span data-ttu-id="9acf4-312">Ulteriori [esercitazioni in cui si basano su una distribuzione di applicazioni SaaS Wingtip hello](sql-database-wtp-overview.md#sql-database-wingtip-saas-tutorials)</span><span class="sxs-lookup"><span data-stu-id="9acf4-312">Additional [tutorials that build upon hello Wingtip SaaS application deployment](sql-database-wtp-overview.md#sql-database-wingtip-saas-tutorials)</span></span>
* [<span data-ttu-id="9acf4-313">Pool elastici SQL</span><span class="sxs-lookup"><span data-stu-id="9acf4-313">SQL Elastic pools</span></span>](sql-database-elastic-pool.md)
* [<span data-ttu-id="9acf4-314">Automazione di Azure</span><span class="sxs-lookup"><span data-stu-id="9acf4-314">Azure automation</span></span>](../automation/automation-intro.md)
* <span data-ttu-id="9acf4-315">[Log Analytics](sql-database-saas-tutorial-log-analytics.md) - Esercitazione sulla configurazione e l'uso di Log Analytics</span><span class="sxs-lookup"><span data-stu-id="9acf4-315">[Log Analytics](sql-database-saas-tutorial-log-analytics.md) - Setting up and using Log Analytics tutorial</span></span>
