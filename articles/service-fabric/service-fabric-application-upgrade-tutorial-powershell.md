---
title: Aggiornamento di un'app di Service Fabric mediante PowerShell | Documentazione Microsoft
description: In questo articolo vengono esaminati l'esperienza di distribuzione di un'applicazione di Service Fabric, la modifica del codice e l'implementazione di un aggiornamento tramite PowerShell.
services: service-fabric
documentationcenter: .net
author: mani-ramaswamy
manager: timlt
editor: 
ms.assetid: 9bc75748-96b0-49ca-8d8a-41fe08398f25
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 8/9/2017
ms.author: subramar
ms.openlocfilehash: 3591ced970887d4eb5a33cec8f6951b5476d04f8
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/18/2017
---
# <a name="service-fabric-application-upgrade-using-powershell"></a><span data-ttu-id="29edf-103">Aggiornamento di un'applicazione di Service Fabric mediante PowerShell</span><span class="sxs-lookup"><span data-stu-id="29edf-103">Service Fabric application upgrade using PowerShell</span></span>
> [!div class="op_single_selector"]
> * [<span data-ttu-id="29edf-104">PowerShell</span><span class="sxs-lookup"><span data-stu-id="29edf-104">PowerShell</span></span>](service-fabric-application-upgrade-tutorial-powershell.md)
> * [<span data-ttu-id="29edf-105">Visual Studio</span><span class="sxs-lookup"><span data-stu-id="29edf-105">Visual Studio</span></span>](service-fabric-application-upgrade-tutorial.md)
> 
> 

<br/>

<span data-ttu-id="29edf-106">Il metodo di aggiornamento consigliato usato più frequentemente è l'aggiornamento in sequenza in modalità monitorata (Monitored).</span><span class="sxs-lookup"><span data-stu-id="29edf-106">The most frequently used and recommended upgrade approach is the monitored rolling upgrade.</span></span>  <span data-ttu-id="29edf-107">Azure Service Fabric monitora l'integrità dell'applicazione che viene aggiornata in base a un set di criteri di integrità.</span><span class="sxs-lookup"><span data-stu-id="29edf-107">Azure Service Fabric monitors the health of the application being upgraded based on a set of health policies.</span></span> <span data-ttu-id="29edf-108">Dopo che un dominio di aggiornamento è stato aggiornato, Service Fabric valuta l'integrità dell'applicazione e poi o passa al dominio di aggiornamento successivo o annulla l'aggiornamento in base ai criteri di integrità.</span><span class="sxs-lookup"><span data-stu-id="29edf-108">Once an update domain (UD) is upgraded, Service Fabric evaluates the application health and either proceeds to the next update domain or fails the upgrade depending on the health policies.</span></span>

<span data-ttu-id="29edf-109">L'aggiornamento di un'applicazione in modalità monitorata può essere eseguito usando le API gestite o native, PowerShell o REST.</span><span class="sxs-lookup"><span data-stu-id="29edf-109">A monitored application upgrade can be performed using the managed or native APIs, PowerShell, or REST.</span></span> <span data-ttu-id="29edf-110">Per istruzioni su come eseguire un aggiornamento usando Visual Studio, vedere [Esercitazione sull'aggiornamento di un'applicazione di Service Fabric tramite Visual Studio](service-fabric-application-upgrade-tutorial.md).</span><span class="sxs-lookup"><span data-stu-id="29edf-110">For instructions on performing an upgrade using Visual Studio, see [Upgrading your application using Visual Studio](service-fabric-application-upgrade-tutorial.md).</span></span>

<span data-ttu-id="29edf-111">L'aggiornamento in sequenza in modalità monitorata di Service Fabric consente all'amministratore di applicazioni di configurare i criteri di valutazione dell'integrità usati da Service Fabric per determinare se l'applicazione è integra.</span><span class="sxs-lookup"><span data-stu-id="29edf-111">With Service Fabric monitored rolling upgrades, the application administrator can configure the health evaluation policy that Service Fabric uses to determine if the application is healthy.</span></span> <span data-ttu-id="29edf-112">L'amministratore può anche configurare l'azione da intraprendere se la valutazione dell'integrità non riesce, ad esempio l'esecuzione di un rollback automatico. Questa sezione descrive in dettaglio un aggiornamento monitorato per uno degli esempi di SDK che usa PowerShell.</span><span class="sxs-lookup"><span data-stu-id="29edf-112">In addition, the administrator can configure the action to be taken when the health evaluation fails (for example, doing an automatic rollback.) This section walks through a monitored upgrade for one of the SDK samples that uses PowerShell.</span></span> <span data-ttu-id="29edf-113">Il video di Microsoft Virtual Academy seguente illustra anche come aggiornare un'app: <center><a target="_blank" href="https://mva.microsoft.com/en-US/training-courses/building-microservices-applications-on-azure-service-fabric-16747?l=OrHJH66yC_6406218965">
<img src="./media/service-fabric-application-upgrade-tutorial-powershell/AppLifecycleVid.png" WIDTH="360" HEIGHT="244">
</a></center></span><span class="sxs-lookup"><span data-stu-id="29edf-113">The following Microsoft Virtual Academy video also walks you through an app upgrade: <center><a target="_blank" href="https://mva.microsoft.com/en-US/training-courses/building-microservices-applications-on-azure-service-fabric-16747?l=OrHJH66yC_6406218965">
<img src="./media/service-fabric-application-upgrade-tutorial-powershell/AppLifecycleVid.png" WIDTH="360" HEIGHT="244">
</a></center></span></span>

## <a name="step-1-build-and-deploy-the-visual-objects-sample"></a><span data-ttu-id="29edf-114">Passaggio 1: creare e distribuire l'esempio di oggetti visivi</span><span class="sxs-lookup"><span data-stu-id="29edf-114">Step 1: Build and deploy the Visual Objects sample</span></span>
<span data-ttu-id="29edf-115">Compilare e pubblicare l'applicazione facendo clic con il pulsante destro del mouse sul progetto dell'applicazione, **VisualObjectsApplication**, e selezionando il comando **Pubblica**.</span><span class="sxs-lookup"><span data-stu-id="29edf-115">Build and publish the application by right-clicking on the application project, **VisualObjectsApplication,** and selecting the **Publish** command.</span></span>  <span data-ttu-id="29edf-116">Per altre informazioni, vedere [Esercitazione sull'aggiornamento di un'applicazione di Service Fabric tramite Visual Studio](service-fabric-application-upgrade-tutorial.md).</span><span class="sxs-lookup"><span data-stu-id="29edf-116">For more information, see [Service Fabric application upgrade tutorial](service-fabric-application-upgrade-tutorial.md).</span></span>  <span data-ttu-id="29edf-117">In alternativa, è possibile usare PowerShell per distribuire l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="29edf-117">Alternatively, you can use PowerShell to deploy your application.</span></span>

> [!NOTE]
> <span data-ttu-id="29edf-118">Per poter usare uno dei comandi di Service Fabric in PowerShell è necessario connettersi prima al cluster con il cmdlet `Connect-ServiceFabricCluster`.</span><span class="sxs-lookup"><span data-stu-id="29edf-118">Before any of the Service Fabric commands may be used in PowerShell, you first need to connect to the cluster by using the `Connect-ServiceFabricCluster` cmdlet.</span></span> <span data-ttu-id="29edf-119">Si presuppone che il cluster sia stato già configurato nel computer locale.</span><span class="sxs-lookup"><span data-stu-id="29edf-119">Similarly, it is assumed that the Cluster has already been set up on your local machine.</span></span> <span data-ttu-id="29edf-120">Vedere l'articolo relativo alla [configurazione dell'ambiente di sviluppo di Service Fabric](service-fabric-get-started.md).</span><span class="sxs-lookup"><span data-stu-id="29edf-120">See the article on [setting up your Service Fabric development environment](service-fabric-get-started.md).</span></span>
> 
> 

<span data-ttu-id="29edf-121">Dopo aver compilato il progetto in Visual Studio è possibile usare il comando di PowerShell [Copy-ServiceFabricApplicationPackage](/powershell/servicefabric/vlatest/copy-servicefabricapplicationpackage) per copiare il pacchetto dell'applicazione in ImageStore.</span><span class="sxs-lookup"><span data-stu-id="29edf-121">After building the project in Visual Studio, you can use the PowerShell command [Copy-ServiceFabricApplicationPackage](/powershell/servicefabric/vlatest/copy-servicefabricapplicationpackage) to copy the application package to the ImageStore.</span></span> <span data-ttu-id="29edf-122">Se si desidera verificare il pacchetto dell'applicazione in locale, usare il cmdlet [Test-ServiceFabricApplicationPackage](/powershell/servicefabric/vlatest/test-servicefabricapplicationpackage).</span><span class="sxs-lookup"><span data-stu-id="29edf-122">If you want to verify the app package locally, use the [Test-ServiceFabricApplicationPackage](/powershell/servicefabric/vlatest/test-servicefabricapplicationpackage) cmdlet.</span></span> <span data-ttu-id="29edf-123">Il passaggio successivo consiste nel registrare l'applicazione nel runtime di Service Fabric mediante il cmdlet [Register-ServiceFabricApplicationPackage](/powershell/servicefabric/vlatest/register-servicefabricapplicationtype) .</span><span class="sxs-lookup"><span data-stu-id="29edf-123">The next step is to register the application to the Service Fabric runtime using the [Register-ServiceFabricApplicationPackage](/powershell/servicefabric/vlatest/register-servicefabricapplicationtype) cmdlet.</span></span> <span data-ttu-id="29edf-124">Il passaggio finale consiste nell'avviare un'istanza dell'applicazione con il cmdlet [New-ServiceFabricApplication](/powershell/module/servicefabric/new-servicefabricapplication?view=azureservicefabricps) .</span><span class="sxs-lookup"><span data-stu-id="29edf-124">The final step is to start an instance of the application by using the [New-ServiceFabricApplication](/powershell/module/servicefabric/new-servicefabricapplication?view=azureservicefabricps) cmdlet.</span></span>  <span data-ttu-id="29edf-125">Questi tre passaggi sono analoghi all'uso della voce di menu **Distribuisci** in Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="29edf-125">These three steps are analogous to using the **Deploy** menu item in Visual Studio.</span></span>

<span data-ttu-id="29edf-126">È ora possibile usare [Service Fabric Explorer per visualizzare il cluster e l'applicazione](service-fabric-visualizing-your-cluster.md).</span><span class="sxs-lookup"><span data-stu-id="29edf-126">Now, you can use [Service Fabric Explorer to view the cluster and the application](service-fabric-visualizing-your-cluster.md).</span></span> <span data-ttu-id="29edf-127">L'applicazione dispone di un servizio Web a cui è possibile accedere in Internet Explorer digitando [http://localhost:8081/visualobjects](http://localhost:8081/visualobjects) sulla barra degli indirizzi.</span><span class="sxs-lookup"><span data-stu-id="29edf-127">The application has a web service that can be navigated to in Internet Explorer by typing [http://localhost:8081/visualobjects](http://localhost:8081/visualobjects) in the address bar.</span></span>  <span data-ttu-id="29edf-128">Verranno visualizzati alcuni oggetti visivi mobili sullo schermo.</span><span class="sxs-lookup"><span data-stu-id="29edf-128">You should see some floating visual objects moving around in the screen.</span></span>  <span data-ttu-id="29edf-129">È anche possibile usare [Get-ServiceFabricApplication](/powershell/module/servicefabric/get-servicefabricapplication?view=azureservicefabricps) per verificare lo stato dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="29edf-129">Additionally, you can use [Get-ServiceFabricApplication](/powershell/module/servicefabric/get-servicefabricapplication?view=azureservicefabricps) to check the application status.</span></span>

## <a name="step-2-update-the-visual-objects-sample"></a><span data-ttu-id="29edf-130">Passaggio 2: aggiornare l'applicazione Oggetti visivi di esempio</span><span class="sxs-lookup"><span data-stu-id="29edf-130">Step 2: Update the Visual Objects sample</span></span>
<span data-ttu-id="29edf-131">È possibile osservare che con la versione distribuita al passaggio 1 gli oggetti visivi non ruotano.</span><span class="sxs-lookup"><span data-stu-id="29edf-131">You might notice that with the version that was deployed in Step 1, the visual objects do not rotate.</span></span> <span data-ttu-id="29edf-132">L'applicazione può essere aggiornata in modo che gli oggetti visivi ruotino.</span><span class="sxs-lookup"><span data-stu-id="29edf-132">Let's upgrade this application to one where the visual objects also rotate.</span></span>

<span data-ttu-id="29edf-133">Selezionare il progetto VisualObjects.ActorService nella soluzione VisualObjects e aprire il file StatefulVisualObjectActor.cs.</span><span class="sxs-lookup"><span data-stu-id="29edf-133">Select the VisualObjects.ActorService project within the VisualObjects solution, and open the StatefulVisualObjectActor.cs file.</span></span> <span data-ttu-id="29edf-134">All'interno del file passare al metodo `MoveObject`, impostare come commento `this.State.Move()` e rimuovere il commento `this.State.Move(true)`.</span><span class="sxs-lookup"><span data-stu-id="29edf-134">Within that file, navigate to the method `MoveObject`, comment out `this.State.Move()`, and uncomment `this.State.Move(true)`.</span></span> <span data-ttu-id="29edf-135">Questa modifica fa ruotare gli oggetti dopo l'aggiornamento del servizio.</span><span class="sxs-lookup"><span data-stu-id="29edf-135">This change rotates the objects after the service is upgraded.</span></span>

<span data-ttu-id="29edf-136">È anche necessario aggiornare il file *ServiceManifest.xml* (in PackageRoot) del progetto **VisualObjects.ActorService**.</span><span class="sxs-lookup"><span data-stu-id="29edf-136">We also need to update the *ServiceManifest.xml* file (under PackageRoot) of the project **VisualObjects.ActorService**.</span></span> <span data-ttu-id="29edf-137">Aggiornare *CodePackage* e la versione del servizio alla versione 2.0, nonché le righe corrispondenti nel file *ServiceManifest.xml*.</span><span class="sxs-lookup"><span data-stu-id="29edf-137">Update the *CodePackage* and the service version to 2.0, and the corresponding lines in the *ServiceManifest.xml* file.</span></span>
<span data-ttu-id="29edf-138">È possibile usare l'opzione *Edit Manifest Files* (Modifica file manifesto) di Visual Studio dopo aver fatto clic con il pulsante destro del mouse sulla soluzione per apportare le modifiche al file manifesto.</span><span class="sxs-lookup"><span data-stu-id="29edf-138">You can use the Visual Studio *Edit Manifest Files* option after you right-click on the solution to make the manifest file changes.</span></span>

<span data-ttu-id="29edf-139">Dopo aver apportato le modifiche, il manifesto dovrebbe essere simile al seguente (le parti evidenziate indicano le modifiche):</span><span class="sxs-lookup"><span data-stu-id="29edf-139">After the changes are made, the manifest should look like the following (highlighted portions show the changes):</span></span>

```xml
<ServiceManifestName="VisualObjects.ActorService" Version="2.0" xmlns="http://schemas.microsoft.com/2011/01/fabric" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">

<CodePackageName="Code" Version="2.0">
```

<span data-ttu-id="29edf-140">A questo punto il file *ApplicationManifest.xml*, disponibile nel progetto **VisualObjects** della soluzione **VisualObjects**, viene aggiornato alla versione 2.0 del progetto **VisualObjects.ActorService**.</span><span class="sxs-lookup"><span data-stu-id="29edf-140">Now the *ApplicationManifest.xml* file (found under the **VisualObjects** project under the **VisualObjects** solution) is updated to version 2.0 of the **VisualObjects.ActorService** project.</span></span> <span data-ttu-id="29edf-141">Anche la versione dell'applicazione viene aggiornata a 2.0.0.0 da 1.0.0.0.</span><span class="sxs-lookup"><span data-stu-id="29edf-141">In addition, the Application version is updated to 2.0.0.0 from 1.0.0.0.</span></span> <span data-ttu-id="29edf-142">Il file *ApplicationManifest.xml* sarà simile al seguente frammento di codice:</span><span class="sxs-lookup"><span data-stu-id="29edf-142">The *ApplicationManifest.xml* should look like the following snippet:</span></span>

```xml
<ApplicationManifestxmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" ApplicationTypeName="VisualObjects" ApplicationTypeVersion="2.0.0.0" xmlns="http://schemas.microsoft.com/2011/01/fabric">

 <ServiceManifestRefServiceManifestName="VisualObjects.ActorService" ServiceManifestVersion="2.0" />
```


<span data-ttu-id="29edf-143">A questo punto compilare il progetto selezionando solo il progetto **ActorService** e quindi facendo clic con il pulsante destro del mouse e scegliendo l'opzione **Compila** in Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="29edf-143">Now, build the project by selecting just the **ActorService** project, and then right-clicking and selecting the **Build** option in Visual Studio.</span></span> <span data-ttu-id="29edf-144">Se si seleziona **Ricompila tutto**, è necessario aggiornare le versioni per tutti i progetti, poiché il codice è stato modificato.</span><span class="sxs-lookup"><span data-stu-id="29edf-144">If you select **Rebuild all**, you should update the versions for all projects, since the code would have changed.</span></span> <span data-ttu-id="29edf-145">È quindi possibile aggiungere l'applicazione aggiornata al pacchetto facendo clic con il pulsante destro del mouse sul progetto ***VisualObjectsApplication***, scegliendo il menu Service Fabric e quindi **Pacchetto**.</span><span class="sxs-lookup"><span data-stu-id="29edf-145">Next, let's package the updated application by right-clicking on ***VisualObjectsApplication***, selecting the Service Fabric Menu, and choosing **Package**.</span></span> <span data-ttu-id="29edf-146">In questo modo viene creato un pacchetto dell'applicazione che può essere distribuito.</span><span class="sxs-lookup"><span data-stu-id="29edf-146">This action creates an application package that can be deployed.</span></span>  <span data-ttu-id="29edf-147">L'applicazione aggiornata è pronta per essere distribuita.</span><span class="sxs-lookup"><span data-stu-id="29edf-147">Your updated application is ready to be deployed.</span></span>

## <a name="step-3--decide-on-health-policies-and-upgrade-parameters"></a><span data-ttu-id="29edf-148">Passaggio 3: Scegliere i criteri di integrità e i parametri di aggiornamento</span><span class="sxs-lookup"><span data-stu-id="29edf-148">Step 3:  Decide on health policies and upgrade parameters</span></span>
<span data-ttu-id="29edf-149">È consigliabile acquisire familiarità con i [parametri di aggiornamento dell'applicazione](service-fabric-application-upgrade-parameters.md) e con il [processo di aggiornamento](service-fabric-application-upgrade.md) per conoscere i diversi parametri di aggiornamento, valori di timeout e criteri di integrità applicati.</span><span class="sxs-lookup"><span data-stu-id="29edf-149">Familiarize yourself with the [application upgrade parameters](service-fabric-application-upgrade-parameters.md) and the [upgrade process](service-fabric-application-upgrade.md) to get a good understanding of the various upgrade parameters, time-outs, and health criterion applied.</span></span> <span data-ttu-id="29edf-150">Per questa procedura dettagliata i criteri predefiniti di valutazione dell'integrità dei servizi sono impostati con i valori consigliati, quindi tutti i servizi e tutte le istanze saranno *integri* dopo l'aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="29edf-150">For this walkthrough, the service health evaluation criterion is set to the default (and recommended) values, which means that all services and instances should be *healthy* after the upgrade.</span></span>  

<span data-ttu-id="29edf-151">Aumentare tuttavia il valore di *HealthCheckStableDuration* impostandolo su 60 secondi, in modo che i servizi siano integri per almeno 20 secondi prima che il processo di aggiornamento passi al dominio di aggiornamento successivo.</span><span class="sxs-lookup"><span data-stu-id="29edf-151">However, let's increase the *HealthCheckStableDuration* to 60 seconds (so that the services are healthy for at least 20 seconds before the upgrade proceeds to the next update domain).</span></span>  <span data-ttu-id="29edf-152">Impostare quindi *UpgradeDomainTimeout* su 1200 secondi e *UpgradeTimeout* su 3000 secondi.</span><span class="sxs-lookup"><span data-stu-id="29edf-152">Let's also set the *UpgradeDomainTimeout* to be 1200 seconds and the *UpgradeTimeout* to be 3000 seconds.</span></span>

<span data-ttu-id="29edf-153">Infine impostare anche *UpgradeFailureAction* in modo che venga eseguito il rollback.</span><span class="sxs-lookup"><span data-stu-id="29edf-153">Finally, let's also set the *UpgradeFailureAction* to rollback.</span></span> <span data-ttu-id="29edf-154">Questa opzione richiede che Service Fabric esegua il rollback dell'applicazione alla versione precedente se riscontra problemi durante l'aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="29edf-154">This option requires Service Fabric to roll back the application to the previous version if it encounters any issues during the upgrade.</span></span> <span data-ttu-id="29edf-155">Perciò, all'avvio dell'aggiornamento (al passaggio 4), vengono specificati i parametri seguenti:</span><span class="sxs-lookup"><span data-stu-id="29edf-155">Thus, when starting the upgrade (in Step 4), the following parameters are specified:</span></span>

<span data-ttu-id="29edf-156">FailureAction = Rollback</span><span class="sxs-lookup"><span data-stu-id="29edf-156">FailureAction = Rollback</span></span>

<span data-ttu-id="29edf-157">HealthCheckStableDurationSec = 60</span><span class="sxs-lookup"><span data-stu-id="29edf-157">HealthCheckStableDurationSec = 60</span></span>

<span data-ttu-id="29edf-158">UpgradeDomainTimeoutSec = 1200</span><span class="sxs-lookup"><span data-stu-id="29edf-158">UpgradeDomainTimeoutSec = 1200</span></span>

<span data-ttu-id="29edf-159">UpgradeTimeout = 3000</span><span class="sxs-lookup"><span data-stu-id="29edf-159">UpgradeTimeout = 3000</span></span>

## <a name="step-4-prepare-application-for-upgrade"></a><span data-ttu-id="29edf-160">Passaggio 4: preparare l'applicazione per l'aggiornamento</span><span class="sxs-lookup"><span data-stu-id="29edf-160">Step 4: Prepare application for upgrade</span></span>
<span data-ttu-id="29edf-161">L'applicazione ora è compilata e pronta per l'aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="29edf-161">Now the application is built and ready to be upgraded.</span></span> <span data-ttu-id="29edf-162">Se si apre una finestra di PowerShell come amministratore e si digita [Get-ServiceFabricApplication](/powershell/module/servicefabric/get-servicefabricapplication?view=azureservicefabricps), verrà indicato che è stato distribuito il tipo di applicazione 1.0.0.0 di **VisualObject**.</span><span class="sxs-lookup"><span data-stu-id="29edf-162">If you open up a PowerShell window as an administrator and type [Get-ServiceFabricApplication](/powershell/module/servicefabric/get-servicefabricapplication?view=azureservicefabricps), it should let you know that it is application type 1.0.0.0 of **VisualObjects** that's been deployed.</span></span>  

<span data-ttu-id="29edf-163">Il pacchetto applicazione è archiviato nel percorso relativo seguente, dove è stato decompresso Service Fabric SDK - *Samples\Services\Stateful\VisualObjects\VisualObjects\obj\x64\Debug*.</span><span class="sxs-lookup"><span data-stu-id="29edf-163">The application package is stored under the following relative path where you uncompressed the Service Fabric SDK - *Samples\Services\Stateful\VisualObjects\VisualObjects\obj\x64\Debug*.</span></span> <span data-ttu-id="29edf-164">In questa directory deve essere disponibile una cartella "Package", dove è archiviato il pacchetto dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="29edf-164">You should find a "Package" folder in that directory, where the application package is stored.</span></span> <span data-ttu-id="29edf-165">Controllare i timestamp per assicurarsi che si tratti dell'ultima build. Potrebbe essere anche necessario modificare i percorsi in base alle esigenze.</span><span class="sxs-lookup"><span data-stu-id="29edf-165">Check the timestamps to ensure that it is the latest build (you may need to modify the paths appropriately as well).</span></span>

<span data-ttu-id="29edf-166">Copiare ora il pacchetto applicazione aggiornato in ImageStore di Service Fabric (dove Service Fabric archivia i pacchetti applicazione).</span><span class="sxs-lookup"><span data-stu-id="29edf-166">Now let's copy the updated application package to the Service Fabric ImageStore (where the application packages are stored by Service Fabric).</span></span> <span data-ttu-id="29edf-167">Il parametro *ApplicationPackagePathInImageStore* indica a Service Fabric dove è contenuto il pacchetto applicazione.</span><span class="sxs-lookup"><span data-stu-id="29edf-167">The parameter *ApplicationPackagePathInImageStore* informs Service Fabric where it can find the application package.</span></span> <span data-ttu-id="29edf-168">L'applicazione aggiornata è stata inserita in "VisualObjects\_V2" con il comando seguente. Potrebbe essere di nuovo necessario modificare i percorsi in base alle esigenze.</span><span class="sxs-lookup"><span data-stu-id="29edf-168">We have put the updated application in "VisualObjects\_V2" with the following command (you may need to modify paths again appropriately).</span></span>

```powershell
Copy-ServiceFabricApplicationPackage  -ApplicationPackagePath .\Samples\Services\Stateful\VisualObjects\VisualObjects\obj\x64\Debug\Package
-ImageStoreConnectionString fabric:ImageStore   -ApplicationPackagePathInImageStore "VisualObjects\_V2"
```

<span data-ttu-id="29edf-169">Il passaggio successivo consiste nel registrare l'applicazione con Service Fabric, operazione che può essere eseguita usando il comando [Register-ServiceFabricApplicationType](/powershell/module/servicefabric/register-servicefabricapplicationtype?view=azureservicefabricps):</span><span class="sxs-lookup"><span data-stu-id="29edf-169">The next step is to register this application with Service Fabric, which can be performed using the [Register-ServiceFabricApplicationType](/powershell/module/servicefabric/register-servicefabricapplicationtype?view=azureservicefabricps) command:</span></span>

```powershell
Register-ServiceFabricApplicationType -ApplicationPathInImageStore "VisualObjects\_V2"
```

<span data-ttu-id="29edf-170">Se il comando precedente non riesce, è probabile che si debbano ricompilare tutti i servizi.</span><span class="sxs-lookup"><span data-stu-id="29edf-170">If the preceding command doesn't succeed, it is likely that you need a rebuild of all services.</span></span> <span data-ttu-id="29edf-171">Come indicato nel passaggio 2, potrebbe essere necessario aggiornare anche la versione di WebService.</span><span class="sxs-lookup"><span data-stu-id="29edf-171">As mentioned in Step 2, you may have to update your WebService version as well.</span></span>

## <a name="step-5-start-the-application-upgrade"></a><span data-ttu-id="29edf-172">Passaggio 5: avviare l'aggiornamento dell'applicazione</span><span class="sxs-lookup"><span data-stu-id="29edf-172">Step 5: Start the application upgrade</span></span>
<span data-ttu-id="29edf-173">Ora è tutto pronto per avviare l'aggiornamento dell'applicazione usando il comando [Start-ServiceFabricApplicationUpgrade](/powershell/module/servicefabric/start-servicefabricapplicationupgrade?view=azureservicefabricps):</span><span class="sxs-lookup"><span data-stu-id="29edf-173">Now, we're all set to start the application upgrade by using the [Start-ServiceFabricApplicationUpgrade](/powershell/module/servicefabric/start-servicefabricapplicationupgrade?view=azureservicefabricps) command:</span></span>

```powershell
Start-ServiceFabricApplicationUpgrade -ApplicationName fabric:/VisualObjects -ApplicationTypeVersion 2.0.0.0 -HealthCheckStableDurationSec 60 -UpgradeDomainTimeoutSec 1200 -UpgradeTimeout 3000   -FailureAction Rollback -Monitored
```


<span data-ttu-id="29edf-174">Il nome dell'applicazione è lo stesso descritto nel file *ApplicationManifest.xml* .</span><span class="sxs-lookup"><span data-stu-id="29edf-174">The application name is the same as it was described in the *ApplicationManifest.xml* file.</span></span> <span data-ttu-id="29edf-175">Service Fabric usa questo nome per identificare l'applicazione che viene aggiornata.</span><span class="sxs-lookup"><span data-stu-id="29edf-175">Service Fabric uses this name to identify which application is getting upgraded.</span></span> <span data-ttu-id="29edf-176">Se si imposta un valore di timeout troppo breve, è possibile che venga visualizzato un messaggio di errore che indica il problema.</span><span class="sxs-lookup"><span data-stu-id="29edf-176">If you set the time-outs to be too short, you may encounter a failure message that states the problem.</span></span> <span data-ttu-id="29edf-177">Vedere la sezione relativa alla risoluzione dei problemi o aumentare i valori di timeout.</span><span class="sxs-lookup"><span data-stu-id="29edf-177">Refer to the troubleshooting section, or increase the time-outs.</span></span>

<span data-ttu-id="29edf-178">Man mano che l'aggiornamento dell'applicazione procede, è possibile monitorarlo con Service Fabric Explorer oppure con il comando di PowerShell [Get-ServiceFabricApplicationUpgrade](/powershell/module/servicefabric/get-servicefabricapplicationupgrade?view=azureservicefabricps):</span><span class="sxs-lookup"><span data-stu-id="29edf-178">Now, as the application upgrade proceeds, you can monitor it using Service Fabric Explorer, or by using the [Get-ServiceFabricApplicationUpgrade](/powershell/module/servicefabric/get-servicefabricapplicationupgrade?view=azureservicefabricps) PowerShell command:</span></span> 

```powershell
Get-ServiceFabricApplicationUpgrade fabric:/VisualObjects
```

<span data-ttu-id="29edf-179">In pochi minuti lo stato ottenuto usando il comando di PowerShell precedente indicherà che sono stati aggiornati (completati) tutti i domini di aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="29edf-179">In a few minutes, the status that you got by using the preceding PowerShell command, should state that all update domains were upgraded (completed).</span></span> <span data-ttu-id="29edf-180">Inoltre gli oggetti visivi nella finestra del browser hanno iniziato a ruotare.</span><span class="sxs-lookup"><span data-stu-id="29edf-180">And you should find that the visual objects in your browser window have started rotating!</span></span>

<span data-ttu-id="29edf-181">Come esercizio provare a effettuare l'aggiornamento dalla versione 2 alla versione 3 o dalla versione 2 alla versione 1:</span><span class="sxs-lookup"><span data-stu-id="29edf-181">You can try upgrading from version 2 to version 3, or from version 2 to version 1 as an exercise.</span></span> <span data-ttu-id="29edf-182">anche il passaggio dalla versione 2 alla versione 1 è considerato un aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="29edf-182">Moving from version 2 to version 1 is also considered an upgrade.</span></span> <span data-ttu-id="29edf-183">Esercitarsi inoltre con i timeout e i criteri di integrità per acquisire familiarità anche con questi concetti.</span><span class="sxs-lookup"><span data-stu-id="29edf-183">Play with time-outs and health policies to make yourself familiar with them.</span></span> <span data-ttu-id="29edf-184">Quando si esegue la distribuzione in un cluster di Azure, è necessario impostare i parametri in modo appropriato.</span><span class="sxs-lookup"><span data-stu-id="29edf-184">When you are deploying to an Azure cluster, the parameters need to be set appropriately.</span></span> <span data-ttu-id="29edf-185">È consigliabile impostare i timeout su valori contenuti.</span><span class="sxs-lookup"><span data-stu-id="29edf-185">It is good to set the time-outs conservatively.</span></span>

## <a name="next-steps"></a><span data-ttu-id="29edf-186">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="29edf-186">Next steps</span></span>
<span data-ttu-id="29edf-187">[Esercitazione sull'aggiornamento di un'applicazione di Service Fabric tramite Visual Studio](service-fabric-application-upgrade-tutorial.md) descrive la procedura di aggiornamento di un'applicazione con Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="29edf-187">[Upgrading your application using Visual Studio](service-fabric-application-upgrade-tutorial.md) walks you through an application upgrade using Visual Studio.</span></span>

<span data-ttu-id="29edf-188">Controllare l'aggiornamento dell'applicazione tramite [Parametri di aggiornamento](service-fabric-application-upgrade-parameters.md).</span><span class="sxs-lookup"><span data-stu-id="29edf-188">Control how your application upgrades by using [upgrade parameters](service-fabric-application-upgrade-parameters.md).</span></span>

<span data-ttu-id="29edf-189">Rendere compatibili gli aggiornamenti dell'applicazione imparando a usare la [serializzazione dei dati](service-fabric-application-upgrade-data-serialization.md).</span><span class="sxs-lookup"><span data-stu-id="29edf-189">Make your application upgrades compatible by learning how to use [data serialization](service-fabric-application-upgrade-data-serialization.md).</span></span>

<span data-ttu-id="29edf-190">Per informazioni su come usare funzionalità avanzate durante l'aggiornamento dell'applicazione, vedere [Argomenti avanzati](service-fabric-application-upgrade-advanced.md).</span><span class="sxs-lookup"><span data-stu-id="29edf-190">Learn how to use advanced functionality while upgrading your application by referring to [Advanced topics](service-fabric-application-upgrade-advanced.md).</span></span>

<span data-ttu-id="29edf-191">Per informazioni su come risolvere problemi comuni negli aggiornamenti dell'applicazione, vedere i passaggi indicati in [Risoluzione dei problemi relativi agli aggiornamenti dell'applicazione](service-fabric-application-upgrade-troubleshooting.md).</span><span class="sxs-lookup"><span data-stu-id="29edf-191">Fix common problems in application upgrades by referring to the steps in [Troubleshooting application upgrades](service-fabric-application-upgrade-troubleshooting.md).</span></span>

