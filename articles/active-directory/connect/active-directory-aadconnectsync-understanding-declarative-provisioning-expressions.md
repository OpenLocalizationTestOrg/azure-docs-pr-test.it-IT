---
title: 'Azure AD Connect: Espressioni di provisioning dichiarativo | Documentazione Microsoft'
description: Informazioni sulle espressioni di provisioning dichiarativo.
services: active-directory
documentationcenter: 
author: andkjell
manager: femila
editor: 
ms.assetid: e3ea53c8-3801-4acf-a297-0fb9bb1bf11d
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/18/2017
ms.author: billmath
ms.openlocfilehash: e3a03a97b10e04fb85261620879b2102e1db8465
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/03/2017
---
# <a name="azure-ad-connect-sync-understanding-declarative-provisioning-expressions"></a><span data-ttu-id="10597-103">Servizio di sincronizzazione Azure AD Connect: Informazioni sulle espressioni di provisioning dichiarativo</span><span class="sxs-lookup"><span data-stu-id="10597-103">Azure AD Connect sync: Understanding Declarative Provisioning Expressions</span></span>
<span data-ttu-id="10597-104">Il servizio di sincronizzazione Azure AD Connect si basa sul provisioning dichiarativo introdotto inizialmente in Forefront Identity Manager 2010.</span><span class="sxs-lookup"><span data-stu-id="10597-104">Azure AD Connect sync builds on declarative provisioning first introduced in Forefront Identity Manager 2010.</span></span> <span data-ttu-id="10597-105">Consente di implementare la logica di business completa per l'integrazione delle identità senza dover scrivere codice compilato.</span><span class="sxs-lookup"><span data-stu-id="10597-105">It allows you to implement your complete identity integration business logic without the need to write compiled code.</span></span>

<span data-ttu-id="10597-106">Una parte essenziale del provisioning dichiarativo è il linguaggio delle espressioni usato nei flussi di attributi.</span><span class="sxs-lookup"><span data-stu-id="10597-106">An essential part of declarative provisioning is the expression language used in attribute flows.</span></span> <span data-ttu-id="10597-107">Il linguaggio usato è un subset di Microsoft® Visual Basic®, Applications Edition (VBA).</span><span class="sxs-lookup"><span data-stu-id="10597-107">The language used is a subset of Microsoft® Visual Basic® for Applications (VBA).</span></span> <span data-ttu-id="10597-108">Questo linguaggio viene usato in Microsoft Office e verrà riconosciuto anche dagli utenti con esperienza in VBScript.</span><span class="sxs-lookup"><span data-stu-id="10597-108">This language is used in Microsoft Office and users with experience of VBScript will also recognize it.</span></span> <span data-ttu-id="10597-109">Il linguaggio delle espressioni di provisioning dichiarativo usa solo funzioni e non è un linguaggio strutturato,</span><span class="sxs-lookup"><span data-stu-id="10597-109">The Declarative Provisioning Expression Language is only using functions and is not a structured language.</span></span> <span data-ttu-id="10597-110">né include metodi o istruzioni.</span><span class="sxs-lookup"><span data-stu-id="10597-110">There are no methods or statements.</span></span> <span data-ttu-id="10597-111">Le funzioni sono invece annidate per esprimere il flusso dei programmi.</span><span class="sxs-lookup"><span data-stu-id="10597-111">Functions are instead nested to express program flow.</span></span>

<span data-ttu-id="10597-112">Per altre informazioni dettagliate, vedere i [riferimenti per il linguaggio Visual Basic, Applications Edition per Office 2013](https://msdn.microsoft.com/library/gg264383.aspx).</span><span class="sxs-lookup"><span data-stu-id="10597-112">For more details, see [Welcome to the Visual Basic for Applications language reference for Office 2013](https://msdn.microsoft.com/library/gg264383.aspx).</span></span>

<span data-ttu-id="10597-113">Gli attributi sono fortemente tipizzati.</span><span class="sxs-lookup"><span data-stu-id="10597-113">The attributes are strongly typed.</span></span> <span data-ttu-id="10597-114">Una funzione accetta solo gli attributi del tipo corretto.</span><span class="sxs-lookup"><span data-stu-id="10597-114">A function only accepts attributes of the correct type.</span></span> <span data-ttu-id="10597-115">Fa anche distinzione tra maiuscole e minuscole.</span><span class="sxs-lookup"><span data-stu-id="10597-115">It is also case-sensitive.</span></span> <span data-ttu-id="10597-116">Se per i nomi delle funzioni e degli attributi non viene rispettata correttamente la distinzione maiuscole/minuscole, viene generato un errore.</span><span class="sxs-lookup"><span data-stu-id="10597-116">Both function names and attribute names must have proper casing or an error is thrown.</span></span>

## <a name="language-definitions-and-identifiers"></a><span data-ttu-id="10597-117">Definizioni e identificatori del linguaggio</span><span class="sxs-lookup"><span data-stu-id="10597-117">Language definitions and Identifiers</span></span>
* <span data-ttu-id="10597-118">I nomi delle funzioni sono seguiti dagli argomenti racchiusi tra parentesi: NomeFunzione(argomento 1,argomento N).</span><span class="sxs-lookup"><span data-stu-id="10597-118">Functions have a name followed by arguments in brackets: FunctionName(argument 1, argument N).</span></span>
* <span data-ttu-id="10597-119">Gli attributi sono identificati da parentesi quadre: [attributeName].</span><span class="sxs-lookup"><span data-stu-id="10597-119">Attributes are identified by square brackets: [attributeName]</span></span>
* <span data-ttu-id="10597-120">I parametri sono identificati dal segno di percentuale: %ParameterName%</span><span class="sxs-lookup"><span data-stu-id="10597-120">Parameters are identified by percent signs: %ParameterName%</span></span>
* <span data-ttu-id="10597-121">Le costanti di stringa sono racchiuse tra virgolette: ad esempio, "Contoso" (Nota: è necessario usare le virgolette semplici "", non quelle non inglesi “”)</span><span class="sxs-lookup"><span data-stu-id="10597-121">String constants are surrounded by quotes: For example, "Contoso" (Note: must use straight quotes "" and not smart quotes “”)</span></span>
* <span data-ttu-id="10597-122">I valori numerici sono espressi senza virgolette e devono essere decimali.</span><span class="sxs-lookup"><span data-stu-id="10597-122">Numeric values are expressed without quotes and expected to be decimal.</span></span> <span data-ttu-id="10597-123">Ai valori esadecimali viene aggiunto un prefisso di tipo &H.</span><span class="sxs-lookup"><span data-stu-id="10597-123">Hexadecimal values are prefixed with &H.</span></span> <span data-ttu-id="10597-124">Ad esempio, 98052, &HFF</span><span class="sxs-lookup"><span data-stu-id="10597-124">For example, 98052, &HFF</span></span>
* <span data-ttu-id="10597-125">I valori booleani sono espressi con costanti: True, False.</span><span class="sxs-lookup"><span data-stu-id="10597-125">Boolean values are expressed with constants: True, False.</span></span>
* <span data-ttu-id="10597-126">Le costanti predefinite sono espresse solo tramite il relativo nome: NULL, CRLF, IgnoreThisFlow</span><span class="sxs-lookup"><span data-stu-id="10597-126">Built-in constants and literals are expressed with only their name: NULL, CRLF, IgnoreThisFlow</span></span>

### <a name="functions"></a><span data-ttu-id="10597-127">Funzioni</span><span class="sxs-lookup"><span data-stu-id="10597-127">Functions</span></span>
<span data-ttu-id="10597-128">Il provisioning dichiarativo usa molte funzioni per rendere possibile la trasformazione dei valori dell'attributo.</span><span class="sxs-lookup"><span data-stu-id="10597-128">Declarative provisioning uses many functions to enable the possibility to transform attribute values.</span></span> <span data-ttu-id="10597-129">Queste funzioni possono essere annidate, in modo che il risultato di una funzione venga passato a un'altra.</span><span class="sxs-lookup"><span data-stu-id="10597-129">These functions can be nested so the result from one function is passed in to another function.</span></span>

`Function1(Function2(Function3()))`

<span data-ttu-id="10597-130">L'elenco completo delle funzioni è disponibile nel [riferimento di funzione](active-directory-aadconnectsync-functions-reference.md).</span><span class="sxs-lookup"><span data-stu-id="10597-130">The complete list of functions can be found in the [function reference](active-directory-aadconnectsync-functions-reference.md).</span></span>

### <a name="parameters"></a><span data-ttu-id="10597-131">Parametri</span><span class="sxs-lookup"><span data-stu-id="10597-131">Parameters</span></span>
<span data-ttu-id="10597-132">Un parametro è definito da un connettore o da un amministratore tramite PowerShell.</span><span class="sxs-lookup"><span data-stu-id="10597-132">A parameter is defined either by a Connector or by an administrator using PowerShell.</span></span> <span data-ttu-id="10597-133">I parametri includono in genere valori diversi da un sistema all'altro, ad esempio il nome del dominio in cui si trova l'utente.</span><span class="sxs-lookup"><span data-stu-id="10597-133">Parameters usually contain values that are different from system to system, for example the name of the domain the user is located in.</span></span> <span data-ttu-id="10597-134">Questi parametri possono essere usati nei flussi degli attributi.</span><span class="sxs-lookup"><span data-stu-id="10597-134">These parameters can be used in attribute flows.</span></span>

<span data-ttu-id="10597-135">Active Directory Connector fornisce i parametri seguenti per le regole di sincronizzazione in entrata:</span><span class="sxs-lookup"><span data-stu-id="10597-135">The Active Directory Connector provided the following parameters for inbound Synchronization Rules:</span></span>

| <span data-ttu-id="10597-136">Nome parametro</span><span class="sxs-lookup"><span data-stu-id="10597-136">Parameter Name</span></span> | <span data-ttu-id="10597-137">Commento</span><span class="sxs-lookup"><span data-stu-id="10597-137">Comment</span></span> |
| --- | --- |
| <span data-ttu-id="10597-138">Domain.Netbios</span><span class="sxs-lookup"><span data-stu-id="10597-138">Domain.Netbios</span></span> |<span data-ttu-id="10597-139">Formato Netbios del dominio attualmente importato, ad esempio FABRIKAMSALES</span><span class="sxs-lookup"><span data-stu-id="10597-139">Netbios format of the domain currently being imported, for example FABRIKAMSALES</span></span> |
| <span data-ttu-id="10597-140">Domain.FQDN</span><span class="sxs-lookup"><span data-stu-id="10597-140">Domain.FQDN</span></span> |<span data-ttu-id="10597-141">Formato FQDN del dominio attualmente importato, ad esempio sales.fabrikam.com</span><span class="sxs-lookup"><span data-stu-id="10597-141">FQDN format of the domain currently being imported, for example sales.fabrikam.com</span></span> |
| <span data-ttu-id="10597-142">Domain.LDAP</span><span class="sxs-lookup"><span data-stu-id="10597-142">Domain.LDAP</span></span> |<span data-ttu-id="10597-143">Formato LDAP del dominio attualmente importato, ad esempio DC=sales,DC=fabrikam,DC=com</span><span class="sxs-lookup"><span data-stu-id="10597-143">LDAP format of the domain currently being imported, for example DC=sales,DC=fabrikam,DC=com</span></span> |
| <span data-ttu-id="10597-144">Forest.Netbios</span><span class="sxs-lookup"><span data-stu-id="10597-144">Forest.Netbios</span></span> |<span data-ttu-id="10597-145">Formato Netbios del nome della foresta attualmente importata, ad esempio FABRIKAMCORP</span><span class="sxs-lookup"><span data-stu-id="10597-145">Netbios format of the forest name currently being imported, for example FABRIKAMCORP</span></span> |
| <span data-ttu-id="10597-146">Forest.FQDN</span><span class="sxs-lookup"><span data-stu-id="10597-146">Forest.FQDN</span></span> |<span data-ttu-id="10597-147">Formato FQDN del nome della foresta attualmente importato, ad esempio FABRIKAMCORP</span><span class="sxs-lookup"><span data-stu-id="10597-147">FQDN format of the forest name currently being imported, for example fabrikam.com</span></span> |
| <span data-ttu-id="10597-148">Forest.LDAP</span><span class="sxs-lookup"><span data-stu-id="10597-148">Forest.LDAP</span></span> |<span data-ttu-id="10597-149">Formato FQDN del nome della foresta attualmente importato, ad esempio DC=fabrikam,DC=com</span><span class="sxs-lookup"><span data-stu-id="10597-149">LDAP format of the forest name currently being imported, for example DC=fabrikam,DC=com</span></span> |

<span data-ttu-id="10597-150">Il sistema fornisce il parametro seguente, usato per ottenere l'identificatore del connettore attualmente in esecuzione: </span><span class="sxs-lookup"><span data-stu-id="10597-150">The system provides the following parameter, which is used to get the identifier of the Connector currently running:</span></span>  
`Connector.ID`

<span data-ttu-id="10597-151">L'esempio seguente popola il dominio dell'attributo metaverse con il nome netbios del dominio in cui si trova l'utente: </span><span class="sxs-lookup"><span data-stu-id="10597-151">Here is an example that populates the metaverse attribute domain with the netbios name of the domain where the user is located:</span></span>  
`domain` <- `%Domain.Netbios%`

### <a name="operators"></a><span data-ttu-id="10597-152">Operatori</span><span class="sxs-lookup"><span data-stu-id="10597-152">Operators</span></span>
<span data-ttu-id="10597-153">È possibile usare gli operatori seguenti:</span><span class="sxs-lookup"><span data-stu-id="10597-153">The following operators can be used:</span></span>

* <span data-ttu-id="10597-154">**Confronto**: <, <=, <>, =, >, >=</span><span class="sxs-lookup"><span data-stu-id="10597-154">**Comparison**: <, <=, <>, =, >, >=</span></span>
* <span data-ttu-id="10597-155">**Matematici**: +, -, \*, -</span><span class="sxs-lookup"><span data-stu-id="10597-155">**Mathematics**: +, -, \*, -</span></span>
* <span data-ttu-id="10597-156">**Stringa**: & (concatenazione)</span><span class="sxs-lookup"><span data-stu-id="10597-156">**String**: & (concatenate)</span></span>
* <span data-ttu-id="10597-157">**Logici**: && (AND), || (OR)</span><span class="sxs-lookup"><span data-stu-id="10597-157">**Logical**: && (and), || (or)</span></span>
* <span data-ttu-id="10597-158">**Ordine di valutazione**: ( )</span><span class="sxs-lookup"><span data-stu-id="10597-158">**Evaluation order**: ( )</span></span>

<span data-ttu-id="10597-159">Gli operatori vengono valutati da sinistra a destra e hanno la stessa priorità di valutazione.</span><span class="sxs-lookup"><span data-stu-id="10597-159">Operators are evaluated left to right and have the same evaluation priority.</span></span> <span data-ttu-id="10597-160">Ad esempio, \* (moltiplicazione) non viene valutato prima di - (sottrazione).</span><span class="sxs-lookup"><span data-stu-id="10597-160">That is, the \* (multiplier) is not evaluated before - (subtraction).</span></span> <span data-ttu-id="10597-161">L'operazione 2\*(5+3) è diversa da 2\*5+3.</span><span class="sxs-lookup"><span data-stu-id="10597-161">2\*(5+3) is not the same as 2\*5+3.</span></span> <span data-ttu-id="10597-162">Le parentesi ( ) vengono usate per modificare l'ordine di valutazione quando un ordine da sinistra a destra non è appropriato.</span><span class="sxs-lookup"><span data-stu-id="10597-162">The brackets ( ) are used to change the evaluation order when left to right evaluation order isn't appropriate.</span></span>

## <a name="multi-valued-attributes"></a><span data-ttu-id="10597-163">Attributi multivalore</span><span class="sxs-lookup"><span data-stu-id="10597-163">Multi-valued attributes</span></span>
<span data-ttu-id="10597-164">Le funzioni possono essere usate con gli attributi a valore singolo e multivalore.</span><span class="sxs-lookup"><span data-stu-id="10597-164">The functions can operate on both single-valued and multi-valued attributes.</span></span> <span data-ttu-id="10597-165">Per gli attributi multivalore la funzione agisce su ogni valore e viene applicata la stessa funzione a ogni valore.</span><span class="sxs-lookup"><span data-stu-id="10597-165">For multi-valued attributes, the function operates over every value and applies the same function to every value.</span></span>

<span data-ttu-id="10597-166">Ad esempio </span><span class="sxs-lookup"><span data-stu-id="10597-166">For example:</span></span>  
<span data-ttu-id="10597-167">`Trim([proxyAddresses])` esegue un trimming di ogni valore nell'attributo proxyAddress.</span><span class="sxs-lookup"><span data-stu-id="10597-167">`Trim([proxyAddresses])` Do a Trim of every value in the proxyAddress attribute.</span></span>  
<span data-ttu-id="10597-168">`Word([proxyAddresses],1,"@") & "@contoso.com"`Per ogni valore con un @-sign, sostituire il dominio con @contoso.com.</span><span class="sxs-lookup"><span data-stu-id="10597-168">`Word([proxyAddresses],1,"@") & "@contoso.com"` For every value with an @-sign, replace the domain with @contoso.com.</span></span>  
<span data-ttu-id="10597-169">`IIF(InStr([proxyAddresses],"SIP:")=1,NULL,[proxyAddresses])` Cercare l'indirizzo SIP e rimuoverlo dai valori.</span><span class="sxs-lookup"><span data-stu-id="10597-169">`IIF(InStr([proxyAddresses],"SIP:")=1,NULL,[proxyAddresses])` Look for the SIP-address and remove it from the values.</span></span>

## <a name="next-steps"></a><span data-ttu-id="10597-170">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="10597-170">Next steps</span></span>
* <span data-ttu-id="10597-171">Per altre informazioni sul modello di configurazione, vedere [Servizio di sincronizzazione Azure AD Connect: Informazioni sul provisioning dichiarativo](active-directory-aadconnectsync-understanding-declarative-provisioning.md).</span><span class="sxs-lookup"><span data-stu-id="10597-171">Read more about the configuration model in [Understanding Declarative Provisioning](active-directory-aadconnectsync-understanding-declarative-provisioning.md).</span></span>
* <span data-ttu-id="10597-172">Per informazioni sull'uso del provisioning dichiarativo predefinito, vedere [Servizio di sincronizzazione Azure AD Connect: Informazioni sulla configurazione predefinita](active-directory-aadconnectsync-understanding-default-configuration.md).</span><span class="sxs-lookup"><span data-stu-id="10597-172">See how declarative provisioning is used out-of-box in [Understanding the default configuration](active-directory-aadconnectsync-understanding-default-configuration.md).</span></span>
* <span data-ttu-id="10597-173">Per informazioni su come apportare una modifica pratica con il provisioning dichiarativo, vedere [Servizio di sincronizzazione Azure AD Connect: come apportare modifiche alla configurazione predefinita](active-directory-aadconnectsync-change-the-configuration.md).</span><span class="sxs-lookup"><span data-stu-id="10597-173">See how to make a practical change using declarative provisioning in [How to make a change to the default configuration](active-directory-aadconnectsync-change-the-configuration.md).</span></span>

<span data-ttu-id="10597-174">**Argomenti generali**</span><span class="sxs-lookup"><span data-stu-id="10597-174">**Overview topics**</span></span>

* [<span data-ttu-id="10597-175">Servizio di sincronizzazione Azure AD Connect: Comprendere e personalizzare la sincronizzazione</span><span class="sxs-lookup"><span data-stu-id="10597-175">Azure AD Connect sync: Understand and customize synchronization</span></span>](active-directory-aadconnectsync-whatis.md)
* [<span data-ttu-id="10597-176">Integrazione delle identità locali con Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="10597-176">Integrating your on-premises identities with Azure Active Directory</span></span>](active-directory-aadconnect.md)

<span data-ttu-id="10597-177">**Argomenti di riferimento**</span><span class="sxs-lookup"><span data-stu-id="10597-177">**Reference topics**</span></span>

* [<span data-ttu-id="10597-178">Servizio di sincronizzazione Azure AD Connect: Riferimento alle funzioni</span><span class="sxs-lookup"><span data-stu-id="10597-178">Azure AD Connect sync: Functions Reference</span></span>](active-directory-aadconnectsync-functions-reference.md)

