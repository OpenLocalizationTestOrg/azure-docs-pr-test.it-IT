---
title: Escludere dischi dalla protezione tramite Azure Site Recovery | Microsoft Docs
description: "Descrive perché e come escludere dalla replica dischi di macchine virtuali per scenari da VMware ad Azure e da Hyper-V ad Azure."
services: site-recovery
documentationcenter: 
author: nsoneji
manager: garavd
editor: 
ms.assetid: 
ms.service: site-recovery
ms.workload: storage-backup-recovery
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: hero-article
ms.date: 06/05/2017
ms.author: nisoneji
ms.openlocfilehash: fccbe88e3c0c2b2f3e9958f5f2f27adc017e4d03
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/03/2017
---
# <a name="exclude-disks-from-replication"></a><span data-ttu-id="3228b-103">Escludere dischi dalla replica</span><span class="sxs-lookup"><span data-stu-id="3228b-103">Exclude disks from replication</span></span>
<span data-ttu-id="3228b-104">Questo articolo descrive come escludere dischi dalla replica,</span><span class="sxs-lookup"><span data-stu-id="3228b-104">This article describes how to exclude disks from replication.</span></span> <span data-ttu-id="3228b-105">in modo da ottimizzare la larghezza di banda di replica usata o le risorse lato destinazione usate dai dischi.</span><span class="sxs-lookup"><span data-stu-id="3228b-105">This exclusion can optimize the consumed replication bandwidth or optimize the target-side resources that such disks utilize.</span></span> <span data-ttu-id="3228b-106">La funzionalità è supportata per due tipi di scenari: da VMware ad Azure e da Hyper-V ad Azure.</span><span class="sxs-lookup"><span data-stu-id="3228b-106">The feature is supported for scenarios of VMware to Azure and Hyper-V to Azure.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="3228b-107">Prerequisiti</span><span class="sxs-lookup"><span data-stu-id="3228b-107">Prerequisites</span></span>

<span data-ttu-id="3228b-108">Per impostazione predefinita, vengono replicati tutti i dischi presenti in un computer.</span><span class="sxs-lookup"><span data-stu-id="3228b-108">By default, all disks on a machine are replicated.</span></span> <span data-ttu-id="3228b-109">Per escludere un disco dalla replica, è necessario installare manualmente il servizio Mobility nel computer prima di abilitare la replica, se si esegue la replica da VMware ad Azure.</span><span class="sxs-lookup"><span data-stu-id="3228b-109">To exclude a disk from replication, you must manually install the Mobility service on the machine before you enable replication if you are replicating from VMware to Azure.</span></span>


## <a name="why-exclude-disks-from-replication"></a><span data-ttu-id="3228b-110">Perché escludere dischi dalla replica</span><span class="sxs-lookup"><span data-stu-id="3228b-110">Why exclude disks from replication?</span></span>
<span data-ttu-id="3228b-111">Spesso è necessario escludere dischi dalla replica per i motivi riportati di seguito:</span><span class="sxs-lookup"><span data-stu-id="3228b-111">Excluding disks from replication is often necessary because:</span></span>

- <span data-ttu-id="3228b-112">I dati di varianza nel disco escluso non sono importanti o non devono essere necessariamente replicati.</span><span class="sxs-lookup"><span data-stu-id="3228b-112">The data that's churned on the excluded disk is not important or doesn’t need to be replicated.</span></span>

- <span data-ttu-id="3228b-113">Si preferisce salvare le risorse di archiviazione e di rete non eseguendo la replica di questa varianza.</span><span class="sxs-lookup"><span data-stu-id="3228b-113">You want to save storage and network resources by not replicating this churn.</span></span>

## <a name="what-are-the-typical-scenarios"></a><span data-ttu-id="3228b-114">Scenari tipici</span><span class="sxs-lookup"><span data-stu-id="3228b-114">What are the typical scenarios?</span></span>
<span data-ttu-id="3228b-115">È possibile identificare alcuni esempi specifici di varianza dei dati particolarmente adatti all'esclusione,</span><span class="sxs-lookup"><span data-stu-id="3228b-115">You can identify specific examples of data churn that are great candidates for exclusion.</span></span> <span data-ttu-id="3228b-116">come le scritture in un file di paging (pagefile.sys) e le scritture nel file tempdb di Microsoft SQL Server.</span><span class="sxs-lookup"><span data-stu-id="3228b-116">Examples might include writes to a paging file (pagefile.sys) and writes to the tempdb file of Microsoft SQL Server.</span></span> <span data-ttu-id="3228b-117">A seconda del carico di lavoro e del sottosistema di archiviazione, il file di paging può registrare una varianza significativa.</span><span class="sxs-lookup"><span data-stu-id="3228b-117">Depending on the workload and the storage subsystem, the paging file can register a significant amount of churn.</span></span> <span data-ttu-id="3228b-118">Tuttavia, la replica di questo tipo di dati dal sito primario ad Azure richiederebbe un utilizzo intensivo delle risorse.</span><span class="sxs-lookup"><span data-stu-id="3228b-118">However, replicating this data from the primary site to Azure would be resource intensive.</span></span> <span data-ttu-id="3228b-119">È quindi possibile ottimizzare la replica di una macchina virtuale con un singolo disco virtuale dotato di sistema operativo e file di paging eseguendo queste operazioni:</span><span class="sxs-lookup"><span data-stu-id="3228b-119">Thus, you can use the following steps to optimize replication of a virtual machine with a single virtual disk that has both the operating system and the paging file:</span></span>

1. <span data-ttu-id="3228b-120">Suddividere il singolo disco virtuale in due dischi virtuali,</span><span class="sxs-lookup"><span data-stu-id="3228b-120">Split the single virtual disk into two virtual disks.</span></span> <span data-ttu-id="3228b-121">uno con il sistema operativo e l'altro con il file di paging.</span><span class="sxs-lookup"><span data-stu-id="3228b-121">One virtual disk has the operating system, and the other has the paging file.</span></span>
2. <span data-ttu-id="3228b-122">Escludere il disco del file di paging dalla replica.</span><span class="sxs-lookup"><span data-stu-id="3228b-122">Exclude the paging file disk from replication.</span></span>

<span data-ttu-id="3228b-123">Analogamente, per ottimizzare un disco in cui sono presenti sia il file tempdb di Microsoft SQL Server sia il file del database di sistema, è possibile eseguire queste operazioni:</span><span class="sxs-lookup"><span data-stu-id="3228b-123">Similarly, you can use the following steps to optimize a disk that has both the Microsoft SQL Server tempdb fie and the system database file:</span></span>

1. <span data-ttu-id="3228b-124">Archiviare il database di sistema e il tempdb in due dischi distinti.</span><span class="sxs-lookup"><span data-stu-id="3228b-124">Keep the system database and tempdb on two different disks.</span></span>
2. <span data-ttu-id="3228b-125">Escludere il disco del tempdb dalla replica.</span><span class="sxs-lookup"><span data-stu-id="3228b-125">Exclude the tempdb disk from replication.</span></span>

## <a name="how-to-exclude-disks-from-replication"></a><span data-ttu-id="3228b-126">Come escludere dischi dalla replica</span><span class="sxs-lookup"><span data-stu-id="3228b-126">How to exclude disks from replication?</span></span>

### <a name="vmware-to-azure"></a><span data-ttu-id="3228b-127">Da VMware ad Azure</span><span class="sxs-lookup"><span data-stu-id="3228b-127">VMware to Azure</span></span>
<span data-ttu-id="3228b-128">Per proteggere una macchina virtuale dal portale di Azure Site Recovery, seguire il flusso di lavoro [Abilitare la replica](site-recovery-vmware-to-azure.md).</span><span class="sxs-lookup"><span data-stu-id="3228b-128">Follow the [Enable replication](site-recovery-vmware-to-azure.md) workflow to protect a virtual machine from the Azure Site Recovery portal.</span></span> <span data-ttu-id="3228b-129">Nel passaggio 4 del flusso di lavoro usare la colonna **DISCHI DA REPLICARE** per escludere dischi dalla replica.</span><span class="sxs-lookup"><span data-stu-id="3228b-129">In the fourth step of the workflow, use the **DISK TO REPLICATE** column to exclude disks from replication.</span></span> <span data-ttu-id="3228b-130">Per impostazione predefinita, tutti i dischi sono selezionati per la replica.</span><span class="sxs-lookup"><span data-stu-id="3228b-130">By default, all disks are selected for replication.</span></span> <span data-ttu-id="3228b-131">Deselezionare la casella di controllo relativa ai dischi da escludere dalla replica e quindi seguire la procedura per abilitare la replica.</span><span class="sxs-lookup"><span data-stu-id="3228b-131">Clear the check box of disks that you want to exclude from replication, and then complete the steps to enable replication.</span></span>

![Escludere i dischi dalla replica e abilitare la replica per il failback da VMware ad Azure](./media/site-recovery-exclude-disk/v2a-enable-replication-exclude-disk1.png)


>[!NOTE]
>
> * <span data-ttu-id="3228b-133">È possibile escludere solo i dischi in cui è già installato il servizio Mobility.</span><span class="sxs-lookup"><span data-stu-id="3228b-133">You can exclude only disks that already have the Mobility service installed.</span></span> <span data-ttu-id="3228b-134">È necessario installare manualmente il servizio Mobility perché questo servizio viene installato tramite il meccanismo di push solo dopo l'abilitazione della replica.</span><span class="sxs-lookup"><span data-stu-id="3228b-134">You need to manually install the Mobility service, because the Mobility service is only installed by using the push mechanism after replication is enabled.</span></span>
> * <span data-ttu-id="3228b-135">Solo i dischi di base possono essere esclusi dalla replica.</span><span class="sxs-lookup"><span data-stu-id="3228b-135">Only basic disks can be excluded from replication.</span></span> <span data-ttu-id="3228b-136">Non è possibile escludere dischi del sistema operativo o dinamici.</span><span class="sxs-lookup"><span data-stu-id="3228b-136">You can't exclude operating system or dynamic disks.</span></span>
> * <span data-ttu-id="3228b-137">Dopo aver abilitato la replica, non è più possibile aggiungere o rimuovere dischi da replicare.</span><span class="sxs-lookup"><span data-stu-id="3228b-137">After you enable replication, you can't add or remove disks for replication.</span></span> <span data-ttu-id="3228b-138">Se si vuole aggiungere o escludere un disco, è necessario disabilitare la protezione per il computer e quindi riabilitarla.</span><span class="sxs-lookup"><span data-stu-id="3228b-138">If you want to add or exclude a disk, you need to disable protection for the machine and then enable it again.</span></span>
> * <span data-ttu-id="3228b-139">Se si esclude un disco necessario per il funzionamento di un'applicazione, dopo il failover in Azure è necessario crearlo manualmente in Azure per consentire l'esecuzione dell'applicazione replicata.</span><span class="sxs-lookup"><span data-stu-id="3228b-139">If you exclude a disk that's needed for an application to operate, after failover to Azure, you’ll need to create the disk manually in Azure so that the replicated application can run.</span></span> <span data-ttu-id="3228b-140">In alternativa, è possibile integrare Automazione di Azure in un piano di ripristino per creare il disco durante il failover del computer.</span><span class="sxs-lookup"><span data-stu-id="3228b-140">Alternatively, you can integrate Azure automation into a recovery plan to create the disk during failover of the machine.</span></span>
> * <span data-ttu-id="3228b-141">Macchina virtuale Windows: per i dischi creati manualmente in Azure non viene eseguito il failback.</span><span class="sxs-lookup"><span data-stu-id="3228b-141">Window virtual machine: Disks that you create manually in Azure are not failed back.</span></span> <span data-ttu-id="3228b-142">Se, ad esempio, si esegue il failover di tre dischi e se ne creano due direttamente in Macchine virtuali di Azure, viene eseguito il failback solo dei tre dischi sottoposti a failover.</span><span class="sxs-lookup"><span data-stu-id="3228b-142">For example, if you fail over three disks and create two disk directly in Azure Virtual Machines, only three disks that were failed over are failed back.</span></span> <span data-ttu-id="3228b-143">Non è possibile includere i dischi creati manualmente nel failback o nella riprotezione da locale ad Azure.</span><span class="sxs-lookup"><span data-stu-id="3228b-143">You can't include disks that you created manually in failback or in reprotect from on-premises to Azure.</span></span>
> * <span data-ttu-id="3228b-144">Macchina virtuale Linux: per i dischi creati manualmente in Azure non viene eseguito il failback.</span><span class="sxs-lookup"><span data-stu-id="3228b-144">Linux virtual machine: Disks that you create manually in Azure are failed back.</span></span> <span data-ttu-id="3228b-145">Se, ad esempio, si esegue il failover di tre dischi e se ne creano due direttamente in Macchine virtuali di Azure, viene eseguito il failback di tutti e cinque i dischi.</span><span class="sxs-lookup"><span data-stu-id="3228b-145">For example, if you fail over three disks and create two disks directly in Azure Virtual Machines, all five will be failed back.</span></span> <span data-ttu-id="3228b-146">Non è possibile escludere i dischi creati manualmente dall'operazione di failback.</span><span class="sxs-lookup"><span data-stu-id="3228b-146">You can't exclude disks that were created manually from failback.</span></span>
>

### <a name="hyper-v-to-azure"></a><span data-ttu-id="3228b-147">Da Hyper-V ad Azure</span><span class="sxs-lookup"><span data-stu-id="3228b-147">Hyper-V to Azure</span></span>
<span data-ttu-id="3228b-148">Per proteggere una macchina virtuale dal portale di Azure Site Recovery, seguire il flusso di lavoro [Abilitare la replica](site-recovery-hyper-v-site-to-azure.md).</span><span class="sxs-lookup"><span data-stu-id="3228b-148">Follow the [Enable replication](site-recovery-hyper-v-site-to-azure.md) workflow to protect a virtual machine from the Azure Site Recovery portal.</span></span> <span data-ttu-id="3228b-149">Nel passaggio 4 del flusso di lavoro usare la colonna **DISCHI DA REPLICARE** per escludere dischi dalla replica.</span><span class="sxs-lookup"><span data-stu-id="3228b-149">In the fourth step of the workflow, use the **DISK TO REPLICATE** column to exclude disks from replication.</span></span> <span data-ttu-id="3228b-150">Per impostazione predefinita, tutti i dischi sono selezionati per la replica.</span><span class="sxs-lookup"><span data-stu-id="3228b-150">By default, all disks are selected for replication.</span></span> <span data-ttu-id="3228b-151">Deselezionare la casella di controllo relativa ai dischi da escludere dalla replica e quindi seguire la procedura per abilitare la replica.</span><span class="sxs-lookup"><span data-stu-id="3228b-151">Clear the check box of disks that you want to exclude from replication, and then complete the steps to enable replication.</span></span>

![Escludere i dischi dalla replica e abilitare la replica per il failback da Hyper-V ad Azure](./media/site-recovery-vmm-to-azure/enable-replication6-with-exclude-disk.png)

>[!NOTE]
>
> * <span data-ttu-id="3228b-153">È possibile escludere dalla replica solo dischi di base.</span><span class="sxs-lookup"><span data-stu-id="3228b-153">You can exclude only basic disks from replication.</span></span> <span data-ttu-id="3228b-154">Non è possibile escludere dischi del sistema operativo</span><span class="sxs-lookup"><span data-stu-id="3228b-154">You can't exclude operating system disks.</span></span> <span data-ttu-id="3228b-155">e non è consigliabile escludere dischi dinamici.</span><span class="sxs-lookup"><span data-stu-id="3228b-155">We recommend that you do not exclude dynamic disks.</span></span> <span data-ttu-id="3228b-156">Azure Site Recovery non è in grado di identificare se un disco rigido virtuale è un disco di base o un disco dinamico all'interno della macchina virtuale guest.</span><span class="sxs-lookup"><span data-stu-id="3228b-156">Azure Site Recovery cannot identify which virtual hard disk (VHD) is basic or dynamic in the guest virtual machine.</span></span>  <span data-ttu-id="3228b-157">Se non vengono esclusi tutti i volumi dinamici dipendenti, in caso di failover della macchina virtuale il disco dinamico protetto risulta in stato di errore e non è possibile accedere ai dati in esso contenuti.</span><span class="sxs-lookup"><span data-stu-id="3228b-157">If all dependent dynamic volume disks are not excluded, the protected dynamic disk becomes a failed disk on a failover virtual machine, and the data on that disk is not accessible.</span></span>
> * <span data-ttu-id="3228b-158">Dopo aver abilitato la replica, non è più possibile aggiungere o rimuovere dischi da replicare.</span><span class="sxs-lookup"><span data-stu-id="3228b-158">After you enable replication, you can't add or remove disks for replication.</span></span> <span data-ttu-id="3228b-159">Se si vuole aggiungere o escludere un disco, è necessario disabilitare la protezione per la macchina virtuale e quindi riabilitarla.</span><span class="sxs-lookup"><span data-stu-id="3228b-159">If you want to add or exclude a disk, you need to disable protection for the virtual machine and then enable it again.</span></span>
> * <span data-ttu-id="3228b-160">Se si esclude un disco necessario per il funzionamento di un'applicazione, dopo il failover in Azure è necessario crearlo manualmente in Azure per consentire l'esecuzione dell'applicazione replicata.</span><span class="sxs-lookup"><span data-stu-id="3228b-160">If you exclude a disk that's needed for an application to operate, after failover to Azure you’ll need to create the disk manually in Azure so that the replicated application can run.</span></span> <span data-ttu-id="3228b-161">In alternativa, è possibile integrare Automazione di Azure in un piano di ripristino per creare il disco durante il failover del computer.</span><span class="sxs-lookup"><span data-stu-id="3228b-161">Alternatively, you can integrate Azure automation into a recovery plan to create the disk during failover of the machine.</span></span>
> * <span data-ttu-id="3228b-162">Per i dischi creati manualmente in Azure non viene eseguito il failback.</span><span class="sxs-lookup"><span data-stu-id="3228b-162">Disks that you create manually in Azure will not be failed back.</span></span> <span data-ttu-id="3228b-163">Se, ad esempio, si esegue il failover di tre dischi e se ne creano due direttamente in Macchine virtuali di Azure, viene eseguito il failback da Azure a Hyper-V solo dei tre dischi sottoposti a failover.</span><span class="sxs-lookup"><span data-stu-id="3228b-163">For example, if you fail over three disks and create two disks directly in Azure Virtual Machines, only three disks that were failed over will be failed back from Azure to Hyper-V.</span></span> <span data-ttu-id="3228b-164">Non è possibile includere nel failback o nella replica inversa da Hyper-V ad Azure i dischi creati manualmente.</span><span class="sxs-lookup"><span data-stu-id="3228b-164">You can't include disks that were created manually in failback or in reverse replication from Hyper-V to Azure.</span></span>



## <a name="end-to-end-scenarios-of-exclude-disks"></a><span data-ttu-id="3228b-165">Scenari end-to-end di esclusione dei dischi</span><span class="sxs-lookup"><span data-stu-id="3228b-165">End-to-end scenarios of exclude disks</span></span>
<span data-ttu-id="3228b-166">Per capire la funzionalità di esclusione dei dischi, si prendano in considerazione i due scenari seguenti:</span><span class="sxs-lookup"><span data-stu-id="3228b-166">Let's consider two scenarios to understand the exclude disk feature:</span></span>

- <span data-ttu-id="3228b-167">Disco del tempdb di SQL Server</span><span class="sxs-lookup"><span data-stu-id="3228b-167">SQL Server tempdb disk</span></span>
- <span data-ttu-id="3228b-168">Disco del file di paging (pagefile.sys)</span><span class="sxs-lookup"><span data-stu-id="3228b-168">Paging file (pagefile.sys) disk</span></span>

### <a name="exclude-the-sql-server-tempdb-disk"></a><span data-ttu-id="3228b-169">Escludere il disco del tempdb di SQL Server</span><span class="sxs-lookup"><span data-stu-id="3228b-169">Exclude the SQL Server tempdb disk</span></span>
<span data-ttu-id="3228b-170">Si prenda ad esempio una macchina virtuale di SQL Server con un tempdb che è possibile escludere.</span><span class="sxs-lookup"><span data-stu-id="3228b-170">Let's consider a SQL Server virtual machine that has a tempdb that can be excluded.</span></span>

<span data-ttu-id="3228b-171">Il nome della macchina virtuale è SalesDB.</span><span class="sxs-lookup"><span data-stu-id="3228b-171">The name of the virtual disk is SalesDB.</span></span>

<span data-ttu-id="3228b-172">Di seguito sono elencati i dischi presenti nella macchina virtuale di origine:</span><span class="sxs-lookup"><span data-stu-id="3228b-172">Disks on the source virtual machine are as follows:</span></span>


<span data-ttu-id="3228b-173">**Nome del disco**</span><span class="sxs-lookup"><span data-stu-id="3228b-173">**Disk name**</span></span> | <span data-ttu-id="3228b-174">**N. disco sistema operativo guest**</span><span class="sxs-lookup"><span data-stu-id="3228b-174">**Guest operating system disk#**</span></span> | <span data-ttu-id="3228b-175">**Lettera di unità**</span><span class="sxs-lookup"><span data-stu-id="3228b-175">**Drive letter**</span></span> | <span data-ttu-id="3228b-176">**Tipo di dati nel disco**</span><span class="sxs-lookup"><span data-stu-id="3228b-176">**Data type on the disk**</span></span>
--- | --- | --- | ---
<span data-ttu-id="3228b-177">DB-Disk0-OS</span><span class="sxs-lookup"><span data-stu-id="3228b-177">DB-Disk0-OS</span></span> | <span data-ttu-id="3228b-178">DISK0</span><span class="sxs-lookup"><span data-stu-id="3228b-178">DISK0</span></span> | <span data-ttu-id="3228b-179">C:\\</span><span class="sxs-lookup"><span data-stu-id="3228b-179">C:\\</span></span> | <span data-ttu-id="3228b-180">Disco del sistema operativo</span><span class="sxs-lookup"><span data-stu-id="3228b-180">Operating system disk</span></span>
<span data-ttu-id="3228b-181">DB-Disk1</span><span class="sxs-lookup"><span data-stu-id="3228b-181">DB-Disk1</span></span>| <span data-ttu-id="3228b-182">Disk1</span><span class="sxs-lookup"><span data-stu-id="3228b-182">Disk1</span></span> | <span data-ttu-id="3228b-183">D:\\</span><span class="sxs-lookup"><span data-stu-id="3228b-183">D:\\</span></span> | <span data-ttu-id="3228b-184">Database di sistema SQL e Database1 dell'utente</span><span class="sxs-lookup"><span data-stu-id="3228b-184">SQL system database and User Database1</span></span>
<span data-ttu-id="3228b-185">DB-Disk2 (disco escluso dalla protezione)</span><span class="sxs-lookup"><span data-stu-id="3228b-185">DB-Disk2 (Excluded the disk from protection)</span></span> | <span data-ttu-id="3228b-186">Disk2</span><span class="sxs-lookup"><span data-stu-id="3228b-186">Disk2</span></span> | <span data-ttu-id="3228b-187">E:\\</span><span class="sxs-lookup"><span data-stu-id="3228b-187">E:\\</span></span> | <span data-ttu-id="3228b-188">File temporanei</span><span class="sxs-lookup"><span data-stu-id="3228b-188">Temp files</span></span>
<span data-ttu-id="3228b-189">DB-Disk3 (disco escluso dalla protezione)</span><span class="sxs-lookup"><span data-stu-id="3228b-189">DB-Disk3 (Excluded the disk from protection)</span></span> | <span data-ttu-id="3228b-190">Disk3</span><span class="sxs-lookup"><span data-stu-id="3228b-190">Disk3</span></span> | <span data-ttu-id="3228b-191">F:\\</span><span class="sxs-lookup"><span data-stu-id="3228b-191">F:\\</span></span> | <span data-ttu-id="3228b-192">Database tempdb di SQL (percorso della cartella, F:\MSSQL\Data\) </br /> </br />Annotare il percorso della cartella prima del failover.</span><span class="sxs-lookup"><span data-stu-id="3228b-192">SQL tempdb database (folder path(F:\MSSQL\Data\) </br /> </br />Write down the folder path before failover.</span></span>
<span data-ttu-id="3228b-193">DB-Disk4</span><span class="sxs-lookup"><span data-stu-id="3228b-193">DB-Disk4</span></span> | <span data-ttu-id="3228b-194">Disk4</span><span class="sxs-lookup"><span data-stu-id="3228b-194">Disk4</span></span> |<span data-ttu-id="3228b-195">G:\\</span><span class="sxs-lookup"><span data-stu-id="3228b-195">G:\\</span></span> |<span data-ttu-id="3228b-196">Database2 dell'utente</span><span class="sxs-lookup"><span data-stu-id="3228b-196">User Database2</span></span>

<span data-ttu-id="3228b-197">Data la natura temporanea della varianza dei dati nei due dischi della macchina virtuale, è opportuno escludere Disk2 e Disk3 dalla replica quando si protegge la macchina virtuale SalesDB.</span><span class="sxs-lookup"><span data-stu-id="3228b-197">Because data churn on two disks of the virtual machine is temporary, while you protect the SalesDB virtual machine, exclude Disk2 and Disk3 from replication.</span></span> <span data-ttu-id="3228b-198">Azure Site Recovery non eseguirà la replica di questi dischi,</span><span class="sxs-lookup"><span data-stu-id="3228b-198">Azure Site Recovery will not replicate those disks.</span></span> <span data-ttu-id="3228b-199">che durante il failover non saranno quindi presenti nella macchina virtuale di failover in Azure.</span><span class="sxs-lookup"><span data-stu-id="3228b-199">On failover, those disks will not be present on the failover virtual machine on Azure.</span></span>

<span data-ttu-id="3228b-200">Di seguito sono elencati i dischi presenti nella macchina virtuale di Azure dopo il failover:</span><span class="sxs-lookup"><span data-stu-id="3228b-200">Disks on the Azure virtual machine after failover are as follows:</span></span>

<span data-ttu-id="3228b-201">**N. disco sistema operativo guest**</span><span class="sxs-lookup"><span data-stu-id="3228b-201">**Guest operating system disk#**</span></span> | <span data-ttu-id="3228b-202">**Lettera di unità**</span><span class="sxs-lookup"><span data-stu-id="3228b-202">**Drive letter**</span></span> | <span data-ttu-id="3228b-203">**Tipo di dati nel disco**</span><span class="sxs-lookup"><span data-stu-id="3228b-203">**Data type on the disk**</span></span>
--- | --- | ---
<span data-ttu-id="3228b-204">DISK0</span><span class="sxs-lookup"><span data-stu-id="3228b-204">DISK0</span></span> | <span data-ttu-id="3228b-205">C:\\</span><span class="sxs-lookup"><span data-stu-id="3228b-205">C:\\</span></span> | <span data-ttu-id="3228b-206">Disco del sistema operativo</span><span class="sxs-lookup"><span data-stu-id="3228b-206">Operating system disk</span></span>
<span data-ttu-id="3228b-207">Disk1</span><span class="sxs-lookup"><span data-stu-id="3228b-207">Disk1</span></span> | <span data-ttu-id="3228b-208">E:\\</span><span class="sxs-lookup"><span data-stu-id="3228b-208">E:\\</span></span> | <span data-ttu-id="3228b-209">Archiviazione temporanea</br /> </br />Azure aggiunge questo disco e assegna la prima lettera di unità disponibile.</span><span class="sxs-lookup"><span data-stu-id="3228b-209">Temporary storage</br /> </br />Azure adds this disk and assigns the first available drive letter.</span></span>
<span data-ttu-id="3228b-210">Disk2</span><span class="sxs-lookup"><span data-stu-id="3228b-210">Disk2</span></span> | <span data-ttu-id="3228b-211">D:\\</span><span class="sxs-lookup"><span data-stu-id="3228b-211">D:\\</span></span> | <span data-ttu-id="3228b-212">Database di sistema SQL e Database1 dell'utente</span><span class="sxs-lookup"><span data-stu-id="3228b-212">SQL system database and User Database1</span></span>
<span data-ttu-id="3228b-213">Disk3</span><span class="sxs-lookup"><span data-stu-id="3228b-213">Disk3</span></span> | <span data-ttu-id="3228b-214">G:\\</span><span class="sxs-lookup"><span data-stu-id="3228b-214">G:\\</span></span> | <span data-ttu-id="3228b-215">Database2 dell'utente</span><span class="sxs-lookup"><span data-stu-id="3228b-215">User Database2</span></span>

<span data-ttu-id="3228b-216">Poiché Disk2 e Disk3 sono stati esclusi dalla macchina virtuale SalesDB, E: è la prima lettera di unità disponibile.</span><span class="sxs-lookup"><span data-stu-id="3228b-216">Because Disk2 and Disk3 were excluded from the SalesDB virtual machine, E: is the first drive letter from the available list.</span></span> <span data-ttu-id="3228b-217">Azure assegna quindi la lettera E: al volume di archiviazione temporanea.</span><span class="sxs-lookup"><span data-stu-id="3228b-217">Azure assigns E: to the temporary storage volume.</span></span> <span data-ttu-id="3228b-218">Per tutti i dischi replicati, la lettera di unità rimane invariata.</span><span class="sxs-lookup"><span data-stu-id="3228b-218">For all the replicated disks, the drive letters remain the same.</span></span>

<span data-ttu-id="3228b-219">Disk3 era il disco del tempdb di SQL (percorso della cartella del tempdb, F:\MSSQL\Data\)) ed è stato escluso dalla replica,</span><span class="sxs-lookup"><span data-stu-id="3228b-219">Disk3, which was the SQL tempdb disk (tempdb folder path F:\MSSQL\Data\), was excluded from replication.</span></span> <span data-ttu-id="3228b-220">non risultando disponibile nella macchina virtuale di failover.</span><span class="sxs-lookup"><span data-stu-id="3228b-220">The disk is not available on the failover virtual machine.</span></span> <span data-ttu-id="3228b-221">Di conseguenza, il servizio SQL si trova nello stato arrestato e necessita del percorso F:\MSSQL\Data.</span><span class="sxs-lookup"><span data-stu-id="3228b-221">As a result, the SQL service is in a stopped state, and it needs the F:\MSSQL\Data path.</span></span>

<span data-ttu-id="3228b-222">Per creare questo percorso, è possibile procedere in due modi:</span><span class="sxs-lookup"><span data-stu-id="3228b-222">There are two ways to create this path:</span></span>

- <span data-ttu-id="3228b-223">Aggiungere un nuovo disco e assegnare il percorso della cartella del tempdb.</span><span class="sxs-lookup"><span data-stu-id="3228b-223">Add a new disk and assign tempdb folder path.</span></span>
- <span data-ttu-id="3228b-224">Usare un disco di archiviazione temporanea esistente per il percorso della cartella del tempdb.</span><span class="sxs-lookup"><span data-stu-id="3228b-224">Use an existing temporary storage disk for the tempdb folder path.</span></span>

#### <a name="add-a-new-disk"></a><span data-ttu-id="3228b-225">Aggiungere un nuovo disco:</span><span class="sxs-lookup"><span data-stu-id="3228b-225">Add a new disk:</span></span>

1. <span data-ttu-id="3228b-226">Prima del failover, annotare i percorsi di tempdb.mdf e tempdb.ldf di SQL.</span><span class="sxs-lookup"><span data-stu-id="3228b-226">Write down the paths of SQL tempdb.mdf and tempdb.ldf before failover.</span></span>
2. <span data-ttu-id="3228b-227">Dal portale di Azure aggiungere un nuovo disco alla macchina virtuale di failover con dimensioni pari o superiori a quelle del disco di origine del tempdb SQL (Disk3).</span><span class="sxs-lookup"><span data-stu-id="3228b-227">From the Azure portal, add a new disk to the failover virtual machine with the same or more size as that of the source SQL tempdb disk (Disk3).</span></span>
3. <span data-ttu-id="3228b-228">Accedere alla macchina virtuale di Azure.</span><span class="sxs-lookup"><span data-stu-id="3228b-228">Sign in to the Azure virtual machine.</span></span> <span data-ttu-id="3228b-229">Dalla console di gestione del disco, diskmgmt.msc, inizializzare e formattare il disco appena aggiunto.</span><span class="sxs-lookup"><span data-stu-id="3228b-229">From the disk management (diskmgmt.msc) console, initialize and format the newly added disk.</span></span>
4. <span data-ttu-id="3228b-230">Assegnare la stessa lettera di unità usata dal disco del tempdb SQL (F:).</span><span class="sxs-lookup"><span data-stu-id="3228b-230">Assign the same drive letter that was used by the SQL tempdb disk (F:).</span></span>
5. <span data-ttu-id="3228b-231">Creare una cartella del tempdb nel volume F: (F:\MSSQL\Data).</span><span class="sxs-lookup"><span data-stu-id="3228b-231">Create a tempdb folder on the F: volume (F:\MSSQL\Data).</span></span>
6. <span data-ttu-id="3228b-232">Avviare il servizio SQL dalla console del servizio.</span><span class="sxs-lookup"><span data-stu-id="3228b-232">Start the SQL service from the service console.</span></span>

#### <a name="use-an-existing-temporary-storage-disk-for-the-sql-tempdb-folder-path"></a><span data-ttu-id="3228b-233">Usare un disco di archiviazione temporanea esistente per il percorso della cartella del tempdb SQL:</span><span class="sxs-lookup"><span data-stu-id="3228b-233">Use an existing temporary storage disk for the SQL tempdb folder path:</span></span>

1. <span data-ttu-id="3228b-234">Aprire un prompt dei comandi.</span><span class="sxs-lookup"><span data-stu-id="3228b-234">Open a command prompt.</span></span>
2. <span data-ttu-id="3228b-235">Eseguire SQL Server in modalità di ripristino dal prompt dei comandi.</span><span class="sxs-lookup"><span data-stu-id="3228b-235">Run SQL Server in recovery mode from the command prompt.</span></span>

        Net start MSSQLSERVER /f / T3608

3. <span data-ttu-id="3228b-236">Eseguire il comando sqlcmd seguente per sostituire il percorso del tempdb con il nuovo percorso.</span><span class="sxs-lookup"><span data-stu-id="3228b-236">Run the following sqlcmd to change the tempdb path to the new path.</span></span>

        sqlcmd -A -S SalesDB        **Use your SQL DBname**
        USE master;     
        GO      
        ALTER DATABASE tempdb       
        MODIFY FILE (NAME = tempdev, FILENAME = 'E:\MSSQL\tempdata\tempdb.mdf');
        GO      
        ALTER DATABASE tempdb       
        MODIFY FILE (NAME = templog, FILENAME = 'E:\MSSQL\tempdata\templog.ldf');       
        GO


4. <span data-ttu-id="3228b-237">Arrestare il servizio Microsoft SQL Server.</span><span class="sxs-lookup"><span data-stu-id="3228b-237">Stop the Microsoft SQL Server service.</span></span>

        Net stop MSSQLSERVER
5. <span data-ttu-id="3228b-238">Avviare il servizio Microsoft SQL Server.</span><span class="sxs-lookup"><span data-stu-id="3228b-238">Start the Microsoft SQL Server service.</span></span>

        Net start MSSQLSERVER

<span data-ttu-id="3228b-239">Vedere le linee guida di Azure seguenti per il disco di archiviazione temporanea:</span><span class="sxs-lookup"><span data-stu-id="3228b-239">Refer to the following Azure guideline for temporary storage disk:</span></span>

* <span data-ttu-id="3228b-240">[Using SSDs in Azure VMs to store SQL Server TempDB and Buffer Pool Extensions](https://blogs.technet.microsoft.com/dataplatforminsider/2014/09/25/using-ssds-in-azure-vms-to-store-sql-server-tempdb-and-buffer-pool-extensions/) (Uso di SSD in VM di Azure per archiviare estensioni del pool di buffer e del tempdb di SQL Server)</span><span class="sxs-lookup"><span data-stu-id="3228b-240">[Using SSDs in Azure VMs to store SQL Server TempDB and Buffer Pool Extensions](https://blogs.technet.microsoft.com/dataplatforminsider/2014/09/25/using-ssds-in-azure-vms-to-store-sql-server-tempdb-and-buffer-pool-extensions/)</span></span>
* [<span data-ttu-id="3228b-241">Procedure consigliate per le prestazioni per SQL Server in Macchine virtuali di Azure</span><span class="sxs-lookup"><span data-stu-id="3228b-241">Performance best practices for SQL Server in Azure Virtual Machines</span></span>](https://docs.microsoft.com/azure/virtual-machines/windows/sql/virtual-machines-windows-sql-performance)

### <a name="failback-from-azure-to-an-on-premises-host"></a><span data-ttu-id="3228b-242">Failback da Azure a un host locale</span><span class="sxs-lookup"><span data-stu-id="3228b-242">Failback (from Azure to an on-premises host)</span></span>
<span data-ttu-id="3228b-243">Questa sezione illustra quali dischi vengono replicati quando si esegue il failover da Azure all'host Hyper-V o VMware locale.</span><span class="sxs-lookup"><span data-stu-id="3228b-243">Now let's understand the disks that are replicated when you fail over from Azure to your on-premises VMware or Hyper-V host.</span></span> <span data-ttu-id="3228b-244">Per i dischi creati manualmente in Azure non viene eseguita la replica.</span><span class="sxs-lookup"><span data-stu-id="3228b-244">Disks that you create manually in Azure will not be replicated.</span></span> <span data-ttu-id="3228b-245">Se, ad esempio, si esegue il failover di tre dischi e se ne creano due direttamente in Macchine virtuali di Azure, viene eseguito il failback solo dei tre dischi sottoposti a failover.</span><span class="sxs-lookup"><span data-stu-id="3228b-245">For example, if you fail over three disks and create two directly in Azure Virtual Machines, only three disks that were failed over will be failed back.</span></span> <span data-ttu-id="3228b-246">Non è possibile includere i dischi creati manualmente nel failback o nella riprotezione da locale ad Azure.</span><span class="sxs-lookup"><span data-stu-id="3228b-246">You can't include disks that were created manually in failback or in reprotect from on-premises to Azure.</span></span> <span data-ttu-id="3228b-247">Negli host locali non viene eseguita la replica neppure del disco di archiviazione temporanea.</span><span class="sxs-lookup"><span data-stu-id="3228b-247">It also does not replicate the temporary storage disk to on-premises hosts.</span></span>

#### <a name="failback-to-original-location-recovery"></a><span data-ttu-id="3228b-248">Ripristino di failback nella posizione originale</span><span class="sxs-lookup"><span data-stu-id="3228b-248">Failback to original location recovery</span></span>

<span data-ttu-id="3228b-249">Di seguito è illustrata la configurazione dei dischi della macchina virtuale di Azure nell'esempio precedente:</span><span class="sxs-lookup"><span data-stu-id="3228b-249">In the previous example, the Azure virtual machine disk configuration is as follows:</span></span>

<span data-ttu-id="3228b-250">**N. disco sistema operativo guest**</span><span class="sxs-lookup"><span data-stu-id="3228b-250">**Guest operating system disk#**</span></span> | <span data-ttu-id="3228b-251">**Lettera di unità**</span><span class="sxs-lookup"><span data-stu-id="3228b-251">**Drive letter**</span></span> | <span data-ttu-id="3228b-252">**Tipo di dati nel disco**</span><span class="sxs-lookup"><span data-stu-id="3228b-252">**Data type on the disk**</span></span>
--- | --- | ---
<span data-ttu-id="3228b-253">DISK0</span><span class="sxs-lookup"><span data-stu-id="3228b-253">DISK0</span></span> | <span data-ttu-id="3228b-254">C:\\</span><span class="sxs-lookup"><span data-stu-id="3228b-254">C:\\</span></span> | <span data-ttu-id="3228b-255">Disco del sistema operativo</span><span class="sxs-lookup"><span data-stu-id="3228b-255">Operating system disk</span></span>
<span data-ttu-id="3228b-256">Disk1</span><span class="sxs-lookup"><span data-stu-id="3228b-256">Disk1</span></span> | <span data-ttu-id="3228b-257">E:\\</span><span class="sxs-lookup"><span data-stu-id="3228b-257">E:\\</span></span> | <span data-ttu-id="3228b-258">Archiviazione temporanea</br /> </br />Azure aggiunge questo disco e assegna la prima lettera di unità disponibile.</span><span class="sxs-lookup"><span data-stu-id="3228b-258">Temporary storage</br /> </br />Azure adds this disk and assigns the first available drive letter.</span></span>
<span data-ttu-id="3228b-259">Disk2</span><span class="sxs-lookup"><span data-stu-id="3228b-259">Disk2</span></span> | <span data-ttu-id="3228b-260">D:\\</span><span class="sxs-lookup"><span data-stu-id="3228b-260">D:\\</span></span> | <span data-ttu-id="3228b-261">Database di sistema SQL e Database1 dell'utente</span><span class="sxs-lookup"><span data-stu-id="3228b-261">SQL system database and User Database1</span></span>
<span data-ttu-id="3228b-262">Disk3</span><span class="sxs-lookup"><span data-stu-id="3228b-262">Disk3</span></span> | <span data-ttu-id="3228b-263">G:\\</span><span class="sxs-lookup"><span data-stu-id="3228b-263">G:\\</span></span> | <span data-ttu-id="3228b-264">Database2 dell'utente</span><span class="sxs-lookup"><span data-stu-id="3228b-264">User Database2</span></span>


#### <a name="vmware-to-azure"></a><span data-ttu-id="3228b-265">Da VMware ad Azure</span><span class="sxs-lookup"><span data-stu-id="3228b-265">VMware to Azure</span></span>
<span data-ttu-id="3228b-266">Al termine del failback nella posizione originale, la configurazione dei dischi della macchina virtuale di failback non prevede l'esclusione di dischi.</span><span class="sxs-lookup"><span data-stu-id="3228b-266">When failback is done to the original location, the failback virtual machine disk configuration does not have excluded disks.</span></span> <span data-ttu-id="3228b-267">Nella macchina virtuale di failback non saranno quindi disponibili i dischi esclusi dalla replica da VMware ad Azure.</span><span class="sxs-lookup"><span data-stu-id="3228b-267">Disks that were excluded from VMware to Azure  will not be available on the failback virtual machine.</span></span>

<span data-ttu-id="3228b-268">Dopo il failover pianificato da Azure a VMware in locale, i dischi della macchina virtuale VMWare (posizione originale) avranno la configurazione seguente:</span><span class="sxs-lookup"><span data-stu-id="3228b-268">After planned failover from Azure to on-premises VMware, disks on the VMWare virtual machine (original location) are as follows:</span></span>

<span data-ttu-id="3228b-269">**N. disco sistema operativo guest**</span><span class="sxs-lookup"><span data-stu-id="3228b-269">**Guest operating system disk#**</span></span> | <span data-ttu-id="3228b-270">**Lettera di unità**</span><span class="sxs-lookup"><span data-stu-id="3228b-270">**Drive letter**</span></span> | <span data-ttu-id="3228b-271">**Tipo di dati nel disco**</span><span class="sxs-lookup"><span data-stu-id="3228b-271">**Data type on the disk**</span></span>
--- | --- | ---
<span data-ttu-id="3228b-272">DISK0</span><span class="sxs-lookup"><span data-stu-id="3228b-272">DISK0</span></span> | <span data-ttu-id="3228b-273">C:\\</span><span class="sxs-lookup"><span data-stu-id="3228b-273">C:\\</span></span> | <span data-ttu-id="3228b-274">Disco del sistema operativo</span><span class="sxs-lookup"><span data-stu-id="3228b-274">Operating system disk</span></span>
<span data-ttu-id="3228b-275">Disk1</span><span class="sxs-lookup"><span data-stu-id="3228b-275">Disk1</span></span> | <span data-ttu-id="3228b-276">D:\\</span><span class="sxs-lookup"><span data-stu-id="3228b-276">D:\\</span></span> | <span data-ttu-id="3228b-277">Database di sistema SQL e Database1 dell'utente</span><span class="sxs-lookup"><span data-stu-id="3228b-277">SQL system database and User Database1</span></span>
<span data-ttu-id="3228b-278">Disk2</span><span class="sxs-lookup"><span data-stu-id="3228b-278">Disk2</span></span> | <span data-ttu-id="3228b-279">G:\\</span><span class="sxs-lookup"><span data-stu-id="3228b-279">G:\\</span></span> | <span data-ttu-id="3228b-280">Database2 dell'utente</span><span class="sxs-lookup"><span data-stu-id="3228b-280">User Database2</span></span>

#### <a name="hyper-v-to-azure"></a><span data-ttu-id="3228b-281">Da Hyper-V ad Azure</span><span class="sxs-lookup"><span data-stu-id="3228b-281">Hyper-V to Azure</span></span>
<span data-ttu-id="3228b-282">Quando il failback viene eseguito nella posizione originale, la configurazione dei dischi della macchina virtuale di failback rimane identica a quella della macchina virtuale originale per Hyper-V.</span><span class="sxs-lookup"><span data-stu-id="3228b-282">When failback is to the original location, the failback virtual machine disk configuration remains the same as that of original virtual machine disk configuration for Hyper-V.</span></span> <span data-ttu-id="3228b-283">Nella macchina virtuale di failback non saranno quindi disponibili i dischi esclusi dalla replica dal sito Hyper-V ad Azure.</span><span class="sxs-lookup"><span data-stu-id="3228b-283">Disks that were excluded from Hyper-V site to Azure are available on the failback virtual machine.</span></span>

<span data-ttu-id="3228b-284">Dopo il failover pianificato da Azure a Hyper-V in locale, i dischi della macchina virtuale Hyper-V (posizione originale) avranno la configurazione seguente:</span><span class="sxs-lookup"><span data-stu-id="3228b-284">After planned failover from Azure to on-premises Hyper-V, disks on the Hyper-V virtual machine (original location) are as follows:</span></span>

<span data-ttu-id="3228b-285">**Nome del disco**</span><span class="sxs-lookup"><span data-stu-id="3228b-285">**Disk Name**</span></span> | <span data-ttu-id="3228b-286">**N. disco sistema operativo guest**</span><span class="sxs-lookup"><span data-stu-id="3228b-286">**Guest operating system disk#**</span></span> | <span data-ttu-id="3228b-287">**Lettera di unità**</span><span class="sxs-lookup"><span data-stu-id="3228b-287">**Drive letter**</span></span> | <span data-ttu-id="3228b-288">**Tipo di dati nel disco**</span><span class="sxs-lookup"><span data-stu-id="3228b-288">**Data type on the disk**</span></span>
--- | --- | --- | ---
<span data-ttu-id="3228b-289">DB-Disk0-OS</span><span class="sxs-lookup"><span data-stu-id="3228b-289">DB-Disk0-OS</span></span> | <span data-ttu-id="3228b-290">DISK0</span><span class="sxs-lookup"><span data-stu-id="3228b-290">DISK0</span></span> |   <span data-ttu-id="3228b-291">C:\\</span><span class="sxs-lookup"><span data-stu-id="3228b-291">C:\\</span></span> | <span data-ttu-id="3228b-292">Disco del sistema operativo</span><span class="sxs-lookup"><span data-stu-id="3228b-292">Operating system disk</span></span>
<span data-ttu-id="3228b-293">DB-Disk1</span><span class="sxs-lookup"><span data-stu-id="3228b-293">DB-Disk1</span></span> | <span data-ttu-id="3228b-294">Disk1</span><span class="sxs-lookup"><span data-stu-id="3228b-294">Disk1</span></span> | <span data-ttu-id="3228b-295">D:\\</span><span class="sxs-lookup"><span data-stu-id="3228b-295">D:\\</span></span> | <span data-ttu-id="3228b-296">Database di sistema SQL e Database1 dell'utente</span><span class="sxs-lookup"><span data-stu-id="3228b-296">SQL system database and User Database1</span></span>
<span data-ttu-id="3228b-297">DB-Disk2 (disco escluso)</span><span class="sxs-lookup"><span data-stu-id="3228b-297">DB-Disk2 (Excluded disk)</span></span> | <span data-ttu-id="3228b-298">Disk2</span><span class="sxs-lookup"><span data-stu-id="3228b-298">Disk2</span></span> | <span data-ttu-id="3228b-299">E:\\</span><span class="sxs-lookup"><span data-stu-id="3228b-299">E:\\</span></span> | <span data-ttu-id="3228b-300">File temporanei</span><span class="sxs-lookup"><span data-stu-id="3228b-300">Temp files</span></span>
<span data-ttu-id="3228b-301">DB-Disk3 (disco escluso)</span><span class="sxs-lookup"><span data-stu-id="3228b-301">DB-Disk3 (Excluded disk)</span></span> | <span data-ttu-id="3228b-302">Disk3</span><span class="sxs-lookup"><span data-stu-id="3228b-302">Disk3</span></span> | <span data-ttu-id="3228b-303">F:\\</span><span class="sxs-lookup"><span data-stu-id="3228b-303">F:\\</span></span> | <span data-ttu-id="3228b-304">Database tempdb SQL (percorso della cartella, F:\MSSQL\Data\)</span><span class="sxs-lookup"><span data-stu-id="3228b-304">SQL tempdb database (folder path(F:\MSSQL\Data\)</span></span>
<span data-ttu-id="3228b-305">DB-Disk4</span><span class="sxs-lookup"><span data-stu-id="3228b-305">DB-Disk4</span></span> | <span data-ttu-id="3228b-306">Disk4</span><span class="sxs-lookup"><span data-stu-id="3228b-306">Disk4</span></span> | <span data-ttu-id="3228b-307">G:\\</span><span class="sxs-lookup"><span data-stu-id="3228b-307">G:\\</span></span> | <span data-ttu-id="3228b-308">Database2 dell'utente</span><span class="sxs-lookup"><span data-stu-id="3228b-308">User Database2</span></span>


#### <a name="exclude-the-paging-file-pagefilesys-disk"></a><span data-ttu-id="3228b-309">Escludere il disco del file di paging (pagefile.sys)</span><span class="sxs-lookup"><span data-stu-id="3228b-309">Exclude the paging file (pagefile.sys) disk</span></span>

<span data-ttu-id="3228b-310">Si prenda ad esempio una macchina virtuale con un disco del file di paging che è possibile escludere.</span><span class="sxs-lookup"><span data-stu-id="3228b-310">Let's consider a virtual machine that has a paging file disk that can be excluded.</span></span>
<span data-ttu-id="3228b-311">I casi possibili sono due:</span><span class="sxs-lookup"><span data-stu-id="3228b-311">There are two cases.</span></span>

#### <a name="case-1-the-paging-file-is-configured-on-the-d-drive"></a><span data-ttu-id="3228b-312">Caso 1: file di paging configurato nell'unità D:</span><span class="sxs-lookup"><span data-stu-id="3228b-312">Case 1: The paging file is configured on the D: drive</span></span>
<span data-ttu-id="3228b-313">Di seguito è illustrata la configurazione dei dischi:</span><span class="sxs-lookup"><span data-stu-id="3228b-313">Here's the disk configuration:</span></span>


<span data-ttu-id="3228b-314">**Nome del disco**</span><span class="sxs-lookup"><span data-stu-id="3228b-314">**Disk name**</span></span> | <span data-ttu-id="3228b-315">**N. disco sistema operativo guest**</span><span class="sxs-lookup"><span data-stu-id="3228b-315">**Guest operating system disk#**</span></span> | <span data-ttu-id="3228b-316">**Lettera di unità**</span><span class="sxs-lookup"><span data-stu-id="3228b-316">**Drive letter**</span></span> | <span data-ttu-id="3228b-317">**Tipo di dati nel disco**</span><span class="sxs-lookup"><span data-stu-id="3228b-317">**Data type on the disk**</span></span>
--- | --- | --- | ---
<span data-ttu-id="3228b-318">DB-Disk0-OS</span><span class="sxs-lookup"><span data-stu-id="3228b-318">DB-Disk0-OS</span></span> | <span data-ttu-id="3228b-319">DISK0</span><span class="sxs-lookup"><span data-stu-id="3228b-319">DISK0</span></span> | <span data-ttu-id="3228b-320">C:\\</span><span class="sxs-lookup"><span data-stu-id="3228b-320">C:\\</span></span> | <span data-ttu-id="3228b-321">Disco del sistema operativo</span><span class="sxs-lookup"><span data-stu-id="3228b-321">Operating system disk</span></span>
<span data-ttu-id="3228b-322">DB-Disk1 (disco escluso dalla protezione)</span><span class="sxs-lookup"><span data-stu-id="3228b-322">DB-Disk1 (Excluded the disk from the protection)</span></span> | <span data-ttu-id="3228b-323">Disk1</span><span class="sxs-lookup"><span data-stu-id="3228b-323">Disk1</span></span> | <span data-ttu-id="3228b-324">D:\\</span><span class="sxs-lookup"><span data-stu-id="3228b-324">D:\\</span></span> | <span data-ttu-id="3228b-325">pagefile.sys</span><span class="sxs-lookup"><span data-stu-id="3228b-325">pagefile.sys</span></span>
<span data-ttu-id="3228b-326">DB-Disk2</span><span class="sxs-lookup"><span data-stu-id="3228b-326">DB-Disk2</span></span> | <span data-ttu-id="3228b-327">Disk2</span><span class="sxs-lookup"><span data-stu-id="3228b-327">Disk2</span></span> | <span data-ttu-id="3228b-328">E:\\</span><span class="sxs-lookup"><span data-stu-id="3228b-328">E:\\</span></span> | <span data-ttu-id="3228b-329">Dati utente 1</span><span class="sxs-lookup"><span data-stu-id="3228b-329">User data 1</span></span>
<span data-ttu-id="3228b-330">DB-Disk3</span><span class="sxs-lookup"><span data-stu-id="3228b-330">DB-Disk3</span></span> | <span data-ttu-id="3228b-331">Disk3</span><span class="sxs-lookup"><span data-stu-id="3228b-331">Disk3</span></span> | <span data-ttu-id="3228b-332">F:\\</span><span class="sxs-lookup"><span data-stu-id="3228b-332">F:\\</span></span> | <span data-ttu-id="3228b-333">Dati utente 2</span><span class="sxs-lookup"><span data-stu-id="3228b-333">User data 2</span></span>

<span data-ttu-id="3228b-334">Di seguito sono illustrate le impostazioni del file di paging nella macchina virtuale di origine:</span><span class="sxs-lookup"><span data-stu-id="3228b-334">Here are the paging file settings on the source virtual machine:</span></span>

![Impostazioni del file di paging nella macchina virtuale di origine](./media/site-recovery-exclude-disk/pagefile-on-d-drive-sourceVM.png)


<span data-ttu-id="3228b-336">Dopo il failover della macchina virtuale da VMware ad Azure o da Hyper-V ad Azure, i dischi nella macchina virtuale di Azure hanno la configurazione seguente:</span><span class="sxs-lookup"><span data-stu-id="3228b-336">After failover of the virtual machine from VMware to Azure or Hyper-V to Azure, disks on the Azure virtual machine are as follows:</span></span>

<span data-ttu-id="3228b-337">**Nome del disco**</span><span class="sxs-lookup"><span data-stu-id="3228b-337">**Disk name**</span></span> | <span data-ttu-id="3228b-338">**N. disco sistema operativo guest**</span><span class="sxs-lookup"><span data-stu-id="3228b-338">**Guest operating system disk#**</span></span> | <span data-ttu-id="3228b-339">**Lettera di unità**</span><span class="sxs-lookup"><span data-stu-id="3228b-339">**Drive letter**</span></span> | <span data-ttu-id="3228b-340">**Tipo di dati nel disco**</span><span class="sxs-lookup"><span data-stu-id="3228b-340">**Data type on the disk**</span></span>
--- | --- | --- | ---
<span data-ttu-id="3228b-341">DB-Disk0-OS</span><span class="sxs-lookup"><span data-stu-id="3228b-341">DB-Disk0-OS</span></span> | <span data-ttu-id="3228b-342">DISK0</span><span class="sxs-lookup"><span data-stu-id="3228b-342">DISK0</span></span> | <span data-ttu-id="3228b-343">C:\\</span><span class="sxs-lookup"><span data-stu-id="3228b-343">C:\\</span></span> | <span data-ttu-id="3228b-344">Disco del sistema operativo</span><span class="sxs-lookup"><span data-stu-id="3228b-344">Operating system disk</span></span>
<span data-ttu-id="3228b-345">DB-Disk1</span><span class="sxs-lookup"><span data-stu-id="3228b-345">DB-Disk1</span></span> | <span data-ttu-id="3228b-346">Disk1</span><span class="sxs-lookup"><span data-stu-id="3228b-346">Disk1</span></span> | <span data-ttu-id="3228b-347">D:\\</span><span class="sxs-lookup"><span data-stu-id="3228b-347">D:\\</span></span> | <span data-ttu-id="3228b-348">Archiviazione temporanea</br /> </br />pagefile.sys</span><span class="sxs-lookup"><span data-stu-id="3228b-348">Temporary storage</br /> </br />pagefile.sys</span></span>
<span data-ttu-id="3228b-349">DB-Disk2</span><span class="sxs-lookup"><span data-stu-id="3228b-349">DB-Disk2</span></span> | <span data-ttu-id="3228b-350">Disk2</span><span class="sxs-lookup"><span data-stu-id="3228b-350">Disk2</span></span> | <span data-ttu-id="3228b-351">E:\\</span><span class="sxs-lookup"><span data-stu-id="3228b-351">E:\\</span></span> | <span data-ttu-id="3228b-352">Dati utente 1</span><span class="sxs-lookup"><span data-stu-id="3228b-352">User data 1</span></span>
<span data-ttu-id="3228b-353">DB-Disk3</span><span class="sxs-lookup"><span data-stu-id="3228b-353">DB-Disk3</span></span> | <span data-ttu-id="3228b-354">Disk3</span><span class="sxs-lookup"><span data-stu-id="3228b-354">Disk3</span></span> | <span data-ttu-id="3228b-355">F:\\</span><span class="sxs-lookup"><span data-stu-id="3228b-355">F:\\</span></span> | <span data-ttu-id="3228b-356">Dati utente 2</span><span class="sxs-lookup"><span data-stu-id="3228b-356">User data 2</span></span>

<span data-ttu-id="3228b-357">Poiché Disk1 (D:) è stato escluso, D: è la prima lettera di unità disponibile</span><span class="sxs-lookup"><span data-stu-id="3228b-357">Because Disk1 (D:) was excluded, D: is the first drive letter from the available list.</span></span> <span data-ttu-id="3228b-358">e viene assegnata da Azure al volume di archiviazione temporanea.</span><span class="sxs-lookup"><span data-stu-id="3228b-358">Azure assigns D: to the temporary storage volume.</span></span> <span data-ttu-id="3228b-359">Poiché l'unità D: è disponibile nella macchina virtuale di Azure, le impostazioni del file di paging della macchina virtuale rimangono invariate.</span><span class="sxs-lookup"><span data-stu-id="3228b-359">Because D: is available on the Azure virtual machine, the paging file setting of the virtual machine remains the same.</span></span>

<span data-ttu-id="3228b-360">Di seguito sono illustrate le impostazioni del file di paging nella macchina virtuale di Azure:</span><span class="sxs-lookup"><span data-stu-id="3228b-360">Here are the paging file settings on the Azure virtual machine:</span></span>

![Impostazioni del file di paging nella macchina virtuale di Azure](./media/site-recovery-exclude-disk/pagefile-on-Azure-vm-after-failover.png)

#### <a name="case-2-the-paging-file-is-configured-on-another-drive-other-than-d-drive"></a><span data-ttu-id="3228b-362">Caso 2: file di paging configurato in un'unità diversa da D:</span><span class="sxs-lookup"><span data-stu-id="3228b-362">Case 2: The paging file is configured on another drive (other than D: drive)</span></span>

<span data-ttu-id="3228b-363">Di seguito è illustrata la configurazione dei dischi della macchina virtuale di origine:</span><span class="sxs-lookup"><span data-stu-id="3228b-363">Here's the source virtual machine disk configuration:</span></span>

<span data-ttu-id="3228b-364">**Nome del disco**</span><span class="sxs-lookup"><span data-stu-id="3228b-364">**Disk name**</span></span> | <span data-ttu-id="3228b-365">**N. disco sistema operativo guest**</span><span class="sxs-lookup"><span data-stu-id="3228b-365">**Guest operating system disk#**</span></span> | <span data-ttu-id="3228b-366">**Lettera di unità**</span><span class="sxs-lookup"><span data-stu-id="3228b-366">**Drive letter**</span></span> | <span data-ttu-id="3228b-367">**Tipo di dati nel disco**</span><span class="sxs-lookup"><span data-stu-id="3228b-367">**Data type on the disk**</span></span>
--- | --- | --- | ---
<span data-ttu-id="3228b-368">DB-Disk0-OS</span><span class="sxs-lookup"><span data-stu-id="3228b-368">DB-Disk0-OS</span></span> | <span data-ttu-id="3228b-369">DISK0</span><span class="sxs-lookup"><span data-stu-id="3228b-369">DISK0</span></span> | <span data-ttu-id="3228b-370">C:\\</span><span class="sxs-lookup"><span data-stu-id="3228b-370">C:\\</span></span> | <span data-ttu-id="3228b-371">Disco del sistema operativo</span><span class="sxs-lookup"><span data-stu-id="3228b-371">Operating system disk</span></span>
<span data-ttu-id="3228b-372">DB-Disk1 (disco escluso dalla protezione)</span><span class="sxs-lookup"><span data-stu-id="3228b-372">DB-Disk1 (Excluded the disk from protection)</span></span> | <span data-ttu-id="3228b-373">Disk1</span><span class="sxs-lookup"><span data-stu-id="3228b-373">Disk1</span></span> | <span data-ttu-id="3228b-374">G:\\</span><span class="sxs-lookup"><span data-stu-id="3228b-374">G:\\</span></span> | <span data-ttu-id="3228b-375">pagefile.sys</span><span class="sxs-lookup"><span data-stu-id="3228b-375">pagefile.sys</span></span>
<span data-ttu-id="3228b-376">DB-Disk2</span><span class="sxs-lookup"><span data-stu-id="3228b-376">DB-Disk2</span></span> | <span data-ttu-id="3228b-377">Disk2</span><span class="sxs-lookup"><span data-stu-id="3228b-377">Disk2</span></span> | <span data-ttu-id="3228b-378">E:\\</span><span class="sxs-lookup"><span data-stu-id="3228b-378">E:\\</span></span> | <span data-ttu-id="3228b-379">Dati utente 1</span><span class="sxs-lookup"><span data-stu-id="3228b-379">User data 1</span></span>
<span data-ttu-id="3228b-380">DB-Disk3</span><span class="sxs-lookup"><span data-stu-id="3228b-380">DB-Disk3</span></span> | <span data-ttu-id="3228b-381">Disk3</span><span class="sxs-lookup"><span data-stu-id="3228b-381">Disk3</span></span> | <span data-ttu-id="3228b-382">F:\\</span><span class="sxs-lookup"><span data-stu-id="3228b-382">F:\\</span></span> | <span data-ttu-id="3228b-383">Dati utente 2</span><span class="sxs-lookup"><span data-stu-id="3228b-383">User data 2</span></span>

<span data-ttu-id="3228b-384">Di seguito sono illustrate le impostazioni del file di paging nella macchina virtuale locale:</span><span class="sxs-lookup"><span data-stu-id="3228b-384">Here are the paging file settings on the on-premises virtual machine:</span></span>

![Impostazioni del file di paging nella macchina virtuale locale](./media/site-recovery-exclude-disk/pagefile-on-g-drive-sourceVM.png)

<span data-ttu-id="3228b-386">Dopo il failover della macchina virtuale da VMware/Hyper-V ad Azure, i dischi nella macchina virtuale di Azure hanno la configurazione seguente:</span><span class="sxs-lookup"><span data-stu-id="3228b-386">After failover of the virtual machine from VMware/Hyper-V to Azure, disks on the Azure virtual machine are as follows:</span></span>

<span data-ttu-id="3228b-387">**Nome del disco**</span><span class="sxs-lookup"><span data-stu-id="3228b-387">**Disk name**</span></span>| <span data-ttu-id="3228b-388">**N. disco sistema operativo guest**</span><span class="sxs-lookup"><span data-stu-id="3228b-388">**Guest operating system disk#**</span></span>| <span data-ttu-id="3228b-389">**Lettera di unità**</span><span class="sxs-lookup"><span data-stu-id="3228b-389">**Drive letter**</span></span> | <span data-ttu-id="3228b-390">**Tipo di dati nel disco**</span><span class="sxs-lookup"><span data-stu-id="3228b-390">**Data type on the disk**</span></span>
--- | --- | --- | ---
<span data-ttu-id="3228b-391">DB-Disk0-OS</span><span class="sxs-lookup"><span data-stu-id="3228b-391">DB-Disk0-OS</span></span> | <span data-ttu-id="3228b-392">DISK0</span><span class="sxs-lookup"><span data-stu-id="3228b-392">DISK0</span></span>  |<span data-ttu-id="3228b-393">C:\\</span><span class="sxs-lookup"><span data-stu-id="3228b-393">C:\\</span></span> |<span data-ttu-id="3228b-394">Disco del sistema operativo</span><span class="sxs-lookup"><span data-stu-id="3228b-394">Operating system disk</span></span>
<span data-ttu-id="3228b-395">DB-Disk1</span><span class="sxs-lookup"><span data-stu-id="3228b-395">DB-Disk1</span></span> | <span data-ttu-id="3228b-396">Disk1</span><span class="sxs-lookup"><span data-stu-id="3228b-396">Disk1</span></span> | <span data-ttu-id="3228b-397">D:\\</span><span class="sxs-lookup"><span data-stu-id="3228b-397">D:\\</span></span> | <span data-ttu-id="3228b-398">Archiviazione temporanea</br /> </br />pagefile.sys</span><span class="sxs-lookup"><span data-stu-id="3228b-398">Temporary storage</br /> </br />pagefile.sys</span></span>
<span data-ttu-id="3228b-399">DB-Disk2</span><span class="sxs-lookup"><span data-stu-id="3228b-399">DB-Disk2</span></span> | <span data-ttu-id="3228b-400">Disk2</span><span class="sxs-lookup"><span data-stu-id="3228b-400">Disk2</span></span> | <span data-ttu-id="3228b-401">E:\\</span><span class="sxs-lookup"><span data-stu-id="3228b-401">E:\\</span></span> | <span data-ttu-id="3228b-402">Dati utente 1</span><span class="sxs-lookup"><span data-stu-id="3228b-402">User data 1</span></span>
<span data-ttu-id="3228b-403">DB-Disk3</span><span class="sxs-lookup"><span data-stu-id="3228b-403">DB-Disk3</span></span> | <span data-ttu-id="3228b-404">Disk3</span><span class="sxs-lookup"><span data-stu-id="3228b-404">Disk3</span></span> | <span data-ttu-id="3228b-405">F:\\</span><span class="sxs-lookup"><span data-stu-id="3228b-405">F:\\</span></span> | <span data-ttu-id="3228b-406">Dati utente 2</span><span class="sxs-lookup"><span data-stu-id="3228b-406">User data 2</span></span>

<span data-ttu-id="3228b-407">Poiché D: è la prima lettera di unità disponibile dall'elenco, Azure assegna D: al volume di archiviazione temporanea.</span><span class="sxs-lookup"><span data-stu-id="3228b-407">Because D: is the first drive letter from available the list, Azure assigns D: to the temporary storage volume.</span></span> <span data-ttu-id="3228b-408">Per tutti i dischi replicati, la lettera di unità rimane invariata.</span><span class="sxs-lookup"><span data-stu-id="3228b-408">For all the replicated disks, the drive letter remains the same.</span></span> <span data-ttu-id="3228b-409">Poiché il disco G: non è disponibile, il sistema userà l'unità C: per il file di paging.</span><span class="sxs-lookup"><span data-stu-id="3228b-409">Because the G: disk is not available, the system will use the C: drive for the paging file.</span></span>

<span data-ttu-id="3228b-410">Di seguito sono illustrate le impostazioni del file di paging nella macchina virtuale di Azure:</span><span class="sxs-lookup"><span data-stu-id="3228b-410">Here are the paging file settings on the Azure virtual machine:</span></span>

![Impostazioni del file di paging nella macchina virtuale di Azure](./media/site-recovery-exclude-disk/pagefile-on-Azure-vm-after-failover-2.png)

## <a name="next-steps"></a><span data-ttu-id="3228b-412">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="3228b-412">Next steps</span></span>
<span data-ttu-id="3228b-413">Dopo aver configurato correttamente la distribuzione, vedere [altre informazioni](site-recovery-failover.md) sui diversi tipi di failover.</span><span class="sxs-lookup"><span data-stu-id="3228b-413">After your deployment is set up and running, [learn more](site-recovery-failover.md) about different types of failover.</span></span>
