---
title: Configurazione dell'accesso condizionale locale con il servizio Registrazione dispositivo di Azure Active Directory | Microsoft Docs
description: Guida dettagliata all'abilitazione dell'accesso condizionale alle applicazioni locali usando Active Directory Federation Services (AD FS) in Windows Server 2012 R2.
services: active-directory
documentationcenter: 
author: MarkusVi
manager: femila
editor: 
ms.assetid: 6ae9df8b-31fe-4d72-9181-cf50cfebbf05
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/31/2017
ms.author: markvi
ms.reviewer: jairoc
ms.openlocfilehash: 1a6f1c6566468188daa71939db8345280b7a529f
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/03/2017
---
# <a name="setting-up-on-premises-conditional-access-by-using-azure-active-directory-device-registration"></a><span data-ttu-id="88a86-103">Configurazione dell'accesso condizionale locale usando il servizio Registrazione dispositivo di Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="88a86-103">Setting up on-premises conditional access by using Azure Active Directory device registration</span></span>
<span data-ttu-id="88a86-104">Quando si chiede agli utenti di aggiungere i dispositivi personali all'area di lavoro con il servizio Registrazione dispositivo di Azure Active Directory (Azure AD), i dispositivi possono essere contrassegnati come noti all'organizzazione.</span><span class="sxs-lookup"><span data-stu-id="88a86-104">When you require users to workplace-join their personal devices to the Azure Active Directory (Azure AD) device registration service, their devices can be marked as known to your organization.</span></span> <span data-ttu-id="88a86-105">Di seguito è riportata una guida dettagliata all'abilitazione dell'accesso condizionale alle applicazioni locali con Active Directory Federation Services (AD FS) in Windows Server 2012 R2.</span><span class="sxs-lookup"><span data-stu-id="88a86-105">Following is a step-by-step guide for enabling conditional access to on-premises applications by using Active Directory Federation Services (AD FS) in Windows Server 2012 R2.</span></span>

> [!NOTE]
> <span data-ttu-id="88a86-106">Quando si usano dispositivi registrati nei criteri di accesso condizionale del servizio Registrazione dispositivo di Azure Active Directory, è necessaria una licenza di Office 365 o una licenza di Azure AD Premium.</span><span class="sxs-lookup"><span data-stu-id="88a86-106">An Office 365 license or Azure AD Premium license is required when using devices that are registered in Azure Active Directory device registration service conditional access policies.</span></span> <span data-ttu-id="88a86-107">Sono inclusi i criteri applicati da AD FS nelle risorse locali.</span><span class="sxs-lookup"><span data-stu-id="88a86-107">These include policies that are enforced by AD FS in on-premises resources.</span></span>
> 
> <span data-ttu-id="88a86-108">Per altre informazioni sugli scenari di accesso condizionale per le risorse locali, vedere [Aggiunta all'area di lavoro da qualsiasi dispositivo per SSO e autenticazione a due fattori trasparente per tutte le applicazioni aziendali](https://technet.microsoft.com/library/dn280945.aspx).</span><span class="sxs-lookup"><span data-stu-id="88a86-108">For more information about the conditional access scenarios for on-premises resources, see [Join to workplace from any device for SSO and seamless second-factor authentication across company applications](https://technet.microsoft.com/library/dn280945.aspx).</span></span>

<span data-ttu-id="88a86-109">Queste funzionalità sono disponibili per i clienti che acquistano una licenza di Azure Active Directory Premium.</span><span class="sxs-lookup"><span data-stu-id="88a86-109">These capabilities are available to customers who purchase an Azure Active Directory Premium license.</span></span>

## <a name="supported-devices"></a><span data-ttu-id="88a86-110">Dispositivi supportati</span><span class="sxs-lookup"><span data-stu-id="88a86-110">Supported devices</span></span>
* <span data-ttu-id="88a86-111">Dispositivi Windows 7 aggiunti a un dominio</span><span class="sxs-lookup"><span data-stu-id="88a86-111">Windows 7 domain-joined devices</span></span>
* <span data-ttu-id="88a86-112">Dispositivi Windows 8.1 personali e aggiunti a un dominio</span><span class="sxs-lookup"><span data-stu-id="88a86-112">Windows 8.1 personal and domain-joined devices</span></span>
* <span data-ttu-id="88a86-113">iOS 6 e versioni successive per il browser Safari</span><span class="sxs-lookup"><span data-stu-id="88a86-113">iOS 6 and later for the Safari browser</span></span>
* <span data-ttu-id="88a86-114">Android 4.0 o versioni successive, telefoni Samsung GS3 o successivi, tablet Samsung Galaxy Note 2 o successivi</span><span class="sxs-lookup"><span data-stu-id="88a86-114">Android 4.0 or later, Samsung GS3 or later phones, Samsung Galaxy Note 2 or later tablets</span></span>

## <a name="scenario-prerequisites"></a><span data-ttu-id="88a86-115">Prerequisiti dello scenario</span><span class="sxs-lookup"><span data-stu-id="88a86-115">Scenario prerequisites</span></span>
* <span data-ttu-id="88a86-116">Sottoscrizione di Office 365 o Azure Active Directory Premium</span><span class="sxs-lookup"><span data-stu-id="88a86-116">Subscription to Office 365 or Azure Active Directory Premium</span></span>
* <span data-ttu-id="88a86-117">Tenant di Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="88a86-117">An Azure Active Directory tenant</span></span>
* <span data-ttu-id="88a86-118">Windows Server Active Directory (Windows Server 2008 o versioni successive)</span><span class="sxs-lookup"><span data-stu-id="88a86-118">Windows Server Active Directory (Windows Server 2008 or later)</span></span>
* <span data-ttu-id="88a86-119">Schema aggiornato in Windows Server 2012 R2</span><span class="sxs-lookup"><span data-stu-id="88a86-119">Updated schema in Windows Server 2012 R2</span></span>
* <span data-ttu-id="88a86-120">Licenza di Azure Active Directory Premium</span><span class="sxs-lookup"><span data-stu-id="88a86-120">License for Azure Active Directory Premium</span></span>
* <span data-ttu-id="88a86-121">Windows Server 2012 R2 Federation Services configurato per l'accesso SSO ad Azure AD</span><span class="sxs-lookup"><span data-stu-id="88a86-121">Windows Server 2012 R2 Federation Services, configured for SSO to Azure AD</span></span>
* <span data-ttu-id="88a86-122">Proxy applicazione Web di Windows Server 2012 R2</span><span class="sxs-lookup"><span data-stu-id="88a86-122">Windows Server 2012 R2 Web Application Proxy</span></span> 
* <span data-ttu-id="88a86-123">Microsoft Azure Active Directory Connect (Azure AD Connect) [(Download di Azure AD Connect)](http://www.microsoft.com/en-us/download/details.aspx?id=47594)</span><span class="sxs-lookup"><span data-stu-id="88a86-123">Microsoft Azure Active Directory Connect (Azure AD Connect) [(Download Azure AD Connect)](http://www.microsoft.com/en-us/download/details.aspx?id=47594)</span></span>
* <span data-ttu-id="88a86-124">Dominio verificato</span><span class="sxs-lookup"><span data-stu-id="88a86-124">Verified domain</span></span>

## <a name="known-issues-in-this-release"></a><span data-ttu-id="88a86-125">Problemi noti in questa versione</span><span class="sxs-lookup"><span data-stu-id="88a86-125">Known issues in this release</span></span>
* <span data-ttu-id="88a86-126">I criteri di accesso condizionale basati su dispositivo richiedono la funzionalità di writeback degli oggetti dispositivo in Active Directory da Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="88a86-126">Device-based conditional access policies require device object writeback to Active Directory from Azure Active Directory.</span></span> <span data-ttu-id="88a86-127">L'esecuzione del writeback degli oggetti dispositivo in Active Directory può richiedere fino a tre ore.</span><span class="sxs-lookup"><span data-stu-id="88a86-127">It can take up to three hours for device objects to be written back to Active Directory.</span></span>
* <span data-ttu-id="88a86-128">I dispositivi iOS 7 richiedono sempre di selezionare un certificato durante l'autenticazione dei certificati client.</span><span class="sxs-lookup"><span data-stu-id="88a86-128">iOS 7 devices  always prompt the user to select a certificate during client certificate authentication.</span></span>
* <span data-ttu-id="88a86-129">Alcune versioni di iOS 8 precedenti a iOS 8.3 non funzionano.</span><span class="sxs-lookup"><span data-stu-id="88a86-129">Some versions of iOS 8 before iOS 8.3 do not work.</span></span>

## <a name="scenario-assumptions"></a><span data-ttu-id="88a86-130">Presupposti dello scenario</span><span class="sxs-lookup"><span data-stu-id="88a86-130">Scenario assumptions</span></span>
<span data-ttu-id="88a86-131">Questo scenario presuppone l'esistenza di un ambiente ibrido, costituito da un tenant di Azure AD e un'istanza di Active Directory locale.</span><span class="sxs-lookup"><span data-stu-id="88a86-131">This scenario assumes that you have a hybrid environment consisting of an Azure AD tenant and an on-premises Active Directory.</span></span> <span data-ttu-id="88a86-132">Questi tenant devono essere connessi con Azure AD Connect, con un dominio verificato e con AD FS per SSO.</span><span class="sxs-lookup"><span data-stu-id="88a86-132">These tenants should be connected with Azure AD Connect, with a verified domain, and with AD FS for SSO.</span></span> <span data-ttu-id="88a86-133">Usare il seguente elenco di controllo per configurare l'ambiente in base ai requisiti.</span><span class="sxs-lookup"><span data-stu-id="88a86-133">Use the following checklist to help you configure your environment according to the requirements.</span></span>

## <a name="checklist-prerequisites-for-conditional-access-scenario"></a><span data-ttu-id="88a86-134">Elenco di controllo: prerequisiti per lo scenario di accesso condizionale</span><span class="sxs-lookup"><span data-stu-id="88a86-134">Checklist: Prerequisites for conditional access scenario</span></span>
<span data-ttu-id="88a86-135">Connettere il tenant di Azure AD all'istanza di Active Directory locale.</span><span class="sxs-lookup"><span data-stu-id="88a86-135">Connect your Azure AD tenant with your on-premises Active Directory instance.</span></span>

## <a name="configure-azure-active-directory-device-registration-service"></a><span data-ttu-id="88a86-136">Configurare il servizio Registrazione dispositivo di Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="88a86-136">Configure Azure Active Directory device registration service</span></span>
<span data-ttu-id="88a86-137">Usare questa guida per distribuire e configurare il servizio Registrazione dispositivo di Azure Active Directory per l'organizzazione.</span><span class="sxs-lookup"><span data-stu-id="88a86-137">Use this guide to deploy and configure the Azure Active Directory device registration service for your organization.</span></span>

<span data-ttu-id="88a86-138">Nella guida si presuppone che Windows Server Active Directory sia stato configurato e che sia stata effettuata la sottoscrizione a Microsoft Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="88a86-138">This guide assumes that you've configured Windows Server Active Directory and have subscribed to Microsoft Azure Active Directory.</span></span> <span data-ttu-id="88a86-139">Vedere i prerequisiti descritti in precedenza.</span><span class="sxs-lookup"><span data-stu-id="88a86-139">See the prerequisites described earlier.</span></span>

<span data-ttu-id="88a86-140">Per distribuire il servizio Registrazione dispositivo di Azure Active Directory con il tenant di Azure Active Directory, completare nell'ordine indicato le attività riportate nell'elenco di controllo seguente.</span><span class="sxs-lookup"><span data-stu-id="88a86-140">To deploy the Azure Active Directory device registration service with your Azure Active Directory tenant, complete the tasks in the following checklist in order.</span></span> <span data-ttu-id="88a86-141">Quando un collegamento a un riferimento porta a un argomento concettuale, tornare a questo elenco di controllo per poter procedere con le attività restanti.</span><span class="sxs-lookup"><span data-stu-id="88a86-141">When a reference link takes you to a conceptual topic, return to this checklist afterward, so that you can proceed with the remaining tasks.</span></span> <span data-ttu-id="88a86-142">Alcune attività includono un passaggio di convalida dello scenario, che consente di verificare se il passaggio è stato eseguito correttamente.</span><span class="sxs-lookup"><span data-stu-id="88a86-142">Some tasks include a scenario validation step that can help you confirm whether the step was completed successfully.</span></span>

## <a name="part-1-enable-azure-active-directory-device-registration"></a><span data-ttu-id="88a86-143">Parte 1: Abilitare Registrazione dispositivo di Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="88a86-143">Part 1: Enable Azure Active Directory device registration</span></span>
<span data-ttu-id="88a86-144">Seguire i passaggi dell'elenco di controllo per abilitare e configurare il servizio Registrazione dispositivo di Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="88a86-144">Follow the steps in the checklist to enable and configure the Azure Active Directory device registration service.</span></span>

| <span data-ttu-id="88a86-145">Attività</span><span class="sxs-lookup"><span data-stu-id="88a86-145">Task</span></span> | <span data-ttu-id="88a86-146">Riferimento</span><span class="sxs-lookup"><span data-stu-id="88a86-146">Reference</span></span> | 
| --- | --- |
| <span data-ttu-id="88a86-147">Abilitare Registrazione dispositivo nel tenant di Azure Active Directory per consentire l'aggiunta dei dispositivi all'area di lavoro.</span><span class="sxs-lookup"><span data-stu-id="88a86-147">Enable device registration in your Azure Active Directory tenant to allow devices to join the workplace.</span></span> <span data-ttu-id="88a86-148">Per impostazione predefinita, la funzionalità Azure Multi-Factor Authentication non è abilitata per il servizio.</span><span class="sxs-lookup"><span data-stu-id="88a86-148">By default, Azure Multi-Factor Authentication is not enabled for the service.</span></span> <span data-ttu-id="88a86-149">Tuttavia, è consigliabile usare l'autenticazione a più fattori quando si registra un dispositivo.</span><span class="sxs-lookup"><span data-stu-id="88a86-149">However, we recommend that you use Multi-Factor Authentication when you register a device.</span></span> <span data-ttu-id="88a86-150">Prima di abilitare Multi-Factor Authentication nel servizio Registrazione dispositivo di Active Directory, verificare che AD FS sia configurato per un provider di autenticazione a più fattori.</span><span class="sxs-lookup"><span data-stu-id="88a86-150">Before enabling Multi-Factor Authentication in Active Directory registration service, ensure that AD FS is configured for a Multi-Factor Authentication  provider.</span></span> |[<span data-ttu-id="88a86-151">Abilitare Registrazione dispositivo di Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="88a86-151">Enable Azure Active Directory device registration</span></span>](active-directory-device-registration-get-started.md)| 
|<span data-ttu-id="88a86-152">I dispositivi individuano il servizio Registrazione dispositivo di Azure Active Directory cercando record DNS noti.</span><span class="sxs-lookup"><span data-stu-id="88a86-152">Devices discover your Azure Active Directory device registration service by looking for well-known DNS records.</span></span> <span data-ttu-id="88a86-153">Configurare il DNS della società in modo che i dispositivi possano rilevare il servizio Registrazione dispositivo di Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="88a86-153">Configure your company DNS so that devices can discover your Azure Active Directory device registration service.</span></span> |[<span data-ttu-id="88a86-154">Configurare l'individuazione di Registrazione dispositivo di Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="88a86-154">Configure Azure Active Directory device registration discovery</span></span>](active-directory-device-registration-get-started.md)| 


## <a name="part-2-deploy-and-configure-windows-server-2012-r2-active-directory-federation-services-and-set-up-a-federation-relationship-with-azure-ad"></a><span data-ttu-id="88a86-155">Parte 2: Distribuire e configurare Active Directory Federation Services con Windows Server 2012 R2 e configurare una relazione federativa con Azure AD</span><span class="sxs-lookup"><span data-stu-id="88a86-155">Part 2: Deploy and configure Windows Server 2012 R2 Active Directory Federation Services and set up a federation relationship with Azure AD</span></span>

| <span data-ttu-id="88a86-156">Attività</span><span class="sxs-lookup"><span data-stu-id="88a86-156">Task</span></span> | <span data-ttu-id="88a86-157">Riferimento</span><span class="sxs-lookup"><span data-stu-id="88a86-157">Reference</span></span> |
| --- | --- |
| <span data-ttu-id="88a86-158">Distribuire Active Directory Domain Services con le estensioni dello schema di Windows Server 2012 R2.</span><span class="sxs-lookup"><span data-stu-id="88a86-158">Deploy Active Directory Domain Services with the Windows Server 2012 R2 schema extensions.</span></span> <span data-ttu-id="88a86-159">Non è necessario aggiornare alcun controller di dominio a Windows Server 2012 R2.</span><span class="sxs-lookup"><span data-stu-id="88a86-159">You do not need to upgrade any of your domain controllers to Windows Server 2012 R2.</span></span> <span data-ttu-id="88a86-160">L'unico requisito è l'aggiornamento dello schema.</span><span class="sxs-lookup"><span data-stu-id="88a86-160">The schema upgrade is the only requirement.</span></span> |[<span data-ttu-id="88a86-161">Aggiornare lo schema di Active Directory Domain Services</span><span class="sxs-lookup"><span data-stu-id="88a86-161">Upgrade your Active Directory Domain Services schema</span></span>](#upgrade-your-active-directory-domain-services-schema) |
| <span data-ttu-id="88a86-162">I dispositivi individuano il servizio Registrazione dispositivo di Azure Active Directory cercando record DNS noti.</span><span class="sxs-lookup"><span data-stu-id="88a86-162">Devices discover your Azure Active Directory device registration service by looking for well-known DNS records.</span></span> <span data-ttu-id="88a86-163">Configurare il DNS della società in modo che i dispositivi possano rilevare il servizio Registrazione dispositivo di Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="88a86-163">Configure your company DNS so that devices can discover your Azure Active Directory device registration service.</span></span> |[<span data-ttu-id="88a86-164">Preparare Active Directory per supportare i dispositivi</span><span class="sxs-lookup"><span data-stu-id="88a86-164">Prepare your Active Directory support devices</span></span>](#prepare-your-active-directory-to-support-devices) |

## <a name="part-3-enable-device-writeback-in-azure-ad"></a><span data-ttu-id="88a86-165">Parte 3: Abilitare il writeback dei dispositivi in Azure AD</span><span class="sxs-lookup"><span data-stu-id="88a86-165">Part 3: Enable device writeback in Azure AD</span></span>
| <span data-ttu-id="88a86-166">Attività</span><span class="sxs-lookup"><span data-stu-id="88a86-166">Task</span></span> | <span data-ttu-id="88a86-167">Riferimento</span><span class="sxs-lookup"><span data-stu-id="88a86-167">Reference</span></span> |
| --- | --- |
| <span data-ttu-id="88a86-168">Completare la parte due di "Abilitazione del writeback dei dispositivi in Azure AD Connect".</span><span class="sxs-lookup"><span data-stu-id="88a86-168">Complete part two of "Enabling device writeback in Azure AD Connect."</span></span> <span data-ttu-id="88a86-169">Al termine, tornare a questa guida.</span><span class="sxs-lookup"><span data-stu-id="88a86-169">After you finish it, return to this guide.</span></span> |[<span data-ttu-id="88a86-170">Abilitazione del writeback dei dispositivi in Azure AD Connect</span><span class="sxs-lookup"><span data-stu-id="88a86-170">Enabling device writeback in Azure AD Connect</span></span>](#upgrade-your-active-directory-domain-services-schema) |

## <a name="optional-part-4-enable-multi-factor-authentication"></a><span data-ttu-id="88a86-171">[Facoltativo] Parte 4: Abilitazione di Multi-Factor Authentication</span><span class="sxs-lookup"><span data-stu-id="88a86-171">[Optional] Part 4: Enable Multi-Factor Authentication</span></span>
<span data-ttu-id="88a86-172">È consigliabile configurare una delle diverse opzioni per Multi-Factor Authentication.</span><span class="sxs-lookup"><span data-stu-id="88a86-172">We strongly recommended that you configure one of the several options for Multi-Factor Authentication.</span></span> <span data-ttu-id="88a86-173">Se si vuole rendere obbligatoria l'autenticazione a più fattori, vedere [Scegliere la soluzione Azure Multi-Factor Authentication più adatta alle proprie esigenze](../multi-factor-authentication/multi-factor-authentication-get-started.md).</span><span class="sxs-lookup"><span data-stu-id="88a86-173">If you want to require Multi-Factor Authentication, see [Choose the Multi-Factor Authentication security solution for you](../multi-factor-authentication/multi-factor-authentication-get-started.md).</span></span> <span data-ttu-id="88a86-174">È inclusa una descrizione di ogni soluzione con collegamenti che consentono di configurare la soluzione selezionata.</span><span class="sxs-lookup"><span data-stu-id="88a86-174">It includes a description of each solution, and links to help you configure the solution of your choice.</span></span>

## <a name="part-5-verification"></a><span data-ttu-id="88a86-175">Parte 5: Verifica</span><span class="sxs-lookup"><span data-stu-id="88a86-175">Part 5: Verification</span></span>
<span data-ttu-id="88a86-176">La distribuzione è stata completata e ora è possibile provare alcuni scenari.</span><span class="sxs-lookup"><span data-stu-id="88a86-176">The deployment is now complete, and you can try out some scenarios.</span></span> <span data-ttu-id="88a86-177">Usare i collegamenti riportati di seguito per provare il servizio e acquisire familiarità con le relative funzionalità.</span><span class="sxs-lookup"><span data-stu-id="88a86-177">Use the following links to experiment with the service and become familiar with its features.</span></span>

| <span data-ttu-id="88a86-178">Attività</span><span class="sxs-lookup"><span data-stu-id="88a86-178">Task</span></span> | <span data-ttu-id="88a86-179">Riferimento</span><span class="sxs-lookup"><span data-stu-id="88a86-179">Reference</span></span> |
| --- | --- |
| <span data-ttu-id="88a86-180">Aggiungere alcuni dispositivi all'area di lavoro usando il servizio Registrazione dispositivo di Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="88a86-180">Join some devices to your workplace by using Azure Active Directory device registration service.</span></span> <span data-ttu-id="88a86-181">È possibile aggiungere dispositivi iOS, Windows e Android.</span><span class="sxs-lookup"><span data-stu-id="88a86-181">You can join iOS, Windows, and Android devices.</span></span> |[<span data-ttu-id="88a86-182">Aggiungere dispositivi all'area di lavoro con il servizio Registrazione dispositivo di Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="88a86-182">Join devices to your workplace using Azure Active Directory device registration service</span></span>](#join-devices-to-your-workplace-using-azure-active-directory-device-registration) |
| <span data-ttu-id="88a86-183">È possibile visualizzare e abilitare o disabilitare i dispositivi registrati usando il portale dell'amministratore.</span><span class="sxs-lookup"><span data-stu-id="88a86-183">View and enable or disable registered devices by using the administrator portal.</span></span> <span data-ttu-id="88a86-184">In questa attività si visualizzano alcuni dispositivi registrati usando il portale dell'amministratore.</span><span class="sxs-lookup"><span data-stu-id="88a86-184">In this task, you view some registered devices by using the administrator portal.</span></span> |[<span data-ttu-id="88a86-185">Panoramica del servizio Registrazione dispositivo di Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="88a86-185">Azure Active Directory device registration service overview</span></span>](active-directory-device-registration-get-started.md) |
| <span data-ttu-id="88a86-186">Verificare che venga eseguito il writeback degli oggetti dispositivo da Azure Active Directory a Windows Server Active Directory.</span><span class="sxs-lookup"><span data-stu-id="88a86-186">Verify that device objects are written back from Azure Active Directory to Windows Server Active Directory.</span></span> |[<span data-ttu-id="88a86-187">Verificare che venga eseguito il writeback dei dispositivi registrati in Active Directory</span><span class="sxs-lookup"><span data-stu-id="88a86-187">Verify registered devices are written back to Active Directory</span></span>](#verify-registered-devices-are-written-back-to-active-directory) |
| <span data-ttu-id="88a86-188">Ora che gli utenti possono registrare i propri dispositivi, è possibile creare criteri di accesso alle applicazioni in AD FS che consentano l'accesso solo a dispositivi registrati.</span><span class="sxs-lookup"><span data-stu-id="88a86-188">Now that users can register their devices, you can create application access polices in AD FS that allow only registered devices.</span></span> <span data-ttu-id="88a86-189">In questa attività viene creata una regola di accesso alle applicazioni e un messaggio di accesso negato personalizzato.</span><span class="sxs-lookup"><span data-stu-id="88a86-189">In this task, you create an application access rule and a custom access-denied message.</span></span> |[<span data-ttu-id="88a86-190">Creare un criterio di accesso alle applicazioni e un messaggio di accesso negato personalizzato</span><span class="sxs-lookup"><span data-stu-id="88a86-190">Create an application access policy and custom access-denied message</span></span>](#create-an-application-access-policy-and-custom-access-denied-message) |

## <a name="integrate-azure-active-directory-with-on-premises-active-directory"></a><span data-ttu-id="88a86-191">Integrare Azure Active Directory con l'istanza di Active Directory locale</span><span class="sxs-lookup"><span data-stu-id="88a86-191">Integrate Azure Active Directory with on-premises Active Directory</span></span>
<span data-ttu-id="88a86-192">Questo passaggio consente di integrare il tenant di Azure AD con l'istanza di Active Directory locale usando Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="88a86-192">This step helps you integrate your Azure AD tenant with your on-premises Active Directory by using Azure AD Connect.</span></span> <span data-ttu-id="88a86-193">Anche se i passaggi sono disponibili nel portale di Azure classico, prendere nota di eventuali istruzioni speciali riportate in questa sezione.</span><span class="sxs-lookup"><span data-stu-id="88a86-193">Although the steps are available in the Azure classic portal, make note of any special instructions that are listed in this section.</span></span>

1. <span data-ttu-id="88a86-194">Accedere al portale di Azure classico usando un account che sia amministratore globale in Azure AD.</span><span class="sxs-lookup"><span data-stu-id="88a86-194">Sign in to the Azure classic portal by using an account that is a global administrator in Azure AD.</span></span>
2. <span data-ttu-id="88a86-195">Nel riquadro sinistro selezionare **Active Directory**.</span><span class="sxs-lookup"><span data-stu-id="88a86-195">On the left pane, select **Active Directory**.</span></span>
3. <span data-ttu-id="88a86-196">Selezionare la propria directory nella scheda **Directory** .</span><span class="sxs-lookup"><span data-stu-id="88a86-196">On the **Directory** tab, select your directory.</span></span>
4. <span data-ttu-id="88a86-197">Selezionare la scheda **Integrazione directory** .</span><span class="sxs-lookup"><span data-stu-id="88a86-197">Select the **Directory Integration** tab.</span></span>
5. <span data-ttu-id="88a86-198">Nella sezione **distribuisci e gestisci** eseguire i passaggi da 1 a 3 per integrare Azure Active Directory con la directory locale.</span><span class="sxs-lookup"><span data-stu-id="88a86-198">Under the **deploy and manage** section, follow steps 1 through 3 to integrate Azure Active Directory with your on-premises directory.</span></span>
   
   1. <span data-ttu-id="88a86-199">Aggiungere i domini.</span><span class="sxs-lookup"><span data-stu-id="88a86-199">Add domains.</span></span>
   2. <span data-ttu-id="88a86-200">Installare ed eseguire Azure AD Connect seguendo le istruzioni riportate in [Installazione personalizzata di Azure AD Connect](connect/active-directory-aadconnect-get-started-custom.md).</span><span class="sxs-lookup"><span data-stu-id="88a86-200">Install and run Azure AD Connect by using the instructions at [Custom installation of Azure AD Connect](connect/active-directory-aadconnect-get-started-custom.md).</span></span>
   3. <span data-ttu-id="88a86-201">Verificare e gestire la sincronizzazione della directory.</span><span class="sxs-lookup"><span data-stu-id="88a86-201">Verify and manage directory sync.</span></span> <span data-ttu-id="88a86-202">Le istruzioni per l'accesso Single Sign-On sono disponibili in questo passaggio.</span><span class="sxs-lookup"><span data-stu-id="88a86-202">Single sign-on instructions are available within this step.</span></span>
   
   <span data-ttu-id="88a86-203">Configurare anche la federazione con AD FS come indicato in [Installazione personalizzata di Azure AD Connect](connect/active-directory-aadconnect-get-started-custom.md).</span><span class="sxs-lookup"><span data-stu-id="88a86-203">In addition, configure federation with AD FS as outlined in [Custom installation of Azure AD Connect](connect/active-directory-aadconnect-get-started-custom.md).</span></span>

## <a name="upgrade-your-active-directory-domain-services-schema"></a><span data-ttu-id="88a86-204">Aggiornare lo schema di Servizi di dominio Active Directory</span><span class="sxs-lookup"><span data-stu-id="88a86-204">Upgrade your Active Directory Domain Services schema</span></span>
> [!NOTE]
> <span data-ttu-id="88a86-205">Dopo aver aggiornato lo schema di Active Directory, il processo non può essere annullato.</span><span class="sxs-lookup"><span data-stu-id="88a86-205">After you upgrade your Active Directory schema, the process cannot be reversed.</span></span> <span data-ttu-id="88a86-206">È quindi consigliabile eseguire prima l'aggiornamento in un ambiente di test.</span><span class="sxs-lookup"><span data-stu-id="88a86-206">We recommend that you first perform the upgrade in a test environment.</span></span>
> 

1. <span data-ttu-id="88a86-207">Accedere al controller di dominio usando un account con diritti sia di amministratore dell'organizzazione sia di amministratore dello schema.</span><span class="sxs-lookup"><span data-stu-id="88a86-207">Sign in to your domain controller with an account that has both enterprise administrator and schema administrator rights.</span></span>
2. <span data-ttu-id="88a86-208">Copiare la directory e le sottodirectory **[media]\support\adprep** in uno dei controller di dominio di Active Directory (dove **[media]** è il percorso al supporto di installazione di Windows Server 2012 R2).</span><span class="sxs-lookup"><span data-stu-id="88a86-208">Copy the **[media]\support\adprep** directory and subdirectories to one of your Active Directory domain controllers (where **[media]** is the path to the Windows Server 2012 R2 installation media).</span></span>
4. <span data-ttu-id="88a86-209">A un prompt dei comandi passare alla directory **adprep** ed eseguire **adprep.exe /forestprep**.</span><span class="sxs-lookup"><span data-stu-id="88a86-209">From a command prompt, go to the **adprep** directory and run **adprep.exe /forestprep**.</span></span> <span data-ttu-id="88a86-210">Seguire le istruzioni visualizzate per completare l'aggiornamento dello schema.</span><span class="sxs-lookup"><span data-stu-id="88a86-210">Follow the onscreen instructions to complete the schema upgrade.</span></span>

## <a name="prepare-your-active-directory-to-support-devices"></a><span data-ttu-id="88a86-211">Preparare Active Directory per supportare i dispositivi</span><span class="sxs-lookup"><span data-stu-id="88a86-211">Prepare your Active Directory to support devices</span></span>
> [!NOTE]
> <span data-ttu-id="88a86-212">Questa è un'operazione da eseguire una sola volta per preparare la foresta Active Directory per supportare i dispositivi.</span><span class="sxs-lookup"><span data-stu-id="88a86-212">This is a one-time operation that you must run to prepare your Active Directory forest to support devices.</span></span> <span data-ttu-id="88a86-213">Per completare questa procedura è necessario accedere con autorizzazioni di amministratore dell'organizzazione e la foresta Active Directory deve avere lo schema di Windows Server 2012 R2.</span><span class="sxs-lookup"><span data-stu-id="88a86-213">To complete this procedure, you must be signed in with enterprise administrator permissions and your Active Directory forest must have the Windows Server 2012 R2 schema.</span></span>
> 


### <a name="prepare-your-active-directory-forest"></a><span data-ttu-id="88a86-214">Preparare la foresta Active Directory</span><span class="sxs-lookup"><span data-stu-id="88a86-214">Prepare your Active Directory forest</span></span>
1. <span data-ttu-id="88a86-215">Nel server federativo aprire una finestra di comando di Windows PowerShell e digitare **Initialize-ADDeviceRegistration**.</span><span class="sxs-lookup"><span data-stu-id="88a86-215">On your federation server, open a Windows PowerShell command window, and then type **Initialize-ADDeviceRegistration**.</span></span> 
2. <span data-ttu-id="88a86-216">Quando viene richiesto di specificare **ServiceAccountName**, immettere il nome dell'account del servizio selezionato come account del servizio per AD FS.</span><span class="sxs-lookup"><span data-stu-id="88a86-216">When prompted for **ServiceAccountName**, enter the name of the service account you selected as the service account for AD FS.</span></span> <span data-ttu-id="88a86-217">Se si tratta di un account del servizio gestito del gruppo, immetterlo nel formato **dominio\nomeaccount$**.</span><span class="sxs-lookup"><span data-stu-id="88a86-217">If it's a gMSA account, enter the account in the **domain\accountname$** format.</span></span> <span data-ttu-id="88a86-218">Per un account di dominio, usare il formato **dominio\nomeaccount**.</span><span class="sxs-lookup"><span data-stu-id="88a86-218">For a domain account, use the format **domain\accountname**.</span></span>

### <a name="enable-device-authentication-in-ad-fs"></a><span data-ttu-id="88a86-219">Abilitare l'autenticazione dispositivo in AD FS</span><span class="sxs-lookup"><span data-stu-id="88a86-219">Enable device authentication in AD FS</span></span>
1. <span data-ttu-id="88a86-220">Nel server federativo aprire la console di gestione di AD FS e passare ad **AD FS** > **Criteri di autenticazione**.</span><span class="sxs-lookup"><span data-stu-id="88a86-220">On your federation server, open the AD FS management console and go to **AD FS** > **Authentication Policies**.</span></span>
2. <span data-ttu-id="88a86-221">Selezionare **Modifica autenticazione primaria globale** nel riquadro **Azioni**.</span><span class="sxs-lookup"><span data-stu-id="88a86-221">On the **Actions** pane, select **Edit Global Primary Authentication**.</span></span>
3. <span data-ttu-id="88a86-222">Selezionare **Abilita autenticazione dispositivo** e quindi **OK**.</span><span class="sxs-lookup"><span data-stu-id="88a86-222">Check **Enable device authentication**, and then select **OK**.</span></span>
4. <span data-ttu-id="88a86-223">Per impostazione predefinita, AD FS rimuove periodicamente da Active Directory i dispositivi inutilizzati.</span><span class="sxs-lookup"><span data-stu-id="88a86-223">By default, AD FS periodically removes unused devices from Active Directory.</span></span> <span data-ttu-id="88a86-224">Disabilitare questa attività quando si usa il servizio Registrazione dispositivo di Azure Active Directory, in modo che i dispositivi possano essere gestiti in Azure.</span><span class="sxs-lookup"><span data-stu-id="88a86-224">Disable this task when you're using Azure Active Directory device registration service so that devices can be managed in Azure.</span></span>

### <a name="disable-unused-device-cleanup"></a><span data-ttu-id="88a86-225">Disabilitare la pulizia dei dispositivi inutilizzati</span><span class="sxs-lookup"><span data-stu-id="88a86-225">Disable unused device cleanup</span></span>
<span data-ttu-id="88a86-226">Nel server federativo aprire una finestra di comando di Windows PowerShell e digitare **Set-AdfsDeviceRegistration -MaximumInactiveDays 0**.</span><span class="sxs-lookup"><span data-stu-id="88a86-226">On your federation server, open a Windows PowerShell command window, and then type **Set-AdfsDeviceRegistration -MaximumInactiveDays 0**.</span></span>

### <a name="prepare-azure-ad-connect-for-device-writeback"></a><span data-ttu-id="88a86-227">Preparare Azure AD Connect per il writeback dei dispositivi</span><span class="sxs-lookup"><span data-stu-id="88a86-227">Prepare Azure AD Connect for device writeback</span></span>
<span data-ttu-id="88a86-228">Completare la parte 1: preparare Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="88a86-228">Complete part 1: Prepare Azure AD Connect.</span></span>

## <a name="join-devices-to-your-workplace-by-using-azure-active-directory-device-registration-service"></a><span data-ttu-id="88a86-229">Aggiungere dispositivi all'area di lavoro con il servizio Registrazione dispositivo di Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="88a86-229">Join devices to your workplace by using Azure Active Directory device registration service</span></span>

### <a name="join-an-ios-device-by-using-azure-active-directory-device-registration"></a><span data-ttu-id="88a86-230">Aggiungere un dispositivo iOS con Registrazione dispositivo di Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="88a86-230">Join an iOS device by using Azure Active Directory device registration</span></span>
<span data-ttu-id="88a86-231">Il servizio Registrazione dispositivo di Azure Active Directory usa il processo di registrazione del profilo OTA (Over-the-Air) per i dispositivi iOS.</span><span class="sxs-lookup"><span data-stu-id="88a86-231">Azure Active Directory device registration uses the Over-the-Air Profile enrollment process for iOS devices.</span></span> <span data-ttu-id="88a86-232">Questo processo inizia quando l'utente si connette per l'URL di registrazione del profilo con Safari.</span><span class="sxs-lookup"><span data-stu-id="88a86-232">This process begins when the user connects to the profile enrollment URL with Safari.</span></span> <span data-ttu-id="88a86-233">Il formato dell'URL è il seguente:</span><span class="sxs-lookup"><span data-stu-id="88a86-233">The URL format is as follows:</span></span>

    https://enterpriseregistration.windows.net/enrollmentserver/otaprofile/"yourdomainname"

<span data-ttu-id="88a86-234">In questo caso `yourdomainname` è il nome di dominio configurato con Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="88a86-234">In this case, `yourdomainname` is the domain name that you configured with Azure Active Directory.</span></span> <span data-ttu-id="88a86-235">Ad esempio, se il nome di dominio è contoso.com, l'URL è:</span><span class="sxs-lookup"><span data-stu-id="88a86-235">For example, if your domain name is contoso.com, the URL is as follows:</span></span>

    https://enterpriseregistration.windows.net/enrollmentserver/otaprofile/contoso.com

<span data-ttu-id="88a86-236">È possibile comunicare questo URL agli utenti in diversi modi.</span><span class="sxs-lookup"><span data-stu-id="88a86-236">There are many different ways to communicate this URL to your users.</span></span> <span data-ttu-id="88a86-237">Un metodo consigliato, ad esempio, consiste nel pubblicare l'URL in un messaggio personalizzato di accesso all'applicazione negato in AD FS.</span><span class="sxs-lookup"><span data-stu-id="88a86-237">For example, one method we recommend is publishing this URL in a custom application access-denied message in AD FS.</span></span> <span data-ttu-id="88a86-238">Queste informazioni sono descritte nella sezione seguente: [Creare un criterio di accesso alle applicazioni e un messaggio di accesso negato personalizzato](#create-an-application-access-policy-and-custom-access-denied-message).</span><span class="sxs-lookup"><span data-stu-id="88a86-238">This information is covered in the upcoming section [Create an application access policy and custom access-denied message](#create-an-application-access-policy-and-custom-access-denied-message).</span></span>

### <a name="join-a-windows-81-device-by-using-azure-active-directory-device-registration"></a><span data-ttu-id="88a86-239">Aggiungere un dispositivo Windows 8.1 con Registrazione dispositivo di Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="88a86-239">Join a Windows 8.1 device by using Azure Active Directory device registration</span></span>
1. <span data-ttu-id="88a86-240">Nel dispositivo Windows 8.1 selezionare **Impostazioni PC** > **Rete** > **Area di lavoro**.</span><span class="sxs-lookup"><span data-stu-id="88a86-240">On your Windows 8.1 device, select **PC Settings** > **Network** > **Workplace**.</span></span>
2. <span data-ttu-id="88a86-241">Immettere il proprio nome utente in formato UPN, ad esempio **dan@contoso.com**.</span><span class="sxs-lookup"><span data-stu-id="88a86-241">Enter your user name in UPN format; for example, **dan@contoso.com**.</span></span>
3. <span data-ttu-id="88a86-242">Selezionare **Aggiungi**.</span><span class="sxs-lookup"><span data-stu-id="88a86-242">Select **Join**.</span></span>
4. <span data-ttu-id="88a86-243">Quando richiesto, accedere con le proprie credenziali.</span><span class="sxs-lookup"><span data-stu-id="88a86-243">When prompted, sign in with your credentials.</span></span> <span data-ttu-id="88a86-244">Il dispositivo ora è aggiunto.</span><span class="sxs-lookup"><span data-stu-id="88a86-244">The device is now joined.</span></span>

### <a name="join-a-windows-7-device-by-using-azure-active-directory-device-registration"></a><span data-ttu-id="88a86-245">Aggiungere un dispositivo Windows 7 con Registrazione dispositivo di Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="88a86-245">Join a Windows 7 device by using Azure Active Directory device registration</span></span>
<span data-ttu-id="88a86-246">Per registrare dispositivi Windows 7 aggiunti a un dominio, è necessario distribuire il pacchetto software di registrazione dispositivo.</span><span class="sxs-lookup"><span data-stu-id="88a86-246">To register Windows 7 domain-joined devices, you need to deploy the device registration software package.</span></span> <span data-ttu-id="88a86-247">Il pacchetto software è denominato "Workplace Join for Windows 7" ed è disponibile per il download dal [sito Web Microsoft Connect](https://connect.microsoft.com/site1164).</span><span class="sxs-lookup"><span data-stu-id="88a86-247">The software package is called Workplace Join for Windows 7, and it's available for download at the [Microsoft Connect website](https://connect.microsoft.com/site1164).</span></span> 

<span data-ttu-id="88a86-248">Per le istruzioni su come usare il pacchetto, vedere [Come configurare la registrazione automatica dei dispositivi Windows aggiunti a un dominio con Azure Active Directory](active-directory-conditional-access-automatic-device-registration-setup.md).</span><span class="sxs-lookup"><span data-stu-id="88a86-248">Instructions about how to use the package are available in [How to configure automatic registration of Windows domain-joined devices with Azure Active Directory](active-directory-conditional-access-automatic-device-registration-setup.md).</span></span>

## <a name="verify-that-registered-devices-are-written-back-to-active-directory"></a><span data-ttu-id="88a86-249">Verificare che venga eseguito il writeback dei dispositivi registrati in Active Directory</span><span class="sxs-lookup"><span data-stu-id="88a86-249">Verify that registered devices are written back to Active Directory</span></span>
<span data-ttu-id="88a86-250">È possibile verificare che sia stato eseguito il writeback degli oggetti dispositivo in Active Directory usando LDP.exe o ADSI Edit.</span><span class="sxs-lookup"><span data-stu-id="88a86-250">You can view and verify that your device objects have been written back to your Active Directory by using LDP.exe or ADSI Edit.</span></span> <span data-ttu-id="88a86-251">Entrambi sono disponibili con gli strumenti dell'amministratore di Active Directory.</span><span class="sxs-lookup"><span data-stu-id="88a86-251">Both are available with the Active Directory administrator tools.</span></span>

<span data-ttu-id="88a86-252">Per impostazione predefinita, gli oggetti dispositivo di cui viene eseguito il writeback da Azure Active Directory vengono inseriti nello stesso dominio della farm AD FS.</span><span class="sxs-lookup"><span data-stu-id="88a86-252">By default, device objects that are written back from Azure Active Directory are placed in the same domain as your AD FS farm.</span></span>

    CN=RegisteredDevices,defaultNamingContext

## <a name="create-an-application-access-policy-and-custom-access-denied-message"></a><span data-ttu-id="88a86-253">Creare un criterio di accesso alle applicazioni e un messaggio di accesso negato personalizzato</span><span class="sxs-lookup"><span data-stu-id="88a86-253">Create an application access policy and custom access-denied message</span></span>
<span data-ttu-id="88a86-254">Considerare lo scenario seguente: si crea un trust della relying party per l'applicazione in AD FS e si configura una regola di autorizzazione rilascio che consente solo dispositivi registrati.</span><span class="sxs-lookup"><span data-stu-id="88a86-254">Consider the following scenario: You create an application Relying Party Trust in AD FS and configure an Issuance Authorization Rule that allows only registered devices.</span></span> <span data-ttu-id="88a86-255">Ora solo i dispositivi registrati possono accedere all'applicazione.</span><span class="sxs-lookup"><span data-stu-id="88a86-255">Now only devices that are registered are allowed to access the application.</span></span> 

<span data-ttu-id="88a86-256">Per semplificare l'accesso degli utenti all'applicazione, configurare un messaggio di accesso negato personalizzato che include istruzioni su come aggiungere il dispositivo dell'utente.</span><span class="sxs-lookup"><span data-stu-id="88a86-256">To make it easy for your users to gain access to the application, you configure a custom access-denied message that includes instructions for how to join their device.</span></span> <span data-ttu-id="88a86-257">A questo punto per gli utenti è più facile registrare i propri dispositivi per accedere a un'applicazione.</span><span class="sxs-lookup"><span data-stu-id="88a86-257">Now your users have a seamless way to register their devices so they can access an application.</span></span>

<span data-ttu-id="88a86-258">Nei passaggi seguenti viene illustrato come implementare questo scenario.</span><span class="sxs-lookup"><span data-stu-id="88a86-258">The following steps show you how to implement this scenario.</span></span>

> [!NOTE]
> <span data-ttu-id="88a86-259">Questa sezione presuppone che sia già stato configurato un trust della relying party per l'applicazione in AD FS.</span><span class="sxs-lookup"><span data-stu-id="88a86-259">This section assumes that you have already configured a Relying Party Trust for your application in AD FS.</span></span>
> 

1. <span data-ttu-id="88a86-260">Aprire lo strumento MMC di AD FS e selezionare **AD FS** > **Relazioni di trust** > **Attendibilità componente**.</span><span class="sxs-lookup"><span data-stu-id="88a86-260">Open the AD FS MMC tool, and then select **AD FS** > **Trust Relationships** > **Relying Party Trusts**.</span></span>
2. <span data-ttu-id="88a86-261">Individuare l'applicazione a cui applicare questa nuova regola di accesso.</span><span class="sxs-lookup"><span data-stu-id="88a86-261">Locate the application to which this new access rule applies.</span></span> <span data-ttu-id="88a86-262">Fare clic con il pulsante destro del mouse sull'applicazione e selezionare **Modifica regole attestazione**.</span><span class="sxs-lookup"><span data-stu-id="88a86-262">Right-click the application, and then select **Edit Claim Rules**.</span></span>
3. <span data-ttu-id="88a86-263">Selezionare la scheda **Regole di autorizzazione rilascio** e quindi selezionare **Aggiungi regola**.</span><span class="sxs-lookup"><span data-stu-id="88a86-263">Select the **Issuance Authorization Rules** tab, and then select **Add Rule**.</span></span>
4. <span data-ttu-id="88a86-264">Nell'elenco a discesa **Modello di regola attestazione** selezionare **Consentire o negare l'accesso agli utenti in base a un'attestazione in ingresso**.</span><span class="sxs-lookup"><span data-stu-id="88a86-264">From the **Claim rule** template drop-down list, select **Permit or Deny Users Based on an Incoming Claim**.</span></span> <span data-ttu-id="88a86-265">Quindi selezionare **Avanti**.</span><span class="sxs-lookup"><span data-stu-id="88a86-265">Then select **Next**.</span></span>
5. <span data-ttu-id="88a86-266">Nel campo **Nome regola attestazione** digitare **Consenti accesso dai dispositivi registrati**.</span><span class="sxs-lookup"><span data-stu-id="88a86-266">In the **Claim rule name** field, type **Permit access from registered devices**.</span></span>
6. <span data-ttu-id="88a86-267">Nell'elenco a discesa **Tipo di attestazione in ingresso** selezionare **È un utente registrato**.</span><span class="sxs-lookup"><span data-stu-id="88a86-267">From the **Incoming claim type** drop-down list, select **Is Registered User**.</span></span>
7. <span data-ttu-id="88a86-268">Digitare **true** nel campo **Valore attestazione in ingresso**.</span><span class="sxs-lookup"><span data-stu-id="88a86-268">In the **Incoming claim value** field, type **true**.</span></span>
8. <span data-ttu-id="88a86-269">Selezionare il pulsante di opzione **Consenti accesso agli utenti con questa attestazione in ingresso** .</span><span class="sxs-lookup"><span data-stu-id="88a86-269">Select the **Permit access to users with this incoming claim** radio button.</span></span>
9. <span data-ttu-id="88a86-270">Selezionare **Fine** e quindi **Applica**.</span><span class="sxs-lookup"><span data-stu-id="88a86-270">Select **Finish**, and then select **Apply**.</span></span>
10. <span data-ttu-id="88a86-271">Rimuovere eventuali regole più permissive di quella creata.</span><span class="sxs-lookup"><span data-stu-id="88a86-271">Remove any rules that are more permissive than the rule you created.</span></span> <span data-ttu-id="88a86-272">Ad esempio, rimuovere la regola predefinita **Consenti accesso a tutti gli utenti** .</span><span class="sxs-lookup"><span data-stu-id="88a86-272">For example, remove the default rule **Permit Access to all Users**.</span></span>

<span data-ttu-id="88a86-273">L'applicazione ora è configurata per consentire l'accesso solo quando l'utente opera da un dispositivo registrato e aggiunto all'area di lavoro.</span><span class="sxs-lookup"><span data-stu-id="88a86-273">Your application is now configured to allow access only when the user is coming from a device that they registered and joined to the workplace.</span></span> <span data-ttu-id="88a86-274">Per i criteri di accesso più avanzati, vedere l'articolo relativo alla [gestione dei rischi con autenticazione a più fattori aggiuntiva per le applicazioni sensibili](https://technet.microsoft.com/library/dn280949.aspx).</span><span class="sxs-lookup"><span data-stu-id="88a86-274">For more advanced access polices, see [Manage Risk with Additional Multi-Factor Authentication for Sensitive Applications](https://technet.microsoft.com/library/dn280949.aspx).</span></span>

<span data-ttu-id="88a86-275">Configurare quindi un messaggio di errore personalizzato per l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="88a86-275">Next, you configure a custom error message for your application.</span></span> <span data-ttu-id="88a86-276">Tale messaggio indica agli utenti che devono aggiungere il proprio dispositivo all'area di lavoro per poter accedere all'applicazione.</span><span class="sxs-lookup"><span data-stu-id="88a86-276">The error message lets users know that they must join their device to the workplace before they can access the application.</span></span> <span data-ttu-id="88a86-277">È possibile creare un messaggio personalizzato di accesso all'applicazione negato usando codice HTML personalizzato e PowerShell.</span><span class="sxs-lookup"><span data-stu-id="88a86-277">You can create a custom application access-denied message by using custom HTML and PowerShell.</span></span>

<span data-ttu-id="88a86-278">Nel server federativo aprire una finestra di comando di PowerShell e digitare il comando seguente.</span><span class="sxs-lookup"><span data-stu-id="88a86-278">On your federation server, open a PowerShell command window, and then type the following command.</span></span> <span data-ttu-id="88a86-279">Sostituire alcune parti del comando con gli elementi specifici del proprio sistema:</span><span class="sxs-lookup"><span data-stu-id="88a86-279">Replace portions of the command with items that are specific to your system:</span></span>

    Set-AdfsRelyingPartyWebContent -Name "relying party trust name" -ErrorPageAuthorizationErrorMessage
<span data-ttu-id="88a86-280">Prima di poter accedere all'applicazione, è necessario registrare il dispositivo.</span><span class="sxs-lookup"><span data-stu-id="88a86-280">You must register your device before you can access this application.</span></span>

<span data-ttu-id="88a86-281">**Se si usa un dispositivo iOS, selezionare questo collegamento per accedere al dispositivo**:</span><span class="sxs-lookup"><span data-stu-id="88a86-281">**If you are using an iOS device, select this link to join your device**:</span></span>

    a href='https://enterpriseregistration.windows.net/enrollmentserver/otaprofile/yourdomain.com

<span data-ttu-id="88a86-282">Aggiungere questo dispositivo iOS alla propria area di lavoro.</span><span class="sxs-lookup"><span data-stu-id="88a86-282">Join this iOS device to your workplace.</span></span>

<span data-ttu-id="88a86-283">Se si usa un dispositivo Windows 8.1, è possibile aggiungere il dispositivo selezionando **Impostazioni PC** > **Rete** > **Area di lavoro**.</span><span class="sxs-lookup"><span data-stu-id="88a86-283">If you are using a Windows 8.1 device, you can join your device by selecting **PC Settings**> **Network** > **Workplace**.</span></span>

<span data-ttu-id="88a86-284">Nei comandi precedenti **relying party trust name** è il nome dell'oggetto trust della relying party dell'applicazione in AD FS.</span><span class="sxs-lookup"><span data-stu-id="88a86-284">In the preceding commands, **relying party trust name** is the name of your application's Relying Party Trust object in AD FS.</span></span>
<span data-ttu-id="88a86-285">E **yourdomain.com** è il nome di dominio configurato con Azure Active Directory, ad esempio contoso.com.</span><span class="sxs-lookup"><span data-stu-id="88a86-285">And **yourdomain.com** is the domain name that you have configured with Azure Active Directory (for example, contoso.com).</span></span>
<span data-ttu-id="88a86-286">Assicurarsi di rimuovere le eventuali interruzioni di riga presenti nel contenuto HTML passato al cmdlet **Set-AdfsRelyingPartyWebContent** .</span><span class="sxs-lookup"><span data-stu-id="88a86-286">Be sure to remove any line breaks (if any) from the HTML content that you pass to the **Set-AdfsRelyingPartyWebContent** cmdlet.</span></span>

<span data-ttu-id="88a86-287">A questo punto, quando gli utenti accedono all'applicazione da un dispositivo non registrato con il servizio Registrazione dispositivo di Azure Active Directory, visualizzano una pagina simile alla schermata seguente.</span><span class="sxs-lookup"><span data-stu-id="88a86-287">Now when users access your application from a device that's not registered with the Azure Active Directory device registration service, they see a page that looks similar to the following screenshot.</span></span>

![Schermata di un errore visualizzato quando gli utenti non hanno registrato il dispositivo con Azure AD](./media/active-directory-conditional-access/error-azureDRS-device-not-registered.gif)


