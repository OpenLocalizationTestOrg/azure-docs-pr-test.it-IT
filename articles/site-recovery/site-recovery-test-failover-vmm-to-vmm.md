---
title: Failover di test (da VMM a VMM) in Azure Site Recovery | Microsoft Docs
description: Azure Site Recovery coordina la replica, il failover e il ripristino di macchine virtuali e server fisici. Informazioni sul failover in Azure o in un centro dati secondario.
services: site-recovery
documentationcenter: 
author: prateek9us
manager: gauravd
editor: 
ms.assetid: 44813a48-c680-4581-a92e-cecc57cc3b1e
ms.service: site-recovery
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: storage-backup-recovery
ms.date: 06/05/2017
ms.author: pratshar
ms.openlocfilehash: afc4790d5714ce7145c8f4291a05acc2e9882a9b
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 07/11/2017
---
# <a name="test-failover-vmm-to-vmm-in-site-recovery"></a><span data-ttu-id="5b936-104">Failover di test (da VMM a VMM) in Site Recovery</span><span class="sxs-lookup"><span data-stu-id="5b936-104">Test failover (VMM to VMM) in Site Recovery</span></span>


<span data-ttu-id="5b936-105">Questo articolo contiene informazioni e istruzioni per eseguire un failover di test o un'esercitazione per il ripristino di emergenza di macchine virtuali (VM) e server fisici protetti con Azure Site Recovery.</span><span class="sxs-lookup"><span data-stu-id="5b936-105">This article provides information and instructions for doing a test failover or a disaster recovery (DR) drill of virtual machines (VMs) and physical servers that are protected with Azure Site Recovery.</span></span> <span data-ttu-id="5b936-106">Come sito di ripristino si usa un sito locale gestito con System Center Virtual Machine Manager (VMM).</span><span class="sxs-lookup"><span data-stu-id="5b936-106">You'll use a System Center Virtual Machine Manager (VMM)-managed on-premises site as the recovery site.</span></span>

<span data-ttu-id="5b936-107">Il failover di test viene eseguito per convalidare la strategia di replica o eseguire un'esercitazione sul ripristino di emergenza senza perdita di dati o tempi di inattività.</span><span class="sxs-lookup"><span data-stu-id="5b936-107">You run a test failover to validate your replication strategy or perform a DR drill without any data loss or downtime.</span></span> <span data-ttu-id="5b936-108">Un failover di test non ha alcun impatto sulla replica in corso o sull'ambiente di produzione.</span><span class="sxs-lookup"><span data-stu-id="5b936-108">A test failover doesn't have any impact on the ongoing replication or on your production environment.</span></span> <span data-ttu-id="5b936-109">È possibile eseguirlo in una macchina virtuale o in un [piano di ripristino](site-recovery-create-recovery-plans.md).</span><span class="sxs-lookup"><span data-stu-id="5b936-109">You can run it on either a virtual machine or a [recovery plan](site-recovery-create-recovery-plans.md).</span></span> <span data-ttu-id="5b936-110">Quando si attiva un failover di test è necessario specificare la rete a cui si connetteranno le macchine virtuali di test.</span><span class="sxs-lookup"><span data-stu-id="5b936-110">When you're triggering a test failover, you need to specify the network that the test virtual machines will connect to.</span></span> <span data-ttu-id="5b936-111">È possibile rilevare lo stato di avanzamento del failover di test nella pagina **Processi**.</span><span class="sxs-lookup"><span data-stu-id="5b936-111">You can track the progress of the test failover on the **Jobs** page.</span></span>  

<span data-ttu-id="5b936-112">Per inviare commenti o domande è possibile usare la parte inferiore di questo articolo oppure il [forum di Azure Recovery Services](https://social.msdn.microsoft.com/forums/azure/home?forum=hypervrecovmgr).</span><span class="sxs-lookup"><span data-stu-id="5b936-112">If you have any comments or questions, post them at the bottom of this article or on the [Azure Recovery Services Forum](https://social.msdn.microsoft.com/forums/azure/home?forum=hypervrecovmgr).</span></span>


## <a name="prepare-the-infrastructure-for-test-failover"></a><span data-ttu-id="5b936-113">Preparare l'infrastruttura per il failover di test</span><span class="sxs-lookup"><span data-stu-id="5b936-113">Prepare the infrastructure for test failover</span></span>
<span data-ttu-id="5b936-114">Per eseguire un failover di test usando una rete esistente preparare Active Directory, DHCP e DNS in tale rete.</span><span class="sxs-lookup"><span data-stu-id="5b936-114">If you want to run a test failover by using an existing network, prepare Active Directory, DHCP, and DNS in that network.</span></span>

<span data-ttu-id="5b936-115">Se si vuole eseguire un failover di test con l'opzione per la creazione automatica di reti VM aggiungere un passaggio manuale prima di Group-1 (Gruppo-1) nel piano di ripristino che si prevede di usare per il failover di test.</span><span class="sxs-lookup"><span data-stu-id="5b936-115">If you want to run a test failover by using the option to create VM networks automatically, add a manual step before Group-1 in the recovery plan that you’re going to use for the test failover.</span></span> <span data-ttu-id="5b936-116">Quindi prima di effettuare il failover di test aggiungere risorse di infrastruttura alla rete creata automaticamente.</span><span class="sxs-lookup"><span data-stu-id="5b936-116">Then, add the infrastructure resources to the automatically created network before you run the test failover.</span></span>

### <a name="things-to-note"></a><span data-ttu-id="5b936-117">Punti da notare</span><span class="sxs-lookup"><span data-stu-id="5b936-117">Things to note</span></span>
<span data-ttu-id="5b936-118">In caso di replica in un sito secondario, il tipo di rete usato dalla macchina di replica non deve necessariamente corrispondere al tipo di rete logica usato per il failover di test, ma alcune combinazioni potrebbero non funzionare.</span><span class="sxs-lookup"><span data-stu-id="5b936-118">When you're replicating to a secondary site, the type of network that the replica machine uses doesn’t need to match the type of logical network used for test failover, but some combinations might not work.</span></span> <span data-ttu-id="5b936-119">Se la replica utilizza DHCP e isolamento basato su VLAN, non è necessario un pool di indirizzi IP statici per la rete VM per la replica.</span><span class="sxs-lookup"><span data-stu-id="5b936-119">If the replica uses DHCP and VLAN-based isolation, the VM network for the replica doesn't need a static IP address pool.</span></span> <span data-ttu-id="5b936-120">Di conseguenza l’uso della virtualizzazione rete Windows per il failover di test non funziona perché non è disponibile alcun pool di indirizzi.</span><span class="sxs-lookup"><span data-stu-id="5b936-120">So using Windows Network Virtualization for the test failover won't work because no address pools are available.</span></span> 

<span data-ttu-id="5b936-121">Il failover di test non funziona anche quando la rete di replica è senza isolamento e la rete di test è basata sulla virtualizzazione rete Windows.</span><span class="sxs-lookup"><span data-stu-id="5b936-121">In addition, the test failover won't work if the replica network uses no isolation and the test network uses Windows Network Virtualization.</span></span> <span data-ttu-id="5b936-122">Questo accade perché la rete senza isolamento non dispone delle subnet necessarie per creare una rete di virtualizzazione rete Windows.</span><span class="sxs-lookup"><span data-stu-id="5b936-122">This is because the no-isolation network doesn't have the subnets required to create a Windows Network Virtualization network.</span></span>

<span data-ttu-id="5b936-123">Il modo in cui le macchine virtuali di replica sono connesse alle reti VM mappate dopo il failover dipende dalla configurazione della rete VM nella console VMM.</span><span class="sxs-lookup"><span data-stu-id="5b936-123">How replica virtual machines are connected to mapped VM networks after failover depends on how the VM network is configured in the VMM console.</span></span>

#### <a name="vm-network-configured-with-no-isolation-or-vlan-isolation"></a><span data-ttu-id="5b936-124">Rete VM configurata senza isolamento o isolamento VLAN</span><span class="sxs-lookup"><span data-stu-id="5b936-124">VM network configured with no isolation or VLAN isolation</span></span>
<span data-ttu-id="5b936-125">Se DHCP viene definito per la rete VM la macchina virtuale di replica viene connessa all'ID VLAN usando le impostazioni specificate per il sito di rete nella rete logica associata.</span><span class="sxs-lookup"><span data-stu-id="5b936-125">If DHCP is defined for the VM network, the replica virtual machine is connected to the VLAN ID through the settings that are specified for the network site in the associated logical network.</span></span> <span data-ttu-id="5b936-126">La macchina virtuale riceve il relativo indirizzo IP dal server DHCP disponibile.</span><span class="sxs-lookup"><span data-stu-id="5b936-126">The virtual machine receives its IP address from the available DHCP server.</span></span> 

<span data-ttu-id="5b936-127">Non è necessario definire un pool di indirizzi IP statico per la rete VM di destinazione.</span><span class="sxs-lookup"><span data-stu-id="5b936-127">You don't need to define a static IP address pool for the target VM network.</span></span> <span data-ttu-id="5b936-128">Se per la rete VM viene usato un pool di indirizzi IP statici, la macchina virtuale di replica viene connessa all'ID VLAN usando le impostazioni specificate per il sito di rete nella rete logica associata.</span><span class="sxs-lookup"><span data-stu-id="5b936-128">If a static IP address pool is used for the VM network, the replica virtual machine is connected to the VLAN ID through the settings that are specified for the network site in the associated logical network.</span></span>

<span data-ttu-id="5b936-129">La macchina virtuale riceve il proprio indirizzo IP dal pool definito per la rete VM.</span><span class="sxs-lookup"><span data-stu-id="5b936-129">The virtual machine receives its IP address from the pool that's defined for the VM network.</span></span> <span data-ttu-id="5b936-130">Se non è definito un pool di indirizzi IP statici nella rete VM di destinazione, l'allocazione di indirizzi IP avrà esito negativo.</span><span class="sxs-lookup"><span data-stu-id="5b936-130">If a static IP address pool isn't defined on the target VM network, IP address allocation will fail.</span></span> <span data-ttu-id="5b936-131">Creare il pool di indirizzi IP nei server VMM di origine e di destinazione che verranno usati per la protezione e il ripristino.</span><span class="sxs-lookup"><span data-stu-id="5b936-131">Create the IP address pool on both the source and target VMM servers that you will use for protection and recovery.</span></span>

#### <a name="vm-network-with-windows-network-virtualization"></a><span data-ttu-id="5b936-132">Rete VM con virtualizzazione rete Windows</span><span class="sxs-lookup"><span data-stu-id="5b936-132">VM network with Windows Network Virtualization</span></span>
<span data-ttu-id="5b936-133">Se una rete VM è configurata con virtualizzazione rete Windows è necessario definire un pool statico per la rete VM di destinazione, sia che la rete VM di origine sia configurata per usare DHCP o un pool di indirizzi IP statici.</span><span class="sxs-lookup"><span data-stu-id="5b936-133">If a VM network is configured with Windows Network Virtualization, you should define a static pool for the target VM network, regardless of whether the source VM network is configured to use DHCP or a static IP address pool.</span></span> 

<span data-ttu-id="5b936-134">Se si definisce DHCP, il server VMM di destinazione viene usato come server DHCP e offre un indirizzo IP dal pool definito per la rete VM di destinazione.</span><span class="sxs-lookup"><span data-stu-id="5b936-134">If you define DHCP, the target VMM server acts as a DHCP server and provides an IP address from the pool that's defined for the target VM network.</span></span> <span data-ttu-id="5b936-135">Se per il server di origine è definito l’uso di un pool di indirizzi IP statici, il server VMM di destinazione assegna un indirizzo IP dal pool.</span><span class="sxs-lookup"><span data-stu-id="5b936-135">If use of a static IP address pool is defined for the source server, the target VMM server allocates an IP address from the pool.</span></span> <span data-ttu-id="5b936-136">In entrambi i casi, l'allocazione di indirizzi IP non riuscirà se non è definito un pool di indirizzi IP statici.</span><span class="sxs-lookup"><span data-stu-id="5b936-136">In both cases, IP address allocation will fail if a static IP address pool is not defined.</span></span>


### <a name="prepare-dhcp"></a><span data-ttu-id="5b936-137">Preparare DHCP</span><span class="sxs-lookup"><span data-stu-id="5b936-137">Prepare DHCP</span></span>
<span data-ttu-id="5b936-138">Se le macchine virtuali che partecipano al failover di test usano DHCP, creare un server DHCP di test all'interno della rete isolata ai fini del failover di test.</span><span class="sxs-lookup"><span data-stu-id="5b936-138">If the virtual machines involved in test failover use DHCP, create a test DHCP server within the isolated network for the purpose of test failover.</span></span>

### <a name="prepare-active-directory"></a><span data-ttu-id="5b936-139">Preparare Active Directory</span><span class="sxs-lookup"><span data-stu-id="5b936-139">Prepare Active Directory</span></span>
<span data-ttu-id="5b936-140">Per eseguire un failover di test per testare l'applicazione, è necessaria una copia dell'ambiente Active Directory di produzione nell'ambiente di test.</span><span class="sxs-lookup"><span data-stu-id="5b936-140">To run a test failover for application testing, you need a copy of the production Active Directory environment in your test environment.</span></span> <span data-ttu-id="5b936-141">Per altre informazioni, vedere le [considerazioni sul failover di test di Active Directory](site-recovery-active-directory.md#test-failover-considerations).</span><span class="sxs-lookup"><span data-stu-id="5b936-141">For more information, review the [test failover considerations for Active Directory](site-recovery-active-directory.md#test-failover-considerations).</span></span>

### <a name="prepare-dns"></a><span data-ttu-id="5b936-142">Preparare DNS</span><span class="sxs-lookup"><span data-stu-id="5b936-142">Prepare DNS</span></span>
<span data-ttu-id="5b936-143">Preparare un server DNS per il failover di test come segue:</span><span class="sxs-lookup"><span data-stu-id="5b936-143">Prepare a DNS server for the test failover as follows:</span></span>

* <span data-ttu-id="5b936-144">**DHCP**: se le macchine virtuali usano DHCP, l'indirizzo IP del DNS di test deve essere aggiornato nel server DHCP di test.</span><span class="sxs-lookup"><span data-stu-id="5b936-144">**DHCP**: If virtual machines use DHCP, the IP address of the test DNS should be updated on the test DHCP server.</span></span> <span data-ttu-id="5b936-145">Se si utilizza un tipo di rete di virtualizzazione rete Windows, il server VMM funge da server DHCP.</span><span class="sxs-lookup"><span data-stu-id="5b936-145">If you’re using a network type of Windows Network Virtualization, the VMM server acts as the DHCP server.</span></span> <span data-ttu-id="5b936-146">Pertanto, l'indirizzo IP del DNS deve essere aggiornato nella rete di failover di test.</span><span class="sxs-lookup"><span data-stu-id="5b936-146">Therefore, the IP address of DNS should be updated in the test failover network.</span></span> <span data-ttu-id="5b936-147">In questo caso le macchine virtuali effettuano la registrazione nel relativo server DNS.</span><span class="sxs-lookup"><span data-stu-id="5b936-147">In this case, the virtual machines register themselves to the relevant DNS server.</span></span>
* <span data-ttu-id="5b936-148">**Indirizzo statico**: se le macchine virtuali usano un indirizzo IP statico, l'indirizzo IP del server DNS di test deve essere aggiornato nella rete di failover di test.</span><span class="sxs-lookup"><span data-stu-id="5b936-148">**Static address**: If virtual machines use a static IP address, the IP address of the test DNS server should be updated in test failover network.</span></span> <span data-ttu-id="5b936-149">Può essere necessario aggiornare il DNS con l'indirizzo IP delle macchine virtuali di test.</span><span class="sxs-lookup"><span data-stu-id="5b936-149">You might need to update DNS with the IP address of the test virtual machines.</span></span> <span data-ttu-id="5b936-150">A tale scopo, è possibile utilizzare lo script di esempio riportato di seguito:</span><span class="sxs-lookup"><span data-stu-id="5b936-150">You can use the following sample script for this purpose:</span></span>

        Param(
        [string]$Zone,
        [string]$name,
        [string]$IP
        )
        $Record = Get-DnsServerResourceRecord -ZoneName $zone -Name $name
        $newrecord = $record.clone()
        $newrecord.RecordData[0].IPv4Address  =  $IP
        Set-DnsServerResourceRecord -zonename $zone -OldInputObject $record -NewInputObject $Newrecord



## <a name="run-a-test-failover"></a><span data-ttu-id="5b936-151">Eseguire un failover di test</span><span class="sxs-lookup"><span data-stu-id="5b936-151">Run a test failover</span></span>
<span data-ttu-id="5b936-152">Questa procedura descrive come eseguire un failover di test per un piano di ripristino.</span><span class="sxs-lookup"><span data-stu-id="5b936-152">This procedure describes how to run a test failover for a recovery plan.</span></span> <span data-ttu-id="5b936-153">In alternativa è possibile effettuare il failover per una singola macchina nella scheda **Macchine virtuali**.</span><span class="sxs-lookup"><span data-stu-id="5b936-153">Alternatively, you can run the failover for a single virtual machine on the **Virtual Machines** tab.</span></span>

![Pannello Failover di test](./media/site-recovery-test-failover-vmm-to-vmm/TestFailover.png)

1. <span data-ttu-id="5b936-155">Selezionare **Piani di ripristino** > *nome_pianodiripristino*.</span><span class="sxs-lookup"><span data-stu-id="5b936-155">Select **Recovery Plans** > *recoveryplan_name*.</span></span> <span data-ttu-id="5b936-156">Fare clic su **Failover** > **Test Failover**.</span><span class="sxs-lookup"><span data-stu-id="5b936-156">Click **Failover** > **Test Failover**.</span></span>
1. <span data-ttu-id="5b936-157">Nel pannello **Failover di test** specificare come le macchine virtuali dovranno essere connesse alle reti dopo il failover di test.</span><span class="sxs-lookup"><span data-stu-id="5b936-157">On the **Test Failover** blade, specify how virtual machines should be connected to networks after the test failover.</span></span> <span data-ttu-id="5b936-158">Per altre informazioni, vedere [Opzioni di rete](#network-options-in-site-recovery).</span><span class="sxs-lookup"><span data-stu-id="5b936-158">For more information, see the [network options](#network-options-in-site-recovery).</span></span>
1. <span data-ttu-id="5b936-159">Tenere traccia dello stato di avanzamento del failover nella scheda **Processi** .</span><span class="sxs-lookup"><span data-stu-id="5b936-159">Track failover progress on the **Jobs** tab.</span></span>
1. <span data-ttu-id="5b936-160">Dopo il completamento del failover verificare che le macchine virtuali vengano avviate correttamente.</span><span class="sxs-lookup"><span data-stu-id="5b936-160">After failover is complete, verify that the virtual machines start successfully.</span></span>
1. <span data-ttu-id="5b936-161">Al termine fare clic su **Cleanup test failover** (Pulizia failover di test) nel piano di ripristino.</span><span class="sxs-lookup"><span data-stu-id="5b936-161">When you're done, click **Cleanup test failover** on the recovery plan.</span></span> <span data-ttu-id="5b936-162">Fare clic su **Note** per registrare e salvare eventuali osservazioni associate al failover di test.</span><span class="sxs-lookup"><span data-stu-id="5b936-162">In **Notes**, record and save any observations associated with the test failover.</span></span> <span data-ttu-id="5b936-163">Questa operazione elimina le macchine virtuali e le reti create durante il failover di test.</span><span class="sxs-lookup"><span data-stu-id="5b936-163">This step deletes the virtual machines and networks that were created during test failover.</span></span>


## <a name="network-options-in-site-recovery"></a><span data-ttu-id="5b936-164">Opzioni di rete in Site Recovery</span><span class="sxs-lookup"><span data-stu-id="5b936-164">Network options in Site Recovery</span></span>

<span data-ttu-id="5b936-165">Quando si esegue un failover di test viene chiesto di selezionare le impostazioni di rete per le macchine di replica di test.</span><span class="sxs-lookup"><span data-stu-id="5b936-165">When you run a test failover, you're asked to select network settings for test replica machines.</span></span> <span data-ttu-id="5b936-166">Sono disponibili varie opzioni.</span><span class="sxs-lookup"><span data-stu-id="5b936-166">You have multiple options.</span></span>  

| <span data-ttu-id="5b936-167">**Opzione di failover di test**</span><span class="sxs-lookup"><span data-stu-id="5b936-167">**Test failover option**</span></span> | <span data-ttu-id="5b936-168">**Descrizione**</span><span class="sxs-lookup"><span data-stu-id="5b936-168">**Description**</span></span> | <span data-ttu-id="5b936-169">**Controllo del failover**</span><span class="sxs-lookup"><span data-stu-id="5b936-169">**Failover check**</span></span> | <span data-ttu-id="5b936-170">**Dettagli**</span><span class="sxs-lookup"><span data-stu-id="5b936-170">**Details**</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="5b936-171">**Effettuare il failover a un sito VMM secondario, senza rete**</span><span class="sxs-lookup"><span data-stu-id="5b936-171">**Fail over to a secondary VMM site--without network**</span></span> |<span data-ttu-id="5b936-172">Non selezionare una rete VM.</span><span class="sxs-lookup"><span data-stu-id="5b936-172">Don't select a VM network.</span></span> |<span data-ttu-id="5b936-173">Il failover controlla che le macchine di test vengono create.</span><span class="sxs-lookup"><span data-stu-id="5b936-173">Failover checks that test machines are created.</span></span><br/><br/><span data-ttu-id="5b936-174">La macchina virtuale di test viene creata nello stesso host in cui è presente la macchina virtuale di replica.</span><span class="sxs-lookup"><span data-stu-id="5b936-174">The test virtual machine is created on the host where the replica virtual machine exists.</span></span> <span data-ttu-id="5b936-175">Non viene aggiunta al cloud in cui si trova la macchina virtuale di replica.</span><span class="sxs-lookup"><span data-stu-id="5b936-175">It isn’t added to the cloud where the replica virtual machine is located.</span></span> |<p><span data-ttu-id="5b936-176">La macchina sottoposta a failover non è connessa a nessuna rete.</span><span class="sxs-lookup"><span data-stu-id="5b936-176">The failed-over machine isn’t connected to any network.</span></span><br/><br/><span data-ttu-id="5b936-177">La macchina può essere connessa a una rete VM dopo che è stata creata.</span><span class="sxs-lookup"><span data-stu-id="5b936-177">The machine can be connected to a VM network after it has been created.</span></span> |
| <span data-ttu-id="5b936-178">**Effettuare il failover a un sito VMM secondario, con rete**</span><span class="sxs-lookup"><span data-stu-id="5b936-178">**Fail over to a secondary VMM site--with network**</span></span> |<span data-ttu-id="5b936-179">Selezionare una rete VM esistente.</span><span class="sxs-lookup"><span data-stu-id="5b936-179">Select an existing VM network.</span></span> |<span data-ttu-id="5b936-180">Il failover controlla che le macchine virtuali vengano create.</span><span class="sxs-lookup"><span data-stu-id="5b936-180">Failover checks that virtual machines are created.</span></span> |<span data-ttu-id="5b936-181">La macchina virtuale di test viene creata nello stesso host in cui è presente la macchina virtuale di replica.</span><span class="sxs-lookup"><span data-stu-id="5b936-181">The test virtual machine is created on the host where the replica virtual machine exists.</span></span> <span data-ttu-id="5b936-182">Non viene aggiunta al cloud in cui si trova la macchina virtuale di replica.</span><span class="sxs-lookup"><span data-stu-id="5b936-182">It isn’t added to the cloud where the replica virtual machine is located.</span></span><br/><br/><span data-ttu-id="5b936-183">Creare una rete VM isolata dalla rete di produzione.</span><span class="sxs-lookup"><span data-stu-id="5b936-183">Create a VM network that's isolated from your production network.</span></span><br/><br/><span data-ttu-id="5b936-184">Se si vuole usare una rete basata su VLAN, è consigliabile creare a questo scopo in VMM una rete logica separata non usata in produzione.</span><span class="sxs-lookup"><span data-stu-id="5b936-184">If you're using a VLAN-based network, we recommend that you create a separate logical network (not used in production) in VMM for this purpose.</span></span> <span data-ttu-id="5b936-185">Questa rete logica viene usata per creare reti VM per i failover di test.</span><span class="sxs-lookup"><span data-stu-id="5b936-185">This logical network is used to create VM networks for test failovers.</span></span><br/><br/><span data-ttu-id="5b936-186">La rete logica deve essere associata ad almeno una delle schede di rete di tutti i server Hyper-V che ospitano macchine virtuali.</span><span class="sxs-lookup"><span data-stu-id="5b936-186">The logical network should be associated with at least one of the network adapters of all the Hyper-V servers that are hosting virtual machines.</span></span><br/><br/><span data-ttu-id="5b936-187">Per le reti logiche VLAN i siti di rete che vengono aggiunti alla rete logica devono essere isolati.</span><span class="sxs-lookup"><span data-stu-id="5b936-187">For VLAN logical networks, the network sites that you add to the logical network should be isolated.</span></span><br/><br/><span data-ttu-id="5b936-188">Se si usa una rete logica basata su Virtualizzazione rete Windows, Azure Site Recovery crea automaticamente reti VM isolate.</span><span class="sxs-lookup"><span data-stu-id="5b936-188">If you’re using a Windows Network Virtualization–based logical network, Azure Site Recovery automatically creates isolated VM networks.</span></span> |
| <span data-ttu-id="5b936-189">**Effettuare il failover a un sito VMM secondario, creare una rete**</span><span class="sxs-lookup"><span data-stu-id="5b936-189">**Fail over to a secondary VMM site--create a network**</span></span> |<span data-ttu-id="5b936-190">Viene creata automaticamente una rete di test temporanea in base all'impostazione specificata in **Rete logica** e ai siti di rete correlati.</span><span class="sxs-lookup"><span data-stu-id="5b936-190">A temporary test network is created automatically based on the setting that you specify in **Logical Network** and its related network sites.</span></span> |<span data-ttu-id="5b936-191">Il failover controlla che le macchine virtuali vengano create.</span><span class="sxs-lookup"><span data-stu-id="5b936-191">Failover checks that virtual machines are created.</span></span> |<span data-ttu-id="5b936-192">Utilizzare questa opzione se il piano di ripristino utilizza più reti VM.</span><span class="sxs-lookup"><span data-stu-id="5b936-192">Use this option if the recovery plan uses more than one VM network.</span></span> <span data-ttu-id="5b936-193">Se si utilizzano reti di virtualizzazione rete Windows, è possibile utilizzare questa opzione per creare automaticamente reti VM con le stesse impostazioni (subnet e pool di indirizzi IP) specificate nella rete della macchina virtuale di replica.</span><span class="sxs-lookup"><span data-stu-id="5b936-193">If you're using Windows Network Virtualization networks, this option can automatically create VM networks with the same settings (subnets and IP address pools) in the network of the replica virtual machine.</span></span> <span data-ttu-id="5b936-194">Queste reti VM vengono eliminate automaticamente al termine del failover di test.</span><span class="sxs-lookup"><span data-stu-id="5b936-194">These VM networks are cleaned up automatically after the test failover is complete.</span></span></p><p><span data-ttu-id="5b936-195">La macchina virtuale di test viene creata nello stesso host in cui è presente la macchina virtuale di replica.</span><span class="sxs-lookup"><span data-stu-id="5b936-195">The test virtual machine is created on the host where the replica virtual machine exists.</span></span> <span data-ttu-id="5b936-196">Non viene aggiunta al cloud in cui si trova la macchina virtuale di replica.</span><span class="sxs-lookup"><span data-stu-id="5b936-196">It isn’t added to the cloud where the replica virtual machine is located.</span></span> |

> [!TIP]
> <span data-ttu-id="5b936-197">L'indirizzo IP assegnato a una macchina virtuale durante un failover di test corrisponde all'indirizzo IP che la macchina virtuale riceverebbe durante un failover pianificato o non pianificato, a condizione che l'indirizzo IP sia disponibile nella rete di failover di test.</span><span class="sxs-lookup"><span data-stu-id="5b936-197">The IP address given to a virtual machine during test failover is the same IP address that the virtual machine would receive for a planned or unplanned failover (presuming that the IP address is available in the test failover network).</span></span> <span data-ttu-id="5b936-198">Se lo stesso indirizzo IP non è disponibile nella rete di failover di test, la macchina virtuale riceve un altro indirizzo IP disponibile in tale rete.</span><span class="sxs-lookup"><span data-stu-id="5b936-198">If the same IP address isn't available in the test failover network, the virtual machine receives another IP address that's available in the test failover network.</span></span>
>
>


## <a name="test-failover-to-a-production-network-on-a-recovery-site"></a><span data-ttu-id="5b936-199">Failover di test su una rete di produzione in un sito di ripristino</span><span class="sxs-lookup"><span data-stu-id="5b936-199">Test failover to a production network on a recovery site</span></span>
<span data-ttu-id="5b936-200">Per un failover di test è consigliabile scegliere una rete diversa dalla rete del sito di ripristino di produzione specificata in [Mapping di rete](https://docs.microsoft.com/azure/site-recovery/site-recovery-network-mapping).</span><span class="sxs-lookup"><span data-stu-id="5b936-200">We recommend that when you're doing a test failover, you choose a network that is different from your production recovery site network that you provided in [network mapping](https://docs.microsoft.com/azure/site-recovery/site-recovery-network-mapping).</span></span> <span data-ttu-id="5b936-201">Se si vuole comunque convalidare la connettività di rete end-to-end in una macchina virtuale sottoposta a failover, tenere presente quanto segue:</span><span class="sxs-lookup"><span data-stu-id="5b936-201">But if you really want to validate end-to-end network connectivity in a failed-over virtual machine, note the following points:</span></span>

* <span data-ttu-id="5b936-202">Verificare che la macchina virtuale primaria sia arrestata quando si esegue il failover di test.</span><span class="sxs-lookup"><span data-stu-id="5b936-202">Make sure that the primary virtual machine is shut down when you're doing the test failover.</span></span> <span data-ttu-id="5b936-203">In caso contrario si avranno due macchine virtuali con la stessa identità in esecuzione contemporaneamente sulla stessa rete.</span><span class="sxs-lookup"><span data-stu-id="5b936-203">If you don't, two virtual machines with the same identity will be running in the same network at the same time.</span></span> <span data-ttu-id="5b936-204">Questa situazione può provocare conseguenze indesiderate.</span><span class="sxs-lookup"><span data-stu-id="5b936-204">That situation can lead to undesired consequences.</span></span>
* <span data-ttu-id="5b936-205">Quando si esegue la pulizia delle macchine virtuali del failover di test, tutte le modifiche apportate a tali macchine vanno perdute.</span><span class="sxs-lookup"><span data-stu-id="5b936-205">Any changes that you make to the test failover virtual machines are lost when you clean up the test failover virtual machines.</span></span> <span data-ttu-id="5b936-206">Le modifiche non vengono replicate nella macchina virtuale primaria.</span><span class="sxs-lookup"><span data-stu-id="5b936-206">These changes are not replicated back to the primary virtual machine.</span></span>
* <span data-ttu-id="5b936-207">Questa modalità di esecuzione dei test determina un tempo di inattività dell'applicazione di produzione.</span><span class="sxs-lookup"><span data-stu-id="5b936-207">This way of doing testing leads to downtime for your production application.</span></span> <span data-ttu-id="5b936-208">Chiedere agli utenti di non usare l'applicazione mentre è in corso l'esercitazione per il ripristino di emergenza.</span><span class="sxs-lookup"><span data-stu-id="5b936-208">Ask users of the application not to use the application when the DR drill is in progress.</span></span>  


## <a name="next-steps"></a><span data-ttu-id="5b936-209">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="5b936-209">Next steps</span></span>
<span data-ttu-id="5b936-210">Dopo l'esito positivo di un failover di test è possibile provare a eseguire un [failover](site-recovery-failover.md).</span><span class="sxs-lookup"><span data-stu-id="5b936-210">After you have successfully run a test failover, you can try a [failover](site-recovery-failover.md).</span></span>
