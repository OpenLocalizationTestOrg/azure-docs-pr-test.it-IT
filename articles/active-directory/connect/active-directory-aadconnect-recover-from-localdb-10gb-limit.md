---
title: 'Azure AD Connect: Come limitare toorecover da 10GB LocalDB problema | Documenti Microsoft'
description: Questo argomento viene descritto come toorecover sincronizzazione di Azure AD Connect del servizio quando viene rilevato LocalDB 10GB limitare problema.
services: active-directory
documentationcenter: 
author: cychua
manager: femila
editor: 
ms.assetid: 41d081af-ed89-4e17-be34-14f7e80ae358
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/17/2017
ms.author: billmath
ms.openlocfilehash: 7b8ce6e19b68837639017bb0315eda4b924d525a
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/06/2017
---
# <a name="azure-ad-connect-how-toorecover-from-localdb-10-gb-limit"></a><span data-ttu-id="00ff8-103">Azure AD Connect: Modalità toorecover dal limite di 10 GB di LocalDB</span><span class="sxs-lookup"><span data-stu-id="00ff8-103">Azure AD Connect: How toorecover from LocalDB 10-GB limit</span></span>
<span data-ttu-id="00ff8-104">Azure AD Connect richiede un Server SQL database toostore identità dei dati.</span><span class="sxs-lookup"><span data-stu-id="00ff8-104">Azure AD Connect requires a SQL Server database toostore identity data.</span></span> <span data-ttu-id="00ff8-105">È possibile utilizzare hello predefinito installato SQL Server 2012 Express LocalDB con Azure AD Connect o usare la propria SQL completa.</span><span class="sxs-lookup"><span data-stu-id="00ff8-105">You can either use hello default SQL Server 2012 Express LocalDB installed with Azure AD Connect or use your own full SQL.</span></span> <span data-ttu-id="00ff8-106">SQL Server Express impone un limite di 10 GB.</span><span class="sxs-lookup"><span data-stu-id="00ff8-106">SQL Server Express imposes a 10-GB size limit.</span></span> <span data-ttu-id="00ff8-107">Quando si usa LocalDB e viene raggiunto questo limite, il servizio di sincronizzazione Azure AD Connect non può più essere avviato o eseguire la sincronizzazione correttamente.</span><span class="sxs-lookup"><span data-stu-id="00ff8-107">When using LocalDB and this limit is reached, Azure AD Connect Synchronization Service can no longer start or synchronize properly.</span></span> <span data-ttu-id="00ff8-108">In questo articolo vengono illustrate operazioni di ripristino hello.</span><span class="sxs-lookup"><span data-stu-id="00ff8-108">This article provides hello recovery steps.</span></span>

## <a name="symptoms"></a><span data-ttu-id="00ff8-109">Sintomi</span><span class="sxs-lookup"><span data-stu-id="00ff8-109">Symptoms</span></span>
<span data-ttu-id="00ff8-110">Esistono due sintomi comuni:</span><span class="sxs-lookup"><span data-stu-id="00ff8-110">There are two common symptoms:</span></span>

* <span data-ttu-id="00ff8-111">Servizio Azure AD Connect sincronizzazione **è in esecuzione** ma non riesce toosynchronize con *"arrestata-database-disco-full"* errore.</span><span class="sxs-lookup"><span data-stu-id="00ff8-111">Azure AD Connect Synchronization Service **is running** but fails toosynchronize with *“stopped-database-disk-full”* error.</span></span>

* <span data-ttu-id="00ff8-112">Servizio Azure AD Connect sincronizzazione **è Impossibile toostart**.</span><span class="sxs-lookup"><span data-stu-id="00ff8-112">Azure AD Connect Synchronization Service **is unable toostart**.</span></span> <span data-ttu-id="00ff8-113">Quando si tenta di servizio hello toostart, non riesce con messaggio di errore e di evento 6323 *"hello server ha rilevato un errore perché SQL Server ha esaurito lo spazio su disco."*</span><span class="sxs-lookup"><span data-stu-id="00ff8-113">When you attempt toostart hello service, it fails with event 6323 and error message *"hello server encountered an error because SQL Server is out of disk space."*</span></span>

## <a name="short-term-recovery-steps"></a><span data-ttu-id="00ff8-114">Procedura di ripristino a breve termine</span><span class="sxs-lookup"><span data-stu-id="00ff8-114">Short-term recovery steps</span></span>
<span data-ttu-id="00ff8-115">Questa sezione vengono fornite hello passaggi tooreclaim DB spazio per l'operazione di servizio Azure AD Connect sincronizzazione tooresume.</span><span class="sxs-lookup"><span data-stu-id="00ff8-115">This section provides hello steps tooreclaim DB space required for Azure AD Connect Synchronization Service tooresume operation.</span></span> <span data-ttu-id="00ff8-116">Hello passaggi includono:</span><span class="sxs-lookup"><span data-stu-id="00ff8-116">hello steps include:</span></span>
1. [<span data-ttu-id="00ff8-117">Determinare lo stato del servizio di sincronizzazione hello</span><span class="sxs-lookup"><span data-stu-id="00ff8-117">Determine hello Synchronization Service status</span></span>](#determine-the-synchronization-service-status)
2. [<span data-ttu-id="00ff8-118">Compattazione di database hello</span><span class="sxs-lookup"><span data-stu-id="00ff8-118">Shrink hello database</span></span>](#shrink-the-database)
3. [<span data-ttu-id="00ff8-119">Eliminare i dati della cronologia di esecuzione</span><span class="sxs-lookup"><span data-stu-id="00ff8-119">Delete run history data</span></span>](#delete-run-history-data)
4. [<span data-ttu-id="00ff8-120">Abbreviare il periodo di conservazione dei dati della cronologia di esecuzione</span><span class="sxs-lookup"><span data-stu-id="00ff8-120">Shorten retention period for run history data</span></span>](#shorten-retention-period-for-run-history-data)

### <a name="determine-hello-synchronization-service-status"></a><span data-ttu-id="00ff8-121">Determinare lo stato del servizio di sincronizzazione hello</span><span class="sxs-lookup"><span data-stu-id="00ff8-121">Determine hello Synchronization Service status</span></span>
<span data-ttu-id="00ff8-122">Innanzitutto, determinare se il servizio di sincronizzazione hello è ancora in esecuzione o non:</span><span class="sxs-lookup"><span data-stu-id="00ff8-122">First, determine whether hello Synchronization Service is still running or not:</span></span>

1. <span data-ttu-id="00ff8-123">Accedi tooyour Azure AD Connect server come amministratore.</span><span class="sxs-lookup"><span data-stu-id="00ff8-123">Log in tooyour Azure AD Connect server as administrator.</span></span>

2. <span data-ttu-id="00ff8-124">Andare troppo**Gestione controllo servizi**.</span><span class="sxs-lookup"><span data-stu-id="00ff8-124">Go too**Service Control Manager**.</span></span>

3. <span data-ttu-id="00ff8-125">Controllare lo stato di hello di **Microsoft Azure AD Sync**.</span><span class="sxs-lookup"><span data-stu-id="00ff8-125">Check hello status of **Microsoft Azure AD Sync**.</span></span>


4. <span data-ttu-id="00ff8-126">Se è in esecuzione, non arrestare o riavviare il servizio di hello.</span><span class="sxs-lookup"><span data-stu-id="00ff8-126">If it is running, do not stop or restart hello service.</span></span> <span data-ttu-id="00ff8-127">Ignora [database hello compattazione](#shrink-the-database) passaggio e andare troppo[Elimina dati di cronologia di esecuzione](#delete-run-history-data) passaggio.</span><span class="sxs-lookup"><span data-stu-id="00ff8-127">Skip [Shrink hello database](#shrink-the-database) step and go too[Delete run history data](#delete-run-history-data) step.</span></span>

5. <span data-ttu-id="00ff8-128">Se non è in esecuzione, provare il servizio di hello toostart.</span><span class="sxs-lookup"><span data-stu-id="00ff8-128">If it is not running, try toostart hello service.</span></span> <span data-ttu-id="00ff8-129">Se il servizio hello viene avviato correttamente, ignorare [database hello compattazione](#shrink-the-database) passaggio e andare troppo[Elimina dati di cronologia di esecuzione](#delete-run-history-data) passaggio.</span><span class="sxs-lookup"><span data-stu-id="00ff8-129">If hello service starts successfully, skip [Shrink hello database](#shrink-the-database) step and go too[Delete run history data](#delete-run-history-data) step.</span></span> <span data-ttu-id="00ff8-130">In caso contrario, continuare con [database hello compattazione](#shrink-the-database) passaggio.</span><span class="sxs-lookup"><span data-stu-id="00ff8-130">Otherwise, continue with [Shrink hello database](#shrink-the-database) step.</span></span>

### <a name="shrink-hello-database"></a><span data-ttu-id="00ff8-131">Compattazione di database hello</span><span class="sxs-lookup"><span data-stu-id="00ff8-131">Shrink hello database</span></span>
<span data-ttu-id="00ff8-132">Utilizzare toofree operazione di compattazione hello backup hello di toostart sufficiente spazio DB servizio di sincronizzazione.</span><span class="sxs-lookup"><span data-stu-id="00ff8-132">Use hello Shrink operation toofree up enough DB space toostart hello Synchronization Service.</span></span> <span data-ttu-id="00ff8-133">Consente di liberare spazio database rimuovendo gli spazi vuoti nel database di hello.</span><span class="sxs-lookup"><span data-stu-id="00ff8-133">It frees up DB space by removing whitespaces in hello database.</span></span> <span data-ttu-id="00ff8-134">Si tratta del miglior tentativo possibile, dato che non è certo che sia sempre possibile recuperare lo spazio.</span><span class="sxs-lookup"><span data-stu-id="00ff8-134">This step is best-effort as it is not guaranteed that you can always recover space.</span></span> <span data-ttu-id="00ff8-135">toolearn più sull'operazione di compattazione, leggere questo articolo [compattare un database](https://msdn.microsoft.com/library/ms189035.aspx).</span><span class="sxs-lookup"><span data-stu-id="00ff8-135">toolearn more about Shrink operation, read this article [Shrink a database](https://msdn.microsoft.com/library/ms189035.aspx).</span></span>

> [!IMPORTANT]
> <span data-ttu-id="00ff8-136">Ignorare questo passaggio se è possibile ottenere hello toorun di servizio di sincronizzazione.</span><span class="sxs-lookup"><span data-stu-id="00ff8-136">Skip this step if you can get hello Synchronization Service toorun.</span></span> <span data-ttu-id="00ff8-137">Non è consigliabile tooshrink hello DB SQL quanto può causare toopoor prestazioni a causa di frammentazione tooincreased.</span><span class="sxs-lookup"><span data-stu-id="00ff8-137">It is not recommended tooshrink hello SQL DB as it can lead toopoor performance due tooincreased fragmentation.</span></span>

<span data-ttu-id="00ff8-138">nome Hello database hello creato per Azure AD Connect è **ADSync**.</span><span class="sxs-lookup"><span data-stu-id="00ff8-138">hello name of hello database created for Azure AD Connect is **ADSync**.</span></span> <span data-ttu-id="00ff8-139">tooperform un'operazione di compattazione, è necessario accedere come hello sysadmin o proprietario del database hello.</span><span class="sxs-lookup"><span data-stu-id="00ff8-139">tooperform a Shrink operation, you must log in either as hello sysadmin or DBO of hello database.</span></span> <span data-ttu-id="00ff8-140">Durante l'installazione di Azure AD Connect, hello seguendo gli account viene concessi diritti di amministratore:</span><span class="sxs-lookup"><span data-stu-id="00ff8-140">During Azure AD Connect installation, hello following accounts are granted sysadmin rights:</span></span>
* <span data-ttu-id="00ff8-141">Amministratori locali</span><span class="sxs-lookup"><span data-stu-id="00ff8-141">Local Administrators</span></span>
* <span data-ttu-id="00ff8-142">account utente Hello era toorun usato Azure AD Connect installazione.</span><span class="sxs-lookup"><span data-stu-id="00ff8-142">hello user account that was used toorun Azure AD Connect installation.</span></span>
* <span data-ttu-id="00ff8-143">account del servizio di sincronizzazione che viene usato come contesto del servizio Azure AD Connect sincronizzazione operativo hello Hello.</span><span class="sxs-lookup"><span data-stu-id="00ff8-143">hello Sync Service account that is used as hello operating context of Azure AD Connect Synchronization Service.</span></span>
* <span data-ttu-id="00ff8-144">gruppo locale di Hello ADSyncAdmins creato durante l'installazione.</span><span class="sxs-lookup"><span data-stu-id="00ff8-144">hello local group ADSyncAdmins that was created during installation.</span></span>

1. <span data-ttu-id="00ff8-145">Eseguire il backup dei database hello copiando **ADSync.mdf** e **ADSync_log.ldf** file che si trovano in `%ProgramFiles%\program files\Microsoft Azure AD Sync\Data` tooa di posizione sicura.</span><span class="sxs-lookup"><span data-stu-id="00ff8-145">Back up hello database by copying **ADSync.mdf** and **ADSync_log.ldf** files located under `%ProgramFiles%\program files\Microsoft Azure AD Sync\Data` tooa safe location.</span></span>

2. <span data-ttu-id="00ff8-146">Avviare una nuova sessione di PowerShell.</span><span class="sxs-lookup"><span data-stu-id="00ff8-146">Start a new PowerShell session.</span></span>

3. <span data-ttu-id="00ff8-147">Passare toofolder `%ProgramFiles%\Program Files\Microsoft SQL Server\110\Tools\Binn`.</span><span class="sxs-lookup"><span data-stu-id="00ff8-147">Navigate toofolder `%ProgramFiles%\Program Files\Microsoft SQL Server\110\Tools\Binn`.</span></span>

4. <span data-ttu-id="00ff8-148">Avviare **sqlcmd** utilità eseguendo il comando hello `./SQLCMD.EXE -S “(localdb)\.\ADSync” -U <Username> -P <Password>`, utilizzando credenziali hello del ruolo sysadmin o hello database DBO.</span><span class="sxs-lookup"><span data-stu-id="00ff8-148">Start **sqlcmd** utility by running hello command `./SQLCMD.EXE -S “(localdb)\.\ADSync” -U <Username> -P <Password>`, using hello credential of a sysadmin or hello database DBO.</span></span>

5. <span data-ttu-id="00ff8-149">database hello tooshrink, al prompt dei comandi sqlcmd hello (1 >), immettere `DBCC Shrinkdatabase(ADSync,1);`, seguito da `GO` nella riga successiva hello.</span><span class="sxs-lookup"><span data-stu-id="00ff8-149">tooshrink hello database, at hello sqlcmd prompt (1>), enter `DBCC Shrinkdatabase(ADSync,1);`, followed by `GO` in hello next line.</span></span>

6. <span data-ttu-id="00ff8-150">Se l'operazione hello ha esito positivo, riprovare hello toostart servizio di sincronizzazione.</span><span class="sxs-lookup"><span data-stu-id="00ff8-150">If hello operation is successful, try toostart hello Synchronization Service again.</span></span> <span data-ttu-id="00ff8-151">Se è possibile avviare il servizio di sincronizzazione hello, andare troppo[Elimina dati di cronologia di esecuzione](#delete-run-history-data) passaggio.</span><span class="sxs-lookup"><span data-stu-id="00ff8-151">If you can start hello Synchronization Service, go too[Delete run history data](#delete-run-history-data) step.</span></span> <span data-ttu-id="00ff8-152">In caso contrario, contattare il supporto tecnico.</span><span class="sxs-lookup"><span data-stu-id="00ff8-152">If not, contact Support.</span></span>

### <a name="delete-run-history-data"></a><span data-ttu-id="00ff8-153">Eliminare i dati della cronologia di esecuzione</span><span class="sxs-lookup"><span data-stu-id="00ff8-153">Delete run history data</span></span>
<span data-ttu-id="00ff8-154">Per impostazione predefinita, Azure AD Connect mantiene fino tooseven di giorni di dati di cronologia di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="00ff8-154">By default, Azure AD Connect retains up tooseven days’ worth of run history data.</span></span> <span data-ttu-id="00ff8-155">In questo passaggio è eliminare hello spazio di tooreclaim DB dati di cronologia di esecuzione in modo che sia possibile avviare servizio Azure AD Connect sincronizzazione sincronizzando di nuovo.</span><span class="sxs-lookup"><span data-stu-id="00ff8-155">In this step, we delete hello run history data tooreclaim DB space so that Azure AD Connect Synchronization Service can start syncing again.</span></span>

1.  <span data-ttu-id="00ff8-156">Avviare **Synchronization Service Manager** da passare → tooSTART servizio di sincronizzazione.</span><span class="sxs-lookup"><span data-stu-id="00ff8-156">Start **Synchronization Service Manager** by going tooSTART → Synchronization Service.</span></span>

2.  <span data-ttu-id="00ff8-157">Passare toohello **operazioni** scheda.</span><span class="sxs-lookup"><span data-stu-id="00ff8-157">Go toohello **Operations** tab.</span></span>

3.  <span data-ttu-id="00ff8-158">In **Actions** (Azioni) selezionare **Clear Runs** (Cancella esecuzioni).</span><span class="sxs-lookup"><span data-stu-id="00ff8-158">Under **Actions**, select **Clear Runs**…</span></span>

4.  <span data-ttu-id="00ff8-159">È possibile scegliere **Clear all runs** (Cancella tutte le esecuzioni) oppure **Clear runs before<date>** (Cancella esecuzioni precedenti a).</span><span class="sxs-lookup"><span data-stu-id="00ff8-159">You can either choose **Clear all runs** or **Clear runs before… <date>** option.</span></span> <span data-ttu-id="00ff8-160">È consigliabile iniziare cancellando i dati della cronologia di esecuzione che risalgono a più di due giorni di prima.</span><span class="sxs-lookup"><span data-stu-id="00ff8-160">It is recommended that you start by clearing run history data that are older than two days.</span></span> <span data-ttu-id="00ff8-161">Se si continua toorun problema di dimensioni di database, quindi scegliere hello **deselezionare tutte le esecuzioni** opzione.</span><span class="sxs-lookup"><span data-stu-id="00ff8-161">If you continue toorun into DB size issue, then choose hello **Clear all runs** option.</span></span>

### <a name="shorten-retention-period-for-run-history-data"></a><span data-ttu-id="00ff8-162">Abbreviare il periodo di conservazione dei dati della cronologia di esecuzione</span><span class="sxs-lookup"><span data-stu-id="00ff8-162">Shorten retention period for run history data</span></span>
<span data-ttu-id="00ff8-163">Questo passaggio è probabilità hello tooreduce dell'esecuzione di problema di limite di 10 GB hello dopo più cicli di sincronizzazione.</span><span class="sxs-lookup"><span data-stu-id="00ff8-163">This step is tooreduce hello likelihood of running into hello 10-GB limit issue after multiple sync cycles.</span></span>

1. <span data-ttu-id="00ff8-164">Aprire una nuova sessione di PowerShell.</span><span class="sxs-lookup"><span data-stu-id="00ff8-164">Open a new PowerShell session.</span></span>

2. <span data-ttu-id="00ff8-165">Eseguire `Get-ADSyncScheduler` e prendere nota di hello PurgeRunHistoryInterval proprietà che specifica il periodo di memorizzazione corrente hello.</span><span class="sxs-lookup"><span data-stu-id="00ff8-165">Run `Get-ADSyncScheduler` and take note of hello PurgeRunHistoryInterval property, which specifies hello current retention period.</span></span>

3. <span data-ttu-id="00ff8-166">Eseguire `Set-ADSyncScheduler -PurgeRunHistoryInterval 2.00:00:00` giorni tootwo periodo di conservazione hello tooset.</span><span class="sxs-lookup"><span data-stu-id="00ff8-166">Run `Set-ADSyncScheduler -PurgeRunHistoryInterval 2.00:00:00` tooset hello retention period tootwo days.</span></span> <span data-ttu-id="00ff8-167">Regolare il periodo di memorizzazione hello come appropriato.</span><span class="sxs-lookup"><span data-stu-id="00ff8-167">Adjust hello retention period as appropriate.</span></span>

## <a name="long-term-solution--migrate-toofull-sql"></a><span data-ttu-id="00ff8-168">Soluzione a lungo termine di migrazione toofull SQL</span><span class="sxs-lookup"><span data-stu-id="00ff8-168">Long-term solution – Migrate toofull SQL</span></span>
<span data-ttu-id="00ff8-169">Problema di hello è in genere indicativa che dimensioni del database di 10 GB non sono più sufficiente per Azure AD Connect toosynchronize il tooAzure di Active Directory locale AD.</span><span class="sxs-lookup"><span data-stu-id="00ff8-169">In general, hello issue is indicative that 10-GB database size is no longer sufficient for Azure AD Connect toosynchronize your on-premises Active Directory tooAzure AD.</span></span> <span data-ttu-id="00ff8-170">È consigliabile passare versione completa di hello toousing di SQL server.</span><span class="sxs-lookup"><span data-stu-id="00ff8-170">It is recommended that you switch toousing hello full version of SQL server.</span></span> <span data-ttu-id="00ff8-171">È possibile sostituire direttamente hello del database locale di una distribuzione esistente di Azure AD Connect con database hello versione completa di hello di SQL.</span><span class="sxs-lookup"><span data-stu-id="00ff8-171">You cannot directly replace hello LocalDB of an existing Azure AD Connect deployment with hello database of hello full version of SQL.</span></span> <span data-ttu-id="00ff8-172">In alternativa, è necessario distribuire un nuovo server di Azure AD Connect versione completa di hello di SQL.</span><span class="sxs-lookup"><span data-stu-id="00ff8-172">Instead, you must deploy a new Azure AD Connect server with hello full version of SQL.</span></span> <span data-ttu-id="00ff8-173">Si consiglia di effettuare una migrazione di attività in cui nuovo server Azure AD Connect hello (con database SQL) viene distribuito come server di gestione temporanea, successivo server in Azure AD Connect esistente a toohello (con LocalDB).</span><span class="sxs-lookup"><span data-stu-id="00ff8-173">It is recommended that you do a swing migration where hello new Azure AD Connect server (with SQL DB) is deployed as a staging server, next toohello existing Azure AD Connect server (with LocalDB).</span></span> 
* <span data-ttu-id="00ff8-174">Per istruzioni su come tooconfigure SQL remoto con Azure AD Connect, fare riferimento tooarticle [installazione personalizzata di Azure AD Connect](https://docs.microsoft.com/azure/active-directory/connect/active-directory-aadconnect-get-started-custom).</span><span class="sxs-lookup"><span data-stu-id="00ff8-174">For instruction on how tooconfigure remote SQL with Azure AD Connect, refer tooarticle [Custom installation of Azure AD Connect](https://docs.microsoft.com/azure/active-directory/connect/active-directory-aadconnect-get-started-custom).</span></span>
* <span data-ttu-id="00ff8-175">Per istruzioni sulla migrazione di attività per l'aggiornamento di Azure AD Connect, consultare tooarticle [Azure AD Connect: l'aggiornamento da una precedente toohello versione più recente](https://docs.microsoft.com/azure/active-directory/connect/active-directory-aadconnect-upgrade-previous-version#swing-migration).</span><span class="sxs-lookup"><span data-stu-id="00ff8-175">For instructions on swing migration for Azure AD Connect upgrade, refer tooarticle [Azure AD Connect: Upgrade from a previous version toohello latest](https://docs.microsoft.com/azure/active-directory/connect/active-directory-aadconnect-upgrade-previous-version#swing-migration).</span></span>

## <a name="next-steps"></a><span data-ttu-id="00ff8-176">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="00ff8-176">Next steps</span></span>
<span data-ttu-id="00ff8-177">Altre informazioni su [Integrazione delle identità locali con Azure Active Directory](active-directory-aadconnect.md).</span><span class="sxs-lookup"><span data-stu-id="00ff8-177">Learn more about [Integrating your on-premises identities with Azure Active Directory](active-directory-aadconnect.md).</span></span>
