---
title: 'Aggiornamento di un''applicazione: serializzazione dei dati | Microsoft Docs'
description: "Procedure consigliate per la serializzazione dei dati e descrizione della sua influenza sugli aggiornamenti dell’applicazione in sequenza."
services: service-fabric
documentationcenter: .net
author: vturecek
manager: timlt
editor: 
ms.assetid: a5f36366-a2ab-4ae3-bb08-bc2f9533bc5a
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 06/29/2017
ms.author: vturecek
ms.openlocfilehash: 6aa3ac7842df4657fca7f6b4264e1c6fe52dc0c6
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 07/11/2017
---
# <a name="how-data-serialization-affects-an-application-upgrade"></a><span data-ttu-id="658df-103">Come la serializzazione dei dati influenzi l’aggiornamento di un’applicazione</span><span class="sxs-lookup"><span data-stu-id="658df-103">How data serialization affects an application upgrade</span></span>
<span data-ttu-id="658df-104">In un [aggiornamento in sequenza di un'applicazione](service-fabric-application-upgrade.md)l'aggiornamento viene applicato a un subset di nodi, procedendo con un dominio di aggiornamento per volta.</span><span class="sxs-lookup"><span data-stu-id="658df-104">In a [rolling application upgrade](service-fabric-application-upgrade.md), the upgrade is applied to a subset of nodes, one upgrade domain at a time.</span></span> <span data-ttu-id="658df-105">Durante questo processo, alcuni domini di aggiornamento si trovano con la versione dell'applicazione più recente e altri con quella meno recente.</span><span class="sxs-lookup"><span data-stu-id="658df-105">During this process, some upgrade domains are on the newer version of your application, and some upgrade domains are on the older version of your application.</span></span> <span data-ttu-id="658df-106">Nella fase di distribuzione, la versione dell'applicazione più recente deve essere in grado di leggere la versione dei dati meno recente e viceversa.</span><span class="sxs-lookup"><span data-stu-id="658df-106">During the rollout, the new version of your application must be able to read the old version of your data, and the old version of your application must be able to read the new version of your data.</span></span> <span data-ttu-id="658df-107">Se il formato dei dati non è compatibile con le versioni successive e precedenti, è possibile che l'aggiornamento abbia esito negativo o, peggio ancora, che i dati vengano persi o danneggiati.</span><span class="sxs-lookup"><span data-stu-id="658df-107">If the data format is not forward and backward compatible, the upgrade may fail, or worse, data may be lost or corrupted.</span></span> <span data-ttu-id="658df-108">Questo articolo illustra come è costituito il formato dei dati e riporta le procedure consigliate per garantire che i dati siano compatibili con le versioni successive e precedenti.</span><span class="sxs-lookup"><span data-stu-id="658df-108">This article discusses what constitutes your data format and offers best practices for ensuring that your data is forward and backward compatible.</span></span>

## <a name="what-makes-up-your-data-format"></a><span data-ttu-id="658df-109">Come è costituito il formato dei dati</span><span class="sxs-lookup"><span data-stu-id="658df-109">What makes up your data format?</span></span>
<span data-ttu-id="658df-110">In Service Fabric di Azure, i dati persistenti e replicati provengono dalle classi C#.</span><span class="sxs-lookup"><span data-stu-id="658df-110">In Azure Service Fabric, the data that is persisted and replicated comes from your C# classes.</span></span> <span data-ttu-id="658df-111">Questo vale per le applicazioni che usano [Reliable Collections](service-fabric-reliable-services-reliable-collections.md), i cui dati sono gli oggetti nei dizionari e nelle code affidabili,</span><span class="sxs-lookup"><span data-stu-id="658df-111">For applications that use [Reliable Collections](service-fabric-reliable-services-reliable-collections.md), that data is the objects in the reliable dictionaries and queues.</span></span> <span data-ttu-id="658df-112">e per le applicazioni che usano [Reliable Actors](service-fabric-reliable-actors-introduction.md), ovvero lo stato sottostante dell'attore.</span><span class="sxs-lookup"><span data-stu-id="658df-112">For applications that use [Reliable Actors](service-fabric-reliable-actors-introduction.md), that is the backing state for the actor.</span></span> <span data-ttu-id="658df-113">Queste classi C# devono essere serializzabili per essere persistenti e replicate.</span><span class="sxs-lookup"><span data-stu-id="658df-113">These C# classes must be serializable to be persisted and replicated.</span></span> <span data-ttu-id="658df-114">Il formato dei dati pertanto viene definito dai campi e dalle proprietà che vengono serializzati, nonché dal modo in cui vengono serializzati.</span><span class="sxs-lookup"><span data-stu-id="658df-114">Therefore, the data format is defined by the fields and properties that are serialized, as well as how they are serialized.</span></span> <span data-ttu-id="658df-115">In `IReliableDictionary<int, MyClass>` ad esempio i dati sono costituiti da elementi `int` e `MyClass` serializzati.</span><span class="sxs-lookup"><span data-stu-id="658df-115">For example, in an `IReliableDictionary<int, MyClass>` the data is a serialized `int` and a serialized `MyClass`.</span></span>

### <a name="code-changes-that-result-in-a-data-format-change"></a><span data-ttu-id="658df-116">Il codice modifica quel risultato trasformandolo in una modifica del formato dei dati</span><span class="sxs-lookup"><span data-stu-id="658df-116">Code changes that result in a data format change</span></span>
<span data-ttu-id="658df-117">Poiché il formato dei dati è determinato da classi C#, le modifiche delle classi possono comportare una modifica del formato dei dati.</span><span class="sxs-lookup"><span data-stu-id="658df-117">Since the data format is determined by C# classes, changes to the classes may cause a data format change.</span></span> <span data-ttu-id="658df-118">Procedere con cautela per assicurarsi che un aggiornamento in sequenza possa gestire la modifica del formato dei dati.</span><span class="sxs-lookup"><span data-stu-id="658df-118">Care must be taken to ensure that a rolling upgrade can handle the data format change.</span></span> <span data-ttu-id="658df-119">Esempi di operazioni che possono comportare modifiche del formato dei dati:</span><span class="sxs-lookup"><span data-stu-id="658df-119">Examples that may cause data format changes:</span></span>

* <span data-ttu-id="658df-120">Aggiunta o rimozione di campi o proprietà</span><span class="sxs-lookup"><span data-stu-id="658df-120">Adding or removing fields or properties</span></span>
* <span data-ttu-id="658df-121">Ridenominazione di campi o proprietà</span><span class="sxs-lookup"><span data-stu-id="658df-121">Renaming fields or properties</span></span>
* <span data-ttu-id="658df-122">Modifica dei tipi di campi o proprietà</span><span class="sxs-lookup"><span data-stu-id="658df-122">Changing the types of fields or properties</span></span>
* <span data-ttu-id="658df-123">Modifica dello spazio dei nomi o del nome di una classe</span><span class="sxs-lookup"><span data-stu-id="658df-123">Changing the class name or namespace</span></span>

### <a name="data-contract-as-the-default-serializer"></a><span data-ttu-id="658df-124">Il Contratto dati è il serializzatore predefinito</span><span class="sxs-lookup"><span data-stu-id="658df-124">Data Contract as the default serializer</span></span>
<span data-ttu-id="658df-125">Il serializzatore in genere è responsabile della lettura dei dati e della deserializzazione dei dati nella versione corrente, anche se sono in una versione precedente o *più recente* .</span><span class="sxs-lookup"><span data-stu-id="658df-125">The serializer is generally responsible for reading the data and deserializing it into the current version, even if the data is in an older or *newer* version.</span></span> <span data-ttu-id="658df-126">Il serializzatore predefinito è [DataContractSerializer](https://msdn.microsoft.com/library/ms733127.aspx), che include regole ben definite di controllo delle versioni.</span><span class="sxs-lookup"><span data-stu-id="658df-126">The default serializer is the [Data Contract serializer](https://msdn.microsoft.com/library/ms733127.aspx), which has well-defined versioning rules.</span></span> <span data-ttu-id="658df-127">Reliable Collections consente l'override del serializzatore, mentre Reliable Actors attualmente non consente questa operazione.</span><span class="sxs-lookup"><span data-stu-id="658df-127">Reliable Collections allow the serializer to be overridden, but Reliable Actors currently do not.</span></span> <span data-ttu-id="658df-128">Il serializzatore di dati svolge un ruolo importante per l'abilitazione degli aggiornamenti in sequenza.</span><span class="sxs-lookup"><span data-stu-id="658df-128">The data serializer plays an important role in enabling rolling upgrades.</span></span> <span data-ttu-id="658df-129">Data Contract Serializer è il serializzatore consigliato per le applicazioni Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="658df-129">The Data Contract serializer is the serializer that we recommend for Service Fabric applications.</span></span>

## <a name="how-the-data-format-affects-a-rolling-upgrade"></a><span data-ttu-id="658df-130">Importanza del formato dei dati nell'aggiornamento in sequenza</span><span class="sxs-lookup"><span data-stu-id="658df-130">How the data format affects a rolling upgrade</span></span>
<span data-ttu-id="658df-131">Durante un aggiornamento in sequenza esistono due scenari principali in cui è possibile che il serializzatore rilevi una versione dei dati precedente o *più recente* :</span><span class="sxs-lookup"><span data-stu-id="658df-131">During a rolling upgrade, there are two main scenarios where the serializer may encounter an older or *newer* version of your data:</span></span>

1. <span data-ttu-id="658df-132">Dopo l'aggiornamento e il riavvio di un nodo, il nuovo serializzatore caricherà sul disco i dati persistenti della versione precedente.</span><span class="sxs-lookup"><span data-stu-id="658df-132">After a node is upgraded and starts back up, the new serializer will load the data that was persisted to disk by the old version.</span></span>
2. <span data-ttu-id="658df-133">Durante l'aggiornamento in sequenza, il cluster conterrà una combinazione di versioni del codice precedenti e più recenti.</span><span class="sxs-lookup"><span data-stu-id="658df-133">During the rolling upgrade, the cluster will contain a mix of the old and new versions of your code.</span></span> <span data-ttu-id="658df-134">Poiché le repliche possono essere posizionate in domini di aggiornamento diversi, e poiché le repliche si inviano dati tra loro, è possibile che sia la versione nuova che quella precedente del serializzatore rilevi sia la nuova versione dei dati che quella precedente.</span><span class="sxs-lookup"><span data-stu-id="658df-134">Since replicas may be placed in different upgrade domains, and replicas send data to each other, the new and/or old version of your data may be encountered by the new and/or old version of your serializer.</span></span>

> [!NOTE]
> <span data-ttu-id="658df-135">Con "nuova versione" e "versione precedente" si intende la versione del codice in esecuzione.</span><span class="sxs-lookup"><span data-stu-id="658df-135">The "new version" and "old version" here refer to the version of your code that is running.</span></span> <span data-ttu-id="658df-136">Con "nuovo serializzatore" si intende il codice del serializzatore in esecuzione nella nuova versione dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="658df-136">The "new serializer" refers to the serializer code that is executing in the new version of your application.</span></span> <span data-ttu-id="658df-137">Con "nuovi dati" si intende la classe C# serializzata della nuova versione dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="658df-137">The "new data" refers to the serialized C# class from the new version of your application.</span></span>
> 
> 

<span data-ttu-id="658df-138">Le due versioni di codice e formato dei dati devono essere entrambe compatibili con le versioni successive e precedenti.</span><span class="sxs-lookup"><span data-stu-id="658df-138">The two versions of code and data format must be both forward and backward compatible.</span></span> <span data-ttu-id="658df-139">In caso contrario, è possibile che l'aggiornamento in sequenza abbia esito negativo o che si verifichi una perdita di dati.</span><span class="sxs-lookup"><span data-stu-id="658df-139">If they are not compatible, the rolling upgrade may fail or data may be lost.</span></span> <span data-ttu-id="658df-140">L'aggiornamento in sequenza può avere esito negativo perché è possibile che il codice o il serializzatore generi eccezioni o errori quando rileva l'altra versione.</span><span class="sxs-lookup"><span data-stu-id="658df-140">The rolling upgrade may fail because the code or serializer may throw exceptions or a fault when it encounters the other version.</span></span> <span data-ttu-id="658df-141">È possibile che si verifichi una perdita di dati se ad esempio è stata aggiunta una nuova proprietà ma il serializzatore precedente la ignora durante la deserializzazione.</span><span class="sxs-lookup"><span data-stu-id="658df-141">Data may be lost if, for example, a new property was added but the old serializer discards it during deserialization.</span></span>

<span data-ttu-id="658df-142">Il contratto dati è la soluzione consigliata per garantire la compatibilità dei dati.</span><span class="sxs-lookup"><span data-stu-id="658df-142">Data Contract is the recommended solution for ensuring that your data is compatible.</span></span> <span data-ttu-id="658df-143">Include regole ben definite di controllo delle versioni per l'aggiunta, la rimozione e la modifica di campi.</span><span class="sxs-lookup"><span data-stu-id="658df-143">It has well-defined versioning rules for adding, removing, and changing fields.</span></span> <span data-ttu-id="658df-144">Supporta inoltre l'eredità delle classi, la gestione dei campi sconosciuti e l'uso di hook nel processo di serializzazione e deserializzazione.</span><span class="sxs-lookup"><span data-stu-id="658df-144">It also has support for dealing with unknown fields, hooking into the serialization and deserialization process, and dealing with class inheritance.</span></span> <span data-ttu-id="658df-145">Per altre informazioni, vedere [Utilizzo di contratti dati](https://msdn.microsoft.com/library/ms733127.aspx).</span><span class="sxs-lookup"><span data-stu-id="658df-145">For more information, see [Using Data Contract](https://msdn.microsoft.com/library/ms733127.aspx).</span></span>

## <a name="next-steps"></a><span data-ttu-id="658df-146">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="658df-146">Next steps</span></span>
<span data-ttu-id="658df-147">[Esercitazione sull'aggiornamento di un'applicazione di Service Fabric tramite Visual Studio](service-fabric-application-upgrade-tutorial.md) descrive la procedura di aggiornamento di un'applicazione con Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="658df-147">[Upgrading your Application Using Visual Studio](service-fabric-application-upgrade-tutorial.md) walks you through an application upgrade using Visual Studio.</span></span>

<span data-ttu-id="658df-148">[Aggiornamento di un'applicazione di Service Fabric mediante PowerShell](service-fabric-application-upgrade-tutorial-powershell.md) descrive la procedura di aggiornamento di un'applicazione tramite PowerShell.</span><span class="sxs-lookup"><span data-stu-id="658df-148">[Upgrading your Application Using Powershell](service-fabric-application-upgrade-tutorial-powershell.md) walks you through an application upgrade using PowerShell.</span></span>

<span data-ttu-id="658df-149">Controllare l’aggiornamento dell'applicazione tramite [Parametri di aggiornamento](service-fabric-application-upgrade-parameters.md).</span><span class="sxs-lookup"><span data-stu-id="658df-149">Control how your application upgrades by using [Upgrade Parameters](service-fabric-application-upgrade-parameters.md).</span></span>

<span data-ttu-id="658df-150">Informazioni su come usare funzionalità avanzate durante l'aggiornamento dell'applicazione facendo riferimento ad [Argomenti avanzati](service-fabric-application-upgrade-advanced.md).</span><span class="sxs-lookup"><span data-stu-id="658df-150">Learn how to use advanced functionality while upgrading your application by referring to [Advanced Topics](service-fabric-application-upgrade-advanced.md).</span></span>

<span data-ttu-id="658df-151">Risolvere problemi comuni negli aggiornamenti dell'applicazione facendo riferimento ai passaggi elencati in [Risoluzione dei problemi relativi agli aggiornamenti dell'applicazione ](service-fabric-application-upgrade-troubleshooting.md).</span><span class="sxs-lookup"><span data-stu-id="658df-151">Fix common problems in application upgrades by referring to the steps in [Troubleshooting Application Upgrades ](service-fabric-application-upgrade-troubleshooting.md).</span></span>

