---
title: 'Azure AD Connect: Eseguire l''aggiornamento da una versione precedente | Documentazione Microsoft'
description: "Illustra i diversi metodi per eseguire l'aggiornamento alla versione più recente di Azure Active Directory Connect, tra cui l'aggiornamento sul posto e la migrazione swing."
services: active-directory
documentationcenter: 
author: AndKjell
manager: femila
editor: 
ms.assetid: 31f084d8-2b89-478c-9079-76cf92e6618f
ms.service: active-directory
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: Identity
ms.date: 07/12/2017
ms.author: billmath
ms.openlocfilehash: 52fd9375c71c42feaf87f4a0f4220e1cb3889e63
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/03/2017
---
# <a name="azure-ad-connect-upgrade-from-a-previous-version-to-the-latest"></a><span data-ttu-id="9ab94-103">Azure AD Connect: Eseguire l'aggiornamento da una versione precedente alla versione più recente</span><span class="sxs-lookup"><span data-stu-id="9ab94-103">Azure AD Connect: Upgrade from a previous version to the latest</span></span>
<span data-ttu-id="9ab94-104">Questo argomento descrive i diversi metodi che è possibile usare per aggiornare l'installazione di Azure Active Directory (Azure AD) Connect alla versione più recente.</span><span class="sxs-lookup"><span data-stu-id="9ab94-104">This topic describes the different methods that you can use to upgrade your Azure Active Directory (Azure AD) Connect installation to the latest release.</span></span> <span data-ttu-id="9ab94-105">È consigliabile mantenersi sempre al passo con le versioni di Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="9ab94-105">We recommend that you keep yourself current with the releases of Azure AD Connect.</span></span> <span data-ttu-id="9ab94-106">È anche possibile usare le procedure illustrate nella sezione [Migrazione swing](#swing-migration), che consentono di apportare modifiche significative alla configurazione.</span><span class="sxs-lookup"><span data-stu-id="9ab94-106">You also use the steps in the [Swing migration](#swing-migration) section when you make a substantial configuration change.</span></span>

<span data-ttu-id="9ab94-107">Se si vuole eseguire l'aggiornamento da DirSync, vedere invece l'argomento relativo all'[aggiornamento dallo strumento di sincronizzazione di Azure AD (DirSync)](active-directory-aadconnect-dirsync-upgrade-get-started.md) .</span><span class="sxs-lookup"><span data-stu-id="9ab94-107">If you want to upgrade from DirSync, see [Upgrade from Azure AD sync tool (DirSync)](active-directory-aadconnect-dirsync-upgrade-get-started.md) instead.</span></span>

<span data-ttu-id="9ab94-108">Esistono diverse strategie per eseguire l'aggiornamento di Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="9ab94-108">There are a few different strategies that you can use to upgrade Azure AD Connect.</span></span>

| <span data-ttu-id="9ab94-109">Metodo</span><span class="sxs-lookup"><span data-stu-id="9ab94-109">Method</span></span> | <span data-ttu-id="9ab94-110">Descrizione</span><span class="sxs-lookup"><span data-stu-id="9ab94-110">Description</span></span> |
| --- | --- |
| [<span data-ttu-id="9ab94-111">Aggiornamento automatico</span><span class="sxs-lookup"><span data-stu-id="9ab94-111">Automatic upgrade</span></span>](active-directory-aadconnect-feature-automatic-upgrade.md) |<span data-ttu-id="9ab94-112">Si tratta del metodo più semplice per i clienti con installazione rapida.</span><span class="sxs-lookup"><span data-stu-id="9ab94-112">This is the easiest method for customers with an express installation.</span></span> |
| [<span data-ttu-id="9ab94-113">Aggiornamento sul posto</span><span class="sxs-lookup"><span data-stu-id="9ab94-113">In-place upgrade</span></span>](#in-place-upgrade) |<span data-ttu-id="9ab94-114">Se si ha un singolo server, è possibile eseguire un aggiornamento sul posto dell'installazione nello stesso server.</span><span class="sxs-lookup"><span data-stu-id="9ab94-114">If you have a single server, you can upgrade the installation in-place on the same server.</span></span> |
| [<span data-ttu-id="9ab94-115">Migrazione swing</span><span class="sxs-lookup"><span data-stu-id="9ab94-115">Swing migration</span></span>](#swing-migration) |<span data-ttu-id="9ab94-116">Se si usano due server, è possibile preparare uno dei due con la nuova versione o configurazione e, quando si è pronti, modificare il server attivo.</span><span class="sxs-lookup"><span data-stu-id="9ab94-116">With two servers, you can prepare one of the servers with the new release or configuration, and change the active server when you're ready.</span></span> |

<span data-ttu-id="9ab94-117">Per informazioni sulle autorizzazioni, vedere le [autorizzazioni necessarie per un aggiornamento](active-directory-aadconnect-accounts-permissions.md#upgrade).</span><span class="sxs-lookup"><span data-stu-id="9ab94-117">For permissions information, see the [permissions required for an upgrade](active-directory-aadconnect-accounts-permissions.md#upgrade).</span></span>

> [!NOTE]
> <span data-ttu-id="9ab94-118">Dopo avere consentito al nuovo server Azure AD Connect di avviare la sincronizzazione delle modifiche ad Azure AD, non si deve più usare DirSync o Azure AD Sync.</span><span class="sxs-lookup"><span data-stu-id="9ab94-118">After you've enabled your new Azure AD Connect server to start synchronizing changes to Azure AD, you must not roll back to using DirSync or Azure AD Sync.</span></span> <span data-ttu-id="9ab94-119">Il downgrade da Azure AD Connect ai client legacy, inclusi DirSync e Azure AD Sync, non è supportato e può causare problemi come la perdita di dati in Azure AD.</span><span class="sxs-lookup"><span data-stu-id="9ab94-119">Downgrading from Azure AD Connect to legacy clients, including DirSync and Azure AD Sync, isn't supported and can lead to issues such as data loss in Azure AD.</span></span>

## <a name="in-place-upgrade"></a><span data-ttu-id="9ab94-120">Aggiornamento sul posto</span><span class="sxs-lookup"><span data-stu-id="9ab94-120">In-place upgrade</span></span>
<span data-ttu-id="9ab94-121">Un aggiornamento sul posto è indicato per il passaggio da Azure AD Sync o Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="9ab94-121">An in-place upgrade works for moving from Azure AD Sync or Azure AD Connect.</span></span> <span data-ttu-id="9ab94-122">Non è possibile usarlo per lo spostamento da DirSync o per una soluzione con Forefront Identity Manager (FIM) e Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="9ab94-122">It doesn't work for moving from DirSync or for a solution with Forefront Identity Manager (FIM) + Azure AD Connector.</span></span>

<span data-ttu-id="9ab94-123">Questo metodo è preferibile quando sono presenti un singolo server e meno di 100.000 oggetti.</span><span class="sxs-lookup"><span data-stu-id="9ab94-123">This method is preferred when you have a single server and less than about 100,000 objects.</span></span> <span data-ttu-id="9ab94-124">Se sono state apportate modifiche alle regole di sincronizzazione predefinite, vengono eseguite un'importazione e una sincronizzazione complete.</span><span class="sxs-lookup"><span data-stu-id="9ab94-124">If there are any changes to the out-of-box sync rules, a full import and full synchronization occur after the upgrade.</span></span> <span data-ttu-id="9ab94-125">Questo metodo si assicura che la nuova configurazione venga applicata a tutti gli oggetti presenti nel sistema.</span><span class="sxs-lookup"><span data-stu-id="9ab94-125">This method ensures that the new configuration is applied to all existing objects in the system.</span></span> <span data-ttu-id="9ab94-126">L'esecuzione può richiedere alcune ore, a seconda del numero di oggetti nell'ambito del motore di sincronizzazione.</span><span class="sxs-lookup"><span data-stu-id="9ab94-126">This run might take a few hours, depending on the number of objects that are in scope of the sync engine.</span></span> <span data-ttu-id="9ab94-127">Viene sospesa la normale sincronizzazione differenziale pianificata, per impostazione predefinita ogni 30 minuti, mentre continua la sincronizzazione delle password.</span><span class="sxs-lookup"><span data-stu-id="9ab94-127">The normal delta synchronization scheduler (which synchronizes every 30 minutes by default) is suspended, but password synchronization continues.</span></span> <span data-ttu-id="9ab94-128">È consigliabile eseguire l'aggiornamento sul posto durante il fine settimana.</span><span class="sxs-lookup"><span data-stu-id="9ab94-128">You might consider doing the in-place upgrade during a weekend.</span></span> <span data-ttu-id="9ab94-129">Se sono state apportate modifiche alla configurazione predefinita con la nuova versione di Azure AD Connect, verrà avviata un'importazione/una sincronizzazione differenziale normale.</span><span class="sxs-lookup"><span data-stu-id="9ab94-129">If there are no changes to the out-of-box configuration with the new Azure AD Connect release, then a normal delta import/sync starts instead.</span></span>  
![Aggiornamento sul posto](./media/active-directory-aadconnect-upgrade-previous-version/inplaceupgrade.png)

<span data-ttu-id="9ab94-131">Se sono state apportate modifiche alle regole di sincronizzazione predefinite, queste regole verranno reimpostate sui valori predefiniti della configurazione al momento dell'aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="9ab94-131">If you've made changes to the out-of-box synchronization rules, then these rules are set back to the default configuration on upgrade.</span></span> <span data-ttu-id="9ab94-132">Per assicurarsi che la configurazione venga mantenuta tra un aggiornamento e l'altro, verificare che le modifiche vengano apportate come descritto in [Procedure consigliate per modificare la configurazione predefinita](active-directory-aadconnectsync-best-practices-changing-default-configuration.md).</span><span class="sxs-lookup"><span data-stu-id="9ab94-132">To make sure that your configuration is kept between upgrades, make sure that you make changes as they're described in [Best practices for changing the default configuration](active-directory-aadconnectsync-best-practices-changing-default-configuration.md).</span></span>

<span data-ttu-id="9ab94-133">Durante l'aggiornamento sul posto, è possibile che vengano introdotte modifiche che richiedono l'esecuzione di specifiche attività di sincronizzazione (ad esempio, i passaggi di importazione completa e di sincronizzazione completa) al termine dell'aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="9ab94-133">During in-place upgrade, there may be changes introduced that require specific synchronization activities (including Full Import step and Full Synchronization step) to be executed after upgrade completes.</span></span> <span data-ttu-id="9ab94-134">Per rinviare queste attività, fare riferimento alla sezione [Come rinviare la sincronizzazione completa dopo l'aggiornamento](#how-to-defer-full-synchronization-after-upgrade).</span><span class="sxs-lookup"><span data-stu-id="9ab94-134">To defer such activities, refer to section [How to defer full synchronization after upgrade](#how-to-defer-full-synchronization-after-upgrade).</span></span>

## <a name="swing-migration"></a><span data-ttu-id="9ab94-135">Migrazione swing</span><span class="sxs-lookup"><span data-stu-id="9ab94-135">Swing migration</span></span>
<span data-ttu-id="9ab94-136">Se è presente una distribuzione complessa o molti oggetti, può essere impraticabile eseguire un aggiornamento sul posto nel sistema attivo.</span><span class="sxs-lookup"><span data-stu-id="9ab94-136">If you have a complex deployment or many objects, it might be impractical to do an in-place upgrade on the live system.</span></span> <span data-ttu-id="9ab94-137">Per alcuni clienti questa procedura potrebbe richiedere più giorni, durante i quali non verranno elaborate modifiche differenziali.</span><span class="sxs-lookup"><span data-stu-id="9ab94-137">For some customers, this process might take multiple days--and during this time, no delta changes are processed.</span></span> <span data-ttu-id="9ab94-138">È possibile usare questo metodo anche quando si pianificano modifiche sostanziali della configurazione e si vogliono provare tali modifiche prima di effettuarne il push nel cloud.</span><span class="sxs-lookup"><span data-stu-id="9ab94-138">You can also use this method when you plan to make substantial changes to your configuration and you want to try them out before they're pushed to the cloud.</span></span>

<span data-ttu-id="9ab94-139">Il metodo consigliato per questi scenari è una migrazione swing.</span><span class="sxs-lookup"><span data-stu-id="9ab94-139">The recommended method for these scenarios is to use a swing migration.</span></span> <span data-ttu-id="9ab94-140">Sono necessari almeno due server, uno attivo e uno di staging.</span><span class="sxs-lookup"><span data-stu-id="9ab94-140">You need (at least) two servers--one active server and one staging server.</span></span> <span data-ttu-id="9ab94-141">Il server attivo (linee blu continue nell'immagine seguente) è responsabile del carico di produzione attivo.</span><span class="sxs-lookup"><span data-stu-id="9ab94-141">The active server (shown with solid blue lines in the following picture) is responsible for the active production load.</span></span> <span data-ttu-id="9ab94-142">Il server di staging (linee tratteggiate viola) viene preparato con la nuova versione o configurazione.</span><span class="sxs-lookup"><span data-stu-id="9ab94-142">The staging server (shown with dashed purple lines) is prepared with the new release or configuration.</span></span> <span data-ttu-id="9ab94-143">Quando la preparazione è completa, il server viene reso attivo.</span><span class="sxs-lookup"><span data-stu-id="9ab94-143">When it's fully ready, this server is made active.</span></span> <span data-ttu-id="9ab94-144">Il server precedentemente attivo, su cui ora è installata la versione o configurazione precedente, diventa il server di staging e viene aggiornato.</span><span class="sxs-lookup"><span data-stu-id="9ab94-144">The previous active server, which now has the old version or configuration installed, is made into the staging server and is upgraded.</span></span>

<span data-ttu-id="9ab94-145">I due server possono usare versioni diverse.</span><span class="sxs-lookup"><span data-stu-id="9ab94-145">The two servers can use different versions.</span></span> <span data-ttu-id="9ab94-146">Ad esempio, il server attivo per il quale è stata pianificata la rimozione delle autorizzazioni può usare Azure AD Sync, mentre il nuovo server di staging può usare Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="9ab94-146">For example, the active server that you plan to decommission can use Azure AD Sync, and the new staging server can use Azure AD Connect.</span></span> <span data-ttu-id="9ab94-147">Se si usa la migrazione swing per sviluppare una nuova configurazione, è consigliabile usare la stessa versione sui due server.</span><span class="sxs-lookup"><span data-stu-id="9ab94-147">If you use swing migration to develop a new configuration, it's a good idea to have the same versions on the two servers.</span></span>  
![server di gestione temporanea](./media/active-directory-aadconnect-upgrade-previous-version/stagingserver1.png)

> [!NOTE]
> <span data-ttu-id="9ab94-149">Alcuni clienti preferiscono avere tre o quattro server per questo scenario.</span><span class="sxs-lookup"><span data-stu-id="9ab94-149">Some customers prefer to have three or four servers for this scenario.</span></span> <span data-ttu-id="9ab94-150">Quando il server di staging viene aggiornato, in caso di [ripristino di emergenza](active-directory-aadconnectsync-operations.md#disaster-recovery) non è disponibile un server di backup.</span><span class="sxs-lookup"><span data-stu-id="9ab94-150">When the staging server is upgraded, you don't have a backup server for [disaster recovery](active-directory-aadconnectsync-operations.md#disaster-recovery).</span></span> <span data-ttu-id="9ab94-151">Con tre o quattro server è possibile preparare un set di server primari o di standby con la nuova versione, per assicurare che sia sempre presente un server di staging pronto a sostituire il server attivo.</span><span class="sxs-lookup"><span data-stu-id="9ab94-151">With three or four servers, you can prepare one set of primary/standby servers with the new version, which ensures that there is always a staging server that's ready to take over.</span></span>

<span data-ttu-id="9ab94-152">Questa procedura è indicata anche per il passaggio da Azure AD Sync o da una soluzione con FIM e Azure AD Connector.</span><span class="sxs-lookup"><span data-stu-id="9ab94-152">These steps also work to move from Azure AD Sync or a solution with FIM + Azure AD Connector.</span></span> <span data-ttu-id="9ab94-153">Questa procedura non è indicata per DirSync, ma nell'argomento [Aggiornare il servizio di sincronizzazione di Microsoft Azure Active Directory (DirSync)](active-directory-aadconnect-dirsync-upgrade-get-started.md) è disponibile lo stesso metodo con migrazione swing, chiamato anche distribuzione parallela, con i passaggi per DirSync.</span><span class="sxs-lookup"><span data-stu-id="9ab94-153">These steps don't work for DirSync, but the same swing migration method (also called parallel deployment) with steps for DirSync is in [Upgrade Azure Active Directory sync (DirSync)](active-directory-aadconnect-dirsync-upgrade-get-started.md).</span></span>

### <a name="use-a-swing-migration-to-upgrade"></a><span data-ttu-id="9ab94-154">Usare una migrazione swing per l'aggiornamento</span><span class="sxs-lookup"><span data-stu-id="9ab94-154">Use a swing migration to upgrade</span></span>
1. <span data-ttu-id="9ab94-155">Se si usa Azure AD Connect in entrambi i server e si pianifica di eseguire soltanto una modifica della configurazione, assicurarsi che il server attivo e il server di staging usino entrambi la stessa versione.</span><span class="sxs-lookup"><span data-stu-id="9ab94-155">If you use Azure AD Connect on both servers and plan to only make a configuration change, make sure that your active server and staging server are both using the same version.</span></span> <span data-ttu-id="9ab94-156">Questo accorgimento rende più facile un successivo confronto delle differenze.</span><span class="sxs-lookup"><span data-stu-id="9ab94-156">That makes it easier to compare differences later.</span></span> <span data-ttu-id="9ab94-157">Se si esegue l'aggiornamento da Azure AD Sync, questi server hanno versioni diverse.</span><span class="sxs-lookup"><span data-stu-id="9ab94-157">If you're upgrading from Azure AD Sync, then these servers have different versions.</span></span> <span data-ttu-id="9ab94-158">Se si esegue l'aggiornamento da una versione precedente di Azure AD Connect, è consigliabile che i due server usino la stessa versione. Non si tratta tuttavia di un requisito obbligatorio.</span><span class="sxs-lookup"><span data-stu-id="9ab94-158">If you're upgrading from an older version of Azure AD Connect, it's a good idea to start with the two servers that are using the same version, but it's not required.</span></span>
2. <span data-ttu-id="9ab94-159">Se è stata eseguita una configurazione personalizzata che non è presente nel server di staging, seguire la procedura descritta in [Spostare la configurazione personalizzata dal server attivo al server di staging](#move-custom-configuration-from-active-to-staging-server).</span><span class="sxs-lookup"><span data-stu-id="9ab94-159">If you've made a custom configuration and your staging server doesn't have it, follow the steps under [Move a custom configuration from the active server to the staging server](#move-custom-configuration-from-active-to-staging-server).</span></span>
3. <span data-ttu-id="9ab94-160">Se si esegue l'aggiornamento da una versione precedente di Azure AD Connect, aggiornare il server di staging alla versione più recente.</span><span class="sxs-lookup"><span data-stu-id="9ab94-160">If you're upgrading from an earlier release of Azure AD Connect, upgrade the staging server to the latest version.</span></span> <span data-ttu-id="9ab94-161">Se si esegue lo spostamento da Azure AD Sync, installare Azure AD Connect nel server di staging.</span><span class="sxs-lookup"><span data-stu-id="9ab94-161">If you're moving from Azure AD Sync, then install Azure AD Connect on your staging server.</span></span>
4. <span data-ttu-id="9ab94-162">Consentire al motore di sincronizzazione di eseguire un'importazione completa e una sincronizzazione completa nel server di gestione temporanea.</span><span class="sxs-lookup"><span data-stu-id="9ab94-162">Let the sync engine run full import and full synchronization on your staging server.</span></span>
5. <span data-ttu-id="9ab94-163">Verificare che la nuova configurazione non abbia causato modifiche impreviste seguendo la procedura descritta nella sezione "Verificare" in [Verificare la configurazione di un server](active-directory-aadconnectsync-operations.md#verify-the-configuration-of-a-server).</span><span class="sxs-lookup"><span data-stu-id="9ab94-163">Verify that the new configuration didn't cause any unexpected changes by using the steps under "Verify" in [Verify the configuration of a server](active-directory-aadconnectsync-operations.md#verify-the-configuration-of-a-server).</span></span> <span data-ttu-id="9ab94-164">In caso di imprevisti, correggere la configurazione, eseguire l'importazione e la sincronizzazione, quindi verificare i dati fino a ottenere il risultato necessario, seguendo la procedura.</span><span class="sxs-lookup"><span data-stu-id="9ab94-164">If something isn't as expected, correct it, run the import and sync, and verify the data until it looks good, by following the steps.</span></span>
6. <span data-ttu-id="9ab94-165">Impostare il server di gestione temporanea come server attivo.</span><span class="sxs-lookup"><span data-stu-id="9ab94-165">Switch the staging server to be the active server.</span></span> <span data-ttu-id="9ab94-166">Questo è il passaggio finale, dal titolo "Cambiare il server attivo", di [Verificare la configurazione di un server](active-directory-aadconnectsync-operations.md#verify-the-configuration-of-a-server).</span><span class="sxs-lookup"><span data-stu-id="9ab94-166">This is the final step "Switch active server" in [Verify the configuration of a server](active-directory-aadconnectsync-operations.md#verify-the-configuration-of-a-server).</span></span>
7. <span data-ttu-id="9ab94-167">Se si esegue l'aggiornamento di Azure AD Connect, eseguire ora l'aggiornamento del server in modalità di staging alla versione più recente.</span><span class="sxs-lookup"><span data-stu-id="9ab94-167">If you're upgrading Azure AD Connect, upgrade the server that's now in staging mode to the latest release.</span></span> <span data-ttu-id="9ab94-168">Seguire gli stessi passaggi descritti in precedenza per aggiornare i dati e la configurazione.</span><span class="sxs-lookup"><span data-stu-id="9ab94-168">Follow the same steps as before to get the data and configuration upgraded.</span></span> <span data-ttu-id="9ab94-169">Se si esegue l'aggiornamento da Azure AD Sync, è possibile disattivare e rimuovere le autorizzazioni dal server precedente.</span><span class="sxs-lookup"><span data-stu-id="9ab94-169">If you upgraded from Azure AD Sync, you can now turn off and decommission your old server.</span></span>

### <a name="move-a-custom-configuration-from-the-active-server-to-the-staging-server"></a><span data-ttu-id="9ab94-170">Spostare una configurazione personalizzata dal server attivo al server di staging</span><span class="sxs-lookup"><span data-stu-id="9ab94-170">Move a custom configuration from the active server to the staging server</span></span>
<span data-ttu-id="9ab94-171">Se sono state apportate modifiche di configurazione al server attivo, è necessario assicurarsi che le stesse modifiche vengano applicate al server di staging.</span><span class="sxs-lookup"><span data-stu-id="9ab94-171">If you've made configuration changes to the active server, you need to make sure that the same changes are applied to the staging server.</span></span> <span data-ttu-id="9ab94-172">Per facilitare lo spostamento, è possibile usare l'[analizzatore di configurazione Azure AD Connect](https://github.com/Microsoft/AADConnectConfigDocumenter).</span><span class="sxs-lookup"><span data-stu-id="9ab94-172">To help with this move, you can use the [Azure AD Connect configuration documenter](https://github.com/Microsoft/AADConnectConfigDocumenter).</span></span>

<span data-ttu-id="9ab94-173">È possibile spostare le regole di sincronizzazione personalizzate create usando PowerShell.</span><span class="sxs-lookup"><span data-stu-id="9ab94-173">You can move the custom sync rules that you've created by using PowerShell.</span></span> <span data-ttu-id="9ab94-174">È necessario applicare altre modifiche allo stesso modo in entrambi i sistemi e non è possibile eseguire la migrazione delle modifiche.</span><span class="sxs-lookup"><span data-stu-id="9ab94-174">You must apply other changes the same way on both systems, and you can't migrate the changes.</span></span> <span data-ttu-id="9ab94-175">L'[analizzatore di configurazione](https://github.com/Microsoft/AADConnectConfigDocumenter) consente di confrontare i due sistemi per assicurarsi che siano identici.</span><span class="sxs-lookup"><span data-stu-id="9ab94-175">The [configuration documenter](https://github.com/Microsoft/AADConnectConfigDocumenter) can help you comparing the two systems to make sure they are identical.</span></span> <span data-ttu-id="9ab94-176">Lo strumento è anche utile per automatizzare la procedura illustrata in questa sezione.</span><span class="sxs-lookup"><span data-stu-id="9ab94-176">The tool can also help in automating the steps found in this section.</span></span>

<span data-ttu-id="9ab94-177">È necessario configurare gli elementi seguenti nello stesso modo in entrambi i server:</span><span class="sxs-lookup"><span data-stu-id="9ab94-177">You need to configure the following things the same way on both servers:</span></span>

* <span data-ttu-id="9ab94-178">Connessione alle stesse foreste</span><span class="sxs-lookup"><span data-stu-id="9ab94-178">Connection to the same forests</span></span>
* <span data-ttu-id="9ab94-179">Domini e filtri unità organizzativa</span><span class="sxs-lookup"><span data-stu-id="9ab94-179">Any domain and OU filtering</span></span>
* <span data-ttu-id="9ab94-180">Stesse funzionalità facoltative, come la sincronizzazione e il writeback delle password</span><span class="sxs-lookup"><span data-stu-id="9ab94-180">The same optional features, such as password sync and password writeback</span></span>

<span data-ttu-id="9ab94-181">**Spostare le regole di sincronizzazione personalizzate**</span><span class="sxs-lookup"><span data-stu-id="9ab94-181">**Move custom synchronization rules**</span></span>  
<span data-ttu-id="9ab94-182">Per spostare le regole di sincronizzazione personalizzate, seguire questa procedura:</span><span class="sxs-lookup"><span data-stu-id="9ab94-182">To move custom synchronization rules, do the following:</span></span>

1. <span data-ttu-id="9ab94-183">Aprire l' **editor delle regole di sincronizzazione** nel server attivo.</span><span class="sxs-lookup"><span data-stu-id="9ab94-183">Open **Synchronization Rules Editor** on your active server.</span></span>
2. <span data-ttu-id="9ab94-184">Selezionare una regola personalizzata.</span><span class="sxs-lookup"><span data-stu-id="9ab94-184">Select a custom rule.</span></span> <span data-ttu-id="9ab94-185">Fare clic su **Esporta**.</span><span class="sxs-lookup"><span data-stu-id="9ab94-185">Click **Export**.</span></span> <span data-ttu-id="9ab94-186">Viene visualizzata una finestra del Blocco note.</span><span class="sxs-lookup"><span data-stu-id="9ab94-186">This brings up a Notepad window.</span></span> <span data-ttu-id="9ab94-187">Salvare il file temporaneo con estensione ps1.</span><span class="sxs-lookup"><span data-stu-id="9ab94-187">Save the temporary file with a PS1 extension.</span></span> <span data-ttu-id="9ab94-188">In questo modo diventa uno script PowerShell.</span><span class="sxs-lookup"><span data-stu-id="9ab94-188">This makes it a PowerShell script.</span></span> <span data-ttu-id="9ab94-189">Copiare il file con estensione PS1 nel server di staging.</span><span class="sxs-lookup"><span data-stu-id="9ab94-189">Copy the PS1 file to the staging server.</span></span>  
   <span data-ttu-id="9ab94-190">![Esportazione delle regole di sincronizzazione](./media/active-directory-aadconnect-upgrade-previous-version/exportrule.png)</span><span class="sxs-lookup"><span data-stu-id="9ab94-190">![Sync rule export](./media/active-directory-aadconnect-upgrade-previous-version/exportrule.png)</span></span>
3. <span data-ttu-id="9ab94-191">Il GUID del connettore è diverso nel server di staging e deve essere modificato.</span><span class="sxs-lookup"><span data-stu-id="9ab94-191">The Connector GUID is different on the staging server, and you must change it.</span></span> <span data-ttu-id="9ab94-192">Per ottenere il GUID, avviare l'**editor di sincronizzazione delle regole**, selezionare una delle regole predefinite che rappresentano lo stesso sistema connesso e fare clic sul pulsante per l'**esportazione**.</span><span class="sxs-lookup"><span data-stu-id="9ab94-192">To get the GUID, start **Synchronization Rules Editor**, select one of the out-of-box rules that represent the same connected system, and click **Export**.</span></span> <span data-ttu-id="9ab94-193">Sostituire il GUID nel file con estensione ps1 con il GUID del server di gestione temporanea.</span><span class="sxs-lookup"><span data-stu-id="9ab94-193">Replace the GUID in your PS1 file with the GUID from the staging server.</span></span>
4. <span data-ttu-id="9ab94-194">In un prompt dei comandi di PowerShell eseguire il file con estensione ps1.</span><span class="sxs-lookup"><span data-stu-id="9ab94-194">In a PowerShell prompt, run the PS1 file.</span></span> <span data-ttu-id="9ab94-195">In questo modo viene creata la regola di sincronizzazione personalizzata nel server di staging.</span><span class="sxs-lookup"><span data-stu-id="9ab94-195">This creates the custom synchronization rule on the staging server.</span></span>
5. <span data-ttu-id="9ab94-196">Ripetere la procedura per tutte le regole personalizzate.</span><span class="sxs-lookup"><span data-stu-id="9ab94-196">Repeat this for all your custom rules.</span></span>

## <a name="how-to-defer-full-synchronization-after-upgrade"></a><span data-ttu-id="9ab94-197">Come rinviare la sincronizzazione completa dopo l'aggiornamento</span><span class="sxs-lookup"><span data-stu-id="9ab94-197">How to defer full synchronization after upgrade</span></span>
<span data-ttu-id="9ab94-198">Durante l'aggiornamento sul posto, è possibile che vengano introdotte modifiche che richiedono l'esecuzione di specifiche attività di sincronizzazione (ad esempio, i passaggi di importazione completa e di sincronizzazione completa).</span><span class="sxs-lookup"><span data-stu-id="9ab94-198">During in-place upgrade, there may be changes introduced that require specific synchronization activities (including Full Import step and Full Synchronization step) to be executed.</span></span> <span data-ttu-id="9ab94-199">In caso di modifiche allo schema del connettore, ad esempio, è necessario eseguire sui connettori interessati l'**importazione completa**, mentre in caso di modifiche alle regole di sincronizzazione è necessario eseguire la **sincronizzazione completa**.</span><span class="sxs-lookup"><span data-stu-id="9ab94-199">For example, connector schema changes require **full import** step and out-of-box synchronization rule changes require **full synchronization** step to be executed on affected connectors.</span></span> <span data-ttu-id="9ab94-200">Durante l'aggiornamento, Azure AD Connect determina le attività di sincronizzazione necessarie e le registra come *sostituzioni*.</span><span class="sxs-lookup"><span data-stu-id="9ab94-200">During upgrade, Azure AD Connect determines what synchronization activities are required and records them as *overrides*.</span></span> <span data-ttu-id="9ab94-201">Nel ciclo di sincronizzazione successivo, l'utilità di pianificazione della sincronizzazione preleva queste sostituzioni e le esegue.</span><span class="sxs-lookup"><span data-stu-id="9ab94-201">In the following synchronization cycle, the synchronization scheduler picks up these overrides and executes them.</span></span> <span data-ttu-id="9ab94-202">Dopo essere state eseguite, le sostituzioni vengono rimosse.</span><span class="sxs-lookup"><span data-stu-id="9ab94-202">Once an override is successfully executed, it is removed.</span></span>

<span data-ttu-id="9ab94-203">È possibile che, in alcuni casi, si preferisca non eseguire queste sostituzioni subito dopo l'aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="9ab94-203">There may be situations where you do not want these overrides to take place immediately after upgrade.</span></span> <span data-ttu-id="9ab94-204">In presenza di numerosi oggetti sincronizzati, ad esempio, può essere opportuno eseguire la procedura di sincronizzazione dopo l'orario lavorativo.</span><span class="sxs-lookup"><span data-stu-id="9ab94-204">For example, you have numerous synchronized objects and you would like these synchronization steps to occur after business hours.</span></span> <span data-ttu-id="9ab94-205">Per rimuovere queste sostituzioni:</span><span class="sxs-lookup"><span data-stu-id="9ab94-205">To remove these overrides:</span></span>

1. <span data-ttu-id="9ab94-206">Durante l'aggiornamento, **deselezionare** l'opzione **Avvia il processo di sincronizzazione al termine della configurazione**.</span><span class="sxs-lookup"><span data-stu-id="9ab94-206">During upgrade, **uncheck** the option **Start the synchronization process when configuration completes**.</span></span> <span data-ttu-id="9ab94-207">In questo modo si disabilita l'utilità di pianificazione della sincronizzazione e si impedisce l'esecuzione automatica del ciclo di sincronizzazione prima che vengano rimosse le sostituzioni.</span><span class="sxs-lookup"><span data-stu-id="9ab94-207">This disables the synchronization scheduler and prevents synchronization cycle from taking place automatically before the overrides are removed.</span></span>

   ![DisableFullSyncAfterUpgrade](./media/active-directory-aadconnect-upgrade-previous-version/disablefullsync01.png)

2. <span data-ttu-id="9ab94-209">Al termine dell'aggiornamento, eseguire il cmdlet seguente per scoprire quali sostituzioni sono state aggiunte: `Get-ADSyncSchedulerConnectorOverride | fl`</span><span class="sxs-lookup"><span data-stu-id="9ab94-209">After upgrade completes, run the following cmdlet to find out what overrides have been added: `Get-ADSyncSchedulerConnectorOverride | fl`</span></span>

   >[!NOTE]
   > <span data-ttu-id="9ab94-210">Le sostituzioni sono specifiche di ogni connettore.</span><span class="sxs-lookup"><span data-stu-id="9ab94-210">The overrides are connector-specific.</span></span> <span data-ttu-id="9ab94-211">Nell'esempio seguente, i passaggi di importazione completa e sincronizzazione completa sono stati aggiunti sia al connettore di Active Directory locale sia al connettore di Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="9ab94-211">In the following example, Full Import step and Full Synchronization step have been added to both the on-premises AD Connector and Azure AD Connector.</span></span>

   ![DisableFullSyncAfterUpgrade](./media/active-directory-aadconnect-upgrade-previous-version/disablefullsync02.png)

3. <span data-ttu-id="9ab94-213">Annotare le sostituzioni esistenti che sono state aggiunte.</span><span class="sxs-lookup"><span data-stu-id="9ab94-213">Note down the existing overrides that have been added.</span></span>
   
4. <span data-ttu-id="9ab94-214">Per rimuovere le sostituzioni per l'importazione completa e per la sincronizzazione completa in un connettore arbitrario, eseguire il cmdlet seguente: `Set-ADSyncSchedulerConnectorOverride -ConnectorIdentifier <Guid-of-ConnectorIdentifier> -FullImportRequired $false -FullSyncRequired $false`</span><span class="sxs-lookup"><span data-stu-id="9ab94-214">To remove the overrides for both full import and full synchronization on an arbitrary connector, run the following cmdlet: `Set-ADSyncSchedulerConnectorOverride -ConnectorIdentifier <Guid-of-ConnectorIdentifier> -FullImportRequired $false -FullSyncRequired $false`</span></span>

   <span data-ttu-id="9ab94-215">Per rimuovere le sostituzioni in tutti i connettori, eseguire lo script PowerShell seguente:</span><span class="sxs-lookup"><span data-stu-id="9ab94-215">To remove the overrides on all connectors, execute the following PowerShell script:</span></span>

   ```
   foreach ($connectorOverride in Get-ADSyncSchedulerConnectorOverride)
   {
       Set-ADSyncSchedulerConnectorOverride -ConnectorIdentifier $connectorOverride.ConnectorIdentifier.Guid -FullSyncRequired $false -FullImportRequired $false
   }
   ```

5. <span data-ttu-id="9ab94-216">Per riabilitare l'utilità di pianificazione, eseguire il cmdlet seguente: `Set-ADSyncScheduler -SyncCycleEnabled $true`</span><span class="sxs-lookup"><span data-stu-id="9ab94-216">To resume the scheduler, run the following cmdlet: `Set-ADSyncScheduler -SyncCycleEnabled $true`</span></span>

   >[!IMPORTANT]
   > <span data-ttu-id="9ab94-217">Non dimenticare di eseguire i passaggi di sincronizzazione necessari appena possibile.</span><span class="sxs-lookup"><span data-stu-id="9ab94-217">Remember to execute the required synchronization steps at your earliest convenience.</span></span> <span data-ttu-id="9ab94-218">È possibile eseguire questi passaggi manualmente tramite Synchronization Service Manager oppure aggiungere nuovamente le sostituzioni usando il cmdlet Set-ADSyncSchedulerConnectorOverride.</span><span class="sxs-lookup"><span data-stu-id="9ab94-218">You can either manually execute these steps using the Synchronization Service Manager or add the overrides back using the Set-ADSyncSchedulerConnectorOverride cmdlet.</span></span>

<span data-ttu-id="9ab94-219">Per aggiungere le sostituzioni per l'importazione completa e per la sincronizzazione completa in un connettore arbitrario, eseguire il cmdlet seguente: `Set-ADSyncSchedulerConnectorOverride -ConnectorIdentifier <Guid> -FullImportRequired $true -FullSyncRequired $true`</span><span class="sxs-lookup"><span data-stu-id="9ab94-219">To add the overrides for both full import and full synchronization on an arbitrary connector, run the following cmdlet:  `Set-ADSyncSchedulerConnectorOverride -ConnectorIdentifier <Guid> -FullImportRequired $true -FullSyncRequired $true`</span></span>

## <a name="next-steps"></a><span data-ttu-id="9ab94-220">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="9ab94-220">Next steps</span></span>
<span data-ttu-id="9ab94-221">Altre informazioni su [Integrazione delle identità locali con Azure Active Directory](active-directory-aadconnect.md).</span><span class="sxs-lookup"><span data-stu-id="9ab94-221">Learn more about [integrating your on-premises identities with Azure Active Directory](active-directory-aadconnect.md).</span></span>
