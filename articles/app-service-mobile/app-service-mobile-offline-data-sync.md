---
title: Sincronizzazione di dati offline nelle app per dispositivi mobili di Azure | Documentazione Microsoft
description: "Riferimento concettuale e panoramica della funzionalità di sincronizzazione di dati offline nelle app per dispositivi mobili di Azure"
documentationcenter: windows
author: ggailey777
manager: syntaxc4
editor: 
services: app-service\mobile
ms.assetid: 982fb683-8884-40da-96e6-77eeca2500e3
ms.service: app-service-mobile
ms.workload: mobile
ms.tgt_pltfrm: na
ms.devlang: multiple
ms.topic: article
ms.date: 10/30/2016
ms.author: glenga
ms.openlocfilehash: 8e2bd755d14319f8c66f7ae7ec64fbd10801b39d
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/29/2017
---
# <a name="offline-data-sync-in-azure-mobile-apps"></a><span data-ttu-id="594db-103">Sincronizzazione di dati offline nelle app per dispositivi mobili di Azure</span><span class="sxs-lookup"><span data-stu-id="594db-103">Offline Data Sync in Azure Mobile Apps</span></span>
## <a name="what-is-offline-data-sync"></a><span data-ttu-id="594db-104">Che cos'è la sincronizzazione di dati offline?</span><span class="sxs-lookup"><span data-stu-id="594db-104">What is offline data sync?</span></span>
<span data-ttu-id="594db-105">La sincronizzazione di dati offline è una funzionalità dell'SDK client e server delle app per dispositivi mobili di Azure che permette agli sviluppatori di creare con facilità app che possono essere usate anche senza connessione di rete.</span><span class="sxs-lookup"><span data-stu-id="594db-105">Offline data sync is a client and server SDK feature of Azure Mobile Apps that makes it easy for developers to create apps that are functional without a network connection.</span></span>

<span data-ttu-id="594db-106">Quando l'app è in modalità offline, è comunque possibile creare e modificare i dati, che vengono salvati in un archivio locale.</span><span class="sxs-lookup"><span data-stu-id="594db-106">When your app is in offline mode, you can still create and modify data, which are saved to a local store.</span></span> <span data-ttu-id="594db-107">Quando l'app torna online, può sincronizzare le modifiche locali con il back-end dell'app per dispositivi mobili di Azure.</span><span class="sxs-lookup"><span data-stu-id="594db-107">When the app is back online, it can synchronize local changes with your Azure Mobile App backend.</span></span> <span data-ttu-id="594db-108">Questa funzionalità include anche il supporto per il rilevamento di conflitti quando lo stesso record viene modificato nel client e nel back-end.</span><span class="sxs-lookup"><span data-stu-id="594db-108">The feature also includes support for detecting conflicts when the same record is changed on both the client and the backend.</span></span> <span data-ttu-id="594db-109">I conflitti possono essere gestiti sul server o sul client.</span><span class="sxs-lookup"><span data-stu-id="594db-109">Conflicts can then be handled either on the server or the client.</span></span>

<span data-ttu-id="594db-110">La sincronizzazione offline presenta diversi vantaggi:</span><span class="sxs-lookup"><span data-stu-id="594db-110">Offline sync has several benefits:</span></span>

* <span data-ttu-id="594db-111">Migliorare la velocità di risposta dell'app memorizzando i dati del server nella cache locale del dispositivo</span><span class="sxs-lookup"><span data-stu-id="594db-111">Improve app responsiveness by caching server data locally on the device</span></span>
* <span data-ttu-id="594db-112">Creare app affidabili che possono essere usate anche in caso di problemi di rete</span><span class="sxs-lookup"><span data-stu-id="594db-112">Create robust apps that remain useful when there are network issues</span></span>
* <span data-ttu-id="594db-113">Permettere agli utenti finali di creare e modificare i dati anche in mancanza di accesso alla rete, supportando scenari con connettività scarsa o assente</span><span class="sxs-lookup"><span data-stu-id="594db-113">Allow end users to create and modify data even when there is no network access, supporting scenarios with little or no connectivity</span></span>
* <span data-ttu-id="594db-114">Sincronizzare i dati tra più dispositivi e rilevare i conflitti quando lo stesso record viene modificato da due dispositivi</span><span class="sxs-lookup"><span data-stu-id="594db-114">Sync data across multiple devices and detect conflicts when the same record is modified by two devices</span></span>
* <span data-ttu-id="594db-115">Limitare l'uso della rete in reti a latenza elevata o a consumo</span><span class="sxs-lookup"><span data-stu-id="594db-115">Limit network use on high-latency or metered networks</span></span>

<span data-ttu-id="594db-116">Le esercitazioni seguenti illustrano come aggiungere la sincronizzazione offline ai client mobili mediante le app per dispositivi mobili di Azure:</span><span class="sxs-lookup"><span data-stu-id="594db-116">The following tutorials show how to add offline sync to your mobile clients using Azure Mobile Apps:</span></span>

* <span data-ttu-id="594db-117">[Android: Abilitare la sincronizzazione offline]</span><span class="sxs-lookup"><span data-stu-id="594db-117">[Android: Enable offline sync]</span></span>
* [<span data-ttu-id="594db-118">Apache Cordova: Abilitare la sincronizzazione offline</span><span class="sxs-lookup"><span data-stu-id="594db-118">Apache Cordova: Enable offline sync</span></span>](app-service-mobile-cordova-get-started-offline-data.md)
* <span data-ttu-id="594db-119">[iOS: Abilitare la sincronizzazione offline]</span><span class="sxs-lookup"><span data-stu-id="594db-119">[iOS: Enable offline sync]</span></span>
* <span data-ttu-id="594db-120">[Xamarin iOS: Abilitare la sincronizzazione offline]</span><span class="sxs-lookup"><span data-stu-id="594db-120">[Xamarin iOS: Enable offline sync]</span></span>
* <span data-ttu-id="594db-121">[Xamarin Android: Abilitare la sincronizzazione offline]</span><span class="sxs-lookup"><span data-stu-id="594db-121">[Xamarin Android: Enable offline sync]</span></span>
* [<span data-ttu-id="594db-122">Xamarin.Forms: Abilitare la sincronizzazione offline</span><span class="sxs-lookup"><span data-stu-id="594db-122">Xamarin.Forms: Enable offline sync</span></span>](app-service-mobile-xamarin-forms-get-started-offline-data.md)
* <span data-ttu-id="594db-123">[Abilitare la sincronizzazione offline per l'app di Windows]</span><span class="sxs-lookup"><span data-stu-id="594db-123">[Universal Windows Platform: Enable offline sync]</span></span>

## <a name="what-is-a-sync-table"></a><span data-ttu-id="594db-124">Informazioni sulla tabella di sincronizzazione</span><span class="sxs-lookup"><span data-stu-id="594db-124">What is a sync table?</span></span>
<span data-ttu-id="594db-125">Per accedere all'endpoint "/tables", gli SDK del client mobile di Azure offrono interfacce quali `IMobileServiceTable` (SDK del client .NET) o `MSTable` (client iOS).</span><span class="sxs-lookup"><span data-stu-id="594db-125">To access the "/tables" endpoint, the Azure Mobile client SDKs provide interfaces such as `IMobileServiceTable` (.NET client SDK) or `MSTable` (iOS client).</span></span> <span data-ttu-id="594db-126">Queste API si connettono direttamente al back-end dell'app per dispositivi mobili di Azure e hanno esito negativo se il dispositivo client non ha una connessione di rete.</span><span class="sxs-lookup"><span data-stu-id="594db-126">These APIs connect directly to the Azure Mobile App backend and fail if the client device does not have a network connection.</span></span>

<span data-ttu-id="594db-127">Per supportare l'uso offline, l'app deve usare invece le API della *tabella di sincronizzazione*, ad esempio `IMobileServiceSyncTable` (SDK del client .NET) o `MSSyncTable` (client iOS).</span><span class="sxs-lookup"><span data-stu-id="594db-127">To support offline use, your app should instead use the *sync table* APIs, such as `IMobileServiceSyncTable` (.NET client SDK) or `MSSyncTable` (iOS client).</span></span> <span data-ttu-id="594db-128">Tutte le operazioni CRUD (Create, Read, Update, Delete) funzionano con le API della tabella di sincronizzazione, ma la lettura o la scrittura vengono effettuate in un *archivio locale*.</span><span class="sxs-lookup"><span data-stu-id="594db-128">All the same CRUD operations (Create, Read, Update, Delete) work against sync table APIs, except now they read from or write to a *local store*.</span></span> <span data-ttu-id="594db-129">Prima di poter eseguire qualsiasi operazione sulla tabella di sincronizzazione, è necessario inizializzare l'archivio locale.</span><span class="sxs-lookup"><span data-stu-id="594db-129">Before any sync table operations can be performed, the local store must be initialized.</span></span>

## <a name="what-is-a-local-store"></a><span data-ttu-id="594db-130">Informazioni sull'archivio locale</span><span class="sxs-lookup"><span data-stu-id="594db-130">What is a local store?</span></span>
<span data-ttu-id="594db-131">Un archivio locale è un livello di persistenza dei dati nel dispositivo client.</span><span class="sxs-lookup"><span data-stu-id="594db-131">A local store is the data persistence layer on the client device.</span></span> <span data-ttu-id="594db-132">Gli SDK del client delle app per dispositivi mobili di Azure forniscono un'implementazione predefinita dell'archivio locale.</span><span class="sxs-lookup"><span data-stu-id="594db-132">The Azure Mobile Apps client SDKs provide a default local store implementation.</span></span> <span data-ttu-id="594db-133">In Windows, Xamarin e Android è basato su SQLite,</span><span class="sxs-lookup"><span data-stu-id="594db-133">On Windows, Xamarin and Android, it is based on SQLite.</span></span> <span data-ttu-id="594db-134">mentre in iOS è basato su Core Data.</span><span class="sxs-lookup"><span data-stu-id="594db-134">On iOS, it is based on Core Data.</span></span>

<span data-ttu-id="594db-135">Per usare l'implementazione basata su SQLite in Windows Phone o Windows Store 8.1, è necessario installare un'estensione SQLite.</span><span class="sxs-lookup"><span data-stu-id="594db-135">To use the SQLite-based implementation on Windows Phone or Windows Store 8.1, you need to install a SQLite extension.</span></span> <span data-ttu-id="594db-136">Per altre informazioni, vedere [Abilitare la sincronizzazione offline per l'app di Windows]. Android e iOS includono una versione di SQLite nel sistema operativo stesso del dispositivo, quindi non è necessario fare riferimento a una versione specifica di SQLite.</span><span class="sxs-lookup"><span data-stu-id="594db-136">For more information, see [Universal Windows Platform: Enable offline sync]. Android and iOS ship with a version of SQLite in the device operating system itself, so it is not necessary to reference your own version of SQLite.</span></span>

<span data-ttu-id="594db-137">Gli sviluppatori possono anche implementare il proprio archivio locale.</span><span class="sxs-lookup"><span data-stu-id="594db-137">Developers can also implement their own local store.</span></span> <span data-ttu-id="594db-138">Ad esempio, per archiviare dati in un formato crittografato nel client mobile, è possibile definire un archivio locale che usa SQLCipher per la crittografia.</span><span class="sxs-lookup"><span data-stu-id="594db-138">For instance, if you wish to store data in an encrypted format on the mobile client, you can define a local store that uses SQLCipher for encryption.</span></span>

## <a name="what-is-a-sync-context"></a><span data-ttu-id="594db-139">Informazioni sul contesto di sincronizzazione</span><span class="sxs-lookup"><span data-stu-id="594db-139">What is a sync context?</span></span>
<span data-ttu-id="594db-140">Un *contesto di sincronizzazione* è associato a un oggetto client mobile, ad esempio `IMobileServiceClient` o `MSClient`, e tiene traccia delle modifiche apportate con le tabelle di sincronizzazione.</span><span class="sxs-lookup"><span data-stu-id="594db-140">A *sync context* is associated with a mobile client object (such as `IMobileServiceClient` or `MSClient`) and tracks changes that are made with sync tables.</span></span> <span data-ttu-id="594db-141">Il contesto di sincronizzazione gestisce una *coda operazioni*, che include un elenco ordinato di operazioni CUD (Create, Update, Delete) che viene inviato successivamente al server.</span><span class="sxs-lookup"><span data-stu-id="594db-141">The sync context maintains an *operation queue*, which keeps an ordered list of CUD operations (Create, Update, Delete) that is later be sent to the server.</span></span>

<span data-ttu-id="594db-142">Un archivio locale è associato al contesto di sincronizzazione tramite un metodo di inizializzazione, ad esempio `IMobileServicesSyncContext.InitializeAsync(localstore)` nel [.NET SDK per client].</span><span class="sxs-lookup"><span data-stu-id="594db-142">A local store is associated with the sync context using an initialize method such as `IMobileServicesSyncContext.InitializeAsync(localstore)` in the [.NET client SDK].</span></span>

## <span data-ttu-id="594db-143"><a name="how-sync-works"></a>Funzionamento della sincronizzazione offline</span><span class="sxs-lookup"><span data-stu-id="594db-143"><a name="how-sync-works"></a>How offline synchronization works</span></span>
<span data-ttu-id="594db-144">Quando si usano le tabelle di sincronizzazione, il codice client controlla quando le modifiche locali vengono sincronizzate con un back-end dell'app per dispositivi mobili di Azure.</span><span class="sxs-lookup"><span data-stu-id="594db-144">When using sync tables, your client code controls when local changes are synchronized with an Azure Mobile App backend.</span></span> <span data-ttu-id="594db-145">I dati vengono inviati al back-end solo quando viene effettuata una chiamata per il *push* delle modifiche locali.</span><span class="sxs-lookup"><span data-stu-id="594db-145">Nothing is sent to the backend until there is a call to *push* local changes.</span></span> <span data-ttu-id="594db-146">Analogamente, l'archivio locale viene popolato con nuovi dati solo quando viene effettuata una chiamata per il *pull* dei dati.</span><span class="sxs-lookup"><span data-stu-id="594db-146">Similarly, the local store is populated with new data only when there is a call to *pull* data.</span></span>

* <span data-ttu-id="594db-147">**Push**: l'operazione push viene effettuata sul contesto di sincronizzazione e invia tutte le modifiche CUD apportate dopo l'ultimo push.</span><span class="sxs-lookup"><span data-stu-id="594db-147">**Push**: Push is an operation on the sync context and sends all CUD changes since the last push.</span></span> <span data-ttu-id="594db-148">Si noti che non è possibile inviare solo le modifiche di una singola tabella, perché ciò potrebbe alterare l'ordine di invio delle operazioni.</span><span class="sxs-lookup"><span data-stu-id="594db-148">Note that it is not possible to send only an individual table's changes, because otherwise operations could be sent out of order.</span></span> <span data-ttu-id="594db-149">L'operazione push esegue una serie di chiamate REST al back-end dell'app per dispositivi mobili di Azure, che a sua volta modifica il database del server.</span><span class="sxs-lookup"><span data-stu-id="594db-149">Push executes a series of REST calls to your Azure Mobile App backend, which in turn modifies your server database.</span></span>
* <span data-ttu-id="594db-150">**Pull**: l'operazione pull viene effettuata per ogni singola tabella e può essere personalizzata con una query, in modo da recuperare solo un subset dei dati del server.</span><span class="sxs-lookup"><span data-stu-id="594db-150">**Pull**: Pull is performed on a per-table basis and can be customized with a query to retrieve only a subset of the server data.</span></span> <span data-ttu-id="594db-151">Gli SDK del client mobile di Azure inseriscono quindi i dati risultanti nell'archivio locale.</span><span class="sxs-lookup"><span data-stu-id="594db-151">The Azure Mobile client SDKs then insert the resulting data into the local store.</span></span>
* <span data-ttu-id="594db-152">**Push impliciti**: se un'operazione pull viene eseguita in una tabella con aggiornamenti locali in sospeso, il pull esegue prima un'operazione `push()` sul contesto di sincronizzazione.</span><span class="sxs-lookup"><span data-stu-id="594db-152">**Implicit Pushes**: If a pull is executed against a table that has pending local updates, the pull first executes a `push()` on the sync context.</span></span> <span data-ttu-id="594db-153">Questo push consente di ridurre al minimo i conflitti tra le modifiche già in coda e i nuovi dati dal server.</span><span class="sxs-lookup"><span data-stu-id="594db-153">This push helps minimize conflicts between changes that are already queued and new data from the server.</span></span>
* <span data-ttu-id="594db-154">**Sincronizzazione incrementale**: il primo parametro dell'operazione pull è un *nome query* usato solo nel client.</span><span class="sxs-lookup"><span data-stu-id="594db-154">**Incremental Sync**: the first parameter to the pull operation is a *query name* that is used only on the client.</span></span> <span data-ttu-id="594db-155">Se si usa un nome di query non Null, Azure Mobile SDK esegue una *sincronizzazione incrementale*. Ogni volta che un'operazione pull restituisce un set di risultati, il timestamp `updatedAt` più recente di tale set di risultati viene archiviato nelle tabelle di sistema locali dell'SDK.</span><span class="sxs-lookup"><span data-stu-id="594db-155">If you use a non-null query name, the Azure Mobile SDK performs an *incremental sync*. Each time a pull operation returns a set of results, the latest `updatedAt` timestamp from that result set is stored in the SDK local system tables.</span></span> <span data-ttu-id="594db-156">Le operazioni pull successive recuperano solo i record successivi a tale timestamp.</span><span class="sxs-lookup"><span data-stu-id="594db-156">Subsequent pull operations retrieve only records after that timestamp.</span></span>

  <span data-ttu-id="594db-157">Per usare la sincronizzazione incrementale, il server deve restituire valori `updatedAt` significativi e deve anche supportare l'ordinamento in base a questo campo.</span><span class="sxs-lookup"><span data-stu-id="594db-157">To use incremental sync, your server must return meaningful `updatedAt` values and must also support sorting by this field.</span></span> <span data-ttu-id="594db-158">Poiché tuttavia l'SDK aggiunge il proprio ordinamento al campo updatedAt, non è possibile usare una query pull con una clausola `orderBy` specifica.</span><span class="sxs-lookup"><span data-stu-id="594db-158">However, since the SDK adds its own sort on the updatedAt field, you cannot use a pull query that has its own `orderBy` clause.</span></span>

  <span data-ttu-id="594db-159">Il nome della query può essere una stringa qualsiasi, ma deve essere univoco per ogni query logica dell'app.</span><span class="sxs-lookup"><span data-stu-id="594db-159">The query name can be any string you choose, but it must be unique for each logical query in your app.</span></span>
  <span data-ttu-id="594db-160">In caso contrario, diverse operazioni pull potrebbero sovrascrivere lo stesso timestamp di sincronizzazione incrementale e le query potrebbero restituire risultati non corretti.</span><span class="sxs-lookup"><span data-stu-id="594db-160">Otherwise, different pull operations could overwrite the same incremental sync timestamp and your queries can return incorrect results.</span></span>

  <span data-ttu-id="594db-161">Se la query ha un parametro, è possibile creare un nome di query univoco incorporando il valore del parametro.</span><span class="sxs-lookup"><span data-stu-id="594db-161">If the query has a parameter, one way to create a unique query name is to incorporate the parameter value.</span></span>
  <span data-ttu-id="594db-162">Ad esempio, se si applica un filtro in base all'ID utente, il nome della query potrebbe essere analogo al seguente (in C#):</span><span class="sxs-lookup"><span data-stu-id="594db-162">For instance, if you are filtering on userid, your query name could be as follows (in C#):</span></span>

        await todoTable.PullAsync("todoItems" + userid,
            syncTable.Where(u => u.UserId == userid));

  <span data-ttu-id="594db-163">Se si intende rifiutare esplicitamente la sincronizzazione incrementale, passare `null` come ID di query.</span><span class="sxs-lookup"><span data-stu-id="594db-163">If you want to opt out of incremental sync, pass `null` as the query ID.</span></span> <span data-ttu-id="594db-164">In questo caso, vengono recuperati tutti i record in ogni chiamata a `PullAsync`, potenzialmente inefficace.</span><span class="sxs-lookup"><span data-stu-id="594db-164">In this case, all records are retrieved on every call to `PullAsync`, which is potentially inefficient.</span></span>
* <span data-ttu-id="594db-165">**Eliminazione**: è possibile eliminare i contenuti dell'archivio locale usando `IMobileServiceSyncTable.PurgeAsync`.</span><span class="sxs-lookup"><span data-stu-id="594db-165">**Purging**: You can clear the contents of the local store using `IMobileServiceSyncTable.PurgeAsync`.</span></span>
  <span data-ttu-id="594db-166">La ripulitura potrebbe essere necessaria se il database client include dati non aggiornati o se si vogliono eliminare tutte le modifiche in sospeso.</span><span class="sxs-lookup"><span data-stu-id="594db-166">Purging may be necessary if you have stale data in the client database, or if you wish to discard all pending changes.</span></span>

  <span data-ttu-id="594db-167">L'operazione di ripulitura cancella una tabella dall'archivio locale.</span><span class="sxs-lookup"><span data-stu-id="594db-167">A purge clears a table from the local store.</span></span> <span data-ttu-id="594db-168">Se sono presenti operazioni in attesa di sincronizzazione con il database del server, la ripulitura genera un'eccezione, a meno che non sia impostato il parametro *force purge*.</span><span class="sxs-lookup"><span data-stu-id="594db-168">If there are operations awaiting synchronization with the server database, the purge throws an exception unless the *force purge* parameter is set.</span></span>

  <span data-ttu-id="594db-169">Come esempio di dati non aggiornati sul client, si supponga che Device1 nell'esempio "todo list" esegua il pull solo di elementi non completati.</span><span class="sxs-lookup"><span data-stu-id="594db-169">As an example of stale data on the client, suppose in the "todo list" example, Device1 only pulls items that are not completed.</span></span> <span data-ttu-id="594db-170">Un elemento todoitem "Buy milk" viene contrassegnato come completato nel server da un altro dispositivo.</span><span class="sxs-lookup"><span data-stu-id="594db-170">A todoitem "Buy milk" is marked completed on the server by another device.</span></span> <span data-ttu-id="594db-171">Device1 include ancora tuttavia l'elemento todoitem "Buy milk" nell'archivio locale, perché esegue il pull solo degli elementi non contrassegnati come completi.</span><span class="sxs-lookup"><span data-stu-id="594db-171">However, Device1 still has the "Buy milk" todoitem in local store because it is only pulling items that are not marked complete.</span></span> <span data-ttu-id="594db-172">Questo elemento non aggiornato viene cancellato da un'operazione di ripulitura.</span><span class="sxs-lookup"><span data-stu-id="594db-172">A purge clears this stale item.</span></span>

## <a name="next-steps"></a><span data-ttu-id="594db-173">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="594db-173">Next steps</span></span>
* <span data-ttu-id="594db-174">[iOS: Abilitare la sincronizzazione offline]</span><span class="sxs-lookup"><span data-stu-id="594db-174">[iOS: Enable offline sync]</span></span>
* <span data-ttu-id="594db-175">[Xamarin iOS: Abilitare la sincronizzazione offline]</span><span class="sxs-lookup"><span data-stu-id="594db-175">[Xamarin iOS: Enable offline sync]</span></span>
* <span data-ttu-id="594db-176">[Xamarin Android: Abilitare la sincronizzazione offline]</span><span class="sxs-lookup"><span data-stu-id="594db-176">[Xamarin Android: Enable offline sync]</span></span>
* <span data-ttu-id="594db-177">[Abilitare la sincronizzazione offline per l'app di Windows]</span><span class="sxs-lookup"><span data-stu-id="594db-177">[Universal Windows Platform: Enable offline sync]</span></span>

<!-- Links -->
[.NET SDK per client]: app-service-mobile-dotnet-how-to-use-client-library.md
[Android: Abilitare la sincronizzazione offline]: app-service-mobile-android-get-started-offline-data.md
[iOS: Abilitare la sincronizzazione offline]: app-service-mobile-ios-get-started-offline-data.md
[Xamarin iOS: Abilitare la sincronizzazione offline]: app-service-mobile-xamarin-ios-get-started-offline-data.md
[Xamarin Android: Abilitare la sincronizzazione offline]: app-service-mobile-xamarin-android-get-started-offline-data.md
[Abilitare la sincronizzazione offline per l'app di Windows]: app-service-mobile-windows-store-dotnet-get-started-offline-data.md
