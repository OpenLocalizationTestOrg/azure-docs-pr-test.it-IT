---
title: aaaRun Cassandra con Linux in Azure | Documenti Microsoft
description: Come toorun un Cassandra cluster Linux in macchine virtuali di Azure da un'app Node.js
services: virtual-machines-linux
documentationcenter: nodejs
author: tomarcher
manager: routlaw
editor: 
tags: azure-service-management
ms.assetid: 30de1f29-e97d-492f-ae34-41ec83488de0
ms.service: virtual-machines-linux
ms.workload: infrastructure-services
ms.tgt_pltfrm: vm-linux
ms.devlang: na
ms.topic: article
ms.date: 08/17/2017
ms.author: tarcher
ms.openlocfilehash: 381ca301bbe88d3740cf182f9c44fada5b9ba7cc
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/06/2017
---
# <a name="running-cassandra-with-linux-on-azure-and-accessing-it-from-nodejs"></a><span data-ttu-id="0c3f0-103">Esecuzione di Cassandra con Linux in Azure e accesso da Node.js</span><span class="sxs-lookup"><span data-stu-id="0c3f0-103">Running Cassandra with Linux on Azure and Accessing it from Node.js</span></span>
> [!IMPORTANT] 
> <span data-ttu-id="0c3f0-104">Azure offre due diversi modelli di distribuzione per creare e usare le risorse: [Gestione risorse e la distribuzione classica](../../../resource-manager-deployment-model.md).</span><span class="sxs-lookup"><span data-stu-id="0c3f0-104">Azure has two different deployment models for creating and working with resources: [Resource Manager and Classic](../../../resource-manager-deployment-model.md).</span></span> <span data-ttu-id="0c3f0-105">In questo articolo viene illustrato l'utilizzo del modello di distribuzione classica hello.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-105">This article covers using hello Classic deployment model.</span></span> <span data-ttu-id="0c3f0-106">Si consiglia di utilizzano il modello di gestione risorse hello più nuove distribuzioni.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-106">Microsoft recommends that most new deployments use hello Resource Manager model.</span></span> <span data-ttu-id="0c3f0-107">Vedere i modelli di Resource Manager per cluster [Datastax Enterprise](https://azure.microsoft.com/documentation/templates/datastax) e [Spark e Cassandra in CentOS](https://azure.microsoft.com/documentation/templates/spark-and-cassandra-on-centos/).</span><span class="sxs-lookup"><span data-stu-id="0c3f0-107">See Resource Manager templates for [Datastax Enterprise](https://azure.microsoft.com/documentation/templates/datastax) and [Spark cluster and Cassandra on CentOS](https://azure.microsoft.com/documentation/templates/spark-and-cassandra-on-centos/).</span></span>

## <a name="overview"></a><span data-ttu-id="0c3f0-108">Panoramica</span><span class="sxs-lookup"><span data-stu-id="0c3f0-108">Overview</span></span>
<span data-ttu-id="0c3f0-109">Microsoft Azure è una piattaforma cloud aperta che esegue software sia Microsoft che non Microsoft, inclusi sistemi operativi, server applicazioni, middleware di messaggistica, oltre a database SQL e NoSQL da modelli sia commerciali che open source.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-109">Microsoft Azure is an open cloud platform that runs both Microsoft as well as non-Microsoft software which  includes operating systems, application servers, messaging middleware as well as SQL and NoSQL databases from both commercial and open source models.</span></span> <span data-ttu-id="0c3f0-110">La compilazione di servizi resilienti su cloud pubblici, incluso Azure, richiede un'attenta pianificazione e un'architettura mirata sia per i server applicazioni che per i livelli di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-110">Building resilient services on public clouds including Azure requires careful planning and deliberate architecture for both applications servers as well storage layers.</span></span> <span data-ttu-id="0c3f0-111">L'architettura di archiviazione distribuita di Cassandra aiuta a compilare con facilità sistemi a disponibilità elevata a tolleranza di errore del cluster.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-111">Cassandra’s distributed storage architecture naturally helps in building highly available systems that are fault tolerant for cluster failures.</span></span> <span data-ttu-id="0c3f0-112">Cassandra è un database NoSQL con scalabilità cloud gestito da Apache Software Foundation all'indirizzo cassandra.apache.org. Cassandra, essendo scritto in Java, viene eseguito su piattaforme sia Windows che Linux.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-112">Cassandra is a cloud scale NoSQL database maintained by Apache Software Foundation at cassandra.apache.org; Cassandra is written in Java and hence runs on both on Windows as well as Linux platforms.</span></span>

<span data-ttu-id="0c3f0-113">lo stato attivo Hello di questo articolo è la distribuzione Cassandra tooshow in Ubuntu come cluster singolo e a più data center di usufruire delle macchine virtuali di Microsoft Azure e le reti virtuali.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-113">hello focus of this article is tooshow Cassandra deployment on Ubuntu as a single and multi-data center cluster leveraging Microsoft Azure Virtual Machines and Virtual Networks.</span></span> <span data-ttu-id="0c3f0-114">Hello per carichi di lavoro di produzione con ottimizzazione per la distribuzione di cluster nell'ambito di questo articolo poiché richiede la configurazione disco a più nodi, hello toosupport di modellazione dati e progettazione della topologia ad anello appropriato è necessario replica, la coerenza dei dati, la velocità effettiva e requisiti di disponibilità elevata.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-114">hello cluster deployment for production optimized workloads is out of scope of this article as it requires multi-disk node configuration, appropriate ring topology design and data modeling toosupport hello needed replication, data consistency, throughput and high availability requirements.</span></span>

<span data-ttu-id="0c3f0-115">Accetta questo articolo tooshow un approccio fondamentali di compilazione hello cluster Cassandra confrontati Docker, Chef o Puppet che possono rendere hello molto più semplice di distribuzione dell'infrastruttura.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-115">This article takes a fundamental approach tooshow what is involved in building hello Cassandra cluster compared Docker, Chef or Puppet which can make hello infrastructure deployment a lot easier.</span></span>  

## <a name="hello-deployment-models"></a><span data-ttu-id="0c3f0-116">Hello modelli di distribuzione</span><span class="sxs-lookup"><span data-stu-id="0c3f0-116">hello Deployment Models</span></span>
<span data-ttu-id="0c3f0-117">Rete di Microsoft Azure consente la distribuzione di hello di cluster privata isolato, accesso hello dei quali può essere qualsiasi sicurezza di rete con granularità fine fine tooattain con restrizioni.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-117">Microsoft Azure networking allows hello deployment of isolated private clusters, hello access of which can be restricted tooattain fine grained network security.</span></span>  <span data-ttu-id="0c3f0-118">Poiché in questo articolo è sulla visualizzazione distribuzione Cassandra hello a un livello di base, non focalizzata sul livello di coerenza hello e progettazione di hello ottimale dell'archiviazione per la velocità effettiva.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-118">Since this article is about showing hello Cassandra deployment at a fundamental level, we will not focus on hello consistency level and hello optimal storage design for throughput.</span></span> <span data-ttu-id="0c3f0-119">Ecco hello elenco di requisiti di rete per il cluster del ipotetica:</span><span class="sxs-lookup"><span data-stu-id="0c3f0-119">Here is hello list of networking requirements for our hypothetical cluster:</span></span>

* <span data-ttu-id="0c3f0-120">I sistemi esterni non possono accedere al database Cassandra da Azure o all'esterno di Azure</span><span class="sxs-lookup"><span data-stu-id="0c3f0-120">External systems can’t access Cassandra database from within or outside Azure</span></span>
* <span data-ttu-id="0c3f0-121">Cluster Cassandra ha toobe dietro il bilanciamento del carico per il traffico thrift</span><span class="sxs-lookup"><span data-stu-id="0c3f0-121">Cassandra cluster has toobe behind a load balancer for thrift traffic</span></span>
* <span data-ttu-id="0c3f0-122">Distribuire i nodi di Cassandra in due gruppi in ogni data center per una migliore disponibilità del cluster</span><span class="sxs-lookup"><span data-stu-id="0c3f0-122">Deploy Cassandra nodes in two groups in each data center for an enhanced cluster availability</span></span>
* <span data-ttu-id="0c3f0-123">Bloccare cluster hello in modo che solo l'applicazione server farm disponga di database di access toohello direttamente</span><span class="sxs-lookup"><span data-stu-id="0c3f0-123">Lock down hello cluster so that only application server farm has access toohello database directly</span></span>
* <span data-ttu-id="0c3f0-124">Nessun endpoint di rete pubblico diverso da SSH</span><span class="sxs-lookup"><span data-stu-id="0c3f0-124">No public networking endpoints other than SSH</span></span>
* <span data-ttu-id="0c3f0-125">Ogni nodo di Cassandra richiede un indirizzo IP interno fisso</span><span class="sxs-lookup"><span data-stu-id="0c3f0-125">Each Cassandra node needs a fixed internal IP address</span></span>

<span data-ttu-id="0c3f0-126">Cassandra può essere distribuito tooa singola regione di Azure o aree toomultiple in base alle natura distribuita hello del carico di lavoro hello.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-126">Cassandra can be deployed tooa single Azure region or toomultiple regions based on hello distributed nature of hello workload.</span></span> <span data-ttu-id="0c3f0-127">Modello di distribuzione con più aree può essere sfruttate tooserve gli utenti finali più vicino tooa particolare geography tramite hello stessa infrastruttura Cassandra.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-127">Multi-region deployment model can be leveraged tooserve end users closer tooa particular geography through hello same Cassandra infrastructure.</span></span> <span data-ttu-id="0c3f0-128">Nodo incorporato replica farà del Cassandra sincronizzazione hello di multi-master scrive provenienti da più centri dati e presenta una visualizzazione coerenza di hello tooapplications di dati.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-128">Cassandra’s built-in node replication takes care of hello synchronization of multi-master writes originating from multiple data centers and presents a consistent view of hello data tooapplications.</span></span> <span data-ttu-id="0c3f0-129">Distribuzione con più aree può consentire anche con l'attenuazione dei rischi hello hello più ampie Azure delle interruzioni di servizio.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-129">Multi-region deployment can also help with hello risk mitigation of hello broader Azure service outages.</span></span> <span data-ttu-id="0c3f0-130">La coerenza perfezionabile e la topologia di replica di Cassandra saranno di aiuto anche per soddisfare diverse esigenze RPO delle applicazioni.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-130">Cassandra’s tunable consistency and replication topology will help in meeting diverse RPO needs of applications.</span></span>

### <a name="single-region-deployment"></a><span data-ttu-id="0c3f0-131">Distribuzione in un'area singola</span><span class="sxs-lookup"><span data-stu-id="0c3f0-131">Single Region Deployment</span></span>
<span data-ttu-id="0c3f0-132">Si inizierà con una distribuzione di un'area singola e raccolto hello procedurali nella creazione di un modello con più aree.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-132">We will start with a single region deployment and harvest hello learnings in creating a multi-region model.</span></span> <span data-ttu-id="0c3f0-133">Reti virtuali di Azure sarà usato toocreate isolato subnet in modo che possono essere soddisfatti i requisiti di sicurezza rete hello indicati in precedenza.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-133">Azure virtual networking will be used toocreate isolated subnets so that hello network security requirements mentioned above can be met.</span></span>  <span data-ttu-id="0c3f0-134">il processo di Hello descritto nella creazione di distribuzione in una singola area hello utilizza Ubuntu 14.04 LTS e 2.08 Cassandra; Tuttavia, il processo di hello può facilmente essere adottato toohello altre varianti di Linux.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-134">hello process described in creating hello single region deployment uses Ubuntu 14.04 LTS and Cassandra 2.08; however, hello process can easily be adopted toohello other Linux variants.</span></span> <span data-ttu-id="0c3f0-135">di seguito Hello sono alcune delle caratteristiche di sistema di distribuzione di un'area singola hello hello.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-135">hello following are some of hello systemic characteristics of hello single region deployment.</span></span>  

<span data-ttu-id="0c3f0-136">**Disponibilità elevata:** hello nodi Cassandra illustrati nella figura 1 vengono distribuiti hello disponibilità tootwo imposta in modo che i nodi di hello vengono distribuiti tra più domini di errore per la disponibilità elevata.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-136">**High Availability:** hello Cassandra nodes shown in hello Figure 1 are deployed tootwo availability sets so that hello nodes are spread between multiple fault domains for high availability.</span></span> <span data-ttu-id="0c3f0-137">Macchine virtuali annotate con ogni set di disponibilità è mappato too2 domini di errore.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-137">VMs annotated with each availability set is mapped too2 fault domains.</span></span>  <span data-ttu-id="0c3f0-138">Microsoft Azure Usa hello concetto di toomanage di dominio di errore non pianificato all'intervallo di tempo (ad esempio, errori hardware o software) il concetto di hello del dominio di aggiornamento (ad esempio host o guest aggiornamenti del sistema operativo l'applicazione di patch /, gli aggiornamenti dell'applicazione) viene utilizzato per la gestione pianificata tempi di inattività.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-138">Microsoft Azure uses hello concept of fault domain toomanage unplanned down time (e.g. hardware or software failures) while hello concept of upgrade domain (e.g. host or guest OS patching/upgrades, application upgrades) is used for managing scheduled down time.</span></span> <span data-ttu-id="0c3f0-139">Vedere [il ripristino di emergenza e disponibilità elevata per applicazioni Azure](http://msdn.microsoft.com/library/dn251004.aspx) per ruolo hello dei domini di errore e di aggiornamento nel conseguire la disponibilità elevata.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-139">Please see [Disaster Recovery and High Availability for Azure Applications](http://msdn.microsoft.com/library/dn251004.aspx) for hello role of fault and upgrade domains in attaining high availability.</span></span>

![Distribuzione in un'area singola](./media/cassandra-nodejs/cassandra-linux1.png)

<span data-ttu-id="0c3f0-141">Figura 1: Distribuzione in un'area singola</span><span class="sxs-lookup"><span data-stu-id="0c3f0-141">Figure 1: Single region deployment</span></span>

<span data-ttu-id="0c3f0-142">Si noti che in fase di hello della redazione del presente documento, Azure non consente il mapping esplicito hello di un gruppo di dominio di errore specifico tooa macchine virtuali. di conseguenza, anche con il modello di distribuzione hello illustrato nella figura 1, è statisticamente probabile che tutte le macchine virtuali hello può essere mappato tootwo domini di errore anziché quattro.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-142">Note that at hello time of this writing, Azure doesn’t allow hello explicit mapping of a group of VMs tooa specific fault domain; consequently, even with hello deployment model shown in Figure 1, it is statistically probable that all hello virtual machines may be mapped tootwo fault domains instead of four.</span></span>

<span data-ttu-id="0c3f0-143">**Il traffico Thrift di bilanciamento del carico:** librerie client Thrift all'interno di server web hello connettano toohello cluster tramite un servizio di bilanciamento del carico interno.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-143">**Load Balancing Thrift Traffic:** Thrift client libraries inside hello web server connect toohello cluster through an internal load balancer.</span></span> <span data-ttu-id="0c3f0-144">Questa operazione richiede il processo di hello di aggiunta di subnet hello carico interno del servizio di bilanciamento toohello "dati" (vedere Figura 1) nel contesto di hello del servizio cloud hello ospita hello Cassandra cluster.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-144">This requires hello process of adding hello internal load balancer toohello “data” subnet (refer Figure 1) in hello context of hello cloud service hosting hello Cassandra cluster.</span></span> <span data-ttu-id="0c3f0-145">Una volta bilanciamento del carico interno hello è definito, ogni nodo richiede toobe di endpoint con carico bilanciato hello aggiunto con annotazioni hello del set con carico bilanciato con nome del servizio di bilanciamento del carico definito.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-145">Once hello internal load balancer is defined, each node requires hello load balanced endpoint toobe added with hello annotations of a load balanced set with previously defined load balancer name.</span></span> <span data-ttu-id="0c3f0-146">Per ulteriori dettagli, vedere [Bilanciamento del carico interno di Azure ](../../../load-balancer/load-balancer-internal-overview.md).</span><span class="sxs-lookup"><span data-stu-id="0c3f0-146">See [Azure Internal Load Balancing ](../../../load-balancer/load-balancer-internal-overview.md)for more details.</span></span>

<span data-ttu-id="0c3f0-147">**I valori di inizializzazione di cluster:** è importante tooselect hello la maggioranza dei nodi a disponibilità elevata per i valori di inizializzazione di nuovi nodi hello comunicherà con topologia di valore di inizializzazione nodi toodiscover hello del cluster di hello.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-147">**Cluster Seeds:** It is important tooselect hello most highly available nodes for seeds as hello new nodes will communicate with seed nodes toodiscover hello topology of hello cluster.</span></span> <span data-ttu-id="0c3f0-148">Un nodo di ogni set di disponibilità è impostato come valore di inizializzazione nodi tooavoid singolo punto di errore.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-148">One node from each availability set is designated as seed nodes tooavoid single point of failure.</span></span>

<span data-ttu-id="0c3f0-149">**Fattore di replica e il livello di coerenza:** della Cassandra compilazione in ingresso a disponibilità elevata e durabilità dei dati è caratterizzata da hello fattore di replica (RF - numero di copie di ogni riga archiviata nel cluster hello) e il livello di coerenza (numero di toobe di repliche letti/scritti prima di restituire il chiamante di hello risultato toohello).</span><span class="sxs-lookup"><span data-stu-id="0c3f0-149">**Replication Factor and Consistency Level:** Cassandra’s build-in high-availability and data durability is characterized by hello Replication Factor (RF - number of copies of each row stored on hello cluster) and Consistency Level (number of replicas toobe read/written before returning hello result toohello caller).</span></span> <span data-ttu-id="0c3f0-150">Fattore di replica viene specificato durante la creazione di spazio delle CHIAVI (database relazionale per simile tooa) hello mentre il livello di coerenza hello viene specificato durante l'esecuzione di query CRUD hello.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-150">Replication factor is specified during hello KEYSPACE (similar tooa relational database) creation whereas hello consistency level is specified while issuing hello CRUD query.</span></span> <span data-ttu-id="0c3f0-151">Vedere la documentazione Cassandra all'indirizzo [configurazione per garantire l'uniformità](http://www.datastax.com/documentation/cassandra/2.0/cassandra/dml/dml_config_consistency_c.html) per i dettagli di coerenza e la formula hello per il calcolo di quorum.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-151">See Cassandra documentation at [Configuring for Consistency](http://www.datastax.com/documentation/cassandra/2.0/cassandra/dml/dml_config_consistency_c.html) for consistency details and hello formula for quorum computation.</span></span>

<span data-ttu-id="0c3f0-152">Cassandra supporta due tipi di modelli di integrità dei dati: coerenza e la coerenza eventuale; Hello fattore di replica e il livello di coerenza verrà determinano se i dati di hello saranno coerenti, non appena un'operazione di scrittura viene completata o sarà possibile alla fine coerente.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-152">Cassandra supports two types of data integrity models – Consistency and Eventual Consistency; hello Replication Factor and Consistency Level will together determine if hello data will be consistent as soon as a write operation is complete or it will be eventually consistent.</span></span> <span data-ttu-id="0c3f0-153">Ad esempio, specificando QUORUM come livello di coerenza verrà sempre hello assicura i dati coerenza durante qualsiasi livello di coerenza, sotto il numero di hello di repliche toobe scritto come tooattain necessari QUORUM (ad esempio uno) comporta la dei dati alla fine coerente.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-153">For example, specifying QUORUM as hello Consistency Level will always ensures data Consistency while any consistency level, below hello number of replicas toobe written as needed tooattain QUORUM (e.g. ONE) results in data being eventually consistent.</span></span>

<span data-ttu-id="0c3f0-154">cluster di 8 nodi Hello illustrato in precedenza, con un fattore di replica del QUORUM e 3 (2 nodi vengono letti o scritti per coerenza) livello di coerenza di lettura/scrittura, in grado di superare perdita teorico hello di al massimo 1 nodo per ogni replica di gruppo prima dell'avvio dell'applicazione hello hello rilevamento errore hello.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-154">hello 8-node cluster shown above, with a replication factor of 3 and QUORUM (2 nodes are read or written for consistency) read/write consistency level, can survive hello theoretical loss of at hello most 1 node per replication group before hello application start noticing hello failure.</span></span> <span data-ttu-id="0c3f0-155">Si presuppone che tutti gli spazi di chiave hello sono ben equilibrati le richieste di lettura/scrittura.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-155">This assumes that all hello key spaces have well balanced read/write requests.</span></span>  <span data-ttu-id="0c3f0-156">di seguito Hello sono parametri hello che verrà utilizzato per il cluster hello distribuito:</span><span class="sxs-lookup"><span data-stu-id="0c3f0-156">hello following are hello parameters we will use for hello deployed cluster:</span></span>

<span data-ttu-id="0c3f0-157">Configurazione del cluster Cassandra in un'area singola:</span><span class="sxs-lookup"><span data-stu-id="0c3f0-157">Single region Cassandra cluster configuration:</span></span>

| <span data-ttu-id="0c3f0-158">Parametro cluster</span><span class="sxs-lookup"><span data-stu-id="0c3f0-158">Cluster Parameter</span></span> | <span data-ttu-id="0c3f0-159">Valore</span><span class="sxs-lookup"><span data-stu-id="0c3f0-159">Value</span></span> | <span data-ttu-id="0c3f0-160">Osservazioni</span><span class="sxs-lookup"><span data-stu-id="0c3f0-160">Remarks</span></span> |
| --- | --- | --- |
| <span data-ttu-id="0c3f0-161">Number of Nodes (N)</span><span class="sxs-lookup"><span data-stu-id="0c3f0-161">Number of Nodes (N)</span></span> |<span data-ttu-id="0c3f0-162">8</span><span class="sxs-lookup"><span data-stu-id="0c3f0-162">8</span></span> |<span data-ttu-id="0c3f0-163">Numero totale di nodi nel cluster hello</span><span class="sxs-lookup"><span data-stu-id="0c3f0-163">Total number of nodes in hello cluster</span></span> |
| <span data-ttu-id="0c3f0-164">Replication Factor (RF)</span><span class="sxs-lookup"><span data-stu-id="0c3f0-164">Replication Factor (RF)</span></span> |<span data-ttu-id="0c3f0-165">3</span><span class="sxs-lookup"><span data-stu-id="0c3f0-165">3</span></span> |<span data-ttu-id="0c3f0-166">Numero di repliche di una determinata riga</span><span class="sxs-lookup"><span data-stu-id="0c3f0-166">Number of replicas of a given row</span></span> |
| <span data-ttu-id="0c3f0-167">Consistency Level (Write)</span><span class="sxs-lookup"><span data-stu-id="0c3f0-167">Consistency Level (Write)</span></span> |<span data-ttu-id="0c3f0-168">QUORUM[(RF/2) +1) = 2] hello result di hello formula viene arrotondata per difetto</span><span class="sxs-lookup"><span data-stu-id="0c3f0-168">QUORUM[(RF/2) +1) = 2] hello result of hello formula is rounded down</span></span> |<span data-ttu-id="0c3f0-169">Scrive in hello la maggior parte delle 2 repliche prima risposta hello viene inviato toohello chiamante. replica 3 viene scritto in modo coerente alla fine.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-169">Writes at hello most 2 replicas before hello response is sent toohello caller; 3rd replica is written in an eventually consistent manner.</span></span> |
| <span data-ttu-id="0c3f0-170">Consistency Level (Read)</span><span class="sxs-lookup"><span data-stu-id="0c3f0-170">Consistency Level (Read)</span></span> |<span data-ttu-id="0c3f0-171">QUORUM [(RF/2) + 1 = 2] il risultato di hello di hello formula viene arrotondato per difetto</span><span class="sxs-lookup"><span data-stu-id="0c3f0-171">QUORUM [(RF/2) +1= 2] hello result of hello formula is rounded down</span></span> |<span data-ttu-id="0c3f0-172">Legge 2 repliche prima di inviare chiamante toohello di risposta.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-172">Reads 2 replicas before sending response toohello caller.</span></span> |
| <span data-ttu-id="0c3f0-173">Replication Strategy</span><span class="sxs-lookup"><span data-stu-id="0c3f0-173">Replication Strategy</span></span> |<span data-ttu-id="0c3f0-174">NetworkTopologyStrategy: per ulteriori informazioni, vedere [Replica dei dati](http://www.datastax.com/documentation/cassandra/2.0/cassandra/architecture/architectureDataDistributeReplication_c.html) nella documentazione di Cassandra</span><span class="sxs-lookup"><span data-stu-id="0c3f0-174">NetworkTopologyStrategy see [Data Replication](http://www.datastax.com/documentation/cassandra/2.0/cassandra/architecture/architectureDataDistributeReplication_c.html) in Cassandra documentation for more information</span></span> |<span data-ttu-id="0c3f0-175">Riconosce la topologia di distribuzione hello e inserisce le repliche in nodi in modo che tutte le repliche di hello non finiscono in hello stesso rack</span><span class="sxs-lookup"><span data-stu-id="0c3f0-175">Understands hello deployment topology and places replicas on nodes so that all hello replicas don’t end up on hello same rack</span></span> |
| <span data-ttu-id="0c3f0-176">Snitch</span><span class="sxs-lookup"><span data-stu-id="0c3f0-176">Snitch</span></span> |<span data-ttu-id="0c3f0-177">GossipingPropertyFileSnitch: per ulteriori informazioni, vedere [Snitch](http://www.datastax.com/documentation/cassandra/2.0/cassandra/architecture/architectureSnitchesAbout_c.html) nella documentazione di Cassandra</span><span class="sxs-lookup"><span data-stu-id="0c3f0-177">GossipingPropertyFileSnitch see [Snitches](http://www.datastax.com/documentation/cassandra/2.0/cassandra/architecture/architectureSnitchesAbout_c.html) in Cassandra documentation for more information</span></span> |<span data-ttu-id="0c3f0-178">NetworkTopologyStrategy viene utilizzato un concetto di topologia di snitch toounderstand hello.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-178">NetworkTopologyStrategy uses a concept of snitch toounderstand hello topology.</span></span> <span data-ttu-id="0c3f0-179">GossipingPropertyFileSnitch offre un migliore controllo per eseguire il mapping di ogni centro toodata nodo e rack.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-179">GossipingPropertyFileSnitch gives better control in mapping each node toodata center and rack.</span></span> <span data-ttu-id="0c3f0-180">cluster Hello utilizza toopropagate possono quindi queste informazioni.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-180">hello cluster then uses gossip toopropagate this information.</span></span> <span data-ttu-id="0c3f0-181">Questo è molto più semplice dinamica tooPropertyFileSnitch relativo di impostazione IP</span><span class="sxs-lookup"><span data-stu-id="0c3f0-181">This is much simpler in dynamic IP setting relative tooPropertyFileSnitch</span></span> |

<span data-ttu-id="0c3f0-182">**Considerazioni di Azure per Cluster Cassandra:** la funzionalità Macchine virtuali di Microsoft Azure utilizza l'archiviazione BLOB di Azure per la persistenza del disco; Archiviazione di Azure consente di salvare 3 repliche di ciascun disco per garantire una durabilità elevata.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-182">**Azure Considerations for Cassandra Cluster:** Microsoft Azure Virtual Machines capability uses Azure Blob storage for disk persistence; Azure Storage saves 3 replicas of each disk for high durability.</span></span> <span data-ttu-id="0c3f0-183">Ciò significa che ogni riga di dati inseriti in una tabella Cassandra è già archiviata in 3 repliche e pertanto la coerenza dei dati è già preso in considerazione anche se il fattore di replica (RF) hello è 1.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-183">That means each row of data inserted into a Cassandra table is already stored in 3 replicas and hence data consistency is already taken care of even if hello Replication Factor (RF) is 1.</span></span> <span data-ttu-id="0c3f0-184">problema principale di Hello con fattore di replica da 1 è che un'applicazione hello subiranno tempi di inattività, anche se un singolo nodo Cassandra ha esito negativo.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-184">hello main problem with Replication Factor being 1 is that hello application will experience downtime even if a single Cassandra node fails.</span></span> <span data-ttu-id="0c3f0-185">Tuttavia, se un nodo è inattivo per i problemi di hello (ad esempio hardware, errori di software di sistema) riconosciuti dal Controller di infrastruttura di Azure, verrà eseguito il provisioning un nuovo nodo nel posto mediante hello stessa unità di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-185">However, if a node is down for hello problems (e.g. hardware, system software failures) recognized by Azure Fabric Controller, it will provision a new node in its place using hello same storage drives.</span></span> <span data-ttu-id="0c3f0-186">Provisioning di un nuovo nodo tooreplace hello precedente uno potrebbe richiedere alcuni minuti.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-186">Provisioning a new node tooreplace hello old one may take a few minutes.</span></span>  <span data-ttu-id="0c3f0-187">Allo stesso modo per attività di manutenzione pianificate, quali le modifiche del sistema operativo guest, vengono aggiornati Cassandra e modifiche all'applicazione Controller di infrastruttura di Azure esegue gli aggiornamenti dei nodi hello in sequenza nel cluster hello.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-187">Similarly for planned maintenance activities like guest OS changes, Cassandra upgrades and application changes Azure Fabric Controller performs rolling upgrades of hello nodes in hello cluster.</span></span>  <span data-ttu-id="0c3f0-188">Pertanto cluster hello potrebbero verificarsi breve tempo di inattività per le partizioni di alcuni aggiornamenti in sequenza possono richiedere anche verso il basso alcuni nodi contemporaneamente.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-188">Rolling upgrades also may take down a few nodes at a time and hence hello cluster may experience brief downtime for a few partitions.</span></span> <span data-ttu-id="0c3f0-189">Tuttavia, non sarà persi a causa di ridondanza dell'archiviazione di Azure predefinita toohello dati hello.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-189">However, hello data will not be lost due toohello built-in Azure Storage redundancy.</span></span>  

<span data-ttu-id="0c3f0-190">Per i sistemi distribuiti tooAzure che non richiede la disponibilità elevata (ad esempio, 99,9 circa che è equivalente too8.76 ore/anno, vedere [la disponibilità elevata](http://en.wikipedia.org/wiki/High_availability) per informazioni dettagliate) è in grado di toorun con RF = 1 e livello di coerenza = uno.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-190">For systems deployed tooAzure that doesn’t require high availability (e.g. around 99.9 which is equivalent too8.76 hrs/year; see [High Availability](http://en.wikipedia.org/wiki/High_availability) for details) you may be able toorun with RF=1 and Consistency Level=ONE.</span></span>  <span data-ttu-id="0c3f0-191">Per le applicazioni con requisiti di disponibilità elevata, RF = 3 e livello di coerenza = QUORUM tollerano hello tempi di inattività di uno dei nodi di hello quello delle repliche hello.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-191">For applications with high availability requirements, RF=3 and Consistency Level=QUORUM will tolerate hello down time of one of hello nodes one of hello replicas.</span></span> <span data-ttu-id="0c3f0-192">RF = 1 nelle distribuzioni tradizionali (ad esempio locale) non possono essere utilizzati a causa di toohello possibile perdita di dati derivanti da problemi quali errori del disco.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-192">RF=1 in traditional deployments (e.g. on-premises) can’t be used due toohello possible data loss resulting from problems like disk failures.</span></span>   

## <a name="multi-region-deployment"></a><span data-ttu-id="0c3f0-193">Distribuzione in più aree</span><span class="sxs-lookup"><span data-stu-id="0c3f0-193">Multi-region Deployment</span></span>
<span data-ttu-id="0c3f0-194">Data center-supporto della replica e il modello di coerenza descritto in precedenza consente alla distribuzione di più aree hello predefinito hello senza hello del Cassandra necessario per qualsiasi strumenti esterni.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-194">Cassandra’s data-center-aware replication and consistency model described above helps with hello multi-region deployment out of hello box without hello need for any external tooling.</span></span> <span data-ttu-id="0c3f0-195">È piuttosto diverso dai database relazionali tradizionali hello in cui il programma di installazione di hello per il mirroring del database per le scritture più master può essere molto complessa.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-195">This is quite different from hello traditional relational databases where hello setup for database mirroring for multi-master writes can be quite complex.</span></span> <span data-ttu-id="0c3f0-196">Cassandra in un'area più imposta consente scenari di utilizzo di hello inclusi hello seguenti:</span><span class="sxs-lookup"><span data-stu-id="0c3f0-196">Cassandra in a multi-region set up can help with hello usage scenarios including hello following:</span></span>

<span data-ttu-id="0c3f0-197">**Distribuzione basati su prossimità:** applicazioni multi-tenant, con Cancella i mapping di utenti del tenant-a-regione, può essere tratto dalla latenza bassa del cluster con più aree di hello.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-197">**Proximity based deployment:** Multi-tenant applications, with clear mapping of tenant users -to-region, can be benefited by hello multi-region cluster’s low latencies.</span></span> <span data-ttu-id="0c3f0-198">Ad esempio una gestione learning sistemi per istituti di istruzione possono distribuire un cluster distribuito in Stati Uniti orientali e Stati Uniti occidentali aree tooserve hello rispettivi campus per transazionale nonché analitica.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-198">For example a learning management systems for educational institutions can deploy a distributed cluster in East US and West US regions tooserve hello respective campuses for transactional as well as analytics.</span></span> <span data-ttu-id="0c3f0-199">dati Hello possono localmente coerenti hello ora letture e scritture che possono essere alla fine coerenti in entrambe le aree hello.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-199">hello data can be locally consistent at hello time reads and writes and can be eventually consistent across both hello regions.</span></span> <span data-ttu-id="0c3f0-200">Sono disponibili altri esempi quali la distribuzione su supporti, e-commerce, e qualsiasi elemento serva alla base utenti concentrata geograficamente è un buon caso di utilizzo per questo modello di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-200">There are other examples like media distribution, e-commerce and anything and everything that serves geo concentrated user base is a good use case for this deployment model.</span></span>

<span data-ttu-id="0c3f0-201">**Disponibilità elevata:** la ridondanza è un fattore chiave per ottenere un'elevata disponibilità di software e hardware; per ulteriori informazioni, vedere la sezione sulla compilazione di sistemi cloud affidabili in Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-201">**High Availability:** Redundancy is a key factor in attaining high availability of software and hardware; see Building Reliable Cloud Systems on Microsoft Azure for details.</span></span> <span data-ttu-id="0c3f0-202">In Microsoft Azure, hello unica modalità affidabile per ottenere ridondanza true è la distribuzione di un cluster con più aree.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-202">On Microsoft Azure, hello only reliable way of achieving true redundancy is by deploying a multi-region cluster.</span></span> <span data-ttu-id="0c3f0-203">Le applicazioni possono essere distribuite in modalità attivo-attivo o attivo-passivo e se una delle aree di hello è attivo, gestione traffico di Azure è possibile reindirizzare regione attiva toohello di traffico.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-203">Applications can be deployed in an active-active or active-passive mode and if one of hello regions is down, Azure Traffic Manager can redirect traffic toohello active region.</span></span>  <span data-ttu-id="0c3f0-204">Con la distribuzione di un'area singola hello, se è la disponibilità di hello 99,9, una distribuzione con due aree può raggiungere una disponibilità di 99,9999 calcolato dalla formula hello: (1-(1-0.999) * (1-0,999)) * 100); hello di sopra della carta per i dettagli, vedere.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-204">With hello single region deployment, if hello availability is 99.9, a two-region deployment can attain an availability of 99.9999 computed by hello formula: (1-(1-0.999) * (1-0.999))*100); see hello above paper for details.</span></span>

<span data-ttu-id="0c3f0-205">**Ripristino di emergenza:** il cluster Cassandra con più aree, se correttamente progettato, può far fronte a potenziali interruzioni irreversibili del centro.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-205">**Disaster Recovery:** Multi-region Cassandra cluster, if properly designed, can withstand catastrophic data center outages.</span></span> <span data-ttu-id="0c3f0-206">Se un'area è attivo, hello applicazione distribuita tooother aree possono cominciare a gestire gli utenti finali di hello.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-206">If one region is down, hello application deployed tooother regions can start serving hello end users.</span></span> <span data-ttu-id="0c3f0-207">Analogamente a qualsiasi altre implementazioni continuità aziendale, un'applicazione hello ha toobe a tolleranza di perdita dei dati dei dati di hello nella pipeline asincrona hello.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-207">Like any other business continuity implementations, hello application has toobe tolerant for some data loss resulting from hello data in hello asynchronous pipeline.</span></span> <span data-ttu-id="0c3f0-208">Tuttavia, Cassandra, ripristino hello notevolmente il processo decisionale di hello tempo a disposizione processi di ripristino di database tradizionale.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-208">However, Cassandra makes hello recovery much swifter than hello time taken by traditional database recovery processes.</span></span> <span data-ttu-id="0c3f0-209">Figura 2 mostra il modello di distribuzione con più aree tipiche hello con otto nodi in ogni area.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-209">Figure 2 shows hello typical multi-region deployment model with eight nodes in each region.</span></span> <span data-ttu-id="0c3f0-210">Entrambe le aree sono immagini di mirror di loro per hello stesso di simmetria; progettazioni reale dipendono dal tipo di carico di lavoro hello (transazionale o analitico, ad esempio), RPO, RTO, la coerenza dei dati e i requisiti di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-210">Both regions are mirror images of each other for hello same of symmetry; real world designs depend on hello workload type (e.g. transactional or analytical), RPO, RTO, data consistency and availability requirements.</span></span>

![Distribuzione in più aree](./media/cassandra-nodejs/cassandra-linux2.png)

<span data-ttu-id="0c3f0-212">Figura 2: Distribuzione di Cassandra con più aree</span><span class="sxs-lookup"><span data-stu-id="0c3f0-212">Figure 2: Multi-region Cassandra deployment</span></span>

### <a name="network-integration"></a><span data-ttu-id="0c3f0-213">Integrazione della rete</span><span class="sxs-lookup"><span data-stu-id="0c3f0-213">Network Integration</span></span>
<span data-ttu-id="0c3f0-214">Set di macchine virtuali, reti tooprivate distribuito in due aree comunica con altri tramite un tunnel VPN.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-214">Sets of virtual machines deployed tooprivate networks located on two regions communicates with each other using a VPN tunnel.</span></span> <span data-ttu-id="0c3f0-215">tunnel VPN Hello connette due gateway software eseguito il provisioning durante il processo di distribuzione di rete hello.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-215">hello VPN tunnel connects two software gateways provisioned during hello network deployment process.</span></span> <span data-ttu-id="0c3f0-216">Entrambe le aree sono simili architettura di rete in termini di subnet "web" e "dati"; Rete di Azure consente di creare un numero di subnet hello e applicare gli ACL in base alle esigenze di sicurezza di rete.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-216">Both regions have similar network architecture in terms of “web” and “data” subnets; Azure networking allows hello creation of as many subnets as needed and apply ACLs as needed by network security.</span></span> <span data-ttu-id="0c3f0-217">Durante la progettazione della topologia cluster hello tra data center comunicazione latenza e hello impatto economico dell'hello rete traffico necessità toobe considerati.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-217">While designing hello cluster topology inter data center communication latency and hello economic impact of hello network traffic need toobe considered.</span></span>

### <a name="data-consistency-for-multi-data-center-deployment"></a><span data-ttu-id="0c3f0-218">Coerenza dei dati per la distribuzione in più data center</span><span class="sxs-lookup"><span data-stu-id="0c3f0-218">Data Consistency for Multi-Data Center Deployment</span></span>
<span data-ttu-id="0c3f0-219">Distributed toobe necessità di distribuzioni conoscenza dell'impatto di topologia di cluster hello sulla velocità effettiva e disponibilità elevata.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-219">Distributed deployments need toobe aware of hello cluster topology impact on throughput and high availability.</span></span> <span data-ttu-id="0c3f0-220">Hello RF e livello di coerenza toobe necessità selezionata in modo che hello quorum non dipende dalla disponibilità hello di tutti i centri dati hello.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-220">hello RF and Consistency Level need toobe selected in such way that hello quorum doesn’t depend on hello availability of all hello data centers.</span></span>
<span data-ttu-id="0c3f0-221">Per un sistema che richiede coerenza elevata, un LOCAL_QUORUM per il livello di coerenza (per le letture e scritture) per garantire che tale hello locale letture e scritture sono soddisfatti da hello locale nodi mentre i dati sono replicati in modo asincrono toohello data center remoti.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-221">For a system that needs high consistency, a LOCAL_QUORUM for consistency level (for reads and writes) will make sure that hello local reads and writes are satisfied from hello local nodes while data is replicated asynchronously toohello remote data centers.</span></span>  <span data-ttu-id="0c3f0-222">Tabella 2 riepiloga configurazione hello dettagli per cluster con più aree hello descritte più avanti in hello di rivalutazione.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-222">Table 2 summarizes hello configuration details for hello multi-region cluster outlined later in hello write up.</span></span>

<span data-ttu-id="0c3f0-223">**Configurazione del cluster Cassandra in due aree**</span><span class="sxs-lookup"><span data-stu-id="0c3f0-223">**Two-region Cassandra cluster configuration**</span></span>

| <span data-ttu-id="0c3f0-224">Parametro cluster</span><span class="sxs-lookup"><span data-stu-id="0c3f0-224">Cluster Parameter</span></span> | <span data-ttu-id="0c3f0-225">Valore</span><span class="sxs-lookup"><span data-stu-id="0c3f0-225">Value</span></span> | <span data-ttu-id="0c3f0-226">Osservazioni</span><span class="sxs-lookup"><span data-stu-id="0c3f0-226">Remarks</span></span> |
| --- | --- | --- |
| <span data-ttu-id="0c3f0-227">Number of Nodes (N)</span><span class="sxs-lookup"><span data-stu-id="0c3f0-227">Number of Nodes (N)</span></span> |<span data-ttu-id="0c3f0-228">8 + 8</span><span class="sxs-lookup"><span data-stu-id="0c3f0-228">8 + 8</span></span> |<span data-ttu-id="0c3f0-229">Numero totale di nodi nel cluster hello</span><span class="sxs-lookup"><span data-stu-id="0c3f0-229">Total number of nodes in hello cluster</span></span> |
| <span data-ttu-id="0c3f0-230">Replication Factor (RF)</span><span class="sxs-lookup"><span data-stu-id="0c3f0-230">Replication Factor (RF)</span></span> |<span data-ttu-id="0c3f0-231">3</span><span class="sxs-lookup"><span data-stu-id="0c3f0-231">3</span></span> |<span data-ttu-id="0c3f0-232">Numero di repliche di una determinata riga</span><span class="sxs-lookup"><span data-stu-id="0c3f0-232">Number of replicas of a given row</span></span> |
| <span data-ttu-id="0c3f0-233">Consistency Level (Write)</span><span class="sxs-lookup"><span data-stu-id="0c3f0-233">Consistency Level (Write)</span></span> |<span data-ttu-id="0c3f0-234">LOCAL_QUORUM [(sum(RF)/2) +1) = 4] risultato hello della formula hello viene arrotondato per difetto</span><span class="sxs-lookup"><span data-stu-id="0c3f0-234">LOCAL_QUORUM [(sum(RF)/2) +1) = 4] hello result of hello formula is rounded down</span></span> |<span data-ttu-id="0c3f0-235">2 nodi verranno scritti toohello primo centro di dati in modo sincrono; Hello aggiuntive 2 nodi necessari per il quorum verranno scritto in modo asincrono toohello 2nd datacenter.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-235">2 nodes will be written toohello first data center synchronously; hello additional 2 nodes needed for quorum will be written asynchronously toohello 2nd data center.</span></span> |
| <span data-ttu-id="0c3f0-236">Consistency Level (Read)</span><span class="sxs-lookup"><span data-stu-id="0c3f0-236">Consistency Level (Read)</span></span> |<span data-ttu-id="0c3f0-237">LOCAL_QUORUM ((RF/2) + 1) = 2 risultato hello della formula hello viene arrotondato per difetto</span><span class="sxs-lookup"><span data-stu-id="0c3f0-237">LOCAL_QUORUM ((RF/2) +1) = 2 hello result of hello formula is rounded down</span></span> |<span data-ttu-id="0c3f0-238">Richieste di lettura sono soddisfatti da una sola area; 2 nodi vengono lette prima dell'invio risposta hello client toohello indietro.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-238">Read requests are satisfied from only one region; 2 nodes are read before hello response is sent back toohello client.</span></span> |
| <span data-ttu-id="0c3f0-239">Replication Strategy</span><span class="sxs-lookup"><span data-stu-id="0c3f0-239">Replication Strategy</span></span> |<span data-ttu-id="0c3f0-240">NetworkTopologyStrategy: per ulteriori informazioni, vedere [Replica dei dati](http://www.datastax.com/documentation/cassandra/2.0/cassandra/architecture/architectureDataDistributeReplication_c.html) nella documentazione di Cassandra</span><span class="sxs-lookup"><span data-stu-id="0c3f0-240">NetworkTopologyStrategy see [Data Replication](http://www.datastax.com/documentation/cassandra/2.0/cassandra/architecture/architectureDataDistributeReplication_c.html) in Cassandra documentation for more information</span></span> |<span data-ttu-id="0c3f0-241">Riconosce la topologia di distribuzione hello e inserisce le repliche in nodi in modo che tutte le repliche di hello non finiscono in hello stesso rack</span><span class="sxs-lookup"><span data-stu-id="0c3f0-241">Understands hello deployment topology and places replicas on nodes so that all hello replicas don’t end up on hello same rack</span></span> |
| <span data-ttu-id="0c3f0-242">Snitch</span><span class="sxs-lookup"><span data-stu-id="0c3f0-242">Snitch</span></span> |<span data-ttu-id="0c3f0-243">GossipingPropertyFileSnitch: per ulteriori informazioni, vedere [Snitch](http://www.datastax.com/documentation/cassandra/2.0/cassandra/architecture/architectureSnitchesAbout_c.html) nella documentazione di Cassandra</span><span class="sxs-lookup"><span data-stu-id="0c3f0-243">GossipingPropertyFileSnitch see [Snitches](http://www.datastax.com/documentation/cassandra/2.0/cassandra/architecture/architectureSnitchesAbout_c.html) in Cassandra documentation for more information</span></span> |<span data-ttu-id="0c3f0-244">NetworkTopologyStrategy viene utilizzato un concetto di topologia di snitch toounderstand hello.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-244">NetworkTopologyStrategy uses a concept of snitch toounderstand hello topology.</span></span> <span data-ttu-id="0c3f0-245">GossipingPropertyFileSnitch offre un migliore controllo per eseguire il mapping di ogni centro toodata nodo e rack.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-245">GossipingPropertyFileSnitch gives better control in mapping each node toodata center and rack.</span></span> <span data-ttu-id="0c3f0-246">cluster Hello utilizza toopropagate possono quindi queste informazioni.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-246">hello cluster then uses gossip toopropagate this information.</span></span> <span data-ttu-id="0c3f0-247">Questo è molto più semplice dinamica tooPropertyFileSnitch relativo di impostazione IP</span><span class="sxs-lookup"><span data-stu-id="0c3f0-247">This is much simpler in dynamic IP setting relative tooPropertyFileSnitch</span></span> |

## <a name="hello-software-configuration"></a><span data-ttu-id="0c3f0-248">Hello configurazione SOFTWARE</span><span class="sxs-lookup"><span data-stu-id="0c3f0-248">hello SOFTWARE CONFIGURATION</span></span>
<span data-ttu-id="0c3f0-249">Hello seguenti versioni del software viene utilizzato durante la distribuzione di hello:</span><span class="sxs-lookup"><span data-stu-id="0c3f0-249">hello following software versions are used during hello deployment:</span></span>

<table>
<tr><th><span data-ttu-id="0c3f0-250">Software</span><span class="sxs-lookup"><span data-stu-id="0c3f0-250">Software</span></span></th><th><span data-ttu-id="0c3f0-251">Sorgente</span><span class="sxs-lookup"><span data-stu-id="0c3f0-251">Source</span></span></th><th><span data-ttu-id="0c3f0-252">Versione</span><span class="sxs-lookup"><span data-stu-id="0c3f0-252">Version</span></span></th></tr>
<tr><td><span data-ttu-id="0c3f0-253">JRE</span><span class="sxs-lookup"><span data-stu-id="0c3f0-253">JRE</span></span>    </td><td><span data-ttu-id="0c3f0-254">[JRE 8](http://www.oracle.com/technetwork/java/javase/downloads/server-jre8-downloads-2133154.html) </span><span class="sxs-lookup"><span data-stu-id="0c3f0-254">[JRE 8](http://www.oracle.com/technetwork/java/javase/downloads/server-jre8-downloads-2133154.html) </span></span></td><td><span data-ttu-id="0c3f0-255">8U5</span><span class="sxs-lookup"><span data-stu-id="0c3f0-255">8U5</span></span></td></tr>
<tr><td><span data-ttu-id="0c3f0-256">JNA</span><span class="sxs-lookup"><span data-stu-id="0c3f0-256">JNA</span></span>    </td><td><span data-ttu-id="0c3f0-257">[JNA](https://github.com/twall/jna) </span><span class="sxs-lookup"><span data-stu-id="0c3f0-257">[JNA](https://github.com/twall/jna) </span></span></td><td> <span data-ttu-id="0c3f0-258">3.2.7</span><span class="sxs-lookup"><span data-stu-id="0c3f0-258">3.2.7</span></span></td></tr>
<tr><td><span data-ttu-id="0c3f0-259">Cassandra</span><span class="sxs-lookup"><span data-stu-id="0c3f0-259">Cassandra</span></span></td><td>[<span data-ttu-id="0c3f0-260">Apache Cassandra 2.0.8</span><span class="sxs-lookup"><span data-stu-id="0c3f0-260">Apache Cassandra 2.0.8</span></span>](http://www.apache.org/dist/cassandra/2.0.8/apache-cassandra-2.0.8-bin.tar.gz)</td><td> <span data-ttu-id="0c3f0-261">2.0.8</span><span class="sxs-lookup"><span data-stu-id="0c3f0-261">2.0.8</span></span></td></tr>
<tr><td><span data-ttu-id="0c3f0-262">Ubuntu</span><span class="sxs-lookup"><span data-stu-id="0c3f0-262">Ubuntu</span></span>    </td><td><span data-ttu-id="0c3f0-263">[Microsoft Azure](https://azure.microsoft.com/) </span><span class="sxs-lookup"><span data-stu-id="0c3f0-263">[Microsoft Azure](https://azure.microsoft.com/) </span></span></td><td><span data-ttu-id="0c3f0-264">14.04 LTS</span><span class="sxs-lookup"><span data-stu-id="0c3f0-264">14.04 LTS</span></span></td></tr>
</table>

<span data-ttu-id="0c3f0-265">Poiché il download di JRE richiede l'accettazione manuale di licenza di Oracle, distribuzione hello toosimplify, download che tutti hello desktop toohello software richiesti per il caricamento in un secondo momento nell'immagine di modello Ubuntu hello che verrà creata come un cluster di toohello precursore distribuzione.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-265">Since downloading of JRE requires manual acceptance of Oracle license, toosimplify hello deployment, download all hello required software toohello desktop for later uploading into hello Ubuntu template image we will be creating as a precursor toohello cluster deployment.</span></span>

<span data-ttu-id="0c3f0-266">Scaricare hello sopra software in una directory di download noto (ad esempio %TEMP%/downloads in Windows o ~/Downloads nella maggior parte delle distribuzioni di Linux o Mac) nel computer locale hello.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-266">Download hello above software into a well-known download directory (e.g. %TEMP%/downloads on Windows or ~/Downloads on most Linux distributions or Mac) on hello local computer.</span></span>

### <a name="create-ubuntu-vm"></a><span data-ttu-id="0c3f0-267">CREARE UNA MACCHINA VIRTUALE UBUNTU</span><span class="sxs-lookup"><span data-stu-id="0c3f0-267">CREATE UBUNTU VM</span></span>
<span data-ttu-id="0c3f0-268">In questo passaggio del processo di hello è creerà Ubuntu immagine con il software prerequisito hello hello immagine può essere riutilizzato per il provisioning di più nodi Cassandra.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-268">In this step of hello process we will create Ubuntu image with hello pre-requisite software so that hello image can be reused for provisioning several Cassandra nodes.</span></span>  

#### <a name="step-1-generate-ssh-key-pair"></a><span data-ttu-id="0c3f0-269">PASSAGGIO 1: Generare la coppia di chiavi SSH</span><span class="sxs-lookup"><span data-stu-id="0c3f0-269">STEP 1: Generate SSH key pair</span></span>
<span data-ttu-id="0c3f0-270">È necessario un X509 chiave pubblica PEM o DER con codifica a provisioning ora hello Azure.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-270">Azure needs an X509 public key that is either PEM or DER encoded at hello provisioning time.</span></span> <span data-ttu-id="0c3f0-271">Generare una coppia di chiavi pubblica/privata utilizzando istruzioni hello si trova in che modo tooUse SSH con Linux in Azure.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-271">Generate a public/private key pair using hello instructions located at How tooUse SSH with Linux on Azure.</span></span> <span data-ttu-id="0c3f0-272">Se si prevede di toouse putty.exe come un client SSH nel server Windows o Linux, è necessario tooconvert hello PEM codificato formato tooPPK chiave privata RSA utilizzando puttygen.exe; istruzioni di Hello per questo oggetto sono reperibile in hello sopra la pagina web.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-272">If you plan toouse putty.exe as an SSH client either on Windows or Linux, you have tooconvert hello PEM encoded RSA private key tooPPK format using puttygen.exe; hello instructions for this can be found in hello above web page.</span></span>

#### <a name="step-2-create-ubuntu-template-vm"></a><span data-ttu-id="0c3f0-273">PASSAGGIO 2: Creare una macchina virtuale modello Ubuntu</span><span class="sxs-lookup"><span data-stu-id="0c3f0-273">STEP 2: Create Ubuntu template VM</span></span>
<span data-ttu-id="0c3f0-274">il modello di hello toocreate macchina virtuale, accedere a hello Azure classico hello portale e l'utilizzo seguente sequenza: fare clic su Nuovo, calcolo, macchina virtuale, da raccolta, UBUNTU, Ubuntu Server 14.04 LTS e quindi fare clic sulla freccia a destra di hello.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-274">toocreate hello template VM, log into hello Azure classic portal and use hello following sequence: Click NEW, COMPUTE, VIRTUAL MACHINE, FROM GALLERY, UBUNTU, Ubuntu Server 14.04 LTS, and then click hello right arrow.</span></span> <span data-ttu-id="0c3f0-275">Per un'esercitazione in cui viene descritto come toocreate una VM Linux, vedere Creazione di una macchina virtuale in esecuzione Linux.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-275">For a tutorial that describes how toocreate a Linux VM, see Create a Virtual Machine Running Linux.</span></span>

<span data-ttu-id="0c3f0-276">Immettere le seguenti informazioni nella schermata di hello "configurazione della macchina virtuale" #1 hello:</span><span class="sxs-lookup"><span data-stu-id="0c3f0-276">Enter hello following information on hello “Virtual machine configuration” screen #1:</span></span>

<table>
<tr><th><span data-ttu-id="0c3f0-277">NOME CAMPO</span><span class="sxs-lookup"><span data-stu-id="0c3f0-277">FIELD NAME</span></span>              </td><td>       <span data-ttu-id="0c3f0-278">VALORE CAMPO</span><span class="sxs-lookup"><span data-stu-id="0c3f0-278">FIELD VALUE</span></span>               </td><td>         <span data-ttu-id="0c3f0-279">OSSERVAZIONI</span><span class="sxs-lookup"><span data-stu-id="0c3f0-279">REMARKS</span></span>                </td><tr>
<tr><td><span data-ttu-id="0c3f0-280">DATA DI RILASCIO VERSIONE</span><span class="sxs-lookup"><span data-stu-id="0c3f0-280">VERSION RELEASE DATE</span></span>    </td><td> <span data-ttu-id="0c3f0-281">Selezionare una data hello elenco a discesa</span><span class="sxs-lookup"><span data-stu-id="0c3f0-281">Select a date from hello drop down</span></span></td><td></td><tr>
<tr><td><span data-ttu-id="0c3f0-282">NOME MACCHINA VIRTUALE</span><span class="sxs-lookup"><span data-stu-id="0c3f0-282">VIRTUAL MACHINE NAME</span></span>    </td><td> <span data-ttu-id="0c3f0-283">cass-template</span><span class="sxs-lookup"><span data-stu-id="0c3f0-283">cass-template</span></span>                   </td><td> <span data-ttu-id="0c3f0-284">Si tratta di nome host hello di hello VM</span><span class="sxs-lookup"><span data-stu-id="0c3f0-284">This is hello hostname of hello VM</span></span> </td><tr>
<tr><td><span data-ttu-id="0c3f0-285">LIVELLO</span><span class="sxs-lookup"><span data-stu-id="0c3f0-285">TIER</span></span>                     </td><td> <span data-ttu-id="0c3f0-286">STANDARD</span><span class="sxs-lookup"><span data-stu-id="0c3f0-286">STANDARD</span></span>                           </td><td> <span data-ttu-id="0c3f0-287">Lasciare l'impostazione predefinita hello</span><span class="sxs-lookup"><span data-stu-id="0c3f0-287">Leave hello default</span></span>              </td><tr>
<tr><td><span data-ttu-id="0c3f0-288">DIMENSIONE</span><span class="sxs-lookup"><span data-stu-id="0c3f0-288">SIZE</span></span>                     </td><td> <span data-ttu-id="0c3f0-289">A1</span><span class="sxs-lookup"><span data-stu-id="0c3f0-289">A1</span></span>                              </td><td><span data-ttu-id="0c3f0-290">È necessario seleziona hello che macchina virtuale in base a hello IO; a questo scopo lasciare l'impostazione predefinita di hello</span><span class="sxs-lookup"><span data-stu-id="0c3f0-290">Select hello VM based on hello IO needs; for this purpose leave hello default</span></span> </td><tr>
<tr><td> <span data-ttu-id="0c3f0-291">NUOVO NOME UTENTE</span><span class="sxs-lookup"><span data-stu-id="0c3f0-291">NEW USER NAME</span></span>             </td><td> <span data-ttu-id="0c3f0-292">localadmin</span><span class="sxs-lookup"><span data-stu-id="0c3f0-292">localadmin</span></span>                       </td><td> <span data-ttu-id="0c3f0-293">"admin" è un nome utente riservato in Ubuntu 12.xx e versioni successive</span><span class="sxs-lookup"><span data-stu-id="0c3f0-293">"admin" is a reserved user name in Ubuntu 12.xx and after</span></span></td><tr>
<tr><td> <span data-ttu-id="0c3f0-294">AUTENTICAZIONE</span><span class="sxs-lookup"><span data-stu-id="0c3f0-294">AUTHENTICATION</span></span>         </td><td> <span data-ttu-id="0c3f0-295">Fare clic sulla casella di controllo</span><span class="sxs-lookup"><span data-stu-id="0c3f0-295">Click check box</span></span>                 </td><td><span data-ttu-id="0c3f0-296">Selezionare se si desidera toosecure con una chiave SSH</span><span class="sxs-lookup"><span data-stu-id="0c3f0-296">Check if you want toosecure with an SSH key</span></span> </td><tr>
<tr><td> <span data-ttu-id="0c3f0-297">CERTIFICATO</span><span class="sxs-lookup"><span data-stu-id="0c3f0-297">CERTIFICATE</span></span>             </td><td> <span data-ttu-id="0c3f0-298">nome file del certificato di chiave pubblica hello</span><span class="sxs-lookup"><span data-stu-id="0c3f0-298">file name of hello public key certificate</span></span> </td><td> <span data-ttu-id="0c3f0-299">Usare hello chiave pubblica generata in precedenza</span><span class="sxs-lookup"><span data-stu-id="0c3f0-299">Use hello public key generated previously</span></span></td><tr>
<tr><td> <span data-ttu-id="0c3f0-300">Nuova password</span><span class="sxs-lookup"><span data-stu-id="0c3f0-300">New Password</span></span>    </td><td> <span data-ttu-id="0c3f0-301">password complessa</span><span class="sxs-lookup"><span data-stu-id="0c3f0-301">strong password</span></span> </td><td> </td><tr>
<tr><td> <span data-ttu-id="0c3f0-302">Confirm Password</span><span class="sxs-lookup"><span data-stu-id="0c3f0-302">Confirm Password</span></span>    </td><td> <span data-ttu-id="0c3f0-303">password complessa</span><span class="sxs-lookup"><span data-stu-id="0c3f0-303">strong password</span></span> </td><td></td><tr>
</table>

<span data-ttu-id="0c3f0-304">Immettere le seguenti informazioni nella schermata di hello "configurazione della macchina virtuale" #2 hello:</span><span class="sxs-lookup"><span data-stu-id="0c3f0-304">Enter hello following information on hello “Virtual machine configuration” screen #2:</span></span>

<table>
<tr><th><span data-ttu-id="0c3f0-305">NOME CAMPO</span><span class="sxs-lookup"><span data-stu-id="0c3f0-305">FIELD NAME</span></span>             </th><th> <span data-ttu-id="0c3f0-306">VALORE CAMPO</span><span class="sxs-lookup"><span data-stu-id="0c3f0-306">FIELD VALUE</span></span>                       </th><th> <span data-ttu-id="0c3f0-307">OSSERVAZIONI</span><span class="sxs-lookup"><span data-stu-id="0c3f0-307">REMARKS</span></span>                                 </th></tr>
<tr><td> <span data-ttu-id="0c3f0-308">SERVIZIO CLOUD</span><span class="sxs-lookup"><span data-stu-id="0c3f0-308">CLOUD SERVICE</span></span>    </td><td> <span data-ttu-id="0c3f0-309">Crea un nuovo servizio cloud</span><span class="sxs-lookup"><span data-stu-id="0c3f0-309">Create a new cloud service</span></span>    </td><td><span data-ttu-id="0c3f0-310">Il servizio cloud è un contenitore per le risorse di calcolo come le macchine virtuali</span><span class="sxs-lookup"><span data-stu-id="0c3f0-310">Cloud service is a container compute resources like virtual machines</span></span></td></tr>
<tr><td> <span data-ttu-id="0c3f0-311">NOME DNS DEL SERVIZIO CLOUD:</span><span class="sxs-lookup"><span data-stu-id="0c3f0-311">CLOUD SERVICE DNS NAME</span></span>    </td><td><span data-ttu-id="0c3f0-312">ubuntu-template.cloudapp.net</span><span class="sxs-lookup"><span data-stu-id="0c3f0-312">ubuntu-template.cloudapp.net</span></span>    </td><td><span data-ttu-id="0c3f0-313">Assegnare un nome bilanciamento del carico indipendente dal computer</span><span class="sxs-lookup"><span data-stu-id="0c3f0-313">Give a machine agnostic load balancer name</span></span></td></tr>
<tr><td> <span data-ttu-id="0c3f0-314">AREA/GRUPPO DI AFFINITÀ/RETE VIRTUALE</span><span class="sxs-lookup"><span data-stu-id="0c3f0-314">REGION/AFFINITY GROUP/VIRTUAL NETWORK</span></span> </td><td>    <span data-ttu-id="0c3f0-315">Stati Uniti occidentali</span><span class="sxs-lookup"><span data-stu-id="0c3f0-315">West US</span></span>    </td><td> <span data-ttu-id="0c3f0-316">Selezionare un'area da cui le applicazioni web di accesso cluster Cassandra hello</span><span class="sxs-lookup"><span data-stu-id="0c3f0-316">Select a region from which your web applications access hello Cassandra cluster</span></span></td></tr>
<tr><td><span data-ttu-id="0c3f0-317">ACCOUNT DI ARCHIVIAZIONE</span><span class="sxs-lookup"><span data-stu-id="0c3f0-317">STORAGE ACCOUNT</span></span> </td><td>    <span data-ttu-id="0c3f0-318">Usare l'impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-318">Use default</span></span>    </td><td><span data-ttu-id="0c3f0-319">Utilizzare l'account di archiviazione predefinito hello o un account di archiviazione creato in precedenza in una determinata area</span><span class="sxs-lookup"><span data-stu-id="0c3f0-319">Use hello default storage account  or a pre-created storage account in a particular region</span></span></td></tr>
<tr><td><span data-ttu-id="0c3f0-320">Set di disponibilità</span><span class="sxs-lookup"><span data-stu-id="0c3f0-320">AVAILABILITY SET</span></span> </td><td>    <span data-ttu-id="0c3f0-321">None</span><span class="sxs-lookup"><span data-stu-id="0c3f0-321">None</span></span> </td><td>    <span data-ttu-id="0c3f0-322">Lasciare vuoto</span><span class="sxs-lookup"><span data-stu-id="0c3f0-322">Leave it blank</span></span></td></tr>
<tr><td><span data-ttu-id="0c3f0-323">ENDPOINT</span><span class="sxs-lookup"><span data-stu-id="0c3f0-323">ENDPOINTS</span></span>    </td><td><span data-ttu-id="0c3f0-324">Usare l'impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-324">Use default</span></span> </td><td>    <span data-ttu-id="0c3f0-325">Utilizzare la configurazione SSH predefinito hello</span><span class="sxs-lookup"><span data-stu-id="0c3f0-325">Use hello default SSH configuration</span></span> </td></tr>
</table>

<span data-ttu-id="0c3f0-326">Fare clic sulla freccia destra, lasciare le impostazioni predefinite hello nella schermata di hello #3 e fare clic su hello "controllo" pulsante toocomplete hello VM processo di provisioning.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-326">Click right arrow, leave hello defaults on hello screen #3 and click hello “check” button toocomplete hello VM provisioning process.</span></span> <span data-ttu-id="0c3f0-327">Dopo alcuni minuti, hello VM con hello name "ubuntu-template" deve essere in uno stato "in esecuzione".</span><span class="sxs-lookup"><span data-stu-id="0c3f0-327">After a few minutes, hello VM with hello name “ubuntu-template” should be in a “running” status.</span></span>

### <a name="install-hello-necessary-software"></a><span data-ttu-id="0c3f0-328">INSTALLARE il SOFTWARE necessario hello</span><span class="sxs-lookup"><span data-stu-id="0c3f0-328">INSTALL hello NECESSARY SOFTWARE</span></span>
#### <a name="step-1-upload-tarballs"></a><span data-ttu-id="0c3f0-329">PASSAGGIO 1: Caricare i file tarball</span><span class="sxs-lookup"><span data-stu-id="0c3f0-329">STEP 1: Upload tarballs</span></span>
<span data-ttu-id="0c3f0-330">Tramite scp o pscp, hello copia scaricati in precedenza software troppo ~ directory di download con hello seguendo il formato di comando:</span><span class="sxs-lookup"><span data-stu-id="0c3f0-330">Using scp or pscp, copy hello previously downloaded software too~/downloads directory using hello following command format:</span></span>

##### <a name="pscp-server-jre-8u5-linux-x64targz-localadminhk-cas-templatecloudappnethomelocaladmindownloadsserver-jre-8u5-linux-x64targz"></a><span data-ttu-id="0c3f0-331">pscp server-jre-8u5-linux-x64.tar.gz localadmin@hk-cas-template.cloudapp.net:/home/localadmin/downloads/server-jre-8u5-linux-x64.tar.gz</span><span class="sxs-lookup"><span data-stu-id="0c3f0-331">pscp server-jre-8u5-linux-x64.tar.gz localadmin@hk-cas-template.cloudapp.net:/home/localadmin/downloads/server-jre-8u5-linux-x64.tar.gz</span></span>
<span data-ttu-id="0c3f0-332">Ripetere hello in precedenza di comando per JRE nonché per bits Cassandra hello.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-332">Repeat hello above command for JRE as well as for hello Cassandra bits.</span></span>

#### <a name="step-2-prepare-hello-directory-structure-and-extract-hello-archives"></a><span data-ttu-id="0c3f0-333">PASSAGGIO 2: Preparare la struttura di directory hello ed estrarre gli archivi hello</span><span class="sxs-lookup"><span data-stu-id="0c3f0-333">STEP 2: Prepare hello directory structure and extract hello archives</span></span>
<span data-ttu-id="0c3f0-334">Accedere a hello macchina virtuale e creare la struttura di directory hello ed estrarre software come un utente con privilegi avanzato tramite script bash hello riportato di seguito:</span><span class="sxs-lookup"><span data-stu-id="0c3f0-334">Log into hello VM and create hello directory structure and extract software as a super user using hello bash script below:</span></span>

    #!/bin/bash
    CASS_INSTALL_DIR="/opt/cassandra"
    JRE_INSTALL_DIR="/opt/java"
    CASS_DATA_DIR="/var/lib/cassandra"
    CASS_LOG_DIR="/var/log/cassandra"
    DOWNLOADS_DIR="~/downloads"
    JRE_TARBALL="server-jre-8u5-linux-x64.tar.gz"
    CASS_TARBALL="apache-cassandra-2.0.8-bin.tar.gz"
    SVC_USER="localadmin"

    RESET_ERROR=1
    MKDIR_ERROR=2

    reset_installation ()
    {
       rm -rf $CASS_INSTALL_DIR 2> /dev/null
       rm -rf $JRE_INSTALL_DIR 2> /dev/null
       rm -rf $CASS_DATA_DIR 2> /dev/null
       rm -rf $CASS_LOG_DIR 2> /dev/null
    }
    make_dir ()
    {
       if [ -z "$1" ]
       then
          echo "make_dir: invalid directory name"
          exit $MKDIR_ERROR
       fi

       if [ -d "$1" ]
       then
          echo "make_dir: directory already exists"
          exit $MKDIR_ERROR
       fi

       mkdir $1 2>/dev/null
       if [ $? != 0 ]
       then
          echo "directory creation failed"
          exit $MKDIR_ERROR
       fi
    }

    unzip()
    {
       if [ $# == 2 ]
       then
          tar xzf $1 -C $2
       else
          echo "archive error"
       fi

    }

    if [ -n "$1" ]
    then
       SVC_USER=$1
    fi

    reset_installation
    make_dir $CASS_INSTALL_DIR
    make_dir $JRE_INSTALL_DIR
    make_dir $CASS_DATA_DIR
    make_dir $CASS_LOG_DIR

    #unzip JRE and Cassandra
    unzip $HOME/downloads/$JRE_TARBALL $JRE_INSTALL_DIR
    unzip $HOME/downloads/$CASS_TARBALL $CASS_INSTALL_DIR

    #Change hello ownership toohello service credentials

    chown -R $SVC_USER:$GROUP $CASS_DATA_DIR
    chown -R $SVC_USER:$GROUP $CASS_LOG_DIR
    echo "edit /etc/profile tooadd JRE toohello PATH"
    echo "installation is complete"


<span data-ttu-id="0c3f0-335">Se si incolla questo script nella finestra vim, rendere ritorno a capo hello che tooremove restituito ('\r ") utilizzando hello comando seguente:</span><span class="sxs-lookup"><span data-stu-id="0c3f0-335">If you paste this script into vim window, make sure tooremove hello carriage return (‘\r”) using hello following command:</span></span>

    tr -d '\r' <infile.sh >outfile.sh

#### <a name="step-3-edit-etcprofile"></a><span data-ttu-id="0c3f0-336">Passaggio 3: Modificare etc/profile</span><span class="sxs-lookup"><span data-stu-id="0c3f0-336">Step 3: Edit etc/profile</span></span>
<span data-ttu-id="0c3f0-337">Aggiungere seguente hello al fine di hello:</span><span class="sxs-lookup"><span data-stu-id="0c3f0-337">Append hello following at hello end:</span></span>

    JAVA_HOME=/opt/java/jdk1.8.0_05
    CASS_HOME= /opt/cassandra/apache-cassandra-2.0.8
    PATH=$PATH:$HOME/bin:$JAVA_HOME/bin:$CASS_HOME/bin
    export JAVA_HOME
    export CASS_HOME
    export PATH

#### <a name="step-4-install-jna-for-production-systems"></a><span data-ttu-id="0c3f0-338">Passaggio 4: Installare JNA per i sistemi di produzione</span><span class="sxs-lookup"><span data-stu-id="0c3f0-338">Step 4: Install JNA for production systems</span></span>
<span data-ttu-id="0c3f0-339">Comando che segue di hello utilizzare sequenza: comando che segue hello installazione jna-3.2.7.jar e jna-piattaforma-3.2.7.jar too/usr/share.java directory sudo apt-get installerà libjna java</span><span class="sxs-lookup"><span data-stu-id="0c3f0-339">Use hello following command sequence: hello following command will install jna-3.2.7.jar and jna-platform-3.2.7.jar too/usr/share.java directory sudo apt-get install libjna-java</span></span>

<span data-ttu-id="0c3f0-340">Creare collegamenti simbolici nella directory $CASS_HOME/lib in modo che lo script di avvio di Cassandra possa trovare questi file jar:</span><span class="sxs-lookup"><span data-stu-id="0c3f0-340">Create symbolic links in $CASS_HOME/lib directory so that Cassandra startup script can find these jars:</span></span>

    ln -s /usr/share/java/jna-3.2.7.jar $CASS_HOME/lib/jna.jar

    ln -s /usr/share/java/jna-platform-3.2.7.jar $CASS_HOME/lib/jna-platform.jar

#### <a name="step-5-configure-cassandrayaml"></a><span data-ttu-id="0c3f0-341">Passaggio 5: Configurare cassandra.yaml</span><span class="sxs-lookup"><span data-stu-id="0c3f0-341">Step 5: Configure cassandra.yaml</span></span>
<span data-ttu-id="0c3f0-342">Modificare cassandra.yaml in ogni configurazione della macchina virtuale tooreflect necessarie per tutte le macchine virtuali hello [è verrà modificare questo durante il provisioning effettivo hello]:</span><span class="sxs-lookup"><span data-stu-id="0c3f0-342">Edit cassandra.yaml on each VM tooreflect configuration needed by all hello virtual machines [we will tweak this during hello actual provisioning]:</span></span>

<table>
<tr><th><span data-ttu-id="0c3f0-343">Nome campo</span><span class="sxs-lookup"><span data-stu-id="0c3f0-343">Field Name</span></span>   </th><th> <span data-ttu-id="0c3f0-344">Valore</span><span class="sxs-lookup"><span data-stu-id="0c3f0-344">Value</span></span>  </th><th>    <span data-ttu-id="0c3f0-345">Osservazioni</span><span class="sxs-lookup"><span data-stu-id="0c3f0-345">Remarks</span></span> </th></tr>
<tr><td><span data-ttu-id="0c3f0-346">cluster_name</span><span class="sxs-lookup"><span data-stu-id="0c3f0-346">cluster_name</span></span> </td><td>    <span data-ttu-id="0c3f0-347">"CustomerService"</span><span class="sxs-lookup"><span data-stu-id="0c3f0-347">“CustomerService”</span></span>    </td><td> <span data-ttu-id="0c3f0-348">Utilizza il nome di hello che riflette la distribuzione</span><span class="sxs-lookup"><span data-stu-id="0c3f0-348">Use hello name that reflects your deployment</span></span></td></tr>
<tr><td><span data-ttu-id="0c3f0-349">listen_address</span><span class="sxs-lookup"><span data-stu-id="0c3f0-349">listen_address</span></span>    </td><td><span data-ttu-id="0c3f0-350">[lasciare vuoto]</span><span class="sxs-lookup"><span data-stu-id="0c3f0-350">[leave it blank]</span></span>    </td><td> <span data-ttu-id="0c3f0-351">Eliminare "localhost"</span><span class="sxs-lookup"><span data-stu-id="0c3f0-351">Delete “localhost”</span></span> </td></tr>
<tr><td><span data-ttu-id="0c3f0-352">rpc_addres</span><span class="sxs-lookup"><span data-stu-id="0c3f0-352">rpc_addres</span></span>   </td><td><span data-ttu-id="0c3f0-353">[lasciare vuoto]</span><span class="sxs-lookup"><span data-stu-id="0c3f0-353">[leave it blank]</span></span>    </td><td> <span data-ttu-id="0c3f0-354">Eliminare "localhost"</span><span class="sxs-lookup"><span data-stu-id="0c3f0-354">Delete “localhost”</span></span> </td></tr>
<tr><td><span data-ttu-id="0c3f0-355">seeds</span><span class="sxs-lookup"><span data-stu-id="0c3f0-355">seeds</span></span>    </td><td><span data-ttu-id="0c3f0-356">"10.1.2.4, 10.1.2.6, 10.1.2.8"</span><span class="sxs-lookup"><span data-stu-id="0c3f0-356">"10.1.2.4, 10.1.2.6, 10.1.2.8"</span></span>    </td><td><span data-ttu-id="0c3f0-357">Elenco di tutti gli indirizzi IP hello designato come i valori di inizializzazione.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-357">List of  all hello IP addresses which are designated as seeds.</span></span></td></tr>
<tr><td><span data-ttu-id="0c3f0-358">endpoint_snitch</span><span class="sxs-lookup"><span data-stu-id="0c3f0-358">endpoint_snitch</span></span> </td><td> <span data-ttu-id="0c3f0-359">org.apache.cassandra.locator.GossipingPropertyFileSnitch</span><span class="sxs-lookup"><span data-stu-id="0c3f0-359">org.apache.cassandra.locator.GossipingPropertyFileSnitch</span></span> </td><td> <span data-ttu-id="0c3f0-360">Viene utilizzato da hello NetworkTopologyStrateg per l'inferenza hello data center e rack hello di hello VM</span><span class="sxs-lookup"><span data-stu-id="0c3f0-360">This is used by hello NetworkTopologyStrateg for inferring hello data center and hello rack of hello VM</span></span></td></tr>
</table>

#### <a name="step-6-capture-hello-vm-image"></a><span data-ttu-id="0c3f0-361">Passaggio 6: Acquisire l'immagine di macchina virtuale hello</span><span class="sxs-lookup"><span data-stu-id="0c3f0-361">Step 6: Capture hello VM image</span></span>
<span data-ttu-id="0c3f0-362">Accedere alla macchina virtuale hello usando nome host hello (hk-CA-template.cloudapp.net) e la chiave privata SSH hello creato in precedenza.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-362">Log into hello virtual machine using hello hostname (hk-cas-template.cloudapp.net) and hello SSH private key previously created.</span></span> <span data-ttu-id="0c3f0-363">Vedere come tooUse SSH con Linux in Azure per i dettagli relativi a come toolog utilizzando hello comando ssh o putty.exe.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-363">See How tooUse SSH with Linux on Azure for details on how toolog in using hello command ssh or putty.exe.</span></span>

<span data-ttu-id="0c3f0-364">Eseguire hello sequenza dell'immagine di hello toocapture azioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="0c3f0-364">Execute hello following sequence of actions toocapture hello image:</span></span>

##### <a name="1-deprovision"></a><span data-ttu-id="0c3f0-365">1. Effettuare il deprovisioning</span><span class="sxs-lookup"><span data-stu-id="0c3f0-365">1. Deprovision</span></span>
<span data-ttu-id="0c3f0-366">Comando hello "sudo waagent-deprovision + user" tooremove informazioni specifiche sull'istanza di macchina virtuale.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-366">Use hello command “sudo waagent –deprovision+user” tooremove Virtual Machine instance specific information.</span></span> <span data-ttu-id="0c3f0-367">Per vedere [come una macchina virtuale Linux tooCapture](capture-image.md) tooUse come modello ulteriori dettagli sul processo di acquisizione immagine hello.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-367">See for [How tooCapture a Linux Virtual Machine](capture-image.md) tooUse as a Template more details on hello image capture process.</span></span>

##### <a name="2-shutdown-hello-vm"></a><span data-ttu-id="0c3f0-368">2: hello arresto VM</span><span class="sxs-lookup"><span data-stu-id="0c3f0-368">2: Shutdown hello VM</span></span>
<span data-ttu-id="0c3f0-369">Verificare che la macchina virtuale hello è evidenziata e fare clic sul collegamento di arresto hello dalla barra dei comandi nella parte inferiore di hello.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-369">Make sure that hello virtual machine is highlighted and click hello SHUTDOWN link from hello bottom command bar.</span></span>

##### <a name="3-capture-hello-image"></a><span data-ttu-id="0c3f0-370">3: immagine di acquisizione hello</span><span class="sxs-lookup"><span data-stu-id="0c3f0-370">3: Capture hello image</span></span>
<span data-ttu-id="0c3f0-371">Verificare che la macchina virtuale hello è evidenziata e fare clic sul collegamento di acquisizione hello dalla barra dei comandi nella parte inferiore di hello.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-371">Make sure that hello virtual machine is highlighted and click hello CAPTURE link from hello bottom command bar.</span></span> <span data-ttu-id="0c3f0-372">Nella schermata successiva hello, assegnare un nome di immagine (ad esempio hk-cas-2-08-ub-14-04-2014071), la descrizione dell'immagine appropriata e fare clic su processo di acquisizione hello toofinish contrassegno "controllo" hello.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-372">In hello next screen, give an IMAGE NAME (e.g. hk-cas-2-08-ub-14-04-2014071), appropriate IMAGE DESCRIPTION, and click hello “check” mark toofinish hello CAPTURE process.</span></span>

<span data-ttu-id="0c3f0-373">L'operazione richiederà alcuni secondi e l'immagine hello deve essere disponibile nella sezione immagini personali della raccolta immagini hello.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-373">This will take a few seconds and hello image should be available in MY IMAGES section of hello image gallery.</span></span> <span data-ttu-id="0c3f0-374">macchina virtuale di origine Hello verrà eliminati automaticamente dopo l'immagine di hello viene acquisita.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-374">hello source VM will be automatically deleted after hello image is successfully captured.</span></span> 

## <a name="single-region-deployment-process"></a><span data-ttu-id="0c3f0-375">Processo di distribuzione in un'area singola</span><span class="sxs-lookup"><span data-stu-id="0c3f0-375">Single Region Deployment Process</span></span>
<span data-ttu-id="0c3f0-376">**Passaggio 1: Creare una rete virtuale hello** accedere hello portale di Azure e creare una rete virtuale (classica) con gli attributi di hello mostrata nella seguente tabella hello.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-376">**Step 1: Create hello Virtual Network** Log into hello Azure portal and create a virtual network (classic) with hello attributes shown in hello following table.</span></span> <span data-ttu-id="0c3f0-377">Vedere [creare una rete virtuale (classico) usando il portale di Azure hello](../../../virtual-network/virtual-networks-create-vnet-classic-pportal.md) per i passaggi dettagliati del processo di hello.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-377">See [Create a virtual network (classic) using hello Azure portal](../../../virtual-network/virtual-networks-create-vnet-classic-pportal.md) for detailed steps of hello process.</span></span>      

<table>
<tr><th><span data-ttu-id="0c3f0-378">Nome attributo macchina virtuale</span><span class="sxs-lookup"><span data-stu-id="0c3f0-378">VM Attribute Name</span></span></th><th><span data-ttu-id="0c3f0-379">Valore</span><span class="sxs-lookup"><span data-stu-id="0c3f0-379">Value</span></span></th><th><span data-ttu-id="0c3f0-380">Osservazioni</span><span class="sxs-lookup"><span data-stu-id="0c3f0-380">Remarks</span></span></th></tr>
<tr><td><span data-ttu-id="0c3f0-381">Nome</span><span class="sxs-lookup"><span data-stu-id="0c3f0-381">Name</span></span></td><td><span data-ttu-id="0c3f0-382">vnet-cass-west-us</span><span class="sxs-lookup"><span data-stu-id="0c3f0-382">vnet-cass-west-us</span></span></td><td></td></tr>
<tr><td><span data-ttu-id="0c3f0-383">Region</span><span class="sxs-lookup"><span data-stu-id="0c3f0-383">Region</span></span></td><td><span data-ttu-id="0c3f0-384">Stati Uniti occidentali</span><span class="sxs-lookup"><span data-stu-id="0c3f0-384">West US</span></span></td><td></td></tr>
<tr><td><span data-ttu-id="0c3f0-385">Server DNS</span><span class="sxs-lookup"><span data-stu-id="0c3f0-385">DNS Servers</span></span></td><td><span data-ttu-id="0c3f0-386">None</span><span class="sxs-lookup"><span data-stu-id="0c3f0-386">None</span></span></td><td><span data-ttu-id="0c3f0-387">Ignorare questo attributo perché non si userà un server DNS</span><span class="sxs-lookup"><span data-stu-id="0c3f0-387">Ignore this as we are not using a DNS Server</span></span></td></tr>
<tr><td><span data-ttu-id="0c3f0-388">Spazio di indirizzi</span><span class="sxs-lookup"><span data-stu-id="0c3f0-388">Address Space</span></span></td><td><span data-ttu-id="0c3f0-389">10.1.0.0/16</span><span class="sxs-lookup"><span data-stu-id="0c3f0-389">10.1.0.0/16</span></span></td><td></td></tr>    
<tr><td><span data-ttu-id="0c3f0-390">IP iniziale</span><span class="sxs-lookup"><span data-stu-id="0c3f0-390">Starting IP</span></span></td><td><span data-ttu-id="0c3f0-391">10.1.0.0</span><span class="sxs-lookup"><span data-stu-id="0c3f0-391">10.1.0.0</span></span></td><td></td></tr>    
<tr><td><span data-ttu-id="0c3f0-392">CIDR</span><span class="sxs-lookup"><span data-stu-id="0c3f0-392">CIDR</span></span> </td><td><span data-ttu-id="0c3f0-393">/16 (65531)</span><span class="sxs-lookup"><span data-stu-id="0c3f0-393">/16 (65531)</span></span></td><td></td></tr>
</table>

<span data-ttu-id="0c3f0-394">Aggiungere hello seguenti subnet:</span><span class="sxs-lookup"><span data-stu-id="0c3f0-394">Add hello following subnets:</span></span>

<table>
<tr><th><span data-ttu-id="0c3f0-395">Nome</span><span class="sxs-lookup"><span data-stu-id="0c3f0-395">Name</span></span></th><th><span data-ttu-id="0c3f0-396">IP iniziale</span><span class="sxs-lookup"><span data-stu-id="0c3f0-396">Starting IP</span></span></th><th><span data-ttu-id="0c3f0-397">CIDR</span><span class="sxs-lookup"><span data-stu-id="0c3f0-397">CIDR</span></span></th><th><span data-ttu-id="0c3f0-398">Osservazioni</span><span class="sxs-lookup"><span data-stu-id="0c3f0-398">Remarks</span></span></th></tr>
<tr><td><span data-ttu-id="0c3f0-399">Web</span><span class="sxs-lookup"><span data-stu-id="0c3f0-399">web</span></span></td><td><span data-ttu-id="0c3f0-400">10.1.1.0</span><span class="sxs-lookup"><span data-stu-id="0c3f0-400">10.1.1.0</span></span></td><td><span data-ttu-id="0c3f0-401">/24 (251)</span><span class="sxs-lookup"><span data-stu-id="0c3f0-401">/24 (251)</span></span></td><td><span data-ttu-id="0c3f0-402">Subnet per farm web hello</span><span class="sxs-lookup"><span data-stu-id="0c3f0-402">Subnet for hello web farm</span></span></td></tr>
<tr><td><span data-ttu-id="0c3f0-403">data</span><span class="sxs-lookup"><span data-stu-id="0c3f0-403">data</span></span></td><td><span data-ttu-id="0c3f0-404">10.1.2.0</span><span class="sxs-lookup"><span data-stu-id="0c3f0-404">10.1.2.0</span></span></td><td><span data-ttu-id="0c3f0-405">/24 (251)</span><span class="sxs-lookup"><span data-stu-id="0c3f0-405">/24 (251)</span></span></td><td><span data-ttu-id="0c3f0-406">Subnet per i nodi database hello</span><span class="sxs-lookup"><span data-stu-id="0c3f0-406">Subnet for hello database nodes</span></span></td></tr>
</table>

<span data-ttu-id="0c3f0-407">Dati e le subnet Web possono essere protetti tramite i gruppi di sicurezza di rete coverage hello che esula dall'ambito di questo articolo.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-407">Data and Web subnets can be protected through network security groups hello coverage of which is out of scope for this article.</span></span>  

<span data-ttu-id="0c3f0-408">**Passaggio 2: Eseguire il provisioning le macchine virtuali** usando l'immagine di hello creato in precedenza, verrà creato hello seguenti macchine virtuali nel cloud hello server "hk-c-svc-Ovest" e associarle toohello rispettive subnet come illustrato di seguito:</span><span class="sxs-lookup"><span data-stu-id="0c3f0-408">**Step 2: Provision Virtual Machines** Using hello image created previously, we will create hello following virtual machines in hello cloud server “hk-c-svc-west” and bind them toohello respective subnets as shown below:</span></span>

<table>
<tr><th><span data-ttu-id="0c3f0-409">Nome computer</span><span class="sxs-lookup"><span data-stu-id="0c3f0-409">Machine Name</span></span>    </th><th><span data-ttu-id="0c3f0-410">Subnet</span><span class="sxs-lookup"><span data-stu-id="0c3f0-410">Subnet</span></span>    </th><th><span data-ttu-id="0c3f0-411">Indirizzo IP</span><span class="sxs-lookup"><span data-stu-id="0c3f0-411">IP Address</span></span>    </th><th><span data-ttu-id="0c3f0-412">Set di disponibilità</span><span class="sxs-lookup"><span data-stu-id="0c3f0-412">Availability set</span></span></th><th><span data-ttu-id="0c3f0-413">DC/Rack</span><span class="sxs-lookup"><span data-stu-id="0c3f0-413">DC/Rack</span></span></th><th><span data-ttu-id="0c3f0-414">Valore di inizializzazione?</span><span class="sxs-lookup"><span data-stu-id="0c3f0-414">Seed?</span></span></th></tr>
<tr><td><span data-ttu-id="0c3f0-415">hk-c1-west-us</span><span class="sxs-lookup"><span data-stu-id="0c3f0-415">hk-c1-west-us</span></span>    </td><td><span data-ttu-id="0c3f0-416">data</span><span class="sxs-lookup"><span data-stu-id="0c3f0-416">data</span></span>    </td><td><span data-ttu-id="0c3f0-417">10.1.2.4</span><span class="sxs-lookup"><span data-stu-id="0c3f0-417">10.1.2.4</span></span>    </td><td><span data-ttu-id="0c3f0-418">hk-c-aset-1</span><span class="sxs-lookup"><span data-stu-id="0c3f0-418">hk-c-aset-1</span></span>    </td><td><span data-ttu-id="0c3f0-419">dc =WESTUS rack =rack1</span><span class="sxs-lookup"><span data-stu-id="0c3f0-419">dc =WESTUS rack =rack1</span></span> </td><td><span data-ttu-id="0c3f0-420">Sì</span><span class="sxs-lookup"><span data-stu-id="0c3f0-420">Yes</span></span></td></tr>
<tr><td><span data-ttu-id="0c3f0-421">hk-c2-west-us</span><span class="sxs-lookup"><span data-stu-id="0c3f0-421">hk-c2-west-us</span></span>    </td><td><span data-ttu-id="0c3f0-422">data</span><span class="sxs-lookup"><span data-stu-id="0c3f0-422">data</span></span>    </td><td><span data-ttu-id="0c3f0-423">10.1.2.5</span><span class="sxs-lookup"><span data-stu-id="0c3f0-423">10.1.2.5</span></span>    </td><td><span data-ttu-id="0c3f0-424">hk-c-aset-1</span><span class="sxs-lookup"><span data-stu-id="0c3f0-424">hk-c-aset-1</span></span>    </td><td><span data-ttu-id="0c3f0-425">dc =WESTUS rack =rack1</span><span class="sxs-lookup"><span data-stu-id="0c3f0-425">dc =WESTUS rack =rack1</span></span>    </td><td><span data-ttu-id="0c3f0-426">No</span><span class="sxs-lookup"><span data-stu-id="0c3f0-426">No</span></span> </td></tr>
<tr><td><span data-ttu-id="0c3f0-427">hk-c3-west-us</span><span class="sxs-lookup"><span data-stu-id="0c3f0-427">hk-c3-west-us</span></span>    </td><td><span data-ttu-id="0c3f0-428">data</span><span class="sxs-lookup"><span data-stu-id="0c3f0-428">data</span></span>    </td><td><span data-ttu-id="0c3f0-429">10.1.2.6</span><span class="sxs-lookup"><span data-stu-id="0c3f0-429">10.1.2.6</span></span>    </td><td><span data-ttu-id="0c3f0-430">hk-c-aset-1</span><span class="sxs-lookup"><span data-stu-id="0c3f0-430">hk-c-aset-1</span></span>    </td><td><span data-ttu-id="0c3f0-431">dc =WESTUS rack =rack2</span><span class="sxs-lookup"><span data-stu-id="0c3f0-431">dc =WESTUS rack =rack2</span></span>    </td><td><span data-ttu-id="0c3f0-432">Sì</span><span class="sxs-lookup"><span data-stu-id="0c3f0-432">Yes</span></span></td></tr>
<tr><td><span data-ttu-id="0c3f0-433">hk-c4-west-us</span><span class="sxs-lookup"><span data-stu-id="0c3f0-433">hk-c4-west-us</span></span>    </td><td><span data-ttu-id="0c3f0-434">data</span><span class="sxs-lookup"><span data-stu-id="0c3f0-434">data</span></span>    </td><td><span data-ttu-id="0c3f0-435">10.1.2.7</span><span class="sxs-lookup"><span data-stu-id="0c3f0-435">10.1.2.7</span></span>    </td><td><span data-ttu-id="0c3f0-436">hk-c-aset-1</span><span class="sxs-lookup"><span data-stu-id="0c3f0-436">hk-c-aset-1</span></span>    </td><td><span data-ttu-id="0c3f0-437">dc =WESTUS rack =rack2</span><span class="sxs-lookup"><span data-stu-id="0c3f0-437">dc =WESTUS rack =rack2</span></span>    </td><td><span data-ttu-id="0c3f0-438">No</span><span class="sxs-lookup"><span data-stu-id="0c3f0-438">No</span></span> </td></tr>
<tr><td><span data-ttu-id="0c3f0-439">hk-c5-west-us</span><span class="sxs-lookup"><span data-stu-id="0c3f0-439">hk-c5-west-us</span></span>    </td><td><span data-ttu-id="0c3f0-440">data</span><span class="sxs-lookup"><span data-stu-id="0c3f0-440">data</span></span>    </td><td><span data-ttu-id="0c3f0-441">10.1.2.8</span><span class="sxs-lookup"><span data-stu-id="0c3f0-441">10.1.2.8</span></span>    </td><td><span data-ttu-id="0c3f0-442">hk-c-aset-2</span><span class="sxs-lookup"><span data-stu-id="0c3f0-442">hk-c-aset-2</span></span>    </td><td><span data-ttu-id="0c3f0-443">dc =WESTUS rack =rack3</span><span class="sxs-lookup"><span data-stu-id="0c3f0-443">dc =WESTUS rack =rack3</span></span>    </td><td><span data-ttu-id="0c3f0-444">Sì</span><span class="sxs-lookup"><span data-stu-id="0c3f0-444">Yes</span></span></td></tr>
<tr><td><span data-ttu-id="0c3f0-445">hk-c6-west-us</span><span class="sxs-lookup"><span data-stu-id="0c3f0-445">hk-c6-west-us</span></span>    </td><td><span data-ttu-id="0c3f0-446">data</span><span class="sxs-lookup"><span data-stu-id="0c3f0-446">data</span></span>    </td><td><span data-ttu-id="0c3f0-447">10.1.2.9</span><span class="sxs-lookup"><span data-stu-id="0c3f0-447">10.1.2.9</span></span>    </td><td><span data-ttu-id="0c3f0-448">hk-c-aset-2</span><span class="sxs-lookup"><span data-stu-id="0c3f0-448">hk-c-aset-2</span></span>    </td><td><span data-ttu-id="0c3f0-449">dc =WESTUS rack =rack3</span><span class="sxs-lookup"><span data-stu-id="0c3f0-449">dc =WESTUS rack =rack3</span></span>    </td><td><span data-ttu-id="0c3f0-450">No</span><span class="sxs-lookup"><span data-stu-id="0c3f0-450">No</span></span> </td></tr>
<tr><td><span data-ttu-id="0c3f0-451">hk-c7-west-us</span><span class="sxs-lookup"><span data-stu-id="0c3f0-451">hk-c7-west-us</span></span>    </td><td><span data-ttu-id="0c3f0-452">data</span><span class="sxs-lookup"><span data-stu-id="0c3f0-452">data</span></span>    </td><td><span data-ttu-id="0c3f0-453">10.1.2.10</span><span class="sxs-lookup"><span data-stu-id="0c3f0-453">10.1.2.10</span></span>    </td><td><span data-ttu-id="0c3f0-454">hk-c-aset-2</span><span class="sxs-lookup"><span data-stu-id="0c3f0-454">hk-c-aset-2</span></span>    </td><td><span data-ttu-id="0c3f0-455">dc =WESTUS rack =rack4</span><span class="sxs-lookup"><span data-stu-id="0c3f0-455">dc =WESTUS rack =rack4</span></span>    </td><td><span data-ttu-id="0c3f0-456">Sì</span><span class="sxs-lookup"><span data-stu-id="0c3f0-456">Yes</span></span></td></tr>
<tr><td><span data-ttu-id="0c3f0-457">hk-c8-west-us</span><span class="sxs-lookup"><span data-stu-id="0c3f0-457">hk-c8-west-us</span></span>    </td><td><span data-ttu-id="0c3f0-458">data</span><span class="sxs-lookup"><span data-stu-id="0c3f0-458">data</span></span>    </td><td><span data-ttu-id="0c3f0-459">10.1.2.11</span><span class="sxs-lookup"><span data-stu-id="0c3f0-459">10.1.2.11</span></span>    </td><td><span data-ttu-id="0c3f0-460">hk-c-aset-2</span><span class="sxs-lookup"><span data-stu-id="0c3f0-460">hk-c-aset-2</span></span>    </td><td><span data-ttu-id="0c3f0-461">dc =WESTUS rack =rack4</span><span class="sxs-lookup"><span data-stu-id="0c3f0-461">dc =WESTUS rack =rack4</span></span>    </td><td><span data-ttu-id="0c3f0-462">No</span><span class="sxs-lookup"><span data-stu-id="0c3f0-462">No</span></span> </td></tr>
<tr><td><span data-ttu-id="0c3f0-463">hk-w1-west-us</span><span class="sxs-lookup"><span data-stu-id="0c3f0-463">hk-w1-west-us</span></span>    </td><td><span data-ttu-id="0c3f0-464">Web</span><span class="sxs-lookup"><span data-stu-id="0c3f0-464">web</span></span>    </td><td><span data-ttu-id="0c3f0-465">10.1.1.4</span><span class="sxs-lookup"><span data-stu-id="0c3f0-465">10.1.1.4</span></span>    </td><td><span data-ttu-id="0c3f0-466">hk-w-aset-1</span><span class="sxs-lookup"><span data-stu-id="0c3f0-466">hk-w-aset-1</span></span>    </td><td>                       </td><td><span data-ttu-id="0c3f0-467">N/D</span><span class="sxs-lookup"><span data-stu-id="0c3f0-467">N/A</span></span></td></tr>
<tr><td><span data-ttu-id="0c3f0-468">hk-w2-west-us</span><span class="sxs-lookup"><span data-stu-id="0c3f0-468">hk-w2-west-us</span></span>    </td><td><span data-ttu-id="0c3f0-469">Web</span><span class="sxs-lookup"><span data-stu-id="0c3f0-469">web</span></span>    </td><td><span data-ttu-id="0c3f0-470">10.1.1.5</span><span class="sxs-lookup"><span data-stu-id="0c3f0-470">10.1.1.5</span></span>    </td><td><span data-ttu-id="0c3f0-471">hk-w-aset-1</span><span class="sxs-lookup"><span data-stu-id="0c3f0-471">hk-w-aset-1</span></span>    </td><td>                       </td><td><span data-ttu-id="0c3f0-472">N/D</span><span class="sxs-lookup"><span data-stu-id="0c3f0-472">N/A</span></span></td></tr>
</table>

<span data-ttu-id="0c3f0-473">Creazione di hello sopra l'elenco di macchine virtuali, è necessario hello seguente processo:</span><span class="sxs-lookup"><span data-stu-id="0c3f0-473">Creation of hello above list of VMs requires hello following process:</span></span>

1. <span data-ttu-id="0c3f0-474">Creare un servizio cloud vuoto in una determinata area</span><span class="sxs-lookup"><span data-stu-id="0c3f0-474">Create an empty cloud service in a particular region</span></span>
2. <span data-ttu-id="0c3f0-475">Creare una macchina virtuale dall'immagine acquisita in precedenza hello e collegarla toohello rete virtuale creata in precedenza. Ripetere questo passaggio per tutte le macchine virtuali hello</span><span class="sxs-lookup"><span data-stu-id="0c3f0-475">Create a VM from hello previously captured image and attach it toohello virtual network created previously; repeat this for all hello VMs</span></span>
3. <span data-ttu-id="0c3f0-476">Aggiungere un servizio cloud toohello di bilanciamento del carico interno e collegarlo subnet toohello "dati"</span><span class="sxs-lookup"><span data-stu-id="0c3f0-476">Add an internal load balancer toohello cloud service and attach it toohello “data” subnet</span></span>
4. <span data-ttu-id="0c3f0-477">Per ogni macchina virtuale creata in precedenza, aggiungere un endpoint con carico bilanciato per il traffico thrift attraverso un bilanciamento del carico interno di toohello creato in precedenza connesso set con carico bilanciato</span><span class="sxs-lookup"><span data-stu-id="0c3f0-477">For each VM created previously, add a load balanced endpoint for thrift traffic through a load balanced set connected toohello previously created internal load balancer</span></span>

<span data-ttu-id="0c3f0-478">Hello sopra processo può essere eseguita utilizzando portale di Azure classico; Utilizzare un computer Windows (usare una macchina virtuale in Azure se non si dispone di una macchina Windows tooa di accesso), usare automaticamente tutte le macchine 8 virtuali hello tooprovision script PowerShell seguente.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-478">hello above process can be executed using Azure classic portal; use a Windows machine (use a VM on Azure if you don't have access tooa Windows machine), use hello following PowerShell script tooprovision all 8 VMs automatically.</span></span>

<span data-ttu-id="0c3f0-479">**Elenco 1: script di PowerShell per il provisioning delle macchine virtuali**</span><span class="sxs-lookup"><span data-stu-id="0c3f0-479">**List 1: PowerShell script for provisioning virtual machines**</span></span>

        #Tested with Azure Powershell - November 2014
        #This powershell script deployes a number of VMs from an existing image inside an Azure region
        #Import your Azure subscription into hello current Powershell session before proceeding
        #hello process: 1. create Azure Storage account, 2. create virtual network, 3.create hello VM template, 2. crate a list of VMs from hello template

        #fundamental variables - change these tooreflect your subscription
        $country="us"; $region="west"; $vnetName = "your_vnet_name";$storageAccount="your_storage_account"
        $numVMs=8;$prefix = "hk-cass";$ilbIP="your_ilb_ip"
        $subscriptionName = "Azure_subscription_name";
        $vmSize="ExtraSmall"; $imageName="your_linux_image_name"
        $ilbName="ThriftInternalLB"; $thriftEndPoint="ThriftEndPoint"

        #generated variables
        $serviceName = "$prefix-svc-$region-$country"; $azureRegion = "$region $country"

        $vmNames = @()
        for ($i=0; $i -lt $numVMs; $i++)
        {
           $vmNames+=("$prefix-vm"+($i+1) + "-$region-$country" );
        }

        #select an Azure subscription already imported into Powershell session
        Select-AzureSubscription -SubscriptionName $subscriptionName -Current
        Set-AzureSubscription -SubscriptionName $subscriptionName -CurrentStorageAccountName $storageAccount

        #create an empty cloud service
        New-AzureService -ServiceName $serviceName -Label "hkcass$region" -Location $azureRegion
        Write-Host "Created $serviceName"

        $VMList= @()   # stores hello list of azure vm configuration objects
        #create hello list of VMs
        foreach($vmName in $vmNames)
        {
           $VMList += New-AzureVMConfig -Name $vmName -InstanceSize ExtraSmall -ImageName $imageName |
           Add-AzureProvisioningConfig -Linux -LinuxUser "localadmin" -Password "Local123" |
           Set-AzureSubnet "data"
        }

        New-AzureVM -ServiceName $serviceName -VNetName $vnetName -VMs $VMList

        #Create internal load balancer
        Add-AzureInternalLoadBalancer -ServiceName $serviceName -InternalLoadBalancerName $ilbName -SubnetName "data" -StaticVNetIPAddress "$ilbIP"
        Write-Host "Created $ilbName"
        #Add add hello thrift endpoint toohello internal load balancer for all hello VMs
        foreach($vmName in $vmNames)
        {
            Get-AzureVM -ServiceName $serviceName -Name $vmName |
                Add-AzureEndpoint -Name $thriftEndPoint -LBSetName "ThriftLBSet" -Protocol tcp -LocalPort 9160 -PublicPort 9160 -ProbePort 9160 -ProbeProtocol tcp -ProbeIntervalInSeconds 10 -InternalLoadBalancerName $ilbName |
                Update-AzureVM

            Write-Host "created $vmName"     
        }

<span data-ttu-id="0c3f0-480">**Passaggio 3: Configurare Cassandra in ogni macchina virtuale**</span><span class="sxs-lookup"><span data-stu-id="0c3f0-480">**Step 3: Configure Cassandra on each VM**</span></span>

<span data-ttu-id="0c3f0-481">Accedere hello VM ed effettuare hello seguenti:</span><span class="sxs-lookup"><span data-stu-id="0c3f0-481">Log into hello VM and perform hello following:</span></span>

* <span data-ttu-id="0c3f0-482">Modificare $CASS_HOME/conf/cassandra-rackdc.properties toospecify hello data center e rack proprietà:</span><span class="sxs-lookup"><span data-stu-id="0c3f0-482">Edit $CASS_HOME/conf/cassandra-rackdc.properties toospecify hello data center and rack properties:</span></span>
  
       dc =EASTUS, rack =rack1
* <span data-ttu-id="0c3f0-483">Modificare i nodi di inizializzazione tooconfigure cassandra.yaml come indicato di seguito:</span><span class="sxs-lookup"><span data-stu-id="0c3f0-483">Edit cassandra.yaml tooconfigure seed nodes as below:</span></span>
  
       Seeds: "10.1.2.4,10.1.2.6,10.1.2.8,10.1.2.10"

<span data-ttu-id="0c3f0-484">**Passaggio 4: Avviare le macchine virtuali hello e test hello del cluster**</span><span class="sxs-lookup"><span data-stu-id="0c3f0-484">**Step 4: Start hello VMs and test hello cluster**</span></span>

<span data-ttu-id="0c3f0-485">Log in uno dei nodi di hello (ad esempio hk-c1-occidentale, Stati Uniti) e hello esecuzione seguendo lo stato del comando toosee hello del cluster hello:</span><span class="sxs-lookup"><span data-stu-id="0c3f0-485">Log into one of hello nodes (e.g. hk-c1-west-us) and run hello following command toosee hello status of hello cluster:</span></span>

       nodetool –h 10.1.2.4 –p 7199 status

<span data-ttu-id="0c3f0-486">È necessario visualizzare hello visualizzazione simili toohello uno di seguito per un cluster di 8 nodi:</span><span class="sxs-lookup"><span data-stu-id="0c3f0-486">You should see hello display similar toohello one below for an 8-node cluster:</span></span>

<table>
<tr><th><span data-ttu-id="0c3f0-487">Stato</span><span class="sxs-lookup"><span data-stu-id="0c3f0-487">Status</span></span></th><th><span data-ttu-id="0c3f0-488">Indirizzo</span><span class="sxs-lookup"><span data-stu-id="0c3f0-488">Address</span></span>    </th><th><span data-ttu-id="0c3f0-489">chiudi</span><span class="sxs-lookup"><span data-stu-id="0c3f0-489">Load</span></span>    </th><th><span data-ttu-id="0c3f0-490">Tokens</span><span class="sxs-lookup"><span data-stu-id="0c3f0-490">Tokens</span></span>    </th><th><span data-ttu-id="0c3f0-491">Owns</span><span class="sxs-lookup"><span data-stu-id="0c3f0-491">Owns</span></span> </th><th><span data-ttu-id="0c3f0-492">Host ID</span><span class="sxs-lookup"><span data-stu-id="0c3f0-492">Host ID</span></span>    </th><th><span data-ttu-id="0c3f0-493">Rack</span><span class="sxs-lookup"><span data-stu-id="0c3f0-493">Rack</span></span></th></tr>
<tr><th><span data-ttu-id="0c3f0-494">UN</span><span class="sxs-lookup"><span data-stu-id="0c3f0-494">UN</span></span>    </td><td><span data-ttu-id="0c3f0-495">10.1.2.4</span><span class="sxs-lookup"><span data-stu-id="0c3f0-495">10.1.2.4</span></span>     </td><td><span data-ttu-id="0c3f0-496">87,81 KB</span><span class="sxs-lookup"><span data-stu-id="0c3f0-496">87.81 KB</span></span>    </td><td><span data-ttu-id="0c3f0-497">256</span><span class="sxs-lookup"><span data-stu-id="0c3f0-497">256</span></span>    </td><td><span data-ttu-id="0c3f0-498">38,0%</span><span class="sxs-lookup"><span data-stu-id="0c3f0-498">38.0%</span></span>    </td><td><span data-ttu-id="0c3f0-499">Guid (removed)</span><span class="sxs-lookup"><span data-stu-id="0c3f0-499">Guid (removed)</span></span></td><td><span data-ttu-id="0c3f0-500">rack1</span><span class="sxs-lookup"><span data-stu-id="0c3f0-500">rack1</span></span></td></tr>
<tr><th><span data-ttu-id="0c3f0-501">UN</span><span class="sxs-lookup"><span data-stu-id="0c3f0-501">UN</span></span>    </td><td><span data-ttu-id="0c3f0-502">10.1.2.5</span><span class="sxs-lookup"><span data-stu-id="0c3f0-502">10.1.2.5</span></span>     </td><td><span data-ttu-id="0c3f0-503">41,08 KB</span><span class="sxs-lookup"><span data-stu-id="0c3f0-503">41.08 KB</span></span>    </td><td><span data-ttu-id="0c3f0-504">256</span><span class="sxs-lookup"><span data-stu-id="0c3f0-504">256</span></span>    </td><td><span data-ttu-id="0c3f0-505">68,9% </span><span class="sxs-lookup"><span data-stu-id="0c3f0-505">68.9%</span></span>    </td><td><span data-ttu-id="0c3f0-506">Guid (removed)</span><span class="sxs-lookup"><span data-stu-id="0c3f0-506">Guid (removed)</span></span></td><td><span data-ttu-id="0c3f0-507">rack1</span><span class="sxs-lookup"><span data-stu-id="0c3f0-507">rack1</span></span></td></tr>
<tr><th><span data-ttu-id="0c3f0-508">UN</span><span class="sxs-lookup"><span data-stu-id="0c3f0-508">UN</span></span>    </td><td><span data-ttu-id="0c3f0-509">10.1.2.6</span><span class="sxs-lookup"><span data-stu-id="0c3f0-509">10.1.2.6</span></span>     </td><td><span data-ttu-id="0c3f0-510">55,29 KB</span><span class="sxs-lookup"><span data-stu-id="0c3f0-510">55.29 KB</span></span>    </td><td><span data-ttu-id="0c3f0-511">256</span><span class="sxs-lookup"><span data-stu-id="0c3f0-511">256</span></span>    </td><td><span data-ttu-id="0c3f0-512">68,8%</span><span class="sxs-lookup"><span data-stu-id="0c3f0-512">68.8%</span></span>    </td><td><span data-ttu-id="0c3f0-513">Guid (removed)</span><span class="sxs-lookup"><span data-stu-id="0c3f0-513">Guid (removed)</span></span></td><td><span data-ttu-id="0c3f0-514">rack2</span><span class="sxs-lookup"><span data-stu-id="0c3f0-514">rack2</span></span></td></tr>
<tr><th><span data-ttu-id="0c3f0-515">UN</span><span class="sxs-lookup"><span data-stu-id="0c3f0-515">UN</span></span>    </td><td><span data-ttu-id="0c3f0-516">10.1.2.7</span><span class="sxs-lookup"><span data-stu-id="0c3f0-516">10.1.2.7</span></span>     </td><td><span data-ttu-id="0c3f0-517">55,29 KB</span><span class="sxs-lookup"><span data-stu-id="0c3f0-517">55.29 KB</span></span>    </td><td><span data-ttu-id="0c3f0-518">256</span><span class="sxs-lookup"><span data-stu-id="0c3f0-518">256</span></span>    </td><td><span data-ttu-id="0c3f0-519">68,8%</span><span class="sxs-lookup"><span data-stu-id="0c3f0-519">68.8%</span></span>    </td><td><span data-ttu-id="0c3f0-520">Guid (removed)</span><span class="sxs-lookup"><span data-stu-id="0c3f0-520">Guid (removed)</span></span></td><td><span data-ttu-id="0c3f0-521">rack2</span><span class="sxs-lookup"><span data-stu-id="0c3f0-521">rack2</span></span></td></tr>
<tr><th><span data-ttu-id="0c3f0-522">UN</span><span class="sxs-lookup"><span data-stu-id="0c3f0-522">UN</span></span>    </td><td><span data-ttu-id="0c3f0-523">10.1.2.8</span><span class="sxs-lookup"><span data-stu-id="0c3f0-523">10.1.2.8</span></span>     </td><td><span data-ttu-id="0c3f0-524">55,29 KB</span><span class="sxs-lookup"><span data-stu-id="0c3f0-524">55.29 KB</span></span>    </td><td><span data-ttu-id="0c3f0-525">256</span><span class="sxs-lookup"><span data-stu-id="0c3f0-525">256</span></span>    </td><td><span data-ttu-id="0c3f0-526">68,8%</span><span class="sxs-lookup"><span data-stu-id="0c3f0-526">68.8%</span></span>    </td><td><span data-ttu-id="0c3f0-527">Guid (removed)</span><span class="sxs-lookup"><span data-stu-id="0c3f0-527">Guid (removed)</span></span></td><td><span data-ttu-id="0c3f0-528">rack3</span><span class="sxs-lookup"><span data-stu-id="0c3f0-528">rack3</span></span></td></tr>
<tr><th><span data-ttu-id="0c3f0-529">UN</span><span class="sxs-lookup"><span data-stu-id="0c3f0-529">UN</span></span>    </td><td><span data-ttu-id="0c3f0-530">10.1.2.9</span><span class="sxs-lookup"><span data-stu-id="0c3f0-530">10.1.2.9</span></span>     </td><td><span data-ttu-id="0c3f0-531">55,29 KB</span><span class="sxs-lookup"><span data-stu-id="0c3f0-531">55.29 KB</span></span>    </td><td><span data-ttu-id="0c3f0-532">256</span><span class="sxs-lookup"><span data-stu-id="0c3f0-532">256</span></span>    </td><td><span data-ttu-id="0c3f0-533">68,8%</span><span class="sxs-lookup"><span data-stu-id="0c3f0-533">68.8%</span></span>    </td><td><span data-ttu-id="0c3f0-534">Guid (removed)</span><span class="sxs-lookup"><span data-stu-id="0c3f0-534">Guid (removed)</span></span></td><td><span data-ttu-id="0c3f0-535">rack3</span><span class="sxs-lookup"><span data-stu-id="0c3f0-535">rack3</span></span></td></tr>
<tr><th><span data-ttu-id="0c3f0-536">UN</span><span class="sxs-lookup"><span data-stu-id="0c3f0-536">UN</span></span>    </td><td><span data-ttu-id="0c3f0-537">10.1.2.10</span><span class="sxs-lookup"><span data-stu-id="0c3f0-537">10.1.2.10</span></span>     </td><td><span data-ttu-id="0c3f0-538">55,29 KB</span><span class="sxs-lookup"><span data-stu-id="0c3f0-538">55.29 KB</span></span>    </td><td><span data-ttu-id="0c3f0-539">256</span><span class="sxs-lookup"><span data-stu-id="0c3f0-539">256</span></span>    </td><td><span data-ttu-id="0c3f0-540">68,8%</span><span class="sxs-lookup"><span data-stu-id="0c3f0-540">68.8%</span></span>    </td><td><span data-ttu-id="0c3f0-541">Guid (removed)</span><span class="sxs-lookup"><span data-stu-id="0c3f0-541">Guid (removed)</span></span></td><td><span data-ttu-id="0c3f0-542">rack4</span><span class="sxs-lookup"><span data-stu-id="0c3f0-542">rack4</span></span></td></tr>
<tr><th><span data-ttu-id="0c3f0-543">UN</span><span class="sxs-lookup"><span data-stu-id="0c3f0-543">UN</span></span>    </td><td><span data-ttu-id="0c3f0-544">10.1.2.11</span><span class="sxs-lookup"><span data-stu-id="0c3f0-544">10.1.2.11</span></span>     </td><td><span data-ttu-id="0c3f0-545">55,29 KB</span><span class="sxs-lookup"><span data-stu-id="0c3f0-545">55.29 KB</span></span>    </td><td><span data-ttu-id="0c3f0-546">256</span><span class="sxs-lookup"><span data-stu-id="0c3f0-546">256</span></span>    </td><td><span data-ttu-id="0c3f0-547">68,8%</span><span class="sxs-lookup"><span data-stu-id="0c3f0-547">68.8%</span></span>    </td><td><span data-ttu-id="0c3f0-548">Guid (removed)</span><span class="sxs-lookup"><span data-stu-id="0c3f0-548">Guid (removed)</span></span></td><td><span data-ttu-id="0c3f0-549">rack4</span><span class="sxs-lookup"><span data-stu-id="0c3f0-549">rack4</span></span></td></tr>
</table>

## <a name="test-hello-single-region-cluster"></a><span data-ttu-id="0c3f0-550">Hello test singolo Cluster di area</span><span class="sxs-lookup"><span data-stu-id="0c3f0-550">Test hello Single Region Cluster</span></span>
<span data-ttu-id="0c3f0-551">Utilizzare hello cluster hello tootest di passaggi seguente:</span><span class="sxs-lookup"><span data-stu-id="0c3f0-551">Use hello following steps tootest hello cluster:</span></span>

1. <span data-ttu-id="0c3f0-552">Utilizzando il cmdlet Get-AzureInternalLoadbalancer comandi Powershell di hello, ottenere l'indirizzo IP hello del bilanciamento del carico interno hello (ad esempio  10.1.2.101).</span><span class="sxs-lookup"><span data-stu-id="0c3f0-552">Using hello Powershell command Get-AzureInternalLoadbalancer commandlet, obtain hello IP address of hello internal load balancer (e.g.  10.1.2.101).</span></span> <span data-ttu-id="0c3f0-553">sintassi di Hello del comando hello è illustrata di seguito: Get-AzureLoadbalancer – ServiceName "hk-c-svc--Stati Uniti occidentali" [Visualizza i dettagli di hello di bilanciamento del carico interno hello con il relativo indirizzo IP]</span><span class="sxs-lookup"><span data-stu-id="0c3f0-553">hello syntax of hello command is shown below: Get-AzureLoadbalancer –ServiceName "hk-c-svc-west-us” [displays hello details of hello internal load balancer along with its IP address]</span></span>
2. <span data-ttu-id="0c3f0-554">Log in farm web hello VM (ad esempio hk-w1-occidentale, Stati Uniti) tramite Putty o ssh</span><span class="sxs-lookup"><span data-stu-id="0c3f0-554">Log into hello web farm VM (e.g. hk-w1-west-us) using Putty or ssh</span></span>
3. <span data-ttu-id="0c3f0-555">Eseguire $CASS_HOME/bin/cqlsh 10.1.2.101 9160</span><span class="sxs-lookup"><span data-stu-id="0c3f0-555">Execute $CASS_HOME/bin/cqlsh 10.1.2.101 9160</span></span>
4. <span data-ttu-id="0c3f0-556">Utilizzare hello seguente CQL comandi tooverify se hello cluster sia attivo:</span><span class="sxs-lookup"><span data-stu-id="0c3f0-556">Use hello following CQL commands tooverify if hello cluster is working:</span></span>
   
     <span data-ttu-id="0c3f0-557">CREATE KEYSPACE customers_ks WITH REPLICATION = { 'class' : 'SimpleStrategy', 'replication_factor' : 3 };   USE customers_ks;   CREATE TABLE Customers(customer_id int PRIMARY KEY, firstname text, lastname text);   INSERT INTO Customers(customer_id, firstname, lastname) VALUES(1, 'John', 'Doe');   INSERT INTO Customers(customer_id, firstname, lastname) VALUES (2, 'Jane', 'Doe');</span><span class="sxs-lookup"><span data-stu-id="0c3f0-557">CREATE KEYSPACE customers_ks WITH REPLICATION = { 'class' : 'SimpleStrategy', 'replication_factor' : 3 };   USE customers_ks;   CREATE TABLE Customers(customer_id int PRIMARY KEY, firstname text, lastname text);   INSERT INTO Customers(customer_id, firstname, lastname) VALUES(1, 'John', 'Doe');   INSERT INTO Customers(customer_id, firstname, lastname) VALUES (2, 'Jane', 'Doe');</span></span>
   
     <span data-ttu-id="0c3f0-558">SELECT * FROM Customers;</span><span class="sxs-lookup"><span data-stu-id="0c3f0-558">SELECT * FROM Customers;</span></span>

<span data-ttu-id="0c3f0-559">È necessario visualizzare una visualizzazione simile hello sotto:</span><span class="sxs-lookup"><span data-stu-id="0c3f0-559">You should see a display like hello one below:</span></span>

<table>
  <tr><th> <span data-ttu-id="0c3f0-560">customer_id</span><span class="sxs-lookup"><span data-stu-id="0c3f0-560">customer_id</span></span> </th><th> <span data-ttu-id="0c3f0-561">firstname</span><span class="sxs-lookup"><span data-stu-id="0c3f0-561">firstname</span></span> </th><th> <span data-ttu-id="0c3f0-562">Lastname</span><span class="sxs-lookup"><span data-stu-id="0c3f0-562">lastname</span></span> </th></tr>
  <tr><td> <span data-ttu-id="0c3f0-563">1</span><span class="sxs-lookup"><span data-stu-id="0c3f0-563">1</span></span> </td><td> <span data-ttu-id="0c3f0-564">John</span><span class="sxs-lookup"><span data-stu-id="0c3f0-564">John</span></span> </td><td> <span data-ttu-id="0c3f0-565">Doe</span><span class="sxs-lookup"><span data-stu-id="0c3f0-565">Doe</span></span> </td></tr>
  <tr><td> <span data-ttu-id="0c3f0-566">2</span><span class="sxs-lookup"><span data-stu-id="0c3f0-566">2</span></span> </td><td> <span data-ttu-id="0c3f0-567">Jane</span><span class="sxs-lookup"><span data-stu-id="0c3f0-567">Jane</span></span> </td><td> <span data-ttu-id="0c3f0-568">Doe</span><span class="sxs-lookup"><span data-stu-id="0c3f0-568">Doe</span></span> </td></tr>
</table>

<span data-ttu-id="0c3f0-569">Si noti che spazio delle chiavi hello creato nel passaggio 4 utilizza SimpleStrategy con un replication_factor 3.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-569">Please note that hello keyspace created in step 4 uses SimpleStrategy with a  replication_factor of 3.</span></span> <span data-ttu-id="0c3f0-570">SimpleStrategy è consigliato per le distribuzioni in un data center singolo, NetworkTopologyStrategy invece per le distribuzioni in più data center.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-570">SimpleStrategy is recommended for single data center deployments whereas NetworkTopologyStrategy for multi-data center deployments.</span></span> <span data-ttu-id="0c3f0-571">Un replication_factor pari a 3 garantirà la tolleranza per gli errori dei nodi.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-571">A replication_factor of 3 will give tolerance for node failures.</span></span>

## <span data-ttu-id="0c3f0-572"><a id="tworegion"> </a>Processo di distribuzione in più aree</span><span class="sxs-lookup"><span data-stu-id="0c3f0-572"><a id="tworegion"> </a>Multi-Region Deployment Process</span></span>
<span data-ttu-id="0c3f0-573">Verrà sfruttare una distribuzione di un'area singola hello completata e ripetere hello stessa procedura per installare una seconda area hello.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-573">Will leverage hello single region deployment completed and repeat hello same process for installing hello second region.</span></span> <span data-ttu-id="0c3f0-574">Hello chiave differenza hello singolo e di distribuzione in un'area più è l'installazione di tunnel VPN hello per le comunicazioni tra area; si avvia con installazione di rete hello, effettuare il provisioning di macchine virtuali hello e configurare Cassandra.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-574">hello key difference between hello single and multiple region deployment is hello VPN tunnel setup for inter-region communication; we will start with hello network installation, provision hello VMs and configure Cassandra.</span></span>

### <a name="step-1-create-hello-virtual-network-at-hello-2nd-region"></a><span data-ttu-id="0c3f0-575">Passaggio 1: Creare una rete virtuale hello in hello area 2a</span><span class="sxs-lookup"><span data-stu-id="0c3f0-575">Step 1: Create hello Virtual Network at hello 2nd Region</span></span>
<span data-ttu-id="0c3f0-576">Accedere al portale di Azure classico hello e creare una rete virtuale con Mostra attributi hello nella tabella hello.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-576">Log into hello Azure classic portal and create a Virtual Network with hello attributes show in hello table.</span></span> <span data-ttu-id="0c3f0-577">Vedere [configurare una rete virtuale nel portale di Azure classico hello](../../../virtual-network/virtual-networks-create-vnet-classic-pportal.md) per i passaggi dettagliati del processo di hello.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-577">See [Configure a Cloud-Only Virtual Network in hello Azure classic portal](../../../virtual-network/virtual-networks-create-vnet-classic-pportal.md) for detailed steps of hello process.</span></span>      

<table>
<tr><th><span data-ttu-id="0c3f0-578">Nome attributo</span><span class="sxs-lookup"><span data-stu-id="0c3f0-578">Attribute Name</span></span>    </th><th><span data-ttu-id="0c3f0-579">Valore</span><span class="sxs-lookup"><span data-stu-id="0c3f0-579">Value</span></span>    </th><th><span data-ttu-id="0c3f0-580">Osservazioni</span><span class="sxs-lookup"><span data-stu-id="0c3f0-580">Remarks</span></span></th></tr>
<tr><td><span data-ttu-id="0c3f0-581">Nome</span><span class="sxs-lookup"><span data-stu-id="0c3f0-581">Name</span></span>    </td><td><span data-ttu-id="0c3f0-582">vnet-cass-east-us</span><span class="sxs-lookup"><span data-stu-id="0c3f0-582">vnet-cass-east-us</span></span></td><td></td></tr>
<tr><td><span data-ttu-id="0c3f0-583">Region</span><span class="sxs-lookup"><span data-stu-id="0c3f0-583">Region</span></span>    </td><td><span data-ttu-id="0c3f0-584">Stati Uniti orientali</span><span class="sxs-lookup"><span data-stu-id="0c3f0-584">East US</span></span></td><td></td></tr>
<tr><td><span data-ttu-id="0c3f0-585">Server DNS</span><span class="sxs-lookup"><span data-stu-id="0c3f0-585">DNS Servers</span></span>        </td><td></td><td><span data-ttu-id="0c3f0-586">Ignorare questo attributo perché non si userà un server DNS</span><span class="sxs-lookup"><span data-stu-id="0c3f0-586">Ignore this as we are not using a DNS Server</span></span></td></tr>
<tr><td><span data-ttu-id="0c3f0-587">Configura una VPN Point-to-Site</span><span class="sxs-lookup"><span data-stu-id="0c3f0-587">Configure a point-to-site VPN</span></span></td><td></td><td>        <span data-ttu-id="0c3f0-588">Ignorare questo attributo</span><span class="sxs-lookup"><span data-stu-id="0c3f0-588">Ignore this</span></span></td></tr>
<tr><td><span data-ttu-id="0c3f0-589">Configura una VPN Site-to-Site</span><span class="sxs-lookup"><span data-stu-id="0c3f0-589">Configure a site-to-site VPN</span></span></td><td></td><td>        <span data-ttu-id="0c3f0-590">Ignorare questo attributo</span><span class="sxs-lookup"><span data-stu-id="0c3f0-590">Ignore this</span></span></td></tr>
<tr><td><span data-ttu-id="0c3f0-591">Spazio di indirizzi</span><span class="sxs-lookup"><span data-stu-id="0c3f0-591">Address Space</span></span>    </td><td><span data-ttu-id="0c3f0-592">10.2.0.0/16</span><span class="sxs-lookup"><span data-stu-id="0c3f0-592">10.2.0.0/16</span></span></td><td></td></tr>
<tr><td><span data-ttu-id="0c3f0-593">IP iniziale</span><span class="sxs-lookup"><span data-stu-id="0c3f0-593">Starting IP</span></span>    </td><td><span data-ttu-id="0c3f0-594">10.2.0.0</span><span class="sxs-lookup"><span data-stu-id="0c3f0-594">10.2.0.0</span></span>    </td><td></td></tr>
<tr><td><span data-ttu-id="0c3f0-595">CIDR</span><span class="sxs-lookup"><span data-stu-id="0c3f0-595">CIDR</span></span>    </td><td><span data-ttu-id="0c3f0-596">/16 (65531)</span><span class="sxs-lookup"><span data-stu-id="0c3f0-596">/16 (65531)</span></span></td><td></td></tr>
</table>

<span data-ttu-id="0c3f0-597">Aggiungere hello seguenti subnet:</span><span class="sxs-lookup"><span data-stu-id="0c3f0-597">Add hello following subnets:</span></span>

<table>
<tr><th><span data-ttu-id="0c3f0-598">Nome</span><span class="sxs-lookup"><span data-stu-id="0c3f0-598">Name</span></span>    </th><th><span data-ttu-id="0c3f0-599">IP iniziale</span><span class="sxs-lookup"><span data-stu-id="0c3f0-599">Starting IP</span></span>    </th><th><span data-ttu-id="0c3f0-600">CIDR</span><span class="sxs-lookup"><span data-stu-id="0c3f0-600">CIDR</span></span>    </th><th><span data-ttu-id="0c3f0-601">Osservazioni</span><span class="sxs-lookup"><span data-stu-id="0c3f0-601">Remarks</span></span></th></tr>
<tr><td><span data-ttu-id="0c3f0-602">Web</span><span class="sxs-lookup"><span data-stu-id="0c3f0-602">web</span></span>    </td><td><span data-ttu-id="0c3f0-603">10.2.1.0</span><span class="sxs-lookup"><span data-stu-id="0c3f0-603">10.2.1.0</span></span>    </td><td><span data-ttu-id="0c3f0-604">/24 (251)</span><span class="sxs-lookup"><span data-stu-id="0c3f0-604">/24 (251)</span></span>    </td><td><span data-ttu-id="0c3f0-605">Subnet per farm web hello</span><span class="sxs-lookup"><span data-stu-id="0c3f0-605">Subnet for hello web farm</span></span></td></tr>
<tr><td><span data-ttu-id="0c3f0-606">data</span><span class="sxs-lookup"><span data-stu-id="0c3f0-606">data</span></span>    </td><td><span data-ttu-id="0c3f0-607">10.2.2.0</span><span class="sxs-lookup"><span data-stu-id="0c3f0-607">10.2.2.0</span></span>    </td><td><span data-ttu-id="0c3f0-608">/24 (251)</span><span class="sxs-lookup"><span data-stu-id="0c3f0-608">/24 (251)</span></span>    </td><td><span data-ttu-id="0c3f0-609">Subnet per i nodi database hello</span><span class="sxs-lookup"><span data-stu-id="0c3f0-609">Subnet for hello database nodes</span></span></td></tr>
</table>


### <a name="step-2-create-local-networks"></a><span data-ttu-id="0c3f0-610">Passaggio 2: Creazione delle reti locali</span><span class="sxs-lookup"><span data-stu-id="0c3f0-610">Step 2: Create Local Networks</span></span>
<span data-ttu-id="0c3f0-611">Una rete locale nella rete virtuale di Azure è uno spazio di indirizzi proxy che esegue il mapping del sito remoto di tooa tra un cloud privato o un'altra area di Azure.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-611">A Local Network in Azure virtual networking is a proxy address space that maps tooa remote site including a private cloud or another Azure region.</span></span> <span data-ttu-id="0c3f0-612">Questo spazio di indirizzi proxy è associata tooa gateway remoto per routing toohello rete direttamente le destinazioni di rete.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-612">This proxy address space is bound tooa remote gateway for routing network toohello right networking destinations.</span></span> <span data-ttu-id="0c3f0-613">Vedere [configurare tooVNet una rete virtuale connessione](../../../vpn-gateway/virtual-networks-configure-vnet-to-vnet-connection.md) per istruzioni hello sulla connessione di rete virtuale a.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-613">See [Configure a VNet tooVNet Connection](../../../vpn-gateway/virtual-networks-configure-vnet-to-vnet-connection.md) for hello instructions on establishing VNET-to-VNET connection.</span></span>

<span data-ttu-id="0c3f0-614">Creare due reti locali per hello seguenti dettagli:</span><span class="sxs-lookup"><span data-stu-id="0c3f0-614">Create two local networks per hello following details:</span></span>

| <span data-ttu-id="0c3f0-615">Nome rete</span><span class="sxs-lookup"><span data-stu-id="0c3f0-615">Network Name</span></span> | <span data-ttu-id="0c3f0-616">Indirizzo gateway VPN</span><span class="sxs-lookup"><span data-stu-id="0c3f0-616">VPN Gateway Address</span></span> | <span data-ttu-id="0c3f0-617">Spazio di indirizzi</span><span class="sxs-lookup"><span data-stu-id="0c3f0-617">Address Space</span></span> | <span data-ttu-id="0c3f0-618">Osservazioni</span><span class="sxs-lookup"><span data-stu-id="0c3f0-618">Remarks</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="0c3f0-619">hk-lnet-map-to-east-us</span><span class="sxs-lookup"><span data-stu-id="0c3f0-619">hk-lnet-map-to-east-us</span></span> |<span data-ttu-id="0c3f0-620">23.1.1.1</span><span class="sxs-lookup"><span data-stu-id="0c3f0-620">23.1.1.1</span></span> |<span data-ttu-id="0c3f0-621">10.2.0.0/16</span><span class="sxs-lookup"><span data-stu-id="0c3f0-621">10.2.0.0/16</span></span> |<span data-ttu-id="0c3f0-622">Durante la creazione di rete locale hello assegnare un segnaposto indirizzo del gateway.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-622">While creating hello Local Network give a placeholder gateway address.</span></span> <span data-ttu-id="0c3f0-623">indirizzo del gateway reale Hello viene compilata una volta creato il gateway hello.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-623">hello real gateway address is filled once hello gateway is created.</span></span> <span data-ttu-id="0c3f0-624">Liberare spazio di indirizzo hello che corrisponde esattamente hello rispettiva rete virtuale remota; In questo caso hello rete virtuale creata in hello area Stati Uniti orientali.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-624">Make sure hello address space exactly matches hello respective remote VNET; in this case hello VNET created in hello East US region.</span></span> |
| <span data-ttu-id="0c3f0-625">hk-lnet-map-to-west-us</span><span class="sxs-lookup"><span data-stu-id="0c3f0-625">hk-lnet-map-to-west-us</span></span> |<span data-ttu-id="0c3f0-626">23.2.2.2</span><span class="sxs-lookup"><span data-stu-id="0c3f0-626">23.2.2.2</span></span> |<span data-ttu-id="0c3f0-627">10.1.0.0/16</span><span class="sxs-lookup"><span data-stu-id="0c3f0-627">10.1.0.0/16</span></span> |<span data-ttu-id="0c3f0-628">Durante la creazione di rete locale hello assegnare un segnaposto indirizzo del gateway.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-628">While creating hello Local Network give a placeholder gateway address.</span></span> <span data-ttu-id="0c3f0-629">indirizzo del gateway reale Hello viene compilata una volta creato il gateway hello.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-629">hello real gateway address is filled once hello gateway is created.</span></span> <span data-ttu-id="0c3f0-630">Liberare spazio di indirizzo hello che corrisponde esattamente hello rispettiva rete virtuale remota; In questo caso hello rete virtuale creata in hello area Stati Uniti occidentali.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-630">Make sure hello address space exactly matches hello respective remote VNET; in this case hello VNET created in hello West US region.</span></span> |

### <a name="step-3-map-local-network-toohello-respective-vnets"></a><span data-ttu-id="0c3f0-631">Passaggio 3: Mappa "Local" rete toohello rispettive reti virtuali</span><span class="sxs-lookup"><span data-stu-id="0c3f0-631">Step 3: Map “Local” network toohello respective VNETs</span></span>
<span data-ttu-id="0c3f0-632">Dal portale di Azure classico hello, selezionare ogni rete virtuale, fare clic su "Configura", selezionare "Connetti toohello locale network" e selezionare hello reti locali per hello seguenti dettagli:</span><span class="sxs-lookup"><span data-stu-id="0c3f0-632">From hello Azure classic portal, select each vnet, click “Configure”, check “Connect toohello local network”, and select hello Local Networks per hello following details:</span></span>

| <span data-ttu-id="0c3f0-633">Rete virtuale</span><span class="sxs-lookup"><span data-stu-id="0c3f0-633">Virtual Network</span></span> | <span data-ttu-id="0c3f0-634">Rete locale</span><span class="sxs-lookup"><span data-stu-id="0c3f0-634">Local Network</span></span> |
| --- | --- |
| <span data-ttu-id="0c3f0-635">hk-vnet-west-us</span><span class="sxs-lookup"><span data-stu-id="0c3f0-635">hk-vnet-west-us</span></span> |<span data-ttu-id="0c3f0-636">hk-lnet-map-to-east-us</span><span class="sxs-lookup"><span data-stu-id="0c3f0-636">hk-lnet-map-to-east-us</span></span> |
| <span data-ttu-id="0c3f0-637">hk-vnet-east-us</span><span class="sxs-lookup"><span data-stu-id="0c3f0-637">hk-vnet-east-us</span></span> |<span data-ttu-id="0c3f0-638">hk-lnet-map-to-west-us</span><span class="sxs-lookup"><span data-stu-id="0c3f0-638">hk-lnet-map-to-west-us</span></span> |

### <a name="step-4-create-gateways-on-vnet1-and-vnet2"></a><span data-ttu-id="0c3f0-639">Passaggio 4: Creare i gateway nella rete virtuale 1 e nella rete virtuale 2</span><span class="sxs-lookup"><span data-stu-id="0c3f0-639">Step 4: Create Gateways on VNET1 and VNET2</span></span>
<span data-ttu-id="0c3f0-640">Dal dashboard di hello di entrambe le reti virtuali di hello, fare clic su Crea GATEWAY che verrà attivata gateway VPN hello processo di provisioning.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-640">From hello dashboard of both hello virtual networks, click CREATE GATEWAY which will trigger hello VPN gateway provisioning process.</span></span> <span data-ttu-id="0c3f0-641">Dopo alcuni minuti hello dashboard di ciascuna rete virtuale deve essere visualizzato l'indirizzo gateway effettivo hello.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-641">After a few minutes hello dashboard of each virtual network should display hello actual gateway address.</span></span>

### <a name="step-5-update-local-networks-with-hello-respective-gateway-addresses"></a><span data-ttu-id="0c3f0-642">Passaggio 5: Le reti "Local" aggiornamento con gli indirizzi del rispettivo "Gateway" hello</span><span class="sxs-lookup"><span data-stu-id="0c3f0-642">Step 5: Update “Local” networks with hello respective “Gateway” addresses</span></span>
<span data-ttu-id="0c3f0-643">Modificare entrambi hello locale tooreplace hello segnaposto gateway IP indirizzo con hello reale indirizzo IP di hello appena effettuato il provisioning gateway delle reti.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-643">Edit both hello local networks tooreplace hello placeholder gateway IP address with hello real IP address of hello just provisioned gateways.</span></span> <span data-ttu-id="0c3f0-644">Utilizzare hello seguenti mapping:</span><span class="sxs-lookup"><span data-stu-id="0c3f0-644">Use hello following mapping:</span></span>

<table>
<tr><th><span data-ttu-id="0c3f0-645">Rete locale</span><span class="sxs-lookup"><span data-stu-id="0c3f0-645">Local Network</span></span>    </th><th><span data-ttu-id="0c3f0-646">Gateway di rete virtuale</span><span class="sxs-lookup"><span data-stu-id="0c3f0-646">Virtual Network Gateway</span></span></th></tr>
<tr><td><span data-ttu-id="0c3f0-647">hk-lnet-map-to-east-us</span><span class="sxs-lookup"><span data-stu-id="0c3f0-647">hk-lnet-map-to-east-us</span></span> </td><td><span data-ttu-id="0c3f0-648">Gateway di hk-vnet-west-us</span><span class="sxs-lookup"><span data-stu-id="0c3f0-648">Gateway of hk-vnet-west-us</span></span></td></tr>
<tr><td><span data-ttu-id="0c3f0-649">hk-lnet-map-to-west-us</span><span class="sxs-lookup"><span data-stu-id="0c3f0-649">hk-lnet-map-to-west-us</span></span> </td><td><span data-ttu-id="0c3f0-650">Gateway di hk-vnet-east-us</span><span class="sxs-lookup"><span data-stu-id="0c3f0-650">Gateway of hk-vnet-east-us</span></span></td></tr>
</table>

### <a name="step-6-update-hello-shared-key"></a><span data-ttu-id="0c3f0-651">Passaggio 6: Aggiornare la chiave condivisa hello</span><span class="sxs-lookup"><span data-stu-id="0c3f0-651">Step 6: Update hello shared key</span></span>
<span data-ttu-id="0c3f0-652">Utilizzare hello seguente chiave Powershell script tooupdate hello IPSec di ciascun gateway VPN [Usa hello i migliori risultati chiave per entrambi i gateway hello]: Set-AzureVNetGatewayKey - VNetName hk-rete virtuale-est-us - LocalNetworkSiteName hk-lnet-map-to-west-us - SharedKey D9E76BKK Set-AzureVNetGatewayKey - VNetName hk-rete virtuale--Stati Uniti occidentali - LocalNetworkSiteName hk-lnet-map-to-east-us - SharedKey D9E76BKK</span><span class="sxs-lookup"><span data-stu-id="0c3f0-652">Use hello following Powershell script tooupdate hello IPSec key of each VPN gateway [use hello sake key for both hello gateways]: Set-AzureVNetGatewayKey -VNetName hk-vnet-east-us -LocalNetworkSiteName hk-lnet-map-to-west-us -SharedKey D9E76BKK Set-AzureVNetGatewayKey -VNetName hk-vnet-west-us -LocalNetworkSiteName hk-lnet-map-to-east-us -SharedKey D9E76BKK</span></span>

### <a name="step-7-establish-hello-vnet-to-vnet-connection"></a><span data-ttu-id="0c3f0-653">Passaggio 7: Hello da rete connessione</span><span class="sxs-lookup"><span data-stu-id="0c3f0-653">Step 7: Establish hello VNET-to-VNET connection</span></span>
<span data-ttu-id="0c3f0-654">Dal portale di Azure classico hello, utilizzare il menu "DASHBOARD" hello della connessione di gateway a gateway entrambi hello reti virtuali tooestablish.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-654">From hello Azure classic portal, use hello “DASHBOARD” menu of both hello virtual networks tooestablish gateway-to-gateway connection.</span></span> <span data-ttu-id="0c3f0-655">Utilizzare le voci di menu "CONNETTI" hello nella barra degli strumenti nella parte inferiore di hello.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-655">Use hello “CONNECT” menu items in hello bottom toolbar.</span></span> <span data-ttu-id="0c3f0-656">Dopo pochi minuti hello dashboard deve visualizzare i dettagli della connessione hello graficamente.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-656">After a few minutes hello dashboard should display hello connection details graphically.</span></span>

### <a name="step-8-create-hello-virtual-machines-in-region-2"></a><span data-ttu-id="0c3f0-657">Passaggio 8: Creare macchine virtuali hello nell'area #2</span><span class="sxs-lookup"><span data-stu-id="0c3f0-657">Step 8: Create hello virtual machines in region #2</span></span>
<span data-ttu-id="0c3f0-658">Creare l'immagine Ubuntu hello come descritto nella distribuzione in un'area #1 dal seguente hello stessi passaggi o copiare hello immagine VHD file toohello account di archiviazione Azure si trova nell'area #2 e immagine hello.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-658">Create hello Ubuntu image as described in region #1 deployment by following hello same steps or copy hello image VHD file toohello Azure storage account located in region #2 and create hello image.</span></span> <span data-ttu-id="0c3f0-659">Utilizzare questa immagine e creare hello seguente elenco di macchine virtuali in un nuovo servizio cloud hk-c-svc-est-us:</span><span class="sxs-lookup"><span data-stu-id="0c3f0-659">Use this image and create hello following list of virtual machines into a new cloud service hk-c-svc-east-us:</span></span>

| <span data-ttu-id="0c3f0-660">Nome computer</span><span class="sxs-lookup"><span data-stu-id="0c3f0-660">Machine Name</span></span> | <span data-ttu-id="0c3f0-661">Subnet</span><span class="sxs-lookup"><span data-stu-id="0c3f0-661">Subnet</span></span> | <span data-ttu-id="0c3f0-662">Indirizzo IP</span><span class="sxs-lookup"><span data-stu-id="0c3f0-662">IP Address</span></span> | <span data-ttu-id="0c3f0-663">Set di disponibilità</span><span class="sxs-lookup"><span data-stu-id="0c3f0-663">Availability set</span></span> | <span data-ttu-id="0c3f0-664">DC/Rack</span><span class="sxs-lookup"><span data-stu-id="0c3f0-664">DC/Rack</span></span> | <span data-ttu-id="0c3f0-665">Valore di inizializzazione?</span><span class="sxs-lookup"><span data-stu-id="0c3f0-665">Seed?</span></span> |
| --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="0c3f0-666">hk-c1-east-us</span><span class="sxs-lookup"><span data-stu-id="0c3f0-666">hk-c1-east-us</span></span> |<span data-ttu-id="0c3f0-667">data</span><span class="sxs-lookup"><span data-stu-id="0c3f0-667">data</span></span> |<span data-ttu-id="0c3f0-668">10.2.2.4</span><span class="sxs-lookup"><span data-stu-id="0c3f0-668">10.2.2.4</span></span> |<span data-ttu-id="0c3f0-669">hk-c-aset-1</span><span class="sxs-lookup"><span data-stu-id="0c3f0-669">hk-c-aset-1</span></span> |<span data-ttu-id="0c3f0-670">dc =EASTUS rack =rack1</span><span class="sxs-lookup"><span data-stu-id="0c3f0-670">dc =EASTUS rack =rack1</span></span> |<span data-ttu-id="0c3f0-671">Sì</span><span class="sxs-lookup"><span data-stu-id="0c3f0-671">Yes</span></span> |
| <span data-ttu-id="0c3f0-672">hk-c2-east-us</span><span class="sxs-lookup"><span data-stu-id="0c3f0-672">hk-c2-east-us</span></span> |<span data-ttu-id="0c3f0-673">data</span><span class="sxs-lookup"><span data-stu-id="0c3f0-673">data</span></span> |<span data-ttu-id="0c3f0-674">10.2.2.5</span><span class="sxs-lookup"><span data-stu-id="0c3f0-674">10.2.2.5</span></span> |<span data-ttu-id="0c3f0-675">hk-c-aset-1</span><span class="sxs-lookup"><span data-stu-id="0c3f0-675">hk-c-aset-1</span></span> |<span data-ttu-id="0c3f0-676">dc =EASTUS rack =rack1</span><span class="sxs-lookup"><span data-stu-id="0c3f0-676">dc =EASTUS rack =rack1</span></span> |<span data-ttu-id="0c3f0-677">No</span><span class="sxs-lookup"><span data-stu-id="0c3f0-677">No</span></span> |
| <span data-ttu-id="0c3f0-678">hk-c3-east-us</span><span class="sxs-lookup"><span data-stu-id="0c3f0-678">hk-c3-east-us</span></span> |<span data-ttu-id="0c3f0-679">data</span><span class="sxs-lookup"><span data-stu-id="0c3f0-679">data</span></span> |<span data-ttu-id="0c3f0-680">10.2.2.6</span><span class="sxs-lookup"><span data-stu-id="0c3f0-680">10.2.2.6</span></span> |<span data-ttu-id="0c3f0-681">hk-c-aset-1</span><span class="sxs-lookup"><span data-stu-id="0c3f0-681">hk-c-aset-1</span></span> |<span data-ttu-id="0c3f0-682">dc =EASTUS rack =rack2</span><span class="sxs-lookup"><span data-stu-id="0c3f0-682">dc =EASTUS rack =rack2</span></span> |<span data-ttu-id="0c3f0-683">Sì</span><span class="sxs-lookup"><span data-stu-id="0c3f0-683">Yes</span></span> |
| <span data-ttu-id="0c3f0-684">hk-c5-east-us</span><span class="sxs-lookup"><span data-stu-id="0c3f0-684">hk-c5-east-us</span></span> |<span data-ttu-id="0c3f0-685">data</span><span class="sxs-lookup"><span data-stu-id="0c3f0-685">data</span></span> |<span data-ttu-id="0c3f0-686">10.2.2.8</span><span class="sxs-lookup"><span data-stu-id="0c3f0-686">10.2.2.8</span></span> |<span data-ttu-id="0c3f0-687">hk-c-aset-2</span><span class="sxs-lookup"><span data-stu-id="0c3f0-687">hk-c-aset-2</span></span> |<span data-ttu-id="0c3f0-688">dc =EASTUS rack =rack3</span><span class="sxs-lookup"><span data-stu-id="0c3f0-688">dc =EASTUS rack =rack3</span></span> |<span data-ttu-id="0c3f0-689">Sì</span><span class="sxs-lookup"><span data-stu-id="0c3f0-689">Yes</span></span> |
| <span data-ttu-id="0c3f0-690">hk-c6-east-us</span><span class="sxs-lookup"><span data-stu-id="0c3f0-690">hk-c6-east-us</span></span> |<span data-ttu-id="0c3f0-691">data</span><span class="sxs-lookup"><span data-stu-id="0c3f0-691">data</span></span> |<span data-ttu-id="0c3f0-692">10.2.2.9</span><span class="sxs-lookup"><span data-stu-id="0c3f0-692">10.2.2.9</span></span> |<span data-ttu-id="0c3f0-693">hk-c-aset-2</span><span class="sxs-lookup"><span data-stu-id="0c3f0-693">hk-c-aset-2</span></span> |<span data-ttu-id="0c3f0-694">dc =EASTUS rack =rack3</span><span class="sxs-lookup"><span data-stu-id="0c3f0-694">dc =EASTUS rack =rack3</span></span> |<span data-ttu-id="0c3f0-695">No</span><span class="sxs-lookup"><span data-stu-id="0c3f0-695">No</span></span> |
| <span data-ttu-id="0c3f0-696">hk-c7-east-us</span><span class="sxs-lookup"><span data-stu-id="0c3f0-696">hk-c7-east-us</span></span> |<span data-ttu-id="0c3f0-697">data</span><span class="sxs-lookup"><span data-stu-id="0c3f0-697">data</span></span> |<span data-ttu-id="0c3f0-698">10.2.2.10</span><span class="sxs-lookup"><span data-stu-id="0c3f0-698">10.2.2.10</span></span> |<span data-ttu-id="0c3f0-699">hk-c-aset-2</span><span class="sxs-lookup"><span data-stu-id="0c3f0-699">hk-c-aset-2</span></span> |<span data-ttu-id="0c3f0-700">dc =EASTUS rack =rack4</span><span class="sxs-lookup"><span data-stu-id="0c3f0-700">dc =EASTUS rack =rack4</span></span> |<span data-ttu-id="0c3f0-701">Sì</span><span class="sxs-lookup"><span data-stu-id="0c3f0-701">Yes</span></span> |
| <span data-ttu-id="0c3f0-702">hk-c8-east-us</span><span class="sxs-lookup"><span data-stu-id="0c3f0-702">hk-c8-east-us</span></span> |<span data-ttu-id="0c3f0-703">data</span><span class="sxs-lookup"><span data-stu-id="0c3f0-703">data</span></span> |<span data-ttu-id="0c3f0-704">10.2.2.11</span><span class="sxs-lookup"><span data-stu-id="0c3f0-704">10.2.2.11</span></span> |<span data-ttu-id="0c3f0-705">hk-c-aset-2</span><span class="sxs-lookup"><span data-stu-id="0c3f0-705">hk-c-aset-2</span></span> |<span data-ttu-id="0c3f0-706">dc =EASTUS rack =rack4</span><span class="sxs-lookup"><span data-stu-id="0c3f0-706">dc =EASTUS rack =rack4</span></span> |<span data-ttu-id="0c3f0-707">No</span><span class="sxs-lookup"><span data-stu-id="0c3f0-707">No</span></span> |
| <span data-ttu-id="0c3f0-708">hk-w1-east-us</span><span class="sxs-lookup"><span data-stu-id="0c3f0-708">hk-w1-east-us</span></span> |<span data-ttu-id="0c3f0-709">Web</span><span class="sxs-lookup"><span data-stu-id="0c3f0-709">web</span></span> |<span data-ttu-id="0c3f0-710">10.2.1.4</span><span class="sxs-lookup"><span data-stu-id="0c3f0-710">10.2.1.4</span></span> |<span data-ttu-id="0c3f0-711">hk-w-aset-1</span><span class="sxs-lookup"><span data-stu-id="0c3f0-711">hk-w-aset-1</span></span> |<span data-ttu-id="0c3f0-712">N/D</span><span class="sxs-lookup"><span data-stu-id="0c3f0-712">N/A</span></span> |<span data-ttu-id="0c3f0-713">N/D</span><span class="sxs-lookup"><span data-stu-id="0c3f0-713">N/A</span></span> |
| <span data-ttu-id="0c3f0-714">hk-w2-east-us</span><span class="sxs-lookup"><span data-stu-id="0c3f0-714">hk-w2-east-us</span></span> |<span data-ttu-id="0c3f0-715">Web</span><span class="sxs-lookup"><span data-stu-id="0c3f0-715">web</span></span> |<span data-ttu-id="0c3f0-716">10.2.1.5</span><span class="sxs-lookup"><span data-stu-id="0c3f0-716">10.2.1.5</span></span> |<span data-ttu-id="0c3f0-717">hk-w-aset-1</span><span class="sxs-lookup"><span data-stu-id="0c3f0-717">hk-w-aset-1</span></span> |<span data-ttu-id="0c3f0-718">N/D</span><span class="sxs-lookup"><span data-stu-id="0c3f0-718">N/A</span></span> |<span data-ttu-id="0c3f0-719">N/D</span><span class="sxs-lookup"><span data-stu-id="0c3f0-719">N/A</span></span> |

<span data-ttu-id="0c3f0-720">Seguire hello stesso istruzioni come area #1 ma si usa lo spazio degli indirizzi 10.2.xxx.xxx.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-720">Follow hello same instructions as region #1 but use 10.2.xxx.xxx address space.</span></span>

### <a name="step-9-configure-cassandra-on-each-vm"></a><span data-ttu-id="0c3f0-721">Passaggio 9: Configurare Cassandra in ogni VM</span><span class="sxs-lookup"><span data-stu-id="0c3f0-721">Step 9: Configure Cassandra on each VM</span></span>
<span data-ttu-id="0c3f0-722">Accedere hello VM ed effettuare hello seguenti:</span><span class="sxs-lookup"><span data-stu-id="0c3f0-722">Log into hello VM and perform hello following:</span></span>

1. <span data-ttu-id="0c3f0-723">Modificare $CASS_HOME/conf/cassandra-rackdc.properties toospecify hello data center rack le proprietà e in formato hello: dc = rack EASTUS = rack1</span><span class="sxs-lookup"><span data-stu-id="0c3f0-723">Edit $CASS_HOME/conf/cassandra-rackdc.properties toospecify hello data center and rack properties in hello format:  dc =EASTUS  rack =rack1</span></span>
2. <span data-ttu-id="0c3f0-724">Modificare i nodi di inizializzazione tooconfigure cassandra.yaml: i valori di inizializzazione: "10.1.2.4,10.1.2.6,10.1.2.8,10.1.2.10,10.2.2.4,10.2.2.6,10.2.2.8,10.2.2.10"</span><span class="sxs-lookup"><span data-stu-id="0c3f0-724">Edit cassandra.yaml tooconfigure seed nodes:  Seeds: "10.1.2.4,10.1.2.6,10.1.2.8,10.1.2.10,10.2.2.4,10.2.2.6,10.2.2.8,10.2.2.10"</span></span>

### <a name="step-10-start-cassandra"></a><span data-ttu-id="0c3f0-725">Passaggio 10: Avviare Cassandra</span><span class="sxs-lookup"><span data-stu-id="0c3f0-725">Step 10: Start Cassandra</span></span>
<span data-ttu-id="0c3f0-726">Accedere a ogni macchina virtuale e avviare Cassandra in background hello eseguendo hello comando seguente: $CASS_HOME/bin/cassandra</span><span class="sxs-lookup"><span data-stu-id="0c3f0-726">Log into each VM and start Cassandra in hello background by running hello following command: $CASS_HOME/bin/cassandra</span></span>

## <a name="test-hello-multi-region-cluster"></a><span data-ttu-id="0c3f0-727">Hello test Cluster con più aree</span><span class="sxs-lookup"><span data-stu-id="0c3f0-727">Test hello Multi-Region Cluster</span></span>
<span data-ttu-id="0c3f0-728">A questo punto Cassandra è stato distribuito too16 nodi con 8 nodi in ogni area di Azure.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-728">By now Cassandra has been deployed too16 nodes with 8 nodes in each Azure region.</span></span> <span data-ttu-id="0c3f0-729">Questi nodi sono in hello in virtù del nome cluster comune hello e configurazione di un nodo di valore di inizializzazione hello del cluster stesso.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-729">These nodes are in hello same cluster by virtue of hello common cluster name and hello seed node configuration.</span></span> <span data-ttu-id="0c3f0-730">Utilizzare hello cluster hello tootest di processo seguenti:</span><span class="sxs-lookup"><span data-stu-id="0c3f0-730">Use hello following process tootest hello cluster:</span></span>

### <a name="step-1-get-hello-internal-load-balancer-ip-for-both-hello-regions-using-powershell"></a><span data-ttu-id="0c3f0-731">Passaggio 1: Ottenere l'indirizzo IP del servizio di bilanciamento di carico interno hello per entrambe le aree hello tramite PowerShell</span><span class="sxs-lookup"><span data-stu-id="0c3f0-731">Step 1: Get hello internal load balancer IP for both hello regions using PowerShell</span></span>
* <span data-ttu-id="0c3f0-732">Get-AzureInternalLoadbalancer -ServiceName "hk-c-svc-west-us"</span><span class="sxs-lookup"><span data-stu-id="0c3f0-732">Get-AzureInternalLoadbalancer -ServiceName "hk-c-svc-west-us"</span></span>
* <span data-ttu-id="0c3f0-733">Get-AzureInternalLoadbalancer -ServiceName "hk-c-svc-east-us"</span><span class="sxs-lookup"><span data-stu-id="0c3f0-733">Get-AzureInternalLoadbalancer -ServiceName "hk-c-svc-east-us"</span></span>  
  
    <span data-ttu-id="0c3f0-734">Si noti gli indirizzi IP hello (ad esempio - 10.1.2.101, est - ovest 10.2.2.101) visualizzato.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-734">Note hello IP addresses (e.g. west - 10.1.2.101, east - 10.2.2.101) displayed.</span></span>

### <a name="step-2-execute-hello-following-in-hello-west-region-after-logging-into-hk-w1-west-us"></a><span data-ttu-id="0c3f0-735">Passaggio 2: Eseguire hello ovest hello dopo la registrazione in hk-w1--Stati Uniti occidentali</span><span class="sxs-lookup"><span data-stu-id="0c3f0-735">Step 2: Execute hello following in hello west region after logging into hk-w1-west-us</span></span>
1. <span data-ttu-id="0c3f0-736">Eseguire $CASS_HOME/bin/cqlsh 10.1.2.101 9160</span><span class="sxs-lookup"><span data-stu-id="0c3f0-736">Execute $CASS_HOME/bin/cqlsh 10.1.2.101 9160</span></span>
2. <span data-ttu-id="0c3f0-737">Eseguire i seguenti comandi CQL hello:</span><span class="sxs-lookup"><span data-stu-id="0c3f0-737">Execute hello following CQL commands:</span></span>
   
     <span data-ttu-id="0c3f0-738">CREATE KEYSPACE customers_ks   WITH REPLICATION = { 'class' : 'NetworkToplogyStrategy', 'WESTUS' : 3, 'EASTUS' : 3};   USE customers_ks;   CREATE TABLE Customers(customer_id int PRIMARY KEY, firstname text, lastname text);   INSERT INTO Customers(customer_id, firstname, lastname) VALUES(1, 'John', 'Doe');   INSERT INTO Customers(customer_id, firstname, lastname) VALUES (2, 'Jane', 'Doe');   SELECT * FROM Customers;</span><span class="sxs-lookup"><span data-stu-id="0c3f0-738">CREATE KEYSPACE customers_ks   WITH REPLICATION = { 'class' : 'NetworkToplogyStrategy', 'WESTUS' : 3, 'EASTUS' : 3};   USE customers_ks;   CREATE TABLE Customers(customer_id int PRIMARY KEY, firstname text, lastname text);   INSERT INTO Customers(customer_id, firstname, lastname) VALUES(1, 'John', 'Doe');   INSERT INTO Customers(customer_id, firstname, lastname) VALUES (2, 'Jane', 'Doe');   SELECT * FROM Customers;</span></span>

<span data-ttu-id="0c3f0-739">È necessario visualizzare una visualizzazione simile hello sotto:</span><span class="sxs-lookup"><span data-stu-id="0c3f0-739">You should see a display like hello one below:</span></span>

| <span data-ttu-id="0c3f0-740">customer_id</span><span class="sxs-lookup"><span data-stu-id="0c3f0-740">customer_id</span></span> | <span data-ttu-id="0c3f0-741">firstname</span><span class="sxs-lookup"><span data-stu-id="0c3f0-741">firstname</span></span> | <span data-ttu-id="0c3f0-742">Lastname</span><span class="sxs-lookup"><span data-stu-id="0c3f0-742">Lastname</span></span> |
| --- | --- | --- |
| <span data-ttu-id="0c3f0-743">1</span><span class="sxs-lookup"><span data-stu-id="0c3f0-743">1</span></span> |<span data-ttu-id="0c3f0-744">John</span><span class="sxs-lookup"><span data-stu-id="0c3f0-744">John</span></span> |<span data-ttu-id="0c3f0-745">Doe</span><span class="sxs-lookup"><span data-stu-id="0c3f0-745">Doe</span></span> |
| <span data-ttu-id="0c3f0-746">2</span><span class="sxs-lookup"><span data-stu-id="0c3f0-746">2</span></span> |<span data-ttu-id="0c3f0-747">Jane</span><span class="sxs-lookup"><span data-stu-id="0c3f0-747">Jane</span></span> |<span data-ttu-id="0c3f0-748">Doe</span><span class="sxs-lookup"><span data-stu-id="0c3f0-748">Doe</span></span> |

### <a name="step-3-execute-hello-following-in-hello-east-region-after-logging-into-hk-w1-east-us"></a><span data-ttu-id="0c3f0-749">Passaggio 3: Eseguire hello nell'area orientale hello dopo la registrazione in hk-w1-est-us:</span><span class="sxs-lookup"><span data-stu-id="0c3f0-749">Step 3: Execute hello following in hello east region after logging into hk-w1-east-us:</span></span>
1. <span data-ttu-id="0c3f0-750">Eseguire $CASS_HOME/bin/cqlsh 10.2.2.101 9160</span><span class="sxs-lookup"><span data-stu-id="0c3f0-750">Execute $CASS_HOME/bin/cqlsh 10.2.2.101 9160</span></span>
2. <span data-ttu-id="0c3f0-751">Eseguire i seguenti comandi CQL hello:</span><span class="sxs-lookup"><span data-stu-id="0c3f0-751">Execute hello following CQL commands:</span></span>
   
     <span data-ttu-id="0c3f0-752">USE customers_ks;   CREATE TABLE Customers(customer_id int PRIMARY KEY, firstname text, lastname text);   INSERT INTO Customers(customer_id, firstname, lastname) VALUES(1, 'John', 'Doe');   INSERT INTO Customers(customer_id, firstname, lastname) VALUES (2, 'Jane', 'Doe');   SELECT * FROM Customers;</span><span class="sxs-lookup"><span data-stu-id="0c3f0-752">USE customers_ks;   CREATE TABLE Customers(customer_id int PRIMARY KEY, firstname text, lastname text);   INSERT INTO Customers(customer_id, firstname, lastname) VALUES(1, 'John', 'Doe');   INSERT INTO Customers(customer_id, firstname, lastname) VALUES (2, 'Jane', 'Doe');   SELECT * FROM Customers;</span></span>

<span data-ttu-id="0c3f0-753">È necessario visualizzare hello stesso visualizzare per l'area occidentale hello:</span><span class="sxs-lookup"><span data-stu-id="0c3f0-753">You should see hello same display as seen for hello West region:</span></span>

| <span data-ttu-id="0c3f0-754">customer_id</span><span class="sxs-lookup"><span data-stu-id="0c3f0-754">customer_id</span></span> | <span data-ttu-id="0c3f0-755">firstname</span><span class="sxs-lookup"><span data-stu-id="0c3f0-755">firstname</span></span> | <span data-ttu-id="0c3f0-756">Lastname</span><span class="sxs-lookup"><span data-stu-id="0c3f0-756">Lastname</span></span> |
| --- | --- | --- |
| <span data-ttu-id="0c3f0-757">1</span><span class="sxs-lookup"><span data-stu-id="0c3f0-757">1</span></span> |<span data-ttu-id="0c3f0-758">John</span><span class="sxs-lookup"><span data-stu-id="0c3f0-758">John</span></span> |<span data-ttu-id="0c3f0-759">Doe</span><span class="sxs-lookup"><span data-stu-id="0c3f0-759">Doe</span></span> |
| <span data-ttu-id="0c3f0-760">2</span><span class="sxs-lookup"><span data-stu-id="0c3f0-760">2</span></span> |<span data-ttu-id="0c3f0-761">Jane</span><span class="sxs-lookup"><span data-stu-id="0c3f0-761">Jane</span></span> |<span data-ttu-id="0c3f0-762">Doe</span><span class="sxs-lookup"><span data-stu-id="0c3f0-762">Doe</span></span> |

<span data-ttu-id="0c3f0-763">Eseguire alcuni comandi di inserimento più e vedere che quelli ottenere replicata toowest-us fa parte di cluster hello.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-763">Execute a few more inserts and see that those get replicated toowest-us part of hello cluster.</span></span>

## <a name="test-cassandra-cluster-from-nodejs"></a><span data-ttu-id="0c3f0-764">Testare il cluster Cassandra da Node.js</span><span class="sxs-lookup"><span data-stu-id="0c3f0-764">Test Cassandra Cluster from Node.js</span></span>
<span data-ttu-id="0c3f0-765">Utilizzando una delle macchine virtuali Linux hello creato in precedenza nel livello "web" hello, si eseguirà un semplice dati di hello inserita in precedenza tooread script Node.js</span><span class="sxs-lookup"><span data-stu-id="0c3f0-765">Using one of hello Linux VMs crated in hello "web" tier previously, we will execute a simple Node.js script tooread hello previously inserted data</span></span>

<span data-ttu-id="0c3f0-766">**Passaggio 1: Installare Node.js e il client Cassandra**</span><span class="sxs-lookup"><span data-stu-id="0c3f0-766">**Step 1: Install Node.js and Cassandra Client**</span></span>

1. <span data-ttu-id="0c3f0-767">Installare Node.js e NPM</span><span class="sxs-lookup"><span data-stu-id="0c3f0-767">Install Node.js and npm</span></span>
2. <span data-ttu-id="0c3f0-768">Installare il pacchetto di nodi "cassandra-client" con NPM</span><span class="sxs-lookup"><span data-stu-id="0c3f0-768">Install node package "cassandra-client" using npm</span></span>
3. <span data-ttu-id="0c3f0-769">Eseguire lo script al prompt dei comandi della shell hello, che visualizza una stringa json hello di hello recuperato dati seguente hello:</span><span class="sxs-lookup"><span data-stu-id="0c3f0-769">Execute hello following script at hello shell prompt which displays hello json string of hello retrieved data:</span></span>
   
        var pooledCon = require('cassandra-client').PooledConnection;
        var ksName = "custsupport_ks";
        var cfName = "customers_cf";
        var hostList = ['internal_loadbalancer_ip:9160'];
        var ksConOptions = { hosts: hostList,
                             keyspace: ksName, use_bigints: false };
   
        function createKeyspace(callback){
           var cql = 'CREATE KEYSPACE ' + ksName + ' WITH strategy_class=SimpleStrategy AND strategy_options:replication_factor=1';
           var sysConOptions = { hosts: hostList,  
                                 keyspace: 'system', use_bigints: false };
           var con = new pooledCon(sysConOptions);
           con.execute(cql,[],function(err) {
           if (err) {
             console.log("Failed toocreate Keyspace: " + ksName);
             console.log(err);
           }
           else {
             console.log("Created Keyspace: " + ksName);
             callback(ksConOptions, populateCustomerData);
           }
           });
           con.shutdown();
        }
   
        function createColumnFamily(ksConOptions, callback){
          var params = ['customers_cf','custid','varint','custname',
                        'text','custaddress','text'];
          var cql = 'CREATE COLUMNFAMILY ? (? ? PRIMARY KEY,? ?, ? ?)';
        var con =  new pooledCon(ksConOptions);
          con.execute(cql,params,function(err) {
              if (err) {
                 console.log("Failed toocreate column family: " + params[0]);
                 console.log(err);
              }
              else {
                 console.log("Created column family: " + params[0]);
                 callback();
              }
          });
          con.shutdown();
        }
   
        //populate Data
        function populateCustomerData() {
           var params = ['John','Infinity Dr, TX', 1];
           updateCustomer(ksConOptions,params);
   
           params = ['Tom','Fermat Ln, WA', 2];
           updateCustomer(ksConOptions,params);
        }
   
        //update will also insert hello record if none exists
        function updateCustomer(ksConOptions,params)
        {
          var cql = 'UPDATE customers_cf SET custname=?,custaddress=? where custid=?';
          var con = new pooledCon(ksConOptions);
          con.execute(cql,params,function(err) {
              if (err) console.log(err);
              else console.log("Inserted customer : " + params[0]);
          });
          con.shutdown();
        }
   
        //read hello two rows inserted above
        function readCustomer(ksConOptions)
        {
          var cql = 'SELECT * FROM customers_cf WHERE custid IN (1,2)';
          var con = new pooledCon(ksConOptions);
          con.execute(cql,[],function(err,rows) {
              if (err)
                 console.log(err);
              else
                 for (var i=0; i<rows.length; i++)
                    console.log(JSON.stringify(rows[i]));
            });
           con.shutdown();
        }
   
        //exectue hello code
        createKeyspace(createColumnFamily);
        readCustomer(ksConOptions)

## <a name="conclusion"></a><span data-ttu-id="0c3f0-770">Conclusioni</span><span class="sxs-lookup"><span data-stu-id="0c3f0-770">Conclusion</span></span>
<span data-ttu-id="0c3f0-771">Microsoft Azure è una piattaforma flessibile che consente l'esecuzione di hello di Microsoft nonché a software open source come illustrato in questo esercizio.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-771">Microsoft Azure is a flexible platform that allows hello running of both Microsoft as well as open source software as demonstrated by this exercise.</span></span> <span data-ttu-id="0c3f0-772">Cluster a disponibilità elevata Cassandra può essere distribuito in un singolo data center tramite hello estendendo hello nodi del cluster tra più domini di errore.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-772">Highly available Cassandra clusters can be deployed on a single data center through hello spreading of hello cluster nodes across multiple fault domains.</span></span> <span data-ttu-id="0c3f0-773">I cluster Cassandra possono essere distribuiti anche in più area di Azure geograficamente distanti per sistemi a prova di emergenza.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-773">Cassandra clusters can also be deployed across multiple geographically distant Azure regions for disaster proof systems.</span></span> <span data-ttu-id="0c3f0-774">Azure e consente contemporaneamente Cassandra hello costruzione di scalabilità, disponibilità elevata e servizi di cloud ripristinabili emergenza necessari da internet oggi aumentare i servizi.</span><span class="sxs-lookup"><span data-stu-id="0c3f0-774">Azure and Cassandra together enables hello construction of highly scalable, highly available and disaster recoverable cloud services needed by today's internet scale services.</span></span>  

## <a name="references"></a><span data-ttu-id="0c3f0-775">Riferimenti</span><span class="sxs-lookup"><span data-stu-id="0c3f0-775">References</span></span>
* [<span data-ttu-id="0c3f0-776">http://cassandra.apache.org</span><span class="sxs-lookup"><span data-stu-id="0c3f0-776">http://cassandra.apache.org</span></span>](http://cassandra.apache.org)
* [<span data-ttu-id="0c3f0-777">http://www.datastax.com</span><span class="sxs-lookup"><span data-stu-id="0c3f0-777">http://www.datastax.com</span></span>](http://www.datastax.com)
* [<span data-ttu-id="0c3f0-778">http://www.nodejs.org</span><span class="sxs-lookup"><span data-stu-id="0c3f0-778">http://www.nodejs.org</span></span>](http://www.nodejs.org)

