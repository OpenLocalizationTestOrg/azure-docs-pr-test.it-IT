---
title: Connettere Excel a Hadoop mediante Power Query - Azure HDInsight | Microsoft Docs
description: Informazioni su come sfruttare i componenti di business intelligence e usare Power Query per Excel per accedere ai dati archiviati in Hadoop in HDInsight.
services: hdinsight
documentationcenter: 
tags: azure-portal
author: mumian
manager: jhubbard
editor: cgronlun
ms.assetid: 01ad2f90-7520-44d9-8c16-4d936faaff9b
ms.service: hdinsight
ms.custom: hdinsightactive
ms.workload: big-data
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/11/2017
ms.author: jgao
ms.openlocfilehash: 6a15efb091b4faaa7305bb8faa362c62fac595cb
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/03/2017
---
# <a name="connect-excel-to-hadoop-by-using-power-query"></a><span data-ttu-id="f5eb3-103">Connettere Excel a Hadoop mediante Power Query</span><span class="sxs-lookup"><span data-stu-id="f5eb3-103">Connect Excel to Hadoop by using Power Query</span></span>
<span data-ttu-id="f5eb3-104">Una funzionalità chiave della soluzione Big Data di Microsoft è l'integrazione dei componenti di business intelligence (BI) Microsoft con i cluster Hadoop in Azure HDInsight.</span><span class="sxs-lookup"><span data-stu-id="f5eb3-104">One key feature of the Microsoft big-data solution is the integration of Microsoft business intelligence (BI) components with Hadoop clusters in Azure HDInsight.</span></span> <span data-ttu-id="f5eb3-105">Un esempio importante è la possibilità di connettere Excel all'account di Archiviazione di Azure che contiene i dati associati al cluster Hadoop usando il componente aggiuntivo Microsoft Power Query per Excel.</span><span class="sxs-lookup"><span data-stu-id="f5eb3-105">A primary example is the ability to connect Excel to the Azure Storage account that contains the data associated with your Hadoop cluster by using the Microsoft Power Query for Excel add-in.</span></span> <span data-ttu-id="f5eb3-106">Questo articolo illustra come configurare e usare Power Query per eseguire una query sui dati associati a un cluster Hadoop gestito con HDInsight.</span><span class="sxs-lookup"><span data-stu-id="f5eb3-106">This article walks you through how to set up and use Power Query to query data associated with a Hadoop cluster managed with HDInsight.</span></span>

### <a name="prerequisites"></a><span data-ttu-id="f5eb3-107">Prerequisiti</span><span class="sxs-lookup"><span data-stu-id="f5eb3-107">Prerequisites</span></span>
<span data-ttu-id="f5eb3-108">Per eseguire le procedure descritte nell'articolo sono necessari gli elementi seguenti:</span><span class="sxs-lookup"><span data-stu-id="f5eb3-108">Before you begin this article, you must have the following items:</span></span>

* <span data-ttu-id="f5eb3-109">**Un cluster HDInsight**.</span><span class="sxs-lookup"><span data-stu-id="f5eb3-109">**An HDInsight cluster**.</span></span> <span data-ttu-id="f5eb3-110">Per configurarne uno, vedere [Introduzione ad Azure HDInsight][hdinsight-get-started].</span><span class="sxs-lookup"><span data-stu-id="f5eb3-110">To configure one, see [Get started with Azure HDInsight][hdinsight-get-started].</span></span>
* <span data-ttu-id="f5eb3-111">**Una workstation** che esegue il sistema operativo Windows 7, Windows Server 2008 R2 o una versione successiva.</span><span class="sxs-lookup"><span data-stu-id="f5eb3-111">**A workstation** that is running Windows 7, Windows Server 2008 R2, or a later operating system.</span></span>
* <span data-ttu-id="f5eb3-112">**Office 2016, Office 2013 Professional Plus, Office 365 ProPlus, Excel 2013 Standalone oppure Office 2010 Professional Plus**.</span><span class="sxs-lookup"><span data-stu-id="f5eb3-112">**Office 2016, Office 2013 Professional Plus, Office 365 ProPlus, Excel 2013 Standalone, or Office 2010 Professional Plus**.</span></span>

## <a name="install-power-query"></a><span data-ttu-id="f5eb3-113">Installare Power Query</span><span class="sxs-lookup"><span data-stu-id="f5eb3-113">Install Power Query</span></span>
<span data-ttu-id="f5eb3-114">Power Query consente di importare dati derivati o generati da un processo Hadoop in esecuzione su un cluster HDInsight.</span><span class="sxs-lookup"><span data-stu-id="f5eb3-114">Power Query can import data that has been output or that has been generated by a Hadoop job running on an HDInsight cluster.</span></span>

<span data-ttu-id="f5eb3-115">In Excel 2016, Power Query è stata integrata nella barra multifunzione Dati nella sezione Get & Transform (Recupera e trasforma).</span><span class="sxs-lookup"><span data-stu-id="f5eb3-115">In Excel 2016, Power Query has been integrated into the Data ribbon under the Get & Transform section.</span></span> <span data-ttu-id="f5eb3-116">Per le versioni meno recenti di Excel, scaricare Microsoft Power Query per Excel dall'[Area download Microsoft][powerquery-download] e installarlo.</span><span class="sxs-lookup"><span data-stu-id="f5eb3-116">For older Excel versions, download Microsoft Power Query for Excel from the [Microsoft Download Center][powerquery-download] and install it.</span></span>

## <a name="import-hdinsight-data-into-excel"></a><span data-ttu-id="f5eb3-117">Importare dati di HDInsight in Excel</span><span class="sxs-lookup"><span data-stu-id="f5eb3-117">Import HDInsight data into Excel</span></span>
<span data-ttu-id="f5eb3-118">Il componente aggiuntivo Power Query per Excel consente di importare facilmente dati dal cluster HDInsight in Excel dove strumenti BI quali PowerPivot e Power Map possono essere usati per esaminare, analizzare e presentare i dati.</span><span class="sxs-lookup"><span data-stu-id="f5eb3-118">The Power Query add-in for Excel makes it easy to import data from your HDInsight cluster into Excel, where BI tools such as PowerPivot and Power Map can be used to inspect, analyze, and present the data.</span></span>

<span data-ttu-id="f5eb3-119">**Per importare dati da un cluster HDInsight**</span><span class="sxs-lookup"><span data-stu-id="f5eb3-119">**To import data from an HDInsight cluster**</span></span>

1. <span data-ttu-id="f5eb3-120">Aprire Excel.</span><span class="sxs-lookup"><span data-stu-id="f5eb3-120">Open Excel.</span></span>
2. <span data-ttu-id="f5eb3-121">Creare una nuova cartella di lavoro vuota.</span><span class="sxs-lookup"><span data-stu-id="f5eb3-121">Create a new blank workbook.</span></span>
3. <span data-ttu-id="f5eb3-122">Eseguire la procedura seguente in base alla versione di Excel:</span><span class="sxs-lookup"><span data-stu-id="f5eb3-122">Perform the following steps based on the Excel version:</span></span>

    - <span data-ttu-id="f5eb3-123">Excel 2016</span><span class="sxs-lookup"><span data-stu-id="f5eb3-123">Excel 2016</span></span>

        - <span data-ttu-id="f5eb3-124">Fare clic sul menu **Dati**, fare clic su **Ottieni dati** della barra multifunzione **Get & Transform Data** (Recupera e trasforma i dati), quindi su **From Azure** (Da Azure) e quindi fare clic su **From Azure HDInsight(HDFS)** (Da Azure HDInsight (HDFS)).</span><span class="sxs-lookup"><span data-stu-id="f5eb3-124">Click the **Data** menu, click **Get Data** from the **Get & Transform Data** ribbon, click **From Azure**, and then click **From Azure HDInsight(HDFS)**.</span></span>

        ![HDI.PowerQuery.SelectHdiSource](./media/hdinsight-connect-excel-power-query/hdi.powerquery.selecthdisource.excel2016.png)

    - <span data-ttu-id="f5eb3-126">Excel 2013/2010</span><span class="sxs-lookup"><span data-stu-id="f5eb3-126">Excel 2013/2010</span></span>

        - <span data-ttu-id="f5eb3-127">Dal menu **Power Query** scegliere **Da Azure**, quindi fare clic su **Da Microsoft Azure HDInsight**.</span><span class="sxs-lookup"><span data-stu-id="f5eb3-127">Click the **Power Query** menu, click **From Azure**, and then click **From Microsoft Azure HDInsight**.</span></span>
   
        ![HDI.PowerQuery.SelectHdiSource][image-hdi-powerquery-hdi-source]
       
        <span data-ttu-id="f5eb3-129">**Nota:** se il menu **Power Query** non è visibile, passare a **File** > **Opzioni** > **Componenti aggiuntivi** e selezionare **Componenti aggiuntivi COM** nella casella di riepilogo **Gestisci** nella parte inferiore della pagina.</span><span class="sxs-lookup"><span data-stu-id="f5eb3-129">**Note:** If you don't see the **Power Query** menu, go to **File** > **Options** > **Add-Ins**, and select **COM Add-ins** from the drop-down **Manage** box at the bottom of the page.</span></span> <span data-ttu-id="f5eb3-130">Fare clic sul pulsante **Vai** e verificare che la casella per il componente aggiuntivo Power Query per Excel sia selezionata.</span><span class="sxs-lookup"><span data-stu-id="f5eb3-130">Select the **Go...** button and verify that the box for the Power Query for Excel add-in has been checked.</span></span>
       
        <span data-ttu-id="f5eb3-131">**Nota:** Power Query consente inoltre di importare dati da HDFS facendo clic su **Da altre origini**.</span><span class="sxs-lookup"><span data-stu-id="f5eb3-131">**Note:** Power Query also allows you to import data from HDFS by clicking **From Other Sources**.</span></span>
4. <span data-ttu-id="f5eb3-132">Per **Nome account** immettere il nome dell'account di archiviazione BLOB di Azure associato al cluster, quindi fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="f5eb3-132">For **Account Name**, enter the name of the Azure Blob storage account associated with your cluster, and then click **OK**.</span></span> <span data-ttu-id="f5eb3-133">Questo può essere l'[account di archiviazione predefinito](hdinsight-administer-use-management-portal.md#find-the-default-storage-account) o un account di archiviazione collegato.</span><span class="sxs-lookup"><span data-stu-id="f5eb3-133">This account can be the [default storage account](hdinsight-administer-use-management-portal.md#find-the-default-storage-account) or a linked storage account.</span></span>  <span data-ttu-id="f5eb3-134">Il formato è *https://&lt;StorageAccountName>.blob.core.windows.net/*.</span><span class="sxs-lookup"><span data-stu-id="f5eb3-134">The format is *https://&lt;StorageAccountName>.blob.core.windows.net/*.</span></span>
5. <span data-ttu-id="f5eb3-135">Per **Chiave account** immettere la chiave dell'account di archiviazione BLOB, quindi fare clic su **Salva**.</span><span class="sxs-lookup"><span data-stu-id="f5eb3-135">For **Account Key**, enter the key for the Blob storage account, and then click **Save**.</span></span> <span data-ttu-id="f5eb3-136">È necessario immettere le informazioni sull'account solo la prima volta che si accede a questo archivio.</span><span class="sxs-lookup"><span data-stu-id="f5eb3-136">(You need to enter the account information only the first time you access this store.)</span></span>
6. <span data-ttu-id="f5eb3-137">Nel riquadro **Strumento di navigazione** a sinistra dell'editor di query fare doppio clic sul nome del contenitore di archiviazione BLOB.</span><span class="sxs-lookup"><span data-stu-id="f5eb3-137">In the **Navigator** pane on the left of the Query Editor, double-click the Blob storage container name.</span></span> <span data-ttu-id="f5eb3-138">Per impostazione predefinita, il nome del contenitore è uguale al nome del cluster.</span><span class="sxs-lookup"><span data-stu-id="f5eb3-138">By default, the container name is the same name as the cluster name.</span></span>
7. <span data-ttu-id="f5eb3-139">Individuare **HiveSampleData.txt** nella colonna **Name**. Il percorso della cartella è **../hive/warehouse/hivesampletable/**. Fare quindi clic su **Binary** a sinistra di HiveSampleData.txt.</span><span class="sxs-lookup"><span data-stu-id="f5eb3-139">Locate **HiveSampleData.txt** in the **Name** column (the folder path is **../hive/warehouse/hivesampletable/**), and then click **Binary** on the left of HiveSampleData.txt.</span></span> <span data-ttu-id="f5eb3-140">HiveSampleData.txt include tutto il cluster.</span><span class="sxs-lookup"><span data-stu-id="f5eb3-140">HiveSampleData.txt comes with all the cluster.</span></span> <span data-ttu-id="f5eb3-141">Facoltativamente, è possibile usare un proprio file.</span><span class="sxs-lookup"><span data-stu-id="f5eb3-141">Optionally, you can use your own file.</span></span>
   
    ![HDI.PowerQuery.ImportData][image-hdi-powerquery-importdata]
8. <span data-ttu-id="f5eb3-143">Se necessario, è possibile ridenominare le colonne.</span><span class="sxs-lookup"><span data-stu-id="f5eb3-143">If you want, you can rename the column names.</span></span> <span data-ttu-id="f5eb3-144">Quando si è pronti, fare clic sul pulsante **Chiudi e carica**.</span><span class="sxs-lookup"><span data-stu-id="f5eb3-144">When you are ready, click **Close & Load**.</span></span>  <span data-ttu-id="f5eb3-145">I dati vengono caricati nella cartella di lavoro:</span><span class="sxs-lookup"><span data-stu-id="f5eb3-145">The data has been loaded to your workbook:</span></span>
   
    ![HDI.PowerQuery.ImportedTable][image-hdi-powerquery-imported-table]

## <a name="next-steps"></a><span data-ttu-id="f5eb3-147">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="f5eb3-147">Next steps</span></span>
<span data-ttu-id="f5eb3-148">In questo articolo è stato illustrato come usare Power Query per recuperare dati da HDInsight in Excel.</span><span class="sxs-lookup"><span data-stu-id="f5eb3-148">In this article, you learned how to use Power Query to retrieve data from HDInsight into Excel.</span></span> <span data-ttu-id="f5eb3-149">È analogamente possibile recuperare dati da HDInsight nel database SQL di Azure.</span><span class="sxs-lookup"><span data-stu-id="f5eb3-149">Similarly, you can retrieve data from HDInsight into Azure SQL Database.</span></span> <span data-ttu-id="f5eb3-150">È inoltre possibile caricare dati in HDInsight.</span><span class="sxs-lookup"><span data-stu-id="f5eb3-150">It is also possible to upload data into HDInsight.</span></span> <span data-ttu-id="f5eb3-151">Per altre informazioni, vedere gli articoli seguenti:</span><span class="sxs-lookup"><span data-stu-id="f5eb3-151">To learn more, see the following articles:</span></span>

* <span data-ttu-id="f5eb3-152">[Connettere Excel a HDInsight mediante Microsoft Hive ODBC Driver][hdinsight-ODBC]</span><span class="sxs-lookup"><span data-stu-id="f5eb3-152">[Connect Excel to HDInsight with the Microsoft Hive ODBC Driver][hdinsight-ODBC]</span></span>
* <span data-ttu-id="f5eb3-153">[Caricare dati in HDInsight][hdinsight-upload-data]</span><span class="sxs-lookup"><span data-stu-id="f5eb3-153">[Upload Data to HDInsight][hdinsight-upload-data]</span></span>

[hdinsight-ODBC]: hdinsight-connect-excel-hive-odbc-driver.md
[hdinsight-get-started]: hdinsight-hadoop-linux-tutorial-get-started.md
[hdinsight-upload-data]: hdinsight-upload-data.md

[image-hdi-powerquery-hdi-source]: ./media/hdinsight-connect-excel-power-query/hdi.powerquery.selecthdisource.png
[image-hdi-powerquery-importdata]: ./media/hdinsight-connect-excel-power-query/hdi.powerquery.importdata.png
[image-hdi-powerquery-imported-table]: ./media/hdinsight-connect-excel-power-query/hdi.powerquery.importedtable.PNG

[powerquery-download]: http://go.microsoft.com/fwlink/?LinkID=286689
