---
title: Opzioni di risoluzione dei nomi DNS per macchine virtuali Linux in Azure
description: "Scenari di risoluzione dei nomi per macchine virtuali Linux in IaaS di Azure, inclusi i servizi DNS forniti, DNS esterno ibrido e possibilità di usare il proprio server DNS."
services: virtual-machines
documentationcenter: na
author: RicksterCDN
manager: timlt
editor: tysonn
ms.assetid: 787a1e04-cebf-4122-a1b4-1fcf0a2bbf5f
ms.service: virtual-machines-linux
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 10/19/2016
ms.author: rclaus
ms.openlocfilehash: cc06ee9305b4d3034154a0825c1aea53fe446f80
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 07/11/2017
---
# <a name="dns-name-resolution-options-for-linux-virtual-machines-in-azure"></a><span data-ttu-id="8feaa-103">Opzioni di risoluzione dei nomi DNS per macchine virtuali Linux in Azure</span><span class="sxs-lookup"><span data-stu-id="8feaa-103">DNS Name Resolution options for Linux virtual machines in Azure</span></span>
<span data-ttu-id="8feaa-104">Per impostazione predefinita, Azure fornisce la risoluzione dei nomi DNS per tutte le macchine virtuali contenute in una singola rete virtuale.</span><span class="sxs-lookup"><span data-stu-id="8feaa-104">Azure provides DNS name resolution by default for all virtual machines that are in a single virtual network.</span></span> <span data-ttu-id="8feaa-105">È possibile implementare la soluzione di risoluzione dei nomi DNS configurando i servizi DNS nelle macchine virtuali ospitate da Azure.</span><span class="sxs-lookup"><span data-stu-id="8feaa-105">You can implement your own DNS name resolution solution by configuring your own DNS services on your virtual machines that Azure hosts.</span></span> <span data-ttu-id="8feaa-106">Gli scenari seguenti consentono di scegliere quello più adatto alla situazione specifica.</span><span class="sxs-lookup"><span data-stu-id="8feaa-106">The following scenarios should help you choose the one that works for your situation.</span></span>

* [<span data-ttu-id="8feaa-107">Risoluzione dei nomi forniti da Azure</span><span class="sxs-lookup"><span data-stu-id="8feaa-107">Name resolution that Azure provides</span></span>](#azure-provided-name-resolution)
* [<span data-ttu-id="8feaa-108">Risoluzione dei nomi usando il server DNS</span><span class="sxs-lookup"><span data-stu-id="8feaa-108">Name resolution using your own DNS server</span></span>](#name-resolution-using-your-own-dns-server)

<span data-ttu-id="8feaa-109">Il tipo di risoluzione dei nomi usato dipende dal modo in cui macchine virtuali e istanze del ruolo devono comunicare.</span><span class="sxs-lookup"><span data-stu-id="8feaa-109">The type of name resolution that you use depends on how your virtual machines and role instances need to communicate with each other.</span></span>

<span data-ttu-id="8feaa-110">Nella tabella seguente vengono illustrate diverse ipotesi e le corrispondenti soluzioni di risoluzione dei nomi:</span><span class="sxs-lookup"><span data-stu-id="8feaa-110">The following table illustrates scenarios and corresponding name resolution solutions:</span></span>

| <span data-ttu-id="8feaa-111">**Scenario**</span><span class="sxs-lookup"><span data-stu-id="8feaa-111">**Scenario**</span></span> | <span data-ttu-id="8feaa-112">**Soluzione**</span><span class="sxs-lookup"><span data-stu-id="8feaa-112">**Solution**</span></span> | <span data-ttu-id="8feaa-113">**Suffisso**</span><span class="sxs-lookup"><span data-stu-id="8feaa-113">**Suffix**</span></span> |
| --- | --- | --- |
| <span data-ttu-id="8feaa-114">Risoluzione dei nomi tra istanze del ruolo o macchine virtuali presenti nella stessa rete virtuale</span><span class="sxs-lookup"><span data-stu-id="8feaa-114">Name resolution between role instances or virtual machines in the same virtual network</span></span> |[<span data-ttu-id="8feaa-115">Risoluzione dei nomi forniti da Azure</span><span class="sxs-lookup"><span data-stu-id="8feaa-115">Name resolution that Azure provides</span></span>](#azure-provided-name-resolution) |<span data-ttu-id="8feaa-116">nome host o nome di dominio completo (FQDN)</span><span class="sxs-lookup"><span data-stu-id="8feaa-116">hostname or fully-qualified domain name (FQDN)</span></span> |
| <span data-ttu-id="8feaa-117">Risoluzione dei nomi tra istanze del ruolo o macchine virtuali presenti in reti virtuali diverse</span><span class="sxs-lookup"><span data-stu-id="8feaa-117">Name resolution between role instances or virtual machines in different virtual networks</span></span> |<span data-ttu-id="8feaa-118">Server DNS gestiti dal cliente che inoltrano query tra reti virtuali per la risoluzione da parte di Azure (proxy DNS).</span><span class="sxs-lookup"><span data-stu-id="8feaa-118">Customer-managed DNS servers that forward queries between virtual networks for resolution by Azure (DNS proxy).</span></span> <span data-ttu-id="8feaa-119">Vedere [Risoluzione dei nomi usando il server DNS](#name-resolution-using-your-own-dns-server).</span><span class="sxs-lookup"><span data-stu-id="8feaa-119">See [Name resolution using your own DNS server](#name-resolution-using-your-own-dns-server).</span></span> |<span data-ttu-id="8feaa-120">Solo nome di dominio completo</span><span class="sxs-lookup"><span data-stu-id="8feaa-120">FQDN only</span></span> |
| <span data-ttu-id="8feaa-121">Risoluzione dei nomi servizi e computer locali da istanze del ruolo o macchine virtuali in Azure</span><span class="sxs-lookup"><span data-stu-id="8feaa-121">Resolution of on-premises computers and service names from role instances or virtual machines in Azure</span></span> |<span data-ttu-id="8feaa-122">Server DNS gestiti dal cliente, ad esempio controller di dominio locale, controller di dominio di sola lettura locale o server DNS secondario sincronizzati tramite trasferimenti di zona.</span><span class="sxs-lookup"><span data-stu-id="8feaa-122">Customer-managed DNS servers (for example, on-premises domain controller, local read-only domain controller, or a DNS secondary synced by using zone transfers).</span></span> <span data-ttu-id="8feaa-123">Vedere [Risoluzione dei nomi usando il server DNS](#name-resolution-using-your-own-dns-server).</span><span class="sxs-lookup"><span data-stu-id="8feaa-123">See [Name resolution using your own DNS server](#name-resolution-using-your-own-dns-server).</span></span> |<span data-ttu-id="8feaa-124">Solo nome di dominio completo</span><span class="sxs-lookup"><span data-stu-id="8feaa-124">FQDN only</span></span> |
| <span data-ttu-id="8feaa-125">Risoluzione di nomi host di Azure da computer locali</span><span class="sxs-lookup"><span data-stu-id="8feaa-125">Resolution of Azure hostnames from on-premises computers</span></span> |<span data-ttu-id="8feaa-126">Inoltro delle query a un server proxy DNS gestito dal cliente nella rete virtuale corrispondente.</span><span class="sxs-lookup"><span data-stu-id="8feaa-126">Forward queries to a customer-managed DNS proxy server in the corresponding virtual network.</span></span> <span data-ttu-id="8feaa-127">Il server proxy inoltra le richieste ad Azure per la risoluzione.</span><span class="sxs-lookup"><span data-stu-id="8feaa-127">The proxy server forwards queries to Azure for resolution.</span></span> <span data-ttu-id="8feaa-128">Vedere [Risoluzione dei nomi usando il server DNS](#name-resolution-using-your-own-dns-server).</span><span class="sxs-lookup"><span data-stu-id="8feaa-128">See [Name resolution using your own DNS server](#name-resolution-using-your-own-dns-server).</span></span> |<span data-ttu-id="8feaa-129">Solo nome di dominio completo</span><span class="sxs-lookup"><span data-stu-id="8feaa-129">FQDN only</span></span> |
| <span data-ttu-id="8feaa-130">DNS inversi per indirizzi IP interni</span><span class="sxs-lookup"><span data-stu-id="8feaa-130">Reverse DNS for internal IPs</span></span> |[<span data-ttu-id="8feaa-131">Risoluzione dei nomi usando il server DNS</span><span class="sxs-lookup"><span data-stu-id="8feaa-131">Name resolution using your own DNS server</span></span>](#name-resolution-using-your-own-dns-server) |<span data-ttu-id="8feaa-132">N/D</span><span class="sxs-lookup"><span data-stu-id="8feaa-132">n/a</span></span> |

## <a name="name-resolution-that-azure-provides"></a><span data-ttu-id="8feaa-133">Risoluzione dei nomi forniti da Azure</span><span class="sxs-lookup"><span data-stu-id="8feaa-133">Name resolution that Azure provides</span></span>
<span data-ttu-id="8feaa-134">Oltre alla risoluzione dei nomi DNS pubblici, Azure offre la risoluzione dei nomi interni per macchine virtuali e istanze del ruolo che si trovano all'interno della stessa rete virtuale.</span><span class="sxs-lookup"><span data-stu-id="8feaa-134">Along with resolution of public DNS names, Azure provides internal name resolution for virtual machines and role instances that are in the same virtual network.</span></span> <span data-ttu-id="8feaa-135">In reti virtuali basate su Azure Resource Manager, il suffisso DNS è coerente attraverso la rete virtuale; il nome FQDN non è necessario.</span><span class="sxs-lookup"><span data-stu-id="8feaa-135">In virtual networks that are based on Azure Resource Manager, the DNS suffix is consistent across the virtual network; the FQDN is not needed.</span></span> <span data-ttu-id="8feaa-136">I nomi DNS possono essere assegnati sia a schede di interfaccia di rete (NIC), sia a macchine virtuali.</span><span class="sxs-lookup"><span data-stu-id="8feaa-136">DNS names can be assigned to both network interface cards (NICs) and virtual machines.</span></span> <span data-ttu-id="8feaa-137">Sebbene la risoluzione dei nomi fornita da Azure non richieda alcuna configurazione, non è la scelta più appropriata per tutti gli scenari di distribuzione, come illustrato nella tabella precedente.</span><span class="sxs-lookup"><span data-stu-id="8feaa-137">Although the name resolution that Azure provides does not require any configuration, it is not the appropriate choice for all deployment scenarios, as seen on the preceding table.</span></span>

### <a name="features-and-considerations"></a><span data-ttu-id="8feaa-138">Funzionalità e considerazioni</span><span class="sxs-lookup"><span data-stu-id="8feaa-138">Features and considerations</span></span>
<span data-ttu-id="8feaa-139">**Funzionalità**</span><span class="sxs-lookup"><span data-stu-id="8feaa-139">**Features:**</span></span>

* <span data-ttu-id="8feaa-140">Non è necessaria alcuna configurazione per usare la risoluzione dei nomi fornita da Azure.</span><span class="sxs-lookup"><span data-stu-id="8feaa-140">No configuration is required to use name resolution that Azure provides.</span></span>
* <span data-ttu-id="8feaa-141">Il servizio di risoluzione dei nomi fornito da Azure ha un'elevata disponibilità.</span><span class="sxs-lookup"><span data-stu-id="8feaa-141">The name resolution service that Azure provides is highly available.</span></span> <span data-ttu-id="8feaa-142">Non è necessario creare e gestire i cluster dei server DNS propri.</span><span class="sxs-lookup"><span data-stu-id="8feaa-142">You don't need to create and manage clusters of your own DNS servers.</span></span>
* <span data-ttu-id="8feaa-143">Il servizio di risoluzione dei nomi fornito da Azure può essere usato insieme ai propri server DNS per risolvere i nomi host locali e i nomi host di Azure.</span><span class="sxs-lookup"><span data-stu-id="8feaa-143">The name resolution service that Azure provides can be used along with your own DNS servers to resolve both on-premises and Azure hostnames.</span></span>
* <span data-ttu-id="8feaa-144">Viene fornita la risoluzione dei nomi tra macchine virtuali in reti virtuali, senza necessità del nome FQDN.</span><span class="sxs-lookup"><span data-stu-id="8feaa-144">Name resolution is provided between virtual machines in virtual networks without need for the FQDN.</span></span>
* <span data-ttu-id="8feaa-145">È possibile usare nomi host personalizzati in grado di descrivere in modo più adeguato le distribuzioni, anziché usare nomi generati automaticamente.</span><span class="sxs-lookup"><span data-stu-id="8feaa-145">You can use hostnames that best describe your deployments rather than working with auto-generated names.</span></span>

<span data-ttu-id="8feaa-146">**Considerazioni:**</span><span class="sxs-lookup"><span data-stu-id="8feaa-146">**Considerations:**</span></span>

* <span data-ttu-id="8feaa-147">Il suffisso DNS creato da Azure non può essere modificato.</span><span class="sxs-lookup"><span data-stu-id="8feaa-147">The DNS suffix that Azure creates cannot be modified.</span></span>
* <span data-ttu-id="8feaa-148">Non è possibile registrare manualmente i propri record.</span><span class="sxs-lookup"><span data-stu-id="8feaa-148">You cannot manually register your own records.</span></span>
* <span data-ttu-id="8feaa-149">WINS e NetBIOS non sono supportati.</span><span class="sxs-lookup"><span data-stu-id="8feaa-149">WINS and NetBIOS are not supported.</span></span>
* <span data-ttu-id="8feaa-150">I nomi host devono essere compatibili con DNS.</span><span class="sxs-lookup"><span data-stu-id="8feaa-150">Hostnames must be DNS-compatible.</span></span>
    <span data-ttu-id="8feaa-151">I nomi devono usare solo 0-9, a-z e "-" e non possono iniziare o terminare con un "-".</span><span class="sxs-lookup"><span data-stu-id="8feaa-151">Names must use only 0-9, a-z, and '-', and they cannot start or end with a '-'.</span></span> <span data-ttu-id="8feaa-152">Vedere RFC 3696 Sezione 2.</span><span class="sxs-lookup"><span data-stu-id="8feaa-152">See RFC 3696 Section 2.</span></span>
* <span data-ttu-id="8feaa-153">Il traffico di query DNS è limitato per ogni macchina virtuale.</span><span class="sxs-lookup"><span data-stu-id="8feaa-153">DNS query traffic is throttled for each virtual machine.</span></span> <span data-ttu-id="8feaa-154">La limitazione in genere non comporta alcun impatto sulla maggior parte delle applicazioni.</span><span class="sxs-lookup"><span data-stu-id="8feaa-154">Throttling shouldn't impact most applications.</span></span>  <span data-ttu-id="8feaa-155">Se viene osservata la limitazione delle richieste, assicurarsi che la memorizzazione nella cache sul lato client sia abilitata.</span><span class="sxs-lookup"><span data-stu-id="8feaa-155">If request throttling is observed, ensure that client-side caching is enabled.</span></span>  <span data-ttu-id="8feaa-156">Per altre informazioni, vedere [Come usare al meglio la risoluzione dei nomi fornita da Azure](#getting-the-most-from-name-resolution-that-azure-provides).</span><span class="sxs-lookup"><span data-stu-id="8feaa-156">For more information, see [Getting the most from name resolution that Azure provides](#getting-the-most-from-name-resolution-that-azure-provides).</span></span>

### <a name="getting-the-most-from-name-resolution-that-azure-provides"></a><span data-ttu-id="8feaa-157">Come usare al meglio la risoluzione dei nomi fornita da Azure</span><span class="sxs-lookup"><span data-stu-id="8feaa-157">Getting the most from name resolution that Azure provides</span></span>
<span data-ttu-id="8feaa-158">**Memorizzazione nella cache sul lato client:**</span><span class="sxs-lookup"><span data-stu-id="8feaa-158">**Client-side caching:**</span></span>

<span data-ttu-id="8feaa-159">Alcune query DNS non vengono inviate attraverso la rete.</span><span class="sxs-lookup"><span data-stu-id="8feaa-159">Some DNS queries are not sent across the network.</span></span> <span data-ttu-id="8feaa-160">La memorizzazione nella cache sul lato client consente di ridurre la latenza e migliorare la resilienza alle incoerenze di rete, tramite la risoluzione di query DNS ricorrenti da una cache locale.</span><span class="sxs-lookup"><span data-stu-id="8feaa-160">Client-side caching helps reduce latency and improve resilience to network inconsistencies by resolving recurring DNS queries from a local cache.</span></span> <span data-ttu-id="8feaa-161">I record DNS contengono una durata (TTL) che consente alla cache di memorizzare il record per il periodo di tempo più lungo possibile senza che questo influisca sullo stato di aggiornamento del record.</span><span class="sxs-lookup"><span data-stu-id="8feaa-161">DNS records contain a Time-To-Live (TTL), which enables the cache to store the record for as long as possible without impacting record freshness.</span></span> <span data-ttu-id="8feaa-162">Di conseguenza, la memorizzazione nella cache sul lato client è ideale per la maggior parte delle situazioni.</span><span class="sxs-lookup"><span data-stu-id="8feaa-162">As a result, client-side caching is suitable for most situations.</span></span>

<span data-ttu-id="8feaa-163">Alcune distribuzioni Linux non includono la memorizzazione nella cache per impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="8feaa-163">Some Linux distributions do not include caching by default.</span></span> <span data-ttu-id="8feaa-164">Si consiglia di aggiungere una cache per ogni macchina virtuale dopo aver controllato che non vi sia già una cache locale.</span><span class="sxs-lookup"><span data-stu-id="8feaa-164">We recommend that you add a cache to each Linux virtual machine after you check that there isn't a local cache already.</span></span>

<span data-ttu-id="8feaa-165">Sono disponibili diversi pacchetti di memorizzazione nella cache DNS, ad esempio dnsmasq.</span><span class="sxs-lookup"><span data-stu-id="8feaa-165">Several different DNS caching packages, such as dnsmasq, are available.</span></span> <span data-ttu-id="8feaa-166">Ecco i passaggi per installare dnsmasq sulle distribuzioni più comuni:</span><span class="sxs-lookup"><span data-stu-id="8feaa-166">Here are the steps to install dnsmasq on the most common distributions:</span></span>

<span data-ttu-id="8feaa-167">**Ubuntu (usa resolvconf)**</span><span class="sxs-lookup"><span data-stu-id="8feaa-167">**Ubuntu (uses resolvconf)**</span></span>
  * <span data-ttu-id="8feaa-168">Installare il pacchetto dnsmasq ("sudo apt-get install dnsmasq").</span><span class="sxs-lookup"><span data-stu-id="8feaa-168">Install the dnsmasq package (“sudo apt-get install dnsmasq”).</span></span>

<span data-ttu-id="8feaa-169">**SUSE (usa netconf)**:</span><span class="sxs-lookup"><span data-stu-id="8feaa-169">**SUSE (uses netconf)**:</span></span>
1. <span data-ttu-id="8feaa-170">Installare il pacchetto dnsmasq ("sudo zypper install dnsmasq").</span><span class="sxs-lookup"><span data-stu-id="8feaa-170">Install the dnsmasq package (“sudo zypper install dnsmasq”).</span></span>
2. <span data-ttu-id="8feaa-171">Abilitare il servizio dnsmasq ("systemctl enable dnsmasq.service").</span><span class="sxs-lookup"><span data-stu-id="8feaa-171">Enable the dnsmasq service (“systemctl enable dnsmasq.service”).</span></span>
3. <span data-ttu-id="8feaa-172">Avviare il servizio dnsmasq ("systemctl start dnsmasq.service").</span><span class="sxs-lookup"><span data-stu-id="8feaa-172">Start the dnsmasq service (“systemctl start dnsmasq.service”).</span></span>
4. <span data-ttu-id="8feaa-173">Modificare "/etc/sysconfig/network/config" e sostituire NETCONFIG_DNS_FORWARDER="" con "dnsmasq".</span><span class="sxs-lookup"><span data-stu-id="8feaa-173">Edit “/etc/sysconfig/network/config”, and change NETCONFIG_DNS_FORWARDER="" to ”dnsmasq”.</span></span>
5. <span data-ttu-id="8feaa-174">Aggiornare resolv.conf ("netconfig update") per impostare la cache come resolver DNS locale.</span><span class="sxs-lookup"><span data-stu-id="8feaa-174">Update resolv.conf ("netconfig update") to set the cache as the local DNS resolver.</span></span>

<span data-ttu-id="8feaa-175">**CentOS di Rogue Wave Software (in precedenza OpenLogic) (usa NetworkManager)**</span><span class="sxs-lookup"><span data-stu-id="8feaa-175">**CentOS by Rogue Wave Software (formerly OpenLogic; uses NetworkManager)**</span></span>
1. <span data-ttu-id="8feaa-176">Installare il pacchetto dnsmasq ("sudo yum install dnsmasq").</span><span class="sxs-lookup"><span data-stu-id="8feaa-176">Install the dnsmasq package (“sudo yum install dnsmasq”).</span></span>
2. <span data-ttu-id="8feaa-177">Abilitare il servizio dnsmasq ("systemctl enable dnsmasq.service").</span><span class="sxs-lookup"><span data-stu-id="8feaa-177">Enable the dnsmasq service (“systemctl enable dnsmasq.service”).</span></span>
3. <span data-ttu-id="8feaa-178">Avviare il servizio dnsmasq ("systemctl start dnsmasq.service").</span><span class="sxs-lookup"><span data-stu-id="8feaa-178">Start the dnsmasq service (“systemctl start dnsmasq.service”).</span></span>
4. <span data-ttu-id="8feaa-179">Aggiungere "prepend domain-name-servers 127.0.0.1;" in "/etc/dhclient-eth0.conf".</span><span class="sxs-lookup"><span data-stu-id="8feaa-179">Add “prepend domain-name-servers 127.0.0.1;” to “/etc/dhclient-eth0.conf”.</span></span>
5. <span data-ttu-id="8feaa-180">Riavviare il servizio di rete ("service network restart") per impostare la cache come resolver DNS locale</span><span class="sxs-lookup"><span data-stu-id="8feaa-180">Restart the network service (“service network restart”) to set the cache as the local DNS resolver</span></span>

> [!NOTE]
> <span data-ttu-id="8feaa-181">: il pacchetto 'dnsmasq' è solo una delle cache DNS disponibili per Linux.</span><span class="sxs-lookup"><span data-stu-id="8feaa-181">: The 'dnsmasq' package is only one of the many DNS caches that are available for Linux.</span></span> <span data-ttu-id="8feaa-182">Prima di usarla, verificare che sia adatta in base alle esigenze specifiche e assicurarsi che non siano installate altre cache.</span><span class="sxs-lookup"><span data-stu-id="8feaa-182">Before you use it, check its suitability for your needs and that no other cache is installed.</span></span>
>
>

<span data-ttu-id="8feaa-183">**Ripetizione di tentativi sul lato client**</span><span class="sxs-lookup"><span data-stu-id="8feaa-183">**Client-side retries**</span></span>

<span data-ttu-id="8feaa-184">DNS è principalmente un protocollo UDP.</span><span class="sxs-lookup"><span data-stu-id="8feaa-184">DNS is primarily a UDP protocol.</span></span> <span data-ttu-id="8feaa-185">Poiché il protocollo UDP non garantisce il recapito dei messaggi, la logica di ripetizione dei tentativi viene gestita nel protocollo DNS stesso.</span><span class="sxs-lookup"><span data-stu-id="8feaa-185">Because the UDP protocol doesn't guarantee message delivery, the DNS protocol itself handles retry logic.</span></span> <span data-ttu-id="8feaa-186">Ogni client DNS (sistema operativo) può includere una logica di ripetizione dei tentativi diversa, in base alle preferenze degli autori:</span><span class="sxs-lookup"><span data-stu-id="8feaa-186">Each DNS client (operating system) can exhibit different retry logic depending on the creator's preference:</span></span>

* <span data-ttu-id="8feaa-187">i sistemi operativi Windows eseguono un nuovo tentativo dopo 1 secondo e ne eseguono un altro dopo 2, 4 e altri 4 secondi.</span><span class="sxs-lookup"><span data-stu-id="8feaa-187">Windows operating systems retry after one second and then again after another two, four, and another four seconds.</span></span>
* <span data-ttu-id="8feaa-188">La configurazione di Linux predefinita esegue il tentativo dopo 5 secondi.</span><span class="sxs-lookup"><span data-stu-id="8feaa-188">The default Linux setup retries after five seconds.</span></span>  <span data-ttu-id="8feaa-189">Modificare questa impostazione in modo da eseguire cinque tentativi a intervalli di 1 secondo.</span><span class="sxs-lookup"><span data-stu-id="8feaa-189">You should change this to retry five times at one-second intervals.</span></span>  

<span data-ttu-id="8feaa-190">Per verificare le impostazioni correnti in una macchina virtuale Linux, aprire il file "cat /etc/resolv.conf" e osservare la riga "options", ad esempio:</span><span class="sxs-lookup"><span data-stu-id="8feaa-190">To check the current settings on a Linux virtual machine, 'cat /etc/resolv.conf', and look at the 'options' line, for example:</span></span>

    options timeout:1 attempts:5

<span data-ttu-id="8feaa-191">Il file resolv.conf viene generato automaticamente e non deve essere modificato.</span><span class="sxs-lookup"><span data-stu-id="8feaa-191">The resolv.conf file is auto-generated and should not be edited.</span></span> <span data-ttu-id="8feaa-192">La procedura specifica per aggiungere la riga "options" varia a seconda della distribuzione:</span><span class="sxs-lookup"><span data-stu-id="8feaa-192">The specific steps that add the 'options' line vary by distribution:</span></span>

<span data-ttu-id="8feaa-193">**Ubuntu** (usa resolvconf)</span><span class="sxs-lookup"><span data-stu-id="8feaa-193">**Ubuntu** (uses resolvconf)</span></span>
1. <span data-ttu-id="8feaa-194">Aggiungere la riga per le opzioni in "/etc/resolveconf/resolv.conf.d/head".</span><span class="sxs-lookup"><span data-stu-id="8feaa-194">Add the options line to '/etc/resolveconf/resolv.conf.d/head'.</span></span>
2. <span data-ttu-id="8feaa-195">Eseguire "resolvconf -u" per aggiornare.</span><span class="sxs-lookup"><span data-stu-id="8feaa-195">Run 'resolvconf -u' to update.</span></span>

<span data-ttu-id="8feaa-196">**SUSE** (usa netconf)</span><span class="sxs-lookup"><span data-stu-id="8feaa-196">**SUSE** (uses netconf)</span></span>
1. <span data-ttu-id="8feaa-197">Aggiungere "timeout:1 attempts:5" al parametro NETCONFIG_DNS_RESOLVER_OPTIONS="" in "/etc/sysconfig/network/config".</span><span class="sxs-lookup"><span data-stu-id="8feaa-197">Add 'timeout:1 attempts:5' to the NETCONFIG_DNS_RESOLVER_OPTIONS="" parameter in '/etc/sysconfig/network/config'.</span></span>
2. <span data-ttu-id="8feaa-198">Eseguire "netconfig update" per aggiornare.</span><span class="sxs-lookup"><span data-stu-id="8feaa-198">Run 'netconfig update' to update.</span></span>

<span data-ttu-id="8feaa-199">**CentOS di Rogue Wave Software (in precedenza OpenLogic)** (usa NetworkManager)</span><span class="sxs-lookup"><span data-stu-id="8feaa-199">**CentOS by Rogue Wave Software (formerly OpenLogic)** (uses NetworkManager)</span></span>
1. <span data-ttu-id="8feaa-200">Aggiungere "echo "options timeout:1 attempts:5"" in "/etc/NetworkManager/dispatcher.d/11-dhclient".</span><span class="sxs-lookup"><span data-stu-id="8feaa-200">Add 'echo "options timeout:1 attempts:5"' to '/etc/NetworkManager/dispatcher.d/11-dhclient'.</span></span>
2. <span data-ttu-id="8feaa-201">Eseguire "service network restart" per aggiornare.</span><span class="sxs-lookup"><span data-stu-id="8feaa-201">Run 'service network restart' to update.</span></span>

## <a name="name-resolution-using-your-own-dns-server"></a><span data-ttu-id="8feaa-202">Risoluzione dei nomi usando il server DNS</span><span class="sxs-lookup"><span data-stu-id="8feaa-202">Name resolution using your own DNS server</span></span>
<span data-ttu-id="8feaa-203">Le esigenze di risoluzione nome possono andare oltre le funzionalità presenti in Azure.</span><span class="sxs-lookup"><span data-stu-id="8feaa-203">Your name resolution needs may go beyond the features that Azure provides.</span></span> <span data-ttu-id="8feaa-204">Ad esempio, potrebbe essere necessaria una risoluzione DNS tra reti virtuali.</span><span class="sxs-lookup"><span data-stu-id="8feaa-204">For example, you might require DNS resolution between virtual networks.</span></span> <span data-ttu-id="8feaa-205">Per coprire questo scenario, è possibile usare i propri server DNS.</span><span class="sxs-lookup"><span data-stu-id="8feaa-205">To cover this scenario, you can use your own DNS servers.</span></span>  

<span data-ttu-id="8feaa-206">I server DNS all'interno di una rete virtuale possono inoltrare query DNS ai resolver ricorsivi di Azure per risolvere i nomi host all'interno della stessa rete virtuale.</span><span class="sxs-lookup"><span data-stu-id="8feaa-206">DNS servers within a virtual network can forward DNS queries to recursive resolvers of Azure to resolve hostnames that are in the same virtual network.</span></span> <span data-ttu-id="8feaa-207">Ad esempio, un server DNS in esecuzione in Azure può rispondere a query DNS per i propri file di zona DNS e inoltrare tutte le altre query ad Azure.</span><span class="sxs-lookup"><span data-stu-id="8feaa-207">For example, a DNS server that runs in Azure can respond to DNS queries for its own DNS zone files and forward all other queries to Azure.</span></span> <span data-ttu-id="8feaa-208">Questa funzionalità consente alle macchine virtuali di visualizzare sia le voci nel file di zona che i nomi host forniti da Azure (tramite il server d'inoltro).</span><span class="sxs-lookup"><span data-stu-id="8feaa-208">This functionality enables virtual machines to see both your entries in your zone files and hostnames that Azure provides (via the forwarder).</span></span> <span data-ttu-id="8feaa-209">L'accesso ai resolver ricorsivi di Azure viene fornito tramite l'indirizzo IP virtuale 168.63.129.16.</span><span class="sxs-lookup"><span data-stu-id="8feaa-209">Access to the recursive resolvers of Azure is provided via the virtual IP 168.63.129.16.</span></span>

<span data-ttu-id="8feaa-210">L'inoltro del DNS abilita anche la risoluzione DNS tra reti virtuali e consente ai computer locali di risolvere i nomi host forniti da Azure.</span><span class="sxs-lookup"><span data-stu-id="8feaa-210">DNS forwarding also enables DNS resolution between virtual networks and enables your on-premises machines to resolve hostnames that Azure provides.</span></span> <span data-ttu-id="8feaa-211">Per risolvere il nome host di una macchina virtuale, la macchina virtuale del server DNS deve risiedere nella stessa rete virtuale ed essere configurata per inoltrare le query relative ai nomi host ad Azure.</span><span class="sxs-lookup"><span data-stu-id="8feaa-211">To resolve a virtual machine's hostname, the DNS server virtual machine must reside in the same virtual network and be configured to forward hostname queries to Azure.</span></span> <span data-ttu-id="8feaa-212">Poiché il suffisso DNS è diverso in ogni rete virtuale, è possibile usare le regole di inoltro condizionale per inviare le query DNS alla rete virtuale corretta per la risoluzione.</span><span class="sxs-lookup"><span data-stu-id="8feaa-212">Because the DNS suffix is different in each virtual network, you can use conditional forwarding rules to send DNS queries to the correct virtual network for resolution.</span></span> <span data-ttu-id="8feaa-213">L'immagine seguente mostra due reti virtuali e una rete locale che gestiscono la risoluzione DNS tra reti virtuali con questo metodo:</span><span class="sxs-lookup"><span data-stu-id="8feaa-213">The following image shows two virtual networks and an on-premises network doing DNS resolution between virtual networks by using this method:</span></span>

![Risoluzione DNS tra reti virtuali](./media/azure-dns/inter-vnet-dns.png)

<span data-ttu-id="8feaa-215">Quando si usa la risoluzione dei nomi fornita da Azure, il suffisso DNS interno viene fornito a ogni macchina virtuale tramite DHCP.</span><span class="sxs-lookup"><span data-stu-id="8feaa-215">When you use name resolution that Azure provides, the internal DNS suffix is provided to each virtual machine by using DHCP.</span></span> <span data-ttu-id="8feaa-216">Quando si usa la soluzione di risoluzione dei nomi personalizzata, questo suffisso non viene fornito alle macchine virtuali perché interferisce con altre architetture DNS.</span><span class="sxs-lookup"><span data-stu-id="8feaa-216">When you use your own name resolution solution, this suffix is not supplied to virtual machines because the suffix interferes with other DNS architectures.</span></span> <span data-ttu-id="8feaa-217">Per fare riferimento alle macchine virtuali usando il nome di dominio completo o per configurare il suffisso nelle macchine virtuali, è possibile usare PowerShell o l'API per determinare il suffisso:</span><span class="sxs-lookup"><span data-stu-id="8feaa-217">To refer to machines by FQDN or to configure the suffix on your virtual machines, you can use PowerShell or the API to determine the suffix:</span></span>

* <span data-ttu-id="8feaa-218">Per le reti virtuali gestite da Azure Resource Manager, il suffisso è disponibile tramite la risorsa [scheda interfaccia di rete](https://msdn.microsoft.com/library/azure/mt163668.aspx).</span><span class="sxs-lookup"><span data-stu-id="8feaa-218">For virtual networks that are managed by Azure Resource Manager, the suffix is available via the [network interface card](https://msdn.microsoft.com/library/azure/mt163668.aspx) resource.</span></span> <span data-ttu-id="8feaa-219">È possibile eseguire anche il comando `azure network public-ip show <resource group> <pip name>` per visualizzare i dettagli dell'indirizzo IP pubblico, che include il nome FQDN della scheda di rete.</span><span class="sxs-lookup"><span data-stu-id="8feaa-219">You can also run the `azure network public-ip show <resource group> <pip name>` command to display the details of your public IP, which includes the FQDN of the NIC.</span></span>

<span data-ttu-id="8feaa-220">Se l'inoltro delle query ad Azure non soddisfa le esigenze correnti, sarà necessario offrire una soluzione DNS personalizzata.</span><span class="sxs-lookup"><span data-stu-id="8feaa-220">If forwarding queries to Azure doesn't suit your needs, you need to provide your own DNS solution.</span></span>  <span data-ttu-id="8feaa-221">La soluzione DNS deve:</span><span class="sxs-lookup"><span data-stu-id="8feaa-221">Your DNS solution needs to:</span></span>

* <span data-ttu-id="8feaa-222">Offrire una soluzione di risoluzione dei nomi host appropriata, ad esempio tramite [DNS dinamico](../../virtual-network/virtual-networks-name-resolution-ddns.md).</span><span class="sxs-lookup"><span data-stu-id="8feaa-222">Provide appropriate hostname resolution, for example via [DDNS](../../virtual-network/virtual-networks-name-resolution-ddns.md).</span></span> <span data-ttu-id="8feaa-223">Se si usa DDNS, potrebbe essere necessario disabilitare lo scavenging dei record DNS.</span><span class="sxs-lookup"><span data-stu-id="8feaa-223">If you use DDNS, you might need to disable DNS record scavenging.</span></span> <span data-ttu-id="8feaa-224">Le lease DHCP di Azure sono molto lunghe e lo scavenging può rimuovere i record DNS in modo anomalo.</span><span class="sxs-lookup"><span data-stu-id="8feaa-224">DHCP leases of Azure are very long and scavenging may remove DNS records prematurely.</span></span>
* <span data-ttu-id="8feaa-225">Fornire una soluzione di risoluzione ricorsiva appropriata per consentire la risoluzione dei nomi di dominio esterni.</span><span class="sxs-lookup"><span data-stu-id="8feaa-225">Provide appropriate recursive resolution to allow resolution of external domain names.</span></span>
* <span data-ttu-id="8feaa-226">Essere accessibile (tramite TCP e UDP sulla porta 53) dai client che gestisce e in grado di accedere a Internet.</span><span class="sxs-lookup"><span data-stu-id="8feaa-226">Be accessible (TCP and UDP on port 53) from the clients it serves and be able to access the Internet.</span></span>
* <span data-ttu-id="8feaa-227">Essere protetta dagli accessi provenienti da Internet per attenuare i rischi rappresentati da agenti esterni.</span><span class="sxs-lookup"><span data-stu-id="8feaa-227">Be secured against access from the Internet to mitigate threats posed by external agents.</span></span>

> [!NOTE]
> <span data-ttu-id="8feaa-228">Per prestazioni ottimali, quando si usano macchine virtuali nei server DNS di Azure, disabilitare il protocollo IPv6 e assegnare un [indirizzo IP pubblico a livello di istanza](../../virtual-network/virtual-networks-instance-level-public-ip.md) a ogni macchina virtuale di server DNS.</span><span class="sxs-lookup"><span data-stu-id="8feaa-228">For best performance, when you use virtual machines in Azure DNS servers, disable IPv6 and assign an [Instance-Level Public IP](../../virtual-network/virtual-networks-instance-level-public-ip.md) to each DNS server virtual machine.</span></span>  
>
>
