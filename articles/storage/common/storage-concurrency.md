---
title: aaaManaging concorrenza in archiviazione di Microsoft Azure
description: "Modalità concorrenza toomanage per hello servizi Blob, coda, tabella e File"
services: storage
documentationcenter: 
author: jasontang501
manager: tadb
editor: tysonn
ms.assetid: cc6429c4-23ee-46e3-b22d-50dd68bd4680
ms.service: storage
ms.workload: storage
ms.tgt_pltfrm: na
ms.devlang: dotnet
ms.topic: article
ms.date: 05/11/2017
ms.author: jasontang501
ms.openlocfilehash: 5b8efbe0a9ebc881ded8f3abef5f138e0385f7c6
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/06/2017
---
# <a name="managing-concurrency-in-microsoft-azure-storage"></a><span data-ttu-id="679f6-103">Gestione della concorrenza nell'archiviazione di Microsoft Azure</span><span class="sxs-lookup"><span data-stu-id="679f6-103">Managing Concurrency in Microsoft Azure Storage</span></span>
## <a name="overview"></a><span data-ttu-id="679f6-104">Panoramica</span><span class="sxs-lookup"><span data-stu-id="679f6-104">Overview</span></span>
<span data-ttu-id="679f6-105">Le moderne applicazioni basate su Internet sono in genere caratterizzate dalla presenza simultanea di più utenti che visualizzano e aggiornano dati.</span><span class="sxs-lookup"><span data-stu-id="679f6-105">Modern Internet based applications usually have multiple users viewing and updating data simultaneously.</span></span> <span data-ttu-id="679f6-106">Ciò richiede toothink agli sviluppatori dell'applicazione con attenzione sulla modalità tooprovide a stimabile esperienza tootheir utenti finali, in particolare per scenari in cui è possono aggiornare più utenti hello stessi dati.</span><span class="sxs-lookup"><span data-stu-id="679f6-106">This requires application developers toothink carefully about how tooprovide a predictable experience tootheir end users, particularly for scenarios where multiple users can update hello same data.</span></span> <span data-ttu-id="679f6-107">Gli sviluppatori in genere prendono in considerazione tre strategie principali di concorrenza dei dati:</span><span class="sxs-lookup"><span data-stu-id="679f6-107">There are three main data concurrency strategies that developers typically consider:</span></span>  

1. <span data-ttu-id="679f6-108">Concorrenza ottimistica: un'applicazione eseguendo che un aggiornamento come parte del relativo aggiornamento verificherà se i dati hello sono stato modificato dall'applicazione hello ultima di leggere i dati.</span><span class="sxs-lookup"><span data-stu-id="679f6-108">Optimistic concurrency – An application performing an update will as part of its update verify if hello data has changed since hello application last read that data.</span></span> <span data-ttu-id="679f6-109">Ad esempio, se due utenti che visualizzano una pagina wiki toohello un aggiornamento stessa pagina piattaforma wiki hello è necessario assicurarsi che gli aggiornamenti di secondo hello non implica la sovrascrittura primo aggiornamento hello: e che entrambi gli utenti di comprendere se l'aggiornamento è riuscita o meno.</span><span class="sxs-lookup"><span data-stu-id="679f6-109">For example, if two users viewing a wiki page make an update toohello same page then hello wiki platform must ensure that hello second update does not overwrite hello first update – and that both users understand whether their update was successful or not.</span></span> <span data-ttu-id="679f6-110">Questa strategia viene usata con maggiore frequenza nelle applicazioni Web.</span><span class="sxs-lookup"><span data-stu-id="679f6-110">This strategy is most often used in web applications.</span></span>
2. <span data-ttu-id="679f6-111">Concorrenza pessimistica: un'applicazione di ricerca tooperform un aggiornamento richiederà un blocco su un oggetto impedisce l'aggiornamento dati hello fino a quando viene rilasciato il blocco di hello di altri utenti.</span><span class="sxs-lookup"><span data-stu-id="679f6-111">Pessimistic concurrency – An application looking tooperform an update will take a lock on an object preventing other users from updating hello data until hello lock is released.</span></span> <span data-ttu-id="679f6-112">Ad esempio, in uno scenario di replica dati master/slave, in cui solo master hello eseguirà aggiornamenti master hello in genere conterrà un blocco esclusivo per un lungo periodo di tempo in tooensure dati hello non possa possibile aggiornarla.</span><span class="sxs-lookup"><span data-stu-id="679f6-112">For example, in a master/slave data replication scenario where only hello master will perform updates hello master will typically hold an exclusive lock for an extended period of time on hello data tooensure no one else can update it.</span></span>
3. <span data-ttu-id="679f6-113">Ultimo writer wins: un approccio che consenta di qualsiasi tooproceed di operazioni di aggiornamento senza verificare se un'altra applicazione ha hello dati aggiornati dall'applicazione hello prima lettura dati hello.</span><span class="sxs-lookup"><span data-stu-id="679f6-113">Last writer wins – An approach that allows any update operations tooproceed without verifying if any other application has updated hello data since hello application first read hello data.</span></span> <span data-ttu-id="679f6-114">Questa strategia (o mancanza di una strategia formale) viene in genere usata in cui i dati vengono partizionati in modo che non vi è alcun rischio che più utenti accederanno hello stessi dati.</span><span class="sxs-lookup"><span data-stu-id="679f6-114">This strategy (or lack of a formal strategy) is usually used where data is partitioned in such a way that there is no likelihood that multiple users will access hello same data.</span></span> <span data-ttu-id="679f6-115">Può inoltre essere utile per l'elaborazione di flussi dei dati di breve durata.</span><span class="sxs-lookup"><span data-stu-id="679f6-115">It can also be useful where short-lived data streams are being processed.</span></span>  

<span data-ttu-id="679f6-116">In questo articolo viene fornita una panoramica di come piattaforma di archiviazione di Azure hello semplifica lo sviluppo fornendo supporto eccellente per tutte e tre queste strategie di concorrenza.</span><span class="sxs-lookup"><span data-stu-id="679f6-116">This article provides an overview of how hello Azure Storage platform simplifies development by providing first class support for all three of these concurrency strategies.</span></span>  

## <a name="azure-storage--simplifies-cloud-development"></a><span data-ttu-id="679f6-117">Archiviazione di Azure – Semplifica lo sviluppo cloud</span><span class="sxs-lookup"><span data-stu-id="679f6-117">Azure Storage – Simplifies Cloud Development</span></span>
<span data-ttu-id="679f6-118">Hello Servizio archiviazione di Azure supporta tutte e tre le strategie, sebbene sia distintivo in possibilità tooprovide supporto completo per la concorrenza ottimistica e pessimistica perché era tooembrace progettato un modello di coerenza assoluta garantisce che quando Hello commit servizio di archiviazione dati inserire o aggiornare tutti gli accessi toothat ulteriori dati verranno visualizzato hello aggiornamento più recente di operazione.</span><span class="sxs-lookup"><span data-stu-id="679f6-118">hello Azure storage service supports all three strategies, although it is distinctive in its ability tooprovide full support for optimistic and pessimistic concurrency because it was designed tooembrace a strong consistency model which guarantees that when hello Storage service commits a data insert or update operation all further accesses toothat data will see hello latest update.</span></span> <span data-ttu-id="679f6-119">Piattaforme di archiviazione che utilizzano un modello di coerenza finale hanno un ritardo tra quando un'operazione di scrittura viene eseguita da un utente e quando hello aggiornato i dati possono essere visualizzati da altri utenti della complessità pertanto lo sviluppo di applicazioni client incoerenze tooprevent ordine da che interessano gli utenti finali.</span><span class="sxs-lookup"><span data-stu-id="679f6-119">Storage platforms that use an eventual consistency model have a lag between when a write is performed by one user and when hello updated data can be seen by other users thus complicating development of client applications in order tooprevent inconsistencies from affecting end users.</span></span>  

<span data-ttu-id="679f6-120">Inoltre tooselecting gli sviluppatori di strategia di concorrenza appropriata devono anche tenere come una piattaforma di archiviazione isola cambia, in particolare i toohello modifiche stesso oggetti tra le transazioni.</span><span class="sxs-lookup"><span data-stu-id="679f6-120">In addition tooselecting an appropriate concurrency strategy developers should also be aware of how a storage platform isolates changes – particularly changes toohello same object across transactions.</span></span> <span data-ttu-id="679f6-121">Hello Servizio archiviazione di Azure Usa tooallow di isolamento snapshot leggere toohappen operazioni contemporaneamente a operazioni di scrittura all'interno di una singola partizione.</span><span class="sxs-lookup"><span data-stu-id="679f6-121">hello Azure storage service uses snapshot isolation tooallow read operations toohappen concurrently with write operations within a single partition.</span></span> <span data-ttu-id="679f6-122">A differenza di altri livelli di isolamento, l'isolamento dello snapshot garantisce che tutte le letture visualizzare uno snapshot coerenza dei dati hello anche durante gli aggiornamenti si verificano – essenzialmente restituendo valori commit ultimo hello durante l'elaborazione di una transazione di aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="679f6-122">Unlike other isolation levels, snapshot isolation guarantees that all reads see a consistent snapshot of hello data even while updates are occurring – essentially by returning hello last committed values while an update transaction is being processed.</span></span>  

## <a name="managing-concurrency-in-blob-storage"></a><span data-ttu-id="679f6-123">Gestione della concorrenza nell'archiviazione BLOB</span><span class="sxs-lookup"><span data-stu-id="679f6-123">Managing Concurrency in Blob storage</span></span>
<span data-ttu-id="679f6-124">È possibile scegliere toouse sia modelli di concorrenza ottimistica o pessimistica toomanage accesso tooblobs e contenitori in hello servizio blob.</span><span class="sxs-lookup"><span data-stu-id="679f6-124">You can opt toouse either optimistic or pessimistic concurrency models toomanage access tooblobs and containers in hello blob service.</span></span> <span data-ttu-id="679f6-125">Se non si specifica esplicitamente una strategia di ultima scritture wins predefinito hello.</span><span class="sxs-lookup"><span data-stu-id="679f6-125">If you do not explicitly specify a strategy last writes wins is hello default.</span></span>  

### <a name="optimistic-concurrency-for-blobs-and-containers"></a><span data-ttu-id="679f6-126">Concorrenza ottimistica per BLOB e contenitori</span><span class="sxs-lookup"><span data-stu-id="679f6-126">Optimistic concurrency for blobs and containers</span></span>
<span data-ttu-id="679f6-127">Hello servizio di archiviazione assegna un oggetto tooevery identificatore archiviato.</span><span class="sxs-lookup"><span data-stu-id="679f6-127">hello Storage service assigns an identifier tooevery object stored.</span></span> <span data-ttu-id="679f6-128">che viene aggiornato ogni volta che un'operazione di aggiornamento viene eseguita su un oggetto.</span><span class="sxs-lookup"><span data-stu-id="679f6-128">This identifier is updated every time an update operation is performed on an object.</span></span> <span data-ttu-id="679f6-129">Identificatore Hello è restituito toohello client come parte di una risposta HTTP GET con intestazione ETag (tag di entità) hello è definito nel protocollo hello HTTP.</span><span class="sxs-lookup"><span data-stu-id="679f6-129">hello identifier is returned toohello client as part of an HTTP GET response using hello ETag (entity tag) header that is defined within hello HTTP protocol.</span></span> <span data-ttu-id="679f6-130">Un utente che esegue un aggiornamento in un oggetto di questo tipo può inviare in hello ETag originale insieme a un tooensure intestazione condizionale che verrà eseguito l'aggiornamento solo se è stata soddisfatta una determinata condizione: in questo caso la condizione hello è un'intestazione "If-Match", che richiede l'archiviazione hello Servizio tooensure hello valore ETag specificato nella richiesta di aggiornamento hello è hello identici a quelli archiviati nel servizio di archiviazione hello hello.</span><span class="sxs-lookup"><span data-stu-id="679f6-130">A user performing an update on such an object can send in hello original ETag along with a conditional header tooensure that an update will only occur if a certain condition has been met – in this case hello condition is an "If-Match" header, which requires hello Storage Service tooensure hello value of hello ETag specified in hello update request is hello same as that stored in hello Storage Service.</span></span>  

<span data-ttu-id="679f6-131">struttura Hello di questo processo è indicato di seguito:</span><span class="sxs-lookup"><span data-stu-id="679f6-131">hello outline of this process is as follows:</span></span>  

1. <span data-ttu-id="679f6-132">Recuperare un blob dal servizio di archiviazione hello, risposta hello include un valore di intestazione ETag HTTP che identifica la versione corrente di hello dell'oggetto hello nel servizio di archiviazione hello.</span><span class="sxs-lookup"><span data-stu-id="679f6-132">Retrieve a blob from hello storage service, hello response includes an HTTP ETag Header value that identifies hello current version of hello object in hello storage service.</span></span>
2. <span data-ttu-id="679f6-133">Quando si aggiorna il blob hello, includere il valore di ETag hello ottenuto nel passaggio 1 in hello **If-Match** condizionale intestazione della richiesta di hello inviati toohello servizio.</span><span class="sxs-lookup"><span data-stu-id="679f6-133">When you update hello blob, include hello ETag value you received in step 1 in hello **If-Match** conditional header of hello request you send toohello service.</span></span>
3. <span data-ttu-id="679f6-134">servizio Hello Confronta valore ETag di hello nella richiesta di hello con valore ETag corrente hello del blob hello.</span><span class="sxs-lookup"><span data-stu-id="679f6-134">hello service compares hello ETag value in hello request with hello current ETag value of hello blob.</span></span>
4. <span data-ttu-id="679f6-135">Se il valore ETag corrente hello del blob hello è una versione diversa di hello ETag in hello **If-Match** intestazione condizionale nella richiesta di hello, servizio hello restituisce un client di 412 errore toohello.</span><span class="sxs-lookup"><span data-stu-id="679f6-135">If hello current ETag value of hello blob is a different version than hello ETag in hello **If-Match** conditional header in hello request, hello service returns a 412 error toohello client.</span></span> <span data-ttu-id="679f6-136">Indica che un altro processo ha aggiornato blob hello poiché è stato recuperato client hello client di toohello.</span><span class="sxs-lookup"><span data-stu-id="679f6-136">This indicates toohello client that another process has updated hello blob since hello client retrieved it.</span></span>
5. <span data-ttu-id="679f6-137">Se hello corrente ETag del blob hello è hello stessa versione di hello ETag in hello **If-Match** intestazione condizionale nella richiesta di hello, servizio hello esegue hello ha richiesto l'operazione e gli aggiornamenti hello valore ETag corrente del blob hello tooshow che ha creato una nuova versione.</span><span class="sxs-lookup"><span data-stu-id="679f6-137">If hello current ETag value of hello blob is hello same version as hello ETag in hello **If-Match** conditional header in hello request, hello service performs hello requested operation and updates hello current ETag value of hello blob tooshow that it has created a new version.</span></span>  

<span data-ttu-id="679f6-138">Hello seguente frammento di codice c# (mediante la libreria Client di archiviazione 4.2.0 hello) viene illustrato un semplice esempio di tooconstruct un **AccessCondition If-Match** hello valore ETag che è accessibile dalla proprietà hello di un blob che è stato in base precedentemente recuperati o inserito.</span><span class="sxs-lookup"><span data-stu-id="679f6-138">hello following C# snippet (using hello Client Storage Library 4.2.0) shows a simple example of how tooconstruct an **If-Match AccessCondition** based on hello ETag value that is accessed from hello properties of a blob that was previously either retrieved or inserted.</span></span> <span data-ttu-id="679f6-139">Viene quindi utilizzato hello **AccessCondition** oggetto quando viene aggiornata blob hello: hello **AccessCondition** oggetto aggiunge hello **If-Match** richiesta toohello intestazione.</span><span class="sxs-lookup"><span data-stu-id="679f6-139">It then uses hello **AccessCondition** object when it updates hello blob: hello **AccessCondition** object adds hello **If-Match** header toohello request.</span></span> <span data-ttu-id="679f6-140">Se un altro processo ha aggiornato il blob hello, servizio blob hello restituisce un messaggio di stato HTTP 412 (Precondition Failed).</span><span class="sxs-lookup"><span data-stu-id="679f6-140">If another process has updated hello blob, hello blob service returns an HTTP 412 (Precondition Failed) status message.</span></span> <span data-ttu-id="679f6-141">È possibile scaricare qui completo esempio hello: [gestione della concorrenza utilizzando l'archiviazione di Azure](http://code.msdn.microsoft.com/Managing-Concurrency-using-56018114).</span><span class="sxs-lookup"><span data-stu-id="679f6-141">You can download hello full sample here: [Managing Concurrency using Azure Storage](http://code.msdn.microsoft.com/Managing-Concurrency-using-56018114).</span></span>  

```csharp
// Retrieve hello ETag from hello newly created blob
// Etag is already populated as UploadText should cause a PUT Blob call
// toostorage blob service which returns hello etag in response.
string orignalETag = blockBlob.Properties.ETag;

// This code simulates an update by a third party.
string helloText = "Blob updated by a third party.";

// No etag, provided so orignal blob is overwritten (thus generating a new etag)
blockBlob.UploadText(helloText);
Console.WriteLine("Blob updated. Updated ETag = {0}",
blockBlob.Properties.ETag);

// Now try tooupdate hello blob using hello orignal ETag provided when hello blob was created
try
{
    Console.WriteLine("Trying tooupdate blob using orignal etag toogenerate if-match access condition");
    blockBlob.UploadText(helloText,accessCondition:
    AccessCondition.GenerateIfMatchCondition(orignalETag));
}
catch (StorageException ex)
{
    if (ex.RequestInformation.HttpStatusCode == (int)HttpStatusCode.PreconditionFailed)
    {
        Console.WriteLine("Precondition failure as expected. Blob's orignal etag no longer matches");
        // TODO: client can decide on how it wants toohandle hello 3rd party updated content.
    }
    else
        throw;
}  
```

<span data-ttu-id="679f6-142">Servizio di archiviazione Hello include anche il supporto per le intestazioni condizionali aggiuntive, ad esempio **If-Modified-Since**, **If-Unmodified-Since** e **If-None-Match** nonché loro combinazioni.</span><span class="sxs-lookup"><span data-stu-id="679f6-142">hello Storage Service also includes support for additional conditional headers such as **If-Modified-Since**, **If-Unmodified-Since** and **If-None-Match** as well as combinations thereof.</span></span> <span data-ttu-id="679f6-143">Per altre informazioni, vedere [Specifica di intestazioni condizionali per le operazioni del servizio BLOB](http://msdn.microsoft.com/library/azure/dd179371.aspx) su MSDN.</span><span class="sxs-lookup"><span data-stu-id="679f6-143">For more information, see [Specifying Conditional Headers for Blob Service Operations](http://msdn.microsoft.com/library/azure/dd179371.aspx) on MSDN.</span></span>  

<span data-ttu-id="679f6-144">Hello nella tabella seguente sono riepilogate le operazioni di contenitore hello che accettano come ad esempio le intestazioni condizionali **If-Match** richiesta hello e che restituiscono un valore ETag nella risposta hello.</span><span class="sxs-lookup"><span data-stu-id="679f6-144">hello following table summarizes hello container operations that accept conditional headers such as **If-Match** in hello request and that return an ETag value in hello response.</span></span>  

| <span data-ttu-id="679f6-145">Operazione</span><span class="sxs-lookup"><span data-stu-id="679f6-145">Operation</span></span> | <span data-ttu-id="679f6-146">Restituisce il valore ETag del contenitore</span><span class="sxs-lookup"><span data-stu-id="679f6-146">Returns Container ETag value</span></span> | <span data-ttu-id="679f6-147">Accetta intestazioni condizionali</span><span class="sxs-lookup"><span data-stu-id="679f6-147">Accepts conditional headers</span></span> |
|:--- |:--- |:--- |
| <span data-ttu-id="679f6-148">Create Container</span><span class="sxs-lookup"><span data-stu-id="679f6-148">Create Container</span></span> |<span data-ttu-id="679f6-149">Sì</span><span class="sxs-lookup"><span data-stu-id="679f6-149">Yes</span></span> |<span data-ttu-id="679f6-150">No</span><span class="sxs-lookup"><span data-stu-id="679f6-150">No</span></span> |
| <span data-ttu-id="679f6-151">Get Container Properties</span><span class="sxs-lookup"><span data-stu-id="679f6-151">Get Container Properties</span></span> |<span data-ttu-id="679f6-152">Sì</span><span class="sxs-lookup"><span data-stu-id="679f6-152">Yes</span></span> |<span data-ttu-id="679f6-153">No</span><span class="sxs-lookup"><span data-stu-id="679f6-153">No</span></span> |
| <span data-ttu-id="679f6-154">Get Container Metadata</span><span class="sxs-lookup"><span data-stu-id="679f6-154">Get Container Metadata</span></span> |<span data-ttu-id="679f6-155">Sì</span><span class="sxs-lookup"><span data-stu-id="679f6-155">Yes</span></span> |<span data-ttu-id="679f6-156">No</span><span class="sxs-lookup"><span data-stu-id="679f6-156">No</span></span> |
| <span data-ttu-id="679f6-157">Set Container Metadata</span><span class="sxs-lookup"><span data-stu-id="679f6-157">Set Container Metadata</span></span> |<span data-ttu-id="679f6-158">Sì</span><span class="sxs-lookup"><span data-stu-id="679f6-158">Yes</span></span> |<span data-ttu-id="679f6-159">Sì</span><span class="sxs-lookup"><span data-stu-id="679f6-159">Yes</span></span> |
| <span data-ttu-id="679f6-160">Get Container ACL</span><span class="sxs-lookup"><span data-stu-id="679f6-160">Get Container ACL</span></span> |<span data-ttu-id="679f6-161">Sì</span><span class="sxs-lookup"><span data-stu-id="679f6-161">Yes</span></span> |<span data-ttu-id="679f6-162">No</span><span class="sxs-lookup"><span data-stu-id="679f6-162">No</span></span> |
| <span data-ttu-id="679f6-163">Set Container ACL</span><span class="sxs-lookup"><span data-stu-id="679f6-163">Set Container ACL</span></span> |<span data-ttu-id="679f6-164">Sì</span><span class="sxs-lookup"><span data-stu-id="679f6-164">Yes</span></span> |<span data-ttu-id="679f6-165">Sì (*)</span><span class="sxs-lookup"><span data-stu-id="679f6-165">Yes (*)</span></span> |
| <span data-ttu-id="679f6-166">Delete Container</span><span class="sxs-lookup"><span data-stu-id="679f6-166">Delete Container</span></span> |<span data-ttu-id="679f6-167">No</span><span class="sxs-lookup"><span data-stu-id="679f6-167">No</span></span> |<span data-ttu-id="679f6-168">Sì</span><span class="sxs-lookup"><span data-stu-id="679f6-168">Yes</span></span> |
| <span data-ttu-id="679f6-169">Lease Container</span><span class="sxs-lookup"><span data-stu-id="679f6-169">Lease Container</span></span> |<span data-ttu-id="679f6-170">Sì</span><span class="sxs-lookup"><span data-stu-id="679f6-170">Yes</span></span> |<span data-ttu-id="679f6-171">Sì</span><span class="sxs-lookup"><span data-stu-id="679f6-171">Yes</span></span> |
| <span data-ttu-id="679f6-172">List Blobs</span><span class="sxs-lookup"><span data-stu-id="679f6-172">List Blobs</span></span> |<span data-ttu-id="679f6-173">No</span><span class="sxs-lookup"><span data-stu-id="679f6-173">No</span></span> |<span data-ttu-id="679f6-174">No</span><span class="sxs-lookup"><span data-stu-id="679f6-174">No</span></span> |

<span data-ttu-id="679f6-175">(*) hello le autorizzazioni definite da SetContainerACL vengono memorizzati nella cache e le autorizzazioni toothese aggiornamenti richiedere 30 secondi toopropagate durante il periodo in cui gli aggiornamenti non sono garantiti toobe coerente.</span><span class="sxs-lookup"><span data-stu-id="679f6-175">(*) hello permissions defined by SetContainerACL are cached and updates toothese permissions take 30 seconds toopropagate during which period updates are not guaranteed toobe consistent.</span></span>  

<span data-ttu-id="679f6-176">Hello nella tabella seguente sono riepilogate le operazioni di blob hello che accettano come ad esempio le intestazioni condizionali **If-Match** richiesta hello e che restituiscono un valore ETag nella risposta hello.</span><span class="sxs-lookup"><span data-stu-id="679f6-176">hello following table summarizes hello blob operations that accept conditional headers such as **If-Match** in hello request and that return an ETag value in hello response.</span></span>

| <span data-ttu-id="679f6-177">Operazione</span><span class="sxs-lookup"><span data-stu-id="679f6-177">Operation</span></span> | <span data-ttu-id="679f6-178">Restituisce il valore ETag</span><span class="sxs-lookup"><span data-stu-id="679f6-178">Returns ETag value</span></span> | <span data-ttu-id="679f6-179">Accetta intestazioni condizionali</span><span class="sxs-lookup"><span data-stu-id="679f6-179">Accepts conditional headers</span></span> |
|:--- |:--- |:--- |
| <span data-ttu-id="679f6-180">Put Blob</span><span class="sxs-lookup"><span data-stu-id="679f6-180">Put Blob</span></span> |<span data-ttu-id="679f6-181">Sì</span><span class="sxs-lookup"><span data-stu-id="679f6-181">Yes</span></span> |<span data-ttu-id="679f6-182">Sì</span><span class="sxs-lookup"><span data-stu-id="679f6-182">Yes</span></span> |
| <span data-ttu-id="679f6-183">Get Blob</span><span class="sxs-lookup"><span data-stu-id="679f6-183">Get Blob</span></span> |<span data-ttu-id="679f6-184">Sì</span><span class="sxs-lookup"><span data-stu-id="679f6-184">Yes</span></span> |<span data-ttu-id="679f6-185">Sì</span><span class="sxs-lookup"><span data-stu-id="679f6-185">Yes</span></span> |
| <span data-ttu-id="679f6-186">Get Blob Properties</span><span class="sxs-lookup"><span data-stu-id="679f6-186">Get Blob Properties</span></span> |<span data-ttu-id="679f6-187">Sì</span><span class="sxs-lookup"><span data-stu-id="679f6-187">Yes</span></span> |<span data-ttu-id="679f6-188">Sì</span><span class="sxs-lookup"><span data-stu-id="679f6-188">Yes</span></span> |
| <span data-ttu-id="679f6-189">Set Blob Properties</span><span class="sxs-lookup"><span data-stu-id="679f6-189">Set Blob Properties</span></span> |<span data-ttu-id="679f6-190">Sì</span><span class="sxs-lookup"><span data-stu-id="679f6-190">Yes</span></span> |<span data-ttu-id="679f6-191">Sì</span><span class="sxs-lookup"><span data-stu-id="679f6-191">Yes</span></span> |
| <span data-ttu-id="679f6-192">Get Blob Metadata</span><span class="sxs-lookup"><span data-stu-id="679f6-192">Get Blob Metadata</span></span> |<span data-ttu-id="679f6-193">Sì</span><span class="sxs-lookup"><span data-stu-id="679f6-193">Yes</span></span> |<span data-ttu-id="679f6-194">Sì</span><span class="sxs-lookup"><span data-stu-id="679f6-194">Yes</span></span> |
| <span data-ttu-id="679f6-195">Set Blob Metadata</span><span class="sxs-lookup"><span data-stu-id="679f6-195">Set Blob Metadata</span></span> |<span data-ttu-id="679f6-196">Sì</span><span class="sxs-lookup"><span data-stu-id="679f6-196">Yes</span></span> |<span data-ttu-id="679f6-197">Sì</span><span class="sxs-lookup"><span data-stu-id="679f6-197">Yes</span></span> |
| <span data-ttu-id="679f6-198">Lease Blob (*)</span><span class="sxs-lookup"><span data-stu-id="679f6-198">Lease Blob (*)</span></span> |<span data-ttu-id="679f6-199">Sì</span><span class="sxs-lookup"><span data-stu-id="679f6-199">Yes</span></span> |<span data-ttu-id="679f6-200">Sì</span><span class="sxs-lookup"><span data-stu-id="679f6-200">Yes</span></span> |
| <span data-ttu-id="679f6-201">Snapshot Blob</span><span class="sxs-lookup"><span data-stu-id="679f6-201">Snapshot Blob</span></span> |<span data-ttu-id="679f6-202">Sì</span><span class="sxs-lookup"><span data-stu-id="679f6-202">Yes</span></span> |<span data-ttu-id="679f6-203">Sì</span><span class="sxs-lookup"><span data-stu-id="679f6-203">Yes</span></span> |
| <span data-ttu-id="679f6-204">Copy Blob</span><span class="sxs-lookup"><span data-stu-id="679f6-204">Copy Blob</span></span> |<span data-ttu-id="679f6-205">Sì</span><span class="sxs-lookup"><span data-stu-id="679f6-205">Yes</span></span> |<span data-ttu-id="679f6-206">Sì (per il BLOB di origine e destinazione)</span><span class="sxs-lookup"><span data-stu-id="679f6-206">Yes (for source and destination blob)</span></span> |
| <span data-ttu-id="679f6-207">Abort Copy Blob</span><span class="sxs-lookup"><span data-stu-id="679f6-207">Abort Copy Blob</span></span> |<span data-ttu-id="679f6-208">No</span><span class="sxs-lookup"><span data-stu-id="679f6-208">No</span></span> |<span data-ttu-id="679f6-209">No</span><span class="sxs-lookup"><span data-stu-id="679f6-209">No</span></span> |
| <span data-ttu-id="679f6-210">Delete Blob</span><span class="sxs-lookup"><span data-stu-id="679f6-210">Delete Blob</span></span> |<span data-ttu-id="679f6-211">No</span><span class="sxs-lookup"><span data-stu-id="679f6-211">No</span></span> |<span data-ttu-id="679f6-212">Sì</span><span class="sxs-lookup"><span data-stu-id="679f6-212">Yes</span></span> |
| <span data-ttu-id="679f6-213">Put Block</span><span class="sxs-lookup"><span data-stu-id="679f6-213">Put Block</span></span> |<span data-ttu-id="679f6-214">No</span><span class="sxs-lookup"><span data-stu-id="679f6-214">No</span></span> |<span data-ttu-id="679f6-215">No</span><span class="sxs-lookup"><span data-stu-id="679f6-215">No</span></span> |
| <span data-ttu-id="679f6-216">Put Block List</span><span class="sxs-lookup"><span data-stu-id="679f6-216">Put Block List</span></span> |<span data-ttu-id="679f6-217">Sì</span><span class="sxs-lookup"><span data-stu-id="679f6-217">Yes</span></span> |<span data-ttu-id="679f6-218">Sì</span><span class="sxs-lookup"><span data-stu-id="679f6-218">Yes</span></span> |
| <span data-ttu-id="679f6-219">Get Block List</span><span class="sxs-lookup"><span data-stu-id="679f6-219">Get Block List</span></span> |<span data-ttu-id="679f6-220">Sì</span><span class="sxs-lookup"><span data-stu-id="679f6-220">Yes</span></span> |<span data-ttu-id="679f6-221">No</span><span class="sxs-lookup"><span data-stu-id="679f6-221">No</span></span> |
| <span data-ttu-id="679f6-222">Put Page</span><span class="sxs-lookup"><span data-stu-id="679f6-222">Put Page</span></span> |<span data-ttu-id="679f6-223">Sì</span><span class="sxs-lookup"><span data-stu-id="679f6-223">Yes</span></span> |<span data-ttu-id="679f6-224">Sì</span><span class="sxs-lookup"><span data-stu-id="679f6-224">Yes</span></span> |
| <span data-ttu-id="679f6-225">Get Page Ranges</span><span class="sxs-lookup"><span data-stu-id="679f6-225">Get Page Ranges</span></span> |<span data-ttu-id="679f6-226">Sì</span><span class="sxs-lookup"><span data-stu-id="679f6-226">Yes</span></span> |<span data-ttu-id="679f6-227">Sì</span><span class="sxs-lookup"><span data-stu-id="679f6-227">Yes</span></span> |

<span data-ttu-id="679f6-228">(*) Blob del lease non modifica hello ETag su un blob.</span><span class="sxs-lookup"><span data-stu-id="679f6-228">(*) Lease Blob does not change hello ETag on a blob.</span></span>  

### <a name="pessimistic-concurrency-for-blobs"></a><span data-ttu-id="679f6-229">Concorrenza pessimistica per i BLOB</span><span class="sxs-lookup"><span data-stu-id="679f6-229">Pessimistic concurrency for blobs</span></span>
<span data-ttu-id="679f6-230">toolock un blob per l'uso esclusivo, è possibile acquisire un [lease](http://msdn.microsoft.com/library/azure/ee691972.aspx) su di esso.</span><span class="sxs-lookup"><span data-stu-id="679f6-230">toolock a blob for exclusive use, you can acquire a [lease](http://msdn.microsoft.com/library/azure/ee691972.aspx) on it.</span></span> <span data-ttu-id="679f6-231">Quando si acquisisce un lease, è necessario specificare per quanto tempo è necessario hello lease: può trattarsi per compreso tra 15 secondi too60 o infinito, che gli importi tooan un blocco esclusivo.</span><span class="sxs-lookup"><span data-stu-id="679f6-231">When you acquire a lease, you specify for how long you need hello lease: this can be for between 15 too60 seconds or infinite, which amounts tooan exclusive lock.</span></span> <span data-ttu-id="679f6-232">È possibile rinnovare un lease finito di tooextend ed è possibile rilasciare un lease dopo aver terminato con.</span><span class="sxs-lookup"><span data-stu-id="679f6-232">You can renew a finite lease tooextend it, and you can release any lease when you are finished with it.</span></span> <span data-ttu-id="679f6-233">servizio blob Hello rilascia automaticamente i lease finiti alla scadenza.</span><span class="sxs-lookup"><span data-stu-id="679f6-233">hello blob service automatically releases finite leases when they expire.</span></span>  

<span data-ttu-id="679f6-234">Lease Abilita sincronizzazione diverse strategie toobe supportati, inclusi esclusivo in scrittura / scrittura esclusivo, lettura condivisa / esclusivo di lettura e scrittura condivisa / lettura esclusivo.</span><span class="sxs-lookup"><span data-stu-id="679f6-234">Leases enable different synchronization strategies toobe supported, including exclusive write / shared read, exclusive write / exclusive read and shared write / exclusive read.</span></span> <span data-ttu-id="679f6-235">Se esiste un lease del servizio di archiviazione hello applica esclusivo operazioni di scrittura (put e impostazione delle operazioni di eliminazione) garantendo tuttavia esclusiva per operazioni di lettura richiede hello developer tooensure che tutte le applicazioni client deve utilizzare un ID lease e che solo un client in un momento ha un ID lease valido.</span><span class="sxs-lookup"><span data-stu-id="679f6-235">Where a lease exists hello storage service enforces exclusive writes (put, set and delete operations) however ensuring exclusivity for read operations requires hello developer tooensure that all client applications use a lease ID and that only one client at a time has a valid lease ID.</span></span> <span data-ttu-id="679f6-236">Le operazioni di lettura che non includono un ID lease determinano letture condivise.</span><span class="sxs-lookup"><span data-stu-id="679f6-236">Read operations that do not include a lease ID result in shared reads.</span></span>  

<span data-ttu-id="679f6-237">Hello c# frammento di codice seguente viene illustrato un esempio di acquisire un lease esclusivo per 30 secondi in un blob, l'aggiornamento del contenuto di hello del blob hello e quindi rilasciare il lease hello.</span><span class="sxs-lookup"><span data-stu-id="679f6-237">hello following C# snippet shows an example of acquiring an exclusive lease for 30 seconds on a blob, updating hello content of hello blob, and then releasing hello lease.</span></span> <span data-ttu-id="679f6-238">Se è già presente un lease valido nel blob hello quando si tenta un nuovo lease tooacquire, servizio blob hello restituisce un risultato di stato di "HTTP (409) conflitto".</span><span class="sxs-lookup"><span data-stu-id="679f6-238">If there is already a valid lease on hello blob when you try tooacquire a new lease, hello blob service returns an "HTTP (409) Conflict" status result.</span></span> <span data-ttu-id="679f6-239">Hello frammento seguente viene utilizzato un **AccessCondition** oggetto informazioni sul lease di hello tooencapsulate quando si rende un blob di hello tooupdate richiesta nel servizio di archiviazione hello.</span><span class="sxs-lookup"><span data-stu-id="679f6-239">hello following snippet uses an **AccessCondition** object tooencapsulate hello lease information when it makes a request tooupdate hello blob in hello storage service.</span></span>  <span data-ttu-id="679f6-240">È possibile scaricare qui completo esempio hello: [gestione della concorrenza utilizzando l'archiviazione di Azure](http://code.msdn.microsoft.com/Managing-Concurrency-using-56018114).</span><span class="sxs-lookup"><span data-stu-id="679f6-240">You can download hello full sample here: [Managing Concurrency using Azure Storage](http://code.msdn.microsoft.com/Managing-Concurrency-using-56018114).</span></span>

```csharp
// Acquire lease for 15 seconds
string lease = blockBlob.AcquireLease(TimeSpan.FromSeconds(15), null);
Console.WriteLine("Blob lease acquired. Lease = {0}", lease);

// Update blob using lease. This operation will succeed
const string helloText = "Blob updated";
var accessCondition = AccessCondition.GenerateLeaseCondition(lease);
blockBlob.UploadText(helloText, accessCondition: accessCondition);
Console.WriteLine("Blob updated using an exclusive lease");

//Simulate third party update tooblob without lease
try
{
    // Below operation will fail as no valid lease provided
    Console.WriteLine("Trying tooupdate blob without valid lease");
    blockBlob.UploadText("Update without lease, will fail");
}
catch (StorageException ex)
{
    if (ex.RequestInformation.HttpStatusCode == (int)HttpStatusCode.PreconditionFailed)
        Console.WriteLine("Precondition failure as expected. Blob's lease does not match");
    else
        throw;
}  
```

<span data-ttu-id="679f6-241">Se si tenta un'operazione di scrittura su un blob con lease senza passare l'ID lease hello, viene generato un errore 412 richiesta hello.</span><span class="sxs-lookup"><span data-stu-id="679f6-241">If you attempt a write operation on a leased blob without passing hello lease ID, hello request fails with a 412 error.</span></span> <span data-ttu-id="679f6-242">Si noti che se hello lease scade prima di chiamare hello **UploadText** metodo ma si continua a superare ID lease hello, richiesta hello ha esito negativo anche con un **412** errore.</span><span class="sxs-lookup"><span data-stu-id="679f6-242">Note that if hello lease expires before calling hello **UploadText** method but you still pass hello lease ID, hello request also fails with a **412** error.</span></span> <span data-ttu-id="679f6-243">Per ulteriori informazioni sulla gestione di ore di scadenza del lease e gli ID lease, vedere hello [Lease Blob](http://msdn.microsoft.com/library/azure/ee691972.aspx) documentazione REST.</span><span class="sxs-lookup"><span data-stu-id="679f6-243">For more information about managing lease expiry times and lease IDs, see hello [Lease Blob](http://msdn.microsoft.com/library/azure/ee691972.aspx) REST documentation.</span></span>  

<span data-ttu-id="679f6-244">Hello operazioni blob seguenti è possono utilizzare la concorrenza pessimistica toomanage lease:</span><span class="sxs-lookup"><span data-stu-id="679f6-244">hello following blob operations can use leases toomanage pessimistic concurrency:</span></span>  

* <span data-ttu-id="679f6-245">Put Blob</span><span class="sxs-lookup"><span data-stu-id="679f6-245">Put Blob</span></span>
* <span data-ttu-id="679f6-246">Get Blob</span><span class="sxs-lookup"><span data-stu-id="679f6-246">Get Blob</span></span>
* <span data-ttu-id="679f6-247">Get Blob Properties</span><span class="sxs-lookup"><span data-stu-id="679f6-247">Get Blob Properties</span></span>
* <span data-ttu-id="679f6-248">Set Blob Properties</span><span class="sxs-lookup"><span data-stu-id="679f6-248">Set Blob Properties</span></span>
* <span data-ttu-id="679f6-249">Get Blob Metadata</span><span class="sxs-lookup"><span data-stu-id="679f6-249">Get Blob Metadata</span></span>
* <span data-ttu-id="679f6-250">Set Blob Metadata</span><span class="sxs-lookup"><span data-stu-id="679f6-250">Set Blob Metadata</span></span>
* <span data-ttu-id="679f6-251">Delete Blob</span><span class="sxs-lookup"><span data-stu-id="679f6-251">Delete Blob</span></span>
* <span data-ttu-id="679f6-252">Put Block</span><span class="sxs-lookup"><span data-stu-id="679f6-252">Put Block</span></span>
* <span data-ttu-id="679f6-253">Put Block List</span><span class="sxs-lookup"><span data-stu-id="679f6-253">Put Block List</span></span>
* <span data-ttu-id="679f6-254">Get Block List</span><span class="sxs-lookup"><span data-stu-id="679f6-254">Get Block List</span></span>
* <span data-ttu-id="679f6-255">Put Page</span><span class="sxs-lookup"><span data-stu-id="679f6-255">Put Page</span></span>
* <span data-ttu-id="679f6-256">Get Page Ranges</span><span class="sxs-lookup"><span data-stu-id="679f6-256">Get Page Ranges</span></span>
* <span data-ttu-id="679f6-257">Snapshot Blob: ID lease facoltativo se esiste un lease</span><span class="sxs-lookup"><span data-stu-id="679f6-257">Snapshot Blob - lease ID optional if a lease exists</span></span>
* <span data-ttu-id="679f6-258">Copia di Blob: lease ID obbligatorio se è presente un lease nel blob di destinazione hello</span><span class="sxs-lookup"><span data-stu-id="679f6-258">Copy Blob - lease ID required if a lease exists on hello destination blob</span></span>
* <span data-ttu-id="679f6-259">Abort Copy Blob: lease ID obbligatorio se esiste un lease infinito sul blob di destinazione hello</span><span class="sxs-lookup"><span data-stu-id="679f6-259">Abort Copy Blob - lease ID required if an infinite lease exists on hello destination blob</span></span>
* <span data-ttu-id="679f6-260">Lease Blob</span><span class="sxs-lookup"><span data-stu-id="679f6-260">Lease Blob</span></span>  

### <a name="pessimistic-concurrency-for-containers"></a><span data-ttu-id="679f6-261">Concorrenza pessimistica per i contenitori</span><span class="sxs-lookup"><span data-stu-id="679f6-261">Pessimistic concurrency for containers</span></span>
<span data-ttu-id="679f6-262">Lease sui contenitori abilitare hello stesso toobe strategie di sincronizzazione supportate come sui BLOB (esclusivo di scrittura / scrittura esclusivo, lettura condivisa / esclusivo di lettura e scrittura condivisa / lettura esclusiva) tuttavia a differenza dei blob del servizio di archiviazione hello impone solo esclusiva in operazioni di eliminazione.</span><span class="sxs-lookup"><span data-stu-id="679f6-262">Leases on containers enable hello same synchronization strategies toobe supported as on blobs (exclusive write / shared read, exclusive write / exclusive read and shared write / exclusive read) however unlike blobs hello storage service only enforces exclusivity on delete operations.</span></span> <span data-ttu-id="679f6-263">toodelete un contenitore con un lease attivo, un client deve includere l'ID lease attivo hello hello richiesta di eliminazione.</span><span class="sxs-lookup"><span data-stu-id="679f6-263">toodelete a container with an active lease, a client must include hello active lease ID with hello delete request.</span></span> <span data-ttu-id="679f6-264">Tutte le altre operazioni hanno esito positivo su un contenitore con lease senza includere l'ID lease hello in questo caso sono condivisi operazioni.</span><span class="sxs-lookup"><span data-stu-id="679f6-264">All other container operations succeed on a leased container without including hello lease ID in which case they are shared operations.</span></span> <span data-ttu-id="679f6-265">Se è richiesta l'esclusività di un'operazione di aggiornamento (Put o Set) o di lettura, gli sviluppatori devono garantire che tutti i client usino un ID lease e che un solo client alla volta abbia un ID lease valido.</span><span class="sxs-lookup"><span data-stu-id="679f6-265">If exclusivity of update (put or set) or read operations is required then developers should ensure all clients use a lease ID and that only one client at a time has a valid lease ID.</span></span>  

<span data-ttu-id="679f6-266">Hello operazioni contenitore è possono utilizzare la concorrenza pessimistica toomanage lease:</span><span class="sxs-lookup"><span data-stu-id="679f6-266">hello following container operations can use leases toomanage pessimistic concurrency:</span></span>  

* <span data-ttu-id="679f6-267">Delete Container</span><span class="sxs-lookup"><span data-stu-id="679f6-267">Delete Container</span></span>
* <span data-ttu-id="679f6-268">Get Container Properties</span><span class="sxs-lookup"><span data-stu-id="679f6-268">Get Container Properties</span></span>
* <span data-ttu-id="679f6-269">Get Container Metadata</span><span class="sxs-lookup"><span data-stu-id="679f6-269">Get Container Metadata</span></span>
* <span data-ttu-id="679f6-270">Set Container Metadata</span><span class="sxs-lookup"><span data-stu-id="679f6-270">Set Container Metadata</span></span>
* <span data-ttu-id="679f6-271">Get Container ACL</span><span class="sxs-lookup"><span data-stu-id="679f6-271">Get Container ACL</span></span>
* <span data-ttu-id="679f6-272">Set Container ACL</span><span class="sxs-lookup"><span data-stu-id="679f6-272">Set Container ACL</span></span>
* <span data-ttu-id="679f6-273">Lease Container</span><span class="sxs-lookup"><span data-stu-id="679f6-273">Lease Container</span></span>  

<span data-ttu-id="679f6-274">Per altre informazioni, vedere:</span><span class="sxs-lookup"><span data-stu-id="679f6-274">For more information, see:</span></span>  

* [<span data-ttu-id="679f6-275">Specifica di intestazioni condizionali per le operazioni del servizio BLOB</span><span class="sxs-lookup"><span data-stu-id="679f6-275">Specifying Conditional Headers for Blob Service Operations</span></span>](http://msdn.microsoft.com/library/azure/dd179371.aspx)
* [<span data-ttu-id="679f6-276">Lease Container</span><span class="sxs-lookup"><span data-stu-id="679f6-276">Lease Container</span></span>](http://msdn.microsoft.com/library/azure/jj159103.aspx)
* [<span data-ttu-id="679f6-277">Lease Blob </span><span class="sxs-lookup"><span data-stu-id="679f6-277">Lease Blob </span></span>](http://msdn.microsoft.com/library/azure/ee691972.aspx)

## <a name="managing-concurrency-in-hello-table-service"></a><span data-ttu-id="679f6-278">Gestione della concorrenza in hello del servizio tabelle</span><span class="sxs-lookup"><span data-stu-id="679f6-278">Managing Concurrency in hello Table Service</span></span>
<span data-ttu-id="679f6-279">servizio tabelle Hello Usa controlli di concorrenza ottimistica come comportamento predefinito di hello quando si lavora con entità, a differenza dei servizi blob hello in cui è necessario scegliere in modo esplicito i controlli di concorrenza ottimistica tooperform.</span><span class="sxs-lookup"><span data-stu-id="679f6-279">hello table service uses optimistic concurrency checks as hello default behavior when you are working with entities, unlike hello blob service where you must explicitly choose tooperform optimistic concurrency checks.</span></span> <span data-ttu-id="679f6-280">Hello altra differenza tra i servizi blob e tabella di hello è che è possibile gestire solo il comportamento della concorrenza hello delle entità mentre con il servizio blob hello è possibile gestire la concorrenza hello di contenitori e BLOB.</span><span class="sxs-lookup"><span data-stu-id="679f6-280">hello other difference between hello table and blob services is that you can only manage hello concurrency behavior of entities whereas with hello blob service you can manage hello concurrency of both containers and blobs.</span></span>  

<span data-ttu-id="679f6-281">concorrenza ottimistica toouse e toocheck se un altro processo modificato un'entità perché è stato recuperato dal servizio di archiviazione tabelle hello, è possibile utilizzare il valore di ETag hello che viene visualizzato quando il servizio tabelle hello restituisce un'entità.</span><span class="sxs-lookup"><span data-stu-id="679f6-281">toouse optimistic concurrency and toocheck if another process modified an entity since you retrieved it from hello table storage service, you can use hello ETag value you receive when hello table service returns an entity.</span></span> <span data-ttu-id="679f6-282">struttura Hello di questo processo è indicato di seguito:</span><span class="sxs-lookup"><span data-stu-id="679f6-282">hello outline of this process is as follows:</span></span>  

1. <span data-ttu-id="679f6-283">Recuperare un'entità dal servizio di archiviazione tabella hello, risposta hello include un valore ETag che identifica l'identificatore attuale di hello associati all'entità nel servizio di archiviazione hello.</span><span class="sxs-lookup"><span data-stu-id="679f6-283">Retrieve an entity from hello table storage service, hello response includes an ETag value that identifies hello current identifier associated with that entity in hello storage service.</span></span>
2. <span data-ttu-id="679f6-284">Quando si aggiorna entità hello, includere il valore di ETag hello ottenuto nel passaggio 1 in hello obbligatorio **If-Match** intestazione della richiesta di hello inviati toohello servizio.</span><span class="sxs-lookup"><span data-stu-id="679f6-284">When you update hello entity, include hello ETag value you received in step 1 in hello mandatory **If-Match** header of hello request you send toohello service.</span></span>
3. <span data-ttu-id="679f6-285">servizio Hello Confronta valore ETag di hello nella richiesta di hello con valore ETag corrente hello dell'entità hello.</span><span class="sxs-lookup"><span data-stu-id="679f6-285">hello service compares hello ETag value in hello request with hello current ETag value of hello entity.</span></span>
4. <span data-ttu-id="679f6-286">Se è diverso da quello Ciao ETag hello obbligatorio valore ETag corrente hello dell'entità hello **If-Match** intestazione nella richiesta di hello, servizio hello restituisce un client di 412 errore toohello.</span><span class="sxs-lookup"><span data-stu-id="679f6-286">If hello current ETag value of hello entity is different than hello ETag in hello mandatory **If-Match** header in hello request, hello service returns a 412 error toohello client.</span></span> <span data-ttu-id="679f6-287">Indica che un altro processo ha aggiornato entità hello poiché è stato recuperato client hello client di toohello.</span><span class="sxs-lookup"><span data-stu-id="679f6-287">This indicates toohello client that another process has updated hello entity since hello client retrieved it.</span></span>
5. <span data-ttu-id="679f6-288">Se il valore ETag corrente hello dell'entità hello è hello stesso hello ETag in hello obbligatorio **If-Match** intestazione nella richiesta di hello o hello **If-Match** intestazione contiene caratteri jolly hello (*), servizio hello esegue hello ha richiesto l'operazione e gli aggiornamenti hello valore ETag corrente di hello tooshow di entità che è stato aggiornato.</span><span class="sxs-lookup"><span data-stu-id="679f6-288">If hello current ETag value of hello entity is hello same as hello ETag in hello mandatory **If-Match** header in hello request or hello **If-Match** header contains hello wildcard character (*), hello service performs hello requested operation and updates hello current ETag value of hello entity tooshow that it has been updated.</span></span>  

<span data-ttu-id="679f6-289">Si noti che, a differenza dei servizi blob hello, del servizio tabelle hello richiede hello client tooinclude un **If-Match** intestazione in richieste di aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="679f6-289">Note that unlike hello blob service, hello table service requires hello client tooinclude an **If-Match** header in update requests.</span></span> <span data-ttu-id="679f6-290">Tuttavia, è possibile tooforce un non condizionale (ultimo writer wins strategia) di aggiornamento e ignorare i controlli di concorrenza se i client di hello imposta hello **If-Match** carattere jolly toohello di intestazione (*) nella richiesta di hello.</span><span class="sxs-lookup"><span data-stu-id="679f6-290">However, it is possible tooforce an unconditional update (last writer wins strategy) and bypass concurrency checks if hello client sets hello **If-Match** header toohello wildcard character (*) in hello request.</span></span>  

<span data-ttu-id="679f6-291">Hello frammento di codice c# seguente viene illustrata un'entità customer che in precedenza è stata creata o recuperata con indirizzo di posta elettronica aggiornato.</span><span class="sxs-lookup"><span data-stu-id="679f6-291">hello following C# snippet shows a customer entity that was previously either created or retrieved having their email address updated.</span></span> <span data-ttu-id="679f6-292">Inserisce Hello iniziale o recuperare il valore ETag di operazione archivi hello oggetto customer hello e poiché viene utilizzato l'esempio hello hello stessa istanza dell'oggetto durante l'esecuzione di hello operazione di sostituzione, invia automaticamente il servizio tabelle toohello indietro di valore ETag di hello, abilitazione toocheck servizio hello per le violazioni di concorrenza.</span><span class="sxs-lookup"><span data-stu-id="679f6-292">hello initial insert or retrieve operation stores hello ETag value in hello customer object, and because hello sample uses hello same object instance when it executes hello replace operation, it automatically sends hello ETag value back toohello table service, enabling hello service toocheck for concurrency violations.</span></span> <span data-ttu-id="679f6-293">Se un altro processo ha aggiornato l'entità hello nell'archiviazione tabelle, il servizio di hello restituisce un messaggio di stato HTTP 412 (Precondition Failed).</span><span class="sxs-lookup"><span data-stu-id="679f6-293">If another process has updated hello entity in table storage, hello service returns an HTTP 412 (Precondition Failed) status message.</span></span>  <span data-ttu-id="679f6-294">È possibile scaricare qui completo esempio hello: [gestione della concorrenza utilizzando l'archiviazione di Azure](http://code.msdn.microsoft.com/Managing-Concurrency-using-56018114).</span><span class="sxs-lookup"><span data-stu-id="679f6-294">You can download hello full sample here: [Managing Concurrency using Azure Storage](http://code.msdn.microsoft.com/Managing-Concurrency-using-56018114).</span></span>

```csharp
try
{
    customer.Email = "updatedEmail@contoso.org";
    TableOperation replaceCustomer = TableOperation.Replace(customer);
    customerTable.Execute(replaceCustomer);
    Console.WriteLine("Replace operation succeeded.");
}
catch (StorageException ex)
{
    if (ex.RequestInformation.HttpStatusCode == 412)
        Console.WriteLine("Optimistic concurrency violation – entity has changed since it was retrieved.");
    else
        throw;
}  
```

<span data-ttu-id="679f6-295">disabilitare il controllo della concorrenza hello tooexplicitly, è consigliabile impostare hello **ETag** proprietà di hello **dipendente** oggetto troppo "*" prima di eseguire l'operazione di sostituzione hello.</span><span class="sxs-lookup"><span data-stu-id="679f6-295">tooexplicitly disable hello concurrency check, you should set hello **ETag** property of hello **employee** object too"*" before you execute hello replace operation.</span></span>  

```csharp
customer.ETag = "*";  
```

<span data-ttu-id="679f6-296">Hello nella tabella seguente sono riepilogati come operazioni di entità tabella hello usare valori ETag:</span><span class="sxs-lookup"><span data-stu-id="679f6-296">hello following table summarizes how hello table entity operations use ETag values:</span></span>

| <span data-ttu-id="679f6-297">Operazione</span><span class="sxs-lookup"><span data-stu-id="679f6-297">Operation</span></span> | <span data-ttu-id="679f6-298">Restituisce il valore ETag</span><span class="sxs-lookup"><span data-stu-id="679f6-298">Returns ETag value</span></span> | <span data-ttu-id="679f6-299">Richiede l'intestazione della richiesta If-Match</span><span class="sxs-lookup"><span data-stu-id="679f6-299">Requires If-Match request header</span></span> |
|:--- |:--- |:--- |
| <span data-ttu-id="679f6-300">Query Entities</span><span class="sxs-lookup"><span data-stu-id="679f6-300">Query Entities</span></span> |<span data-ttu-id="679f6-301">Sì</span><span class="sxs-lookup"><span data-stu-id="679f6-301">Yes</span></span> |<span data-ttu-id="679f6-302">No</span><span class="sxs-lookup"><span data-stu-id="679f6-302">No</span></span> |
| <span data-ttu-id="679f6-303">Insert Entity</span><span class="sxs-lookup"><span data-stu-id="679f6-303">Insert Entity</span></span> |<span data-ttu-id="679f6-304">Sì</span><span class="sxs-lookup"><span data-stu-id="679f6-304">Yes</span></span> |<span data-ttu-id="679f6-305">No</span><span class="sxs-lookup"><span data-stu-id="679f6-305">No</span></span> |
| <span data-ttu-id="679f6-306">Update Entity</span><span class="sxs-lookup"><span data-stu-id="679f6-306">Update Entity</span></span> |<span data-ttu-id="679f6-307">Sì</span><span class="sxs-lookup"><span data-stu-id="679f6-307">Yes</span></span> |<span data-ttu-id="679f6-308">Sì</span><span class="sxs-lookup"><span data-stu-id="679f6-308">Yes</span></span> |
| <span data-ttu-id="679f6-309">Merge Entity</span><span class="sxs-lookup"><span data-stu-id="679f6-309">Merge Entity</span></span> |<span data-ttu-id="679f6-310">Sì</span><span class="sxs-lookup"><span data-stu-id="679f6-310">Yes</span></span> |<span data-ttu-id="679f6-311">Sì</span><span class="sxs-lookup"><span data-stu-id="679f6-311">Yes</span></span> |
| <span data-ttu-id="679f6-312">Delete Entity</span><span class="sxs-lookup"><span data-stu-id="679f6-312">Delete Entity</span></span> |<span data-ttu-id="679f6-313">No</span><span class="sxs-lookup"><span data-stu-id="679f6-313">No</span></span> |<span data-ttu-id="679f6-314">Sì</span><span class="sxs-lookup"><span data-stu-id="679f6-314">Yes</span></span> |
| <span data-ttu-id="679f6-315">Insert or Replace Entity</span><span class="sxs-lookup"><span data-stu-id="679f6-315">Insert or Replace Entity</span></span> |<span data-ttu-id="679f6-316">Sì</span><span class="sxs-lookup"><span data-stu-id="679f6-316">Yes</span></span> |<span data-ttu-id="679f6-317">No</span><span class="sxs-lookup"><span data-stu-id="679f6-317">No</span></span> |
| <span data-ttu-id="679f6-318">Insert or Merge Entity</span><span class="sxs-lookup"><span data-stu-id="679f6-318">Insert or Merge Entity</span></span> |<span data-ttu-id="679f6-319">Sì</span><span class="sxs-lookup"><span data-stu-id="679f6-319">Yes</span></span> |<span data-ttu-id="679f6-320">No</span><span class="sxs-lookup"><span data-stu-id="679f6-320">No</span></span> |

<span data-ttu-id="679f6-321">Si noti che hello **Insert o sostituire entità** e **Insert o Merge entità** operazioni *non* esegue alcun controllo della concorrenza, poiché non inviano un toohello valore ETag servizio tabelle.</span><span class="sxs-lookup"><span data-stu-id="679f6-321">Note that hello **Insert or Replace Entity** and **Insert or Merge Entity** operations do *not* perform any concurrency checks because they do not send an ETag value toohello table service.</span></span>  

<span data-ttu-id="679f6-322">In generale gli sviluppatori che usano tabelle devono fare affidamento sulla concorrenza ottimistica quando sviluppano applicazioni scalabili.</span><span class="sxs-lookup"><span data-stu-id="679f6-322">In general developers using tables should rely on optimistic concurrency when developing scalable applications.</span></span> <span data-ttu-id="679f6-323">Se il blocco pessimistico è necessaria, gli sviluppatori di un approccio possono intraprendere quando l'accesso alle tabelle viene tooassign un blob designato per ogni tabella e provare un lease nel blob hello tootake prima di operare sulla tabella hello.</span><span class="sxs-lookup"><span data-stu-id="679f6-323">If pessimistic locking is needed, one approach developers can take when accessing Tables is tooassign a designated blob for each table and try tootake a lease on hello blob before operating on hello table.</span></span> <span data-ttu-id="679f6-324">Questo approccio richiede tooensure applicazione hello accesso ai dati di tutti i percorsi ottenere hello lease toooperating precedente tabella hello.</span><span class="sxs-lookup"><span data-stu-id="679f6-324">This approach does require hello application tooensure all data access paths obtain hello lease prior toooperating on hello table.</span></span> <span data-ttu-id="679f6-325">Si noti che una durata del lease minimo hello è 15 secondi che richiede un'attenta valutazione per la scalabilità.</span><span class="sxs-lookup"><span data-stu-id="679f6-325">You should also note that hello minimum lease time is 15 seconds which requires careful consideration for scalability.</span></span>  

<span data-ttu-id="679f6-326">Per altre informazioni, vedere:</span><span class="sxs-lookup"><span data-stu-id="679f6-326">For more information, see:</span></span>  

* [<span data-ttu-id="679f6-327">Operazioni sulle entità</span><span class="sxs-lookup"><span data-stu-id="679f6-327">Operations on Entities</span></span>](http://msdn.microsoft.com/library/azure/dd179375.aspx)  

## <a name="managing-concurrency-in-hello-queue-service"></a><span data-ttu-id="679f6-328">Gestione della concorrenza in hello servizio di Accodamento</span><span class="sxs-lookup"><span data-stu-id="679f6-328">Managing Concurrency in hello Queue Service</span></span>
<span data-ttu-id="679f6-329">Uno scenario che in cui la concorrenza è un problema nel servizio di Accodamento messaggi hello è in cui più client recuperano messaggi da una coda.</span><span class="sxs-lookup"><span data-stu-id="679f6-329">One scenario in which concurrency is a concern in hello queueing service is where multiple clients are retrieving messages from a queue.</span></span> <span data-ttu-id="679f6-330">Quando un messaggio viene recuperato dalla coda di hello, risposta hello include messaggio hello e un valore di ricezione pop, ovvero messaggio hello toodelete obbligatorio.</span><span class="sxs-lookup"><span data-stu-id="679f6-330">When a message is retrieved from hello queue, hello response includes hello message and a pop receipt value, which is required toodelete hello message.</span></span> <span data-ttu-id="679f6-331">messaggio non viene eliminato automaticamente dalla coda di hello, ma dopo che sono stati recuperati, non è visibile tooother client per l'intervallo di tempo hello specificato dal parametro visibilitytimeout hello.</span><span class="sxs-lookup"><span data-stu-id="679f6-331">hello message is not automatically deleted from hello queue, but after it has been retrieved, it is not visible tooother clients for hello time interval specified by hello visibilitytimeout parameter.</span></span> <span data-ttu-id="679f6-332">client Hello che recupera il messaggio hello è messaggio hello toodelete previsto dopo che è stata elaborata e prima di hello ora specificata da hello elemento TimeNextVisible di hello risposta, che viene calcolato in base al valore hello hello visibilitytimeout parametro.</span><span class="sxs-lookup"><span data-stu-id="679f6-332">hello client that retrieves hello message is expected toodelete hello message after it has been processed, and before hello time specified by hello TimeNextVisible element of hello response, which is calculated based on hello value of hello visibilitytimeout parameter.</span></span> <span data-ttu-id="679f6-333">il valore di Hello del visibilitytimeout viene aggiunto toohello ora in cui hello messaggio recuperato TimeNextVisible valore hello toodetermine.</span><span class="sxs-lookup"><span data-stu-id="679f6-333">hello value of visibilitytimeout is added toohello time at which hello message is retrieved toodetermine hello value of TimeNextVisible.</span></span>  

<span data-ttu-id="679f6-334">il servizio di Accodamento di Hello non dispone del supporto per la concorrenza ottimistica o pessimistica e per questo client motivo l'elaborazione dei messaggi recuperati da una coda devono verificare i messaggi vengono elaborati in modo idempotente.</span><span class="sxs-lookup"><span data-stu-id="679f6-334">hello queue service does not have support for either optimistic or pessimistic concurrency and for this reason clients processing messages retrieved from a queue should ensure messages are processed in an idempotent manner.</span></span> <span data-ttu-id="679f6-335">Una strategia in cui prevale l'ultima scrittura viene usata per aggiornare operazioni quali SetQueueServiceProperties, SetQueueMetaData, SetQueueACL e UpdateMessage.</span><span class="sxs-lookup"><span data-stu-id="679f6-335">A last writer wins strategy is used for update operations such as SetQueueServiceProperties, SetQueueMetaData, SetQueueACL and UpdateMessage.</span></span>  

<span data-ttu-id="679f6-336">Per altre informazioni, vedere:</span><span class="sxs-lookup"><span data-stu-id="679f6-336">For more information, see:</span></span>  

* [<span data-ttu-id="679f6-337">API REST del servizio di accodamento</span><span class="sxs-lookup"><span data-stu-id="679f6-337">Queue Service REST API</span></span>](http://msdn.microsoft.com/library/azure/dd179363.aspx)
* [<span data-ttu-id="679f6-338">Get Messages</span><span class="sxs-lookup"><span data-stu-id="679f6-338">Get Messages</span></span>](http://msdn.microsoft.com/library/azure/dd179474.aspx)  

## <a name="managing-concurrency-in-hello-file-service"></a><span data-ttu-id="679f6-339">Gestione della concorrenza in hello servizio File</span><span class="sxs-lookup"><span data-stu-id="679f6-339">Managing Concurrency in hello File Service</span></span>
<span data-ttu-id="679f6-340">servizio file Hello è possibile accedere tramite due endpoint di protocollo diversi: SMB e REST.</span><span class="sxs-lookup"><span data-stu-id="679f6-340">hello file service can be accessed using two different protocol endpoints – SMB and REST.</span></span> <span data-ttu-id="679f6-341">Hello servizio REST non dispone di supporto per il blocco ottimistico o pessimistico blocco e tutti gli aggiornamenti seguiranno una strategia di wins ultimo writer.</span><span class="sxs-lookup"><span data-stu-id="679f6-341">hello REST service does not have support for either optimistic locking or pessimistic locking and all updates will follow a last writer wins strategy.</span></span> <span data-ttu-id="679f6-342">I client SMB che montate condivisioni file possono utilizzare file blocco meccanismi toomanage accesso tooshared del file system-tra cui hello possibilità tooperform il blocco pessimistico.</span><span class="sxs-lookup"><span data-stu-id="679f6-342">SMB clients that mount file shares can leverage file system locking mechanisms toomanage access tooshared files – including hello ability tooperform pessimistic locking.</span></span> <span data-ttu-id="679f6-343">Quando un client SMB apre un file, specifica l'accesso al file hello sia condivisione modalità.</span><span class="sxs-lookup"><span data-stu-id="679f6-343">When an SMB client opens a file, it specifies both hello file access and share mode.</span></span> <span data-ttu-id="679f6-344">Se un'opzione di accesso ai File di "Scrittura" o "Lettura/scrittura" insieme a una modalità di condivisione File "None", verrà restituita nel file hello è bloccato da un client SMB fino alla chiusura di file hello.</span><span class="sxs-lookup"><span data-stu-id="679f6-344">Setting a File Access option of "Write" or "Read/Write" along with a File Share mode of "None" will result in hello file being locked by an SMB client until hello file is closed.</span></span> <span data-ttu-id="679f6-345">Se l'operazione di resto viene tentata in un file in cui un client SMB ha bloccato file hello hello servizio REST restituirà il codice di stato 409 (conflitto) con codice errore SharingViolation.</span><span class="sxs-lookup"><span data-stu-id="679f6-345">If REST operation is attempted on a file where an SMB client has hello file locked hello REST service will return status code 409 (Conflict) with error code SharingViolation.</span></span>  

<span data-ttu-id="679f6-346">Quando un client SMB apre un file per l'eliminazione, contrassegna il file hello come in attesa di eliminazione fino a quando tutti gli altri client SMB vengono chiusi gli handle aperti sul file selezionato.</span><span class="sxs-lookup"><span data-stu-id="679f6-346">When an SMB client opens a file for delete, it marks hello file as pending delete until all other SMB client open handles on that file are closed.</span></span> <span data-ttu-id="679f6-347">Quando un file viene contrassegnato come in attesa di eliminazione, qualsiasi operazione REST su tale file restituirà il codice di stato 409 (Conflitto) con codice errore SMBDeletePending.</span><span class="sxs-lookup"><span data-stu-id="679f6-347">While a file is marked as pending delete, any REST operation on that file will return status code 409 (Conflict) with error code SMBDeletePending.</span></span> <span data-ttu-id="679f6-348">Poiché è possibile per hello di hello SMB client tooremove file hello tooclosing precedente flag di eliminazione in sospeso, non viene restituito il codice di stato 404 (non trovato).</span><span class="sxs-lookup"><span data-stu-id="679f6-348">Status code 404 (Not Found) is not returned since it is possible for hello SMB client tooremove hello pending deletion flag prior tooclosing hello file.</span></span> <span data-ttu-id="679f6-349">In altre parole, codice di stato 404 (non trovato) è previsto solo quando è stato rimosso il file hello.</span><span class="sxs-lookup"><span data-stu-id="679f6-349">In other words, status code 404 (Not Found) is only expected when hello file has been removed.</span></span> <span data-ttu-id="679f6-350">Si noti che mentre un file è un protocollo SMB in sospeso lo stato di eliminazione, non essere incluso in hello che elencati i file di risultati.</span><span class="sxs-lookup"><span data-stu-id="679f6-350">Note that while a file is in an SMB pending delete state, it will not be included in hello List Files results.</span></span> <span data-ttu-id="679f6-351">Si noti inoltre che le operazioni REST Elimina tutti i File e Directory eliminare REST hello vengono eseguito il commit in modo atomico e non vengano inseriti in uno stato di eliminazione in sospeso.</span><span class="sxs-lookup"><span data-stu-id="679f6-351">Also, note that hello REST Delete File and REST Delete Directory operations are committed atomically and do not result in a pending delete state.</span></span>  

<span data-ttu-id="679f6-352">Per altre informazioni, vedere:</span><span class="sxs-lookup"><span data-stu-id="679f6-352">For more information, see:</span></span>  

* [<span data-ttu-id="679f6-353">Managing File Locks</span><span class="sxs-lookup"><span data-stu-id="679f6-353">Managing File Locks</span></span>](http://msdn.microsoft.com/library/azure/dn194265.aspx)  

## <a name="summary-and-next-steps"></a><span data-ttu-id="679f6-354">Riepilogo e passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="679f6-354">Summary and Next Steps</span></span>
<span data-ttu-id="679f6-355">Hello archiviazione di Microsoft Azure, servizio è stato progettato esigenze hello toomeet delle applicazioni in linea più complesse hello senza imporre agli sviluppatori toocompromise o riflettere sulla chiave presupposti di progettazione, ad esempio concorrenza e consistenza dei dati che provengono tootake Per concedere.</span><span class="sxs-lookup"><span data-stu-id="679f6-355">hello Microsoft Azure Storage service has been designed toomeet hello needs of hello most complex online applications without forcing developers toocompromise or rethink key design assumptions such as concurrency and data consistency that they have come tootake for granted.</span></span>  

<span data-ttu-id="679f6-356">Per hello completare l'applicazione di esempio a cui fa riferimento in questo blog:</span><span class="sxs-lookup"><span data-stu-id="679f6-356">For hello complete sample application referenced in this blog:</span></span>  

* [<span data-ttu-id="679f6-357">Gestione della concorrenza con l'archiviazione di Azure - Applicazione di esempio</span><span class="sxs-lookup"><span data-stu-id="679f6-357">Managing Concurrency using Azure Storage - Sample Application</span></span>](http://code.msdn.microsoft.com/Managing-Concurrency-using-56018114)  

<span data-ttu-id="679f6-358">Per altre informazioni sull'archiviazione di Azure, vedere:</span><span class="sxs-lookup"><span data-stu-id="679f6-358">For more information on Azure Storage see:</span></span>  

* [<span data-ttu-id="679f6-359">Home page di Archiviazione di Microsoft Azure</span><span class="sxs-lookup"><span data-stu-id="679f6-359">Microsoft Azure Storage Home Page</span></span>](https://azure.microsoft.com/services/storage/)
* [<span data-ttu-id="679f6-360">Introduzione tooAzure archiviazione</span><span class="sxs-lookup"><span data-stu-id="679f6-360">Introduction tooAzure Storage</span></span>](storage-introduction.md)
* <span data-ttu-id="679f6-361">Introduzione all'archiviazione per [BLOB](../blobs/storage-dotnet-how-to-use-blobs.md), [tabelle](../../cosmos-db/table-storage-how-to-use-dotnet.md), [code](../storage-dotnet-how-to-use-queues.md) e [file](../storage-dotnet-how-to-use-files.md)</span><span class="sxs-lookup"><span data-stu-id="679f6-361">Storage Getting Started for [Blob](../blobs/storage-dotnet-how-to-use-blobs.md), [Table](../../cosmos-db/table-storage-how-to-use-dotnet.md),  [Queues](../storage-dotnet-how-to-use-queues.md), and [Files](../storage-dotnet-how-to-use-files.md)</span></span>
* <span data-ttu-id="679f6-362">Architettura di archiviazione - [Archiviazione di Azure: un servizio di archiviazione cloud a elevata disponibilità con coerenza assoluta](http://blogs.msdn.com/b/windowsazurestorage/archive/2011/11/20/windows-azure-storage-a-highly-available-cloud-storage-service-with-strong-consistency.aspx)</span><span class="sxs-lookup"><span data-stu-id="679f6-362">Storage Architecture – [Azure Storage: A Highly Available Cloud Storage Service with Strong Consistency](http://blogs.msdn.com/b/windowsazurestorage/archive/2011/11/20/windows-azure-storage-a-highly-available-cloud-storage-service-with-strong-consistency.aspx)</span></span>

