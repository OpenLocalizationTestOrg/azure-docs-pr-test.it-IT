---
title: Come usare PerfInsights in Microsoft Azure| Microsoft Docs
description: Informazioni su come usare PerfInsights per risolvere i problemi delle prestazioni delle VM Windows.
services: virtual-machines-windows'
documentationcenter: 
author: genlin
manager: cshepard
editor: na
tags: 
ms.service: virtual-machines-windows
ms.workload: infrastructure-services
ms.tgt_pltfrm: vm-windows
ms.devlang: na
ms.topic: article
ms.date: 07/18/2017
ms.author: genli
ms.openlocfilehash: f22bd42302b96118dba0d4e5e387c6798a0b8777
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/18/2017
---
# <a name="how-to-use-perfinsights"></a><span data-ttu-id="8018f-103">Come usare PerfInsights</span><span class="sxs-lookup"><span data-stu-id="8018f-103">How to use PerfInsights</span></span> 

<span data-ttu-id="8018f-104">[PerfInsights](http://aka.ms/perfinsightsdownload) è uno script automatizzato che raccoglie utili informazioni di diagnostica, esegue carichi con stress di I/O e fornisce un report di analisi per risolvere i problemi di prestazioni delle VM Windows in Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="8018f-104">[PerfInsights](http://aka.ms/perfinsightsdownload) is an automated script that collects useful diagnostic information, runs I/O stress loads, and provides an analysis report to help troubleshoot Windows VM performance problems in Microsoft Azure.</span></span> 

<span data-ttu-id="8018f-105">È consigliabile aprire questo script prima di aprire un ticket di supporto con Microsoft per problemi di prestazioni delle VM.</span><span class="sxs-lookup"><span data-stu-id="8018f-105">We recommend that you run this script before you open a Support ticket with Microsoft for VM performance issues.</span></span>

## <a name="supported-troubleshooting-scenarios"></a><span data-ttu-id="8018f-106">Scenari per la risoluzione dei problemi supportati</span><span class="sxs-lookup"><span data-stu-id="8018f-106">Supported troubleshooting scenarios</span></span>

<span data-ttu-id="8018f-107">PerfInsights può raccogliere e analizzare diversi tipi di informazioni che vengono raggruppate in scenari univoci.</span><span class="sxs-lookup"><span data-stu-id="8018f-107">PerfInsights can collect and analyze several kinds of information that are grouped into unique scenarios.</span></span>

### <a name="collect-disk-configuration"></a><span data-ttu-id="8018f-108">Raccogliere la configurazione dei dischi</span><span class="sxs-lookup"><span data-stu-id="8018f-108">Collect disk configuration</span></span> 

<span data-ttu-id="8018f-109">Questo scenario raccoglie la configurazione dei dischi e altre importanti informazioni, inclusi gli elementi seguenti:</span><span class="sxs-lookup"><span data-stu-id="8018f-109">This scenario collects the disk configuration and other important information, including the following items:</span></span>

-   <span data-ttu-id="8018f-110">Log eventi</span><span class="sxs-lookup"><span data-stu-id="8018f-110">Event logs</span></span>

-   <span data-ttu-id="8018f-111">Stato della rete per tutte le connessioni in ingresso e in uscita</span><span class="sxs-lookup"><span data-stu-id="8018f-111">Network status for all incoming and outgoing connections</span></span>

-   <span data-ttu-id="8018f-112">Impostazioni di configurazione della rete e del firewall</span><span class="sxs-lookup"><span data-stu-id="8018f-112">Network and firewall configuration settings</span></span>

-   <span data-ttu-id="8018f-113">Elenco di attività per tutte le applicazioni attualmente in esecuzione nel sistema</span><span class="sxs-lookup"><span data-stu-id="8018f-113">Task list for all applications that are currently running on the system</span></span>

-   <span data-ttu-id="8018f-114">File di informazioni creato da msinfo32 per la macchina virtuale (VM)</span><span class="sxs-lookup"><span data-stu-id="8018f-114">Information file created by msinfo32 for the virtual machine (VM)</span></span>

-   <span data-ttu-id="8018f-115">Impostazioni di configurazione del database di Microsoft SQL Server (se la VM viene identificata come server che esegue SQL Server)</span><span class="sxs-lookup"><span data-stu-id="8018f-115">Microsoft SQL Server database configuration settings (if the VM is identified as a server that is running SQL Server)</span></span>

-   <span data-ttu-id="8018f-116">Contatori di affidabilità di archiviazione</span><span class="sxs-lookup"><span data-stu-id="8018f-116">Storage reliability counters</span></span>

-   <span data-ttu-id="8018f-117">Importanti hotfix di Windows</span><span class="sxs-lookup"><span data-stu-id="8018f-117">Important Windows hotfixes</span></span>

-   <span data-ttu-id="8018f-118">Driver di filtro installati</span><span class="sxs-lookup"><span data-stu-id="8018f-118">Installed filter drivers</span></span>

<span data-ttu-id="8018f-119">Si tratta di una raccolta passiva di informazioni che non influirà sul sistema.</span><span class="sxs-lookup"><span data-stu-id="8018f-119">This is a passive collection of information that shouldn't affect the system.</span></span> 

>[!Note]
><span data-ttu-id="8018f-120">Questo scenario viene automaticamente incluso in tutti gli scenari seguenti.</span><span class="sxs-lookup"><span data-stu-id="8018f-120">This scenario is automatically included in each of the following scenarios.</span></span>

### <a name="benchmarkstorage-performance-test"></a><span data-ttu-id="8018f-121">Test delle prestazioni dell'archiviazione o di benchmark</span><span class="sxs-lookup"><span data-stu-id="8018f-121">Benchmark/Storage Performance Test</span></span>

<span data-ttu-id="8018f-122">Questo scenario esegue il test di benchmark [diskspd](https://github.com/Microsoft/diskspd) (operazioni di I/O al secondo e Mbps) per tutte le unità collegate alla VM.</span><span class="sxs-lookup"><span data-stu-id="8018f-122">This scenario runs the [diskspd](https://github.com/Microsoft/diskspd) benchmark test (IOPS and MBPS) for all drives that are attached to the VM.</span></span> 

> [!Note]
> <span data-ttu-id="8018f-123">Questo scenario può influire sul sistema e non deve essere eseguito in un sistema di produzione live.</span><span class="sxs-lookup"><span data-stu-id="8018f-123">This scenario can affect the system and shouldn’t be run on a live production system.</span></span> <span data-ttu-id="8018f-124">Se necessario, eseguire questo scenario in una finestra di manutenzione dedicata per evitare qualsiasi problema.</span><span class="sxs-lookup"><span data-stu-id="8018f-124">If necessary, run this scenario in a dedicated maintenance window to avoid any problems.</span></span> <span data-ttu-id="8018f-125">Un maggiore carico di lavoro causato da un test di traccia o di benchmark può influire negativamente sulle prestazioni della VM.</span><span class="sxs-lookup"><span data-stu-id="8018f-125">An increased workload that is caused by a trace or benchmark test could adversely affect the performance of your VM.</span></span>
>

### <a name="general-vm-slow-analysis"></a><span data-ttu-id="8018f-126">Analisi generale della VM lenta</span><span class="sxs-lookup"><span data-stu-id="8018f-126">General VM Slow analysis</span></span> 

<span data-ttu-id="8018f-127">Questo scenario esegue una traccia dei [contatori delle prestazioni](https://msdn.microsoft.com/library/windows/desktop/aa373083(v=vs.85).aspx) usando i contatori specificati nel file Generalcounters.txt.</span><span class="sxs-lookup"><span data-stu-id="8018f-127">This scenario runs a [performance counter](https://msdn.microsoft.com/library/windows/desktop/aa373083(v=vs.85).aspx) trace by using the counters that are specified in the Generalcounters.txt file.</span></span> <span data-ttu-id="8018f-128">Se la VM viene identificata come server che esegue SQL Server, esegue una traccia dei contatori delle prestazioni usando i contatori presenti nel file Sqlcounters.txt.</span><span class="sxs-lookup"><span data-stu-id="8018f-128">If the VM is identified as a server that is running SQL Server, it runs a performance counter trace by using the counters that are found in the Sqlcounters.txt file.</span></span> <span data-ttu-id="8018f-129">Include anche i dati di diagnostica delle prestazioni.</span><span class="sxs-lookup"><span data-stu-id="8018f-129">It also includes Performance Diagnostics data.</span></span>

### <a name="vm-slow-analysis-and-benchmark"></a><span data-ttu-id="8018f-130">Analisi della VM lenta e benchmark</span><span class="sxs-lookup"><span data-stu-id="8018f-130">VM Slow analysis and benchmark</span></span>

<span data-ttu-id="8018f-131">Questo scenario esegue una traccia dei [contatori delle prestazioni](https://msdn.microsoft.com/library/windows/desktop/aa373083(v=vs.85).aspx) seguita da un test di benchmark [diskspd](https://github.com/Microsoft/diskspd).</span><span class="sxs-lookup"><span data-stu-id="8018f-131">This scenario runs a [performance counter](https://msdn.microsoft.com/library/windows/desktop/aa373083(v=vs.85).aspx) trace that is followed by a [diskspd](https://github.com/Microsoft/diskspd) benchmark test.</span></span> 

> [!Note]
> <span data-ttu-id="8018f-132">Questo scenario può influire sul sistema e non deve essere eseguito in un sistema di produzione live.</span><span class="sxs-lookup"><span data-stu-id="8018f-132">This scenario can affect the system and shouldn’t be run on a live production system.</span></span> <span data-ttu-id="8018f-133">Se necessario, eseguire questo scenario in una finestra di manutenzione dedicata per evitare qualsiasi problema.</span><span class="sxs-lookup"><span data-stu-id="8018f-133">If necessary, run this scenario in a dedicated maintenance window to avoid any problems.</span></span> <span data-ttu-id="8018f-134">Un maggiore carico di lavoro causato da un test di traccia o di benchmark può influire negativamente sulle prestazioni della VM.</span><span class="sxs-lookup"><span data-stu-id="8018f-134">An increased workload that is caused by a trace or benchmark test could adversely affect the performance of your VM.</span></span>
>

### <a name="azure-files-analysis"></a><span data-ttu-id="8018f-135">Analisi di File di Azure</span><span class="sxs-lookup"><span data-stu-id="8018f-135">Azure Files analysis</span></span> 

<span data-ttu-id="8018f-136">Questo scenario esegue una speciale acquisizione dei contatori delle prestazioni insieme a una traccia di rete.</span><span class="sxs-lookup"><span data-stu-id="8018f-136">This scenario runs a special performance counter capture together with a network trace.</span></span> <span data-ttu-id="8018f-137">L'acquisizione include tutti i contatori "Condivisioni client SMB".</span><span class="sxs-lookup"><span data-stu-id="8018f-137">The capture includes all the "SMB Client Shares" counters.</span></span> <span data-ttu-id="8018f-138">I seguenti sono alcuni dei principali contatori delle prestazioni Condivisioni client SMB che fanno parte dell'acquisizione:</span><span class="sxs-lookup"><span data-stu-id="8018f-138">The following are some key SMB client share performance counters that are part of the capture:</span></span>

| <span data-ttu-id="8018f-139">**Tipo**</span><span class="sxs-lookup"><span data-stu-id="8018f-139">**Type**</span></span>     | <span data-ttu-id="8018f-140">**Contatore Condivisioni client SMB**</span><span class="sxs-lookup"><span data-stu-id="8018f-140">**SMB client shares counter**</span></span> |
|--------------|-------------------------------|
| <span data-ttu-id="8018f-141">IOPS</span><span class="sxs-lookup"><span data-stu-id="8018f-141">IOPS</span></span>         | <span data-ttu-id="8018f-142">Richieste dati/sec</span><span class="sxs-lookup"><span data-stu-id="8018f-142">Data Requests/sec</span></span>             |
|              | <span data-ttu-id="8018f-143">Richieste di lettura/sec</span><span class="sxs-lookup"><span data-stu-id="8018f-143">Read Requests/sec</span></span>             |
|              | <span data-ttu-id="8018f-144">Richieste di scrittura/sec</span><span class="sxs-lookup"><span data-stu-id="8018f-144">Write Requests/sec</span></span>            |
| <span data-ttu-id="8018f-145">Latency</span><span class="sxs-lookup"><span data-stu-id="8018f-145">Latency</span></span>      | <span data-ttu-id="8018f-146">Media sec/dati richiesta</span><span class="sxs-lookup"><span data-stu-id="8018f-146">Avg. sec/Data Request</span></span>         |
|              | <span data-ttu-id="8018f-147">Media sec/lettura</span><span class="sxs-lookup"><span data-stu-id="8018f-147">Avg. sec/Read</span></span>                 |
|              | <span data-ttu-id="8018f-148">Media sec/scrittura</span><span class="sxs-lookup"><span data-stu-id="8018f-148">Avg. sec/Write</span></span>                |
| <span data-ttu-id="8018f-149">Dimensioni I/O</span><span class="sxs-lookup"><span data-stu-id="8018f-149">IO Size</span></span>      | <span data-ttu-id="8018f-150">Avg. Bytes/Data Request (Media byte/richiesta dati)</span><span class="sxs-lookup"><span data-stu-id="8018f-150">Avg. Bytes/Data Request</span></span>       |
|              | <span data-ttu-id="8018f-151">Media byte/Lettura</span><span class="sxs-lookup"><span data-stu-id="8018f-151">Avg. Bytes/Read</span></span>               |
|              | <span data-ttu-id="8018f-152">Media byte/Scrittura</span><span class="sxs-lookup"><span data-stu-id="8018f-152">Avg. Bytes/Write</span></span>              |
| <span data-ttu-id="8018f-153">Velocità effettiva</span><span class="sxs-lookup"><span data-stu-id="8018f-153">Throughput</span></span>   | <span data-ttu-id="8018f-154">Byte dati/sec</span><span class="sxs-lookup"><span data-stu-id="8018f-154">Data Bytes/sec</span></span>                |
|              | <span data-ttu-id="8018f-155">Byte letti/sec</span><span class="sxs-lookup"><span data-stu-id="8018f-155">Read Bytes/sec</span></span>                |
|              | <span data-ttu-id="8018f-156">Byte scritti/sec</span><span class="sxs-lookup"><span data-stu-id="8018f-156">Write Bytes/sec</span></span>               |
| <span data-ttu-id="8018f-157">Lunghezza coda</span><span class="sxs-lookup"><span data-stu-id="8018f-157">Queue Length</span></span> | <span data-ttu-id="8018f-158">Lunghezza media coda lettura</span><span class="sxs-lookup"><span data-stu-id="8018f-158">Avg. Read Queue Length</span></span>        |
|              | <span data-ttu-id="8018f-159">Lunghezza media coda scrittura</span><span class="sxs-lookup"><span data-stu-id="8018f-159">Avg. Write Queue Length</span></span>       |
|              | <span data-ttu-id="8018f-160">Lunghezza media coda dati</span><span class="sxs-lookup"><span data-stu-id="8018f-160">Avg. Data Queue Length</span></span>        |

### <a name="custom-configuration"></a><span data-ttu-id="8018f-161">Configurazione personalizzata</span><span class="sxs-lookup"><span data-stu-id="8018f-161">Custom configuration</span></span> 

<span data-ttu-id="8018f-162">Quando si esegue una configurazione personalizzata, si eseguono tutte le tracce (diagnostica delle prestazioni, contatore delle prestazioni, Xperf, rete, StorPort) in parallelo, a seconda del numero di tracce diverse selezionate.</span><span class="sxs-lookup"><span data-stu-id="8018f-162">When you run a custom configuration, you are running all traces (performance diagnostics, performance counter, xperf, network, storport) in parallel, depending how many different traces are selected.</span></span> <span data-ttu-id="8018f-163">Al termine dell'analisi, lo strumento esegue il benchmark diskspd, se selezionato.</span><span class="sxs-lookup"><span data-stu-id="8018f-163">After tracing is completed, the tool runs the diskspd benchmark, if it is selected.</span></span> 

> [!Note]
> <span data-ttu-id="8018f-164">Questo scenario può influire sul sistema e non deve essere eseguito in un sistema di produzione live.</span><span class="sxs-lookup"><span data-stu-id="8018f-164">This scenario can affect the system and shouldn’t be run on a live production system.</span></span> <span data-ttu-id="8018f-165">Se necessario, eseguire questo scenario in una finestra di manutenzione dedicata per evitare qualsiasi problema.</span><span class="sxs-lookup"><span data-stu-id="8018f-165">If necessary, run this scenario in a dedicated maintenance window to avoid any problems.</span></span> <span data-ttu-id="8018f-166">Un maggiore carico di lavoro causato da un test di traccia o di benchmark può influire negativamente sulle prestazioni della VM.</span><span class="sxs-lookup"><span data-stu-id="8018f-166">An increased workload that is caused by a trace or benchmark test could adversely affect the performance of your VM.</span></span>
>

## <a name="what-kind-of-information-is-collected-by-the-script"></a><span data-ttu-id="8018f-167">Tipo di informazioni raccolte dallo script</span><span class="sxs-lookup"><span data-stu-id="8018f-167">What kind of information is collected by the script?</span></span>

<span data-ttu-id="8018f-168">Vengono raccolte informazioni sulla VM Windows, sulla configurazione dei dischi o dei pool di archiviazione, sui contatori delle prestazioni, sui log e su diverse tracce a seconda dello scenario delle prestazioni usato:</span><span class="sxs-lookup"><span data-stu-id="8018f-168">Information about Windows VM, disks or storage pools configuration, performance counters, logs and various traces are collected depending on the performance scenario used:</span></span>

|<span data-ttu-id="8018f-169">Dati raccolti</span><span class="sxs-lookup"><span data-stu-id="8018f-169">Data collected</span></span>                              |  |  | <span data-ttu-id="8018f-170">Scenari delle prestazioni</span><span class="sxs-lookup"><span data-stu-id="8018f-170">Performance Scenarios</span></span> |  |  | |
|----------------------------------|----------------------------|------------------------------------|--------------------------|--------------------------------|----------------------|----------------------|
|                              | <span data-ttu-id="8018f-171">Raccogliere la configurazione dei dischi</span><span class="sxs-lookup"><span data-stu-id="8018f-171">Collect disk Configuration</span></span> | <span data-ttu-id="8018f-172">Test delle prestazioni dell'archiviazione o di benchmark</span><span class="sxs-lookup"><span data-stu-id="8018f-172">Benchmark/Storage Performance test</span></span> | <span data-ttu-id="8018f-173">Analisi generale della VM lenta</span><span class="sxs-lookup"><span data-stu-id="8018f-173">General VM Slow analysis</span></span> | <span data-ttu-id="8018f-174">Analisi della VM lenta e benchmark</span><span class="sxs-lookup"><span data-stu-id="8018f-174">VM Slow analysis and benchmark</span></span> | <span data-ttu-id="8018f-175">Analisi di File di Azure</span><span class="sxs-lookup"><span data-stu-id="8018f-175">Azure Files analysis</span></span> | <span data-ttu-id="8018f-176">Configurazione personalizzata</span><span class="sxs-lookup"><span data-stu-id="8018f-176">Custom configuration</span></span> |
| <span data-ttu-id="8018f-177">Informazioni dai log eventi</span><span class="sxs-lookup"><span data-stu-id="8018f-177">Information from Event logs</span></span>      | <span data-ttu-id="8018f-178">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-178">Yes</span></span>                        | <span data-ttu-id="8018f-179">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-179">Yes</span></span>                                | <span data-ttu-id="8018f-180">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-180">Yes</span></span>                      | <span data-ttu-id="8018f-181">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-181">Yes</span></span>                            | <span data-ttu-id="8018f-182">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-182">Yes</span></span>                  | <span data-ttu-id="8018f-183">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-183">Yes</span></span>                  |
| <span data-ttu-id="8018f-184">Informazioni di sistema</span><span class="sxs-lookup"><span data-stu-id="8018f-184">System information</span></span>               | <span data-ttu-id="8018f-185">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-185">Yes</span></span>                        | <span data-ttu-id="8018f-186">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-186">Yes</span></span>                                | <span data-ttu-id="8018f-187">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-187">Yes</span></span>                      | <span data-ttu-id="8018f-188">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-188">Yes</span></span>                            | <span data-ttu-id="8018f-189">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-189">Yes</span></span>                  | <span data-ttu-id="8018f-190">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-190">Yes</span></span>                  |
| <span data-ttu-id="8018f-191">Mapping del volume</span><span class="sxs-lookup"><span data-stu-id="8018f-191">Volume Map</span></span>                       | <span data-ttu-id="8018f-192">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-192">Yes</span></span>                        | <span data-ttu-id="8018f-193">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-193">Yes</span></span>                                | <span data-ttu-id="8018f-194">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-194">Yes</span></span>                      | <span data-ttu-id="8018f-195">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-195">Yes</span></span>                            | <span data-ttu-id="8018f-196">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-196">Yes</span></span>                  | <span data-ttu-id="8018f-197">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-197">Yes</span></span>                  |
| <span data-ttu-id="8018f-198">Mapping del disco</span><span class="sxs-lookup"><span data-stu-id="8018f-198">Disk Map</span></span>                         | <span data-ttu-id="8018f-199">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-199">Yes</span></span>                        | <span data-ttu-id="8018f-200">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-200">Yes</span></span>                                | <span data-ttu-id="8018f-201">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-201">Yes</span></span>                      | <span data-ttu-id="8018f-202">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-202">Yes</span></span>                            | <span data-ttu-id="8018f-203">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-203">Yes</span></span>                  | <span data-ttu-id="8018f-204">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-204">Yes</span></span>                  |
| <span data-ttu-id="8018f-205">Attività in esecuzione</span><span class="sxs-lookup"><span data-stu-id="8018f-205">Running Tasks</span></span>                    | <span data-ttu-id="8018f-206">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-206">Yes</span></span>                        | <span data-ttu-id="8018f-207">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-207">Yes</span></span>                                | <span data-ttu-id="8018f-208">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-208">Yes</span></span>                      | <span data-ttu-id="8018f-209">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-209">Yes</span></span>                            | <span data-ttu-id="8018f-210">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-210">Yes</span></span>                  | <span data-ttu-id="8018f-211">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-211">Yes</span></span>                  |
| <span data-ttu-id="8018f-212">Contatori di affidabilità di archiviazione</span><span class="sxs-lookup"><span data-stu-id="8018f-212">Storage Reliability Counters</span></span>     | <span data-ttu-id="8018f-213">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-213">Yes</span></span>                        | <span data-ttu-id="8018f-214">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-214">Yes</span></span>                                | <span data-ttu-id="8018f-215">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-215">Yes</span></span>                      | <span data-ttu-id="8018f-216">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-216">Yes</span></span>                            | <span data-ttu-id="8018f-217">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-217">Yes</span></span>                  | <span data-ttu-id="8018f-218">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-218">Yes</span></span>                  |
| <span data-ttu-id="8018f-219">Informazioni sull'archiviazione</span><span class="sxs-lookup"><span data-stu-id="8018f-219">Storage information</span></span>              | <span data-ttu-id="8018f-220">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-220">Yes</span></span>                        | <span data-ttu-id="8018f-221">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-221">Yes</span></span>                                | <span data-ttu-id="8018f-222">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-222">Yes</span></span>                      | <span data-ttu-id="8018f-223">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-223">Yes</span></span>                            | <span data-ttu-id="8018f-224">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-224">Yes</span></span>                  | <span data-ttu-id="8018f-225">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-225">Yes</span></span>                  |
| <span data-ttu-id="8018f-226">Output di fsutil</span><span class="sxs-lookup"><span data-stu-id="8018f-226">Fsutil output</span></span>                    | <span data-ttu-id="8018f-227">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-227">Yes</span></span>                        | <span data-ttu-id="8018f-228">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-228">Yes</span></span>                                | <span data-ttu-id="8018f-229">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-229">Yes</span></span>                      | <span data-ttu-id="8018f-230">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-230">Yes</span></span>                            | <span data-ttu-id="8018f-231">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-231">Yes</span></span>                  | <span data-ttu-id="8018f-232">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-232">Yes</span></span>                  |
| <span data-ttu-id="8018f-233">Informazioni sul driver di filtro</span><span class="sxs-lookup"><span data-stu-id="8018f-233">Filter Driver info</span></span>               | <span data-ttu-id="8018f-234">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-234">Yes</span></span>                        | <span data-ttu-id="8018f-235">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-235">Yes</span></span>                                | <span data-ttu-id="8018f-236">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-236">Yes</span></span>                      | <span data-ttu-id="8018f-237">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-237">Yes</span></span>                            | <span data-ttu-id="8018f-238">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-238">Yes</span></span>                  | <span data-ttu-id="8018f-239">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-239">Yes</span></span>                  |
| <span data-ttu-id="8018f-240">Output di netstat</span><span class="sxs-lookup"><span data-stu-id="8018f-240">Netstat output</span></span>                   | <span data-ttu-id="8018f-241">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-241">Yes</span></span>                        | <span data-ttu-id="8018f-242">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-242">Yes</span></span>                                | <span data-ttu-id="8018f-243">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-243">Yes</span></span>                      | <span data-ttu-id="8018f-244">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-244">Yes</span></span>                            | <span data-ttu-id="8018f-245">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-245">Yes</span></span>                  | <span data-ttu-id="8018f-246">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-246">Yes</span></span>                  |
| <span data-ttu-id="8018f-247">Network configuration</span><span class="sxs-lookup"><span data-stu-id="8018f-247">Network configuration</span></span>            | <span data-ttu-id="8018f-248">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-248">Yes</span></span>                        | <span data-ttu-id="8018f-249">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-249">Yes</span></span>                                | <span data-ttu-id="8018f-250">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-250">Yes</span></span>                      | <span data-ttu-id="8018f-251">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-251">Yes</span></span>                            | <span data-ttu-id="8018f-252">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-252">Yes</span></span>                  | <span data-ttu-id="8018f-253">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-253">Yes</span></span>                  |
| <span data-ttu-id="8018f-254">Configurazione del firewall</span><span class="sxs-lookup"><span data-stu-id="8018f-254">Firewall configuration</span></span>           | <span data-ttu-id="8018f-255">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-255">Yes</span></span>                        | <span data-ttu-id="8018f-256">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-256">Yes</span></span>                                | <span data-ttu-id="8018f-257">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-257">Yes</span></span>                      | <span data-ttu-id="8018f-258">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-258">Yes</span></span>                            | <span data-ttu-id="8018f-259">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-259">Yes</span></span>                  | <span data-ttu-id="8018f-260">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-260">Yes</span></span>                  |
| <span data-ttu-id="8018f-261">Configurazione di SQL Server</span><span class="sxs-lookup"><span data-stu-id="8018f-261">SQL Server configuration</span></span>         | <span data-ttu-id="8018f-262">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-262">Yes</span></span>                        | <span data-ttu-id="8018f-263">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-263">Yes</span></span>                                | <span data-ttu-id="8018f-264">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-264">Yes</span></span>                      | <span data-ttu-id="8018f-265">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-265">Yes</span></span>                            | <span data-ttu-id="8018f-266">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-266">Yes</span></span>                  | <span data-ttu-id="8018f-267">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-267">Yes</span></span>                  |
| <span data-ttu-id="8018f-268">Tracce diagnostiche delle prestazioni *</span><span class="sxs-lookup"><span data-stu-id="8018f-268">Performance Diagnostics Traces *</span></span> |                            |                                    | <span data-ttu-id="8018f-269">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-269">Yes</span></span>                      |                                |                      | <span data-ttu-id="8018f-270">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-270">Yes</span></span>                  |
| <span data-ttu-id="8018f-271">Traccia dei contatori delle prestazioni **</span><span class="sxs-lookup"><span data-stu-id="8018f-271">Performance counter Trace **</span></span>     |                            |                                    |                          |                                |                      | <span data-ttu-id="8018f-272">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-272">Yes</span></span>                  |
| <span data-ttu-id="8018f-273">Traccia del contatore SMB **</span><span class="sxs-lookup"><span data-stu-id="8018f-273">SMB counter Trace **</span></span>             |                            |                                    |                          |                                | <span data-ttu-id="8018f-274">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-274">Yes</span></span>                  |                      |
| <span data-ttu-id="8018f-275">Traccia del contatore SQL Server **</span><span class="sxs-lookup"><span data-stu-id="8018f-275">SQL Server counter Trace **</span></span>      |                            |                                    |                          |                                |                      | <span data-ttu-id="8018f-276">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-276">Yes</span></span>                  |
| <span data-ttu-id="8018f-277">Traccia di XPerf</span><span class="sxs-lookup"><span data-stu-id="8018f-277">XPerf Trace</span></span>                      |                            |                                    |                          |                                |                      | <span data-ttu-id="8018f-278">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-278">Yes</span></span>                  |
| <span data-ttu-id="8018f-279">Traccia di StorPort</span><span class="sxs-lookup"><span data-stu-id="8018f-279">StorPort Trace</span></span>                   |                            |                                    |                          |                                |                      | <span data-ttu-id="8018f-280">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-280">Yes</span></span>                  |
| <span data-ttu-id="8018f-281">Traccia di rete</span><span class="sxs-lookup"><span data-stu-id="8018f-281">Network Trace</span></span>                    |                            |                                    |                          |                                | <span data-ttu-id="8018f-282">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-282">Yes</span></span>                  | <span data-ttu-id="8018f-283">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-283">Yes</span></span>                  |
| <span data-ttu-id="8018f-284">Traccia del benchmark diskspd ***</span><span class="sxs-lookup"><span data-stu-id="8018f-284">Diskspd Benchmark trace ***</span></span>      |                            | <span data-ttu-id="8018f-285">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-285">Yes</span></span>                                |                          | <span data-ttu-id="8018f-286">Sì</span><span class="sxs-lookup"><span data-stu-id="8018f-286">Yes</span></span>                            |                      |                      |
|       |                            |                         |                                                   |                      |                      |

### <a name="performance-diagnostics-trace-"></a><span data-ttu-id="8018f-287">Traccia diagnostica delle prestazioni (*)</span><span class="sxs-lookup"><span data-stu-id="8018f-287">Performance Diagnostics trace (*)</span></span>

<span data-ttu-id="8018f-288">Esegue in background un motore basato su regole per raccogliere dati e diagnosticare problemi di prestazioni in corso.</span><span class="sxs-lookup"><span data-stu-id="8018f-288">Runs a rule-based engine in the background to collect data and diagnose ongoing performance issues.</span></span> <span data-ttu-id="8018f-289">Sono attualmente supportate le regole seguenti:</span><span class="sxs-lookup"><span data-stu-id="8018f-289">The following rules are currently supported:</span></span>

- <span data-ttu-id="8018f-290">Regola HighCpuUsage: rileva i periodi di utilizzo della CPU elevato e visualizza i principali consumer di utilizzo della CPU.</span><span class="sxs-lookup"><span data-stu-id="8018f-290">HighCpuUsage rule: Detects high CPU usage periods and shows the top CPU usage consumers during those periods.</span></span>
- <span data-ttu-id="8018f-291">Regola HighDiskUsage: rileva i periodi di utilizzo dei dischi elevato nei dischi fisici e visualizza i principali consumer di utilizzo dei dischi.</span><span class="sxs-lookup"><span data-stu-id="8018f-291">HighDiskUsage rule: Detects high disk usage periods on physical disks and shows the top disk usage consumers during those periods.</span></span>
- <span data-ttu-id="8018f-292">Regola HighResolutionDiskMetric: visualizza le metriche relative a operazioni di I/O al secondo, velocità effettiva e latenza di I/O ogni 50 millisecondi per ogni disco fisico.</span><span class="sxs-lookup"><span data-stu-id="8018f-292">HighResolutionDiskMetric rule: Shows IOPS, throughput and IO latency metrics per 50 milliseconds for each physical disk.</span></span> <span data-ttu-id="8018f-293">Consente di identificare rapidamente i periodi di limitazione.</span><span class="sxs-lookup"><span data-stu-id="8018f-293">It helps to quickly identify disk throttling periods.</span></span>
- <span data-ttu-id="8018f-294">Regola HighMemoryUsage: rileva i periodi di utilizzo della memoria elevato e visualizza i principali consumer di utilizzo della memoria.</span><span class="sxs-lookup"><span data-stu-id="8018f-294">HighMemoryUsage rule: Detects high memory usage periods, and shows the top memory usage consumers during those periods.</span></span>

> [!NOTE] 
> <span data-ttu-id="8018f-295">Sono attualmente supportate le versioni di Windows che includono .NET Framework 3.5 o versioni successive.</span><span class="sxs-lookup"><span data-stu-id="8018f-295">Currently, Windows versions that include the .NET Framework 3.5 or later versions are supported.</span></span>

### <a name="performance-counter-trace-"></a><span data-ttu-id="8018f-296">Traccia dei contatori delle prestazioni (**)</span><span class="sxs-lookup"><span data-stu-id="8018f-296">Performance Counter trace (**)</span></span>

<span data-ttu-id="8018f-297">Raccoglie i contatori delle prestazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="8018f-297">Collects the following Performance Counters:</span></span>

- <span data-ttu-id="8018f-298">\Processo, \Processore, \Memoria, \Thread, \Disco fisico, \Disco logico</span><span class="sxs-lookup"><span data-stu-id="8018f-298">\Process, \Processor, \Memory, \Thread, \PhysicalDisk, \LogicalDisk</span></span>
- <span data-ttu-id="8018f-299">\Cache\Pagine dirty, \Cache\Scritture Lazy scaricate su disco/sec, \Server\Errori in pool non di paging, \Server\Errori in pool di paging</span><span class="sxs-lookup"><span data-stu-id="8018f-299">\Cache\Dirty Pages, \Cache\Lazy Write Flushes/sec, \Server\Pool Nonpaged, Failures, \Server\Pool Paged Failures</span></span>
- <span data-ttu-id="8018f-300">Contatori selezionati in \Interfaccia di rete, \IPv4\Datagrams (Datagrammi), \IPv6\Datagrams (Datagrammi), \TCPv4\Segmenti, \TCPv6\Segmenti, \Scheda di rete, \Piattaforma filtro Windows versione 4\Pacchetti, \Piattaforma filtro Windows versione 6\Pacchetti, \UDPv4\Datagrams (Datagrammi), \UDPv6\Datagrams (Datagrammi), \TCPv4\Connessione, \TCPv6\Connessione, \Criteri QoS di rete\Pacchetti, \Attività scheda di interfaccia di rete per processore, \Microsoft Winsock Base Service Provider</span><span class="sxs-lookup"><span data-stu-id="8018f-300">Selected counters under \Network Interface, \IPv4\Datagrams, \IPv6\Datagrams, \TCPv4\Segments, \TCPv6\Segments,  \Network Adapter, \WFPv4\Packets, \WFPv6\Packets, \UDPv4\Datagrams, \UDPv6\Datagrams, \TCPv4\Connection, \TCPv6\Connection, \Network QoS Policy\Packets, \Per Processor Network Interface Card Activity, \Microsoft Winsock BSP</span></span>

#### <a name="for-sql-server-instances"></a><span data-ttu-id="8018f-301">Per le istanze di SQL Server</span><span class="sxs-lookup"><span data-stu-id="8018f-301">For SQL Server instances</span></span>
- <span data-ttu-id="8018f-302">\SQL Server:Buffer Manager, \SQLServer:Resource Pool Stats, \SQLServer:SQL Statistics\\</span><span class="sxs-lookup"><span data-stu-id="8018f-302">\SQL Server:Buffer Manager, \SQLServer:Resource Pool Stats, \SQLServer:SQL Statistics\\</span></span>
- <span data-ttu-id="8018f-303">\SQLServer:Locks, \SQLServer:General Statistics</span><span class="sxs-lookup"><span data-stu-id="8018f-303">\SQLServer:Locks, \SQLServer:General, Statistics</span></span>
- <span data-ttu-id="8018f-304">\SQLServer:Metodi di accesso</span><span class="sxs-lookup"><span data-stu-id="8018f-304">\SQLServer:Access Methods</span></span>

#### <a name="for-azure-files"></a><span data-ttu-id="8018f-305">Per File di Azure</span><span class="sxs-lookup"><span data-stu-id="8018f-305">For Azure Files</span></span>
<span data-ttu-id="8018f-306">\Condivisioni client SMB</span><span class="sxs-lookup"><span data-stu-id="8018f-306">\SMB Client Shares</span></span>

### <a name="diskspd-benchmark-trace-"></a><span data-ttu-id="8018f-307">Traccia del benchmark diskspd (***)</span><span class="sxs-lookup"><span data-stu-id="8018f-307">Diskspd Benchmark trace (***)</span></span>
<span data-ttu-id="8018f-308">Il carico di lavoro di I/O diskspd testa [disco del sistema operativo (scrittura) e unità di pool (lettura/scrittura)]</span><span class="sxs-lookup"><span data-stu-id="8018f-308">Diskspd IO workload tests [OS Disk (write) and pool drives (read/write)]</span></span>

## <a name="run-the-perfinsights-on-your-vm"></a><span data-ttu-id="8018f-309">Eseguire PerfInsights nella VM</span><span class="sxs-lookup"><span data-stu-id="8018f-309">Run the PerfInsights on your VM</span></span>

### <a name="what-do-i-have-to-know-before-i-run-the-script"></a><span data-ttu-id="8018f-310">Informazioni importanti prima di eseguire lo script</span><span class="sxs-lookup"><span data-stu-id="8018f-310">What do I have to know before I run the script?</span></span> 

<span data-ttu-id="8018f-311">**Requisiti dello script**</span><span class="sxs-lookup"><span data-stu-id="8018f-311">**Script requirements**</span></span>

1.  <span data-ttu-id="8018f-312">Questo script deve essere eseguito nella VM che presenta il problema relativo alle prestazioni.</span><span class="sxs-lookup"><span data-stu-id="8018f-312">This script must be run on the VM that has the performance issue.</span></span> 

2.  <span data-ttu-id="8018f-313">Sono supportati i sistemi operativi seguenti: Windows Server 2008 R2, 2012, 2012 R2 e 2016, Windows 8.1 e Windows 10.</span><span class="sxs-lookup"><span data-stu-id="8018f-313">The following OSes are supported: Windows Server 2008 R2, 2012, 2012 R2, 2016; Windows 8.1 and Windows 10.</span></span>

<span data-ttu-id="8018f-314">**Possibili problemi quando si esegue lo script nelle VM di produzione:**</span><span class="sxs-lookup"><span data-stu-id="8018f-314">**Possible issues when you run the script on production VMs:**</span></span>

1.  <span data-ttu-id="8018f-315">Lo script può influire negativamente sulle prestazioni della VM quando viene usato con lo scenario benchmark o personalizzato, configurato tramite XPerf o DiskSpd.</span><span class="sxs-lookup"><span data-stu-id="8018f-315">The script might adversely affect the performance of the VM when it is used together with the "Benchmark" or "Custom" scenario that is configured by using XPerf or DiskSpd.</span></span> <span data-ttu-id="8018f-316">Prestare attenzione quando si esegue lo script in un ambiente di produzione.</span><span class="sxs-lookup"><span data-stu-id="8018f-316">Be careful when you run the script in a production environment.</span></span>

2.  <span data-ttu-id="8018f-317">Quando si usa lo script con lo scenario benchmark o personalizzato che viene configurato tramite DiskSpd, verificare che nessuna altra attività in background interferisca con il carico di lavoro di I/O nei dischi testati.</span><span class="sxs-lookup"><span data-stu-id="8018f-317">When you use the script together with the "Benchmark" or "Custom" scenario that is configured by using DiskSpd, make sure that no other background activity interferes with the I/O workload on the tested disks.</span></span>

3.  <span data-ttu-id="8018f-318">Per impostazione predefinita, lo script usa l'unità di archiviazione temporanea per raccogliere i dati.</span><span class="sxs-lookup"><span data-stu-id="8018f-318">By default, the script uses the temporary storage drive to collect data.</span></span> <span data-ttu-id="8018f-319">Se la traccia rimane abilitata per un periodo più lungo, la quantità di dati raccolti potrebbe essere rilevante.</span><span class="sxs-lookup"><span data-stu-id="8018f-319">If tracing stays enabled for a longer time, the amount of data that is collected might be relevant.</span></span> <span data-ttu-id="8018f-320">Ciò può ridurre la disponibilità di spazio nel disco temporaneo, influendo così sulle applicazioni che si basano su questa unità.</span><span class="sxs-lookup"><span data-stu-id="8018f-320">This can reduce the availability of space on the temporary disk, therefore affecting any application that relies on this drive.</span></span>

### <a name="how-do-i-run-perfinsights"></a><span data-ttu-id="8018f-321">Come si esegue PerfInsights</span><span class="sxs-lookup"><span data-stu-id="8018f-321">How do I run PerfInsights?</span></span> 

<span data-ttu-id="8018f-322">Per eseguire lo script, seguire questa procedura:</span><span class="sxs-lookup"><span data-stu-id="8018f-322">To run the script, follow these steps:</span></span>

1. <span data-ttu-id="8018f-323">Scaricare [PerfInsights.zip](http://aka.ms/perfinsightsdownload).</span><span class="sxs-lookup"><span data-stu-id="8018f-323">Download [PerfInsights.zip](http://aka.ms/perfinsightsdownload).</span></span>

2. <span data-ttu-id="8018f-324">Sbloccare il file PerfInsights.zip</span><span class="sxs-lookup"><span data-stu-id="8018f-324">Unblock the PerfInsights.zip file.</span></span> <span data-ttu-id="8018f-325">facendo clic con il pulsante destro del mouse sul file PerfInsights.zip e scegliendo **Proprietà**.</span><span class="sxs-lookup"><span data-stu-id="8018f-325">To do this, right-click the PerfInsights.zip file, select **Properties**.</span></span> <span data-ttu-id="8018f-326">Nella scheda **Generale** selezionare **Annulla blocco** e quindi fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="8018f-326">In the **General** tab, select **Unblock** and then select **OK**.</span></span> <span data-ttu-id="8018f-327">In tal modo, lo script verrà eseguito senza altri prompt di sicurezza.</span><span class="sxs-lookup"><span data-stu-id="8018f-327">This will make sure that the script runs without any additional security prompts.</span></span>  

    ![Sbloccare il file con estensione zip](media/how-to-use-perfInsights/unlock-file.png)

3.  <span data-ttu-id="8018f-329">Espandere il file PerfInsights.zip compresso nell'unità temporanea (per impostazione predefinita, in genere l'unità D).</span><span class="sxs-lookup"><span data-stu-id="8018f-329">Expand the compressed PerfInsights.zip file into your temporary drive (by default, usually the D drive).</span></span> <span data-ttu-id="8018f-330">Il file compresso conterrà i file e le cartelle seguenti:</span><span class="sxs-lookup"><span data-stu-id="8018f-330">The compressed file should contain the following files and folders:</span></span>

    ![File nella cartella ZIP](media/how-to-use-perfInsights/file-folder.png)

4.  <span data-ttu-id="8018f-332">Aprire Windows PowerShell come amministratore e quindi eseguire lo script PerfInsights.ps1.</span><span class="sxs-lookup"><span data-stu-id="8018f-332">Open Windows PowerShell as an administrator, and then run the PerfInsights.ps1 script.</span></span>

    ```
    cd <the path of PerfInsights folder >
    Powershell.exe -ExecutionPolicy UnRestricted -NoProfile -File .\\PerfInsights.ps1
    ```

    <span data-ttu-id="8018f-333">Potrebbe essere necessario immettere "y" se viene chiesto di confermare che si vuole modificare il criterio di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="8018f-333">You might have to enter "y" to if you are asked to confirm that you want to change the execution policy.</span></span>

    <span data-ttu-id="8018f-334">Nella finestra di dialogo Dichiarazione di non responsabilità, è presente l'opzione per condividere le informazioni diagnostiche con il supporto tecnico Microsoft.</span><span class="sxs-lookup"><span data-stu-id="8018f-334">In the Disclaimer dialog box, you are given the option to share diagnostic information with Microsoft Support.</span></span> <span data-ttu-id="8018f-335">È anche necessario dare il consenso al contratto di licenza per continuare.</span><span class="sxs-lookup"><span data-stu-id="8018f-335">You must also consent to the license agreement to continue.</span></span> <span data-ttu-id="8018f-336">Verificare le selezioni e quindi fare clic su **Esegui script**.</span><span class="sxs-lookup"><span data-stu-id="8018f-336">Make your selections, and then click **Run Script**.</span></span>

    ![Finestra di dialogo Dichiarazione di non responsabilità](media/how-to-use-perfInsights/disclaimer.png)

5.  <span data-ttu-id="8018f-338">Quando si esegue lo script, se disponibile, inviare il numero di caso, che verrà usato per le statistiche Microsoft.</span><span class="sxs-lookup"><span data-stu-id="8018f-338">Submit the case number, if it is available, when you run the script (This is for our statistics).</span></span> <span data-ttu-id="8018f-339">Fare quindi clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="8018f-339">Then, click **OK**.</span></span>
    
    ![Immettere l'ID di supporto](media/how-to-use-perfInsights/enter-support-number.png)

6.  <span data-ttu-id="8018f-341">Selezionare l'unità di archiviazione temporanea.</span><span class="sxs-lookup"><span data-stu-id="8018f-341">Select your temporary storage drive.</span></span> <span data-ttu-id="8018f-342">Lo script può rilevare automaticamente la lettera di unità.</span><span class="sxs-lookup"><span data-stu-id="8018f-342">The Script can auto-detect the drive letter of the drive.</span></span> <span data-ttu-id="8018f-343">Se si verificano problemi in questa fase, potrebbe venire chiesto di selezionare l'unità. L'unità predefinita è D.</span><span class="sxs-lookup"><span data-stu-id="8018f-343">If any problems occur in this stage, you might be prompted to select the drive (the default drive is D).</span></span> <span data-ttu-id="8018f-344">I log generati vengono archiviati qui, nella cartella log\_collection.</span><span class="sxs-lookup"><span data-stu-id="8018f-344">Generated logs are stored here in the log\_collection folder.</span></span> <span data-ttu-id="8018f-345">Dopo avere immesso o accettato la lettera di unità, fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="8018f-345">After you enter or accept the drive letter, click **OK**.</span></span>

    ![Immettere l'unità](media/how-to-use-perfInsights/enter-drive.png)

7.  <span data-ttu-id="8018f-347">Selezionare uno scenario di risoluzione dei problemi dall'elenco fornito.</span><span class="sxs-lookup"><span data-stu-id="8018f-347">Select a troubleshooting scenario from the provided list.</span></span>

       ![Selezionare gli scenari di supporto](media/how-to-use-perfInsights/select-scenarios.png)

8.  <span data-ttu-id="8018f-349">È anche possibile eseguire PerfInsights senza l'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="8018f-349">You can also run PerfInsights without UI.</span></span>

    <span data-ttu-id="8018f-350">Il comando seguente esegue lo scenario di risoluzione dei problemi "Analisi generale della VM lenta" senza prompt dell'interfaccia utente o acquisizione di dati per 30 secondi.</span><span class="sxs-lookup"><span data-stu-id="8018f-350">The following command runs the "General VM Slow analysis" troubleshooting scenario without a UI prompt or capture data for 30 seconds.</span></span> <span data-ttu-id="8018f-351">Viene chiesto il consenso per la stessa dichiarazione di non responsabilità e le stesse condizioni di licenza citate nel passaggio 4.</span><span class="sxs-lookup"><span data-stu-id="8018f-351">It prompts you to consent to the same disclaimer and EULA that  are mentioned in step 4.</span></span>

        powershell.exe -ExecutionPolicy UnRestricted -NoProfile -Command ".\\PerfInsights.ps1 -NoGui -Scenario vmslow -TracingDuration 30"

    <span data-ttu-id="8018f-352">Per eseguire PerfInsights in modalità non interattiva, usare il parametro **-AcceptDisclaimerAndShareDiagnostics**.</span><span class="sxs-lookup"><span data-stu-id="8018f-352">If you want PerfInsights to run in silent mode, use the **-AcceptDisclaimerAndShareDiagnostics** parameter.</span></span> <span data-ttu-id="8018f-353">Ad esempio, usare il comando seguente:</span><span class="sxs-lookup"><span data-stu-id="8018f-353">For example, use the following command:</span></span>

        powershell.exe -ExecutionPolicy UnRestricted -NoProfile -Command ".\\PerfInsights.ps1 -NoGui -Scenario vmslow -TracingDuration 30 -AcceptDisclaimerAndShareDiagnostics"

### <a name="how-do-i-troubleshoot-issues-while-running-the-script"></a><span data-ttu-id="8018f-354">Come risolvere i problemi durante l'esecuzione dello script</span><span class="sxs-lookup"><span data-stu-id="8018f-354">How do I troubleshoot issues while running the script?</span></span>

<span data-ttu-id="8018f-355">Se lo script viene terminato in modo anomalo, è possibile pulire uno stato non coerente eseguendo lo script con l'opzione -Cleanup, come segue:</span><span class="sxs-lookup"><span data-stu-id="8018f-355">If the script terminates abnormally, you can clean up an inconsistent state by running the script together with the -Cleanup switch, as follows:</span></span>

    powershell.exe -ExecutionPolicy UnRestricted -NoProfile -Command ".\\PerfInsights.ps1 -Cleanup"

<span data-ttu-id="8018f-356">Se si verificano problemi durante il rilevamento automatico dell'unità temporanea, potrebbe venire chiesto di selezionare l'unità. L'unità predefinita è D.</span><span class="sxs-lookup"><span data-stu-id="8018f-356">If any problems occur during the automatic detection of the temporary drive, you might be prompted to select the drive (the default drive is D).</span></span>

![Immettere l'unità](media/how-to-use-perfInsights/enter-drive.png)

<span data-ttu-id="8018f-358">Lo script disinstalla gli strumenti dell'utilità e rimuove le cartelle temporanee.</span><span class="sxs-lookup"><span data-stu-id="8018f-358">The script uninstalls the utility tools and removes temporary folders.</span></span>

### <a name="troubleshooting-other-script-issues"></a><span data-ttu-id="8018f-359">Risoluzione di altri problemi di script</span><span class="sxs-lookup"><span data-stu-id="8018f-359">Troubleshooting other script issues</span></span> 

<span data-ttu-id="8018f-360">Se si verificano problemi quando si esegue lo script, premere CTRL+C per interrompere l'esecuzione dello script.</span><span class="sxs-lookup"><span data-stu-id="8018f-360">If any problems occur when you run the script, press Ctrl+C to interrupt the script execution.</span></span> <span data-ttu-id="8018f-361">Per rimuovere gli oggetti temporanei, vedere la sezione "Pulizia dopo una terminazione anomala".</span><span class="sxs-lookup"><span data-stu-id="8018f-361">To remove temporary objects, see the "Clean up after abnormal termination" section.</span></span>

<span data-ttu-id="8018f-362">Se si continuano a verificare errori di script anche dopo più tentativi, è consigliabile eseguire lo script in "modalità di debug" usando l'opzione del parametro "-Debug" all'avvio.</span><span class="sxs-lookup"><span data-stu-id="8018f-362">If you continue to experience script failure even after several attempts, we recommend that you run the script in "debug mode" by using the "-Debug" parameter option on startup.</span></span>

<span data-ttu-id="8018f-363">Quando si verifica l'errore, copiare l'output completo della console di PowerShell e inviarlo all'agente del supporto tecnico Microsoft che sta prestando assistenza nella risoluzione del problema.</span><span class="sxs-lookup"><span data-stu-id="8018f-363">After the failure occurs, copy the full output of the PowerShell console, and send it to the Microsoft Support agent who is assisting you to help troubleshoot the problem.</span></span>

### <a name="how-do-i-run-the-script-in-custom-configuration-mode"></a><span data-ttu-id="8018f-364">Come si esegue lo script nella modalità di configurazione personalizzata</span><span class="sxs-lookup"><span data-stu-id="8018f-364">How do I run the script in custom configuration mode?</span></span>

<span data-ttu-id="8018f-365">Selezionando la configurazione **Personalizzata**, è possibile abilitare più tracce in parallelo. Usare MAIUSC per la selezione multipla:</span><span class="sxs-lookup"><span data-stu-id="8018f-365">By selecting the **Custom** configuration, you can enable several traces in parallel (use Shift to multi-select):</span></span>

![Selezionare gli scenari](media/how-to-use-perfInsights/select-scenario.png)

<span data-ttu-id="8018f-367">Quando si selezionano gli scenari di diagnostica delle prestazioni, traccia dei contatori delle prestazioni, traccia di XPerf, traccia di rete o traccia di StorPort, seguire le istruzioni delle finestre di dialogo e provare a riprodurre il problema del rallentamento delle prestazioni dopo avere avviato le tracce.</span><span class="sxs-lookup"><span data-stu-id="8018f-367">When you select the Performance Diagnostics, Performance Counter Trace, XPerf Trace, Network Trace, or Storport Trace scenarios, follow the instructions in the dialog boxes, and try to reproduce the slow performance issue after you start the traces.</span></span>

<span data-ttu-id="8018f-368">La finestra di dialogo seguente consente di avviare una traccia:</span><span class="sxs-lookup"><span data-stu-id="8018f-368">The following dialog box lets you start a trace:</span></span>

![Avviare una traccia](media/how-to-use-perfInsights/start-trace-message.png)

<span data-ttu-id="8018f-370">Per arrestare le tracce, è necessario confermare il comando in una seconda finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="8018f-370">To stop the traces, you have to confirm the command in a second dialog box.</span></span>

<span data-ttu-id="8018f-371">![Arrestare una traccia](media/how-to-use-perfInsights/stop-trace-message.png)
![Arrestare una traccia](media/how-to-use-perfInsights/ok-trace-message.png)</span><span class="sxs-lookup"><span data-stu-id="8018f-371">![stop-trace](media/how-to-use-perfInsights/stop-trace-message.png)
![stop-trace](media/how-to-use-perfInsights/ok-trace-message.png)</span></span>

<span data-ttu-id="8018f-372">Quando le tracce o le operazioni vengono completate, viene generato un nuovo file in D:\\log\_collection (o nell'unità temporanea) denominato **CollectedData\_aaaa-MM-gg\_hh\_mm\_ss.zip.**</span><span class="sxs-lookup"><span data-stu-id="8018f-372">When the traces or operations are completed, a new file is generated in D:\\log\_collection (or the temporary drive) that is named **CollectedData\_yyyy-MM-dd\_hh\_mm\_ss.zip.**</span></span> <span data-ttu-id="8018f-373">È possibile inviare il file all'agente di supporto per l'analisi.</span><span class="sxs-lookup"><span data-stu-id="8018f-373">You can send this file to the Support agent for analysis.</span></span>

## <a name="review-the-diagnostics-report-created-by-perfinsights"></a><span data-ttu-id="8018f-374">Esaminare il report di diagnostica creato da PerfInsights</span><span class="sxs-lookup"><span data-stu-id="8018f-374">Review the diagnostics report created by PerfInsights</span></span>

<span data-ttu-id="8018f-375">Nel file **CollectedData\_aaaa-MM-gg\_hh\_mm\_ss.zip,** generato da PerfInsights, è possibile trovare un report HTML che elenca in dettaglio i risultati di PerfInsights.</span><span class="sxs-lookup"><span data-stu-id="8018f-375">Within the **CollectedData\_yyyy-MM-dd\_hh\_mm\_ss.zip file,** that is generated by PerfInsights, you can find an HTML report that details the findings of PerfInsights.</span></span> <span data-ttu-id="8018f-376">Per esaminare il report, espandere il file **CollectedData\_aaaa-MM-gg\_hh\_mm\_ss.zip** e quindi aprire il file **PerfInsights Report.html**.</span><span class="sxs-lookup"><span data-stu-id="8018f-376">To review the report, expand the **CollectedData\_yyyy-MM-dd\_hh\_mm\_ss.zip** file, and then open the **PerfInsights Report.html** file.</span></span>

<span data-ttu-id="8018f-377">Selezionare la scheda **Risultati**.</span><span class="sxs-lookup"><span data-stu-id="8018f-377">Select the **Findings** tab.</span></span>

![Scheda Risultati](media/how-to-use-perfInsights/findingtab.png)

<span data-ttu-id="8018f-379">**Note**</span><span class="sxs-lookup"><span data-stu-id="8018f-379">**Notes**</span></span>

-   <span data-ttu-id="8018f-380">I messaggi in rosso sono problemi di configurazione noti che possono causare problemi di prestazioni.</span><span class="sxs-lookup"><span data-stu-id="8018f-380">Messages in red are known configuration issues that may cause performance issues.</span></span>

-   <span data-ttu-id="8018f-381">I messaggi in giallo sono avvisi che rappresentano configurazioni non ottimali che non necessariamente causano problemi di prestazioni.</span><span class="sxs-lookup"><span data-stu-id="8018f-381">Messages in yellow are warnings that represent non-optimal configurations that do not necessarily cause performance issues.</span></span>

-   <span data-ttu-id="8018f-382">I messaggi in blu sono solo istruzioni informative.</span><span class="sxs-lookup"><span data-stu-id="8018f-382">Messages in blue are informative statements only.</span></span>

<span data-ttu-id="8018f-383">Esaminare i collegamenti HTTP per tutti i messaggi di errore in rosso per ottenere informazioni più dettagliate sui risultati e sulle possibili conseguenze sulle prestazioni o sulle procedure consigliate per le configurazioni ottimizzate per le prestazioni.</span><span class="sxs-lookup"><span data-stu-id="8018f-383">Review the HTTP links for all error messages in red to get more detailed information about the findings and how they can affect the performance or best practices for performance-optimized configurations.</span></span>

### <a name="disk-configuration-tab"></a><span data-ttu-id="8018f-384">Scheda Disk Configuration (Configurazione dei dischi)</span><span class="sxs-lookup"><span data-stu-id="8018f-384">Disk Configuration Tab</span></span>

<span data-ttu-id="8018f-385">La sezione **Panoramica** visualizza diverse viste della configurazione di archiviazione, incluse le informazioni provenienti da Diskpart e Spazi di archiviazione</span><span class="sxs-lookup"><span data-stu-id="8018f-385">The **Overview** section displays different views of the storage configuration, including information from Diskpart and Storage Spaces</span></span>

<span data-ttu-id="8018f-386">Le sezioni **DiskMap** e **VolumeMap** descrivono da un duplice punto di vista la correlazione tra i volumi logici e i dischi fisici.</span><span class="sxs-lookup"><span data-stu-id="8018f-386">The **DiskMap** and **VolumeMap** sections describe on a dual perspective how logical volumes and physical disks are related to each other.</span></span>

<span data-ttu-id="8018f-387">Dal punto di vista di PhysicalDisk (DiskMap), la tabella visualizza tutti i volumi logici in esecuzione sul disco.</span><span class="sxs-lookup"><span data-stu-id="8018f-387">In the PhysicalDisk perspective (DiskMap), the table shows all logical volumes that are running on the disk.</span></span> <span data-ttu-id="8018f-388">Nell'esempio seguente PhysicalDrive2 esegue 2 volumi logici creati in più partizioni (J e H):</span><span class="sxs-lookup"><span data-stu-id="8018f-388">In the following example, PhysicalDrive2 runs 2 Logical Volumes created on multiple partitions (J and H):</span></span>

![Scheda dati](media/how-to-use-perfInsights/disktab.png)

<span data-ttu-id="8018f-390">Dal punto di vista del volume (*VolumeMap*), le tabelle visualizzano tutti i dischi fisici in ogni volume logico.</span><span class="sxs-lookup"><span data-stu-id="8018f-390">In the Volume perspective (*VolumeMap*), the tables show all the physical disks under each logical volume.</span></span> <span data-ttu-id="8018f-391">Si noti che per i dischi RAID/dinamici è possibile eseguire un volume logico in più dischi fisici.</span><span class="sxs-lookup"><span data-stu-id="8018f-391">Notice that for RAID/Dynamic disks, you might run a logical volume upon multiple physical disks.</span></span> <span data-ttu-id="8018f-392">Nell'esempio seguente *C:\\mount* è un punto di montaggio configurato come *SpannedDisk* nei dischi fisici \#2 e \#3:</span><span class="sxs-lookup"><span data-stu-id="8018f-392">In the following sample *C:\\mount* is a mountpoint configured as *SpannedDisk* on PhysicalDisks \#2 and \#3:</span></span>

![Scheda Volume](media/how-to-use-perfInsights/volumetab.png)

### <a name="sql-server-tab"></a><span data-ttu-id="8018f-394">Scheda SQL Server</span><span class="sxs-lookup"><span data-stu-id="8018f-394">SQL Server tab</span></span>

<span data-ttu-id="8018f-395">Se la VM di destinazione ospita istanze di SQL Server, nel report verrà visualizzata una scheda aggiuntiva denominata **SQL Server**:</span><span class="sxs-lookup"><span data-stu-id="8018f-395">If the target VM hosts any SQL Server instances, you will see an additional tab in the report that is named **SQL Server**:</span></span>

![Scheda per SQL](media/how-to-use-perfInsights/sqltab.png)

<span data-ttu-id="8018f-397">Questa sezione contiene una scheda "Panoramica" e altre schede secondarie per ogni istanza di SQL Server ospitata nella VM.</span><span class="sxs-lookup"><span data-stu-id="8018f-397">This section contains an "Overview" and additional sub tabs for each of the SQL Server instances hosted on the VM.</span></span>

<span data-ttu-id="8018f-398">La sezione "Panoramica" contiene un'utile tabella che riepiloga tutti i dischi fisici (dischi di sistema e dati) in esecuzione e contiene una combinazione di file di dati e di file di log delle transazioni.</span><span class="sxs-lookup"><span data-stu-id="8018f-398">The "Overview" section contains a helpful table that summarizes all the physical disks (system and data disks) that are running and that contain a mixture of data files and transaction log files.</span></span>

<span data-ttu-id="8018f-399">Nell'esempio seguente viene visualizzato *PhysicalDrive0* (che esegue l'unità C) perché entrambi i file *modeldev* e *modellog* si trovano nell'unità C e sono di tipo diverso (rispettivamente file di dati e log delle transazioni):</span><span class="sxs-lookup"><span data-stu-id="8018f-399">In the following example, *PhysicalDrive0* (running the C drive) is displayed because both the *modeldev* and *modellog* files are located on the C drive, and they are of different types (such as Data File and Transaction Log, respectively):</span></span>

![Informazioni sui log](media/how-to-use-perfInsights/loginfo.png)

<span data-ttu-id="8018f-401">Le schede specifiche delle istanze di SQL Server contengono una sezione generale che visualizza le informazioni di base sull'istanza selezionata e altre sezioni per le informazioni avanzate, incluse impostazioni, configurazioni e opzioni utente.</span><span class="sxs-lookup"><span data-stu-id="8018f-401">The SQL Server instance-specific tabs contain a general section that displays basic information about the selected instance and additional sections for advanced information, including Settings, Configurations, and User Options.</span></span>

## <a name="references-to-the-external-tools-used"></a><span data-ttu-id="8018f-402">Informazioni di riferimento sugli strumenti esterni usati</span><span class="sxs-lookup"><span data-stu-id="8018f-402">References to the external tools used</span></span>

### <a name="diskspd"></a><span data-ttu-id="8018f-403">Diskspd</span><span class="sxs-lookup"><span data-stu-id="8018f-403">Diskspd</span></span>

<span data-ttu-id="8018f-404">DISKSPD è un generatore di carico di archiviazione e uno strumento di test delle prestazioni dei team di progettazione di Windows, Windows Server e dell'infrastruttura server cloud.</span><span class="sxs-lookup"><span data-stu-id="8018f-404">DISKSPD is a storage load generator and performance test tool from the Windows and Windows Server and Cloud Server Infrastructure engineering teams.</span></span> <span data-ttu-id="8018f-405">Per altre informazioni, vedere [Diskspd](https://github.com/Microsoft/diskspd).</span><span class="sxs-lookup"><span data-stu-id="8018f-405">For more information, see [Diskspd](https://github.com/Microsoft/diskspd).</span></span>

### <a name="xperf"></a><span data-ttu-id="8018f-406">XPerf</span><span class="sxs-lookup"><span data-stu-id="8018f-406">XPerf</span></span>

<span data-ttu-id="8018f-407">Xperf è uno strumento da riga di comando per acquisire tracce da Windows Performance Toolkit.</span><span class="sxs-lookup"><span data-stu-id="8018f-407">Xperf is a command-line tool to capture traces from the Windows Performance Tools Kit.</span></span>

<span data-ttu-id="8018f-408">Per altre informazioni, vedere [Windows Performance Toolkit – Xperf](https://blogs.msdn.microsoft.com/ntdebugging/2008/04/03/windows-performance-toolkit-xperf/) (Windows Performance Toolkit - Xperf).</span><span class="sxs-lookup"><span data-stu-id="8018f-408">For more information, see [Windows Performance Toolkit – Xperf](https://blogs.msdn.microsoft.com/ntdebugging/2008/04/03/windows-performance-toolkit-xperf/).</span></span>

## <a name="next-steps"></a><span data-ttu-id="8018f-409">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="8018f-409">Next Steps</span></span>

### <a name="upload-diagnostics-logs-and-reports-to-microsoft-support-for-further-review"></a><span data-ttu-id="8018f-410">Caricare log di diagnostica e report per il supporto tecnico Microsoft per ulteriori analisi</span><span class="sxs-lookup"><span data-stu-id="8018f-410">Upload diagnostics logs and reports to Microsoft Support for further review</span></span>

<span data-ttu-id="8018f-411">Quando si collabora con il personale del supporto tecnico Microsoft, potrebbe venire chiesto di trasmettere l'output generato da PerfInsights per facilitare il processo di risoluzione dei problemi.</span><span class="sxs-lookup"><span data-stu-id="8018f-411">When you work with the Microsoft Support staff, you may be requested to transmit the output that is generated by PerfInsights to assist the troubleshooting process.</span></span>

<span data-ttu-id="8018f-412">L'agente del supporto creerà un'area di lavoro DTM e si riceverà un messaggio di posta elettronica che include un collegamento al portale DTM (https://filetransfer.support.microsoft.com/EFTClient/Account/Login.htm), un ID utente univoco e una password.</span><span class="sxs-lookup"><span data-stu-id="8018f-412">The Support agent will create a DTM workspace for you, and you will receive an email message that includes a link to the [DTM portal (https://filetransfer.support.microsoft.com/EFTClient/Account/Login.htm) and a unique user ID and password.</span></span>

<span data-ttu-id="8018f-413">Questo messaggio verrà inviato da **CTS Automated Diagnostics Services** (ctsadiag@microsoft.com).</span><span class="sxs-lookup"><span data-stu-id="8018f-413">This message will be sent from **CTS Automated Diagnostics Services** (ctsadiag@microsoft.com).</span></span>

![Esempio di messaggio](media/how-to-use-perfInsights/supportemail.png)

<span data-ttu-id="8018f-415">Per maggiore sicurezza, verrà chiesto di cambiare la password al primo uso.</span><span class="sxs-lookup"><span data-stu-id="8018f-415">For additional security, you will be required to change your password on first use.</span></span>

<span data-ttu-id="8018f-416">Dopo l'accesso a DTM, verrà visualizzata una finestra di dialogo per caricare il file **CollectedData\_aaaa-MM-gg\_hh\_mm\_ss.zip** raccolto da PerfInsights.</span><span class="sxs-lookup"><span data-stu-id="8018f-416">After you log in to DTM, you will find a dialog box to upload the **CollectedData\_yyyy-MM-dd\_hh\_mm\_ss.zip** file that was collected by PerfInsights.</span></span>
