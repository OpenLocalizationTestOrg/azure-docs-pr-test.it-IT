---
title: "aaaMoving dati tra database cloud di scalabilità orizzontale | Documenti Microsoft"
description: "Illustra la modalità di partizioni toomanipulate e spostare i dati tramite un servizio indipendente elastica utilizzando le API di database."
services: sql-database
documentationcenter: 
manager: jhubbard
author: ddove
ms.assetid: 204fd902-0397-4185-985a-dea3ed7c7d9f
ms.service: sql-database
ms.custom: scale out apps
ms.workload: sql-database
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 10/24/2016
ms.author: ddove
ms.openlocfilehash: 629dee06e22609e9b61edf93ba5c38d997132d8c
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/06/2017
---
# <a name="moving-data-between-scaled-out-cloud-databases"></a><span data-ttu-id="d0af4-103">Spostamento di dati tra database cloud con scalabilità orizzontale</span><span class="sxs-lookup"><span data-stu-id="d0af4-103">Moving data between scaled-out cloud databases</span></span>
<span data-ttu-id="d0af4-104">Se si è un Software come un sviluppatore del servizio e improvvisamente app sottoposto a grande richiesta, è necessario crescita hello tooaccommodate.</span><span class="sxs-lookup"><span data-stu-id="d0af4-104">If you are a Software as a Service developer, and suddenly your app undergoes tremendous demand, you need tooaccommodate hello growth.</span></span> <span data-ttu-id="d0af4-105">A tale scopo aggiungerà altri database (partizioni).</span><span class="sxs-lookup"><span data-stu-id="d0af4-105">So you add more databases (shards).</span></span> <span data-ttu-id="d0af4-106">Come si ridistribuire hello dati toohello i nuovi database senza compromettere l'integrità dei dati di hello?</span><span class="sxs-lookup"><span data-stu-id="d0af4-106">How do you redistribute hello data toohello new databases without disrupting hello data integrity?</span></span> <span data-ttu-id="d0af4-107">Hello utilizzare **strumento di merge di divisione** dati toomove vincolata database toohello nuovi database.</span><span class="sxs-lookup"><span data-stu-id="d0af4-107">Use hello **split-merge tool** toomove data from constrained databases toohello new databases.</span></span>  

<span data-ttu-id="d0af4-108">strumento di unione di menu combinato Hello viene eseguito come servizio web di Azure.</span><span class="sxs-lookup"><span data-stu-id="d0af4-108">hello split-merge tool runs as an Azure web service.</span></span> <span data-ttu-id="d0af4-109">Un amministratore o lo sviluppatore utilizza hello strumento toomove shardlet (dati da una partizione) tra i diversi database (partizioni).</span><span class="sxs-lookup"><span data-stu-id="d0af4-109">An administrator or developer uses hello tool toomove shardlets (data from a shard) between different databases (shards).</span></span> <span data-ttu-id="d0af4-110">strumento Hello utilizza partizioni mappa toomaintain hello metadati database del servizio Gestione e verificare i mapping coerenti.</span><span class="sxs-lookup"><span data-stu-id="d0af4-110">hello tool uses shard map management toomaintain hello service metadata database, and ensure consistent mappings.</span></span>

![Panoramica][1]

## <a name="download"></a><span data-ttu-id="d0af4-112">Download</span><span class="sxs-lookup"><span data-stu-id="d0af4-112">Download</span></span>
[<span data-ttu-id="d0af4-113">Microsoft.Azure.SqlDatabase.ElasticScale.Service.SplitMerge</span><span class="sxs-lookup"><span data-stu-id="d0af4-113">Microsoft.Azure.SqlDatabase.ElasticScale.Service.SplitMerge</span></span>](http://www.nuget.org/packages/Microsoft.Azure.SqlDatabase.ElasticScale.Service.SplitMerge/)

## <a name="documentation"></a><span data-ttu-id="d0af4-114">Documentazione</span><span class="sxs-lookup"><span data-stu-id="d0af4-114">Documentation</span></span>
1. [<span data-ttu-id="d0af4-115">Esercitazione relativa allo strumento divisione-unione del database elastico</span><span class="sxs-lookup"><span data-stu-id="d0af4-115">Elastic database Split-Merge tool tutorial</span></span>](sql-database-elastic-scale-configure-deploy-split-and-merge.md)
2. [<span data-ttu-id="d0af4-116">Configurazione della sicurezza dei servizi di "split and merge"</span><span class="sxs-lookup"><span data-stu-id="d0af4-116">Split-Merge security configuration</span></span>](sql-database-elastic-scale-split-merge-security-configuration.md)
3. [<span data-ttu-id="d0af4-117">Considerazioni sulla sicurezza dello strumento di suddivisione-unione</span><span class="sxs-lookup"><span data-stu-id="d0af4-117">Split-merge security considerations</span></span>](sql-database-elastic-scale-split-merge-security-configuration.md)
4. [<span data-ttu-id="d0af4-118">Gestione mappe partizioni</span><span class="sxs-lookup"><span data-stu-id="d0af4-118">Shard map management</span></span>](sql-database-elastic-scale-shard-map-management.md)
5. [<span data-ttu-id="d0af4-119">Eseguire la migrazione di database esistente tooscale-out</span><span class="sxs-lookup"><span data-stu-id="d0af4-119">Migrate existing databases tooscale-out</span></span>](sql-database-elastic-convert-to-use-elastic-tools.md)
6. [<span data-ttu-id="d0af4-120">Strumenti di database elastici</span><span class="sxs-lookup"><span data-stu-id="d0af4-120">Elastic database tools</span></span>](sql-database-elastic-scale-introduction.md)
7. [<span data-ttu-id="d0af4-121">Glossario sugli strumenti di database elastici</span><span class="sxs-lookup"><span data-stu-id="d0af4-121">Elastic Database tools glossary</span></span>](sql-database-elastic-scale-glossary.md)

## <a name="why-use-hello-split-merge-tool"></a><span data-ttu-id="d0af4-122">Perché utilizzare lo strumento di unione di menu combinato hello?</span><span class="sxs-lookup"><span data-stu-id="d0af4-122">Why use hello split-merge tool?</span></span>
<span data-ttu-id="d0af4-123">**Flessibilità**</span><span class="sxs-lookup"><span data-stu-id="d0af4-123">**Flexibility**</span></span>

<span data-ttu-id="d0af4-124">Le applicazioni devono toostretch in modo flessibile oltre i limiti di hello di un singolo database di database SQL di Azure.</span><span class="sxs-lookup"><span data-stu-id="d0af4-124">Applications need toostretch flexibly beyond hello limits of a single Azure SQL DB database.</span></span> <span data-ttu-id="d0af4-125">Utilizzare i dati di toomove strumento hello come i database necessari toonew mantenendo l'integrità.</span><span class="sxs-lookup"><span data-stu-id="d0af4-125">Use hello tool toomove data as needed toonew databases while retaining integrity.</span></span>

<span data-ttu-id="d0af4-126">**Split toogrow**</span><span class="sxs-lookup"><span data-stu-id="d0af4-126">**Split toogrow**</span></span> 

<span data-ttu-id="d0af4-127">È necessario tooincrease complessivo rapida crescita delle toohandle capacità.</span><span class="sxs-lookup"><span data-stu-id="d0af4-127">You need tooincrease overall capacity toohandle explosive growth.</span></span> <span data-ttu-id="d0af4-128">toodo, creare capacità aggiuntiva dai dati di partizionamento orizzontale hello e distribuendolo tra i database in modo incrementale più fino a quando non sono soddisfatte esigenze di capacità.</span><span class="sxs-lookup"><span data-stu-id="d0af4-128">toodo so, create additional capacity by sharding hello data and by distributing it across incrementally more databases until capacity needs are fulfilled.</span></span> <span data-ttu-id="d0af4-129">Questo è un esempio di funzione 'split' hello.</span><span class="sxs-lookup"><span data-stu-id="d0af4-129">This is a prime example of hello ‘split’ feature.</span></span> 

<span data-ttu-id="d0af4-130">**Merge tooshrink**</span><span class="sxs-lookup"><span data-stu-id="d0af4-130">**Merge tooshrink**</span></span>

<span data-ttu-id="d0af4-131">Capacità è necessario compattare scadenza toohello carattere stagionale di un'azienda.</span><span class="sxs-lookup"><span data-stu-id="d0af4-131">Capacity needs shrink due toohello seasonal nature of a business.</span></span> <span data-ttu-id="d0af4-132">unità di scala Hello strumento consente che ridurre toofewer quando business rallenta.</span><span class="sxs-lookup"><span data-stu-id="d0af4-132">hello tool lets you scale down toofewer scale units when business slows.</span></span> <span data-ttu-id="d0af4-133">funzionalità 'merge' Hello hello scalabilità elastica suddivisione unione servizio descrive questo requisito.</span><span class="sxs-lookup"><span data-stu-id="d0af4-133">hello ‘merge’ feature in hello Elastic Scale split-merge Service covers this requirement.</span></span> 

<span data-ttu-id="d0af4-134">**Gestire gli hotspot mediante lo spostamento di shardlet**</span><span class="sxs-lookup"><span data-stu-id="d0af4-134">**Manage hotspots by moving shardlets**</span></span>

<span data-ttu-id="d0af4-135">Con più tenant per ogni database, allocazione hello di shardlet tooshards può causare colli di bottiglia toocapacity su alcune partizioni.</span><span class="sxs-lookup"><span data-stu-id="d0af4-135">With multiple tenants per database, hello allocation of shardlets tooshards can lead toocapacity bottlenecks on some shards.</span></span> <span data-ttu-id="d0af4-136">È necessario allocare nuovamente gli shardlet o lo spostamento toonew shardlet occupato o meno utilizzate partizioni.</span><span class="sxs-lookup"><span data-stu-id="d0af4-136">This requires re-allocating shardlets or moving busy shardlets toonew or less utilized shards.</span></span> 

## <a name="concepts--key-features"></a><span data-ttu-id="d0af4-137">Concetti e funzionalità principali</span><span class="sxs-lookup"><span data-stu-id="d0af4-137">Concepts & key features</span></span>
<span data-ttu-id="d0af4-138">**Servizi ospitati dal cliente**</span><span class="sxs-lookup"><span data-stu-id="d0af4-138">**Customer-hosted services**</span></span>

<span data-ttu-id="d0af4-139">suddivisione di Hello-unione viene recapitato come un servizio ospitato sul cliente.</span><span class="sxs-lookup"><span data-stu-id="d0af4-139">hello split-merge is delivered as a customer-hosted service.</span></span> <span data-ttu-id="d0af4-140">È necessario distribuire e ospitare il servizio di hello nella sottoscrizione di Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="d0af4-140">You must deploy and host hello service in your Microsoft Azure subscription.</span></span> <span data-ttu-id="d0af4-141">pacchetto di Hello scaricati da NuGet contiene un toocomplete del modello di configurazione con le informazioni di hello per una distribuzione specifica.</span><span class="sxs-lookup"><span data-stu-id="d0af4-141">hello package you download from NuGet contains a configuration template toocomplete with hello information for your specific deployment.</span></span> <span data-ttu-id="d0af4-142">Vedere hello [esercitazione suddivisione unione](sql-database-elastic-scale-configure-deploy-split-and-merge.md) per informazioni dettagliate.</span><span class="sxs-lookup"><span data-stu-id="d0af4-142">See hello [split-merge tutorial](sql-database-elastic-scale-configure-deploy-split-and-merge.md) for details.</span></span> <span data-ttu-id="d0af4-143">Poiché il servizio di hello viene eseguito nella sottoscrizione di Azure, è possibile controllare e configurare la maggior parte degli aspetti di sicurezza del servizio di hello.</span><span class="sxs-lookup"><span data-stu-id="d0af4-143">Since hello service runs in your Azure subscription, you can control and configure most security aspects of hello service.</span></span> <span data-ttu-id="d0af4-144">modello predefinito Hello include hello opzioni tooconfigure SSL, l'autenticazione client basata su certificato, la crittografia per le credenziali archiviate, protegge DoS e le restrizioni IP.</span><span class="sxs-lookup"><span data-stu-id="d0af4-144">hello default template includes hello options tooconfigure SSL, certificate-based client authentication, encryption for stored credentials, DoS guarding and IP restrictions.</span></span> <span data-ttu-id="d0af4-145">Sono disponibili ulteriori informazioni su hello gli aspetti di sicurezza seguente documento hello [configurazione della protezione di suddivisione unione](sql-database-elastic-scale-split-merge-security-configuration.md).</span><span class="sxs-lookup"><span data-stu-id="d0af4-145">You can find more information on hello security aspects in hello following document [split-merge security configuration](sql-database-elastic-scale-split-merge-security-configuration.md).</span></span>

<span data-ttu-id="d0af4-146">predefinito Hello distribuito viene eseguito il servizio con un unico ruolo web e di un lavoro.</span><span class="sxs-lookup"><span data-stu-id="d0af4-146">hello default deployed service runs with one worker and one web role.</span></span> <span data-ttu-id="d0af4-147">Ogni utilizza dimensioni della macchina virtuale A1 hello in servizi Cloud di Azure.</span><span class="sxs-lookup"><span data-stu-id="d0af4-147">Each uses hello A1 VM size in Azure Cloud Services.</span></span> <span data-ttu-id="d0af4-148">Mentre è possibile modificare queste impostazioni quando si distribuisce il pacchetto di hello, è possibile modificare dopo una corretta distribuzione di hello in esecuzione il servizio cloud, (tramite hello portale di Azure).</span><span class="sxs-lookup"><span data-stu-id="d0af4-148">While you cannot modify these settings when deploying hello package, you could change them after a successful deployment in hello running cloud service, (through hello Azure portal).</span></span> <span data-ttu-id="d0af4-149">Si noti che il ruolo di lavoro hello non deve essere configurato per più di una singola istanza per motivi tecnici.</span><span class="sxs-lookup"><span data-stu-id="d0af4-149">Note that hello worker role must not be configured for more than a single instance for technical reasons.</span></span> 

<span data-ttu-id="d0af4-150">**Integrazione della mappa partizioni**</span><span class="sxs-lookup"><span data-stu-id="d0af4-150">**Shard map integration**</span></span>

<span data-ttu-id="d0af4-151">il servizio di suddivisione unione Hello interagisce con mappa partizioni hello di un'applicazione hello.</span><span class="sxs-lookup"><span data-stu-id="d0af4-151">hello split-merge service interacts with hello shard map of hello application.</span></span> <span data-ttu-id="d0af4-152">Quando si utilizza toosplit servizio di suddivisione unione hello o intervalli di unione o toomove shardlet tra le partizioni, il servizio hello mantiene automaticamente mappa partizioni hello backup toodate.</span><span class="sxs-lookup"><span data-stu-id="d0af4-152">When using hello split-merge service toosplit or merge ranges or toomove shardlets between shards, hello service automatically keeps hello shard map up toodate.</span></span> <span data-ttu-id="d0af4-153">toodo in tal caso, il servizio hello si connette toohello database manager mappa di partizione dell'applicazione hello e gestisce gli intervalli e i mapping come stato di avanzamento delle richieste di suddivisione/unione/spostamento.</span><span class="sxs-lookup"><span data-stu-id="d0af4-153">toodo so, hello service connects toohello shard map manager database of hello application and maintains ranges and mappings as split/merge/move requests progress.</span></span> <span data-ttu-id="d0af4-154">In questo modo la mappa partizioni hello sempre presenta una visualizzazione aggiornata quando le operazioni di unione di menu combinato sono in corso.</span><span class="sxs-lookup"><span data-stu-id="d0af4-154">This ensures that hello shard map always presents an up-to-date view when split-merge operations are going on.</span></span> <span data-ttu-id="d0af4-155">Suddiviso, operazioni di spostamento di shardlet e di tipo merge vengono implementate tramite lo spostamento di un batch di shardlet dalla partizione di destinazione di hello origine partizione toohello.</span><span class="sxs-lookup"><span data-stu-id="d0af4-155">Split, merge and shardlet movement operations are implemented by moving a batch of shardlets from hello source shard toohello target shard.</span></span> <span data-ttu-id="d0af4-156">Durante la hello shardlet spostamento operazione hello shardlet soggetto toohello batch corrente sono contrassegnati come offline nella mappa partizioni hello e non sono disponibili per le connessioni di routine dipendente dai dati utilizzando hello **OpenConnectionForKey** API.</span><span class="sxs-lookup"><span data-stu-id="d0af4-156">During hello shardlet movement operation hello shardlets subject toohello current batch are marked as offline in hello shard map and are unavailable for data-dependent routing connections using hello **OpenConnectionForKey** API.</span></span> 

<span data-ttu-id="d0af4-157">**Connessioni a shardlet coerenti**</span><span class="sxs-lookup"><span data-stu-id="d0af4-157">**Consistent shardlet connections**</span></span>

<span data-ttu-id="d0af4-158">Quando lo spostamento dei dati viene avviata per un nuovo batch di shardlet, qualsiasi partizione-mappa fornita dipendente dai dati routing connessioni toohello partizioni archiviazione hello shardlet sono terminate e le successive connessioni da mappa partizioni hello toohello API queste shardlet sono bloccati mentre lo spostamento dei dati di Hello è in corso incoerenze tooavoid ordine.</span><span class="sxs-lookup"><span data-stu-id="d0af4-158">When data movement starts for a new batch of shardlets, any shard-map provided data-dependent routing connections toohello shard storing hello shardlet are killed and subsequent connections from hello shard map APIs toohello these shardlets are blocked while hello data movement is in progress in order tooavoid inconsistencies.</span></span> <span data-ttu-id="d0af4-159">Gli shardlet tooother le connessioni sul hello stesso partizione verrà inoltre ottenere terminato, ma avrà esito positivo nuovamente immediatamente nel tentativo successivo.</span><span class="sxs-lookup"><span data-stu-id="d0af4-159">Connections tooother shardlets on hello same shard will also get killed, but will succeed again immediately on retry.</span></span> <span data-ttu-id="d0af4-160">Dopo aver spostato batch hello, hello shardlet sono contrassegnati come online nuovamente per la partizione di destinazione hello e dati di origine hello viene rimosso dalla partizione di origine hello.</span><span class="sxs-lookup"><span data-stu-id="d0af4-160">Once hello batch is moved, hello shardlets are marked online again for hello target shard and hello source data is removed from hello source shard.</span></span> <span data-ttu-id="d0af4-161">servizio Hello passa questi passaggi per ogni batch fino a quando non sono stati spostati tutti gli shardlet.</span><span class="sxs-lookup"><span data-stu-id="d0af4-161">hello service goes through these steps for every batch until all shardlets have been moved.</span></span> <span data-ttu-id="d0af4-162">Questo comporta le operazioni di kill connessione tooseveral corso hello di completare l'operazione split/merge/spostamento hello.</span><span class="sxs-lookup"><span data-stu-id="d0af4-162">This will lead tooseveral connection kill operations during hello course of hello complete split/merge/move operation.</span></span>  

<span data-ttu-id="d0af4-163">**Gestione della disponibilità di shardlet**</span><span class="sxs-lookup"><span data-stu-id="d0af4-163">**Managing shardlet availability**</span></span>

<span data-ttu-id="d0af4-164">Limitazione della connessione hello la terminazione del batch corrente di toohello di shardlet, come illustrato in precedenza limita l'ambito hello del batch tooone indisponibilità di shardlet alla volta.</span><span class="sxs-lookup"><span data-stu-id="d0af4-164">Limiting hello connection killing toohello current batch of shardlets as discussed above restricts hello scope of unavailability tooone batch of shardlets at a time.</span></span> <span data-ttu-id="d0af4-165">Questo è preferibile un approccio in partizioni completa hello resta offline per tutti i relativi shardlet hello durante un'operazione di divisione o di unione.</span><span class="sxs-lookup"><span data-stu-id="d0af4-165">This is preferred over an approach where hello complete shard would remain offline for all its shardlets during hello course of a split or merge operation.</span></span> <span data-ttu-id="d0af4-166">dimensioni Hello di un batch, definita come numero di hello di shardlet distinct toomove contemporaneamente, sono un parametro di configurazione.</span><span class="sxs-lookup"><span data-stu-id="d0af4-166">hello size of a batch, defined as hello number of distinct shardlets toomove at a time, is a configuration parameter.</span></span> <span data-ttu-id="d0af4-167">Può essere definito per ogni operazione di divisione e unione a seconda delle esigenze di disponibilità e prestazioni dell'applicazione hello.</span><span class="sxs-lookup"><span data-stu-id="d0af4-167">It can be defined for each split and merge operation depending on hello application’s availability and performance needs.</span></span> <span data-ttu-id="d0af4-168">Si noti che l'intervallo di hello da bloccare nella mappa partizioni hello può essere più grande delle dimensioni di batch hello specificata.</span><span class="sxs-lookup"><span data-stu-id="d0af4-168">Note that hello range that is being locked in hello shard map may be larger than hello batch size specified.</span></span> <span data-ttu-id="d0af4-169">Questo avviene perché il servizio di hello rileva dimensioni dell'intervallo hello in modo che il numero effettivo di hello di valori di chiave di partizionamento orizzontale nei dati hello corrisponda circa dimensioni batch hello.</span><span class="sxs-lookup"><span data-stu-id="d0af4-169">This is because hello service picks hello range size such that hello actual number of sharding key values in hello data approximately matches hello batch size.</span></span> <span data-ttu-id="d0af4-170">Questo aspetto è importante tooremember soprattutto per le chiavi di partizionamento orizzontale scarsamente popolato.</span><span class="sxs-lookup"><span data-stu-id="d0af4-170">This is important tooremember in particular for sparsely populated sharding keys.</span></span> 

<span data-ttu-id="d0af4-171">**Archiviazione dei metadati**</span><span class="sxs-lookup"><span data-stu-id="d0af4-171">**Metadata storage**</span></span>

<span data-ttu-id="d0af4-172">il servizio di suddivisione unione Hello utilizza un database toomaintain stato e tookeep registra durante l'elaborazione della richiesta.</span><span class="sxs-lookup"><span data-stu-id="d0af4-172">hello split-merge service uses a database toomaintain its status and tookeep logs during request processing.</span></span> <span data-ttu-id="d0af4-173">utente Hello crea il database nella propria sottoscrizione e prevede la stringa di connessione hello nel file di configurazione hello per la distribuzione del servizio hello.</span><span class="sxs-lookup"><span data-stu-id="d0af4-173">hello user creates this database in their subscription and provides hello connection string for it in hello configuration file for hello service deployment.</span></span> <span data-ttu-id="d0af4-174">Gli amministratori dell'organizzazione dell'utente hello possono inoltre connettersi toothis lo stato di richiesta di database tooreview e tooinvestigate informazioni dettagliate in potenziali problemi.</span><span class="sxs-lookup"><span data-stu-id="d0af4-174">Administrators from hello user’s organization can also connect toothis database tooreview request progress and tooinvestigate detailed information regarding potential failures.</span></span>

<span data-ttu-id="d0af4-175">**Rilevamento del partizionamento orizzontale**</span><span class="sxs-lookup"><span data-stu-id="d0af4-175">**Sharding-awareness**</span></span>

<span data-ttu-id="d0af4-176">il servizio di suddivisione unione Hello riconosce la differenza tra tabelle partizionate di (1), tabelle di riferimento (2) e (3) normali tabelle.</span><span class="sxs-lookup"><span data-stu-id="d0af4-176">hello split-merge service differentiates between (1) sharded tables, (2) reference tables, and (3) normal tables.</span></span> <span data-ttu-id="d0af4-177">la semantica di Hello di un'operazione di suddivisione/unione/spostamento dipende dal tipo di hello della tabella hello utilizzata e è definita come segue:</span><span class="sxs-lookup"><span data-stu-id="d0af4-177">hello semantics of a split/merge/move operation depend on hello type of hello table used and are defined as follows:</span></span> 

* <span data-ttu-id="d0af4-178">**Tabelle partizionate**: Split, merge e le operazioni di spostamento spostano gli shardlet dalla partizione di origine tootarget.</span><span class="sxs-lookup"><span data-stu-id="d0af4-178">**Sharded tables**: Split, merge, and move operations move shardlets from source tootarget shard.</span></span> <span data-ttu-id="d0af4-179">Dopo il completamento di hello complessiva richiesta, tali shardlet non sono più presenti nell'origine hello.</span><span class="sxs-lookup"><span data-stu-id="d0af4-179">After successful completion of hello overall request, those shardlets are no longer present on hello source.</span></span> <span data-ttu-id="d0af4-180">Si noti che le tabelle di destinazione di hello necessario tooexist nella partizione di destinazione hello e non devono contenere dati hello tooprocessing precedente intervallo destinazione dell'operazione di hello.</span><span class="sxs-lookup"><span data-stu-id="d0af4-180">Note that hello target tables need tooexist on hello target shard and must not contain data in hello target range prior tooprocessing of hello operation.</span></span> 
* <span data-ttu-id="d0af4-181">**Fare riferimento a tabelle**: per le tabelle di riferimento, hello split, merge e spostare le operazioni di copiare i dati di hello dalla partizione di destinazione toohello origine hello.</span><span class="sxs-lookup"><span data-stu-id="d0af4-181">**Reference tables**: For reference tables, hello split, merge and move operations copy hello data from hello source toohello target shard.</span></span> <span data-ttu-id="d0af4-182">Si noti, tuttavia, che non si verificano modifiche al partizione di destinazione hello per una determinata tabella se qualsiasi riga è già presente in questa tabella nella destinazione hello.</span><span class="sxs-lookup"><span data-stu-id="d0af4-182">Note, however, that no changes occur on hello target shard for a given table if any row is already present in this table on hello target.</span></span> <span data-ttu-id="d0af4-183">tabella Hello è toobe vuota per qualsiasi tooget di operazione copia tabella di riferimento elaborati.</span><span class="sxs-lookup"><span data-stu-id="d0af4-183">hello table has toobe empty for any reference table copy operation tooget processed.</span></span>
* <span data-ttu-id="d0af4-184">**Altre tabelle**: altre tabelle possono essere presenti in hello origine o destinazione hello di un'operazione di divisione e unione.</span><span class="sxs-lookup"><span data-stu-id="d0af4-184">**Other Tables**: Other tables can be present on either hello source or hello target of a split and merge operation.</span></span> <span data-ttu-id="d0af4-185">il servizio di suddivisione unione Hello Ignora queste tabelle per le operazioni di copia o lo spostamento dei dati.</span><span class="sxs-lookup"><span data-stu-id="d0af4-185">hello split-merge service disregards these tables for any data movement or copy operations.</span></span> <span data-ttu-id="d0af4-186">Si noti, tuttavia, che in caso di vincoli queste tabelle possono interferire con le operazioni.</span><span class="sxs-lookup"><span data-stu-id="d0af4-186">Note, however, that they can interfere with these operations in case of constraints.</span></span>

<span data-ttu-id="d0af4-187">Hello informazioni sul riferimento e tabelle partizionate vengono fornite da hello **SchemaInfo** API nella mappa partizioni hello.</span><span class="sxs-lookup"><span data-stu-id="d0af4-187">hello information on reference vs. sharded tables is provided by hello **SchemaInfo** APIs on hello shard map.</span></span> <span data-ttu-id="d0af4-188">Hello seguente esempio di seguito viene illustrato l'utilizzo di hello di queste API in un oggetto smm di partizioni specificato mappa manager:</span><span class="sxs-lookup"><span data-stu-id="d0af4-188">hello following example illustrates hello use of these APIs on a given shard map manager object smm:</span></span> 

    // Create hello schema annotations 
    SchemaInfo schemaInfo = new SchemaInfo(); 

    // Reference tables 
    schemaInfo.Add(new ReferenceTableInfo("dbo", "region")); 
    schemaInfo.Add(new ReferenceTableInfo("dbo", "nation")); 

    // Sharded tables 
    schemaInfo.Add(new ShardedTableInfo("dbo", "customer", "C_CUSTKEY")); 
    schemaInfo.Add(new ShardedTableInfo("dbo", "orders", "O_CUSTKEY")); 

    // Publish 
    smm.GetSchemaInfoCollection().Add(Configuration.ShardMapName, schemaInfo); 

<span data-ttu-id="d0af4-189">Hello tabelle 'region' e 'nazione' sono definite come tabelle di riferimento verrà copiato con operazioni di suddivisione/unione/spostamento.</span><span class="sxs-lookup"><span data-stu-id="d0af4-189">hello tables ‘region’ and ‘nation’ are defined as reference tables and will be copied with split/merge/move operations.</span></span> <span data-ttu-id="d0af4-190">"cliente" e "ordini" a loro volta sono definite come tabelle partizionate.</span><span class="sxs-lookup"><span data-stu-id="d0af4-190">‘customer’ and ‘orders’ in turn are defined as sharded tables.</span></span> <span data-ttu-id="d0af4-191">C_CUSTKEY e O_CUSTKEY fungere da chiave di partizionamento orizzontale hello.</span><span class="sxs-lookup"><span data-stu-id="d0af4-191">C_CUSTKEY and O_CUSTKEY serve as hello sharding key.</span></span> 

<span data-ttu-id="d0af4-192">**Integrità referenziale**</span><span class="sxs-lookup"><span data-stu-id="d0af4-192">**Referential Integrity**</span></span>

<span data-ttu-id="d0af4-193">il servizio di suddivisione unione Hello analizza le dipendenze tra le tabelle e utilizza le operazioni di hello toostage relazioni di chiave primaria-chiave esterna per lo spostamento delle tabelle di riferimento e gli shardlet.</span><span class="sxs-lookup"><span data-stu-id="d0af4-193">hello split-merge service analyzes dependencies between tables and uses foreign key-primary key relationships toostage hello operations for moving reference tables and shardlets.</span></span> <span data-ttu-id="d0af4-194">Le tabelle di riferimento vengono in genere copiate per prime in ordine di dipendenza, quindi vengono copiati gli shardlet, in base al rispettivo ordine di dipendenza in ogni batch.</span><span class="sxs-lookup"><span data-stu-id="d0af4-194">In general, reference tables are copied first in dependency order, then shardlets are copied in order of their dependencies within each batch.</span></span> <span data-ttu-id="d0af4-195">Ciò è necessario in modo che vengono rispettati i vincoli di chiave esterna-chiave primaria nella partizione di destinazione hello in arrivo di nuovi dati hello.</span><span class="sxs-lookup"><span data-stu-id="d0af4-195">This is necessary so that FK-PK constraints on hello target shard are honored as hello new data arrives.</span></span> 

<span data-ttu-id="d0af4-196">**Coerenza della mappa partizioni e completamento finale**</span><span class="sxs-lookup"><span data-stu-id="d0af4-196">**Shard Map Consistency and Eventual Completion**</span></span>

<span data-ttu-id="d0af4-197">In presenza di hello di errori, il servizio di suddivisione unione hello riprende le operazioni dopo qualsiasi interruzione e ha lo scopo toocomplete qualsiasi nelle richieste di stato di avanzamento.</span><span class="sxs-lookup"><span data-stu-id="d0af4-197">In hello presence of failures, hello split-merge service resumes operations after any outage and aims toocomplete any in progress requests.</span></span> <span data-ttu-id="d0af4-198">Tuttavia, potrebbero esserci irreversibile situazioni, ad esempio, quando la partizione di destinazione hello viene perduto o danneggiato ripristinato.</span><span class="sxs-lookup"><span data-stu-id="d0af4-198">However, there may be unrecoverable situations, e.g., when hello target shard is lost or compromised beyond repair.</span></span> <span data-ttu-id="d0af4-199">In tali circostanze, alcuni shardlet che doveva toobe spostato può continuare tooreside nella partizione di origine hello.</span><span class="sxs-lookup"><span data-stu-id="d0af4-199">Under those circumstances, some shardlets that were supposed toobe moved may continue tooreside on hello source shard.</span></span> <span data-ttu-id="d0af4-200">servizio Hello assicura che i mapping di shardlet vengono aggiornati solo dopo i dati necessari hello destinazione toohello copiati correttamente.</span><span class="sxs-lookup"><span data-stu-id="d0af4-200">hello service ensures that shardlet mappings are only updated after hello necessary data has been successfully copied toohello target.</span></span> <span data-ttu-id="d0af4-201">Gli Shardlet vengono eliminati solo nell'origine hello dopo che tutti i relativi dati sono stati copiati toohello destinazione e sono stati aggiornati i mapping corrispondente hello.</span><span class="sxs-lookup"><span data-stu-id="d0af4-201">Shardlets are only deleted on hello source once all their data has been copied toohello target and hello corresponding mappings have been updated successfully.</span></span> <span data-ttu-id="d0af4-202">l'operazione di eliminazione Hello avviene in background hello durante l'intervallo di hello è già online nella partizione di destinazione hello.</span><span class="sxs-lookup"><span data-stu-id="d0af4-202">hello deletion operation happens in hello background while hello range is already online on hello target shard.</span></span> <span data-ttu-id="d0af4-203">servizio di suddivisione unione Hello garantisce sempre la correttezza dei mapping hello archiviato nella mappa partizioni hello.</span><span class="sxs-lookup"><span data-stu-id="d0af4-203">hello split-merge service always ensures correctness of hello mappings stored in hello shard map.</span></span>

## <a name="hello-split-merge-user-interface"></a><span data-ttu-id="d0af4-204">interfaccia utente di suddivisione unione Hello</span><span class="sxs-lookup"><span data-stu-id="d0af4-204">hello split-merge user interface</span></span>
<span data-ttu-id="d0af4-205">pacchetto del servizio di suddivisione unione Hello include un ruolo di lavoro e un ruolo web.</span><span class="sxs-lookup"><span data-stu-id="d0af4-205">hello split-merge service package includes a worker role and a web role.</span></span> <span data-ttu-id="d0af4-206">ruolo web Hello è le richieste di unione di menu combinato toosubmit utilizzato in modo interattivo.</span><span class="sxs-lookup"><span data-stu-id="d0af4-206">hello web role is used toosubmit split-merge requests in an interactive way.</span></span> <span data-ttu-id="d0af4-207">come indicato di seguito sono riportati i componenti principali di Hello dell'interfaccia utente di hello:</span><span class="sxs-lookup"><span data-stu-id="d0af4-207">hello main components of hello user interface are as follows:</span></span>

* <span data-ttu-id="d0af4-208">Tipo di operazione: tipo di operazione hello è un pulsante di opzione che controlla il tipo di hello di operazione eseguita dal servizio hello per questa richiesta.</span><span class="sxs-lookup"><span data-stu-id="d0af4-208">Operation Type: hello operation type is a radio button that controls hello kind of operation performed by hello service for this request.</span></span> <span data-ttu-id="d0af4-209">È possibile scegliere tra hello split, merge e scenari di spostamento.</span><span class="sxs-lookup"><span data-stu-id="d0af4-209">You can choose between hello split, merge and move scenarios.</span></span> <span data-ttu-id="d0af4-210">È anche possibile annullare un'operazione inviata in precedenza.</span><span class="sxs-lookup"><span data-stu-id="d0af4-210">You can also cancel a previously submitted operation.</span></span> <span data-ttu-id="d0af4-211">È possibile usare richieste di suddivisione, unione e spostamento per le mappe partizioni di tipo intervallo.</span><span class="sxs-lookup"><span data-stu-id="d0af4-211">You can use split, merge and move requests for range shard maps.</span></span> <span data-ttu-id="d0af4-212">Le mappe partizioni di tipo elenco supportano solo operazioni di spostamento.</span><span class="sxs-lookup"><span data-stu-id="d0af4-212">List shard maps only support move operations.</span></span>
* <span data-ttu-id="d0af4-213">Mappa partizioni: sezione successiva hello di richiesta parametri copertura informazioni mappa partizioni hello e la mappa partizioni di hosting del database hello.</span><span class="sxs-lookup"><span data-stu-id="d0af4-213">Shard Map: hello next section of request parameters cover information about hello shard map and hello database hosting your shard map.</span></span> <span data-ttu-id="d0af4-214">In particolare, è necessario tooprovide hello nome del server di Database SQL di Azure hello e shardmap hello di hosting del database, partizioni di credenziali tooconnect toohello eseguire il mapping del database e infine hello Nome mappa partizioni hello.</span><span class="sxs-lookup"><span data-stu-id="d0af4-214">In particular, you need tooprovide hello name of hello Azure SQL Database server and database hosting hello shardmap, credentials tooconnect toohello shard map database, and finally hello name of hello shard map.</span></span> <span data-ttu-id="d0af4-215">Attualmente, operazione hello accetta solo un singolo set di credenziali.</span><span class="sxs-lookup"><span data-stu-id="d0af4-215">Currently, hello operation only accepts a single set of credentials.</span></span> <span data-ttu-id="d0af4-216">Queste credenziali necessitano disporre delle autorizzazioni sufficienti di toohave tooperform modifica mappa partizioni toohello, nonché i dati utente toohello su partizioni hello.</span><span class="sxs-lookup"><span data-stu-id="d0af4-216">These credentials need toohave sufficient permissions tooperform changes toohello shard map as well as toohello user data on hello shards.</span></span>
* <span data-ttu-id="d0af4-217">Intervallo di origine (suddivisione e unione): un'operazione di suddivisione e unione elabora un intervallo usando le relative chiavi superiore e inferiore.</span><span class="sxs-lookup"><span data-stu-id="d0af4-217">Source Range (split and merge): A split and merge operation processes a range using its low and high key.</span></span> <span data-ttu-id="d0af4-218">toospecify un'operazione con un unbounded valore di chiave superiore, controllo casella di controllo "chiave superiore è max" hello e lasciare vuota campo chiave elevata hello.</span><span class="sxs-lookup"><span data-stu-id="d0af4-218">toospecify an operation with an unbounded high key value, check hello “High key is max” check box and leave hello high key field empty.</span></span> <span data-ttu-id="d0af4-219">Hello intervallo valori di chiave specificato non è necessario tooprecisely corrispondono ai limiti della mappa di partizione e un mapping.</span><span class="sxs-lookup"><span data-stu-id="d0af4-219">hello range key values that you specify do not need tooprecisely match a mapping and its boundaries in your shard map.</span></span> <span data-ttu-id="d0af4-220">Se non si specifica i limiti di intervallo in qualsiasi servizio hello dedurrà intervallo più vicino hello è automaticamente.</span><span class="sxs-lookup"><span data-stu-id="d0af4-220">If you do not specify any range boundaries at all hello service will infer hello closest range for you automatically.</span></span> <span data-ttu-id="d0af4-221">È possibile utilizzare hello PowerShell GetMappings.ps1 tooretrieve hello corrente i mapping degli script in una mappa partizioni specificato.</span><span class="sxs-lookup"><span data-stu-id="d0af4-221">You can use hello GetMappings.ps1 PowerShell script tooretrieve hello current mappings in a given shard map.</span></span>
* <span data-ttu-id="d0af4-222">Il comportamento di origine Split (divisione): per le operazioni di divisione, definire l'intervallo di origine di hello toosplit punto hello.</span><span class="sxs-lookup"><span data-stu-id="d0af4-222">Split Source Behavior (split): For split operations, define hello point toosplit hello source range.</span></span> <span data-ttu-id="d0af4-223">Questo scopo è fornire una chiave di partizionamento orizzontale hello in cui si desidera hello divisa toooccur.</span><span class="sxs-lookup"><span data-stu-id="d0af4-223">You do this by providing hello sharding key where you want hello split toooccur.</span></span> <span data-ttu-id="d0af4-224">Pulsante di opzione Usa hello specificare se si desidera parte inferiore di hello di hello toomove di intervallo (hello suddividere la chiave escluse) o se si desidera toomove parte superiore di hello (incluse chiave split hello).</span><span class="sxs-lookup"><span data-stu-id="d0af4-224">Use hello radio button specify whether you want hello lower part of hello range (excluding hello split key) toomove, or whether you want hello upper part toomove (including hello split key).</span></span>
* <span data-ttu-id="d0af4-225">Origine Shardlet (spostare): spostare le operazioni sono diverse dalla divisione o operazioni di unione, in quanto non richiedono un'origine di hello toodescribe intervallo.</span><span class="sxs-lookup"><span data-stu-id="d0af4-225">Source Shardlet (move): Move operations are different from split or merge operations as they do not require a range toodescribe hello source.</span></span> <span data-ttu-id="d0af4-226">Un'origine per lo spostamento è semplicemente identificata dal valore di chiave di partizionamento orizzontale hello pianificare toomove.</span><span class="sxs-lookup"><span data-stu-id="d0af4-226">A source for move is simply identified by hello sharding key value that you plan toomove.</span></span>
* <span data-ttu-id="d0af4-227">Partizioni (divisione) di destinazione: dopo avere fornito hello informazioni sull'origine hello dell'operazione di divisione, è necessario toodefine in cui si desidera hello dati toobe copiati server di database SQL di Azure tooby fornendo hello e nome del database di destinazione hello.</span><span class="sxs-lookup"><span data-stu-id="d0af4-227">Target Shard (split): Once you have provided hello information on hello source of your split operation, you need toodefine where you want hello data toobe copied tooby providing hello Azure SQL Db server and database name for hello target.</span></span>
* <span data-ttu-id="d0af4-228">Intervallo di destinazione (unione): le operazioni di unione spostare gli shardlet tooan esistente partizioni.</span><span class="sxs-lookup"><span data-stu-id="d0af4-228">Target Range (merge): Merge operations move shardlets tooan existing shard.</span></span> <span data-ttu-id="d0af4-229">Per identificare partizioni esistenti hello, fornendo i limiti di intervallo esistente hello che si desidera toomerge con intervallo di hello.</span><span class="sxs-lookup"><span data-stu-id="d0af4-229">You identify hello existing shard by providing hello range boundaries of hello existing range that you want toomerge with.</span></span>
* <span data-ttu-id="d0af4-230">Dimensione batch: controlli di dimensioni di batch hello hello numero di shardlet che andrà offline contemporaneamente durante lo spostamento dei dati di hello.</span><span class="sxs-lookup"><span data-stu-id="d0af4-230">Batch Size: hello batch size controls hello number of shardlets that will go offline at a time during hello data movement.</span></span> <span data-ttu-id="d0af4-231">Si tratta di un valore intero in cui è possibile utilizzare i valori inferiori e si toolong sensibili i tempi di inattività per gli shardlet.</span><span class="sxs-lookup"><span data-stu-id="d0af4-231">This is an integer value where you can use smaller values when you are sensitive toolong periods of downtime for shardlets.</span></span> <span data-ttu-id="d0af4-232">Valori più grandi aumenta il tempo necessario hello che un determinato shardlet è offline ma può migliorare le prestazioni.</span><span class="sxs-lookup"><span data-stu-id="d0af4-232">Larger values will increase hello time that a given shardlet is offline but may improve performance.</span></span>
* <span data-ttu-id="d0af4-233">Id operazione (Annulla): Se si dispone di un'operazione in corso che non è più necessario, è possibile annullare operazione hello fornendo l'ID operazione in questo campo.</span><span class="sxs-lookup"><span data-stu-id="d0af4-233">Operation Id (Cancel): If you have an ongoing operation that is no longer needed, you can cancel hello operation by providing its operation ID in this field.</span></span> <span data-ttu-id="d0af4-234">È possibile recuperare l'ID operazione hello dalla tabella di stato richiesta hello (vedere la sezione 8.1) oppure dall'output di hello nel browser web hello in cui è stato inviato richiesta hello.</span><span class="sxs-lookup"><span data-stu-id="d0af4-234">You can retrieve hello operation ID from hello request status table (see Section 8.1) or from hello output in hello web browser where you submitted hello request.</span></span>

## <a name="requirements-and-limitations"></a><span data-ttu-id="d0af4-235">Requisiti e limitazioni</span><span class="sxs-lookup"><span data-stu-id="d0af4-235">Requirements and Limitations</span></span>
<span data-ttu-id="d0af4-236">Hello l'implementazione corrente del servizio di suddivisione unione hello è soggetto toohello seguenti requisiti e limitazioni:</span><span class="sxs-lookup"><span data-stu-id="d0af4-236">hello current implementation of hello split-merge service is subject toohello following requirements and limitations:</span></span> 

* <span data-ttu-id="d0af4-237">partizioni Hello necessario tooexist ed essere registrate nella mappa partizioni hello prima di poter eseguire un'operazione di unione di menu combinato su tali partizioni.</span><span class="sxs-lookup"><span data-stu-id="d0af4-237">hello shards need tooexist and be registered in hello shard map before a split-merge operation on these shards can be performed.</span></span> 
* <span data-ttu-id="d0af4-238">servizio Hello non crea le tabelle o altri oggetti di database automaticamente come parte delle operazioni.</span><span class="sxs-lookup"><span data-stu-id="d0af4-238">hello service does not create tables or any other database objects automatically as part of its operations.</span></span> <span data-ttu-id="d0af4-239">Ciò significa che hello dello schema per tabelle partizionate tutti e fanno riferimento a tabelle necessario tooexist sull'operazione di suddivisione/unione/spostamento di hello destinazione partizioni tooany precedente.</span><span class="sxs-lookup"><span data-stu-id="d0af4-239">This means that hello schema for all sharded tables and reference tables need tooexist on hello target shard prior tooany split/merge/move operation.</span></span> <span data-ttu-id="d0af4-240">Tabelle partizionate, in particolare, sono necessari toobe vuota nell'intervallo di hello in nuovi shardlet sono toobe aggiunte da un'operazione di suddivisione/unione/spostamento.</span><span class="sxs-lookup"><span data-stu-id="d0af4-240">Sharded tables in particular are required toobe empty in hello range where new shardlets are toobe added by a split/merge/move operation.</span></span> <span data-ttu-id="d0af4-241">In caso contrario, hello operazione non riuscirà hello iniziale verifica di coerenza nella partizione di destinazione hello.</span><span class="sxs-lookup"><span data-stu-id="d0af4-241">Otherwise, hello operation will fail hello initial consistency check on hello target shard.</span></span> <span data-ttu-id="d0af4-242">Si noti che i dati di riferimento viene copiati solo se la tabella di riferimento hello è vuota e che non esistono alcun coerenza garantisce anche con le operazioni di scrittura simultanee tooother considerare nelle tabelle di riferimento hello.</span><span class="sxs-lookup"><span data-stu-id="d0af4-242">Also note that reference data is only copied if hello reference table is empty and that there are no consistency guarantees with regard tooother concurrent write operations on hello reference tables.</span></span> <span data-ttu-id="d0af4-243">È consigliabile questo: durante l'esecuzione di operazioni di suddivisione/unione, senza altre operazioni di scrittura di apportare modifiche toohello tabelle di riferimento.</span><span class="sxs-lookup"><span data-stu-id="d0af4-243">We recommend this: when running split/merge operations, no other write operations make changes toohello reference tables.</span></span>
* <span data-ttu-id="d0af4-244">servizio Hello si basa su identità di riga definita da un indice univoco o chiave che include prestazioni tooimprove chiave di partizionamento orizzontale hello e affidabilità per gli shardlet di grandi dimensioni.</span><span class="sxs-lookup"><span data-stu-id="d0af4-244">hello service relies on row identity established by a unique index or key that includes hello sharding key tooimprove performance and reliability for large shardlets.</span></span> <span data-ttu-id="d0af4-245">In questo modo sarà possibile dati toomove del servizio hello un'anche maggiore granularità rispetto appena hello partizionamento orizzontale valore della chiave.</span><span class="sxs-lookup"><span data-stu-id="d0af4-245">This allows hello service toomove data at an even finer granularity than just hello sharding key value.</span></span> <span data-ttu-id="d0af4-246">In questo modo quantità massima di hello tooreduce di spazio del log e i blocchi che sono necessari durante l'operazione di hello.</span><span class="sxs-lookup"><span data-stu-id="d0af4-246">This helps tooreduce hello maximum amount of log space and locks that are required during hello operation.</span></span> <span data-ttu-id="d0af4-247">È consigliabile creare un indice univoco o chiave primaria tra la chiave di partizionamento orizzontale hello in una tabella specificata, se si desidera toouse tale tabella con le richieste di suddivisione/unione/spostamento.</span><span class="sxs-lookup"><span data-stu-id="d0af4-247">Consider creating a unique index or a primary key including hello sharding key on a given table if you want toouse that table with split/merge/move requests.</span></span> <span data-ttu-id="d0af4-248">Per motivi di prestazioni chiave di partizionamento orizzontale hello deve essere hello iniziali colonne chiave hello hello indici o.</span><span class="sxs-lookup"><span data-stu-id="d0af4-248">For performance reasons, hello sharding key should be hello leading column in hello key or hello index.</span></span>
* <span data-ttu-id="d0af4-249">Corso hello di elaborazione delle richieste, alcuni dati shardlet possono essere presenti sia in origine hello e partizioni di destinazione hello.</span><span class="sxs-lookup"><span data-stu-id="d0af4-249">During hello course of request processing, some shardlet data may be present both on hello source and hello target shard.</span></span> <span data-ttu-id="d0af4-250">Si tratta tooprotect necessarie in caso di errori durante lo spostamento di shardlet hello.</span><span class="sxs-lookup"><span data-stu-id="d0af4-250">This is necessary tooprotect against failures during hello shardlet movement.</span></span> <span data-ttu-id="d0af4-251">Hello integrazione di suddivisione-unione con mappa partizioni hello assicura che le connessioni tramite hello dati dipendenti routing API hello **OpenConnectionForKey** metodo nella mappa partizioni hello non vengono visualizzati tutti gli stati intermedi non coerenti.</span><span class="sxs-lookup"><span data-stu-id="d0af4-251">hello integration of split-merge with hello shard map ensures that connections through hello data dependent routing APIs using hello **OpenConnectionForKey** method on hello shard map do not see any inconsistent intermediate states.</span></span> <span data-ttu-id="d0af4-252">Tuttavia, se connessione origine toohello o hello destinazione partizioni senza utilizzare hello **OpenConnectionForKey** (metodo), gli stati intermedi non coerenti potrebbero essere visibili quando sono richieste di suddivisione/unione/spostamento in corso..</span><span class="sxs-lookup"><span data-stu-id="d0af4-252">However, when connecting toohello source or hello target shards without using hello **OpenConnectionForKey** method, inconsistent intermediate states might be visible when split/merge/move requests are going on.</span></span> <span data-ttu-id="d0af4-253">Queste connessioni possono visualizzare i risultati parziali o duplicati in base a temporizzazione hello o connessione hello sottostante di hello partizioni.</span><span class="sxs-lookup"><span data-stu-id="d0af4-253">These connections may show partial or duplicate results depending on hello timing or hello shard underlying hello connection.</span></span> <span data-ttu-id="d0af4-254">Questa limitazione attualmente include le connessioni hello dalla scalabilità elastica Multi-Shard-query.</span><span class="sxs-lookup"><span data-stu-id="d0af4-254">This limitation currently includes hello connections made by Elastic Scale Multi-Shard-Queries.</span></span>
* <span data-ttu-id="d0af4-255">database dei metadati Hello per il servizio di suddivisione unione hello non deve essere condivise tra diversi ruoli.</span><span class="sxs-lookup"><span data-stu-id="d0af4-255">hello metadata database for hello split-merge service must not be shared between different roles.</span></span> <span data-ttu-id="d0af4-256">Ad esempio, un ruolo del servizio di suddivisione unione hello in esecuzione in gestione temporanea deve toopoint tooa metadati diversi database di ruolo di produzione hello.</span><span class="sxs-lookup"><span data-stu-id="d0af4-256">For example, a role of hello split-merge service running in staging needs toopoint tooa different metadata database than hello production role.</span></span>

## <a name="billing"></a><span data-ttu-id="d0af4-257">Fatturazione</span><span class="sxs-lookup"><span data-stu-id="d0af4-257">Billing</span></span>
<span data-ttu-id="d0af4-258">il servizio di suddivisione unione Hello viene eseguito come servizio cloud nella sottoscrizione di Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="d0af4-258">hello split-merge service runs as a cloud service in your Microsoft Azure subscription.</span></span> <span data-ttu-id="d0af4-259">Pertanto di tooyour istanza del servizio hello vengano addebitati costi per i servizi cloud.</span><span class="sxs-lookup"><span data-stu-id="d0af4-259">Therefore charges for cloud services apply tooyour instance of hello service.</span></span> <span data-ttu-id="d0af4-260">Se non si eseguono spesso operazioni di suddivisione/unione/spostamento, è consigliabile eliminare il servizio cloud di suddivisione-unione,</span><span class="sxs-lookup"><span data-stu-id="d0af4-260">Unless you frequently perform split/merge/move operations, we recommend you delete your split-merge cloud service.</span></span> <span data-ttu-id="d0af4-261">in modo da ridurre i costi per le istanze dei servizi cloud in esecuzione o distribuite.</span><span class="sxs-lookup"><span data-stu-id="d0af4-261">That saves costs for running or deployed cloud service instances.</span></span> <span data-ttu-id="d0af4-262">È possibile distribuire di nuovo e iniziare la configurazione eseguibile immediatamente ogni volta che è necessario tooperform dividere o unire le operazioni.</span><span class="sxs-lookup"><span data-stu-id="d0af4-262">You can re-deploy and start your readily runnable configuration whenever you need tooperform split or merge operations.</span></span> 

## <a name="monitoring"></a><span data-ttu-id="d0af4-263">Monitoraggio</span><span class="sxs-lookup"><span data-stu-id="d0af4-263">Monitoring</span></span>
### <a name="status-tables"></a><span data-ttu-id="d0af4-264">Tabelle di stato</span><span class="sxs-lookup"><span data-stu-id="d0af4-264">Status tables</span></span>
<span data-ttu-id="d0af4-265">Servizio di suddivisione unione Hello fornisce hello **RequestStatus** tabella nel database dell'archivio di metadati hello per il monitoraggio delle richieste in corso e completate.</span><span class="sxs-lookup"><span data-stu-id="d0af4-265">hello split-merge Service provides hello **RequestStatus** table in hello metadata store database for monitoring of completed and ongoing requests.</span></span> <span data-ttu-id="d0af4-266">Hello tabella una riga per ogni richiesta di unione di menu combinato che è stato inviato toothis istanza del servizio di suddivisione unione hello.</span><span class="sxs-lookup"><span data-stu-id="d0af4-266">hello table lists a row for each split-merge request that has been submitted toothis instance of hello split-merge service.</span></span> <span data-ttu-id="d0af4-267">Fornisce le seguenti informazioni per ogni richiesta hello:</span><span class="sxs-lookup"><span data-stu-id="d0af4-267">It gives hello following information for each request:</span></span>

* <span data-ttu-id="d0af4-268">**Timestamp**: hello ora e data di inizio richiesta hello.</span><span class="sxs-lookup"><span data-stu-id="d0af4-268">**Timestamp**: hello time and date when hello request was started.</span></span>
* <span data-ttu-id="d0af4-269">**ID operazione**: un GUID che identifica in modo univoco la richiesta hello.</span><span class="sxs-lookup"><span data-stu-id="d0af4-269">**OperationId**: A GUID that uniquely identifies hello request.</span></span> <span data-ttu-id="d0af4-270">Questa richiesta può essere anche usato toocancel hello operazione mentre è ancora in corso.</span><span class="sxs-lookup"><span data-stu-id="d0af4-270">This request can also be used toocancel hello operation while it is still ongoing.</span></span>
* <span data-ttu-id="d0af4-271">**Stato**: hello stato corrente della richiesta di hello.</span><span class="sxs-lookup"><span data-stu-id="d0af4-271">**Status**: hello current state of hello request.</span></span> <span data-ttu-id="d0af4-272">Per le richieste in corso, vengono anche elencate hello fase corrente in cui hello è richiesta.</span><span class="sxs-lookup"><span data-stu-id="d0af4-272">For ongoing requests, it also lists hello current phase in which hello request is.</span></span>
* <span data-ttu-id="d0af4-273">**CancelRequest**: un flag che indica se la richiesta hello è stata annullata.</span><span class="sxs-lookup"><span data-stu-id="d0af4-273">**CancelRequest**: A flag that indicates whether hello request has been cancelled.</span></span>
* <span data-ttu-id="d0af4-274">**Lo stato di avanzamento**: una stima della percentuale di completamento per l'operazione di hello.</span><span class="sxs-lookup"><span data-stu-id="d0af4-274">**Progress**: A percentage estimate of completion for hello operation.</span></span> <span data-ttu-id="d0af4-275">Un valore pari a 50 indica che l'operazione di hello è circa il 50% completato.</span><span class="sxs-lookup"><span data-stu-id="d0af4-275">A value of 50 indicates that hello operation is approximately 50% complete.</span></span>
* <span data-ttu-id="d0af4-276">**Details**: valore XML che fornisce un report di stato più dettagliato.</span><span class="sxs-lookup"><span data-stu-id="d0af4-276">**Details**: An XML value that provides a more detailed progress report.</span></span> <span data-ttu-id="d0af4-277">report stato di avanzamento Hello viene aggiornato periodicamente come set di righe vengono copiate dal tootarget di origine.</span><span class="sxs-lookup"><span data-stu-id="d0af4-277">hello progress report is periodically updated as sets of rows are copied from source tootarget.</span></span> <span data-ttu-id="d0af4-278">In caso di errori o eccezioni, questa colonna include inoltre informazioni più dettagliate sull'errore hello.</span><span class="sxs-lookup"><span data-stu-id="d0af4-278">In case of failures or exceptions, this column also includes more detailed information about hello failure.</span></span>

### <a name="azure-diagnostics"></a><span data-ttu-id="d0af4-279">Diagnostica Azure</span><span class="sxs-lookup"><span data-stu-id="d0af4-279">Azure Diagnostics</span></span>
<span data-ttu-id="d0af4-280">il servizio di suddivisione unione Hello Usa diagnostica Azure basato su Azure SDK 2.5 per il monitoraggio e diagnostica.</span><span class="sxs-lookup"><span data-stu-id="d0af4-280">hello split-merge service uses Azure Diagnostics based on Azure SDK 2.5 for monitoring and diagnostics.</span></span> <span data-ttu-id="d0af4-281">Controllare la configurazione di diagnostica hello come illustrato qui: [abilitazione di diagnostica in servizi Cloud di Azure e macchine virtuali](../cloud-services/cloud-services-dotnet-diagnostics.md).</span><span class="sxs-lookup"><span data-stu-id="d0af4-281">You control hello diagnostics configuration as explained here: [Enabling Diagnostics in Azure Cloud Services and Virtual Machines](../cloud-services/cloud-services-dotnet-diagnostics.md).</span></span> <span data-ttu-id="d0af4-282">pacchetto di download Hello include due configurazioni di diagnostica - uno per ruolo web hello e uno per il ruolo di lavoro hello.</span><span class="sxs-lookup"><span data-stu-id="d0af4-282">hello download package includes two diagnostics configurations - one for hello web role and one for hello worker role.</span></span> <span data-ttu-id="d0af4-283">Queste configurazioni di diagnostica per il servizio hello attenersi alle linee guida hello [nozioni di base del servizio Cloud in Microsoft Azure](https://code.msdn.microsoft.com/windowsazure/Cloud-Service-Fundamentals-4ca72649).</span><span class="sxs-lookup"><span data-stu-id="d0af4-283">These diagnostics configurations for hello service follow hello guidance from [Cloud Service Fundamentals in Microsoft Azure](https://code.msdn.microsoft.com/windowsazure/Cloud-Service-Fundamentals-4ca72649).</span></span> <span data-ttu-id="d0af4-284">Include hello definizioni toolog i contatori delle prestazioni, log IIS, registri eventi di Windows e registri eventi applicazioni di unione di menu combinato.</span><span class="sxs-lookup"><span data-stu-id="d0af4-284">It includes hello definitions toolog Performance Counters, IIS logs, Windows Event Logs, and split-merge application event logs.</span></span> 

## <a name="deploy-diagnostics"></a><span data-ttu-id="d0af4-285">Distribuire la diagnostica</span><span class="sxs-lookup"><span data-stu-id="d0af4-285">Deploy Diagnostics</span></span>
<span data-ttu-id="d0af4-286">tooenable il monitoraggio e diagnostica usando la configurazione di diagnostica hello per i ruoli di lavoro e web hello forniti dal pacchetto NuGet hello, eseguire hello comandi usando Azure PowerShell seguente:</span><span class="sxs-lookup"><span data-stu-id="d0af4-286">tooenable monitoring and diagnostics using hello diagnostic configuration for hello web and worker roles provided by hello NuGet package, run hello following commands using Azure PowerShell:</span></span> 

    $storage_name = "<YourAzureStorageAccount>" 

    $key = "<YourAzureStorageAccountKey" 

    $storageContext = New-AzureStorageContext -StorageAccountName $storage_name -StorageAccountKey $key  


    $config_path = "<YourFilePath>\SplitMergeWebContent.diagnostics.xml" 

    $service_name = "<YourCloudServiceName>" 

    Set-AzureServiceDiagnosticsExtension -StorageContext $storageContext -DiagnosticsConfigurationPath $config_path -ServiceName $service_name -Slot Production -Role "SplitMergeWeb" 


    $config_path = "<YourFilePath>\SplitMergeWorkerContent.diagnostics.xml" 

    $service_name = "<YourCloudServiceName>" 

    Set-AzureServiceDiagnosticsExtension -StorageContext $storageContext -DiagnosticsConfigurationPath $config_path -ServiceName $service_name -Slot Production -Role "SplitMergeWorker" 

<span data-ttu-id="d0af4-287">È possibile trovare ulteriori informazioni su come tooconfigure e distribuire le impostazioni di diagnostica: [abilitazione di diagnostica in servizi Cloud di Azure e macchine virtuali](../cloud-services/cloud-services-dotnet-diagnostics.md).</span><span class="sxs-lookup"><span data-stu-id="d0af4-287">You can find more information on how tooconfigure and deploy diagnostics settings here: [Enabling Diagnostics in Azure Cloud Services and Virtual Machines](../cloud-services/cloud-services-dotnet-diagnostics.md).</span></span> 

## <a name="retrieve-diagnostics"></a><span data-ttu-id="d0af4-288">Recuperare la diagnostica</span><span class="sxs-lookup"><span data-stu-id="d0af4-288">Retrieve diagnostics</span></span>
<span data-ttu-id="d0af4-289">È possibile accedere facilmente i dati di diagnostica da hello Esplora Server Visual Studio in Azure parte della struttura ad albero di Esplora Server hello hello.</span><span class="sxs-lookup"><span data-stu-id="d0af4-289">You can easily access your diagnostics from hello Visual Studio Server Explorer in hello Azure part of hello Server Explorer tree.</span></span> <span data-ttu-id="d0af4-290">Aprire un'istanza di Visual Studio e sulla barra dei menu hello fare clic su Visualizza e a Esplora Server.</span><span class="sxs-lookup"><span data-stu-id="d0af4-290">Open a Visual Studio instance, and in hello menu bar click View, and Server Explorer.</span></span> <span data-ttu-id="d0af4-291">Fare clic su hello icona Azure tooconnect tooyour sottoscrizione di Azure.</span><span class="sxs-lookup"><span data-stu-id="d0af4-291">Click hello Azure icon tooconnect tooyour Azure subscription.</span></span> <span data-ttu-id="d0af4-292">Passare quindi tooAzure -> archiviazione -> <your storage account> -> tabelle -> WADLogsTable.</span><span class="sxs-lookup"><span data-stu-id="d0af4-292">Then navigate tooAzure -> Storage -> <your storage account> -> Tables -> WADLogsTable.</span></span> <span data-ttu-id="d0af4-293">Per altre informazioni, vedere [Esplorazione delle risorse di archiviazione con Esplora server](http://msdn.microsoft.com/library/azure/ff683677.aspx).</span><span class="sxs-lookup"><span data-stu-id="d0af4-293">For more information, see [Browsing Storage Resources with Server Explorer](http://msdn.microsoft.com/library/azure/ff683677.aspx).</span></span> 

![WADLogsTable][2]

<span data-ttu-id="d0af4-295">Hello WADLogsTable evidenziati nella figura hello precedente contiene hello eventi dal registro applicazioni del servizio di suddivisione unione hello dettagliati.</span><span class="sxs-lookup"><span data-stu-id="d0af4-295">hello WADLogsTable highlighted in hello figure above contains hello detailed events from hello split-merge service’s application log.</span></span> <span data-ttu-id="d0af4-296">Si noti che la configurazione predefinita hello di hello scaricato pacchetto si concentri su una distribuzione di produzione.</span><span class="sxs-lookup"><span data-stu-id="d0af4-296">Note that hello default configuration of hello downloaded package is geared towards a production deployment.</span></span> <span data-ttu-id="d0af4-297">Pertanto intervallo hello vengono estratti i registri e i contatori da istanze del servizio hello è di grandi dimensioni (5 minuti).</span><span class="sxs-lookup"><span data-stu-id="d0af4-297">Therefore hello interval at which logs and counters are pulled from hello service instances is large (5 minutes).</span></span> <span data-ttu-id="d0af4-298">Per sviluppo e test, è necessario inferiore intervallo hello modificando le impostazioni di diagnostica hello di web hello o tooyour ruolo di lavoro hello.</span><span class="sxs-lookup"><span data-stu-id="d0af4-298">For test and development, lower hello interval by adjusting hello diagnostics settings of hello web or hello worker role tooyour needs.</span></span> <span data-ttu-id="d0af4-299">Fare clic sul ruolo hello in hello Esplora Server di Visual Studio (vedere sopra), quindi modificare hello periodo di trasferimento nella finestra di dialogo di hello per le impostazioni di configurazione di diagnostica hello:</span><span class="sxs-lookup"><span data-stu-id="d0af4-299">Right-click on hello role in hello Visual Studio Server Explorer (see above) and then adjust hello Transfer Period in hello dialog for hello Diagnostics configuration settings:</span></span> 

![Configurazione][3]

## <a name="performance"></a><span data-ttu-id="d0af4-301">Prestazioni</span><span class="sxs-lookup"><span data-stu-id="d0af4-301">Performance</span></span>
<span data-ttu-id="d0af4-302">In generale, prestazioni migliori sono toobe previsto dal hello superiore, più i livelli di servizio ad alte prestazioni nel Database SQL di Azure.</span><span class="sxs-lookup"><span data-stu-id="d0af4-302">In general, better performance is toobe expected from hello higher, more performant service tiers in Azure SQL Database.</span></span> <span data-ttu-id="d0af4-303">Superiore delle allocazioni dei / o, memoria e CPU per i livelli di servizio superiore hello vantaggio hello la copia bulk e le operazioni che Usa servizio di suddivisione unione hello di eliminazione.</span><span class="sxs-lookup"><span data-stu-id="d0af4-303">Higher IO, CPU and memory allocations for hello higher service tiers benefit hello bulk copy and delete operations that hello split-merge service uses.</span></span> <span data-ttu-id="d0af4-304">Per questo motivo, aumentare il livello di servizio hello solo per i database per un periodo di tempo definito limitato.</span><span class="sxs-lookup"><span data-stu-id="d0af4-304">For that reason, increase hello service tier just for those databases for a defined, limited period of time.</span></span>

<span data-ttu-id="d0af4-305">servizio Hello esegue inoltre query convalida come parte delle normale operazioni.</span><span class="sxs-lookup"><span data-stu-id="d0af4-305">hello service also performs validation queries as part of its normal operations.</span></span> <span data-ttu-id="d0af4-306">Queste query convalida controllare imprevisto presenza di dati nell'intervallo di destinazione hello e assicurarsi che qualsiasi operazione di suddivisione/unione/spostamento inizia da uno stato coerente.</span><span class="sxs-lookup"><span data-stu-id="d0af4-306">These validation queries check for unexpected presence of data in hello target range and ensure that any split/merge/move operation starts from a consistent state.</span></span> <span data-ttu-id="d0af4-307">Queste query tutti funzionano su intervalli di chiavi di partizionamento orizzontale definiti dall'ambito di hello dell'operazione di hello e dimensioni di batch hello fornite come parte della definizione di richiesta di hello.</span><span class="sxs-lookup"><span data-stu-id="d0af4-307">These queries all work over sharding key ranges defined by hello scope of hello operation and hello batch size provided as part of hello request definition.</span></span> <span data-ttu-id="d0af4-308">Queste query prestazioni ottimali quando un indice è presente con la chiave di partizionamento orizzontale hello hello colonna iniziale.</span><span class="sxs-lookup"><span data-stu-id="d0af4-308">These queries perform best when an index is present that has hello sharding key as hello leading column.</span></span> 

<span data-ttu-id="d0af4-309">Inoltre, una proprietà di univocità con la chiave di partizionamento orizzontale hello come colonna iniziale hello consentirà hello servizio toouse un approccio ottimizzato che limita il consumo di risorse in termini di memoria e spazio del log.</span><span class="sxs-lookup"><span data-stu-id="d0af4-309">In addition, a uniqueness property with hello sharding key as hello leading column will allow hello service toouse an optimized approach that limits resource consumption in terms of log space and memory.</span></span> <span data-ttu-id="d0af4-310">Questa proprietà di unicità è necessario toomove le dimensioni di dati di grandi dimensioni (in genere superiore a 1GB).</span><span class="sxs-lookup"><span data-stu-id="d0af4-310">This uniqueness property is required toomove large data sizes (typically above 1GB).</span></span> 

## <a name="how-tooupgrade"></a><span data-ttu-id="d0af4-311">Come tooupgrade</span><span class="sxs-lookup"><span data-stu-id="d0af4-311">How tooupgrade</span></span>
1. <span data-ttu-id="d0af4-312">Seguire i passaggi di hello in [distribuire un servizio di suddivisione unione](sql-database-elastic-scale-configure-deploy-split-and-merge.md).</span><span class="sxs-lookup"><span data-stu-id="d0af4-312">Follow hello steps in [Deploy a split-merge service](sql-database-elastic-scale-configure-deploy-split-and-merge.md).</span></span>
2. <span data-ttu-id="d0af4-313">Modificare il file di configurazione del servizio cloud per il distribuzione di suddivisione unione tooreflect hello nuovi parametri di configurazione.</span><span class="sxs-lookup"><span data-stu-id="d0af4-313">Change your cloud service configuration file for your split-merge deployment tooreflect hello new configuration parameters.</span></span> <span data-ttu-id="d0af4-314">Un nuovo parametro richiesto è informazioni hello sul certificato di hello utilizzato per la crittografia.</span><span class="sxs-lookup"><span data-stu-id="d0af4-314">A new required parameter is hello information about hello certificate used for encryption.</span></span> <span data-ttu-id="d0af4-315">Un modo semplice di toodo toocompare hello nuova configurazione file di modello dal download hello contro la configurazione esistente.</span><span class="sxs-lookup"><span data-stu-id="d0af4-315">An easy way toodo this is toocompare hello new configuration template file from hello download against your existing configuration.</span></span> <span data-ttu-id="d0af4-316">Assicurarsi di aggiungere le impostazioni di hello per "DataEncryptionPrimaryCertificateThumbprint" e "DataEncryptionPrimary" per il ruolo di lavoro hello e web hello.</span><span class="sxs-lookup"><span data-stu-id="d0af4-316">Make sure you add hello settings for “DataEncryptionPrimaryCertificateThumbprint” and “DataEncryptionPrimary” for both hello web and hello worker role.</span></span>
3. <span data-ttu-id="d0af4-317">Prima di distribuire hello tooAzure di aggiornamento, assicurarsi che vengono completate tutte le operazioni split-merge attualmente in esecuzione.</span><span class="sxs-lookup"><span data-stu-id="d0af4-317">Before deploying hello update tooAzure, ensure that all currently running split-merge operations have finished.</span></span> <span data-ttu-id="d0af4-318">È possibile farlo facilmente eseguendo query sulle tabelle di RequestStatus e PendingWorkflows hello nel database dei metadati di merge di divisione hello per le richieste in corso.</span><span class="sxs-lookup"><span data-stu-id="d0af4-318">You can easily do this by querying hello RequestStatus and PendingWorkflows tables in hello split-merge metadata database for ongoing requests.</span></span>
4. <span data-ttu-id="d0af4-319">Aggiornare la distribuzione del servizio cloud esistente per l'unione di menu combinato nella sottoscrizione di Azure con il nuovo pacchetto di hello e il file di configurazione di servizio aggiornato.</span><span class="sxs-lookup"><span data-stu-id="d0af4-319">Update your existing cloud service deployment for split-merge in your Azure subscription with hello new package and your updated service configuration file.</span></span>

<span data-ttu-id="d0af4-320">Non è necessario tooprovision un nuovo database di metadati per l'unione di menu combinato tooupgrade.</span><span class="sxs-lookup"><span data-stu-id="d0af4-320">You do not need tooprovision a new metadata database for split-merge tooupgrade.</span></span> <span data-ttu-id="d0af4-321">nuova versione di Hello comporta l'aggiornamento automatico dei metadati del database toohello nuova versione esistente.</span><span class="sxs-lookup"><span data-stu-id="d0af4-321">hello new version will automatically upgrade your existing metadata database toohello new version.</span></span> 

## <a name="best-practices--troubleshooting"></a><span data-ttu-id="d0af4-322">Procedure consigliate e risoluzione dei problemi</span><span class="sxs-lookup"><span data-stu-id="d0af4-322">Best practices & troubleshooting</span></span>
* <span data-ttu-id="d0af4-323">Definire un tenant di prova e sperimentare le principali operazioni di suddivisione/unione/spostamento con tenant di prova hello tra partizioni diverse.</span><span class="sxs-lookup"><span data-stu-id="d0af4-323">Define a test tenant and exercise your most important split/merge/move operations with hello test tenant across several shards.</span></span> <span data-ttu-id="d0af4-324">Verificare che tutti i metadati sia definito correttamente nella mappa partizioni e che le operazioni di hello non violino i vincoli o le chiavi esterne.</span><span class="sxs-lookup"><span data-stu-id="d0af4-324">Ensure that all metadata is defined correctly in your shard map and that hello operations do not violate constraints or foreign keys.</span></span>
* <span data-ttu-id="d0af4-325">Dimensioni dei dati tenant test hello Keep sopra hello dimensione massima di dati più grande tenant tooensure non si è verificato la dimensione dei dati correlati.</span><span class="sxs-lookup"><span data-stu-id="d0af4-325">Keep hello test tenant data size above hello maximum data size of your largest tenant tooensure you are not encountering data size related issues.</span></span> <span data-ttu-id="d0af4-326">Ciò consente di valutare hello tempo toomove un singolo tenant intorno a un limite superiore.</span><span class="sxs-lookup"><span data-stu-id="d0af4-326">This helps you assess an upper bound on hello time it takes toomove a single tenant around.</span></span> 
* <span data-ttu-id="d0af4-327">Assicurarsi che lo schema consenta le eliminazioni.</span><span class="sxs-lookup"><span data-stu-id="d0af4-327">Make sure that your schema allows deletions.</span></span> <span data-ttu-id="d0af4-328">il servizio di suddivisione unione Hello richiede dei dati dalla partizione di origine hello tooremove possibilità hello dopo aver copiato toohello destinazione dati hello.</span><span class="sxs-lookup"><span data-stu-id="d0af4-328">hello split-merge service requires hello ability tooremove data from hello source shard once hello data has been successfully copied toohello target.</span></span> <span data-ttu-id="d0af4-329">Ad esempio, **trigger delete** può impedire l'eliminazione di dati hello origine hello servizio hello e potrebbe essere toofail operazioni.</span><span class="sxs-lookup"><span data-stu-id="d0af4-329">For example, **delete triggers** can prevent hello service from deleting hello data on hello source and may cause operations toofail.</span></span>
* <span data-ttu-id="d0af4-330">chiave di partizionamento orizzontale Hello deve essere la colonna iniziale di hello la chiave primaria o una definizione di indice univoco.</span><span class="sxs-lookup"><span data-stu-id="d0af4-330">hello sharding key should be hello leading column in your primary key or unique index definition.</span></span> <span data-ttu-id="d0af4-331">Questo garantisce prestazioni ottimali hello hello query convalida divisione o di unione e per hello operazioni lo spostamento e l'eliminazione di dati effettivi che funzionano sempre in intervalli di chiavi di partizionamento orizzontale.</span><span class="sxs-lookup"><span data-stu-id="d0af4-331">That ensures hello best performance for hello split or merge validation queries, and for hello actual data movement and deletion operations which always operate on sharding key ranges.</span></span>
* <span data-ttu-id="d0af4-332">Colloca il servizio di suddivisione unione nel centro dati e area in cui si trovano i database, hello.</span><span class="sxs-lookup"><span data-stu-id="d0af4-332">Collocate your split-merge service in hello region and data center where your databases reside.</span></span> 

[!INCLUDE [elastic-scale-include](../../includes/elastic-scale-include.md)]

<!--Anchors-->
<!--Image references-->
[1]:./media/sql-database-elastic-scale-overview-split-and-merge/split-merge-overview.png
[2]:./media/sql-database-elastic-scale-overview-split-and-merge/diagnostics.png
[3]:./media/sql-database-elastic-scale-overview-split-and-merge/diagnostics-config.png

