---
title: aaaHow tooupdate un servizio cloud | Documenti Microsoft
description: "Informazioni su come dei servizi cloud tooupdate in Azure. Informazioni su modalità di prosecuzione tooensure disponibilità di un aggiornamento in un servizio cloud."
services: cloud-services
documentationcenter: 
author: Thraka
manager: timlt
editor: 
ms.assetid: c6a8b5e6-5c99-454c-9911-5c7ae8d1af63
ms.service: cloud-services
ms.workload: tbd
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 04/19/2017
ms.author: adegeo
ms.openlocfilehash: 7e4c8bd46e51a555b4309ea8927d120e8efcf0ea
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/06/2017
---
# <a name="how-tooupdate-a-cloud-service"></a><span data-ttu-id="7229c-104">Come tooupdate un servizio cloud</span><span class="sxs-lookup"><span data-stu-id="7229c-104">How tooupdate a cloud service</span></span>

<span data-ttu-id="7229c-105">L'aggiornamento di un servizio cloud, inclusi i ruoli e il sistema operativo guest, è un processo in tre passaggi.</span><span class="sxs-lookup"><span data-stu-id="7229c-105">Updating a cloud service, including both its roles and guest OS, is a three step process.</span></span> <span data-ttu-id="7229c-106">Innanzitutto, i file binari hello e file di configurazione per hello nuovo servizio cloud o versione del sistema operativo deve essere caricato.</span><span class="sxs-lookup"><span data-stu-id="7229c-106">First, hello binaries and configuration files for hello new cloud service or OS version must be uploaded.</span></span> <span data-ttu-id="7229c-107">Successivamente, Azure riserva risorse di calcolo e rete per il servizio cloud hello in base ai requisiti di hello della nuova versione del servizio cloud hello.</span><span class="sxs-lookup"><span data-stu-id="7229c-107">Next, Azure reserves compute and network resources for hello cloud service based on hello requirements of hello new cloud service version.</span></span> <span data-ttu-id="7229c-108">Infine, Azure esegue una sequenza tooincrementally aggiornamento hello tenant toohello nuova versione di aggiornamento o guest del sistema operativo, mantenendo la disponibilità.</span><span class="sxs-lookup"><span data-stu-id="7229c-108">Finally, Azure performs a rolling upgrade tooincrementally update hello tenant toohello new version or guest OS, while preserving your availability.</span></span> <span data-ttu-id="7229c-109">Questo articolo illustra i dettagli di hello di quest'ultimo passaggio: hello aggiornamento in sequenza.</span><span class="sxs-lookup"><span data-stu-id="7229c-109">This article discusses hello details of this last step – hello rolling upgrade.</span></span>

## <a name="update-an-azure-service"></a><span data-ttu-id="7229c-110">Aggiornare un servizio di Azure</span><span class="sxs-lookup"><span data-stu-id="7229c-110">Update an Azure Service</span></span>
<span data-ttu-id="7229c-111">Azure organizza le istanze del ruolo in raggruppamenti logici chiamati domini di aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="7229c-111">Azure organizes your role instances into logical groupings called upgrade domains (UD).</span></span> <span data-ttu-id="7229c-112">I domini di aggiornamento sono set logici di istanze del ruolo aggiornate come gruppo.</span><span class="sxs-lookup"><span data-stu-id="7229c-112">Upgrade domains (UD) are logical sets of role instances that are updated as a group.</span></span>  <span data-ttu-id="7229c-113">Gli aggiornamenti di Azure a cloud service uno UD alla volta, consentendo agli altri toocontinue UD del traffico di istanze.</span><span class="sxs-lookup"><span data-stu-id="7229c-113">Azure updates a cloud service one UD at a time, which allows instances in other UDs toocontinue serving traffic.</span></span>

<span data-ttu-id="7229c-114">numero di domini di aggiornamento predefinito Hello è 5.</span><span class="sxs-lookup"><span data-stu-id="7229c-114">hello default number of upgrade domains is 5.</span></span> <span data-ttu-id="7229c-115">È possibile specificare un numero diverso di domini di aggiornamento includendo l'attributo upgradeDomainCount hello nel file di definizione del servizio hello (con estensione csdef).</span><span class="sxs-lookup"><span data-stu-id="7229c-115">You can specify a different number of upgrade domains by including hello upgradeDomainCount attribute in hello service’s definition file (.csdef).</span></span> <span data-ttu-id="7229c-116">Per ulteriori informazioni sull'attributo upgradeDomainCount hello, vedere [WebRole Schema](https://msdn.microsoft.com/library/azure/gg557553.aspx) o [WorkerRole Schema](https://msdn.microsoft.com/library/azure/gg557552.aspx).</span><span class="sxs-lookup"><span data-stu-id="7229c-116">For more information about hello upgradeDomainCount attribute, see [WebRole Schema](https://msdn.microsoft.com/library/azure/gg557553.aspx) or [WorkerRole Schema](https://msdn.microsoft.com/library/azure/gg557552.aspx).</span></span>

<span data-ttu-id="7229c-117">Quando si esegue un aggiornamento sul posto di uno o più ruoli nel servizio, Azure Aggiorna set di istanze del ruolo in base toowhich di dominio di aggiornamento toohello che appartengono.</span><span class="sxs-lookup"><span data-stu-id="7229c-117">When you perform an in-place update of one or more roles in your service, Azure updates sets of role instances according toohello upgrade domain toowhich they belong.</span></span> <span data-ttu-id="7229c-118">Dominio successivo hello passa quindi tutte le istanze di hello in un dato dominio di aggiornamento arrestarli, aggiornarle, riportarle eseguire il backup, gli aggiornamenti di Azure.</span><span class="sxs-lookup"><span data-stu-id="7229c-118">Azure updates all of hello instances in a given upgrade domain – stopping them, updating them, bringing them back on-line – then moves onto hello next domain.</span></span> <span data-ttu-id="7229c-119">Arrestando solo le istanze di hello in esecuzione in hello corrente di dominio di aggiornamento, Azure garantisce che si verifica un aggiornamento con hello minimo impatto toohello in esecuzione del servizio.</span><span class="sxs-lookup"><span data-stu-id="7229c-119">By stopping only hello instances running in hello current upgrade domain, Azure makes sure that an update occurs with hello least possible impact toohello running service.</span></span> <span data-ttu-id="7229c-120">Per ulteriori informazioni, vedere [come continuazione dell'aggiornamento hello](#howanupgradeproceeds) più avanti in questo articolo.</span><span class="sxs-lookup"><span data-stu-id="7229c-120">For more information, see [How hello update proceeds](#howanupgradeproceeds) later in this article.</span></span>

> [!NOTE]
> <span data-ttu-id="7229c-121">Mentre i termini di hello **aggiornare** e **aggiornamento** assumere significati leggermente diversi nel contesto di hello Azure, possono essere utilizzate indifferentemente per i processi di hello e le descrizioni delle funzionalità di hello in questo documento.</span><span class="sxs-lookup"><span data-stu-id="7229c-121">While hello terms **update** and **upgrade** have slightly different meaning in hello context Azure, they can be used interchangeably for hello processes and descriptions of hello features in this document.</span></span>
>
>

<span data-ttu-id="7229c-122">Il servizio è necessario definire almeno due istanze di un ruolo per tale ruolo toobe aggiornati sul posto senza tempo di inattività.</span><span class="sxs-lookup"><span data-stu-id="7229c-122">Your service must define at least two instances of a role for that role toobe updated in-place without downtime.</span></span> <span data-ttu-id="7229c-123">Se il servizio di hello costituito dal solo un'istanza di un ruolo, il servizio sarà disponibile finché non hello aggiornamento sul posto è terminata.</span><span class="sxs-lookup"><span data-stu-id="7229c-123">If hello service consists of only one instance of one role, your service will be unavailable until hello in-place update has finished.</span></span>

<span data-ttu-id="7229c-124">In questo argomento vengono illustrate le seguenti informazioni sugli aggiornamenti Azure hello:</span><span class="sxs-lookup"><span data-stu-id="7229c-124">This topic covers hello following information about Azure updates:</span></span>

* [<span data-ttu-id="7229c-125">Modifiche consentite al servizio durante un aggiornamento</span><span class="sxs-lookup"><span data-stu-id="7229c-125">Allowed service changes during an update</span></span>](#AllowedChanges)
* [<span data-ttu-id="7229c-126">Come avviene un aggiornamento</span><span class="sxs-lookup"><span data-stu-id="7229c-126">How an upgrade proceeds</span></span>](#howanupgradeproceeds)
* [<span data-ttu-id="7229c-127">Ripristino dello stato precedente di un aggiornamento</span><span class="sxs-lookup"><span data-stu-id="7229c-127">Rollback of an update</span></span>](#RollbackofanUpdate)
* [<span data-ttu-id="7229c-128">Avvio di più operazioni di mutazione durante una distribuzione</span><span class="sxs-lookup"><span data-stu-id="7229c-128">Initiating multiple mutating operations on an ongoing deployment</span></span>](#multiplemutatingoperations)
* [<span data-ttu-id="7229c-129">Distribuzione di ruoli nei domini di aggiornamento</span><span class="sxs-lookup"><span data-stu-id="7229c-129">Distribution of roles across upgrade domains</span></span>](#distributiondfroles)

<a name="AllowedChanges"></a>

## <a name="allowed-service-changes-during-an-update"></a><span data-ttu-id="7229c-130">Modifiche consentite al servizio durante un aggiornamento</span><span class="sxs-lookup"><span data-stu-id="7229c-130">Allowed service changes during an update</span></span>
<span data-ttu-id="7229c-131">Hello nella tabella seguente viene illustrato come hello consentita modifiche servizio tooa durante un aggiornamento:</span><span class="sxs-lookup"><span data-stu-id="7229c-131">hello following table shows hello allowed changes tooa service during an update:</span></span>

| <span data-ttu-id="7229c-132">Modifiche consentite toohosting, servizi e ruoli</span><span class="sxs-lookup"><span data-stu-id="7229c-132">Changes permitted toohosting, services, and roles</span></span> | <span data-ttu-id="7229c-133">Aggiornamento sul posto</span><span class="sxs-lookup"><span data-stu-id="7229c-133">In-place update</span></span> | <span data-ttu-id="7229c-134">Gestione temporanea (scambio indirizzi VIP)</span><span class="sxs-lookup"><span data-stu-id="7229c-134">Staged (VIP swap)</span></span> | <span data-ttu-id="7229c-135">Eliminazione e ridistribuzione</span><span class="sxs-lookup"><span data-stu-id="7229c-135">Delete and re-deploy</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="7229c-136">Versione del sistema operativo</span><span class="sxs-lookup"><span data-stu-id="7229c-136">Operating system version</span></span> |<span data-ttu-id="7229c-137">Sì</span><span class="sxs-lookup"><span data-stu-id="7229c-137">Yes</span></span> |<span data-ttu-id="7229c-138">Sì</span><span class="sxs-lookup"><span data-stu-id="7229c-138">Yes</span></span> |<span data-ttu-id="7229c-139">Sì</span><span class="sxs-lookup"><span data-stu-id="7229c-139">Yes</span></span> |
| <span data-ttu-id="7229c-140">Livello di attendibilità .NET</span><span class="sxs-lookup"><span data-stu-id="7229c-140">.NET trust level</span></span> |<span data-ttu-id="7229c-141">Sì</span><span class="sxs-lookup"><span data-stu-id="7229c-141">Yes</span></span> |<span data-ttu-id="7229c-142">Sì</span><span class="sxs-lookup"><span data-stu-id="7229c-142">Yes</span></span> |<span data-ttu-id="7229c-143">Sì</span><span class="sxs-lookup"><span data-stu-id="7229c-143">Yes</span></span> |
| <span data-ttu-id="7229c-144">Dimensioni macchina virtuale<sup>1</sup></span><span class="sxs-lookup"><span data-stu-id="7229c-144">Virtual machine size<sup>1</sup></span></span> |<span data-ttu-id="7229c-145">Sì<sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="7229c-145">Yes<sup>2</sup></span></span> |<span data-ttu-id="7229c-146">Sì</span><span class="sxs-lookup"><span data-stu-id="7229c-146">Yes</span></span> |<span data-ttu-id="7229c-147">Sì</span><span class="sxs-lookup"><span data-stu-id="7229c-147">Yes</span></span> |
| <span data-ttu-id="7229c-148">Impostazioni di archiviazione locali</span><span class="sxs-lookup"><span data-stu-id="7229c-148">Local storage settings</span></span> |<span data-ttu-id="7229c-149">Solo aumento<sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="7229c-149">Increase only<sup>2</sup></span></span> |<span data-ttu-id="7229c-150">Sì</span><span class="sxs-lookup"><span data-stu-id="7229c-150">Yes</span></span> |<span data-ttu-id="7229c-151">Sì</span><span class="sxs-lookup"><span data-stu-id="7229c-151">Yes</span></span> |
| <span data-ttu-id="7229c-152">Aggiungere o rimuovere ruoli in un servizio</span><span class="sxs-lookup"><span data-stu-id="7229c-152">Add or remove roles in a service</span></span> |<span data-ttu-id="7229c-153">Sì</span><span class="sxs-lookup"><span data-stu-id="7229c-153">Yes</span></span> |<span data-ttu-id="7229c-154">Sì</span><span class="sxs-lookup"><span data-stu-id="7229c-154">Yes</span></span> |<span data-ttu-id="7229c-155">Sì</span><span class="sxs-lookup"><span data-stu-id="7229c-155">Yes</span></span> |
| <span data-ttu-id="7229c-156">Numero di istanze di un particolare ruolo</span><span class="sxs-lookup"><span data-stu-id="7229c-156">Number of instances of a particular role</span></span> |<span data-ttu-id="7229c-157">Sì</span><span class="sxs-lookup"><span data-stu-id="7229c-157">Yes</span></span> |<span data-ttu-id="7229c-158">Sì</span><span class="sxs-lookup"><span data-stu-id="7229c-158">Yes</span></span> |<span data-ttu-id="7229c-159">Sì</span><span class="sxs-lookup"><span data-stu-id="7229c-159">Yes</span></span> |
| <span data-ttu-id="7229c-160">Numero o tipo di endpoint per un servizio</span><span class="sxs-lookup"><span data-stu-id="7229c-160">Number or type of endpoints for a service</span></span> |<span data-ttu-id="7229c-161">Sì<sup>2</sup></span><span class="sxs-lookup"><span data-stu-id="7229c-161">Yes<sup>2</sup></span></span> |<span data-ttu-id="7229c-162">No</span><span class="sxs-lookup"><span data-stu-id="7229c-162">No</span></span> |<span data-ttu-id="7229c-163">Sì</span><span class="sxs-lookup"><span data-stu-id="7229c-163">Yes</span></span> |
| <span data-ttu-id="7229c-164">Nomi e i valori delle impostazioni di configurazione</span><span class="sxs-lookup"><span data-stu-id="7229c-164">Names and values of configuration settings</span></span> |<span data-ttu-id="7229c-165">Sì</span><span class="sxs-lookup"><span data-stu-id="7229c-165">Yes</span></span> |<span data-ttu-id="7229c-166">Sì</span><span class="sxs-lookup"><span data-stu-id="7229c-166">Yes</span></span> |<span data-ttu-id="7229c-167">Sì</span><span class="sxs-lookup"><span data-stu-id="7229c-167">Yes</span></span> |
| <span data-ttu-id="7229c-168">Valori (ma non nomi) delle impostazioni di configurazione</span><span class="sxs-lookup"><span data-stu-id="7229c-168">Values (but not names) of configuration settings</span></span> |<span data-ttu-id="7229c-169">Sì</span><span class="sxs-lookup"><span data-stu-id="7229c-169">Yes</span></span> |<span data-ttu-id="7229c-170">Sì</span><span class="sxs-lookup"><span data-stu-id="7229c-170">Yes</span></span> |<span data-ttu-id="7229c-171">Sì</span><span class="sxs-lookup"><span data-stu-id="7229c-171">Yes</span></span> |
| <span data-ttu-id="7229c-172">Aggiungere nuovi certificati</span><span class="sxs-lookup"><span data-stu-id="7229c-172">Add new certificates</span></span> |<span data-ttu-id="7229c-173">Sì</span><span class="sxs-lookup"><span data-stu-id="7229c-173">Yes</span></span> |<span data-ttu-id="7229c-174">Sì</span><span class="sxs-lookup"><span data-stu-id="7229c-174">Yes</span></span> |<span data-ttu-id="7229c-175">Sì</span><span class="sxs-lookup"><span data-stu-id="7229c-175">Yes</span></span> |
| <span data-ttu-id="7229c-176">Modificare i certificati esistenti</span><span class="sxs-lookup"><span data-stu-id="7229c-176">Change existing certificates</span></span> |<span data-ttu-id="7229c-177">Sì</span><span class="sxs-lookup"><span data-stu-id="7229c-177">Yes</span></span> |<span data-ttu-id="7229c-178">Sì</span><span class="sxs-lookup"><span data-stu-id="7229c-178">Yes</span></span> |<span data-ttu-id="7229c-179">Sì</span><span class="sxs-lookup"><span data-stu-id="7229c-179">Yes</span></span> |
| <span data-ttu-id="7229c-180">Distribuire nuovo codice</span><span class="sxs-lookup"><span data-stu-id="7229c-180">Deploy new code</span></span> |<span data-ttu-id="7229c-181">Sì</span><span class="sxs-lookup"><span data-stu-id="7229c-181">Yes</span></span> |<span data-ttu-id="7229c-182">Sì</span><span class="sxs-lookup"><span data-stu-id="7229c-182">Yes</span></span> |<span data-ttu-id="7229c-183">Sì</span><span class="sxs-lookup"><span data-stu-id="7229c-183">Yes</span></span> |

<span data-ttu-id="7229c-184"><sup>1</sup> modifica delle dimensioni limitate toohello subset di dimensioni disponibili per il servizio cloud hello.</span><span class="sxs-lookup"><span data-stu-id="7229c-184"><sup>1</sup> Size change limited toohello subset of sizes available for hello cloud service.</span></span>

<span data-ttu-id="7229c-185"><sup>2</sup> Richiede Azure SDK 1.5 o versioni successive.</span><span class="sxs-lookup"><span data-stu-id="7229c-185"><sup>2</sup> Requires Azure SDK 1.5 or later versions.</span></span>

> [!WARNING]
> <span data-ttu-id="7229c-186">Modifica delle dimensioni della macchina virtuale hello comporta l'eliminazione di dati locali.</span><span class="sxs-lookup"><span data-stu-id="7229c-186">Changing hello virtual machine size will destroy local data.</span></span>
>
>

<span data-ttu-id="7229c-187">Hello seguenti non è supportato durante un aggiornamento:</span><span class="sxs-lookup"><span data-stu-id="7229c-187">hello following items are not supported during an update:</span></span>

* <span data-ttu-id="7229c-188">Modifica nome hello di un ruolo.</span><span class="sxs-lookup"><span data-stu-id="7229c-188">Changing hello name of a role.</span></span> <span data-ttu-id="7229c-189">Rimuovere e quindi aggiungere il ruolo di hello con nuovo nome hello.</span><span class="sxs-lookup"><span data-stu-id="7229c-189">Remove and then add hello role with hello new name.</span></span>
* <span data-ttu-id="7229c-190">Modifica di hello conteggio di aggiornamento del dominio.</span><span class="sxs-lookup"><span data-stu-id="7229c-190">Changing of hello Upgrade Domain count.</span></span>
* <span data-ttu-id="7229c-191">Riduzione delle dimensioni di hello delle risorse locali hello.</span><span class="sxs-lookup"><span data-stu-id="7229c-191">Decreasing hello size of hello local resources.</span></span>

<span data-ttu-id="7229c-192">Se si eseguono altri aggiornamenti della definizione del servizio tooyour, ad esempio la diminuzione delle dimensioni di hello della risorsa locale, è necessario eseguire invece un aggiornamento di scambio VIP.</span><span class="sxs-lookup"><span data-stu-id="7229c-192">If you are making other updates tooyour service's definition, such as decreasing hello size of local resource, you must perform a VIP swap update instead.</span></span> <span data-ttu-id="7229c-193">Per altre informazioni, vedere [Scambiare la distribuzione](https://msdn.microsoft.com/library/azure/ee460814.aspx).</span><span class="sxs-lookup"><span data-stu-id="7229c-193">For more information, see [Swap Deployment](https://msdn.microsoft.com/library/azure/ee460814.aspx).</span></span>

<a name="howanupgradeproceeds"></a>

## <a name="how-an-upgrade-proceeds"></a><span data-ttu-id="7229c-194">Come avviene un aggiornamento</span><span class="sxs-lookup"><span data-stu-id="7229c-194">How an upgrade proceeds</span></span>
<span data-ttu-id="7229c-195">È possibile decidere se si desidera tooupdate tutti i ruoli di hello nel servizio o un singolo ruolo nel servizio hello.</span><span class="sxs-lookup"><span data-stu-id="7229c-195">You can decide whether you want tooupdate all of hello roles in your service or a single role in hello service.</span></span> <span data-ttu-id="7229c-196">In entrambi i casi, tutte le istanze di ogni ruolo in corso l'aggiornamento e appartengono toohello primo dominio di aggiornamento sono arrestate, aggiornate e portate nuovamente online.</span><span class="sxs-lookup"><span data-stu-id="7229c-196">In either case, all instances of each role that is being upgraded and belong toohello first upgrade domain are stopped, upgraded, and brought back online.</span></span> <span data-ttu-id="7229c-197">Dopo aver riportato online, hello istanze nel secondo dominio di aggiornamento hello arrestate, aggiornate e portate online.</span><span class="sxs-lookup"><span data-stu-id="7229c-197">Once they are back online, hello instances in hello second upgrade domain are stopped, upgraded, and brought back online.</span></span> <span data-ttu-id="7229c-198">Un servizio cloud non può avere più di un aggiornamento attivo per volta.</span><span class="sxs-lookup"><span data-stu-id="7229c-198">A cloud service can have at most one upgrade active at a time.</span></span> <span data-ttu-id="7229c-199">aggiornamento di Hello viene sempre eseguita con la versione più recente di hello del servizio cloud hello.</span><span class="sxs-lookup"><span data-stu-id="7229c-199">hello upgrade is always performed against hello latest version of hello cloud service.</span></span>

<span data-ttu-id="7229c-200">Hello diagramma seguente illustra come avviare l'aggiornamento di hello se si esegue l'aggiornamento di tutti i ruoli di hello nel servizio hello:</span><span class="sxs-lookup"><span data-stu-id="7229c-200">hello following diagram illustrates how hello upgrade proceeds if you are upgrading all of hello roles in hello service:</span></span>

<span data-ttu-id="7229c-201">![Servizio di aggiornamento](media/cloud-services-update-azure-service/IC345879.png "Servizio di aggiornamento")</span><span class="sxs-lookup"><span data-stu-id="7229c-201">![Upgrade service](media/cloud-services-update-azure-service/IC345879.png "Upgrade service")</span></span>

<span data-ttu-id="7229c-202">Nel diagramma seguente viene illustrato come continuazione dell'aggiornamento hello se si sta aggiornando un solo ruolo:</span><span class="sxs-lookup"><span data-stu-id="7229c-202">This next diagram illustrates how hello update proceeds if you are upgrading only a single role:</span></span>

<span data-ttu-id="7229c-203">![Aggiornamento ruolo](media/cloud-services-update-azure-service/IC345880.png "Aggiornamento ruolo")</span><span class="sxs-lookup"><span data-stu-id="7229c-203">![Upgrade role](media/cloud-services-update-azure-service/IC345880.png "Upgrade role")</span></span>  

<span data-ttu-id="7229c-204">Durante un aggiornamento automatico, hello Controller di infrastruttura di Azure valuta periodicamente integrità hello di hello cloud servizio toodetermine quando è sicuro toowalk hello UD successivo.</span><span class="sxs-lookup"><span data-stu-id="7229c-204">During an automatic update, hello Azure Fabric Controller periodically evaluates hello health of hello cloud service toodetermine when it’s safe toowalk hello next UD.</span></span> <span data-ttu-id="7229c-205">Questa valutazione dell'integrità viene eseguita in base al ruolo e vengono considerate solo le istanze nella versione più recente di hello (ad esempio le istanze da domini di aggiornamento che sono già stati esaminati).</span><span class="sxs-lookup"><span data-stu-id="7229c-205">This health evaluation is performed on a per-role basis and considers only instances in hello latest version (i.e. instances from UDs that have already been walked).</span></span> <span data-ttu-id="7229c-206">Verifica che un numero minimo di istanze del ruolo, per ogni ruolo, abbia raggiunto uno stato finale soddisfacente.</span><span class="sxs-lookup"><span data-stu-id="7229c-206">It verifies that a minimum number of role instances, for each role, have achieved a satisfactory terminal state.</span></span>

### <a name="role-instance-start-timeout"></a><span data-ttu-id="7229c-207">Timeout dell'avvio dell’istanza del ruolo</span><span class="sxs-lookup"><span data-stu-id="7229c-207">Role Instance Start Timeout</span></span>
<span data-ttu-id="7229c-208">Controller di infrastruttura Hello attende 30 minuti per ogni tooreach istanza ruolo stato avviato.</span><span class="sxs-lookup"><span data-stu-id="7229c-208">hello Fabric Controller will wait 30 minutes for each role instance tooreach a Started state.</span></span> <span data-ttu-id="7229c-209">Se scade la durata del timeout di hello, Controller di infrastruttura hello continuerà esame toohello successiva istanza del ruolo.</span><span class="sxs-lookup"><span data-stu-id="7229c-209">If hello timeout duration elapses, hello Fabric Controller will continue walking toohello next role instance.</span></span>

### <a name="impact-toodrive-data-during-cloud-service-upgrades"></a><span data-ttu-id="7229c-210">Dati di impatto toodrive durante gli aggiornamenti del servizio Cloud</span><span class="sxs-lookup"><span data-stu-id="7229c-210">Impact toodrive data during Cloud Service upgrades</span></span>

<span data-ttu-id="7229c-211">Durante l'aggiornamento di un servizio da istanze di toomultiple una singola istanza del servizio verrà ridotto durante l'aggiornamento di hello viene eseguita a causa di toohello modo che Azure consente di aggiornare i servizi.</span><span class="sxs-lookup"><span data-stu-id="7229c-211">When upgrading a service from a single instance toomultiple instances your service will be brought down while hello upgrade is performed due toohello way Azure upgrades services.</span></span> <span data-ttu-id="7229c-212">Hello servizio Contratto garantisce la disponibilità del servizio si applica solo tooservices distribuiti con più di un'istanza.</span><span class="sxs-lookup"><span data-stu-id="7229c-212">hello service level agreement guaranteeing service availability only applies tooservices that are deployed with more than one instance.</span></span> <span data-ttu-id="7229c-213">Hello elenco seguente descrive come dati hello in ogni unità sono interessati da ogni scenario di aggiornamento del servizio di Azure:</span><span class="sxs-lookup"><span data-stu-id="7229c-213">hello following list describes how hello data on each drive is affected by each Azure service upgrade scenario:</span></span>

|<span data-ttu-id="7229c-214">Scenario</span><span class="sxs-lookup"><span data-stu-id="7229c-214">Scenario</span></span>|<span data-ttu-id="7229c-215">Unità C</span><span class="sxs-lookup"><span data-stu-id="7229c-215">C Drive</span></span>|<span data-ttu-id="7229c-216">Unità D</span><span class="sxs-lookup"><span data-stu-id="7229c-216">D Drive</span></span>|<span data-ttu-id="7229c-217">Unità E</span><span class="sxs-lookup"><span data-stu-id="7229c-217">E Drive</span></span>|
|--------|-------|-------|-------|
|<span data-ttu-id="7229c-218">Riavvio VM</span><span class="sxs-lookup"><span data-stu-id="7229c-218">VM reboot</span></span>|<span data-ttu-id="7229c-219">Mantenuta</span><span class="sxs-lookup"><span data-stu-id="7229c-219">Preserved</span></span>|<span data-ttu-id="7229c-220">Mantenuta</span><span class="sxs-lookup"><span data-stu-id="7229c-220">Preserved</span></span>|<span data-ttu-id="7229c-221">Mantenuta</span><span class="sxs-lookup"><span data-stu-id="7229c-221">Preserved</span></span>|
|<span data-ttu-id="7229c-222">Riavvio del portale</span><span class="sxs-lookup"><span data-stu-id="7229c-222">Portal reboot</span></span>|<span data-ttu-id="7229c-223">Mantenuta</span><span class="sxs-lookup"><span data-stu-id="7229c-223">Preserved</span></span>|<span data-ttu-id="7229c-224">Mantenuta</span><span class="sxs-lookup"><span data-stu-id="7229c-224">Preserved</span></span>|<span data-ttu-id="7229c-225">Eliminata</span><span class="sxs-lookup"><span data-stu-id="7229c-225">Destroyed</span></span>|
|<span data-ttu-id="7229c-226">Ricreazione dell'immagine del portale</span><span class="sxs-lookup"><span data-stu-id="7229c-226">Portal reimage</span></span>|<span data-ttu-id="7229c-227">Mantenuta</span><span class="sxs-lookup"><span data-stu-id="7229c-227">Preserved</span></span>|<span data-ttu-id="7229c-228">Eliminata</span><span class="sxs-lookup"><span data-stu-id="7229c-228">Destroyed</span></span>|<span data-ttu-id="7229c-229">Eliminata</span><span class="sxs-lookup"><span data-stu-id="7229c-229">Destroyed</span></span>|
|<span data-ttu-id="7229c-230">Aggiornamento sul posto</span><span class="sxs-lookup"><span data-stu-id="7229c-230">In-Place Upgrade</span></span>|<span data-ttu-id="7229c-231">Mantenuta</span><span class="sxs-lookup"><span data-stu-id="7229c-231">Preserved</span></span>|<span data-ttu-id="7229c-232">Mantenuta</span><span class="sxs-lookup"><span data-stu-id="7229c-232">Preserved</span></span>|<span data-ttu-id="7229c-233">Eliminata</span><span class="sxs-lookup"><span data-stu-id="7229c-233">Destroyed</span></span>|
|<span data-ttu-id="7229c-234">Migrazione di un nodo</span><span class="sxs-lookup"><span data-stu-id="7229c-234">Node migration</span></span>|<span data-ttu-id="7229c-235">Eliminata</span><span class="sxs-lookup"><span data-stu-id="7229c-235">Destroyed</span></span>|<span data-ttu-id="7229c-236">Eliminata</span><span class="sxs-lookup"><span data-stu-id="7229c-236">Destroyed</span></span>|<span data-ttu-id="7229c-237">Eliminata</span><span class="sxs-lookup"><span data-stu-id="7229c-237">Destroyed</span></span>|

<span data-ttu-id="7229c-238">Si noti che, in hello sopra l'elenco, hello unità e: rappresenta l'unità radice del ruolo hello e non deve essere hardcoded.</span><span class="sxs-lookup"><span data-stu-id="7229c-238">Note that, in hello above list, hello E: drive represents hello role’s root drive, and should not be hard-coded.</span></span> <span data-ttu-id="7229c-239">Utilizzare invece hello **% RoleRoot %** unità hello toorepresent variabile di ambiente.</span><span class="sxs-lookup"><span data-stu-id="7229c-239">Instead, use hello **%RoleRoot%** environment variable toorepresent hello drive.</span></span>

<span data-ttu-id="7229c-240">toominimize hello tempi di inattività durante l'aggiornamento di un servizio a istanza singola, distribuire un nuovo multi-istanza servizio toohello server di gestione temporanea ed eseguire uno scambio VIP.</span><span class="sxs-lookup"><span data-stu-id="7229c-240">toominimize hello downtime when upgrading a single-instance service, deploy a new multi-instance service toohello staging server and perform a VIP swap.</span></span>

<a name="RollbackofanUpdate"></a>

## <a name="rollback-of-an-update"></a><span data-ttu-id="7229c-241">Ripristino dello stato precedente di un aggiornamento</span><span class="sxs-lookup"><span data-stu-id="7229c-241">Rollback of an update</span></span>
<span data-ttu-id="7229c-242">Azure offre flessibilità nella gestione dei servizi durante un aggiornamento consentendo l'avvio di altre operazioni su un servizio, dopo la richiesta di aggiornamento iniziale hello è accettata da hello Controller di infrastruttura di Azure.</span><span class="sxs-lookup"><span data-stu-id="7229c-242">Azure provides flexibility in managing services during an update by letting you initiate additional operations on a service, after hello initial update request is accepted by hello Azure Fabric Controller.</span></span> <span data-ttu-id="7229c-243">Un'operazione di rollback può essere eseguita solo quando un aggiornamento (modifica della configurazione) o l'aggiornamento è in hello **in corso** stato sulla distribuzione di hello.</span><span class="sxs-lookup"><span data-stu-id="7229c-243">A rollback can only be performed when an update (configuration change) or upgrade is in hello **in progress** state on hello deployment.</span></span> <span data-ttu-id="7229c-244">Un aggiornamento o l'aggiornamento viene considerato toobe in corso, purché vi sia almeno un'istanza del servizio hello che non è ancora stato aggiornato toohello nuova versione.</span><span class="sxs-lookup"><span data-stu-id="7229c-244">An update or upgrade is considered toobe in-progress as long as there is at least one instance of hello service which has not yet been updated toohello new version.</span></span> <span data-ttu-id="7229c-245">tootest se è consentito il rollback, controllare il valore di hello del flag RollbackAllowed hello, restituito da [Get Deployment](https://msdn.microsoft.com/library/azure/ee460804.aspx) e [ottenere proprietà del servizio Cloud](https://msdn.microsoft.com/library/azure/ee460806.aspx) operazioni, è impostato tootrue.</span><span class="sxs-lookup"><span data-stu-id="7229c-245">tootest whether a rollback is allowed, check hello value of hello RollbackAllowed flag, returned by [Get Deployment](https://msdn.microsoft.com/library/azure/ee460804.aspx) and [Get Cloud Service Properties](https://msdn.microsoft.com/library/azure/ee460806.aspx) operations, is set tootrue.</span></span>

> [!NOTE]
> <span data-ttu-id="7229c-246">Rende senso toocall Rollback solo in un **sul posto** aggiornamento perché gli aggiornamenti di scambio VIP comportano la sostituzione di un'intera istanza in esecuzione del servizio con un altro.</span><span class="sxs-lookup"><span data-stu-id="7229c-246">It only makes sense toocall Rollback on an **in-place** update or upgrade because VIP swap upgrades involve replacing one entire running instance of your service with another.</span></span>
>
>

<span data-ttu-id="7229c-247">Rollback di un aggiornamento in corso ha hello effetti sulla distribuzione di hello seguenti:</span><span class="sxs-lookup"><span data-stu-id="7229c-247">Rollback of an in-progress update has hello following effects on hello deployment:</span></span>

* <span data-ttu-id="7229c-248">Tutte le istanze di ruolo che non fosse stata aggiornata o aggiornati toohello nuova versione non vengono aggiornate o aggiornate, poiché tali istanze sono già in esecuzione la versione di destinazione hello del servizio hello.</span><span class="sxs-lookup"><span data-stu-id="7229c-248">Any role instances which had not yet been updated or upgraded toohello new version are not updated or upgraded, because those instances are already running hello target version of hello service.</span></span>
* <span data-ttu-id="7229c-249">Le istanze di qualsiasi ruolo che era già stata aggiornata o aggiornato toohello nuova versione del pacchetto del servizio hello (\*con estensione cspkg) hello o file di configurazione del servizio (\*. cscfg) file o entrambi i file sono toohello ripristinato versione pre-aggiornamento di Questi file.</span><span class="sxs-lookup"><span data-stu-id="7229c-249">Any role instances which had already been updated or upgraded toohello new version of hello service package (\*.cspkg) file or hello service configuration (\*.cscfg) file (or both files) are reverted toohello pre-upgrade version of these files.</span></span>

<span data-ttu-id="7229c-250">Ciò viene fornita dai hello seguenti caratteristiche:</span><span class="sxs-lookup"><span data-stu-id="7229c-250">This functionally is provided by hello following features:</span></span>

* <span data-ttu-id="7229c-251">Hello [Rollback aggiornamento o l'aggiornamento](https://msdn.microsoft.com/library/azure/hh403977.aspx) operazione, che può essere chiamato su un aggiornamento della configurazione (attivato chiamando [modificare la configurazione di distribuzione](https://msdn.microsoft.com/library/azure/ee460809.aspx)) o un aggiornamento (attivato chiamando [ L'aggiornamento della distribuzione](https://msdn.microsoft.com/library/azure/ee460793.aspx)), purché vi sia almeno un'istanza nel servizio hello che non è ancora stato aggiornato toohello nuova versione.</span><span class="sxs-lookup"><span data-stu-id="7229c-251">hello [Rollback Update Or Upgrade](https://msdn.microsoft.com/library/azure/hh403977.aspx) operation, which can be called on a configuration update (triggered by calling [Change Deployment Configuration](https://msdn.microsoft.com/library/azure/ee460809.aspx)) or an upgrade (triggered by calling [Upgrade Deployment](https://msdn.microsoft.com/library/azure/ee460793.aspx)) as long as there is at least one instance in hello service which has not yet been updated toohello new version.</span></span>
* <span data-ttu-id="7229c-252">Hello Locked ed elemento hello RollbackAllowed, che vengono restituiti come parte del corpo della risposta hello di hello [Get Deployment](https://msdn.microsoft.com/library/azure/ee460804.aspx) e [ottenere proprietà del servizio Cloud](https://msdn.microsoft.com/library/azure/ee460806.aspx) operazioni:</span><span class="sxs-lookup"><span data-stu-id="7229c-252">hello Locked element and hello RollbackAllowed element, which are returned as part of hello response body of hello [Get Deployment](https://msdn.microsoft.com/library/azure/ee460804.aspx) and [Get Cloud Service Properties](https://msdn.microsoft.com/library/azure/ee460806.aspx) operations:</span></span>

  1. <span data-ttu-id="7229c-253">elemento bloccato Hello consente toodetect quando un'operazione di mutazione può essere richiamata su una distribuzione specificata.</span><span class="sxs-lookup"><span data-stu-id="7229c-253">hello Locked element allows you toodetect when a mutating operation can be invoked on a given deployment.</span></span>
  2. <span data-ttu-id="7229c-254">Hello RollbackAllowed elemento consente toodetect quando hello [Rollback dell'aggiornamento](https://msdn.microsoft.com/library/azure/hh403977.aspx) operazione può essere chiamata in una distribuzione specificata.</span><span class="sxs-lookup"><span data-stu-id="7229c-254">hello RollbackAllowed element allows you toodetect when hello [Rollback Update Or Upgrade](https://msdn.microsoft.com/library/azure/hh403977.aspx) operation can be called on a given deployment.</span></span>

  <span data-ttu-id="7229c-255">In ordine tooperform un rollback, non si dispone toocheck sia hello Locked e RollbackAllowed elementi hello.</span><span class="sxs-lookup"><span data-stu-id="7229c-255">In order tooperform a rollback, you do not have toocheck both hello Locked and hello RollbackAllowed elements.</span></span> <span data-ttu-id="7229c-256">È sufficiente tooconfirm RollbackAllowed viene impostato tootrue.</span><span class="sxs-lookup"><span data-stu-id="7229c-256">It suffices tooconfirm that RollbackAllowed is set tootrue.</span></span> <span data-ttu-id="7229c-257">Questi elementi vengono restituiti solo se questi metodi vengono richiamati mediante l'intestazione della richiesta hello impostato troppo "x-ms-version: 2011-10-01" o una versione successiva.</span><span class="sxs-lookup"><span data-stu-id="7229c-257">These elements are only returned if these methods are invoked by using hello request header set too“x-ms-version: 2011-10-01” or a later version.</span></span> <span data-ttu-id="7229c-258">Per altre informazioni sul controllo delle versioni delle intestazioni, vedere [Controllo delle versioni di gestione del servizio](https://msdn.microsoft.com/library/azure/gg592580.aspx).</span><span class="sxs-lookup"><span data-stu-id="7229c-258">For more information about versioning headers, see [Service Management Versioning](https://msdn.microsoft.com/library/azure/gg592580.aspx).</span></span>

<span data-ttu-id="7229c-259">In alcune situazioni un ripristino dello stato precedente di un aggiornamento non è supportato, come nei casi seguenti:</span><span class="sxs-lookup"><span data-stu-id="7229c-259">There are some situations where a rollback of an update or upgrade is not supported, these are as follows:</span></span>

* <span data-ttu-id="7229c-260">Riduzione delle risorse locali - se hello aggiornamento aumenta hello risorse locali per un ruolo hello piattaforma Azure non consente il rollback.</span><span class="sxs-lookup"><span data-stu-id="7229c-260">Reduction in local resources - If hello update increases hello local resources for a role hello Azure platform does not allow rolling back.</span></span>
* <span data-ttu-id="7229c-261">Limiti di quota - se update hello è un'operazione potrebbe non essere più di ridimensionamento è sufficiente calcolo quota toocomplete hello l'operazione di rollback.</span><span class="sxs-lookup"><span data-stu-id="7229c-261">Quota limitations - If hello update was a scale down operation you may no longer have sufficient compute quota toocomplete hello rollback operation.</span></span> <span data-ttu-id="7229c-262">Ogni sottoscrizione di Azure è una quota associata che specifica hello il numero massimo di core che possono essere utilizzati da tutti i servizi ospitati che appartengono toothat sottoscrizione.</span><span class="sxs-lookup"><span data-stu-id="7229c-262">Each Azure subscription has a quota associated with it that specifies hello maximum number of cores which can be consumed by all hosted services that belong toothat subscription.</span></span> <span data-ttu-id="7229c-263">Se l'esecuzione di un ripristino dello stato precedente di un determinato aggiornamento farà superare la quota prevista per la sottoscrizione, il ripristino dello stato precedente non verrà abilitato.</span><span class="sxs-lookup"><span data-stu-id="7229c-263">If performing a rollback of a given update would put your subscription over quota then that a rollback will not be enabled.</span></span>
* <span data-ttu-id="7229c-264">Race condition - se l'aggiornamento iniziale hello è stata completata, non è possibile un rollback.</span><span class="sxs-lookup"><span data-stu-id="7229c-264">Race condition - If hello initial update has completed, a rollback is not possible.</span></span>

<span data-ttu-id="7229c-265">Un esempio di quando potrebbe essere utile eseguire il rollback di un aggiornamento hello è se si utilizza hello [l'aggiornamento della distribuzione](https://msdn.microsoft.com/library/azure/ee460793.aspx) operazione tasso di hello toocontrol modalità manuale in corrispondenza del quale servizio ospitato un tooyour aggiornamento sul posto principale Azure è implementato.</span><span class="sxs-lookup"><span data-stu-id="7229c-265">An example of when hello rollback of an update might be useful is if you are using hello [Upgrade Deployment](https://msdn.microsoft.com/library/azure/ee460793.aspx) operation in manual mode toocontrol hello rate at which a major in-place upgrade tooyour Azure hosted service is rolled out.</span></span>

<span data-ttu-id="7229c-266">Durante l'implementazione di hello dell'aggiornamento hello chiamare [l'aggiornamento della distribuzione](https://msdn.microsoft.com/library/azure/ee460793.aspx) in modalità manuale e iniziare toowalk domini di aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="7229c-266">During hello rollout of hello upgrade you call [Upgrade Deployment](https://msdn.microsoft.com/library/azure/ee460793.aspx) in manual mode and begin toowalk upgrade domains.</span></span> <span data-ttu-id="7229c-267">Se a un certo punto durante il monitoraggio aggiornamento hello, si nota in hello primi domini di aggiornamento che esaminano alcune istanze del ruolo sono diventate non risponde, è possibile chiamare hello [Rollback dell'aggiornamento](https://msdn.microsoft.com/library/azure/hh403977.aspx) operazione sulla distribuzione di hello, che lascia le istanze hello invariati non ancora aggiornate e le istanze di rollback che era stato aggiornato toohello pacchetto del servizio precedente e la configurazione.</span><span class="sxs-lookup"><span data-stu-id="7229c-267">If at some point, as you monitor hello upgrade, you note some role instances in hello first upgrade domains that you examine have become unresponsive, you can call hello [Rollback Update Or Upgrade](https://msdn.microsoft.com/library/azure/hh403977.aspx) operation on hello deployment, which will leave untouched hello instances which had not yet been upgraded and rollback instances which had been upgraded toohello previous service package and configuration.</span></span>

<a name="multiplemutatingoperations"></a>

## <a name="initiating-multiple-mutating-operations-on-an-ongoing-deployment"></a><span data-ttu-id="7229c-268">Avvio di più operazioni di mutazione durante una distribuzione</span><span class="sxs-lookup"><span data-stu-id="7229c-268">Initiating multiple mutating operations on an ongoing deployment</span></span>
<span data-ttu-id="7229c-269">In alcuni casi è opportuno tooinitiate più operazioni di mutazione simultanee in una distribuzione in corso.</span><span class="sxs-lookup"><span data-stu-id="7229c-269">In some cases you may want tooinitiate multiple simultaneous mutating operations on an ongoing deployment.</span></span> <span data-ttu-id="7229c-270">Ad esempio, è possibile eseguire un aggiornamento del servizio e, durante l'aggiornamento software nel servizio, si desidera toomake alcune modifiche, ad esempio tooroll hello nuovamente l'aggiornamento, si applicano a un altro aggiornamento o anche eliminare la distribuzione di hello.</span><span class="sxs-lookup"><span data-stu-id="7229c-270">For example, you may perform a service update and, while that update is being rolled out across your service, you want toomake some change, e.g. tooroll hello update back, apply a different update, or even delete hello deployment.</span></span> <span data-ttu-id="7229c-271">Un caso in cui ciò potrebbe essere necessario è se un aggiornamento del servizio contiene codice anomalo che causa un arresto anomalo toorepeatedly istanza di ruolo aggiornata.</span><span class="sxs-lookup"><span data-stu-id="7229c-271">A case in which this might be necessary is if a service upgrade contains buggy code which causes an upgraded role instance toorepeatedly crash.</span></span> <span data-ttu-id="7229c-272">In questo caso, hello Controller di infrastruttura di Azure non sarà in grado di toomake lo stato di avanzamento nell'applicazione con l'aggiornamento perché un numero sufficiente di istanze nel dominio aggiornato hello sia integro.</span><span class="sxs-lookup"><span data-stu-id="7229c-272">In this case, hello Azure Fabric Controller will not be able toomake progress in applying that upgrade because an insufficient number of instances in hello upgraded domain are healthy.</span></span> <span data-ttu-id="7229c-273">Questo stato è tooas di cui si fa riferimento un *distribuzione bloccata*.</span><span class="sxs-lookup"><span data-stu-id="7229c-273">This state is referred tooas a *stuck deployment*.</span></span> <span data-ttu-id="7229c-274">È possibile sbloccare distribuzione hello rollback hello aggiornamento o l'applicazione di un nuovo aggiornamento sopra hello in mancanza di uno.</span><span class="sxs-lookup"><span data-stu-id="7229c-274">You can unstick hello deployment by rolling back hello update or applying a fresh update over top of hello failing one.</span></span>

<span data-ttu-id="7229c-275">Una volta servizio hello tooupdate o aggiornamento hello richiesta iniziale è stato ricevuto da hello Controller di infrastruttura di Azure, è possibile avviare le operazioni di mutazione successive.</span><span class="sxs-lookup"><span data-stu-id="7229c-275">Once hello initial request tooupdate or upgrade hello service has been received by hello Azure Fabric Controller, you can start subsequent mutating operations.</span></span> <span data-ttu-id="7229c-276">Ovvero, non si dispone toowait per hello operazione iniziale toocomplete prima di iniziare un'altra operazione di mutazione.</span><span class="sxs-lookup"><span data-stu-id="7229c-276">That is, you do not have toowait for hello initial operation toocomplete before you can start another mutating operation.</span></span>

<span data-ttu-id="7229c-277">Avviare una seconda operazione di aggiornamento mentre è in corso l'aggiornamento prima di hello eseguirà l'operazione di rollback toohello simile.</span><span class="sxs-lookup"><span data-stu-id="7229c-277">Initiating a second update operation while hello first update is ongoing will perform similar toohello rollback operation.</span></span> <span data-ttu-id="7229c-278">Se hello secondo aggiornamento è in modalità automatica, hello primo dominio di aggiornamento verrà aggiornato immediatamente, causando tooinstances da più domini di aggiornamento offline hello stesso punto nel tempo.</span><span class="sxs-lookup"><span data-stu-id="7229c-278">If hello second update is in automatic mode, hello first upgrade domain will be upgraded immediately, possibly leading tooinstances from multiple upgrade domains being offline at hello same point in time.</span></span>

<span data-ttu-id="7229c-279">Hello operazioni di mutazione sono le seguenti: [modificare la configurazione di distribuzione](https://msdn.microsoft.com/library/azure/ee460809.aspx), [l'aggiornamento della distribuzione](https://msdn.microsoft.com/library/azure/ee460793.aspx), [lo stato di distribuzione](https://msdn.microsoft.com/library/azure/ee460808.aspx), [eliminare Distribuzione](https://msdn.microsoft.com/library/azure/ee460815.aspx), e [aggiornamento Rollback](https://msdn.microsoft.com/library/azure/hh403977.aspx).</span><span class="sxs-lookup"><span data-stu-id="7229c-279">hello mutating operations are as follows: [Change Deployment Configuration](https://msdn.microsoft.com/library/azure/ee460809.aspx), [Upgrade Deployment](https://msdn.microsoft.com/library/azure/ee460793.aspx), [Update Deployment Status](https://msdn.microsoft.com/library/azure/ee460808.aspx), [Delete Deployment](https://msdn.microsoft.com/library/azure/ee460815.aspx), and [Rollback Update Or Upgrade](https://msdn.microsoft.com/library/azure/hh403977.aspx).</span></span>

<span data-ttu-id="7229c-280">Due operazioni, [Get Deployment](https://msdn.microsoft.com/library/azure/ee460804.aspx) e [ottenere proprietà del servizio Cloud](https://msdn.microsoft.com/library/azure/ee460806.aspx), restituire i flag bloccato hello che può essere esaminato toodetermine se un'operazione di mutazione può essere richiamata su una distribuzione specificata.</span><span class="sxs-lookup"><span data-stu-id="7229c-280">Two operations, [Get Deployment](https://msdn.microsoft.com/library/azure/ee460804.aspx) and [Get Cloud Service Properties](https://msdn.microsoft.com/library/azure/ee460806.aspx), return hello Locked flag which can be examined toodetermine whether a mutating operation can be invoked on a given deployment.</span></span>

<span data-ttu-id="7229c-281">In ordine toocall hello versione di questi metodi che restituisce i flag bloccato hello, è necessario impostare l'intestazione richiesta troppo "x-ms-version: 2011-10-01" o una versione successiva.</span><span class="sxs-lookup"><span data-stu-id="7229c-281">In order toocall hello version of these methods which returns hello Locked flag, you must set request header too“x-ms-version: 2011-10-01” or a later.</span></span> <span data-ttu-id="7229c-282">Per altre informazioni sul controllo delle versioni delle intestazioni, vedere [Controllo delle versioni di gestione del servizio](https://msdn.microsoft.com/library/azure/gg592580.aspx).</span><span class="sxs-lookup"><span data-stu-id="7229c-282">For more information about versioning headers, see [Service Management Versioning](https://msdn.microsoft.com/library/azure/gg592580.aspx).</span></span>

<a name="distributiondfroles"></a>

## <a name="distribution-of-roles-across-upgrade-domains"></a><span data-ttu-id="7229c-283">Distribuzione di ruoli nei domini di aggiornamento</span><span class="sxs-lookup"><span data-stu-id="7229c-283">Distribution of roles across upgrade domains</span></span>
<span data-ttu-id="7229c-284">Azure distribuisce uniformemente le istanze di un ruolo in un numero di domini di aggiornamento, che può essere configurato come parte del file di definizione (con estensione csdef) hello del servizio.</span><span class="sxs-lookup"><span data-stu-id="7229c-284">Azure distributes instances of a role evenly across a set number of upgrade domains, which can be configured as part of hello service definition (.csdef) file.</span></span> <span data-ttu-id="7229c-285">Hello il numero massimo di domini di aggiornamento è 20 e il valore predefinito di hello è 5.</span><span class="sxs-lookup"><span data-stu-id="7229c-285">hello max number of upgrade domains is 20 and hello default is 5.</span></span> <span data-ttu-id="7229c-286">Per ulteriori informazioni su come toomodify hello file di definizione del servizio, vedere [dello Schema di definizione del servizio di Azure (File con estensione csdef)](cloud-services-model-and-package.md#csdef).</span><span class="sxs-lookup"><span data-stu-id="7229c-286">For more information about how toomodify hello service definition file, see [Azure Service Definition Schema (.csdef File)](cloud-services-model-and-package.md#csdef).</span></span>

<span data-ttu-id="7229c-287">Se, ad esempio, il ruolo ha dieci istanze, per impostazione predefinita, ogni dominio di aggiornamento contiene due istanze.</span><span class="sxs-lookup"><span data-stu-id="7229c-287">For example, if your role has ten instances, by default each upgrade domain contains two instances.</span></span> <span data-ttu-id="7229c-288">Se il ruolo dispone di 14 istanze, quindi quattro hello domini di aggiornamento sono contenute tre istanze e un quinto dominio ne contiene due.</span><span class="sxs-lookup"><span data-stu-id="7229c-288">If your role has 14 instances, then four of hello upgrade domains contain three instances, and a fifth domain contains two.</span></span>

<span data-ttu-id="7229c-289">Domini di aggiornamento vengono identificati con un indice in base zero: hello primo dominio di aggiornamento con ID 0 e il secondo dominio di aggiornamento hello con ID 1 e così via.</span><span class="sxs-lookup"><span data-stu-id="7229c-289">Upgrade domains are identified with a zero-based index: hello first upgrade domain has an ID of 0, and hello second upgrade domain has an ID of 1, and so on.</span></span>

<span data-ttu-id="7229c-290">Hello diagramma seguente illustra come un servizio che contiene due ruoli vengono distribuiti quando il servizio di hello definisce due domini di aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="7229c-290">hello following diagram illustrates how a service than contains two roles are distributed when hello service defines two upgrade domains.</span></span> <span data-ttu-id="7229c-291">servizio Hello è in esecuzione otto istanze del ruolo web hello e nove istanze del ruolo di lavoro hello.</span><span class="sxs-lookup"><span data-stu-id="7229c-291">hello service is running eight instances of hello web role and nine instances of hello worker role.</span></span>

<span data-ttu-id="7229c-292">![Distribuzione di domini di aggiornamento](media/cloud-services-update-azure-service/IC345533.png "Distribuzione di domini di aggiornamento")</span><span class="sxs-lookup"><span data-stu-id="7229c-292">![Distribution of Upgrade Domains](media/cloud-services-update-azure-service/IC345533.png "Distribution of Upgrade Domains")</span></span>

> [!NOTE]
> <span data-ttu-id="7229c-293">Si noti che Azure controlla come le istanze vengono allocate nei domini di aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="7229c-293">Note that Azure controls how instances are allocated across upgrade domains.</span></span> <span data-ttu-id="7229c-294">Non è possibile toospecify quali istanze siano allocate toowhich dominio.</span><span class="sxs-lookup"><span data-stu-id="7229c-294">It's not possible toospecify which instances are allocated toowhich domain.</span></span>
>
>

## <a name="next-steps"></a><span data-ttu-id="7229c-295">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="7229c-295">Next steps</span></span>
[<span data-ttu-id="7229c-296">Come tooManage dei servizi Cloud</span><span class="sxs-lookup"><span data-stu-id="7229c-296">How tooManage Cloud Services</span></span>](cloud-services-how-to-manage.md)  
[<span data-ttu-id="7229c-297">Come tooMonitor dei servizi Cloud</span><span class="sxs-lookup"><span data-stu-id="7229c-297">How tooMonitor Cloud Services</span></span>](cloud-services-how-to-monitor.md)  
[<span data-ttu-id="7229c-298">Come tooConfigure dei servizi Cloud</span><span class="sxs-lookup"><span data-stu-id="7229c-298">How tooConfigure Cloud Services</span></span>](cloud-services-how-to-configure.md)  
