---
title: aaaBackup e ripristino di emergenza per i dischi Azure IaaS | Documenti Microsoft
description: "In questo articolo verrà illustrato come tooplan per il Backup e ripristino di emergenza delle macchine virtuali IaaS (VM) e dischi in Azure. Questo documento è relativo a dischi gestiti e non gestiti"
services: storage
cloud: Azure
documentationcenter: na
author: luywang
manager: kavithag
ms.assetid: 
ms.service: storage
ms.workload: storage
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/19/2017
ms.author: luywang
ms.openlocfilehash: 17c697bc411fb47c4b7483b59829af1c40732ac1
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/06/2017
---
# <a name="backup-and-disaster-recovery-for-azure-iaas-disks"></a><span data-ttu-id="e8765-104">Backup e ripristino di emergenza per dischi IaaS di Azure</span><span class="sxs-lookup"><span data-stu-id="e8765-104">Backup and disaster recovery for Azure IaaS disks</span></span>

<span data-ttu-id="e8765-105">In questo articolo verrà illustrato come tooplan per il Backup e ripristino di emergenza delle macchine virtuali IaaS (VM) e dischi in Azure.</span><span class="sxs-lookup"><span data-stu-id="e8765-105">In this article, we will explain how tooplan for Backup and Disaster Recovery (DR) of IaaS virtual machines (VMs) and Disks in Azure.</span></span> <span data-ttu-id="e8765-106">Questo documento è relativo a dischi gestiti e non gestiti.</span><span class="sxs-lookup"><span data-stu-id="e8765-106">This document covers both Managed and Unmanaged Disks.</span></span>

<span data-ttu-id="e8765-107">Prima di tutto parleremo hello errore incorporate funzionalità di tolleranza in hello piattaforma Azure che consentono di proteggersi da errori locali.</span><span class="sxs-lookup"><span data-stu-id="e8765-107">We’ll first talk about hello built-in fault tolerance capabilities in hello Azure platform which help guard against local failures.</span></span> <span data-ttu-id="e8765-108">Quindi si parlerà di scenari di emergenza hello non completamente coperti da funzionalità incorporate di hello, che è l'argomento principale di hello interessato da questo documento.</span><span class="sxs-lookup"><span data-stu-id="e8765-108">We’ll then discuss hello disaster scenarios not fully covered by hello built-in capabilities, which is hello main topic addressed by this document.</span></span> <span data-ttu-id="e8765-109">Verranno forniti anche alcuni esempi di scenari di carico di lavoro per cui è possibile applicare diverse considerazioni relative a backup e ripristino di emergenza.</span><span class="sxs-lookup"><span data-stu-id="e8765-109">We’ll also show several examples of workload scenarios where different Backup and DR considerations may apply.</span></span> <span data-ttu-id="e8765-110">Verranno infine esaminate le soluzioni possibili per il ripristino di emergenza di dischi IaaS.</span><span class="sxs-lookup"><span data-stu-id="e8765-110">We’ll then review possible solutions for DR of IaaS Disks.</span></span> 

## <a name="introduction"></a><span data-ttu-id="e8765-111">Introduzione</span><span class="sxs-lookup"><span data-stu-id="e8765-111">Introduction</span></span>

<span data-ttu-id="e8765-112">Hello piattaforma Azure utilizzati vari metodi per la ridondanza e protezione toohelp tolleranza di errore da errori hardware localizzati che possono verificarsi.</span><span class="sxs-lookup"><span data-stu-id="e8765-112">hello Azure platform uses various methods for redundancy and fault tolerance toohelp protect customers from localized hardware failures that can occur.</span></span> <span data-ttu-id="e8765-113">Errori locali possono includere problemi con un computer server di archiviazione di Azure contenente errori di un'unità SSD o HDD o parte dei dati di hello per un disco virtuale in tale server.</span><span class="sxs-lookup"><span data-stu-id="e8765-113">Local failures may include problems with an Azure storage server machine that stores part of hello data for a virtual disk or failures of an SSD or HDD on that server.</span></span> <span data-ttu-id="e8765-114">Gli errori dei componenti hardware isolato tale situazione possono verificarsi durante le normali operazioni e piattaforma hello è progettato toobe toothese resilienti errori.</span><span class="sxs-lookup"><span data-stu-id="e8765-114">Such isolated hardware component failures can happen during normal operations and hello platform is designed toobe resilient toothese failures.</span></span> <span data-ttu-id="e8765-115">Le emergenze gravi possono provocare errori o inaccessibilità per un numero elevato di server di archiviazione o per un intero data center.</span><span class="sxs-lookup"><span data-stu-id="e8765-115">Major disasters can result in failures or inaccessibility of a large numbers of storage servers or a whole datacenter.</span></span> <span data-ttu-id="e8765-116">Mentre le macchine virtuali e dischi in genere sono protetti da errori localizzati, ulteriori passaggi sono necessari tooprotect il carico di lavoro a livello di area irreversibile tentativi non riusciti (ad esempio un errore grave) che possono influenzare la macchina virtuale e i dischi.</span><span class="sxs-lookup"><span data-stu-id="e8765-116">While your VMs and disks are normally protected from localized failures, additional steps are necessary tooprotect your workload from region-wide catastrophic failures (such as a major disaster) that can affect your VM and disks.</span></span>

<span data-ttu-id="e8765-117">Inoltre toohello possibilità di errori di piattaforma, possono verificarsi problemi con i dati o un'applicazione hello cliente.</span><span class="sxs-lookup"><span data-stu-id="e8765-117">In addition toohello possibility of platform failures, problems with hello customer application or data can occur.</span></span> <span data-ttu-id="e8765-118">Ad esempio, una nuova versione dell'applicazione potrebbe inavvertitamente effettuare un'interruzione toohello dati delle modifiche.</span><span class="sxs-lookup"><span data-stu-id="e8765-118">For example, a new version of your application may inadvertently make a breaking change toohello data.</span></span> <span data-ttu-id="e8765-119">In tal caso, è un'applicazione hello toorevert e hello dati tooa versione precedente contiene hello ultimo stato noto soddisfacente.</span><span class="sxs-lookup"><span data-stu-id="e8765-119">In that case, you may want toorevert hello application and hello data tooa prior version containing hello last known good state.</span></span> <span data-ttu-id="e8765-120">A questo scopo, sono necessari backup regolari.</span><span class="sxs-lookup"><span data-stu-id="e8765-120">This requires maintaining regular backups.</span></span>

<span data-ttu-id="e8765-121">Per il ripristino di emergenza locale, è necessario eseguire il backup VM IaaS dischi tooa diverso paese.</span><span class="sxs-lookup"><span data-stu-id="e8765-121">For regional disaster recovery, you must backup your IaaS VM disks tooa different region.</span></span> 

<span data-ttu-id="e8765-122">Prima di esaminare le opzioni di backup e ripristino di emergenza, è utile esaminare i metodi disponibili per la gestione degli errori localizzati.</span><span class="sxs-lookup"><span data-stu-id="e8765-122">Before we look at Backup and DR options, let’s recap a few methods available for handling localized failures.</span></span>

### <a name="azure-iaas-resiliency"></a><span data-ttu-id="e8765-123">Resilienza IaaS di Azure</span><span class="sxs-lookup"><span data-stu-id="e8765-123">Azure IaaS Resiliency</span></span>

<span data-ttu-id="e8765-124">*Resilienza* fa riferimento a tolleranza di errore toohello normali errori che si verificano in componenti hardware.</span><span class="sxs-lookup"><span data-stu-id="e8765-124">*Resiliency* refers toohello tolerance for normal failures that occur in hardware components.</span></span> <span data-ttu-id="e8765-125">Resilienza è hello possibilità toorecover dagli errori e continuare toofunction.</span><span class="sxs-lookup"><span data-stu-id="e8765-125">Resiliency is hello ability toorecover from failures and continue toofunction.</span></span> <span data-ttu-id="e8765-126">Non è su come evitare errori, ma risponde toofailures in modo da evitare tempi di inattività o perdita di dati.</span><span class="sxs-lookup"><span data-stu-id="e8765-126">It's not about avoiding failures, but responding toofailures in a way that avoids downtime or data loss.</span></span> <span data-ttu-id="e8765-127">obiettivo di Hello di resilienza è tooreturn hello tooa completamente funzionante lo stato dell'applicazione dopo un errore.</span><span class="sxs-lookup"><span data-stu-id="e8765-127">hello goal of resiliency is tooreturn hello application tooa fully functioning state following a failure.</span></span> <span data-ttu-id="e8765-128">Macchine virtuali di Azure e i dischi sono toobe progettato toocommon resilienti hardware errori.</span><span class="sxs-lookup"><span data-stu-id="e8765-128">Azure Virtual Machines and Disks are designed toobe resilient toocommon hardware faults.</span></span> <span data-ttu-id="e8765-129">Esaminiamo come piattaforma IaaS di Azure hello fornisce la resilienza.</span><span class="sxs-lookup"><span data-stu-id="e8765-129">Let us look at how hello Azure IaaS platform provides this resiliency.</span></span>

<span data-ttu-id="e8765-130">Una macchina virtuale è costituito principalmente da due parti: (1) un calcolo, server e dischi persistenti hello (2).</span><span class="sxs-lookup"><span data-stu-id="e8765-130">A virtual machine consists mainly of two parts: (1) A compute server, and (2) hello persistent disks.</span></span> <span data-ttu-id="e8765-131">Entrambi influiscono sulla tolleranza di errore hello di una macchina virtuale.</span><span class="sxs-lookup"><span data-stu-id="e8765-131">Both affect hello fault tolerance of a virtual machine.</span></span>

<span data-ttu-id="e8765-132">Se il server host di calcolo di Azure hello che ospita la macchina virtuale di cui si verifichi un errore hardware (che è raro), Azure è progettato tooautomatically ripristino hello macchina virtuale in un altro server.</span><span class="sxs-lookup"><span data-stu-id="e8765-132">If hello Azure compute host server that houses your VM experiences a hardware failure (which is rare), Azure is designed tooautomatically restore hello VM on another server.</span></span> <span data-ttu-id="e8765-133">In questo caso, si verificherà un riavvio e hello VM sarà eseguire il backup in un secondo momento.</span><span class="sxs-lookup"><span data-stu-id="e8765-133">If this happens, you will experience a reboot, and hello VM will be back up after some time.</span></span> <span data-ttu-id="e8765-134">Azure rileva tali errori hardware automaticamente ed esegue i ripristini toohelp verificare che il cliente hello VM sarà disponibile appena possibile.</span><span class="sxs-lookup"><span data-stu-id="e8765-134">Azure automatically detects such hardware failures and executes recoveries toohelp ensure hello customer VM will be available as soon as possible.</span></span>

<span data-ttu-id="e8765-135">Relative ai dischi IaaS, è fondamentale per la piattaforma di archiviazione permanente hello durabilità dei dati.</span><span class="sxs-lookup"><span data-stu-id="e8765-135">Regarding IaaS disks, durability of data is critical for hello persistent storage platform.</span></span> <span data-ttu-id="e8765-136">Azure dotate di applicazioni aziendali importanti in esecuzione su IaaS e dipendono persistenza hello dei dati di hello.</span><span class="sxs-lookup"><span data-stu-id="e8765-136">Azure customers have important business applications running on IaaS and they depend on hello persistence of hello data.</span></span> <span data-ttu-id="e8765-137">La progettazione della protezione di Azure per questi dischi IaaS prevede tre copie ridondanti dei dati archiviati localmente, in modo da offrire una durabilità elevata rispetto agli errori locali.</span><span class="sxs-lookup"><span data-stu-id="e8765-137">Azure designs protection for these IaaS disks with three redundant copies of data stored locally, providing high durability against local failures.</span></span> <span data-ttu-id="e8765-138">Se uno dei componenti hardware hello che contiene il disco non riesce, è possibile che la macchina virtuale non venga interessata perché sono presenti due copie aggiuntive toosupport disco richieste.</span><span class="sxs-lookup"><span data-stu-id="e8765-138">If one of hello hardware components that holds your disk fails, your VM is not impacted because there are two additional copies toosupport disk requests.</span></span> <span data-ttu-id="e8765-139">Funziona correttamente anche se i due diversi componenti hardware che supporta un disco non riuscire in hello stesso tempo (che sarebbe molto raro).</span><span class="sxs-lookup"><span data-stu-id="e8765-139">It works fine even if two different hardware components supporting a disk fail at hello same time (which would be very rare).</span></span> <span data-ttu-id="e8765-140">toohelp verificare sempre mantiene tre repliche, il servizio di archiviazione di Azure hello genera automaticamente una nuova copia dei dati in background hello se uno dei tre copie hello diventa non disponibile.</span><span class="sxs-lookup"><span data-stu-id="e8765-140">toohelp ensure we always maintain three replicas, hello Azure Storage service automatically spawns a new copy of data in hello background if one of hello three copies becomes unavailable.</span></span> <span data-ttu-id="e8765-141">Pertanto non deve essere necessario toouse RAID con dischi di Azure per la tolleranza di errore.</span><span class="sxs-lookup"><span data-stu-id="e8765-141">Therefore, it should not be necessary toouse RAID with Azure disks for fault tolerance.</span></span> <span data-ttu-id="e8765-142">Un RAID 0 semplice configurazione dovrebbe essere sufficiente per lo striping dischi hello toocreate necessari volumi di grandi dimensioni.</span><span class="sxs-lookup"><span data-stu-id="e8765-142">A simple RAID 0 configuration should be sufficient for striping hello disks if necessary toocreate larger volumes.</span></span>

<span data-ttu-id="e8765-143">Grazie a questa architettura, **Azure ha offerto in modo costante una durabilità di livello aziendale per dischi IaaS, con una percentuale di [frequenza di errori annualizzata](https://en.wikipedia.org/wiki/Annualized_failure_rate) pari a ZERO, ovvero la migliore del settore.**</span><span class="sxs-lookup"><span data-stu-id="e8765-143">Because of this architecture, **Azure has consistently delivered enterprise-grade durability for IaaS disks, with an industry-leading ZERO % [Annualized Failure Rate](https://en.wikipedia.org/wiki/Annualized_failure_rate).**</span></span>

<span data-ttu-id="e8765-144">Problemi hardware localizzati in hello calcolano host o nel servizio di archiviazione hello piattaforma può comportare talvolta indisponibilità temporanea per la macchina virtuale che è coperto da hello hello [SLA di Azure](https://azure.microsoft.com/support/legal/sla/virtual-machines/) per la disponibilità di macchina virtuale.</span><span class="sxs-lookup"><span data-stu-id="e8765-144">Localized hardware faults on hello compute host or in hello storage platform can sometimes result in temporary unavailability for hello VM which is covered by hello [Azure SLA](https://azure.microsoft.com/support/legal/sla/virtual-machines/) for VM Availability.</span></span> <span data-ttu-id="e8765-145">Azure offre anche un Contratto di servizio leader di settore per singole istanze di VM che usano dischi di Archiviazione Premium.</span><span class="sxs-lookup"><span data-stu-id="e8765-145">Azure also provides an industry-leading SLA for single VM instances that use Premium Storage disks.</span></span>

<span data-ttu-id="e8765-146">toosafeguard i carichi di lavoro di applicazione dall'inattività a causa di toohello temporanea indisponibilità di un disco o di una macchina virtuale, i clienti possono usare [set di disponibilità](../virtual-machines/windows/manage-availability.md).</span><span class="sxs-lookup"><span data-stu-id="e8765-146">toosafeguard application workloads from downtime due toohello temporary unavailability of a disk or VM, customers can leverage [Availability Sets](../virtual-machines/windows/manage-availability.md).</span></span> <span data-ttu-id="e8765-147">Due o più macchine virtuali in un set di disponibilità fornisce la ridondanza per un'applicazione hello.</span><span class="sxs-lookup"><span data-stu-id="e8765-147">Two or more virtual machines in an availability set provides redundancy for hello application.</span></span> <span data-ttu-id="e8765-148">Azure crea quindi queste VM e questi dischi in domini di errore separati con diverso tipo di alimentazione, diverse risorse di rete e diversi componenti del server.</span><span class="sxs-lookup"><span data-stu-id="e8765-148">Azure then creates these VMs and disks in separate fault domains with different power, network, and server components.</span></span> <span data-ttu-id="e8765-149">Di conseguenza, gli errori hardware localizzato in genere non influiscono più macchine virtuali in hello impostare hello stesso tempo, garantendo una disponibilità elevata per l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="e8765-149">Thus, localized hardware failures typically do not affect multiple VMs in hello set at hello same time, providing high availability for your application.</span></span> <span data-ttu-id="e8765-150">Viene considerato che una disponibilità toouse buona norma imposta quando è necessaria la disponibilità elevata.</span><span class="sxs-lookup"><span data-stu-id="e8765-150">It is considered a good practice toouse availability sets when high availability is required.</span></span> <span data-ttu-id="e8765-151">Per ulteriori informazioni, vedere gli aspetti di ripristino di emergenza hello descritti di seguito.</span><span class="sxs-lookup"><span data-stu-id="e8765-151">For more information, see hello Disaster Recovery aspects detailed below.</span></span>

### <a name="backup-and-disaster-recovery"></a><span data-ttu-id="e8765-152">Backup e ripristino di emergenza</span><span class="sxs-lookup"><span data-stu-id="e8765-152">Backup and Disaster Recovery</span></span>

<span data-ttu-id="e8765-153">Ripristino di emergenza (ripristino di emergenza) è hello possibilità toorecover da incidenti rari ma principali: errori non temporanei e larga scala, ad esempio interruzioni del servizio che interessa un'intera area.</span><span class="sxs-lookup"><span data-stu-id="e8765-153">Disaster recovery (DR) is hello ability toorecover from rare but major incidents: non-transient, wide-scale failures, such as service disruption that affects an entire region.</span></span> <span data-ttu-id="e8765-154">Il ripristino di emergenza include il backup dei dati e l'archiviazione e può includere l'intervento manuale, ad esempio il ripristino di un database dal backup.</span><span class="sxs-lookup"><span data-stu-id="e8765-154">Disaster recovery includes data backup and archiving, and may include manual intervention, such as restoring a database from backup.</span></span>

<span data-ttu-id="e8765-155">Hello protezione incorporata della piattaforma Azure in caso di errori localizzato potrebbe non garantire una protezione completa hello macchine virtuali e dischi in caso di hello di principali emergenze che possono causare interruzioni su larga scala.</span><span class="sxs-lookup"><span data-stu-id="e8765-155">hello Azure platform’s built-in protection against localized failures may not fully protect hello VMs/disks in hello case of major disasters which can cause large-scale outages.</span></span> <span data-ttu-id="e8765-156">ad esempio eventi irreversibili come uragani, terremoti, incendi o errori su larga scala delle unità hardware che colpiscono un data center.</span><span class="sxs-lookup"><span data-stu-id="e8765-156">This includes catastrophic events such as a data center being hit by a hurricane, earthquake, fire, or large scale hardware unit failures.</span></span> <span data-ttu-id="e8765-157">Inoltre, possono verificarsi errori a causa di problemi di tooapplication o dati.</span><span class="sxs-lookup"><span data-stu-id="e8765-157">In addition, you may encounter failures due tooapplication or data issues.</span></span>

<span data-ttu-id="e8765-158">toohelp proteggere i carichi di lavoro IaaS interruzioni, è consigliabile pianificare per il ripristino tooenable ridondanza e i backup.</span><span class="sxs-lookup"><span data-stu-id="e8765-158">toohelp protect your IaaS workloads from outages, you should plan for redundancy and backups tooenable recovery.</span></span> <span data-ttu-id="e8765-159">Ripristino di emergenza, è consigliabile pianificare backup in una posizione geografica diversa dal sito primario di hello e ridondanza.</span><span class="sxs-lookup"><span data-stu-id="e8765-159">For disaster recovery, you should plan redundancy and backup in a different geographic location away from hello primary site.</span></span> <span data-ttu-id="e8765-160">Ciò consente di garantire il backup non è interessato dalle hello stesso evento che originariamente interessati hello macchina virtuale o dischi.</span><span class="sxs-lookup"><span data-stu-id="e8765-160">This helps ensure your backup is not affected by hello same event that originally impacted hello VM or disks.</span></span> <span data-ttu-id="e8765-161">Per altre informazioni, vedere [Disaster Recovery for Applications built on Azure](https://docs.microsoft.com/azure/architecture/resiliency/disaster-recovery-azure-applications) (Ripristino di emergenza per applicazioni basate su Azure).</span><span class="sxs-lookup"><span data-stu-id="e8765-161">For more information, see [Disaster Recovery for Applications built on Azure](https://docs.microsoft.com/azure/architecture/resiliency/disaster-recovery-azure-applications).</span></span>

<span data-ttu-id="e8765-162">Le considerazioni di ripristino di emergenza possono includere hello seguenti aspetti:</span><span class="sxs-lookup"><span data-stu-id="e8765-162">Your DR considerations may include hello following aspects:</span></span>

1. <span data-ttu-id="e8765-163">Disponibilità elevata è il possibilità hello di hello toocontinue di applicazione in esecuzione in uno stato integro, senza tempi di inattività significativi.</span><span class="sxs-lookup"><span data-stu-id="e8765-163">High Availability (HA) is hello ability of hello application toocontinue running in a healthy state, without significant downtime.</span></span> <span data-ttu-id="e8765-164">Per "Integro", si intende un'applicazione hello è reattiva e gli utenti possono connettersi toohello applicazione e interagire con esso.</span><span class="sxs-lookup"><span data-stu-id="e8765-164">By "healthy state," we mean hello application is responsive, and users can connect toohello application and interact with it.</span></span> <span data-ttu-id="e8765-165">Alcuni database e applicazioni mission-critical possono essere necessari toobe disponibile sempre, anche se sono presenti errori nella piattaforma hello.</span><span class="sxs-lookup"><span data-stu-id="e8765-165">Certain mission-critical applications and databases may be required toobe available always, even when there are failures in hello platform.</span></span> <span data-ttu-id="e8765-166">Per questi carichi di lavoro, potrebbe essere necessario tooplan ridondanza per un'applicazione hello, nonché dati hello.</span><span class="sxs-lookup"><span data-stu-id="e8765-166">For these workloads, you may need tooplan redundancy for hello application as well as hello data.</span></span>

2. <span data-ttu-id="e8765-167">Durabilità dei dati: In alcuni casi, la considerazione principale hello consiste nel garantire dati hello viene mantenuti in caso di hello un'emergenza.</span><span class="sxs-lookup"><span data-stu-id="e8765-167">Data Durability: In some cases, hello main consideration is ensuring hello data is preserved in hello case of a disaster.</span></span> <span data-ttu-id="e8765-168">Potrebbe essere quindi necessario un backup dei dati in una posizione diversa.</span><span class="sxs-lookup"><span data-stu-id="e8765-168">Therefore, you may need a backup of your data in a different site.</span></span> <span data-ttu-id="e8765-169">Tali carichi di lavoro, potrebbe essere necessario non ridondanza completa per un'applicazione hello, ma un backup regolare dei dischi hello.</span><span class="sxs-lookup"><span data-stu-id="e8765-169">For such workloads, you may not need full redundancy for hello application, but a regular backup of hello disks.</span></span>

## <a name="backup-and-dr-scenarios"></a><span data-ttu-id="e8765-170">Scenari di backup e ripristino di emergenza</span><span class="sxs-lookup"><span data-stu-id="e8765-170">Backup and DR Scenarios</span></span>

<span data-ttu-id="e8765-171">Ecco alcuni esempi tipici scenari di applicazione del carico di lavoro e le considerazioni di hello per la pianificazione di ripristino di emergenza.</span><span class="sxs-lookup"><span data-stu-id="e8765-171">Let’s look at a few typical examples of application workload scenarios and hello considerations for planning Disaster Recovery.</span></span>

### <a name="scenario-1-major-database-solutions"></a><span data-ttu-id="e8765-172">Scenario 1: Principali soluzioni di database</span><span class="sxs-lookup"><span data-stu-id="e8765-172">Scenario 1: Major Database Solutions</span></span>

<span data-ttu-id="e8765-173">Si consideri un server di database di produzione, ad esempio SQL Server oppure Oracle, in grado di supportare la disponibilità elevata.</span><span class="sxs-lookup"><span data-stu-id="e8765-173">Consider a production database server like SQL Server or Oracle that can support High Availability.</span></span> <span data-ttu-id="e8765-174">Le applicazioni di produzione cruciali e gli utenti dipendono da questo database.</span><span class="sxs-lookup"><span data-stu-id="e8765-174">Critical production applications and users depend on this database.</span></span> <span data-ttu-id="e8765-175">piano di ripristino di emergenza Hello per questo sistema potrebbe essere necessario hello toosupport seguenti requisiti:</span><span class="sxs-lookup"><span data-stu-id="e8765-175">hello Disaster Recovery plan for this system may need toosupport hello following requirements:</span></span>

1. <span data-ttu-id="e8765-176">I dati devono essere protetti e recuperabili.</span><span class="sxs-lookup"><span data-stu-id="e8765-176">Data must be protected and recoverable.</span></span>
2.  <span data-ttu-id="e8765-177">Il server deve essere disponibile per l'uso.</span><span class="sxs-lookup"><span data-stu-id="e8765-177">Server must be available for use.</span></span>

<span data-ttu-id="e8765-178">Tale operazione potrebbe richiedere la gestione di una replica di database hello in un'area diversa come backup.</span><span class="sxs-lookup"><span data-stu-id="e8765-178">This may require maintaining a replica of hello database in a different region as a backup.</span></span> <span data-ttu-id="e8765-179">A seconda dei requisiti di hello per la disponibilità di server e il ripristino dei dati, soluzione hello potrebbe variare da un attivo-attivo o attivo-passivo replica sito tooperiodic backup non in linea dei dati di hello.</span><span class="sxs-lookup"><span data-stu-id="e8765-179">Depending on hello requirements for server availability and data recovery, hello solution could range from an Active-Active or Active-Passive replica site tooperiodic offline backups of hello data.</span></span> <span data-ttu-id="e8765-180">I database relazionali come SQL Server e Oracle offrono diverse opzioni per la replica.</span><span class="sxs-lookup"><span data-stu-id="e8765-180">Relational databases such as SQL Server and Oracle provide various options for replication.</span></span> <span data-ttu-id="e8765-181">Per SQL Server è possibile usare [SQL Server Always On Availability Groups](https://msdn.microsoft.com/library/hh510230.aspx) (Gruppi di disponibilità AlwaysOn di SQL Server) per ottenere la disponibilità elevata.</span><span class="sxs-lookup"><span data-stu-id="e8765-181">For SQL Server, [SQL Server Always On Availability Groups](https://msdn.microsoft.com/library/hh510230.aspx) can be used for high availability.</span></span>

<span data-ttu-id="e8765-182">Anche i database NoSQL come MongoDB supportano le [repliche](https://docs.mongodb.com/manual/replication/) per la ridondanza.</span><span class="sxs-lookup"><span data-stu-id="e8765-182">NoSQL databases like MongoDB also support [replicas](https://docs.mongodb.com/manual/replication/) for redundancy.</span></span> <span data-ttu-id="e8765-183">le repliche di Hello per la disponibilità elevata possono essere utilizzate.</span><span class="sxs-lookup"><span data-stu-id="e8765-183">hello replicas for high availability can be used.</span></span>

### <a name="scenario-2-a-cluster-of-redundant-vms"></a><span data-ttu-id="e8765-184">Scenario 2: Cluster di VM ridondanti</span><span class="sxs-lookup"><span data-stu-id="e8765-184">Scenario 2: A cluster of redundant VMs</span></span>

<span data-ttu-id="e8765-185">Si consideri un carico di lavoro gestito da un cluster di VM che forniscono ridondanza e bilanciamento del carico,</span><span class="sxs-lookup"><span data-stu-id="e8765-185">Consider a workload handled by a cluster of VMs that provide redundancy and load balancing.</span></span> <span data-ttu-id="e8765-186">ad esempio un cluster Cassandra distribuito in un'area.</span><span class="sxs-lookup"><span data-stu-id="e8765-186">One example would be a Cassandra cluster deployed in a region.</span></span> <span data-ttu-id="e8765-187">Questo tipo di architettura fornisce già un livello elevato di ridondanza entro tale area.</span><span class="sxs-lookup"><span data-stu-id="e8765-187">This type of architecture already provides a high level of redundancy within that region.</span></span> <span data-ttu-id="e8765-188">Tuttavia, tooprotect hello il carico di lavoro da un errore a livello regionale, considerare la distribuzione di cluster hello in due aree o la regione tooanother backup periodici.</span><span class="sxs-lookup"><span data-stu-id="e8765-188">However, tooprotect hello workload from a regional level failure, you should consider spreading hello cluster across two regions or making periodic backups tooanother region.</span></span>

### <a name="scenario-3-iaas-application-workload"></a><span data-ttu-id="e8765-189">Scenario 3: Carico di lavoro delle applicazioni IaaS</span><span class="sxs-lookup"><span data-stu-id="e8765-189">Scenario 3: IaaS Application Workload</span></span>

<span data-ttu-id="e8765-190">Potrebbe trattarsi di un carico di lavoro tipico in esecuzione in una VM di Azure,</span><span class="sxs-lookup"><span data-stu-id="e8765-190">This could be a typical production workload running on an Azure VM.</span></span> <span data-ttu-id="e8765-191">È possibile ad esempio, un server web o file che contiene il contenuto di hello e altre risorse di un sito.</span><span class="sxs-lookup"><span data-stu-id="e8765-191">For example, it could be a web server or file server holding hello content and other resources of a site.</span></span> <span data-ttu-id="e8765-192">Potrebbe anche essere un'applicazione di business personalizzata in esecuzione in una macchina virtuale archiviati relativi dati, risorse e lo stato dell'applicazione nei dischi di macchina virtuale hello.</span><span class="sxs-lookup"><span data-stu-id="e8765-192">It could also be a custom-built business application running on a VM that stored its data, resources, and application state on hello VM disks.</span></span> <span data-ttu-id="e8765-193">In questo caso, è importante toomake assicurarsi di che eseguire backup a intervalli regolari.</span><span class="sxs-lookup"><span data-stu-id="e8765-193">In this case, it is important toomake sure you take backups on a regular basis.</span></span> <span data-ttu-id="e8765-194">Frequenza di backup dovrebbe essere basata su natura hello del carico di lavoro VM hello.</span><span class="sxs-lookup"><span data-stu-id="e8765-194">Backup frequency should be based on hello nature of hello VM workload.</span></span> <span data-ttu-id="e8765-195">Ad esempio, se un'applicazione hello viene eseguito ogni giorno e modifica i dati, quindi hello devono eseguire backup ogni ora.</span><span class="sxs-lookup"><span data-stu-id="e8765-195">For example, if hello application runs every day and modifies data, then hello backup should be taken every hour.</span></span>

<span data-ttu-id="e8765-196">Un altro esempio è costituito da un server di report che esegue il pull dei dati da altre origini e genera report aggregati.</span><span class="sxs-lookup"><span data-stu-id="e8765-196">Another example is a reporting server that pull data from other sources and generates aggregated reports.</span></span> <span data-ttu-id="e8765-197">Perdita di questa macchina virtuale o dischi comporti toohello perdita di hello report.</span><span class="sxs-lookup"><span data-stu-id="e8765-197">Loss of this VM or disks will lead toohello loss of hello reports.</span></span> <span data-ttu-id="e8765-198">Tuttavia, potrebbe essere possibile toorerun hello reporting processo e l'output di hello rigenerare.</span><span class="sxs-lookup"><span data-stu-id="e8765-198">However, it may be possible toorerun hello reporting process and regenerate hello output.</span></span> <span data-ttu-id="e8765-199">In tal caso, non è importante una perdita di dati anche se il server di report hello viene raggiunto con un'emergenza, è possibile un livello di tolleranza per perdere parte dei dati di hello in hello server di report.</span><span class="sxs-lookup"><span data-stu-id="e8765-199">In that case, you don’t really have a loss of data even if hello reporting server is hit with a disaster, so you could have a higher level of tolerance for losing part of hello data on hello reporting server.</span></span> <span data-ttu-id="e8765-200">In tal caso, i backup meno frequenti è un costo di hello tooreduce opzione.</span><span class="sxs-lookup"><span data-stu-id="e8765-200">In that case, less frequent backups is an option tooreduce hello cost.</span></span>

### <a name="scenario-4-iaas-application-data-issues"></a><span data-ttu-id="e8765-201">Scenario 4: Problemi relativi ai dati delle applicazioni IaaS</span><span class="sxs-lookup"><span data-stu-id="e8765-201">Scenario 4: IaaS Application data issues</span></span>

<span data-ttu-id="e8765-202">È presente un'applicazione che calcola, gestisce e fornisce dati commerciali cruciali, ad esempio le informazioni sui prezzi.</span><span class="sxs-lookup"><span data-stu-id="e8765-202">You have an application that computes, maintains, and serves critical commercial data such as pricing information.</span></span> <span data-ttu-id="e8765-203">Una nuova versione dell'applicazione contiene un bug del software che non è corretto calcolata hello prezzi e serviti dalla piattaforma hello hello esistente commerce dati danneggiati.</span><span class="sxs-lookup"><span data-stu-id="e8765-203">A new version of your application had a software bug which incorrectly computed hello pricing and corrupted hello existing commerce data served by hello platform.</span></span> <span data-ttu-id="e8765-204">In questo caso, hello migliore sarebbe toorevert toohello versione precedente di un'applicazione hello e dati hello prima.</span><span class="sxs-lookup"><span data-stu-id="e8765-204">Here, hello best course of action would be toorevert toohello earlier version of hello application and hello data first.</span></span> <span data-ttu-id="e8765-205">tooenable, questo backup periodici take del sistema.</span><span class="sxs-lookup"><span data-stu-id="e8765-205">tooenable this, take periodic backups of your system.</span></span>

## <a name="disaster-recovery-solution-azure-backup-service"></a><span data-ttu-id="e8765-206">Soluzione per il ripristino di emergenza: servizio Backup di Azure</span><span class="sxs-lookup"><span data-stu-id="e8765-206">Disaster Recovery Solution: Azure Backup Service</span></span>

<span data-ttu-id="e8765-207">Il [servizio Backup di Azure](https://azure.microsoft.com/services/backup/) può essere usato per il backup e il ripristino e funziona con [dischi gestiti](storage-managed-disks-overview.md) e [non gestiti](storage-about-disks-and-vhds-windows.md#unmanaged-disks).</span><span class="sxs-lookup"><span data-stu-id="e8765-207">[Azure Backup Service](https://azure.microsoft.com/services/backup/) is can be used for Backup and DR, and it works with [Managed Disks](storage-managed-disks-overview.md) as well as [Unmanaged Disks](storage-about-disks-and-vhds-windows.md#unmanaged-disks).</span></span> <span data-ttu-id="e8765-208">È possibile creare un processo di backup con backup basati su orari specifici e con criteri semplici per il ripristino delle VM e la conservazione dei backup.</span><span class="sxs-lookup"><span data-stu-id="e8765-208">You can create a backup job with time-based backups, easy VM restoration and backup retention policies.</span></span> 

<span data-ttu-id="e8765-209">Se si utilizza [dischi di archiviazione Premium](storage-premium-storage.md), [dischi gestiti](storage-managed-disks-overview.md), o altri tipi di disco con hello [archiviazione localmente ridondante (LRS)](storage-redundancy.md#locally-redundant-storage) opzione, è particolarmente importante tooleverage backup di ripristino di emergenza periodici.</span><span class="sxs-lookup"><span data-stu-id="e8765-209">If you use [Premium Storage disks](storage-premium-storage.md), [Managed Disks](storage-managed-disks-overview.md), or other disk types with hello [locally redundant storage (LRS)](storage-redundancy.md#locally-redundant-storage) option, it is especially important tooleverage periodic DR backups.</span></span> <span data-ttu-id="e8765-210">Backup di Azure archivia i dati di hello nell'insieme di credenziali di servizi di ripristino per la conservazione a lungo termine.</span><span class="sxs-lookup"><span data-stu-id="e8765-210">Azure Backup stores hello data in your Recovery Services vault for long term retention.</span></span> <span data-ttu-id="e8765-211">Scegliere hello [archiviazione con ridondanza geografica (GRS)](storage-redundancy.md#geo-redundant-storage) opzione per l'insieme di credenziali di servizi di ripristino Backup hello.</span><span class="sxs-lookup"><span data-stu-id="e8765-211">Choose hello [Geo-redundant storage (GRS)](storage-redundancy.md#geo-redundant-storage) option for hello Backup Recovery Services vault.</span></span> <span data-ttu-id="e8765-212">Garantisce che i backup vengono replicate tooa area Azure diversa per protezione da calamità.</span><span class="sxs-lookup"><span data-stu-id="e8765-212">That will ensure backups are replicated tooa different Azure region for safeguarding from regional disasters.</span></span>

<span data-ttu-id="e8765-213">Per [dischi non gestito](storage-about-disks-and-vhds-windows.md#unmanaged-disks), è possibile usare il tipo di archiviazione con ridondanza di hello per i dischi di IaaS, ma assicurarsi che i Backup di Azure sia abilitato con l'opzione di archiviazione con ridondanza geografica per l'insieme di credenziali di servizi di ripristino hello hello.</span><span class="sxs-lookup"><span data-stu-id="e8765-213">For [Unmanaged Disks](storage-about-disks-and-vhds-windows.md#unmanaged-disks), you can use hello LRS storage type for IaaS disks, but ensure that Azure Backup is enabled with hello GRS option for hello Recovery Services Vault.</span></span>

<span data-ttu-id="e8765-214">**Se si utilizza hello [GRS](storage-redundancy.md#geo-redundant-storage)/[RA-GRS](storage-redundancy.md#read-access-geo-redundant-storage) opzione per i dischi non gestito, è comunque necessario snapshot coerenti per il Backup e ripristino di emergenza.**</span><span class="sxs-lookup"><span data-stu-id="e8765-214">**If you use hello [GRS](storage-redundancy.md#geo-redundant-storage)/[RA-GRS](storage-redundancy.md#read-access-geo-redundant-storage) option for your Unmanaged Disks, you still need consistent snapshots for Backup and DR.**</span></span> <span data-ttu-id="e8765-215">È necessario usare il [servizio Backup di Azure](https://azure.microsoft.com/services/backup/) o [snapshot coerenti](#alternative-solution-consistent-snapshots).</span><span class="sxs-lookup"><span data-stu-id="e8765-215">You must use either [Azure Backup Service](https://azure.microsoft.com/services/backup/) or [consistent snapshots](#alternative-solution-consistent-snapshots).</span></span>

<span data-ttu-id="e8765-216">di seguito Hello è un riepilogo delle soluzioni di ripristino di emergenza.</span><span class="sxs-lookup"><span data-stu-id="e8765-216">hello following is a summary of solutions for DR.</span></span>

| <span data-ttu-id="e8765-217">Scenario</span><span class="sxs-lookup"><span data-stu-id="e8765-217">Scenario</span></span> | <span data-ttu-id="e8765-218">Replica automatica</span><span class="sxs-lookup"><span data-stu-id="e8765-218">Automatic Replication</span></span> | <span data-ttu-id="e8765-219">Soluzione di ripristino di emergenza</span><span class="sxs-lookup"><span data-stu-id="e8765-219">DR Solution</span></span> |
| --- | --- | --- |
| <span data-ttu-id="e8765-220">*Dischi di Archiviazione Premium*</span><span class="sxs-lookup"><span data-stu-id="e8765-220">*Premium Storage Disks*</span></span> | <span data-ttu-id="e8765-221">Locale ([Archiviazione con ridondanza locale](storage-redundancy.md#locally-redundant-storage))</span><span class="sxs-lookup"><span data-stu-id="e8765-221">Local ([LRS](storage-redundancy.md#locally-redundant-storage))</span></span> | [<span data-ttu-id="e8765-222">Backup di Azure</span><span class="sxs-lookup"><span data-stu-id="e8765-222">Azure Backup</span></span>](https://azure.microsoft.com/services/backup/) |
| <span data-ttu-id="e8765-223">*Managed Disks*</span><span class="sxs-lookup"><span data-stu-id="e8765-223">*Managed Disks*</span></span> | <span data-ttu-id="e8765-224">Locale ([Archiviazione con ridondanza locale](storage-redundancy.md#locally-redundant-storage))</span><span class="sxs-lookup"><span data-stu-id="e8765-224">Local ([LRS](storage-redundancy.md#locally-redundant-storage))</span></span> | [<span data-ttu-id="e8765-225">Backup di Azure</span><span class="sxs-lookup"><span data-stu-id="e8765-225">Azure Backup</span></span>](https://azure.microsoft.com/services/backup/) |
| <span data-ttu-id="e8765-226">*Dischi non gestiti con archiviazione con ridondanza locale*</span><span class="sxs-lookup"><span data-stu-id="e8765-226">*Unmanaged LRS Disks*</span></span> | <span data-ttu-id="e8765-227">Locale ([Archiviazione con ridondanza locale](storage-redundancy.md#locally-redundant-storage))</span><span class="sxs-lookup"><span data-stu-id="e8765-227">Local ([LRS](storage-redundancy.md#locally-redundant-storage))</span></span> | [<span data-ttu-id="e8765-228">Backup di Azure</span><span class="sxs-lookup"><span data-stu-id="e8765-228">Azure Backup</span></span>](https://azure.microsoft.com/services/backup/) |
| <span data-ttu-id="e8765-229">*Dischi non gestiti con archiviazione con ridondanza geografica*</span><span class="sxs-lookup"><span data-stu-id="e8765-229">*Unmanaged GRS Disks*</span></span> | <span data-ttu-id="e8765-230">Tra aree ([Archiviazione con ridondanza geografica](storage-redundancy.md#geo-redundant-storage))</span><span class="sxs-lookup"><span data-stu-id="e8765-230">Cross region ([GRS](storage-redundancy.md#geo-redundant-storage))</span></span> | [<span data-ttu-id="e8765-231">Backup di Azure</span><span class="sxs-lookup"><span data-stu-id="e8765-231">Azure Backup</span></span>](https://azure.microsoft.com/services/backup/)<br/>[<span data-ttu-id="e8765-232">Snapshot coerenti</span><span class="sxs-lookup"><span data-stu-id="e8765-232">Consistent snapshots</span></span>](#alternative-solution-consistent-snapshots) |
| <span data-ttu-id="e8765-233">*Dischi non gestiti con archiviazione con ridondanza geografica e accesso in lettura*</span><span class="sxs-lookup"><span data-stu-id="e8765-233">*Unmanaged RA-GRS Disks*</span></span> | <span data-ttu-id="e8765-234">Tra aree ([Archiviazione con ridondanza geografica e accesso in lettura](storage-redundancy.md#read-access-geo-redundant-storage))</span><span class="sxs-lookup"><span data-stu-id="e8765-234">Cross region ([RA-GRS](storage-redundancy.md#read-access-geo-redundant-storage))</span></span> | [<span data-ttu-id="e8765-235">Backup di Azure</span><span class="sxs-lookup"><span data-stu-id="e8765-235">Azure Backup</span></span>](https://azure.microsoft.com/services/backup/)<br/>[<span data-ttu-id="e8765-236">Snapshot coerenti</span><span class="sxs-lookup"><span data-stu-id="e8765-236">Consistent snapshots</span></span>](#alternative-solution-consistent-snapshots) |

<span data-ttu-id="e8765-237">Disponibilità elevata meglio possibile soddisfatti da tramite l'utilizzo di hello di dischi gestiti in un Set di disponibilità insieme ai Backup di Azure.</span><span class="sxs-lookup"><span data-stu-id="e8765-237">High availability can best by met through hello use of Managed Disks in an Availability Set along with Azure Backup.</span></span> <span data-ttu-id="e8765-238">Se si usano i dischi non gestiti, è comunque possibile usare Backup di Azure per il ripristino di emergenza.</span><span class="sxs-lookup"><span data-stu-id="e8765-238">If you are using Unmanaged Disks, you can still  use Azure Backup for DR.</span></span> <span data-ttu-id="e8765-239">Se si è grado toouse Backup di Azure, quindi scegliere [snapshot coerenti](#alternative-solution-consistent-snapshots) come descritto in una sezione successiva è una soluzione alternativa per il Backup e ripristino di emergenza.</span><span class="sxs-lookup"><span data-stu-id="e8765-239">If you are unable toouse Azure Backup, then taking [consistent snapshots](#alternative-solution-consistent-snapshots) as described in a later section is an alternative solution for Backup and DR.</span></span>

<span data-ttu-id="e8765-240">Le opzioni per la disponibilità elevata, il backup e il ripristino di emergenza a livello di applicazione o infrastruttura possono essere rappresentate come segue:</span><span class="sxs-lookup"><span data-stu-id="e8765-240">Your choices for high availability, backup and DR at Application or Infrastructure levels can be represented as below:</span></span>

| <span data-ttu-id="e8765-241">*Level*</span><span class="sxs-lookup"><span data-stu-id="e8765-241">*Level*</span></span> | <span data-ttu-id="e8765-242">Disponibilità elevata</span><span class="sxs-lookup"><span data-stu-id="e8765-242">High Availability</span></span>   | <span data-ttu-id="e8765-243">Backup/Ripristino di emergenza</span><span class="sxs-lookup"><span data-stu-id="e8765-243">Backup / DR</span></span> |
| --- | --- | --- |
| <span data-ttu-id="e8765-244">*Applicazione*</span><span class="sxs-lookup"><span data-stu-id="e8765-244">*Application*</span></span> | <span data-ttu-id="e8765-245">SQL AlwaysOn</span><span class="sxs-lookup"><span data-stu-id="e8765-245">SQL Always On</span></span> | <span data-ttu-id="e8765-246">Backup di Azure</span><span class="sxs-lookup"><span data-stu-id="e8765-246">Azure Backup</span></span> |
| <span data-ttu-id="e8765-247">*Infrastruttura*</span><span class="sxs-lookup"><span data-stu-id="e8765-247">*Infrastructure*</span></span>  | <span data-ttu-id="e8765-248">Set di disponibilità</span><span class="sxs-lookup"><span data-stu-id="e8765-248">Availability Set</span></span>  | <span data-ttu-id="e8765-249">Archiviazione con ridondanza geografica con snapshot coerenti</span><span class="sxs-lookup"><span data-stu-id="e8765-249">GRS with consistent snapshots</span></span> |

### <a name="using-hello-azure-backup-service"></a><span data-ttu-id="e8765-250">Utilizzo di hello servizio Backup di Azure</span><span class="sxs-lookup"><span data-stu-id="e8765-250">Using hello Azure Backup Service</span></span>

<span data-ttu-id="e8765-251">[Backup di Azure](../backup/backup-azure-vms-introduction.md) può eseguire il backup delle macchine virtuali in esecuzione Windows o Linux toohello insieme di credenziali di Azure Recovery Services.</span><span class="sxs-lookup"><span data-stu-id="e8765-251">[Azure Backup](../backup/backup-azure-vms-introduction.md) can backup your VMs running Windows or Linux toohello Azure Recovery Services Vault.</span></span> <span data-ttu-id="e8765-252">Backup e ripristino dei dati aziendali critici è complicata dal fatto di hello che dati aziendali critici devono eseguire il backup durante le applicazioni di hello che producono hello dati sono in esecuzione.</span><span class="sxs-lookup"><span data-stu-id="e8765-252">Backing up and restoring business-critical data is complicated by hello fact that business-critical data must be backed up while hello applications that produce hello data are running.</span></span> <span data-ttu-id="e8765-253">tooaddress, Azure Backup include backup coerenti con l'applicazione per i carichi di lavoro con tooensure servizio Shadow del Volume (VSS) hello che vengano scritti dati correttamente toostorage.</span><span class="sxs-lookup"><span data-stu-id="e8765-253">tooaddress this, Azure Backup provides application-consistent backups for Microsoft workloads by using hello Volume Shadow Service (VSS) tooensure that data is written correctly toostorage.</span></span> <span data-ttu-id="e8765-254">Per le macchine virtuali Linux, solo i backup coerenti con i file sono possibili, poiché non dispone di funzionalità equivalenti tooVSS Linux.</span><span class="sxs-lookup"><span data-stu-id="e8765-254">For Linux VMs, only file-consistent backups are possible, since Linux does not have functionality equivalent tooVSS.</span></span>

![][1]

<span data-ttu-id="e8765-255">Quando Azure Backup avvia un processo di backup in fase di hello pianificata, attiva estensione backup di hello installata in hello VM tootake uno snapshot del punto nel tempo.</span><span class="sxs-lookup"><span data-stu-id="e8765-255">When Azure Backup initiates a backup job at hello scheduled time, it triggers hello backup extension installed in hello VM tootake a point-in-time snapshot.</span></span> <span data-ttu-id="e8765-256">Viene eseguito uno snapshot in coordinamento con VSS tooget uno snapshot coerente dei dischi hello nella macchina virtuale hello senza tooshut, verso il basso.</span><span class="sxs-lookup"><span data-stu-id="e8765-256">A snapshot is taken in coordination with VSS tooget a consistent snapshot of hello disks in hello virtual machine without having tooshut it down.</span></span> <span data-ttu-id="e8765-257">estensione del backup Hello in hello VM Scarica tutte le operazioni di scrittura prima di eseguire uno snapshot coerente hello di tutti i dischi di hello.</span><span class="sxs-lookup"><span data-stu-id="e8765-257">hello backup extension in hello VM flushes all writes before taking hello consistent snapshot of all hello disks.</span></span> <span data-ttu-id="e8765-258">Dopo che hello dello snapshot, i dati hello viene trasferiti dall'insieme di credenziali backup toohello Azure Backup.</span><span class="sxs-lookup"><span data-stu-id="e8765-258">After hello snapshot is taken, hello data is transferred by Azure Backup toohello backup vault.</span></span> <span data-ttu-id="e8765-259">toomake hello processo di backup più efficiente, servizio hello identifica e trasferisce solo i blocchi di hello di dati che sono stati modificati dopo l'ultimo backup hello.</span><span class="sxs-lookup"><span data-stu-id="e8765-259">toomake hello backup process more efficient, hello service identifies and transfers only hello blocks of data that have changed since hello last backup.</span></span>


<span data-ttu-id="e8765-260">toorestore, è possibile visualizzare i backup disponibili hello tramite Backup di Azure e quindi avviare un ripristino.</span><span class="sxs-lookup"><span data-stu-id="e8765-260">toorestore, you can view hello available backups through Azure Backup and then initiate a restore.</span></span> <span data-ttu-id="e8765-261">È possibile creare e ripristinare i backup di Azure tramite hello [portale di Azure](https://portal.azure.com/), [tramite PowerShell](../backup/backup-azure-vms-automation.md ), o tramite hello [CLI di Azure](https://docs.microsoft.com/azure/xplat-cli-install).</span><span class="sxs-lookup"><span data-stu-id="e8765-261">You can create and restore Azure backups through hello [Azure portal](https://portal.azure.com/), [using PowerShell](../backup/backup-azure-vms-automation.md ), or using hello [Azure CLI](https://docs.microsoft.com/azure/xplat-cli-install).</span></span> <span data-ttu-id="e8765-262">Per altre informazioni, vedere Backup di Azure.</span><span class="sxs-lookup"><span data-stu-id="e8765-262">For more information, see Azure Backup.</span></span>

### <a name="steps-tooenable-backup"></a><span data-ttu-id="e8765-263">Passaggi tooEnable Backup</span><span class="sxs-lookup"><span data-stu-id="e8765-263">Steps tooEnable Backup</span></span>

<span data-ttu-id="e8765-264">i passaggi seguenti Hello sono tooenable utilizzati in genere i backup delle macchine virtuali utilizzando hello [portale Azure](https://portal.azure.com/).</span><span class="sxs-lookup"><span data-stu-id="e8765-264">hello following steps are typically used tooenable backups of your VMs using hello [Azure Portal](https://portal.azure.com/).</span></span> <span data-ttu-id="e8765-265">La procedura presenterà alcune variazioni in base allo scenario esatto.</span><span class="sxs-lookup"><span data-stu-id="e8765-265">There will be some variations depending on your exact scenario.</span></span> <span data-ttu-id="e8765-266">Fare riferimento toohello [Azure Backup](../backup/backup-azure-vms-introduction.md) documentazione per i dettagli completi.</span><span class="sxs-lookup"><span data-stu-id="e8765-266">Refer toohello [Azure Backup](../backup/backup-azure-vms-introduction.md) documentation for full details.</span></span> <span data-ttu-id="e8765-267">Backup di Azure [supporta anche le VM con Managed Disks](https://azure.microsoft.com/blog/azure-managed-disk-backup/).</span><span class="sxs-lookup"><span data-stu-id="e8765-267">Azure Backup also [supports VMs with Managed Disks](https://azure.microsoft.com/blog/azure-managed-disk-backup/).</span></span>

1.  <span data-ttu-id="e8765-268">Creare un insieme di credenziali di servizi di ripristino per una macchina virtuale tramite hello alla procedura seguente:</span><span class="sxs-lookup"><span data-stu-id="e8765-268">Create a recovery services vault for a VM using hello following steps:</span></span>

    <span data-ttu-id="e8765-269">a.</span><span class="sxs-lookup"><span data-stu-id="e8765-269">a.</span></span>  <span data-ttu-id="e8765-270">Utilizzo di hello [portale di Azure](https://portal.azure.com/), selezionare tutte le risorse e cercare "Insiemi di credenziali di servizi di ripristino".</span><span class="sxs-lookup"><span data-stu-id="e8765-270">Using hello [Azure portal](https://portal.azure.com/), browse all resources and find “Recovery Services vaults”.</span></span>

    <span data-ttu-id="e8765-271">b.</span><span class="sxs-lookup"><span data-stu-id="e8765-271">b.</span></span>  <span data-ttu-id="e8765-272">In hello servizi di ripristino di insiemi di credenziali di menu, fare clic su Aggiungi e seguire hello passaggi toocreate un nuovo insieme di credenziali hello hello VM stessa area.</span><span class="sxs-lookup"><span data-stu-id="e8765-272">On hello Recovery Services vaults menu, click Add and follow hello steps toocreate a new vault in hello same region as hello VM.</span></span> <span data-ttu-id="e8765-273">Ad esempio, se la macchina virtuale è nell'area Stati Uniti occidentali, scegliere Stati Uniti occidentali per insieme di credenziali hello.</span><span class="sxs-lookup"><span data-stu-id="e8765-273">For example, if your VM is in West US region, pick West US for hello vault.</span></span>

2.  <span data-ttu-id="e8765-274">Verificare la replica di archiviazione hello per hello appena creato l'insieme di credenziali.</span><span class="sxs-lookup"><span data-stu-id="e8765-274">Verify hello Storage replication for hello newly created vault.</span></span> <span data-ttu-id="e8765-275">toodo, questo insieme di credenziali di accesso hello da hello servizi di ripristino gli insiemi di credenziali blade e passare toohello impostazioni/Backup configurazione.</span><span class="sxs-lookup"><span data-stu-id="e8765-275">toodo this, access hello vault from hello Recovery Services vaults blade and go toohello settings/Backup Configuration.</span></span> <span data-ttu-id="e8765-276">Verificare l'opzione di archiviazione con ridondanza geografica hello è selezionata per impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="e8765-276">Ensure hello GRS option is selected by default.</span></span> <span data-ttu-id="e8765-277">Ciò garantisce che l'insieme di credenziali viene replicata automaticamente tooa data center secondario.</span><span class="sxs-lookup"><span data-stu-id="e8765-277">This will ensure that your vault is automatically replicated tooa secondary data center.</span></span> <span data-ttu-id="e8765-278">Ad esempio, l'insieme di credenziali negli Stati Uniti occidentali saranno automaticamente replicati tooEast Stati Uniti.</span><span class="sxs-lookup"><span data-stu-id="e8765-278">For example, your vault in West US will be automatically replicated tooEast US.</span></span>

3.  <span data-ttu-id="e8765-279">Configurare i criteri di backup hello e selezionare hello VM hello stessa interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="e8765-279">Configure hello backup policy and select hello VM from hello same UI.</span></span>

4.  <span data-ttu-id="e8765-280">Verificare che hello che backup Agent viene installato nella macchina virtuale hello.</span><span class="sxs-lookup"><span data-stu-id="e8765-280">Make sure hello Backup Agent is installed on hello VM.</span></span> <span data-ttu-id="e8765-281">Se la macchina virtuale viene creata usando un'immagine della raccolta di Azure, l'agente di Backup hello è già installato.</span><span class="sxs-lookup"><span data-stu-id="e8765-281">If your VM is created using an Azure gallery image, then hello Backup agent is already installed.</span></span> <span data-ttu-id="e8765-282">In caso contrario (ovvero, se si utilizza un'immagine personalizzata), utilizzare istruzioni troppo[hello installazione agente della macchina virtuale nella macchina virtuale hello](../backup/backup-azure-arm-vms-prepare.md#install-the-vm-agent-on-the-virtual-machine).</span><span class="sxs-lookup"><span data-stu-id="e8765-282">Otherwise (that is, if you are using a custom image), use instructions too[Install hello VM Agent on hello virtual machine](../backup/backup-azure-arm-vms-prepare.md#install-the-vm-agent-on-the-virtual-machine).</span></span>

5.  <span data-ttu-id="e8765-283">Verificare che tale macchina virtuale di hello consente la connettività di rete per hello toofunction di servizio di backup.</span><span class="sxs-lookup"><span data-stu-id="e8765-283">Make sure that hello VM allows network connectivity for hello backup service toofunction.</span></span> <span data-ttu-id="e8765-284">Seguire queste istruzioni per la [Connettività di rete](../backup/backup-azure-arm-vms-prepare.md#network-connectivity).</span><span class="sxs-lookup"><span data-stu-id="e8765-284">Follow these instructions for [Network connectivity](../backup/backup-azure-arm-vms-prepare.md#network-connectivity).</span></span>

6.  <span data-ttu-id="e8765-285">Al termine di hello sopra passaggi, verrà eseguito il backup di hello a intervalli regolari, come specificato nel criterio di backup hello.</span><span class="sxs-lookup"><span data-stu-id="e8765-285">Once hello above steps are completed, hello backup will run at regular intervals as specified in hello backup policy.</span></span> <span data-ttu-id="e8765-286">Se necessario, è possibile attivare il backup prima di hello manualmente dal dashboard dell'insieme di credenziali di hello in hello portale di Azure.</span><span class="sxs-lookup"><span data-stu-id="e8765-286">If necessary, you can trigger hello first backup manually from hello vault dashboard on hello Azure portal.</span></span>

<span data-ttu-id="e8765-287">Per l'automazione di Azure Backup tramite script, fare riferimento troppo[i cmdlet di PowerShell per il backup VM](../backup/backup-azure-vms-automation.md).</span><span class="sxs-lookup"><span data-stu-id="e8765-287">For automating Azure Backup using scripts, please refer too[PowerShell cmdlets for VM backup](../backup/backup-azure-vms-automation.md).</span></span>

### <a name="steps-for-recovery"></a><span data-ttu-id="e8765-288">Procedura per il ripristino</span><span class="sxs-lookup"><span data-stu-id="e8765-288">Steps for Recovery</span></span>

<span data-ttu-id="e8765-289">Se è necessario toorepair o si ricompila una macchina virtuale, è possibile ripristinare hello macchina virtuale da uno qualsiasi dei punti di ripristino dei backup hello nell'insieme di credenziali hello.</span><span class="sxs-lookup"><span data-stu-id="e8765-289">If you need toorepair or rebuild a VM, you can restore hello VM from any of hello backup recovery points in hello vault.</span></span> <span data-ttu-id="e8765-290">Esistono un paio di diverse opzioni per eseguire il ripristino di hello:</span><span class="sxs-lookup"><span data-stu-id="e8765-290">There are a couple of different options for performing hello recovery:</span></span>

1.  <span data-ttu-id="e8765-291">È possibile creare una nuova VM come rappresentazione temporizzata della macchina virtuale sottoposta a backup.</span><span class="sxs-lookup"><span data-stu-id="e8765-291">You can create a new VM as a point-in-time representation of your backed-up VM.</span></span>

2.  <span data-ttu-id="e8765-292">È possibile ripristinare i dischi hello e quindi usare il modello di hello per toocustomize VM hello e ricompilazione hello ripristinato macchina virtuale.</span><span class="sxs-lookup"><span data-stu-id="e8765-292">You can restore hello disks and then use hello template for hello VM toocustomize and rebuild hello restored VM.</span></span> 

<span data-ttu-id="e8765-293">Vedere le istruzioni troppo[macchine virtuali di Azure usare portale toorestore](../backup/backup-azure-arm-restore-vms.md#restoring-a-vm-during-azure-datacenter-disaster).</span><span class="sxs-lookup"><span data-stu-id="e8765-293">See instructions too[Use Azure portal toorestore virtual machines](../backup/backup-azure-arm-restore-vms.md#restoring-a-vm-during-azure-datacenter-disaster).</span></span> <span data-ttu-id="e8765-294">documento di Hello illustra anche passaggi specifici di hello per il ripristino dei backup macchine virtuali toohello abbinata data center mediante l'insieme di credenziali di backup con ridondanza geografica nel caso di hello di emergenza in hello data center principale.</span><span class="sxs-lookup"><span data-stu-id="e8765-294">hello document also explains hello specific steps for restoring backed-up VMs toohello paired data center using your geo-redundant backup vault in hello case of a disaster at hello primary data center.</span></span> <span data-ttu-id="e8765-295">In tal caso, Azure Backup utilizza il servizio di calcolo hello dalla macchina virtuale di hello area secondaria toocreate hello ripristinato.</span><span class="sxs-lookup"><span data-stu-id="e8765-295">In that case, Azure Backup uses hello Compute service from hello secondary region toocreate hello restored virtual machine.</span></span>

<span data-ttu-id="e8765-296">È anche possibile usare PowerShell per il [ripristino di una VM](../backup/backup-azure-vms-automation.md#restore-an-azure-vm) o per la [creazione di una nuova VM dai dischi ripristinati](../backup/backup-azure-vms-automation.md#create-a-vm-from-restored-disks).</span><span class="sxs-lookup"><span data-stu-id="e8765-296">You can also use PowerShell for [restoring a VM](../backup/backup-azure-vms-automation.md#restore-an-azure-vm) or for [creating a new VM from restored disks](../backup/backup-azure-vms-automation.md#create-a-vm-from-restored-disks).</span></span>

## <a name="alternative-solution-consistent-snapshots"></a><span data-ttu-id="e8765-297">Soluzione alternativa: snapshot coerenti</span><span class="sxs-lookup"><span data-stu-id="e8765-297">Alternative Solution: Consistent Snapshots</span></span>

<span data-ttu-id="e8765-298">Se si è grado toouse hello servizio Backup di Azure, è possibile implementare un proprio meccanismo di backup con snapshot.</span><span class="sxs-lookup"><span data-stu-id="e8765-298">If you are unable toouse hello Azure Backup Service, you can implement your own backup mechanism using snapshots.</span></span> <span data-ttu-id="e8765-299">È complicato toocreate snapshot coerenti per tutti i dischi usati da una macchina virtuale e quindi replica tali area tooanother snapshot.</span><span class="sxs-lookup"><span data-stu-id="e8765-299">It is complicated toocreate consistent snapshots for all disks used by a VM and then replicate those snapshots tooanother region.</span></span> <span data-ttu-id="e8765-300">Per questo motivo, Azure considera un'opzione migliore rispetto alla creazione di una soluzione personalizzata hello sfruttando il servizio di Backup.</span><span class="sxs-lookup"><span data-stu-id="e8765-300">For this reason, Azure considers leveraging hello Backup Service a better option than building a custom solution.</span></span> <span data-ttu-id="e8765-301">Se si utilizza l'archiviazione RA-GRS/archiviazione con ridondanza geografica per i dischi, gli snapshot vengono automaticamente replicati tooa data center secondario.</span><span class="sxs-lookup"><span data-stu-id="e8765-301">If you use RA-GRS/GRS storage for disks, snapshots are automatically replicated tooa secondary data center.</span></span> <span data-ttu-id="e8765-302">Se si utilizza l'archiviazione con ridondanza locale per i dischi, è necessario dati hello tooreplicate manualmente.</span><span class="sxs-lookup"><span data-stu-id="e8765-302">If you use LRS storage for disks, you will need tooreplicate hello data yourself.</span></span> <span data-ttu-id="e8765-303">Per altre informazioni, vedere [Eseguire il backup dei dischi di VM non gestiti con snapshot incrementali](storage-incremental-snapshots.md).</span><span class="sxs-lookup"><span data-stu-id="e8765-303">For more information, see [Back up Azure unmanaged VM disks with incremental snapshots](storage-incremental-snapshots.md).</span></span>

<span data-ttu-id="e8765-304">Uno snapshot è una rappresentazione di un oggetto in un punto specifico del tempo.</span><span class="sxs-lookup"><span data-stu-id="e8765-304">A snapshot is a representation of an object at a specific point in time.</span></span> <span data-ttu-id="e8765-305">Uno snapshot genererà fatturazione per hello incrementale dimensioni dati hello contiene.</span><span class="sxs-lookup"><span data-stu-id="e8765-305">A snapshot will incur billing for hello incremental size of hello data it holds.</span></span> <span data-ttu-id="e8765-306">Per altre informazioni, vedere [Creare uno snapshot del BLOB](storage-blob-snapshots.md).</span><span class="sxs-lookup"><span data-stu-id="e8765-306">For more information, see [Create a blob snapshot](storage-blob-snapshots.md).</span></span>

### <a name="creating-snapshots-while-hello-vm-is-running"></a><span data-ttu-id="e8765-307">Creazione di snapshot durante hello macchina virtuale è in esecuzione</span><span class="sxs-lookup"><span data-stu-id="e8765-307">Creating snapshots while hello VM is running</span></span>

<span data-ttu-id="e8765-308">Mentre è possibile creare uno snapshot in qualsiasi momento, se hello macchina virtuale è in esecuzione, è ancora dati da trasmettere in flusso toohello dischi e snapshot hello può contenere parziale operazioni in corso.</span><span class="sxs-lookup"><span data-stu-id="e8765-308">While you can take a snapshot at any time, if hello VM is running, there is still data being streamed toohello disks, and hello snapshots may contain partial operations that were in flight.</span></span> <span data-ttu-id="e8765-309">Inoltre, se sono coinvolti più dischi, snapshot hello di dischi diversi potrebbe essersi verificato in momenti diversi, ovvero che questi snapshot potrebbero non essere coordinati.</span><span class="sxs-lookup"><span data-stu-id="e8765-309">Also, if there are several disks involved, hello snapshots of different disks may have occurred at different times, which means these snapshots may not be coordinated.</span></span> <span data-ttu-id="e8765-310">Ciò risulta particolarmente problematico per i volumi con striping, i cui file possono essere danneggiati in caso di modifiche durante il backup.</span><span class="sxs-lookup"><span data-stu-id="e8765-310">This is especially problematic for striped volumes whose files can be corrupted if changes were being made during backup.</span></span>

<span data-ttu-id="e8765-311">tooavoid questa situazione, il processo di backup hello deve implementare hello alla procedura seguente:</span><span class="sxs-lookup"><span data-stu-id="e8765-311">tooavoid this situation, hello backup process must implement hello following steps:</span></span>

1.  <span data-ttu-id="e8765-312">Blocca tutti i dischi di hello</span><span class="sxs-lookup"><span data-stu-id="e8765-312">Freeze all hello disks</span></span>

2.  <span data-ttu-id="e8765-313">Svuotare tutti hello scrittura in sospeso</span><span class="sxs-lookup"><span data-stu-id="e8765-313">Flush all hello pending writes</span></span>

3.  <span data-ttu-id="e8765-314">Quindi, [creare uno snapshot del blob](storage-blob-snapshots.md) per tutti i dischi di hello</span><span class="sxs-lookup"><span data-stu-id="e8765-314">Then, [create a blob snapshot](storage-blob-snapshots.md) for all hello disks</span></span>

<span data-ttu-id="e8765-315">Alcune applicazioni di Windows come SQL Server forniscono un meccanismo di backup coordinato tramite backup coerenti con l'applicazione di VSS toocreate.</span><span class="sxs-lookup"><span data-stu-id="e8765-315">Some Windows applications like SQL Server provide a coordinated backup mechanism via VSS toocreate application-consistent backups.</span></span> <span data-ttu-id="e8765-316">In Linux, è possibile utilizzare uno strumento come fsfreeze per coordinare i dischi di hello, che forniranno i backup coerenti con i file, ma non applicazione-snapshot coerenti.</span><span class="sxs-lookup"><span data-stu-id="e8765-316">On Linux, you can use a tool like fsfreeze for coordinating hello disks, which will provide file-consistent backups, but not application-consistent snapshots.</span></span> <span data-ttu-id="e8765-317">Questo processo è complicato ed è quindi consigliabile prendere in considerazione l'uso di [Backup di Azure](../backup/backup-azure-vms-introduction.md) o di una soluzione di backup di terze parti che implementa già questa funzionalità.</span><span class="sxs-lookup"><span data-stu-id="e8765-317">This process is complicated, so and you should consider using [Azure Backup](../backup/backup-azure-vms-introduction.md) or a third-party backup solution which already implement this.</span></span>

<span data-ttu-id="e8765-318">Hello sopra processo comporterà una raccolta di snapshot coordinato per tutti i dischi di macchina virtuale di hello, che rappresenta una visualizzazione in un momento specifica di hello macchina virtuale.</span><span class="sxs-lookup"><span data-stu-id="e8765-318">hello above process will result in a collection of coordinated snapshots for all hello VM disks, representing a specific point-in-time view of hello VM.</span></span> <span data-ttu-id="e8765-319">Si tratta di un punto di ripristino del backup per hello macchina virtuale.</span><span class="sxs-lookup"><span data-stu-id="e8765-319">This is a backup restore point for hello VM.</span></span> <span data-ttu-id="e8765-320">È possibile ripetere il processo di hello in backup periodici toocreate di intervalli pianificati.</span><span class="sxs-lookup"><span data-stu-id="e8765-320">You can repeat hello process at scheduled intervals toocreate periodic backups.</span></span> <span data-ttu-id="e8765-321">Per vedere di seguito i passaggi di hello troppo[area tooanother i backup di copia hello](#copy-the-snapshots-to-another-region) per ripristino di emergenza.</span><span class="sxs-lookup"><span data-stu-id="e8765-321">See below for hello steps too[copy hello backups tooanother region](#copy-the-snapshots-to-another-region) for DR.</span></span>

### <a name="creating-snapshots-while-hello-vm-is-offline"></a><span data-ttu-id="e8765-322">Creazione di snapshot durante hello VM è offline</span><span class="sxs-lookup"><span data-stu-id="e8765-322">Creating snapshots while hello VM is offline</span></span>

<span data-ttu-id="e8765-323">Un altro di backup coerenti con l'opzione di toocreate arresto hello VM e blob di acquisire snapshot di ogni disco.</span><span class="sxs-lookup"><span data-stu-id="e8765-323">Another option toocreate consistent backups is shutting down hello VM and taking blob snapshots of each disk.</span></span> <span data-ttu-id="e8765-324">Questa procedura risulta più semplice rispetto alla coordinazione di snapshot di una VM in esecuzione ma richiede qualche minuto di inattività.</span><span class="sxs-lookup"><span data-stu-id="e8765-324">This is easier than coordinating snapshots of a running VM, but it requires a few minutes of downtime.</span></span> <span data-ttu-id="e8765-325">Per questo processo, seguire questa procedura:</span><span class="sxs-lookup"><span data-stu-id="e8765-325">For this process, follow these steps:</span></span>

1. <span data-ttu-id="e8765-326">Arrestare VM hello.</span><span class="sxs-lookup"><span data-stu-id="e8765-326">Shut down hello VM.</span></span>

2. <span data-ttu-id="e8765-327">Creare uno snapshot di ogni BLOB di disco rigido virtuale, operazione che richiede solo pochi secondi.</span><span class="sxs-lookup"><span data-stu-id="e8765-327">Create a snapshot of each VHD blob, which only takes a few seconds.</span></span>

    <span data-ttu-id="e8765-328">toocreate uno snapshot, è possibile utilizzare [PowerShell](storage-powershell-guide-full.md#how-to-manage-azure-blob-snapshots), hello [API Rest di archiviazione Azure](https://msdn.microsoft.com/library/azure/ee691971.aspx), [CLI di Azure](https://docs.microsoft.com/azure/xplat-cli-install), o uno dei hello le librerie Client di archiviazione di Azure, ad esempio [ libreria client di archiviazione Hello per .NET](https://msdn.microsoft.com/library/azure/hh488361.aspx).</span><span class="sxs-lookup"><span data-stu-id="e8765-328">toocreate a snapshot, you can use [PowerShell](storage-powershell-guide-full.md#how-to-manage-azure-blob-snapshots), hello [Azure Storage Rest API](https://msdn.microsoft.com/library/azure/ee691971.aspx), [Azure CLI](https://docs.microsoft.com/azure/xplat-cli-install), or one of hello Azure Storage Client Libraries such as [hello Storage client library for .NET](https://msdn.microsoft.com/library/azure/hh488361.aspx).</span></span>

3. <span data-ttu-id="e8765-329">Avvia macchina virtuale, che termina i tempi di inattività hello hello.</span><span class="sxs-lookup"><span data-stu-id="e8765-329">Start hello VM, which ends hello downtime.</span></span> <span data-ttu-id="e8765-330">In genere l'intero processo hello viene completata entro pochi minuti.</span><span class="sxs-lookup"><span data-stu-id="e8765-330">Typically hello entire process completes within a few minutes.</span></span>

<span data-ttu-id="e8765-331">Questo processo produce una raccolta di snapshot coerenti per tutti i dischi di hello, fornire un punto di ripristino del backup per hello macchina virtuale.</span><span class="sxs-lookup"><span data-stu-id="e8765-331">This process yields a collection of consistent snapshots for all hello disks, providing a backup restore point for hello VM.</span></span> <span data-ttu-id="e8765-332">Vedere di seguito per area di hello passaggi toocopy hello snapshot tooanother per ripristino di emergenza.</span><span class="sxs-lookup"><span data-stu-id="e8765-332">See below for hello steps toocopy hello snapshots tooanother region for DR.</span></span>

### <a name="copy-hello-snapshots-tooanother-region"></a><span data-ttu-id="e8765-333">Copia hello snapshot tooanother area</span><span class="sxs-lookup"><span data-stu-id="e8765-333">Copy hello snapshots tooanother region</span></span>

<span data-ttu-id="e8765-334">Creazione di snapshot hello da sola potrebbe non essere sufficiente per ripristino di emergenza.</span><span class="sxs-lookup"><span data-stu-id="e8765-334">Creation of hello snapshots alone may not be sufficient for DR.</span></span> <span data-ttu-id="e8765-335">È anche necessario replicare area tooanother backup snapshot di hello.</span><span class="sxs-lookup"><span data-stu-id="e8765-335">You must also replicate hello snapshot backups tooanother region.</span></span>

<span data-ttu-id="e8765-336">Se si utilizza GRS o RA-GRS per i dischi, quindi hello gli snapshot sono area secondaria toohello replicati automaticamente.</span><span class="sxs-lookup"><span data-stu-id="e8765-336">If you are using GRS or RA-GRS for your disks, then hello snapshots are replicated toohello secondary region automatically.</span></span> <span data-ttu-id="e8765-337">Possono essere presenti alcuni minuti di ritardo prima che la replica hello e se hello data center principale si arresta prima gli snapshot hello completare la replica, non sarà in grado di tooaccess snapshot hello hello data center secondario.</span><span class="sxs-lookup"><span data-stu-id="e8765-337">There can be a few minutes of lag before hello replication, and if hello primary data center goes down before hello snapshots finish replicating, you will not be able tooaccess hello snapshots from hello secondary data center.</span></span> <span data-ttu-id="e8765-338">probabilità di Hello di questo oggetto è ridotto.</span><span class="sxs-lookup"><span data-stu-id="e8765-338">hello likelihood of this is small.</span></span>

> [!Note] 
> <span data-ttu-id="e8765-339">Solo con i dischi hello in un account GRS o RA-GRS non protegge hello VM in situazioni di emergenza.</span><span class="sxs-lookup"><span data-stu-id="e8765-339">Only having hello disks in a GRS or RA-GRS account does not protect hello VM from disasters.</span></span> <span data-ttu-id="e8765-340">È necessario creare anche snapshot coordinati o usare Backup di Azure.</span><span class="sxs-lookup"><span data-stu-id="e8765-340">You must also create coordinated snapshots or use Azure Backup.</span></span> <span data-ttu-id="e8765-341">Si tratta di toorecover richiesto uno stato coerente di tooa macchina virtuale.</span><span class="sxs-lookup"><span data-stu-id="e8765-341">This is required toorecover a VM tooa consistent state.</span></span>

<span data-ttu-id="e8765-342">Se si utilizza l'archiviazione con ridondanza locale, è necessario copiare account di archiviazione diverso tooa hello snapshot subito dopo la creazione dello snapshot hello.</span><span class="sxs-lookup"><span data-stu-id="e8765-342">If you are using LRS, you must copy hello snapshots tooa different storage account immediately after creating hello snapshot.</span></span> <span data-ttu-id="e8765-343">destinazione della copia Hello potrebbe essere un account di archiviazione con ridondanza locale in un'area diversa, risultante in copia hello in un'area remota.</span><span class="sxs-lookup"><span data-stu-id="e8765-343">hello copy target could be an LRS storage account in a different region, resulting in hello copy being in a remote region.</span></span> <span data-ttu-id="e8765-344">È inoltre possibile copiare account di archiviazione RA-GRS tooan snapshot hello in hello stessa area.</span><span class="sxs-lookup"><span data-stu-id="e8765-344">You can also copy hello snapshot tooan RA-GRS storage account in hello same region.</span></span> <span data-ttu-id="e8765-345">In questo caso, snapshot hello sarà area secondaria remoto toohello replicate in modo differito.</span><span class="sxs-lookup"><span data-stu-id="e8765-345">In this case, hello snapshot will be lazily replicated toohello remote secondary region.</span></span> <span data-ttu-id="e8765-346">Il backup è protetto da situazioni di emergenza nel sito primario di hello dopo hello copia e la replica è stata completata.</span><span class="sxs-lookup"><span data-stu-id="e8765-346">Your backup is protected from disasters at hello primary site once hello copying and replication is complete.</span></span>

<span data-ttu-id="e8765-347">toocopy gli snapshot incrementali per ripristino di emergenza in modo efficiente, rivedere le istruzioni di hello in [eseguire il backup di Azure i dischi di macchina virtuale non gestiti con snapshot incrementali](storage-incremental-snapshots.md).</span><span class="sxs-lookup"><span data-stu-id="e8765-347">toocopy your incremental snapshots for DR efficiently, review hello instructions in [Back up Azure unmanaged VM disks with incremental snapshots](storage-incremental-snapshots.md).</span></span>

![][2]

### <a name="recovery-from-snapshots"></a><span data-ttu-id="e8765-348">Ripristino da snapshot</span><span class="sxs-lookup"><span data-stu-id="e8765-348">Recovery from Snapshots</span></span>

<span data-ttu-id="e8765-349">tooretrieve uno snapshot, copiarlo toomake un nuovo blob.</span><span class="sxs-lookup"><span data-stu-id="e8765-349">tooretrieve a snapshot, copy it toomake a new blob.</span></span> <span data-ttu-id="e8765-350">Se si copia snapshot hello dall'account primario hello, è possibile copiare hello snapshot sul blob di base toohello snapshot hello, pertanto ripristino hello disco toohello snapshot. Questo è noto come snapshot hello innalzamento di livello.</span><span class="sxs-lookup"><span data-stu-id="e8765-350">If you are copying hello snapshot from hello primary account, you can copy hello snapshot over toohello base blob of hello snapshot, thus reverting hello disk toohello snapshot; this is known as promoting hello snapshot.</span></span> <span data-ttu-id="e8765-351">Se si copia di backup di snapshot hello da un account secondario (nel caso di hello di RA-GRS), deve essere copiato tooa account principale.</span><span class="sxs-lookup"><span data-stu-id="e8765-351">If you are copying hello snapshot backup from a secondary account (in hello case of RA-GRS), it must be copied tooa primary account.</span></span> <span data-ttu-id="e8765-352">È possibile copiare uno snapshot [tramite PowerShell](storage-powershell-guide-full.md#how-to-copy-a-snapshot-of-a-blob) o tramite l'utilità AzCopy hello.</span><span class="sxs-lookup"><span data-stu-id="e8765-352">You can copy a snapshot [using PowerShell](storage-powershell-guide-full.md#how-to-copy-a-snapshot-of-a-blob) or using hello AzCopy utility.</span></span> <span data-ttu-id="e8765-353">Per ulteriori informazioni, vedere [trasferire i dati con l'utilità della riga di comando di AzCopy hello](storage-use-azcopy.md).</span><span class="sxs-lookup"><span data-stu-id="e8765-353">For more information, see [Transfer data with hello AzCopy Command-Line Utility](storage-use-azcopy.md).</span></span>

<span data-ttu-id="e8765-354">Nel caso di hello di macchine virtuali con più dischi, è necessario copiare tutto il punto di ripristino di snapshot hello che fanno parte di hello stesso coordinato.</span><span class="sxs-lookup"><span data-stu-id="e8765-354">In hello case of VMs with multiple disks, you must copy all hello snapshots that are part of hello same coordinated restore point.</span></span> <span data-ttu-id="e8765-355">Quando si copiano BLOB VHD toowritable di hello snapshot, è possibile utilizzare la macchina virtuale utilizzando il modello di hello per hello VM toorecreate BLOB hello.</span><span class="sxs-lookup"><span data-stu-id="e8765-355">Once you copy hello snapshots toowritable VHD blobs, you can use hello blobs toorecreate your VM using hello template for hello VM.</span></span>

## <a name="other-options"></a><span data-ttu-id="e8765-356">Altre opzioni</span><span class="sxs-lookup"><span data-stu-id="e8765-356">Other options</span></span>

### <a name="sql-server"></a><span data-ttu-id="e8765-357">SQL Server</span><span class="sxs-lookup"><span data-stu-id="e8765-357">SQL Server</span></span>

<span data-ttu-id="e8765-358">SQL Server in esecuzione in una macchina virtuale ha un proprio toobackup funzionalità incorporate il tooAzure di database di SQL Server archiviazione Blob o una condivisione file.</span><span class="sxs-lookup"><span data-stu-id="e8765-358">SQL Server running in a VM has its own built-in capabilities toobackup your SQL Server database tooAzure Blob storage or a file share.</span></span> <span data-ttu-id="e8765-359">Se l'account di archiviazione hello è GRS o RA-GRS, è possibile accedere in hello account di archiviazione data center secondario in caso di hello un'emergenza, i backup con hello stesse restrizioni, come descritto in precedenza.</span><span class="sxs-lookup"><span data-stu-id="e8765-359">If hello storage account is GRS or RA-GRS, you can access those backups in hello storage account’s secondary data center in hello event of a disaster, with hello same restrictions as discussed previously.</span></span> <span data-ttu-id="e8765-360">Per altre informazioni, vedere [Backup e ripristino per SQL Server in Macchine virtuali di Azure](../virtual-machines/windows/sql/virtual-machines-windows-sql-backup-recovery.md).</span><span class="sxs-lookup"><span data-stu-id="e8765-360">For more information, see [Backup and Restore for SQL Server in Azure Virtual Machines](../virtual-machines/windows/sql/virtual-machines-windows-sql-backup-recovery.md).</span></span> <span data-ttu-id="e8765-361">In aggiunta toobackup e ripristino, [SQL Server di gruppi di disponibilità AlwaysOn](../virtual-machines/windows/sql/virtual-machines-windows-sql-high-availability-dr.md) consente di mantenere le repliche secondarie di database toogreatly ridurre i tempi di ripristino di emergenza hello.</span><span class="sxs-lookup"><span data-stu-id="e8765-361">In addition toobackup and restore, [SQL Server Always On Availability Groups](../virtual-machines/windows/sql/virtual-machines-windows-sql-high-availability-dr.md) can maintain secondary replicas of databases toogreatly reduce hello disaster recovery time.</span></span>

## <a name="other-considerations"></a><span data-ttu-id="e8765-362">Altre considerazioni</span><span class="sxs-lookup"><span data-stu-id="e8765-362">Other considerations</span></span>

<span data-ttu-id="e8765-363">In questo articolo ha descritto come toobackup o acquisire snapshot nelle macchine virtuali e i relativi dischi toosupport il ripristino di emergenza e come toouse tali toorecover.</span><span class="sxs-lookup"><span data-stu-id="e8765-363">This article has discussed how toobackup or take snapshots of your VMs and their disks toosupport disaster recovery, and how toouse those toorecover.</span></span> <span data-ttu-id="e8765-364">Con il modello di gestione risorse di Azure hello, molte persone usano modelli toocreate le proprie macchine virtuali e altre infrastrutture in Azure.</span><span class="sxs-lookup"><span data-stu-id="e8765-364">With hello Azure Resource Manager model, many people use templates toocreate their VMs and other infrastructure in Azure.</span></span> <span data-ttu-id="e8765-365">È possibile utilizzare un toocreate modello una macchina virtuale con hello stessa configurazione ogni volta.</span><span class="sxs-lookup"><span data-stu-id="e8765-365">You can use a template toocreate a VM that has hello same configuration every time.</span></span> <span data-ttu-id="e8765-366">Se si utilizzano immagini personalizzate per la creazione delle macchine virtuali, è necessario anche assicurarsi che le immagini sono protetti tramite un toostore account RA-GRS li.</span><span class="sxs-lookup"><span data-stu-id="e8765-366">If you use custom images for creating your VMs, you must also make sure your images are protected by using an RA-GRS account toostore them.</span></span>

<span data-ttu-id="e8765-367">È quindi possibile che il processo di backup sia una combinazione di due elementi:</span><span class="sxs-lookup"><span data-stu-id="e8765-367">Consequently, your backup process may be a combination of two things:</span></span>

1. <span data-ttu-id="e8765-368">Dati di backup hello (dischi)</span><span class="sxs-lookup"><span data-stu-id="e8765-368">Backup hello data (disks)</span></span>
2. <span data-ttu-id="e8765-369">Configurazione di backup hello (modelli, immagini personalizzate)</span><span class="sxs-lookup"><span data-stu-id="e8765-369">Backup hello configuration (templates, custom images)</span></span>

<span data-ttu-id="e8765-370">A seconda opzione backup hello che scelta, è possibile backup hello toohandle di dati hello e configurazione di hello, o servizio di backup hello può gestire tutto che per l'utente.</span><span class="sxs-lookup"><span data-stu-id="e8765-370">Depending on hello backup option you choose, you may have toohandle hello backup of both hello data and hello configuration, or hello backup service may handle all of that for you.</span></span>

## <a name="appendix---understanding-hello-impact-of-lrs-grs-and-ra-grs"></a><span data-ttu-id="e8765-371">Appendice - impatto hello di archiviazione con ridondanza locale, GRS e RA-GRS</span><span class="sxs-lookup"><span data-stu-id="e8765-371">Appendix - Understanding hello impact of LRS, GRS, and RA-GRS</span></span>

<span data-ttu-id="e8765-372">Per gli account di archiviazione di Azure sono disponibili tre tipi di ridondanza dei dati da tenere in considerazione per il ripristino di emergenza, ovvero archiviazione con ridondanza locale, archiviazione con ridondanza geografica e archiviazione con ridondanza geografica e accesso in lettura.</span><span class="sxs-lookup"><span data-stu-id="e8765-372">For storage accounts in Azure, there are three types of data redundancy that you should consider regarding disaster recovery – locally redundant (LRS), geo-redundant (GRS), or geo-redundant with read access (RA-GRS).</span></span> 

<span data-ttu-id="e8765-373">Localmente archiviazione ridondante (LRS) mantiene tre copie dei dati di hello hello nello stesso data center.</span><span class="sxs-lookup"><span data-stu-id="e8765-373">Locally Redundant Storage (LRS) retains three copies of hello data in hello same data center.</span></span> <span data-ttu-id="e8765-374">Quando si scrivono dati hello, vengono aggiornate tutte le tre copie prima del completamento toohello chiamante, in modo che si sono identici.</span><span class="sxs-lookup"><span data-stu-id="e8765-374">When writing hello data, all three copies are updated before success is returned toohello caller, so you know they are identical.</span></span> <span data-ttu-id="e8765-375">Il disco è protetto da errori locali, poiché è molto improbabile che tutte le tre copie potrebbero essere interessate hello contemporaneamente.</span><span class="sxs-lookup"><span data-stu-id="e8765-375">Your disk is protected from local failures, since it is extremely unlikely that all three copies would be impacted at hello same time.</span></span> <span data-ttu-id="e8765-376">Nel caso di hello di archiviazione con ridondanza locale, non è non ridondanza geografica, disco hello non è protetta da errori irreversibili che possono influire su un'unità di intero data center o di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="e8765-376">In hello case of LRS, there is no geo-redundancy, so hello disk is not protected from catastrophic failures that can impact an entire data center or storage unit.</span></span>

<span data-ttu-id="e8765-377">Con GRS e RA-GRS, vengono mantenute tre copie dei dati nell'area primaria di hello (selezionato dall'utente) e vengono mantenute tre più copie dei dati in un'area secondaria corrispondente (impostata da Azure).</span><span class="sxs-lookup"><span data-stu-id="e8765-377">With GRS and RA-GRS, three copies of your data are retained in hello primary region (selected by you), and three more copies of your data are retained in a corresponding secondary region (set by Azure).</span></span> <span data-ttu-id="e8765-378">Ad esempio, se si archiviano dati negli Stati Uniti occidentali, dati hello sarà tooEast replicati negli Stati Uniti.</span><span class="sxs-lookup"><span data-stu-id="e8765-378">For example, if you store data in West US, hello data will be replicated tooEast US.</span></span> <span data-ttu-id="e8765-379">Questa operazione viene eseguita in modo asincrono e si verifica un ritardo di piccole dimensioni tra gli aggiornamenti toohello primario e secondario.</span><span class="sxs-lookup"><span data-stu-id="e8765-379">This is done asynchronously, and there is a small delay between updates toohello primary and secondary.</span></span> <span data-ttu-id="e8765-380">Le repliche di dischi hello nel sito secondario hello sono coerenti in base al disco (con ritardo hello), ma le repliche di più dischi attivi potrebbero non essere sincronizzate **reciprocamente**.</span><span class="sxs-lookup"><span data-stu-id="e8765-380">Replicas of hello disks on hello secondary site are consistent on a per-disk basis (with hello delay), but replicas of multiple active disks may not be in sync **with each other**.</span></span> <span data-ttu-id="e8765-381">sono necessari toohave repliche coerenti in più dischi, snapshot coerenti.</span><span class="sxs-lookup"><span data-stu-id="e8765-381">toohave consistent replicas across multiple disks, consistent snapshots are needed.</span></span>

<span data-ttu-id="e8765-382">Hello differenza principale tra GRS e RA-GRS è con RA-GRS, è possibile leggere la copia secondaria hello in qualsiasi momento.</span><span class="sxs-lookup"><span data-stu-id="e8765-382">hello main difference between GRS and RA-GRS is that with RA-GRS, you can read hello secondary copy at any time.</span></span> <span data-ttu-id="e8765-383">Se si verifica un problema che esegue il rendering dei dati di hello nell'area primaria hello inaccessibile, hello team di Azure renderà ogni accesso toorestore sforzo.</span><span class="sxs-lookup"><span data-stu-id="e8765-383">If there is a problem that renders hello data in hello primary region inaccessible, hello Azure team will make every effort toorestore access.</span></span> <span data-ttu-id="e8765-384">Se hello primario è inattivo, se si dispone di RA-GRS è abilitata, è possibile accedere a dati hello in hello data center secondario.</span><span class="sxs-lookup"><span data-stu-id="e8765-384">While hello primary is down, if you have RA-GRS enabled, you can access hello data in hello secondary data center.</span></span> <span data-ttu-id="e8765-385">Pertanto, se si prevede di tooread dalla replica hello mentre hello primario non è accessibile, quindi RA-GRS da considerare.</span><span class="sxs-lookup"><span data-stu-id="e8765-385">Therefore, if you plan tooread from hello replica while hello primary is inaccessible, then RA-GRS should be considered.</span></span>

<span data-ttu-id="e8765-386">Se si scopre toobe un'interruzione significativa, hello team di Azure è possibile attivare un failover geografico e modificare hello primario DNS voci toopoint toosecondary archiviazione.</span><span class="sxs-lookup"><span data-stu-id="e8765-386">If it turns out toobe a significant outage, hello Azure team may trigger a geo-failover and change hello primary DNS entries toopoint toosecondary storage.</span></span> <span data-ttu-id="e8765-387">A questo punto, se sono entrambi GRS o RA-GRS è abilitata, è possibile accedere ai dati di hello nell'area di hello utilizzati hello toobe secondario.</span><span class="sxs-lookup"><span data-stu-id="e8765-387">At this point, if you have either GRS or RA-GRS enabled, you can access hello data in hello region that used toobe hello secondary.</span></span> <span data-ttu-id="e8765-388">In altre parole, se l'account di archiviazione è l'archiviazione con ridondanza geografica e si è verificato un problema, è possibile accedere archiviazione secondaria hello solo se è disponibile un failover geografico.</span><span class="sxs-lookup"><span data-stu-id="e8765-388">In other words, if your storage account is GRS and there is a problem, you can access hello secondary storage only if there is a geo-failover.</span></span>

<span data-ttu-id="e8765-389">Per ulteriori informazioni, vedere [quali toodo se si verifica un'interruzione di servizio di archiviazione Azure](storage-disaster-recovery-guidance.md).</span><span class="sxs-lookup"><span data-stu-id="e8765-389">For more information, see [What toodo if an Azure Storage outage occurs](storage-disaster-recovery-guidance.md).</span></span> 

<span data-ttu-id="e8765-390">Si noti che Microsoft controlla il verificarsi di un failover.</span><span class="sxs-lookup"><span data-stu-id="e8765-390">Note that Microsoft controls whether a failover occurs.</span></span> <span data-ttu-id="e8765-391">Il failover non è controllato per i singoli account di archiviazione e non viene quindi determinato dai singoli clienti.</span><span class="sxs-lookup"><span data-stu-id="e8765-391">Failover is not controlled per storage account, therefore it is not decided by individual customers.</span></span> <span data-ttu-id="e8765-392">tooimplement il ripristino di emergenza per gli account di archiviazione specifico o i dischi di macchina virtuale, è necessario utilizzare le tecniche di hello descritte in precedenza in questo articolo.</span><span class="sxs-lookup"><span data-stu-id="e8765-392">tooimplement Disaster Recovery for specific storage accounts or virtual machine disks, you must use hello techniques described previously in this article.</span></span>



[1]: ./media/storage-backup-and-disaster-recovery-for-azure-iaas-disks/backup-and-disaster-recovery-for-azure-iaas-disks-1.png
[2]: ./media/storage-backup-and-disaster-recovery-for-azure-iaas-disks/backup-and-disaster-recovery-for-azure-iaas-disks-2.png