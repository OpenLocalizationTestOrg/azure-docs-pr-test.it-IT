---
title: aaaOverview di hello del ciclo di vita di servizi di Azure Service Fabric affidabile | Documenti Microsoft
description: Informazioni sugli eventi del ciclo di vita diversi hello in servizi di Service Fabric affidabili
services: Service-Fabric
documentationcenter: java
author: PavanKunapareddyMSFT
manager: timlt
ms.assetid: 
ms.service: Service-Fabric
ms.devlang: java
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 06/30/2017
ms.author: pakunapa;
ms.openlocfilehash: 6d48c217d12bc5248c2da57b544aac747cecd872
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/06/2017
---
# <a name="reliable-services-lifecycle-overview"></a><span data-ttu-id="0f628-103">Panoramica del ciclo di vita di Reliable Services</span><span class="sxs-lookup"><span data-stu-id="0f628-103">Reliable services lifecycle overview</span></span>
> [!div class="op_single_selector"]
> * [<span data-ttu-id="0f628-104">C# su Windows</span><span class="sxs-lookup"><span data-stu-id="0f628-104">C# on Windows</span></span>](service-fabric-reliable-services-lifecycle.md)
> * [<span data-ttu-id="0f628-105">Java su Linux</span><span class="sxs-lookup"><span data-stu-id="0f628-105">Java on Linux</span></span>](service-fabric-reliable-services-lifecycle-java.md)
>
>

<span data-ttu-id="0f628-106">Quando si pensa hello cicli di vita di servizi affidabili, funzionalità di base di hello del ciclo di vita hello sono hello più importante.</span><span class="sxs-lookup"><span data-stu-id="0f628-106">When thinking about hello lifecycles of Reliable Services, hello basics of hello lifecycle are hello most important.</span></span> <span data-ttu-id="0f628-107">In generale:</span><span class="sxs-lookup"><span data-stu-id="0f628-107">In general:</span></span>

* <span data-ttu-id="0f628-108">Durante l'avvio</span><span class="sxs-lookup"><span data-stu-id="0f628-108">During Startup</span></span>
  * <span data-ttu-id="0f628-109">I servizi vengono costruiti</span><span class="sxs-lookup"><span data-stu-id="0f628-109">Services are constructed</span></span>
  * <span data-ttu-id="0f628-110">Hanno un tooconstruct opportunità e restituire zero o più listener</span><span class="sxs-lookup"><span data-stu-id="0f628-110">They have an opportunity tooconstruct and return zero or more listeners</span></span>
  * <span data-ttu-id="0f628-111">Qualsiasi listener restituito sono aperte, consentendo la comunicazione con il servizio hello</span><span class="sxs-lookup"><span data-stu-id="0f628-111">Any returned listeners are opened, allowing communication with hello service</span></span>
  * <span data-ttu-id="0f628-112">viene chiamato il metodo di runAsync Hello del servizio, consentendo di hello servizio toodo a esecuzione prolungata o di lavoro in background</span><span class="sxs-lookup"><span data-stu-id="0f628-112">hello Service's runAsync method is called, allowing hello service toodo long running or background work</span></span>
* <span data-ttu-id="0f628-113">Durante l'arresto</span><span class="sxs-lookup"><span data-stu-id="0f628-113">During shutdown</span></span>
  * <span data-ttu-id="0f628-114">toorunAsync passato di Hello annullamento token viene annullato e vengono chiuse listener hello</span><span class="sxs-lookup"><span data-stu-id="0f628-114">hello cancellation token passed toorunAsync is canceled, and hello listeners are closed</span></span>
  * <span data-ttu-id="0f628-115">Una volta completato, hello servizio oggetto eliminato</span><span class="sxs-lookup"><span data-stu-id="0f628-115">Once that is complete, hello service object itself is destructed</span></span>

<span data-ttu-id="0f628-116">Sono disponibili informazioni dettagliate sugli hello esatto di ordinamento di questi eventi.</span><span class="sxs-lookup"><span data-stu-id="0f628-116">There are details around hello exact ordering of these events.</span></span> <span data-ttu-id="0f628-117">In particolare, ordine hello degli eventi può cambiare leggermente a seconda che sia di hello servizio affidabile Stateless o informazioni sullo stato.</span><span class="sxs-lookup"><span data-stu-id="0f628-117">In particular, hello order of events may change slightly depending on whether hello Reliable Service is Stateless or Stateful.</span></span> <span data-ttu-id="0f628-118">Inoltre, per i servizi con stati, abbiamo toodeal con uno scenario di scambio primario hello.</span><span class="sxs-lookup"><span data-stu-id="0f628-118">In addition, for stateful services, we have toodeal with hello Primary swap scenario.</span></span> <span data-ttu-id="0f628-119">Durante questa sequenza, ruolo hello database primario replica tooanother trasferiti (o torna) senza l'arresto del servizio hello.</span><span class="sxs-lookup"><span data-stu-id="0f628-119">During this sequence, hello role of Primary is transferred tooanother replica (or comes back) without hello service shutting down.</span></span> <span data-ttu-id="0f628-120">Infine, abbiamo toothink sulle condizioni di errore o di.</span><span class="sxs-lookup"><span data-stu-id="0f628-120">Finally, we have toothink about error or failure conditions.</span></span>

## <a name="stateless-service-startup"></a><span data-ttu-id="0f628-121">Avvio di un servizio senza stato</span><span class="sxs-lookup"><span data-stu-id="0f628-121">Stateless service startup</span></span>
<span data-ttu-id="0f628-122">Hello ciclo di vita di un servizio senza stato è piuttosto semplice.</span><span class="sxs-lookup"><span data-stu-id="0f628-122">hello lifecycle of a stateless service is fairly straightforward.</span></span> <span data-ttu-id="0f628-123">Ecco l'ordine di hello degli eventi:</span><span class="sxs-lookup"><span data-stu-id="0f628-123">Here's hello order of events:</span></span>

1. <span data-ttu-id="0f628-124">Hello servizio viene costruito</span><span class="sxs-lookup"><span data-stu-id="0f628-124">hello Service is constructed</span></span>
2. <span data-ttu-id="0f628-125">Quindi si verificano due cose in parallelo:</span><span class="sxs-lookup"><span data-stu-id="0f628-125">Then, in parallel two things happen:</span></span>
    - <span data-ttu-id="0f628-126">Viene chiamato `StatelessService.createServiceInstanceListeners()` e viene aperto qualsiasi listener restituito (viene chiamato `CommunicationListener.openAsync()` su ogni listener)</span><span class="sxs-lookup"><span data-stu-id="0f628-126">`StatelessService.createServiceInstanceListeners()` is invoked and any returned listeners are Opened (`CommunicationListener.openAsync()` is called on each listener)</span></span>
    - <span data-ttu-id="0f628-127">metodo runAsync del servizio di Hello (`StatelessService.runAsync()`) viene chiamato</span><span class="sxs-lookup"><span data-stu-id="0f628-127">hello service's runAsync method (`StatelessService.runAsync()`) is called</span></span>
3. <span data-ttu-id="0f628-128">Se presente, viene chiamato metodo onOpenAsync di hello del servizio (in particolare, `StatelessService.onOpenAsync()` viene chiamato.</span><span class="sxs-lookup"><span data-stu-id="0f628-128">If present, hello service's own onOpenAsync method is called (Specifically, `StatelessService.onOpenAsync()` is called.</span></span> <span data-ttu-id="0f628-129">si tratta di un override insolito ma comunque disponibile).</span><span class="sxs-lookup"><span data-stu-id="0f628-129">This is an uncommon override but it is available).</span></span>

<span data-ttu-id="0f628-130">È importante toonote che non vi sia alcun ordinamento tra toocreate chiamate hello e i listener hello aperto e runAsync.</span><span class="sxs-lookup"><span data-stu-id="0f628-130">It is important toonote that there is no ordering between hello calls toocreate and open hello listeners and runAsync.</span></span> <span data-ttu-id="0f628-131">listener Hello venga aperto prima dell'avvio di runAsync.</span><span class="sxs-lookup"><span data-stu-id="0f628-131">hello listeners may open before runAsync is started.</span></span> <span data-ttu-id="0f628-132">Analogamente, runAsync rischia di richiamato prima che il listener di comunicazione hello è aperto o anche costruito.</span><span class="sxs-lookup"><span data-stu-id="0f628-132">Similarly, runAsync may end up invoked before hello communication listeners are open or have even been constructed.</span></span> <span data-ttu-id="0f628-133">Se è necessario eseguire qualsiasi sincronizzazione, viene lasciato in qualità di implementatore toohello esercizio.</span><span class="sxs-lookup"><span data-stu-id="0f628-133">If any synchronization is required, it is left as an exercise toohello implementer.</span></span> <span data-ttu-id="0f628-134">Soluzioni comuni:</span><span class="sxs-lookup"><span data-stu-id="0f628-134">Common solutions:</span></span>

* <span data-ttu-id="0f628-135">Talvolta i listener non possono funzionare fino a quando non vengono create altre informazioni o eseguite determinate operazioni.</span><span class="sxs-lookup"><span data-stu-id="0f628-135">Sometimes listeners can't function until some other information is created or work done.</span></span> <span data-ttu-id="0f628-136">Per i servizi senza stati che possono in genere eseguire le operazioni nel costruttore del servizio hello durante hello `createServiceInstanceListeners()` chiamare, o come parte della costruzione di hello del listener hello stesso.</span><span class="sxs-lookup"><span data-stu-id="0f628-136">For stateless services that work can usually be done in hello service's constructor, during hello `createServiceInstanceListeners()` call, or as a part of hello construction of hello listener itself.</span></span>
* <span data-ttu-id="0f628-137">Hello codice runAsync non talvolta toostart fino a quando non sono aperti listener hello.</span><span class="sxs-lookup"><span data-stu-id="0f628-137">Sometimes hello code in runAsync does not want toostart until hello listeners are open.</span></span> <span data-ttu-id="0f628-138">In questo caso è necessario un po' di coordinamento in più.</span><span class="sxs-lookup"><span data-stu-id="0f628-138">In this case additional coordination is necessary.</span></span> <span data-ttu-id="0f628-139">Una soluzione comune è alcuni flag all'interno di listener hello che indica quando vengono completati, cui è archiviato runAsync prima di continuare a utilizzare tooactual.</span><span class="sxs-lookup"><span data-stu-id="0f628-139">One common solution is some flag within hello listeners indicating when they have completed, which is checked in runAsync before continuing tooactual work.</span></span>

## <a name="stateless-service-shutdown"></a><span data-ttu-id="0f628-140">Arresto di un servizio senza stato</span><span class="sxs-lookup"><span data-stu-id="0f628-140">Stateless service shutdown</span></span>
<span data-ttu-id="0f628-141">Quando un servizio senza stato di arresto, hello stesso modello viene seguito, solo in senso inverso:</span><span class="sxs-lookup"><span data-stu-id="0f628-141">When shutting down a stateless service, hello same pattern is followed, just in reverse:</span></span>

1. <span data-ttu-id="0f628-142">In parallelo</span><span class="sxs-lookup"><span data-stu-id="0f628-142">In parallel</span></span>
    - <span data-ttu-id="0f628-143">Tutti i listener aperti vengono chiusi (viene chiamato `CommunicationListener.closeAsync()` su ogni listener)</span><span class="sxs-lookup"><span data-stu-id="0f628-143">Any open listeners are Closed (`CommunicationListener.closeAsync()` is called on each listener)</span></span>
    - <span data-ttu-id="0f628-144">token di annullamento Hello passato troppo`runAsync()` viene annullata (controllo del token di annullamento hello `isCancelled` proprietà restituisce true e se la chiamata del token hello `throwIfCancellationRequested` metodo genera un `CancellationException`)</span><span class="sxs-lookup"><span data-stu-id="0f628-144">hello cancellation token passed too`runAsync()` is canceled (checking hello cancellation token's `isCancelled` property returns true, and if called hello token's `throwIfCancellationRequested` method throws a `CancellationException`)</span></span>
2. <span data-ttu-id="0f628-145">Una volta `closeAsync()` completa per ogni listener e `runAsync()` completa inoltre del servizio hello `StatelessService.onCloseAsync()` metodo viene chiamato, se presente (nuovo si tratta di una sostituzione non comune).</span><span class="sxs-lookup"><span data-stu-id="0f628-145">Once `closeAsync()` completes on each listener and `runAsync()` also completes, hello service's `StatelessService.onCloseAsync()` method is called, if present (again this is an uncommon override).</span></span>
3. <span data-ttu-id="0f628-146">Dopo aver `StatelessService.onCloseAsync()` viene completato, viene eliminato l'oggetto servizio hello</span><span class="sxs-lookup"><span data-stu-id="0f628-146">After `StatelessService.onCloseAsync()` completes, hello service object is destructed</span></span>

## <a name="notes-on-service-lifecycle"></a><span data-ttu-id="0f628-147">Note sul ciclo di vita del servizio</span><span class="sxs-lookup"><span data-stu-id="0f628-147">Notes on service lifecycle</span></span>
* <span data-ttu-id="0f628-148">Entrambi hello `runAsync()` metodo e hello `createServiceInstanceListeners` chiamate sono facoltative.</span><span class="sxs-lookup"><span data-stu-id="0f628-148">Both hello `runAsync()` method and hello `createServiceInstanceListeners` calls are optional.</span></span> <span data-ttu-id="0f628-149">Un servizio può averne una, entrambe o nessuna.</span><span class="sxs-lookup"><span data-stu-id="0f628-149">A service may have one of them, both, or neither.</span></span> <span data-ttu-id="0f628-150">Ad esempio, se il servizio di hello non tutto il relativo lavoro risposta toouser chiamate, non è necessario per tale tooimplement `runAsync()`.</span><span class="sxs-lookup"><span data-stu-id="0f628-150">For example, if hello service does all its work in response toouser calls, there is no need for it tooimplement `runAsync()`.</span></span> <span data-ttu-id="0f628-151">Sono necessari solo i listener di comunicazione hello e il codice associato.</span><span class="sxs-lookup"><span data-stu-id="0f628-151">Only hello communication listeners and their associated code are necessary.</span></span> <span data-ttu-id="0f628-152">Analogamente, la creazione e la restituzione di listener di comunicazione è facoltativo, come servizio di hello potrebbe avere solo sfondo toodo di lavoro e deve pertanto solo tooimplement`runAsync()`</span><span class="sxs-lookup"><span data-stu-id="0f628-152">Similarly, creating and returning communication listeners is optional, as hello service may have only background work toodo, and so only needs tooimplement `runAsync()`</span></span>
* <span data-ttu-id="0f628-153">È valido per un servizio toocomplete `runAsync()` correttamente e restituito da esso.</span><span class="sxs-lookup"><span data-stu-id="0f628-153">It is valid for a service toocomplete `runAsync()` successfully and return from it.</span></span> <span data-ttu-id="0f628-154">Questo non è considerato una condizione di errore e rappresenta operazioni in background hello di hello servizio completato.</span><span class="sxs-lookup"><span data-stu-id="0f628-154">This is not considered a failure condition and would represent hello background work of hello service completing.</span></span> <span data-ttu-id="0f628-155">Per i servizi reliable con stati `runAsync()` deve essere chiamato nuovamente se servizio hello sono stati abbassato di livello dal database primario e quindi promossa tooprimary indietro.</span><span class="sxs-lookup"><span data-stu-id="0f628-155">For stateful reliable services `runAsync()` would be called again if hello service were demoted from primary and then promoted back tooprimary.</span></span>
* <span data-ttu-id="0f628-156">Se un servizio viene terminato da `runAsync()` generando alcune eccezione imprevista, si tratta di un errore e l'oggetto servizio hello è stato arrestato e segnalato un errore di integrità.</span><span class="sxs-lookup"><span data-stu-id="0f628-156">If a service exits from `runAsync()` by throwing some unexpected exception, this is a failure and hello service object is shut down and a health error reported.</span></span>
* <span data-ttu-id="0f628-157">Sebbene non esista alcun limite di tempo restituito da questi metodi, immediatamente perdere toowrite possibilità hello e pertanto non è possibile completare qualsiasi lavoro effettivo.</span><span class="sxs-lookup"><span data-stu-id="0f628-157">While there is no time limit on returning from these methods, you immediately lose hello ability toowrite and therefore cannot complete any real work.</span></span> <span data-ttu-id="0f628-158">È consigliabile che venga restituito al più presto dopo aver ricevuto la richiesta di annullamento hello.</span><span class="sxs-lookup"><span data-stu-id="0f628-158">It is recommended that you return as quickly as possible upon receiving hello cancellation request.</span></span> <span data-ttu-id="0f628-159">Se il servizio non risponde toothese API chiamate in una quantità ragionevole di tempo che Service Fabric potrebbe forzare la terminazione del servizio.</span><span class="sxs-lookup"><span data-stu-id="0f628-159">If your service does not respond toothese API calls in a reasonable amount of time Service Fabric may forcibly terminate your service.</span></span> <span data-ttu-id="0f628-160">In genere ciò accade solo durante gli aggiornamenti delle applicazioni o quando viene eliminato un servizio.</span><span class="sxs-lookup"><span data-stu-id="0f628-160">Usually this only happens during application upgrades or when a service is being deleted.</span></span> <span data-ttu-id="0f628-161">Questo timeout è di 15 minuti per impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="0f628-161">This timeout is 15 minutes by default.</span></span>
* <span data-ttu-id="0f628-162">Errori di hello `onCloseAsync()` comporterà percorso `onAbort()` la chiamata che è un'opportunità di sforzo ultima possibilità per hello service tooclean backup e rilasciare le risorse che sono richiesti.</span><span class="sxs-lookup"><span data-stu-id="0f628-162">Failures in hello `onCloseAsync()` path result in `onAbort()` being called which is a last-chance best-effort opportunity for hello service tooclean up and release any resources that they have claimed.</span></span>

> [!NOTE]
> <span data-ttu-id="0f628-163">Reliable Services con stato non è ancora supportato in Java.</span><span class="sxs-lookup"><span data-stu-id="0f628-163">Stateful reliable services are not supported in java yet.</span></span>
>
>

## <a name="next-steps"></a><span data-ttu-id="0f628-164">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="0f628-164">Next steps</span></span>
* [<span data-ttu-id="0f628-165">Introduzione tooReliable servizi</span><span class="sxs-lookup"><span data-stu-id="0f628-165">Introduction tooReliable Services</span></span>](service-fabric-reliable-services-introduction.md)
* [<span data-ttu-id="0f628-166">Guida introduttiva a Reliable Services di Microsoft Azure Service Fabric</span><span class="sxs-lookup"><span data-stu-id="0f628-166">Reliable Services quick start</span></span>](service-fabric-reliable-services-quick-start.md)
* [<span data-ttu-id="0f628-167">Uso avanzato del modello di programmazione Reliable Services</span><span class="sxs-lookup"><span data-stu-id="0f628-167">Reliable Services advanced usage</span></span>](service-fabric-reliable-services-advanced-usage.md)
