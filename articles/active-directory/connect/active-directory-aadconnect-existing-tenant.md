---
title: "Azure AD Connect: Quando è già presente Azure AD | Documentazione Microsoft"
description: "Questo argomento illustra come usare Connect quando è presente un tenant Azure AD."
services: active-directory
documentationcenter: 
author: andkjell
manager: femila
editor: 
ms.assetid: 
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/13/2017
ms.author: billmath
ms.openlocfilehash: 908c576b0427a23934c844362a4fd69443800d0f
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/03/2017
---
# <a name="azure-ad-connect-when-you-have-an-existent-tenant"></a><span data-ttu-id="2cd4f-103">Azure AD Connect con un tenant esistente</span><span class="sxs-lookup"><span data-stu-id="2cd4f-103">Azure AD Connect: When you have an existent tenant</span></span>
<span data-ttu-id="2cd4f-104">La maggior parte degli argomenti che illustrano come usare Azure AD Connect presuppongono che si inizi con un nuovo tenant di Azure AD che non contiene utenti o altri oggetti.</span><span class="sxs-lookup"><span data-stu-id="2cd4f-104">Most of the topics for how to use Azure AD Connect assumes you start with a new Azure AD tenant and that there are no users or other objects there.</span></span> <span data-ttu-id="2cd4f-105">Questo argomento è utile se tuttavia si inizia con un tenant di Azure AD che contiene utenti e altri oggetti e si vuole usare Connect.</span><span class="sxs-lookup"><span data-stu-id="2cd4f-105">But if you have started with an Azure AD tenant, populated it with users and other objects, and now want to use Connect, then this topic is for you.</span></span>

## <a name="the-basics"></a><span data-ttu-id="2cd4f-106">Nozioni di base</span><span class="sxs-lookup"><span data-stu-id="2cd4f-106">The basics</span></span>
<span data-ttu-id="2cd4f-107">Un oggetto in Azure AD viene gestito nel cloud (Azure AD) o in locale.</span><span class="sxs-lookup"><span data-stu-id="2cd4f-107">An object in Azure AD is either mastered in the cloud (Azure AD) or on-premises.</span></span> <span data-ttu-id="2cd4f-108">Per un singolo oggetto non è possibile gestire alcuni attributi in locale e altri attributi in Azure AD.</span><span class="sxs-lookup"><span data-stu-id="2cd4f-108">For one single object, you cannot manage some attributes on-premises and some other attributes in Azure AD.</span></span> <span data-ttu-id="2cd4f-109">Ogni oggetto ha un flag che indica dove viene gestito l'oggetto.</span><span class="sxs-lookup"><span data-stu-id="2cd4f-109">Each object has a flag indicating where the object is managed.</span></span>

<span data-ttu-id="2cd4f-110">È possibile gestire alcuni utenti in locale e altri nel cloud.</span><span class="sxs-lookup"><span data-stu-id="2cd4f-110">You can manage some users on-premises and other in the cloud.</span></span> <span data-ttu-id="2cd4f-111">Uno scenario comune per questa configurazione è un'azienda con una combinazione di contabili e addetti alla vendita.</span><span class="sxs-lookup"><span data-stu-id="2cd4f-111">A common scenario for this configuration is an organization with a mix of accounting workers and sales workers.</span></span> <span data-ttu-id="2cd4f-112">I contabili hanno un account AD locale, a differenza degli addetti alla vendita che hanno un account in Azure AD.</span><span class="sxs-lookup"><span data-stu-id="2cd4f-112">The accounting workers have an on-premises AD account, but the sales workers do not, they have an account in Azure AD.</span></span> <span data-ttu-id="2cd4f-113">Alcuni utenti verranno gestiti in locale, alcuni in Azure AD.</span><span class="sxs-lookup"><span data-stu-id="2cd4f-113">You would manage some users on-premises and some in Azure AD.</span></span>

<span data-ttu-id="2cd4f-114">Se si iniziano a gestire in Azure AD utenti che si trovano anche nell'istanza di AD locale e successivamente si vuole usare Connect, è necessario prendere in considerazione altri aspetti.</span><span class="sxs-lookup"><span data-stu-id="2cd4f-114">If you started to manage users in Azure AD that are also in on-premises AD and later want to use Connect, then there are some additional concerns you need to consider.</span></span>

## <a name="sync-with-existing-users-in-azure-ad"></a><span data-ttu-id="2cd4f-115">Eseguire la sincronizzazione con gli utenti esistenti in Azure AD</span><span class="sxs-lookup"><span data-stu-id="2cd4f-115">Sync with existing users in Azure AD</span></span>
<span data-ttu-id="2cd4f-116">Quando si installa Azure AD Connect e si avvia la sincronizzazione, il servizio di sincronizzazione di Azure AD (in Azure AD) esegue un controllo per ogni nuovo oggetto e prova a trovare un oggetto esistente da associare.</span><span class="sxs-lookup"><span data-stu-id="2cd4f-116">When you install Azure AD Connect and you start synchronizing, the Azure AD sync service (in Azure AD) does a check on every new object and try to find an existing object to match.</span></span> <span data-ttu-id="2cd4f-117">Vengono usati tre attributi per questo processo: **userPrincipalName**, **proxyAddresses** e **sourceAnchor**/**immutableID**.</span><span class="sxs-lookup"><span data-stu-id="2cd4f-117">There are three attributes used for this process: **userPrincipalName**, **proxyAddresses**, and **sourceAnchor**/**immutableID**.</span></span> <span data-ttu-id="2cd4f-118">Una corrispondenza per **userPrincipalName** e **proxyAddresses** è nota come **corrispondenza flessibile**.</span><span class="sxs-lookup"><span data-stu-id="2cd4f-118">A match on **userPrincipalName** and **proxyAddresses** is known as a **soft match**.</span></span> <span data-ttu-id="2cd4f-119">Una corrispondenza per **sourceAnchor** è nota come **corrispondenza rigida**.</span><span class="sxs-lookup"><span data-stu-id="2cd4f-119">A match on **sourceAnchor** is known as **hard match**.</span></span> <span data-ttu-id="2cd4f-120">Per l'attributo **proxyAddresses** solo il valore con attributo **SMTP:**, ovvero l'indirizzo di posta elettronica principale, viene usato per la valutazione.</span><span class="sxs-lookup"><span data-stu-id="2cd4f-120">For the **proxyAddresses** attribute only the value with **SMTP:**, that is the primary email address, is used for the evaluation.</span></span>

<span data-ttu-id="2cd4f-121">La corrispondenza viene valutata solo per i nuovi oggetti provenienti da Connect.</span><span class="sxs-lookup"><span data-stu-id="2cd4f-121">The match is only evaluated for new objects coming from Connect.</span></span> <span data-ttu-id="2cd4f-122">Se si modifica un oggetto esistente in modo che corrisponda a uno di questi attributi, verrà visualizzato un errore.</span><span class="sxs-lookup"><span data-stu-id="2cd4f-122">If you change an exiting object so it is matching any of these attributes, then you see an error instead.</span></span>

<span data-ttu-id="2cd4f-123">Se Azure AD rileva un oggetto in cui i valori di attributo sono gli stessi per un oggetto proveniente da Connect che è già presente in Azure AD, l'oggetto in Azure AD verrà acquisito da Connect.</span><span class="sxs-lookup"><span data-stu-id="2cd4f-123">If Azure AD finds an object where the attribute values are the same for an object coming from Connect and that it is already present in Azure AD, then the object in Azure AD is taken over by Connect.</span></span> <span data-ttu-id="2cd4f-124">L'oggetto precedentemente gestito nel cloud viene contrassegnato come gestito in locale.</span><span class="sxs-lookup"><span data-stu-id="2cd4f-124">The previously cloud-managed object is flagged as on-premises managed.</span></span> <span data-ttu-id="2cd4f-125">Tutti gli attributi in Azure AD con un valore in AD locale vengono sovrascritti con il valore locale.</span><span class="sxs-lookup"><span data-stu-id="2cd4f-125">All attributes in Azure AD with a value in on-premises AD are overwritten with the on-premises value.</span></span> <span data-ttu-id="2cd4f-126">L'eccezione si ha quando un attributo ha un valore **NULL** in locale.</span><span class="sxs-lookup"><span data-stu-id="2cd4f-126">The exception is when an attribute has a **NULL** value on-premises.</span></span> <span data-ttu-id="2cd4f-127">In questo caso, il valore in Azure AD viene conservato, ma può essere modificato solo in locale.</span><span class="sxs-lookup"><span data-stu-id="2cd4f-127">In this case, the value in Azure AD remains, but you can still only change it on-premises to something else.</span></span>

> [!WARNING]
> <span data-ttu-id="2cd4f-128">Poiché tutti gli attributi in Azure AD verranno sovrascritti con il valore locale, accertarsi che i dati locali siano corretti.</span><span class="sxs-lookup"><span data-stu-id="2cd4f-128">Since all attributes in Azure AD are going to be overwritten by the on-premises value, make sure you have good data on-premises.</span></span> <span data-ttu-id="2cd4f-129">Se ad esempio un indirizzo e-mail è stato gestito solo in Office 365, ma non è stato aggiornato nell'istanza di Active Directory Domain Services locale, i valori di Azure AD/Office 365 non presenti in Active Directory Domain Services andranno persi.</span><span class="sxs-lookup"><span data-stu-id="2cd4f-129">For example, if you only have managed email address in Office 365 and not kept it updated in on-premises AD DS, then you lose any values in Azure AD/Office 365 not present in AD DS.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="2cd4f-130">Se si usa la sincronizzazione delle password, opzione sempre usata dalle impostazioni rapide, la password in Azure AD verrà sovrascritta con la password dell'istanza di AD locale.</span><span class="sxs-lookup"><span data-stu-id="2cd4f-130">If you use password sync, which is always used by express settings, then the password in Azure AD is overwritten with the password in on-premises AD.</span></span> <span data-ttu-id="2cd4f-131">Se gli utenti sono abituati a gestire più password, è necessario informarli che dovranno usare la password locale dopo aver installato Connect.</span><span class="sxs-lookup"><span data-stu-id="2cd4f-131">If your users are used to manage different passwords, then you need to inform them that they should use the on-premises password when you have installed Connect.</span></span>

<span data-ttu-id="2cd4f-132">È necessario prendere in considerazione le indicazioni della sezione precedente nella pianificazione.</span><span class="sxs-lookup"><span data-stu-id="2cd4f-132">The previous section and warning must be considered in your planning.</span></span> <span data-ttu-id="2cd4f-133">Se in Azure AD sono state apportate molte modifiche che non sono state applicate nell'istanza di Active Directory Domain Services locale, è necessario pianificare come popolare Active Directory Domain Services con i valori aggiornati prima di sincronizzare gli oggetti con Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="2cd4f-133">If you have made many changes in Azure AD not reflected in on-premises AD DS, then you need to plan for how to populate AD DS with the updated values before you sync your objects with Azure AD Connect.</span></span>

<span data-ttu-id="2cd4f-134">Se gli oggetti sono stati associati con una corrispondenza flessibile, verrà aggiunto **sourceAnchor** all'oggetto in Azure AD e sarà quindi possibile usare una corrispondenza rigida in seguito.</span><span class="sxs-lookup"><span data-stu-id="2cd4f-134">If you matched your objects with a soft-match, then the **sourceAnchor** is added to the object in Azure AD so a hard match can be used later.</span></span>

### <a name="hard-match-vs-soft-match"></a><span data-ttu-id="2cd4f-135">Differenza tra corrispondenza rigida e corrispondenza flessibile</span><span class="sxs-lookup"><span data-stu-id="2cd4f-135">Hard-match vs Soft-match</span></span>
<span data-ttu-id="2cd4f-136">Per una nuova installazione di Connect, non esiste alcuna differenza pratica tra corrispondenza flessibile e corrispondenza rigida.</span><span class="sxs-lookup"><span data-stu-id="2cd4f-136">For a new installation of Connect, there is no practical difference between a soft- and a hard-match.</span></span> <span data-ttu-id="2cd4f-137">La differenza emerge in una situazione di ripristino di emergenza.</span><span class="sxs-lookup"><span data-stu-id="2cd4f-137">The difference is in a disaster recovery situation.</span></span> <span data-ttu-id="2cd4f-138">Se si è perso il server con Azure AD Connect, è possibile reinstallare una nuova istanza senza perdere i dati.</span><span class="sxs-lookup"><span data-stu-id="2cd4f-138">If you have lost your server with Azure AD Connect, you can reinstall a new instance without losing any data.</span></span> <span data-ttu-id="2cd4f-139">Un oggetto con un attributo sourceAnchor viene inviato a Connect durante l'installazione iniziale.</span><span class="sxs-lookup"><span data-stu-id="2cd4f-139">An object with a sourceAnchor is sent to Connect during initial install.</span></span> <span data-ttu-id="2cd4f-140">La corrispondenza può quindi essere valutata dal client (Azure AD Connect), che per l'operazione impiega molto meno tempo rispetto ad Azure AD.</span><span class="sxs-lookup"><span data-stu-id="2cd4f-140">The match can then be evaluated by the client (Azure AD Connect), which is a lot faster than doing the same in Azure AD.</span></span> <span data-ttu-id="2cd4f-141">Una corrispondenza rigida viene valutata sia da Connect che da Azure AD.</span><span class="sxs-lookup"><span data-stu-id="2cd4f-141">A hard match is evaluated both by Connect and by Azure AD.</span></span> <span data-ttu-id="2cd4f-142">Una corrispondenza flessibile viene valutata solo da Azure AD.</span><span class="sxs-lookup"><span data-stu-id="2cd4f-142">A soft match is only evaluated by Azure AD.</span></span>

### <a name="other-objects-than-users"></a><span data-ttu-id="2cd4f-143">Oggetti diversi dagli utenti</span><span class="sxs-lookup"><span data-stu-id="2cd4f-143">Other objects than users</span></span>
<span data-ttu-id="2cd4f-144">Gli utenti hanno in genere sia l'attributo userPrincipalName che l'attributo proxyAddresses, semplificando così la corrispondenza.</span><span class="sxs-lookup"><span data-stu-id="2cd4f-144">Users usually have both userPrincipalName and proxyAddresses, making the match easy.</span></span> <span data-ttu-id="2cd4f-145">Altri oggetti, ad esempio i gruppi di sicurezza, non hanno tuttavia questi attributi.</span><span class="sxs-lookup"><span data-stu-id="2cd4f-145">But other objects, such as security groups, do not have those.</span></span> <span data-ttu-id="2cd4f-146">In questo caso l'associazione è possibile solo con una corrispondenza rigida tramite l'attributo sourceAnchor.</span><span class="sxs-lookup"><span data-stu-id="2cd4f-146">In this case, you can only match on a hard match using the sourceAnchor.</span></span> <span data-ttu-id="2cd4f-147">L'attributo sourceAnchor è sempre l'**objectGUID** convertito in Base64 in locale, quindi è necessario aggiornare il valore in Azure AD quando due oggetti devono corrispondere.</span><span class="sxs-lookup"><span data-stu-id="2cd4f-147">The sourceAnchor is always the Base64 converted **objectGUID** on-premises, so you must update the value in Azure AD when you need two objects to match.</span></span> <span data-ttu-id="2cd4f-148">Gli attributi sourceAnchor/immutableID possono essere aggiornati solo con PowerShell e non tramite i portali.</span><span class="sxs-lookup"><span data-stu-id="2cd4f-148">The sourceAnchor/immutableID can only be updated with PowerShell and not through the portals.</span></span>

## <a name="create-a-new-on-premises-active-directory-from-data-in-azure-ad"></a><span data-ttu-id="2cd4f-149">Creare una nuova istanza di Active Directory locale dai dati di Azure AD</span><span class="sxs-lookup"><span data-stu-id="2cd4f-149">Create a new on-premises Active Directory from data in Azure AD</span></span>
<span data-ttu-id="2cd4f-150">Alcuni clienti iniziano con una soluzione solo cloud con Azure AD e non hanno un'istanza di AD locale.</span><span class="sxs-lookup"><span data-stu-id="2cd4f-150">Some customers start with a cloud-only solution with Azure AD and they do not have an on-premises AD.</span></span> <span data-ttu-id="2cd4f-151">In un secondo momento intendono usare risorse locali e creare un'istanza di AD locale basata sui dati di Azure AD.</span><span class="sxs-lookup"><span data-stu-id="2cd4f-151">Later they want to consume on-premises resources and want to build an on-premises AD based on Azure AD data.</span></span> <span data-ttu-id="2cd4f-152">Azure AD Connect non potrà essere utile per questo scenario.</span><span class="sxs-lookup"><span data-stu-id="2cd4f-152">Azure AD Connect cannot help you for this scenario.</span></span> <span data-ttu-id="2cd4f-153">Non crea gli utenti locali e non può impostare in locale la stessa password di Azure AD.</span><span class="sxs-lookup"><span data-stu-id="2cd4f-153">It does not create users on-premises and it does not have any ability to set the password on-premises to the same as in Azure AD.</span></span>

<span data-ttu-id="2cd4f-154">Se l'unico motivo per cui si prevede di aggiungere un'istanza di AD locale è il supporto di LOB (app line-of-business), forse è opportuno considerare invece l'uso di [Azure AD Domain Services](../../active-directory-domain-services/index.md).</span><span class="sxs-lookup"><span data-stu-id="2cd4f-154">If the only reason why you plan to add on-premises AD is to support LOBs (Line-of-Business apps), then maybe you should consider to use [Azure AD domain services](../../active-directory-domain-services/index.md) instead.</span></span>

## <a name="next-steps"></a><span data-ttu-id="2cd4f-155">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="2cd4f-155">Next steps</span></span>
<span data-ttu-id="2cd4f-156">Altre informazioni su [Integrazione delle identità locali con Azure Active Directory](active-directory-aadconnect.md).</span><span class="sxs-lookup"><span data-stu-id="2cd4f-156">Learn more about [Integrating your on-premises identities with Azure Active Directory](active-directory-aadconnect.md).</span></span>
