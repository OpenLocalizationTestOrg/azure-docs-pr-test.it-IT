---
title: Analisi di eventi di Azure Service Fabric con Azure Application Insights | Microsoft Docs
description: Informazioni sulla visualizzazione e l'analisi di eventi con Application Insights per il monitoraggio e la diagnostica dei cluster di Azure Service Fabric.
services: service-fabric
documentationcenter: .net
author: dkkapur
manager: timlt
editor: 
ms.assetid: 
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 05/26/2017
ms.author: dekapur
ms.openlocfilehash: 4085a607b800f4f4f155cdc266bc203b0858fd7c
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/03/2017
---
# <a name="event-analysis-and-visualization-with-application-insights"></a><span data-ttu-id="a03ed-103">Analisi e visualizzazione degli eventi con Application Insights</span><span class="sxs-lookup"><span data-stu-id="a03ed-103">Event analysis and visualization with Application Insights</span></span>

<span data-ttu-id="a03ed-104">Azure Application Insights è una piattaforma estendibile per la diagnostica e il monitoraggio dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="a03ed-104">Azure Application Insights is an extensible platform for application monitoring and diagnostics.</span></span> <span data-ttu-id="a03ed-105">Include un potente strumento di analisi ed esecuzione di query, visualizzazione e dashboard personalizzabili e altre opzioni tra cui gli avvisi automatizzati.</span><span class="sxs-lookup"><span data-stu-id="a03ed-105">It includes a powerful analytics and querying tool, customizable dashboard and visualizations, and further options including automated alerting.</span></span> <span data-ttu-id="a03ed-106">È la piattaforma consigliata per il monitoraggio e la diagnostica di servizi e applicazioni di Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="a03ed-106">It is the recommended platform for monitoring and diagnostics for Service Fabric applications and services.</span></span>

## <a name="setting-up-application-insights"></a><span data-ttu-id="a03ed-107">Configurazione di Application Insights</span><span class="sxs-lookup"><span data-stu-id="a03ed-107">Setting up Application Insights</span></span>

### <a name="creating-an-ai-resource"></a><span data-ttu-id="a03ed-108">Creazione di una risorsa AI</span><span class="sxs-lookup"><span data-stu-id="a03ed-108">Creating an AI Resource</span></span>

<span data-ttu-id="a03ed-109">Per creare una risorsa AI, visitare Azure Marketplace e cercare "Application Insights".</span><span class="sxs-lookup"><span data-stu-id="a03ed-109">To create an AI resource, head over to the Azure Marketplace, and search for "Application Insights".</span></span> <span data-ttu-id="a03ed-110">Viene visualizzata come la prima soluzione nella categoria "Web e dispositivi mobili".</span><span class="sxs-lookup"><span data-stu-id="a03ed-110">It should show up as the first solution (it is under category "Web + Mobile").</span></span> <span data-ttu-id="a03ed-111">Fare clic su **Crea** mentre si controllano le risorse sulla destra. Verificare che il percorso corrisponda a quello mostrato nell'immagine di seguito.</span><span class="sxs-lookup"><span data-stu-id="a03ed-111">Click **Create** when you are looking at the right resource (confirm that your path matches the image below).</span></span>

![Nuova risorsa di Application Insights](media/service-fabric-diagnostics-event-analysis-appinsights/create-new-ai-resource.png)

<span data-ttu-id="a03ed-113">È necessario inserire alcune informazioni per eseguire correttamente il provisioning della risorsa.</span><span class="sxs-lookup"><span data-stu-id="a03ed-113">You will need to fill out some information to provision the resource correctly.</span></span> <span data-ttu-id="a03ed-114">Nel campo *Tipo di applicazione* usare "Applicazione Web ASP.NET" se si intende usare di uno dei modelli di programmazione di Service Fabric o se si intende pubblicare un'applicazione .NET nel cluster.</span><span class="sxs-lookup"><span data-stu-id="a03ed-114">In the *Application Type* field, use "ASP.NET web application" if you will be using any of Service Fabric's programming models or publishing a .NET application to the cluster.</span></span> <span data-ttu-id="a03ed-115">Se si intende distribuire contenitori e file eseguibili guest, usare "Generale".</span><span class="sxs-lookup"><span data-stu-id="a03ed-115">Use "General" if you will be deploying guest executables and containers.</span></span> <span data-ttu-id="a03ed-116">In generale usare l'opzione predefinita "Applicazione Web ASP.NET" per tenere aperte le opzioni disponibili in futuro.</span><span class="sxs-lookup"><span data-stu-id="a03ed-116">In general, default to using "ASP.NET web application" to keep your options open in the future.</span></span> <span data-ttu-id="a03ed-117">L'utente può scegliere il nome in base alle proprie preferenze e sia la sottoscrizione sia il gruppo di risorse sono modificabile in seguito alla distribuzione della risorsa.</span><span class="sxs-lookup"><span data-stu-id="a03ed-117">The name is up to your preference, and both the resource group and subscription are changeable post-deployment of the resource.</span></span> <span data-ttu-id="a03ed-118">Si consiglia di inserire la risorsa AI nello stesso gruppo di risorse del cluster.</span><span class="sxs-lookup"><span data-stu-id="a03ed-118">We recommend that your AI resource is in the same resource group as your cluster.</span></span> <span data-ttu-id="a03ed-119">Per altre informazioni, vedere [Creare una risorsa di Application Insights](../application-insights/app-insights-create-new-resource.md)</span><span class="sxs-lookup"><span data-stu-id="a03ed-119">If you need more information, please see [Create an Application Insights resource](../application-insights/app-insights-create-new-resource.md)</span></span>

<span data-ttu-id="a03ed-120">Per configurare AI con lo strumento di aggregazione di eventi è necessaria la chiave di strumentazione AI.</span><span class="sxs-lookup"><span data-stu-id="a03ed-120">You need the AI Instrumentation Key to configure AI with your event aggregation tool.</span></span> <span data-ttu-id="a03ed-121">La configurazione della risorsa AI può richiedere pochi minuti dopo la convalida della distribuzione. In seguito passare alla risorsa e cercare la sezione **Proprietà** nella barra di spostamento a sinistra.</span><span class="sxs-lookup"><span data-stu-id="a03ed-121">Once your AI resource is set up (takes a few minutes after the deployment is validated), navigate to it and find the **Properties** section on the left navigation bar.</span></span> <span data-ttu-id="a03ed-122">Verrà visualizzato un nuovo pannello che mostra una *CHIAVE DI STRUMENTAZIONE*.</span><span class="sxs-lookup"><span data-stu-id="a03ed-122">A new blade will open up that shows an *INSTRUMENTATION KEY*.</span></span> <span data-ttu-id="a03ed-123">Qui è anche possibile modificare la sottoscrizione o il gruppo di risorse della risorsa.</span><span class="sxs-lookup"><span data-stu-id="a03ed-123">If you need to change the subscription or resource group of the resource, it can be done here as well.</span></span>

### <a name="configuring-ai-with-wad"></a><span data-ttu-id="a03ed-124">Configurazione di AI con WAD</span><span class="sxs-lookup"><span data-stu-id="a03ed-124">Configuring AI with WAD</span></span>

<span data-ttu-id="a03ed-125">Per inviare i dati da WAD ad Azure AI esistono due modalità, realizzabili aggiungendo un sink AI alla configurazione di WAD, come descritto in [questo articolo](../monitoring-and-diagnostics/azure-diagnostics-configure-application-insights.md).</span><span class="sxs-lookup"><span data-stu-id="a03ed-125">There are two primary ways to send data from WAD to Azure AI, which is achieved by adding an AI sink to the WAD configuration, as detailed in [this article](../monitoring-and-diagnostics/azure-diagnostics-configure-application-insights.md).</span></span>

#### <a name="add-an-ai-instrumentation-key-when-creating-a-cluster-in-azure-portal"></a><span data-ttu-id="a03ed-126">Aggiungere una chiave di strumentazione AI durante la creazione di un cluster nel portale di Azure</span><span class="sxs-lookup"><span data-stu-id="a03ed-126">Add an AI Instrumentation Key when creating a cluster in Azure portal</span></span>

![Aggiunta di un AIKey](media/service-fabric-diagnostics-event-analysis-appinsights/azure-enable-diagnostics.png)

<span data-ttu-id="a03ed-128">Quando si crea un cluster, se la diagnostica è attiva, si visualizzerà un campo facoltativo per immettere una chiave di strumentazione di Application Insights.</span><span class="sxs-lookup"><span data-stu-id="a03ed-128">When creating a cluster, if Diagnostics is turned "On", an optional field to enter an Application Insights Instrumentation key will show.</span></span> <span data-ttu-id="a03ed-129">Se si incolla la chiave di strumentazione AI qui, il sink AI verrà automaticamente configurato per l'utente nel modello di Resource Manager che viene usato per distribuire il cluster.</span><span class="sxs-lookup"><span data-stu-id="a03ed-129">If you paste your AI IKey here, the AI sink will be automatically configured for you in the Resource Manager template that is used to deploy your cluster.</span></span>

#### <a name="add-the-ai-sink-to-the-resource-manager-template"></a><span data-ttu-id="a03ed-130">Aggiungere il sink AI al modello di Resource Manager</span><span class="sxs-lookup"><span data-stu-id="a03ed-130">Add the AI Sink to the Resource Manager template</span></span>

<span data-ttu-id="a03ed-131">Nel modello di Resource Manager, in "WadCfg" aggiungere un "Sink" apportando le due modifiche seguenti:</span><span class="sxs-lookup"><span data-stu-id="a03ed-131">In the "WadCfg" of the Resource Manager template, add a "Sink" by including the following two changes:</span></span>

1. <span data-ttu-id="a03ed-132">Aggiungere la configurazione del sink:</span><span class="sxs-lookup"><span data-stu-id="a03ed-132">Add the sink configuration:</span></span>

    ```json
    "SinksConfig": {
        "Sink": [
            {
                "name": "applicationInsights",
                "ApplicationInsights": "***ADD INSTRUMENTATION KEY HERE***"
            }
        ]
    }

    ```

2. <span data-ttu-id="a03ed-133">Includere il sink in DiagnosticMonitorConfiguration aggiungendo la riga seguente in "DiagnosticMonitorConfiguration" di "WadCfg":</span><span class="sxs-lookup"><span data-stu-id="a03ed-133">Include the Sink in the DiagnosticMonitorConfiguration by adding the following line in "DiagnosticMonitorConfiguration" of the "WadCfg":</span></span>

    ```json
    "sinks": "applicationInsights"
    ```

<span data-ttu-id="a03ed-134">In entrambi i frammenti di codice precedenti il nome "applicationInsights" è stato usato per descrivere il sink.</span><span class="sxs-lookup"><span data-stu-id="a03ed-134">In both the code snippets above, the name "applicationInsights" was used to describe the sink.</span></span> <span data-ttu-id="a03ed-135">Questo non è un requisito e fino a quando il nome del sink è incluso in "sink", è possibile impostare il nome per qualsiasi stringa.</span><span class="sxs-lookup"><span data-stu-id="a03ed-135">This is not a requirement and as long as the name of the sink is included in "sinks", you can set the name to any string.</span></span>

<span data-ttu-id="a03ed-136">Attualmente, i registri del cluster verranno mostrati come tracce nel visualizzatore di log di AI.</span><span class="sxs-lookup"><span data-stu-id="a03ed-136">Currently, logs from the cluster will show up as traces in AI's log viewer.</span></span> <span data-ttu-id="a03ed-137">Poiché la maggior parte delle tracce provenienti dal livello di infrastruttura è di tipo "Informazioni", è anche possibile modificare la configurazione del sink per inviare solo i log di tipo "Critico" o "Errore".</span><span class="sxs-lookup"><span data-stu-id="a03ed-137">Since most of the traces coming from the platform are of level "Informational", you can also consider changing the sink configuration to only send logs of type "Critical" or "Error".</span></span> <span data-ttu-id="a03ed-138">Questa operazione può essere eseguita aggiungendo i "Canali" al sink, come illustrato in [questo articolo](../monitoring-and-diagnostics/azure-diagnostics-configure-application-insights.md).</span><span class="sxs-lookup"><span data-stu-id="a03ed-138">This can be done by adding "Channels" to your sink, as demonstrated in [this article](../monitoring-and-diagnostics/azure-diagnostics-configure-application-insights.md).</span></span>

>[!NOTE]
><span data-ttu-id="a03ed-139">Se si usa una chiave di strumentazione di AI errata nel portale o nel modello di Resource Manager, è necessario modificare la chiave e aggiornare il cluster o ridistribuirlo manualmente.</span><span class="sxs-lookup"><span data-stu-id="a03ed-139">If you use an incorrect AI IKey either in portal or in your Resource Manager template, you will have to manually change the key and update the cluster / redeploy it.</span></span> 

### <a name="configuring-ai-with-eventflow"></a><span data-ttu-id="a03ed-140">Configurazione di AI con EventFlow</span><span class="sxs-lookup"><span data-stu-id="a03ed-140">Configuring AI with EventFlow</span></span>

<span data-ttu-id="a03ed-141">Se si usa EventFlow per aggregare gli eventi, assicurarsi di importare il pacchetto NuGet `Microsoft.Diagnostics.EventFlow.Output.ApplicationInsights`.</span><span class="sxs-lookup"><span data-stu-id="a03ed-141">If you are using EventFlow to aggregate events, make sure to import the `Microsoft.Diagnostics.EventFlow.Output.ApplicationInsights`NuGet package.</span></span> <span data-ttu-id="a03ed-142">È necessario includere nella sezione *output* di *eventFlowConfig.json* il codice seguente:</span><span class="sxs-lookup"><span data-stu-id="a03ed-142">The following has to be included in the *outputs* section of the *eventFlowConfig.json*:</span></span>

```json
"outputs": [
    {
        "type": "ApplicationInsights",
        // (replace the following value with your AI resource's instrumentation key)
        "instrumentationKey": "00000000-0000-0000-0000-000000000000"
    }
]
```

<span data-ttu-id="a03ed-143">Assicurarsi di apportare le modifiche necessarie nei filtri, nonché di includere altri input, insieme ai rispettivi pacchetti NuGet.</span><span class="sxs-lookup"><span data-stu-id="a03ed-143">Make sure to make the required changes in your filters, as well as include any other inputs (along with their respective NuGet packages).</span></span>

## <a name="aisdk"></a><span data-ttu-id="a03ed-144">AI.SDK</span><span class="sxs-lookup"><span data-stu-id="a03ed-144">AI.SDK</span></span>

<span data-ttu-id="a03ed-145">In genere è consigliabile usare EventFlow e WAD come soluzioni di aggregazione, in quanto consentono di usare un approccio più modulare alla diagnostica e al monitoraggio. Ad esempio se si desidera modificare l'output da EventFlow non sono necessarie modifiche alla strumentazione effettiva, ma solo una semplice modifica al file di configurazione.</span><span class="sxs-lookup"><span data-stu-id="a03ed-145">It is generally recommended to use EventFlow and WAD as aggregation solutions, because they allow for a more modular approach to diagnostics and monitoring, i.e. if you want to change your outputs from EventFlow, it requires no change to your actual instrumentation, just a simple modification to your config file.</span></span> <span data-ttu-id="a03ed-146">Se, tuttavia, si decide di investire nell'uso di Application Insights e non si desidera passare a un'altra piattaforma, è consigliabile eseguire un'analisi usando il nuovo SDK di AI per l'aggregazione di eventi e l'invio ad AI.</span><span class="sxs-lookup"><span data-stu-id="a03ed-146">If, however, you decide to invest in using Application Insights and are not likely to change to a different platform, you should look into using AI's new SDK for aggregating events and sending them to AI.</span></span> <span data-ttu-id="a03ed-147">Ciò significa che non è più necessario configurare EventFlow per l'invio di dati AI, ma si dovrà installare il pacchetto NuGet di Service Fabric di ApplicationInsight.</span><span class="sxs-lookup"><span data-stu-id="a03ed-147">This means that you will no longer have to configure EventFlow to send your data to AI, but instead will install the ApplicationInsight's Service Fabric NuGet package.</span></span> <span data-ttu-id="a03ed-148">I dettagli del pacchetto sono disponibili [qui](https://github.com/Microsoft/ApplicationInsights-ServiceFabric).</span><span class="sxs-lookup"><span data-stu-id="a03ed-148">Details on the package can be found [here](https://github.com/Microsoft/ApplicationInsights-ServiceFabric).</span></span>

<span data-ttu-id="a03ed-149">[Supporto di Application Insights per microservizi e contenitori](https://azure.microsoft.com/app-insights-microservices/) descrive alcune delle nuove funzionalità su cui si sta lavorando, attualmente ancora in versione beta, che consentono di avere opzioni di monitoraggio con AI pronte all'uso più ricche.</span><span class="sxs-lookup"><span data-stu-id="a03ed-149">[Application Insights support for Microservices and Containers](https://azure.microsoft.com/app-insights-microservices/) shows you some of the new features that are being worked on (currently still in beta), which allow you to have richer out-of-the-box monitoring options with AI.</span></span> <span data-ttu-id="a03ed-150">Sono inclusi il rilevamento delle dipendenze, usato nella creazione di un AppMap per tutti i servizi e le applicazioni in un cluster e nella comunicazione tra di essi, e una migliore correlazione delle tracce provenienti dai servizi che consente di conoscere meglio un problema nel flusso di lavoro di un'app o di un servizio.</span><span class="sxs-lookup"><span data-stu-id="a03ed-150">These include dependency tracking (used in building an AppMap of all your services and applications in a cluster and the communication between them), and better correlation of traces coming from your services (helps in better pinpointing an issue in the workflow of an app or service).</span></span>

<span data-ttu-id="a03ed-151">Se si sviluppa in .NET e si intende usare alcuni modelli di programmazione di Service Fabric e AI come piattaforma per la visualizzazione e l'analisi dei dati dell'evento e del log, è consigliabile usare la route AI SDK come flusso di lavoro di monitoraggio e diagnostica.</span><span class="sxs-lookup"><span data-stu-id="a03ed-151">If you are developing in .NET and will likely be using some of Service Fabric's programming models, and are willing to use AI as your platform for visualizing and analyzing event and log data, then we recommend that you go via the AI SDK route as your monitoring and diagnostics workflow.</span></span> <span data-ttu-id="a03ed-152">Lettura [questo articolo](../application-insights/app-insights-asp-net-more.md) e [questo argomento](../application-insights/app-insights-asp-net-trace-logs.md) per iniziare a usare AI per raccogliere e visualizzare i log.</span><span class="sxs-lookup"><span data-stu-id="a03ed-152">Read [this](../application-insights/app-insights-asp-net-more.md) and [this](../application-insights/app-insights-asp-net-trace-logs.md) to get started with using AI to collect and display your logs.</span></span>

## <a name="navigating-the-ai-resource-in-azure-portal"></a><span data-ttu-id="a03ed-153">Spostamento della risorsa AI nel portale di Azure</span><span class="sxs-lookup"><span data-stu-id="a03ed-153">Navigating the AI resource in Azure portal</span></span>

<span data-ttu-id="a03ed-154">Dopo aver configurato AI come output per log ed eventi, le informazioni verranno visualizzate nella risorsa AI in pochi minuti.</span><span class="sxs-lookup"><span data-stu-id="a03ed-154">Once you have configured AI as an output for your events and logs, information should start to show up in your AI resource in a few minutes.</span></span> <span data-ttu-id="a03ed-155">Passare alla risorsa AI, che consente di accedere al dashboard della risorsa AI.</span><span class="sxs-lookup"><span data-stu-id="a03ed-155">Navigate to the AI resource, which will take you to the AI resource dashboard.</span></span> <span data-ttu-id="a03ed-156">Fare clic su **Cerca** nella barra delle applicazioni per visualizzare le tracce più recenti ricevute e applicare un filtro.</span><span class="sxs-lookup"><span data-stu-id="a03ed-156">Click **Search** in the AI taskbar to see the latest traces that it has received, and to be able to filter through them.</span></span>

<span data-ttu-id="a03ed-157">*Esplora metriche* è uno strumento utile per la creazione di dashboard personalizzati in base alle metriche che possono essere segnalate da applicazioni, servizi e cluster.</span><span class="sxs-lookup"><span data-stu-id="a03ed-157">*Metrics Explorer* is a useful tool for creating custom dashboards based on metrics that your applications, services, and cluster may be reporting.</span></span> <span data-ttu-id="a03ed-158">Vedere [Esaminare le metriche in Application Insights](../application-insights/app-insights-metrics-explorer.md) per configurare alcuni grafici per se stessi in base ai dati raccolti.</span><span class="sxs-lookup"><span data-stu-id="a03ed-158">See [Exploring Metrics in Application Insights](../application-insights/app-insights-metrics-explorer.md) to set up a few charts for yourself based on the data you are collecting.</span></span>

<span data-ttu-id="a03ed-159">Facendo clic su **Analisi** si aprirà il portale di Analisi di Application Insights, dove è possibile eseguire query di eventi e tracce con ambito e operazioni facoltative maggiori.</span><span class="sxs-lookup"><span data-stu-id="a03ed-159">Clicking **Analytics** will take you to the Application Insights Analytics portal, where you can query events and traces with greater scope and optionality.</span></span> <span data-ttu-id="a03ed-160">Per altre informazioni su questo argomento leggere [Analytics in Application Insights](../application-insights/app-insights-analytics.md) (Analisi in Application Insights).</span><span class="sxs-lookup"><span data-stu-id="a03ed-160">Read more about this at [Analytics in Application Insights](../application-insights/app-insights-analytics.md).</span></span>

## <a name="next-steps"></a><span data-ttu-id="a03ed-161">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="a03ed-161">Next steps</span></span>

* <span data-ttu-id="a03ed-162">[Configurare gli avvisi in AI](../application-insights/app-insights-alerts.md) per ricevere una notifica sulle modifiche apportate alle prestazioni o all'uso</span><span class="sxs-lookup"><span data-stu-id="a03ed-162">[Set up Alerts in AI](../application-insights/app-insights-alerts.md) to be notified about changes in performance or usage</span></span>
* <span data-ttu-id="a03ed-163">[Rilevamento intelligente in Application Insights](../application-insights/app-insights-proactive-diagnostics.md) esegue un'analisi proattiva dei dati di telemetria che vengono inviati ad AI per avvisare l'utente in caso di potenziali problemi di prestazioni</span><span class="sxs-lookup"><span data-stu-id="a03ed-163">[Smart Detection in Application Insights](../application-insights/app-insights-proactive-diagnostics.md) performs a proactive analysis of the telemetry being sent to AI to warn you of potential performance problems</span></span>