# <a name="secure-your-iot-deployment"></a><span data-ttu-id="caa5c-101">Proteggere la distribuzione di IoT</span><span class="sxs-lookup"><span data-stu-id="caa5c-101">Secure your IoT deployment</span></span>
<span data-ttu-id="caa5c-102">L'articolo fornisce una serie di informazioni avanzate per proteggere l'infrastruttura Azure IoT e</span><span class="sxs-lookup"><span data-stu-id="caa5c-102">This article provides the next level of detail for securing the Azure IoT-based Internet of Things (IoT) infrastructure.</span></span> <span data-ttu-id="caa5c-103">fornisce i collegamenti ai dettagli a livello di implementazione per configurare e distribuire ciascun componente.</span><span class="sxs-lookup"><span data-stu-id="caa5c-103">It links to implementation level details for configuring and deploying each component.</span></span> <span data-ttu-id="caa5c-104">Offre anche una serie di confronti e scelte tra i vari metodi concorrenti.</span><span class="sxs-lookup"><span data-stu-id="caa5c-104">It also provides comparisons and choices between various competing methods.</span></span>

<span data-ttu-id="caa5c-105">La protezione della distribuzione di Azure IoT può essere divisa nelle tre aree di sicurezza seguenti:</span><span class="sxs-lookup"><span data-stu-id="caa5c-105">Securing the Azure IoT deployment can be divided into the following three security areas:</span></span>

* <span data-ttu-id="caa5c-106">**Sicurezza del dispositivo**: proteggere il dispositivo IoT mentre viene distribuito in circostanze normali.</span><span class="sxs-lookup"><span data-stu-id="caa5c-106">**Device Security**: Securing the IoT device while it is deployed in the wild.</span></span>
* <span data-ttu-id="caa5c-107">**Sicurezza delle connessioni**: garantire che tuti i dati trasmessi tra il dispositivo IoT e l'hub IoT siano riservati e a prova di manomissione.</span><span class="sxs-lookup"><span data-stu-id="caa5c-107">**Connection Security**: Ensuring all data transmitted between the IoT device and IoT Hub is confidential and tamper-proof.</span></span>
* <span data-ttu-id="caa5c-108">**Sicurezza del cloud**: fornire un mezzo per proteggere i dati duranti il trasferimento e l'archiviazione nel cloud.</span><span class="sxs-lookup"><span data-stu-id="caa5c-108">**Cloud Security**: Providing a means to secure data while it moves through, and is stored in the cloud.</span></span>

![Tre aree di sicurezza][img-overview]

## <a name="secure-device-provisioning-and-authentication"></a><span data-ttu-id="caa5c-110">Proteggere il provisioning dei dispositivi e l'autenticazione</span><span class="sxs-lookup"><span data-stu-id="caa5c-110">Secure device provisioning and authentication</span></span>
<span data-ttu-id="caa5c-111">Azure IoT Suite protegge dispositivi IoT mediante i due metodi seguenti:</span><span class="sxs-lookup"><span data-stu-id="caa5c-111">The Azure IoT Suite secures IoT devices by the following two methods:</span></span>

* <span data-ttu-id="caa5c-112">Fornendo una chiave di identità univoca (token di sicurezza) per ogni dispositivo, che può essere utilizzata dal dispositivo per comunicare con l'hub IoT.</span><span class="sxs-lookup"><span data-stu-id="caa5c-112">By providing a unique identity key (security tokens) for each device, which can be used by the device to communicate with the IoT Hub.</span></span>
* <span data-ttu-id="caa5c-113">Usando un [certificato X.509 ][lnk-x509] su dispositivo e la chiave privata come mezzo per autenticare il dispositivo nell'hub IoT.</span><span class="sxs-lookup"><span data-stu-id="caa5c-113">By using an on-device [X.509 certificate][lnk-x509] and private key as a means to authenticate the device to the IoT Hub.</span></span> <span data-ttu-id="caa5c-114">Questo metodo di autenticazione assicura che la chiave privata sul dispositivo non sia mai nota all'esterno del dispositivo, garantendo un livello di sicurezza più elevato.</span><span class="sxs-lookup"><span data-stu-id="caa5c-114">This authentication method ensures that the private key on the device is not known outside the device at any time, providing a higher level of security.</span></span>

<span data-ttu-id="caa5c-115">Il metodo basato sul token di sicurezza fornisce l'autenticazione per ogni chiamata effettuata dal dispositivo all'hub IoT associando la chiave simmetrica a ciascuna chiamata.</span><span class="sxs-lookup"><span data-stu-id="caa5c-115">The security token method provides authentication for each call made by the device to IoT Hub by associating the symmetric key to each call.</span></span> <span data-ttu-id="caa5c-116">L'autenticazione basata sul certificato x.509 consente di autenticare un dispositivo IoT a livello fisico come parte del processo di creazione della connessione TLS.</span><span class="sxs-lookup"><span data-stu-id="caa5c-116">X.509-based authentication allows authentication of an IoT device at the physical layer as part of the TLS connection establishment.</span></span> <span data-ttu-id="caa5c-117">Il metodo basato sul token di sicurezza può essere utilizzato senza l'autenticazione tramite certificato x.509, che rappresenta un modello meno sicuro.</span><span class="sxs-lookup"><span data-stu-id="caa5c-117">The security-token-based method can be used without the X.509 authentication which is a less secure pattern.</span></span> <span data-ttu-id="caa5c-118">La scelta tra i due metodi dipende principalmente dal livello di protezione richiesto dall'autenticazione del dispositivo e dalla disponibilità di spazio di archiviazione sicura sul dispositivo (per archiviare la chiave privata in modo sicuro).</span><span class="sxs-lookup"><span data-stu-id="caa5c-118">The choice between the two methods is primarily dictated by how secure the device authentication needs to be, and availability of secure storage on the device (to store the private key securely).</span></span>

## <a name="iot-hub-security-tokens"></a><span data-ttu-id="caa5c-119">Token di sicurezza dell'hub IoT</span><span class="sxs-lookup"><span data-stu-id="caa5c-119">IoT Hub security tokens</span></span>
<span data-ttu-id="caa5c-120">Hub IoT usa i token di sicurezza per autenticare i dispositivi e i servizi ed evitare l'invio in rete delle chiavi.</span><span class="sxs-lookup"><span data-stu-id="caa5c-120">IoT Hub uses security tokens to authenticate devices and services to avoid sending keys on the network.</span></span> <span data-ttu-id="caa5c-121">Inoltre, i token di sicurezza hanno una validità limitata in termini di tempo e portata.</span><span class="sxs-lookup"><span data-stu-id="caa5c-121">Additionally, security tokens are limited in time validity and scope.</span></span> <span data-ttu-id="caa5c-122">Gli Azure IoT SDK generano automaticamente i token senza richiedere una configurazione speciale.</span><span class="sxs-lookup"><span data-stu-id="caa5c-122">Azure IoT SDKs automatically generate tokens without requiring any special configuration.</span></span> <span data-ttu-id="caa5c-123">In alcuni scenari, tuttavia, è necessario che l'utente generi e usi direttamente i token di sicurezza.</span><span class="sxs-lookup"><span data-stu-id="caa5c-123">Some scenarios, however, require the user to generate and use security tokens directly.</span></span> <span data-ttu-id="caa5c-124">Questi scenari includono l'uso diretto delle superfici MQTT, AMQP o HTTP o l'implementazione del modello di servizio token.</span><span class="sxs-lookup"><span data-stu-id="caa5c-124">These include the direct use of the MQTT, AMQP, or HTTP surfaces, or the implementation of the token service pattern.</span></span>

<span data-ttu-id="caa5c-125">Maggiori dettagli sulla struttura del token di sicurezza e il relativo utilizzo sono forniti all'interno degli articoli seguenti:</span><span class="sxs-lookup"><span data-stu-id="caa5c-125">More details on the structure of the security token and its usage can be found in the following articles:</span></span>

* <span data-ttu-id="caa5c-126">[Struttura dei token di sicurezza][lnk-security-tokens]</span><span class="sxs-lookup"><span data-stu-id="caa5c-126">[Security token structure][lnk-security-tokens]</span></span>
* <span data-ttu-id="caa5c-127">[Uso dei token SAS come dispositivo][lnk-sas-tokens]</span><span class="sxs-lookup"><span data-stu-id="caa5c-127">[Using SAS tokens as a device][lnk-sas-tokens]</span></span>

<span data-ttu-id="caa5c-128">Ogni hub IoT ha un [registro di identità][lnk-identity-registry] che può essere usato per creare risorse per dispositivo nel servizio, ad esempio una coda che contiene messaggi cloud a dispositivo in elaborazione, e per consentire l'accesso agli endpoint per dispositivi.</span><span class="sxs-lookup"><span data-stu-id="caa5c-128">Each IoT Hub has an [identity registry][lnk-identity-registry] that can be used to create per-device resources in the service, such as a queue that contains in-flight cloud-to-device messages, and to allow access to the device-facing endpoints.</span></span> <span data-ttu-id="caa5c-129">Il Registro delle identità dell'hub IoT offre l'archiviazione protetta delle identità e delle chiavi di protezione del dispositivo per una soluzione.</span><span class="sxs-lookup"><span data-stu-id="caa5c-129">The IoT Hub identity registry provides secure storage of device identities and security keys for a solution.</span></span> <span data-ttu-id="caa5c-130">Le identità dei dispositivi, singolarmente o in gruppo, possono essere aggiunte a un elenco Consenti o Blocca, favorendo il controllo completo dell'accesso al dispositivo.</span><span class="sxs-lookup"><span data-stu-id="caa5c-130">Individual or groups of device identities can be added to an allow list, or a block list, enabling complete control over device access.</span></span> <span data-ttu-id="caa5c-131">Gli articoli seguenti illustrano altri dettagli sulla struttura del registro di identità e sulle operazioni supportate.</span><span class="sxs-lookup"><span data-stu-id="caa5c-131">The following articles provide more details on the structure of the identity registry and supported operations.</span></span>

<span data-ttu-id="caa5c-132">[L'hub IoT supporta protocolli quali MQTT, AMQP e HTTP][lnk-protocols].</span><span class="sxs-lookup"><span data-stu-id="caa5c-132">[IoT Hub supports protocols such as MQTT, AMQP, and HTTP][lnk-protocols].</span></span> <span data-ttu-id="caa5c-133">Ognuno di questi protocolli utilizza i token di sicurezza dal dispositivo all'hub IoT in modo diverso:</span><span class="sxs-lookup"><span data-stu-id="caa5c-133">Each of these protocols use security tokens from the IoT device to IoT Hub differently:</span></span>

* <span data-ttu-id="caa5c-134">AMQP: sicurezza basata su attestazioni AMQP e SASL PLAIN ({policyName}@sas.root.{iothubName} nel caso di token a livello di hub IoT; {deviceId} nel caso di token con ambito dispositivo).</span><span class="sxs-lookup"><span data-stu-id="caa5c-134">AMQP: SASL PLAIN and AMQP Claims-based security ({policyName}@sas.root.{iothubName} in the case of IoT hub-level tokens; {deviceId} in case of device-scoped tokens).</span></span>
* <span data-ttu-id="caa5c-135">MQTT: il pacchetto CONNECT usa {deviceId} come {ClientId}, {IoThubhostname}/{deviceId} nel campo **Nome utente** e un token di firma di accesso condiviso nel campo **Password**.</span><span class="sxs-lookup"><span data-stu-id="caa5c-135">MQTT: CONNECT packet uses {deviceId} as the {ClientId}, {IoThubhostname}/{deviceId} in the **Username** field and a SAS token in the **Password** field.</span></span>
* <span data-ttu-id="caa5c-136">HTTP: il token valido è contenuto nell'intestazione della richiesta di autorizzazione.</span><span class="sxs-lookup"><span data-stu-id="caa5c-136">HTTP: Valid token is in the authorization request header.</span></span>

<span data-ttu-id="caa5c-137">Il registro di identità dell'hub IoT può essere usato per configurare il controllo dell'accesso e le credenziali di sicurezza per dispositivo.</span><span class="sxs-lookup"><span data-stu-id="caa5c-137">IoT Hub identity registry can be used to configure per-device security credentials and access control.</span></span> <span data-ttu-id="caa5c-138">Se tuttavia una soluzione IoT presenta già un investimento significativo in un [registro personalizzato di identità dei dispositivi e/o in uno schema di autenticazione][lnk-custom-auth], è possibile integrarla nell'infrastruttura esistente con l'hub IoT creando un servizio token.</span><span class="sxs-lookup"><span data-stu-id="caa5c-138">However, if an IoT solution already has a significant investment in a [custom device identity registry and/or authentication scheme][lnk-custom-auth], it can be integrated into an existing infrastructure with IoT Hub by creating a token service.</span></span>

### <a name="x509-certificate-based-device-authentication"></a><span data-ttu-id="caa5c-139">Autenticazione del dispositivo basata sul certificato x.509</span><span class="sxs-lookup"><span data-stu-id="caa5c-139">X.509 certificate-based device authentication</span></span>
<span data-ttu-id="caa5c-140">L'uso di un [certificato x.509 basato su dispositivo][lnk-use-x509] e la coppia di chiavi pubblica e privata associata consente un'autenticazione aggiuntiva a livello fisico.</span><span class="sxs-lookup"><span data-stu-id="caa5c-140">The use of a [device-based X.509 certificate][lnk-use-x509] and its associated private and public key pair allows additional authentication at the physical layer.</span></span> <span data-ttu-id="caa5c-141">La chiave privata viene archiviata in modo sicuro nel dispositivo e non può essere individuata all'esterno del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="caa5c-141">The private key is stored securely in the device and is not discoverable outside the device.</span></span> <span data-ttu-id="caa5c-142">Il certificato x.509 contiene informazioni sul dispositivo (ad esempio l'ID dispositivo) e altri dettagli dell'organizzazione.</span><span class="sxs-lookup"><span data-stu-id="caa5c-142">The X.509 certificate contains information about the device, such as device ID, and other organizational details.</span></span> <span data-ttu-id="caa5c-143">Una firma del certificato viene generata utilizzando la chiave privata.</span><span class="sxs-lookup"><span data-stu-id="caa5c-143">A signature of the certificate is generated by using the private key.</span></span>

<span data-ttu-id="caa5c-144">Flusso di provisioning di dispositivi di alto livello:</span><span class="sxs-lookup"><span data-stu-id="caa5c-144">High-level device provisioning flow:</span></span>

* <span data-ttu-id="caa5c-145">Associare un identificatore a un dispositivo fisico: associazione dell'identità del dispositivo e/o del certificato x.509 al dispositivo durante la produzione e la messa in funzione del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="caa5c-145">Associate an identifier to a physical device – device identity and/or X.509 certificate associated to the device during device manufacturing or commissioning.</span></span>
* <span data-ttu-id="caa5c-146">Creare una voce di identità corrispondente nell'hub IoT: l'identità del dispositivo e le informazioni sul dispositivo associato nel registro di identità dell'hub IoT.</span><span class="sxs-lookup"><span data-stu-id="caa5c-146">Create a corresponding identity entry in IoT Hub – device identity and associated device information in the IoT Hub identity registry.</span></span>
* <span data-ttu-id="caa5c-147">Archiviare in modo sicuro l'identificazione personale del certificato x.509 nel registro di identità dell'hub IoT.</span><span class="sxs-lookup"><span data-stu-id="caa5c-147">Securely store X.509 certificate thumbprint in IoT Hub identity registry.</span></span>

### <a name="root-certificate-on-device"></a><span data-ttu-id="caa5c-148">Certificato principale nel dispositivo</span><span class="sxs-lookup"><span data-stu-id="caa5c-148">Root certificate on device</span></span>
<span data-ttu-id="caa5c-149">Durante il tentativo di stabilire una connessione TLS sicura con l'hub IoT, il dispositivo IoT autentica l'hub IoT usando un certificato principale che fa parte dell'SDK per dispositivi.</span><span class="sxs-lookup"><span data-stu-id="caa5c-149">While establishing a secure TLS connection with IoT Hub, the IoT device authenticates IoT Hub using a root certificate which is part of the device SDK.</span></span> <span data-ttu-id="caa5c-150">Per l'SDK client dell'unità C, il certificato si trova nella cartella "\\c\\certs" nella radice del repository.</span><span class="sxs-lookup"><span data-stu-id="caa5c-150">For the C client SDK the certificate is located under the folder "\\c\\certs" under the root of the repo.</span></span> <span data-ttu-id="caa5c-151">Anche se questi certificati sono di lunga durata, possono comunque scadere o essere revocati.</span><span class="sxs-lookup"><span data-stu-id="caa5c-151">Though these root certificates are long-lived, they still may expire or be revoked.</span></span> <span data-ttu-id="caa5c-152">Se non esiste alcun modo di aggiornare il certificato sul dispositivo, il dispositivo potrebbe successivamente non essere in grado di connettersi all'hub IoT (o qualsiasi altro servizio cloud).</span><span class="sxs-lookup"><span data-stu-id="caa5c-152">If there is no way of updating the certificate on the device, the device may not be able to subsequently connect to the IoT Hub (or any other cloud service).</span></span> <span data-ttu-id="caa5c-153">Questo rischio si riduce efficacemente se si dispone di un mezzo per aggiornare il certificato principale dopo aver distribuito il dispositivo IoT.</span><span class="sxs-lookup"><span data-stu-id="caa5c-153">Having a means to update the root certificate once the IoT device is deployed will effectively mitigate this risk.</span></span>

## <a name="securing-the-connection"></a><span data-ttu-id="caa5c-154">Proteggere la connessione</span><span class="sxs-lookup"><span data-stu-id="caa5c-154">Securing the connection</span></span>
<span data-ttu-id="caa5c-155">La connessione Internet tra il dispositivo IoT e l'hub IoT è protetta mediante lo standard TLS (Transport Layer Security).</span><span class="sxs-lookup"><span data-stu-id="caa5c-155">Internet connection between the IoT device and IoT Hub is secured using the Transport Layer Security (TLS) standard.</span></span> <span data-ttu-id="caa5c-156">IoT di Azure supporta gli standard[TLS 1.2][lnk-tls12], TLS 1.1 e TLS 1.0, in questo ordine.</span><span class="sxs-lookup"><span data-stu-id="caa5c-156">Azure IoT supports [TLS 1.2][lnk-tls12], TLS 1.1 and TLS 1.0, in this order.</span></span> <span data-ttu-id="caa5c-157">Il supporto per lo standard TLS 1.0 viene fornito soltanto per la compatibilità con le versioni precedenti.</span><span class="sxs-lookup"><span data-stu-id="caa5c-157">Support for TLS 1.0 is provided for backward compatibility only.</span></span> <span data-ttu-id="caa5c-158">Si consiglia di usare lo standard TLS 1.2, che fornisce un livello di protezione superiore.</span><span class="sxs-lookup"><span data-stu-id="caa5c-158">It is recommended to use TLS 1.2 since it provides the most security.</span></span>

<span data-ttu-id="caa5c-159">Azure IoT Suite supporta, nell'ordine, i pacchetti di crittografia seguenti:</span><span class="sxs-lookup"><span data-stu-id="caa5c-159">Azure IoT Suite supports the following Cipher Suites, in this order.</span></span>

| <span data-ttu-id="caa5c-160">Pacchetto di crittografia</span><span class="sxs-lookup"><span data-stu-id="caa5c-160">Cipher Suite</span></span> | <span data-ttu-id="caa5c-161">Length</span><span class="sxs-lookup"><span data-stu-id="caa5c-161">Length</span></span> |
| --- | --- |
| <span data-ttu-id="caa5c-162">TLS\_ECDHE\_RSA\_WITH\_AES\_256\_CBC\_SHA384 (0xc028) ECDH secp384r1 (uguale a</span><span class="sxs-lookup"><span data-stu-id="caa5c-162">TLS\_ECDHE\_RSA\_WITH\_AES\_256\_CBC\_SHA384 (0xc028) ECDH secp384r1 (eq.</span></span> <span data-ttu-id="caa5c-163">RSA a 7680 bit) FS</span><span class="sxs-lookup"><span data-stu-id="caa5c-163">7680 bits RSA) FS</span></span> |<span data-ttu-id="caa5c-164">256</span><span class="sxs-lookup"><span data-stu-id="caa5c-164">256</span></span> |
| <span data-ttu-id="caa5c-165">TLS\_ECDHE\_RSA\_WITH\_AES\_128\_CBC\_SHA256 (0xc027) ECDH secp256r1 (uguale a</span><span class="sxs-lookup"><span data-stu-id="caa5c-165">TLS\_ECDHE\_RSA\_WITH\_AES\_128\_CBC\_SHA256 (0xc027) ECDH secp256r1 (eq.</span></span> <span data-ttu-id="caa5c-166">RSA a 3072 bit) FS</span><span class="sxs-lookup"><span data-stu-id="caa5c-166">3072 bits RSA) FS</span></span> |<span data-ttu-id="caa5c-167">128</span><span class="sxs-lookup"><span data-stu-id="caa5c-167">128</span></span> |
| <span data-ttu-id="caa5c-168">TLS\_ECDHE\_RSA\_WITH\_AES\_256\_CBC\_SHA (0xc014) ECDH secp384r1 (uguale a</span><span class="sxs-lookup"><span data-stu-id="caa5c-168">TLS\_ECDHE\_RSA\_WITH\_AES\_256\_CBC\_SHA (0xc014) ECDH secp384r1 (eq.</span></span> <span data-ttu-id="caa5c-169">RSA a 7680 bit) FS</span><span class="sxs-lookup"><span data-stu-id="caa5c-169">7680 bits RSA) FS</span></span> |<span data-ttu-id="caa5c-170">256</span><span class="sxs-lookup"><span data-stu-id="caa5c-170">256</span></span> |
| <span data-ttu-id="caa5c-171">TLS\_ECDHE\_RSA\_WITH\_AES\_128\_CBC\_SHA (0xc013) ECDH secp256r1 (uguale a</span><span class="sxs-lookup"><span data-stu-id="caa5c-171">TLS\_ECDHE\_RSA\_WITH\_AES\_128\_CBC\_SHA (0xc013) ECDH secp256r1 (eq.</span></span> <span data-ttu-id="caa5c-172">RSA a 3072 bit) FS</span><span class="sxs-lookup"><span data-stu-id="caa5c-172">3072 bits RSA) FS</span></span> |<span data-ttu-id="caa5c-173">128</span><span class="sxs-lookup"><span data-stu-id="caa5c-173">128</span></span> |
| <span data-ttu-id="caa5c-174">TLS\_RSA\_WITH\_AES\_256\_GCM\_SHA384 (0x9d)</span><span class="sxs-lookup"><span data-stu-id="caa5c-174">TLS\_RSA\_WITH\_AES\_256\_GCM\_SHA384 (0x9d)</span></span> |<span data-ttu-id="caa5c-175">256</span><span class="sxs-lookup"><span data-stu-id="caa5c-175">256</span></span> |
| <span data-ttu-id="caa5c-176">TLS\_RSA\_WITH\_AES\_128\_GCM\_SHA256 (0x9c)</span><span class="sxs-lookup"><span data-stu-id="caa5c-176">TLS\_RSA\_WITH\_AES\_128\_GCM\_SHA256 (0x9c)</span></span> |<span data-ttu-id="caa5c-177">128</span><span class="sxs-lookup"><span data-stu-id="caa5c-177">128</span></span> |
| <span data-ttu-id="caa5c-178">TLS\_RSA\_WITH\_AES\_256\_CBC\_SHA256 (0x3d)</span><span class="sxs-lookup"><span data-stu-id="caa5c-178">TLS\_RSA\_WITH\_AES\_256\_CBC\_SHA256 (0x3d)</span></span> |<span data-ttu-id="caa5c-179">256</span><span class="sxs-lookup"><span data-stu-id="caa5c-179">256</span></span> |
| <span data-ttu-id="caa5c-180">TLS\_RSA\_WITH\_AES\_128\_CBC\_SHA256 (0x3c)</span><span class="sxs-lookup"><span data-stu-id="caa5c-180">TLS\_RSA\_WITH\_AES\_128\_CBC\_SHA256 (0x3c)</span></span> |<span data-ttu-id="caa5c-181">128</span><span class="sxs-lookup"><span data-stu-id="caa5c-181">128</span></span> |
| <span data-ttu-id="caa5c-182">TLS\_RSA\_WITH\_AES\_256\_CBC\_SHA (0x35)</span><span class="sxs-lookup"><span data-stu-id="caa5c-182">TLS\_RSA\_WITH\_AES\_256\_CBC\_SHA (0x35)</span></span> |<span data-ttu-id="caa5c-183">256</span><span class="sxs-lookup"><span data-stu-id="caa5c-183">256</span></span> |
| <span data-ttu-id="caa5c-184">TLS\_RSA\_WITH\_AES\_128\_CBC\_SHA (0x2f)</span><span class="sxs-lookup"><span data-stu-id="caa5c-184">TLS\_RSA\_WITH\_AES\_128\_CBC\_SHA (0x2f)</span></span> |<span data-ttu-id="caa5c-185">128</span><span class="sxs-lookup"><span data-stu-id="caa5c-185">128</span></span> |
| <span data-ttu-id="caa5c-186">TLS\_RSA\_WITH\_3DES\_EDE\_CBC\_SHA (0xa)</span><span class="sxs-lookup"><span data-stu-id="caa5c-186">TLS\_RSA\_WITH\_3DES\_EDE\_CBC\_SHA (0xa)</span></span> |<span data-ttu-id="caa5c-187">112</span><span class="sxs-lookup"><span data-stu-id="caa5c-187">112</span></span> |

## <a name="securing-the-cloud"></a><span data-ttu-id="caa5c-188">Proteggere il cloud</span><span class="sxs-lookup"><span data-stu-id="caa5c-188">Securing the cloud</span></span>
<span data-ttu-id="caa5c-189">L'hub IoT di Azure consente la definizione dei [criteri di controllo di accesso][lnk-protocols] per ogni chiave di sicurezza,</span><span class="sxs-lookup"><span data-stu-id="caa5c-189">Azure IoT Hub allows definition of [access control policies][lnk-protocols] for each security key.</span></span> <span data-ttu-id="caa5c-190">usando il set di autorizzazioni seguente per concedere l'accesso agli endpoint dell'hub IoT.</span><span class="sxs-lookup"><span data-stu-id="caa5c-190">It uses the following set of permissions to grant access to each of IoT Hub's endpoints.</span></span> <span data-ttu-id="caa5c-191">Le autorizzazioni limitano l'accesso a un hub IoT in base alla funzionalità.</span><span class="sxs-lookup"><span data-stu-id="caa5c-191">Permissions limit the access to an IoT Hub based on functionality.</span></span>

* <span data-ttu-id="caa5c-192">**RegistryRead**.</span><span class="sxs-lookup"><span data-stu-id="caa5c-192">**RegistryRead**.</span></span> <span data-ttu-id="caa5c-193">Concede l'accesso di sola lettura al registro di identità.</span><span class="sxs-lookup"><span data-stu-id="caa5c-193">Grants read access to the identity registry.</span></span> <span data-ttu-id="caa5c-194">Per altre informazioni, vedere [Registro di identità][lnk-identity-registry].</span><span class="sxs-lookup"><span data-stu-id="caa5c-194">For more information, see [identity registry][lnk-identity-registry].</span></span>
* <span data-ttu-id="caa5c-195">**RegistryReadWrite**.</span><span class="sxs-lookup"><span data-stu-id="caa5c-195">**RegistryReadWrite**.</span></span> <span data-ttu-id="caa5c-196">Concede l'accesso di lettura e scrittura al registro di identità.</span><span class="sxs-lookup"><span data-stu-id="caa5c-196">Grants read and write access to the identity registry.</span></span> <span data-ttu-id="caa5c-197">Per altre informazioni, vedere [Registro di identità][lnk-identity-registry].</span><span class="sxs-lookup"><span data-stu-id="caa5c-197">For more information, see [identity registry][lnk-identity-registry].</span></span>
* <span data-ttu-id="caa5c-198">**ServiceConnect**.</span><span class="sxs-lookup"><span data-stu-id="caa5c-198">**ServiceConnect**.</span></span> <span data-ttu-id="caa5c-199">Concede l'accesso alle comunicazioni per il servizio cloud e al monitoraggio degli endpoint.</span><span class="sxs-lookup"><span data-stu-id="caa5c-199">Grants access to cloud service-facing communication and monitoring endpoints.</span></span> <span data-ttu-id="caa5c-200">Ad esempio, concede ai servizi cloud back-end l'autorizzazione per la ricezione di messaggi da dispositivo a cloud, l'invio di messaggi da cloud a dispositivo e il recupero degli acknowledgment di recapito corrispondenti.</span><span class="sxs-lookup"><span data-stu-id="caa5c-200">For example, it grants permission to back-end cloud services to receive device-to-cloud messages, send cloud-to-device messages, and retrieve the corresponding delivery acknowledgments.</span></span>
* <span data-ttu-id="caa5c-201">**DeviceConnect**.</span><span class="sxs-lookup"><span data-stu-id="caa5c-201">**DeviceConnect**.</span></span> <span data-ttu-id="caa5c-202">Concede l'accesso agli endpoint per il dispositivo.</span><span class="sxs-lookup"><span data-stu-id="caa5c-202">Grants access to device-facing endpoints.</span></span> <span data-ttu-id="caa5c-203">Ad esempio, concede l'autorizzazione per l'invio di messaggi da dispositivo a cloud e la ricezione di messaggi da cloud a dispositivo.</span><span class="sxs-lookup"><span data-stu-id="caa5c-203">For example, it grants permission to send device-to-cloud messages and receive cloud-to-device messages.</span></span> <span data-ttu-id="caa5c-204">Questa autorizzazione viene usata dai dispositivi.</span><span class="sxs-lookup"><span data-stu-id="caa5c-204">This permission is used by devices.</span></span>

<span data-ttu-id="caa5c-205">Ci sono due modi per ottenere le autorizzazioni **DeviceConnect** su hub IoT con i [token di sicurezza][lnk-sas-tokens]: tramite una chiave di identità dispositivo o tramite una chiave di accesso condiviso.</span><span class="sxs-lookup"><span data-stu-id="caa5c-205">There are two ways to obtain **DeviceConnect** permissions with IoT Hub with [security tokens][lnk-sas-tokens]: using a device identity key, or a shared access key.</span></span> <span data-ttu-id="caa5c-206">Inoltre, è importante notare che tutte le funzionalità accessibili dai dispositivi vengono esposte, per impostazione predefinita, sugli endpoint con prefisso `/devices/{deviceId}`.</span><span class="sxs-lookup"><span data-stu-id="caa5c-206">Moreover, it is important to note that all functionality accessible from devices is exposed by design on endpoints with prefix `/devices/{deviceId}`.</span></span>

<span data-ttu-id="caa5c-207">[I componenti del servizio possono generare token di sicurezza][lnk-service-tokens] solo tramite criteri di accesso condiviso che concedono le autorizzazioni appropriate.</span><span class="sxs-lookup"><span data-stu-id="caa5c-207">[Service components can only generate security tokens][lnk-service-tokens] using shared access policies granting the appropriate permissions.</span></span>

<span data-ttu-id="caa5c-208">L'hub IoT di Azure e altri servizi che possono essere parte della soluzione consentono la gestione degli utenti mediante l'Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="caa5c-208">Azure IoT Hub and other services which may be part of the solution allow management of users using the Azure Active Directory.</span></span>

<span data-ttu-id="caa5c-209">I dati inseriti dall'Hub IoT di Azure possono essere usati da una serie di servizi, ad esempio Analisi di flusso di Azure, Archiviazione BLOB e così via.</span><span class="sxs-lookup"><span data-stu-id="caa5c-209">Data ingested by Azure IoT Hub can be consumed by a variety of services such as Azure Stream Analytics and Azure blob storage.</span></span> <span data-ttu-id="caa5c-210">Questi servizi consentono l'accesso di gestione.</span><span class="sxs-lookup"><span data-stu-id="caa5c-210">These services allow management access.</span></span> <span data-ttu-id="caa5c-211">Ulteriori informazioni su questi servizi e sulle opzioni disponibili riportate di seguito:</span><span class="sxs-lookup"><span data-stu-id="caa5c-211">Read more about these services and available options below:</span></span>

* <span data-ttu-id="caa5c-212">[Azure DocumentDB][lnk-docdb]: un servizio di database scalabile e completamente indicizzato per i dati semistrutturati che gestiscono metadati per i dispositivi di cui si effettua il provisioning, ad esempio attributi, configurazione e proprietà di sicurezza.</span><span class="sxs-lookup"><span data-stu-id="caa5c-212">[Azure DocumentDB][lnk-docdb]: A scalable, fully-indexed database service for semi-structured data that manages metadata for the devices you provision, such as attributes, configuration, and security properties.</span></span> <span data-ttu-id="caa5c-213">DocumentDB offre l'elaborazione ad alte prestazioni e velocità, indicizzazione dei dati senza schema e una ricca interfaccia di query SQL.</span><span class="sxs-lookup"><span data-stu-id="caa5c-213">DocumentDB offers high-performance and high-throughput processing, schema-agnostic indexing of data, and a rich SQL query interface.</span></span>
* <span data-ttu-id="caa5c-214">[Analisi di flusso di Azure][lnk-asa]: elaborazione del flusso in tempo reale nel cloud per sviluppare e distribuire rapidamente una soluzione di analisi a basso costo che consenta di rilevare informazioni approfondite in tempo reale da dispositivi, sensori, infrastruttura e applicazioni.</span><span class="sxs-lookup"><span data-stu-id="caa5c-214">[Azure Stream Analytics][lnk-asa]: Real-time stream processing in the cloud that enables you to rapidly develop and deploy a low-cost analytics solution to uncover real-time insights from devices, sensors, infrastructure, and applications.</span></span> <span data-ttu-id="caa5c-215">I dati di questo servizio completamente gestito possono raggiungere qualsiasi volume anche in condizioni di velocità effettiva elevata, bassa latenza e resilienza.</span><span class="sxs-lookup"><span data-stu-id="caa5c-215">The data from this fully-managed service can scale to any volume while still achieving high throughput, low latency, and resiliency.</span></span>
* <span data-ttu-id="caa5c-216">[Servizi app di Azure][lnk-appservices]: piattaforma cloud per compilare efficaci app mobili e Web che si connettono ai dati ovunque si trovino: nel cloud o localmente.</span><span class="sxs-lookup"><span data-stu-id="caa5c-216">[Azure App Services][lnk-appservices]: A cloud platform to build powerful web and mobile apps that connect to data anywhere; in the cloud or on-premises.</span></span> <span data-ttu-id="caa5c-217">Creare app per dispositivi mobili coinvolgenti per iOS, Android e Windows.</span><span class="sxs-lookup"><span data-stu-id="caa5c-217">Build engaging mobile apps for iOS, Android, and Windows.</span></span> <span data-ttu-id="caa5c-218">Eseguire l'integrazione con applicazioni Software as a Service (SaaS) e aziendali, grazie a connettività integrata a dozzine di applicazioni aziendali e servizi basati sul cloud.</span><span class="sxs-lookup"><span data-stu-id="caa5c-218">Integrate with your Software as a Service (SaaS) and enterprise applications with out-of-the-box connectivity to dozens of cloud-based services and enterprise applications.</span></span> <span data-ttu-id="caa5c-219">Scrivere codice usando IDE e il linguaggio preferito, .NET, Node.js, PHP, Python o Java, per creare app Web e API più rapidamente che mai.</span><span class="sxs-lookup"><span data-stu-id="caa5c-219">Code in your favorite language and IDE (.NET, Node.js, PHP, Python, or Java) to build web apps and APIs faster than ever.</span></span>
* <span data-ttu-id="caa5c-220">[App per la logica][lnk-logicapps]: la funzionalità App per la logica del servizio app di Azure consente di integrare la soluzione IoT con i sistemi line-of-business esistenti e automatizzare i processi del flusso di lavoro.</span><span class="sxs-lookup"><span data-stu-id="caa5c-220">[Logic Apps][lnk-logicapps]: The Logic Apps feature of Azure App Service helps integrate your IoT solution to your existing line-of-business systems and automate workflow processes.</span></span> <span data-ttu-id="caa5c-221">App per la logica consente agli sviluppatori di progettare flussi di lavoro che vengono avviati da un trigger e quindi di eseguire una serie di passaggi, regole e azioni che usano potenti connettori per l'integrazione con i processi aziendali.</span><span class="sxs-lookup"><span data-stu-id="caa5c-221">Logic Apps enables developers to design workflows that start from a trigger and then execute a series of steps—rules and actions that use powerful connectors to integrate with your business processes.</span></span> <span data-ttu-id="caa5c-222">App per la logica offre connettività integrata per un vasto ecosistema di applicazioni SaaS, basate sul cloud e locali.</span><span class="sxs-lookup"><span data-stu-id="caa5c-222">Logic Apps offers out-of-the-box connectivity to a vast ecosystem of SaaS, cloud-based, and on-premises applications.</span></span>
* <span data-ttu-id="caa5c-223">[Archiviazione BLOB di Azure][lnk-blob]: archiviazione cloud affidabile ed economica per i dati che i dispositivi inviano al cloud.</span><span class="sxs-lookup"><span data-stu-id="caa5c-223">[Azure blob storage][lnk-blob]: Reliable, economical cloud storage for the data that your devices send to the cloud.</span></span>

## <a name="conclusion"></a><span data-ttu-id="caa5c-224">Conclusione</span><span class="sxs-lookup"><span data-stu-id="caa5c-224">Conclusion</span></span>
<span data-ttu-id="caa5c-225">Questo articolo fornisce una panoramica a livello di implementazione per progettare e distribuire un'infrastruttura mediante Azure IoT.</span><span class="sxs-lookup"><span data-stu-id="caa5c-225">This article provides overview of implementation level details for designing and deploying an IoT infrastructure using Azure IoT.</span></span> <span data-ttu-id="caa5c-226">Per una protezione complessiva dell'infrastruttura IoT è fondamentale configurare la sicurezza di ciascun componente.</span><span class="sxs-lookup"><span data-stu-id="caa5c-226">Configuring each component to be secure is key in securing the overall IoT infrastructure.</span></span> <span data-ttu-id="caa5c-227">Le scelte di progettazione disponibili in Azure IoT forniscono un certo livello di flessibilità e scelta; tuttavia, ogni scelta può avere determinate implicazioni di sicurezza.</span><span class="sxs-lookup"><span data-stu-id="caa5c-227">The design choices available in Azure IoT provide some level of flexibility and choice; however, each choice may have security implications.</span></span> <span data-ttu-id="caa5c-228">Si consiglia di vagliare entrambe le opzioni secondo il criterio di una valutazione dei costi e del rischio.</span><span class="sxs-lookup"><span data-stu-id="caa5c-228">It is recommended that each of these choices be evaluated through a risk/cost assessment.</span></span>

[img-overview]: media/iot-secure-your-deployment/overview.png

[lnk-security-tokens]: ../articles/iot-hub/iot-hub-devguide-security.md#security-token-structure
[lnk-sas-tokens]: ../articles/iot-hub/iot-hub-devguide-security.md#use-sas-tokens-in-a-device-app
[lnk-identity-registry]: ../articles/iot-hub/iot-hub-devguide-identity-registry.md
[lnk-protocols]: ../articles/iot-hub/iot-hub-devguide-security.md
[lnk-custom-auth]: ../articles/iot-hub/iot-hub-devguide-security.md#custom-device-authentication
[lnk-x509]: http://www.itu.int/rec/T-REC-X.509-201210-I/en
[lnk-use-x509]: ../articles/iot-hub/iot-hub-devguide-security.md
[lnk-tls12]: https://tools.ietf.org/html/rfc5246
[lnk-service-tokens]: ../articles/iot-hub/iot-hub-devguide-security.md#use-security-tokens-from-service-components
[lnk-docdb]: https://azure.microsoft.com/services/documentdb/
[lnk-asa]: https://azure.microsoft.com/services/stream-analytics/
[lnk-appservices]: https://azure.microsoft.com/services/app-service/
[lnk-logicapps]: https://azure.microsoft.com/services/app-service/logic/
[lnk-blob]: https://azure.microsoft.com/services/storage/
