---
title: Il primo runbook PowerShell in Automazione di Azure | Documentazione Microsoft
description: Esercitazione che illustra la creazione, i test e la pubblicazione di un semplice runbook PowerShell.
services: automation
documentationcenter: 
author: mgoedtel
manager: jwhit
editor: 
keywords: Azure PowerShell, esercitazione sugli script di PowerShell, automazione di PowerShell
ms.assetid: a43b395a-e740-41a3-ae62-40eac9d0ec00
ms.service: automation
ms.workload: tbd
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: get-started-article
ms.date: 03/26/2017
ms.author: magoedte;sngun
ms.openlocfilehash: 4b32011b72acc647d4af44bb5ccbcaab408fb4d6
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 07/11/2017
---
# <a name="my-first-powershell-runbook"></a><span data-ttu-id="54482-104">Il primo runbook PowerShell</span><span class="sxs-lookup"><span data-stu-id="54482-104">My first PowerShell runbook</span></span>

> [!div class="op_single_selector"]
> * [<span data-ttu-id="54482-105">Grafico</span><span class="sxs-lookup"><span data-stu-id="54482-105">Graphical</span></span>](automation-first-runbook-graphical.md)
> * [<span data-ttu-id="54482-106">PowerShell</span><span class="sxs-lookup"><span data-stu-id="54482-106">PowerShell</span></span>](automation-first-runbook-textual-powershell.md)
> * [<span data-ttu-id="54482-107">Flusso di lavoro PowerShell</span><span class="sxs-lookup"><span data-stu-id="54482-107">PowerShell Workflow</span></span>](automation-first-runbook-textual.md)
> 
> 

<span data-ttu-id="54482-108">Questa esercitazione illustra la creazione di un [runbook PowerShell](automation-runbook-types.md#powershell-runbooks) in Automazione di Azure.</span><span class="sxs-lookup"><span data-stu-id="54482-108">This tutorial walks you through the creation of a [PowerShell runbook](automation-runbook-types.md#powershell-runbooks) in Azure Automation.</span></span> <span data-ttu-id="54482-109">Si inizia con un runbook semplice che sarà testato e pubblicato, quindi viene illustrato come tenere traccia dello stato del processo del runbook.</span><span class="sxs-lookup"><span data-stu-id="54482-109">We start with a simple runbook that we test and publish while we explain how to track the status of the runbook job.</span></span> <span data-ttu-id="54482-110">Si modifica quindi il runbook per gestire effettivamente le risorse di Azure, avviando in questo caso una macchina virtuale di Azure.</span><span class="sxs-lookup"><span data-stu-id="54482-110">Then we modify the runbook to actually manage Azure resources, in this case starting an Azure virtual machine.</span></span> <span data-ttu-id="54482-111">Si rende infine il runbook più affidabile aggiungendo i relativi parametri.</span><span class="sxs-lookup"><span data-stu-id="54482-111">Lastly, we make the runbook more robust by adding runbook parameters.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="54482-112">Prerequisiti</span><span class="sxs-lookup"><span data-stu-id="54482-112">Prerequisites</span></span>
<span data-ttu-id="54482-113">Per completare l'esercitazione, sono necessari gli elementi seguenti:</span><span class="sxs-lookup"><span data-stu-id="54482-113">To complete this tutorial, you need the following:</span></span>

* <span data-ttu-id="54482-114">Sottoscrizione di Azure.</span><span class="sxs-lookup"><span data-stu-id="54482-114">Azure subscription.</span></span> <span data-ttu-id="54482-115">Se non si ha ancora una sottoscrizione, è possibile [attivare i vantaggi della sottoscrizione MSDN](https://azure.microsoft.com/pricing/member-offers/msdn-benefits-details/) oppure <a href="/pricing/free-account/" target="_blank">[iscriversi per ottenere un account gratuito](https://azure.microsoft.com/free/).</span><span class="sxs-lookup"><span data-stu-id="54482-115">If you don't have one yet, you can [activate your MSDN subscriber benefits](https://azure.microsoft.com/pricing/member-offers/msdn-benefits-details/) or <a href="/pricing/free-account/" target="_blank">[sign up for a free account](https://azure.microsoft.com/free/).</span></span>
* <span data-ttu-id="54482-116">[Account di Automazione](automation-sec-configure-azure-runas-account.md) che conterrà il runbook ed eseguirà l'autenticazione con le risorse di Azure.</span><span class="sxs-lookup"><span data-stu-id="54482-116">[Automation account](automation-sec-configure-azure-runas-account.md) to hold the runbook and authenticate to Azure resources.</span></span>  <span data-ttu-id="54482-117">Questo account deve avere l'autorizzazione per avviare e arrestare la macchina virtuale.</span><span class="sxs-lookup"><span data-stu-id="54482-117">This account must have permission to start and stop the virtual machine.</span></span>
* <span data-ttu-id="54482-118">Macchina virtuale di Azure.</span><span class="sxs-lookup"><span data-stu-id="54482-118">An Azure virtual machine.</span></span> <span data-ttu-id="54482-119">La macchina virtuale viene arrestata e avviata, quindi non deve essere una macchina virtuale di produzione.</span><span class="sxs-lookup"><span data-stu-id="54482-119">We stop and start this machine so it should not be a production VM.</span></span>

## <a name="step-1---create-new-runbook"></a><span data-ttu-id="54482-120">Passaggio 1: Creare nuovo runbook</span><span class="sxs-lookup"><span data-stu-id="54482-120">Step 1 - Create new runbook</span></span>
<span data-ttu-id="54482-121">Si inizierà creando un runbook semplice che restituisce il testo *Hello World*.</span><span class="sxs-lookup"><span data-stu-id="54482-121">We'll start by creating a simple runbook that outputs the text *Hello World*.</span></span>

1. <span data-ttu-id="54482-122">Nel portale di Azure aprire l'account di automazione.</span><span class="sxs-lookup"><span data-stu-id="54482-122">In the Azure portal, open your Automation account.</span></span>  
   <span data-ttu-id="54482-123">La pagina dell'account di automazione offre una visualizzazione rapida delle risorse di questo account.</span><span class="sxs-lookup"><span data-stu-id="54482-123">The Automation account page gives you a quick view of the resources in this account.</span></span> <span data-ttu-id="54482-124">Dovrebbero essere già disponibili alcuni asset.</span><span class="sxs-lookup"><span data-stu-id="54482-124">You should already have some assets.</span></span> <span data-ttu-id="54482-125">Per la maggior parte sono i moduli inclusi automaticamente in un nuovo account di automazione.</span><span class="sxs-lookup"><span data-stu-id="54482-125">Most of those are the modules that are automatically included in a new Automation account.</span></span> <span data-ttu-id="54482-126">Dovrebbe essere disponibile anche l'asset credenziali citato nei [prerequisiti](#prerequisites).</span><span class="sxs-lookup"><span data-stu-id="54482-126">You should also have the Credential asset that's mentioned in the [prerequisites](#prerequisites).</span></span>
2. <span data-ttu-id="54482-127">Fare clic nel pannello **Runbook** per aprire l'elenco dei runbook.</span><span class="sxs-lookup"><span data-stu-id="54482-127">Click the **Runbooks** tile to open the list of runbooks.</span></span><br><br> <span data-ttu-id="54482-128">![RunbooksControl](media/automation-first-runbook-textual-powershell/runbooks-control-tiles.png)</span><span class="sxs-lookup"><span data-stu-id="54482-128">![RunbooksControl](media/automation-first-runbook-textual-powershell/runbooks-control-tiles.png)</span></span>  
3. <span data-ttu-id="54482-129">Creare un nuovo runbook facendo clic sul pulsante **Aggiungi runbook** e quindi su **Crea un nuovo runbook**.</span><span class="sxs-lookup"><span data-stu-id="54482-129">Create a new runbook by clicking the **Add a runbook** button and then **Create a new runbook**.</span></span>
4. <span data-ttu-id="54482-130">Denominare il runbook *MyFirstRunbook-PowerShell*.</span><span class="sxs-lookup"><span data-stu-id="54482-130">Give the runbook the name *MyFirstRunbook-PowerShell*.</span></span>
5. <span data-ttu-id="54482-131">In questo caso si sta creando un [runbook PowerShell](automation-runbook-types.md#powershell-runbooks), quindi selezionare **Powershell** per **Tipo di Runbook**.</span><span class="sxs-lookup"><span data-stu-id="54482-131">In this case, we're going to create a [PowerShell runbook](automation-runbook-types.md#powershell-runbooks) so select **Powershell** for **Runbook type**.</span></span><br><br> <span data-ttu-id="54482-132">![Tipo di runbook](media/automation-first-runbook-textual-powershell/automation-runbook-type.png)</span><span class="sxs-lookup"><span data-stu-id="54482-132">![Runbook Type](media/automation-first-runbook-textual-powershell/automation-runbook-type.png)</span></span>  
6. <span data-ttu-id="54482-133">Fare clic su **Crea** per creare il runbook e aprire l'editor di testo.</span><span class="sxs-lookup"><span data-stu-id="54482-133">Click **Create** to create the runbook and open the textual editor.</span></span>

## <a name="step-2---add-code-to-the-runbook"></a><span data-ttu-id="54482-134">Passaggio 2: - aggiungere un codice al runbook</span><span class="sxs-lookup"><span data-stu-id="54482-134">Step 2 - Add code to the runbook</span></span>
<span data-ttu-id="54482-135">È possibile digitare il codice direttamente nel runbook, oppure è possibile selezionare i cmdlet, i runbook e le risorse dal controllo della libreria e aggiungerle al runbook con tutti i parametri correlati.</span><span class="sxs-lookup"><span data-stu-id="54482-135">You can either type code directly into the runbook, or you can select cmdlets, runbooks, and assets from the Library control and have them added to the runbook with any related parameters.</span></span> <span data-ttu-id="54482-136">Per questa procedura dettagliata si digiterà direttamente nel runbook.</span><span class="sxs-lookup"><span data-stu-id="54482-136">For this walkthrough, we type directly in the runbook.</span></span>

1. <span data-ttu-id="54482-137">Il runbook è attualmente vuoto, digitare *Write-Output "Hello World"*.</span><span class="sxs-lookup"><span data-stu-id="54482-137">Our runbook is currently empty, type *Write-Output "Hello World."*.</span></span><br><br> <span data-ttu-id="54482-138">![Hello World](media/automation-first-runbook-textual-powershell/automation-helloworld.png)</span><span class="sxs-lookup"><span data-stu-id="54482-138">![Hello World](media/automation-first-runbook-textual-powershell/automation-helloworld.png)</span></span>  
2. <span data-ttu-id="54482-139">Salvare il runbook facendo clic su **Salva**.</span><span class="sxs-lookup"><span data-stu-id="54482-139">Save the runbook by clicking **Save**.</span></span><br><br> <span data-ttu-id="54482-140">![Pulsante Salva](media/automation-first-runbook-textual-powershell/automation-runbook-edit-controls-save.png)</span><span class="sxs-lookup"><span data-stu-id="54482-140">![Save Button](media/automation-first-runbook-textual-powershell/automation-runbook-edit-controls-save.png)</span></span>  

## <a name="step-3---test-the-runbook"></a><span data-ttu-id="54482-141">Passaggio 3: Testare il runbook</span><span class="sxs-lookup"><span data-stu-id="54482-141">Step 3 - Test the runbook</span></span>
<span data-ttu-id="54482-142">Prima di pubblicare il runbook per renderlo disponibile nell'ambiente di produzione, occorre testarlo per verificare che funzioni correttamente.</span><span class="sxs-lookup"><span data-stu-id="54482-142">Before we publish the runbook to make it available in production, we want to test it to make sure that it works properly.</span></span> <span data-ttu-id="54482-143">Quando si testa un runbook, è necessario eseguire la versione **Bozza** e visualizzarne l'output in modo interattivo.</span><span class="sxs-lookup"><span data-stu-id="54482-143">When you test a runbook, you run its **Draft** version and view its output interactively.</span></span>

1. <span data-ttu-id="54482-144">Fare clic su **Pannello di test** per aprire il pannello di test.</span><span class="sxs-lookup"><span data-stu-id="54482-144">Click **Test pane** to open the Test pane.</span></span><br><br> <span data-ttu-id="54482-145">![Test Pane](media/automation-first-runbook-textual-powershell/automation-runbook-edit-controls-test.png)</span><span class="sxs-lookup"><span data-stu-id="54482-145">![Test Pane](media/automation-first-runbook-textual-powershell/automation-runbook-edit-controls-test.png)</span></span>  
2. <span data-ttu-id="54482-146">Fare clic su **Avvia** per avviare il test.</span><span class="sxs-lookup"><span data-stu-id="54482-146">Click **Start** to start the test.</span></span> <span data-ttu-id="54482-147">Questa deve essere l'unica opzione abilitata.</span><span class="sxs-lookup"><span data-stu-id="54482-147">This should be the only enabled option.</span></span>
3. <span data-ttu-id="54482-148">Viene creato un [processo del runbook](automation-runbook-execution.md) e il relativo stato viene visualizzato.</span><span class="sxs-lookup"><span data-stu-id="54482-148">A [runbook job](automation-runbook-execution.md) is created and its status displayed.</span></span>  
   <span data-ttu-id="54482-149">Lo stato del processo verrà avviato come *In coda* per indicare che è in attesa della disponibilità di un ruolo di lavoro per runbook nel cloud.</span><span class="sxs-lookup"><span data-stu-id="54482-149">The job status starts as *Queued* indicating that it is waiting for a runbook worker in the cloud to come available.</span></span> <span data-ttu-id="54482-150">Lo stato passerà quindi ad *Avvio in corso* quando un ruolo di lavoro richiede il processo e quindi a *In esecuzione* quando l'esecuzione del runbook viene effettivamente avviata.</span><span class="sxs-lookup"><span data-stu-id="54482-150">It will then move to *Starting* when a worker claims the job, and then *Running* when the runbook actually starts running.</span></span>  
4. <span data-ttu-id="54482-151">Al termine del processo del runbook, viene visualizzato l'output.</span><span class="sxs-lookup"><span data-stu-id="54482-151">When the runbook job completes, its output is displayed.</span></span> <span data-ttu-id="54482-152">In questo caso, dovrebbe essere visualizzato *Hello World*.</span><span class="sxs-lookup"><span data-stu-id="54482-152">In our case, we should see *Hello World*.</span></span><br><br> <span data-ttu-id="54482-153">![Output del Riquadro test](media/automation-first-runbook-textual-powershell/automation-testpane-output.png)</span><span class="sxs-lookup"><span data-stu-id="54482-153">![Test Pane Output](media/automation-first-runbook-textual-powershell/automation-testpane-output.png)</span></span>  
5. <span data-ttu-id="54482-154">Chiudere il riquadro di test per tornare all'area di disegno.</span><span class="sxs-lookup"><span data-stu-id="54482-154">Close the Test pane to return to the canvas.</span></span>

## <a name="step-4---publish-and-start-the-runbook"></a><span data-ttu-id="54482-155">Passaggio 4: Pubblicare e avviare il runbook</span><span class="sxs-lookup"><span data-stu-id="54482-155">Step 4 - Publish and start the runbook</span></span>
<span data-ttu-id="54482-156">Il runbook creato è ancora in modalità Bozza.</span><span class="sxs-lookup"><span data-stu-id="54482-156">The runbook that we created is still in Draft mode.</span></span> <span data-ttu-id="54482-157">È necessario pubblicarlo prima di poterlo eseguire in produzione.</span><span class="sxs-lookup"><span data-stu-id="54482-157">We need to publish it before we can run it in production.</span></span>  <span data-ttu-id="54482-158">Quando si pubblica un runbook, è possibile sovrascrivere la versione pubblicata esistente con la versione bozza.</span><span class="sxs-lookup"><span data-stu-id="54482-158">When you publish a runbook, you overwrite the existing Published version with the Draft version.</span></span>  <span data-ttu-id="54482-159">In questo caso, non esiste ancora una versione pubblicata perché il runbook è appena stato creato.</span><span class="sxs-lookup"><span data-stu-id="54482-159">In our case, we don't have a Published version yet because we just created the runbook.</span></span>

1. <span data-ttu-id="54482-160">Fare clic su **Pubblica** per pubblicare il runbook, quindi su **Sì** quando richiesto.</span><span class="sxs-lookup"><span data-stu-id="54482-160">Click **Publish** to publish the runbook and then **Yes** when prompted.</span></span><br><br> <span data-ttu-id="54482-161">![Pulsante Publish](media/automation-first-runbook-textual-powershell/automation-runbook-edit-controls-publish.png)</span><span class="sxs-lookup"><span data-stu-id="54482-161">![Publish button](media/automation-first-runbook-textual-powershell/automation-runbook-edit-controls-publish.png)</span></span>  
2. <span data-ttu-id="54482-162">Se ora si scorre verso sinistra per visualizzare il runbook nel pannello **Runbook**, come **Stato di creazione** viene visualizzato **Pubblicato**.</span><span class="sxs-lookup"><span data-stu-id="54482-162">If you scroll left to view the runbook in the **Runbooks** pane now, it will show an **Authoring Status** of **Published**.</span></span>
3. <span data-ttu-id="54482-163">Scorrere verso destra per visualizzare il riquadro **MyFirstRunbook-PowerShell**.</span><span class="sxs-lookup"><span data-stu-id="54482-163">Scroll back to the right to view the pane for **MyFirstRunbook-PowerShell**.</span></span>  
   <span data-ttu-id="54482-164">Le opzioni nella parte superiore consentono di avviare il runbook, visualizzarlo, pianificarlo per l'avvio in un momento successivo o creare un [webhook](automation-webhooks.md) per poterlo avviare con una chiamata HTTP.</span><span class="sxs-lookup"><span data-stu-id="54482-164">The options across the top allow us to start the runbook, view the runbook, schedule it to start at some time in the future, or create a [webhook](automation-webhooks.md) so it can be started through an HTTP call.</span></span>
4. <span data-ttu-id="54482-165">Per avviare il runbook, fare clic su **Avvia** e quindi su **OK** quando si apre il pannello Avvia runbook.</span><span class="sxs-lookup"><span data-stu-id="54482-165">We want to start the runbook, so click **Start** and then click **Ok** when the Start Runbook blade opens.</span></span><br><br> <span data-ttu-id="54482-166">![Pulsante Avvia](media/automation-first-runbook-textual-powershell/automation-runbook-controls-start.png)</span><span class="sxs-lookup"><span data-stu-id="54482-166">![Start button](media/automation-first-runbook-textual-powershell/automation-runbook-controls-start.png)</span></span><br>    
5. <span data-ttu-id="54482-167">Verrà aperto un pannello per il processo del runbook creato.</span><span class="sxs-lookup"><span data-stu-id="54482-167">A job pane is opened for the runbook job that we created.</span></span> <span data-ttu-id="54482-168">È possibile chiudere questo riquadro, ma in questo caso lo si lascerà aperto per poter controllare lo stato del processo.</span><span class="sxs-lookup"><span data-stu-id="54482-168">We can close this pane, but in this case we leave it open so we can watch the job's progress.</span></span>
6. <span data-ttu-id="54482-169">Lo stato del processo è visualizzato in **Riepilogo processi** e corrisponde agli stati osservati quando è stato testato il runbook.</span><span class="sxs-lookup"><span data-stu-id="54482-169">The job status is shown in **Job Summary** and matches the statuses that we saw when we tested the runbook.</span></span><br><br> <span data-ttu-id="54482-170">![Riepilogo processi](media/automation-first-runbook-textual-powershell/job-pane-status-blade-jobsummary.png)</span><span class="sxs-lookup"><span data-stu-id="54482-170">![Job Summary](media/automation-first-runbook-textual-powershell/job-pane-status-blade-jobsummary.png)</span></span><br>  
7. <span data-ttu-id="54482-171">Quando lo stato del runbook risulta *Completato*fare clic su **Output**.</span><span class="sxs-lookup"><span data-stu-id="54482-171">Once the runbook status shows *Completed*, click **Output**.</span></span> <span data-ttu-id="54482-172">Viene aperto il pannello Output dove si può vedere il testo *Hello World*.</span><span class="sxs-lookup"><span data-stu-id="54482-172">The Output pane is opened, and we can see our *Hello World*.</span></span><br><br> <span data-ttu-id="54482-173">![Output processo](media/automation-first-runbook-textual-powershell/job-pane-status-blade-outputtile.png)</span><span class="sxs-lookup"><span data-stu-id="54482-173">![Job Output](media/automation-first-runbook-textual-powershell/job-pane-status-blade-outputtile.png)</span></span><br> 
8. <span data-ttu-id="54482-174">Chiudere il riquadro Output.</span><span class="sxs-lookup"><span data-stu-id="54482-174">Close the Output pane.</span></span>
9. <span data-ttu-id="54482-175">Fare clic su **Tutti i log** per aprire il riquadro Flussi relativo al processo del runbook.</span><span class="sxs-lookup"><span data-stu-id="54482-175">Click **All Logs** to open the Streams pane for the runbook job.</span></span> <span data-ttu-id="54482-176">Nel flusso di output dovrebbe essere visibile solo *Hello World* , ma potrebbero essere visualizzati altri flussi per un processo del runbook, ad esempio Verbose ed Error se il runbook scrive in questi flussi.</span><span class="sxs-lookup"><span data-stu-id="54482-176">We should only see *Hello World* in the output stream, but this can show other streams for a runbook job such as Verbose and Error if the runbook writes to them.</span></span><br><br> <span data-ttu-id="54482-177">![Tutti i log](media/automation-first-runbook-textual-powershell/job-pane-status-blade-alllogstile.png)</span><span class="sxs-lookup"><span data-stu-id="54482-177">![All Logs](media/automation-first-runbook-textual-powershell/job-pane-status-blade-alllogstile.png)</span></span><br>   
10. <span data-ttu-id="54482-178">Chiudere il riquadro Flussi e il riquadro dei processi per tornare al riquadro MyFirstRunbook-PowerShell.</span><span class="sxs-lookup"><span data-stu-id="54482-178">Close the Streams pane and the Job pane to return to the MyFirstRunbook-PowerShell pane.</span></span>
11. <span data-ttu-id="54482-179">Fare clic su **Processi** per aprire il pannello dei processi per questo runbook.</span><span class="sxs-lookup"><span data-stu-id="54482-179">Click **Jobs** to open the Jobs pane for this runbook.</span></span> <span data-ttu-id="54482-180">Sono elencati tutti i processi creati da questo runbook.</span><span class="sxs-lookup"><span data-stu-id="54482-180">This lists all of the jobs created by this runbook.</span></span> <span data-ttu-id="54482-181">Dovrebbe essere elencato un solo processo, perché il processo è stato eseguito una sola volta.</span><span class="sxs-lookup"><span data-stu-id="54482-181">We should only see one job listed since we only ran the job once.</span></span><br><br> <span data-ttu-id="54482-182">![Elenco processi](media/automation-first-runbook-textual-powershell/runbook-control-job-tile.png)</span><span class="sxs-lookup"><span data-stu-id="54482-182">![Job List](media/automation-first-runbook-textual-powershell/runbook-control-job-tile.png)</span></span>  
12. <span data-ttu-id="54482-183">È possibile fare clic su questo processo per aprire lo stesso pannello visualizzato quando è stato avviato il runbook.</span><span class="sxs-lookup"><span data-stu-id="54482-183">You can click this job to open the same Job pane that we viewed when we started the runbook.</span></span> <span data-ttu-id="54482-184">In questo modo è possibile tornare indietro nel tempo e visualizzare i dettagli di tutti i processi creati per un runbook particolare.</span><span class="sxs-lookup"><span data-stu-id="54482-184">This allows you to go back in time and view the details of any job that was created for a particular runbook.</span></span>

## <a name="step-5---add-authentication-to-manage-azure-resources"></a><span data-ttu-id="54482-185">Passaggio 5: Aggiungere l'autenticazione per gestire le risorse di Azure</span><span class="sxs-lookup"><span data-stu-id="54482-185">Step 5 - Add authentication to manage Azure resources</span></span>
<span data-ttu-id="54482-186">Il runbook è stato testato e pubblicato, ma finora non esegue alcuna attività utile.</span><span class="sxs-lookup"><span data-stu-id="54482-186">We've tested and published our runbook, but so far it doesn't do anything useful.</span></span> <span data-ttu-id="54482-187">Si vuole fare in modo che gestisca le risorse di Azure.</span><span class="sxs-lookup"><span data-stu-id="54482-187">We want to have it manage Azure resources.</span></span> <span data-ttu-id="54482-188">Sarà tuttavia in grado di eseguire questa operazione solo dopo aver fatto in modo che esegua l'autenticazione con le credenziali indicate nei [prerequisiti](#prerequisites).</span><span class="sxs-lookup"><span data-stu-id="54482-188">It won't be able to do that though unless we have it authenticate using the credentials that are referred to in the [prerequisites](#prerequisites).</span></span> <span data-ttu-id="54482-189">A questo scopo si userà il cmdlet **Add-AzureRmAccount** .</span><span class="sxs-lookup"><span data-stu-id="54482-189">We do that with the **Add-AzureRmAccount** cmdlet.</span></span>

1. <span data-ttu-id="54482-190">Aprire l'editor di testo facendo clic su **Modifica** nel riquadro MyFirstRunbook-PowerShell.</span><span class="sxs-lookup"><span data-stu-id="54482-190">Open the textual editor by clicking **Edit** on the MyFirstRunbook-PowerShell pane.</span></span><br><br> <span data-ttu-id="54482-191">![Modifica runbook](media/automation-first-runbook-textual-powershell/automation-runbook-controls-edit.png)</span><span class="sxs-lookup"><span data-stu-id="54482-191">![Edit Runbook](media/automation-first-runbook-textual-powershell/automation-runbook-controls-edit.png)</span></span><br>   
2. <span data-ttu-id="54482-192">Non è più necessaria la riga **Write-Output** , quindi andare avanti ed eliminarla.</span><span class="sxs-lookup"><span data-stu-id="54482-192">We don't need the **Write-Output** line anymore, so go ahead and delete it.</span></span>
3. <span data-ttu-id="54482-193">Digitare o copiare e incollare il codice seguente che gestisce l'autenticazione con l'account RunAs di Automazione:</span><span class="sxs-lookup"><span data-stu-id="54482-193">Type or copy and paste the following code that handles the authentication with your Automation Run As account:</span></span>
   
   ```
   $Conn = Get-AutomationConnection -Name AzureRunAsConnection
   Add-AzureRMAccount -ServicePrincipal -Tenant $Conn.TenantID `
   -ApplicationId $Conn.ApplicationID -CertificateThumbprint $Conn.CertificateThumbprint
   ```
   <br>
4. <span data-ttu-id="54482-194">Fare clic sul **Pannello di test** in modo da testare il runbook.</span><span class="sxs-lookup"><span data-stu-id="54482-194">Click **Test pane** so that we can test the runbook.</span></span>
5. <span data-ttu-id="54482-195">Fare clic su **Avvia** per avviare il test.</span><span class="sxs-lookup"><span data-stu-id="54482-195">Click **Start** to start the test.</span></span> <span data-ttu-id="54482-196">Al termine verrà visualizzato un output simile al seguente, con le informazioni di base sull'account.</span><span class="sxs-lookup"><span data-stu-id="54482-196">Once it completes, you should receive output similar to the following, displaying basic information from your account.</span></span> <span data-ttu-id="54482-197">Questo conferma che la credenziale è valida.</span><span class="sxs-lookup"><span data-stu-id="54482-197">This confirms that the credential is valid.</span></span><br><br> <span data-ttu-id="54482-198">![Autentica](media/automation-first-runbook-textual-powershell/runbook-auth-output.png)</span><span class="sxs-lookup"><span data-stu-id="54482-198">![Authenticate](media/automation-first-runbook-textual-powershell/runbook-auth-output.png)</span></span>

## <a name="step-6---add-code-to-start-a-virtual-machine"></a><span data-ttu-id="54482-199">Passaggio 6 - aggiungere il codice per avviare una macchina virtuale</span><span class="sxs-lookup"><span data-stu-id="54482-199">Step 6 - Add code to start a virtual machine</span></span>
<span data-ttu-id="54482-200">Ora che il runbook esegue l'autenticazione per la sottoscrizione di Azure è possibile gestire le risorse.</span><span class="sxs-lookup"><span data-stu-id="54482-200">Now that our runbook is authenticating to our Azure subscription, we can manage resources.</span></span> <span data-ttu-id="54482-201">Si aggiunge un comando per avviare una macchina virtuale.</span><span class="sxs-lookup"><span data-stu-id="54482-201">We add a command to start a virtual machine.</span></span> <span data-ttu-id="54482-202">È possibile selezionare una macchina virtuale qualsiasi nella sottoscrizione di Azure. Per ora il nome sarà hardcoded nel runbook.</span><span class="sxs-lookup"><span data-stu-id="54482-202">You can pick any virtual machine in your Azure subscription, and for now we will hardcode that name in the runbook.</span></span>

1. <span data-ttu-id="54482-203">Dopo *Add-AzureRmAccount* digitare *Start-AzureRmVM -Name 'VMName' -ResourceGroupName 'NameofResourceGroup'* specificando il nome e il nome del gruppo di risorse della macchina virtuale da avviare.</span><span class="sxs-lookup"><span data-stu-id="54482-203">After *Add-AzureRmAccount*, type *Start-AzureRmVM -Name 'VMName' -ResourceGroupName 'NameofResourceGroup'* providing the name and Resource Group name of the virtual machine to start.</span></span>  
   
   ```
   $Conn = Get-AutomationConnection -Name AzureRunAsConnection
   Add-AzureRMAccount -ServicePrincipal -Tenant $Conn.TenantID `
   -ApplicationID $Conn.ApplicationID -CertificateThumbprint $Conn.CertificateThumbprint
   Start-AzureRmVM -Name 'VMName' -ResourceGroupName 'ResourceGroupName'
   ```
   <br>
2. <span data-ttu-id="54482-204">Salvare il runbook e poi fare clic su **Pannello di Test** in modo da poterne eseguire il test.</span><span class="sxs-lookup"><span data-stu-id="54482-204">Save the runbook and then click **Test pane** so that we can test it.</span></span>
3. <span data-ttu-id="54482-205">Fare clic su **Avvia** per avviare il test.</span><span class="sxs-lookup"><span data-stu-id="54482-205">Click **Start** to start the test.</span></span> <span data-ttu-id="54482-206">Dopo aver completato l'attività, controllare che la macchina virtuale sia stata avviata.</span><span class="sxs-lookup"><span data-stu-id="54482-206">Once it completes, check that the virtual machine was started.</span></span>

## <a name="step-7---add-an-input-parameter-to-the-runbook"></a><span data-ttu-id="54482-207">Passaggio 7: Aggiungere un parametro di input al runbook</span><span class="sxs-lookup"><span data-stu-id="54482-207">Step 7 - Add an input parameter to the runbook</span></span>
<span data-ttu-id="54482-208">Ora il runbook avvia la macchina virtuale impostata come hardcoded nel runbook, ma sarebbe più utile specificare la macchina virtuale quando si avvia il runbook.</span><span class="sxs-lookup"><span data-stu-id="54482-208">Our runbook currently starts the virtual machine that we hardcoded in the runbook, but it would be more useful if we specify the virtual machine when the runbook is started.</span></span> <span data-ttu-id="54482-209">Per fornire questa funzionalità, ora si aggiungeranno dei parametri di input al runbook.</span><span class="sxs-lookup"><span data-stu-id="54482-209">We will now add input parameters to the runbook to provide that functionality.</span></span>

1. <span data-ttu-id="54482-210">Aggiungere parametri per *VMName* e *ResourceGroupName* al runbook e usare queste variabili con il cmdlet **Start-AzureRmVM** come nell'esempio seguente.</span><span class="sxs-lookup"><span data-stu-id="54482-210">Add parameters for *VMName* and *ResourceGroupName* to the runbook and use these variables with the **Start-AzureRmVM** cmdlet as in the example below.</span></span>  
   
   ```
   Param(
    [string]$VMName,
    [string]$ResourceGroupName
   )
   $Conn = Get-AutomationConnection -Name AzureRunAsConnection
   Add-AzureRMAccount -ServicePrincipal -Tenant $Conn.TenantID `
   -ApplicationID $Conn.ApplicationID -CertificateThumbprint $Conn.CertificateThumbprint
   Start-AzureRmVM -Name $VMName -ResourceGroupName $ResourceGroupName
   ```
   <br>
2. <span data-ttu-id="54482-211">Salvare il runbook e aprire il riquadro Test.</span><span class="sxs-lookup"><span data-stu-id="54482-211">Save the runbook and open the Test pane.</span></span> <span data-ttu-id="54482-212">È ora possibile fornire i valori per le due variabili di input usate nel test.</span><span class="sxs-lookup"><span data-stu-id="54482-212">You can now provide values for the two input variables that are used in the test.</span></span>
3. <span data-ttu-id="54482-213">Chiudere il riquadro Test.</span><span class="sxs-lookup"><span data-stu-id="54482-213">Close the Test pane.</span></span>
4. <span data-ttu-id="54482-214">Fare clic su **Pubblica** per pubblicare la nuova versione del runbook.</span><span class="sxs-lookup"><span data-stu-id="54482-214">Click **Publish** to publish the new version of the runbook.</span></span>
5. <span data-ttu-id="54482-215">Arrestare la macchina virtuale avviata nel passaggio precedente.</span><span class="sxs-lookup"><span data-stu-id="54482-215">Stop the virtual machine that you started in the previous step.</span></span>
6. <span data-ttu-id="54482-216">Fare clic su **Avvia** per avviare il runbook.</span><span class="sxs-lookup"><span data-stu-id="54482-216">Click **Start** to start the runbook.</span></span> <span data-ttu-id="54482-217">Digitare **VMName** e **ResourceGroupName** per la macchina virtuale da avviare.</span><span class="sxs-lookup"><span data-stu-id="54482-217">Type in the **VMName** and **ResourceGroupName** for the virtual machine that you're going to start.</span></span><br><br> <span data-ttu-id="54482-218">![Passare i parametri](media/automation-first-runbook-textual-powershell/automation-pass-params.png)</span><span class="sxs-lookup"><span data-stu-id="54482-218">![Pass Parameter](media/automation-first-runbook-textual-powershell/automation-pass-params.png)</span></span><br>  
7. <span data-ttu-id="54482-219">Quando il runbook viene completato, controllare che la macchina virtuale sia stata avviata.</span><span class="sxs-lookup"><span data-stu-id="54482-219">When the runbook completes, check that the virtual machine was started.</span></span>

## <a name="differences-from-powershell-workflow"></a><span data-ttu-id="54482-220">Differenze rispetto al flusso di lavoro PowerShell</span><span class="sxs-lookup"><span data-stu-id="54482-220">Differences from PowerShell Workflow</span></span>
<span data-ttu-id="54482-221">I runbook PowerShell hanno lo stesso ciclo di vita, le stesse funzionalità e la stessa modalità di gestione dei runbook Flusso di lavoro PowerShell, ma con alcune differenze e limitazioni:</span><span class="sxs-lookup"><span data-stu-id="54482-221">PowerShell runbooks have the same lifecycle, capabilities, and management as PowerShell Workflow runbooks but there are some differences and limitations:</span></span>

1. <span data-ttu-id="54482-222">L'esecuzione dei runbook PowerShell è più rapida rispetto ai runbook Flusso di lavoro PowerShell, perché non prevedono un passaggio di compilazione.</span><span class="sxs-lookup"><span data-stu-id="54482-222">PowerShell runbooks run fast compared to PowerShell Workflow runbooks as they don’t have compilation step.</span></span>
2. <span data-ttu-id="54482-223">Grazie al supporto dei checkpoint, i runbook Flusso di lavoro PowerShell possono riprendere da qualsiasi punto del runbook, mentre i runbook PowerShell possono riprendere solo dall'inizio.</span><span class="sxs-lookup"><span data-stu-id="54482-223">PowerShell Workflow runbooks support checkpoints, using checkpoints, PowerShell Workflow runbooks can resume from any point in the runbook whereas PowerShell runbooks can only resume from the beginning.</span></span>
3. <span data-ttu-id="54482-224">I runbook Flusso di lavoro PowerShell supportano l'esecuzione seriale e parallela, mentre i runbook PowerShell possono eseguire i comandi solo in modo seriale.</span><span class="sxs-lookup"><span data-stu-id="54482-224">PowerShell Workflow runbooks support parallel and serial execution whereas PowerShell runbooks can only execute commands serially.</span></span>
4. <span data-ttu-id="54482-225">In un runbook Flusso di lavoro PowerShell un'attività, un comando o un blocco di script può avere un proprio spazio di esecuzione, mentre in un runbook PowerShell tutti gli elementi in uno script vengono eseguiti in un singolo spazio di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="54482-225">In a PowerShell Workflow runbook, an activity, a command, or a script block can have its own runspace whereas in a PowerShell runbook, everything in a script runs in a single runspace.</span></span> <span data-ttu-id="54482-226">Esistono anche [differenze di sintassi](https://technet.microsoft.com/magazine/dn151046.aspx) tra un runbook PowerShell nativo e un runbook Flusso di lavoro PowerShell.</span><span class="sxs-lookup"><span data-stu-id="54482-226">There are also some [syntactic differences](https://technet.microsoft.com/magazine/dn151046.aspx) between a native PowerShell runbook and a PowerShell Workflow runbook.</span></span>

## <a name="next-steps"></a><span data-ttu-id="54482-227">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="54482-227">Next steps</span></span>
* <span data-ttu-id="54482-228">Per iniziare a usare runbook grafici, vedere [Il primo runbook grafico](automation-first-runbook-graphical.md)</span><span class="sxs-lookup"><span data-stu-id="54482-228">To get started with Graphical runbooks, see [My first graphical runbook](automation-first-runbook-graphical.md)</span></span>
* <span data-ttu-id="54482-229">Per iniziare a usare i runbook del flusso di lavoro PowerShell, vedere [Il primo runbook del flusso di lavoro PowerShell](automation-first-runbook-textual.md)</span><span class="sxs-lookup"><span data-stu-id="54482-229">To get started with PowerShell workflow runbooks, see [My first PowerShell workflow runbook](automation-first-runbook-textual.md)</span></span>
* <span data-ttu-id="54482-230">Per altre informazioni sui tipi di runbook, i relativi vantaggi e le limitazioni, vedere [Tipi di runbook di Automazione di Azure](automation-runbook-types.md)</span><span class="sxs-lookup"><span data-stu-id="54482-230">To know more about runbook types, their advantages and limitations, see [Azure Automation runbook types](automation-runbook-types.md)</span></span>
* <span data-ttu-id="54482-231">Per altre informazioni sulla funzionalità di supporto degli script PowerShell, vedere il blog relativo al [supporto di script PowerShell nativi in Automazione di Azure](https://azure.microsoft.com/blog/announcing-powershell-script-support-azure-automation-2/)</span><span class="sxs-lookup"><span data-stu-id="54482-231">For more information on PowerShell script support feature, see [Native PowerShell script support in Azure Automation](https://azure.microsoft.com/blog/announcing-powershell-script-support-azure-automation-2/)</span></span>

