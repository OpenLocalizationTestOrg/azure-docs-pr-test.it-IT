---
title: Creare code e argomenti partizionati del bus di servizio di Azure | Microsoft Docs
description: "Descrive come partizionare code e argomenti del bus di servizio usando più broker messaggi."
services: service-bus-messaging
documentationcenter: na
author: sethmanheim
manager: timlt
editor: 
ms.assetid: a0c7d5a2-4876-42cb-8344-a1fc988746e7
ms.service: service-bus-messaging
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 08/07/2017
ms.author: sethm;hillaryc
ms.openlocfilehash: 5a4e69ea7e13cb017f8fb432c524c6a8ce9228a8
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/18/2017
---
# <a name="partitioned-queues-and-topics"></a><span data-ttu-id="36489-103">Code e argomenti partizionati</span><span class="sxs-lookup"><span data-stu-id="36489-103">Partitioned queues and topics</span></span>
<span data-ttu-id="36489-104">Il bus di servizio di Azure usa più broker messaggi per elaborare i messaggi e più archivi di messaggistica per archiviarli.</span><span class="sxs-lookup"><span data-stu-id="36489-104">Azure Service Bus employs multiple message brokers to process messages and multiple messaging stores to store messages.</span></span> <span data-ttu-id="36489-105">Una coda o un argomento convenzionale è gestito da un singolo broker messaggi e archiviato in un archivio di messaggistica.</span><span class="sxs-lookup"><span data-stu-id="36489-105">A conventional queue or topic is handled by a single message broker and stored in one messaging store.</span></span> <span data-ttu-id="36489-106">Le *partizioni* del bus di servizio consentono il partizionamento di code e argomenti, o *entità di messaggistica*, tra più broker messaggi e archivi di messaggistica.</span><span class="sxs-lookup"><span data-stu-id="36489-106">Service Bus *partitions* enable queues and topics, or *messaging entities*, to be partitioned across multiple message brokers and messaging stores.</span></span> <span data-ttu-id="36489-107">Questo significa che la velocità effettiva complessiva di un'entità partizionata non è più limitata dalle prestazioni di un singolo broker messaggi o archivio di messaggistica.</span><span class="sxs-lookup"><span data-stu-id="36489-107">This means that the overall throughput of a partitioned entity is no longer limited by the performance of a single message broker or messaging store.</span></span> <span data-ttu-id="36489-108">Inoltre, un'interruzione temporanea dell'alimentazione di un archivio di messaggistica non determina la mancanza di disponibilità di una coda o di un argomento partizionato.</span><span class="sxs-lookup"><span data-stu-id="36489-108">In addition, a temporary outage of a messaging store does not render a partitioned queue or topic unavailable.</span></span> <span data-ttu-id="36489-109">Le code e gli argomenti partizionati possono contenere tutte le funzionalità avanzate del bus di servizio, ad esempio il supporto delle transazioni e delle sessioni.</span><span class="sxs-lookup"><span data-stu-id="36489-109">Partitioned queues and topics can contain all advanced Service Bus features, such as support for transactions and sessions.</span></span>

<span data-ttu-id="36489-110">Per informazioni sugli elementi interni del bus di servizio, vedere l'articolo [Architettura del bus di servizio][Service Bus architecture].</span><span class="sxs-lookup"><span data-stu-id="36489-110">For information about Service Bus internals, see the [Service Bus architecture][Service Bus architecture] article.</span></span>

<span data-ttu-id="36489-111">Il partizionamento è abilitato per impostazione predefinita al momento della creazione dell'entità in tutte le code e tutti gli argomenti della messaggistica sia Standard che Premium.</span><span class="sxs-lookup"><span data-stu-id="36489-111">Partitioning is enabled by default at entity creation on all queues and topics in both Standard and Premium messaging.</span></span> <span data-ttu-id="36489-112">È possibile creare entità di livello messaggistica Standard senza il partizionamento, ma le code e gli argomenti in uno spazio dei nomi Premium vengono sempre partizionati. Questa opzione non può essere disabilitata.</span><span class="sxs-lookup"><span data-stu-id="36489-112">You can create Standard messaging tier entities without partitioning, but queues and topics in a Premium namespace are always partitioned; this option cannot be disabled.</span></span> 

<span data-ttu-id="36489-113">Non è possibile modificare l'opzione di partizionamento su una coda o un argomento esistente nei livelli Standard o Premium. L'opzione può essere impostata solo in fase di creazione dell'entità.</span><span class="sxs-lookup"><span data-stu-id="36489-113">It is not possible to change the partitioning option on an existing queue or topic in either Standard or Premium tiers, you can only set the option when you create the entity.</span></span>

## <a name="how-it-works"></a><span data-ttu-id="36489-114">Funzionamento</span><span class="sxs-lookup"><span data-stu-id="36489-114">How it works</span></span>

<span data-ttu-id="36489-115">Ogni coda o argomento partizionato è costituito da più frammenti.</span><span class="sxs-lookup"><span data-stu-id="36489-115">Each partitioned queue or topic consists of multiple fragments.</span></span> <span data-ttu-id="36489-116">Ogni frammento viene memorizzato in un archivio di messaggistica differente e gestito da un broker messaggi diverso.</span><span class="sxs-lookup"><span data-stu-id="36489-116">Each fragment is stored in a different messaging store and handled by a different message broker.</span></span> <span data-ttu-id="36489-117">Quando un messaggio viene inviato a una coda o a un argomento partizionato, il bus di servizio assegna il messaggio a uno dei frammenti.</span><span class="sxs-lookup"><span data-stu-id="36489-117">When a message is sent to a partitioned queue or topic, Service Bus assigns the message to one of the fragments.</span></span> <span data-ttu-id="36489-118">La selezione viene eseguita in modo casuale dal bus di servizio o tramite una chiave di partizione che può essere specificata dal mittente.</span><span class="sxs-lookup"><span data-stu-id="36489-118">The selection is done randomly by Service Bus or by using a partition key that the sender can specify.</span></span>

<span data-ttu-id="36489-119">Quando un client vuole ricevere un messaggio da una coda partizionata o da una sottoscrizione a un argomento partizionato, il bus di servizio esegue query su tutti i frammenti dei messaggi, quindi restituisce al ricevitore il primo messaggio ottenuto dagli archivi di messaggistica.</span><span class="sxs-lookup"><span data-stu-id="36489-119">When a client wants to receive a message from a partitioned queue, or from a subscription to a partitioned topic, Service Bus queries all fragments for messages, then returns the first message that is obtained from any of the messaging stores to the receiver.</span></span> <span data-ttu-id="36489-120">Il bus di servizio memorizza nella cache gli altri messaggi e li restituisce quando riceve altre richieste.</span><span class="sxs-lookup"><span data-stu-id="36489-120">Service Bus caches the other messages and returns them when it receives additional receive requests.</span></span> <span data-ttu-id="36489-121">Un client destinatario non è a conoscenza del partizionamento; il comportamento verso il client di una coda o un argomento partizionato (ad esempio lettura, completamento, rinvio, non recapitabilità, prelettura) è identico a quello di un'entità normale.</span><span class="sxs-lookup"><span data-stu-id="36489-121">A receiving client is not aware of the partitioning; the client-facing behavior of a partitioned queue or topic (for example, read, complete, defer, deadletter, prefetching) is identical to the behavior of a regular entity.</span></span>

<span data-ttu-id="36489-122">I messaggi a una coda o a un argomento partizionato non presentano costi aggiuntivi, né in invio né in ricezione.</span><span class="sxs-lookup"><span data-stu-id="36489-122">There is no additional cost when sending a message to, or receiving a message from, a partitioned queue or topic.</span></span>

## <a name="enable-partitioning"></a><span data-ttu-id="36489-123">Abilitare il partizionamento</span><span class="sxs-lookup"><span data-stu-id="36489-123">Enable partitioning</span></span>

<span data-ttu-id="36489-124">Per usare le code e gli argomenti partizionati con il bus di servizio di Azure, è necessario usare Azure SDK 2.2 o versione successiva oppure specificare `api-version=2013-10` nelle richieste HTTP.</span><span class="sxs-lookup"><span data-stu-id="36489-124">To use partitioned queues and topics with Azure Service Bus, use the Azure SDK version 2.2 or later, or specify `api-version=2013-10` in your HTTP requests.</span></span>

### <a name="standard"></a><span data-ttu-id="36489-125">Standard</span><span class="sxs-lookup"><span data-stu-id="36489-125">Standard</span></span>

<span data-ttu-id="36489-126">A livello di messaggistica Standard, è possibile creare code e argomenti del bus di servizio in dimensioni di 1, 2, 3, 4 o 5 GB (il valore predefinito è 1 GB).</span><span class="sxs-lookup"><span data-stu-id="36489-126">In the Standard messaging tier, you can create Service Bus queues and topics in 1, 2, 3, 4, or 5 GB sizes (the default is 1 GB).</span></span> <span data-ttu-id="36489-127">Con il partizionamento abilitato, il bus di servizio crea 16 copie (16 partizioni) per ogni GB specificato.</span><span class="sxs-lookup"><span data-stu-id="36489-127">With partitioning enabled, Service Bus creates 16 copies (16 partitions) of the entity for each GB you specify.</span></span> <span data-ttu-id="36489-128">Di conseguenza, se si crea una coda con dimensioni pari a 5 GB, con 16 partizioni le dimensioni massime della coda diventano di 80 GB (5 \* 16).</span><span class="sxs-lookup"><span data-stu-id="36489-128">As such, if you create a queue that's 5 GB in size, with 16 partitions the maximum queue size becomes (5 \* 16) = 80 GB.</span></span> <span data-ttu-id="36489-129">È possibile vedere le dimensioni massime della coda o dell'argomento partizionato esaminando la voce corrispondente nel [portale di Azure][Azure portal], nel pannello **Panoramica** relativo all'entità.</span><span class="sxs-lookup"><span data-stu-id="36489-129">You can see the maximum size of your partitioned queue or topic by looking at its entry on the [Azure portal][Azure portal], in the **Overview** blade for that entity.</span></span>

### <a name="premium"></a><span data-ttu-id="36489-130">Premium</span><span class="sxs-lookup"><span data-stu-id="36489-130">Premium</span></span>

<span data-ttu-id="36489-131">Nello spazio dei nomi di livello Premium, è possibile creare code e argomenti del bus di servizio in dimensioni di 1, 2, 3, 4, 5, 10, 20, 40 o 80 GB (il valore predefinito è 1 GB).</span><span class="sxs-lookup"><span data-stu-id="36489-131">In a Premium tier namespace, you can create Service Bus queues and topics in 1, 2, 3, 4, 5, 10, 20, 40, or 80 GB sizes (the default is 1 GB).</span></span> <span data-ttu-id="36489-132">Con il partizionamento abilitato per impostazione predefinita, il bus di servizio crea due partizioni per ogni entità.</span><span class="sxs-lookup"><span data-stu-id="36489-132">With partitioning enabled by default, Service Bus creates two partitions per entity.</span></span> <span data-ttu-id="36489-133">È possibile vedere le dimensioni massime della coda o dell'argomento partizionato esaminando la voce corrispondente nel [portale di Azure][Azure portal], nel pannello **Panoramica** relativo all'entità.</span><span class="sxs-lookup"><span data-stu-id="36489-133">You can see the maximum size of your partitioned queue or topic by looking at its entry on the [Azure portal][Azure portal], in the **Overview** blade for that entity.</span></span>

<span data-ttu-id="36489-134">Per altre informazioni sul partizionamento nel livello di messaggistica Premium, vedere [Livelli di messaggistica Standard e Premium del bus di servizio](service-bus-premium-messaging.md).</span><span class="sxs-lookup"><span data-stu-id="36489-134">For more information about partitioning in the Premium messaging tier, see [Service Bus Premium and Standard messaging tiers](service-bus-premium-messaging.md).</span></span> 

### <a name="create-a-partitioned-entity"></a><span data-ttu-id="36489-135">Creare una tabella partizionata</span><span class="sxs-lookup"><span data-stu-id="36489-135">Create a partitioned entity</span></span>

<span data-ttu-id="36489-136">Sono disponibili vari modi per creare una coda o un argomento partizionato.</span><span class="sxs-lookup"><span data-stu-id="36489-136">There are several ways to create a partitioned queue or topic.</span></span> <span data-ttu-id="36489-137">Quando si crea la coda o l'argomento dalla propria applicazione, è possibile abilitare il partizionamento per la coda o l'argomento impostando, rispettivamente, la proprietà [QueueDescription.EnablePartitioning][QueueDescription.EnablePartitioning] o [TopicDescription.EnablePartitioning][TopicDescription.EnablePartitioning] su **true**.</span><span class="sxs-lookup"><span data-stu-id="36489-137">When you create the queue or topic from your application, you can enable partitioning for the queue or topic by respectively setting the [QueueDescription.EnablePartitioning][QueueDescription.EnablePartitioning] or [TopicDescription.EnablePartitioning][TopicDescription.EnablePartitioning] property to **true**.</span></span> <span data-ttu-id="36489-138">Queste proprietà devono essere impostate al momento della creazione della coda o dell'argomento.</span><span class="sxs-lookup"><span data-stu-id="36489-138">These properties must be set at the time the queue or topic is created.</span></span> <span data-ttu-id="36489-139">Come detto in precedenza, non è possibile modificare queste proprietà in una coda o in un argomento esistente.</span><span class="sxs-lookup"><span data-stu-id="36489-139">As stated previously, it is not possible to change these properties on an existing queue or topic.</span></span> <span data-ttu-id="36489-140">Ad esempio:</span><span class="sxs-lookup"><span data-stu-id="36489-140">For example:</span></span>

```csharp
// Create partitioned topic
NamespaceManager ns = NamespaceManager.CreateFromConnectionString(myConnectionString);
TopicDescription td = new TopicDescription(TopicName);
td.EnablePartitioning = true;
ns.CreateTopic(td);
```

<span data-ttu-id="36489-141">È possibile, in alternativa, creare una coda o un argomento partizionato nel [portale di Azure][Azure portal] o in Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="36489-141">Alternatively, you can create a partitioned queue or topic in the [Azure portal][Azure portal] or in Visual Studio.</span></span> <span data-ttu-id="36489-142">Quando si crea una coda o un argomento nel portale, l'opzione **Abilita partizionamento** nel pannello **Crea** della coda o dell'argomento è selezionata per impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="36489-142">When you create a queue or topic in the portal, the **Enable partitioning** option in the queue or topic **Create** blade is checked by default.</span></span> <span data-ttu-id="36489-143">L'opzione può essere disabilitata solo in un'entità di livello Standard. Nel livello Premium il partizionamento è sempre abilitato.</span><span class="sxs-lookup"><span data-stu-id="36489-143">You can only disable this option in a Standard tier entity; in the Premium tier partitioning is always enabled.</span></span> <span data-ttu-id="36489-144">In Visual Studio selezionare la casella di controllo **Abilita partizionamento** nella finestra di dialogo **Nuova coda** o **Nuovo argomento**.</span><span class="sxs-lookup"><span data-stu-id="36489-144">In Visual Studio, click the **Enable Partitioning** checkbox in the **New Queue** or **New Topic** dialog box.</span></span>

## <a name="use-of-partition-keys"></a><span data-ttu-id="36489-145">Uso delle chiavi di partizione</span><span class="sxs-lookup"><span data-stu-id="36489-145">Use of partition keys</span></span>
<span data-ttu-id="36489-146">Quando un messaggio viene accodato in una coda o in un argomento partizionato, il bus di servizio controlla la presenza di una chiave di partizione.</span><span class="sxs-lookup"><span data-stu-id="36489-146">When a message is enqueued into a partitioned queue or topic, Service Bus checks for the presence of a partition key.</span></span> <span data-ttu-id="36489-147">Se ne trova una, seleziona il frammento in base a tale chiave.</span><span class="sxs-lookup"><span data-stu-id="36489-147">If it finds one, it selects the fragment based on that key.</span></span> <span data-ttu-id="36489-148">Se invece non trova alcuna chiave di partizione, seleziona il frammento in base a un algoritmo interno.</span><span class="sxs-lookup"><span data-stu-id="36489-148">If it does not find a partition key, it selects the fragment based on an internal algorithm.</span></span>

### <a name="using-a-partition-key"></a><span data-ttu-id="36489-149">Uso di una chiave di partizione</span><span class="sxs-lookup"><span data-stu-id="36489-149">Using a partition key</span></span>
<span data-ttu-id="36489-150">In alcuni scenari, ad esempio le sessioni o le transazioni, i messaggi devono essere archiviati in un frammento specifico.</span><span class="sxs-lookup"><span data-stu-id="36489-150">Some scenarios, such as sessions or transactions, require messages to be stored in a specific fragment.</span></span> <span data-ttu-id="36489-151">Tutti questi scenari richiedono l'uso di una chiave di partizione.</span><span class="sxs-lookup"><span data-stu-id="36489-151">All these scenarios require the use of a partition key.</span></span> <span data-ttu-id="36489-152">Tutti i messaggi che usano la stessa chiave di partizione vengono assegnati allo stesso frammento.</span><span class="sxs-lookup"><span data-stu-id="36489-152">All messages that use the same partition key are assigned to the same fragment.</span></span> <span data-ttu-id="36489-153">Se il frammento è temporaneamente non disponibile, il bus di servizio restituisce un errore.</span><span class="sxs-lookup"><span data-stu-id="36489-153">If the fragment is temporarily unavailable, Service Bus returns an error.</span></span>

<span data-ttu-id="36489-154">In base allo scenario vengono usate come chiave di partizione proprietà dei messaggi diverse:</span><span class="sxs-lookup"><span data-stu-id="36489-154">Depending on the scenario, different message properties are used as a partition key:</span></span>

<span data-ttu-id="36489-155">**SessionId**: se per un messaggio è impostata la proprietà [BrokeredMessage.SessionId][BrokeredMessage.SessionId], il bus di servizio usa questa proprietà come la chiave di partizione.</span><span class="sxs-lookup"><span data-stu-id="36489-155">**SessionId**: If a message has the [BrokeredMessage.SessionId][BrokeredMessage.SessionId] property set, then Service Bus uses this property as the partition key.</span></span> <span data-ttu-id="36489-156">In questo modo, tutti i messaggi appartenenti alla stessa sessione vengono gestiti dallo stesso broker messaggi.</span><span class="sxs-lookup"><span data-stu-id="36489-156">This way, all messages that belong to the same session are handled by the same message broker.</span></span> <span data-ttu-id="36489-157">Questo consente a l bus di servizio di garantire l'ordinamento dei messaggi così come la coerenza degli stati della sessione.</span><span class="sxs-lookup"><span data-stu-id="36489-157">This enables Service Bus to guarantee message ordering as well as the consistency of session states.</span></span>

<span data-ttu-id="36489-158">**PartitionKey**: se per un messaggio è impostata la proprietà [BrokeredMessage.PartitionKey][BrokeredMessage.PartitionKey], ma non la proprietà [BrokeredMessage.SessionId][BrokeredMessage.SessionId], il bus di servizio usa la proprietà [PartitionKey][PartitionKey] come la chiave di partizione.</span><span class="sxs-lookup"><span data-stu-id="36489-158">**PartitionKey**: If a message has the [BrokeredMessage.PartitionKey][BrokeredMessage.PartitionKey] property but not the [BrokeredMessage.SessionId][BrokeredMessage.SessionId] property set, then Service Bus uses the [PartitionKey][PartitionKey] property as the partition key.</span></span> <span data-ttu-id="36489-159">Se per il messaggio sono impostate entrambe le proprietà [SessionId][SessionId] e [PartitionKey][PartitionKey], queste devono avere un valore identico.</span><span class="sxs-lookup"><span data-stu-id="36489-159">If the message has both the [SessionId][SessionId] and the [PartitionKey][PartitionKey] properties set, both properties must be identical.</span></span> <span data-ttu-id="36489-160">Se la proprietà [PartitionKey][PartitionKey] è impostata su un valore diverso rispetto a quello della proprietà [SessionId][SessionId], il bus di servizio restituisce un'eccezione di operazione non valida.</span><span class="sxs-lookup"><span data-stu-id="36489-160">If the [PartitionKey][PartitionKey] property is set to a different value than the [SessionId][SessionId] property, Service Bus returns an invalid operation exception.</span></span> <span data-ttu-id="36489-161">La proprietà [PartitionKey][PartitionKey] deve essere usata se un mittente invia messaggi transazionali non sono in grado di riconoscere le sessioni.</span><span class="sxs-lookup"><span data-stu-id="36489-161">The [PartitionKey][PartitionKey] property should be used if a sender sends non-session aware transactional messages.</span></span> <span data-ttu-id="36489-162">La chiave di partizione assicura che tutti i messaggi inviati all'interno di una transazione vengano gestiti dallo stesso broker di messaggistica.</span><span class="sxs-lookup"><span data-stu-id="36489-162">The partition key ensures that all messages that are sent within a transaction are handled by the same messaging broker.</span></span>

<span data-ttu-id="36489-163">**MessageId**: se per la coda o l'argomento la proprietà [QueueDescription.RequiresDuplicateDetection][QueueDescription.RequiresDuplicateDetection] è impostata su **true** e la proprietà [BrokeredMessage.SessionId][BrokeredMessage.SessionId] o [BrokeredMessage.PartitionKey][BrokeredMessage.PartitionKey] non è impostata, la proprietà [BrokeredMessage.MessageId][BrokeredMessage.MessageId] viene usata come chiave di partizione.</span><span class="sxs-lookup"><span data-stu-id="36489-163">**MessageId**: If the queue or topic has the [QueueDescription.RequiresDuplicateDetection][QueueDescription.RequiresDuplicateDetection] property set to **true** and the [BrokeredMessage.SessionId][BrokeredMessage.SessionId] or [BrokeredMessage.PartitionKey][BrokeredMessage.PartitionKey] properties are not set, then the [BrokeredMessage.MessageId][BrokeredMessage.MessageId] property serves as the partition key.</span></span> <span data-ttu-id="36489-164">(tenere presente che le librerie di Microsoft .NET e AMQP assegnano automaticamente un ID messaggio, se questo non viene assegnato dall'applicazione mittente). In questo caso tutte le copie dello stesso messaggio vengono gestite dallo stesso broker messaggi.</span><span class="sxs-lookup"><span data-stu-id="36489-164">(Note that the Microsoft .NET and AMQP libraries automatically assign a message ID if the sending application does not.) In this case, all copies of the same message are handled by the same message broker.</span></span> <span data-ttu-id="36489-165">Questo consente al bus di servizio di rilevare ed eliminare i messaggi duplicati.</span><span class="sxs-lookup"><span data-stu-id="36489-165">This enables Service Bus to detect and eliminate duplicate messages.</span></span> <span data-ttu-id="36489-166">Se la proprietà [QueueDescription.RequiresDuplicateDetection][QueueDescription.RequiresDuplicateDetection] non è impostata su **true**, il bus di servizio non considera la proprietà [MessageId][MessageId] come chiave di partizione.</span><span class="sxs-lookup"><span data-stu-id="36489-166">If the [QueueDescription.RequiresDuplicateDetection][QueueDescription.RequiresDuplicateDetection] property is not set to **true**, Service Bus does not consider the [MessageId][MessageId] property as a partition key.</span></span>

### <a name="not-using-a-partition-key"></a><span data-ttu-id="36489-167">Senza l'uso di una chiave di partizione</span><span class="sxs-lookup"><span data-stu-id="36489-167">Not using a partition key</span></span>
<span data-ttu-id="36489-168">In assenza di una chiave di partizione, il bus di servizio distribuisce, con un'alternanza di tipo round robin, i messaggi ai frammenti della coda o dell'argomento partizionato.</span><span class="sxs-lookup"><span data-stu-id="36489-168">In the absence of a partition key, Service Bus distributes messages in a round-robin fashion to all the fragments of the partitioned queue or topic.</span></span> <span data-ttu-id="36489-169">Se il frammento scelto non è disponibile, il bus di servizio assegna il messaggio a un altro frammento.</span><span class="sxs-lookup"><span data-stu-id="36489-169">If the chosen fragment is not available, Service Bus assigns the message to a different fragment.</span></span> <span data-ttu-id="36489-170">In questo modo, l'operazione di invio viene completata correttamente indipendentemente dalla disponibilità o meno di un archivio di messaggistica.</span><span class="sxs-lookup"><span data-stu-id="36489-170">This way, the send operation succeeds despite the temporary unavailability of a messaging store.</span></span> <span data-ttu-id="36489-171">Non si otterrà tuttavia l'ordinamento garantito fornito da una chiave di partizione.</span><span class="sxs-lookup"><span data-stu-id="36489-171">However, you will not achieve the guaranteed ordering that a partition key provides.</span></span>

<span data-ttu-id="36489-172">Per un'analisi più approfondita del compromesso tra disponibilità (nessuna chiave di partizione) e coerenza (uso di una chiave di partizione), vedere [questo articolo](../event-hubs/event-hubs-availability-and-consistency.md).</span><span class="sxs-lookup"><span data-stu-id="36489-172">For a more in-depth discussion of the tradeoff between availability (no partition key) and consistency (using a partition key), see [this article](../event-hubs/event-hubs-availability-and-consistency.md).</span></span> <span data-ttu-id="36489-173">Queste informazioni si applicano ugualmente alle entità del bus di servizio partizionate e alle partizioni di Hub eventi.</span><span class="sxs-lookup"><span data-stu-id="36489-173">This information applies equally to partitioned Service Bus entities and Event Hubs partitions.</span></span>

<span data-ttu-id="36489-174">Per concedere al bus di servizio tempo sufficiente per l'accodamento del messaggio in un frammento diverso, il valore [MessagingFactorySettings.OperationTimeout][MessagingFactorySettings.OperationTimeout] specificato dal client che invia il messaggio deve essere maggiore di 15 secondi.</span><span class="sxs-lookup"><span data-stu-id="36489-174">To give Service Bus enough time to enqueue the message into a different fragment, the [MessagingFactorySettings.OperationTimeout][MessagingFactorySettings.OperationTimeout] value specified by the client that sends the message must be greater than 15 seconds.</span></span> <span data-ttu-id="36489-175">È consigliabile impostare la proprietà [OperationTimeout][OperationTimeout] sul valore predefinito di 60 secondi.</span><span class="sxs-lookup"><span data-stu-id="36489-175">It is recommended that you set the [OperationTimeout][OperationTimeout] property to the default value of 60 seconds.</span></span>

<span data-ttu-id="36489-176">Tenere presente che una chiave di partizione "aggiunge" un messaggio a un frammento specifico.</span><span class="sxs-lookup"><span data-stu-id="36489-176">Note that a partition key "pins" a message to a specific fragment.</span></span> <span data-ttu-id="36489-177">Se l'archivio di messaggistica contenente questo frammento non è disponibile, il bus di servizio restituisce un errore.</span><span class="sxs-lookup"><span data-stu-id="36489-177">If the messaging store that holds this fragment is unavailable, Service Bus returns an error.</span></span> <span data-ttu-id="36489-178">In assenza di una chiave di partizione, il bus di servizio può scegliere un frammento diverso e l'operazione verrà completata correttamente.</span><span class="sxs-lookup"><span data-stu-id="36489-178">In the absence of a partition key, Service Bus can choose a different fragment and the operation succeeds.</span></span> <span data-ttu-id="36489-179">È quindi consigliabile non specificare una chiave di partizione, a meno che non sia necessario.</span><span class="sxs-lookup"><span data-stu-id="36489-179">Therefore, it is recommended that you do not supply a partition key unless it is required.</span></span>

## <a name="advanced-topics-use-transactions-with-partitioned-entities"></a><span data-ttu-id="36489-180">Argomenti avanzati: usare le transazioni con entità partizionate</span><span class="sxs-lookup"><span data-stu-id="36489-180">Advanced topics: use transactions with partitioned entities</span></span>
<span data-ttu-id="36489-181">I messaggi inviati come parte di una transazione devono specificare una chiave di partizione.</span><span class="sxs-lookup"><span data-stu-id="36489-181">Messages that are sent as part of a transaction must specify a partition key.</span></span> <span data-ttu-id="36489-182">Tale chiave può essere una delle proprietà seguenti: [BrokeredMessage.SessionId][BrokeredMessage.SessionId], [BrokeredMessage.PartitionKey][BrokeredMessage.PartitionKey] o [BrokeredMessage.MessageId][BrokeredMessage.MessageId].</span><span class="sxs-lookup"><span data-stu-id="36489-182">This can be one of the following properties: [BrokeredMessage.SessionId][BrokeredMessage.SessionId], [BrokeredMessage.PartitionKey][BrokeredMessage.PartitionKey], or [BrokeredMessage.MessageId][BrokeredMessage.MessageId].</span></span> <span data-ttu-id="36489-183">Tutti i messaggi che vengono inviati come parte della stessa transazione devono specificare la stessa chiave di partizione.</span><span class="sxs-lookup"><span data-stu-id="36489-183">All messages that are sent as part of the same transaction must specify the same partition key.</span></span> <span data-ttu-id="36489-184">Se si prova a inviare un messaggio senza una chiave di partizione in una transazione, il bus di servizio restituisce un'eccezione di operazione non valida.</span><span class="sxs-lookup"><span data-stu-id="36489-184">If you attempt to send a message without a partition key within a transaction, Service Bus returns an invalid operation exception.</span></span> <span data-ttu-id="36489-185">Se si prova a inviare più messaggi con chiavi di partizione diverse nella stessa transazione, il bus di servizio restituisce un'eccezione di operazione non valida.</span><span class="sxs-lookup"><span data-stu-id="36489-185">If you attempt to send multiple messages within the same transaction that have different partition keys, Service Bus returns an invalid operation exception.</span></span> <span data-ttu-id="36489-186">Ad esempio:</span><span class="sxs-lookup"><span data-stu-id="36489-186">For example:</span></span>

```csharp
CommittableTransaction committableTransaction = new CommittableTransaction();
using (TransactionScope ts = new TransactionScope(committableTransaction))
{
    BrokeredMessage msg = new BrokeredMessage("This is a message");
    msg.PartitionKey = "myPartitionKey";
    messageSender.Send(msg); 
    ts.Complete();
}
committableTransaction.Commit();
```

<span data-ttu-id="36489-187">Se le proprietà che fungono da chiave di partizione sono impostate, il bus di servizio aggiunge il messaggio a un frammento specifico.</span><span class="sxs-lookup"><span data-stu-id="36489-187">If any of the properties that serve as a partition key are set, Service Bus pins the message to a specific fragment.</span></span> <span data-ttu-id="36489-188">Questo comportamento si verifica indipendentemente dall'uso di una transazione.</span><span class="sxs-lookup"><span data-stu-id="36489-188">This behavior occurs whether or not a transaction is used.</span></span> <span data-ttu-id="36489-189">È consigliabile non specificare una chiave di partizione, a meno che non sia necessario.</span><span class="sxs-lookup"><span data-stu-id="36489-189">It is recommended that you do not specify a partition key if it is not necessary.</span></span>

## <a name="using-sessions-with-partitioned-entities"></a><span data-ttu-id="36489-190">Uso delle sessioni con entità partizionate</span><span class="sxs-lookup"><span data-stu-id="36489-190">Using sessions with partitioned entities</span></span>
<span data-ttu-id="36489-191">Per inviare un messaggio transazionale a un argomento o una coda in grado di riconoscere la sessione, per il messaggio la proprietà [BrokeredMessage.SessionId][BrokeredMessage.SessionId] deve essere impostata.</span><span class="sxs-lookup"><span data-stu-id="36489-191">To send a transactional message to a session-aware topic or queue, the message must have the [BrokeredMessage.SessionId][BrokeredMessage.SessionId] property set.</span></span> <span data-ttu-id="36489-192">Se è specificata anche la proprietà [BrokeredMessage.PartitionKey][BrokeredMessage.PartitionKey], quest'ultima deve avere un valore identico a quello della proprietà [SessionId][SessionId].</span><span class="sxs-lookup"><span data-stu-id="36489-192">If the [BrokeredMessage.PartitionKey][BrokeredMessage.PartitionKey] property is specified as well, it must be identical to the [SessionId][SessionId] property.</span></span> <span data-ttu-id="36489-193">In caso contrario, il bus di servizio restituisce un'eccezione di operazione non valida.</span><span class="sxs-lookup"><span data-stu-id="36489-193">If they differ, Service Bus returns an invalid operation exception.</span></span>

<span data-ttu-id="36489-194">A differenza delle code o degli argomenti normali (non partizionati), non è possibile usare una singola transazione per inviare più messaggi a sessioni diverse.</span><span class="sxs-lookup"><span data-stu-id="36489-194">Unlike regular (non-partitioned) queues or topics, it is not possible to use a single transaction to send multiple messages to different sessions.</span></span> <span data-ttu-id="36489-195">Se è stato effettuato un tentativo, il bus di servizio restituirà un'eccezione di operazione non valida,</span><span class="sxs-lookup"><span data-stu-id="36489-195">If attempted, Service Bus returns an invalid operation exception.</span></span> <span data-ttu-id="36489-196">ad esempio:</span><span class="sxs-lookup"><span data-stu-id="36489-196">For example:</span></span>

```csharp
CommittableTransaction committableTransaction = new CommittableTransaction();
using (TransactionScope ts = new TransactionScope(committableTransaction))
{
    BrokeredMessage msg = new BrokeredMessage("This is a message");
    msg.SessionId = "mySession";
    messageSender.Send(msg); 
    ts.Complete();
}
committableTransaction.Commit();
```

## <a name="automatic-message-forwarding-with-partitioned-entities"></a><span data-ttu-id="36489-197">Inoltro automatico dei messaggi con entità partizionate</span><span class="sxs-lookup"><span data-stu-id="36489-197">Automatic message forwarding with partitioned entities</span></span>
<span data-ttu-id="36489-198">Il bus di servizio supporta l'inoltro automatico dei messaggi da, a o tra entità partizionate.</span><span class="sxs-lookup"><span data-stu-id="36489-198">Service Bus supports automatic message forwarding from, to, or between partitioned entities.</span></span> <span data-ttu-id="36489-199">Per abilitare l'inoltro automatico dei messaggi, impostare la proprietà [QueueDescription.ForwardTo][QueueDescription.ForwardTo] nella coda o nella sottoscrizione di origine.</span><span class="sxs-lookup"><span data-stu-id="36489-199">To enable automatic message forwarding, set the [QueueDescription.ForwardTo][QueueDescription.ForwardTo] property on the source queue or subscription.</span></span> <span data-ttu-id="36489-200">Se il messaggio specifica una chiave di partizione ([SessionId][SessionId], [PartitionKey][PartitionKey] o [MessageId][MessageId]), tale chiave viene usata per l'entità di destinazione.</span><span class="sxs-lookup"><span data-stu-id="36489-200">If the message specifies a partition key ([SessionId][SessionId], [PartitionKey][PartitionKey], or [MessageId][MessageId]), that partition key is used for the destination entity.</span></span>

## <a name="considerations-and-guidelines"></a><span data-ttu-id="36489-201">Considerazioni e indicazioni</span><span class="sxs-lookup"><span data-stu-id="36489-201">Considerations and guidelines</span></span>
* <span data-ttu-id="36489-202">**Funzionalità a coerenza elevata**: se un'entità usa funzionalità come le sessioni, il rilevamento dei duplicati o il controllo esplicito della chiave di partizionamento, le operazioni di messaggistica vengono indirizzate sempre a frammenti specifici.</span><span class="sxs-lookup"><span data-stu-id="36489-202">**High consistency features**: If an entity uses features such as sessions, duplicate detection, or explicit control of partitioning key, then the messaging operations are always routed to specific fragments.</span></span> <span data-ttu-id="36489-203">In caso di traffico elevato in uno dei frammenti o di stato non integro dell'archivio sottostante, queste operazioni hanno esito negativo e la disponibilità viene ridotta.</span><span class="sxs-lookup"><span data-stu-id="36489-203">If any of the fragments experience high traffic or the underlying store is unhealthy, those operations fail and availability is reduced.</span></span> <span data-ttu-id="36489-204">La coerenza è complessivamente molto più elevata rispetto alle entità non partizionate. I problemi si verificano solo per un sottoinsieme del traffico, invece che per tutto il traffico.</span><span class="sxs-lookup"><span data-stu-id="36489-204">Overall, the consistency is still much higher than non-partitioned entities; only a subset of traffic is experiencing issues, as opposed to all the traffic.</span></span> <span data-ttu-id="36489-205">Per altre informazioni, vedere la [discussione relativa a disponibilità e coerenza](../event-hubs/event-hubs-availability-and-consistency.md).</span><span class="sxs-lookup"><span data-stu-id="36489-205">For more information, see this [discussion of availability and consistency](../event-hubs/event-hubs-availability-and-consistency.md).</span></span>
* <span data-ttu-id="36489-206">**Gestione**: le operazioni di creazione, aggiornamento ed eliminazione devono essere eseguite su tutti i frammenti dell'entità.</span><span class="sxs-lookup"><span data-stu-id="36489-206">**Management**: Operations such as Create, Update and Delete must be performed on all the fragments of the entity.</span></span> <span data-ttu-id="36489-207">Se un frammento non è integro, potrebbero verificarsi errori per queste operazioni.</span><span class="sxs-lookup"><span data-stu-id="36489-207">If any fragment is unhealthy it could result in failures for these operations.</span></span> <span data-ttu-id="36489-208">Per l'operazione Get è necessario aggregare da tutti i frammenti le informazioni quali il numero di messaggi.</span><span class="sxs-lookup"><span data-stu-id="36489-208">For the Get operation, information such as message counts must be aggregated from all fragments.</span></span> <span data-ttu-id="36489-209">Se un frammento non è integro, lo stato di disponibilità dell'entità risulta limitato.</span><span class="sxs-lookup"><span data-stu-id="36489-209">If any fragment is unhealthy, the entity availability status is reported as limited.</span></span>
* <span data-ttu-id="36489-210">**Scenari con volumi ridotti di messaggi**: per questi scenari, in particolare se si usa il protocollo HTTP, potrebbe essere necessario eseguire più operazioni di ricezione per ottenere tutti i messaggi.</span><span class="sxs-lookup"><span data-stu-id="36489-210">**Low volume message scenarios**: For such scenarios, especially when using the HTTP protocol, you may have to perform multiple receive operations in order to obtain all the messages.</span></span> <span data-ttu-id="36489-211">Per le richieste di ricezione, il front-end esegue una ricezione su tutti i frammenti e memorizza nella cache tutte le risposte ricevute.</span><span class="sxs-lookup"><span data-stu-id="36489-211">For receive requests, the front end performs a receive on all the fragments and caches all the responses received.</span></span> <span data-ttu-id="36489-212">Una richiesta di ricezione successiva sulla stessa connessione sarebbe avvantaggiata dalla memorizzazione nella cache e le latenze di ricezione saranno minori.</span><span class="sxs-lookup"><span data-stu-id="36489-212">A subsequent receive request on the same connection would benefit from this caching and receive latencies will be lower.</span></span> <span data-ttu-id="36489-213">Se tuttavia sono presenti più connessioni o si usa HTTP, ciò crea una nuova connessione per ogni richiesta.</span><span class="sxs-lookup"><span data-stu-id="36489-213">However, if you have multiple connections or use HTTP, that establishes a new connection for each request.</span></span> <span data-ttu-id="36489-214">Non è quindi possibile assicurare che la richiesta venga ricevuta sullo stesso nodo.</span><span class="sxs-lookup"><span data-stu-id="36489-214">As such, there is no guarantee that it would land on the same node.</span></span> <span data-ttu-id="36489-215">Se tutti i messaggi esistenti sono bloccati e memorizzati nella cache in un altro front-end, l'operazione di ricezione restituisce **null**.</span><span class="sxs-lookup"><span data-stu-id="36489-215">If all existing messages are locked and cached in another front end, the receive operation returns **null**.</span></span> <span data-ttu-id="36489-216">I messaggi raggiungeranno infine la scadenza e verranno ricevuti di nuovo.</span><span class="sxs-lookup"><span data-stu-id="36489-216">Messages eventually expire and you can receive them again.</span></span> <span data-ttu-id="36489-217">È consigliabile usare la connessione keep-alive HTTP.</span><span class="sxs-lookup"><span data-stu-id="36489-217">HTTP keep-alive is recommended.</span></span>
* <span data-ttu-id="36489-218">**Esaminare/Visualizzare l'anteprima dei messaggi**: [PeekBatch](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_PeekBatch_System_Int32_) non restituisce sempre il numero di messaggi specificati nella proprietà [MessageCount](/dotnet/api/microsoft.servicebus.messaging.queuedescription#Microsoft_ServiceBus_Messaging_QueueDescription_MessageCount)</span><span class="sxs-lookup"><span data-stu-id="36489-218">**Browse/Peek messages**: [PeekBatch](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_PeekBatch_System_Int32_) does not always return the number of messages specified in the [MessageCount](/dotnet/api/microsoft.servicebus.messaging.queuedescription#Microsoft_ServiceBus_Messaging_QueueDescription_MessageCount) property.</span></span> <span data-ttu-id="36489-219">a causa di due motivi comuni.</span><span class="sxs-lookup"><span data-stu-id="36489-219">There are two common reasons for this.</span></span> <span data-ttu-id="36489-220">Il primo motivo consiste nel fatto che le dimensioni aggregate della raccolta di messaggi superano le dimensioni massime peri a 256 KB.</span><span class="sxs-lookup"><span data-stu-id="36489-220">One reason is that the aggregated size of the collection of messages exceeds the maximum size of 256KB.</span></span> <span data-ttu-id="36489-221">L'altro motivo dipende dal fatto che, se la [proprietà EnablePartitioning](/dotnet/api/microsoft.servicebus.messaging.queuedescription#Microsoft_ServiceBus_Messaging_QueueDescription_EnablePartitioning) della coda o dell'argomento è impostata su **true**, è possibile che una partizione non includa una quantità di messaggi sufficiente per completare il numero di messaggi richiesto.</span><span class="sxs-lookup"><span data-stu-id="36489-221">Another reason is that if the queue or topic has the [EnablePartitioning property](/dotnet/api/microsoft.servicebus.messaging.queuedescription#Microsoft_ServiceBus_Messaging_QueueDescription_EnablePartitioning) set to **true**, a partition may not have enough messages to complete the requested number of messages.</span></span> <span data-ttu-id="36489-222">In genere, se un'applicazione vuole ricevere un numero specifico di messaggi, deve chiamare ripetutamente [PeekBatch](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_PeekBatch_System_Int32_) fino a ottenere tale numero di messaggi o fino a quando non siano più presenti messaggi di cui visualizzare l'anteprima.</span><span class="sxs-lookup"><span data-stu-id="36489-222">In general, if an application wants to receive a specific number of messages, it should call [PeekBatch](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_PeekBatch_System_Int32_) repeatedly until it gets that number of messages, or there are no more messages to peek.</span></span> <span data-ttu-id="36489-223">Per altre informazioni, inclusi esempi di codice, vedere [QueueClient.PeekBatch](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_PeekBatch_System_Int32_) o [SubscriptionClient.PeekBatch](/dotnet/api/microsoft.servicebus.messaging.subscriptionclient#Microsoft_ServiceBus_Messaging_SubscriptionClient_PeekBatch_System_Int32_).</span><span class="sxs-lookup"><span data-stu-id="36489-223">For more information, including code samples, see [QueueClient.PeekBatch](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_PeekBatch_System_Int32_) or [SubscriptionClient.PeekBatch](/dotnet/api/microsoft.servicebus.messaging.subscriptionclient#Microsoft_ServiceBus_Messaging_SubscriptionClient_PeekBatch_System_Int32_).</span></span>

## <a name="latest-added-features"></a><span data-ttu-id="36489-224">Funzionalità aggiunte di recente</span><span class="sxs-lookup"><span data-stu-id="36489-224">Latest added features</span></span>
* <span data-ttu-id="36489-225">L'aggiunta o la rimozione di una regola è ora supportata con le entità partizionate.</span><span class="sxs-lookup"><span data-stu-id="36489-225">Add or remove rule is now supported with partitioned entities.</span></span> <span data-ttu-id="36489-226">A differenza delle entità non partizionate, queste operazioni non sono supportate nelle transazioni.</span><span class="sxs-lookup"><span data-stu-id="36489-226">Different from non-partitioned entities, these operations are not supported under transactions.</span></span> 
* <span data-ttu-id="36489-227">AMQP è ora supportato per l'invio e la ricezione di messaggi verso e da un'entità partizionata.</span><span class="sxs-lookup"><span data-stu-id="36489-227">AMQP is now supported for sending and receiving messages to and from a partitioned entity.</span></span>
* <span data-ttu-id="36489-228">AMQP è ora supportato per le operazioni seguenti: [invio batch](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_SendBatch_System_Collections_Generic_IEnumerable_Microsoft_ServiceBus_Messaging_BrokeredMessage__), [ricezione batch](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_ReceiveBatch_System_Int32_), [ricezione per numero di sequenza](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_Receive_System_Int64_), [visualizzazione dell'anteprima](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_Peek), [rinnovo del blocco](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_RenewMessageLock_System_Guid_), [pianificazione del messaggio](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_ScheduleMessageAsync_Microsoft_ServiceBus_Messaging_BrokeredMessage_System_DateTimeOffset_), [annullamento del messaggio pianificato](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_CancelScheduledMessageAsync_System_Int64_), [aggiunta di una nuova regola](/dotnet/api/microsoft.servicebus.messaging.ruledescription), [rimozione di una regola](/dotnet/api/microsoft.servicebus.messaging.ruledescription), [blocco del rinnovo della sessione](/dotnet/api/microsoft.servicebus.messaging.messagesession#Microsoft_ServiceBus_Messaging_MessageSession_RenewLock), [impostazione dello stato della sessione](/dotnet/api/microsoft.servicebus.messaging.messagesession#Microsoft_ServiceBus_Messaging_MessageSession_SetState_System_IO_Stream_), [recupero dello stato della sessione](/dotnet/api/microsoft.servicebus.messaging.messagesession#Microsoft_ServiceBus_Messaging_MessageSession_GetState) ed [enumerazione delle sessioni](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_GetMessageSessionsAsync).</span><span class="sxs-lookup"><span data-stu-id="36489-228">AMQP is now supported for the following operations: [Batch Send](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_SendBatch_System_Collections_Generic_IEnumerable_Microsoft_ServiceBus_Messaging_BrokeredMessage__), [Batch Receive](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_ReceiveBatch_System_Int32_), [Receive by Sequence Number](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_Receive_System_Int64_), [Peek](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_Peek), [Renew Lock](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_RenewMessageLock_System_Guid_), [Schedule Message](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_ScheduleMessageAsync_Microsoft_ServiceBus_Messaging_BrokeredMessage_System_DateTimeOffset_), [Cancel Scheduled Message](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_CancelScheduledMessageAsync_System_Int64_), [Add Rule](/dotnet/api/microsoft.servicebus.messaging.ruledescription), [Remove Rule](/dotnet/api/microsoft.servicebus.messaging.ruledescription), [Session Renew Lock](/dotnet/api/microsoft.servicebus.messaging.messagesession#Microsoft_ServiceBus_Messaging_MessageSession_RenewLock), [Set Session State](/dotnet/api/microsoft.servicebus.messaging.messagesession#Microsoft_ServiceBus_Messaging_MessageSession_SetState_System_IO_Stream_), [Get Session State](/dotnet/api/microsoft.servicebus.messaging.messagesession#Microsoft_ServiceBus_Messaging_MessageSession_GetState), and [Enumerate Sessions](/dotnet/api/microsoft.servicebus.messaging.queueclient#Microsoft_ServiceBus_Messaging_QueueClient_GetMessageSessionsAsync).</span></span>

## <a name="partitioned-entities-limitations"></a><span data-ttu-id="36489-229">Limiti delle entità partizionate</span><span class="sxs-lookup"><span data-stu-id="36489-229">Partitioned entities limitations</span></span>
<span data-ttu-id="36489-230">Attualmente il bus di servizio impone alle code o agli argomenti partizionati i limiti seguenti:</span><span class="sxs-lookup"><span data-stu-id="36489-230">Currently Service Bus imposes the following limitations on partitioned queues and topics:</span></span>

* <span data-ttu-id="36489-231">Le code e gli argomenti partizionati non supportano l'invio di messaggi che appartengono a sessioni diverse in una singola transazione.</span><span class="sxs-lookup"><span data-stu-id="36489-231">Partitioned queues and topics do not support sending messages that belong to different sessions in a single transaction.</span></span>
* <span data-ttu-id="36489-232">Il bus di servizio attualmente consente fino a 100 code o argomenti partizionati per spazio dei nomi.</span><span class="sxs-lookup"><span data-stu-id="36489-232">Service Bus currently allows up to 100 partitioned queues or topics per namespace.</span></span> <span data-ttu-id="36489-233">Ogni coda o argomento partizionato viene conteggiato ai fini della quota di 10.000 entità per spazio dei nomi (non si applica al livello Premium).</span><span class="sxs-lookup"><span data-stu-id="36489-233">Each partitioned queue or topic counts towards the quota of 10,000 entities per namespace (does not apply to Premium tier).</span></span>

## <a name="next-steps"></a><span data-ttu-id="36489-234">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="36489-234">Next steps</span></span>
<span data-ttu-id="36489-235">Per altre informazioni sul partizionamento delle entità di messaggistica, vedere [Supporto di AMQP 1.0 per code e argomenti partizionati del bus di servizio][AMQP 1.0 support for Service Bus partitioned queues and topics].</span><span class="sxs-lookup"><span data-stu-id="36489-235">See the discussion of [AMQP 1.0 support for Service Bus partitioned queues and topics][AMQP 1.0 support for Service Bus partitioned queues and topics] to learn more about partitioning messaging entities.</span></span> 

[Service Bus architecture]: service-bus-architecture.md
[Azure portal]: https://portal.azure.com
[QueueDescription.EnablePartitioning]: /dotnet/api/microsoft.servicebus.messaging.queuedescription#Microsoft_ServiceBus_Messaging_QueueDescription_EnablePartitioning
[TopicDescription.EnablePartitioning]: /dotnet/api/microsoft.servicebus.messaging.topicdescription#Microsoft_ServiceBus_Messaging_TopicDescription_EnablePartitioning
[BrokeredMessage.SessionId]: /dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_SessionId
[BrokeredMessage.PartitionKey]: /dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_PartitionKey
[SessionId]: /dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_SessionId
[PartitionKey]: /dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_PartitionKey
[QueueDescription.RequiresDuplicateDetection]: /dotnet/api/microsoft.servicebus.messaging.queuedescription#Microsoft_ServiceBus_Messaging_QueueDescription_RequiresDuplicateDetection
[BrokeredMessage.MessageId]: /dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_MessageId
[MessageId]: /dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_MessageId
[MessagingFactorySettings.OperationTimeout]: /dotnet/api/microsoft.servicebus.messaging.messagingfactorysettings#Microsoft_ServiceBus_Messaging_MessagingFactorySettings_OperationTimeout
[OperationTimeout]: /dotnet/api/microsoft.servicebus.messaging.messagingfactorysettings#Microsoft_ServiceBus_Messaging_MessagingFactorySettings_OperationTimeout
[QueueDescription.ForwardTo]: /dotnet/api/microsoft.servicebus.messaging.queuedescription#Microsoft_ServiceBus_Messaging_QueueDescription_ForwardTo
[AMQP 1.0 support for Service Bus partitioned queues and topics]: service-bus-partitioned-queues-and-topics-amqp-overview.md
