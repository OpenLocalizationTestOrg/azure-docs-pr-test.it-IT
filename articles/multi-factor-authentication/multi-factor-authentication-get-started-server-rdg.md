---
title: "aaaRDG e Server di autenticazione a più fattori di Azure tramite RADIUS | Documenti Microsoft"
description: Si tratta hello Azure multi-factor authentication pagina di supporto nella distribuzione di Gateway Desktop remoto (desktop remoto) e il Server Azure multi-Factor Authentication tramite RADIUS.
services: multi-factor-authentication
documentationcenter: 
author: kgremban
manager: femila
ms.assetid: f2354ac4-a3a7-48e5-a86d-84a9e5682b42
ms.service: multi-factor-authentication
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: get-started-article
ms.date: 06/27/2017
ms.author: kgremban
ms.reviewer: yossib
ms.custom: it-pro
ms.openlocfilehash: fd280e9b6ff90c82927cffe593c4f1fda7047842
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/06/2017
---
# <a name="remote-desktop-gateway-and-azure-multi-factor-authentication-server-using-radius"></a><span data-ttu-id="55bf3-103">Gateway Desktop remoto e server Azure Multi-Factor Authentication utilizzando RADIUS</span><span class="sxs-lookup"><span data-stu-id="55bf3-103">Remote Desktop Gateway and Azure Multi-Factor Authentication Server using RADIUS</span></span>
<span data-ttu-id="55bf3-104">Spesso, Gateway Desktop remoto (desktop remoto) utilizza hello locale servizi (criteri di rete) tooauthenticate utenti.</span><span class="sxs-lookup"><span data-stu-id="55bf3-104">Often, Remote Desktop (RD) Gateway uses hello local Network Policy Services (NPS) tooauthenticate users.</span></span> <span data-ttu-id="55bf3-105">In questo articolo viene descritto come tooroute RADIUS richiede hello Gateway Desktop remoto (tramite hello dei criteri di rete locale) toohello Server multi-Factor Authentication.</span><span class="sxs-lookup"><span data-stu-id="55bf3-105">This article describes how tooroute RADIUS requests out from hello Remote Desktop Gateway (through hello local NPS) toohello Multi-Factor Authentication Server.</span></span> <span data-ttu-id="55bf3-106">Hello combinazione di Azure MFA e Gateway Desktop remoto significa che gli utenti possono accedere gli ambienti di lavoro da qualsiasi posizione durante l'esecuzione dell'autenticazione avanzata.</span><span class="sxs-lookup"><span data-stu-id="55bf3-106">hello combination of Azure MFA and RD Gateway means that your users can access their work environments from anywhere while performing strong authentication.</span></span> 

<span data-ttu-id="55bf3-107">Poiché l'autenticazione di Windows per Servizi terminal non è supportato per Server 2012 R2, è possibile utilizzare toointegrate RADIUS e Gateway Desktop remoto con Server di autenticazione a più fattori.</span><span class="sxs-lookup"><span data-stu-id="55bf3-107">Since Windows Authentication for terminal services is not supported for Server 2012 R2, use RD Gateway and RADIUS toointegrate with MFA Server.</span></span> 

<span data-ttu-id="55bf3-108">Installare hello del Server Azure multi-Factor Authentication in un server distinto, quali proxy RADIUS hello richiesta nuovamente toohello dei criteri di rete su hello Server Gateway Desktop remoto.</span><span class="sxs-lookup"><span data-stu-id="55bf3-108">Install hello Azure Multi-Factor Authentication Server on a separate server, which proxies hello RADIUS request back toohello NPS on hello Remote Desktop Gateway Server.</span></span> <span data-ttu-id="55bf3-109">Una volta NPS convalida hello username e password, restituisce un toohello di risposta Server multi-Factor Authentication.</span><span class="sxs-lookup"><span data-stu-id="55bf3-109">After NPS validates hello username and password, it returns a response toohello Multi-Factor Authentication Server.</span></span> <span data-ttu-id="55bf3-110">Quindi, hello Server MFA esegue secondo fattore di autenticazione di hello e restituisce un gateway toohello risultato.</span><span class="sxs-lookup"><span data-stu-id="55bf3-110">Then, hello MFA Server performs hello second factor of authentication and returns a result toohello gateway.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="55bf3-111">Prerequisiti</span><span class="sxs-lookup"><span data-stu-id="55bf3-111">Prerequisites</span></span>

- <span data-ttu-id="55bf3-112">Un server MFA di Azure aggiunto a un dominio.</span><span class="sxs-lookup"><span data-stu-id="55bf3-112">A domain-joined Azure MFA Server.</span></span> <span data-ttu-id="55bf3-113">Se non si dispone di uno già installato, attenersi alla procedura hello in [introduzione hello del Server Azure multi-Factor Authentication](multi-factor-authentication-get-started-server.md).</span><span class="sxs-lookup"><span data-stu-id="55bf3-113">If you don't have one installed already, follow hello steps in [Getting started with hello Azure Multi-Factor Authentication Server](multi-factor-authentication-get-started-server.md).</span></span>
- <span data-ttu-id="55bf3-114">Un'istanza di Gateway Desktop remoto che esegue l'autenticazione con il server dei criteri di rete.</span><span class="sxs-lookup"><span data-stu-id="55bf3-114">A Remote Desktop Gateway that authenticates with Network Policy Services.</span></span>

## <a name="configure-hello-remote-desktop-gateway"></a><span data-ttu-id="55bf3-115">Configurare hello Gateway Desktop remoto</span><span class="sxs-lookup"><span data-stu-id="55bf3-115">Configure hello Remote Desktop Gateway</span></span>
<span data-ttu-id="55bf3-116">Configurare hello Gateway Desktop remoto toosend RADIUS autenticazione tooan Server Azure multi-Factor Authentication.</span><span class="sxs-lookup"><span data-stu-id="55bf3-116">Configure hello RD Gateway toosend RADIUS authentication tooan Azure Multi-Factor Authentication Server.</span></span> 

1. <span data-ttu-id="55bf3-117">In Gestione Gateway Desktop remoto, il nome di server hello e scegliere **proprietà**.</span><span class="sxs-lookup"><span data-stu-id="55bf3-117">In RD Gateway Manager, right-click hello server name and select **Properties**.</span></span>
2. <span data-ttu-id="55bf3-118">Passare toohello **archivio per desktop remoto** e selezionare **server centrale,**.</span><span class="sxs-lookup"><span data-stu-id="55bf3-118">Go toohello **RD CAP Store** tab and select **Central server running NPS**.</span></span> 
3. <span data-ttu-id="55bf3-119">Aggiungere uno o più server di autenticazione a più fattori di Azure come server RADIUS, immettere il nome di hello o indirizzo IP di ogni server.</span><span class="sxs-lookup"><span data-stu-id="55bf3-119">Add one or more Azure Multi-Factor Authentication Servers as RADIUS servers by entering hello name or IP address of each server.</span></span> 
4. <span data-ttu-id="55bf3-120">Creare un segreto condiviso per ogni server.</span><span class="sxs-lookup"><span data-stu-id="55bf3-120">Create a shared secret for each server.</span></span>

## <a name="configure-nps"></a><span data-ttu-id="55bf3-121">Configurazione dei criteri di rete</span><span class="sxs-lookup"><span data-stu-id="55bf3-121">Configure NPS</span></span>
<span data-ttu-id="55bf3-122">Hello Gateway Desktop remoto utilizza criteri di rete toosend hello RADIUS richiesta tooAzure multi-Factor Authentication.</span><span class="sxs-lookup"><span data-stu-id="55bf3-122">hello RD Gateway uses NPS toosend hello RADIUS request tooAzure Multi-Factor Authentication.</span></span> <span data-ttu-id="55bf3-123">tooconfigure dei criteri di rete, prima è modificare le impostazioni di timeout hello tooprevent hello Gateway Desktop remoto dal timeout prima del completamento di verifica in due passaggi hello.</span><span class="sxs-lookup"><span data-stu-id="55bf3-123">tooconfigure NPS, first you change hello timeout settings tooprevent hello RD Gateway from timing out before hello two-step verification has completed.</span></span> <span data-ttu-id="55bf3-124">È quindi possibile aggiornare le autenticazioni RADIUS tooreceive di criteri di rete dal Server di autenticazione a più fattori.</span><span class="sxs-lookup"><span data-stu-id="55bf3-124">Then, you update NPS tooreceive RADIUS authentications from your MFA Server.</span></span> <span data-ttu-id="55bf3-125">Utilizzare hello procedure tooconfigure dei criteri di rete seguenti:</span><span class="sxs-lookup"><span data-stu-id="55bf3-125">Use hello following procedure tooconfigure NPS:</span></span>

### <a name="modify-hello-timeout-policy"></a><span data-ttu-id="55bf3-126">Modificare i criteri di timeout hello</span><span class="sxs-lookup"><span data-stu-id="55bf3-126">Modify hello timeout policy</span></span>

1. <span data-ttu-id="55bf3-127">In Criteri di rete, aprire hello **client e Server RADIUS** dal menu a sinistra di colonna e selezionare hello **gruppi di Server RADIUS remoti**.</span><span class="sxs-lookup"><span data-stu-id="55bf3-127">In NPS, open hello **RADIUS Clients and Server** menu in hello left column and select **Remote RADIUS Server Groups**.</span></span> 
2. <span data-ttu-id="55bf3-128">Seleziona hello **gruppo del SERVER GATEWAY Servizi terminal**.</span><span class="sxs-lookup"><span data-stu-id="55bf3-128">Select hello **TS GATEWAY SERVER GROUP**.</span></span> 
3. <span data-ttu-id="55bf3-129">Passare toohello **il bilanciamento del carico** scheda.</span><span class="sxs-lookup"><span data-stu-id="55bf3-129">Go toohello **Load Balancing** tab.</span></span> 
4. <span data-ttu-id="55bf3-130">Modificare entrambi hello **numero di secondi senza risposta prima che la richiesta venga annullata** hello e **numero di secondi tra le richieste quando il server viene identificato come non disponibile** toobetween 30 e 60 secondi.</span><span class="sxs-lookup"><span data-stu-id="55bf3-130">Change both hello **Number of seconds without response before request is considered dropped** and hello **Number of seconds between requests when server is identified as unavailable** toobetween 30 and 60 seconds.</span></span> <span data-ttu-id="55bf3-131">(Se si ritiene che il server hello scade ancora durante l'autenticazione, è possibile tornare a questa schermata e aumentare hello numero di secondi.)</span><span class="sxs-lookup"><span data-stu-id="55bf3-131">(If you find that hello server still times out during authentication, you can come back here and increase hello number of seconds.)</span></span>
5. <span data-ttu-id="55bf3-132">Passare toohello **/Account di autenticazione** scheda e verificare che le porte RADIUS hello specificato corrispondenza hello porte che hello Server multi-Factor Authentication è in ascolto.</span><span class="sxs-lookup"><span data-stu-id="55bf3-132">Go toohello **Authentication/Account** tab and check that hello RADIUS ports specified match hello ports that hello Multi-Factor Authentication Server is listening on.</span></span>

### <a name="prepare-nps-tooreceive-authentications-from-hello-mfa-server"></a><span data-ttu-id="55bf3-133">Preparare le autenticazioni tooreceive dei criteri di rete dal Server di autenticazione a più fattori hello</span><span class="sxs-lookup"><span data-stu-id="55bf3-133">Prepare NPS tooreceive authentications from hello MFA Server</span></span>

1. <span data-ttu-id="55bf3-134">Fare doppio clic su **client RADIUS** in client RADIUS e server in a sinistra di colonna e selezionare hello **New**.</span><span class="sxs-lookup"><span data-stu-id="55bf3-134">Right-click **RADIUS Clients** under RADIUS Clients and Servers in hello left column and select **New**.</span></span>
2. <span data-ttu-id="55bf3-135">Aggiungere hello del Server Azure multi-Factor Authentication come client RADIUS.</span><span class="sxs-lookup"><span data-stu-id="55bf3-135">Add hello Azure Multi-Factor Authentication Server as a RADIUS client.</span></span> <span data-ttu-id="55bf3-136">Scegliere un nome descrittivo e specificare un segreto condiviso.</span><span class="sxs-lookup"><span data-stu-id="55bf3-136">Choose a Friendly name and specify a shared secret.</span></span>
3. <span data-ttu-id="55bf3-137">Aprire hello **criteri** dal menu a sinistra di colonna e selezionare hello **criteri richiesta di connessione**.</span><span class="sxs-lookup"><span data-stu-id="55bf3-137">Open hello **Policies** menu in hello left column and select **Connection Request Policies**.</span></span> <span data-ttu-id="55bf3-138">Verrà visualizzato un criterio denominato TS GATEWAY AUTHORIZATION POLICY, creato durante la configurazione di Gateway Desktop remoto.</span><span class="sxs-lookup"><span data-stu-id="55bf3-138">You should see a policy called TS GATEWAY AUTHORIZATION POLICY that was created when RD Gateway was configured.</span></span> <span data-ttu-id="55bf3-139">Questo criterio inoltra le richieste RADIUS toohello Server multi-Factor Authentication.</span><span class="sxs-lookup"><span data-stu-id="55bf3-139">This policy forwards RADIUS requests toohello Multi-Factor Authentication Server.</span></span>
4. <span data-ttu-id="55bf3-140">Fare clic con il pulsante destro del mouse su **TS GATEWAY AUTHORIZATION POLICY** e scegliere **Duplica criterio**.</span><span class="sxs-lookup"><span data-stu-id="55bf3-140">Right-click **TS GATEWAY AUTHORIZATION POLICY** and select **Duplicate Policy**.</span></span> 
5. <span data-ttu-id="55bf3-141">Aprire hello nuovi criteri e passare toohello **condizioni** scheda.</span><span class="sxs-lookup"><span data-stu-id="55bf3-141">Open hello new policy and go toohello **Conditions** tab.</span></span>
6. <span data-ttu-id="55bf3-142">Aggiungere una condizione corrispondente al nome descrittivo del Client con il nome descrittivo di hello impostato nel passaggio 2 per client RADIUS del Server Azure multi-Factor Authentication hello hello.</span><span class="sxs-lookup"><span data-stu-id="55bf3-142">Add a condition that matches hello Client Friendly Name with hello Friendly name set in step 2 for hello Azure Multi-Factor Authentication Server RADIUS client.</span></span> 
7. <span data-ttu-id="55bf3-143">Passare toohello **impostazioni** e selezionare **autenticazione**.</span><span class="sxs-lookup"><span data-stu-id="55bf3-143">Go toohello **Settings** tab and select **Authentication**.</span></span>
8. <span data-ttu-id="55bf3-144">Modificare anche i Provider di autenticazione hello**autenticare le richieste in questo server**.</span><span class="sxs-lookup"><span data-stu-id="55bf3-144">Change hello Authentication Provider too**Authenticate requests on this server**.</span></span> <span data-ttu-id="55bf3-145">Questo criterio assicura che quando dei criteri di rete riceve una richiesta RADIUS dal Server di autenticazione a più fattori di Azure hello, hello autenticazione viene eseguita localmente anziché inviare un raggio richiesta indietro toohello Azure multi-Factor Authentication Server, con la conseguenza di una condizione di ciclo.</span><span class="sxs-lookup"><span data-stu-id="55bf3-145">This policy ensures that when NPS receives a RADIUS request from hello Azure MFA Server, hello authentication occurs locally instead of sending a RADIUS request back toohello Azure Multi-Factor Authentication Server, which would result in a loop condition.</span></span> 
9. <span data-ttu-id="55bf3-146">tooprevent una condizione di ciclo, assicurarsi che il nuovo criterio di hello è ordinato sopra criterio originale di hello in hello **criteri richiesta di connessione** riquadro.</span><span class="sxs-lookup"><span data-stu-id="55bf3-146">tooprevent a loop condition, make sure that hello new policy is ordered ABOVE hello original policy in hello **Connection Request Policies** pane.</span></span>

## <a name="configure-azure-multi-factor-authentication"></a><span data-ttu-id="55bf3-147">Configurazione di Azure Multi-Factor Authentication</span><span class="sxs-lookup"><span data-stu-id="55bf3-147">Configure Azure Multi-Factor Authentication</span></span>

<span data-ttu-id="55bf3-148">Hello del Server Azure multi-Factor Authentication è configurato come proxy RADIUS tra Gateway Desktop remoto e dei criteri di rete.</span><span class="sxs-lookup"><span data-stu-id="55bf3-148">hello Azure Multi-Factor Authentication Server is configured as a RADIUS proxy between RD Gateway and NPS.</span></span>  <span data-ttu-id="55bf3-149">È necessario installarlo in un server di dominio che è distinto dal server Gateway Desktop remoto hello.</span><span class="sxs-lookup"><span data-stu-id="55bf3-149">It should be installed on a domain-joined server that is separate from hello RD Gateway server.</span></span> <span data-ttu-id="55bf3-150">Utilizzare hello seguente hello tooconfigure procedure del Server Azure multi-Factor Authentication.</span><span class="sxs-lookup"><span data-stu-id="55bf3-150">Use hello following procedure tooconfigure hello Azure Multi-Factor Authentication Server.</span></span>

1. <span data-ttu-id="55bf3-151">Scegliere sull'icona autenticazione RADIUS hello hello del Server Azure multi-Factor Authentication.</span><span class="sxs-lookup"><span data-stu-id="55bf3-151">Open hello Azure Multi-Factor Authentication Server and select hello RADIUS Authentication icon.</span></span> 
2. <span data-ttu-id="55bf3-152">Controllare hello **Abilita autenticazione RADIUS** casella di controllo.</span><span class="sxs-lookup"><span data-stu-id="55bf3-152">Check hello **Enable RADIUS authentication** checkbox.</span></span>
3. <span data-ttu-id="55bf3-153">Nella scheda client hello, verificare che le porte hello corrispondano a quelle configurate in Criteri di rete, quindi selezionare **Aggiungi**.</span><span class="sxs-lookup"><span data-stu-id="55bf3-153">On hello Clients tab, ensure hello ports match what is configured in NPS then select **Add**.</span></span>
4. <span data-ttu-id="55bf3-154">Aggiungere l'indirizzo IP del server Gateway Desktop remoto hello, nome dell'applicazione (facoltativo) e un segreto condiviso.</span><span class="sxs-lookup"><span data-stu-id="55bf3-154">Add hello RD Gateway server IP address, application name (optional), and a shared secret.</span></span> <span data-ttu-id="55bf3-155">Hello shared secret esigenze toobe hello stesso sul Server Azure multi-Factor Authentication hello e Gateway Desktop remoto.</span><span class="sxs-lookup"><span data-stu-id="55bf3-155">hello shared secret needs toobe hello same on both hello Azure Multi-Factor Authentication Server and RD Gateway.</span></span>
3. <span data-ttu-id="55bf3-156">Passare toohello **destinazione** scheda e seleziona hello **server RADIUS** pulsante di opzione.</span><span class="sxs-lookup"><span data-stu-id="55bf3-156">Go toohello **Target** tab and select hello **RADIUS server(s)** radio button.</span></span>
4. <span data-ttu-id="55bf3-157">Selezionare **Aggiungi** e immettere l'indirizzo IP hello segreto condiviso e porte del server dei criteri di rete hello.</span><span class="sxs-lookup"><span data-stu-id="55bf3-157">Select **Add** and enter hello IP address, shared secret, and ports of hello NPS server.</span></span> <span data-ttu-id="55bf3-158">A meno che non utilizza una rete centrale, sono hello stesso hello client RADIUS e destinazione RADIUS.</span><span class="sxs-lookup"><span data-stu-id="55bf3-158">Unless using a central NPS, hello RADIUS client and RADIUS target are hello same.</span></span> <span data-ttu-id="55bf3-159">segreto condiviso Hello deve corrispondere a quello impostato di hello nella sezione client RADIUS del server dei criteri di rete hello hello.</span><span class="sxs-lookup"><span data-stu-id="55bf3-159">hello shared secret must match hello one setup in hello RADIUS client section of hello NPS server.</span></span>

![Autenticazione RADIUS](./media/multi-factor-authentication-get-started-server-rdg/radius.png)

## <a name="next-steps"></a><span data-ttu-id="55bf3-161">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="55bf3-161">Next steps</span></span>

- <span data-ttu-id="55bf3-162">Integrare Azure MFA e [app Web IIS](multi-factor-authentication-get-started-server-iis.md)</span><span class="sxs-lookup"><span data-stu-id="55bf3-162">Integrate Azure MFA and [IIS web apps](multi-factor-authentication-get-started-server-iis.md)</span></span>

- <span data-ttu-id="55bf3-163">Ottenere le risposte in hello [domande frequenti di Azure multi-Factor Authentication](multi-factor-authentication-faq.md)</span><span class="sxs-lookup"><span data-stu-id="55bf3-163">Get answers in hello [Azure Multi-Factor Authentication FAQ](multi-factor-authentication-faq.md)</span></span>
