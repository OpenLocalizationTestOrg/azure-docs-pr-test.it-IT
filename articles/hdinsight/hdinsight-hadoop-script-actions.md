---
title: lo sviluppo dell'azione con HDInsight - Azure aaaScript | Documenti Microsoft
description: "Informazioni su come toocustomize Hadoop cluster con azione di Script. Genera script azione può essere utilizzato tooinstall software aggiuntivo in esecuzione in una configurazione di hello cluster o toochange Hadoop delle applicazioni installate in un cluster."
services: hdinsight
documentationcenter: 
tags: azure-portal
author: mumian
manager: jhubbard
editor: cgronlun
ms.assetid: 836d68a8-8b21-4d69-8b61-281a7fe67f21
ms.service: hdinsight
ms.workload: big-data
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 05/25/2017
ms.author: jgao
ROBOTS: NOINDEX
ms.openlocfilehash: 4fc3a389df8a003f7129ab00b4cd9bc7ad81a419
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/06/2017
---
# <a name="develop-script-action-scripts-for-hdinsight-windows-based-clusters"></a><span data-ttu-id="0a84d-104">Sviluppare script di Azione script per HDInsight nei cluster basati su Windows</span><span class="sxs-lookup"><span data-stu-id="0a84d-104">Develop Script Action scripts for HDInsight Windows-based clusters</span></span>
<span data-ttu-id="0a84d-105">Informazioni su come toowrite genera Script azione gli script per HDInsight.</span><span class="sxs-lookup"><span data-stu-id="0a84d-105">Learn how toowrite Script Action scripts for HDInsight.</span></span> <span data-ttu-id="0a84d-106">Per informazioni sull'uso di script di Azione script, vedere [Personalizzare cluster HDInsight mediante Azione script](hdinsight-hadoop-customize-cluster.md).</span><span class="sxs-lookup"><span data-stu-id="0a84d-106">For information on using Script Action scripts, see [Customize HDInsight clusters using Script Action](hdinsight-hadoop-customize-cluster.md).</span></span> <span data-ttu-id="0a84d-107">Per hello stesso articolo scritto per i cluster HDInsight basati su Linux, vedere [script sviluppare genera Script azione per HDInsight](hdinsight-hadoop-script-actions-linux.md).</span><span class="sxs-lookup"><span data-stu-id="0a84d-107">For hello same article written for Linux-based HDInsight clusters, see [Develop Script Action scripts for HDInsight](hdinsight-hadoop-script-actions-linux.md).</span></span>



> [!IMPORTANT]
> <span data-ttu-id="0a84d-108">Hello passaggi sono disponibili solo in questo documento per i cluster HDInsight basati su Windows.</span><span class="sxs-lookup"><span data-stu-id="0a84d-108">hello steps in this document only work for Windows-based HDInsight clusters.</span></span> <span data-ttu-id="0a84d-109">HDInsight è disponibile in Windows solo per le versioni precedenti a HDInsight 3.4.</span><span class="sxs-lookup"><span data-stu-id="0a84d-109">HDInsight is only available on Windows for versions lower than HDInsight 3.4.</span></span> <span data-ttu-id="0a84d-110">Linux è hello solo sistema operativo utilizzato in HDInsight versione 3.4 o successiva.</span><span class="sxs-lookup"><span data-stu-id="0a84d-110">Linux is hello only operating system used on HDInsight version 3.4 or greater.</span></span> <span data-ttu-id="0a84d-111">Per altre informazioni, vedere la sezione relativa al [ritiro di HDInsight in Windows](hdinsight-component-versioning.md#hdinsight-windows-retirement).</span><span class="sxs-lookup"><span data-stu-id="0a84d-111">For more information, see [HDInsight retirement on Windows](hdinsight-component-versioning.md#hdinsight-windows-retirement).</span></span> <span data-ttu-id="0a84d-112">Per informazioni sull'uso di azioni script con cluster basati su Linux, vedere [Sviluppo di azioni script con HDInsight (Linux)](hdinsight-hadoop-script-actions-linux.md).</span><span class="sxs-lookup"><span data-stu-id="0a84d-112">For information on using script actions with Linux-based clusters, see [Script action development with HDInsight (Linux)](hdinsight-hadoop-script-actions-linux.md).</span></span>
>
>



<span data-ttu-id="0a84d-113">Genera script azione può essere utilizzato tooinstall software aggiuntivo in esecuzione in una configurazione di hello cluster o toochange Hadoop delle applicazioni installate in un cluster.</span><span class="sxs-lookup"><span data-stu-id="0a84d-113">Script Action can be used tooinstall additional software running on a Hadoop cluster or toochange hello configuration of applications installed on a cluster.</span></span> <span data-ttu-id="0a84d-114">Le azioni script sono gli script da eseguire sui nodi del cluster di hello quando si distribuiscono cluster HDInsight e vengono eseguiti una volta che i nodi cluster hello completare la configurazione di HDInsight.</span><span class="sxs-lookup"><span data-stu-id="0a84d-114">Script actions are scripts that run on hello cluster nodes when HDInsight clusters are deployed, and they are executed once nodes in hello cluster complete HDInsight configuration.</span></span> <span data-ttu-id="0a84d-115">Un'azione di script viene eseguita con privilegi di account amministratore di sistema e fornisce i diritti di accesso completi toohello i nodi del cluster.</span><span class="sxs-lookup"><span data-stu-id="0a84d-115">A script action is executed under system admin account privileges and provides full access rights toohello cluster nodes.</span></span> <span data-ttu-id="0a84d-116">Ogni cluster può essere fornito con un elenco di toobe azioni script eseguiti in ordine di hello in cui sono state specificate.</span><span class="sxs-lookup"><span data-stu-id="0a84d-116">Each cluster can be provided with a list of script actions toobe executed in hello order in which they are specified.</span></span>

> [!NOTE]
> <span data-ttu-id="0a84d-117">Se si verifica hello seguente messaggio di errore:</span><span class="sxs-lookup"><span data-stu-id="0a84d-117">If you experience hello following error message:</span></span>
>
> <span data-ttu-id="0a84d-118">System.Management.Automation.CommandNotFoundException; ExceptionMessage: hello termine 'Salva HDIFile' non è riconosciuto come nome hello di un cmdlet, funzione, file di script o programma eseguibile.</span><span class="sxs-lookup"><span data-stu-id="0a84d-118">System.Management.Automation.CommandNotFoundException; ExceptionMessage : hello term 'Save-HDIFile' is not recognized as hello name of a cmdlet, function, script file, or operable program.</span></span> <span data-ttu-id="0a84d-119">Il controllo ortografico hello del nome di hello, o se è stato incluso un percorso, verificare che il percorso hello sia corretto e riprovare.</span><span class="sxs-lookup"><span data-stu-id="0a84d-119">Check hello spelling of hello name, or if a path was included, verify that hello path is correct and try again.</span></span>
> <span data-ttu-id="0a84d-120">È perché non inclusi metodi helper hello.</span><span class="sxs-lookup"><span data-stu-id="0a84d-120">It is because you didn't include hello helper methods.</span></span>  <span data-ttu-id="0a84d-121">Vedere [Metodi helper per gli script personalizzati](hdinsight-hadoop-script-actions.md#helper-methods-for-custom-scripts).</span><span class="sxs-lookup"><span data-stu-id="0a84d-121">See [Helper methods for custom scripts](hdinsight-hadoop-script-actions.md#helper-methods-for-custom-scripts).</span></span>
>
>

## <a name="sample-scripts"></a><span data-ttu-id="0a84d-122">Script di esempio</span><span class="sxs-lookup"><span data-stu-id="0a84d-122">Sample scripts</span></span>
<span data-ttu-id="0a84d-123">Per la creazione di cluster HDInsight nel sistema operativo Windows, hello azione Script è uno script di PowerShell di Azure.</span><span class="sxs-lookup"><span data-stu-id="0a84d-123">For creating HDInsight clusters on Windows operating system, hello Script Action is Azure PowerShell script.</span></span> <span data-ttu-id="0a84d-124">Hello script riportato di seguito è riportato un esempio per la configurazione del file di configurazione del sito hello:</span><span class="sxs-lookup"><span data-stu-id="0a84d-124">hello following script is a sample for configuring hello site configuration files:</span></span>

[!INCLUDE [upgrade-powershell](../../includes/hdinsight-use-latest-powershell.md)]

    param (
        [parameter(Mandatory)][string] $ConfigFileName,
        [parameter(Mandatory)][string] $Name,
        [parameter(Mandatory)][string] $Value,
        [parameter()][string] $Description
    )

    if (!$Description) {
        $Description = ""
    }

    $hdiConfigFiles = @{
        "hive-site.xml" = "$env:HIVE_HOME\conf\hive-site.xml";
        "core-site.xml" = "$env:HADOOP_HOME\etc\hadoop\core-site.xml";
        "hdfs-site.xml" = "$env:HADOOP_HOME\etc\hadoop\hdfs-site.xml";
        "mapred-site.xml" = "$env:HADOOP_HOME\etc\hadoop\mapred-site.xml";
        "yarn-site.xml" = "$env:HADOOP_HOME\etc\hadoop\yarn-site.xml"
    }

    if (!($hdiConfigFiles[$ConfigFileName])) {
        Write-HDILog "Unable tooconfigure $ConfigFileName because it is not part of hello HDI configuration files."
        return
    }

    [xml]$configFile = Get-Content $hdiConfigFiles[$ConfigFileName]

    $existingproperty = $configFile.configuration.property | where {$_.Name -eq $Name}

    if ($existingproperty) {
        $existingproperty.Value = $Value
        $existingproperty.Description = $Description
    } else {
        $newproperty = @($configFile.configuration.property)[0].Clone()
        $newproperty.Name = $Name
        $newproperty.Value = $Value
        $newproperty.Description = $Description
        $configFile.configuration.AppendChild($newproperty)
    }

    $configFile.Save($hdiConfigFiles[$ConfigFileName])

    Write-HDILog "$configFileName has been configured."

<span data-ttu-id="0a84d-125">script di Hello accetta quattro parametri, un nome di file di configurazione di hello, hello la proprietà toomodify, il valore di hello desiderato tooset e una descrizione.</span><span class="sxs-lookup"><span data-stu-id="0a84d-125">hello script takes four parameters, hello configuration file name, hello property you want toomodify, hello value you want tooset, and a description.</span></span> <span data-ttu-id="0a84d-126">ad esempio:</span><span class="sxs-lookup"><span data-stu-id="0a84d-126">For example:</span></span>

    hive-site.xml hive.metastore.client.socket.timeout 90

<span data-ttu-id="0a84d-127">Questi parametri imposta hello hive.metastore.client.socket.timeout valore too90 nel file hive-Site.XML hello.</span><span class="sxs-lookup"><span data-stu-id="0a84d-127">These parameters sets hello hive.metastore.client.socket.timeout value too90 in hello hive-site.xml file.</span></span>  <span data-ttu-id="0a84d-128">valore predefinito di Hello è 60 secondi.</span><span class="sxs-lookup"><span data-stu-id="0a84d-128">hello default value is 60 seconds.</span></span>

<span data-ttu-id="0a84d-129">Lo script di esempio è disponibile anche all'indirizzo [https://hditutorialdata.blob.core.windows.net/customizecluster/editSiteConfig.ps1](https://hditutorialdata.blob.core.windows.net/customizecluster/editSiteConfig.ps1).</span><span class="sxs-lookup"><span data-stu-id="0a84d-129">This sample script can also be found at [https://hditutorialdata.blob.core.windows.net/customizecluster/editSiteConfig.ps1](https://hditutorialdata.blob.core.windows.net/customizecluster/editSiteConfig.ps1).</span></span>

<span data-ttu-id="0a84d-130">HDInsight disponibili alcuni script di componenti aggiuntivi tooinstall nei cluster HDInsight:</span><span class="sxs-lookup"><span data-stu-id="0a84d-130">HDInsight provides several scripts tooinstall additional components on HDInsight clusters:</span></span>

| <span data-ttu-id="0a84d-131">Nome</span><span class="sxs-lookup"><span data-stu-id="0a84d-131">Name</span></span> | <span data-ttu-id="0a84d-132">Script</span><span class="sxs-lookup"><span data-stu-id="0a84d-132">Script</span></span> |
| --- | --- |
| <span data-ttu-id="0a84d-133">**Installare Spark**</span><span class="sxs-lookup"><span data-stu-id="0a84d-133">**Install Spark**</span></span> |<span data-ttu-id="0a84d-134">https://hdiconfigactions.blob.core.windows.net/sparkconfigactionv03/spark-installer-v03.ps1.</span><span class="sxs-lookup"><span data-stu-id="0a84d-134">https://hdiconfigactions.blob.core.windows.net/sparkconfigactionv03/spark-installer-v03.ps1.</span></span> <span data-ttu-id="0a84d-135">Vedere [Installare e usare Spark in cluster Hadoop di HDInsight][hdinsight-install-spark].</span><span class="sxs-lookup"><span data-stu-id="0a84d-135">See [Install and use Spark on HDInsight clusters][hdinsight-install-spark].</span></span> |
| <span data-ttu-id="0a84d-136">**Installare R**</span><span class="sxs-lookup"><span data-stu-id="0a84d-136">**Install R**</span></span> |<span data-ttu-id="0a84d-137">https://hdiconfigactions.blob.core.windows.net/rconfigactionv02/r-installer-v02.ps1.</span><span class="sxs-lookup"><span data-stu-id="0a84d-137">https://hdiconfigactions.blob.core.windows.net/rconfigactionv02/r-installer-v02.ps1.</span></span> <span data-ttu-id="0a84d-138">Vedere [Installare e usare R nei cluster HDInsight][hdinsight-r-scripts].</span><span class="sxs-lookup"><span data-stu-id="0a84d-138">See [Install and use R on HDInsight clusters][hdinsight-r-scripts].</span></span> |
| <span data-ttu-id="0a84d-139">**Installare Solr**</span><span class="sxs-lookup"><span data-stu-id="0a84d-139">**Install Solr**</span></span> |<span data-ttu-id="0a84d-140">https://hdiconfigactions.blob.core.windows.net/solrconfigactionv01/solr-installer-v01.ps1.</span><span class="sxs-lookup"><span data-stu-id="0a84d-140">https://hdiconfigactions.blob.core.windows.net/solrconfigactionv01/solr-installer-v01.ps1.</span></span> <span data-ttu-id="0a84d-141">Vedere [Installare e usare Solr nei cluster Hadoop di HDInsight](hdinsight-hadoop-solr-install.md).</span><span class="sxs-lookup"><span data-stu-id="0a84d-141">See [Install and use Solr on HDInsight clusters](hdinsight-hadoop-solr-install.md).</span></span> |
| <span data-ttu-id="0a84d-142">- **Installare Giraph**</span><span class="sxs-lookup"><span data-stu-id="0a84d-142">- **Install Giraph**</span></span> |<span data-ttu-id="0a84d-143">https://hdiconfigactions.blob.core.windows.net/giraphconfigactionv01/giraph-installer-v01.ps1.</span><span class="sxs-lookup"><span data-stu-id="0a84d-143">https://hdiconfigactions.blob.core.windows.net/giraphconfigactionv01/giraph-installer-v01.ps1.</span></span> <span data-ttu-id="0a84d-144">Vedere [Installare Giraph nei cluster HDInsight Hadoop](hdinsight-hadoop-giraph-install.md).</span><span class="sxs-lookup"><span data-stu-id="0a84d-144">See [Install and use Giraph on HDInsight clusters](hdinsight-hadoop-giraph-install.md).</span></span> |

<span data-ttu-id="0a84d-145">Genera script azione può essere distribuite da hello portale di Azure, Azure PowerShell o utilizzando hello HDInsight .NET SDK.</span><span class="sxs-lookup"><span data-stu-id="0a84d-145">Script Action can be deployed from hello Azure portal, Azure PowerShell or by using hello HDInsight .NET SDK.</span></span>  <span data-ttu-id="0a84d-146">Per altre informazioni, vedere [Personalizzare cluster HDInsight mediante l'azione script][hdinsight-cluster-customize].</span><span class="sxs-lookup"><span data-stu-id="0a84d-146">For more information, see [Customize HDInsight clusters using Script Action][hdinsight-cluster-customize].</span></span>

> [!NOTE]
> <span data-ttu-id="0a84d-147">script di esempio Hello funziona solo con una versione del cluster HDInsight 3.1 o successiva.</span><span class="sxs-lookup"><span data-stu-id="0a84d-147">hello sample scripts work only with HDInsight cluster version 3.1 or above.</span></span> <span data-ttu-id="0a84d-148">Per altre informazioni sulle versioni dei cluster HDInsight, vedere [Versioni cluster HDInsight](hdinsight-component-versioning.md).</span><span class="sxs-lookup"><span data-stu-id="0a84d-148">For more information on HDInsight cluster versions, see [HDInsight cluster versions](hdinsight-component-versioning.md).</span></span>
>
>

## <a name="helper-methods-for-custom-scripts"></a><span data-ttu-id="0a84d-149">Metodi helper per gli script personalizzati</span><span class="sxs-lookup"><span data-stu-id="0a84d-149">Helper methods for custom scripts</span></span>
<span data-ttu-id="0a84d-150">I metodi di supporto di Azione script sono utilità che è possibile usare durante la scrittura di script personalizzati.</span><span class="sxs-lookup"><span data-stu-id="0a84d-150">Script Action helper methods are utilities that you can use while writing custom scripts.</span></span> <span data-ttu-id="0a84d-151">Questi metodi sono definiti in [https://hdiconfigactions.blob.core.windows.net/configactionmodulev05/HDInsightUtilities-v05.psm1](https://hdiconfigactions.blob.core.windows.net/configactionmodulev05/HDInsightUtilities-v05.psm1)e possono essere inclusi negli script utilizzando hello seguente esempio:</span><span class="sxs-lookup"><span data-stu-id="0a84d-151">These methods are defined in [https://hdiconfigactions.blob.core.windows.net/configactionmodulev05/HDInsightUtilities-v05.psm1](https://hdiconfigactions.blob.core.windows.net/configactionmodulev05/HDInsightUtilities-v05.psm1), and can be included in your scripts using hello following sample:</span></span>

    # Download config action module from a well-known directory.
    $CONFIGACTIONURI = "https://hdiconfigactions.blob.core.windows.net/configactionmodulev05/HDInsightUtilities-v05.psm1";
    $CONFIGACTIONMODULE = "C:\apps\dist\HDInsightUtilities.psm1";
    $webclient = New-Object System.Net.WebClient;
    $webclient.DownloadFile($CONFIGACTIONURI, $CONFIGACTIONMODULE);

    # (TIP) Import config action helper method module toomake writing config action easy.
    if (Test-Path ($CONFIGACTIONMODULE))
    {
        Import-Module $CONFIGACTIONMODULE;
    }
    else
    {
        Write-Output "Failed tooload HDInsightUtilities module, exiting ...";
        exit;
    }

<span data-ttu-id="0a84d-152">Di seguito sono metodi di supporto hello forniti da questo script:</span><span class="sxs-lookup"><span data-stu-id="0a84d-152">Here are hello helper methods that are provided by this script:</span></span>

| <span data-ttu-id="0a84d-153">Metodo helper</span><span class="sxs-lookup"><span data-stu-id="0a84d-153">Helper method</span></span> | <span data-ttu-id="0a84d-154">Descrizione</span><span class="sxs-lookup"><span data-stu-id="0a84d-154">Description</span></span> |
| --- | --- |
| <span data-ttu-id="0a84d-155">**Save-HDIFile**</span><span class="sxs-lookup"><span data-stu-id="0a84d-155">**Save-HDIFile**</span></span> |<span data-ttu-id="0a84d-156">Scaricare un file da hello specificato percorso tooa identificatore URI (Uniform Resource) sul disco locale hello associato al cluster di hello Azure VM nodi toohello assegnato.</span><span class="sxs-lookup"><span data-stu-id="0a84d-156">Download a file from hello specified Uniform Resource Identifier (URI) tooa location on hello local disk that is associated with hello Azure VM node assigned toohello cluster.</span></span> |
| <span data-ttu-id="0a84d-157">**Expand-HDIZippedFile**</span><span class="sxs-lookup"><span data-stu-id="0a84d-157">**Expand-HDIZippedFile**</span></span> |<span data-ttu-id="0a84d-158">Decomprimere un file compresso.</span><span class="sxs-lookup"><span data-stu-id="0a84d-158">Unzip a zipped file.</span></span> |
| <span data-ttu-id="0a84d-159">**Invoke-HDICmdScript**</span><span class="sxs-lookup"><span data-stu-id="0a84d-159">**Invoke-HDICmdScript**</span></span> |<span data-ttu-id="0a84d-160">Eseguire uno script da cmd.exe.</span><span class="sxs-lookup"><span data-stu-id="0a84d-160">Run a script from cmd.exe.</span></span> |
| <span data-ttu-id="0a84d-161">**Write-HDILog**</span><span class="sxs-lookup"><span data-stu-id="0a84d-161">**Write-HDILog**</span></span> |<span data-ttu-id="0a84d-162">Scrivere l'output dello script di hello personalizzato utilizzato per un'azione di script.</span><span class="sxs-lookup"><span data-stu-id="0a84d-162">Write output from hello custom script used for a script action.</span></span> |
| <span data-ttu-id="0a84d-163">**Get-Services**</span><span class="sxs-lookup"><span data-stu-id="0a84d-163">**Get-Services**</span></span> |<span data-ttu-id="0a84d-164">Ottenere un elenco dei servizi in esecuzione nel computer di hello in cui viene eseguito uno script hello.</span><span class="sxs-lookup"><span data-stu-id="0a84d-164">Get a list of services running on hello machine where hello script executes.</span></span> |
| <span data-ttu-id="0a84d-165">**Get-Service**</span><span class="sxs-lookup"><span data-stu-id="0a84d-165">**Get-Service**</span></span> |<span data-ttu-id="0a84d-166">Nome del servizio specifico hello come input, di ottenere informazioni dettagliate per un servizio specifico (nome del servizio, ID processo, lo stato e così via) nel computer di hello in cui viene eseguito uno script hello.</span><span class="sxs-lookup"><span data-stu-id="0a84d-166">With hello specific service name as input, get detailed information for a specific service (service name, process ID, state, etc.) on hello machine where hello script executes.</span></span> |
| <span data-ttu-id="0a84d-167">**Get-HDIServices**</span><span class="sxs-lookup"><span data-stu-id="0a84d-167">**Get-HDIServices**</span></span> |<span data-ttu-id="0a84d-168">Ottenere un elenco dei servizi HDInsight in esecuzione nel computer di hello in cui viene eseguito uno script hello.</span><span class="sxs-lookup"><span data-stu-id="0a84d-168">Get a list of HDInsight services running on hello computer where hello script executes.</span></span> |
| <span data-ttu-id="0a84d-169">**Get-HDIService**</span><span class="sxs-lookup"><span data-stu-id="0a84d-169">**Get-HDIService**</span></span> |<span data-ttu-id="0a84d-170">Hello HDInsight servizio nome specifico come input, di ottenere informazioni dettagliate per un servizio specifico (nome del servizio, ID processo, lo stato e così via) nel computer di hello in cui viene eseguito uno script hello.</span><span class="sxs-lookup"><span data-stu-id="0a84d-170">With hello specific HDInsight service name as input, get detailed information for a specific service (service name, process ID, state, etc.) on hello machine where hello script executes.</span></span> |
| <span data-ttu-id="0a84d-171">**Get-ServicesRunning**</span><span class="sxs-lookup"><span data-stu-id="0a84d-171">**Get-ServicesRunning**</span></span> |<span data-ttu-id="0a84d-172">Ottenere un elenco di servizi in esecuzione nel computer di hello in cui viene eseguito uno script hello.</span><span class="sxs-lookup"><span data-stu-id="0a84d-172">Get a list of services that are running on hello computer where hello script executes.</span></span> |
| <span data-ttu-id="0a84d-173">**Get-ServiceRunning**</span><span class="sxs-lookup"><span data-stu-id="0a84d-173">**Get-ServiceRunning**</span></span> |<span data-ttu-id="0a84d-174">Controllare se un servizio specifico (per nome) è in esecuzione nel computer di hello in cui viene eseguito uno script hello.</span><span class="sxs-lookup"><span data-stu-id="0a84d-174">Check if a specific service (by name) is running on hello computer where hello script executes.</span></span> |
| <span data-ttu-id="0a84d-175">**Get-HDIServicesRunning**</span><span class="sxs-lookup"><span data-stu-id="0a84d-175">**Get-HDIServicesRunning**</span></span> |<span data-ttu-id="0a84d-176">Ottenere un elenco dei servizi HDInsight in esecuzione nel computer di hello in cui viene eseguito uno script hello.</span><span class="sxs-lookup"><span data-stu-id="0a84d-176">Get a list of HDInsight services running on hello computer where hello script executes.</span></span> |
| <span data-ttu-id="0a84d-177">**Get-HDIServiceRunning**</span><span class="sxs-lookup"><span data-stu-id="0a84d-177">**Get-HDIServiceRunning**</span></span> |<span data-ttu-id="0a84d-178">Controllare se un servizio HDInsight specifico (per nome) è in esecuzione nel computer di hello in cui viene eseguito uno script hello.</span><span class="sxs-lookup"><span data-stu-id="0a84d-178">Check if a specific HDInsight service (by name) is running on hello computer where hello script executes.</span></span> |
| <span data-ttu-id="0a84d-179">**Get-HDIHadoopVersion**</span><span class="sxs-lookup"><span data-stu-id="0a84d-179">**Get-HDIHadoopVersion**</span></span> |<span data-ttu-id="0a84d-180">Ottenere la versione di hello Hadoop installato nel computer di hello in cui viene eseguito uno script hello.</span><span class="sxs-lookup"><span data-stu-id="0a84d-180">Get hello version of Hadoop installed on hello computer where hello script executes.</span></span> |
| <span data-ttu-id="0a84d-181">**Test-IsHDIHeadNode**</span><span class="sxs-lookup"><span data-stu-id="0a84d-181">**Test-IsHDIHeadNode**</span></span> |<span data-ttu-id="0a84d-182">Verificare se il computer di hello in cui viene eseguito uno script hello è un nodo head.</span><span class="sxs-lookup"><span data-stu-id="0a84d-182">Check if hello computer where hello script executes is a head node.</span></span> |
| <span data-ttu-id="0a84d-183">**Test-IsActiveHDIHeadNode**</span><span class="sxs-lookup"><span data-stu-id="0a84d-183">**Test-IsActiveHDIHeadNode**</span></span> |<span data-ttu-id="0a84d-184">Verificare se il computer di hello in cui viene eseguito uno script hello è un nodo head attivo.</span><span class="sxs-lookup"><span data-stu-id="0a84d-184">Check if hello computer where hello script executes is an active head node.</span></span> |
| <span data-ttu-id="0a84d-185">**Test-IsHDIDataNode**</span><span class="sxs-lookup"><span data-stu-id="0a84d-185">**Test-IsHDIDataNode**</span></span> |<span data-ttu-id="0a84d-186">Verificare se il computer di hello in cui viene eseguito uno script hello è un nodo di dati.</span><span class="sxs-lookup"><span data-stu-id="0a84d-186">Check if hello computer where hello script executes is a data node.</span></span> |
| <span data-ttu-id="0a84d-187">**Edit-HDIConfigFile**</span><span class="sxs-lookup"><span data-stu-id="0a84d-187">**Edit-HDIConfigFile**</span></span> |<span data-ttu-id="0a84d-188">Modificare hello config file hive-Site.XML, Core-Site.XML, hdfs-Site.XML, mapred-Site.XML o yarn-Site.Xml.</span><span class="sxs-lookup"><span data-stu-id="0a84d-188">Edit hello config files hive-site.xml, core-site.xml, hdfs-site.xml, mapred-site.xml, or yarn-site.xml.</span></span> |

## <a name="best-practices-for-script-development"></a><span data-ttu-id="0a84d-189">Procedure consigliate per lo sviluppo di script</span><span class="sxs-lookup"><span data-stu-id="0a84d-189">Best practices for script development</span></span>
<span data-ttu-id="0a84d-190">Quando si sviluppa uno script personalizzato per un cluster HDInsight, sono disponibili diverse procedure tookeep di procedure consigliate in considerazione:</span><span class="sxs-lookup"><span data-stu-id="0a84d-190">When you develop a custom script for an HDInsight cluster, there are several best practices tookeep in mind:</span></span>

* <span data-ttu-id="0a84d-191">Controllo per la versione di Hadoop hello</span><span class="sxs-lookup"><span data-stu-id="0a84d-191">Check for hello Hadoop version</span></span>

    <span data-ttu-id="0a84d-192">Solo HDInsight versione 3.1 (Hadoop 2.4) e versioni successive supportano utilizzando i componenti personalizzati di tooinstall genera Script azione in un cluster.</span><span class="sxs-lookup"><span data-stu-id="0a84d-192">Only HDInsight version 3.1 (Hadoop 2.4) and above support using Script Action tooinstall custom components on a cluster.</span></span> <span data-ttu-id="0a84d-193">Nello script personalizzato, è necessario utilizzare hello **Get HDIHadoopVersion** helper metodo toocheck hello versione di Hadoop prima di procedere con l'esecuzione di altre attività nello script hello.</span><span class="sxs-lookup"><span data-stu-id="0a84d-193">In your custom script, you must use hello **Get-HDIHadoopVersion** helper method toocheck hello Hadoop version before proceeding with performing other tasks in hello script.</span></span>
* <span data-ttu-id="0a84d-194">Fornire stabile collega tooscript risorse</span><span class="sxs-lookup"><span data-stu-id="0a84d-194">Provide stable links tooscript resources</span></span>

    <span data-ttu-id="0a84d-195">Gli utenti devono assicurarsi che tutti gli script hello e altri artefatti usati in hello personalizzazione di un cluster rimangono disponibili per tutta la durata di hello del cluster hello e che le versioni di hello di questi file non cambiano per durata hello.</span><span class="sxs-lookup"><span data-stu-id="0a84d-195">Users should make sure that all hello scripts and other artifacts used in hello customization of a cluster remain available throughout hello lifetime of hello cluster and that hello versions of these files do not change for hello duration.</span></span> <span data-ttu-id="0a84d-196">Queste risorse sono necessarie se hello ricreando le immagini dei nodi nel cluster hello è obbligatorio.</span><span class="sxs-lookup"><span data-stu-id="0a84d-196">These resources are required if hello reimaging of nodes in hello cluster is required.</span></span> <span data-ttu-id="0a84d-197">procedura consigliata Hello è toodownload e archiviare tutti gli elementi di un account di archiviazione che hello controlli utente.</span><span class="sxs-lookup"><span data-stu-id="0a84d-197">hello best practice is toodownload and archive everything in a Storage account that hello user controls.</span></span> <span data-ttu-id="0a84d-198">Può trattarsi di account di archiviazione predefinito hello o qualsiasi hello aggiuntive di account di archiviazione specificato in fase di hello di distribuzione per un cluster personalizzato.</span><span class="sxs-lookup"><span data-stu-id="0a84d-198">This can be hello default Storage account or any of hello additional Storage accounts specified at hello time of deployment for a customized cluster.</span></span>
    <span data-ttu-id="0a84d-199">In hello Spark e R personalizzati esempi cluster fornite nella documentazione di hello, ad esempio, è stata introdotta una copia locale di risorse hello questo account di archiviazione: https://hdiconfigactions.blob.core.windows.net/.</span><span class="sxs-lookup"><span data-stu-id="0a84d-199">In hello Spark and R customized cluster samples provided in hello documentation, for example, we have made a local copy of hello resources in this Storage account: https://hdiconfigactions.blob.core.windows.net/.</span></span>
* <span data-ttu-id="0a84d-200">Verificare che uno script di personalizzazione cluster hello è idempotente</span><span class="sxs-lookup"><span data-stu-id="0a84d-200">Ensure that hello cluster customization script is idempotent</span></span>

    <span data-ttu-id="0a84d-201">È necessario prevedere che i nodi di un cluster HDInsight hello viene ricreata l'immagine nel corso della durata del cluster di hello.</span><span class="sxs-lookup"><span data-stu-id="0a84d-201">You must expect that hello nodes of an HDInsight cluster is reimaged during hello cluster lifetime.</span></span> <span data-ttu-id="0a84d-202">script di personalizzazione di Hello cluster viene eseguito ogni volta che viene ricreata l'immagine di un cluster.</span><span class="sxs-lookup"><span data-stu-id="0a84d-202">hello cluster customization script is run whenever a cluster is reimaged.</span></span> <span data-ttu-id="0a84d-203">Questo script deve essere idempotente toobe progettato in senso hello che al momento di ricreazione dell'immagine, script hello deve assicurare che tale cluster hello è restituiti stesso personalizzato dello stato in cui era subito dopo hello script è stato eseguito per hello prima ora cluster hello inizialmente toohello creato.</span><span class="sxs-lookup"><span data-stu-id="0a84d-203">This script must be designed toobe idempotent in hello sense that upon reimaging, hello script should ensure that hello cluster is returned toohello same customized state that it was in just after hello script ran for hello first time when hello cluster was initially created.</span></span> <span data-ttu-id="0a84d-204">Ad esempio, se uno script personalizzato installata un'applicazione in D:\AppLocation la prima esecuzione, quindi ogni successiva esecuzione, al momento di ricreazione dell'immagine, script hello deve verificare l'esistenza di un'applicazione hello in hello D:\AppLocation percorso prima di procedere con altre passaggi in uno script hello.</span><span class="sxs-lookup"><span data-stu-id="0a84d-204">For example, if a custom script installed an application at D:\AppLocation on its first run, then on each subsequent run, upon reimaging, hello script should check whether hello application exists at hello D:\AppLocation location before proceeding with other steps in hello script.</span></span>
* <span data-ttu-id="0a84d-205">Installare i componenti personalizzati in posizione ottimale hello</span><span class="sxs-lookup"><span data-stu-id="0a84d-205">Install custom components in hello optimal location</span></span>

    <span data-ttu-id="0a84d-206">Quando vengano ricreata l'immagine di nodi del cluster, unità di risorsa C:\ hello e unità di sistema D:\ può essere riformattati, pertanto hello perdita di dati e applicazioni installate in tali unità.</span><span class="sxs-lookup"><span data-stu-id="0a84d-206">When cluster nodes are reimaged, hello C:\ resource drive and D:\ system drive can be reformatted, resulting in hello loss of data and applications that had been installed on those drives.</span></span> <span data-ttu-id="0a84d-207">Questo problema può verificarsi anche se un nodo di macchina virtuale di Azure (VM) che fa parte del cluster hello diventa inattivo e viene sostituito da un nuovo nodo.</span><span class="sxs-lookup"><span data-stu-id="0a84d-207">This could also happen if an Azure virtual machine (VM) node that is part of hello cluster goes down and is replaced by a new node.</span></span> <span data-ttu-id="0a84d-208">È possibile installare i componenti hello unità D:\ o nel percorso C:\apps hello cluster hello.</span><span class="sxs-lookup"><span data-stu-id="0a84d-208">You can install components on hello D:\ drive or in hello C:\apps location on hello cluster.</span></span> <span data-ttu-id="0a84d-209">Tutti gli altri percorsi in hello unità C:\ sono riservati.</span><span class="sxs-lookup"><span data-stu-id="0a84d-209">All other locations on hello C:\ drive are reserved.</span></span> <span data-ttu-id="0a84d-210">Specificare hello percorso in cui le applicazioni o librerie toobe installato in uno script di personalizzazione di hello del cluster.</span><span class="sxs-lookup"><span data-stu-id="0a84d-210">Specify hello location where applications or libraries are toobe installed in hello cluster customization script.</span></span>
* <span data-ttu-id="0a84d-211">Verificare la disponibilità elevata dell'architettura di cluster hello</span><span class="sxs-lookup"><span data-stu-id="0a84d-211">Ensure high availability of hello cluster architecture</span></span>

    <span data-ttu-id="0a84d-212">HDInsight è un'architettura attivo-passivo per la disponibilità elevata, in cui un nodo head è in modalità attiva (in cui sono in esecuzione servizi HDInsight hello) e altri hello nodo head è in modalità standby (nella quale HDInsight servizi non vengono eseguiti).</span><span class="sxs-lookup"><span data-stu-id="0a84d-212">HDInsight has an active-passive architecture for high availability, in which one head node is in active mode (where hello HDInsight services are running) and hello other head node is in standby mode (in which HDInsight services are not running).</span></span> <span data-ttu-id="0a84d-213">nodi Hello cambiare la modalità di attive e passive se HDInsight vengono interrotti.</span><span class="sxs-lookup"><span data-stu-id="0a84d-213">hello nodes switch active and passive modes if HDInsight services are interrupted.</span></span> <span data-ttu-id="0a84d-214">Se un'azione di script è servizi tooinstall usato in entrambi i nodi head per la disponibilità elevata, si noti che il meccanismo di failover di HDInsight hello non fail tooautomatically in grado di questi servizi installato dall'utente.</span><span class="sxs-lookup"><span data-stu-id="0a84d-214">If a script action is used tooinstall services on both head nodes for high availability, note that hello HDInsight failover mechanism is not able tooautomatically fail over these user-installed services.</span></span> <span data-ttu-id="0a84d-215">Servizi pertanto installato dall'utente nei nodi head HDInsight che sono previsti toobe a disponibilità elevata devono essere dispongono di un proprio meccanismo di failover se è in modalità attiva-passiva o in modalità attivo-attivo.</span><span class="sxs-lookup"><span data-stu-id="0a84d-215">So user-installed services on HDInsight head nodes that are expected toobe highly available must either have their own failover mechanism if in active-passive mode or be in active-active mode.</span></span>

    <span data-ttu-id="0a84d-216">Viene eseguito un comando di HDInsight genera Script azione in entrambi i nodi head quando il ruolo del nodo head hello è specificato come valore di hello *ClusterRoleCollection* parametro.</span><span class="sxs-lookup"><span data-stu-id="0a84d-216">An HDInsight Script Action command runs on both head nodes when hello head-node role is specified as a value in hello *ClusterRoleCollection* parameter.</span></span> <span data-ttu-id="0a84d-217">Pertanto, quando si progetta uno script personalizzato, assicurarsi che lo script tenga conto di questa impostazione.</span><span class="sxs-lookup"><span data-stu-id="0a84d-217">So when you design a custom script, make sure that your script is aware of this setup.</span></span> <span data-ttu-id="0a84d-218">È consigliabile non eseguire problemi in cui hello stessi servizi sono installati e avviati su entrambi i nodi head hello e finiscono con competizione tra loro.</span><span class="sxs-lookup"><span data-stu-id="0a84d-218">You should not run into problems where hello same services are installed and started on both of hello head nodes and they end up competing with each other.</span></span> <span data-ttu-id="0a84d-219">Inoltre, tenere presente che i dati vengano persi durante la ricreazione dell'immagine, in modo software installato tramite l'azione di Script ha toobe toosuch resilienti eventi.</span><span class="sxs-lookup"><span data-stu-id="0a84d-219">Also, be aware that data is lost during reimaging, so software installed via Script Action has toobe resilient toosuch events.</span></span> <span data-ttu-id="0a84d-220">Applicazioni devono essere progettate toowork con disponibilità elevata dei dati sono distribuita in molti nodi.</span><span class="sxs-lookup"><span data-stu-id="0a84d-220">Applications should be designed toowork with highly available data that is distributed across many nodes.</span></span> <span data-ttu-id="0a84d-221">Si noti che può essere ricreata l'immagine di un massimo di 1/5 di nodi hello in un cluster in hello contemporaneamente.</span><span class="sxs-lookup"><span data-stu-id="0a84d-221">Note that as many as 1/5 of hello nodes in a cluster can be reimaged at hello same time.</span></span>
* <span data-ttu-id="0a84d-222">Configurare l'archiviazione Blob di Azure toouse componenti personalizzati di hello</span><span class="sxs-lookup"><span data-stu-id="0a84d-222">Configure hello custom components toouse Azure Blob storage</span></span>

    <span data-ttu-id="0a84d-223">i componenti personalizzati Hello installata nei nodi del cluster hello potrebbero essere un toouse di configurazione predefinito archiviazione Hadoop Distributed File System (HDFS).</span><span class="sxs-lookup"><span data-stu-id="0a84d-223">hello custom components that you install on hello cluster nodes might have a default configuration toouse Hadoop Distributed File System (HDFS) storage.</span></span> <span data-ttu-id="0a84d-224">In alternativa, è necessario modificare hello configurazione toouse archiviazione Blob di Azure.</span><span class="sxs-lookup"><span data-stu-id="0a84d-224">You should change hello configuration toouse Azure Blob storage instead.</span></span> <span data-ttu-id="0a84d-225">In una nuova immagine del cluster, hello HDFS file system Ottiene formattato e si perderanno tutti i dati sono archiviati.</span><span class="sxs-lookup"><span data-stu-id="0a84d-225">On a cluster reimage, hello HDFS file system gets formatted and you would lose any data that is stored there.</span></span> <span data-ttu-id="0a84d-226">Se invece si usa l'archivio BLOB di Azure, i dati vengono mantenuti.</span><span class="sxs-lookup"><span data-stu-id="0a84d-226">Using Azure Blob storage instead ensures that your data is retained.</span></span>

## <a name="common-usage-patterns"></a><span data-ttu-id="0a84d-227">Modelli di utilizzo comuni</span><span class="sxs-lookup"><span data-stu-id="0a84d-227">Common usage patterns</span></span>
<span data-ttu-id="0a84d-228">Questa sezione vengono fornite informazioni aggiuntive sull'implementazione di alcuni dei modelli di utilizzo comuni hello che potrebbero essere generati durante la scrittura di script personalizzato.</span><span class="sxs-lookup"><span data-stu-id="0a84d-228">This section provides guidance on implementing some of hello common usage patterns that you might run into while writing your own custom script.</span></span>

### <a name="configure-environment-variables"></a><span data-ttu-id="0a84d-229">Configurare le variabili di ambiente</span><span class="sxs-lookup"><span data-stu-id="0a84d-229">Configure environment variables</span></span>
<span data-ttu-id="0a84d-230">Spesso nello sviluppo di azione di script, si ritiene hello necessario tooset le variabili di ambiente.</span><span class="sxs-lookup"><span data-stu-id="0a84d-230">Often in script action development, you feel hello need tooset environment variables.</span></span> <span data-ttu-id="0a84d-231">Ad esempio, uno scenario più probabile è quando si scarica un file binario da un sito esterno, installarlo nel cluster hello e aggiunta hello posizione in cui è installato tooyour variabile di ambiente 'PATH'.</span><span class="sxs-lookup"><span data-stu-id="0a84d-231">For instance, a most likely scenario is when you download a binary from an external site, install it on hello cluster, and add hello location of where it is installed tooyour ‘PATH’ environment variable.</span></span> <span data-ttu-id="0a84d-232">Hello frammento di codice seguente viene illustrato come le variabili di ambiente tooset in hello script personalizzato.</span><span class="sxs-lookup"><span data-stu-id="0a84d-232">hello following snippet shows you how tooset environment variables in hello custom script.</span></span>

    Write-HDILog "Starting environment variable setting at: $(Get-Date)";
    [Environment]::SetEnvironmentVariable('MDS_RUNNER_CUSTOM_CLUSTER', 'true', 'Machine');

<span data-ttu-id="0a84d-233">Questa istruzione consente di impostare la variabile di ambiente hello **MDS_RUNNER_CUSTOM_CLUSTER** toohello valore 'true', nonché set hello ambito di questa variabile toobe a livello di computer.</span><span class="sxs-lookup"><span data-stu-id="0a84d-233">This statement sets hello environment variable **MDS_RUNNER_CUSTOM_CLUSTER** toohello value 'true' and also sets hello scope of this variable toobe machine-wide.</span></span> <span data-ttu-id="0a84d-234">In alcuni casi è importante che le variabili di ambiente sono impostate in ambito appropriato hello-computer o dell'utente.</span><span class="sxs-lookup"><span data-stu-id="0a84d-234">At times it is important that environment variables are set at hello appropriate scope – machine or user.</span></span> <span data-ttu-id="0a84d-235">Vedere [qui][1] per altre informazioni sull'impostazione delle variabili di ambiente.</span><span class="sxs-lookup"><span data-stu-id="0a84d-235">Refer [here][1] for more information on setting environment variables.</span></span>

### <a name="access-toolocations-where-hello-custom-scripts-are-stored"></a><span data-ttu-id="0a84d-236">Accesso toolocations in cui sono archiviati gli script personalizzati hello</span><span class="sxs-lookup"><span data-stu-id="0a84d-236">Access toolocations where hello custom scripts are stored</span></span>
<span data-ttu-id="0a84d-237">Script utilizzati toocustomize tooeither di esigenze di un cluster trovarsi nell'account di archiviazione predefinito hello per cluster hello o in un contenitore di sola lettura pubblico in qualsiasi altro account di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="0a84d-237">Scripts used toocustomize a cluster needs tooeither be in hello default storage account for hello cluster or in a public read-only container on any other storage account.</span></span> <span data-ttu-id="0a84d-238">Se lo script accede a risorse che si trovano in un' posizione, questi devono toobe in accessibile pubblicamente (pubblici almeno sola lettura).</span><span class="sxs-lookup"><span data-stu-id="0a84d-238">If your script accesses resources located elsewhere these need toobe in a publicly accessible (at least public read-only).</span></span> <span data-ttu-id="0a84d-239">Ad esempio si tooaccess un file e salvarlo con il comando hello SaveFile HDI.</span><span class="sxs-lookup"><span data-stu-id="0a84d-239">For instance you might want tooaccess a file and save it using hello SaveFile-HDI command.</span></span>

    Save-HDIFile -SrcUri 'https://somestorageaccount.blob.core.windows.net/somecontainer/some-file.jar' -DestFile 'C:\apps\dist\hadoop-2.4.0.2.1.9.0-2196\share\hadoop\mapreduce\some-file.jar'

<span data-ttu-id="0a84d-240">In questo esempio, è necessario assicurarsi che il contenitore hello 'somecontainer' in 'somestorageaccount' account di archiviazione è accessibile pubblicamente.</span><span class="sxs-lookup"><span data-stu-id="0a84d-240">In this example, you must ensure that hello container 'somecontainer' in storage account 'somestorageaccount' is publicly accessible.</span></span> <span data-ttu-id="0a84d-241">In caso contrario, script hello genera un'eccezione "Non trovato" e non riuscire.</span><span class="sxs-lookup"><span data-stu-id="0a84d-241">Otherwise, hello script throws a ‘Not Found’ exception and fail.</span></span>

### <a name="pass-parameters-toohello-add-azurermhdinsightscriptaction-cmdlet"></a><span data-ttu-id="0a84d-242">Passare parametri toohello Aggiungi AzureRmHDInsightScriptAction cmdlet</span><span class="sxs-lookup"><span data-stu-id="0a84d-242">Pass parameters toohello Add-AzureRmHDInsightScriptAction cmdlet</span></span>
<span data-ttu-id="0a84d-243">toopass più parametri toohello Aggiungi AzureRmHDInsightScriptAction cmdlet, è necessario tooformat hello stringa valore toocontain tutti i parametri per lo script hello.</span><span class="sxs-lookup"><span data-stu-id="0a84d-243">toopass multiple parameters toohello Add-AzureRmHDInsightScriptAction cmdlet, you need tooformat hello string value toocontain all parameters for hello script.</span></span> <span data-ttu-id="0a84d-244">ad esempio:</span><span class="sxs-lookup"><span data-stu-id="0a84d-244">For example:</span></span>

    "-CertifcateUri wasb:///abc.pfx -CertificatePassword 123456 -InstallFolderName MyFolder"

<span data-ttu-id="0a84d-245">oppure</span><span class="sxs-lookup"><span data-stu-id="0a84d-245">or</span></span>

    $parameters = '-Parameters "{0};{1};{2}"' -f $CertificateName,$certUriWithSasToken,$CertificatePassword


### <a name="throw-exception-for-failed-cluster-deployment"></a><span data-ttu-id="0a84d-246">Generare un'eccezione per la distribuzione cluster non riuscita</span><span class="sxs-lookup"><span data-stu-id="0a84d-246">Throw exception for failed cluster deployment</span></span>
<span data-ttu-id="0a84d-247">Se si desidera tooget una notifica in modo accurato dei fatti hello di personalizzazione di cluster non è stata eseguita come previsto, è importante toothrow un'eccezione e la creazione di cluster hello di esito negativo.</span><span class="sxs-lookup"><span data-stu-id="0a84d-247">If you want tooget accurately notified of hello fact that cluster customization did not succeed as expected, it is important toothrow an exception and fail hello cluster creation.</span></span> <span data-ttu-id="0a84d-248">Ad esempio, si potrebbe essere necessario tooprocess un file se esiste e gestire il caso di errore hello file hello in cui non esiste.</span><span class="sxs-lookup"><span data-stu-id="0a84d-248">For instance, you might want tooprocess a file if it exists and handle hello error case where hello file does not exist.</span></span> <span data-ttu-id="0a84d-249">In tal modo che script hello viene chiuso normalmente e stato hello del cluster di hello correttamente è noto.</span><span class="sxs-lookup"><span data-stu-id="0a84d-249">This would ensure that hello script exits gracefully and hello state of hello cluster is correctly known.</span></span> <span data-ttu-id="0a84d-250">Hello frammento di codice seguente viene fornito un esempio di come tooachieve questo:</span><span class="sxs-lookup"><span data-stu-id="0a84d-250">hello following snippet gives an example of how tooachieve this:</span></span>

    If(Test-Path($SomePath)) {
        #Process file in some way
    } else {
        # File does not exist; handle error case
        # Print error message
    exit
    }

<span data-ttu-id="0a84d-251">In questo frammento di codice, se il file hello non esiste, potrebbe causare tooa stato in cui hello script effettivamente viene chiuso normalmente dopo la stampa il messaggio di errore hello e cluster hello raggiunge uno stato di esecuzione presupponendo che "" completato il processo di personalizzazione di cluster.</span><span class="sxs-lookup"><span data-stu-id="0a84d-251">In this snippet, if hello file did not exist, it would lead tooa state where hello script actually exits gracefully after printing hello error message, and hello cluster reaches running state assuming it "successfully" completed cluster customization process.</span></span> <span data-ttu-id="0a84d-252">Se si desidera toobe una notifica in modo accurato dei fatti hello personalizzazione cluster essenzialmente non è stata eseguita come previsto a causa di un file mancante, è più appropriato toothrow un'eccezione e imposti hello cluster personalizzazione passaggio non riuscito.</span><span class="sxs-lookup"><span data-stu-id="0a84d-252">If you want toobe accurately notified of hello fact that cluster customization essentially did not succeed as expected because of a missing file, it is more appropriate toothrow an exception and fail hello cluster customization step.</span></span> <span data-ttu-id="0a84d-253">tooachieve scopo, è necessario usare hello seguente frammento di codice di esempio invece.</span><span class="sxs-lookup"><span data-stu-id="0a84d-253">tooachieve this you must use hello following sample code snippet instead.</span></span>

    If(Test-Path($SomePath)) {
        #Process file in some way
    } else {
        # File does not exist; handle error case
        # Print error message
    throw
    }


## <a name="checklist-for-deploying-a-script-action"></a><span data-ttu-id="0a84d-254">Elenco di controllo per la distribuzione di un'azione script</span><span class="sxs-lookup"><span data-stu-id="0a84d-254">Checklist for deploying a script action</span></span>
<span data-ttu-id="0a84d-255">Ecco i passaggi di hello effettuati durante la preparazione di questi script toodeploy:</span><span class="sxs-lookup"><span data-stu-id="0a84d-255">Here are hello steps we took when preparing toodeploy these scripts:</span></span>

1. <span data-ttu-id="0a84d-256">Inserire i file hello che contengono gli script personalizzati hello in una posizione accessibile dai nodi di cluster hello durante la distribuzione.</span><span class="sxs-lookup"><span data-stu-id="0a84d-256">Put hello files that contain hello custom scripts in a place that is accessible by hello cluster nodes during deployment.</span></span> <span data-ttu-id="0a84d-257">Può trattarsi di qualsiasi valore predefinito di hello o altri account di archiviazione specificato in fase di distribuzione di cluster, o qualsiasi altro contenitore di archiviazione accessibile pubblicamente di hello.</span><span class="sxs-lookup"><span data-stu-id="0a84d-257">This can be any of hello default or additional Storage accounts specified at hello time of cluster deployment, or any other publicly accessible storage container.</span></span>
2. <span data-ttu-id="0a84d-258">Aggiungere i controlli in script toomake si è certi che vengono eseguiti in modo idempotente, in modo che script hello può essere eseguito più volte su hello stesso nodo.</span><span class="sxs-lookup"><span data-stu-id="0a84d-258">Add checks into scripts toomake sure that they execute idempotently, so that hello script can be executed multiple times on hello same node.</span></span>
3. <span data-ttu-id="0a84d-259">Hello utilizzare **Write-Output** tooSTDOUT tooprint cmdlet di Azure PowerShell, nonché STDERR.</span><span class="sxs-lookup"><span data-stu-id="0a84d-259">Use hello **Write-Output** Azure PowerShell cmdlet tooprint tooSTDOUT as well as STDERR.</span></span> <span data-ttu-id="0a84d-260">Non usare **Write-Host**.</span><span class="sxs-lookup"><span data-stu-id="0a84d-260">Do not use **Write-Host**.</span></span>
4. <span data-ttu-id="0a84d-261">Utilizzare una cartella di file temporaneo, ad esempio $env: TEMP, tookeep hello file scaricato utilizzato dagli script hello e quindi li elimina dopo aver eseguito gli script.</span><span class="sxs-lookup"><span data-stu-id="0a84d-261">Use a temporary file folder, such as $env:TEMP, tookeep hello downloaded file used by hello scripts and then clean them up after scripts have executed.</span></span>
5. <span data-ttu-id="0a84d-262">Installare il software personalizzato solo in D:\ o C:\apps.</span><span class="sxs-lookup"><span data-stu-id="0a84d-262">Install custom software only at D:\ or C:\apps.</span></span> <span data-ttu-id="0a84d-263">Altre posizioni nell'unità c: hello non devono essere utilizzati poiché sono riservate.</span><span class="sxs-lookup"><span data-stu-id="0a84d-263">Other locations on hello C: drive should not be used as they are reserved.</span></span> <span data-ttu-id="0a84d-264">Si noti che l'installazione di file nell'unità c: hello esterni alla cartella C:\apps hello potrebbe causare errori durante l'installazione durante reimages del nodo hello.</span><span class="sxs-lookup"><span data-stu-id="0a84d-264">Note that installing files on hello C: drive outside of hello C:\apps folder may result in setup failures during reimages of hello node.</span></span>
6. <span data-ttu-id="0a84d-265">In caso di hello che siano stati modificati le impostazioni a livello del sistema operativo o i file di configurazione del servizio di Hadoop, è consigliabile toorestart HDInsight servizi in modo che sia possibile acquisiscono le impostazioni a livello del sistema operativo, ad esempio le variabili di ambiente hello set negli script hello.</span><span class="sxs-lookup"><span data-stu-id="0a84d-265">In hello event that OS-level settings or Hadoop service configuration files were changed, you may want toorestart HDInsight services so that they can pick up any OS-level settings, such as hello environment variables set in hello scripts.</span></span>

## <a name="debug-custom-scripts"></a><span data-ttu-id="0a84d-266">Eseguire il debug degli script personalizzati</span><span class="sxs-lookup"><span data-stu-id="0a84d-266">Debug custom scripts</span></span>
<span data-ttu-id="0a84d-267">vengono archiviati i log degli errori di script Hello, insieme a altro output, nell'account di archiviazione hello predefinito specificato per il cluster hello al momento della relativa creazione.</span><span class="sxs-lookup"><span data-stu-id="0a84d-267">hello script error logs are stored, along with other output, in hello default Storage account that you specified for hello cluster at its creation.</span></span> <span data-ttu-id="0a84d-268">Hello i log vengono archiviati in una tabella con nome hello *u < \cluster-name-fragment >< \time-stamp > setuplog*.</span><span class="sxs-lookup"><span data-stu-id="0a84d-268">hello logs are stored in a table with hello name *u<\cluster-name-fragment><\time-stamp>setuplog*.</span></span> <span data-ttu-id="0a84d-269">Questi sono registri aggregati che presentano record da tutti i nodi hello (nodo head e i nodi di lavoro) in cui hello script viene eseguito nel cluster hello.</span><span class="sxs-lookup"><span data-stu-id="0a84d-269">These are aggregated logs that have records from all of hello nodes (head node and worker nodes) on which hello script runs in hello cluster.</span></span>
<span data-ttu-id="0a84d-270">Un modo semplice i registri di hello toocheck è toouse di strumenti di HDInsight per Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="0a84d-270">An easy way toocheck hello logs is toouse HDInsight Tools for Visual Studio.</span></span> <span data-ttu-id="0a84d-271">Per installare gli strumenti di hello, vedere [iniziare a usare gli strumenti di Visual Studio Hadoop per HDInsight](hdinsight-hadoop-visual-studio-tools-get-started.md#install-data-lake-tools-for-visual-studio)</span><span class="sxs-lookup"><span data-stu-id="0a84d-271">For installing hello tools, see [Get started using Visual Studio Hadoop tools for HDInsight](hdinsight-hadoop-visual-studio-tools-get-started.md#install-data-lake-tools-for-visual-studio)</span></span>

<span data-ttu-id="0a84d-272">**log di hello toocheck utilizzando Visual Studio**</span><span class="sxs-lookup"><span data-stu-id="0a84d-272">**toocheck hello log using Visual Studio**</span></span>

1. <span data-ttu-id="0a84d-273">Aprire Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="0a84d-273">Open Visual Studio.</span></span>
2. <span data-ttu-id="0a84d-274">Fare clic su **Visualizza** e quindi su **Esplora server**.</span><span class="sxs-lookup"><span data-stu-id="0a84d-274">Click **View**, and then click **Server Explorer**.</span></span>
3. <span data-ttu-id="0a84d-275">Fare doppio clic su "Azure", fare clic su Connetti troppo**sottoscrizioni di Microsoft Azure**e quindi immettere le credenziali.</span><span class="sxs-lookup"><span data-stu-id="0a84d-275">Right-click "Azure", click Connect too**Microsoft Azure Subscriptions**, and then enter your credentials.</span></span>
4. <span data-ttu-id="0a84d-276">Espandere **archiviazione**, espandere account di archiviazione di Azure hello utilizzato come file system predefinito hello **tabelle**e quindi fare doppio clic sul nome della tabella hello.</span><span class="sxs-lookup"><span data-stu-id="0a84d-276">Expand **Storage**, expand hello Azure storage account used as hello default file system, expand **Tables**, and then double-click hello table name.</span></span>

<span data-ttu-id="0a84d-277">È possibile anche remoto in toosee di nodi cluster hello sia STDOUT e STDERR per gli script personalizzati.</span><span class="sxs-lookup"><span data-stu-id="0a84d-277">You can also remote into hello cluster nodes toosee both STDOUT and STDERR for custom scripts.</span></span> <span data-ttu-id="0a84d-278">Hello i log in ogni nodo sono nodo toothat solo specifico e vengono registrati in **C:\HDInsightLogs\DeploymentAgent.log**.</span><span class="sxs-lookup"><span data-stu-id="0a84d-278">hello logs on each node are specific only toothat node and are logged into **C:\HDInsightLogs\DeploymentAgent.log**.</span></span> <span data-ttu-id="0a84d-279">Questi file di log registrano tutti gli output di uno script personalizzato hello.</span><span class="sxs-lookup"><span data-stu-id="0a84d-279">These log files record all outputs from hello custom script.</span></span> <span data-ttu-id="0a84d-280">Un frammento di log di esempio per un'azione script Spark è simile a quanto riportato di seguito:</span><span class="sxs-lookup"><span data-stu-id="0a84d-280">An example log snippet for a Spark script action looks like this:</span></span>

    Microsoft.Hadoop.Deployment.Engine.CustomPowershellScriptCommand; Details : BEGIN: Invoking powershell script https://configactions.blob.core.windows.net/sparkconfigactions/spark-installer.ps1.;
    Version : 2.1.0.0;
    ActivityId : 739e61f5-aa22-4254-aafc-9faf56fc2692;
    AzureVMName : HEADNODE0;
    IsException : False;
    ExceptionType : ;
    ExceptionMessage : ;
    InnerExceptionType : ;
    InnerExceptionMessage : ;
    Exception : ;
    ...

    Starting Spark installation at: 09/04/2014 21:46:02 Done with Spark installation at: 09/04/2014 21:46:38;

    Version : 2.1.0.0;
    ActivityId : 739e61f5-aa22-4254-aafc-9faf56fc2692;
    AzureVMName : HEADNODE0;
    IsException : False;
    ExceptionType : ;
    ExceptionMessage : ;
    InnerExceptionType : ;
    InnerExceptionMessage : ;
    Exception : ;
    ...

    Microsoft.Hadoop.Deployment.Engine.CustomPowershellScriptCommand;
    Details : END: Invoking powershell script https://configactions.blob.core.windows.net/sparkconfigactions/spark-installer.ps1.;
    Version : 2.1.0.0;
    ActivityId : 739e61f5-aa22-4254-aafc-9faf56fc2692;
    AzureVMName : HEADNODE0;
    IsException : False;
    ExceptionType : ;
    ExceptionMessage : ;
    InnerExceptionType : ;
    InnerExceptionMessage : ;
    Exception : ;


<span data-ttu-id="0a84d-281">In questo log, è evidente che l'azione di script Spark hello è stato eseguito nella macchina virtuale denominata HEADNODE0 hello e che non sono state generate eccezioni durante l'esecuzione di hello.</span><span class="sxs-lookup"><span data-stu-id="0a84d-281">In this log, it is clear that hello Spark script action has been executed on hello VM named HEADNODE0 and that no exceptions were thrown during hello execution.</span></span>

<span data-ttu-id="0a84d-282">In caso di hello che si verifica un errore di esecuzione, che descrive il output di hello è contenuta anche in questo file di log.</span><span class="sxs-lookup"><span data-stu-id="0a84d-282">In hello event that an execution failure occurs, hello output describing it is also contained in this log file.</span></span> <span data-ttu-id="0a84d-283">informazioni di Hello fornite in questi registri devono essere utile eseguire il debug di problemi di script che possono verificarsi.</span><span class="sxs-lookup"><span data-stu-id="0a84d-283">hello information provided in these logs should be helpful in debugging script problems that may arise.</span></span>

## <a name="see-also"></a><span data-ttu-id="0a84d-284">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="0a84d-284">See also</span></span>
* <span data-ttu-id="0a84d-285">[Personalizzare cluster HDInsight mediante l'azione script][hdinsight-cluster-customize]</span><span class="sxs-lookup"><span data-stu-id="0a84d-285">[Customize HDInsight clusters using Script Action][hdinsight-cluster-customize]</span></span>
* <span data-ttu-id="0a84d-286">[Installare e usare Spark nei cluster HDInsight][hdinsight-install-spark]</span><span class="sxs-lookup"><span data-stu-id="0a84d-286">[Install and use Spark on HDInsight clusters][hdinsight-install-spark]</span></span>
* <span data-ttu-id="0a84d-287">[Installare e usare R nei cluster HDInsight][hdinsight-r-scripts]</span><span class="sxs-lookup"><span data-stu-id="0a84d-287">[Install and use R on HDInsight clusters][hdinsight-r-scripts]</span></span>
* <span data-ttu-id="0a84d-288">[Installare e usare Solr nei cluster HDInsight](hdinsight-hadoop-solr-install.md).</span><span class="sxs-lookup"><span data-stu-id="0a84d-288">[Install and use Solr on HDInsight clusters](hdinsight-hadoop-solr-install.md).</span></span>
* <span data-ttu-id="0a84d-289">[Installare e usare Giraph nei cluster HDInsight](hdinsight-hadoop-giraph-install.md).</span><span class="sxs-lookup"><span data-stu-id="0a84d-289">[Install and use Giraph on HDInsight clusters](hdinsight-hadoop-giraph-install.md).</span></span>

[hdinsight-provision]: hdinsight-provision-clusters.md
[hdinsight-cluster-customize]: hdinsight-hadoop-customize-cluster.md
[hdinsight-install-spark]: hdinsight-hadoop-spark-install.md
[hdinsight-r-scripts]: hdinsight-hadoop-r-scripts.md
[powershell-install-configure]: install-configure-powershell.md

<!--Reference links in article-->
[1]: https://msdn.microsoft.com/library/96xafkes(v=vs.110).aspx
