---
title: "Uso di set di scalabilità di macchine virtuali di Azure di grandi dimensioni | Documentazione Microsoft"
description: "Informazioni utili per usare set di scalabilità di macchine virtuali di Azure di grandi dimensioni"
services: virtual-machine-scale-sets
documentationcenter: 
author: gbowerman
manager: timlt
editor: 
tags: azure-resource-manager
ms.assetid: 76ac7fd7-2e05-4762-88ca-3b499e87906e
ms.service: virtual-machine-scale-sets
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: get-started-article
ms.date: 2/7/2017
ms.author: guybo
ms.openlocfilehash: 9e9eae1623e55c1c05e97aa0b836819ce5dc16f9
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/03/2017
---
# <a name="working-with-large-virtual-machine-scale-sets"></a><span data-ttu-id="15323-103">Uso di set di scalabilità di macchine virtuali di grandi dimensioni</span><span class="sxs-lookup"><span data-stu-id="15323-103">Working with large virtual machine scale sets</span></span>
<span data-ttu-id="15323-104">È ora possibile creare [set di scalabilità di macchine virtuali](/azure/virtual-machine-scale-sets/) di Azure con capacità fino a 1.000 VM.</span><span class="sxs-lookup"><span data-stu-id="15323-104">You can now create Azure [virtual machine scale sets](/azure/virtual-machine-scale-sets/) with a capacity of up to 1,000 VMs.</span></span> <span data-ttu-id="15323-105">In questo documento è definito _set di scalabilità di macchine virtuali di grandi dimensioni_ un set di scalabilità ridimensionabile fino a oltre 100 VM.</span><span class="sxs-lookup"><span data-stu-id="15323-105">In this document, a _large virtual machine scale set_ is defined as a scale set capable of scaling to greater than 100 VMs.</span></span> <span data-ttu-id="15323-106">Tale funzionalità è impostata da una proprietà del set di scalabilità (_singlePlacementGroup=False_).</span><span class="sxs-lookup"><span data-stu-id="15323-106">This capability is set by a scale set property (_singlePlacementGroup=False_).</span></span> 

<span data-ttu-id="15323-107">Nei set di scalabilità di grandi dimensioni, alcuni aspetti, come il bilanciamento del carico e i domini di errore, presentano un comportamento diverso rispetto ai set di scalabilità standard.</span><span class="sxs-lookup"><span data-stu-id="15323-107">Certain aspects of large scale sets, such as load balancing and fault domains behave differently to a standard scale set.</span></span> <span data-ttu-id="15323-108">Questo documento illustra le caratteristiche dei set di scalabilità di grandi dimensioni e offre informazioni utili per usarli correttamente nelle applicazioni.</span><span class="sxs-lookup"><span data-stu-id="15323-108">This document explains the characteristics of large scale sets, and describes what you need to know to successfully use them in your applications.</span></span> 

<span data-ttu-id="15323-109">Un approccio comune per distribuire un'infrastruttura cloud su larga scala consiste nel creare un set di _unità di scala_, ad esempio creando più set di scalabilità di macchine virtuali in più reti virtuali e account di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="15323-109">A common approach for deploying cloud infrastructure at large scale is to create a set of _scale units_, for example by creating multiple VMs scale sets across multiple VNETs and storage accounts.</span></span> <span data-ttu-id="15323-110">Questo approccio offre una gestione più semplice rispetto alle VM singole e la presenza di più unità di scala è utile per numerose applicazioni, in particolare per quelle che richiedono altri componenti organizzabili in stack come più reti virtuali ed endpoint.</span><span class="sxs-lookup"><span data-stu-id="15323-110">This approach provides easier management compared to single VMs, and multiple scale units are useful for many applications, particularly those that require other stackable components like multiple virtual networks and endpoints.</span></span> <span data-ttu-id="15323-111">Se l'applicazione richiede un singolo cluster di grandi dimensioni, tuttavia, può essere più semplice distribuire un singolo set di scalabilità con un massimo di 1.000 VM.</span><span class="sxs-lookup"><span data-stu-id="15323-111">If your application requires a single large cluster however, it can be more straightforward to deploy a single scale set of up to 1,000 VMs.</span></span> <span data-ttu-id="15323-112">Gli scenari di esempio includono distribuzioni centralizzate di Big Data o griglie di calcolo che richiedono una gestione semplice di un esteso pool di nodi di lavoro.</span><span class="sxs-lookup"><span data-stu-id="15323-112">Example scenarios include centralized big data deployments, or compute grids requiring simple management of a large pool of worker nodes.</span></span> <span data-ttu-id="15323-113">In combinazione con i [dischi dati collegati](virtual-machine-scale-sets-attached-disks.md) dei set di scalabilità di macchine virtuali, i set di scalabilità di grandi dimensioni consentono di distribuire un'infrastruttura scalabile costituita da migliaia di core e petabyte di spazio di archiviazione in un'unica operazione.</span><span class="sxs-lookup"><span data-stu-id="15323-113">Combined with VM scale set [attached data disks](virtual-machine-scale-sets-attached-disks.md), large scale sets enable you to deploy a scalable infrastructure consisting of thousands of cores and petabytes of storage, as a single operation.</span></span>

## <a name="placement-groups"></a><span data-ttu-id="15323-114">Gruppi di posizionamento</span><span class="sxs-lookup"><span data-stu-id="15323-114">Placement groups</span></span> 
<span data-ttu-id="15323-115">La caratteristica distintiva di un set di scalabilità _di grandi dimensioni_ non è il numero di VM, ma il numero di _gruppi di posizionamento_ che contiene.</span><span class="sxs-lookup"><span data-stu-id="15323-115">What makes a _large_ scale set special is not the number of VMs, but the number of _placement groups_ it contains.</span></span> <span data-ttu-id="15323-116">Un gruppo di posizionamento è un costrutto simile a un set di disponibilità di Azure, con specifici domini di errore e di aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="15323-116">A placement group is a construct similar to an Azure availability set, with its own fault domains and upgrade domains.</span></span> <span data-ttu-id="15323-117">Per impostazione predefinita, un set di scalabilità è costituito da un singolo gruppo di posizionamento con una dimensione massima di 100 VM.</span><span class="sxs-lookup"><span data-stu-id="15323-117">By default, a scale set consists of a single placement group with a maximum size of 100 VMs.</span></span> <span data-ttu-id="15323-118">Se la proprietà del set di scalabilità denominata _singlePlacementGroup_ è impostata su _false_, il set può essere costituito da più gruppi di posizionamento con un intervallo da 0 a 1.000 VM.</span><span class="sxs-lookup"><span data-stu-id="15323-118">If a scale set property called _singlePlacementGroup_ is set to _false_, the scale set can be composed of multiple placement groups and has a range of 0-1,000 VMs.</span></span> <span data-ttu-id="15323-119">Quando la proprietà è impostata sul valore predefinito _true_, un set di scalabilità è costituito da un singolo gruppo di posizionamento, con un intervallo da 0 a 100 VM.</span><span class="sxs-lookup"><span data-stu-id="15323-119">When set to the default value of _true_, a scale set is composed of a single placement group, and has a range of 0-100 VMs.</span></span>

## <a name="checklist-for-using-large-scale-sets"></a><span data-ttu-id="15323-120">Elenco di controllo per l'uso di set di scalabilità di grandi dimensioni</span><span class="sxs-lookup"><span data-stu-id="15323-120">Checklist for using large scale sets</span></span>
<span data-ttu-id="15323-121">Per stabilire se l'applicazione può usare in modo efficace set di scalabilità di grandi dimensioni, considerare i requisiti seguenti:</span><span class="sxs-lookup"><span data-stu-id="15323-121">To decide whether your application can make effective use of large scale sets, consider the following requirements:</span></span>

- <span data-ttu-id="15323-122">I set di scalabilità di grandi dimensioni richiedono Azure Managed Disks.</span><span class="sxs-lookup"><span data-stu-id="15323-122">Large scale sets require Azure Managed Disks.</span></span> <span data-ttu-id="15323-123">Per i set di scalabilità non creati con Managed Disks sono necessari più account di archiviazione (uno ogni 20 VM).</span><span class="sxs-lookup"><span data-stu-id="15323-123">Scale sets that are not created with Managed Disks require multiple storage accounts (one for every 20 VMs).</span></span> <span data-ttu-id="15323-124">I set di scalabilità di grandi dimensioni sono progettati per usare esclusivamente Managed Disks, per ridurre il sovraccarico nella gestione dell'archiviazione ed evitare il rischio di raggiungere i limiti della sottoscrizione per gli account di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="15323-124">Large scale sets are designed to work exclusively with Managed Disks to reduce your storage management overhead, and to avoid the risk of running into subscription limits for storage accounts.</span></span> <span data-ttu-id="15323-125">Se non si usa Managed Disks, il set di scalabilità è limitato a 100 VM.</span><span class="sxs-lookup"><span data-stu-id="15323-125">If you do not use Managed Disks, your scale set is limited to 100 VMs.</span></span>
- <span data-ttu-id="15323-126">I set di scalabilità creati da immagini di Azure Marketplace sono ridimensionabili fino a 1.000 VM.</span><span class="sxs-lookup"><span data-stu-id="15323-126">Scale sets created from Azure Marketplace images can scale up to 1,000 VMs.</span></span>
- <span data-ttu-id="15323-127">I set di scalabilità creati da immagini personalizzate (ossia immagini di VM create e caricate dall'utente) sono attualmente ridimensionabili fino a 100 VM.</span><span class="sxs-lookup"><span data-stu-id="15323-127">Scale sets created from custom images (VM images you create and upload yourself) can currently scale up to 100 VMs.</span></span>
- <span data-ttu-id="15323-128">Il bilanciamento del carico di livello 4 con Azure Load Balancer non è ancora supportato per i set di scalabilità costituiti da più gruppi di posizionamento.</span><span class="sxs-lookup"><span data-stu-id="15323-128">Layer-4 load balancing with the Azure Load Balancer is not yet supported for scale sets composed of multiple placement groups.</span></span> <span data-ttu-id="15323-129">Se è necessario usare Azure Load Balancer, verificare che il set di scalabilità sia configurato per l'uso di un singolo gruppo di posizionamento, come da impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="15323-129">If you need to use the Azure Load Balancer make sure the scale set is configured to use a single placement group, which is the default setting.</span></span>
- <span data-ttu-id="15323-130">Il bilanciamento del carico di livello 7 con il gateway applicazione di Azure è supportato per tutti i set di scalabilità.</span><span class="sxs-lookup"><span data-stu-id="15323-130">Layer-7 load balancing with the Azure Application Gateway is supported for all scale sets.</span></span>
- <span data-ttu-id="15323-131">Un set di scalabilità è definito con una singola subnet. Verificare che lo spazio indirizzi della subnet sia sufficiente per tutte le VM necessarie.</span><span class="sxs-lookup"><span data-stu-id="15323-131">A scale set is defined with a single subnet - make sure your subnet has an address space large enough for all the VMs you need.</span></span> <span data-ttu-id="15323-132">Per impostazione predefinita, un set di scalabilità effettua un provisioning eccessivo (ossia crea VM aggiuntive, per cui non vengono applicati addebiti, in fase di distribuzione o quando si aumenta il numero di istanze) per migliorare l'affidabilità e le prestazioni della distribuzione.</span><span class="sxs-lookup"><span data-stu-id="15323-132">By default a scale set overprovisions (creates extra VMs at deployment time or when scaling out, which you are not charged for) to improve deployment reliability and performance.</span></span> <span data-ttu-id="15323-133">Prevedere uno spazio indirizzi superiore del 20% rispetto al numero di VM a cui si intende eseguire il ridimensionamento.</span><span class="sxs-lookup"><span data-stu-id="15323-133">Allow for an address space 20% greater than the number of VMs you plan to scale to.</span></span>
- <span data-ttu-id="15323-134">Se si pianifica di distribuire molte VM, potrebbe essere necessario aumentare i limiti di quota dei core di calcolo.</span><span class="sxs-lookup"><span data-stu-id="15323-134">If you are planning to deploy many VMs, your Compute core quota limits may need to be increased.</span></span>
- <span data-ttu-id="15323-135">I domini di errore e di aggiornamento sono coerenti solo all'interno di un gruppo di posizionamento.</span><span class="sxs-lookup"><span data-stu-id="15323-135">Fault domains and upgrade domains are only consistent within a placement group.</span></span> <span data-ttu-id="15323-136">Questa architettura non modifica la disponibilità generale di un set di scalabilità, perché le VM sono distribuite in modo uniforme su hardware fisico distinto. Se è necessario garantire che due VM risiedano in hardware diverso, tuttavia, verificare che si trovino in domini di errore diversi nello stesso gruppo di posizionamento.</span><span class="sxs-lookup"><span data-stu-id="15323-136">This architecture does not change the overall availability of a scale set, as VMs are evenly distributed across distinct physical hardware, but it does means that if you need to guarantee two VMs are on different hardware, make sure they are in different fault domains in the same placement group.</span></span> <span data-ttu-id="15323-137">Il dominio di errore e l'ID del gruppo di posizionamento sono riportati nella _visualizzazione dell'istanza_ di una VM del set di scalabilità.</span><span class="sxs-lookup"><span data-stu-id="15323-137">Fault domain and placement group ID are shown in the _instance view_ of a scale set VM.</span></span> <span data-ttu-id="15323-138">La visualizzazione dell'istanza di una VM del set di scalabilità è disponibile in [Esplora risorse di Azure](https://resources.azure.com/).</span><span class="sxs-lookup"><span data-stu-id="15323-138">You can view the instance view of a scale set VM in the [Azure Resource Explorer](https://resources.azure.com/).</span></span>


## <a name="creating-a-large-scale-set"></a><span data-ttu-id="15323-139">Creazione di un set di scalabilità di grandi dimensioni</span><span class="sxs-lookup"><span data-stu-id="15323-139">Creating a large scale set</span></span>
<span data-ttu-id="15323-140">Quando si crea un set di scalabilità nel portale di Azure, è possibile consentire il ridimensionamento a più gruppi di posizionamento impostando l'opzione _Limit to a single placement group_ (Limita a singolo gruppo di posizionamento) su _False_ nel pannello _Informazioni di base_.</span><span class="sxs-lookup"><span data-stu-id="15323-140">When you create a scale set in the Azure portal, you can allow it to scale to multiple placement groups by setting the _Limit to a single placement group_ option to _False_ in the _Basics_ blade.</span></span> <span data-ttu-id="15323-141">Con questa opzione impostata su _False_, è possibile specificare un valore fino a 1.000 in _Numero di istanze_.</span><span class="sxs-lookup"><span data-stu-id="15323-141">With this option set to _False_, you can specify an _Instance count_ value of up to 1,000.</span></span>

![](./media/virtual-machine-scale-sets-placement-groups/portal-large-scale.png)

<span data-ttu-id="15323-142">È possibile creare un set di scalabilità di macchine virtuali di grandi dimensioni con il comando _az vmss create_ dell'[interfaccia della riga di comando di Azure](https://github.com/Azure/azure-cli).</span><span class="sxs-lookup"><span data-stu-id="15323-142">You can create a large VM scale set using the [Azure CLI](https://github.com/Azure/azure-cli) _az vmss create_ command.</span></span> <span data-ttu-id="15323-143">Questo comando configura impostazioni predefinite intelligenti, ad esempio dimensioni di subnet basate sull'argomento _instance-count_:</span><span class="sxs-lookup"><span data-stu-id="15323-143">This command sets intelligent defaults such as subnet size based on the _instance-count_ argument:</span></span>

```bash
az group create -l southcentralus -n biginfra
az vmss create -g biginfra -n bigvmss --image ubuntults --instance-count 1000
```
<span data-ttu-id="15323-144">Si noti che il comando _vmss create_ imposta alcuni valori di configurazione predefiniti se non vengono specificati dall'utente.</span><span class="sxs-lookup"><span data-stu-id="15323-144">Note that the _vmss create_ command defaults certain configuration values if you do not specify them.</span></span> <span data-ttu-id="15323-145">Per visualizzare le opzioni che possono essere sostituite, provare il comando seguente:</span><span class="sxs-lookup"><span data-stu-id="15323-145">To see the available options that you can override, try:</span></span>
```bash
az vmss create --help
```

<span data-ttu-id="15323-146">Se si crea un set di scalabilità di grandi dimensioni componendo un modello di Azure Resource Manager, verificare che il modello crei un set di scalabilità basato su Azure Managed Disks.</span><span class="sxs-lookup"><span data-stu-id="15323-146">If you are creating a large scale set by composing an Azure Resource Manager template, make sure the template creates a scale set based on Azure Managed Disks.</span></span> <span data-ttu-id="15323-147">È possibile impostare la proprietà _singlePlacementGroup_ su _false_ nella sezione _properties_ della risorsa _Microsoft.Compute/virtualMAchineScaleSets_.</span><span class="sxs-lookup"><span data-stu-id="15323-147">You can set the _singlePlacementGroup_ property to _false_ in the _properties_ section of the _Microsoft.Compute/virtualMAchineScaleSets_ resource.</span></span> <span data-ttu-id="15323-148">Il frammento JSON seguente mostra l'inizio di un modello di set di scalabilità, con una capacità di 1.000 VM e l'impostazione _"singlePlacementGroup": false_:</span><span class="sxs-lookup"><span data-stu-id="15323-148">The following JSON fragment shows the beginning of a scale set template, including the 1,000 VM capacity and the _"singlePlacementGroup" : false_ setting:</span></span>
```json
{
  "type": "Microsoft.Compute/virtualMachineScaleSets",
  "location": "australiaeast",
  "name": "bigvmss",
  "sku": {
    "name": "Standard_DS1_v2",
    "tier": "Standard",
    "capacity": 1000
  },
  "properties": {
    "singlePlacementGroup": false,
    "upgradePolicy": {
      "mode": "Automatic"
    }
```
<span data-ttu-id="15323-149">Per un esempio completo di modello di set di scalabilità di grandi dimensioni, vedere [https://github.com/gbowerman/azure-myriad/blob/master/bigtest/bigbottle.json](https://github.com/gbowerman/azure-myriad/blob/master/bigtest/bigbottle.json).</span><span class="sxs-lookup"><span data-stu-id="15323-149">For a complete example of a large scale set template, refer to [https://github.com/gbowerman/azure-myriad/blob/master/bigtest/bigbottle.json](https://github.com/gbowerman/azure-myriad/blob/master/bigtest/bigbottle.json).</span></span>

## <a name="converting-an-existing-scale-set-to-span-multiple-placement-groups"></a><span data-ttu-id="15323-150">Conversione di un set di scalabilità esistente per includere più gruppi di posizionamento</span><span class="sxs-lookup"><span data-stu-id="15323-150">Converting an existing scale set to span multiple placement groups</span></span>
<span data-ttu-id="15323-151">Per consentire il ridimensionamento di un set di scalabilità di macchine virtuali esistente a più di 100 VM, è necessario modificare la proprietà _singlePlacementGroup_ impostandola su _false_ nel modello di set di scalabilità.</span><span class="sxs-lookup"><span data-stu-id="15323-151">To make an existing VM scale set capable of scaling to more than 100 VMs, you need to change the _singplePlacementGroup_ property to _false_ in the scale set model.</span></span> <span data-ttu-id="15323-152">È possibile testare la modifica di questa proprietà con [Esplora risorse di Azure](https://resources.azure.com/).</span><span class="sxs-lookup"><span data-stu-id="15323-152">You can test changing this property with the [Azure Resource Explorer](https://resources.azure.com/).</span></span> <span data-ttu-id="15323-153">Trovare un set di scalabilità esistente, selezionare _Edit_ (Modifica) e modificare la proprietà _singlePlacementGroup_.</span><span class="sxs-lookup"><span data-stu-id="15323-153">Find an existing scale set, select _Edit_ and change the _singlePlacementGroup_ property.</span></span> <span data-ttu-id="15323-154">Se questa proprietà non è visualizzata, è possibile che si stia visualizzando il set di scalabilità con una versione precedente dell'API Microsoft.Compute.</span><span class="sxs-lookup"><span data-stu-id="15323-154">If you do not see this property, you may be viewing the scale set with an older version of the Microsoft.Compute API.</span></span>

>[!NOTE] 
<span data-ttu-id="15323-155">È possibile modificare una set di scalabilità passando dal supporto di un singolo gruppo di posizionamento (comportamento predefinito) al supporto di più gruppi di posizionamento, ma non eseguire la conversione inversa.</span><span class="sxs-lookup"><span data-stu-id="15323-155">You can change a scale set from supporting a single placement group only (the default behavior) to a supporting multiple placement groups, but you cannot convert the other way around.</span></span> <span data-ttu-id="15323-156">Di conseguenza, prima di effettuare la conversione è importante comprendere le proprietà dei set di scalabilità di grandi dimensioni.</span><span class="sxs-lookup"><span data-stu-id="15323-156">Therefore make sure you understand the properties of large scale sets before converting.</span></span> <span data-ttu-id="15323-157">In particolare, verificare che non sia necessario il bilanciamento del carico di livello 4 con Azure Load Balancer.</span><span class="sxs-lookup"><span data-stu-id="15323-157">In particular, make sure you do not need layer-4 load balancing with the Azure Load Balancer.</span></span>


