---
title: Progettare modelli di Azure per soluzioni complesse | Documentazione Microsoft
description: Illustra le procedure consigliate per la progettazione di modelli di Azure Resource Manager per scenari complessi
services: azure-resource-manager
documentationcenter: 
author: tfitzmac
manager: timlt
editor: tysonn
ms.assetid: ce1141d6-ece7-4976-acea-1db1f775409e
ms.service: azure-resource-manager
ms.workload: multiple
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 12/19/2016
ms.author: tomfitz
ms.openlocfilehash: dcc31f7a8c85a8f7fbd554371a66fb1e348bca17
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/03/2017
---
# <a name="design-patterns-for-azure-resource-manager-templates-when-deploying-complex-solutions"></a><span data-ttu-id="c8115-103">Modelli di progettazione per modelli di Azure Resource Manager durante la distribuzione di soluzioni complesse</span><span class="sxs-lookup"><span data-stu-id="c8115-103">Design patterns for Azure Resource Manager templates when deploying complex solutions</span></span>
<span data-ttu-id="c8115-104">Usando un approccio flessibile basato sui modelli di Azure Resource Manager, è possibile distribuire topologie complesse in modo rapido e coerente.</span><span class="sxs-lookup"><span data-stu-id="c8115-104">Using a flexible approach based on Azure Resource Manager templates, you can deploy complex topologies quickly and consistently.</span></span> <span data-ttu-id="c8115-105">È possibile adattare facilmente queste distribuzioni man mano che le offerte principali cambiano o inserire varianti per scenari o clienti esterni.</span><span class="sxs-lookup"><span data-stu-id="c8115-105">You can adapt these deployments easily as core offerings evolve or to accommodate variants for outlier scenarios or customers.</span></span>

<span data-ttu-id="c8115-106">Questo argomento fa parte di un white paper di dimensioni maggiori.</span><span class="sxs-lookup"><span data-stu-id="c8115-106">This topic is part of a larger whitepaper.</span></span> <span data-ttu-id="c8115-107">Per leggere il documento completo, scaricare [World Class Azure Resource Manager Templates Considerations and Proven Practices](http://download.microsoft.com/download/8/E/1/8E1DBEFA-CECE-4DC9-A813-93520A5D7CFE/World Class ARM Templates - Considerations and Proven Practices.pdf) (Considerazioni e procedure consigliate sui modelli di Azure Resource Manager a livello internazionale).</span><span class="sxs-lookup"><span data-stu-id="c8115-107">To read the full paper, download [World Class Azure Resource Manager Templates Considerations and Proven Practices](http://download.microsoft.com/download/8/E/1/8E1DBEFA-CECE-4DC9-A813-93520A5D7CFE/World Class ARM Templates - Considerations and Proven Practices.pdf).</span></span>

<span data-ttu-id="c8115-108">I modelli uniscono i vantaggi della Gestione risorse di Azure sottostante con l'adattabilità e la leggibilità di JavaScript Object Notation (JSON).</span><span class="sxs-lookup"><span data-stu-id="c8115-108">Templates combine the benefits of the underlying Azure Resource Manager with the adaptability and readability of JavaScript Object Notation (JSON).</span></span> <span data-ttu-id="c8115-109">Utilizzando i modelli, è possibile:</span><span class="sxs-lookup"><span data-stu-id="c8115-109">Using templates, you can:</span></span>

* <span data-ttu-id="c8115-110">Distribuire in modo coerente le topologie e i relativi carichi di lavoro.</span><span class="sxs-lookup"><span data-stu-id="c8115-110">Deploy topologies and their workloads consistently.</span></span>
* <span data-ttu-id="c8115-111">Gestire tutte le risorse di un'applicazione contemporaneamente utilizzando gruppi di risorse.</span><span class="sxs-lookup"><span data-stu-id="c8115-111">Manage all your resources in an application together using resource groups.</span></span>
* <span data-ttu-id="c8115-112">Applicare il controllo dell'accesso basato sui ruoli (RBAC) per concedere l'accesso appropriato a utenti, gruppi e servizi.</span><span class="sxs-lookup"><span data-stu-id="c8115-112">Apply role-based access control (RBAC) to grant appropriate access to users, groups, and services.</span></span>
* <span data-ttu-id="c8115-113">Utilizzare le associazioni di assegnazione di tag per semplificare attività come i rollup di fatturazione.</span><span class="sxs-lookup"><span data-stu-id="c8115-113">Use tagging associations to streamline tasks such as billing rollups.</span></span>

<span data-ttu-id="c8115-114">In questo articolo vengono fornite informazioni dettagliate su scenari di utilizzo, architettura e modelli di implementazione identificati durante le sessioni di progettazione e implementazioni reali dei modelli con i clienti di Azure Customer Advisory Team (AzureCAT).</span><span class="sxs-lookup"><span data-stu-id="c8115-114">This article provides details on consumption scenarios, architecture, and implementation patterns identified during our design sessions and real-world template implementations with Azure Customer Advisory Team (AzureCAT) customers.</span></span> <span data-ttu-id="c8115-115">Lungi dall'essere accademici, questi approcci sono procedure consolidate derivanti dallo sviluppo di modelli per 12 delle principali tecnologie OSS basate su Linux, tra cui: Apache Kafka, Apache Spark, Cloudera, Couchbase, Hortonworks HDP, DataStax Enterprise basato su tecnologia Apache Cassandra, Elasticsearch, Jenkins, MongoDB, PostgreSQL, Redis e Nagios.</span><span class="sxs-lookup"><span data-stu-id="c8115-115">Far from academic, these approaches are proven practices informed by the development of templates for 12 of the top Linux-based OSS technologies, including: Apache Kafka, Apache Spark, Cloudera, Couchbase, Hortonworks HDP, DataStax Enterprise powered by Apache Cassandra, Elasticsearch, Jenkins, MongoDB, PostgreSQL, Redis, and Nagios.</span></span> 

<span data-ttu-id="c8115-116">Nel presente articolo vengono proposte queste procedure consolidate allo scopo di agevolare la progettazione di modelli di Gestione risorse di Azure di elevata qualità.</span><span class="sxs-lookup"><span data-stu-id="c8115-116">This article shares these proven practices to help you architect world class Azure Resource Manager templates.</span></span>  

<span data-ttu-id="c8115-117">Lavorando con i clienti, è stata identificata una serie di esperienze di utilizzo dei modelli di Resource Manager tra aziende, system integrator (SI) e CSV.</span><span class="sxs-lookup"><span data-stu-id="c8115-117">In our work with customers, we have identified several Resource Manager template consumption experiences across enterprises, System Integrators (SI)s, and CSVs.</span></span> <span data-ttu-id="c8115-118">Le sezioni seguenti forniscono una panoramica generale di scenari e modelli comuni per diversi tipi di clienti.</span><span class="sxs-lookup"><span data-stu-id="c8115-118">The following sections provide a high-level overview of common scenarios and patterns for different customer types.</span></span>

## <a name="enterprises-and-system-integrators"></a><span data-ttu-id="c8115-119">Aziende e integratori di sistemi</span><span class="sxs-lookup"><span data-stu-id="c8115-119">Enterprises and system integrators</span></span>
<span data-ttu-id="c8115-120">Nelle organizzazioni di grandi dimensioni, si osservano comunemente due consumer di modelli di Resource Manager: team di sviluppo di software interno e IT aziendale.</span><span class="sxs-lookup"><span data-stu-id="c8115-120">Within large organizations, we commonly see two consumers of Resource Manager templates: internal software development teams and corporate IT.</span></span> <span data-ttu-id="c8115-121">È risultato evidente che gli scenari relativi agli SI sono associati a quelli delle grandi imprese, quindi si applicano le stesse considerazioni.</span><span class="sxs-lookup"><span data-stu-id="c8115-121">We've found that the scenarios for the SIs map to the scenarios for Enterprises, so the same considerations apply.</span></span>

### <a name="internal-software-development-teams"></a><span data-ttu-id="c8115-122">Team di sviluppo di software interno</span><span class="sxs-lookup"><span data-stu-id="c8115-122">Internal software development teams</span></span>
<span data-ttu-id="c8115-123">Se il team sviluppa software per supportare l'azienda, i modelli forniscono un modo semplice per distribuire rapidamente le tecnologie da utilizzare in soluzioni specifiche per l'azienda.</span><span class="sxs-lookup"><span data-stu-id="c8115-123">If your team develops software to support your business, templates provide an easy way to quickly deploy technologies for use in business-specific solutions.</span></span> <span data-ttu-id="c8115-124">I modelli possono inoltre essere utilizzati per creare rapidamente ambienti di formazione che consentano ai membri del team di acquisire le competenze necessarie.</span><span class="sxs-lookup"><span data-stu-id="c8115-124">You can also use templates to rapidly create training environments that enable team members to gain necessary skills.</span></span>

<span data-ttu-id="c8115-125">È possibile utilizzare modelli così come sono oppure estenderli o comporli per adeguarli alle proprie esigenze.</span><span class="sxs-lookup"><span data-stu-id="c8115-125">You can use templates as-is or extend or compose them to accommodate your needs.</span></span> <span data-ttu-id="c8115-126">Utilizzando l'associazione di tag all'interno dei modelli, è possibile fornire un riepilogo di fatturazione con varie viste quali team, progetto, utente e formazione.</span><span class="sxs-lookup"><span data-stu-id="c8115-126">Using tagging within templates, you can provide a billing summary with various views such as team, project, individual, and education.</span></span>

<span data-ttu-id="c8115-127">Spesso le aziende chiedono ai team di sviluppo software di creare un modello che consenta la distribuzione uniforme di una soluzione.</span><span class="sxs-lookup"><span data-stu-id="c8115-127">Businesses often want software development teams to create a template for consistent deployment of a solution.</span></span> <span data-ttu-id="c8115-128">Il modello semplifica i vincoli in modo che alcuni elementi all'interno di tale ambiente rimangono fissi e non possano essere sottoposti a override.</span><span class="sxs-lookup"><span data-stu-id="c8115-128">The template facilitates constraints so certain items within that environment remain fixed and can't be overridden.</span></span> <span data-ttu-id="c8115-129">Ad esempio una banca potrebbe richiedere un modello per includere lo RBAC al fine di evitare che un programmatore possa modificare una soluzione di banking per inviare dati a un account di archiviazione personale.</span><span class="sxs-lookup"><span data-stu-id="c8115-129">For example, a bank might require a template to include RBAC so a programmer can’t revise a banking solution to send data to a personal storage account.</span></span>

### <a name="corporate-it"></a><span data-ttu-id="c8115-130">IT aziendale</span><span class="sxs-lookup"><span data-stu-id="c8115-130">Corporate IT</span></span>
<span data-ttu-id="c8115-131">Le organizzazioni IT aziendali in genere utilizzano modelli per la distribuzione di capacità cloud e funzionalità ospitate su cloud.</span><span class="sxs-lookup"><span data-stu-id="c8115-131">Corporate IT organizations typically use templates for delivering cloud capacity and cloud-hosted capabilities.</span></span>

#### <a name="cloud-capacity"></a><span data-ttu-id="c8115-132">Capacità cloud</span><span class="sxs-lookup"><span data-stu-id="c8115-132">Cloud capacity</span></span>
<span data-ttu-id="c8115-133">Un metodo comune adottato dai gruppi IT aziendali per fornire capacità cloud ai team sono le "taglie", ovvero dimensioni di offerta standard quali small, medium e large.</span><span class="sxs-lookup"><span data-stu-id="c8115-133">A common way for corporate IT groups to provide cloud capacity for teams is with "t-shirt sizes", which are standard offering sizes such as small, medium, and large.</span></span> <span data-ttu-id="c8115-134">Le offerte basate sulle taglie possono combinare tipi e quantità differenti di risorse fornendo al tempo stesso un livello di standardizzazione che consente di utilizzare i modelli.</span><span class="sxs-lookup"><span data-stu-id="c8115-134">The t-shirt sized offerings can mix different resource types and quantities while providing a level of standardization that makes it possible to use templates.</span></span> <span data-ttu-id="c8115-135">I modelli offrono capacità in modo coerente permettendo l'applicazione dei criteri aziendali e l'utilizzo dell'associazione di tag per fornire funzionalità di chargeback alle organizzazioni che ne fanno uso.</span><span class="sxs-lookup"><span data-stu-id="c8115-135">The templates deliver capacity in a consistent way that enforces corporate policies and uses tagging to provide chargeback to consuming organizations.</span></span>

<span data-ttu-id="c8115-136">Ad esempio, potrebbe essere necessario fornire ambienti di sviluppo, test o produzione all'interno dei quali i team di sviluppo software possono distribuire le relative soluzioni.</span><span class="sxs-lookup"><span data-stu-id="c8115-136">For example, you may need to provide development, test, or production environments within which the software development teams can deploy their solutions.</span></span> <span data-ttu-id="c8115-137">L'ambiente ha una topologia di rete predefinita ed elementi non modificabili dai team di sviluppo software, quali le regole che controllano l'accesso alla rete Internet pubblica e l'ispezione dei pacchetti.</span><span class="sxs-lookup"><span data-stu-id="c8115-137">The environment has a predefined network topology and elements that the software development teams cannot change, such as rules governing access to the public internet and packet inspection.</span></span> <span data-ttu-id="c8115-138">Per tali ambienti potrebbero anche esistere regole specifiche dell'organizzazione con diritti di accesso distinti per l'ambiente.</span><span class="sxs-lookup"><span data-stu-id="c8115-138">You may also have organization-specific roles for these environments with distinct access rights for the environment.</span></span>

#### <a name="cloud-hosted-capabilities"></a><span data-ttu-id="c8115-139">Funzionalità ospitate nel cloud</span><span class="sxs-lookup"><span data-stu-id="c8115-139">Cloud-hosted capabilities</span></span>
<span data-ttu-id="c8115-140">È possibile utilizzare modelli per supportare funzionalità ospitate nel cloud, tra cui singoli pacchetti software oppure offerte combinate disponibili per le linee interne di business.</span><span class="sxs-lookup"><span data-stu-id="c8115-140">You can use templates to support cloud-hosted capabilities, including individual software packages or composite offerings that are offered to internal lines of business.</span></span> <span data-ttu-id="c8115-141">Un esempio di offerta combinata è l'analytics-as-a-service, tecnologie di analisi, virtualizzazione e altre tecnologie, fornita in una configurazione ottimizzata e connessa in una topologia di rete predefinita.</span><span class="sxs-lookup"><span data-stu-id="c8115-141">An example of a composite offering would be analytics-as-a-service—analytics, visualization, and other technologies—delivered in an optimized, connected configuration on a predefined network topology.</span></span>

<span data-ttu-id="c8115-142">Le funzionalità ospitate nel cloud sono influenzate da considerazioni in materia di sicurezza e di ruoli, determinate dall'offerta di capacità cloud su cui sono basate.</span><span class="sxs-lookup"><span data-stu-id="c8115-142">Cloud-hosted capabilities are affected by the security and role considerations established by the cloud capacity offering on which they’re built.</span></span> <span data-ttu-id="c8115-143">Queste funzionalità sono disponibili così come sono oppure come servizio gestito.</span><span class="sxs-lookup"><span data-stu-id="c8115-143">These capabilities are offered as is or as a managed service.</span></span> <span data-ttu-id="c8115-144">Per quest'ultimo, sono richiesti ruoli con limiti di accesso per abilitare l'accesso all'ambiente a scopo di gestione.</span><span class="sxs-lookup"><span data-stu-id="c8115-144">For the latter, access-constrained roles are required to enable access into the environment for management purposes.</span></span>

## <a name="cloud-service-vendors"></a><span data-ttu-id="c8115-145">Fornitori di servizi cloud</span><span class="sxs-lookup"><span data-stu-id="c8115-145">Cloud service vendors</span></span>
<span data-ttu-id="c8115-146">Dopo avere parlato con molti CSV, sono stati identificati molteplici approcci adottabili per distribuire servizi per i clienti e i requisiti associati.</span><span class="sxs-lookup"><span data-stu-id="c8115-146">After talking to many CSVs, we identified multiple approaches you can take to deploy services for your customers and associated requirements.</span></span>

### <a name="csv-hosted-offering"></a><span data-ttu-id="c8115-147">Offerta ospitata su CSV</span><span class="sxs-lookup"><span data-stu-id="c8115-147">CSV-hosted offering</span></span>
<span data-ttu-id="c8115-148">Quando l'offerta viene ospitata nella propria sottoscrizione di Azure, sono comunemente adottati due approcci di hosting: distribuzione di una implementazione distinta per ogni cliente o distribuzione di unità di scala che supportano un'infrastruttura condivisa usata per tutti i clienti.</span><span class="sxs-lookup"><span data-stu-id="c8115-148">If you host your offering in your own Azure subscription, two hosting approaches are common: deploying a distinct deployment for every customer or deploying scale units that underpin a shared infrastructure used for all customers.</span></span>

* <span data-ttu-id="c8115-149">**Distribuzioni distinte per ogni cliente.**</span><span class="sxs-lookup"><span data-stu-id="c8115-149">**Distinct deployments for each customer.**</span></span> <span data-ttu-id="c8115-150">Le distribuzioni distinte per ogni cliente richiedono topologie fisse di configurazioni note differenti.</span><span class="sxs-lookup"><span data-stu-id="c8115-150">Distinct deployments per customer require fixed topologies of different known configurations.</span></span> <span data-ttu-id="c8115-151">Queste distribuzioni possono contenere macchine virtuali (VM) di dimensioni differenti, un numero variabile di nodi e volumi diversi di memoria associata.</span><span class="sxs-lookup"><span data-stu-id="c8115-151">These deployments may have different virtual machine (VM) sizes, varying numbers of nodes, and different amounts of associated storage.</span></span> <span data-ttu-id="c8115-152">L'associazione di tag alle distribuzioni è utilizzata per i roll-up di fatturazione per ogni cliente.</span><span class="sxs-lookup"><span data-stu-id="c8115-152">Tagging of deployments is used for roll-up billing of each customer.</span></span> <span data-ttu-id="c8115-153">Lo RBAC può essere abilitato per consentire ai clienti di accedere agli aspetti dell'ambiente cloud.</span><span class="sxs-lookup"><span data-stu-id="c8115-153">RBAC may be enabled to allow customers access to aspects of their cloud environment.</span></span>
* <span data-ttu-id="c8115-154">**Unità di scala in ambienti multi-tenant condivisi.**</span><span class="sxs-lookup"><span data-stu-id="c8115-154">**Scale units in shared multi-tenant environments.**</span></span> <span data-ttu-id="c8115-155">Un modello può rappresentare un'unità di scala per ambienti multi-tenant.</span><span class="sxs-lookup"><span data-stu-id="c8115-155">A template can represent a scale unit for multi-tenant environments.</span></span> <span data-ttu-id="c8115-156">In questo caso, la stessa infrastruttura viene utilizzata per supportare tutti i clienti.</span><span class="sxs-lookup"><span data-stu-id="c8115-156">In this case, the same infrastructure is used to support all customers.</span></span> <span data-ttu-id="c8115-157">Le distribuzioni rappresentano un gruppo di risorse che forniscono un livello di capacità per le offerte ospitate, ad esempio numero di utenti e numero di transazioni.</span><span class="sxs-lookup"><span data-stu-id="c8115-157">The deployments represent a group of resources that deliver a level of capacity for the hosted offering, such as number of users and number of transactions.</span></span> <span data-ttu-id="c8115-158">Tali unità di scala sono aumentate o diminuite secondo necessità.</span><span class="sxs-lookup"><span data-stu-id="c8115-158">These scale units are increased or decreased as demand requires.</span></span>

### <a name="csv-offering-injected-into-customer-subscription"></a><span data-ttu-id="c8115-159">Offerta CSV inserita nella sottoscrizione del cliente</span><span class="sxs-lookup"><span data-stu-id="c8115-159">CSV offering injected into customer subscription</span></span>
<span data-ttu-id="c8115-160">Potrebbe essere necessario distribuire il software in sottoscrizioni appartenenti a clienti finali.</span><span class="sxs-lookup"><span data-stu-id="c8115-160">You may want to deploy your software into subscriptions owned by end customers.</span></span> <span data-ttu-id="c8115-161">È possibile utilizzare modelli per distribuire distribuzioni distinte in un account Azure del cliente.</span><span class="sxs-lookup"><span data-stu-id="c8115-161">You can use templates to deploy distinct deployments into a customer’s Azure account.</span></span>

<span data-ttu-id="c8115-162">Queste distribuzioni utilizzano lo RBAC, pertanto è possibile aggiornare e gestire la distribuzione all'interno dell'account cliente.</span><span class="sxs-lookup"><span data-stu-id="c8115-162">These deployments use RBAC so you can update and manage the deployment within the customer’s account.</span></span>

### <a name="azure-marketplace"></a><span data-ttu-id="c8115-163">Azure Marketplace</span><span class="sxs-lookup"><span data-stu-id="c8115-163">Azure Marketplace</span></span>
<span data-ttu-id="c8115-164">Per pubblicizzare e vendere le proprie offerte tramite un marketplace, ad esempio Azure Marketplace, è possibile sviluppare modelli per la fornitura di tipi distinti di distribuzioni che vengono eseguiti nell'account Azure di un cliente.</span><span class="sxs-lookup"><span data-stu-id="c8115-164">To advertise and sell your offerings through a marketplace, such as Azure Marketplace, you can develop templates to deliver distinct types of deployments that run in a customer’s Azure account.</span></span> <span data-ttu-id="c8115-165">Queste distribuzioni distinte possono essere descritte in genere come taglia (small, medium, large), tipo di prodotto/pubblico (community, sviluppatore, grande impresa) o tipo di funzionalità (di base, disponibilità elevata).</span><span class="sxs-lookup"><span data-stu-id="c8115-165">These distinct deployments can be typically described as a t-shirt size (small, medium, large), product/audience type (community, developer, enterprise), or feature type (basic, high availability).</span></span>  <span data-ttu-id="c8115-166">In alcuni casi, tali tipi consentono di specificare determinati attributi di distribuzione, ad esempio il tipo di VM o il numero di dischi.</span><span class="sxs-lookup"><span data-stu-id="c8115-166">In some cases, these types allow you to specify certain attributes of the deployment, such as VM type or number of disks.</span></span>

## <a name="oss-projects"></a><span data-ttu-id="c8115-167">Progetti OSS</span><span class="sxs-lookup"><span data-stu-id="c8115-167">OSS projects</span></span>
<span data-ttu-id="c8115-168">All'interno dei progetti open source, i modelli di Gestione delle risorse consentono a una community di distribuire rapidamente una soluzione, utilizzando procedure consolidate.</span><span class="sxs-lookup"><span data-stu-id="c8115-168">Within open source projects, Resource Manager templates enable a community to deploy a solution quickly using proven practices.</span></span> <span data-ttu-id="c8115-169">I modelli possono essere archiviati in un archivio GitHub in modo che la community possa esaminarli nel tempo.</span><span class="sxs-lookup"><span data-stu-id="c8115-169">You can store templates in a GitHub repository so the community can revise them over time.</span></span> <span data-ttu-id="c8115-170">Gli utenti distribuiscono questi modelli nelle proprie sottoscrizioni di Azure.</span><span class="sxs-lookup"><span data-stu-id="c8115-170">Users deploy these templates in their own Azure subscriptions.</span></span>

<span data-ttu-id="c8115-171">Nelle sezioni seguenti vengono identificati gli aspetti da considerare prima di progettare la soluzione.</span><span class="sxs-lookup"><span data-stu-id="c8115-171">The following sections identify the things you need to consider before designing your solution.</span></span>

## <a name="identifying-what-is-outside-and-inside-a-vm"></a><span data-ttu-id="c8115-172">Identificazione degli elementi esterni e interni di una VM</span><span class="sxs-lookup"><span data-stu-id="c8115-172">Identifying what is outside and inside a VM</span></span>
<span data-ttu-id="c8115-173">Quando si progetta il modello, è utile esaminare i requisiti in termini di elementi interni ed esterni delle macchine virtuali (VM):</span><span class="sxs-lookup"><span data-stu-id="c8115-173">As you design your template, it’s helpful to look at the requirements in terms of what's outside and inside the virtual machines (VMs):</span></span>

* <span data-ttu-id="c8115-174">Per elementi esterni si intendono le VM e altre risorse della distribuzione, quali la topologia di rete, associazione di tag, riferimenti a certificati o chiavi private e controllo di accesso basato sui ruoli.</span><span class="sxs-lookup"><span data-stu-id="c8115-174">Outside means the VMs and other resources of your deployment, such as the network topology, tagging, references to the certs/secrets, and role-based access control.</span></span> <span data-ttu-id="c8115-175">Tutte queste risorse fanno parte del modello.</span><span class="sxs-lookup"><span data-stu-id="c8115-175">All these resources are part of your template.</span></span>
* <span data-ttu-id="c8115-176">Per elementi interni si intende il software installato e la configurazione dello stato globale desiderato.</span><span class="sxs-lookup"><span data-stu-id="c8115-176">Inside means the installed software and overall desired state configuration.</span></span> <span data-ttu-id="c8115-177">Altri meccanismi, ad esempio le estensioni di VM o gli script, vengono utilizzati in tutto o in parte.</span><span class="sxs-lookup"><span data-stu-id="c8115-177">Other mechanisms, such as VM extensions or scripts, are used in whole or in part.</span></span> <span data-ttu-id="c8115-178">Questi meccanismi possono essere identificati ed eseguiti dal modello ma non al suo interno.</span><span class="sxs-lookup"><span data-stu-id="c8115-178">These mechanisms may be identified and executed by the template but aren’t in it.</span></span>

<span data-ttu-id="c8115-179">Esempi comuni di attività eseguite "inside the box" sono:</span><span class="sxs-lookup"><span data-stu-id="c8115-179">Common examples of activities you would do “inside the box” include -</span></span>  

* <span data-ttu-id="c8115-180">Installare o rimuovere funzionalità e ruoli del server</span><span class="sxs-lookup"><span data-stu-id="c8115-180">Install or remove server roles and features</span></span>
* <span data-ttu-id="c8115-181">Installare e configurare il software a livello di nodo o cluster</span><span class="sxs-lookup"><span data-stu-id="c8115-181">Install and configure software at the node or cluster level</span></span>
* <span data-ttu-id="c8115-182">Distribuire siti Web in un server Web</span><span class="sxs-lookup"><span data-stu-id="c8115-182">Deploy websites on a web server</span></span>
* <span data-ttu-id="c8115-183">Distribuire schemi di database</span><span class="sxs-lookup"><span data-stu-id="c8115-183">Deploy database schemas</span></span>
* <span data-ttu-id="c8115-184">Gestire il registro di sistema o altri tipi di impostazioni di configurazione</span><span class="sxs-lookup"><span data-stu-id="c8115-184">Manage registry or other types of configuration settings</span></span>
* <span data-ttu-id="c8115-185">Gestire file e directory</span><span class="sxs-lookup"><span data-stu-id="c8115-185">Manage files and directories</span></span>
* <span data-ttu-id="c8115-186">Avviare, arrestare e gestire processi e servizi</span><span class="sxs-lookup"><span data-stu-id="c8115-186">Start, stop, and manage processes and services</span></span>
* <span data-ttu-id="c8115-187">Gestire account utente e gruppi locali</span><span class="sxs-lookup"><span data-stu-id="c8115-187">Manage local groups and user accounts</span></span>
* <span data-ttu-id="c8115-188">Installare e gestire i pacchetti (file con estensione .msi, .exe, yum e così via)</span><span class="sxs-lookup"><span data-stu-id="c8115-188">Install and manage packages (.msi, .exe, yum, etc.)</span></span>
* <span data-ttu-id="c8115-189">Gestire le variabili di ambiente</span><span class="sxs-lookup"><span data-stu-id="c8115-189">Manage environment variables</span></span>
* <span data-ttu-id="c8115-190">Eseguire gli script nativi (Windows PowerShell, bash e così via)</span><span class="sxs-lookup"><span data-stu-id="c8115-190">Run native scripts (Windows PowerShell, bash, etc.)</span></span>

### <a name="desired-state-configuration-dsc"></a><span data-ttu-id="c8115-191">Configurazione dello stato desiderato (DSC)</span><span class="sxs-lookup"><span data-stu-id="c8115-191">Desired state configuration (DSC)</span></span>
<span data-ttu-id="c8115-192">Relativamente allo stato interno delle VM dopo la distribuzione, è opportuno verificare che tale distribuzione non "devii" dalla configurazione definita e controllata nel controllo del codice sorgente.</span><span class="sxs-lookup"><span data-stu-id="c8115-192">Thinking about the internal state of your VMs beyond deployment, you want to make sure this deployment doesn’t "drift" from the configuration that you have defined and checked into source control.</span></span> <span data-ttu-id="c8115-193">Con questo approccio gli sviluppatori o il personale addetto alle operazioni potranno apportare a un ambiente solo le modifiche ad hoc che sono state esaminate, testate o registrate nel controllo del codice sorgente.</span><span class="sxs-lookup"><span data-stu-id="c8115-193">This approach ensures your developers or operations staff don’t make ad-hoc changes to an environment that are not vetted, tested, or recorded in source control.</span></span> <span data-ttu-id="c8115-194">Questo controllo è importante, in quanto le modifiche manuali non sono presenti nel controllo del codice sorgente.</span><span class="sxs-lookup"><span data-stu-id="c8115-194">This control is important, because the manual changes are not in source control.</span></span> <span data-ttu-id="c8115-195">Inoltre, non fanno parte della distribuzione standard e avranno un impatto sulle future distribuzioni automatiche del software.</span><span class="sxs-lookup"><span data-stu-id="c8115-195">They are also not part of the standard deployment and will impact future automated deployments of the software.</span></span>

<span data-ttu-id="c8115-196">Oltre che dal punto di vista dei dipendenti interni, la configurazione dello stato desiderato è importante anche in termini di sicurezza.</span><span class="sxs-lookup"><span data-stu-id="c8115-196">Beyond your internal employees, desired state configuration is also important from a security perspective.</span></span> <span data-ttu-id="c8115-197">I pirati informatici tentano regolarmente di compromettere e sfruttare i sistemi software.</span><span class="sxs-lookup"><span data-stu-id="c8115-197">Hackers are regularly trying to compromise and exploit software systems.</span></span> <span data-ttu-id="c8115-198">Quando il tentativo riesce, lo scopo è in genere l'installazione di file o altrimenti la modifica dello stato di un sistema compromesso.</span><span class="sxs-lookup"><span data-stu-id="c8115-198">When successful, it's common to install files and otherwise change the state of a compromised system.</span></span> <span data-ttu-id="c8115-199">Utilizzando la configurazione dello stato desiderato, è possibile identificare i delta tra lo stato desiderato e quello effettivo e ripristinare una configurazione nota.</span><span class="sxs-lookup"><span data-stu-id="c8115-199">Using desired state configuration, you can identify deltas between the desired and actual state and restore a known configuration.</span></span>

<span data-ttu-id="c8115-200">Esistono estensioni di risorsa per i meccanismi più diffusi per DSC - PowerShell DSC, Chef e Puppet.</span><span class="sxs-lookup"><span data-stu-id="c8115-200">There are resource extensions for the most popular mechanisms for DSC - PowerShell DSC, Chef, and Puppet.</span></span> <span data-ttu-id="c8115-201">Ognuna di queste estensioni può distribuire lo stato iniziale della VM ed essere usata anche per verificare che venga mantenuto lo stato voluto.</span><span class="sxs-lookup"><span data-stu-id="c8115-201">Each of these extensions can deploy the initial state of your VM and also be used to make sure the desired state is maintained.</span></span>

## <a name="common-template-scopes"></a><span data-ttu-id="c8115-202">Ambiti dei modello comuni</span><span class="sxs-lookup"><span data-stu-id="c8115-202">Common template scopes</span></span>
<span data-ttu-id="c8115-203">Nella nostra esperienza, abbiamo visto emergere tre ambiti principali per i modelli di soluzioni.</span><span class="sxs-lookup"><span data-stu-id="c8115-203">In our experience, we’ve seen three key solution templates scopes emerge.</span></span> <span data-ttu-id="c8115-204">Questi tre ambiti, ovvero capacità, funzionalità e soluzione end-to-end, sono descritti nelle sezioni seguenti.</span><span class="sxs-lookup"><span data-stu-id="c8115-204">These three scopes – capacity, capability, and end-to-end solution – are described in the following sections.</span></span>

### <a name="capacity-scope"></a><span data-ttu-id="c8115-205">Ambito di capacità</span><span class="sxs-lookup"><span data-stu-id="c8115-205">Capacity scope</span></span>
<span data-ttu-id="c8115-206">Un ambito di capacità offre un set di risorse in una topologia standard preconfigurata per essere conforme a regolamenti e criteri.</span><span class="sxs-lookup"><span data-stu-id="c8115-206">A capacity scope delivers a set of resources in a standard topology that is pre-configured to be in compliance with regulations and policies.</span></span> <span data-ttu-id="c8115-207">L'esempio più comune è la distribuzione di un ambiente di sviluppo standard in uno scenario di IT aziendale o SI.</span><span class="sxs-lookup"><span data-stu-id="c8115-207">The most common example is deploying a standard development environment in an Enterprise IT or SI scenario.</span></span>

### <a name="capability-scope"></a><span data-ttu-id="c8115-208">Ambito di funzionalità</span><span class="sxs-lookup"><span data-stu-id="c8115-208">Capability scope</span></span>
<span data-ttu-id="c8115-209">Un ambito di funzionalità è incentrato sulla distribuzione e configurazione di una topologia per una determinata tecnologia.</span><span class="sxs-lookup"><span data-stu-id="c8115-209">A capability scope is focused on deploying and configuring a topology for a given technology.</span></span> <span data-ttu-id="c8115-210">Scenari comuni includono tecnologie quali SQL Server, Cassandra, Hadoop.</span><span class="sxs-lookup"><span data-stu-id="c8115-210">Common scenarios including technologies such as SQL Server, Cassandra, Hadoop.</span></span>

### <a name="end-to-end-solution-scope"></a><span data-ttu-id="c8115-211">Ambito di soluzione end-to-end</span><span class="sxs-lookup"><span data-stu-id="c8115-211">End-to-end solution scope</span></span>
<span data-ttu-id="c8115-212">Un ambito di soluzione end-to-end non riguarda una singola funzionalità ma è invece incentrato sulla fornitura di una soluzione end-to-end costituita da più funzionalità.</span><span class="sxs-lookup"><span data-stu-id="c8115-212">An End-to-End Solution Scope is targeted beyond a single capability, and instead focused on delivering an end to end solution comprised of multiple capabilities.</span></span>  

<span data-ttu-id="c8115-213">Un ambito di modello con ambito soluzione si manifesta come un set di uno o più modelli con ambito funzionalità con risorse, logica e stato desiderato specifici della soluzione.</span><span class="sxs-lookup"><span data-stu-id="c8115-213">A solution-scoped template scope manifests itself as a set of one or more capability-scoped templates with solution-specific resources, logic, and desired state.</span></span> <span data-ttu-id="c8115-214">Un esempio di modello con ambito soluzione è un modello di soluzione di pipeline di dati end-to-end.</span><span class="sxs-lookup"><span data-stu-id="c8115-214">An example of a solution-scoped template is an end to end data pipeline solution template.</span></span> <span data-ttu-id="c8115-215">Il modello può combinare una topologia e uno stato specifici della soluzione con più modelli di soluzione con ambito di funzionalità, ad esempio Kafka, Storm e Hadoop.</span><span class="sxs-lookup"><span data-stu-id="c8115-215">The template might mix solution-specific topology and state with multiple capability-scoped solution templates such as Kafka, Storm, and Hadoop.</span></span>

## <a name="choosing-free-form-vs-known-configurations"></a><span data-ttu-id="c8115-216">Scelta del formato libero rispetto a configurazioni note</span><span class="sxs-lookup"><span data-stu-id="c8115-216">Choosing free-form vs. known configurations</span></span>
<span data-ttu-id="c8115-217">Inizialmente si potrebbe pensare che un modello debba fornire ai fruitori la massima flessibilità, ma sulla scelta di utilizzare configurazioni in formato libero o configurazioni note influiscono molteplici considerazioni.</span><span class="sxs-lookup"><span data-stu-id="c8115-217">You might initially think a template should give consumers the utmost flexibility, but many considerations affect the choice of whether to use free-form configurations vs. known configurations.</span></span> <span data-ttu-id="c8115-218">In questa sezione vengono identificati i principali requisiti dei clienti e le considerazioni tecniche che hanno plasmato l'approccio illustrato nel presente documento.</span><span class="sxs-lookup"><span data-stu-id="c8115-218">This section identifies the key customer requirements and technical considerations that shaped the approach shared in this document.</span></span>

### <a name="free-form-configurations"></a><span data-ttu-id="c8115-219">Configurazioni in formato libero</span><span class="sxs-lookup"><span data-stu-id="c8115-219">Free-form configurations</span></span>
<span data-ttu-id="c8115-220">In apparenza, le configurazioni in formato libero sembrano ideali.</span><span class="sxs-lookup"><span data-stu-id="c8115-220">On the surface, free-form configurations sound ideal.</span></span> <span data-ttu-id="c8115-221">Consentono di selezionare un tipo di VM e specificare un numero arbitrario di nodi e dischi collegati per tali nodi, come parametri di un modello.</span><span class="sxs-lookup"><span data-stu-id="c8115-221">They allow you to select a VM type and provide an arbitrary number of nodes and attached disks for those nodes — and do so as parameters to a template.</span></span> <span data-ttu-id="c8115-222">Questo approccio, tuttavia, non è l'ideale per alcuni scenari.</span><span class="sxs-lookup"><span data-stu-id="c8115-222">However, this approach is not ideal for some scenarios.</span></span>

<span data-ttu-id="c8115-223">Nell'articolo [Dimensioni delle macchine virtuali](../virtual-machines/windows/sizes.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json) vengono identificati i diversi tipi di VM e le dimensioni disponibili oltre a ciascuna combinazione di dischi permanenti (2, 4, 8, 16 o 32) collegabili.</span><span class="sxs-lookup"><span data-stu-id="c8115-223">In [Sizes for virtual machines](../virtual-machines/windows/sizes.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json), the different VM types and available sizes are identified, and each of the number of durable disks (2, 4, 8, 16, or 32) that can be attached.</span></span> <span data-ttu-id="c8115-224">Ogni disco collegato fornisce 500 IOPS ed è possibile raggruppare più dischi per ottenere un multiplo di tale numero di IOPS.</span><span class="sxs-lookup"><span data-stu-id="c8115-224">Each attached disk provides 500 IOPS and multiples of these disks can be pooled for a multiplier of that number of IOPS.</span></span> <span data-ttu-id="c8115-225">Ad esempio, 16 dischi possono essere raggruppati per fornire 8.000 IOPS.</span><span class="sxs-lookup"><span data-stu-id="c8115-225">For example, 16 disks can be pooled to provide 8,000 IOPS.</span></span> <span data-ttu-id="c8115-226">Il pooling viene eseguito con la configurazione nel sistema operativo, utilizzando spazi di archiviazione di Microsoft Windows o RAID (Redundant Array of Inexpensive Disks) in Linux.</span><span class="sxs-lookup"><span data-stu-id="c8115-226">Pooling is done with configuration in the operating system, using Microsoft Windows Storage Spaces or redundant array of inexpensive disks (RAID) in Linux.</span></span>

<span data-ttu-id="c8115-227">Una configurazione in formato libero consente di selezionare varie istanze di VM, vari tipi e dimensioni differenti di VM per tali istanze, un numero di dischi che può variare in base al tipo di VM e uno o più script per configurare il contenuto delle VM.</span><span class="sxs-lookup"><span data-stu-id="c8115-227">A free-form configuration enables the selection several VM instances, various VM types and sizes for those instances, various disks for the VM type, and one or more scripts to configure the VM contents.</span></span>

<span data-ttu-id="c8115-228">È comune che una distribuzione disponga di più tipi di nodi, ad esempio nodi master e nodi dati, pertanto questa flessibilità viene spesso fornita per ogni tipo di nodo.</span><span class="sxs-lookup"><span data-stu-id="c8115-228">It is common that a deployment may have multiple types of nodes, such as master and data nodes, so this flexibility is often provided for every node type.</span></span>

<span data-ttu-id="c8115-229">Man mano che si inizia a distribuire cluster di una qualsiasi importanza, si inizia a lavorare con questi scenari complessi.</span><span class="sxs-lookup"><span data-stu-id="c8115-229">As you start to deploy clusters of any significance, you begin to work with these complex scenarios.</span></span> <span data-ttu-id="c8115-230">Distribuendo un cluster di Hadoop, ad esempio, con 8 nodi master e 200 nodi dati e 4 dischi collegati in pool in ogni nodo master e 16 dischi collegati in pool per ogni nodo dati, occorrerà gestire 208 VM e 3.232 dischi.</span><span class="sxs-lookup"><span data-stu-id="c8115-230">If you were deploying a Hadoop cluster, for example, with 8 master nodes and 200 data nodes, and pooled 4 attached disks on each master node and pooled 16 attached disks per data node, you would have 208 VMs and 3,232 disks to manage.</span></span>

<span data-ttu-id="c8115-231">Un account di archiviazione limiterà le richieste che superano il limite identificato di 20.000 transazioni/secondo, è pertanto opportuno prendere in considerazione il partizionamento dell'account di archiviazione e utilizzare calcoli per determinare il numero appropriato di account di archiviazione per adattare questa topologia.</span><span class="sxs-lookup"><span data-stu-id="c8115-231">A storage account will throttle requests above its identified 20,000 transactions/second limit, so you should look at storage account partitioning and use calculations to determine the appropriate number of storage accounts to accommodate this topology.</span></span> <span data-ttu-id="c8115-232">Data la grande varietà di combinazioni supportate dall'approccio in formato libero, sono necessari calcoli dinamici per determinare il partizionamento appropriato.</span><span class="sxs-lookup"><span data-stu-id="c8115-232">Given the multitude of combinations supported by the free-form approach, dynamic calculations are required to determine the appropriate partitioning.</span></span> <span data-ttu-id="c8115-233">Il linguaggio del modello di Gestione risorse di Azure non fornisce attualmente funzioni matematiche, pertanto è necessario eseguire tali calcoli nel codice, generando un modello univoco hardcoded con i dettagli appropriati.</span><span class="sxs-lookup"><span data-stu-id="c8115-233">The Azure Resource Manager Template Language does not presently provide mathematical functions, so you must perform these calculations in code, generating a unique, hard-coded template with the appropriate details.</span></span>

<span data-ttu-id="c8115-234">Negli scenari di IT e SI aziendali, qualcuno deve gestire i modelli e fornire supporto per le topologie distribuite per una o più organizzazioni.</span><span class="sxs-lookup"><span data-stu-id="c8115-234">In enterprise IT and SI scenarios, someone must maintain the templates and support the deployed topologies for one or more organizations.</span></span> <span data-ttu-id="c8115-235">Questo sovraccarico aggiuntivo, ovvero configurazioni e modelli differenti per ogni cliente, è tutt'altro che auspicabile.</span><span class="sxs-lookup"><span data-stu-id="c8115-235">This additional overhead — different configurations and templates for each customer — is far from desirable.</span></span>

<span data-ttu-id="c8115-236">È possibile usare questi modelli per distribuire gli ambienti nella sottoscrizione di Azure del cliente, ma sia i team IT aziendali che i CSV in genere li distribuiscono nelle proprie sottoscrizioni, usando una funzione di chargeback per la fatturazione dei clienti.</span><span class="sxs-lookup"><span data-stu-id="c8115-236">You can use these templates to deploy environments in your customer’s Azure subscription, but both corporate IT teams and CSVs typically deploy them into their own subscriptions, using a chargeback function to bill their customers.</span></span> <span data-ttu-id="c8115-237">In questi scenari, l'obiettivo è distribuire capacità per più clienti in un pool di sottoscrizioni e mantenere le distribuzioni densamente popolate nelle sottoscrizioni per ridurne al minimo la proliferazione, vale a dire più sottoscrizioni da gestire.</span><span class="sxs-lookup"><span data-stu-id="c8115-237">In these scenarios, the goal is to deploy capacity for multiple customers across a pool of subscriptions and keep deployments densely populated into the subscriptions to minimize subscription sprawl—that is, more subscriptions to manage.</span></span> <span data-ttu-id="c8115-238">Con dimensioni di distribuzione realmente dinamiche, per ottenere questo tipo di densità occorre un'attenta pianificazione e un ulteriore sviluppo per l'attività di scaffolding effettuato per conto dell'organizzazione.</span><span class="sxs-lookup"><span data-stu-id="c8115-238">With truly dynamic deployment sizes, achieving this type of density requires careful planning and additional development for scaffolding work on behalf of the organization.</span></span>

<span data-ttu-id="c8115-239">Non è poi possibile creare sottoscrizioni tramite una chiamata API, ma è necessaria un'operazione manuale tramite il portale.</span><span class="sxs-lookup"><span data-stu-id="c8115-239">In addition, you can’t create subscriptions via an API call but must do so manually through the portal.</span></span> <span data-ttu-id="c8115-240">Man mano che aumenta il numero di sottoscrizioni, l'eventuale proliferazione di sottoscrizioni risultante richiede l'intervento degli operatori perché non può essere gestita in modo automatizzato.</span><span class="sxs-lookup"><span data-stu-id="c8115-240">As the number of subscriptions increases, any resulting subscription sprawl requires human intervention—it can’t be automated.</span></span> <span data-ttu-id="c8115-241">Con così tanta variabilità nelle dimensioni delle distribuzioni, è necessario il pre-provisioning manuale di varie sottoscrizioni per garantirne la disponibilità.</span><span class="sxs-lookup"><span data-stu-id="c8115-241">With so much variability in the sizes of deployments, you would have to pre-provision a number of subscriptions manually to ensure subscriptions are available.</span></span>

<span data-ttu-id="c8115-242">Considerando tutti questi fattori, l'adozione di una configurazione in formato libero risulta meno accattivante che a prima vista.</span><span class="sxs-lookup"><span data-stu-id="c8115-242">Considering all these factors, a truly free-form configuration is less appealing than at first blush.</span></span>

### <a name="known-configurations--the-t-shirt-sizing-approach"></a><span data-ttu-id="c8115-243">Configurazioni note: l'approccio a taglie</span><span class="sxs-lookup"><span data-stu-id="c8115-243">Known configurations — the t-shirt sizing approach</span></span>
<span data-ttu-id="c8115-244">Anziché offrire un modello che fornisce massima flessibilità e innumerevoli variazioni, secondo la nostra esperienza uno schema diffuso è fornire la possibilità di selezionare configurazioni note, ovvero taglie standard quali sandbox, small, medium e large.</span><span class="sxs-lookup"><span data-stu-id="c8115-244">Rather than offer a template that provides total flexibility and countless variations, in our experience a common pattern is to provide the ability to select known configurations — in effect, standard t-shirt sizes such as sandbox, small, medium, and large.</span></span> <span data-ttu-id="c8115-245">Altri esempi di taglie sono le offerte di prodotti, come Community Edition o Enterprise Edition.</span><span class="sxs-lookup"><span data-stu-id="c8115-245">Other examples of t-shirt sizes are product offerings, such as community edition or enterprise edition.</span></span>  <span data-ttu-id="c8115-246">In altri casi, potrebbero essere configurazioni specifiche per i carichi di lavoro di una determinata tecnologia, ad esempio map reduce o no sql.</span><span class="sxs-lookup"><span data-stu-id="c8115-246">In other cases, it may be workload-specific configurations of a technology – such as map reduce or no sql.</span></span>

<span data-ttu-id="c8115-247">Molteplici organizzazioni IT aziendali, fornitori di OSS e SI oggi rendono disponibili le loro offerte utilizzando questo approccio in ambienti locali virtualizzati (aziende) o come offerte software-as-a-service (SaaS) (CSV e OSV).</span><span class="sxs-lookup"><span data-stu-id="c8115-247">Many enterprise IT organizations, OSS vendors, and SIs make their offerings available today in this way in on-premises, virtualized environments (enterprises) or as software-as-a-service (SaaS) offerings (CSVs and OSVs).</span></span>

<span data-ttu-id="c8115-248">Questo approccio fornisce configurazioni note ed efficienti di dimensioni variabili, preconfigurate per i clienti.</span><span class="sxs-lookup"><span data-stu-id="c8115-248">This approach provides good, known configurations of varying sizes that are preconfigured for customers.</span></span> <span data-ttu-id="c8115-249">Senza configurazioni note, i clienti devono determinare autonomamente la dimensione del cluster, includere i limiti di risorse della piattaforma ed effettuare calcoli matematici per identificare il partizionamento risultante degli account di archiviazione e altre risorse (a causa della dimensione del cluster e dei limiti di risorse).</span><span class="sxs-lookup"><span data-stu-id="c8115-249">Without known configurations, end customers must determine cluster sizing on their own, factor in platform resource constraints, and do math to identify the resulting partitioning of storage accounts and other resources (due to cluster size and resource constraints).</span></span> <span data-ttu-id="c8115-250">Le configurazioni note consentono ai clienti di selezionare con facilità la taglia appropriata, ovvero una specifica distribuzione.</span><span class="sxs-lookup"><span data-stu-id="c8115-250">Known configurations enable customers to easily select the right t-shirt size—that is, a given deployment.</span></span> <span data-ttu-id="c8115-251">Oltre a migliorare l'esperienza del cliente, un numero limitato di configurazioni note è più facile da supportare e consente di offrire un livello superiore di densità.</span><span class="sxs-lookup"><span data-stu-id="c8115-251">In addition to making a better experience for the customer, a small number of known configurations is easier to support and can help you deliver a higher level of density.</span></span>

<span data-ttu-id="c8115-252">In un approccio di configurazione nota incentrato sulle taglie, la taglia può inoltre contenere un numero variabile di nodi.</span><span class="sxs-lookup"><span data-stu-id="c8115-252">A known configuration approach focused on t-shirt sizes may also have varying number of nodes within a size.</span></span> <span data-ttu-id="c8115-253">Ad esempio, una taglia small può contenere dai 3 ai 10 nodi.</span><span class="sxs-lookup"><span data-stu-id="c8115-253">For example, a small t-shirt size may be between 3 and 10 nodes.</span></span>  <span data-ttu-id="c8115-254">Le taglie verrebbero progettate per contenere fino a 10 nodi e fornire ai clienti la possibilità di effettuare scelte in formato libero fino alla taglia massima identificata.</span><span class="sxs-lookup"><span data-stu-id="c8115-254">The t-shirt size would be designed to accommodate up to 10 nodes and provide the consumer the ability to make free form selections up to the maximum size identified.</span></span>  

<span data-ttu-id="c8115-255">Una taglia basata sul tipo di carico di lavoro, potrebbe essere per natura un formato più libero in termini di numero di nodi distribuibili ma avrà dimensione dei nodi e configurazione del software nel nodo separate per il carico di lavoro.</span><span class="sxs-lookup"><span data-stu-id="c8115-255">A t-shirt size based on workload type, may be more free form in nature in terms of the number of nodes that can be deployed but will have workload distinct node size and configuration of the software on the node.</span></span>

<span data-ttu-id="c8115-256">Le taglie basate su offerte di prodotti, quali Community o Enterprise, possono disporre di tipi di risorse separati e di un numero massimo di nodi distribuibile, in genere a seguito di considerazioni relative alle licenze o della disponibilità di funzionalità nelle diverse offerte.</span><span class="sxs-lookup"><span data-stu-id="c8115-256">T-shirt sizes based on product offerings, such as community or Enterprise, may have distinct resource types and maximum number of nodes that can be deployed, typically tied to licensing considerations or feature availability across the different offerings.</span></span>

<span data-ttu-id="c8115-257">Ai clienti è inoltre possibile offrire varianti specifiche utilizzando modelli basati su JSON.</span><span class="sxs-lookup"><span data-stu-id="c8115-257">You can also accommodate customers with unique variants using the JSON-based templates.</span></span> <span data-ttu-id="c8115-258">Quando si utilizzano gli outlier, è possibile incorporare la pianificazione appropriata e considerazioni relative a sviluppo, supporto e costi.</span><span class="sxs-lookup"><span data-stu-id="c8115-258">When dealing with outliers, you can incorporate the appropriate planning and considerations for development, support, and costing.</span></span>

<span data-ttu-id="c8115-259">Sulla base degli scenari di utilizzo dei modelli da parte dei clienti e dei requisiti identificati all'inizio di questo documento, abbiamo identificato uno schema per la scomposizione dei modelli.</span><span class="sxs-lookup"><span data-stu-id="c8115-259">Based on the customer template consumption scenarios, and requirements identified at the start of this document, we identified a pattern for template decomposition.</span></span>

## <a name="capacity-and-capability-scoped-solution-templates"></a><span data-ttu-id="c8115-260">Modelli di soluzione con ambito di capacità e funzionalità</span><span class="sxs-lookup"><span data-stu-id="c8115-260">Capacity and capability-scoped solution templates</span></span>
<span data-ttu-id="c8115-261">La scomposizione offre un approccio modulare allo sviluppo dei modelli in grado di supportare riutilizzo, estendibilità e strumenti.</span><span class="sxs-lookup"><span data-stu-id="c8115-261">Decomposition provides a modular approach to template development that supports reuse, extensibility, testing, and tooling.</span></span> <span data-ttu-id="c8115-262">In questa sezione vengono forniti dettagli sulla modalità di applicazione di un approccio di scomposizione a modelli con un ambito di capacità o funzionalità.</span><span class="sxs-lookup"><span data-stu-id="c8115-262">This section provides detail on how a decomposition approach can be applied to templates with a Capacity or Capability scope.</span></span>

<span data-ttu-id="c8115-263">In questo approccio, un modello principale riceve i valori dei parametri da un consumer di modello, quindi si collega a vari tipi di modelli e script a valle come illustrato di seguito.</span><span class="sxs-lookup"><span data-stu-id="c8115-263">In this approach, a main template receives parameter values from a template consumer, then links to several types of templates and scripts downstream as shown below.</span></span> <span data-ttu-id="c8115-264">Per inserire ed estrarre valori dei modelli collegati vengono utilizzati parametri, variabili statiche e variabili generate.</span><span class="sxs-lookup"><span data-stu-id="c8115-264">Parameters, static variables, and generated variables are used to provide values in and out of the linked templates.</span></span>

![Parametri del modello](./media/best-practices-resource-manager-design-templates/template-parameters.png)

<span data-ttu-id="c8115-266">**I parametri vengono passati a un modello principale, quindi a modelli collegati**</span><span class="sxs-lookup"><span data-stu-id="c8115-266">**Parameters are passed to a main template then to linked templates**</span></span>

<span data-ttu-id="c8115-267">Le sezioni seguenti illustrano i tipi di modelli e di script in cui viene scomposto un singolo modello.</span><span class="sxs-lookup"><span data-stu-id="c8115-267">The following sections focus on the types of templates and scripts that a single template is decomposed into.</span></span> <span data-ttu-id="c8115-268">Le sezioni descrivono gli approcci per passare le informazioni sullo stato tra i modelli.</span><span class="sxs-lookup"><span data-stu-id="c8115-268">The sections present approaches for passing state information among the templates.</span></span> <span data-ttu-id="c8115-269">Ogni modello e i tipi di script nell'immagine sono descritti con esempi.</span><span class="sxs-lookup"><span data-stu-id="c8115-269">Each template and the script types in the image are described along with examples.</span></span> <span data-ttu-id="c8115-270">Per un esempio contestuale, vedere "Uso combinato: un'implementazione di esempio", più avanti in questo documento.</span><span class="sxs-lookup"><span data-stu-id="c8115-270">For a contextual example, see "Putting it together: a sample implementation" later in this document.</span></span>

### <a name="template-metadata"></a><span data-ttu-id="c8115-271">Metadati del modello</span><span class="sxs-lookup"><span data-stu-id="c8115-271">Template metadata</span></span>
<span data-ttu-id="c8115-272">I metadati del modello (il file metadata.json) contengono coppie chiave/valore che descrivono un modello in JSON, leggibili da persone e sistemi software.</span><span class="sxs-lookup"><span data-stu-id="c8115-272">Template metadata (the metadata.json file) contains key/value pairs that describe a template in JSON, which can be read by humans and software systems.</span></span>

![Metadati del modello](./media/best-practices-resource-manager-design-templates/template-metadata.png)

<span data-ttu-id="c8115-274">**I metadati del modello sono descritti nel file metadata.json**</span><span class="sxs-lookup"><span data-stu-id="c8115-274">**Template metadata is described in the metadata.json file**</span></span>

<span data-ttu-id="c8115-275">Gli agenti software possono recuperare il file metadata.json e pubblicare le informazioni e un collegamento al modello in una pagina Web o in una directory.</span><span class="sxs-lookup"><span data-stu-id="c8115-275">Software agents can retrieve the metadata.json file and publish the information and a link to the template in a web page or directory.</span></span> <span data-ttu-id="c8115-276">Gli elementi includono *itemDisplayName*, *description*, *summary*, *githubUsername* e *dateUpdated*.</span><span class="sxs-lookup"><span data-stu-id="c8115-276">Elements include *itemDisplayName*, *description*, *summary*, *githubUsername*, and *dateUpdated*.</span></span>

<span data-ttu-id="c8115-277">Di seguito è riportato un file di esempio nel suo complesso.</span><span class="sxs-lookup"><span data-stu-id="c8115-277">An example file is shown below in its entirety.</span></span>

    {
        "itemDisplayName": "PostgreSQL 9.3 on Ubuntu VMs",
        "description": "This template creates a PostgreSQL streaming-replication between a master and one or more slave servers each with 2 striped data disks. The database servers are deployed into a private-only subnet with one publicly accessible jumpbox VM in a DMZ subnet with public IP.",
        "summary": "PostgreSQL stream-replication with multiple slave servers and a publicly accessible jumpbox VM",
        "githubUsername": "arsenvlad",
        "dateUpdated": "2015-04-24"
    }

### <a name="main-template"></a><span data-ttu-id="c8115-278">Modello principale</span><span class="sxs-lookup"><span data-stu-id="c8115-278">Main template</span></span>
<span data-ttu-id="c8115-279">Il modello principale riceve i parametri da un utente, usa tali informazioni per popolare variabili oggetto complesse ed esegue i modelli collegati.</span><span class="sxs-lookup"><span data-stu-id="c8115-279">The main template receives parameters from a user, uses that information to populate complex object variables, and executes the linked templates.</span></span>

![Modello principale](./media/best-practices-resource-manager-design-templates/main-template.png)

<span data-ttu-id="c8115-281">**Il modello principale riceve parametri da un utente**</span><span class="sxs-lookup"><span data-stu-id="c8115-281">**The main template receives parameters from a user**</span></span>

<span data-ttu-id="c8115-282">Un parametro fornito è un tipo di configurazione nota conosciuto anche come parametro di taglia a causa dei relativi valori standardizzati quali small, medium o large.</span><span class="sxs-lookup"><span data-stu-id="c8115-282">One parameter that is provided is a known configuration type also known as the t-shirt size parameter because of its standardized values such as small, medium, or large.</span></span> <span data-ttu-id="c8115-283">In pratica è possibile usare questo parametro in diversi modi.</span><span class="sxs-lookup"><span data-stu-id="c8115-283">In practice, you can use this parameter in multiple ways.</span></span> <span data-ttu-id="c8115-284">Per ulteriori informazioni, vedere "Modello di risorse di configurazione note", più avanti in questo documento.</span><span class="sxs-lookup"><span data-stu-id="c8115-284">For details, see "Known configuration resources template" later in this document.</span></span>

<span data-ttu-id="c8115-285">Alcune risorse vengono distribuite indipendentemente dalla configurazione nota specificata dal parametro di un utente.</span><span class="sxs-lookup"><span data-stu-id="c8115-285">Some resources are deployed regardless of the known configuration specified by a user parameter.</span></span> <span data-ttu-id="c8115-286">Queste risorse vengono sottoposte a provisioning utilizzando un unico modello di risorsa condivisa e vengono condivise da altri modelli, in modo che il modello di risorsa condivisa venga eseguito per primo.</span><span class="sxs-lookup"><span data-stu-id="c8115-286">These resources are provisioned using a single shared resource template and are shared by other templates, so the shared resource template is run first.</span></span>

<span data-ttu-id="c8115-287">Alcune risorse vengono distribuite facoltativamente indipendentemente dalla configurazione nota specificata.</span><span class="sxs-lookup"><span data-stu-id="c8115-287">Some resources are deployed optionally regardless of the specified known configuration.</span></span>

### <a name="shared-resources-template"></a><span data-ttu-id="c8115-288">Modello di risorse condivise</span><span class="sxs-lookup"><span data-stu-id="c8115-288">Shared resources template</span></span>
<span data-ttu-id="c8115-289">Questo modello offre risorse comuni a tutte le configurazioni note.</span><span class="sxs-lookup"><span data-stu-id="c8115-289">This template delivers resources that are common across all known configurations.</span></span> <span data-ttu-id="c8115-290">Contiene la rete virtuale, i set di disponibilità e altre risorse necessarie indipendentemente dal modello di configurazione nota distribuito.</span><span class="sxs-lookup"><span data-stu-id="c8115-290">It contains the virtual network, availability sets, and other resources that are required regardless of the known configuration template that is deployed.</span></span>

![Risorse del modello](./media/best-practices-resource-manager-design-templates/template-resources.png)

<span data-ttu-id="c8115-292">**Modello di risorse condivise**</span><span class="sxs-lookup"><span data-stu-id="c8115-292">**Shared resources template**</span></span>

<span data-ttu-id="c8115-293">I nomi delle risorse, ad esempio il nome della rete virtuale, si basano sul modello principale.</span><span class="sxs-lookup"><span data-stu-id="c8115-293">Resource names, such as the virtual network name, are based on the main template.</span></span> <span data-ttu-id="c8115-294">È possibile specificarli come una variabile all'interno di tale modello o riceverli come parametro dall'utente, secondo quanto richiesto dall'organizzazione.</span><span class="sxs-lookup"><span data-stu-id="c8115-294">You can specify them as a variable within that template or receive them as a parameter from the user, as required by your organization.</span></span>

### <a name="optional-resources-template"></a><span data-ttu-id="c8115-295">Modello di risorse facoltative</span><span class="sxs-lookup"><span data-stu-id="c8115-295">Optional resources template</span></span>
<span data-ttu-id="c8115-296">Il modello di risorse facoltative contiene risorse distribuite a livello di codice in base al valore di un parametro o di una variabile.</span><span class="sxs-lookup"><span data-stu-id="c8115-296">The optional resources template contains resources that are programmatically deployed based on the value of a parameter or variable.</span></span>

![Risorse facoltative](./media/best-practices-resource-manager-design-templates/optional-resources.png)

<span data-ttu-id="c8115-298">**Modello di risorse facoltative**</span><span class="sxs-lookup"><span data-stu-id="c8115-298">**Optional resources template**</span></span>

<span data-ttu-id="c8115-299">Ad esempio, è possibile utilizzare un modello di risorse facoltative per configurare un jumpbox che consente l'accesso indiretto a un ambiente distribuito dalla rete Internet pubblica.</span><span class="sxs-lookup"><span data-stu-id="c8115-299">For example, you can use an optional resources template to configure a jumpbox that enables indirect access to a deployed environment from the public Internet.</span></span> <span data-ttu-id="c8115-300">È possibile usare un parametro o una variabile per stabilire se il jumpbox deve essere abilitato o meno e identificare la funzione *concat* per compilare il nome di destinazione per il modello, ad esempio *jumpbox_enabled.json*.</span><span class="sxs-lookup"><span data-stu-id="c8115-300">You would use a parameter or variable to identify whether the jumpbox should be enabled and the *concat* function to build the target name for the template, such as *jumpbox_enabled.json*.</span></span> <span data-ttu-id="c8115-301">Il collegamento al modello utilizza la variabile risultante per installare il jumpbox.</span><span class="sxs-lookup"><span data-stu-id="c8115-301">Template linking would use the resulting variable to install the jumpbox.</span></span>

<span data-ttu-id="c8115-302">È possibile collegare il modello di risorse facoltative da più posizioni:</span><span class="sxs-lookup"><span data-stu-id="c8115-302">You can link the optional resources template from multiple places:</span></span>

* <span data-ttu-id="c8115-303">Quando applicabile a ogni distribuzione, creare un collegamento basato su parametro dal modello di risorse condivise.</span><span class="sxs-lookup"><span data-stu-id="c8115-303">When applicable to every deployment, create a parameter-driven link from the shared resources template.</span></span>
* <span data-ttu-id="c8115-304">Quando applicabile alle configurazioni note selezionate, ad esempio, installare solo in distribuzioni di grandi dimensioni, creare un collegamento basato su parametro o su variabile dal modello di configurazione nota.</span><span class="sxs-lookup"><span data-stu-id="c8115-304">When applicable to select known configurations—for example, only install on large deployments—create a parameter-driven or variable-driven link from the known configuration template.</span></span>

<span data-ttu-id="c8115-305">Se una determinata risorsa è facoltativa potrebbe non dipendere dal consumer del modello ma dal fornitore del modello.</span><span class="sxs-lookup"><span data-stu-id="c8115-305">Whether a given resource is optional may not be driven by the template consumer but instead by the template provider.</span></span> <span data-ttu-id="c8115-306">Ad esempio, potrebbe essere necessario soddisfare un requisito specifico del prodotto o un componente aggiuntivo di prodotto (comune per i CSV) o per applicare i criteri (comune per SI e gruppi IT aziendali).</span><span class="sxs-lookup"><span data-stu-id="c8115-306">For example, you may need to satisfy a particular product requirement or product add-on (common for CSVs) or to enforce policies (common for SIs and enterprise IT groups).</span></span> <span data-ttu-id="c8115-307">In questi casi, è possibile utilizzare una variabile per stabilire se la risorsa deve essere distribuita o meno.</span><span class="sxs-lookup"><span data-stu-id="c8115-307">In these cases, you can use a variable to identify whether the resource should be deployed.</span></span>

### <a name="known-configuration-resources-template"></a><span data-ttu-id="c8115-308">Modello di risorse di configurazione note</span><span class="sxs-lookup"><span data-stu-id="c8115-308">Known configuration resources template</span></span>
<span data-ttu-id="c8115-309">Nel modello principale, un parametro può essere esposto per consentire al consumer del modello di specificare una configurazione nota desiderata da distribuire.</span><span class="sxs-lookup"><span data-stu-id="c8115-309">In the main template, a parameter can be exposed to allow the template consumer to specify a desired known configuration to deploy.</span></span> <span data-ttu-id="c8115-310">Spesso, questa configurazione nota usa un approccio basato sulle taglie con un set di dimensioni di configurazione fisse quali sandbox, small, medium e large.</span><span class="sxs-lookup"><span data-stu-id="c8115-310">Often, this known configuration uses a t-shirt size approach with a set of fixed configuration sizes such as sandbox, small, medium, and large.</span></span>

![Risorse di configurazione note](./media/best-practices-resource-manager-design-templates/known-config.png)

<span data-ttu-id="c8115-312">**Modello di risorse di configurazione note**</span><span class="sxs-lookup"><span data-stu-id="c8115-312">**Known configuration resources template**</span></span>

<span data-ttu-id="c8115-313">L'approccio a taglie viene comunemente utilizzato, ma i parametri possono rappresentare qualsiasi set di configurazioni note.</span><span class="sxs-lookup"><span data-stu-id="c8115-313">The t-shirt size approach is commonly used, but the parameters can represent any set of known configurations.</span></span> <span data-ttu-id="c8115-314">Ad esempio, è possibile specificare un set di ambienti per un'applicazione aziendale, ad esempio sviluppo, test e prodotto.</span><span class="sxs-lookup"><span data-stu-id="c8115-314">For example, you can specify a set of environments for an enterprise application such as Development, Test, and Product.</span></span> <span data-ttu-id="c8115-315">In alternativa, è possibile utilizzarlo per un servizio cloud per rappresentare unità di scala, versioni di prodotto o le configurazioni del prodotto differenti, ad esempio Community, Developer o Enterprise.</span><span class="sxs-lookup"><span data-stu-id="c8115-315">Or you could use it for a cloud service to represent different scale units, product versions, or product configurations such as Community, Developer, or Enterprise.</span></span>

<span data-ttu-id="c8115-316">Come con il modello di risorsa condivisa, le variabili vengono passate al modello di configurazioni note da:</span><span class="sxs-lookup"><span data-stu-id="c8115-316">As with the shared resource template, variables are passed to the known configurations template from either:</span></span>

* <span data-ttu-id="c8115-317">Un utente finale, ovvero i parametri inviati al modello principale.</span><span class="sxs-lookup"><span data-stu-id="c8115-317">An end user—that is, the parameters sent to the main template.</span></span>
* <span data-ttu-id="c8115-318">Un'organizzazione, ovvero le variabili nel modello principale che rappresentano requisiti o criteri interni.</span><span class="sxs-lookup"><span data-stu-id="c8115-318">An organization—that is, the variables in the main template that represent internal requirements or policies.</span></span>

### <a name="member-resources-template"></a><span data-ttu-id="c8115-319">Modello di risorse membro</span><span class="sxs-lookup"><span data-stu-id="c8115-319">Member resources template</span></span>
<span data-ttu-id="c8115-320">All'interno di una configurazione nota sono spesso inclusi uno o più tipi di nodi membro.</span><span class="sxs-lookup"><span data-stu-id="c8115-320">Within a known configuration, one or more member node types are often included.</span></span> <span data-ttu-id="c8115-321">Ad esempio, con Hadoop si hanno nodi master e nodi dati.</span><span class="sxs-lookup"><span data-stu-id="c8115-321">For example, with Hadoop you have master nodes and data nodes.</span></span> <span data-ttu-id="c8115-322">Installando MongoDB, si hanno nodi dati e un arbitro.</span><span class="sxs-lookup"><span data-stu-id="c8115-322">If you are installing MongoDB, you have data nodes and an arbiter.</span></span> <span data-ttu-id="c8115-323">Distribuendo DataStax, si hanno nodi dati e una VM con OpsCenter installato.</span><span class="sxs-lookup"><span data-stu-id="c8115-323">If you are deploying DataStax, you have data nodes and a VM with OpsCenter installed.</span></span>

![Risorse membro](./media/best-practices-resource-manager-design-templates/member-resources.png)

<span data-ttu-id="c8115-325">**Modello di risorse membro**</span><span class="sxs-lookup"><span data-stu-id="c8115-325">**Member resources template**</span></span>

<span data-ttu-id="c8115-326">Ogni tipo di nodo può avere dimensioni di VM, numeri di dischi collegati, script per installare e configurare i nodi, configurazioni delle porte per le VM, numero di istanze e altri dettagli diversi.</span><span class="sxs-lookup"><span data-stu-id="c8115-326">Each type of nodes can have different sizes of VMs, numbers of attached disks, scripts to install and set up the nodes, port configurations for the VMs, number of instances, and other details.</span></span> <span data-ttu-id="c8115-327">Quindi ogni tipo di nodo ottiene il proprio modello di risorsa membro, contenente i dettagli per la distribuzione e la configurazione di un'infrastruttura, nonché l'esecuzione di script per distribuire e configurare il software all'interno della VM.</span><span class="sxs-lookup"><span data-stu-id="c8115-327">So each node type gets its own member resource template, which contains the details for deploying and configuring an infrastructure as well as executing scripts to deploy and configure software within the VM.</span></span>

<span data-ttu-id="c8115-328">Per le VM, in genere vengono utilizzati due tipi di script, ovvero script ampiamente riutilizzabili e script personalizzati.</span><span class="sxs-lookup"><span data-stu-id="c8115-328">For VMs, typically two types of scripts are used, widely reusable and custom scripts.</span></span>

### <a name="widely-reusable-scripts"></a><span data-ttu-id="c8115-329">Script ampiamente riutilizzabili</span><span class="sxs-lookup"><span data-stu-id="c8115-329">Widely reusable scripts</span></span>
<span data-ttu-id="c8115-330">Gli script ampiamente riutilizzabili possono essere impiegati in più tipi di modelli.</span><span class="sxs-lookup"><span data-stu-id="c8115-330">Widely reusable scripts can be used across multiple types of templates.</span></span> <span data-ttu-id="c8115-331">Uno degli esempi migliori per questi script ampiamente riutilizzabili imposta RAID su Linux per raggruppare dischi in pool e ottenere un numero maggiore di IOPS.</span><span class="sxs-lookup"><span data-stu-id="c8115-331">One of the better examples of these widely reusable scripts sets up RAID on Linux to pool disks and gain a greater number of IOPS.</span></span> <span data-ttu-id="c8115-332">Indipendentemente dal software installato nella VM, questo script consente di riutilizzare procedure consolidate per scenari comuni.</span><span class="sxs-lookup"><span data-stu-id="c8115-332">Regardless of the software being installed in the VM, this script provides reuse of proven practices for common scenarios.</span></span>

![Script riutilizzabili](./media/best-practices-resource-manager-design-templates/reusable-scripts.png)

<span data-ttu-id="c8115-334">**I modelli di risorse membro possono chiamare script ampiamente riutilizzabili**</span><span class="sxs-lookup"><span data-stu-id="c8115-334">**Member resources templates can call widely reusable scripts**</span></span>

### <a name="custom-scripts"></a><span data-ttu-id="c8115-335">Script personalizzati</span><span class="sxs-lookup"><span data-stu-id="c8115-335">Custom scripts</span></span>
<span data-ttu-id="c8115-336">I modelli chiamano comunemente uno o più script che consentono di installare e configurare il software all'interno delle VM.</span><span class="sxs-lookup"><span data-stu-id="c8115-336">Templates commonly call one or more scripts that install and configure software within VMs.</span></span> <span data-ttu-id="c8115-337">È stato osservato uno schema comune con le topologie di grandi dimensioni in cui vengono distribuite più istanze di uno o più tipi membro.</span><span class="sxs-lookup"><span data-stu-id="c8115-337">A common pattern is seen with large topologies where multiple instances of one or more member types are deployed.</span></span> <span data-ttu-id="c8115-338">Per ogni macchina virtuale viene avviato uno script di installazione eseguibile in parallelo, seguito da uno script di configurazione chiamato dopo la distribuzione di tutte le VM (o tutte le VM di un tipo di membro specificato).</span><span class="sxs-lookup"><span data-stu-id="c8115-338">An installation script is initiated for every VM that can be run in parallel, followed by a setup script that is called after all VMs (or all VMs of a given member type) are deployed.</span></span>

![Script personalizzati](./media/best-practices-resource-manager-design-templates/custom-scripts.png)

<span data-ttu-id="c8115-340">**I modelli di risorse membro possono chiamare script per uno scopo specifico, ad esempio la configurazione della VM**</span><span class="sxs-lookup"><span data-stu-id="c8115-340">**Member resources templates can call scripts for a specific purpose such as VM configuration**</span></span>

## <a name="capability-scoped-solution-template-example---redis"></a><span data-ttu-id="c8115-341">Esempio di modello di soluzione con ambito di funzionalità - Redis</span><span class="sxs-lookup"><span data-stu-id="c8115-341">Capability-scoped solution template example - Redis</span></span>
<span data-ttu-id="c8115-342">Per mostrare come potrebbe funzionare un'implementazione, verrà esaminato un esempio pratico di creazione di un modello che facilita la distribuzione e la configurazione di Redis a taglie standard.</span><span class="sxs-lookup"><span data-stu-id="c8115-342">To show how an implementation might work, let's look at a practical example of building a template that facilitates the deployment and configuration of Redis in standard t-shirt sizes.</span></span>  

<span data-ttu-id="c8115-343">Per la distribuzione, sono disponibile un set di risorse condivise (rete virtuale, account di archiviazione, set di disponibilità) e una risorsa facoltativa (jumpbox).</span><span class="sxs-lookup"><span data-stu-id="c8115-343">For the deployment, there are a set of shared resources (virtual network, storage account, availability sets) and an optional resource (jumpbox).</span></span> <span data-ttu-id="c8115-344">Esistono più configurazioni note rappresentate come taglie (small, medium, large) ma ciascuna con un tipo di nodo singolo.</span><span class="sxs-lookup"><span data-stu-id="c8115-344">There are multiple known configurations represented as t-shirt sizes (small, medium, large) but each with a single node type.</span></span> <span data-ttu-id="c8115-345">Esistono anche due script specifici per lo scopo (installazione, configurazione).</span><span class="sxs-lookup"><span data-stu-id="c8115-345">There are also two purpose-specific scripts (installation, configuration).</span></span>

### <a name="creating-the-template-files"></a><span data-ttu-id="c8115-346">Creazione dei file dei modelli</span><span class="sxs-lookup"><span data-stu-id="c8115-346">Creating the template files</span></span>
<span data-ttu-id="c8115-347">Verrà creato un modello principale denominato azuredeploy.json.</span><span class="sxs-lookup"><span data-stu-id="c8115-347">You would create a Main Template named azuredeploy.json.</span></span>

<span data-ttu-id="c8115-348">Verrà creato un modello di risorse condivise denominato shared-resources.json</span><span class="sxs-lookup"><span data-stu-id="c8115-348">You create Shared Resources Template named shared-resources.json</span></span>

<span data-ttu-id="c8115-349">Verrà creato un modello di risorsa facoltativa per abilitare la distribuzione di un jumpbox denominato jumpbox_enabled.json</span><span class="sxs-lookup"><span data-stu-id="c8115-349">You create an Optional Resource Template to enable the deployment of a jumpbox, named jumpbox_enabled.json</span></span>

<span data-ttu-id="c8115-350">Redis usa solo un tipo di nodo singolo, in modo che venga creato un unico modello di risorsa membro denominato node-resources.json.</span><span class="sxs-lookup"><span data-stu-id="c8115-350">Redis uses just a single node type, so you create a single Member Resource Template named node-resources.json.</span></span>

<span data-ttu-id="c8115-351">Con Redis, si vuole installare ogni singolo nodo e quindi configurare il cluster.</span><span class="sxs-lookup"><span data-stu-id="c8115-351">With Redis, you want to install each individual node, and then set up the cluster.</span></span>  <span data-ttu-id="c8115-352">Sono disponibili script per eseguire l'installazione e la configurazione, redis-cluster-install.sh e redis-cluster-setup.sh.</span><span class="sxs-lookup"><span data-stu-id="c8115-352">You have scripts to accommodate the installation and set up, redis-cluster-install.sh and redis-cluster-setup.sh.</span></span>

### <a name="linking-the-templates"></a><span data-ttu-id="c8115-353">Collegamento dei modelli</span><span class="sxs-lookup"><span data-stu-id="c8115-353">Linking the templates</span></span>
<span data-ttu-id="c8115-354">Utilizzando il collegamento di modello, il modello principale si collega al modello di risorse condivise, stabilendo in tal modo la rete virtuale.</span><span class="sxs-lookup"><span data-stu-id="c8115-354">Using template linking, the main template links out to the shared resources template, which establishes the virtual network.</span></span>

<span data-ttu-id="c8115-355">Nel modello principale viene aggiunta la logica per consentire ai consumer del modello di specificare se un jumpbox dovrà essere distribuito o meno.</span><span class="sxs-lookup"><span data-stu-id="c8115-355">Logic is added within the main template to enable consumers of the template to specify whether a jumpbox should be deployed.</span></span> <span data-ttu-id="c8115-356">Un valore *enabled* per il parametro *EnableJumpbox* indica che il cliente vuole distribuire un jumpbox.</span><span class="sxs-lookup"><span data-stu-id="c8115-356">An *enabled* value for the *EnableJumpbox* parameter indicates that the customer wants to deploy a jumpbox.</span></span> <span data-ttu-id="c8115-357">Quando questo valore viene specificato, il modello concatena *_enabled* come suffisso al nome di un modello di base per la funzionalità di jumpbox.</span><span class="sxs-lookup"><span data-stu-id="c8115-357">When this value is provided, the template concatenates *_enabled* as a suffix to a base template name for the jumpbox capability.</span></span>

<span data-ttu-id="c8115-358">Il modello principale applica il valore del parametro *large* come suffisso al nome di un modello di base per le taglie della t-shirt e quindi usa tale valore nel collegamento di un modello per *technology_on_os_large.json*.</span><span class="sxs-lookup"><span data-stu-id="c8115-358">The main template applies the *large* parameter value as a suffix to a base template name for t-shirt sizes, and then uses that value in a template link out to *technology_on_os_large.json*.</span></span>

<span data-ttu-id="c8115-359">La topologia sarà simile a questa illustrazione.</span><span class="sxs-lookup"><span data-stu-id="c8115-359">The topology would resemble this illustration.</span></span>

![Modello di Redis](./media/best-practices-resource-manager-design-templates/redis-template.png)

<span data-ttu-id="c8115-361">**Struttura del modello per un modello di Redis**</span><span class="sxs-lookup"><span data-stu-id="c8115-361">**Template structure for a Redis template**</span></span>

### <a name="configuring-state"></a><span data-ttu-id="c8115-362">Configurazione dello stato</span><span class="sxs-lookup"><span data-stu-id="c8115-362">Configuring state</span></span>
<span data-ttu-id="c8115-363">Per i nodi del cluster, esistono due fasi per la configurazione dello stato, entrambe rappresentate da script specifici per lo scopo.</span><span class="sxs-lookup"><span data-stu-id="c8115-363">For the nodes in the cluster, there are two steps to configuring the state, both represented by Purpose Specific Scripts.</span></span>  <span data-ttu-id="c8115-364">"redis-cluster-install.sh" installa Redis e "redis-cluster-setup.sh" configura il cluster.</span><span class="sxs-lookup"><span data-stu-id="c8115-364">"redis-cluster-install.sh" installs Redis and "redis-cluster-setup.sh" sets up the cluster.</span></span>

### <a name="supporting-different-size-deployments"></a><span data-ttu-id="c8115-365">Supporto di distribuzioni di dimensioni diverse</span><span class="sxs-lookup"><span data-stu-id="c8115-365">Supporting Different Size Deployments</span></span>
<span data-ttu-id="c8115-366">Nelle variabili il modello delle taglie specifica il numero di nodi di ogni tipo di distribuzione per la dimensione specificata (*large*).</span><span class="sxs-lookup"><span data-stu-id="c8115-366">Inside variables, the t-shirt size template specifies the number of nodes of each type to deploy for the specified size (*large*).</span></span> <span data-ttu-id="c8115-367">Distribuisce poi il numero di istanze di macchina virtuale utilizzando i cicli di risorse, specificando nomi univoci alle risorse mediante l'aggiunta di un nome di nodo con un numero di sequenza numerica da *copyIndex()*.</span><span class="sxs-lookup"><span data-stu-id="c8115-367">It then deploys that number of VM instances using resource loops, providing unique names to resources by appending a node name with a numeric sequence number from *copyIndex()*.</span></span> <span data-ttu-id="c8115-368">Questi passaggi vengono eseguiti per le VM di un'area sia sensibile che di una meno sensibile, come definito nel modello di nome della taglia.</span><span class="sxs-lookup"><span data-stu-id="c8115-368">It does these steps for both hot and warm zone VMs, as defined in the t-shirt name template</span></span>

## <a name="decomposition-and-end-to-end-solution-scoped-templates"></a><span data-ttu-id="c8115-369">Modelli con ambito di soluzione end-to-end e di scomposizione</span><span class="sxs-lookup"><span data-stu-id="c8115-369">Decomposition and end-to-end solution scoped templates</span></span>
<span data-ttu-id="c8115-370">Un modello di soluzione con ambito di soluzione end-to-end è incentrato sulla fornitura di una soluzione end-to-end.</span><span class="sxs-lookup"><span data-stu-id="c8115-370">A solution template with an end-to-end solution scope is focused on delivering an end-to-end solution.</span></span>  <span data-ttu-id="c8115-371">Questo approccio prevede in genere una composizione di più modelli con ambito di funzionalità con risorse aggiuntive, logica e stato.</span><span class="sxs-lookup"><span data-stu-id="c8115-371">This approach is typically a composition of multiple capability-scoped templates with additional resources, logic, and state.</span></span>

<span data-ttu-id="c8115-372">Come evidenziato nell'immagine riportata di seguito, lo stesso modello utilizzato per i modelli con ambito di funzionalità viene esteso per i modelli con ambito di soluzione End-to-End.</span><span class="sxs-lookup"><span data-stu-id="c8115-372">As highlighted in the image below, the same model used for capability scoped templates is extended for templates with an End-to-End Solution Scope.</span></span>

<span data-ttu-id="c8115-373">Un modello di risorse condivise e i modelli di risorse facoltative hanno la stessa funzione degli approcci di modelli con ambito di capacità e di funzionalità ma l'ambito è la soluzione end-to-end.</span><span class="sxs-lookup"><span data-stu-id="c8115-373">A Shared Resources Template and Optional Resources Templates serve the same function as in the capacity and capability scoped template approaches, but are scoped for the end to end solution.</span></span>

<span data-ttu-id="c8115-374">Dato che anche i modelli con ambito di soluzione end-to-end possono in genere avere taglie, il modello di risorse di configurazione note riflette ciò che è necessario per una specifica configurazione nota della soluzione.</span><span class="sxs-lookup"><span data-stu-id="c8115-374">As end to end solution scoped templates also can typically have t-shirt sizes, the Known Configuration Resources template reflects what is required for a given known configuration of the solution.</span></span>

<span data-ttu-id="c8115-375">Il modello di risorse di configurazione note crea un collegamento a uno o più modelli di soluzione con ambito funzionalità pertinenti per la soluzione end-to-end nonché ai modelli di risorse membro necessari per la soluzione end-to-end.</span><span class="sxs-lookup"><span data-stu-id="c8115-375">The Known Configuration Resources Template links to one or more capability scoped solution templates that are relevant to the end to end solution as well as the Member Resource Templates that are required for the end to end solution.</span></span>

<span data-ttu-id="c8115-376">Dato che la taglia della soluzione può differire dal modello con ambito di funzionalità individuale, vengono utilizzate variabili all'interno del modello di risorse di configurazione note per fornire i valori appropriati ai modelli di soluzione con ambito di funzionalità downstream allo scopo di distribuire la taglia appropriata.</span><span class="sxs-lookup"><span data-stu-id="c8115-376">As the t-shirt size of the solution may be different than the individual capability-scoped template, variables within the Known Configuration Resources Template are used to provide the appropriate values for downstream capability scoped solution templates to deploy the appropriate t-shirt size.</span></span>

![End-to-end](./media/best-practices-resource-manager-design-templates/end-to-end.png)

<span data-ttu-id="c8115-378">**Il modello utilizzato per i modelli di soluzioni con ambito di capacità o funzionalità possono essere facilmente estesi per gli ambiti dei modelli di soluzioni end-to-end**</span><span class="sxs-lookup"><span data-stu-id="c8115-378">**The model used for capacity or capability scoped solution templates can be readily extended for end to end solution template scopes**</span></span>

## <a name="preparing-templates-for-the-marketplace"></a><span data-ttu-id="c8115-379">Preparazione di modelli per Marketplace</span><span class="sxs-lookup"><span data-stu-id="c8115-379">Preparing templates for the Marketplace</span></span>
<span data-ttu-id="c8115-380">L'approccio precedente si adatta facilmente a scenari in cui le aziende, gli SI e i CSV vogliono distribuire autonomamente i modelli o consentire ai propri clienti di distribuirli in modo indipendente.</span><span class="sxs-lookup"><span data-stu-id="c8115-380">The preceding approach readily accommodates scenarios where Enterprises, SIs, and CSVs want to either deploy the templates themselves or enable their customers to deploy on their own.</span></span>

<span data-ttu-id="c8115-381">Un altro scenario desiderato è la distribuzione di un modello tramite marketplace.</span><span class="sxs-lookup"><span data-stu-id="c8115-381">Another desired scenario is deploying a template via the marketplace.</span></span>  <span data-ttu-id="c8115-382">Questo approccio di scomposizione funziona anche per il marketplace, con alcune piccole modifiche.</span><span class="sxs-lookup"><span data-stu-id="c8115-382">This decomposition approach works for the marketplace as well, with some minor changes.</span></span>

<span data-ttu-id="c8115-383">Come indicato in precedenza, i modelli possono essere utilizzati per tipi di distribuzione separati per la vendita nel marketplace.</span><span class="sxs-lookup"><span data-stu-id="c8115-383">As mentioned previously, templates can be used to offer distinct deployment types for sale in the marketplace.</span></span> <span data-ttu-id="c8115-384">Tipi di distribuzioni distinte possono essere le taglie (small, medium, large), il tipo di prodotto/pubblico (community, sviluppatore, grande impresa) o il tipo di funzionalità (di base, disponibilità elevata).</span><span class="sxs-lookup"><span data-stu-id="c8115-384">Distinct deployment types may be t-shirt sizes (small, medium, large), product/audience type (community, developer, enterprise), or feature type (basic, high availability).</span></span>

<span data-ttu-id="c8115-385">Come illustrato di seguito, la soluzione end-to-end o i modelli con ambito di funzionalità esistenti, possono essere facilmente utilizzati per elencare le diverse configurazioni note nel marketplace.</span><span class="sxs-lookup"><span data-stu-id="c8115-385">As shown below, the existing end to end solution or capability scoped templates can be readily utilized to list the different known configurations in the marketplace.</span></span>

<span data-ttu-id="c8115-386">Per rimuovere il parametro in ingresso denominato tshirtSize vengono innanzitutto modificati i parametri per il modello principale.</span><span class="sxs-lookup"><span data-stu-id="c8115-386">The parameters to the main template are first modified to remove the inbound parameter named tshirtSize.</span></span>

<span data-ttu-id="c8115-387">Sebbene i tipi di distribuzione separati eseguano il mapping al modello di risorse di configurazione note, sono necessarie anche le risorse comuni e la configurazione trovate nel modello di risorse condivise e potenzialmente quelle dei modelli di risorse facoltative.</span><span class="sxs-lookup"><span data-stu-id="c8115-387">While the distinct deployment types map to the Known Configuration Resources Template, they also need the common resources and configuration found in the Shared Resources Template and potentially those in Optional Resource Templates.</span></span>

<span data-ttu-id="c8115-388">Se si desidera pubblicare il modello nel marketplace, occorre stabilire copie distinte del modello principale che sostituiscano il parametro in ingresso precedentemente disponibile di tshirtSize in una variabile incorporata all'interno del modello.</span><span class="sxs-lookup"><span data-stu-id="c8115-388">If you want to publish your template to the marketplace, you establish distinct copies of your Main template that replaces the previously available inbound parameter of tshirtSize to a variable embedded within the template.</span></span>

![Marketplace](./media/best-practices-resource-manager-design-templates/marketplace.png)

<span data-ttu-id="c8115-390">**Adattamento di un modello con ambito di soluzione per marketplace**</span><span class="sxs-lookup"><span data-stu-id="c8115-390">**Adapting a solution scoped template for the marketplace**</span></span>

## <a name="next-steps"></a><span data-ttu-id="c8115-391">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="c8115-391">Next steps</span></span>
* <span data-ttu-id="c8115-392">Per ulteriori informazioni sulla condivisione dello stato all'interno e all'esterno dei modelli, vedere [Condivisione dello stato nei modelli di Gestione risorse di Azure](best-practices-resource-manager-state.md)</span><span class="sxs-lookup"><span data-stu-id="c8115-392">To learn about sharing state into and out of templates, see [Sharing state in Azure Resource Manager templates](best-practices-resource-manager-state.md).</span></span>
* <span data-ttu-id="c8115-393">Per indicazioni su come le aziende possono usare Resource Manager per gestire efficacemente le sottoscrizioni, vedere [Azure enterprise scaffold - prescriptive subscription governance](resource-manager-subscription-governance.md) (Scaffolding aziendale Azure - Governance prescrittiva per le sottoscrizioni).</span><span class="sxs-lookup"><span data-stu-id="c8115-393">For guidance on how enterprises can use Resource Manager to effectively manage subscriptions, see [Azure enterprise scaffold - prescriptive subscription governance](resource-manager-subscription-governance.md).</span></span>

