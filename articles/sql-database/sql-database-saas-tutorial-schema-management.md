---
title: Gestire lo schema del database SQL di Azure in un'app multi-tenant | Microsoft Docs
description: "Gestire lo schema per più tenant in un'applicazione multi-tenant che usa il database SQL di Azure"
keywords: esercitazione database SQL
services: sql-database
documentationcenter: 
author: stevestein
manager: jhubbard
editor: 
ms.assetid: 
ms.service: sql-database
ms.custom: scale out apps
ms.workload: data-management
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/28/2017
ms.author: billgib; sstein
ms.openlocfilehash: 78d76efb88bf11fa18a416b59e6f881539141232
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/03/2017
---
# <a name="manage-schema-for-multiple-tenants-in-the-wingtip-saas-application"></a><span data-ttu-id="ec4b0-104">Gestire lo schema per più tenant nell'applicazione SaaS Wingtip</span><span class="sxs-lookup"><span data-stu-id="ec4b0-104">Manage schema for multiple tenants in the Wingtip SaaS application</span></span>

<span data-ttu-id="ec4b0-105">La [prima esercitazione sull'app SaaS Wingtip](sql-database-saas-tutorial.md) illustra come l'app può effettuare il provisioning di un database tenant e registrarlo nel catalogo.</span><span class="sxs-lookup"><span data-stu-id="ec4b0-105">The [first Wingtip SaaS tutorial](sql-database-saas-tutorial.md) shows how the app can provision a tenant database and register it in the catalog.</span></span> <span data-ttu-id="ec4b0-106">Come qualsiasi altra applicazione, l'app SaaS Wingtip evolverà nel tempo e a volte saranno necessarie modifiche al database.</span><span class="sxs-lookup"><span data-stu-id="ec4b0-106">Like any application, the Wingtip SaaS app will evolve over time, and at times will require changes to the database.</span></span> <span data-ttu-id="ec4b0-107">Tali modifiche possono includere uno schema nuovo o modificato, dati di riferimento nuovi o modificati e attività di manutenzione periodiche del database per garantire prestazioni ottimali dell'app.</span><span class="sxs-lookup"><span data-stu-id="ec4b0-107">Changes may include new or changed schema, new or changed reference data, and routine database maintenance tasks to ensure optimal app performance.</span></span> <span data-ttu-id="ec4b0-108">Con un'applicazione SaaS queste modifiche devono essere distribuite in modo coordinato a un gruppo potenzialmente enorme di database tenant.</span><span class="sxs-lookup"><span data-stu-id="ec4b0-108">With a SaaS application, these changes need to be deployed in a coordinated manner across a potentially massive fleet of tenant databases.</span></span> <span data-ttu-id="ec4b0-109">Per essere incluse in database tenant futuri, le modifiche devono essere incorporate nel processo di provisioning.</span><span class="sxs-lookup"><span data-stu-id="ec4b0-109">For these changes to be in future tenant databases, they need to be incorporated into the provisioning process.</span></span>

<span data-ttu-id="ec4b0-110">Questa esercitazione illustra due scenari: distribuzione degli aggiornamenti dei dati di riferimento per tutti i tenant e restituzione di un indice per la tabella contenente i dati di riferimento.</span><span class="sxs-lookup"><span data-stu-id="ec4b0-110">This tutorial explores two scenarios - deploying reference data updates for all tenants, and retuning an index on the table containing the reference data.</span></span> <span data-ttu-id="ec4b0-111">La funzionalità [processi elastici](sql-database-elastic-jobs-overview.md) viene usata per eseguire queste operazioni su tutti i tenant e il database tenant *di riferimento* viene usato come modello per i nuovi database.</span><span class="sxs-lookup"><span data-stu-id="ec4b0-111">The [Elastic jobs](sql-database-elastic-jobs-overview.md) feature is used to execute these operations across all tenants, and the *golden* tenant database that is used as a template for new databases.</span></span>

<span data-ttu-id="ec4b0-112">In questa esercitazione si apprenderà come:</span><span class="sxs-lookup"><span data-stu-id="ec4b0-112">In this tutorial you learn how to:</span></span>

> [!div class="checklist"]

> * <span data-ttu-id="ec4b0-113">Creare un account di processo</span><span class="sxs-lookup"><span data-stu-id="ec4b0-113">Create a job account</span></span>
> * <span data-ttu-id="ec4b0-114">Eseguire query in più tenant</span><span class="sxs-lookup"><span data-stu-id="ec4b0-114">Query across multiple tenants</span></span>
> * <span data-ttu-id="ec4b0-115">Aggiornare i dati in tutti i database tenant</span><span class="sxs-lookup"><span data-stu-id="ec4b0-115">Update data in all tenant databases</span></span>
> * <span data-ttu-id="ec4b0-116">Creare un indice su una tabella in tutti i database tenant</span><span class="sxs-lookup"><span data-stu-id="ec4b0-116">Create an index on a table in all tenant databases</span></span>


<span data-ttu-id="ec4b0-117">Per completare questa esercitazione, verificare che siano soddisfatti i prerequisiti seguenti:</span><span class="sxs-lookup"><span data-stu-id="ec4b0-117">To complete this tutorial, make sure the following prerequisites are met:</span></span>

* <span data-ttu-id="ec4b0-118">L'app SaaS Wingtip viene distribuita.</span><span class="sxs-lookup"><span data-stu-id="ec4b0-118">The Wingtip SaaS app is deployed.</span></span> <span data-ttu-id="ec4b0-119">Per distribuire in meno di cinque minuti, vedere [Distribuire ed esplorare l'applicazione SaaS Wingtip](sql-database-saas-tutorial.md)</span><span class="sxs-lookup"><span data-stu-id="ec4b0-119">To deploy in less than five minutes, see [Deploy and explore the Wingtip SaaS application](sql-database-saas-tutorial.md)</span></span>
* <span data-ttu-id="ec4b0-120">Azure PowerShell è installato.</span><span class="sxs-lookup"><span data-stu-id="ec4b0-120">Azure PowerShell is installed.</span></span> <span data-ttu-id="ec4b0-121">Per informazioni dettagliate, vedere [Introduzione ad Azure PowerShell](https://docs.microsoft.com/powershell/azure/get-started-azureps)</span><span class="sxs-lookup"><span data-stu-id="ec4b0-121">For details, see [Getting started with Azure PowerShell](https://docs.microsoft.com/powershell/azure/get-started-azureps)</span></span>
* <span data-ttu-id="ec4b0-122">La versione più recente di SQL Server Management Studio (SSMS) è installata.</span><span class="sxs-lookup"><span data-stu-id="ec4b0-122">The latest version of SQL Server Management Studio (SSMS) is installed.</span></span> [<span data-ttu-id="ec4b0-123">Scaricare e installare SSMS</span><span class="sxs-lookup"><span data-stu-id="ec4b0-123">Download and Install SSMS</span></span>](https://docs.microsoft.com/sql/ssms/download-sql-server-management-studio-ssms)

<span data-ttu-id="ec4b0-124">*Questa esercitazione usa funzionalità del servizio database SQL incluse in un'anteprima limitata (processi di Database elastico). Per eseguire questa esercitazione, fornire l'ID della sottoscrizione a SaaSFeedback@microsoft.com indicando nell'oggetto del messaggio "Elastic Jobs Preview". Dopo aver ricevuto conferma che la sottoscrizione è stata abilitata, [scaricare e installare i cmdlet più recenti della versione preliminare](https://github.com/jaredmoo/azure-powershell/releases). Questa versione di anteprima è limitata. Per eventuali domande o richieste di supporto, contattare SaaSFeedback@microsoft.com.*</span><span class="sxs-lookup"><span data-stu-id="ec4b0-124">*This tutorial uses features of the SQL Database service that are in a limited preview (Elastic Database jobs). If you wish to do this tutorial, provide your subscription id to SaaSFeedback@microsoft.com with subject=Elastic Jobs Preview. After you receive confirmation that your subscription has been enabled, [download and install the latest pre-release jobs cmdlets](https://github.com/jaredmoo/azure-powershell/releases). This preview is limited, so contact SaaSFeedback@microsoft.com for related questions or support.*</span></span>


## <a name="introduction-to-saas-schema-management-patterns"></a><span data-ttu-id="ec4b0-125">Introduzione ai modelli di gestione dello schema di SaaS</span><span class="sxs-lookup"><span data-stu-id="ec4b0-125">Introduction to SaaS Schema Management patterns</span></span>

<span data-ttu-id="ec4b0-126">Il modello SaaS con tenant singolo per ogni database trae numerosi vantaggi dall'isolamento dei dati risultante, ma allo stesso tempo introduce complicazioni aggiuntive correlate alla manutenzione e gestione di numerosi database.</span><span class="sxs-lookup"><span data-stu-id="ec4b0-126">The single tenant per database SaaS pattern benefits in many ways from the data isolation that results, but at the same time introduces the additional complexity of maintaining and managing many databases.</span></span> <span data-ttu-id="ec4b0-127">Il servizio [Processi elastici](sql-database-elastic-jobs-overview.md) facilita l'amministrazione e la gestione del livello dati SQL.</span><span class="sxs-lookup"><span data-stu-id="ec4b0-127">[Elastic Jobs](sql-database-elastic-jobs-overview.md) facilitates administration and management of the SQL data tier.</span></span> <span data-ttu-id="ec4b0-128">I processi consentono di eseguire attività (script T-SQL) in modo sicuro e affidabile su un gruppo di database, indipendentemente dall'interazione con gli utenti o dal loro input.</span><span class="sxs-lookup"><span data-stu-id="ec4b0-128">Jobs enable you to securely and reliably, run tasks (T-SQL scripts) independent of user interaction or input, against a group of databases.</span></span> <span data-ttu-id="ec4b0-129">Questo metodo può essere usato per distribuire modifiche dello schema e dei dati di riferimento comuni a tutti i tenant in un'applicazione.</span><span class="sxs-lookup"><span data-stu-id="ec4b0-129">This method can be used to deploy schema and common reference data changes across all tenants in an application.</span></span> <span data-ttu-id="ec4b0-130">Il servizio Processi elastici può essere usato anche per gestire una copia *di riferimento* del database usato per creare nuovi tenant, assicurandosi che disponga sempre dello schema e dei dati di riferimento più recenti.</span><span class="sxs-lookup"><span data-stu-id="ec4b0-130">Elastic Jobs can also be used to maintain a *golden* copy of the database used to create new tenants, ensuring it always has the latest schema and reference data.</span></span>

![schermata](media/sql-database-saas-tutorial-schema-management/schema-management.png)


## <a name="elastic-jobs-limited-preview"></a><span data-ttu-id="ec4b0-132">Anteprima limitata del servizio Processi elastici</span><span class="sxs-lookup"><span data-stu-id="ec4b0-132">Elastic Jobs limited preview</span></span>

<span data-ttu-id="ec4b0-133">È disponibile una nuova versione del servizio Processi elastici che è ora una funzionalità integrata di database SQL di Azure, che non richiede servizi o componenti aggiuntivi.</span><span class="sxs-lookup"><span data-stu-id="ec4b0-133">There is a new version of Elastic Jobs that is now an integrated feature of Azure SQL Database (that requires no additional services or components).</span></span> <span data-ttu-id="ec4b0-134">Questa nuova versione del servizio Processi elastici è attualmente in anteprima limitata.</span><span class="sxs-lookup"><span data-stu-id="ec4b0-134">This new version of Elastic Jobs is currently in limited preview.</span></span> <span data-ttu-id="ec4b0-135">Questa anteprima limitata supporta attualmente PowerShell per creare gli account per processi e T-SQL per creare e gestire i processi.</span><span class="sxs-lookup"><span data-stu-id="ec4b0-135">This limited preview currently supports PowerShell to create job accounts, and T-SQL to create and manage jobs.</span></span>

> [!NOTE]
> <span data-ttu-id="ec4b0-136">*Questa esercitazione usa funzionalità del servizio database SQL incluse in un'anteprima limitata (processi di Database elastico). Per eseguire questa esercitazione, fornire l'ID della sottoscrizione a SaaSFeedback@microsoft.com indicando nell'oggetto del messaggio "Elastic Jobs Preview". Dopo aver ricevuto conferma che la sottoscrizione è stata abilitata, [scaricare e installare i cmdlet più recenti della versione preliminare](https://github.com/jaredmoo/azure-powershell/releases). Questa versione di anteprima è limitata. Per eventuali domande o richieste di supporto, contattare SaaSFeedback@microsoft.com.*</span><span class="sxs-lookup"><span data-stu-id="ec4b0-136">*This tutorial uses features of the SQL Database service that are in a limited preview (Elastic Database jobs). If you wish to do this tutorial, provide your subscription id to SaaSFeedback@microsoft.com with subject=Elastic Jobs Preview. After you receive confirmation that your subscription has been enabled, [download and install the latest pre-release jobs cmdlets](https://github.com/jaredmoo/azure-powershell/releases). This preview is limited, so contact SaaSFeedback@microsoft.com for related questions or support.*</span></span>

## <a name="get-the-wingtip-application-scripts"></a><span data-ttu-id="ec4b0-137">Ottenere gli script dell'applicazione Wingtip</span><span class="sxs-lookup"><span data-stu-id="ec4b0-137">Get the Wingtip application scripts</span></span>

<span data-ttu-id="ec4b0-138">Gli script dell'app SaaS Wingtip e il codice sorgente dell'applicazione sono disponibili nel repository GitHub [WingtipSaaS](https://github.com/Microsoft/WingtipSaaS).</span><span class="sxs-lookup"><span data-stu-id="ec4b0-138">The Wingtip SaaS scripts and application source code are available in the [WingtipSaaS](https://github.com/Microsoft/WingtipSaaS) github repo.</span></span> <span data-ttu-id="ec4b0-139">[Procedura per scaricare gli script dell'app SaaS Wingtip](sql-database-wtp-overview.md#download-and-unblock-the-wingtip-saas-scripts).</span><span class="sxs-lookup"><span data-stu-id="ec4b0-139">[Steps to download the Wingtip SaaS scripts](sql-database-wtp-overview.md#download-and-unblock-the-wingtip-saas-scripts).</span></span>

## <a name="create-a-job-account-database-and-new-job-account"></a><span data-ttu-id="ec4b0-140">Creare un database di account per processi e un nuovo account per processi</span><span class="sxs-lookup"><span data-stu-id="ec4b0-140">Create a job account database and new job account</span></span>

<span data-ttu-id="ec4b0-141">Per questa esercitazione è necessario usare PowerShell per creare il database degli account per processi e l'account per processi.</span><span class="sxs-lookup"><span data-stu-id="ec4b0-141">This tutorial requires you use PowerShell to create the job account database and job account.</span></span> <span data-ttu-id="ec4b0-142">Come MSDB e SQL Agent, il servizio Processi elastici usa un database SQL di Azure per archiviare le definizioni dei processi, lo stato dei processi e la cronologia.</span><span class="sxs-lookup"><span data-stu-id="ec4b0-142">Like MSDB and SQL Agent, Elastic Jobs uses an Azure SQL database to store job definitions, job status, and history.</span></span> <span data-ttu-id="ec4b0-143">Dopo aver creato l'account di processo, è possibile creare e monitorare i processi immediatamente.</span><span class="sxs-lookup"><span data-stu-id="ec4b0-143">Once the job account is created, you can create and monitor jobs immediately.</span></span>

1. <span data-ttu-id="ec4b0-144">Aprire …\\Learning Modules\\Schema Management\\*Demo-SchemaManagement.ps1* in **PowerShell ISE**.</span><span class="sxs-lookup"><span data-stu-id="ec4b0-144">Open …\\Learning Modules\\Schema Management\\*Demo-SchemaManagement.ps1* in the **PowerShell ISE**.</span></span>
1. <span data-ttu-id="ec4b0-145">Premere **F5** per eseguire lo script.</span><span class="sxs-lookup"><span data-stu-id="ec4b0-145">Press **F5** to run the script.</span></span>

<span data-ttu-id="ec4b0-146">Lo script *Demo-SchemaManagement.ps1* chiama lo script *Deploy-SchemaManagement.ps1* per creare un database *S2* denominato **jobaccount** nel server di catalogo.</span><span class="sxs-lookup"><span data-stu-id="ec4b0-146">The *Demo-SchemaManagement.ps1* script calls the *Deploy-SchemaManagement.ps1* script to create an *S2* database named **jobaccount** on the catalog server.</span></span> <span data-ttu-id="ec4b0-147">Viene quindi creato l'account per processi, passando il database jobaccount come parametro per la chiamata di creazione dell'account per processi.</span><span class="sxs-lookup"><span data-stu-id="ec4b0-147">It then creates the job account, passing the jobaccount database as a parameter to the job account creation call.</span></span>

## <a name="create-a-job-to-deploy-new-reference-data-to-all-tenants"></a><span data-ttu-id="ec4b0-148">Creare un processo per distribuire nuovi dati di riferimento a tutti i tenant</span><span class="sxs-lookup"><span data-stu-id="ec4b0-148">Create a job to deploy new reference data to all tenants</span></span>

<span data-ttu-id="ec4b0-149">Ogni database tenant include un set di tipi di sedi che definiscono il tipo di eventi ospitato in una sede.</span><span class="sxs-lookup"><span data-stu-id="ec4b0-149">Each tenant database includes a set of venue types that define the kind of events that are hosted at a venue.</span></span> <span data-ttu-id="ec4b0-150">Questo esercizio illustra come distribuire un aggiornamento a tutti i database tenant per aggiungere due tipi di eventi aggiuntivi: *Motorcycle Racing* (Gare motociclistiche) e *Swimming Club* (Club nuoto).</span><span class="sxs-lookup"><span data-stu-id="ec4b0-150">In this exercise, you deploy an update to all the tenant databases to add two additional venue types: *Motorcycle Racing* and *Swimming Club*.</span></span> <span data-ttu-id="ec4b0-151">Questi tipi di sedi di eventi corrispondono all'immagine di sfondo visualizzata nell'app degli eventi del tenant.</span><span class="sxs-lookup"><span data-stu-id="ec4b0-151">These venue types correspond to the background image you see in the tenant events app.</span></span>

<span data-ttu-id="ec4b0-152">Fare clic nel menu a discesa Venue Type (Tipo di sede) e verificare che siano disponibili solo 10 opzioni e in particolare che i tipi 'Motorcycle Racing' e 'Swimming Club' non siano inclusi nell'elenco.</span><span class="sxs-lookup"><span data-stu-id="ec4b0-152">Click the Venue Type drop down menu and validate that only 10 venue type options are available, and specifically that ‘Motorcycle Racing’ and ‘Swimming Club’ are not included in the list.</span></span>

<span data-ttu-id="ec4b0-153">L'esercizio prevede ora la creazione di un processo per aggiornare la tabella *VenueTypes* in tutti i database tenant e aggiungere i nuovi tipi di eventi.</span><span class="sxs-lookup"><span data-stu-id="ec4b0-153">Now let’s create a job to update the *VenueTypes* table in all the tenant databases and add the new venue types.</span></span>

<span data-ttu-id="ec4b0-154">Per creare un nuovo processo, viene usato un set di stored procedure di sistema per i processi creato nel database jobaccount al momento della creazione dell'account per processi.</span><span class="sxs-lookup"><span data-stu-id="ec4b0-154">To create a new job, we use a set of jobs system stored procedures created in the jobaccount database when the job account was created.</span></span>

1. <span data-ttu-id="ec4b0-155">Aprire SSMS e connettersi al server di catalogo: catalog-\<utente\>.database.windows.net</span><span class="sxs-lookup"><span data-stu-id="ec4b0-155">Open SSMS and connect to the catalog server: catalog-\<user\>.database.windows.net server</span></span>
1. <span data-ttu-id="ec4b0-156">Connettersi anche al server tenant: tenants1-\<user\>.database.windows.net</span><span class="sxs-lookup"><span data-stu-id="ec4b0-156">Also connect to the tenant server: tenants1-\<user\>.database.windows.net</span></span>
1. <span data-ttu-id="ec4b0-157">Passare al database *contosoconcerthall* nel server *tenants1* ed eseguire una query sulla tabella *VenueTypes* per verificare che *Motorcycle Racing* e *Swimming Club* **non siano inclusi** nel set di risultati.</span><span class="sxs-lookup"><span data-stu-id="ec4b0-157">Browse to the *contosoconcerthall* database on the *tenants1* server and query the *VenueTypes* table to confirm that *Motorcycle Racing* and *Swimming Club* **are not** in the results list.</span></span>
1. <span data-ttu-id="ec4b0-158">Aprire il file …\\Learning Modules\\Schema Management\\DeployReferenceData.sql</span><span class="sxs-lookup"><span data-stu-id="ec4b0-158">Open the file …\\Learning Modules\\Schema Management\\DeployReferenceData.sql</span></span>
1. <span data-ttu-id="ec4b0-159">Modificare l'istruzione: SET @wtpUser = &lt;user&gt; e sostituire il valore dell'utente usato per la distribuzione dell'app Wingtip</span><span class="sxs-lookup"><span data-stu-id="ec4b0-159">Modify the statement: SET @wtpUser = &lt;user&gt; and substitute the User value used when you deployed the Wingtip app</span></span>
1. <span data-ttu-id="ec4b0-160">Assicurarsi di essere connessi al database jobaccount e premere **F5** per eseguire lo script</span><span class="sxs-lookup"><span data-stu-id="ec4b0-160">Ensure you are connected to the jobaccount database and press **F5** to run the script</span></span>

* <span data-ttu-id="ec4b0-161">**sp\_add\_target\_group** crea il nome del gruppo di destinazione DemoServerGroup a cui è ora necessario aggiungere i membri di destinazione.</span><span class="sxs-lookup"><span data-stu-id="ec4b0-161">**sp\_add\_target\_group** creates the target group name DemoServerGroup, now we need to add target members.</span></span>
* <span data-ttu-id="ec4b0-162">**sp\_add\_target\_group\_member** aggiunge un tipo di membro di destinazione *server* che desume che tutti i database nel server al momento dell'esecuzione del processo devono essere inclusi nel processo (si noti che si tratta del database tenants1-&lt;Utente&gt; contenente i database tenant). Viene poi aggiunto un tipo di membro di destinazione *database*, nello specifico il database di riferimento basetenantdb che risiede nel server catalog-&lt;Utente&gt; e infine viene aggiunto un altro tipo di membro di destinazione *database* per includere il database adhocanalytics usato in un'esercitazione successiva.</span><span class="sxs-lookup"><span data-stu-id="ec4b0-162">**sp\_add\_target\_group\_member** adds a *server* target member type, which deems all databases within that server (note this is the tenants1-&lt;User&gt; server containing the tenant databases) at time of job execution should be included in the job, the second is adding a *database* target member type, specifically the ‘golden’ database (basetenantdb) that resides on catalog-&lt;User&gt; server, and lastly another *database* target group member type to include the adhocanalytics database that is used in a later tutorial.</span></span>
* <span data-ttu-id="ec4b0-163">**sp\_add\_job** crea un processo denominato "Reference Data Deployment" (Distribuzione dati di riferimento)</span><span class="sxs-lookup"><span data-stu-id="ec4b0-163">**sp\_add\_job** creates a job called “Reference Data Deployment”</span></span>
* <span data-ttu-id="ec4b0-164">**sp\_add\_jobstep** crea il passaggio del processo contenente il testo del comando T-SQL per aggiornare la tabella di riferimento VenueTypes</span><span class="sxs-lookup"><span data-stu-id="ec4b0-164">**sp\_add\_jobstep** creates the job step containing T-SQL command text to update the reference table, VenueTypes</span></span>
* <span data-ttu-id="ec4b0-165">Le restanti viste nello script consentono di confermare l'esistenza degli oggetti e gestire il monitoraggio dell'esecuzione del processo.</span><span class="sxs-lookup"><span data-stu-id="ec4b0-165">The remaining views in the script display the existence of the objects and monitor job execution.</span></span> <span data-ttu-id="ec4b0-166">Usare queste query per esaminare il valore di stato nella colonna **lifecycle** e determinare quando il processo viene completato in tutti i database tenant e nei due database aggiuntivi che contengono la tabella di riferimento.</span><span class="sxs-lookup"><span data-stu-id="ec4b0-166">Use these queries to review the status value in the **lifecycle** column to determine when the job has successfully finished on all tenant databases and the two additional databases containing the reference table.</span></span>

1. <span data-ttu-id="ec4b0-167">In SSMS passare al database *contosoconcerthall* nel server *tenants1* ed eseguire una query sulla tabella *VenueTypes* per verificare che *Motorcycle Racing* e *Swimming Club* **siano ora inclusi** nel set di risultati.</span><span class="sxs-lookup"><span data-stu-id="ec4b0-167">In SSMS, browse to the *contosoconcerthall* database on the *tenants1* server and query the *VenueTypes* table to confirm that *Motorcycle Racing* and *Swimming Club* **are** now in the results list.</span></span>


## <a name="create-a-job-to-manage-the-reference-table-index"></a><span data-ttu-id="ec4b0-168">Creare un processo per gestire l'indice della tabella di riferimento</span><span class="sxs-lookup"><span data-stu-id="ec4b0-168">Create a job to manage the reference table index</span></span>

<span data-ttu-id="ec4b0-169">In modo simile all'esercizio precedente, questo esercizio crea un processo per ricompilare l'indice sulla chiave primaria della tabella di riferimento, ovvero un'operazione tipica di gestione dei database che un amministratore potrebbe eseguire dopo un caricamento di dati di grandi dimensioni in una tabella.</span><span class="sxs-lookup"><span data-stu-id="ec4b0-169">Similar to the previous exercise, this exercise creates a job to rebuild the index on the reference table primary key, a typical database management operation an administrator might perform after a large data load into a table.</span></span>

<span data-ttu-id="ec4b0-170">Creare un processo usando le stesse stored procedure di sistema per i processi.</span><span class="sxs-lookup"><span data-stu-id="ec4b0-170">Create a job using the same jobs 'system' stored procedures.</span></span>

1. <span data-ttu-id="ec4b0-171">Aprire SSMS e connettersi al server catalog-&lt;Utente&gt;.database.windows.net</span><span class="sxs-lookup"><span data-stu-id="ec4b0-171">Open SSMS and connect to the catalog-&lt;User&gt;.database.windows.net server</span></span>
1. <span data-ttu-id="ec4b0-172">Aprire il file …\\Learning Modules\\Schema Management\\OnlineReindex.sql</span><span class="sxs-lookup"><span data-stu-id="ec4b0-172">Open the file …\\Learning Modules\\Schema Management\\OnlineReindex.sql</span></span>
1. <span data-ttu-id="ec4b0-173">Fare clic con il pulsante destro del mouse, scegliere Connessione e connettersi al server catalog-&lt;Utente&gt;.database.windows.net, se necessario</span><span class="sxs-lookup"><span data-stu-id="ec4b0-173">Right click, select Connection, and connect to the catalog-&lt;User&gt;.database.windows.net server, if not already connected</span></span>
1. <span data-ttu-id="ec4b0-174">Assicurarsi di essere connessi al database jobaccount e premere F5 per eseguire lo script</span><span class="sxs-lookup"><span data-stu-id="ec4b0-174">Ensure you are connected to the jobaccount database and press F5 to run the script</span></span>

* <span data-ttu-id="ec4b0-175">sp\_add\_job crea un nuovo processo denominato "Online Reindex PK\_\_VenueTyp\_\_265E44FD7FD4C885"</span><span class="sxs-lookup"><span data-stu-id="ec4b0-175">sp\_add\_job creates a new job called “Online Reindex PK\_\_VenueTyp\_\_265E44FD7FD4C885”</span></span>
* <span data-ttu-id="ec4b0-176">sp\_add\_jobstep crea il passaggio del processo contenente il testo del comando T-SQL per aggiornare l'indice</span><span class="sxs-lookup"><span data-stu-id="ec4b0-176">sp\_add\_jobstep creates the job step containing T-SQL command text to update the index</span></span>




## <a name="next-steps"></a><span data-ttu-id="ec4b0-177">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="ec4b0-177">Next steps</span></span>

<span data-ttu-id="ec4b0-178">In questa esercitazione si è appreso come:</span><span class="sxs-lookup"><span data-stu-id="ec4b0-178">In this tutorial you learned how to:</span></span>

> [!div class="checklist"]

> * <span data-ttu-id="ec4b0-179">Creare un account per processi per eseguire query su più tenant</span><span class="sxs-lookup"><span data-stu-id="ec4b0-179">Create a job account to query across multiple tenants</span></span>
> * <span data-ttu-id="ec4b0-180">Aggiornare i dati in tutti i database tenant</span><span class="sxs-lookup"><span data-stu-id="ec4b0-180">Update data in all tenant databases</span></span>
> * <span data-ttu-id="ec4b0-181">Creare un indice su una tabella in tutti i database tenant</span><span class="sxs-lookup"><span data-stu-id="ec4b0-181">Create an index on a table in all tenant databases</span></span>

[<span data-ttu-id="ec4b0-182">Esercitazione sull'analisi ad hoc</span><span class="sxs-lookup"><span data-stu-id="ec4b0-182">Ad-hoc analytics tutorial</span></span>](sql-database-saas-tutorial-adhoc-analytics.md)


## <a name="additional-resources"></a><span data-ttu-id="ec4b0-183">Risorse aggiuntive</span><span class="sxs-lookup"><span data-stu-id="ec4b0-183">Additional resources</span></span>

* [<span data-ttu-id="ec4b0-184">Altre esercitazioni basate sulla distribuzione dell'applicazione SaaS Wingtip</span><span class="sxs-lookup"><span data-stu-id="ec4b0-184">Additional tutorials that build upon the Wingtip SaaS application deployment</span></span>](sql-database-wtp-overview.md#sql-database-wingtip-saas-tutorials)
* [<span data-ttu-id="ec4b0-185">Gestione dei database cloud con scalabilità orizzontale</span><span class="sxs-lookup"><span data-stu-id="ec4b0-185">Managing scaled-out cloud databases</span></span>](sql-database-elastic-jobs-overview.md)
* [<span data-ttu-id="ec4b0-186">Creare e gestire database SQL di Azure con scalabilità orizzontale</span><span class="sxs-lookup"><span data-stu-id="ec4b0-186">Create and manage scaled-out cloud databases</span></span>](sql-database-elastic-jobs-create-and-manage.md)
