---
title: utilizzando criteri di autorizzazione chiave contenuto aaaConfigure hello portale di Azure | Documenti Microsoft
description: Informazioni su come tooconfigure criteri di autorizzazione per una chiave simmetrica.
services: media-services
documentationcenter: 
author: juliako
manager: cfowler
editor: 
ms.assetid: ee82a3fa-c34b-48f2-a108-8ba321f1691e
ms.service: media-services
ms.workload: media
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 08/09/2017
ms.author: juliako
ms.openlocfilehash: 157fb691b7f71f4889228817e1dc64555e327d48
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/06/2017
---
# <a name="configure-content-key-authorization-policy"></a><span data-ttu-id="24551-103">Configurare i criteri di autorizzazione della chiave simmetrica</span><span class="sxs-lookup"><span data-stu-id="24551-103">Configure Content Key Authorization Policy</span></span>
[!INCLUDE [media-services-selector-content-key-auth-policy](../../includes/media-services-selector-content-key-auth-policy.md)]

## <a name="overview"></a><span data-ttu-id="24551-104">Panoramica</span><span class="sxs-lookup"><span data-stu-id="24551-104">Overview</span></span>
<span data-ttu-id="24551-105">Servizi multimediali di Microsoft Azure consente toodeliver MPEG-DASH, Smooth Streaming e i flussi HTTP-Live-Streaming (HLS) protetti con Advanced Encryption Standard (AES) (utilizzando le chiavi di crittografia a 128 bit) o [Microsoft PlayReady DRM](https://www.microsoft.com/playready/overview/).</span><span class="sxs-lookup"><span data-stu-id="24551-105">Microsoft Azure Media Services enables you toodeliver MPEG-DASH, Smooth Streaming, and HTTP-Live-Streaming (HLS) streams protected with Advanced Encryption Standard (AES) (using 128-bit encryption keys) or [Microsoft PlayReady DRM](https://www.microsoft.com/playready/overview/).</span></span> <span data-ttu-id="24551-106">AMS consente inoltre di toodeliver DASH streams crittografato con DRM Widevine.</span><span class="sxs-lookup"><span data-stu-id="24551-106">AMS also enables you toodeliver DASH streams encrypted with Widevine DRM.</span></span> <span data-ttu-id="24551-107">PlayReady sia Widevine vengono crittografati in base hello specifica la crittografia comune (ISO/IEC 23001-7 CENC).</span><span class="sxs-lookup"><span data-stu-id="24551-107">Both PlayReady and Widevine are encrypted per hello Common Encryption (ISO/IEC 23001-7 CENC) specification.</span></span>

<span data-ttu-id="24551-108">Servizi multimediali fornisce inoltre un **servizio di distribuzione chiave licenza** da cui i client possono ottenere chiavi AES o PlayReady/Widevine licenze tooplay hello contenuto crittografato.</span><span class="sxs-lookup"><span data-stu-id="24551-108">Media Services also provides a **Key/License Delivery Service** from which clients can obtain AES keys or PlayReady/Widevine licenses tooplay hello encrypted content.</span></span>

<span data-ttu-id="24551-109">Questo argomento viene illustrato come toouse hello criteri di autorizzazione chiave del contenuto hello tooconfigure portale Azure.</span><span class="sxs-lookup"><span data-stu-id="24551-109">This topic shows how toouse hello Azure portal tooconfigure hello content key authorization policy.</span></span> <span data-ttu-id="24551-110">è possibile utilizzare successivamente chiave Hello toodynamically crittografare il contenuto.</span><span class="sxs-lookup"><span data-stu-id="24551-110">hello key can later be used toodynamically encrypt your content.</span></span> <span data-ttu-id="24551-111">Si noti che attualmente è possibile crittografare i seguenti formati di streaming hello: HLS, MPEG DASH e Smooth Streaming.</span><span class="sxs-lookup"><span data-stu-id="24551-111">Note that currently you can encrypt hello following streaming formats: HLS, MPEG DASH, and Smooth Streaming.</span></span> <span data-ttu-id="24551-112">Non è possibile crittografare i download progressivi.</span><span class="sxs-lookup"><span data-stu-id="24551-112">You cannot encrypt progressive downloads.</span></span>

<span data-ttu-id="24551-113">Quando un lettore richiede un flusso che è impostato toobe crittografati in modo dinamico, servizi multimediali Usa hello configurato chiave toodynamically crittografare il contenuto utilizzando la crittografia AES o DRM.</span><span class="sxs-lookup"><span data-stu-id="24551-113">When a player requests a stream that is set toobe dynamically encrypted, Media Services uses hello configured key toodynamically encrypt your content using AES or DRM encryption.</span></span> <span data-ttu-id="24551-114">flusso di hello toodecrypt, hello lettore richiederà chiave hello dal servizio di distribuzione delle chiavi hello.</span><span class="sxs-lookup"><span data-stu-id="24551-114">toodecrypt hello stream, hello player will request hello key from hello key delivery service.</span></span> <span data-ttu-id="24551-115">Se è o meno utente hello toodecide autorizzato chiave hello tooget, servizio hello valuta i criteri di autorizzazione hello specificato per la chiave di hello.</span><span class="sxs-lookup"><span data-stu-id="24551-115">toodecide whether or not hello user is authorized tooget hello key, hello service evaluates hello authorization policies that you specified for hello key.</span></span>

<span data-ttu-id="24551-116">Se si prevede di più chiavi simmetriche toohave o toospecify un **servizio di distribuzione chiave licenza** URL diverso dal servizio di distribuzione delle chiavi di servizi multimediali, hello usare Media Services .NET SDK o le API REST.</span><span class="sxs-lookup"><span data-stu-id="24551-116">If you plan toohave multiple content keys or want toospecify a **Key/License Delivery Service** URL other than hello Media Services key delivery service, use Media Services .NET SDK or REST APIs.</span></span>

[<span data-ttu-id="24551-117">Configurare i criteri di autorizzazione della chiave simmetrica mediante Media Services .NET SDK</span><span class="sxs-lookup"><span data-stu-id="24551-117">Configure Content Key Authorization Policy using Media Services .NET SDK</span></span>](media-services-dotnet-configure-content-key-auth-policy.md)

[<span data-ttu-id="24551-118">Configurare i criteri di autorizzazione della chiave simmetrica mediante l'API REST di Servizi multimediali</span><span class="sxs-lookup"><span data-stu-id="24551-118">Configure Content Key Authorization Policy using Media Services REST API</span></span>](media-services-rest-configure-content-key-auth-policy.md)

### <a name="some-considerations-apply"></a><span data-ttu-id="24551-119">Considerazioni applicabili:</span><span class="sxs-lookup"><span data-stu-id="24551-119">Some considerations apply:</span></span>
* <span data-ttu-id="24551-120">Quando viene creato l'account di sistema AMS un **predefinito** endpoint di streaming viene aggiunto l'account tooyour in hello **arrestato** stato.</span><span class="sxs-lookup"><span data-stu-id="24551-120">When your AMS account is created a **default** streaming endpoint is added  tooyour account in hello **Stopped** state.</span></span> <span data-ttu-id="24551-121">toostart streaming del contenuto e intraprendere sfruttare creazione dinamica dei pacchetti e la crittografia dinamica, l'endpoint di streaming è toobe in hello **esecuzione** stato.</span><span class="sxs-lookup"><span data-stu-id="24551-121">toostart streaming your content and take advantage of dynamic packaging and dynamic encryption, your streaming endpoint has toobe in hello **Running** state.</span></span> 
* <span data-ttu-id="24551-122">L'asset deve contenere un set di file MP4 o Smooth Streaming a velocità in bit adattiva.</span><span class="sxs-lookup"><span data-stu-id="24551-122">Your asset must contain a set of adaptive bitrate MP4s or adaptive bitrate Smooth Streaming files.</span></span> <span data-ttu-id="24551-123">Per altre informazioni, vedere l'articolo relativo alla [codifica di un asset](media-services-encode-asset.md).</span><span class="sxs-lookup"><span data-stu-id="24551-123">For more information, see [Encode an asset](media-services-encode-asset.md).</span></span>
* <span data-ttu-id="24551-124">Hello del servizio di distribuzione delle chiavi memorizza nella cache ContentKeyAuthorizationPolicy e gli oggetti correlati (opzioni di criteri e restrizioni) per 15 minuti.</span><span class="sxs-lookup"><span data-stu-id="24551-124">hello Key Delivery service caches ContentKeyAuthorizationPolicy and its related objects (policy options and restrictions) for 15 minutes.</span></span>  <span data-ttu-id="24551-125">Se si crea un oggetto ContentKeyAuthorizationPolicy e specifica toouse una restrizione "Token", quindi eseguirne il test e si aggiornano i criteri di hello troppo "aperto" restrizione, richiederà circa 15 minuti prima di hello criteri commutatori toohello "Aperto" versione di hello criterio.</span><span class="sxs-lookup"><span data-stu-id="24551-125">If you create a ContentKeyAuthorizationPolicy and specify toouse a “Token” restriction, then test it, and then update hello policy too“Open” restriction, it will take roughly 15 minutes before hello policy switches toohello “Open” version of hello policy.</span></span>

## <a name="how-to-configure-hello-key-authorization-policy"></a><span data-ttu-id="24551-126">Procedura: configurare i criteri di autorizzazione chiave hello</span><span class="sxs-lookup"><span data-stu-id="24551-126">How to: configure hello key authorization policy</span></span>
<span data-ttu-id="24551-127">criteri di autorizzazione chiave hello tooconfigure, seleziona hello **protezione del contenuto** pagina.</span><span class="sxs-lookup"><span data-stu-id="24551-127">tooconfigure hello key authorization policy, select hello **CONTENT PROTECTION** page.</span></span>

<span data-ttu-id="24551-128">Servizi multimediali supporta più modalità di autenticazione degli utenti che eseguono richieste di chiavi.</span><span class="sxs-lookup"><span data-stu-id="24551-128">Media Services supports multiple ways of authenticating users who make key requests.</span></span> <span data-ttu-id="24551-129">possono avere criteri di autorizzazione chiave del contenuto Hello **aprire**, **token**, o **IP** restrizioni (**IP** può essere configurato con REST o .NET SDK).</span><span class="sxs-lookup"><span data-stu-id="24551-129">hello content key authorization policy can have **open**, **token**, or **IP** authorization restrictions (**IP** can be configured with REST or .NET SDK).</span></span>

### <a name="open-restriction"></a><span data-ttu-id="24551-130">Restrizione Open</span><span class="sxs-lookup"><span data-stu-id="24551-130">Open restriction</span></span>
<span data-ttu-id="24551-131">Hello **aprire** restrizione implica sistema hello recapiterà tooanyone di chiave hello che effettua una richiesta di chiave.</span><span class="sxs-lookup"><span data-stu-id="24551-131">hello **open** restriction means hello system will deliver hello key tooanyone who makes a key request.</span></span> <span data-ttu-id="24551-132">Questa restrizione può essere utile a scopo di test.</span><span class="sxs-lookup"><span data-stu-id="24551-132">This restriction might be useful for testing purposes.</span></span>

![OpenPolicy][open_policy]

### <a name="token-restriction"></a><span data-ttu-id="24551-134">Restrizione Token</span><span class="sxs-lookup"><span data-stu-id="24551-134">Token restriction</span></span>
<span data-ttu-id="24551-135">token hello toochoose con restrizioni dei criteri, premere hello **TOKEN** pulsante.</span><span class="sxs-lookup"><span data-stu-id="24551-135">toochoose hello token restricted policy, press hello **TOKEN** button.</span></span>

<span data-ttu-id="24551-136">Hello **token** criterio con restrizioni deve essere accompagnato da un token emesso da un **servizio Token di sicurezza** (STS).</span><span class="sxs-lookup"><span data-stu-id="24551-136">hello **token** restricted policy must be accompanied by a token issued by a **Secure Token Service** (STS).</span></span> <span data-ttu-id="24551-137">Servizi multimediali supporta i token in hello **token Web semplici** ([SWT](https://msdn.microsoft.com/library/gg185950.aspx#BKMK_2)) formato e **Token Web JSON** formato (JWT).</span><span class="sxs-lookup"><span data-stu-id="24551-137">Media Services supports tokens in hello **Simple Web Tokens** ([SWT](https://msdn.microsoft.com/library/gg185950.aspx#BKMK_2)) format and **JSON Web Token** (JWT) format.</span></span> <span data-ttu-id="24551-138">Per informazioni, vedere [Autenticazione dei token JWT](http://www.gtrifonov.com/2015/01/03/jwt-token-authentication-in-azure-media-services-and-dynamic-encryption/).</span><span class="sxs-lookup"><span data-stu-id="24551-138">For information, see [JWT token authentication](http://www.gtrifonov.com/2015/01/03/jwt-token-authentication-in-azure-media-services-and-dynamic-encryption/).</span></span>

<span data-ttu-id="24551-139">Servizi multimediali non fornisce **servizi token di sicurezza**.</span><span class="sxs-lookup"><span data-stu-id="24551-139">Media Services does not provide **Secure Token Services**.</span></span> <span data-ttu-id="24551-140">È possibile creare un servizio token di sicurezza personalizzato o utilizzare i token tooissue ACS di Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="24551-140">You can create a custom STS or leverage Microsoft Azure ACS tooissue tokens.</span></span> <span data-ttu-id="24551-141">Hello servizio token di sicurezza deve essere configurato toocreate un token firmato con hello specificato chiave e rilasciare le attestazioni specificate nella configurazione della restrizione token hello.</span><span class="sxs-lookup"><span data-stu-id="24551-141">hello STS must be configured toocreate a token signed with hello specified key and issue claims that you specified in hello token restriction configuration.</span></span> <span data-ttu-id="24551-142">Hello servizio di distribuzione delle chiavi di servizi multimediali restituirà client toohello chiave di crittografia hello se hello token è valido e hello attestazioni nel token hello corrispondono a quelli configurati per la chiave simmetrica hello.</span><span class="sxs-lookup"><span data-stu-id="24551-142">hello Media Services key delivery service will return hello encryption key toohello client if hello token is valid and hello claims in hello token match those configured for hello content key.</span></span> <span data-ttu-id="24551-143">Per ulteriori informazioni, vedere [i token ACS di usare Azure tooissue](http://mingfeiy.com/acs-with-key-services).</span><span class="sxs-lookup"><span data-stu-id="24551-143">For more information, see [Use Azure ACS tooissue tokens](http://mingfeiy.com/acs-with-key-services).</span></span>

<span data-ttu-id="24551-144">Quando si configura hello **TOKEN** criterio con restrizioni, è necessario impostare i valori per **chiave di verifica**, **dell'autorità di certificazione** e **destinatari**.</span><span class="sxs-lookup"><span data-stu-id="24551-144">When configuring hello **TOKEN** restricted policy, you must set values for **verification key**, **issuer** and **audience**.</span></span> <span data-ttu-id="24551-145">chiave di verifica primaria Hello contiene hello chiave che hello token è stato firmato con, autorità emittente è hello servizio token di sicurezza che rilascia token hello.</span><span class="sxs-lookup"><span data-stu-id="24551-145">hello primary verification key contains hello key that hello token was signed with, issuer is hello secure token service that issues hello token.</span></span> <span data-ttu-id="24551-146">destinatari Hello (talvolta denominato ambito) descrive finalità hello del token hello o hello risorse hello token autorizza l'accesso.</span><span class="sxs-lookup"><span data-stu-id="24551-146">hello audience (sometimes called scope) describes hello intent of hello token or hello resource hello token authorizes access to.</span></span> <span data-ttu-id="24551-147">Hello servizio di distribuzione delle chiavi di servizi multimediali verifica che i valori nel token hello corrispondano valori hello hello modello.</span><span class="sxs-lookup"><span data-stu-id="24551-147">hello Media Services key delivery service validates that these values in hello token match hello values in hello template.</span></span>

### <a name="playready"></a><span data-ttu-id="24551-148">PlayReady</span><span class="sxs-lookup"><span data-stu-id="24551-148">PlayReady</span></span>
<span data-ttu-id="24551-149">Quando si protegge il contenuto con **PlayReady**, uno di hello utili toospecify nei criteri di autorizzazione è una stringa XML che definisce il modello di licenza PlayReady hello.</span><span class="sxs-lookup"><span data-stu-id="24551-149">When protecting your content with **PlayReady**, one of hello things you need toospecify in your authorization policy is an XML string that defines hello PlayReady license template.</span></span> <span data-ttu-id="24551-150">Per impostazione predefinita, è hello seguenti criteri:</span><span class="sxs-lookup"><span data-stu-id="24551-150">By default, hello following policy is set:</span></span>

<span data-ttu-id="24551-151"><PlayReadyLicenseResponseTemplate xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://schemas.microsoft.com/Azure/MediaServices/KeyDelivery/PlayReadyTemplate/v1"><LicenseTemplates><PlayReadyLicenseTemplate><AllowTestDevices>true</AllowTestDevices><ContentKey i:type="ContentEncryptionKeyFromHeader" /><LicenseType>Nonpersistent</LicenseType><PlayRight><AllowPassingVideoContentToUnknownOutput>Allowed</AllowPassingVideoContentToUnknownOutput></PlayRight></PlayReadyLicenseTemplate></LicenseTemplates></PlayReadyLicenseResponseTemplate></span><span class="sxs-lookup"><span data-stu-id="24551-151"><PlayReadyLicenseResponseTemplate xmlns:i="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://schemas.microsoft.com/Azure/MediaServices/KeyDelivery/PlayReadyTemplate/v1"> <LicenseTemplates> <PlayReadyLicenseTemplate><AllowTestDevices>true</AllowTestDevices> <ContentKey i:type="ContentEncryptionKeyFromHeader" /> <LicenseType>Nonpersistent</LicenseType> <PlayRight> <AllowPassingVideoContentToUnknownOutput>Allowed</AllowPassingVideoContentToUnknownOutput> </PlayRight> </PlayReadyLicenseTemplate> </LicenseTemplates> </PlayReadyLicenseResponseTemplate></span></span>

<span data-ttu-id="24551-152">È possibile fare clic su hello **importare criteri xml** pulsante e fornire un diverso XML conforme a XML Schema definito toohello [qui](media-services-playready-license-template-overview.md).</span><span class="sxs-lookup"><span data-stu-id="24551-152">You can click hello **import policy xml** button and provide a different XML which conforms toohello  XML Schema defined [here](media-services-playready-license-template-overview.md).</span></span>

## <a name="next-step"></a><span data-ttu-id="24551-153">Passaggio successivo</span><span class="sxs-lookup"><span data-stu-id="24551-153">Next step</span></span>
<span data-ttu-id="24551-154">Analizzare i percorsi di apprendimento di Servizi multimediali.</span><span class="sxs-lookup"><span data-stu-id="24551-154">Review Media Services learning paths.</span></span>

[!INCLUDE [media-services-learning-paths-include](../../includes/media-services-learning-paths-include.md)]

## <a name="provide-feedback"></a><span data-ttu-id="24551-155">Fornire commenti e suggerimenti</span><span class="sxs-lookup"><span data-stu-id="24551-155">Provide feedback</span></span>
[!INCLUDE [media-services-user-voice-include](../../includes/media-services-user-voice-include.md)]

[open_policy]: ./media/media-services-portal-configure-content-key-auth-policy/media-services-protect-content-with-open-restriction.png
[token_policy]: ./media/media-services-key-authorization-policy/media-services-protect-content-with-token-restriction.png

