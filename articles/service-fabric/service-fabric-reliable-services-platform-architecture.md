---
title: Architettura di Reliable Services | Documentazione Microsoft
description: Panoramica dell'architettura per servizi Reliable Services con e senza stato
services: service-fabric
documentationcenter: .net
author: AlanWarwick
manager: timlt
editor: vturecek
ms.assetid: af002ae6-7f6d-4769-b049-82aa1ba0891b
ms.service: Service-Fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 03/30/2016
ms.author: alanwar
redirect_url: /azure/service-fabric/service-fabric-reliable-services-introduction
ms.openlocfilehash: a00a16945356b9731485554e06df46528b5c7bb2
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 07/11/2017
---
# <a name="architecture-for-stateful-and-stateless-reliable-services"></a><span data-ttu-id="9423d-103">Architettura per servizi Reliable Services con e senza stato</span><span class="sxs-lookup"><span data-stu-id="9423d-103">Architecture for stateful and stateless Reliable Services</span></span>
<span data-ttu-id="9423d-104">Un servizio Reliable Services di Azure Service Fabric può essere con o senza stato.</span><span class="sxs-lookup"><span data-stu-id="9423d-104">An Azure Service Fabric Reliable Service may be stateful or stateless.</span></span> <span data-ttu-id="9423d-105">Ogni tipo di servizio viene eseguito all'interno di un'architettura specifica,</span><span class="sxs-lookup"><span data-stu-id="9423d-105">Each type of service runs within a specific architecture.</span></span> <span data-ttu-id="9423d-106">descritta in questo articolo.</span><span class="sxs-lookup"><span data-stu-id="9423d-106">These architectures are described in this article.</span></span>
<span data-ttu-id="9423d-107">Per altre informazioni sulle differenze tra i servizi con e senza stato, vedere [Panoramica di Reliable Services](service-fabric-reliable-services-introduction.md).</span><span class="sxs-lookup"><span data-stu-id="9423d-107">See the [Reliable Service overview](service-fabric-reliable-services-introduction.md) for more information about the differences between stateful and stateless services.</span></span>

## <a name="stateful-reliable-services"></a><span data-ttu-id="9423d-108">Reliable Services con stato</span><span class="sxs-lookup"><span data-stu-id="9423d-108">Stateful Reliable Services</span></span>
### <a name="architecture-of-a-stateful-service"></a><span data-ttu-id="9423d-109">Architettura di un servizio con stato</span><span class="sxs-lookup"><span data-stu-id="9423d-109">Architecture of a stateful service</span></span>
![Diagramma dell'architettura di un servizio con stato](./media/service-fabric-reliable-services-platform-architecture/reliable-stateful-service-architecture.png)

### <a name="stateful-reliable-service"></a><span data-ttu-id="9423d-111">Reliable Services con stato</span><span class="sxs-lookup"><span data-stu-id="9423d-111">Stateful Reliable Service</span></span>
<span data-ttu-id="9423d-112">Un servizio Reliable Services con stato può derivare dalla classe StatefulService o StatefulServiceBase.</span><span class="sxs-lookup"><span data-stu-id="9423d-112">A stateful Reliable Service can derive from either the StatefulService or StatefulServiceBase class.</span></span> <span data-ttu-id="9423d-113">Queste classi di base sono entrambe fornite da Service Fabric</span><span class="sxs-lookup"><span data-stu-id="9423d-113">Both of these base classes are provided by Service Fabric.</span></span> <span data-ttu-id="9423d-114">e offrono diversi livelli di supporto e astrazione per consentire al servizio con stato di interagire con Service Fabric e di partecipare come servizio al cluster di Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="9423d-114">They offer various levels of support and abstraction for the stateful service to interface with Service Fabric--and to participate as a service within the Service Fabric cluster.</span></span>

<span data-ttu-id="9423d-115">La classe StatefulService deriva dalla classe StatefulServiceBase,</span><span class="sxs-lookup"><span data-stu-id="9423d-115">StatefulService derives from StatefulServiceBase.</span></span> <span data-ttu-id="9423d-116">che offre ai servizi maggiore flessibilità ma richiede una comprensione approfondita dei componenti interni di Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="9423d-116">StatefulServiceBase offers services more flexibility, but requires more understanding of the internals of Service Fabric.</span></span>
<span data-ttu-id="9423d-117">Per altre informazioni sulle specifiche di sviluppo di servizi con le classi StatefulService e StatefulServiceBase, vedere [Panoramica di Reliable Services](service-fabric-reliable-services-introduction.md) e [Uso avanzato del modello di programmazione Reliable Services](service-fabric-reliable-services-advanced-usage.md).</span><span class="sxs-lookup"><span data-stu-id="9423d-117">See the [Reliable Service overview](service-fabric-reliable-services-introduction.md) and [Reliable Service advanced usage](service-fabric-reliable-services-advanced-usage.md) for more information on the specifics of writing services by using the StatefulService and StatefulServiceBase classes.</span></span>

<span data-ttu-id="9423d-118">Entrambe le classi di base gestiscono la durata e il ruolo dell'implementazione del servizio.</span><span class="sxs-lookup"><span data-stu-id="9423d-118">Both base classes manage the lifetime and role of the service implementation.</span></span> <span data-ttu-id="9423d-119">L'implementazione del servizio può eseguire l'override dei metodi virtuali di una delle classi di base se deve eseguire operazioni in quelle fasi del ciclo di vita dell'implementazione o se deve creare un oggetto CommunicationListener.</span><span class="sxs-lookup"><span data-stu-id="9423d-119">The service implementation may override virtual methods of either base class if the service implementation has work to do at those points in the service implementation lifecycle--or if it wants to create a communication listener object.</span></span> <span data-ttu-id="9423d-120">Si noti che, anche se l'implementazione del servizio può implementare il proprio oggetto CommunicationListener esponendo ICommunicationListener, come mostrato nel diagramma precedente, il listener di comunicazione viene effettivamente implementato da Service Fabric (poiché l'implementazione del servizio usa un listener di comunicazione implementato da Service Fabric).</span><span class="sxs-lookup"><span data-stu-id="9423d-120">Note that although a service implementation may implement its own communication listener object exposing ICommunicationListener, in the diagram above, the communication listener is implemented by Service Fabric--as the service implementation uses a communication listener that is implemented by Service Fabric.</span></span>

<span data-ttu-id="9423d-121">Un servizio Reliable Services con stato usa Reliable State Manager per sfruttare i vantaggi offerti dalle raccolte Reliable Collections.</span><span class="sxs-lookup"><span data-stu-id="9423d-121">A stateful Reliable Service uses the reliable state manager to take advantage of reliable collections.</span></span> <span data-ttu-id="9423d-122">Le raccolte Reliable Collections sono strutture dati locali altamente disponibili per il servizio, ovvero sono sempre disponibili indipendentemente dai failover del servizio.</span><span class="sxs-lookup"><span data-stu-id="9423d-122">Reliable collections are local data structures that are highly available to the service--that is, they are always available, regardless of service failovers.</span></span> <span data-ttu-id="9423d-123">Ogni tipo di raccolta Reliable Collections viene implementato da un provider di stato affidabile.</span><span class="sxs-lookup"><span data-stu-id="9423d-123">Each type of reliable collection is implemented by a reliable state provider.</span></span>
<span data-ttu-id="9423d-124">Per altre informazioni sulle raccolte Reliable Collections, vedere [Introduzione alle Reliable Collections](service-fabric-reliable-services-reliable-collections.md).</span><span class="sxs-lookup"><span data-stu-id="9423d-124">For more information on reliable collections, see the [reliable collections overview](service-fabric-reliable-services-reliable-collections.md).</span></span>

### <a name="reliable-state-manager-and-state-providers"></a><span data-ttu-id="9423d-125">Reliable state manager e provider di stato</span><span class="sxs-lookup"><span data-stu-id="9423d-125">Reliable state manager and state providers</span></span>
<span data-ttu-id="9423d-126">Reliable State Manager è l'oggetto che gestisce i provider di stato affidabili.</span><span class="sxs-lookup"><span data-stu-id="9423d-126">The reliable state manager is the object that manages reliable state providers.</span></span> <span data-ttu-id="9423d-127">Integra funzionalità che consentono di creare, eliminare, enumerare e assicurare che i provider di stato affidabili siano persistenti e a disponibilità elevata.</span><span class="sxs-lookup"><span data-stu-id="9423d-127">It has the functionality to create, delete, enumerate, and ensure that the reliable state providers are persisted and highly available.</span></span> <span data-ttu-id="9423d-128">Un'istanza di un provider di stato affidabile rappresenta un'istanza di una struttura dati persistente e a disponibilità elevata, ad esempio un dizionario o una coda.</span><span class="sxs-lookup"><span data-stu-id="9423d-128">A reliable state provider instance represents an instance of a persisted and highly available data structure, such as a dictionary or a queue.</span></span>

<span data-ttu-id="9423d-129">Ogni provider di stato affidabile espone un'interfaccia che viene usata dal servizio con stato per interagire con il provider di stato stesso.</span><span class="sxs-lookup"><span data-stu-id="9423d-129">Each reliable state provider exposes an interface that is used by a stateful service to interact with the reliable state provider.</span></span> <span data-ttu-id="9423d-130">L'interfaccia IReliableDictionary, ad esempio, viene usata con il dizionario affidabile (ReliableDictionary), mentre l'interfaccia IReliableQueue viene usata per interagire con la coda affidabile (ReliableQueue).</span><span class="sxs-lookup"><span data-stu-id="9423d-130">For example, IReliableDictionary is used to interface with the reliable dictionary, while IReliableQueue is used to interface with the reliable queue.</span></span> <span data-ttu-id="9423d-131">Tutti i provider di stato affidabili implementano l'interfaccia IReliableState.</span><span class="sxs-lookup"><span data-stu-id="9423d-131">All reliable state providers implement the IReliableState interface.</span></span>

<span data-ttu-id="9423d-132">Reliable State Manager ha un'interfaccia denominata IReliableStateManager, che consente l'accesso da un servizio con stato.</span><span class="sxs-lookup"><span data-stu-id="9423d-132">The reliable state manager has an interface named IReliableStateManager, which allows access to it from a stateful service.</span></span> <span data-ttu-id="9423d-133">Le interfacce per i provider di stato affidabili vengono restituite tramite IReliableStateManager.</span><span class="sxs-lookup"><span data-stu-id="9423d-133">Interfaces to reliable state providers are returned through IReliableStateManager.</span></span>

<span data-ttu-id="9423d-134">Reliable State Manager usa un'architettura plug-in dinamica che consente di integrare dinamicamente nuovi tipi di raccolte Reliable Collections.</span><span class="sxs-lookup"><span data-stu-id="9423d-134">The reliable state manager uses a plug-in architecture so that new types of reliable collections can be plugged in dynamically.</span></span>

<span data-ttu-id="9423d-135">Gli oggetti ReliableDictionary e ReliableQueue sono basati sull'implementazione di un archivio differenziale ad alte prestazioni con controllo delle versioni.</span><span class="sxs-lookup"><span data-stu-id="9423d-135">The reliable dictionary and reliable queue are built upon the implementation of a high-performance, versioned differential store.</span></span>

### <a name="transactional-replicator"></a><span data-ttu-id="9423d-136">Transactional Replicator</span><span class="sxs-lookup"><span data-stu-id="9423d-136">Transactional replicator</span></span>
<span data-ttu-id="9423d-137">Il componente Transactional Replicator deve garantire che lo stato del servizio, ovvero lo stato all'interno di Reliable State Manager e Reliable Collections, sia coerente in tutte le repliche che eseguono il servizio</span><span class="sxs-lookup"><span data-stu-id="9423d-137">The transactional replicator component is responsible for ensuring that the state of a service (that is, the state within the reliable state manager and the reliable collections) is consistent across all replicas running the service.</span></span> <span data-ttu-id="9423d-138">e che sia inoltre persistente nel log.</span><span class="sxs-lookup"><span data-stu-id="9423d-138">It also ensures that the state is persisted in the log.</span></span> <span data-ttu-id="9423d-139">Reliable State Manager interagisce con Transactional Replicator tramite un meccanismo privato.</span><span class="sxs-lookup"><span data-stu-id="9423d-139">The reliable state manager interfaces with the transactional replicator via a private mechanism.</span></span>

<span data-ttu-id="9423d-140">Transactional Replicator usa un protocollo di rete per comunicare lo stato alle altre repliche dell'istanza del servizio, in modo che tutte le repliche abbiano informazioni aggiornate sullo stato.</span><span class="sxs-lookup"><span data-stu-id="9423d-140">The transactional replicator uses a network protocol to communicate state with other replicas of the service instance so that all replicas have up-to-date state information.</span></span>

<span data-ttu-id="9423d-141">Transactional Replicator usa un log per rendere persistenti le informazioni sullo stato, in modo che queste ultime non vengano danneggiate da eventuali arresti anomali dei processi o dei nodi.</span><span class="sxs-lookup"><span data-stu-id="9423d-141">The transactional replicator uses a log to persist state information so that the state information survives process or node crashes.</span></span> <span data-ttu-id="9423d-142">L'interazione con il log avviene tramite un meccanismo privato.</span><span class="sxs-lookup"><span data-stu-id="9423d-142">The interface to the log is via a private mechanism.</span></span>

### <a name="log"></a><span data-ttu-id="9423d-143">Log</span><span class="sxs-lookup"><span data-stu-id="9423d-143">Log</span></span>
<span data-ttu-id="9423d-144">Il componente Log offre un archivio persistente ad alte prestazioni che può essere ottimizzato sia per la scrittura su unità disco rigido o SSD (Solid State Disk)</span><span class="sxs-lookup"><span data-stu-id="9423d-144">The log component provides a high-performance persistent store that can be optimized for writing to spinning or solid-state disks.</span></span>  <span data-ttu-id="9423d-145">La progettazione del componente Log è finalizzata a rendere l'archiviazione persistente (ad es. i dischi rigidi) locale rispetto ai nodi che eseguono il servizio con stato,</span><span class="sxs-lookup"><span data-stu-id="9423d-145">The design of the log is for the persistent storage (i.e., hard disks) to be local to the nodes that are running the stateful service.</span></span> <span data-ttu-id="9423d-146">in modo da consentire una più bassa latenza e una maggiore velocità effettiva rispetto all'archiviazione persistente remota, non locale rispetto al nodo.</span><span class="sxs-lookup"><span data-stu-id="9423d-146">This allows for low latencies and high throughput, as compared to remote persistent storage, which is not local to the node.</span></span>

<span data-ttu-id="9423d-147">Il componente Log usa più file di log.</span><span class="sxs-lookup"><span data-stu-id="9423d-147">The log component uses multiple log files.</span></span> <span data-ttu-id="9423d-148">Esiste un file di log condiviso a livello di nodo utilizzato da tutte le repliche perché è in grado di fornire la latenza minima e la massima velocità effettiva per l'archiviazione dei dati sullo stato.</span><span class="sxs-lookup"><span data-stu-id="9423d-148">There is a node-wide shared log file that all replicas use as it can provide the lowest latency and highest throughput for storing state data.</span></span> <span data-ttu-id="9423d-149">Per impostazione predefinita il log condiviso viene posizionato nella directory di lavoro del nodo Service Fabric ma, può anche essere configurato per essere posizionato in un altro percorso, preferibilmente su un disco riservato solo al log condiviso.</span><span class="sxs-lookup"><span data-stu-id="9423d-149">By default the shared log is placed in the Service Fabric node work directory but it may also be configured to be placed at another location, ideally on a disk reserved for only the shared log.</span></span> <span data-ttu-id="9423d-150">Ogni replica del servizio dispone inoltre di un file di log dedicato che si trova all'interno della directory di lavoro del servizio.</span><span class="sxs-lookup"><span data-stu-id="9423d-150">Each replica for the service also has a dedicated log file and the dedicated log is placed within the service's work directory.</span></span> <span data-ttu-id="9423d-151">Non esiste alcun meccanismo per configurare il log dedicato in modo da posizionarlo in un percorso diverso.</span><span class="sxs-lookup"><span data-stu-id="9423d-151">There is no mechanism to configure the dedicated log to be placed at a different location.</span></span>

<span data-ttu-id="9423d-152">Il log condiviso è un'area di transizione per le informazioni sullo stato della replica, mentre il file di log dedicato è la destinazione finale in cui le informazioni vengono rese persistenti.</span><span class="sxs-lookup"><span data-stu-id="9423d-152">The shared log is a transitional area for the replica's state information, while the dedicated log file is the final destination where it is persisted.</span></span> <span data-ttu-id="9423d-153">In questa progettazione le informazioni sullo stato vengono prima scritte nel file di log condiviso e quindi spostate in background al file di log dedicato.</span><span class="sxs-lookup"><span data-stu-id="9423d-153">In this design, the state information is first written to the shared log file and then lazily moved to the dedicated log file in the background.</span></span> <span data-ttu-id="9423d-154">In questo modo, la scrittura nel log condiviso dovrebbe presentare il più basso livello di latenza e il più alto livello di velocità effettiva, così da rendere più rapido lo stato di avanzamento del servizio.</span><span class="sxs-lookup"><span data-stu-id="9423d-154">In this way, the write to the shared log would have the lowest latency and highest throughput which allows the service to make progress faster.</span></span>

<span data-ttu-id="9423d-155">Letture e scritture nel log condiviso vengono eseguite tramite IO diretto nello spazio su disco preassegnato per il file di log condiviso.</span><span class="sxs-lookup"><span data-stu-id="9423d-155">Reads and writes to the shared log are done via direct IO to preallocated space on the disk for the shared log file.</span></span> <span data-ttu-id="9423d-156">Per consentire un utilizzo ottimale dello spazio su disco nell'unità con log dedicati, il file di log dedicato viene creato come file NTFS sparse.</span><span class="sxs-lookup"><span data-stu-id="9423d-156">To allow optimal use of disk space on the drive with dedicated logs, the dedicated log file is created as a NTFS sparse file.</span></span> <span data-ttu-id="9423d-157">Questo permetterà l'overprovisioning dello spazio su disco e il sistema operativo visualizzerà i file del log dedicato utilizzando molto più spazio su disco rispetto a quello effettivamente utilizzato.</span><span class="sxs-lookup"><span data-stu-id="9423d-157">Note that this will allow overprovisioning of disk space and the OS will show the dedicated log files using much more disk space than is actually used.</span></span>

<span data-ttu-id="9423d-158">Ad eccezione di un'interfaccia utente minima usata per l'interazione con il componente Log, il file di log viene scritto come driver in modalità kernel.</span><span class="sxs-lookup"><span data-stu-id="9423d-158">Aside from a minimal user-mode interface to the log, the log is written as a kernel-mode driver.</span></span> <span data-ttu-id="9423d-159">L'esecuzione del log come driver in modalità kernel può assicurare prestazioni elevate a tutti i servizi che lo usano.</span><span class="sxs-lookup"><span data-stu-id="9423d-159">By running as a kernel-mode driver, the log can provide the highest performance to all services that use it.</span></span>

<span data-ttu-id="9423d-160">Per altre informazioni sulla configurazione del log, vedere [Configurazione di Reliable Services con stato](service-fabric-reliable-services-configuration.md).</span><span class="sxs-lookup"><span data-stu-id="9423d-160">For more information about configuring the log, see [Configuring stateful Reliable Services](service-fabric-reliable-services-configuration.md).</span></span>

## <a name="stateless-reliable-service"></a><span data-ttu-id="9423d-161">Reliable Services senza stato</span><span class="sxs-lookup"><span data-stu-id="9423d-161">Stateless Reliable Service</span></span>
### <a name="architecture-of-a-stateless-service"></a><span data-ttu-id="9423d-162">Architettura di un servizio senza stato</span><span class="sxs-lookup"><span data-stu-id="9423d-162">Architecture of a stateless service</span></span>
![Diagramma dell'architettura di un servizio senza stato](./media/service-fabric-reliable-services-platform-architecture/reliable-stateless-service-architecture.png)

### <a name="stateless-reliable-service"></a><span data-ttu-id="9423d-164">Reliable Services senza stato</span><span class="sxs-lookup"><span data-stu-id="9423d-164">Stateless Reliable Service</span></span>
<span data-ttu-id="9423d-165">Le implementazioni di un servizio senza stato derivano dalla classe StatelessService o StatelessServiceBase,</span><span class="sxs-lookup"><span data-stu-id="9423d-165">Stateless service implementations derive from the StatelessService or StatelessServiceBase class.</span></span> <span data-ttu-id="9423d-166">che consente una maggiore flessibilità rispetto alla classe StatelessService.</span><span class="sxs-lookup"><span data-stu-id="9423d-166">The StatelessServiceBase class allows more flexibility than the StatelessService class.</span></span>
<span data-ttu-id="9423d-167">Entrambe le classi di base gestiscono la durata e il ruolo di un servizio.</span><span class="sxs-lookup"><span data-stu-id="9423d-167">Both base classes manage the lifetime and role of a service.</span></span>

<span data-ttu-id="9423d-168">L'implementazione del servizio può eseguire l'override dei metodi virtuali di una delle classi di base se il servizio deve eseguire operazioni in quelle fasi del ciclo di vita del servizio o se deve creare un oggetto CommunicationListener.</span><span class="sxs-lookup"><span data-stu-id="9423d-168">The service implementation may override virtual methods of either base class if the service has work to do at those points in the service lifecycle--or if it wants to create a communication listener object.</span></span> <span data-ttu-id="9423d-169">Si noti che, anche se il servizio può implementare il proprio oggetto CommunicationListener esponendo ICommunicationListener, come mostrato nel diagramma precedente, il listener di comunicazione viene effettivamente implementato da Service Fabric (poiché l'implementazione del servizio usa un listener di comunicazione implementato da Service Fabric).</span><span class="sxs-lookup"><span data-stu-id="9423d-169">Note that although the service may implement its own communication listener object exposing ICommunicationListener, in the diagram above, the communication listener is implemented by Service Fabric, as that service implementation uses a communication listener that is implemented by Service Fabric.</span></span>

<span data-ttu-id="9423d-170">Per altre informazioni sulle specifiche di sviluppo di servizi con le classi StatelessService e StatelessServiceBase, vedere [Panoramica di Reliable Services](service-fabric-reliable-services-introduction.md) e [Uso avanzato del modello di programmazione Reliable Services](service-fabric-reliable-services-advanced-usage.md).</span><span class="sxs-lookup"><span data-stu-id="9423d-170">See the [Reliable Service overview](service-fabric-reliable-services-introduction.md) and [Reliable Service advanced usage](service-fabric-reliable-services-advanced-usage.md) for more information on the specifics of writing services using the StatelessService and StatelessServiceBase classes.</span></span>

<!--Every topic should have next steps and links to the next logical set of content to keep the customer engaged-->
## <a name="next-steps"></a><span data-ttu-id="9423d-171">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="9423d-171">Next steps</span></span>
<span data-ttu-id="9423d-172">Per altre informazioni su Service Fabric, vedere:</span><span class="sxs-lookup"><span data-stu-id="9423d-172">For more information about Service Fabric, see:</span></span>

[<span data-ttu-id="9423d-173">Panoramica di Reliable Services</span><span class="sxs-lookup"><span data-stu-id="9423d-173">Reliable service overview</span></span>](service-fabric-reliable-services-introduction.md)

[<span data-ttu-id="9423d-174">Avvio rapido</span><span class="sxs-lookup"><span data-stu-id="9423d-174">Quick start</span></span>](service-fabric-reliable-services-quick-start.md)

[<span data-ttu-id="9423d-175">Introduzione alle Reliable Collections</span><span class="sxs-lookup"><span data-stu-id="9423d-175">Reliable collections overview</span></span>](service-fabric-reliable-services-reliable-collections.md)

[<span data-ttu-id="9423d-176">Uso avanzato del modello di programmazione Reliable Services</span><span class="sxs-lookup"><span data-stu-id="9423d-176">Reliable service advanced usage</span></span>](service-fabric-reliable-services-advanced-usage.md)

[<span data-ttu-id="9423d-177">Configurazione di Reliable Services con stato</span><span class="sxs-lookup"><span data-stu-id="9423d-177">Reliable service configuration</span></span>](service-fabric-reliable-services-configuration.md)  

