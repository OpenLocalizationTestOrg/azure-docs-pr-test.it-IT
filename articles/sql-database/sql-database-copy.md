---
title: aaaCopy un database SQL di Azure | Documenti Microsoft
description: Creare una copia di un database SQL di Azure
services: sql-database
documentationcenter: 
author: CarlRabeler
manager: jhubbard
editor: 
ms.assetid: 5aaf6bcd-3839-49b5-8c77-cbdf786e359b
ms.service: sql-database
ms.custom: load & move data
ms.devlang: NA
ms.date: 06/15/2017
ms.author: carlrab
ms.workload: data-management
ms.topic: article
ms.tgt_pltfrm: NA
ms.openlocfilehash: 64a297d819d6da89600fda60abe8394ae405abfe
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/06/2017
---
# <a name="copy-an-azure-sql-database"></a><span data-ttu-id="156c5-103">Copiare un database SQL di Azure</span><span class="sxs-lookup"><span data-stu-id="156c5-103">Copy an Azure SQL database</span></span>

<span data-ttu-id="156c5-104">Database SQL di Azure fornisce diversi metodi per la creazione di una copia coerente delle transazioni SQL Azure esistenti del database su entrambi hello stesso server o un altro server.</span><span class="sxs-lookup"><span data-stu-id="156c5-104">Azure SQL Database provides several methods for creating a transactionally consistent copy of an existing Azure SQL database on either hello same server or a different server.</span></span> <span data-ttu-id="156c5-105">È possibile copiare un database SQL tramite T-SQL, PowerShell o hello portale di Azure.</span><span class="sxs-lookup"><span data-stu-id="156c5-105">You can copy a SQL database by using hello Azure portal, PowerShell, or T-SQL.</span></span> 

## <a name="overview"></a><span data-ttu-id="156c5-106">Panoramica</span><span class="sxs-lookup"><span data-stu-id="156c5-106">Overview</span></span>

<span data-ttu-id="156c5-107">Una copia del database è uno snapshot del database di origine hello ora hello della richiesta di copia hello.</span><span class="sxs-lookup"><span data-stu-id="156c5-107">A database copy is a snapshot of hello source database as of hello time of hello copy request.</span></span> <span data-ttu-id="156c5-108">È possibile selezionare hello nello stesso server o un altro server, il relativo livello di prestazioni e di servizio o un livello di prestazioni diverse all'interno di hello stesso livello di servizio (edizione).</span><span class="sxs-lookup"><span data-stu-id="156c5-108">You can select hello same server or a different server, its service tier and performance level, or a different performance level within hello same service tier (edition).</span></span> <span data-ttu-id="156c5-109">Una volta completata la copia hello, diventa un database indipendente, completamente funzionante.</span><span class="sxs-lookup"><span data-stu-id="156c5-109">After hello copy is complete, it becomes a fully functional, independent database.</span></span> <span data-ttu-id="156c5-110">A questo punto, è possibile aggiornare o effettuare il downgrade tooany edition.</span><span class="sxs-lookup"><span data-stu-id="156c5-110">At this point, you can upgrade or downgrade it tooany edition.</span></span> <span data-ttu-id="156c5-111">autorizzazioni, utenti e account di accesso hello possono essere gestite in modo indipendente.</span><span class="sxs-lookup"><span data-stu-id="156c5-111">hello logins, users, and permissions can be managed independently.</span></span>  

## <a name="logins-in-hello-database-copy"></a><span data-ttu-id="156c5-112">Account di accesso in una copia del database hello</span><span class="sxs-lookup"><span data-stu-id="156c5-112">Logins in hello database copy</span></span>

<span data-ttu-id="156c5-113">Quando si copia un toohello database nello stesso server logico, hello stessi account di accesso può essere usato in entrambi i database.</span><span class="sxs-lookup"><span data-stu-id="156c5-113">When you copy a database toohello same logical server, hello same logins can be used on both databases.</span></span> <span data-ttu-id="156c5-114">Hello entità di sicurezza utilizzata database hello toocopy diventa proprietario del database nel nuovo database hello hello.</span><span class="sxs-lookup"><span data-stu-id="156c5-114">hello security principal you use toocopy hello database becomes hello database owner on hello new database.</span></span> <span data-ttu-id="156c5-115">Tutti gli utenti di database, le relative autorizzazioni e la sicurezza (SID) di identificatori sono copiati toohello copia del database.</span><span class="sxs-lookup"><span data-stu-id="156c5-115">All database users, their permissions, and their security identifiers (SIDs) are copied toohello database copy.</span></span>  

<span data-ttu-id="156c5-116">Quando si copia un database tooa altro server logico, sicurezza hello principale nel nuovo server hello diventa proprietario del database nel nuovo database hello hello.</span><span class="sxs-lookup"><span data-stu-id="156c5-116">When you copy a database tooa different logical server, hello security principal on hello new server becomes hello database owner on hello new database.</span></span> <span data-ttu-id="156c5-117">Se si utilizza [utenti del database indipendente](sql-database-manage-logins.md) per accedere ai dati, assicurarsi che entrambi hello primario e i database secondari sono sempre hello stesse credenziali utente, in modo che dopo aver hello copia completata immediatamente accessibili con hello stesso credenziali.</span><span class="sxs-lookup"><span data-stu-id="156c5-117">If you use [contained database users](sql-database-manage-logins.md) for data access, ensure that both hello primary and secondary databases always have hello same user credentials, so that after hello copy is complete you can immediately access it with hello same credentials.</span></span> 

<span data-ttu-id="156c5-118">Se si utilizza [Azure Active Directory](../active-directory/active-directory-whatis.md), è possibile eliminare completamente hello necessario per la gestione delle credenziali nella copia hello.</span><span class="sxs-lookup"><span data-stu-id="156c5-118">If you use [Azure Active Directory](../active-directory/active-directory-whatis.md), you can completely eliminate hello need for managing credentials in hello copy.</span></span> <span data-ttu-id="156c5-119">Tuttavia, quando si copia nuovo server di hello database tooa, accesso basato su account di accesso hello potrebbe non funzionare, poiché gli account di accesso di hello non sono presenti nel nuovo server hello.</span><span class="sxs-lookup"><span data-stu-id="156c5-119">However, when you copy hello database tooa new server, hello login-based access might not work, because hello logins do not exist on hello new server.</span></span> <span data-ttu-id="156c5-120">toolearn sulla gestione degli account di accesso quando si copia un database tooa server logico diverso, vedere [come sicurezza toomanage SQL Azure database dopo il ripristino di emergenza](sql-database-geo-replication-security-config.md).</span><span class="sxs-lookup"><span data-stu-id="156c5-120">toolearn about managing logins when you copy a database tooa different logical server, see [How toomanage Azure SQL database security after disaster recovery](sql-database-geo-replication-security-config.md).</span></span> 

<span data-ttu-id="156c5-121">Dopo il completamento della copia hello e prima di altri utenti vengono mappate nuovamente, hello account di accesso che ha avviato la copia, hello proprietario del database hello, può effettuare l'accesso solo toohello nuovo database.</span><span class="sxs-lookup"><span data-stu-id="156c5-121">After hello copying succeeds and before other users are remapped, only hello login that initiated hello copying, hello database owner, can log in toohello new database.</span></span> <span data-ttu-id="156c5-122">vedere tooresolve gli account di accesso al termine dell'operazione di copia hello [risolvere gli account di accesso](#resolve-logins).</span><span class="sxs-lookup"><span data-stu-id="156c5-122">tooresolve logins after hello copying operation is complete, see [Resolve logins](#resolve-logins).</span></span>

## <a name="copy-a-database-by-using-hello-azure-portal"></a><span data-ttu-id="156c5-123">Copiare un database utilizzando hello portale di Azure</span><span class="sxs-lookup"><span data-stu-id="156c5-123">Copy a database by using hello Azure portal</span></span>

<span data-ttu-id="156c5-124">toocopy hello Azure pagina del portale, hello open per il database e quindi fare clic su un database utilizzando **copia**.</span><span class="sxs-lookup"><span data-stu-id="156c5-124">toocopy a database by using hello Azure portal, open hello page for your database, and then click **Copy**.</span></span> 

   ![Copia del database](./media/sql-database-copy/database-copy.png)

## <a name="copy-a-database-by-using-powershell"></a><span data-ttu-id="156c5-126">Copiare un database tramite PowerShell</span><span class="sxs-lookup"><span data-stu-id="156c5-126">Copy a database by using PowerShell</span></span>

<span data-ttu-id="156c5-127">un database tramite PowerShell, usare hello toocopy [New AzureRmSqlDatabaseCopy](/powershell/module/azurerm.sql/new-azurermsqldatabasecopy) cmdlet.</span><span class="sxs-lookup"><span data-stu-id="156c5-127">toocopy a database by using PowerShell, use hello [New-AzureRmSqlDatabaseCopy](/powershell/module/azurerm.sql/new-azurermsqldatabasecopy) cmdlet.</span></span> 

```PowerShell
New-AzureRmSqlDatabaseCopy -ResourceGroupName "myResourceGroup" `
    -ServerName $sourceserver `
    -DatabaseName "MySampleDatabase" `
    -CopyResourceGroupName "myResourceGroup" `
    -CopyServerName $targetserver `
    -CopyDatabaseName "CopyOfMySampleDatabase"
```

<span data-ttu-id="156c5-128">Per un esempio completo, vedere [copiare un server di database tooa nuova](scripts/sql-database-copy-database-to-new-server-powershell.md).</span><span class="sxs-lookup"><span data-stu-id="156c5-128">For a complete sample script, see [Copy a database tooa new server](scripts/sql-database-copy-database-to-new-server-powershell.md).</span></span>

## <a name="copy-a-database-by-using-transact-sql"></a><span data-ttu-id="156c5-129">Copiare un database tramite Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="156c5-129">Copy a database by using Transact-SQL</span></span>

<span data-ttu-id="156c5-130">Database di log nel database master toohello con account di accesso dell'entità a livello di server hello o hello creati database hello da toocopy.</span><span class="sxs-lookup"><span data-stu-id="156c5-130">Log in toohello master database with hello server-level principal login or hello login that created hello database you want toocopy.</span></span> <span data-ttu-id="156c5-131">Per toosucceed di copia del database, gli account di accesso che non sono entità di livello server hello devono essere membri del ruolo dbmanager hello.</span><span class="sxs-lookup"><span data-stu-id="156c5-131">For database copying toosucceed, logins that are not hello server-level principal must be members of hello dbmanager role.</span></span> <span data-ttu-id="156c5-132">Per ulteriori informazioni sull'account di accesso e il server toohello connessione, vedere [gestire gli account di accesso](sql-database-manage-logins.md).</span><span class="sxs-lookup"><span data-stu-id="156c5-132">For more information about logins and connecting toohello server, see [Manage logins](sql-database-manage-logins.md).</span></span>

<span data-ttu-id="156c5-133">Avviare la copia di database di origine hello con hello [CREATE DATABASE](https://msdn.microsoft.com/library/ms176061.aspx) istruzione.</span><span class="sxs-lookup"><span data-stu-id="156c5-133">Start copying hello source database with hello [CREATE DATABASE](https://msdn.microsoft.com/library/ms176061.aspx) statement.</span></span> <span data-ttu-id="156c5-134">L'esecuzione di questa istruzione Avvia processo di copia del database hello.</span><span class="sxs-lookup"><span data-stu-id="156c5-134">Executing this statement initiates hello database copying process.</span></span> <span data-ttu-id="156c5-135">Poiché la copia di un database è un processo asincrono, hello istruzione CREATE DATABASE restituisce prima hello copia del database è stata completata.</span><span class="sxs-lookup"><span data-stu-id="156c5-135">Because copying a database is an asynchronous process, hello CREATE DATABASE statement returns before hello database copying is complete.</span></span>

### <a name="copy-a-sql-database-toohello-same-server"></a><span data-ttu-id="156c5-136">Copiare un toohello di database SQL nello stesso server</span><span class="sxs-lookup"><span data-stu-id="156c5-136">Copy a SQL database toohello same server</span></span>
<span data-ttu-id="156c5-137">Database di log nel database master toohello con account di accesso dell'entità a livello di server hello o hello creati database hello da toocopy.</span><span class="sxs-lookup"><span data-stu-id="156c5-137">Log in toohello master database with hello server-level principal login or hello login that created hello database you want toocopy.</span></span> <span data-ttu-id="156c5-138">Per toosucceed di copia del database, gli account di accesso che non sono entità di livello server hello devono essere membri del ruolo dbmanager hello.</span><span class="sxs-lookup"><span data-stu-id="156c5-138">For database copying toosucceed, logins that are not hello server-level principal must be members of hello dbmanager role.</span></span>

<span data-ttu-id="156c5-139">Questo comando copia Database1 tooa nuovo database denominato Database2 su hello nello stesso server.</span><span class="sxs-lookup"><span data-stu-id="156c5-139">This command copies Database1 tooa new database named Database2 on hello same server.</span></span> <span data-ttu-id="156c5-140">A seconda delle dimensioni di hello del database, hello operazione di copia potrebbe richiedere alcuni toocomplete ora.</span><span class="sxs-lookup"><span data-stu-id="156c5-140">Depending on hello size of your database, hello copying operation might take some time toocomplete.</span></span>

    -- Execute on hello master database.
    -- Start copying.
    CREATE DATABASE Database1_copy AS COPY OF Database1;

### <a name="copy-a-sql-database-tooa-different-server"></a><span data-ttu-id="156c5-141">Copiare un altro server tooa database SQL</span><span class="sxs-lookup"><span data-stu-id="156c5-141">Copy a SQL database tooa different server</span></span>

<span data-ttu-id="156c5-142">Database di log nel database master toohello del server di destinazione hello, hello database server SQL in cui il nuovo database di hello toobe creato.</span><span class="sxs-lookup"><span data-stu-id="156c5-142">Log in toohello master database of hello destination server, hello SQL database server where hello new database is toobe created.</span></span> <span data-ttu-id="156c5-143">Utilizzare un account di accesso come proprietario del database hello hello del database di origine nel server di database SQL di origine hello è hello stesso nome e password.</span><span class="sxs-lookup"><span data-stu-id="156c5-143">Use a login that has hello same name and password as hello database owner of hello source database on hello source SQL database server.</span></span> <span data-ttu-id="156c5-144">account di accesso di Hello nel server di destinazione hello deve anche essere un membro del ruolo dbmanager hello o essere l'account di accesso hello a livello di server principale.</span><span class="sxs-lookup"><span data-stu-id="156c5-144">hello login on hello destination server must also be a member of hello dbmanager role or be hello server-level principal login.</span></span>

<span data-ttu-id="156c5-145">Questo comando copia Database1 nel nuovo database denominato Database2 su server2 tooa server1.</span><span class="sxs-lookup"><span data-stu-id="156c5-145">This command copies Database1 on server1 tooa new database named Database2 on server2.</span></span> <span data-ttu-id="156c5-146">A seconda delle dimensioni di hello del database, hello operazione di copia potrebbe richiedere alcuni toocomplete ora.</span><span class="sxs-lookup"><span data-stu-id="156c5-146">Depending on hello size of your database, hello copying operation might take some time toocomplete.</span></span>

    -- Execute on hello master database of hello target server (server2)
    -- Start copying from Server1 tooServer2
    CREATE DATABASE Database1_copy AS COPY OF server1.Database1;


### <a name="monitor-hello-progress-of-hello-copying-operation"></a><span data-ttu-id="156c5-147">Monitorare lo stato di avanzamento hello di hello operazione di copia</span><span class="sxs-lookup"><span data-stu-id="156c5-147">Monitor hello progress of hello copying operation</span></span>

<span data-ttu-id="156c5-148">Monitoraggio processo di copia hello eseguendo una query su visualizzazioni di Sys. Databases e Sys.dm database_copies hello.</span><span class="sxs-lookup"><span data-stu-id="156c5-148">Monitor hello copying process by querying hello sys.databases and sys.dm_database_copies views.</span></span> <span data-ttu-id="156c5-149">Durante la copia di hello è in corso, hello **state_desc** colonna della vista sys. Databases hello per il nuovo database hello è troppo**COPYING**.</span><span class="sxs-lookup"><span data-stu-id="156c5-149">While hello copying is in progress, hello **state_desc** column of hello sys.databases view for hello new database is set too**COPYING**.</span></span>

* <span data-ttu-id="156c5-150">Se la copia di hello non riesce, hello **state_desc** colonna della vista sys. Databases hello per il nuovo database hello è troppo**ritiene**.</span><span class="sxs-lookup"><span data-stu-id="156c5-150">If hello copying fails, hello **state_desc** column of hello sys.databases view for hello new database is set too**SUSPECT**.</span></span> <span data-ttu-id="156c5-151">Eseguire hello istruzione DROP sul nuovo database hello e riprovare più tardi.</span><span class="sxs-lookup"><span data-stu-id="156c5-151">Execute hello DROP statement on hello new database, and try again later.</span></span>
* <span data-ttu-id="156c5-152">Se la copia di hello ha esito positivo, hello **state_desc** colonna della vista sys. Databases hello per il nuovo database hello è troppo**ONLINE**.</span><span class="sxs-lookup"><span data-stu-id="156c5-152">If hello copying succeeds, hello **state_desc** column of hello sys.databases view for hello new database is set too**ONLINE**.</span></span> <span data-ttu-id="156c5-153">Hello copia è completa e hello nuovo database è un database normale che può essere modificato indipendentemente dalla hello database di origine.</span><span class="sxs-lookup"><span data-stu-id="156c5-153">hello copying is complete, and hello new database is a regular database that can be changed independent of hello source database.</span></span>

> [!NOTE]
> <span data-ttu-id="156c5-154">Se si decide di toocancel hello copia mentre è in corso, eseguire hello [DROP DATABASE](https://msdn.microsoft.com/library/ms178613.aspx) istruzione sul nuovo database hello.</span><span class="sxs-lookup"><span data-stu-id="156c5-154">If you decide toocancel hello copying while it is in progress, execute hello [DROP DATABASE](https://msdn.microsoft.com/library/ms178613.aspx) statement on hello new database.</span></span> <span data-ttu-id="156c5-155">In alternativa, l'istruzione DROP DATABASE hello nel database di origine hello anche Annulla hello processo di copia.</span><span class="sxs-lookup"><span data-stu-id="156c5-155">Alternatively, executing hello DROP DATABASE statement on hello source database also cancels hello copying process.</span></span>
> 

## <a name="resolve-logins"></a><span data-ttu-id="156c5-156">Risolvere gli account di accesso</span><span class="sxs-lookup"><span data-stu-id="156c5-156">Resolve logins</span></span>

<span data-ttu-id="156c5-157">Dopo aver hello nuovo database è online nel server di destinazione hello, utilizzare hello [ALTER USER](https://msdn.microsoft.com/library/ms176060.aspx) istruzione tooremap hello utenti hello toologins nel server di destinazione hello di nuovo database.</span><span class="sxs-lookup"><span data-stu-id="156c5-157">After hello new database is online on hello destination server, use hello [ALTER USER](https://msdn.microsoft.com/library/ms176060.aspx) statement tooremap hello users from hello new database toologins on hello destination server.</span></span> <span data-ttu-id="156c5-158">gli utenti isolati (orfani) tooresolve, vedere [risolvere i problemi relativi agli utenti isolati](https://msdn.microsoft.com/library/ms175475.aspx).</span><span class="sxs-lookup"><span data-stu-id="156c5-158">tooresolve orphaned users, see [Troubleshoot Orphaned Users](https://msdn.microsoft.com/library/ms175475.aspx).</span></span> <span data-ttu-id="156c5-159">Vedere anche [come sicurezza toomanage SQL Azure database dopo il ripristino di emergenza](sql-database-geo-replication-security-config.md).</span><span class="sxs-lookup"><span data-stu-id="156c5-159">See also [How toomanage Azure SQL database security after disaster recovery](sql-database-geo-replication-security-config.md).</span></span>

<span data-ttu-id="156c5-160">Tutti gli utenti nel nuovo database hello mantengano le autorizzazioni di hello cui disponevano nel database di origine hello.</span><span class="sxs-lookup"><span data-stu-id="156c5-160">All users in hello new database retain hello permissions that they had in hello source database.</span></span> <span data-ttu-id="156c5-161">utente Hello che ha avviato una copia del database hello diventa proprietario del database hello del nuovo database hello e viene assegnato un nuovo ID di sicurezza (SID).</span><span class="sxs-lookup"><span data-stu-id="156c5-161">hello user who initiated hello database copy becomes hello database owner of hello new database and is assigned a new security identifier (SID).</span></span> <span data-ttu-id="156c5-162">Dopo il completamento della copia hello e prima di altri utenti vengono mappate nuovamente, hello account di accesso che ha avviato la copia, hello proprietario del database hello, può effettuare l'accesso solo toohello nuovo database.</span><span class="sxs-lookup"><span data-stu-id="156c5-162">After hello copying succeeds and before other users are remapped, only hello login that initiated hello copying, hello database owner, can log in toohello new database.</span></span>

<span data-ttu-id="156c5-163">toolearn sulla gestione di utenti e account di accesso quando si copia un database tooa server logico diverso, vedere [come sicurezza toomanage SQL Azure database dopo il ripristino di emergenza](sql-database-geo-replication-security-config.md).</span><span class="sxs-lookup"><span data-stu-id="156c5-163">toolearn about managing users and logins when you copy a database tooa different logical server, see [How toomanage Azure SQL database security after disaster recovery](sql-database-geo-replication-security-config.md).</span></span>

## <a name="next-steps"></a><span data-ttu-id="156c5-164">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="156c5-164">Next steps</span></span>

* <span data-ttu-id="156c5-165">Per informazioni sugli account di accesso, vedere [gestire gli account di accesso](sql-database-manage-logins.md) e [come sicurezza toomanage SQL Azure database dopo il ripristino di emergenza](sql-database-geo-replication-security-config.md).</span><span class="sxs-lookup"><span data-stu-id="156c5-165">For information about logins, see [Manage logins](sql-database-manage-logins.md) and [How toomanage Azure SQL database security after disaster recovery](sql-database-geo-replication-security-config.md).</span></span>
* <span data-ttu-id="156c5-166">tooexport un database, vedere [esportare hello database tooa BACPAC](sql-database-export.md).</span><span class="sxs-lookup"><span data-stu-id="156c5-166">tooexport a database, see [Export hello database tooa BACPAC](sql-database-export.md).</span></span>
