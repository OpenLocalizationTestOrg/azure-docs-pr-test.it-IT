---
title: Ricerche log in OMS Log Analytics| Microsoft Docs
description: "Una ricerca log è necessaria per recuperare qualsiasi tipo di dati da Log Analytics.  Questo articolo descrive come vengono usate le nuove ricerche log in Log Analytics e illustra i concetti con cui occorre avere familiarità prima di crearne una."
services: log-analytics
documentationcenter: 
author: bwren
manager: carmonm
editor: 
ms.service: log-analytics
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/25/2017
ms.author: bwren
ms.openlocfilehash: 0f27db7018e398f71a8d7bd0b86e643367b15875
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/29/2017
---
# <a name="understanding-log-searches-in-log-analytics"></a><span data-ttu-id="bb0c1-104">Informazioni sulle ricerche log in Log Analytics</span><span class="sxs-lookup"><span data-stu-id="bb0c1-104">Understanding log searches in Log Analytics</span></span>

> [!NOTE]
> <span data-ttu-id="bb0c1-105">Questo articolo descrive le ricerche log in Azure Log Analytics tramite il nuovo linguaggio di query.</span><span class="sxs-lookup"><span data-stu-id="bb0c1-105">This article describes log searches in Azure Log Analytics using the new query language.</span></span>  <span data-ttu-id="bb0c1-106">In [Aggiornare l'area di lavoro di Azure Log Analytics alla nuova ricerca log](log-analytics-log-search-upgrade.md) sono disponibili altre informazioni sul nuovo linguaggio e istruzioni per l'aggiornamento dell'area di lavoro.</span><span class="sxs-lookup"><span data-stu-id="bb0c1-106">You can learn more about the new language and get the procedure to upgrade your workspace at [Upgrade your Azure Log Analytics workspace to new log search](log-analytics-log-search-upgrade.md).</span></span>  
>
> <span data-ttu-id="bb0c1-107">Se l'area di lavoro non è stata aggiornata al nuovo linguaggio di query, è consigliabile consultare [Trovare dati tramite ricerche nei log in Log Analytics](log-analytics-log-searches.md).</span><span class="sxs-lookup"><span data-stu-id="bb0c1-107">If your workspace hasn't been upgraded to the new query language, you should refer to [Find data using log searches in Log Analytics](log-analytics-log-searches.md).</span></span>

<span data-ttu-id="bb0c1-108">Una ricerca log è necessaria per recuperare qualsiasi tipo di dati da Log Analytics.</span><span class="sxs-lookup"><span data-stu-id="bb0c1-108">You require a log search to retrieve any data from Log Analytics.</span></span>  <span data-ttu-id="bb0c1-109">Indipendentemente dal fatto che l'esigenza sia quella di analizzare i dati nel portale, configurare una regola di avviso per ricevere una notifica di una determinata condizione o di recuperare dati tramite l'API di Log Analytics, per specificare i dati necessari si userà una ricerca log.</span><span class="sxs-lookup"><span data-stu-id="bb0c1-109">Whether you're analyzing data in the portal, configuring an alert rule to be notified of a particular condition, or retrieving data using the Log Analytics API, you will use a log search to specify the data you want.</span></span>  <span data-ttu-id="bb0c1-110">Questo articolo descrive come vengono usate le ricerche log in Log Analytics e illustra i concetti con cui occorre avere familiarità prima di crearne una.</span><span class="sxs-lookup"><span data-stu-id="bb0c1-110">This article describes how log searches are used in Log Analytics and provides concepts that should understand before creating one.</span></span> <span data-ttu-id="bb0c1-111">Vedere la sezione [Passaggi successivi](#next-steps) per informazioni dettagliate sulla creazione e la modifica delle ricerche log e per informazioni di riferimento sul linguaggio di query.</span><span class="sxs-lookup"><span data-stu-id="bb0c1-111">See the [Next steps](#next-steps) section for details on creating and editing log searches and for references on the query language.</span></span>

## <a name="where-log-searches-are-used"></a><span data-ttu-id="bb0c1-112">Possibili usi delle ricerche log</span><span class="sxs-lookup"><span data-stu-id="bb0c1-112">Where log searches are used</span></span>

<span data-ttu-id="bb0c1-113">Di seguito sono indicati alcuni dei vari modi in cui verranno usate le ricerche log in Log Analytics:</span><span class="sxs-lookup"><span data-stu-id="bb0c1-113">The different ways that you will use log searches in Log Analytics include the following:</span></span>

- <span data-ttu-id="bb0c1-114">**Portali.**</span><span class="sxs-lookup"><span data-stu-id="bb0c1-114">**Portals.**</span></span> <span data-ttu-id="bb0c1-115">È possibile eseguire un'analisi interattiva dei dati nel repository con il [portale per la ricerca log](log-analytics-log-search-log-search-portal.md) o il [portale Advanced Analytics](https://go.microsoft.com/fwlink/?linkid=856587).</span><span class="sxs-lookup"><span data-stu-id="bb0c1-115">You can perform interactive analysis of data in the repository with the [Log Search portal](log-analytics-log-search-log-search-portal.md) or the [Advanced Analytics portal](https://go.microsoft.com/fwlink/?linkid=856587).</span></span>  <span data-ttu-id="bb0c1-116">In questo modo è possibile modificare le query e analizzare i risultati in una vasta gamma di formati e visualizzazioni.</span><span class="sxs-lookup"><span data-stu-id="bb0c1-116">This allows you to edit your query and analyze the results in a variety of formats and visualizations.</span></span>  <span data-ttu-id="bb0c1-117">Per la maggior parte delle query create si inizia in uno dei portali, per poi copiarle dopo aver verificato che il funzionamento corrisponde alle esigenze.</span><span class="sxs-lookup"><span data-stu-id="bb0c1-117">Most queries that you create will start in one of the portals and then copied once you verify that it works as expected.</span></span>
- <span data-ttu-id="bb0c1-118">**Regole di avviso.**</span><span class="sxs-lookup"><span data-stu-id="bb0c1-118">**Alert rules.**</span></span> <span data-ttu-id="bb0c1-119">Le [regole di avviso](log-analytics-alerts.md) consentono di identificare in modo proattivo i problemi dai dati nell'area di lavoro.</span><span class="sxs-lookup"><span data-stu-id="bb0c1-119">[Alert rules](log-analytics-alerts.md) proactively identify issues from data in your workspace.</span></span>  <span data-ttu-id="bb0c1-120">Ogni regola di avviso è basata su una ricerca log che viene eseguita automaticamente a intervalli regolari.</span><span class="sxs-lookup"><span data-stu-id="bb0c1-120">Each alert rule is based on a log search that is automatically run at regular intervals.</span></span>  <span data-ttu-id="bb0c1-121">I risultati vengono esaminati per determinare se è necessario creare un avviso.</span><span class="sxs-lookup"><span data-stu-id="bb0c1-121">The results are inspected to determine if an alert should be created.</span></span>
- <span data-ttu-id="bb0c1-122">**Visualizzazioni.**</span><span class="sxs-lookup"><span data-stu-id="bb0c1-122">**Views.**</span></span>  <span data-ttu-id="bb0c1-123">È possibile creare visualizzazioni dei dati da includere nei dashboard degli utenti con [Progettazione viste](log-analytics-view-designer.md).</span><span class="sxs-lookup"><span data-stu-id="bb0c1-123">You can create visualizations of data to be included in user dashboards with [View Designer](log-analytics-view-designer.md).</span></span>  <span data-ttu-id="bb0c1-124">Le ricerche log forniscono i dati usati dai [riquadri](log-analytics-view-designer-tiles.md) e dalle [parti della visualizzazione](log-analytics-view-designer-parts.md) in ogni visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="bb0c1-124">Log searches provide the data used by [tiles](log-analytics-view-designer-tiles.md) and [visualization parts](log-analytics-view-designer-parts.md) in each view.</span></span>  <span data-ttu-id="bb0c1-125">È possibile eseguire il drill-down dalle parti della visualizzazione nel portale per la ricerca log per eseguire ulteriori analisi dei dati.</span><span class="sxs-lookup"><span data-stu-id="bb0c1-125">You can drill down from visualization parts into the Log Search portal to perform further analysis on the data.</span></span>
- <span data-ttu-id="bb0c1-126">**Esportazione.**</span><span class="sxs-lookup"><span data-stu-id="bb0c1-126">**Export.**</span></span>  <span data-ttu-id="bb0c1-127">Quando si esportano dati dall'area di lavoro di Log Analytics in Excel o [Power BI](log-analytics-powerbi.md), si crea una ricerca log per definire i dati da esportare.</span><span class="sxs-lookup"><span data-stu-id="bb0c1-127">When you export data from the Log Analytics workspace to Excel or [Power BI](log-analytics-powerbi.md), you create a log search to define the data to export.</span></span>
- <span data-ttu-id="bb0c1-128">**PowerShell.**</span><span class="sxs-lookup"><span data-stu-id="bb0c1-128">**PowerShell.**</span></span> <span data-ttu-id="bb0c1-129">È possibile eseguire uno script di PowerShell da una riga di comando o un runbook di Automazione di Azure che usa [Get AzureRmOperationalInsightsSearchResults](https://docs.microsoft.com/powershell/module/azurerm.operationalinsights/get-azurermoperationalinsightssearchresults?view=azurermps-4.0.0) per recuperare dati da Log Analytics.</span><span class="sxs-lookup"><span data-stu-id="bb0c1-129">You can run a PowerShell script from a command line or an Azure Automation runbook that uses [Get-AzureRmOperationalInsightsSearchResults](https://docs.microsoft.com/powershell/module/azurerm.operationalinsights/get-azurermoperationalinsightssearchresults?view=azurermps-4.0.0) to retrieve data from Log Analytics.</span></span>  <span data-ttu-id="bb0c1-130">Questo cmdlet richiede una query per determinare i dati da recuperare.</span><span class="sxs-lookup"><span data-stu-id="bb0c1-130">This cmdlet requires a query to determine the data to retrieve.</span></span>
- <span data-ttu-id="bb0c1-131">**API di Log Analytics.**</span><span class="sxs-lookup"><span data-stu-id="bb0c1-131">**Log Analytics API.**</span></span>  <span data-ttu-id="bb0c1-132">L'[API di ricerca log di Log Analytics](log-analytics-log-search-api.md) consente a qualsiasi client API REST di recuperare dati da un'area di lavoro.</span><span class="sxs-lookup"><span data-stu-id="bb0c1-132">The [Log Analytics log search API](log-analytics-log-search-api.md) allows any REST API client to retrieve data from the workspace.</span></span>  <span data-ttu-id="bb0c1-133">La richiesta dell'API include una query eseguita su Log Analytics per determinare i dati da recuperare.</span><span class="sxs-lookup"><span data-stu-id="bb0c1-133">The API request includes a query that is run against Log Analytics to determine the data to retrieve.</span></span>

![Ricerche log](media/log-analytics-log-search-new/log-search-overview.png)

## <a name="how-log-analytics-data-is-organized"></a><span data-ttu-id="bb0c1-135">Organizzazione dei dati di Log Analytics</span><span class="sxs-lookup"><span data-stu-id="bb0c1-135">How Log Analytics data is organized</span></span>
<span data-ttu-id="bb0c1-136">Quando si compila una query, è necessario innanzitutto determinare quali tabelle contengono i dati da cercare.</span><span class="sxs-lookup"><span data-stu-id="bb0c1-136">When you build a query, you start by determining which tables have the data that you're looking for.</span></span> <span data-ttu-id="bb0c1-137">Ogni [origine dati](log-analytics-data-sources.md) e [soluzione](../operations-management-suite/operations-management-suite-solutions.md) archivia i dati in tabelle dedicate nell'area di lavoro di Log Analytics.</span><span class="sxs-lookup"><span data-stu-id="bb0c1-137">Each [data source](log-analytics-data-sources.md) and [solution](../operations-management-suite/operations-management-suite-solutions.md) stores its data in dedicated tables in the Log Analytics workspace.</span></span>  <span data-ttu-id="bb0c1-138">La documentazione per ogni origine dati e soluzione include il nome del tipo di dati che crea e una descrizione di ciascuna delle relative proprietà.</span><span class="sxs-lookup"><span data-stu-id="bb0c1-138">Documentation for each data source and solution includes the name of the data type that it creates and a description of each of its properties.</span></span>     <span data-ttu-id="bb0c1-139">Molte query richiedono solo dati da singole tabelle, ma altre possono usare un'ampia gamma di opzioni per includere dati da più tabelle.</span><span class="sxs-lookup"><span data-stu-id="bb0c1-139">Many queries will only require data from a single tables, but others may use a variety of options to include data from multiple tables.</span></span>

![Tabelle](media/log-analytics-log-search-new/queries-tables.png)


## <a name="writing-a-query"></a><span data-ttu-id="bb0c1-141">Scrittura di una query</span><span class="sxs-lookup"><span data-stu-id="bb0c1-141">Writing a query</span></span>
<span data-ttu-id="bb0c1-142">Alla base delle ricerche log in Log Analytics vi è [un linguaggio di query completo](https://docs.loganalytics.io/) che consente di recuperare e analizzare i dati dal repository in diversi modi.</span><span class="sxs-lookup"><span data-stu-id="bb0c1-142">At the core of log searches in Log Analytics is [an extensive query language](https://docs.loganalytics.io/) that lets you retrieve and analyze data from the repository in a variety of ways.</span></span>  <span data-ttu-id="bb0c1-143">Si tratta dello stesso linguaggio di query usato per [Application Insights](../application-insights/app-insights-analytics.md).</span><span class="sxs-lookup"><span data-stu-id="bb0c1-143">This same query language is used for [Application Insights](../application-insights/app-insights-analytics.md).</span></span>  <span data-ttu-id="bb0c1-144">Imparare a scrivere una query è fondamentale per la creazione di ricerche log in Log Analytics.</span><span class="sxs-lookup"><span data-stu-id="bb0c1-144">Learning how to write a query is critical to creating log searches in Log Analytics.</span></span>  <span data-ttu-id="bb0c1-145">Si inizia in genere con query semplici per poi usare funzioni più avanzate, man mano che i requisiti diventano più complessi.</span><span class="sxs-lookup"><span data-stu-id="bb0c1-145">You'll typically start with basic queries and then progress to use more advanced functions as your requirements become more complex.</span></span>

<span data-ttu-id="bb0c1-146">La struttura di base di una query è costituita da una tabella di origine seguita da una serie di operatori separati dal carattere barra verticale `|`.</span><span class="sxs-lookup"><span data-stu-id="bb0c1-146">The basic structure of a query is a source table followed by a series of operators separated by a pipe character `|`.</span></span>  <span data-ttu-id="bb0c1-147">È possibile concatenare più operatori per eseguire operazioni di recupero dei dati e funzioni più elaborate e avanzate.</span><span class="sxs-lookup"><span data-stu-id="bb0c1-147">You can chain together multiple operators to refine the data and perform advanced functions.</span></span>

<span data-ttu-id="bb0c1-148">Ad esempio, si supponga di voler trovare i primi dieci computer nei quali si è verificata la maggior parte degli eventi di errore il giorno precedente.</span><span class="sxs-lookup"><span data-stu-id="bb0c1-148">For example, suppose you wanted to find the top ten computers with the most error events over the past day.</span></span>

    Event
    | where (EventLevelName == "Error")
    | where (TimeGenerated > ago(1days))
    | summarize ErrorCount = count() by Computer
    | top 10 by ErrorCount desc

<span data-ttu-id="bb0c1-149">Oppure, potrebbe essere necessario individuare i computer senza heartbeat nelle ultime 24 ore.</span><span class="sxs-lookup"><span data-stu-id="bb0c1-149">Or maybe you want to find computers that haven't had a heartbeat in the last day.</span></span>

    Heartbeat
    | where TimeGenerated > ago(7d)
    | summarize max(TimeGenerated) by Computer
    | where max_TimeGenerated < ago(1d)  

<span data-ttu-id="bb0c1-150">Potrebbe anche essere utile un grafico a linee con l'utilizzo del processore per ogni computer nell'ultima settimana.</span><span class="sxs-lookup"><span data-stu-id="bb0c1-150">How about a line chart with the processor utilization for each computer from last week?</span></span>

    Perf
    | where ObjectName == "Processor" and CounterName == "% Processor Time"
    | where TimeGenerated  between (startofweek(ago(7d)) .. endofweek(ago(7d)) )
    | summarize avg(CounterValue) by Computer, bin(TimeGenerated, 5min)
    | render timechart    

<span data-ttu-id="bb0c1-151">Da questi semplici esempi è possibile notare che la struttura della query è simile, indipendentemente dal tipo di dati in uso.</span><span class="sxs-lookup"><span data-stu-id="bb0c1-151">You can see from these quick samples that regardless of the kind of data that you're working with, the structure of the query is similar.</span></span>  <span data-ttu-id="bb0c1-152">È possibile suddividerla in passaggi distinti, in cui i dati risultanti da un comando vengono inviati tramite la pipeline al comando successivo.</span><span class="sxs-lookup"><span data-stu-id="bb0c1-152">You can break it down into distinct steps where the resulting data from one command is sent through the pipeline to the next command.</span></span>

<span data-ttu-id="bb0c1-153">Per una documentazione completa sul linguaggio di query di Azure Log Analytics, incluse esercitazioni e informazioni di riferimento sul linguaggio, vedere la [documentazione del linguaggio di query di Azure Log Analytics](https://docs.loganalytics.io/).</span><span class="sxs-lookup"><span data-stu-id="bb0c1-153">For complete documentation on the Azure Log Analytics query language including tutorials and language reference, see the [Azure Log Analytics query language documentation](https://docs.loganalytics.io/).</span></span>

## <a name="next-steps"></a><span data-ttu-id="bb0c1-154">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="bb0c1-154">Next steps</span></span>

- <span data-ttu-id="bb0c1-155">Leggere le informazioni sui [portali usati per creare e modifiche le ricerche log](log-analytics-log-search-portals.md).</span><span class="sxs-lookup"><span data-stu-id="bb0c1-155">Learn about the [portals that you use to create and edit log searches](log-analytics-log-search-portals.md).</span></span>
- <span data-ttu-id="bb0c1-156">Vedere un'[esercitazione sulla scrittura di query](https://go.microsoft.com/fwlink/?linkid=856078) con il nuovo linguaggio di query.</span><span class="sxs-lookup"><span data-stu-id="bb0c1-156">Check out a [tutorial on writing queries](https://go.microsoft.com/fwlink/?linkid=856078) using the new query language.</span></span>
