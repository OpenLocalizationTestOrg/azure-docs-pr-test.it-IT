---
title: aaaOnline backup e ripristino con Azure Cosmos DB | Documenti Microsoft
description: Informazioni su come tooperform automatica di backup e ripristino in un database di Azure Cosmos DB.
keywords: backup e ripristino, backup online
services: cosmos-db
documentationcenter: 
author: RahulPrasad16
manager: jhubbard
editor: monicar
ms.assetid: 98eade4a-7ef4-4667-b167-6603ecd80b79
ms.service: cosmos-db
ms.workload: data-services
ms.tgt_pltfrm: na
ms.devlang: multiple
ms.topic: article
ms.date: 08/11/2017
ms.author: raprasa
ms.openlocfilehash: a0b464c95681dfc7b5462b02bf04c2c43d6bc16f
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/06/2017
---
# <a name="automatic-online-backup-and-restore-with-azure-cosmos-db"></a><span data-ttu-id="beb77-104">Backup online automatico e ripristino con Azure Cosmos DB</span><span class="sxs-lookup"><span data-stu-id="beb77-104">Automatic online backup and restore with Azure Cosmos DB</span></span>
<span data-ttu-id="beb77-105">Azure Cosmos DB esegue automaticamente il backup di tutti i dati a intervalli regolari.</span><span class="sxs-lookup"><span data-stu-id="beb77-105">Azure Cosmos DB automatically takes backups of all your data at regular intervals.</span></span> <span data-ttu-id="beb77-106">i backup automatici di Hello vengono eseguiti senza influire sulle prestazioni di hello o la disponibilità delle operazioni di database.</span><span class="sxs-lookup"><span data-stu-id="beb77-106">hello automatic backups are taken without affecting hello performance or availability of your database operations.</span></span> <span data-ttu-id="beb77-107">Tutti i backup vengono archiviati separatamente in un altro servizio di archiviazione, oltre a essere replicati a livello globale per garantire la resilienza in caso di emergenze locali.</span><span class="sxs-lookup"><span data-stu-id="beb77-107">All your backups are stored separately in another storage service, and those backups are globally replicated for resiliency against regional disasters.</span></span> <span data-ttu-id="beb77-108">i backup automatici Hello sono destinati a scenari quando si elimina accidentalmente il contenitore DB Comos e versioni successive richiede il recupero dei dati o una soluzione di ripristino di emergenza.</span><span class="sxs-lookup"><span data-stu-id="beb77-108">hello automatic backups are intended for scenarios when you accidentally delete your Comos DB container and later require data recovery or a disaster recovery solution.</span></span>  

<span data-ttu-id="beb77-109">In questo articolo inizia con un riepilogo rapido della ridondanza dei dati hello e della disponibilità in Cosmos DB e quindi vengono illustrati i backup.</span><span class="sxs-lookup"><span data-stu-id="beb77-109">This article starts with a quick recap of hello data redundancy and availability in Cosmos DB, and then discusses backups.</span></span> 

## <a name="high-availability-with-cosmos-db---a-recap"></a><span data-ttu-id="beb77-110">Disponibilità elevata con Cosmos DB: riepilogo</span><span class="sxs-lookup"><span data-stu-id="beb77-110">High availability with Cosmos DB - a recap</span></span>
<span data-ttu-id="beb77-111">COSMOS DB è progettato toobe [distribuiti in modo globale](distribute-data-globally.md) : consente di velocità effettiva tooscale tra più aree di Azure con criteri basati su failover e le API multihosting trasparente.</span><span class="sxs-lookup"><span data-stu-id="beb77-111">Cosmos DB is designed toobe [globally distributed](distribute-data-globally.md) – it allows you tooscale throughput across multiple Azure regions along with policy driven failover and transparent multi-homing APIs.</span></span> <span data-ttu-id="beb77-112">Come un'offerta di sistema di database [disponibilità del 99,99% SLA](https://azure.microsoft.com/support/legal/sla/cosmos-db), tutte le scritture hello in DB Cosmos sono dischi toolocal commit in modo permanente da un quorum di repliche all'interno di un data center locale prima del riconoscimento toohello client.</span><span class="sxs-lookup"><span data-stu-id="beb77-112">As a database system offering [99.99% availability SLAs](https://azure.microsoft.com/support/legal/sla/cosmos-db), all hello writes in Cosmos DB are durably committed toolocal disks by a quorum of replicas within a local data center before acknowledging toohello client.</span></span> <span data-ttu-id="beb77-113">Si noti che la disponibilità elevata del database Cosmos hello si basa su archiviazione locale e non dipende da qualsiasi tecnologia di archiviazione esterna.</span><span class="sxs-lookup"><span data-stu-id="beb77-113">Note that hello high availability of Cosmos DB relies on local storage and does not depend on any external storage technologies.</span></span> <span data-ttu-id="beb77-114">Inoltre, se l'account di database è associato a più di un'area di Azure, le operazioni di scrittura vengono replicate anche nelle altre aree.</span><span class="sxs-lookup"><span data-stu-id="beb77-114">Additionally, if your database account is associated with more than one Azure region, your writes are replicated across other regions as well.</span></span> <span data-ttu-id="beb77-115">tooscale la velocità effettiva e accedere ai dati a bassa latenza, è possibile includere molte leggere aree associate all'account di database nel modo desiderato.</span><span class="sxs-lookup"><span data-stu-id="beb77-115">tooscale your throughput and access data at low latencies, you can have as many read regions associated with your database account as you like.</span></span> <span data-ttu-id="beb77-116">In ogni area lettura dati hello (replicata) viene mantenuti in modo durevole tra un set di repliche.</span><span class="sxs-lookup"><span data-stu-id="beb77-116">In each read region, hello (replicated) data is durably persisted across a replica set.</span></span>  

<span data-ttu-id="beb77-117">Come illustrato nel seguente diagramma hello, è un singolo contenitore Cosmos DB [partizionati orizzontalmente](partition-data.md).</span><span class="sxs-lookup"><span data-stu-id="beb77-117">As illustrated in hello following diagram, a single Cosmos DB container is [horizontally partitioned](partition-data.md).</span></span> <span data-ttu-id="beb77-118">Una partizione"" è identificata da un cerchio nel seguente diagramma hello e ogni partizione viene reso disponibile tramite un set di repliche.</span><span class="sxs-lookup"><span data-stu-id="beb77-118">A “partition” is denoted by a circle in hello following diagram, and each partition is made highly available via a replica set.</span></span> <span data-ttu-id="beb77-119">Si tratta di distribuzione locale di hello in una singola regione di Azure (indicata dall'asse X hello).</span><span class="sxs-lookup"><span data-stu-id="beb77-119">This is hello local distribution within a single Azure region (denoted by hello X axis).</span></span> <span data-ttu-id="beb77-120">Inoltre, ogni partizione (con il relativo set di replica corrispondente) quindi viene distribuito a livello globale in più regioni associati all'account di database (ad esempio, in questa illustrazione hello tre aree: Stati Uniti orientali, Stati Uniti occidentali e India centrale).</span><span class="sxs-lookup"><span data-stu-id="beb77-120">Further, each partition (with its corresponding replica set) is then globally distributed across multiple regions associated with your database account (for example, in this illustration hello three regions – East US, West US and Central India).</span></span> <span data-ttu-id="beb77-121">"set di partizioni" Hello viene distribuita a livello globale entità è costituita da più copie dei dati in ogni area (indicato dalle asse hello Y).</span><span class="sxs-lookup"><span data-stu-id="beb77-121">hello “partition set” is a globally distributed entity comprising of multiple copies of your data in each region (denoted by hello Y axis).</span></span> <span data-ttu-id="beb77-122">È possibile assegnare priorità aree toohello associate all'account di database e Cosmos DB comporta in modo trasparente area successiva toohello di failover in caso di emergenza.</span><span class="sxs-lookup"><span data-stu-id="beb77-122">You can assign priority toohello regions associated with your database account and Cosmos DB will transparently failover toohello next region in case of disaster.</span></span> <span data-ttu-id="beb77-123">È possibile simulare manualmente failover tootest hello end-to-end disponibilità dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="beb77-123">You can also manually simulate failover tootest hello end-to-end availability of your application.</span></span>  

<span data-ttu-id="beb77-124">Hello immagine seguente illustra elevato hello di ridondanza con DB Cosmos.</span><span class="sxs-lookup"><span data-stu-id="beb77-124">hello following image illustrates hello high degree of redundancy with Cosmos DB.</span></span>

![Elevato grado di ridondanza con Cosmos DB](./media/online-backup-and-restore/redundancy.png)

![Elevato grado di ridondanza con Cosmos DB](./media/online-backup-and-restore/global-distribution.png)

## <a name="full-automatic-online-backups"></a><span data-ttu-id="beb77-127">Backup online, completi, automatici</span><span class="sxs-lookup"><span data-stu-id="beb77-127">Full, automatic, online backups</span></span>
<span data-ttu-id="beb77-128">È possibile che il contenitore o il database venga eliminato.</span><span class="sxs-lookup"><span data-stu-id="beb77-128">Oops, I deleted my container or database!</span></span> <span data-ttu-id="beb77-129">Con Cosmos DB, non solo i dati, ma i backup hello dei dati vengono eseguite anche emergenze tooregional altamente ridondante e flessibile.</span><span class="sxs-lookup"><span data-stu-id="beb77-129">With Cosmos DB, not only your data, but hello backups of your data are also made highly redundant and resilient tooregional disasters.</span></span> <span data-ttu-id="beb77-130">I backup automatici vengono attualmente eseguiti ogni quattro ore circa; ogni volta vengono archiviati i due backup più recenti.</span><span class="sxs-lookup"><span data-stu-id="beb77-130">These automated backups are currently taken approximately every four hours and latest 2 backups are stored at all times.</span></span> <span data-ttu-id="beb77-131">Se dati hello viene accidentalmente eliminato o danneggiato,. [contattare il supporto tecnico di Azure](https://azure.microsoft.com/support/options/) entro 8 ore.</span><span class="sxs-lookup"><span data-stu-id="beb77-131">If hello data is accidently dropped or corrupted, please [contact Azure support](https://azure.microsoft.com/support/options/) within 8 hours.</span></span> 

<span data-ttu-id="beb77-132">Hello backup senza influire sulle prestazioni di hello o la disponibilità delle operazioni di database.</span><span class="sxs-lookup"><span data-stu-id="beb77-132">hello backups are taken without affecting hello performance or availability of your database operations.</span></span> <span data-ttu-id="beb77-133">COSMOS DB accetta backup hello in background hello senza utilizzare i servizio aggiornamento destinatari provisioning o influire sulle prestazioni di hello e senza influire sulla disponibilità hello del database.</span><span class="sxs-lookup"><span data-stu-id="beb77-133">Cosmos DB takes hello backup in hello background without consuming your provisioned RUs or affecting hello performance and without affecting hello availability of your database.</span></span> 

<span data-ttu-id="beb77-134">A differenza dei dati archiviati in DB Cosmos, i backup automatici hello vengono archiviati nel servizio di archiviazione Blob di Azure.</span><span class="sxs-lookup"><span data-stu-id="beb77-134">Unlike your data that is stored inside Cosmos DB, hello automatic backups are stored in Azure Blob Storage service.</span></span> <span data-ttu-id="beb77-135">caricamento di latenza bassa/efficiente hello tooguarantee, snapshot hello del backup è istanza tooan caricato nell'archiviazione Blob di Azure in hello area scrittura corrente hello dell'account di database DB Cosmos stessa area.</span><span class="sxs-lookup"><span data-stu-id="beb77-135">tooguarantee hello low latency/efficient upload, hello snapshot of your backup is uploaded tooan instance of Azure Blob storage in hello same region as hello current write region of your Cosmos DB database account.</span></span> <span data-ttu-id="beb77-136">Per garantire la resilienza in situazioni di emergenza, ogni snapshot dei dati di backup nell'archiviazione Blob di Azure viene replicato nuovamente tramite area tooanother archiviazione con ridondanza geografica (GRS).</span><span class="sxs-lookup"><span data-stu-id="beb77-136">For resiliency against regional disaster, each snapshot of your backup data in Azure Blob Storage is again replicated via geo-redundant storage (GRS) tooanother region.</span></span> <span data-ttu-id="beb77-137">Hello diagramma seguente mostra che l'intero contenitore Cosmos DB hello (con tutte le tre partizioni primarie negli Stati Uniti occidentali, in questo esempio) viene eseguito il backup in un account di archiviazione Blob di Azure remoto negli Stati Uniti occidentali e quindi GRS replicati tooEast ci.</span><span class="sxs-lookup"><span data-stu-id="beb77-137">hello following diagram shows that hello entire Cosmos DB container (with all three primary partitions in West US, in this example) is backed up in a remote Azure Blob Storage account in West US and then GRS replicated tooEast US.</span></span> 

<span data-ttu-id="beb77-138">Hello immagine seguente illustra i backup completi periodici di tutte le entità di database Cosmos in archiviazione di Azure di archiviazione con ridondanza geografica.</span><span class="sxs-lookup"><span data-stu-id="beb77-138">hello following image illustrates periodic full backups of all Cosmos DB entities in GRS Azure Storage.</span></span>

![Backup completi periodici di tutte le entità di Cosmos DB nell'archiviazione con ridondanza geografica di Azure](./media/online-backup-and-restore/automatic-backup.png)

## <a name="backup-retention-period"></a><span data-ttu-id="beb77-140">Periodo di conservazione dei backup</span><span class="sxs-lookup"><span data-stu-id="beb77-140">Backup retention period</span></span>
<span data-ttu-id="beb77-141">Come descritto in precedenza, Azure Cosmos DB accetta gli snapshot dei dati ogni quattro ore e consente di mantenere gli snapshot delle ultime due hello di ogni partizione per 30 giorni.</span><span class="sxs-lookup"><span data-stu-id="beb77-141">As described above, Azure Cosmos DB takes snapshots of your data every four hours and retains hello last two snapshots of every partition for 30 days.</span></span> <span data-ttu-id="beb77-142">In base alle normative di conformità, gli snapshot vengono eliminati dopo 90 giorni.</span><span class="sxs-lookup"><span data-stu-id="beb77-142">Per our compliance regulations, snapshots are purged after 90 days.</span></span>

<span data-ttu-id="beb77-143">Se si desidera toomaintain proprio snapshot, è possibile utilizzare l'opzione di tooJSON esportazione hello in hello Azure Cosmos DB [dello strumento di migrazione dei dati](import-data.md#export-to-json-file) tooschedule ulteriori backup.</span><span class="sxs-lookup"><span data-stu-id="beb77-143">If you want toomaintain your own snapshots, you can use hello export tooJSON option in hello Azure Cosmos DB [Data Migration tool](import-data.md#export-to-json-file) tooschedule additional backups.</span></span> 

## <a name="restoring-a-database-from-an-online-backup"></a><span data-ttu-id="beb77-144">Ripristino di un database da un backup online</span><span class="sxs-lookup"><span data-stu-id="beb77-144">Restoring a database from an online backup</span></span>
<span data-ttu-id="beb77-145">Se si elimina accidentalmente il database o la raccolta, è possibile [un ticket di supporto](https://portal.azure.com/?#blade/Microsoft_Azure_Support/HelpAndSupportBlade) o [contattare il supporto Azure](https://azure.microsoft.com/support/options/) dati hello toorestore dall'ultimo backup automatico di hello.</span><span class="sxs-lookup"><span data-stu-id="beb77-145">If you accidentally delete your database or collection, you can [file a support ticket](https://portal.azure.com/?#blade/Microsoft_Azure_Support/HelpAndSupportBlade) or [call Azure support](https://azure.microsoft.com/support/options/) toorestore hello data from hello last automatic backup.</span></span> <span data-ttu-id="beb77-146">Se è necessario toorestore il database a causa di problema di danneggiamento dei dati, vedere [gestisce il danneggiamento dei dati](#handling-data-corruption) in base alle esigenze tootake ulteriori passaggi tooprevent hello danneggiato dati dai backup hello penetrazione.</span><span class="sxs-lookup"><span data-stu-id="beb77-146">If you need toorestore your database because of data corruption issue, see [Handling data corruption](#handling-data-corruption) as you need tootake additional steps tooprevent hello corrupted data from penetrating hello backups.</span></span> <span data-ttu-id="beb77-147">Per uno snapshot specifico del toobe backup ripristinato, DB Cosmos richiede che i dati di hello erano disponibili per la durata di hello del ciclo di backup hello per lo snapshot.</span><span class="sxs-lookup"><span data-stu-id="beb77-147">For a specific snapshot of your backup toobe restored, Cosmos DB requires that hello data was available for hello duration of hello backup cycle for that snapshot.</span></span>

## <a name="handling-data-corruption"></a><span data-ttu-id="beb77-148">Gestione del danneggiamento dei dati</span><span class="sxs-lookup"><span data-stu-id="beb77-148">Handling data corruption</span></span>
<span data-ttu-id="beb77-149">DB Cosmos Azure mantiene backup ultime due di hello di ogni partizione nel sistema hello.</span><span class="sxs-lookup"><span data-stu-id="beb77-149">Azure Cosmos DB retains hello last two backups of every partition in hello system.</span></span> <span data-ttu-id="beb77-150">Questo modello è molto utili quando un contenitore (raccolta di documenti, grafico e tabella) o un database viene accidentalmente eliminato perché una delle ultime versioni hello può essere ripristinata.</span><span class="sxs-lookup"><span data-stu-id="beb77-150">This model works very well when a container (collection of documents, graph, table) or a database is accidentally deleted since one of hello last versions can be restored.</span></span> <span data-ttu-id="beb77-151">Tuttavia, in hello caso in cui quando gli utenti possono comportare un problema di danneggiamento dei dati, Azure Cosmos DB potrebbe non essere consapevole di danneggiamento dei dati hello ed ed è possibile che hello danneggiamento possibile evitare i backup hello.</span><span class="sxs-lookup"><span data-stu-id="beb77-151">However, in hello case when when users may introduce a data corruption issue, Azure Cosmos DB may be unaware of hello data corruption, and it is possible that hello corruption may have penetrated hello backups.</span></span> <span data-ttu-id="beb77-152">Non appena vengono rilevati dati danneggiati, è necessario eliminare il contenitore di hello danneggiato (raccolta/grafico o tabella) in modo che i backup siano protetti dalla sovrascrittura con dati danneggiati.</span><span class="sxs-lookup"><span data-stu-id="beb77-152">As soon as corruption is detected, you should delete hello corrupted container (collection/graph/table) so that backups are protected from being overwritten with corrupted data.</span></span> <span data-ttu-id="beb77-153">Dopo l'ultimo backup hello potrebbe essere quattro ore, è possibile utilizzare utente hello [modificare feed](change-feed.md) toocapture e archivio hello ultime quattro ore di dati prima di eliminare il contenitore di hello.</span><span class="sxs-lookup"><span data-stu-id="beb77-153">Since hello last backup could be four hours old, hello user can employ [change feed](change-feed.md) toocapture and store hello last four hours worth of data before deleting hello container.</span></span>

## <a name="next-steps"></a><span data-ttu-id="beb77-154">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="beb77-154">Next steps</span></span>

<span data-ttu-id="beb77-155">vedere il database in più data center, tooreplicate [distribuire i dati a livello globale con DB Cosmos](distribute-data-globally.md).</span><span class="sxs-lookup"><span data-stu-id="beb77-155">tooreplicate your database in multiple data centers, see [distribute your data globally with Cosmos DB](distribute-data-globally.md).</span></span> 

<span data-ttu-id="beb77-156">toofile contattare il supporto tecnico di Azure, [un ticket dal portale di Azure hello](https://portal.azure.com/?#blade/Microsoft_Azure_Support/HelpAndSupportBlade).</span><span class="sxs-lookup"><span data-stu-id="beb77-156">toofile contact Azure Support, [file a ticket from hello Azure portal](https://portal.azure.com/?#blade/Microsoft_Azure_Support/HelpAndSupportBlade).</span></span>

