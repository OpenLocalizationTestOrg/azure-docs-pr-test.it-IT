---
title: autenticazione aaaUser per App per le API in Azure App Service | Documenti Microsoft
description: Informazioni su come un'app per le API nel servizio App di Azure, consentendo di tooprotect tooauthenticated solo utenti di accesso.
services: app-service\api
documentationcenter: .net
author: alexkarcher-msft
manager: erikre
editor: 
ms.assetid: 3896760d-46ff-4b67-b98a-edd233f24758
ms.service: app-service-api
ms.workload: na
ms.tgt_pltfrm: dotnet
ms.devlang: na
ms.topic: article
ms.date: 06/30/2016
ms.author: alkarche
ms.openlocfilehash: 4702fc77fcfe736405e22b033c35d22ae3c5a300
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/06/2017
---
# <a name="user-authentication-for-api-apps-in-azure-app-service"></a><span data-ttu-id="6a7a8-103">Autenticazione utente per le app per le API nel servizio app di Azure</span><span class="sxs-lookup"><span data-stu-id="6a7a8-103">User authentication for API Apps in Azure App Service</span></span>
## <a name="overview"></a><span data-ttu-id="6a7a8-104">Panoramica</span><span class="sxs-lookup"><span data-stu-id="6a7a8-104">Overview</span></span>
<span data-ttu-id="6a7a8-105">Questo articolo illustra come può essere chiamato tooprotect un'app per le API di Azure in modo che solo gli utenti autenticati.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-105">This article shows how tooprotect an Azure API app so that only authenticated users can call it.</span></span> <span data-ttu-id="6a7a8-106">Hello articolo si presuppone di avere letto hello [panoramica dell'autenticazione del servizio App di Azure](../app-service/app-service-authentication-overview.md).</span><span class="sxs-lookup"><span data-stu-id="6a7a8-106">hello article assumes that you have read hello [Azure App Service authentication overview](../app-service/app-service-authentication-overview.md).</span></span>

<span data-ttu-id="6a7a8-107">Si apprenderà come:</span><span class="sxs-lookup"><span data-stu-id="6a7a8-107">You'll learn:</span></span>

* <span data-ttu-id="6a7a8-108">Come tooconfigure un provider di autenticazione, con i dettagli per Azure Active Directory (Azure AD).</span><span class="sxs-lookup"><span data-stu-id="6a7a8-108">How tooconfigure an authentication provider, with details for Azure Active Directory (Azure AD).</span></span>
* <span data-ttu-id="6a7a8-109">Come tooconsume un'app di API protetta utilizzando hello [Active Directory Authentication Library (ADAL) per JavaScript](https://github.com/AzureAD/azure-activedirectory-library-for-js).</span><span class="sxs-lookup"><span data-stu-id="6a7a8-109">How tooconsume a protected API app by using hello [Active Directory Authentication Library (ADAL) for JavaScript](https://github.com/AzureAD/azure-activedirectory-library-for-js).</span></span>

<span data-ttu-id="6a7a8-110">Hello articolo sono contenute due sezioni:</span><span class="sxs-lookup"><span data-stu-id="6a7a8-110">hello article contains two sections:</span></span>

* <span data-ttu-id="6a7a8-111">Hello [come l'autenticazione utente tooconfigure in Azure App Service](#authconfig) sezione viene illustrato in generale come tooconfigure l'autenticazione utente per qualsiasi app per le API e si applica equamente tooall Framework supportato dal servizio App, tra cui .NET, Node.js e Java.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-111">hello [How tooconfigure user authentication in Azure App Service](#authconfig) section explains in general how tooconfigure user authentication for any API app and applies equally tooall frameworks supported by App Service, including .NET, Node.js, and Java.</span></span>
* <span data-ttu-id="6a7a8-112">A partire da hello [continuare esercitazioni di App per le API .NET hello](#tutorialstart) sezione, hello Guide articolo tramite la configurazione di un'applicazione di esempio con .NET eseguire il fine e un front-end di AngularJS in modo che utilizzi Azure Active Directory per utente autenticazione.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-112">Starting with hello [Continuing hello .NET API Apps tutorials](#tutorialstart) section, hello article guides you through configuring a sample application with a .NET back end and an AngularJS front end so that it uses Azure Active Directory for user authentication.</span></span> 

## <span data-ttu-id="6a7a8-113"><a id="authconfig"></a>Come l'autenticazione utente tooconfigure in Azure App Service</span><span class="sxs-lookup"><span data-stu-id="6a7a8-113"><a id="authconfig"></a> How tooconfigure user authentication in Azure App Service</span></span>
<span data-ttu-id="6a7a8-114">In questa sezione fornisce istruzioni generali valide tooany API app.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-114">This section provides general instructions that apply tooany API app.</span></span> <span data-ttu-id="6a7a8-115">Per passaggi specifici toohello tooDo applicazione di esempio elenco .NET, andare troppo[continuare esercitazioni su Guida introduttiva di .NET hello](#tutorialstart).</span><span class="sxs-lookup"><span data-stu-id="6a7a8-115">For steps specific toohello tooDo List .NET sample application, go too[Continuing hello .NET getting-started tutorials](#tutorialstart).</span></span>

1. <span data-ttu-id="6a7a8-116">In hello [portale di Azure](https://portal.azure.com/), passare toohello **impostazioni** pannello App hello API che si desidera tooprotect, hello trova **funzionalità** sezione e quindi fare clic su  **Autenticazione / autorizzazione**.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-116">In hello [Azure portal](https://portal.azure.com/), navigate toohello **Settings** blade of hello API app that you want tooprotect, find hello **Features** section, and then click **Authentication/ Authorization**.</span></span>
   
    ![Autenticazione/Autorizzazione del portale di Azure](./media/app-service-api-dotnet-user-principal-auth/features.png)
2. <span data-ttu-id="6a7a8-118">In hello **autenticazione / autorizzazione** pannello, fare clic su **su**.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-118">In hello **Authentication / Authorization** blade, click **On**.</span></span>
3. <span data-ttu-id="6a7a8-119">Selezionare una delle opzioni di hello hello **tootake azione quando la richiesta non è autenticata** elenco a discesa.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-119">Select one of hello options from hello **Action tootake when request is not authenticated** drop-down list.</span></span>
   
   * <span data-ttu-id="6a7a8-120">Se si desidera solo chiamate autenticate tooreach app per le API, scegliere una delle hello **Log con...**  opzioni.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-120">If you want only authenticated calls tooreach your API app, choose one of hello **Log in with ...** options.</span></span> <span data-ttu-id="6a7a8-121">Questa opzione consente di tooprotect hello API app senza scrivere codice che viene eseguito in essa contenuti.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-121">This option enables you tooprotect hello API app without writing any code that runs in it.</span></span>
   * <span data-ttu-id="6a7a8-122">Se si desidera tooreach tutte le chiamate API app, scegliere **Consenti richiesta (alcuna azione)**.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-122">If you want all calls tooreach your API app, choose **Allow request (no action)**.</span></span> <span data-ttu-id="6a7a8-123">È possibile utilizzare questa opzione toodirect non autenticati chiamanti tooa scelta dei provider di autenticazione.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-123">You can use this option toodirect unauthenticated callers tooa choice of authentication providers.</span></span> <span data-ttu-id="6a7a8-124">Con questa opzione si dispone dell'autorizzazione di toohandle di toowrite codice.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-124">With this option you have toowrite code toohandle authorization.</span></span>
     
     <span data-ttu-id="6a7a8-125">Per altre informazioni, vedere [Autenticazione e autorizzazione per app per le API nel servizio app di Azure](app-service-api-authentication.md#multiple-protection-options).</span><span class="sxs-lookup"><span data-stu-id="6a7a8-125">For more information, see [Authentication and authorization for API Apps in Azure App Service](app-service-api-authentication.md#multiple-protection-options).</span></span>
4. <span data-ttu-id="6a7a8-126">Selezionare uno o più di hello **provider di autenticazione**.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-126">Select one or more of hello **Authentication Providers**.</span></span>
   
    <span data-ttu-id="6a7a8-127">immagine di Hello Mostra le scelte che richiedono tutti i chiamanti toobe autenticato da Azure AD.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-127">hello image shows    choices that require all callers toobe authenticated by Azure AD.</span></span>
   
    ![Pannello Autenticazione/Autorizzazione del portale di Azure](./media/app-service-api-dotnet-user-principal-auth/authblade.png)
   
    <span data-ttu-id="6a7a8-129">Quando si sceglie un provider di autenticazione, portale hello viene visualizzato un pannello di configurazione per il provider.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-129">When you choose an authentication provider, hello portal displays a configuration blade for that provider.</span></span> 
   
    <span data-ttu-id="6a7a8-130">Per istruzioni dettagliate che illustrano come tooconfigure hello pannelli di configurazione del provider di autenticazione, vedere [come tooconfigure l'accesso di Azure Active Directory di servizio App applicazione toouse](../app-service-mobile/app-service-mobile-how-to-configure-active-directory-authentication.md).</span><span class="sxs-lookup"><span data-stu-id="6a7a8-130">For detailed instructions that explain how tooconfigure hello authentication provider configuration blades, see [How tooconfigure your App Service application toouse Azure Active Directory login](../app-service-mobile/app-service-mobile-how-to-configure-active-directory-authentication.md).</span></span> <span data-ttu-id="6a7a8-131">(collegamento di hello viene tooan articolo su Azure AD, ma articolo hello stesso contiene schede che collegano tooarticles per hello altri provider di autenticazione).</span><span class="sxs-lookup"><span data-stu-id="6a7a8-131">(hello link goes tooan article about Azure AD, but hello article itself contains tabs that link tooarticles for hello other authentication providers.)</span></span>
5. <span data-ttu-id="6a7a8-132">Al pannello di configurazione del provider di autenticazione hello termine, fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-132">When you're done with hello authentication provider configuration blade, click **OK**.</span></span>
6. <span data-ttu-id="6a7a8-133">In hello **autenticazione / autorizzazione** pannello, fare clic su **salvare**.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-133">In hello **Authentication / Authorization** blade, click **Save**.</span></span>

<span data-ttu-id="6a7a8-134">Quando questa operazione viene eseguita, servizio App autentica tutte le chiamate API prima che raggiungano app hello per le API.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-134">When this is done, App Service authenticates all API calls before they reach hello API app.</span></span> <span data-ttu-id="6a7a8-135">lavoro di servizi di autenticazione Hello hello uguale per tutte le lingue supportate dal servizio App, inclusi .NET, Node.js e Java di.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-135">hello authentication services work hello same for all languages that App service supports, including .NET, Node.js, and Java.</span></span> 

<span data-ttu-id="6a7a8-136">toomake autenticato chiamate API, chiamante hello include i token di connessione del provider di autenticazione hello OAuth 2.0 nell'intestazione di autorizzazione hello di richieste HTTP.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-136">toomake authenticated API calls, hello caller includes hello authentication provider's OAuth 2.0 bearer token in hello Authorization header of HTTP requests.</span></span> <span data-ttu-id="6a7a8-137">token Hello possono essere acquisite tramite il SDK del provider di autenticazione hello.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-137">hello token can be acquired by using hello authentication provider's SDK.</span></span>

## <span data-ttu-id="6a7a8-138"><a id="tutorialstart"></a>Esercitazioni di App per le API .NET hello continuare</span><span class="sxs-lookup"><span data-stu-id="6a7a8-138"><a id="tutorialstart"></a> Continuing hello .NET API Apps tutorials</span></span>
<span data-ttu-id="6a7a8-139">Se si segue esercitazioni di Node.js o Java hello per le app di API, ignorare l'articolo successivo toohello, [l'autenticazione dell'entità servizio per App per le API](app-service-api-dotnet-service-principal-auth.md).</span><span class="sxs-lookup"><span data-stu-id="6a7a8-139">If you are following hello Node.js or Java tutorials for API apps, skip toohello next article, [service principal authentication for API apps](app-service-api-dotnet-service-principal-auth.md).</span></span> 

<span data-ttu-id="6a7a8-140">Se si segue serie di esercitazioni hello .NET per App per le API e applicazione di esempio hello hanno già distribuito come indicato in hello [prima](app-service-api-dotnet-get-started.md) e [secondo](app-service-api-cors-consume-javascript.md) esercitazioni, ignorare toohello [impostare l'autenticazione in Azure AD e di servizio App](#azureauth) sezione.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-140">If you are following hello .NET tutorial series for API apps and have already deployed hello sample application as directed in hello [first](app-service-api-dotnet-get-started.md) and [second](app-service-api-cors-consume-javascript.md) tutorials, skip toohello [Set up authentication in App Service and Azure AD](#azureauth) section.</span></span>

<span data-ttu-id="6a7a8-141">Se si desidera toofollow questa esercitazione senza passare attraverso le esercitazioni di prima e seconda hello, hello seguendo i passaggi che illustrano la modalità di avvio tooget tramite un'applicazione di esempio hello toodeploy processo automatico.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-141">If you want toofollow this tutorial without going through hello first and second tutorials, do hello following steps which explain how tooget started by using an automated process toodeploy hello sample application.</span></span>

> [!NOTE]
> <span data-ttu-id="6a7a8-142">Hello segue iniziare toohello punto di partenza stesso come se si hello prime due esercitazioni, con una sola eccezione: Visual Studio non sapranno già quali app web o app per le API che ogni progetto viene distribuito a.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-142">hello following steps get you toohello same starting point as if you did hello first two tutorials, with one exception: Visual Studio won't already know which web app or API app that each project gets deployed to.</span></span> <span data-ttu-id="6a7a8-143">Pertanto, non sarà possibile le istruzioni esatte in questa esercitazione viene illustrato come destinazioni di destra toohello toodeploy.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-143">That means you won't have exact instructions in this tutorial that explain how toodeploy toohello right targets.</span></span> <span data-ttu-id="6a7a8-144">Se non si ha familiarità con pensare a come passaggi di distribuzione hello toodo autonomamente, è preferibile toofollow hello esercitazione serie hello [prima esercitazione](app-service-api-dotnet-get-started.md) di toostart con questo automatizzato il processo di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-144">If you're not comfortable with figuring out how toodo hello deployment steps on your own, it's better toofollow hello tutorial series from hello [first tutorial](app-service-api-dotnet-get-started.md) than toostart with this automated deployment process.</span></span>
> 
> 

1. <span data-ttu-id="6a7a8-145">Assicurarsi di disporre di tutti i prerequisiti di hello elencati in hello [prima esercitazione](app-service-api-dotnet-get-started.md).</span><span class="sxs-lookup"><span data-stu-id="6a7a8-145">Make sure that you have all of hello prerequisites listed in hello [first tutorial](app-service-api-dotnet-get-started.md).</span></span> <span data-ttu-id="6a7a8-146">In aggiunta toohello prerequisiti elencati queste esercitazioni autenticazione presuppongono che si ha familiarità con App del servizio web App e App in Visual Studio per le API e hello portale di Azure.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-146">In addition toohello prerequisites listed, these authentication tutorials assume that you have worked with App Service web apps and API apps in Visual Studio and hello Azure portal.</span></span>
2. <span data-ttu-id="6a7a8-147">Fare clic su hello **distribuire tooAzure** pulsante hello [file Leggimi di tooDo elenco esempio repository](https://github.com/azure-samples/app-service-api-dotnet-todo-list/blob/master/readme.md) toodeploy hello API App e hello web app.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-147">Click hello **Deploy tooAzure** button in hello [tooDo List sample repository readme file](https://github.com/azure-samples/app-service-api-dotnet-todo-list/blob/master/readme.md) toodeploy hello API apps and hello web app.</span></span> <span data-ttu-id="6a7a8-148">Prendere nota del gruppo di risorse di Azure hello che viene creato, come è possibile usare questo toolook successive di app web e i nomi delle app di API.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-148">Make a note of hello Azure resource group that gets created, as you can use this later toolook up web app and API app names.</span></span>
3. <span data-ttu-id="6a7a8-149">Download o hello clone [repository di esempio elenco tooDo](https://github.com/Azure-Samples/app-service-api-dotnet-todo-list) codice hello tooget che verranno utilizzate in locale in Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-149">Download or clone hello [tooDo List sample repository](https://github.com/Azure-Samples/app-service-api-dotnet-todo-list) tooget hello code that you'll work with locally in Visual Studio.</span></span>

## <span data-ttu-id="6a7a8-150"><a id="azureauth"></a> Configurare l'autenticazione nel servizio app e in Azure AD</span><span class="sxs-lookup"><span data-stu-id="6a7a8-150"><a id="azureauth"></a> Set up authentication in App Service and Azure AD</span></span>
<span data-ttu-id="6a7a8-151">È ora disponibile un'applicazione hello in esecuzione in Azure App Service senza richiedere che gli utenti autenticati.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-151">You now have hello application running in Azure App Service without requiring that users be authenticated.</span></span> <span data-ttu-id="6a7a8-152">In questa sezione è aggiungere l'autenticazione in questo modo hello seguenti attività:</span><span class="sxs-lookup"><span data-stu-id="6a7a8-152">In this section you add authentication by doing hello following tasks:</span></span>

* <span data-ttu-id="6a7a8-153">Configurare l'autenticazione di Azure Active Directory (Azure AD) toorequire di servizio App per chiamare l'applicazione di livello intermedio API hello.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-153">Configure App Service toorequire Azure Active Directory (Azure AD) authentication for calling hello middle tier API app.</span></span>
* <span data-ttu-id="6a7a8-154">Creare un'applicazione Azure AD.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-154">Create an Azure AD application.</span></span>
* <span data-ttu-id="6a7a8-155">Configurare il token di connessione hello hello Azure AD applicazione toosend dopo front-end di accesso toohello AngularJS.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-155">Configure hello Azure AD application toosend hello bearer token after logon toohello AngularJS front end.</span></span> 

<span data-ttu-id="6a7a8-156">Se si verificano problemi durante le direzioni dell'esercitazione di hello seguenti, vedere hello [Troubleshooting](#troubleshooting) sezione alla fine di hello dell'esercitazione hello.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-156">If you run into problems while following hello tutorial directions, see hello [Troubleshooting](#troubleshooting) section at hello end of hello tutorial.</span></span> 

### <a name="configure-authentication-for-hello-middle-tier-api-app"></a><span data-ttu-id="6a7a8-157">Configurare l'autenticazione per il livello intermedio di hello app per le API</span><span class="sxs-lookup"><span data-stu-id="6a7a8-157">Configure authentication for hello middle tier API app</span></span>
1. <span data-ttu-id="6a7a8-158">In hello [portale di Azure](https://portal.azure.com/), passare toohello **impostazioni** pannello dell'applicazione hello API che è stato creato per il progetto ToDoListAPI hello, trovare hello **funzionalità** sezione e quindi Fare clic su **autenticazione / autorizzazione**.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-158">In hello [Azure portal](https://portal.azure.com/), navigate toohello **Settings** blade of hello API app that you created for hello ToDoListAPI project, find hello **Features** section, and then click **Authentication / Authorization**.</span></span>
   
    ![Autenticazione/Autorizzazione del portale di Azure](./media/app-service-api-dotnet-user-principal-auth/features.png)
2. <span data-ttu-id="6a7a8-160">In hello **autenticazione / autorizzazione** pannello, fare clic su **su**.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-160">In hello **Authentication / Authorization** blade, click **On**.</span></span>
3. <span data-ttu-id="6a7a8-161">In hello **tootake azione quando la richiesta non è autenticata** elenco a discesa, seleziona **Accedi con Azure Active Directory**.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-161">In hello **Action tootake when request is not authenticated** drop-down list, select **Log in with Azure Active Directory**.</span></span>
   
    <span data-ttu-id="6a7a8-162">Questa opzione garantisce che nessuna richiesta unauathenticated raggiungerà app hello per le API.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-162">This option ensures that no unauathenticated requests will reach hello API app.</span></span> 
4. <span data-ttu-id="6a7a8-163">In **Provider di autenticazione** fare clic su **Azure Active Directory**.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-163">Under **Authentication Providers**, click **Azure Active Directory**.</span></span>
   
    ![Pannello Autenticazione/Autorizzazione del portale di Azure](./media/app-service-api-dotnet-user-principal-auth/authblade.png)
5. <span data-ttu-id="6a7a8-165">In hello **impostazioni di Azure Active Directory** pannello, fare clic su **Express**</span><span class="sxs-lookup"><span data-stu-id="6a7a8-165">In hello **Azure Active Directory Settings** blade, click **Express**</span></span>
   
    ![Opzione Rapida di Autenticazione/Autorizzazione del portale di Azure](./media/app-service-api-dotnet-user-principal-auth/aadsettings.png)
   
    <span data-ttu-id="6a7a8-167">Con hello **Express** opzione servizio App può creare automaticamente un'applicazione Azure AD in Azure AD [tenant](https://msdn.microsoft.com/en-us/library/azure/jj573650.aspx#BKMK_WhatIsAnAzureADTenant).</span><span class="sxs-lookup"><span data-stu-id="6a7a8-167">With hello **Express** option, App Service can automatically create an Azure AD application in your Azure AD [tenant](https://msdn.microsoft.com/en-us/library/azure/jj573650.aspx#BKMK_WhatIsAnAzureADTenant).</span></span> 
   
    <span data-ttu-id="6a7a8-168">Non è necessario toocreate un tenant, perché ogni account di Azure dispone automaticamente di uno.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-168">You don't have toocreate a tenant, because every Azure account automatically has one.</span></span>
6. <span data-ttu-id="6a7a8-169">In **modalità di gestione**, fare clic su **Crea nuova App AD** se non è già selezionata e osservare il valore hello in hello **creare App** casella di testo; è possibile cercare questo AAD applicazione hello portale di Azure classico in un secondo momento.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-169">Under **Management mode**, click **Create New AD App** if it isn't already selected, and notice hello value that is in hello **Create App** text box; you'll look up this AAD application in hello Azure classic portal later.</span></span>
   
    ![Impostazioni di Azure AD del portale di Azure](./media/app-service-api-dotnet-user-principal-auth/aadsettings2.png)
   
    <span data-ttu-id="6a7a8-171">Azure crea automaticamente un'applicazione Azure AD con hello nome indicato nel tenant di Azure AD.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-171">Azure will automatically create an Azure AD application with hello indicated name in your Azure AD tenant.</span></span> <span data-ttu-id="6a7a8-172">Per impostazione predefinita, viene denominato hello applicazione AD Azure stesso hello come applicazione hello API.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-172">By default, hello Azure AD application is named hello same as hello API app.</span></span> <span data-ttu-id="6a7a8-173">Se si preferisce, è possibile immettere un nome diverso.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-173">If you prefer, you can enter a different name.</span></span>
7. <span data-ttu-id="6a7a8-174">Fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-174">Click **OK**.</span></span>
8. <span data-ttu-id="6a7a8-175">In hello **autenticazione / autorizzazione** pannello, fare clic su **salvare**.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-175">In hello **Authentication / Authorization** blade, click **Save**.</span></span>
   
    ![Fare clic su Salva.](./media/app-service-api-dotnet-user-principal-auth/authsave.png)

<span data-ttu-id="6a7a8-177">Ora solo gli utenti nel tenant di Azure AD possono chiamare app hello per le API.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-177">Now only users in your Azure AD tenant can call hello API app.</span></span>

### <a name="optional-test-hello-api-app"></a><span data-ttu-id="6a7a8-178">Facoltativo: Testare l'applicazione hello API</span><span class="sxs-lookup"><span data-stu-id="6a7a8-178">Optional: Test hello API app</span></span>
1. <span data-ttu-id="6a7a8-179">In un browser andare toohello URL dell'app hello API: in hello **app per le API** pannello in hello portale di Azure, fare clic su collegamento hello in **URL**.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-179">In a browser go toohello URL of hello API app: in hello **API app** blade in hello Azure portal, click hello link under **URL**.</span></span>  
   
    <span data-ttu-id="6a7a8-180">Si è reindirizzato tooa schermata di accesso perché le richieste non autenticate non sono consentite tooreach hello API app.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-180">You are redirected tooa login screen because unauthenticated requests are not allowed tooreach hello API app.</span></span>
   
    <span data-ttu-id="6a7a8-181">Se il browser passa pagina toohello "completata", il browser hello potrebbe già essere registrato, in tal caso, aprire una finestra InPrivate o Incognito e passare l'URL dell'app toohello API.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-181">If your browser goes toohello "successfully created" page, hello browser might already be logged on -- in that case, open an InPrivate or Incognito window and go toohello API app's URL.</span></span>
2. <span data-ttu-id="6a7a8-182">Accedere con le credenziali per un utente incluso nel tenant di Azure AD.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-182">Log on using credentials for a user in your Azure AD tenant.</span></span>
   
    <span data-ttu-id="6a7a8-183">Quando si accede, hello "completata" pagina viene visualizzata nel browser hello.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-183">When you're logged on, hello "successfully created" page appears in hello browser.</span></span>
3. <span data-ttu-id="6a7a8-184">Browser hello Chiudi.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-184">Close hello browser.</span></span>

### <a name="configure-hello-azure-ad-application"></a><span data-ttu-id="6a7a8-185">Configurare un'applicazione hello Azure AD</span><span class="sxs-lookup"><span data-stu-id="6a7a8-185">Configure hello Azure AD application</span></span>
<span data-ttu-id="6a7a8-186">Quando è stata configurata l'autenticazione di Azure AD, il servizio app ha creato automaticamente un'applicazione Azure AD.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-186">When you configured Azure AD authentication, App Service created an Azure AD application for you.</span></span> <span data-ttu-id="6a7a8-187">Per impostazione predefinita un'applicazione hello nuovo Azure AD è stato configurato tooprovide hello connessione toohello token API URL dell'app.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-187">By default hello new Azure AD application was configured tooprovide hello bearer token toohello API app's URL.</span></span> <span data-ttu-id="6a7a8-188">In questa sezione configurare hello Azure AD tooprovide hello connessione toohello token AngularJS front-end dell'applicazione anziché direttamente toohello intermedio API app.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-188">In this section you configure hello Azure AD application tooprovide hello bearer token toohello AngularJS front end instead of directly toohello middle tier API app.</span></span> <span data-ttu-id="6a7a8-189">front-end di Hello AngularJS invierà hello toohello token API app durante la chiamata di app per le API hello.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-189">hello AngularJS front end will send hello token toohello API app when it calls hello API app.</span></span>

> [!NOTE]
> <span data-ttu-id="6a7a8-190">processo di hello tookeep più semplice possibile, questa esercitazione viene utilizzato un singolo Azure AD applicazione per front-end hello e applicazione di livello intermedio API hello.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-190">tookeep hello process as simple as possible, this tutorial uses a single Azure AD application for both hello front end and hello middle tier API app.</span></span> <span data-ttu-id="6a7a8-191">Un'altra opzione è toouse due applicazioni di Azure AD.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-191">Another option is toouse two Azure AD applications.</span></span> <span data-ttu-id="6a7a8-192">In questo caso sarebbe necessario di toogive hello front-end Azure AD applicazione autorizzazione toocall hello di Azure AD applicazione di livello intermedio.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-192">In that case you would have toogive hello front end's Azure AD application permission toocall hello middle tier's Azure AD application.</span></span> <span data-ttu-id="6a7a8-193">Questo approccio con più applicazione fornisce un controllo più granulare livello tooeach autorizzazioni.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-193">This multi-application approach would give you more granular control over permissions tooeach tier.</span></span>
> 
> 

1. <span data-ttu-id="6a7a8-194">In hello [portale di Azure classico](https://manage.windowsazure.com/), andare troppo**Azure Active Directory**.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-194">In hello [Azure classic portal](https://manage.windowsazure.com/), go too**Azure Active Directory**.</span></span>
   
   <span data-ttu-id="6a7a8-195">È necessario portale classico di hello toouse poiché alcune impostazioni di Azure Active Directory che è necessario accedere tooare non è ancora disponibile nel portale di Azure corrente hello.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-195">You have toouse hello classic portal because certain Azure Active Directory settings that you need access tooare not yet available in hello current Azure portal.</span></span>
2. <span data-ttu-id="6a7a8-196">In hello **Directory** scheda, fare clic su tenant di AAD.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-196">On hello **Directory** tab, click your AAD tenant.</span></span>
   
   ![Azure AD nel portale classico](./media/app-service-api-dotnet-user-principal-auth/selecttenant.png)
3. <span data-ttu-id="6a7a8-198">Fare clic su **applicazioni > applicazioni proprietà dell'azienda**, quindi fare clic su hello segno di spunta.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-198">Click **Applications > Applications my company owns**, and then click hello check mark.</span></span>
   
   <span data-ttu-id="6a7a8-199">Potrebbe anche essere toorefresh hello pagina toosee hello nuova applicazione.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-199">You might also have toorefresh hello page toosee hello new application.</span></span>
4. <span data-ttu-id="6a7a8-200">Nell'elenco di hello delle applicazioni, fare clic su nome hello di hello Azure creata automaticamente quando è abilitata l'autenticazione per l'app dell'API.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-200">In hello list of applications, click hello name of hello one that Azure created for you when you enabled authentication for your API app.</span></span>
   
   ![Scheda Applicazioni Azure AD](./media/app-service-api-dotnet-user-principal-auth/appstab.png)
5. <span data-ttu-id="6a7a8-202">Fare clic su **Configure**.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-202">Click **Configure**.</span></span>
   
   ![Scheda Configura di Azure AD](./media/app-service-api-dotnet-user-principal-auth/configure.png)
6. <span data-ttu-id="6a7a8-204">Impostare **Sign-on URL** toohello URL per l'app web di AngularJS, nessuna barra finale.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-204">Set **Sign-on URL** toohello URL for your AngularJS web app, no trailing slash.</span></span>
   
   <span data-ttu-id="6a7a8-205">Immettere ad esempio https://todolistangular.azurewebsites.net</span><span class="sxs-lookup"><span data-stu-id="6a7a8-205">For example: https://todolistangular.azurewebsites.net</span></span>
   
   ![URL di accesso](./media/app-service-api-dotnet-user-principal-auth/signonurlazure.png)
7. <span data-ttu-id="6a7a8-207">Impostare **URL di risposta** toohello URL per l'app web, nessuna barra finale.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-207">Set **Reply URL** toohello URL for your web app, no trailing slash.</span></span>
   
   <span data-ttu-id="6a7a8-208">Immettere ad esempio https://todolistsangular.azurewebsites.net</span><span class="sxs-lookup"><span data-stu-id="6a7a8-208">For example: https://todolistsangular.azurewebsites.net</span></span>
8. <span data-ttu-id="6a7a8-209">Fare clic su **Save**.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-209">Click **Save**.</span></span>
   
   ![URL di risposta](./media/app-service-api-dotnet-user-principal-auth/replyurlazure.png)
9. <span data-ttu-id="6a7a8-211">Nella parte inferiore di hello della pagina hello, fare clic su **Gestisci manifesto > Download manifesto**.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-211">At hello bottom of hello page, click **Manage manifest > Download manifest**.</span></span>
   
   ![Scaricare il manifesto](./media/app-service-api-dotnet-user-principal-auth/downloadmanifest.png)
10. <span data-ttu-id="6a7a8-213">Scaricare hello tooa percorso in cui è possibile modificarlo.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-213">Download hello file tooa location where you can edit it.</span></span>
11. <span data-ttu-id="6a7a8-214">Nel file manifesto hello scaricato, cercare hello `oauth2AllowImplicitFlow` proprietà.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-214">In hello downloaded manifest file, search for hello  `oauth2AllowImplicitFlow` property.</span></span> <span data-ttu-id="6a7a8-215">Modificare il valore di hello di questa proprietà da `false` troppo`true`e quindi salvare il file hello.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-215">Change hello value of this property from `false` too`true`, and then save hello file.</span></span>
    
    <span data-ttu-id="6a7a8-216">Questa impostazione è necessaria per l'accesso da un'applicazione a singola pagina JavaScript</span><span class="sxs-lookup"><span data-stu-id="6a7a8-216">This setting is required for access from a JavaScript single-page application.</span></span> <span data-ttu-id="6a7a8-217">In questo modo hello Oauth 2.0 connessione toobe token restituito nel frammento di URL hello.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-217">It enables hello Oauth 2.0 bearer token toobe returned in hello URL fragment.</span></span>
12. <span data-ttu-id="6a7a8-218">Fare clic su **Gestisci manifesto > caricamento manifesto**e caricare file hello aggiornato nel precedente passaggio hello.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-218">Click **Manage manifest > Upload manifest**, and upload hello file that you updated in hello preceding step.</span></span>
    
    ![Caricare il manifesto](./media/app-service-api-dotnet-user-principal-auth/uploadmanifest.png)
13. <span data-ttu-id="6a7a8-220">Hello copia **ID Client** valore e salvarlo in un punto è possibile ottenere dalla in un secondo momento.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-220">Copy hello **Client ID** value and save it somewhere you can get it from later.</span></span>

## <a name="configure-hello-todolistangular-project-toouse-authentication"></a><span data-ttu-id="6a7a8-221">Configurare l'autenticazione di hello ToDoListAngular progetto toouse</span><span class="sxs-lookup"><span data-stu-id="6a7a8-221">Configure hello ToDoListAngular project toouse authentication</span></span>
<span data-ttu-id="6a7a8-222">In questa sezione si modificare front-end di hello AngularJS in modo che utilizzi Active Directory Authentication Library (ADAL) per JS tooacquire un token di connessione per hello effettuato l'accesso utente da Azure AD.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-222">In this section you change hello AngularJS front end so that it uses Active Directory Authentication Library (ADAL) for JS tooacquire a bearer token for hello logged-on user from Azure AD.</span></span> <span data-ttu-id="6a7a8-223">codice Hello includerà token hello in richieste HTTP inviate toohello di livello intermedio, come illustrato nel seguente diagramma hello.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-223">hello code will include hello token in HTTP requests sent toohello middle tier, as shown in hello following diagram.</span></span> 

![Diagramma di autenticazione utente](./media/app-service-api-dotnet-user-principal-auth/appdiagram.png)

<span data-ttu-id="6a7a8-225">Rendere hello seguente toofiles modifiche nel progetto ToDoListAngular hello.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-225">Make hello following changes toofiles in hello ToDoListAngular project.</span></span>

1. <span data-ttu-id="6a7a8-226">Aprire hello *cshtml* file.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-226">Open hello *index.cshtml* file.</span></span>
2. <span data-ttu-id="6a7a8-227">Rimuovere il commento righe hello che fanno riferimento a hello Active Directory Authentication Library (ADAL) per gli script JS.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-227">Uncomment hello lines that reference hello Active Directory Authentication Library (ADAL) for JS scripts.</span></span>
   
        <script src="app/scripts/adal.js"></script>
        <script src="app/scripts/adal-angular.js"></script>
3. <span data-ttu-id="6a7a8-228">Aprire hello *app/scripts/app.js* file.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-228">Open hello *app/scripts/app.js* file.</span></span>
4. <span data-ttu-id="6a7a8-229">Commento blocco hello di codice contrassegnata per "senza l'autenticazione" e rimuovere il commento blocco hello di codice contrassegnato per "con l'autenticazione".</span><span class="sxs-lookup"><span data-stu-id="6a7a8-229">Comment out hello block of code marked for "without authentication" and uncomment hello block of code marked for "with authentication".</span></span>
   
    <span data-ttu-id="6a7a8-230">Questa modifica fa riferimento a provider di autenticazione ADAL JS hello e fornisce tooit valori di configurazione.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-230">This change references hello ADAL JS authentication provider and provides configuration values tooit.</span></span> <span data-ttu-id="6a7a8-231">In hello alla procedura seguente impostare i valori di configurazione hello per le app per le API e l'applicazione Azure AD.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-231">In hello following steps you set hello configuration values for your API app and Azure AD application.</span></span>
5. <span data-ttu-id="6a7a8-232">Nel codice hello che imposta hello `endpoints` hello variabile, impostare l'URL dell'API toohello URL dell'API hello app creata per il progetto ToDoListAPI hello e impostare hello Azure AD ID toohello ID client applicazione copiata dal portale di Azure classico hello.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-232">In hello code that sets hello `endpoints` variable, set hello API URL toohello URL of hello API app that you created for hello ToDoListAPI project, and set hello Azure AD application ID toohello client ID that you copied from hello Azure classic portal.</span></span>
   
    <span data-ttu-id="6a7a8-233">codice Hello è ora simile toohello esempio seguente.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-233">hello code is now similar toohello following example.</span></span>
   
        var endpoints = {
            "https://todolistapi0121.azurewebsites.net/": "1cf55bc9-9ed8-4df31cf55bc9-9ed8-4df3"
        };
6. <span data-ttu-id="6a7a8-234">In hello chiamare troppo`adalProvider.init`, impostare `tenant` nome tenant tooyour e `clientId` toosame valore utilizzato nel passaggio precedente hello.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-234">In hello call too`adalProvider.init`, set `tenant` tooyour tenant name and `clientId` toosame value you used in hello previous step.</span></span>
   
    <span data-ttu-id="6a7a8-235">codice Hello è ora simile toohello esempio seguente.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-235">hello code is now similar toohello following example.</span></span>
   
        adalProvider.init(
            {
                instance: 'https://login.microsoftonline.com/', 
                tenant: 'contoso.onmicrosoft.com',
                clientId: '1cf55bc9-9ed8-4df31cf55bc9-9ed8-4df3',
                extraQueryParameter: 'nux=1',
                endpoints: endpoints
            },
            $httpProvider
            );
   
    <span data-ttu-id="6a7a8-236">Queste modifiche sono state troppo`app.js` specificare codice chiamante hello e hello chiamata API sono in un'applicazione hello stesso Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-236">These changes too`app.js` specify that hello calling code and hello called API are in hello same Azure AD application.</span></span>
7. <span data-ttu-id="6a7a8-237">Aprire hello *app/scripts/homeCtrl.js* file.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-237">Open hello *app/scripts/homeCtrl.js* file.</span></span>
8. <span data-ttu-id="6a7a8-238">Commento blocco hello di codice contrassegnata per "senza l'autenticazione" e rimuovere il commento blocco hello di codice contrassegnato per "con l'autenticazione".</span><span class="sxs-lookup"><span data-stu-id="6a7a8-238">Comment out hello block of code marked for "without authentication" and uncomment hello block of code marked for "with authentication".</span></span>
9. <span data-ttu-id="6a7a8-239">Aprire hello *app/scripts/indexCtrl.js* file.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-239">Open hello *app/scripts/indexCtrl.js* file.</span></span>
10. <span data-ttu-id="6a7a8-240">Commento blocco hello di codice contrassegnata per "senza l'autenticazione" e rimuovere il commento blocco hello di codice contrassegnato per "con l'autenticazione".</span><span class="sxs-lookup"><span data-stu-id="6a7a8-240">Comment out hello block of code marked for "without authentication" and uncomment hello block of code marked for "with authentication".</span></span>

### <a name="deploy-hello-todolistangular-project-tooazure"></a><span data-ttu-id="6a7a8-241">Distribuire hello ToDoListAngular progetto tooAzure</span><span class="sxs-lookup"><span data-stu-id="6a7a8-241">Deploy hello ToDoListAngular project tooAzure</span></span>
1. <span data-ttu-id="6a7a8-242">In **Esplora**, fare clic sul progetto ToDoListAngular hello e quindi fare clic su **pubblica**.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-242">In **Solution Explorer**, right-click hello ToDoListAngular project, and then click **Publish**.</span></span>
2. <span data-ttu-id="6a7a8-243">Fare clic su **Pubblica**.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-243">Click **Publish**.</span></span>
   
    <span data-ttu-id="6a7a8-244">Visual Studio distribuisce il progetto hello e apre l'URL di base dell'app di web toohello browser.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-244">Visual Studio deploys hello project and opens a browser toohello web app's base URL.</span></span> <span data-ttu-id="6a7a8-245">Verranno visualizzati una pagina di 403 errore, che è norma per un tentativo di toogo tooa API Web URL di base da un browser.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-245">This will show a 403 error page, which is normal for an attempt toogo tooa Web API base URL from a browser.</span></span>
   
    <span data-ttu-id="6a7a8-246">È comunque necessario toomake un livello intermedio app per le API toohello di modifica prima di poter testare un'applicazione hello.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-246">You still have toomake a change toohello middle tier API app before you can test hello application.</span></span>
3. <span data-ttu-id="6a7a8-247">Browser hello Chiudi.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-247">Close hello browser.</span></span>

## <a name="configure-hello-todolistapi-project-toouse-authentication"></a><span data-ttu-id="6a7a8-248">Configurare l'autenticazione di hello ToDoListAPI progetto toouse</span><span class="sxs-lookup"><span data-stu-id="6a7a8-248">Configure hello ToDoListAPI project toouse authentication</span></span>
<span data-ttu-id="6a7a8-249">Attualmente hello Invia progetto ToDoListAPI "*" come hello `owner` tooToDoListDataAPI valore.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-249">Currently hello ToDoListAPI project sends "*" as hello `owner` value tooToDoListDataAPI.</span></span> <span data-ttu-id="6a7a8-250">In questa sezione si modificare hello codice toosend hello ID dell'utente connesso di hello.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-250">In this section you change hello code toosend hello ID of hello logged-on user.</span></span>

<span data-ttu-id="6a7a8-251">Rendere hello dopo le modifiche nel progetto ToDoListAPI hello.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-251">Make hello following changes in hello ToDoListAPI project.</span></span>

1. <span data-ttu-id="6a7a8-252">Aprire hello *Controllers/ToDoListController.cs* file e rimuovere il commento riga hello in ogni metodo di azione che imposta `owner` toohello Azure AD `NameIdentifier` il valore dell'attestazione.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-252">Open hello *Controllers/ToDoListController.cs* file, and uncomment hello line in each action method that sets `owner` toohello Azure AD `NameIdentifier` claim value.</span></span> <span data-ttu-id="6a7a8-253">ad esempio:</span><span class="sxs-lookup"><span data-stu-id="6a7a8-253">For example:</span></span>
   
        owner = ((ClaimsIdentity)User.Identity).FindFirst(ClaimTypes.NameIdentifier).Value;
   
    <span data-ttu-id="6a7a8-254">**Importante**: non rimuovere il commento di codice in hello `ToDoListDataAPI` metodo; operazione dovrà essere effettuata in un secondo momento per l'esercitazione di autenticazione dell'entità servizio hello.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-254">**Important**: Don't uncomment code in hello `ToDoListDataAPI` method; you'll do that later for hello service principal authentication tutorial.</span></span>

### <a name="deploy-hello-todolistapi-project-tooazure"></a><span data-ttu-id="6a7a8-255">Distribuire hello ToDoListAPI progetto tooAzure</span><span class="sxs-lookup"><span data-stu-id="6a7a8-255">Deploy hello ToDoListAPI project tooAzure</span></span>
1. <span data-ttu-id="6a7a8-256">In **Esplora**, fare clic sul progetto ToDoListAPI hello e quindi fare clic su **pubblica**.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-256">In **Solution Explorer**, right-click hello ToDoListAPI project, and then click **Publish**.</span></span>
2. <span data-ttu-id="6a7a8-257">Fare clic su **Pubblica**.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-257">Click **Publish**.</span></span>
   
    <span data-ttu-id="6a7a8-258">Visual Studio distribuisce il progetto hello e apre URL di base di un browser toohello app per le API.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-258">Visual Studio deploys hello project and opens a browser toohello API app's base URL.</span></span>
3. <span data-ttu-id="6a7a8-259">Browser hello Chiudi.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-259">Close hello browser.</span></span>

### <a name="test-hello-application"></a><span data-ttu-id="6a7a8-260">Testare l'applicazione hello</span><span class="sxs-lookup"><span data-stu-id="6a7a8-260">Test hello application</span></span>
1. <span data-ttu-id="6a7a8-261">Vai a URL toohello dell'app web hello, **mediante HTTPS, non HTTP**.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-261">Go toohello URL of hello web app, **using HTTPS, not HTTP**.</span></span>
2. <span data-ttu-id="6a7a8-262">Fare clic su hello **tooDo elenco** scheda.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-262">Click hello **tooDo List** tab.</span></span>
   
    <span data-ttu-id="6a7a8-263">Si è richiesta toolog in.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-263">You are prompted toolog in.</span></span>
3. <span data-ttu-id="6a7a8-264">Accedere con credenziali hello di un utente nel tenant di AAD.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-264">Log in with hello credentials of a user in your AAD tenant.</span></span>
4. <span data-ttu-id="6a7a8-265">Hello **tooDo elenco** verrà visualizzata la pagina.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-265">hello **tooDo List** page appears.</span></span>
   
   ![pagina di elenco tooDo](./media/app-service-api-dotnet-user-principal-auth/webappindex.png)
   
   <span data-ttu-id="6a7a8-267">Non vengono visualizzate attività perché fino a questo momento erano tutte per owner "*".</span><span class="sxs-lookup"><span data-stu-id="6a7a8-267">No to-do items are displayed because until now they have all been for owner "*".</span></span> <span data-ttu-id="6a7a8-268">Livello intermedio hello richiede ora gli elementi per l'utente connesso hello e non sono ancora stati creati.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-268">Now hello middle tier is requesting items for hello logged-on user, and none have been created yet.</span></span>
5. <span data-ttu-id="6a7a8-269">Aggiungere nuovo tooverify gli elementi di attività che sia in esecuzione un'applicazione hello.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-269">Add new to-do items tooverify that hello application is working.</span></span>
6. <span data-ttu-id="6a7a8-270">In un'altra finestra del browser toohello URL Swagger di interfaccia utente per app per le API di ToDoListDataAPI hello, fare clic su **ToDoList > ottenere**.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-270">In another browser window, go toohello Swagger UI URL for hello ToDoListDataAPI API app and click **ToDoList > Get**.</span></span> <span data-ttu-id="6a7a8-271">Immettere un asterisco per hello `owner` parametro e quindi fare clic su **provarlo**.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-271">Enter an asterisk for hello `owner` parameter, and then click **Try it out**.</span></span>
   
   <span data-ttu-id="6a7a8-272">risposta Hello indica che gli elementi di attività nuova hello hanno ID utente hello Azure AD effettivo nella proprietà proprietario hello.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-272">hello response shows that hello new to-do items have hello actual Azure AD user ID in hello Owner property.</span></span>
   
   ![ID proprietario nella risposta JSON](./media/app-service-api-dotnet-user-principal-auth/todolistapiauth.png)

## <a name="building-hello-projects-from-scratch"></a><span data-ttu-id="6a7a8-274">Compilazione di progetti hello da zero</span><span class="sxs-lookup"><span data-stu-id="6a7a8-274">Building hello projects from scratch</span></span>
<span data-ttu-id="6a7a8-275">progetti API Web Hello due sono stati creati tramite hello **Azure API App** progetto di modello e sostituendo i controller di valori predefinito hello con un controller elenco attività.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-275">hello two Web API projects were created by using hello **Azure API App** project template and replacing hello default Values controller with a ToDoList controller.</span></span> 

<span data-ttu-id="6a7a8-276">Per informazioni sulla creazione di un'applicazione a pagina singola AngularJS troppo con un back-end Web API 2, vedere [mani nel Lab: creare un'applicazione a pagina singola (SPA) con ASP.NET Web API and Angular.js](http://www.asp.net/web-api/overview/getting-started-with-aspnet-web-api/build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs).</span><span class="sxs-lookup"><span data-stu-id="6a7a8-276">For information about how too create an AngularJS single-page application with a Web API 2 back end, see  [Hands On Lab: Build a Single Page Application (SPA) with ASP.NET Web API and Angular.js](http://www.asp.net/web-api/overview/getting-started-with-aspnet-web-api/build-a-single-page-application-spa-with-aspnet-web-api-and-angularjs).</span></span> <span data-ttu-id="6a7a8-277">Per informazioni su come tooadd il codice di autenticazione di Azure AD, vedere hello seguenti risorse:</span><span class="sxs-lookup"><span data-stu-id="6a7a8-277">For information about how tooadd Azure AD authentication code, see hello following resources:</span></span>

* <span data-ttu-id="6a7a8-278">[Protezione di app AngularJS a singola pagina con Azure AD](../active-directory/active-directory-devquickstarts-angular.md).</span><span class="sxs-lookup"><span data-stu-id="6a7a8-278">[Securing AngularJS Single Page Apps with Azure AD](../active-directory/active-directory-devquickstarts-angular.md).</span></span>
* [<span data-ttu-id="6a7a8-279">Introduzione ad ADAL JS v1</span><span class="sxs-lookup"><span data-stu-id="6a7a8-279">Introducing ADAL JS v1</span></span>](http://www.cloudidentity.com/blog/2015/02/19/introducing-adal-js-v1/)

## <a name="troubleshooting"></a><span data-ttu-id="6a7a8-280">Risoluzione dei problemi</span><span class="sxs-lookup"><span data-stu-id="6a7a8-280">Troubleshooting</span></span>
[!INCLUDE [troubleshooting](../../includes/app-service-api-auth-troubleshooting.md)]

* <span data-ttu-id="6a7a8-281">Assicurarsi di non confondere ToDoListAPI (livello intermedio) e ToDoListDataAPI (livello dati).</span><span class="sxs-lookup"><span data-stu-id="6a7a8-281">Make sure that you don't confuse ToDoListAPI (middle tier) and ToDoListDataAPI (data tier).</span></span> <span data-ttu-id="6a7a8-282">Ad esempio, verificare di aver aggiunto l'autenticazione toohello intermedio app per le API, non il livello di dati hello.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-282">For example, verify that you added authentication toohello middle tier API app, not hello data tier.</span></span> 
* <span data-ttu-id="6a7a8-283">Assicurarsi che l'URL di app AngularJS origine codice riferimenti hello intermedio API hello (ToDoListAPI, non ToDoListDataAPI) e hello corretti ID client di Azure AD.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-283">Make sure that hello AngularJS source code references hello middle tier API app URL (ToDoListAPI, not ToDoListDataAPI)and hello correct Azure AD client ID.</span></span> 

## <a name="next-steps"></a><span data-ttu-id="6a7a8-284">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="6a7a8-284">Next steps</span></span>
<span data-ttu-id="6a7a8-285">In questa esercitazione è stato descritto come toouse l'autenticazione del servizio App per un'app per le API e come toocall hello app per le API tramite hello libreria ADAL JS.</span><span class="sxs-lookup"><span data-stu-id="6a7a8-285">In this tutorial you learned how toouse App Service authentication for an API app and how toocall hello API app by using hello ADAL JS library.</span></span> <span data-ttu-id="6a7a8-286">Nella prossima esercitazione hello si apprenderà come troppo[app tooyour API di accesso sicuro per gli scenari servizio-servizio](app-service-api-dotnet-service-principal-auth.md).</span><span class="sxs-lookup"><span data-stu-id="6a7a8-286">In hello next tutorial you'll learn how too[secure access tooyour API app for service-to-service scenarios](app-service-api-dotnet-service-principal-auth.md).</span></span>

