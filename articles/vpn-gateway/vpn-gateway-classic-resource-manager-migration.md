---
title: aaaVPN Gateway classico tooResource migrazione Manager | Documenti Microsoft
description: Questa pagina viene fornita una panoramica di hello VPN Gateway classico tooResource migrazione di gestione.
documentationcenter: na
services: vpn-gateway
author: amsriva
manager: rossort
editor: amsriva
ms.assetid: caa8eb19-825a-4031-8b49-18fbf3ebc04e
ms.service: vpn-gateway
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 05/02/2017
ms.author: amsriva
ms.openlocfilehash: c1d84bf5315224c5c8faac53d7957b496ed205ed
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/06/2017
---
# <a name="vpn-gateway-classic-tooresource-manager-migration"></a><span data-ttu-id="9293e-103">Gateway VPN classico tooResource migration Manager</span><span class="sxs-lookup"><span data-stu-id="9293e-103">VPN Gateway classic tooResource Manager migration</span></span>
<span data-ttu-id="9293e-104">Gateway VPN possono ora essere migrati da tooResource classico modello di distribuzione di gestione.</span><span class="sxs-lookup"><span data-stu-id="9293e-104">VPN Gateways can now be migrated from classic tooResource Manager deployment model.</span></span> <span data-ttu-id="9293e-105">Altre informazioni su [funzionalità e vantaggi di Azure Resource Manager](../azure-resource-manager/resource-group-overview.md).</span><span class="sxs-lookup"><span data-stu-id="9293e-105">You can read more about Azure Resource Manager [features and benefits](../azure-resource-manager/resource-group-overview.md).</span></span> <span data-ttu-id="9293e-106">In questo articolo è descrivere in dettaglio come toomigrate da distribuzioni classico toonewer Gestione risorse basato sul modello.</span><span class="sxs-lookup"><span data-stu-id="9293e-106">In this article, we  detail how toomigrate from classic deployments toonewer Resource Manager based model.</span></span> 

<span data-ttu-id="9293e-107">Gateway VPN vengono migrate come parte della migrazione di rete virtuale da classico tooResource Manager.</span><span class="sxs-lookup"><span data-stu-id="9293e-107">VPN Gateways are migrated as part of VNet migration from classic tooResource Manager.</span></span> <span data-ttu-id="9293e-108">Viene eseguita la migrazione di una rete virtuale alla volta.</span><span class="sxs-lookup"><span data-stu-id="9293e-108">This migration is done one VNet at a time.</span></span> <span data-ttu-id="9293e-109">Non è necessario aggiuntivo in termini di toomigration strumenti o i prerequisiti.</span><span class="sxs-lookup"><span data-stu-id="9293e-109">There is no additional requirement in terms of tools or prerequisites toomigration.</span></span> <span data-ttu-id="9293e-110">I passaggi della migrazione sono identici tooexisting la migrazione di rete virtuale e sono documentati in [pagina migrazione di risorse IaaS](../virtual-machines/windows/migration-classic-resource-manager-ps.md).</span><span class="sxs-lookup"><span data-stu-id="9293e-110">Migration steps are identical tooexisting VNet migration and are documented at [IaaS resources migration page](../virtual-machines/windows/migration-classic-resource-manager-ps.md).</span></span> <span data-ttu-id="9293e-111">È presente alcun tempo di inattività di percorso di dati durante la migrazione e pertanto i carichi di lavoro esistente continua a toofunction senza perdita di connettività locale durante la migrazione.</span><span class="sxs-lookup"><span data-stu-id="9293e-111">There is no data path downtime during migration and thus existing workloads would continue toofunction without loss of on-premises connectivity during migration.</span></span> <span data-ttu-id="9293e-112">indirizzo IP pubblico Hello associata al gateway VPN hello rimane invariato durante il processo di migrazione hello.</span><span class="sxs-lookup"><span data-stu-id="9293e-112">hello public IP address associated with hello VPN gateway does not change during hello migration process.</span></span> <span data-ttu-id="9293e-113">Ciò implica che non è necessario tooreconfigure il router locale dopo aver eseguita la migrazione di hello.</span><span class="sxs-lookup"><span data-stu-id="9293e-113">This implies that you will not need tooreconfigure your on-premises router once hello migration is completed.</span></span>  

<span data-ttu-id="9293e-114">il modello di Hello in Gestione risorse è diverso dal modello classico ed è composto da gateway di rete virtuale, gateway di rete locale e le risorse di connessione.</span><span class="sxs-lookup"><span data-stu-id="9293e-114">hello model in Resource Manager is different from classic model and is composed of virtual network gateways, local network gateways and connection resources.</span></span> <span data-ttu-id="9293e-115">Questi rappresentano i gateway VPN hello stesso, hello che rappresentano rispettivamente su spazio degli indirizzi locale e la connettività tra hello due siti locali.</span><span class="sxs-lookup"><span data-stu-id="9293e-115">These represent hello VPN gateway itself, hello local-site representing on premises address space and connectivity between hello two respectively.</span></span> <span data-ttu-id="9293e-116">Dopo il completamento della migrazione, i gateway non saranno disponibili nel modello classico e tutte le operazioni di gestione nei gateway di rete virtuale, nei gateway di rete locale e gli oggetti di connessione devono essere eseguite usando il modello Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="9293e-116">Once migration is completed your gateways would not be available in classic model and all management operations on virtual network gateways, local network gateways, and connection objects must be performed using Resource Manager model.</span></span>

## <a name="supported-scenarios"></a><span data-ttu-id="9293e-117">Scenari supportati</span><span class="sxs-lookup"><span data-stu-id="9293e-117">Supported scenarios</span></span>
<span data-ttu-id="9293e-118">Più comuni scenari di connettività VPN rientrano tooResource classico migrazione di gestione.</span><span class="sxs-lookup"><span data-stu-id="9293e-118">Most common VPN connectivity scenarios are covered by classic tooResource Manager migration.</span></span> <span data-ttu-id="9293e-119">gli scenari di Hello supportato includono:</span><span class="sxs-lookup"><span data-stu-id="9293e-119">hello supported scenarios include -</span></span>

* <span data-ttu-id="9293e-120">Connettività toosite punto</span><span class="sxs-lookup"><span data-stu-id="9293e-120">Point toosite connectivity</span></span>
* <span data-ttu-id="9293e-121">Connettività toosite con Gateway VPN da sito connesso sede locale tooon</span><span class="sxs-lookup"><span data-stu-id="9293e-121">Site toosite connectivity with VPN Gateway connected tooon premises location</span></span>
* <span data-ttu-id="9293e-122">Connettività di rete virtuale tooVNet tra due reti virtuali mediante gateway VPN</span><span class="sxs-lookup"><span data-stu-id="9293e-122">VNet tooVNet connectivity between two VNets using VPN gateways</span></span>
* <span data-ttu-id="9293e-123">Più reti virtuali connesse toosame nel percorso locale</span><span class="sxs-lookup"><span data-stu-id="9293e-123">Multiple VNets connected toosame on premises location</span></span>
* <span data-ttu-id="9293e-124">Connessione multisito</span><span class="sxs-lookup"><span data-stu-id="9293e-124">Multi-site connectivity</span></span>
* <span data-ttu-id="9293e-125">Reti virtuali abilitate per il tunneling forzato</span><span class="sxs-lookup"><span data-stu-id="9293e-125">Forced tunneling enabled VNets</span></span>

<span data-ttu-id="9293e-126">Gli scenari non supportati includono:</span><span class="sxs-lookup"><span data-stu-id="9293e-126">Scenarios which are not supported include -</span></span>  

* <span data-ttu-id="9293e-127">La rete virtuale con il gateway ExpressRoute e Gateway VPN al momento non è supportata.</span><span class="sxs-lookup"><span data-stu-id="9293e-127">VNet with both ExpressRoute Gateway and VPN Gateway is not currently supported.</span></span>
* <span data-ttu-id="9293e-128">Scenari di transito in cui le estensioni VM sono i server connessi tooon locale.</span><span class="sxs-lookup"><span data-stu-id="9293e-128">Transit scenarios where VM extensions are connected tooon-premises servers.</span></span> <span data-ttu-id="9293e-129">Le limitazioni relative alla connettività VPN di transito sono descritte di seguito.</span><span class="sxs-lookup"><span data-stu-id="9293e-129">Transit VPN connectivity limitations are detailed below.</span></span>

> [!NOTE]
> <span data-ttu-id="9293e-130">Convalida CIDR nel modello di gestione risorse è più rigida hello uno nel modello classico.</span><span class="sxs-lookup"><span data-stu-id="9293e-130">CIDR validation in Resource Manager model is more strict than hello one in classic model.</span></span> <span data-ttu-id="9293e-131">Prima della migrazione di garantire che gli intervalli di indirizzi classico specificati conformità formato CIDR toovalid prima di iniziare la migrazione di hello.</span><span class="sxs-lookup"><span data-stu-id="9293e-131">Before migrating ensure that classic address ranges given conform toovalid CIDR format before beginning hello migration.</span></span> <span data-ttu-id="9293e-132">È possibile convalidare CIDR usando qualsiasi validator CIDR comune.</span><span class="sxs-lookup"><span data-stu-id="9293e-132">CIDR can be validated using any common CIDR validators.</span></span> <span data-ttu-id="9293e-133">La rete virtuale o i siti locali con intervalli CIDR non validi durante la migrazione generano uno stato di errore.</span><span class="sxs-lookup"><span data-stu-id="9293e-133">VNet or local sites with invalid CIDR ranges when migrated would result in failed state.</span></span>
> 
> 

## <a name="vnet-toovnet-connectivity-migration"></a><span data-ttu-id="9293e-134">Migrazione di connettività di rete virtuale tooVNet</span><span class="sxs-lookup"><span data-stu-id="9293e-134">VNet tooVNet connectivity migration</span></span>
<span data-ttu-id="9293e-135">Connettività di rete virtuale tooVNet classica è stata ottenuta tramite la creazione di un sito locale rappresentazione hello connessi a reti virtuali.</span><span class="sxs-lookup"><span data-stu-id="9293e-135">VNet tooVNet connectivity in classic was achieved by creating a local site representation of hello connected VNet.</span></span> <span data-ttu-id="9293e-136">I clienti sono stati necessari toocreate due siti locali rappresentato hello due reti virtuali necessarie toobe connesse tra loro.</span><span class="sxs-lookup"><span data-stu-id="9293e-136">Customers were required toocreate two local sites which represented hello two VNets which needed toobe connected together.</span></span> <span data-ttu-id="9293e-137">Questi sono stati quindi connesso toohello corrispondente reti virtuali con connettività di tooestablish tunnel IPsec tra due reti virtuali hello.</span><span class="sxs-lookup"><span data-stu-id="9293e-137">These were then connected toohello corresponding VNets using IPsec tunnel tooestablish connectivity between hello two VNets.</span></span> <span data-ttu-id="9293e-138">Questo modello ha problemi di gestibilità in quanto le modifiche di intervallo di indirizzi in una rete virtuale devono anche essere mantenute nella rappresentazione di hello corrispondente sito locale.</span><span class="sxs-lookup"><span data-stu-id="9293e-138">This model has manageability challenges since any address range changes in one VNet must also be maintained in hello corresponding local site representation.</span></span> <span data-ttu-id="9293e-139">Nel modello Resource Manager questa soluzione non è più necessaria.</span><span class="sxs-lookup"><span data-stu-id="9293e-139">In Resource Manager model this workaround is no longer needed.</span></span> <span data-ttu-id="9293e-140">connessione Hello tra due reti virtuali possono essere direttamente hello ottenuta usando il tipo di connessione 'Vnet2Vnet' nella risorsa di connessione.</span><span class="sxs-lookup"><span data-stu-id="9293e-140">hello connection between hello two VNets can be directly achieved using 'Vnet2Vnet' connection type in Connection resource.</span></span> 

![Migrazione tooVNet schermata della rete virtuale.](./media/vpn-gateway-migration/migration1.png)

<span data-ttu-id="9293e-142">Durante la migrazione di rete virtuale è rilevare che hello entità connessa gateway VPN della rete virtuale toocurrent un'altra rete virtuale e verificare che al termine della migrazione di entrambe le reti virtuali, non sarà più visualizzato due siti locali che rappresenta hello altra rete virtuale.</span><span class="sxs-lookup"><span data-stu-id="9293e-142">During VNet migration we detect that hello connected entity toocurrent VNet's VPN gateway is another VNet and ensure that once migration of both VNets is completed, you would no longer see two local sites representing hello other VNet.</span></span> <span data-ttu-id="9293e-143">il modello classico di Hello di due gateway VPN, i due siti locali e due connessioni tra di essi è trasformato tooResource modello di gestione con due gateway VPN e due connessioni di tipo Vnet2Vnet.</span><span class="sxs-lookup"><span data-stu-id="9293e-143">hello classic model of two VPN gateways, two local sites and two connections between them is transformed tooResource Manager model with two VPN gateways and two connections of type Vnet2Vnet.</span></span>

## <a name="transit-vpn-connectivity"></a><span data-ttu-id="9293e-144">Connettività VPN di transito</span><span class="sxs-lookup"><span data-stu-id="9293e-144">Transit VPN connectivity</span></span>
<span data-ttu-id="9293e-145">È possibile configurare un gateway VPN in una topologia in modo che la connettività locale per una rete virtuale viene ottenuta tramite la connessione di rete virtuale che è direttamente connessi tooon locale tooanother.</span><span class="sxs-lookup"><span data-stu-id="9293e-145">You can configure VPN gateways in a topology such that on-premises connectivity for a VNet is achieved by connecting tooanother VNet that is directly connected tooon-premises.</span></span> <span data-ttu-id="9293e-146">Si tratta di transito connettività VPN in cui le istanze nella rete virtuale prima sono risorse connessi tooon locale tramite gateway VPN toohello di transito nella rete virtuale connessa che è direttamente connessi tooon locale.</span><span class="sxs-lookup"><span data-stu-id="9293e-146">This is transit VPN connectivity where instances in first VNet are connected tooon-premises resources via transit toohello VPN gateway in connected VNet that is directly connected tooon-premises.</span></span> <span data-ttu-id="9293e-147">tooachieve questa configurazione nel modello di distribuzione classica, occorre toocreate un sito locale che dispone di aggregati di prefissi che rappresenta entrambi spazio indirizzo hello connesso in locale e di rete virtuale.</span><span class="sxs-lookup"><span data-stu-id="9293e-147">tooachieve this configuration in classic deployment model, you would need toocreate a local site which has aggregated prefixes representing both hello connected VNet and on-premises address space.</span></span> <span data-ttu-id="9293e-148">Questo sito locale representational è connettività di transito connesso toohello tooachieve di rete virtuale.</span><span class="sxs-lookup"><span data-stu-id="9293e-148">This representational local site is then connected toohello VNet tooachieve transit connectivity.</span></span> <span data-ttu-id="9293e-149">Il modello classico presenta problemi di gestibilità simili poiché qualsiasi modifica intervallo di indirizzi locali debba essere gestito anche nel sito locale di hello che rappresenta aggregazione hello di rete virtuale e in locale.</span><span class="sxs-lookup"><span data-stu-id="9293e-149">This classic model also has similar manageability challenges since any change in on-premises address range must also be maintained on hello local site representing hello aggregate of VNet and on-premises.</span></span> <span data-ttu-id="9293e-150">L'introduzione del supporto BGP nel gateway di gestione di risorse supportati semplifica la gestibilità poiché hello gateway connessi possono apprendono le route da in locale senza tooprefixes modifica manuale.</span><span class="sxs-lookup"><span data-stu-id="9293e-150">Introduction of BGP support in Resource Manager supported gateways simplifies manageability since hello connected gateways can learn routes from on premises without manual modification tooprefixes.</span></span>

![Screenshot dello scenario di routing di transito.](./media/vpn-gateway-migration/migration2.png)

<span data-ttu-id="9293e-152">Poiché la connettività di rete virtuale tooVNet trasformare senza siti locali, uno scenario di transito hello perde la connettività locale per la rete virtuale che è indirettamente connessi tooon locale.</span><span class="sxs-lookup"><span data-stu-id="9293e-152">Since we transform VNet tooVNet connectivity without requiring local sites, hello transit scenario loses on-premises connectivity for VNet that is indirectly connected tooon-premises.</span></span> <span data-ttu-id="9293e-153">Hello perdita di connettività può essere ridotti in hello seguenti due modi, dopo aver completata la migrazione:</span><span class="sxs-lookup"><span data-stu-id="9293e-153">hello loss of connectivity can be mitigated in hello following two ways, after migration is completed -</span></span> 

* <span data-ttu-id="9293e-154">Abilitare BGP nel gateway VPN che sono connesse tra loro e tooon locale.</span><span class="sxs-lookup"><span data-stu-id="9293e-154">Enable BGP on VPN gateways that are connected together and tooon-premises.</span></span> <span data-ttu-id="9293e-155">L'abilitazione del protocollo BGP ripristina la connettività senza apportare altre modifiche di configurazione poiché le route vengono apprese e annunciate tra i gateway di rete virtuale.</span><span class="sxs-lookup"><span data-stu-id="9293e-155">Enabling BGP restores connectivity without any other configuration change since routes are learned and advertised between VNet gateways.</span></span> <span data-ttu-id="9293e-156">Si noti che l'opzione BGP è disponibile solo per le unità SKU standard e versioni successive.</span><span class="sxs-lookup"><span data-stu-id="9293e-156">Note that BGP option is only available on Standard and higher SKUs.</span></span>
* <span data-ttu-id="9293e-157">Stabilire una connessione esplicita dal gateway di rete locale a toohello interessati rete virtuale che rappresenta il percorso locale.</span><span class="sxs-lookup"><span data-stu-id="9293e-157">Establish an explicit connection from affected VNet toohello local network gateway representing on-premises location.</span></span> <span data-ttu-id="9293e-158">Potrebbe anche richiedere la modifica di configurazione in hello locale router toocreate e configurare tunnel IPsec hello.</span><span class="sxs-lookup"><span data-stu-id="9293e-158">This would also require changing configuration on hello on-premises router toocreate and configure hello IPsec tunnel.</span></span>

## <a name="next-steps"></a><span data-ttu-id="9293e-159">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="9293e-159">Next steps</span></span>
<span data-ttu-id="9293e-160">Dopo avere imparare a supporto della migrazione gateway VPN, andare troppo[piattaforma supportata la migrazione di risorse IaaS tooResource classico Manager](../virtual-machines/windows/migration-classic-resource-manager-ps.md) tooget avviato.</span><span class="sxs-lookup"><span data-stu-id="9293e-160">After learning about VPN gateway migration support, go too[platform-supported migration of IaaS resources from classic tooResource Manager](../virtual-machines/windows/migration-classic-resource-manager-ps.md) tooget started.</span></span>

