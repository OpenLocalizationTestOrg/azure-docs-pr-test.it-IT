---
title: Come controllare il traffico in ingresso a un ambiente del servizio app
description: Informazioni su come configurare le regole di sicurezza di rete per controllare il traffico in ingresso a un ambiente del servizio app.
services: app-service
documentationcenter: 
author: ccompy
manager: erikre
editor: 
ms.assetid: 4cc82439-8791-48a4-9485-de6d8e1d1a08
ms.service: app-service
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 01/11/2017
ms.author: stefsch
ms.openlocfilehash: ee0a2248a1cd5d76f87b280de05410b94f96c8af
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 07/11/2017
---
# <a name="how-to-control-inbound-traffic-to-an-app-service-environment"></a><span data-ttu-id="069ae-103">Come controllare il traffico in ingresso a un ambiente del servizio app</span><span class="sxs-lookup"><span data-stu-id="069ae-103">How To Control Inbound Traffic to an App Service Environment</span></span>
## <a name="overview"></a><span data-ttu-id="069ae-104">Panoramica</span><span class="sxs-lookup"><span data-stu-id="069ae-104">Overview</span></span>
<span data-ttu-id="069ae-105">Un ambiente del servizio app può essere creato **o** in una rete virtuale di Azure Resource Manager **o** in una [rete virtuale][virtualnetwork] del modello di distribuzione classica.</span><span class="sxs-lookup"><span data-stu-id="069ae-105">An App Service Environment can be created in **either** an Azure Resource Manager virtual network, **or** a classic deployment model [virtual network][virtualnetwork].</span></span>  <span data-ttu-id="069ae-106">È possibile definire una nuova rete virtuale e una nuova subnet al momento della creazione di un ambiente del servizio app.</span><span class="sxs-lookup"><span data-stu-id="069ae-106">A new virtual network and new subnet can be defined at the time an App Service Environment is created.</span></span>  <span data-ttu-id="069ae-107">In alternativa, è possibile creare un ambiente del servizio app in una rete virtuale e in una subnet preesistenti.</span><span class="sxs-lookup"><span data-stu-id="069ae-107">Alternatively, an App Service Environment can be created in a pre-existing virtual network and pre-existing subnet.</span></span>  <span data-ttu-id="069ae-108">Con una modifica apportata a giugno 2016, gli ambienti del servizio app possono essere distribuiti nelle reti virtuali che usano intervalli di indirizzi pubblici o spazi di indirizzi RFC1918, ovvero</span><span class="sxs-lookup"><span data-stu-id="069ae-108">With a change made in June 2016, ASEs can also be deployed into virtual networks that use either public address ranges, or RFC1918 address spaces (i.e.</span></span> <span data-ttu-id="069ae-109">indirizzi privati.</span><span class="sxs-lookup"><span data-stu-id="069ae-109">private addresses).</span></span>  <span data-ttu-id="069ae-110">Per altre informazioni su come creare un ambiente del servizio app, vedere [Come creare un ambiente del servizio app][HowToCreateAnAppServiceEnvironment].</span><span class="sxs-lookup"><span data-stu-id="069ae-110">For more details on creating an App Service Environment see [How To Create an App Service Environment][HowToCreateAnAppServiceEnvironment].</span></span>

<span data-ttu-id="069ae-111">È sempre necessario creare un ambiente del servizio app all'interno di una subnet perché la subnet fornisce un limite di rete che può essere usato per bloccare il traffico in ingresso proveniente da dispositivi e servizi upstream, in modo che il traffico HTTP e HTTPS sia accettato solo da indirizzi IP upstream specifici.</span><span class="sxs-lookup"><span data-stu-id="069ae-111">An App Service Environment must always be created within a subnet because a subnet provides a network boundary which can be used to lock down inbound traffic behind upstream devices and services such that HTTP and HTTPS traffic is only accepted from specific upstream IP addresses.</span></span>

<span data-ttu-id="069ae-112">Il traffico in ingresso e in uscita diretto verso e proveniente da una subnet è controllato tramite un [gruppo di sicurezza di rete][NetworkSecurityGroups].</span><span class="sxs-lookup"><span data-stu-id="069ae-112">Inbound and outbound network traffic on a subnet is controlled using a [network security group][NetworkSecurityGroups].</span></span> <span data-ttu-id="069ae-113">Per controllare il traffico in ingresso è necessario creare regole di sicurezza di rete in un gruppo di sicurezza di rete, quindi assegnare al gruppo di sicurezza di rete la subnet contenente l'ambiente del servizio app.</span><span class="sxs-lookup"><span data-stu-id="069ae-113">Controlling inbound traffic requires creating network security rules in a network security group, and then assigning the network security group the subnet containing the App Service Environment.</span></span>

<span data-ttu-id="069ae-114">Dopo aver assegnato un gruppo di sicurezza di rete a una subnet, il traffico in ingresso alle app nell'ambiente del servizio app è consentito/bloccato in base alle regole di autorizzazione consentita o negata definite nel gruppo di sicurezza di rete.</span><span class="sxs-lookup"><span data-stu-id="069ae-114">Once a network security group is assigned to a subnet, inbound traffic to apps in the App Service Environment is allowed/blocked based on the allow and deny rules defined in the network security group.</span></span>

[!INCLUDE [app-service-web-to-api-and-mobile](../../includes/app-service-web-to-api-and-mobile.md)]

## <a name="inbound-network-ports-used-in-an-app-service-environment"></a><span data-ttu-id="069ae-115">Porte di rete in ingresso usate in un ambiente del servizio app</span><span class="sxs-lookup"><span data-stu-id="069ae-115">Inbound Network Ports Used in an App Service Environment</span></span>
<span data-ttu-id="069ae-116">Prima di bloccare il traffico di rete in ingresso tramite un gruppo di sicurezza di rete, è importante conoscere quali sono le porte di rete obbligatorie e facoltative usate da un ambiente del servizio app.</span><span class="sxs-lookup"><span data-stu-id="069ae-116">Before locking down inbound network traffic with a network security group, it is important to know the set of required and optional network ports used by an App Service Environment.</span></span>  <span data-ttu-id="069ae-117">Il blocco accidentale del traffico ad alcune porte può comportare una perdita di funzionalità nell'ambiente del servizio app.</span><span class="sxs-lookup"><span data-stu-id="069ae-117">Accidentally closing off traffic to some ports can result in loss of functionality in an App Service Environment.</span></span>

<span data-ttu-id="069ae-118">Di seguito è riportato un elenco delle porte usate da un ambiente del servizio app.</span><span class="sxs-lookup"><span data-stu-id="069ae-118">The following is a list of ports used by an App Service Environment.</span></span> <span data-ttu-id="069ae-119">Tutte le porte sono di tipo **TCP**, se non indicato diversamente in modo chiaro:</span><span class="sxs-lookup"><span data-stu-id="069ae-119">All ports are **TCP**, unless otherwise clearly noted:</span></span>

* <span data-ttu-id="069ae-120">454: **porta obbligatoria** usata dall'infrastruttura di Azure per la gestione e la manutenzione degli ambienti del servizio app tramite SSL.</span><span class="sxs-lookup"><span data-stu-id="069ae-120">454:  **Required port** used by Azure infrastructure for managing and maintaining App Service Environments via SSL.</span></span>  <span data-ttu-id="069ae-121">Non bloccare il traffico indirizzato a questa porta.</span><span class="sxs-lookup"><span data-stu-id="069ae-121">Do not block traffic to this port.</span></span>  <span data-ttu-id="069ae-122">Questa porta è sempre associata all'indirizzo VIP pubblico di un ambiente del servizio app.</span><span class="sxs-lookup"><span data-stu-id="069ae-122">This port is always bound to the public VIP of an ASE.</span></span>
* <span data-ttu-id="069ae-123">455: **porta obbligatoria** usata dall'infrastruttura di Azure per la gestione e la manutenzione degli ambienti del servizio app tramite SSL.</span><span class="sxs-lookup"><span data-stu-id="069ae-123">455:  **Required port** used by Azure infrastructure for managing and maintaining App Service Environments via SSL.</span></span>  <span data-ttu-id="069ae-124">Non bloccare il traffico indirizzato a questa porta.</span><span class="sxs-lookup"><span data-stu-id="069ae-124">Do not block traffic to this port.</span></span>  <span data-ttu-id="069ae-125">Questa porta è sempre associata all'indirizzo VIP pubblico di un ambiente del servizio app.</span><span class="sxs-lookup"><span data-stu-id="069ae-125">This port is always bound to the public VIP of an ASE.</span></span>
* <span data-ttu-id="069ae-126">80: porta predefinita per il traffico HTTP in ingresso alle app in esecuzione nei piani di servizio app in un ambiente del servizio app.</span><span class="sxs-lookup"><span data-stu-id="069ae-126">80:  Default port for inbound HTTP traffic to apps running in App Service Plans in an App Service Environment.</span></span>  <span data-ttu-id="069ae-127">In un ambiente del servizio app abilitato al bilanciamento del carico interno, questa porta è associata all'indirizzo ILB dell'ambiente.</span><span class="sxs-lookup"><span data-stu-id="069ae-127">On an ILB-enabled ASE, this port is bound to the ILB address of the ASE.</span></span>
* <span data-ttu-id="069ae-128">443: porta predefinita per il traffico SSL in ingresso alle app in esecuzione nei piani del servizio app in un ambiente del servizio app.</span><span class="sxs-lookup"><span data-stu-id="069ae-128">443: Default port for inbound SSL traffic to apps running in App Service Plans in an App Service Environment.</span></span>  <span data-ttu-id="069ae-129">In un ambiente del servizio app abilitato al bilanciamento del carico interno, questa porta è associata all'indirizzo ILB dell'ambiente.</span><span class="sxs-lookup"><span data-stu-id="069ae-129">On an ILB-enabled ASE, this port is bound to the ILB address of the ASE.</span></span>
* <span data-ttu-id="069ae-130">21: canale di controllo per il servizio FTP.</span><span class="sxs-lookup"><span data-stu-id="069ae-130">21:  Control channel for FTP.</span></span>  <span data-ttu-id="069ae-131">Questa porta può essere bloccata, se non si usa un servizio FTP.</span><span class="sxs-lookup"><span data-stu-id="069ae-131">This port can be safely blocked if FTP is not being used.</span></span>  <span data-ttu-id="069ae-132">In un ambiente del servizio app abilitato al bilanciamento del carico interno, questa porta è associata all'indirizzo ILB per un ambiente.</span><span class="sxs-lookup"><span data-stu-id="069ae-132">On an ILB-enabled ASE, this port can be bound to the ILB address for an ASE.</span></span>
* <span data-ttu-id="069ae-133">990: canale di controllo per il servizio FTPS.</span><span class="sxs-lookup"><span data-stu-id="069ae-133">990:  Control channel for FTPS.</span></span>  <span data-ttu-id="069ae-134">Questa porta può essere bloccata, se non si usa un servizio FTPS.</span><span class="sxs-lookup"><span data-stu-id="069ae-134">This port can be safely blocked if FTPS is not being used.</span></span>  <span data-ttu-id="069ae-135">In un ambiente del servizio app abilitato al bilanciamento del carico interno, questa porta è associata all'indirizzo ILB per un ambiente.</span><span class="sxs-lookup"><span data-stu-id="069ae-135">On an ILB-enabled ASE, this port can be bound to the ILB address for an ASE.</span></span>
* <span data-ttu-id="069ae-136">10001-10020: canali di dati per il servizio FTP.</span><span class="sxs-lookup"><span data-stu-id="069ae-136">10001-10020: Data channels for FTP.</span></span>  <span data-ttu-id="069ae-137">Come per il canale di controllo, queste porte possono essere bloccate se non si usa il servizio FTP.</span><span class="sxs-lookup"><span data-stu-id="069ae-137">As with the control channel, these ports can be safely blocked if FTP is not being used.</span></span>  <span data-ttu-id="069ae-138">In un ambiente del servizio app abilitato al bilanciamento del carico interno, questa porta può essere associata all'indirizzo ILB dell'ambiente.</span><span class="sxs-lookup"><span data-stu-id="069ae-138">On an ILB-enabled ASE, this port can be bound to the ASE's ILB address.</span></span>
* <span data-ttu-id="069ae-139">4016: porta usata per il debug remoto con Visual Studio 2012.</span><span class="sxs-lookup"><span data-stu-id="069ae-139">4016: Used for remote debugging with Visual Studio 2012.</span></span>  <span data-ttu-id="069ae-140">Questa porta può essere bloccata, se non si usa questa funzionalità.</span><span class="sxs-lookup"><span data-stu-id="069ae-140">This port can be safely blocked if the feature is not being used.</span></span>  <span data-ttu-id="069ae-141">In un ambiente del servizio app abilitato al bilanciamento del carico interno, questa porta è associata all'indirizzo ILB dell'ambiente.</span><span class="sxs-lookup"><span data-stu-id="069ae-141">On an ILB-enabled ASE, this port is bound to the ILB address of the ASE.</span></span>
* <span data-ttu-id="069ae-142">4018: porta usata per il debug remoto con Visual Studio 2013.</span><span class="sxs-lookup"><span data-stu-id="069ae-142">4018: Used for remote debugging with Visual Studio 2013.</span></span>  <span data-ttu-id="069ae-143">Questa porta può essere bloccata, se non si usa questa funzionalità.</span><span class="sxs-lookup"><span data-stu-id="069ae-143">This port can be safely blocked if the feature is not being used.</span></span>  <span data-ttu-id="069ae-144">In un ambiente del servizio app abilitato al bilanciamento del carico interno, questa porta è associata all'indirizzo ILB dell'ambiente.</span><span class="sxs-lookup"><span data-stu-id="069ae-144">On an ILB-enabled ASE, this port is bound to the ILB address of the ASE.</span></span>
* <span data-ttu-id="069ae-145">4020: porta usata per il debug remoto con Visual Studio 2015.</span><span class="sxs-lookup"><span data-stu-id="069ae-145">4020: Used for remote debugging with Visual Studio 2015.</span></span>  <span data-ttu-id="069ae-146">Questa porta può essere bloccata, se non si usa questa funzionalità.</span><span class="sxs-lookup"><span data-stu-id="069ae-146">This port can be safely blocked if the feature is not being used.</span></span>  <span data-ttu-id="069ae-147">In un ambiente del servizio app abilitato al bilanciamento del carico interno, questa porta è associata all'indirizzo ILB dell'ambiente.</span><span class="sxs-lookup"><span data-stu-id="069ae-147">On an ILB-enabled ASE, this port is bound to the ILB address of the ASE.</span></span>

## <a name="outbound-connectivity-and-dns-requirements"></a><span data-ttu-id="069ae-148">Requisiti per DNS e connettività in uscita</span><span class="sxs-lookup"><span data-stu-id="069ae-148">Outbound Connectivity and DNS Requirements</span></span>
<span data-ttu-id="069ae-149">Per un corretto funzionamento dell'ambiente del servizio app, è necessario l'accesso in uscita ai vari endpoint.</span><span class="sxs-lookup"><span data-stu-id="069ae-149">For an App Service Environment to function properly, it also requires outbound access to various endpoints.</span></span> <span data-ttu-id="069ae-150">Un elenco completo degli endpoint esterni usati da un ambiente del servizio app è disponibile nella sezione "Requisiti della connettività di rete" dell'articolo [Configurazione di rete per ExpressRoute](app-service-app-service-environment-network-configuration-expressroute.md#required-network-connectivity) .</span><span class="sxs-lookup"><span data-stu-id="069ae-150">A full list of the external endpoints used by an ASE is in the "Required Network Connectivity" section of the [Network Configuration for ExpressRoute](app-service-app-service-environment-network-configuration-expressroute.md#required-network-connectivity) article.</span></span>

<span data-ttu-id="069ae-151">Gli ambienti del servizio app richiedono un'infrastruttura DNS valida configurata per la rete virtuale.</span><span class="sxs-lookup"><span data-stu-id="069ae-151">App Service Environments require a valid DNS infrastructure configured for the virtual network.</span></span>  <span data-ttu-id="069ae-152">Se per qualsiasi motivo viene modificata la configurazione DNS dopo aver creato un ambiente di servizio app, gli sviluppatori possono forzare un ambiente di servizio app per selezionare la nuova configurazione del DNS.</span><span class="sxs-lookup"><span data-stu-id="069ae-152">If for any reason the DNS configuration is changed after an App Service Environment has been created, developers can force an App Service Environment to pick up the new DNS configuration.</span></span>  <span data-ttu-id="069ae-153">L'attivazione di un riavvio di ambiente in sequenza con l'icona "Riavvia" disponibile nella parte superiore del pannello di gestione dell'ambiente del servizio app nel [portale di Azure][NewPortal] farà sì che l'ambiente selezioni la nuova configurazione del DNS.</span><span class="sxs-lookup"><span data-stu-id="069ae-153">Triggering a rolling environment reboot using the "Restart" icon located at the top of the App Service Environment management blade in the [Azure portal][NewPortal] will cause the environment to pick up the new DNS configuration.</span></span>

<span data-ttu-id="069ae-154">È anche consigliabile che i server DNS personalizzati nella rete virtuale vengano configurati prima di creare un ambiente del servizio app.</span><span class="sxs-lookup"><span data-stu-id="069ae-154">It is also recommended that any custom DNS servers on the vnet be setup ahead of time prior to creating an App Service Environment.</span></span>  <span data-ttu-id="069ae-155">Se la configurazione DNS della rete virtuale viene modificata durante la creazione di un ambiente del servizio app, il processo di creazione dell'ambiente del servizio app avrà esito negativo.</span><span class="sxs-lookup"><span data-stu-id="069ae-155">If a virtual network's DNS configuration is changed while an App Service Environment is being created, that will result in the App Service Environment creation process failing.</span></span>  <span data-ttu-id="069ae-156">In modo analogo, se esiste un server DNS personalizzato nell’altra estremità di un gateway VPN e il server DNS è irraggiungibile o non disponibile, anche il processo di creazione dell’ambiente del servizio App avrà esito negativo.</span><span class="sxs-lookup"><span data-stu-id="069ae-156">In a similar vein, if a custom DNS server exists on the other end of a VPN gateway, and the DNS server is unreachable or unavailable, the App Service Environment creation process will also fail.</span></span>

## <a name="creating-a-network-security-group"></a><span data-ttu-id="069ae-157">Creazione di un gruppo di sicurezza di rete</span><span class="sxs-lookup"><span data-stu-id="069ae-157">Creating a Network Security Group</span></span>
<span data-ttu-id="069ae-158">Per i dettagli sul funzionamento dei gruppi di sicurezza di rete, vedere le [informazioni][NetworkSecurityGroups] seguenti.</span><span class="sxs-lookup"><span data-stu-id="069ae-158">For full details on how network security groups work see the following [information][NetworkSecurityGroups].</span></span>  <span data-ttu-id="069ae-159">Di seguito sono riportate le informazioni principali relative ai gruppi di sicurezza di rete, con particolare attenzione alla configurazione e all'applicazione di un gruppo di sicurezza di rete a una subnet contenente un ambiente del servizio app.</span><span class="sxs-lookup"><span data-stu-id="069ae-159">The Azure Service Management example below touches on highlights of network security groups, with a focus on configuring and applying a network security group to a subnet that contains an App Service Environment.</span></span>

<span data-ttu-id="069ae-160">**Nota:** i gruppi di sicurezza di rete possono essere configurati in modalità grafica con il [portale di Azure](https://portal.azure.com) oppure tramite Azure PowerShell.</span><span class="sxs-lookup"><span data-stu-id="069ae-160">**Note:** Network security groups can be configured graphically using the [Azure Portal](https://portal.azure.com) or through Azure PowerShell.</span></span>

<span data-ttu-id="069ae-161">I gruppi di sicurezza di rete vengono inizialmente creati come un'entità autonoma associata a una sottoscrizione.</span><span class="sxs-lookup"><span data-stu-id="069ae-161">Network security groups are first created as a standalone entity associated with a subscription.</span></span> <span data-ttu-id="069ae-162">Poiché i gruppi di sicurezza di rete vengono creati in un'area di Azure, assicurarsi di creare il gruppo di sicurezza di rete nella stessa area dell'ambiente del servizio app.</span><span class="sxs-lookup"><span data-stu-id="069ae-162">Since network security groups are created in an Azure region, ensure that the network security group is created in the same region as the App Service Environment.</span></span>

<span data-ttu-id="069ae-163">Di seguito è illustrata la procedura di creazione di un gruppo di sicurezza di rete:</span><span class="sxs-lookup"><span data-stu-id="069ae-163">The following demonstrates creating a network security group:</span></span>

    New-AzureNetworkSecurityGroup -Name "testNSGexample" -Location "South Central US" -Label "Example network security group for an app service environment"

<span data-ttu-id="069ae-164">Dopo aver creato il gruppo di sicurezza di rete, vengono aggiunte una o più regole di sicurezza di rete.</span><span class="sxs-lookup"><span data-stu-id="069ae-164">Once a network security group is created, one or more network security rules are added to it.</span></span>  <span data-ttu-id="069ae-165">Poiché il set di regole può variare nel tempo, è consigliabile lasciare spazi vuoti nello schema di numerazione usato per le priorità delle regole al fine di agevolare l'inserimento di regole aggiuntive in futuro.</span><span class="sxs-lookup"><span data-stu-id="069ae-165">Since the set of rules may change over time, it is recommended to space out the numbering scheme used for rule priorities to make it easy to insert additional rules over time.</span></span>

<span data-ttu-id="069ae-166">L'esempio seguente illustra una regola che concede l'accesso in modo esplicito alle porte necessarie per la gestione e la manutenzione dell'ambiente del servizio app da parte dell'infrastruttura di Azure.</span><span class="sxs-lookup"><span data-stu-id="069ae-166">The example below shows a rule that explicitly grants access to the management ports needed by the Azure infrastructure to manage and maintain an App Service Environment.</span></span>  <span data-ttu-id="069ae-167">Si noti che tutto il traffico di gestione transita attraverso il protocollo SSL ed è protetto tramite certificati client, quindi anche se le porte sono aperte risultano inaccessibili a entità diverse dall'infrastruttura di gestione di Azure.</span><span class="sxs-lookup"><span data-stu-id="069ae-167">Note that all management traffic flows over SSL and is secured by client certificates, so even though the ports are opened they are inaccessible by any entity other than Azure management infrastructure.</span></span>

    Get-AzureNetworkSecurityGroup -Name "testNSGexample" | Set-AzureNetworkSecurityRule -Name "ALLOW AzureMngmt" -Type Inbound -Priority 100 -Action Allow -SourceAddressPrefix 'INTERNET'  -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '454-455' -Protocol TCP


<span data-ttu-id="069ae-168">Quando si blocca l'accesso alle porte 80 e 443 per "nascondere" un ambiente del servizio app oltre i dispositivi o servizi upstream, è necessario conoscere l'indirizzo IP upstream.</span><span class="sxs-lookup"><span data-stu-id="069ae-168">When locking down access to port 80 and 443 to "hide" an App Service Environment behind upstream devices or services, you will need to know the upstream IP address.</span></span>  <span data-ttu-id="069ae-169">Se, ad esempio, si un firewall per applicazioni Web, il firewall disporrà di uno o più indirizzi IP che userà per l'inoltro del traffico a un ambiente del servizio app downstream.</span><span class="sxs-lookup"><span data-stu-id="069ae-169">For example, if you are using a web application firewall (WAF), the WAF will have its own IP address (or addresses) which it uses when proxying traffic to a downstream App Service Environment.</span></span>  <span data-ttu-id="069ae-170">Sarà necessario usare questo indirizzo IP nel parametro *SourceAddressPrefix* di una regola di sicurezza di rete.</span><span class="sxs-lookup"><span data-stu-id="069ae-170">You will need to use this IP address in the *SourceAddressPrefix* parameter of a network security rule.</span></span>

<span data-ttu-id="069ae-171">Nell'esempio seguente, il traffico in ingresso da un indirizzo IP upstream specifico è consentito in modo esplicito.</span><span class="sxs-lookup"><span data-stu-id="069ae-171">In the example below, inbound traffic from a specific upstream IP address is explicitly allowed.</span></span>  <span data-ttu-id="069ae-172">L'indirizzo *1.2.3.4* è usato come segnaposto per l'indirizzo IP di un firewall per applicazioni Web upstream.</span><span class="sxs-lookup"><span data-stu-id="069ae-172">The address *1.2.3.4* is used as a placeholder for the IP address of an upstream WAF.</span></span>  <span data-ttu-id="069ae-173">Modificare il valore in modo che corrisponda all'indirizzo usato dal dispositivo o dal servizio upstream corrente.</span><span class="sxs-lookup"><span data-stu-id="069ae-173">Change the value to match the address used by your upstream device or service.</span></span>

    Get-AzureNetworkSecurityGroup -Name "testNSGexample" | Set-AzureNetworkSecurityRule -Name "RESTRICT HTTP" -Type Inbound -Priority 200 -Action Allow -SourceAddressPrefix '1.2.3.4/32'  -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '80' -Protocol TCP
    Get-AzureNetworkSecurityGroup -Name "testNSGexample" | Set-AzureNetworkSecurityRule -Name "RESTRICT HTTPS" -Type Inbound -Priority 300 -Action Allow -SourceAddressPrefix '1.2.3.4/32'  -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '443' -Protocol TCP

<span data-ttu-id="069ae-174">Se si desidera usufruire del supporto per FTP, è possibile usare le regole seguenti come un modello per concedere l'accesso alla porta di controllo FTP e alle porte dei canali di dati.</span><span class="sxs-lookup"><span data-stu-id="069ae-174">If FTP support is desired, the following rules can be used as a template to grant access to the FTP control port and data channel ports.</span></span>  <span data-ttu-id="069ae-175">Poiché FTP è un protocollo con stato, potrebbe non essere possibile instradare il traffico FTP attraverso un dispositivo proxy o un firewall HTTP/HTTPS tradizionale.</span><span class="sxs-lookup"><span data-stu-id="069ae-175">Since FTP is a stateful protocol, you may not be able to route FTP traffic through a traditional HTTP/HTTPS firewall or proxy device.</span></span>  <span data-ttu-id="069ae-176">In questo caso sarà necessario impostare *SourceAddressPrefix* su un valore diverso, ad esempio l'intervallo di indirizzi IP per i computer dedicati allo sviluppo o alla distribuzione in cui sono in esecuzione i client FTP.</span><span class="sxs-lookup"><span data-stu-id="069ae-176">In this case you will need to set the *SourceAddressPrefix* to a different value - for example the IP address range of developer or deployment machines on which FTP clients are running.</span></span> 

    Get-AzureNetworkSecurityGroup -Name "testNSGexample" | Set-AzureNetworkSecurityRule -Name "RESTRICT FTPCtrl" -Type Inbound -Priority 400 -Action Allow -SourceAddressPrefix '1.2.3.4/32'  -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '21' -Protocol TCP
    Get-AzureNetworkSecurityGroup -Name "testNSGexample" | Set-AzureNetworkSecurityRule -Name "RESTRICT FTPDataRange" -Type Inbound -Priority 500 -Action Allow -SourceAddressPrefix '1.2.3.4/32'  -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '10001-10020' -Protocol TCP

<span data-ttu-id="069ae-177">(**Nota:** l'intervallo delle porte dei canali di dati per FTP potrebbero variare durante il periodo di anteprima del servizio.</span><span class="sxs-lookup"><span data-stu-id="069ae-177">(**Note:**  the data channel port range may change during the preview period.)</span></span>

<span data-ttu-id="069ae-178">Se si usa la funzionalità di debug remoto con Visual Studio, usare le regole seguenti per concedere l'accesso.</span><span class="sxs-lookup"><span data-stu-id="069ae-178">If remote debugging with Visual Studio is used, the following rules demonstrate how to grant access.</span></span>  <span data-ttu-id="069ae-179">Esiste una regola separata per ogni versione supportata di Visual Studio, dal momento che ogni versione usa una porta diversa per il debug remoto.</span><span class="sxs-lookup"><span data-stu-id="069ae-179">There is a separate rule for each supported version of Visual Studio since each version uses a different port for remote debugging.</span></span>  <span data-ttu-id="069ae-180">Come per l'accesso FTP, il traffico di debug remoto potrebbe non transitare correttamente attraverso un dispositivo proxy o un firewall per applicazioni Web tradizionale.</span><span class="sxs-lookup"><span data-stu-id="069ae-180">As with FTP access, remote debugging traffic may not flow properly through a traditional WAF or proxy device.</span></span>  <span data-ttu-id="069ae-181">È quindi possibile impostare *SourceAddressPrefix* sull'intervallo di indirizzi IP dei computer di sviluppo che eseguono Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="069ae-181">The *SourceAddressPrefix* can instead be set to the IP address range of developer machines running Visual Studio.</span></span>

    Get-AzureNetworkSecurityGroup -Name "testNSGexample" | Set-AzureNetworkSecurityRule -Name "RESTRICT RemoteDebuggingVS2012" -Type Inbound -Priority 600 -Action Allow -SourceAddressPrefix '1.2.3.4/32'  -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '4016' -Protocol TCP
    Get-AzureNetworkSecurityGroup -Name "testNSGexample" | Set-AzureNetworkSecurityRule -Name "RESTRICT RemoteDebuggingVS2013" -Type Inbound -Priority 700 -Action Allow -SourceAddressPrefix '1.2.3.4/32'  -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '4018' -Protocol TCP
    Get-AzureNetworkSecurityGroup -Name "testNSGexample" | Set-AzureNetworkSecurityRule -Name "RESTRICT RemoteDebuggingVS2015" -Type Inbound -Priority 800 -Action Allow -SourceAddressPrefix '1.2.3.4/32'  -SourcePortRange '*' -DestinationAddressPrefix '*' -DestinationPortRange '4020' -Protocol TCP

## <a name="assigning-a-network-security-group-to-a-subnet"></a><span data-ttu-id="069ae-182">Assegnazione di un gruppo di sicurezza di rete a una subnet</span><span class="sxs-lookup"><span data-stu-id="069ae-182">Assigning a Network Security Group to a Subnet</span></span>
<span data-ttu-id="069ae-183">Un gruppo di sicurezza di rete include una regola di sicurezza predefinita che nega l'accesso a tutto il traffico esterno.</span><span class="sxs-lookup"><span data-stu-id="069ae-183">A network security group has a default security rule which denies access to all external traffic.</span></span>  <span data-ttu-id="069ae-184">La combinazione delle regole di sicurezza di rete descritte in precedenza e della regola di sicurezza predefinita che blocca il traffico in ingresso determina che solo il traffico proveniente da intervalli di indirizzi di origine associati a un'azione *Consenti* potranno inviare il traffico alle app in esecuzione in un ambiente del servizio app.</span><span class="sxs-lookup"><span data-stu-id="069ae-184">The result from combining the network security rules described above, and the default security rule blocking inbound traffic, is that only traffic from source address ranges associated with an *Allow* action will be able to send traffic to apps running in an App Service Environment.</span></span>

<span data-ttu-id="069ae-185">Quando un gruppo di sicurezza di rete è stato popolato con le regole di sicurezza, deve essere assegnato alla subnet contenente l'ambiente del servizio app.</span><span class="sxs-lookup"><span data-stu-id="069ae-185">After a network security group is populated with security rules, it needs to be assigned to the subnet containing the App Service Environment.</span></span>  <span data-ttu-id="069ae-186">Il comando di assegnazione fa riferimento sia al nome della rete virtuale in cui risiede l'ambiente del servizio app, sia al nome della subnet in cui è stato creato l'ambiente.</span><span class="sxs-lookup"><span data-stu-id="069ae-186">The assignment command references both the name of the virtual network where the App Service Environment resides, as well as the name of the subnet where the App Service Environment was created.</span></span>  

<span data-ttu-id="069ae-187">L'esempio seguente illustra l'assegnazione di un gruppo di sicurezza di rete a una subnet e a una rete virtuale:</span><span class="sxs-lookup"><span data-stu-id="069ae-187">The example below shows a network security group being assigned to a subnet and virtual network:</span></span>

    Get-AzureNetworkSecurityGroup -Name "testNSGexample" | Set-AzureNetworkSecurityGroupToSubnet -VirtualNetworkName 'testVNet' -SubnetName 'Subnet-test'

<span data-ttu-id="069ae-188">Dopo l'assegnazione del gruppo di sicurezza di rete (si tratta di un'operazione con esecuzione prolungata che potrebbe richiedere alcuni minuti), solo il traffico in ingresso che corrisponde alle regole *Consenti* potrà raggiungere le app nell'ambiente del servizio app.</span><span class="sxs-lookup"><span data-stu-id="069ae-188">Once the network security group assignment succeeds (the assignment is a long-running operations and can take a few minutes to complete), only inbound traffic matching *Allow* rules will successfully reach apps in the App Service Environment.</span></span>

<span data-ttu-id="069ae-189">Per completezza, di seguito viene mostrato un esempio di come rimuovere e quindi dissociare il gruppo di sicurezza di rete dalla subnet:</span><span class="sxs-lookup"><span data-stu-id="069ae-189">For completeness the following example shows how to remove and thus dis-associate the network security group from the subnet:</span></span>

    Get-AzureNetworkSecurityGroup -Name "testNSGexample" | Remove-AzureNetworkSecurityGroupFromSubnet -VirtualNetworkName 'testVNet' -SubnetName 'Subnet-test'

## <a name="special-considerations-for-explicit-ip-ssl"></a><span data-ttu-id="069ae-190">Considerazioni speciali su IP SSL esplicito</span><span class="sxs-lookup"><span data-stu-id="069ae-190">Special Considerations for Explicit IP-SSL</span></span>
<span data-ttu-id="069ae-191">Se un'app è configurata con un indirizzo IP SSL esplicito (applicabile *solo* agli ambienti del servizio app con indirizzo VIP pubblico) anziché usare l'indirizzo IP predefinito dell'ambiente del servizio app, il traffico HTTP e HTTPS transita nella subnet tramite un set di porte diverse dalle porte 80 e 443.</span><span class="sxs-lookup"><span data-stu-id="069ae-191">If an app is configured with an explicit IP-SSL address (applicable *only* to ASEs that have a public VIP), instead of using the default IP address of the App Service Environment, both HTTP and HTTPS traffic flows into the subnet over a different set of ports other than ports 80 and 443.</span></span>

<span data-ttu-id="069ae-192">La singola coppia di porte usata da ogni indirizzo IP SSL è disponibile nell'interfaccia utente del portale nel pannello relativo all'esperienza utente con i dettagli dell'ambiente del servizio app.</span><span class="sxs-lookup"><span data-stu-id="069ae-192">The individual pair of ports used by each IP-SSL address can be found in the portal user interface from the App Service Environment's details UX blade.</span></span>  <span data-ttu-id="069ae-193">Selezionare "Tutte le impostazioni" --> "Indirizzi IP".</span><span class="sxs-lookup"><span data-stu-id="069ae-193">Select "All settings" --> "IP addresses".</span></span>  <span data-ttu-id="069ae-194">Il pannello "Indirizzi IP" mostra una tabella di tutti gli indirizzi IP SSL configurati in modo esplicito per l'ambiente del servizio app, con la coppia speciale di porte che consente di instradare il traffico HTTP e HTTPS associato a ogni indirizzo IP-SSL.</span><span class="sxs-lookup"><span data-stu-id="069ae-194">The "IP addresses" blade shows a table of all explicitly configured IP-SSL addresses for the App Service Environment, along with the special port pair that is used to route HTTP and HTTPS traffic associated with each IP-SSL address.</span></span>  <span data-ttu-id="069ae-195">Questa è la coppia di porte che deve essere utilizzata per i parametri DestinationPortRange quando si configurano le regole in un gruppo di sicurezza di rete.</span><span class="sxs-lookup"><span data-stu-id="069ae-195">It is this port pair that needs to be used for the DestinationPortRange parameters when configuring rules in a network security group.</span></span>

<span data-ttu-id="069ae-196">Quando un'app in un ambiente del servizio app è configurata in modo da usare l'indirizzo IP SSL, ai clienti esterni non verrà visualizzato il mapping della coppia di porte e non dovranno preoccuparsi di questo aspetto.</span><span class="sxs-lookup"><span data-stu-id="069ae-196">When an app on an ASE is configured to use IP-SSL, external customers will not see and do not need to worry about the special port pair mapping.</span></span>  <span data-ttu-id="069ae-197">Il traffico verso le app transiterà normalmente all'indirizzo IP SSL configurato.</span><span class="sxs-lookup"><span data-stu-id="069ae-197">Traffic to the apps will flow normally to the configured IP-SSL address.</span></span>  <span data-ttu-id="069ae-198">La conversione a una coppia di porte specifica avviene internamente in modo automatico durante l'ultima parte del routing del traffico nella subnet contenente l'ambiente del servizio app.</span><span class="sxs-lookup"><span data-stu-id="069ae-198">The translation to the special port pair automatically happens internally during the final leg of routing traffic into the subnet containing the ASE.</span></span> 

## <a name="getting-started"></a><span data-ttu-id="069ae-199">Introduzione</span><span class="sxs-lookup"><span data-stu-id="069ae-199">Getting started</span></span>
<span data-ttu-id="069ae-200">Per iniziare a usare gli ambienti del servizio app, vedere [Introduzione all'ambiente del servizio app][IntroToAppServiceEnvironment]</span><span class="sxs-lookup"><span data-stu-id="069ae-200">To get started with App Service Environments, see [Introduction to App Service Environment][IntroToAppServiceEnvironment]</span></span>

<span data-ttu-id="069ae-201">Tutti gli articoli e le procedure sugli ambienti del servizio app sono disponibili nel [file LEGGIMI per gli ambienti di servizio dell'applicazione](../app-service/app-service-app-service-environments-readme.md).</span><span class="sxs-lookup"><span data-stu-id="069ae-201">All articles and How-To's for App Service Environments are available in the [README for Application Service Environments](../app-service/app-service-app-service-environments-readme.md).</span></span>

<span data-ttu-id="069ae-202">Per informazioni dettagliate sulle app che si connettono in modo sicuro alla risorsa back-end da un ambiente del servizio app, vedere [Connessione sicura alle risorse back-end da un ambiente del servizio app][SecurelyConnecttoBackend]</span><span class="sxs-lookup"><span data-stu-id="069ae-202">For details around apps securely connecting to backend resource from an App Service Environment, see [Securely connecting to Backend resources from an App Service Environment][SecurelyConnecttoBackend]</span></span>

<span data-ttu-id="069ae-203">Per altre informazioni sulla piattaforma del servizio app di Azure, vedere l'articolo relativo al [servizio app di Azure][AzureAppService].</span><span class="sxs-lookup"><span data-stu-id="069ae-203">For more information about the Azure App Service platform, see [Azure App Service][AzureAppService].</span></span>

[!INCLUDE [app-service-web-whats-changed](../../includes/app-service-web-whats-changed.md)]

[!INCLUDE [app-service-web-try-app-service](../../includes/app-service-web-try-app-service.md)]

<!-- LINKS -->
[virtualnetwork]: https://azure.microsoft.com/documentation/articles/virtual-networks-faq/
[HowToCreateAnAppServiceEnvironment]: http://azure.microsoft.com/documentation/articles/app-service-web-how-to-create-an-app-service-environment/
[NetworkSecurityGroups]: https://azure.microsoft.com/documentation/articles/virtual-networks-nsg/
[AzureAppService]: http://azure.microsoft.com/documentation/articles/app-service-value-prop-what-is/
[IntroToAppServiceEnvironment]:  http://azure.microsoft.com/documentation/articles/app-service-app-service-environment-intro/
[SecurelyConnecttoBackend]:  http://azure.microsoft.com/documentation/articles/app-service-app-service-environment-securely-connecting-to-backend-resources/
[NewPortal]:  https://portal.azure.com  

<!-- IMAGES -->

