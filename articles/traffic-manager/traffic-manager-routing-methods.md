---
title: Gestione traffico di Azure - Metodi di routing del traffico | Microsoft Docs
description: Questo articolo fornisce informazioni sui diversi metodi di routing del traffico usati da Gestione traffico
services: traffic-manager
documentationcenter: 
author: KumudD
manager: timlt
editor: 
ms.assetid: db1efbf6-6762-4c7a-ac99-675d4eeb54d0
ms.service: traffic-manager
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 07/13/2017
ms.author: kumud
ms.openlocfilehash: fe776e24a4f78b389c6096694055b38befa3c419
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/03/2017
---
# <a name="traffic-manager-routing-methods"></a><span data-ttu-id="e3dae-103">Metodi di routing di Gestione traffico</span><span class="sxs-lookup"><span data-stu-id="e3dae-103">Traffic Manager routing methods</span></span>

<span data-ttu-id="e3dae-104">Gestione traffico di Microsoft Azure supporta tre metodi di routing del traffico per determinare la modalità di instradamento del traffico di rete ai vari endpoint di servizio.</span><span class="sxs-lookup"><span data-stu-id="e3dae-104">Azure Traffic Manager supports four traffic-routing methods to determine how to route network traffic to the various service endpoints.</span></span> <span data-ttu-id="e3dae-105">Gestione traffico applica il metodo di routing a ogni query DNS ricevuta,</span><span class="sxs-lookup"><span data-stu-id="e3dae-105">Traffic Manager applies the traffic-routing method to each DNS query it receives.</span></span> <span data-ttu-id="e3dae-106">per determinare l'endpoint da restituire nella risposta DNS.</span><span class="sxs-lookup"><span data-stu-id="e3dae-106">The traffic-routing method determines which endpoint returned in the DNS response.</span></span>

<span data-ttu-id="e3dae-107">In Gestione traffico sono disponibili quattro metodi di routing del traffico:</span><span class="sxs-lookup"><span data-stu-id="e3dae-107">There are four traffic routing methods available in Traffic Manager:</span></span>

* <span data-ttu-id="e3dae-108">**[Priorità](#priority):** selezionare **Priorità** quando si vuole usare un endpoint di servizio primario per tutto il traffico e prevedere endpoint di backup nel caso in cui l'endpoint primario o gli endpoint di backup non siano disponibili.</span><span class="sxs-lookup"><span data-stu-id="e3dae-108">**[Priority](#priority):** Select **Priority** when you want to use a primary service endpoint for all traffic, and provide backups in case the primary or the backup endpoints are unavailable.</span></span>
* <span data-ttu-id="e3dae-109">**[Ponderato](#weighted):** selezionare **Ponderato** quando si vuole distribuire il traffico in un set di endpoint in modo uniforme o in base alle ponderazioni definite.</span><span class="sxs-lookup"><span data-stu-id="e3dae-109">**[Weighted](#weighted):** Select **Weighted** when you want to distribute traffic across a set of endpoints, either evenly or according to weights, which you define.</span></span>
* <span data-ttu-id="e3dae-110">**[Prestazioni](#performance):** selezionare **Prestazioni** quando gli endpoint si trovano in aree geografiche diverse e si vuole che gli utenti finali usino l'endpoint "più vicino" in termini di latenza di rete più bassa.</span><span class="sxs-lookup"><span data-stu-id="e3dae-110">**[Performance](#performance):** Select **Performance** when you have endpoints in different geographic locations and you want end users to use the "closest" endpoint in terms of the lowest network latency.</span></span>
* <span data-ttu-id="e3dae-111">**[Geografico](#geographic):** selezionare **Geografico** in modo che gli utenti vengono indirizzati a endpoint specifici (Azure, Esterno o Annidato) in base alla posizione geografica da cui provengono le query DNS.</span><span class="sxs-lookup"><span data-stu-id="e3dae-111">**[Geographic](#geographic):** Select **Geographic** so that users are directed to specific endpoints (Azure, External, or Nested) based on which geographic location their DNS query originates from.</span></span> <span data-ttu-id="e3dae-112">Questo consente ai clienti di Gestione traffico di abilitare scenari in cui è importante conoscere l'area geografica dell'utente ed eseguirne il routing in base a questa.</span><span class="sxs-lookup"><span data-stu-id="e3dae-112">This empowers Traffic Manager customers to enable scenarios where knowing a user’s geographic region and routing them based on that is important.</span></span> <span data-ttu-id="e3dae-113">Ne sono esempi la presenza di determinati requisiti sui dati, la localizzazione del contenuto e dell'esperienza dell'utente e la misurazione del traffico da aree diverse.</span><span class="sxs-lookup"><span data-stu-id="e3dae-113">Examples include complying with data sovereignty mandates, localization of content & user experience and measuring traffic from different regions.</span></span>

<span data-ttu-id="e3dae-114">Tutti i profili di Gestione traffico includono il monitoraggio continuo dell'integrità degli endpoint e il failover automatico degli endpoint.</span><span class="sxs-lookup"><span data-stu-id="e3dae-114">All Traffic Manager profiles include monitoring of endpoint health and automatic endpoint failover.</span></span> <span data-ttu-id="e3dae-115">Per altre informazioni, vedere [Informazioni sul monitoraggio di Gestione traffico](traffic-manager-monitoring.md).</span><span class="sxs-lookup"><span data-stu-id="e3dae-115">For more information, see [Traffic Manager Endpoint Monitoring](traffic-manager-monitoring.md).</span></span> <span data-ttu-id="e3dae-116">Un singolo profilo di Gestione traffico può usare un solo metodo di routing del traffico.</span><span class="sxs-lookup"><span data-stu-id="e3dae-116">A single Traffic Manager profile can use only one traffic routing method.</span></span> <span data-ttu-id="e3dae-117">È possibile selezionare in qualsiasi momento un metodo di routing del traffico diverso per il profilo.</span><span class="sxs-lookup"><span data-stu-id="e3dae-117">You can select a different traffic routing method for your profile at any time.</span></span> <span data-ttu-id="e3dae-118">Le modifiche vengono applicate entro un minuto e non si verificano periodi di inattività.</span><span class="sxs-lookup"><span data-stu-id="e3dae-118">Changes are applied within one minute, and no downtime is incurred.</span></span> <span data-ttu-id="e3dae-119">I metodi di routing del traffico possono essere combinati usando profili nidificati di Gestione traffico.</span><span class="sxs-lookup"><span data-stu-id="e3dae-119">Traffic-routing methods can be combined by using nested Traffic Manager profiles.</span></span> <span data-ttu-id="e3dae-120">I profili annidati consentono di creare configurazioni di routing del traffico sofisticate e flessibili per soddisfare le esigenze di applicazioni più grandi e più complesse.</span><span class="sxs-lookup"><span data-stu-id="e3dae-120">Nesting enables sophisticated and flexible traffic-routing configurations that meet the needs of larger, complex applications.</span></span> <span data-ttu-id="e3dae-121">Per altre informazioni, vedere [nested Traffic Manager profiles](traffic-manager-nested-profiles.md)(Profili nidificati di Gestione traffico).</span><span class="sxs-lookup"><span data-stu-id="e3dae-121">For more information, see [nested Traffic Manager profiles](traffic-manager-nested-profiles.md).</span></span>

## <span data-ttu-id="e3dae-122"><a name = "priority"></a>Metodo di routing del traffico Priorità</span><span class="sxs-lookup"><span data-stu-id="e3dae-122"><a name = "priority"></a>Priority traffic-routing method</span></span>

<span data-ttu-id="e3dae-123">Un'organizzazione vuole spesso offrire la massima affidabilità per i propri servizi dotandosi di uno o più servizi di backup in caso di inattività del servizio primario.</span><span class="sxs-lookup"><span data-stu-id="e3dae-123">Often an organization wants to provide reliability for its services by deploying one or more backup services in case their primary service goes down.</span></span> <span data-ttu-id="e3dae-124">Il metodo di routing del traffico "Priorità" consente ai clienti di Azure di implementare facilmente questo modello di failover.</span><span class="sxs-lookup"><span data-stu-id="e3dae-124">The 'Priority' traffic-routing method allows Azure customers to easily implement this failover pattern.</span></span>

![Metodo di routing del traffico "Priorità" di Gestione traffico di Azure][1]

<span data-ttu-id="e3dae-126">Il profilo di Gestione traffico contiene un elenco con priorità di endpoint di servizio.</span><span class="sxs-lookup"><span data-stu-id="e3dae-126">The Traffic Manager profile contains a prioritized list of service endpoints.</span></span> <span data-ttu-id="e3dae-127">Per impostazione predefinita, tutto il traffico viene inviato all'endpoint primario (o con priorità più elevata).</span><span class="sxs-lookup"><span data-stu-id="e3dae-127">By default, Traffic Manager sends all traffic to the primary (highest-priority) endpoint.</span></span> <span data-ttu-id="e3dae-128">Se l'endpoint primario non è disponibile, Gestione traffico indirizza il traffico verso il secondo endpoint.</span><span class="sxs-lookup"><span data-stu-id="e3dae-128">If the primary endpoint is not available, Traffic Manager routes the traffic to the second endpoint.</span></span> <span data-ttu-id="e3dae-129">Se l'endpoint primario e secondario non sono disponibili, il traffico viene indirizzato al terzo e così via.</span><span class="sxs-lookup"><span data-stu-id="e3dae-129">If both the primary and secondary endpoints are not available, the traffic goes to the third, and so on.</span></span> <span data-ttu-id="e3dae-130">La disponibilità dell'endpoint si basa sullo stato configurato (abilitato o disabilitato) e sul monitoraggio degli endpoint in corso.</span><span class="sxs-lookup"><span data-stu-id="e3dae-130">Availability of the endpoint is based on the configured status (enabled or disabled) and the ongoing endpoint monitoring.</span></span>

### <a name="configuring-endpoints"></a><span data-ttu-id="e3dae-131">Configurazione degli endpoint</span><span class="sxs-lookup"><span data-stu-id="e3dae-131">Configuring endpoints</span></span>

<span data-ttu-id="e3dae-132">In Azure Resource Manager la priorità degli endpoint viene configurata in modo esplicito, definendo la proprietà "priority" di ogni endpoint.</span><span class="sxs-lookup"><span data-stu-id="e3dae-132">With Azure Resource Manager, you configure the endpoint priority explicitly using the 'priority' property for each endpoint.</span></span> <span data-ttu-id="e3dae-133">Questa proprietà accetta un valore compreso tra 1 e 1000,</span><span class="sxs-lookup"><span data-stu-id="e3dae-133">This property is a value between 1 and 1000.</span></span> <span data-ttu-id="e3dae-134">dove i valori più bassi rappresentano una priorità più elevata.</span><span class="sxs-lookup"><span data-stu-id="e3dae-134">Lower values represent a higher priority.</span></span> <span data-ttu-id="e3dae-135">Gli endpoint non possono avere lo stesso valore di priorità.</span><span class="sxs-lookup"><span data-stu-id="e3dae-135">Endpoints cannot share priority values.</span></span> <span data-ttu-id="e3dae-136">La proprietà è facoltativa e,</span><span class="sxs-lookup"><span data-stu-id="e3dae-136">Setting the property is optional.</span></span> <span data-ttu-id="e3dae-137">se viene omessa, viene usata una priorità predefinita in base all'ordine degli endpoint.</span><span class="sxs-lookup"><span data-stu-id="e3dae-137">When omitted, a default priority based on the endpoint order is used.</span></span>

##<span data-ttu-id="e3dae-138"><a name = "weighted"></a>Metodo di routing del traffico Ponderato</span><span class="sxs-lookup"><span data-stu-id="e3dae-138"><a name = "weighted"></a>Weighted traffic-routing method</span></span>
<span data-ttu-id="e3dae-139">Il metodo di routing del traffico "Ponderato" consente di distribuire il traffico tra tutti gli endpoint in modo uniforme o con un peso predefinito.</span><span class="sxs-lookup"><span data-stu-id="e3dae-139">The 'Weighted' traffic-routing method allows you to distribute traffic evenly or to use a pre-defined weighting.</span></span>

![Metodo di routing del traffico "Ponderato" di Gestione traffico di Azure][2]

<span data-ttu-id="e3dae-141">Nel metodo di routing del traffico "Ponderato" viene assegnato un peso a ogni endpoint come parte della configurazione del profilo di Gestione traffico.</span><span class="sxs-lookup"><span data-stu-id="e3dae-141">In the Weighted traffic-routing method, you assign a weight to each endpoint in the Traffic Manager profile configuration.</span></span> <span data-ttu-id="e3dae-142">Ogni peso è un numero intero compreso tra 1 e 1000.</span><span class="sxs-lookup"><span data-stu-id="e3dae-142">The weight is an integer from 1 to 1000.</span></span> <span data-ttu-id="e3dae-143">Questo parametro è facoltativo e,</span><span class="sxs-lookup"><span data-stu-id="e3dae-143">This parameter is optional.</span></span> <span data-ttu-id="e3dae-144">se omesso, viene usato il valore di peso predefinito "1".</span><span class="sxs-lookup"><span data-stu-id="e3dae-144">If omitted, Traffic Managers uses a default weight of '1'.</span></span>

<span data-ttu-id="e3dae-145">Per ogni query DNS ricevuta, viene scelto un endpoint disponibile in modo casuale,</span><span class="sxs-lookup"><span data-stu-id="e3dae-145">For each DNS query received, Traffic Manager randomly chooses an available endpoint.</span></span> <span data-ttu-id="e3dae-146">con una probabilità di scelta basata sul peso assegnato a tutti gli endpoint disponibili.</span><span class="sxs-lookup"><span data-stu-id="e3dae-146">The probability of choosing an endpoint is based on the weights assigned to all available endpoints.</span></span> <span data-ttu-id="e3dae-147">L'uso dello stesso peso in tutti gli endpoint comporta una distribuzione uniforme del traffico.</span><span class="sxs-lookup"><span data-stu-id="e3dae-147">Using the same weight across all endpoints results in an even traffic distribution.</span></span> <span data-ttu-id="e3dae-148">Se vengono usati pesi superiori o inferiori in specifici endpoint, questi verranno restituiti più o meno frequentemente nelle risposte DNS.</span><span class="sxs-lookup"><span data-stu-id="e3dae-148">Using higher or lower weights on specific endpoints causes those endpoints to be returned more or less frequently in the DNS responses.</span></span>

<span data-ttu-id="e3dae-149">Il metodo "Ponderato" abilita alcuni scenari utili:</span><span class="sxs-lookup"><span data-stu-id="e3dae-149">The weighted method enables some useful scenarios:</span></span>

* <span data-ttu-id="e3dae-150">Aggiornamento graduale dell'applicazione: allocare una percentuale di traffico da indirizzare a un nuovo endpoint, quindi incrementare gradualmente il traffico nel tempo fino al 100%.</span><span class="sxs-lookup"><span data-stu-id="e3dae-150">Gradual application upgrade: Allocate a percentage of traffic to route to a new endpoint, and gradually increase the traffic over time to 100%.</span></span>
* <span data-ttu-id="e3dae-151">Migrazione dell'applicazione in Azure: creare un profilo con endpoint di Azure ed esterni.</span><span class="sxs-lookup"><span data-stu-id="e3dae-151">Application migration to Azure: Create a profile with both Azure and external endpoints.</span></span> <span data-ttu-id="e3dae-152">Regolare il peso degli endpoint per preferire i nuovi endpoint.</span><span class="sxs-lookup"><span data-stu-id="e3dae-152">Adjust the weight of the endpoints to prefer the new endpoints.</span></span>
* <span data-ttu-id="e3dae-153">Espansione del cloud per capacità aggiuntiva: espandere rapidamente una distribuzione locale nel cloud posizionandola dietro a un profilo di Gestione traffico.</span><span class="sxs-lookup"><span data-stu-id="e3dae-153">Cloud-bursting for additional capacity: Quickly expand an on-premises deployment into the cloud by putting it behind a Traffic Manager profile.</span></span> <span data-ttu-id="e3dae-154">In caso di necessità di capacità aggiuntiva nel cloud, si possono aggiungere o abilitare più endpoint e si può specificare la quantità di traffico da indirizzare a ogni endpoint.</span><span class="sxs-lookup"><span data-stu-id="e3dae-154">When you need extra capacity in the cloud, you can add or enable more endpoints and specify what portion of traffic goes to each endpoint.</span></span>

<span data-ttu-id="e3dae-155">Il portale di Azure Resource Manager supporta la configurazione del traffico pesato.</span><span class="sxs-lookup"><span data-stu-id="e3dae-155">The Resource Manager Azure portal supports the configuration of weighted traffic routing.</span></span>  <span data-ttu-id="e3dae-156">I pesi possono essere configurati usando le versioni Resource Manager di Azure PowerShell, dell'interfaccia della riga di comando e dell'API REST.</span><span class="sxs-lookup"><span data-stu-id="e3dae-156">You can configure weights using the Resource Manager versions of Azure PowerShell, CLI, and the REST APIs.</span></span>

<span data-ttu-id="e3dae-157">È importante comprendere che le risposte DNS vengono memorizzate nella cache dai client e dai server ricorsivi usati per risolvere i nomi DNS.</span><span class="sxs-lookup"><span data-stu-id="e3dae-157">It is important to understand that DNS responses are cached by clients and by the recursive DNS servers that the clients use to resolve DNS names.</span></span> <span data-ttu-id="e3dae-158">Questa memorizzazione ha un impatto sulle distribuzioni del traffico ponderate.</span><span class="sxs-lookup"><span data-stu-id="e3dae-158">This caching can have an impact on weighted traffic distributions.</span></span> <span data-ttu-id="e3dae-159">Se il numero di client e di server DNS ricorsivi è elevato, la distribuzione del traffico funziona come previsto.</span><span class="sxs-lookup"><span data-stu-id="e3dae-159">When the number of clients and recursive DNS servers is large, traffic distribution works as expected.</span></span> <span data-ttu-id="e3dae-160">Se invece il numero di client o di server DNS ricorsivi è limitato, la memorizzazione nella cache può modificare significativamente la distribuzione del traffico.</span><span class="sxs-lookup"><span data-stu-id="e3dae-160">However, when the number of clients or recursive DNS servers is small, caching can significantly skew the traffic distribution.</span></span>

<span data-ttu-id="e3dae-161">I casi d'uso comuni in cui può verificarsi questa situazione includono:</span><span class="sxs-lookup"><span data-stu-id="e3dae-161">Common use cases include:</span></span>

* <span data-ttu-id="e3dae-162">Ambienti di sviluppo e test</span><span class="sxs-lookup"><span data-stu-id="e3dae-162">Development and testing environments</span></span>
* <span data-ttu-id="e3dae-163">Comunicazioni tra applicazioni</span><span class="sxs-lookup"><span data-stu-id="e3dae-163">Application-to-application communications</span></span>
* <span data-ttu-id="e3dae-164">Applicazioni destinate a una base utenti ristretta che condivide un'infrastruttura DNS ricorsiva comune, ad esempio i dipendenti di un'organizzazione che si connettono tramite proxy.</span><span class="sxs-lookup"><span data-stu-id="e3dae-164">Applications aimed at a narrow user-base that share a common recursive DNS infrastructure (for example, employees of company connecting through a proxy)</span></span>

<span data-ttu-id="e3dae-165">Questi effetti della memorizzazione nella cache DNS non riguardano solo Gestione traffico di Azure, ma sono comuni a tutti i sistemi di routing del traffico basati su DNS.</span><span class="sxs-lookup"><span data-stu-id="e3dae-165">These DNS caching effects are common to all DNS-based traffic routing systems, not just Azure Traffic Manager.</span></span> <span data-ttu-id="e3dae-166">In alcuni casi, la cancellazione della cache DNS in modo esplicito può risolvere il problema.</span><span class="sxs-lookup"><span data-stu-id="e3dae-166">In some cases, explicitly clearing the DNS cache may provide a workaround.</span></span> <span data-ttu-id="e3dae-167">In altri casi, può essere più appropriato un metodo di routing del traffico alternativo.</span><span class="sxs-lookup"><span data-stu-id="e3dae-167">In other cases, an alternative traffic-routing method may be more appropriate.</span></span>

## <span data-ttu-id="e3dae-168"><a name = "performance"></a>Metodo di routing del traffico Prestazioni</span><span class="sxs-lookup"><span data-stu-id="e3dae-168"><a name = "performance"></a>Performance traffic-routing method</span></span>

<span data-ttu-id="e3dae-169">La velocità di risposta di molte applicazioni può essere migliorata distribuendo gli endpoint in due o più posizioni a livello globale e indirizzando il traffico alla posizione più vicina.</span><span class="sxs-lookup"><span data-stu-id="e3dae-169">Deploying endpoints in two or more locations across the globe can improve the responsiveness of many applications by routing traffic to the location that is 'closest' to you.</span></span> <span data-ttu-id="e3dae-170">Questo è lo scopo del metodo di routing del traffico "Prestazioni".</span><span class="sxs-lookup"><span data-stu-id="e3dae-170">The 'Performance' traffic-routing method provides this capability.</span></span>

![Metodo di routing del traffico "Prestazioni" di Gestione traffico di Azure][3]

<span data-ttu-id="e3dae-172">L'endpoint più vicino non è necessariamente il più vicino in termini di distanza geografica.</span><span class="sxs-lookup"><span data-stu-id="e3dae-172">The 'closest' endpoint is not necessarily closest as measured by geographic distance.</span></span> <span data-ttu-id="e3dae-173">Il metodo di routing del traffico "Prestazioni" determina invece l'endpoint più vicino in termini di latenza di rete.</span><span class="sxs-lookup"><span data-stu-id="e3dae-173">Instead, the 'Performance' traffic-routing method determines the closest endpoint by measuring network latency.</span></span> <span data-ttu-id="e3dae-174">La tabella della latenza di Internet indica il tempo di round trip tra intervalli di indirizzi IP e ciascun data center di Azure.</span><span class="sxs-lookup"><span data-stu-id="e3dae-174">Traffic Manager maintains an Internet Latency Table to track the round-trip time between IP address ranges and each Azure datacenter.</span></span>

<span data-ttu-id="e3dae-175">Gestione traffico individua nella tabella la riga relativa all'indirizzo IP di origine della richiesta DNS in ingresso</span><span class="sxs-lookup"><span data-stu-id="e3dae-175">Traffic Manager looks up the source IP address of the incoming DNS request in the Internet Latency Table.</span></span> <span data-ttu-id="e3dae-176">e sceglie quindi nel data center di Azure l'endpoint disponibile con la latenza più bassa per l'intervallo di indirizzi IP specifico, e restituisce quindi l'endpoint nella risposta DNS.</span><span class="sxs-lookup"><span data-stu-id="e3dae-176">Traffic Manager chooses an available endpoint in the Azure datacenter that has the lowest latency for that IP address range, then returns that endpoint in the DNS response.</span></span>

<span data-ttu-id="e3dae-177">Come spiegato in [Modalità di funzionamento di Gestione traffico](traffic-manager-overview.md#how-traffic-manager-works), le query DNS non vengono ricevute direttamente dai client,</span><span class="sxs-lookup"><span data-stu-id="e3dae-177">As explained in [How Traffic Manager Works](traffic-manager-overview.md#how-traffic-manager-works), Traffic Manager does not receive DNS queries directly from clients.</span></span> <span data-ttu-id="e3dae-178">ma dal servizio DNS ricorsivo per il quale sono configurati.</span><span class="sxs-lookup"><span data-stu-id="e3dae-178">Rather, DNS queries come from the recursive DNS service that the clients are configured to use.</span></span> <span data-ttu-id="e3dae-179">Pertanto, l'indirizzo IP usato per determinare l'endpoint più vicino non è l'indirizzo IP del client, ma l'indirizzo IP del servizio DNS ricorsivo.</span><span class="sxs-lookup"><span data-stu-id="e3dae-179">Therefore, the IP address used to determine the 'closest' endpoint is not the client's IP address, but it is the IP address of the recursive DNS service.</span></span> <span data-ttu-id="e3dae-180">In pratica, questo indirizzo IP è un proxy valido a questo scopo per il client.</span><span class="sxs-lookup"><span data-stu-id="e3dae-180">In practice, this IP address is a good proxy for the client.</span></span>


<span data-ttu-id="e3dae-181">Per adeguarsi alle modifiche nella rete Internet globale e all'aggiunta di nuove aree di Azure, Gestione traffico aggiorna regolarmente la tabella della latenza di Internet usata.</span><span class="sxs-lookup"><span data-stu-id="e3dae-181">Traffic Manager regularly updates the Internet Latency Table to account for changes in the global Internet and new Azure regions.</span></span> <span data-ttu-id="e3dae-182">Tuttavia, le prestazioni dell'applicazione variano in base alle variazioni del carico in tempo reale registrate in Internet.</span><span class="sxs-lookup"><span data-stu-id="e3dae-182">However, application performance varies based on real-time variations in load across the Internet.</span></span> <span data-ttu-id="e3dae-183">Il routing del traffico "Prestazioni" non prende in considerazione il monitoraggio del carico su un determinato endpoint di servizio.</span><span class="sxs-lookup"><span data-stu-id="e3dae-183">Performance traffic-routing does not monitor load on a given service endpoint.</span></span> <span data-ttu-id="e3dae-184">Se un endpoint non è più disponibile, non viene incluso nelle risposte alle query DNS.</span><span class="sxs-lookup"><span data-stu-id="e3dae-184">However, if an endpoint becomes unavailable, Traffic Manager does not include it in DNS query responses.</span></span>


<span data-ttu-id="e3dae-185">Punti da notare:</span><span class="sxs-lookup"><span data-stu-id="e3dae-185">Points to note:</span></span>

* <span data-ttu-id="e3dae-186">Se il profilo contiene più endpoint nella stessa area di Azure, il traffico indirizzato all'area in questione viene distribuito in modo uniforme tra gli endpoint disponibili nell'area.</span><span class="sxs-lookup"><span data-stu-id="e3dae-186">If your profile contains multiple endpoints in the same Azure region, then Traffic Manager distributes traffic evenly across the available endpoints in that region.</span></span> <span data-ttu-id="e3dae-187">Se si preferisce una distribuzione del traffico diversa all'interno di un'area, usare i [profili annidati di Gestione traffico](traffic-manager-nested-profiles.md).</span><span class="sxs-lookup"><span data-stu-id="e3dae-187">If you prefer a different traffic distribution within a region, you can use [nested Traffic Manager profiles](traffic-manager-nested-profiles.md).</span></span>
* <span data-ttu-id="e3dae-188">Se tutti gli endpoint abilitati nell'area di Azure più vicina sono danneggiati, Gestione traffico sposta il traffico sugli endpoint nella successiva area di Azure più vicina.</span><span class="sxs-lookup"><span data-stu-id="e3dae-188">If all enabled endpoints in the closest Azure region are degraded, Traffic Manager moves traffic to the endpoints in the next closest Azure region.</span></span> <span data-ttu-id="e3dae-189">Se si preferisce definire una sequenza di failover, usare i [profili annidati di Gestione traffico](traffic-manager-nested-profiles.md).</span><span class="sxs-lookup"><span data-stu-id="e3dae-189">If you want to define a preferred failover sequence, use [nested Traffic Manager profiles](traffic-manager-nested-profiles.md).</span></span>
* <span data-ttu-id="e3dae-190">Quando si usa il metodo di routing del traffico "Prestazioni" con endpoint esterni o endpoint annidati, è necessario specificare la posizione di tali endpoint.</span><span class="sxs-lookup"><span data-stu-id="e3dae-190">When using the Performance traffic routing method with external endpoints or nested endpoints, you need to specify the location of those endpoints.</span></span> <span data-ttu-id="e3dae-191">Scegliere l'area di Azure più vicina alla distribuzione specifica.</span><span class="sxs-lookup"><span data-stu-id="e3dae-191">Choose the Azure region closest to your deployment.</span></span> <span data-ttu-id="e3dae-192">Si tratta delle posizioni supportate dalla tabella della latenza di Internet.</span><span class="sxs-lookup"><span data-stu-id="e3dae-192">Those locations are the values supported by the Internet Latency Table.</span></span>
* <span data-ttu-id="e3dae-193">L'algoritmo che sceglie l'endpoint è deterministico.</span><span class="sxs-lookup"><span data-stu-id="e3dae-193">The algorithm that chooses the endpoint is deterministic.</span></span> <span data-ttu-id="e3dae-194">Le query DNS ripetute dallo stesso client vengono indirizzate allo stesso endpoint.</span><span class="sxs-lookup"><span data-stu-id="e3dae-194">Repeated DNS queries from the same client are directed to the same endpoint.</span></span> <span data-ttu-id="e3dae-195">Quando viaggiano, i client solitamente usano server DNS ricorsivi diversi,</span><span class="sxs-lookup"><span data-stu-id="e3dae-195">Typically, clients use different recursive DNS servers when traveling.</span></span> <span data-ttu-id="e3dae-196">e possono pertanto essere indirizzati a un endpoint differente.</span><span class="sxs-lookup"><span data-stu-id="e3dae-196">The client may be routed to a different endpoint.</span></span> <span data-ttu-id="e3dae-197">Il routing potrebbe inoltre risentire degli aggiornamenti della tabella della latenza di Internet.</span><span class="sxs-lookup"><span data-stu-id="e3dae-197">Routing can also be affected by updates to the Internet Latency Table.</span></span> <span data-ttu-id="e3dae-198">Ne consegue che il metodo di routing del traffico "Prestazioni" non garantisce che un client sia sempre indirizzato allo stesso endpoint.</span><span class="sxs-lookup"><span data-stu-id="e3dae-198">Therefore, the Performance traffic-routing method does not guarantee that a client is always routed to the same endpoint.</span></span>
* <span data-ttu-id="e3dae-199">Quando viene aggiornata la tabella della latenza di Internet, è possibile notare che alcuni client vengono indirizzati a un endpoint diverso.</span><span class="sxs-lookup"><span data-stu-id="e3dae-199">When the Internet Latency Table changes, you may notice that some clients are directed to a different endpoint.</span></span> <span data-ttu-id="e3dae-200">Ciò riflette un routing più accurato in base ai dati di latenza correnti.</span><span class="sxs-lookup"><span data-stu-id="e3dae-200">This routing change is more accurate based on current latency data.</span></span> <span data-ttu-id="e3dae-201">Questi aggiornamenti sono essenziali per garantire la precisione del routing del traffico Prestazioni man mano che Internet si evolve.</span><span class="sxs-lookup"><span data-stu-id="e3dae-201">These updates are essential to maintain the accuracy of Performance traffic-routing as the Internet continually evolves.</span></span>

## <span data-ttu-id="e3dae-202"><a name = "geographic"></a>Metodo di routing del traffico Geografico</span><span class="sxs-lookup"><span data-stu-id="e3dae-202"><a name = "geographic"></a>Geographic traffic-routing method</span></span>

<span data-ttu-id="e3dae-203">I profili di Gestione traffico possono essere configurati per l'uso del metodo di routing Geografico, in modo che gli utenti vengono indirizzati a endpoint specifici (Azure, Esterno o Annidato) in base alla posizione geografica da cui provengono le query DNS.</span><span class="sxs-lookup"><span data-stu-id="e3dae-203">Traffic Manager profiles can be configured to use the Geographic routing method so that users are directed to specific endpoints (Azure, External or Nested) based on which geographic location their DNS query originates from.</span></span> <span data-ttu-id="e3dae-204">Questo consente ai clienti di Gestione traffico di abilitare scenari in cui è importante conoscere l'area geografica dell'utente ed eseguirne il routing in base a questa.</span><span class="sxs-lookup"><span data-stu-id="e3dae-204">This empowers Traffic Manager customers to enable scenarios where knowing a user’s geographic region and routing them based on that is important.</span></span> <span data-ttu-id="e3dae-205">Ne sono esempi la presenza di determinati requisiti sui dati, la localizzazione del contenuto e dell'esperienza dell'utente e la misurazione del traffico da aree diverse.</span><span class="sxs-lookup"><span data-stu-id="e3dae-205">Examples include complying with data sovereignty mandates, localization of content & user experience and measuring traffic from different regions.</span></span>
<span data-ttu-id="e3dae-206">Quando un profilo è configurato per il routing geografico, ogni endpoint associato al profilo deve avere un set di aree geografiche assegnate.</span><span class="sxs-lookup"><span data-stu-id="e3dae-206">When a profile is configured for geographic routing, each endpoint associated with that profile needs to have a set of geographic regions assigned to it.</span></span> <span data-ttu-id="e3dae-207">Un'area geografica può avere i seguenti livelli di granularità</span><span class="sxs-lookup"><span data-stu-id="e3dae-207">A geographic region can be at following levels of granularity</span></span> 
- <span data-ttu-id="e3dae-208">Mondo: qualsiasi area</span><span class="sxs-lookup"><span data-stu-id="e3dae-208">World– any region</span></span>
- <span data-ttu-id="e3dae-209">Raggruppamento di aree: ad esempio Africa, Medio Oriente, Australia/Pacifico e così via.</span><span class="sxs-lookup"><span data-stu-id="e3dae-209">Regional Grouping – for example, Africa, Middle East, Australia/Pacific etc.</span></span> 
- <span data-ttu-id="e3dae-210">Paese/area geografica: ad esempio Irlanda, Perù, Regione amministrativa speciale di Hong Kong e così via.</span><span class="sxs-lookup"><span data-stu-id="e3dae-210">Country/Region – for example, Ireland, Peru, Hong Kong SAR etc.</span></span> 
- <span data-ttu-id="e3dae-211">Stato/provincia: ad esempio USA-California, Australia-Queensland, Canada-Alberta e così via (nota: questo livello di granularità è supportato solo per gli stati e province di Australia, Canada, Regno Unito e Stati Uniti).</span><span class="sxs-lookup"><span data-stu-id="e3dae-211">State/Province – for example, USA-California, Australia-Queensland, Canada-Alberta etc. (note: this granularity level is supported only for states / provinces in Australia, Canada, UK, and USA).</span></span>

<span data-ttu-id="e3dae-212">Quando un'area o un gruppo di aree è assegnato a un endpoint, tutte le richieste da tali aree vengono instradate solo a tale endpoint.</span><span class="sxs-lookup"><span data-stu-id="e3dae-212">When a region or a set of regions is assigned to an endpoint, any requests from those regions gets routed only to that endpoint.</span></span> <span data-ttu-id="e3dae-213">Gestione traffico usa l'indirizzo IP di origine della query DNS per determinare l'area da cui l'utente sta eseguendo la query: in genere si tratta dell'indirizzo IP del resolver DNS locale che esegue la query per conto dell'utente.</span><span class="sxs-lookup"><span data-stu-id="e3dae-213">Traffic Manager uses the source IP address of the DNS query to determine the region from which a user is querying from – usually this is the IP address of the local DNS resolver doing the query on behalf of the user.</span></span>  

![Metodo geografico di routing del traffico di Gestione traffico di Azure](./media/traffic-manager-routing-methods/geographic.png)

<span data-ttu-id="e3dae-215">Gestione traffico legge l'indirizzo IP di origine della query DNS e decide da quale area geografica è stato originato.</span><span class="sxs-lookup"><span data-stu-id="e3dae-215">Traffic Manager reads the source IP address of the DNS query and decides which geographic region it is originating from.</span></span> <span data-ttu-id="e3dae-216">Verifica quindi se esiste un endpoint a cui è mappata questa area geografica.</span><span class="sxs-lookup"><span data-stu-id="e3dae-216">It then looks to see if there is an endpoint that has this geographic region mapped to it.</span></span> <span data-ttu-id="e3dae-217">Questa ricerca viene avviata al livello di granularità più basso (stato/provincia dove è supportato, altrimenti a livello di paese/area geografica) e arriva fino al livello più alto che è il **mondo**.</span><span class="sxs-lookup"><span data-stu-id="e3dae-217">This lookup starts at the lowest granularity level (State/Province where it is supported, else at the Country/Region level) and goes all the way up to the highest level, which is **World**.</span></span> <span data-ttu-id="e3dae-218">La prima corrispondenza trovata usando questo attraversamento viene indicata come endpoint da restituire nella risposta alla query.</span><span class="sxs-lookup"><span data-stu-id="e3dae-218">The first match found using this traversal is designated as the endpoint to return in the query response.</span></span> <span data-ttu-id="e3dae-219">In caso di corrispondenza con un endpoint di tipo nidificato, viene restituito un endpoint all'interno di tale profilo figlio, in base al suo metodo di routing.</span><span class="sxs-lookup"><span data-stu-id="e3dae-219">When matching with a Nested type endpoint, an endpoint within that child profile is returned, based on its routing method.</span></span> <span data-ttu-id="e3dae-220">I punti seguenti sono applicabili a questo comportamento:</span><span class="sxs-lookup"><span data-stu-id="e3dae-220">The following points are applicable to this behavior:</span></span>

- <span data-ttu-id="e3dae-221">Un'area geografica può essere mappata a un solo endpoint in un profilo di Gestione traffico quando il tipo di routing è quello geografico.</span><span class="sxs-lookup"><span data-stu-id="e3dae-221">A geographic region can be mapped only to one endpoint in a Traffic Manager profile when the routing type is Geographic Routing.</span></span> <span data-ttu-id="e3dae-222">Ciò garantisce che il routing degli utenti sia deterministico e i clienti possano abilitare scenari che richiedono limiti geografici non ambigui.</span><span class="sxs-lookup"><span data-stu-id="e3dae-222">This ensures that routing of users is deterministic, and customers can enable scenarios that require unambiguous geographic boundaries.</span></span>
- <span data-ttu-id="e3dae-223">Se l'area geografica di un utente ricade entro il mapping geografico di due endpoint diversi, Gestione traffico seleziona l'endpoint con la granularità più bassa e non considera le richieste di routing di tale area all'altro endpoint.</span><span class="sxs-lookup"><span data-stu-id="e3dae-223">If a user’s region comes under two different endpoints’ geographic mapping, Traffic Manager selects the endpoint with the lowest granularity and does not consider routing requests from that region to the other endpoint.</span></span> <span data-ttu-id="e3dae-224">Ad esempio, si consideri un profilo con il tipo di routing geografico e con due endpoint: Endpoint1 ed Endpoint2.</span><span class="sxs-lookup"><span data-stu-id="e3dae-224">For example, consider a Geographic Routing type profile with two endpoints - Endpoint1 and Endpoint2.</span></span> <span data-ttu-id="e3dae-225">L'Endpoint1 è configurato per ricevere il traffico dall'Irlanda e l'Endpoint2 è configurato per ricevere il traffico dall'Europa.</span><span class="sxs-lookup"><span data-stu-id="e3dae-225">Endpoint1 is configured to receive traffic from Ireland and Endpoint2 is configured to receive traffic from Europe.</span></span> <span data-ttu-id="e3dae-226">Se una richiesta proviene dall'Irlanda, viene sempre instradata all'Endpoint1.</span><span class="sxs-lookup"><span data-stu-id="e3dae-226">If a request originates from Ireland, it is always routed to Endpoint1.</span></span>
- <span data-ttu-id="e3dae-227">Poiché un'area può essere mappata a un solo endpoint, Gestione traffico la restituisce indipendentemente dal fatto che l'endpoint sia integro o meno.</span><span class="sxs-lookup"><span data-stu-id="e3dae-227">Since a region can be mapped only to one endpoint, Traffic Manager returns it regardless of whether the endpoint is healthy or not.</span></span>

    >[!IMPORTANT]
    ><span data-ttu-id="e3dae-228">È consigliabile che i clienti usino il metodo di routing geografico associato con endpoint di tipo nidificato e profili figlio contenenti almeno due endpoint ciascuno.</span><span class="sxs-lookup"><span data-stu-id="e3dae-228">It is strongly recommended that customers using the geographic routing method associate it with the Nested type endpoints that has child profiles containing at least two endpoints within each.</span></span>
- <span data-ttu-id="e3dae-229">Se viene trovata una corrispondenza di endpoint e l'endpoint è nello stato **Arrestato**, Gestione traffico restituisce una risposta NODATA.</span><span class="sxs-lookup"><span data-stu-id="e3dae-229">If an endpoint match is found and that endpoint is in the **Stopped** state, Traffic Manager returns a NODATA response.</span></span> <span data-ttu-id="e3dae-230">In questo caso non vengono eseguite ulteriori ricerche più in alto nella gerarchia dell'area geografica.</span><span class="sxs-lookup"><span data-stu-id="e3dae-230">In this case, no further lookups is made higher up in the geographic region hierarchy.</span></span> <span data-ttu-id="e3dae-231">Questo comportamento è applicabile anche per i tipi di endpoint annidati quando il profilo figlio è nello stato **Arrestato** o **Disabilitato**.</span><span class="sxs-lookup"><span data-stu-id="e3dae-231">This behavior is also applicable for nested endpoint types when the child profile is in the **Stopped** or **Disabled** state.</span></span>
- <span data-ttu-id="e3dae-232">Se un endpoint si trova nello stato **Disabilitato**, non sarà incluso nel processo di ricerca di corrispondenza dell'area.</span><span class="sxs-lookup"><span data-stu-id="e3dae-232">If an endpoint displays a **Disabled** status, it won’t be included in the region matching process.</span></span> <span data-ttu-id="e3dae-233">Questo comportamento si applica anche per i tipi di endpoint annidati quando l'endpoint si trova nello stato **Disabilitato**.</span><span class="sxs-lookup"><span data-stu-id="e3dae-233">This behavior is also applicable for nested endpoint types when the endpoint is in the **Disabled** state.</span></span>
- <span data-ttu-id="e3dae-234">Se una query proviene da un'area geografica che non ha alcun mapping in quel profilo, Gestione traffico restituisce una risposta NODATA.</span><span class="sxs-lookup"><span data-stu-id="e3dae-234">If a query is coming from a geographic region that has no mapping in that profile, Traffic Manager returns a NODATA response.</span></span> <span data-ttu-id="e3dae-235">Pertanto è consigliabile che i clienti usino il routing geografico con un solo endpoint, idealmente di tipo nidificato con almeno due endpoint all'interno del profilo figlio, con l'area **Mondo** assegnata.</span><span class="sxs-lookup"><span data-stu-id="e3dae-235">Therefore, it is strongly recommended that customers use geographic routing with one endpoint, ideally of type Nested with at least two endpoints within the child profile, with the region **World** assigned to it.</span></span> <span data-ttu-id="e3dae-236">Questo garantisce inoltre che vengano gestiti tutti gli indirizzi IP che non sono mappati a un'area.</span><span class="sxs-lookup"><span data-stu-id="e3dae-236">This also ensures that any IP addresses that do not map to a region are handled.</span></span>

<span data-ttu-id="e3dae-237">Come spiegato in [Modalità di funzionamento di Gestione traffico](traffic-manager-how-traffic-manager-works.md), le query DNS non vengono ricevute direttamente dai client,</span><span class="sxs-lookup"><span data-stu-id="e3dae-237">As explained in [How Traffic Manager Works](traffic-manager-how-traffic-manager-works.md), Traffic Manager does not receive DNS queries directly from clients.</span></span> <span data-ttu-id="e3dae-238">ma dal servizio DNS ricorsivo per il quale sono configurati.</span><span class="sxs-lookup"><span data-stu-id="e3dae-238">Rather, DNS queries come from the recursive DNS service that the clients are configured to use.</span></span> <span data-ttu-id="e3dae-239">Pertanto l'indirizzo IP utilizzato per determinare l'area non è l'indirizzo IP del client ma l'indirizzo IP del servizio DNS ricorsivo.</span><span class="sxs-lookup"><span data-stu-id="e3dae-239">Therefore, the IP address used to determine the region is not the client's IP address, but it is the IP address of the recursive DNS service.</span></span> <span data-ttu-id="e3dae-240">In pratica, questo indirizzo IP è un proxy valido a questo scopo per il client.</span><span class="sxs-lookup"><span data-stu-id="e3dae-240">In practice, this IP address is a good proxy for the client.</span></span>


## <a name="next-steps"></a><span data-ttu-id="e3dae-241">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="e3dae-241">Next steps</span></span>

<span data-ttu-id="e3dae-242">Informazioni su come sviluppare applicazioni a disponibilità elevata tramite [Informazioni sul monitoraggio di Gestione traffico](traffic-manager-monitoring.md)</span><span class="sxs-lookup"><span data-stu-id="e3dae-242">Learn how to develop high-availability applications using [Traffic Manager endpoint monitoring](traffic-manager-monitoring.md)</span></span>

<span data-ttu-id="e3dae-243">Informazioni su come [creare un profilo di Gestione traffico](traffic-manager-create-profile.md)</span><span class="sxs-lookup"><span data-stu-id="e3dae-243">Learn how to [create a Traffic Manager profile](traffic-manager-create-profile.md)</span></span>

<!--Image references-->
[1]: ./media/traffic-manager-routing-methods/priority.png
[2]: ./media/traffic-manager-routing-methods/weighted.png
[3]: ./media/traffic-manager-routing-methods/performance.png



