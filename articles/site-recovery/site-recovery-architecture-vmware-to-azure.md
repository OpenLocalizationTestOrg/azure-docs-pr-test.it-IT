---
title: aaaHow funziona VMware replica tooAzure in Azure Site Recovery? | Microsoft Docs
description: In questo articolo viene fornita una panoramica dei componenti e architettura utilizzata quando la replica locale le macchine virtuali VMware e server fisici tooAzure con hello servizio Azure Site Recovery
services: site-recovery
documentationcenter: 
author: rayne-wiselman
manager: carmonm
editor: 
ms.assetid: c413efcd-d750-4b22-b34b-15bcaa03934a
ms.service: site-recovery
ms.workload: storage-backup-recovery
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: get-started-article
ms.date: 05/29/2017
ms.author: raynew
ROBOTS: NOINDEX, NOFOLLOW
redirect_url: vmware-walkthrough-architecture
ms.openlocfilehash: f0fb834f8b251640f97e4d0163b2b9e54de691e1
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/06/2017
---
# <a name="how-does-vmware-replication-tooazure-work-in-site-recovery"></a><span data-ttu-id="a914c-104">Come funziona tooAzure replica VMware in Site Recovery?</span><span class="sxs-lookup"><span data-stu-id="a914c-104">How does VMware replication tooAzure work in Site Recovery?</span></span>

<span data-ttu-id="a914c-105">Questo articolo vengono descritti i componenti di hello e processi per la replica locale tooAzure macchine virtuali e server fisici Windows/Linux, VMware utilizzando hello [Azure Site Recovery](site-recovery-overview.md) servizio.</span><span class="sxs-lookup"><span data-stu-id="a914c-105">This article describes hello components and processes involved when replicating on-premises VMware virtual machines, and Windows/Linux physical servers, tooAzure using hello [Azure Site Recovery](site-recovery-overview.md) service.</span></span>

<span data-ttu-id="a914c-106">Quando si esegue la replica tooAzure server fisico locale, utilizzato nella replica hello anche stesso componenti e i processi come la replica VMware VM, queste differenze:</span><span class="sxs-lookup"><span data-stu-id="a914c-106">When you replicate physical on-premises servers tooAzure, replication uses also hello same components and processes as VMware VM replication, with these differences:</span></span>

- <span data-ttu-id="a914c-107">È possibile utilizzare un server fisico per i server di configurazione hello, anziché una VM VMware.</span><span class="sxs-lookup"><span data-stu-id="a914c-107">You can use a physical server for hello configuration server, instead of a VMware VM.</span></span>
- <span data-ttu-id="a914c-108">Sarà necessaria un'infrastruttura VMware locale per il failback.</span><span class="sxs-lookup"><span data-stu-id="a914c-108">You will need an on-premises VMware infrastructure for failback.</span></span> <span data-ttu-id="a914c-109">È possibile eseguire il computer fisico tooa indietro.</span><span class="sxs-lookup"><span data-stu-id="a914c-109">You can't fail back tooa physical machine.</span></span>

<span data-ttu-id="a914c-110">Inviare eventuali commenti nella parte inferiore di hello di questo articolo, o porre domande in hello [forum sui servizi di ripristino di Azure](https://social.msdn.microsoft.com/forums/azure/home?forum=hypervrecovmgr).</span><span class="sxs-lookup"><span data-stu-id="a914c-110">Post any comments at hello bottom of this article, or ask questions in hello [Azure Recovery Services Forum](https://social.msdn.microsoft.com/forums/azure/home?forum=hypervrecovmgr).</span></span>


## <a name="architectural-components"></a><span data-ttu-id="a914c-111">Componenti dell'architettura</span><span class="sxs-lookup"><span data-stu-id="a914c-111">Architectural components</span></span>

<span data-ttu-id="a914c-112">Non è coinvolto un numero di componenti per la replica delle macchine virtuali VMware e server fisici tooAzure.</span><span class="sxs-lookup"><span data-stu-id="a914c-112">There are a number of components involved when replicating VMware VMs and physical servers tooAzure.</span></span>

<span data-ttu-id="a914c-113">**Componente**</span><span class="sxs-lookup"><span data-stu-id="a914c-113">**Component**</span></span> | <span data-ttu-id="a914c-114">**Posizione**</span><span class="sxs-lookup"><span data-stu-id="a914c-114">**Location**</span></span> | <span data-ttu-id="a914c-115">**Dettagli**</span><span class="sxs-lookup"><span data-stu-id="a914c-115">**Details**</span></span>
--- | --- | ---
<span data-ttu-id="a914c-116">**Azzurro**</span><span class="sxs-lookup"><span data-stu-id="a914c-116">**Azure**</span></span> | <span data-ttu-id="a914c-117">In Azure sono necessari un account Azure, un account di archiviazione di Azure e una rete di Azure.</span><span class="sxs-lookup"><span data-stu-id="a914c-117">In Azure you need an Azure account, an Azure storage account, and an Azure network.</span></span> | <span data-ttu-id="a914c-118">Dati replicati vengono archiviati nell'account di archiviazione hello e macchine virtuali di Azure vengono create con i dati replicato hello quando si verifica il failover da sito locale.</span><span class="sxs-lookup"><span data-stu-id="a914c-118">Replicated data is stored in hello storage account, and Azure VMs are created with hello replicated data when failover from your on-premises site occurs.</span></span> <span data-ttu-id="a914c-119">Hello macchine virtuali di Azure connettersi toohello rete virtuale di Azure quando vengono creati.</span><span class="sxs-lookup"><span data-stu-id="a914c-119">hello Azure VMs connect toohello Azure virtual network when they're created.</span></span>
<span data-ttu-id="a914c-120">**Server di configurazione**</span><span class="sxs-lookup"><span data-stu-id="a914c-120">**Configuration server**</span></span> | <span data-ttu-id="a914c-121">Un singolo server di gestione (VMWare VM) che esegue tutti i componenti locali hello che sono necessari per la distribuzione di hello, tra cui il server di configurazione di hello, server di elaborazione, il server di destinazione master in locale</span><span class="sxs-lookup"><span data-stu-id="a914c-121">A single on-premises management server (VMWare VM) that runs all hello on-premises components that are needed for hello deployment, including hello configuration server, process server, master target server</span></span> | <span data-ttu-id="a914c-122">componente server di configurazione Hello coordina le comunicazioni tra sedi locali e Azure e gestisce la replica dei dati.</span><span class="sxs-lookup"><span data-stu-id="a914c-122">hello configuration server component coordinates communications between on-premises and Azure, and manages data replication.</span></span>
 <span data-ttu-id="a914c-123">**Server di elaborazione**</span><span class="sxs-lookup"><span data-stu-id="a914c-123">**Process server**:</span></span>  | <span data-ttu-id="a914c-124">Installato per impostazione predefinita nel server di configurazione hello.</span><span class="sxs-lookup"><span data-stu-id="a914c-124">Installed by default on hello configuration server.</span></span> | <span data-ttu-id="a914c-125">Agisce come un gateway di replica.</span><span class="sxs-lookup"><span data-stu-id="a914c-125">Acts as a replication gateway.</span></span> <span data-ttu-id="a914c-126">Riceve dati di replica, consente di ottimizzare con la memorizzazione nella cache, la compressione e crittografia e lo invia tooAzure archiviazione.</span><span class="sxs-lookup"><span data-stu-id="a914c-126">Receives replication data, optimizes it with caching, compression, and encryption, and sends it tooAzure storage.</span></span><br/><br/> <span data-ttu-id="a914c-127">server di elaborazione Hello inoltre gestisce l'installazione push del computer tooprotected del servizio di mobilità hello ed esegue l'individuazione automatica delle macchine virtuali VMware.</span><span class="sxs-lookup"><span data-stu-id="a914c-127">hello process server also handles push installation of hello Mobility service tooprotected machines, and performs automatic discovery of VMware VMs.</span></span><br/><br/> <span data-ttu-id="a914c-128">Man mano che aumenta la distribuzione è possibile aggiungere ulteriori processo dedicato separato server toohandle aumentare i volumi di traffico di replica.</span><span class="sxs-lookup"><span data-stu-id="a914c-128">As your deployment grows you can add additional separate dedicated process servers toohandle increasing volumes of replication traffic.</span></span>
 <span data-ttu-id="a914c-129">**Server master di destinazione**</span><span class="sxs-lookup"><span data-stu-id="a914c-129">**Master target server**</span></span> | <span data-ttu-id="a914c-130">Installato per impostazione predefinita nel server di configurazione di on-premise hello.</span><span class="sxs-lookup"><span data-stu-id="a914c-130">Installed by default on hello on-premises configuration server.</span></span> | <span data-ttu-id="a914c-131">Gestisce i dati di replica durante il failback da Azure.</span><span class="sxs-lookup"><span data-stu-id="a914c-131">Handles replication data during failback from Azure.</span></span><br/><br/> <span data-ttu-id="a914c-132">Se i volumi del traffico di failback sono elevati, è possibile distribuire un server di destinazione master separato per il failback.</span><span class="sxs-lookup"><span data-stu-id="a914c-132">If volumes of failback traffic are high, you can deploy a separate master target server for failback.</span></span>
<span data-ttu-id="a914c-133">**Server VMware**</span><span class="sxs-lookup"><span data-stu-id="a914c-133">**VMware servers**</span></span> | <span data-ttu-id="a914c-134">Le macchine virtuali VMware ospitate su server di vSphere ESXi, si consiglia un vCenter host hello toomanage di server.</span><span class="sxs-lookup"><span data-stu-id="a914c-134">VMware VMs are hosted on vSphere ESXi servers, and we recommend a vCenter server toomanage hello hosts.</span></span> | <span data-ttu-id="a914c-135">Aggiungere un insieme di credenziali VMware server tooyour servizi di ripristino.</span><span class="sxs-lookup"><span data-stu-id="a914c-135">You add VMware servers tooyour Recovery Services vault.</span></span>
<span data-ttu-id="a914c-136">**Computer replicati**</span><span class="sxs-lookup"><span data-stu-id="a914c-136">**Replicated machines**</span></span> | <span data-ttu-id="a914c-137">servizio di mobilità Hello verrà installato in ogni macchina virtuale che si desidera tooreplicate VMware.</span><span class="sxs-lookup"><span data-stu-id="a914c-137">hello Mobility service will be installed on each VMware VM you want tooreplicate.</span></span> <span data-ttu-id="a914c-138">Può essere installato manualmente su ogni computer o con un'installazione push dal server di elaborazione hello.</span><span class="sxs-lookup"><span data-stu-id="a914c-138">It can be installed manually on each machine, or with a push installation from hello process server.</span></span>

<span data-ttu-id="a914c-139">Informazioni sui prerequisiti per la distribuzione hello e requisiti per ognuno di questi componenti in hello [matrice del supporto](site-recovery-support-matrix-to-azure.md).</span><span class="sxs-lookup"><span data-stu-id="a914c-139">Learn about hello deployment prerequisites and requirements for each of these components in hello [support matrix](site-recovery-support-matrix-to-azure.md).</span></span>

<span data-ttu-id="a914c-140">**Figura 1: VMware tooAzure componenti**</span><span class="sxs-lookup"><span data-stu-id="a914c-140">**Figure 1: VMware tooAzure components**</span></span>

![Componenti](./media/site-recovery-components/arch-enhanced.png)

## <a name="replication-process"></a><span data-ttu-id="a914c-142">Processo di replica</span><span class="sxs-lookup"><span data-stu-id="a914c-142">Replication process</span></span>

1. <span data-ttu-id="a914c-143">Impostare la distribuzione di hello, inclusi i componenti di Azure e un insieme di credenziali di servizi di ripristino.</span><span class="sxs-lookup"><span data-stu-id="a914c-143">You set up hello deployment, including Azure components, and a Recovery Services vault.</span></span> <span data-ttu-id="a914c-144">Nell'insieme di credenziali hello specificare origine della replica hello e destinazione, configurare il server di configurazione di hello, aggiungere server VMware, creare un criterio di replica, distribuire il servizio di mobilità hello, abilitare la replica ed eseguire un failover di test.</span><span class="sxs-lookup"><span data-stu-id="a914c-144">In hello vault you specify hello replication source and target, set up hello configuration server, add VMware servers, create a replication policy, deploy hello Mobility service, enable replication, and run a test failover.</span></span>
2.  <span data-ttu-id="a914c-145">Macchine avviare la replica in base ai criteri di replica hello e una copia iniziale dei dati hello è archiviazione tooAzure replicati.</span><span class="sxs-lookup"><span data-stu-id="a914c-145">Machines start replicating in accordance with hello replication policy, and an initial copy of hello data is replicated tooAzure storage.</span></span>
4. <span data-ttu-id="a914c-146">Replica di tooAzure le modifiche delta inizia dopo il completamento della replica iniziale hello.</span><span class="sxs-lookup"><span data-stu-id="a914c-146">Replication of delta changes tooAzure begins after hello initial replication finishes.</span></span> <span data-ttu-id="a914c-147">Le modifiche rilevate vengono salvate in un file HRL.</span><span class="sxs-lookup"><span data-stu-id="a914c-147">Tracked changes for a machine are held in a .hrl file.</span></span>
    - <span data-ttu-id="a914c-148">La replica macchine comunicano con server di configurazione hello sulla porta HTTPS 443 in entrata per la gestione della replica.</span><span class="sxs-lookup"><span data-stu-id="a914c-148">Replicating machines communicate with hello configuration server on port HTTPS 443 inbound, for replication management.</span></span>
    - <span data-ttu-id="a914c-149">La replica macchine inviano server di elaborazione toohello dati di replica sulla porta HTTPS 9443 in ingresso (può essere configurato).</span><span class="sxs-lookup"><span data-stu-id="a914c-149">Replicating machines send replication data toohello process server on port HTTPS 9443 inbound (can be configured).</span></span>
    - <span data-ttu-id="a914c-150">il server di configurazione di Hello Orchestra la gestione di replica in Azure tramite la porta HTTPS 443 in uscita.</span><span class="sxs-lookup"><span data-stu-id="a914c-150">hello configuration server orchestrates replication management with Azure over port HTTPS 443 outbound.</span></span>
    - <span data-ttu-id="a914c-151">server di elaborazione Hello riceve dati dal computer di origine, Ottimizza e crittografa e invia tooAzure archiviazione tramite la porta 443 in uscita.</span><span class="sxs-lookup"><span data-stu-id="a914c-151">hello process server receives data from source machines, optimizes and encrypts it, and sends it tooAzure storage over port 443 outbound.</span></span>
    - <span data-ttu-id="a914c-152">Se si abilita la coerenza tra più macchine, quindi nel gruppo di replica hello macchine comunicano tra loro attraverso la porta 20004.</span><span class="sxs-lookup"><span data-stu-id="a914c-152">If you enable multi-VM consistency, then machines in hello replication group communicate with each other over port 20004.</span></span> <span data-ttu-id="a914c-153">La coerenza tra più VM viene usata se si raggruppano più computer in gruppi di replica che condividono punti di ripristino coerenti con l'arresto anomalo del sistema e coerenti con l'app quando si esegue il failover.</span><span class="sxs-lookup"><span data-stu-id="a914c-153">Multi-VM is used if you group multiple machines into replication groups that share crash-consistent and app-consistent recovery points when they fail over.</span></span> <span data-ttu-id="a914c-154">Ciò è utile se sono in esecuzione macchine hello stesso carico di lavoro ed è necessario toobe coerente.</span><span class="sxs-lookup"><span data-stu-id="a914c-154">This is useful if machines are running hello same workload and need toobe consistent.</span></span>
5. <span data-ttu-id="a914c-155">Il traffico è superiore all'endpoint pubblici di archiviazione replicata tooAzure, hello internet.</span><span class="sxs-lookup"><span data-stu-id="a914c-155">Traffic is replicated tooAzure storage public endpoints, over hello internet.</span></span> <span data-ttu-id="a914c-156">In alternativa, è possibile usare il [peering pubblico](../expressroute/expressroute-circuit-peerings.md#public-peering) di Azure ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="a914c-156">Alternately, you can use Azure ExpressRoute [public peering](../expressroute/expressroute-circuit-peerings.md#public-peering).</span></span> <span data-ttu-id="a914c-157">Non è supportata la replica del traffico tramite una VPN da sito a sito da un tooAzure sito locale.</span><span class="sxs-lookup"><span data-stu-id="a914c-157">Replicating traffic over a site-to-site VPN from an on-premises site tooAzure isn't supported.</span></span>

<span data-ttu-id="a914c-158">**Figura 2: VMware tooAzure replica**</span><span class="sxs-lookup"><span data-stu-id="a914c-158">**Figure 2: VMware tooAzure replication**</span></span>

![Avanzato](./media/site-recovery-components/v2a-architecture-henry.png)

## <a name="failover-and-failback-process"></a><span data-ttu-id="a914c-160">Processo di failover e failback</span><span class="sxs-lookup"><span data-stu-id="a914c-160">Failover and failback process</span></span>

1. <span data-ttu-id="a914c-161">Dopo aver verificato che il failover di test funzioni come previsto, è possibile eseguire failover pianificati tooAzure come richiesto.</span><span class="sxs-lookup"><span data-stu-id="a914c-161">After you verify that test failover is working as expected, you can run unplanned failovers tooAzure as required.</span></span> <span data-ttu-id="a914c-162">Il failover pianificato non è supportato.</span><span class="sxs-lookup"><span data-stu-id="a914c-162">Planned failover isn't supported.</span></span>
2. <span data-ttu-id="a914c-163">È possibile eseguire il failover a un singolo computer o creare [i piani di ripristino](site-recovery-create-recovery-plans.md), toofail in più macchine virtuali.</span><span class="sxs-lookup"><span data-stu-id="a914c-163">You can fail over a single machine, or create [recovery plans](site-recovery-create-recovery-plans.md), toofail over multiple VMs.</span></span>
3. <span data-ttu-id="a914c-164">Quando si esegue un failover, vengono create VM di replica in Azure.</span><span class="sxs-lookup"><span data-stu-id="a914c-164">When you run a failover, replica VMs are created in Azure.</span></span> <span data-ttu-id="a914c-165">Si esegue il commit di un failover toostart accesso hello carico di lavoro dalla replica hello macchina virtuale di Azure.</span><span class="sxs-lookup"><span data-stu-id="a914c-165">You commit a failover toostart accessing hello workload from hello replica Azure VM.</span></span>
4. <span data-ttu-id="a914c-166">Quando il sito locale primario è di nuovo disponibile, è possibile effettuare il failback.</span><span class="sxs-lookup"><span data-stu-id="a914c-166">When your primary on-premises site is available again, you can fail back.</span></span> <span data-ttu-id="a914c-167">Configurare un'infrastruttura di failback, avviare la replica macchina hello da hello del sito secondario toohello primario ed eseguire un failover non pianificato dal sito secondario hello.</span><span class="sxs-lookup"><span data-stu-id="a914c-167">You set up a failback infrastructure, start replicating hello machine from hello secondary site toohello primary, and run an unplanned failover from hello secondary site.</span></span> <span data-ttu-id="a914c-168">Dopo il commit, il failover dati sarà nascosto in locale e occorre tooenable replica tooAzure nuovamente.</span><span class="sxs-lookup"><span data-stu-id="a914c-168">After you commit this failover, data will be back on-premises, and you need tooenable replication tooAzure again.</span></span> [<span data-ttu-id="a914c-169">Altre informazioni</span><span class="sxs-lookup"><span data-stu-id="a914c-169">Learn more</span></span>](site-recovery-failback-azure-to-vmware.md)

<span data-ttu-id="a914c-170">Esistono alcuni requisiti per il failback:</span><span class="sxs-lookup"><span data-stu-id="a914c-170">There are a few failback requirements:</span></span>


- <span data-ttu-id="a914c-171">**Server di elaborazione temporaneo in Azure**: se si desidera toofail da Azure dopo il failover sarà necessario tooset di una macchina virtuale di Azure configurato come un server di elaborazione, la replica toohandle da Azure.</span><span class="sxs-lookup"><span data-stu-id="a914c-171">**Temporary process server in Azure**: If you want toofail back from Azure after failover you'll need tooset up an Azure VM configured as a process server, toohandle replication from Azure.</span></span> <span data-ttu-id="a914c-172">Questa VM può essere eliminata al termine del failback.</span><span class="sxs-lookup"><span data-stu-id="a914c-172">You can delete this VM after failback finishes.</span></span>
- <span data-ttu-id="a914c-173">**Connessione VPN**: per il failback, occorre una connessione VPN (o Azure ExpressRoute) imposta da hello Azure rete toohello nel sito locale.</span><span class="sxs-lookup"><span data-stu-id="a914c-173">**VPN connection**: For failback you'll need a VPN connection (or Azure ExpressRoute) set up from hello Azure network toohello on-premises site.</span></span>
- <span data-ttu-id="a914c-174">**Server di destinazione master locale separato**: server di destinazione master locale hello gestisce il failback.</span><span class="sxs-lookup"><span data-stu-id="a914c-174">**Separate on-premises master target server**: hello on-premises master target server handles failback.</span></span> <span data-ttu-id="a914c-175">server di destinazione master Hello è installato per impostazione predefinita nel server di gestione di hello, ma se si sta riesce nuovamente più grandi volumi di traffico deve configurare un server di destinazione master locale separato per questo scopo.</span><span class="sxs-lookup"><span data-stu-id="a914c-175">hello master target server is installed by default on hello management server, but if you're failing back larger volumes of traffic you should set up a separate on-premises master target server for this purpose.</span></span>
- <span data-ttu-id="a914c-176">**Criteri di failback**: tooyour indietro tooreplicate sito locale, è necessario un criterio di failback.</span><span class="sxs-lookup"><span data-stu-id="a914c-176">**Failback policy**: tooreplicate back tooyour on-premises site, you need a failback policy.</span></span> <span data-ttu-id="a914c-177">che viene creato automaticamente quando si crea il criterio di replica.</span><span class="sxs-lookup"><span data-stu-id="a914c-177">This is automatically created when you created your replication policy.</span></span>
- <span data-ttu-id="a914c-178">**Infrastruttura VMware**: È necessario eseguire il failback tooan locale VM VMware.</span><span class="sxs-lookup"><span data-stu-id="a914c-178">**VMware infrastructure**: You must fail back tooan on-premises VMware VM.</span></span> <span data-ttu-id="a914c-179">Il che richiede un'infrastruttura VMware in locale, anche se si esegue la replica tooAzure server fisici locali.</span><span class="sxs-lookup"><span data-stu-id="a914c-179">This means you need an on-premises VMware infrastructure, even if you're replicating on-premises physical servers tooAzure.</span></span>

<span data-ttu-id="a914c-180">**Figura 3: Failback VMware/fisico**</span><span class="sxs-lookup"><span data-stu-id="a914c-180">**Figure 3: VMware/physical failback**</span></span>

![Failback](./media/site-recovery-components/enhanced-failback.png)


## <a name="next-steps"></a><span data-ttu-id="a914c-182">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="a914c-182">Next steps</span></span>

<span data-ttu-id="a914c-183">Hello revisione [matrice del supporto](site-recovery-support-matrix-to-azure.md)</span><span class="sxs-lookup"><span data-stu-id="a914c-183">Review hello [support matrix](site-recovery-support-matrix-to-azure.md)</span></span>
