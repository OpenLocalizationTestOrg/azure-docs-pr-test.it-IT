---
title: Guida del backup di SAP HANA in macchine virtuali di Azure | Documentazione Microsoft
description: La guida del backup per SAP HANA offre due opzioni principali per il backup di SAP HANA su macchine virtuali di Azure
services: virtual-machines-linux
documentationcenter: 
author: hermanndms
manager: timlt
editor: 
ms.service: virtual-machines-linux
ms.devlang: NA
ms.topic: article
ums.tgt_pltfrm: vm-linux
ms.workload: infrastructure-services
ms.date: 3/13/2017
ms.author: rclaus
ms.openlocfilehash: 9e5b124643b753f404ba6012d3df998f567be59a
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/29/2017
---
# <a name="backup-guide-for-sap-hana-on-azure-virtual-machines"></a><span data-ttu-id="85ffc-103">Guida del backup di SAP HANA in macchine virtuali di Azure</span><span class="sxs-lookup"><span data-stu-id="85ffc-103">Backup guide for SAP HANA on Azure Virtual Machines</span></span>

## <a name="getting-started"></a><span data-ttu-id="85ffc-104">Introduzione</span><span class="sxs-lookup"><span data-stu-id="85ffc-104">Getting Started</span></span>

<span data-ttu-id="85ffc-105">La guida del backup per SAP HANA in esecuzione su macchine virtuali di Azure illustra esclusivamente argomenti specifici di Azure.</span><span class="sxs-lookup"><span data-stu-id="85ffc-105">The backup guide for SAP HANA running on Azure virtual Machines will only describe Azure-specific topics.</span></span> <span data-ttu-id="85ffc-106">Per gli elementi correlati al backup generale di SAP HANA, consultare la documentazione di SAP HANA (vedere _Documentazione di backup per SAP HANA_ più avanti in questo articolo).</span><span class="sxs-lookup"><span data-stu-id="85ffc-106">For general SAP HANA backup related items, check the SAP HANA documentation (see _SAP HANA backup documentation_ later in this article).</span></span>

<span data-ttu-id="85ffc-107">Questo articolo illustra le due principali opzioni di backup per SAP HANA in macchine virtuali di Azure:</span><span class="sxs-lookup"><span data-stu-id="85ffc-107">The focus of this article is on two major backup possibilities for SAP HANA on Azure virtual machines:</span></span>

- <span data-ttu-id="85ffc-108">Backup di HANA nel file system di una macchina virtuale Linux in Azure (vedere [Backup di SAP HANA di Azure a livello di file](sap-hana-backup-file-level.md))</span><span class="sxs-lookup"><span data-stu-id="85ffc-108">HANA backup to the file system in an Azure Linux Virtual Machine (see [SAP HANA Azure Backup on file level](sap-hana-backup-file-level.md))</span></span>
- <span data-ttu-id="85ffc-109">Backup di HANA basato su snapshot di archiviazione attraverso la funzionalità di snapshot del BLOB del servizio di archiviazione di Azure manualmente o con il servizio di Backup di Azure (vedere [Backup di SAP HANA basato su snapshot di archiviazione](sap-hana-backup-storage-snapshots.md))</span><span class="sxs-lookup"><span data-stu-id="85ffc-109">HANA backup based on storage snapshots using the Azure storage blob snapshot feature manually or Azure Backup Service (see [SAP HANA backup based on storage snapshots](sap-hana-backup-storage-snapshots.md))</span></span>

<span data-ttu-id="85ffc-110">SAP HANA offre un'API di backup, che consente agli strumenti di backup di terze parti di integrarsi direttamente con SAP HANA</span><span class="sxs-lookup"><span data-stu-id="85ffc-110">SAP HANA offers a backup API, which allows third-party backup tools to integrate directly with SAP HANA.</span></span> <span data-ttu-id="85ffc-111">(questo argomento non è compreso nella presente guida). Al momento non è prevista alcuna integrazione diretta di SAP HANA con il servizio di Backup di Azure basato su tale API.</span><span class="sxs-lookup"><span data-stu-id="85ffc-111">(That is not within the scope of this guide.) There is no direct integration of SAP HANA with Azure Backup service available right now based on this API.</span></span>

<span data-ttu-id="85ffc-112">SAP HANA è ufficialmente supportato nel tipo di VM di Azure GS5 come singola istanza con un vincolo aggiuntivo sui carichi di lavoro OLAP (vedere [Find Certified IaaS Platforms](https://global.sap.com/community/ebook/2014-09-02-hana-hardware/enEN/iaas.html) (Trova piattaforme IaaS certificate) sul sito Web di SAP).</span><span class="sxs-lookup"><span data-stu-id="85ffc-112">SAP HANA is officially supported on Azure VM type GS5 as single instance with an additional restriction to OLAP workloads (see [Find Certified IaaS Platforms](https://global.sap.com/community/ebook/2014-09-02-hana-hardware/enEN/iaas.html) on the SAP website).</span></span> <span data-ttu-id="85ffc-113">Questo articolo verrà aggiornato non appena saranno disponibili nuove offerte per SAP HANA in Azure.</span><span class="sxs-lookup"><span data-stu-id="85ffc-113">This article will be updated as new offerings for SAP HANA on Azure become available.</span></span>

<span data-ttu-id="85ffc-114">Azure offre anche una soluzione ibrida SAP HANA, in cui SAP HANA viene eseguito in modo non virtualizzato su server fisici.</span><span class="sxs-lookup"><span data-stu-id="85ffc-114">There is also an SAP HANA hybrid solution available on Azure, where SAP HANA runs non-virtualized on physical servers.</span></span> <span data-ttu-id="85ffc-115">La presente guida del backup di SAP HANA in Azure descrive un ambiente di Azure genuino in cui SAP HANA viene eseguito in una VM di Azure, non su &quot;istanze di grandi dimensioni&quot;. Vedere [SAP HANA (large instances) overview and architecture on Azure](hana-overview-architecture.md) (Panoramica e architettura di SAP HANA (istanze di grandi dimensioni) in Azure) per altre informazioni su questa soluzione di backup per &quot;istanze di grandi dimensioni&quot; basate su snapshot di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="85ffc-115">However, this SAP HANA Azure backup guide covers a pure Azure environment where SAP HANA runs in an Azure VM, not SAP HANA running on &quot;large instances.&quot; See [SAP HANA (large instances) overview and architecture on Azure](hana-overview-architecture.md) for more information about this backup solution on &quot;large instances&quot; based on storage snapshots.</span></span>

<span data-ttu-id="85ffc-116">Informazioni generali sui prodotti SAP supportati in Azure sono reperibili in [SAP Note 1928533](https://launchpad.support.sap.com/#/notes/1928533) (Nota SAP 1928533).</span><span class="sxs-lookup"><span data-stu-id="85ffc-116">General information about SAP products supported on Azure can be found in [SAP Note 1928533](https://launchpad.support.sap.com/#/notes/1928533).</span></span>

<span data-ttu-id="85ffc-117">Le seguenti tre figure offrono una panoramica delle opzioni di backup per SAP HANA attraverso funzionalità native di Azure attualmente disponibili e illustrano anche tre potenziali scenari di backup futuri.</span><span class="sxs-lookup"><span data-stu-id="85ffc-117">The following three figures give an overview of the SAP HANA backup options using native Azure capabilities currently, and also show three potential future backup scenarios.</span></span> <span data-ttu-id="85ffc-118">Gli articoli correlati [Backup di SAP HANA di Azure a livello di file](sap-hana-backup-file-level.md) e [Backup di SAP HANA basato su snapshot di archiviazione](sap-hana-backup-storage-snapshots.md) descrivono queste opzioni in modo più dettagliato, con alcune considerazioni sulle dimensioni e le prestazioni per i backup SAP HANA con dimensioni a più terybite.</span><span class="sxs-lookup"><span data-stu-id="85ffc-118">The related articles [SAP HANA Azure Backup on file level](sap-hana-backup-file-level.md) and [SAP HANA backup based on storage snapshots](sap-hana-backup-storage-snapshots.md) describe these options in more detail, including size and performance considerations for SAP HANA backups that are multi-terabytes in size.</span></span>

![La figura seguente mostra due possibilità per salvare lo stato corrente della VM](media/sap-hana-backup-guide/image001.png)

<span data-ttu-id="85ffc-120">La figura seguente mostra la possibilità di salvare lo stato corrente della VM tramite il servizio di Backup di Azure o tramite lo snapshot manuale dei dischi della VM.</span><span class="sxs-lookup"><span data-stu-id="85ffc-120">This figure shows the possibility of saving the current VM state, either via Azure Backup service or manual snapshot of VM disks.</span></span> <span data-ttu-id="85ffc-121">Con questo approccio, non è necessario gestire i backup di SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="85ffc-121">With this approach, one doesn&#39;t have to manage SAP HANA backups.</span></span> <span data-ttu-id="85ffc-122">La sfida posta dallo scenario dello snapshot del disco risiede nella coerenza del file system e in uno stato del disco coerente con l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="85ffc-122">The challenge of the disk snapshot scenario is file system consistency, and an application-consistent disk state.</span></span> <span data-ttu-id="85ffc-123">Sulla coerenza si discuterà nella sezione _Coerenza dei dati SAP HANA durante l'esecuzione degli snapshot di archiviazione_ più avanti in questo articolo.</span><span class="sxs-lookup"><span data-stu-id="85ffc-123">The consistency topic is discussed in the section _SAP HANA data consistency when taking storage snapshots_ later in this article.</span></span> <span data-ttu-id="85ffc-124">Più avanti nel seguente articolo vengono illustrate anche le funzionalità e le restrizioni del servizio di Backup di Azure correlate ai backup di SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="85ffc-124">Capabilities and restrictions of Azure Backup service related to SAP HANA backups are also discussed later in this article.</span></span>

![La figura seguente mostra le opzioni per l'esecuzione di un backup dei file di SAP HANA nella macchina virtuale](media/sap-hana-backup-guide/image002.png)

<span data-ttu-id="85ffc-126">La figura seguente mostra le opzioni per eseguire un backup dei file SAP HANA nella macchina virtuale e quindi archiviare i file di backup HANA in una posizione diversa tramite strumenti differenti.</span><span class="sxs-lookup"><span data-stu-id="85ffc-126">This figure shows options for taking an SAP HANA file backup inside the VM, and then storing it HANA backup files somewhere else using different tools.</span></span> <span data-ttu-id="85ffc-127">L'esecuzione di un backup HANA richiede più tempo rispetto a una soluzione di backup basato su snapshot, ma presenta vantaggi riguardanti l'integrità e la coerenza.</span><span class="sxs-lookup"><span data-stu-id="85ffc-127">Taking a HANA backup requires more time than a snapshot-based backup solution, but it has advantages regarding integrity and consistency.</span></span> <span data-ttu-id="85ffc-128">Altri dettagli sono disponibili più avanti in questo articolo.</span><span class="sxs-lookup"><span data-stu-id="85ffc-128">More details are provided later in this article.</span></span>

![La figura seguente mostra un potenziale scenario futuro di backup di SAP HANA](media/sap-hana-backup-guide/image003.png)

<span data-ttu-id="85ffc-130">La figura seguente mostra un potenziale scenario futuro di backup di SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="85ffc-130">This figure shows a potential future SAP HANA backup scenario.</span></span> <span data-ttu-id="85ffc-131">Se SAP HANA ha consentito l'esecuzione di backup da una replica secondaria, vengono aggiunte altre opzioni per le strategie di backup.</span><span class="sxs-lookup"><span data-stu-id="85ffc-131">If SAP HANA allowed taking backups from a replication secondary, it would add additional options for backup strategies.</span></span> <span data-ttu-id="85ffc-132">Attualmente tale operazione non è possibile, come specificato in un post nella Wiki di SAP HANA:</span><span class="sxs-lookup"><span data-stu-id="85ffc-132">Currently it isn't possible according to a post in the SAP HANA Wiki:</span></span>

<span data-ttu-id="85ffc-133">_&quot;È possibile eseguire i backup sul lato secondario?_</span><span class="sxs-lookup"><span data-stu-id="85ffc-133">_&quot;Is it possible to take backups on the secondary side?_</span></span>

<span data-ttu-id="85ffc-134">_No, attualmente è possibile eseguire solo backup di dati e log sul lato primario. Se il backup automatico dei log è abilitato, dopo l'acquisizione sul lato secondario, i backup dei log verranno scritti automaticamente in questa posizione.&quot;_</span><span class="sxs-lookup"><span data-stu-id="85ffc-134">_No, currently you can only take data and log backups on the primary side. If automatic log backup is enabled, after takeover to the secondary side, the log backups will automatically be written there.&quot;_</span></span>

## <a name="sap-resources-for-hana-backup"></a><span data-ttu-id="85ffc-135">Risorse SAP per il backup di HANA</span><span class="sxs-lookup"><span data-stu-id="85ffc-135">SAP resources for HANA backup</span></span>

### <a name="sap-hana-backup-documentation"></a><span data-ttu-id="85ffc-136">Documentazione sul backup di SAP HANA</span><span class="sxs-lookup"><span data-stu-id="85ffc-136">SAP HANA backup documentation</span></span>

- <span data-ttu-id="85ffc-137">[Introduction to SAP HANA Administration](https://help.sap.com/viewer/6b94445c94ae495c83a19646e7c3fd56/2.0.00/en-US) (Introduzione all'amministrazione di SAP HANA)</span><span class="sxs-lookup"><span data-stu-id="85ffc-137">[Introduction to SAP HANA Administration](https://help.sap.com/viewer/6b94445c94ae495c83a19646e7c3fd56/2.0.00/en-US)</span></span>
- <span data-ttu-id="85ffc-138">[Planning Your Backup and Recovery Strategy](https://help.sap.com/saphelp_hanaplatform/helpdata/en/ef/085cd5949c40b788bba8fd3c65743e/content.htm) (Pianificazione del backup e strategia di ripristino)</span><span class="sxs-lookup"><span data-stu-id="85ffc-138">[Planning Your Backup and Recovery Strategy](https://help.sap.com/saphelp_hanaplatform/helpdata/en/ef/085cd5949c40b788bba8fd3c65743e/content.htm)</span></span>
- <span data-ttu-id="85ffc-139">[Schedule HANA Backup using ABAP DBACOCKPIT](http://www.hanatutorials.com/p/schedule-hana-backup-using-abap.html) (Pianificare il backup di HANA tramite ABAP DBACOCKPIT)</span><span class="sxs-lookup"><span data-stu-id="85ffc-139">[Schedule HANA Backup using ABAP DBACOCKPIT](http://www.hanatutorials.com/p/schedule-hana-backup-using-abap.html)</span></span>
- <span data-ttu-id="85ffc-140">[Schedule Data Backups (SAP HANA Cockpit)](http://help.sap.com/saphelp_hanaplatform/helpdata/en/6d/385fa14ef64a6bab2c97a3d3e40292/frameset.htm) (Pianificare il backup dei dati (Pannello di controllo di SAP HANA)</span><span class="sxs-lookup"><span data-stu-id="85ffc-140">[Schedule Data Backups (SAP HANA Cockpit)](http://help.sap.com/saphelp_hanaplatform/helpdata/en/6d/385fa14ef64a6bab2c97a3d3e40292/frameset.htm)</span></span>
- <span data-ttu-id="85ffc-141">Domande frequenti sul backup di SAP HANA in [Nota SAP 1642148](https://launchpad.support.sap.com/#/notes/1642148)</span><span class="sxs-lookup"><span data-stu-id="85ffc-141">FAQ about SAP HANA backup in [SAP Note 1642148](https://launchpad.support.sap.com/#/notes/1642148)</span></span>
- <span data-ttu-id="85ffc-142">Domande frequenti sugli snapshot di archiviazione e dei database di SAP HANA in [Nota SAP 2039883](https://launchpad.support.sap.com/#/notes/2039883)</span><span class="sxs-lookup"><span data-stu-id="85ffc-142">FAQ about SAP HANA database and storage snapshots in [SAP Note 2039883](https://launchpad.support.sap.com/#/notes/2039883)</span></span>
- <span data-ttu-id="85ffc-143">File system di rete non appropriati per il backup e il ripristino in [Nota SAP 1820529](https://launchpad.support.sap.com/#/notes/1820529)</span><span class="sxs-lookup"><span data-stu-id="85ffc-143">Unsuitable network file systems for backup and recovery in [SAP Note 1820529](https://launchpad.support.sap.com/#/notes/1820529)</span></span>

### <a name="why-sap-hana-backup"></a><span data-ttu-id="85ffc-144">Perché eseguire il backup di SAP HANA?</span><span class="sxs-lookup"><span data-stu-id="85ffc-144">Why SAP HANA backup?</span></span>

<span data-ttu-id="85ffc-145">Archiviazione di Azure offre disponibilità e affidabilità pronte all'uso (vedere [Introduzione ad Archiviazione di Microsoft Azure](../../../storage/common/storage-introduction.md) per altre informazioni sull'archiviazione di Azure).</span><span class="sxs-lookup"><span data-stu-id="85ffc-145">Azure storage offers availability and reliability out of the box (see [Introduction to Microsoft Azure Storage](../../../storage/common/storage-introduction.md) for more information about Azure storage).</span></span>

<span data-ttu-id="85ffc-146">Il requisito minimo per il &quot;backup&quot; è affidarsi ai contratti di servizio Azure, mantenendo i file di dati e log di SAP HANA nei dischi rigidi virtuali di Azure collegati alla macchina virtuale del server di SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="85ffc-146">The minimum for &quot;backup&quot; is to rely on the Azure SLAs, keeping the SAP HANA data and log files on Azure VHDs attached to the SAP HANA server VM.</span></span> <span data-ttu-id="85ffc-147">Questo approccio copre gli errori della macchina virtuale, ma non i possibili danni ai file di dati e log di SAP HANA o gli errori logici, ad esempio l'eliminazione accidentale di dati o file.</span><span class="sxs-lookup"><span data-stu-id="85ffc-147">This approach covers VM failures, but not potential damage to the SAP HANA data and log files, or logical errors like deleting data or files by accident.</span></span> <span data-ttu-id="85ffc-148">I backup sono necessari anche per motivi legali o di conformità.</span><span class="sxs-lookup"><span data-stu-id="85ffc-148">Backups are also required for compliance or legal reasons.</span></span> <span data-ttu-id="85ffc-149">In breve, è sempre necessario eseguire backup di SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="85ffc-149">In short, there is always a need for SAP HANA backups.</span></span>

### <a name="how-to-verify-correctness-of-sap-hana-backup"></a><span data-ttu-id="85ffc-150">Come verificare la correttezza del backup di SAP HANA</span><span class="sxs-lookup"><span data-stu-id="85ffc-150">How to verify correctness of SAP HANA backup</span></span>
<span data-ttu-id="85ffc-151">Quando si usano gli snapshot di archiviazione, è consigliabile eseguire un ripristino di prova su un sistema differente.</span><span class="sxs-lookup"><span data-stu-id="85ffc-151">When using storage snapshots, running a test restore on a different system is recommended.</span></span> <span data-ttu-id="85ffc-152">Questo approccio offre un modo per verificare che la copia di backup sia corretta e che i processi interni per il backup e il ripristino funzionino come previsto.</span><span class="sxs-lookup"><span data-stu-id="85ffc-152">This approach provides a way to ensure that a backup is correct, and internal processes for backup and restore work as expected.</span></span> <span data-ttu-id="85ffc-153">Mentre tale operazione, in locale, rappresenta un notevole ostacolo, è molto più semplice da eseguire nel cloud fornendo temporaneamente le risorse necessarie per questo scopo.</span><span class="sxs-lookup"><span data-stu-id="85ffc-153">While this is a significant hurdle on-premises, it is much easier to accomplish in the cloud by providing necessary resources temporarily for this purpose.</span></span>

<span data-ttu-id="85ffc-154">Tenere presente che eseguire un semplice ripristino e verificare che HANA sia attivo e in esecuzione non è sufficiente.</span><span class="sxs-lookup"><span data-stu-id="85ffc-154">Keep in mind that doing a simple restore and checking if HANA is up and running is not sufficient.</span></span> <span data-ttu-id="85ffc-155">In teoria, si dovrebbe eseguire una verifica della coerenza della tabella per verificare che il database sia stato ripristinato correttamente.</span><span class="sxs-lookup"><span data-stu-id="85ffc-155">Ideally, one should run a table consistency check to be sure that the restored database is fine.</span></span> <span data-ttu-id="85ffc-156">SAP HANA offre diversi tipi di verifiche della coerenza, descritti nella [Nota SAP 1977584](https://launchpad.support.sap.com/#/notes/1977584).</span><span class="sxs-lookup"><span data-stu-id="85ffc-156">SAP HANA offers several kinds of consistency checks described in [SAP Note 1977584](https://launchpad.support.sap.com/#/notes/1977584).</span></span>

<span data-ttu-id="85ffc-157">Informazioni sulla verifica della coerenza della tabella sono reperibili anche nel sito Web di SAP in [Table and Catalog Consistency Checks](http://help.sap.com/saphelp_hanaplatform/helpdata/en/25/84ec2e324d44529edc8221956359ea/content.htm#loio9357bf52c7324bee9567dca417ad9f8b) (Verifiche della coerenza di tabelle e cataloghi).</span><span class="sxs-lookup"><span data-stu-id="85ffc-157">Information about the table consistency check can also be found on the SAP website at [Table and Catalog Consistency Checks](http://help.sap.com/saphelp_hanaplatform/helpdata/en/25/84ec2e324d44529edc8221956359ea/content.htm#loio9357bf52c7324bee9567dca417ad9f8b).</span></span>

<span data-ttu-id="85ffc-158">Per il backup di file standard, non è necessario eseguire un ripristino di prova.</span><span class="sxs-lookup"><span data-stu-id="85ffc-158">For standard file backups, a test restore is not necessary.</span></span> <span data-ttu-id="85ffc-159">Sono disponibili due strumenti di SAP HANA che consentono di controllare quale backup può essere usato per il ripristino: hdbbackupdiag e hdbbackupcheck.</span><span class="sxs-lookup"><span data-stu-id="85ffc-159">There are two SAP HANA tools that help to check which backup can be used for restore: hdbbackupdiag and hdbbackupcheck.</span></span> <span data-ttu-id="85ffc-160">Vedere [Manually Checking Whether a Recovery is Possible](https://help.sap.com/saphelp_hanaplatform/helpdata/en/77/522ef1e3cb4d799bab33e0aeb9c93b/content.htm) (Verifica manuale della fattibilità di un ripristino) per altre informazioni su questi strumenti.</span><span class="sxs-lookup"><span data-stu-id="85ffc-160">See [Manually Checking Whether a Recovery is Possible](https://help.sap.com/saphelp_hanaplatform/helpdata/en/77/522ef1e3cb4d799bab33e0aeb9c93b/content.htm) for more information about these tools.</span></span>

### <a name="pros-and-cons-of-hana-backup-versus-storage-snapshot"></a><span data-ttu-id="85ffc-161">Vantaggi e svantaggi dei backup di HANA rispetto agli snapshot di archiviazione</span><span class="sxs-lookup"><span data-stu-id="85ffc-161">Pros and cons of HANA backup versus storage snapshot</span></span>

<span data-ttu-id="85ffc-162">SAP non esprime preferenze tra l'esecuzione del backup di HANA e lo snapshot di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="85ffc-162">SAP doesn&#39;t give preference to either HANA backup versus storage snapshot.</span></span> <span data-ttu-id="85ffc-163">SAP elenca vantaggi e svantaggi, in modo che l'utente possa determinare quale usare a seconda della situazione e della tecnologia di archiviazione disponibile. Vedere [Planning Your Backup and Recovery Strategy](https://help.sap.com/saphelp_hanaplatform/helpdata/en/ef/085cd5949c40b788bba8fd3c65743e/content.htm) (Pianificazione del backup e strategia di ripristino).</span><span class="sxs-lookup"><span data-stu-id="85ffc-163">It lists their pros and cons, so one can determine which to use depending on the situation and available storage technology (see [Planning Your Backup and Recovery Strategy](https://help.sap.com/saphelp_hanaplatform/helpdata/en/ef/085cd5949c40b788bba8fd3c65743e/content.htm)).</span></span>

<span data-ttu-id="85ffc-164">In Azure, tenere in considerazione il fatto che la funzionalità dello snapshot del BLOB di Azure non garantisce coerenza dei file system. Vedere [Using blob snapshots with PowerShell](https://blogs.msdn.microsoft.com/cie/2016/05/17/using-blob-snapshots-with-powershell/)(Uso degli snapshot BLOB con PowerShell).</span><span class="sxs-lookup"><span data-stu-id="85ffc-164">On Azure, be aware of the fact that the Azure blob snapshot feature doesn&#39;t guarantee file system consistency (see [Using blob snapshots with PowerShell](https://blogs.msdn.microsoft.com/cie/2016/05/17/using-blob-snapshots-with-powershell/)).</span></span> <span data-ttu-id="85ffc-165">Nella sezione successiva, _Coerenza dei dati SAP HANA durante l'esecuzione degli snapshot di archiviazione_, vengono presentate alcune considerazioni su questa funzionalità.</span><span class="sxs-lookup"><span data-stu-id="85ffc-165">The next section, _SAP HANA data consistency when taking storage snapshots_, discusses some considerations regarding this feature.</span></span>

<span data-ttu-id="85ffc-166">È anche necessario comprendere le implicazioni di fatturazione quando si lavora spesso con gli snapshot del BLOB, come descritto in questo articolo: [Informazioni sull'incremento dei costi dovuto agli snapshot](/rest/api/storageservices/understanding-how-snapshots-accrue-charges). Non è scontato come per l'uso dei dischi virtuali di Azure.</span><span class="sxs-lookup"><span data-stu-id="85ffc-166">In addition, one has to understand the billing implications when working frequently with blob snapshots as described in this article: [Understanding How Snapshots Accrue Charges](/rest/api/storageservices/understanding-how-snapshots-accrue-charges)—it isn&#39;t as obvious as using Azure virtual disks.</span></span>

### <a name="sap-hana-data-consistency-when-taking-storage-snapshots"></a><span data-ttu-id="85ffc-167">Coerenza dei dati SAP HANA durante l'esecuzione degli snapshot di archiviazione</span><span class="sxs-lookup"><span data-stu-id="85ffc-167">SAP HANA data consistency when taking storage snapshots</span></span>

<span data-ttu-id="85ffc-168">La coerenza del file system e dell'applicazione è un problema complesso quando si eseguono snapshot di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="85ffc-168">File system and application consistency is a complex issue when taking storage snapshots.</span></span> <span data-ttu-id="85ffc-169">Il modo più semplice per evitare problemi è quello di arrestare SAP HANA o l'intera macchina virtuale.</span><span class="sxs-lookup"><span data-stu-id="85ffc-169">The easiest way to avoid problems would be to shut down SAP HANA, or maybe even the whole virtual machine.</span></span> <span data-ttu-id="85ffc-170">L'arresto potrebbe essere eseguibile tramite demo, prototipo o anche tramite un sistema di sviluppo, ma non è un'opzione per un sistema di produzione.</span><span class="sxs-lookup"><span data-stu-id="85ffc-170">A shutdown might be doable with a demo or prototype, or even a development system, but it is not an option for a production system.</span></span>

<span data-ttu-id="85ffc-171">In Azure è necessario tenere presente che la funzionalità di snapshot del BLOB di Azure non garantisce la coerenza del file system.</span><span class="sxs-lookup"><span data-stu-id="85ffc-171">On Azure, one has to keep in mind that the Azure blob snapshot feature doesn&#39;t guarantee file system consistency.</span></span> <span data-ttu-id="85ffc-172">Tuttavia, funziona correttamente usando la funzionalità di snapshot di SAP HANA, a condizione che sia coinvolto un singolo disco virtuale.</span><span class="sxs-lookup"><span data-stu-id="85ffc-172">It works fine however by using the SAP HANA snapshot feature, as long as there is only a single virtual disk involved.</span></span> <span data-ttu-id="85ffc-173">Anche con un singolo disco, è necessario controllare alcuni elementi aggiuntivi.</span><span class="sxs-lookup"><span data-stu-id="85ffc-173">But even with a single disk, additional items have to be checked.</span></span> <span data-ttu-id="85ffc-174">La [Nota SAP 2039883](https://launchpad.support.sap.com/#/notes/2039883) contiene importanti informazioni sui backup di SAP HANA tramite gli snapshot di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="85ffc-174">[SAP Note 2039883](https://launchpad.support.sap.com/#/notes/2039883) has important information about SAP HANA backups via storage snapshots.</span></span> <span data-ttu-id="85ffc-175">Ad esempio, la nota fa riferimento al fatto che, con il file system XFS, è necessario eseguire **xfs\_freeze** prima di avviare uno snapshot di archiviazione per garantire la coerenza (vedere [xfs\_freeze(8) - Linux man page](https://linux.die.net/man/8/xfs_freeze) per informazioni dettagliate su **xfs\_freeze**).</span><span class="sxs-lookup"><span data-stu-id="85ffc-175">For example, it mentions that, with the XFS file system, it is necessary to run **xfs\_freeze** before starting a storage snapshot to guarantee consistency (see [xfs\_freeze(8) - Linux man page](https://linux.die.net/man/8/xfs_freeze) for details on **xfs\_freeze**).</span></span>

<span data-ttu-id="85ffc-176">L'argomento della coerenza diventa anche più complesso nel caso in cui un singolo file system si estenda su più dischi/volumi.</span><span class="sxs-lookup"><span data-stu-id="85ffc-176">The topic of consistency becomes even more challenging in a case where a single file system spans multiple disks/volumes.</span></span> <span data-ttu-id="85ffc-177">Ad esempio, tramite mdadm o LVM e lo striping.</span><span class="sxs-lookup"><span data-stu-id="85ffc-177">For example, by using mdadm or LVM and striping.</span></span> <span data-ttu-id="85ffc-178">La nota SAP indicata in precedenza afferma:</span><span class="sxs-lookup"><span data-stu-id="85ffc-178">The SAP Note mentioned above states:</span></span>

<span data-ttu-id="85ffc-179">_&quot;Tenere tuttavia presente che il sistema di archiviazione deve garantire coerenza I/O durante la creazione di uno snapshot di archiviazione per ogni volume di dati di SAP HANA, ovvero l'esecuzione dello snapshot di un volume di dati specifico del servizio SAP HANA deve essere un'operazione atomica.&quot;_</span><span class="sxs-lookup"><span data-stu-id="85ffc-179">_&quot;But keep in mind that the storage system has to guarantee I/O consistency while creating a storage snapshot per SAP HANA data volume, i.e. snapshotting of an SAP HANA service-specific data volume must be an atomic operation.&quot;_</span></span>

<span data-ttu-id="85ffc-180">Presupponendo che sia presente un file system XFS che si estende su quattro dischi virtuali di Azure, i passaggi seguenti offrono uno snapshot coerente che rappresenta l'area dati HANA:</span><span class="sxs-lookup"><span data-stu-id="85ffc-180">Assuming there is an XFS file system spanning four Azure virtual disks, the following steps provide a consistent snapshot that represents the HANA data area:</span></span>

- <span data-ttu-id="85ffc-181">Preparazione dello snapshot HANA</span><span class="sxs-lookup"><span data-stu-id="85ffc-181">HANA snapshot prepare</span></span>
- <span data-ttu-id="85ffc-182">Bloccare il file system (ad esempio, usare **xfs\_freeze**).</span><span class="sxs-lookup"><span data-stu-id="85ffc-182">Freeze the file system (for example, use **xfs\_freeze**)</span></span>
- <span data-ttu-id="85ffc-183">Creare tutti gli snapshot BLOB necessari in Azure.</span><span class="sxs-lookup"><span data-stu-id="85ffc-183">Create all necessary blob snapshots on Azure</span></span>
- <span data-ttu-id="85ffc-184">Sbloccare il file system.</span><span class="sxs-lookup"><span data-stu-id="85ffc-184">Unfreeze the file system</span></span>
- <span data-ttu-id="85ffc-185">Confermare lo snapshot HANA.</span><span class="sxs-lookup"><span data-stu-id="85ffc-185">Confirm the HANA snapshot</span></span>

<span data-ttu-id="85ffc-186">Si consiglia di usare la procedura indicata in alto in tutti i casi per essere al sicuro, indipendentemente dal file system.</span><span class="sxs-lookup"><span data-stu-id="85ffc-186">Recommendation is to use the procedure above in all cases to be on the safe side, no matter which file system.</span></span> <span data-ttu-id="85ffc-187">In alternativa, se si tratta di un singolo disco o dello striping, usare mdadm o LVM nei diversi dischi.</span><span class="sxs-lookup"><span data-stu-id="85ffc-187">Or if it is a single disk or striping, via mdadm or LVM across multiple disks.</span></span>

<span data-ttu-id="85ffc-188">È importante confermare lo snapshot HANA.</span><span class="sxs-lookup"><span data-stu-id="85ffc-188">It is important to confirm the HANA snapshot.</span></span> <span data-ttu-id="85ffc-189">A causa di &quot;Copy-on-Write&quot; SAP HANA potrebbe non richiedere altro spazio sul disco in questa modalità di preparazione dello snapshot.</span><span class="sxs-lookup"><span data-stu-id="85ffc-189">Due to the &quot;Copy-on-Write,&quot; SAP HANA might not require additional disk space while in this snapshot-prepare mode.</span></span> <span data-ttu-id="85ffc-190">Non è neanche possibile avviare nuovi backup fino a quando lo snapshot di SAP HANA non viene confermato.</span><span class="sxs-lookup"><span data-stu-id="85ffc-190">It&#39;s also not possible to start new backups until the SAP HANA snapshot is confirmed.</span></span>

<span data-ttu-id="85ffc-191">Il servizio di Backup di Azure usa le estensioni della macchina virtuale di Azure per occuparsi della coerenza dei file system.</span><span class="sxs-lookup"><span data-stu-id="85ffc-191">Azure Backup service uses Azure VM extensions to take care of the file system consistency.</span></span> <span data-ttu-id="85ffc-192">Queste estensioni della macchina virtuale non sono disponibili per l'uso autonomo.</span><span class="sxs-lookup"><span data-stu-id="85ffc-192">These VM extensions are not available for standalone usage.</span></span> <span data-ttu-id="85ffc-193">È comunque necessario gestire la coerenza di SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="85ffc-193">One still has to manage SAP HANA consistency.</span></span> <span data-ttu-id="85ffc-194">Vedere l'articolo correlato [Backup di SAP HANA di Azure a livello di file](sap-hana-backup-file-level.md) per altre informazioni.</span><span class="sxs-lookup"><span data-stu-id="85ffc-194">See the related article [SAP HANA Azure Backup on file level](sap-hana-backup-file-level.md) for more information.</span></span>

### <a name="sap-hana-backup-scheduling-strategy"></a><span data-ttu-id="85ffc-195">Strategia di pianificazione del backup di SAP HANA</span><span class="sxs-lookup"><span data-stu-id="85ffc-195">SAP HANA backup scheduling strategy</span></span>

<span data-ttu-id="85ffc-196">L'articolo di SAP HANA [Planning Your Backup and Recovery Strategy](https://help.sap.com/saphelp_hanaplatform/helpdata/en/ef/085cd5949c40b788bba8fd3c65743e/content.htm) (Pianificazione del backup e strategia di ripristino) indica un piano di base per eseguire i backup:</span><span class="sxs-lookup"><span data-stu-id="85ffc-196">The SAP HANA article [Planning Your Backup and Recovery Strategy](https://help.sap.com/saphelp_hanaplatform/helpdata/en/ef/085cd5949c40b788bba8fd3c65743e/content.htm) states a basic plan to do backups:</span></span>

- <span data-ttu-id="85ffc-197">Snapshot di archiviazione (giornaliero)</span><span class="sxs-lookup"><span data-stu-id="85ffc-197">Storage snapshot (daily)</span></span>
- <span data-ttu-id="85ffc-198">Backup completo dei dati tramite il formato di file o backint (una volta alla settimana)</span><span class="sxs-lookup"><span data-stu-id="85ffc-198">Complete data backup using file or bacint format (once a week)</span></span>
- <span data-ttu-id="85ffc-199">Backup automatici dei log</span><span class="sxs-lookup"><span data-stu-id="85ffc-199">Automatic log backups</span></span>

<span data-ttu-id="85ffc-200">Facoltativamente, è possibile procedere completamente senza snapshot di archiviazione. Questi possono essere sostituiti da backup delta di HANA, ad esempio backup incrementali o differenziali. Vedere [Delta Backups](https://help.sap.com/saphelp_hanaplatform/helpdata/en/c3/bb7e33bb571014a03eeabba4e37541/content.htm) (Backup delta).</span><span class="sxs-lookup"><span data-stu-id="85ffc-200">Optionally, one could go completely without storage snapshots; they could be replaced by HANA delta backups, like incremental or differential backups (see [Delta Backups](https://help.sap.com/saphelp_hanaplatform/helpdata/en/c3/bb7e33bb571014a03eeabba4e37541/content.htm)).</span></span>

<span data-ttu-id="85ffc-201">La guida all'amministrazione di HANA offre un elenco di esempio.</span><span class="sxs-lookup"><span data-stu-id="85ffc-201">The HANA Administration guide provides an example list.</span></span> <span data-ttu-id="85ffc-202">Si consiglia di ripristinare SAP HANA in uno specifico punto nel tempo usando la sequenza di backup seguente:</span><span class="sxs-lookup"><span data-stu-id="85ffc-202">It suggests that one recover SAP HANA to a specific point in time using the following sequence of backups:</span></span>

1. <span data-ttu-id="85ffc-203">Backup completo dei dati</span><span class="sxs-lookup"><span data-stu-id="85ffc-203">Full data backup</span></span>
2. <span data-ttu-id="85ffc-204">Backup differenziale</span><span class="sxs-lookup"><span data-stu-id="85ffc-204">Differential backup</span></span>
3. <span data-ttu-id="85ffc-205">Backup incrementale 1</span><span class="sxs-lookup"><span data-stu-id="85ffc-205">Incremental backup 1</span></span>
4. <span data-ttu-id="85ffc-206">Backup incrementale 2</span><span class="sxs-lookup"><span data-stu-id="85ffc-206">Incremental backup 2</span></span>
5. <span data-ttu-id="85ffc-207">Backup dei log</span><span class="sxs-lookup"><span data-stu-id="85ffc-207">Log backups</span></span>

<span data-ttu-id="85ffc-208">Per quanto riguarda una pianificazione esatta di quando e con quale frequenza deve essere svolto un tipo di backup specifico, non è possibile fornire linee guida generali: si tratta di un elemento specifico del cliente, che dipende dal numero di modifiche dei dati che si verifica nel sistema.</span><span class="sxs-lookup"><span data-stu-id="85ffc-208">Regarding an exact schedule as to when and how often a specific backup type should happen, it is not possible to give a general guideline—it is too customer-specific, and depends on how many data changes occur in the system.</span></span> <span data-ttu-id="85ffc-209">Un consiglio di base dal lato SAP, che può essere considerato come linea guida generale, è quello di eseguire un backup HANA completo una volta alla settimana.</span><span class="sxs-lookup"><span data-stu-id="85ffc-209">One basic recommendation from SAP side, which can be seen as general guidance, is to make one full HANA backup once a week.</span></span>
<span data-ttu-id="85ffc-210">Per quanto riguarda i backup dei log, vedere la documentazione di SAP HANA [Log Backups](https://help.sap.com/saphelp_hanaplatform/helpdata/en/c3/bb7e33bb571014a03eeabba4e37541/content.htm) (Backup dei log).</span><span class="sxs-lookup"><span data-stu-id="85ffc-210">Regarding log backups, see the SAP HANA documentation [Log Backups](https://help.sap.com/saphelp_hanaplatform/helpdata/en/c3/bb7e33bb571014a03eeabba4e37541/content.htm).</span></span>

<span data-ttu-id="85ffc-211">SAP consiglia anche di eseguire alcune attività di manutenzione del catalogo di backup per impedirgli di crescere all'infinito. Vedere [Housekeeping for Backup Catalog and Backup Storage](http://help.sap.com/saphelp_hanaplatform/helpdata/en/ca/c903c28b0e4301b39814ef41dbf568/content.htm) (Manutenzione del catalogo e dell'archiviazione dei backup).</span><span class="sxs-lookup"><span data-stu-id="85ffc-211">SAP also recommends doing some housekeeping of the backup catalog to keep it from growing infinitely (see [Housekeeping for Backup Catalog and Backup Storage](http://help.sap.com/saphelp_hanaplatform/helpdata/en/ca/c903c28b0e4301b39814ef41dbf568/content.htm)).</span></span>

### <a name="sap-hana-configuration-files"></a><span data-ttu-id="85ffc-212">File di configurazione di SAP HANA</span><span class="sxs-lookup"><span data-stu-id="85ffc-212">SAP HANA configuration files</span></span>

<span data-ttu-id="85ffc-213">Come indicato nelle domande frequenti contenute nella [Nota SAP 1642148](https://launchpad.support.sap.com/#/notes/1642148), i file di configurazione SAP HANA non fanno parte di un backup HANA standard.</span><span class="sxs-lookup"><span data-stu-id="85ffc-213">As stated in the FAQ in [SAP Note 1642148](https://launchpad.support.sap.com/#/notes/1642148), the SAP HANA configuration files are not part of a standard HANA backup.</span></span> <span data-ttu-id="85ffc-214">Non sono essenziali per il ripristino di un sistema.</span><span class="sxs-lookup"><span data-stu-id="85ffc-214">They are not essential to restore a system.</span></span> <span data-ttu-id="85ffc-215">La configurazione HANA può essere modificata manualmente dopo il ripristino.</span><span class="sxs-lookup"><span data-stu-id="85ffc-215">The HANA configuration could be changed manually after the restore.</span></span> <span data-ttu-id="85ffc-216">Nel caso in cui si desideri ottenere la stessa configurazione personalizzata durante il processo di ripristino, è necessario eseguire il backup dei file di configurazione HANA separatamente.</span><span class="sxs-lookup"><span data-stu-id="85ffc-216">In case one would like to get the same custom configuration during the restore process, it is necessary to back up the HANA configuration files separately.</span></span>

<span data-ttu-id="85ffc-217">Se i backup HANA standard passano a un file system di backup HANA dedicato, è anche possibile copiare i file di configurazione nello stesso file system del backup e quindi copiare tutti gli elementi insieme nella destinazione di archiviazione finale come l'archiviazione BLOB per accesso sporadico.</span><span class="sxs-lookup"><span data-stu-id="85ffc-217">If standard HANA backups are going to a dedicated HANA backup file system, one could also copy the configuration files to the same backup filesystem, and then copy everything together to the final storage destination like cool blob storage.</span></span>

### <a name="sap-hana-cockpit"></a><span data-ttu-id="85ffc-218">Pannello di controllo SAP HANA</span><span class="sxs-lookup"><span data-stu-id="85ffc-218">SAP HANA Cockpit</span></span>

<span data-ttu-id="85ffc-219">Il pannello di controllo di SAP HANA offre la possibilità di monitorare e gestire di SAP HANA attraverso un browser.</span><span class="sxs-lookup"><span data-stu-id="85ffc-219">SAP HANA Cockpit offers the possibility of monitoring and managing SAP HANA via a browser.</span></span> <span data-ttu-id="85ffc-220">Consente anche la gestione dei backup di SAP HANA e pertanto può essere usato come alternativa a SAP HANA Studio e ad ABAP DBACOCKPIT. Vedere [SAP HANA Cockpit](https://help.sap.com/saphelp_hanaplatform/helpdata/en/73/c37822444344f3973e0e976b77958e/content.htm) (Pannello di controllo SAP HANA) per altre informazioni.</span><span class="sxs-lookup"><span data-stu-id="85ffc-220">It also allows handling of SAP HANA backups, and therefore can be used as an alternative to SAP HANA Studio and ABAP DBACOCKPIT (see [SAP HANA Cockpit](https://help.sap.com/saphelp_hanaplatform/helpdata/en/73/c37822444344f3973e0e976b77958e/content.htm) for more information).</span></span>

![Nella figura viene mostrata la schermata di gestione del database del pannello di controllo SAP HANA](media/sap-hana-backup-guide/image004.png)

<span data-ttu-id="85ffc-222">Nella figura viene mostrata la schermata di gestione del database del pannello di controllo di SAP HANA e il riquadro del backup sulla sinistra.</span><span class="sxs-lookup"><span data-stu-id="85ffc-222">This figure shows the SAP HANA Cockpit Database Administration Screen, and the backup tile on the left.</span></span> <span data-ttu-id="85ffc-223">Per visualizzare il riquadro del backup sono necessarie adeguate autorizzazioni per l'utente sull'account di accesso.</span><span class="sxs-lookup"><span data-stu-id="85ffc-223">Seeing the backup tile requires appropriate user permissions for login account.</span></span>

![I backup possono essere monitorati nel pannello di controllo di SAP HANA durante l'esecuzione.](media/sap-hana-backup-guide/image005.png)

<span data-ttu-id="85ffc-225">I backup possono essere monitorati nel pannello di controllo di SAP HANA durante l'esecuzione e, al termine, saranno disponibili tutti i dettagli sul backup.</span><span class="sxs-lookup"><span data-stu-id="85ffc-225">Backups can be monitored in SAP HANA Cockpit while they are ongoing and, once it is finished, all the backup details are available.</span></span>

![Esempio di uso di Firefox in una macchina virtuale 12 SLES di Azure con desktop Gnome](media/sap-hana-backup-guide/image006.png)

<span data-ttu-id="85ffc-227">Le schermate precedenti sono state acquisite da una macchina virtuale Windows Azure.</span><span class="sxs-lookup"><span data-stu-id="85ffc-227">The previous screenshots were made from an Azure Windows VM.</span></span> <span data-ttu-id="85ffc-228">Questo è un esempio di uso di Firefox in una macchina virtuale 12 SLES di Azure con desktop Gnome,</span><span class="sxs-lookup"><span data-stu-id="85ffc-228">This one is an example using Firefox on an Azure SLES 12 VM with Gnome desktop.</span></span> <span data-ttu-id="85ffc-229">che mostra l'opzione per definire le pianificazioni di backup di SAP HANA nel pannello di controllo di SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="85ffc-229">It shows the option to define SAP HANA backup schedules in SAP HANA Cockpit.</span></span> <span data-ttu-id="85ffc-230">Come si può osservare, è consigliabile inserire data/ora come prefisso per i file di backup.</span><span class="sxs-lookup"><span data-stu-id="85ffc-230">As one can also see, it suggests date/time as a prefix for the backup files.</span></span> <span data-ttu-id="85ffc-231">In SAP HANA Studio il prefisso predefinito è &quot;COMPLETE\_DATA\_BACKUP&quot; per un backup completo del file.</span><span class="sxs-lookup"><span data-stu-id="85ffc-231">In SAP HANA Studio, the default prefix is &quot;COMPLETE\_DATA\_BACKUP&quot; when doing a full file backup.</span></span> <span data-ttu-id="85ffc-232">Si consiglia l'uso di un prefisso unico.</span><span class="sxs-lookup"><span data-stu-id="85ffc-232">Using a unique prefix is recommended.</span></span>

### <a name="sap-hana-backup-encryption"></a><span data-ttu-id="85ffc-233">Crittografia del backup di SAP HANA</span><span class="sxs-lookup"><span data-stu-id="85ffc-233">SAP HANA backup encryption</span></span>

<span data-ttu-id="85ffc-234">SAP HANA offre la crittografia di dati e log.</span><span class="sxs-lookup"><span data-stu-id="85ffc-234">SAP HANA offers encryption of data and log.</span></span> <span data-ttu-id="85ffc-235">Se i dati e i log di SAP HANA non sono crittografati, allora neanche i backup sono crittografati.</span><span class="sxs-lookup"><span data-stu-id="85ffc-235">If SAP HANA data and log are not encrypted, then the backups are also not encrypted.</span></span> <span data-ttu-id="85ffc-236">Il cliente potrà usare soluzioni di terze parti per crittografare i backup di SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="85ffc-236">It is up to the customer to use some form of third-party solution to encrypt the SAP HANA backups.</span></span> <span data-ttu-id="85ffc-237">Vedere [Data and Log Volume Encryption](https://help.sap.com/saphelp_hanaplatform/helpdata/en/dc/01f36fbb5710148b668201a6e95cf2/content.htm) (Crittografia del volume di dati e log) per altre informazioni sulla crittografia di SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="85ffc-237">See [Data and Log Volume Encryption](https://help.sap.com/saphelp_hanaplatform/helpdata/en/dc/01f36fbb5710148b668201a6e95cf2/content.htm) to find out more about SAP HANA encryption.</span></span>

<span data-ttu-id="85ffc-238">In Microsoft Azure è possibile eseguire la crittografia tramite la funzionalità di crittografia della macchina virtuale IaaS.</span><span class="sxs-lookup"><span data-stu-id="85ffc-238">On Microsoft Azure, a customer could use the IaaS VM encryption feature to encrypt.</span></span> <span data-ttu-id="85ffc-239">Ad esempio, si potrebbero usare dei dischi di dati appositi collegati alla macchina virtuale, usati per archiviare i backup di SAP HANA, quindi creare delle copie di tali dischi.</span><span class="sxs-lookup"><span data-stu-id="85ffc-239">For example, one could use dedicated data disks attached to the VM, which are used to store SAP HANA backups, then make copies of these disks.</span></span>

<span data-ttu-id="85ffc-240">Il servizio di Backup di Azure può gestire macchine virtuali e dischi crittografati (vedere [Come eseguire il backup e il ripristino delle macchine virtuali crittografate con il Backup di Azure](../../../backup/backup-azure-vms-encryption.md)).</span><span class="sxs-lookup"><span data-stu-id="85ffc-240">Azure Backup service can handle encrypted VMs/disks (see [How to back up and restore encrypted virtual machines with Azure Backup](../../../backup/backup-azure-vms-encryption.md)).</span></span>

<span data-ttu-id="85ffc-241">Un'altra opzione è quella di gestire la macchina virtuale di SAP HANA e i relativi dischi senza crittografia e di archiviare i file di backup di SAP HANA in un account di archiviazione per cui sia stata abilitata la crittografia (vedere [Crittografia del servizio di archiviazione di Azure per dati inattivi](../../../storage/common/storage-service-encryption.md)).</span><span class="sxs-lookup"><span data-stu-id="85ffc-241">Another option would be to maintain the SAP HANA VM and its disks without encryption, and store the SAP HANA backup files in a storage account for which encryption was enabled (see [Azure Storage Service Encryption for Data at Rest](../../../storage/common/storage-service-encryption.md)).</span></span>

## <a name="test-setup"></a><span data-ttu-id="85ffc-242">Impostazione del test</span><span class="sxs-lookup"><span data-stu-id="85ffc-242">Test setup</span></span>

### <a name="test-virtual-machine-on-azure"></a><span data-ttu-id="85ffc-243">Eseguire il test della macchina virtuale in Azure.</span><span class="sxs-lookup"><span data-stu-id="85ffc-243">Test Virtual Machine on Azure</span></span>

<span data-ttu-id="85ffc-244">Per i test di backup e ripristino seguenti è stata usata un'installazione di SAP HANA in una macchina virtuale GS5 Azure.</span><span class="sxs-lookup"><span data-stu-id="85ffc-244">An SAP HANA installation in an Azure GS5 VM was used for the following backup/restore tests.</span></span>

![In questa figura viene illustrata parte della panoramica del portale di Azure per le macchine virtuali del test HANA](media/sap-hana-backup-guide/image007.png)

<span data-ttu-id="85ffc-246">In questa figura viene illustrata parte della panoramica del portale di Azure per le macchine virtuali del test HANA.</span><span class="sxs-lookup"><span data-stu-id="85ffc-246">This figure shows part of the Azure portal overview for the HANA test VM.</span></span>

### <a name="test-backup-size"></a><span data-ttu-id="85ffc-247">Testare la dimensione del backup</span><span class="sxs-lookup"><span data-stu-id="85ffc-247">Test backup size</span></span>

![Questa figura è stata ottenuta dalla console di backup in HANA Studio e mostra le dimensioni del file di backup di 229 GB per il server dell'indice HANA.](media/sap-hana-backup-guide/image008.png)

<span data-ttu-id="85ffc-249">Una tabella fittizia è stata riempita con i dati per ottenere una dimensione di backup di dati totale di oltre 200 GB al fine di derivare i dati delle prestazioni realistiche.</span><span class="sxs-lookup"><span data-stu-id="85ffc-249">A dummy table was filled up with data to get a total data backup size of over 200 GB to derive realistic performance data.</span></span> <span data-ttu-id="85ffc-250">La figura è stata ottenuta dalla console di backup in HANA Studio e mostra le dimensioni del file di backup di 229 GB per il server dell'indice HANA.</span><span class="sxs-lookup"><span data-stu-id="85ffc-250">The figure was taken from the backup console in HANA Studio and shows the backup file size of 229 GB for the HANA index server.</span></span> <span data-ttu-id="85ffc-251">Per i test, è stato usato il prefisso di backup predefinito "COMPLETE_DATA_BACKUP" in SAP HANA Studio.</span><span class="sxs-lookup"><span data-stu-id="85ffc-251">For the tests, the default backup prefix "COMPLETE_DATA_BACKUP" in SAP HANA Studio was used.</span></span> <span data-ttu-id="85ffc-252">Nei sistemi di produzione reali, deve essere definito un prefisso più utile.</span><span class="sxs-lookup"><span data-stu-id="85ffc-252">In real production systems, a more useful prefix should be defined.</span></span> <span data-ttu-id="85ffc-253">Il pannello di controllo SAP HANA suggerisce data/ora.</span><span class="sxs-lookup"><span data-stu-id="85ffc-253">SAP HANA Cockpit suggests date/time.</span></span>

### <a name="test-tool-to-copy-files-directly-to-azure-storage"></a><span data-ttu-id="85ffc-254">Strumento di test per copiare i file direttamente in Archiviazione di Azure</span><span class="sxs-lookup"><span data-stu-id="85ffc-254">Test tool to copy files directly to Azure storage</span></span>

<span data-ttu-id="85ffc-255">Per trasferire i file di backup di SAP HANA direttamente in Archiviazione BLOB di Azure o nelle condivisioni di file di Azure, è stato usato lo strumento blobxfer poiché supporta entrambe le destinazioni e può essere facilmente integrato negli script di automazione grazie all'interfaccia della riga di comando.</span><span class="sxs-lookup"><span data-stu-id="85ffc-255">To transfer SAP HANA backup files directly to Azure blob storage, or Azure file shares, the blobxfer tool was used because it supports both targets and it can be easily integrated into automation scripts due to its command-line interface.</span></span> <span data-ttu-id="85ffc-256">Lo strumento blobxfer è disponibile in [GitHub](https://github.com/Azure/blobxfer).</span><span class="sxs-lookup"><span data-stu-id="85ffc-256">The blobxfer tool is available on [GitHub](https://github.com/Azure/blobxfer).</span></span>

### <a name="test-backup-size-estimation"></a><span data-ttu-id="85ffc-257">Testare la stima della dimensione del backup</span><span class="sxs-lookup"><span data-stu-id="85ffc-257">Test backup size estimation</span></span>

<span data-ttu-id="85ffc-258">È importante stimare la dimensione del backup di SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="85ffc-258">It is important to estimate the backup size of SAP HANA.</span></span> <span data-ttu-id="85ffc-259">Questa stima consente di migliorare le prestazioni definendo la dimensione massima del file di backup per un numero di file di backup, grazie al parallelismo durante una copia del file.</span><span class="sxs-lookup"><span data-stu-id="85ffc-259">This estimate helps to improve performance by defining the max backup file size for a number of backup files, due to parallelism during a file copy.</span></span> <span data-ttu-id="85ffc-260">Questi dettagli verranno spiegati più avanti nell'articolo. Si deve anche decidere se eseguire un backup completo o un backup delta (incrementale o differenziale).</span><span class="sxs-lookup"><span data-stu-id="85ffc-260">(Those details are explained later in this article.) One must also decide whether to do a full backup or a delta backup (incremental or differential).</span></span>

<span data-ttu-id="85ffc-261">Fortunatamente, esiste una semplice istruzione SQL che stima la dimensione dei file di backup: **selezionare \* da M\_BACKUP\_DIMENSIONE\_STIME**. Vedere [Estimate the Space Needed in the File System for a Data Backup](https://help.sap.com/saphelp_hanaplatform/helpdata/en/7d/46337b7a9c4c708d965b65bc0f343c/content.htm) (Stimare lo spazio necessario nel file system per un backup di dati).</span><span class="sxs-lookup"><span data-stu-id="85ffc-261">Fortunately, there is a simple SQL statement that estimates the size of the backup files: **select \* from M\_BACKUP\_SIZE\_ESTIMATIONS** (see [Estimate the Space Needed in the File System for a Data Backup](https://help.sap.com/saphelp_hanaplatform/helpdata/en/7d/46337b7a9c4c708d965b65bc0f343c/content.htm)).</span></span>

![L'output dell'istruzione SQL corrisponde quasi esattamente alla dimensione effettiva del backup completo dei dati sul disco](media/sap-hana-backup-guide/image009.png)

<span data-ttu-id="85ffc-263">Per il sistema di test, l'output dell'istruzione SQL corrisponde quasi esattamente alla dimensione effettiva del backup completo dei dati sul disco.</span><span class="sxs-lookup"><span data-stu-id="85ffc-263">For the test system, the output of this SQL statement matches almost exactly the real size of the full data backup on disk.</span></span>

### <a name="test-hana-backup-file-size"></a><span data-ttu-id="85ffc-264">Testare la dimensione del file di backup HANA</span><span class="sxs-lookup"><span data-stu-id="85ffc-264">Test HANA backup file size</span></span>

![La console di backup HANA Studio consente di limitare la dimensione massima del file dei file di backup di HANA.](media/sap-hana-backup-guide/image010.png)

<span data-ttu-id="85ffc-266">La console di backup HANA Studio consente di limitare la dimensione massima dei file di backup di HANA.</span><span class="sxs-lookup"><span data-stu-id="85ffc-266">The HANA Studio backup console allows one to restrict the max file size of HANA backup files.</span></span> <span data-ttu-id="85ffc-267">Nell'ambiente di esempio tale funzionalità consente di ottenere più file di backup più piccoli invece di un file di backup di 230 GB.</span><span class="sxs-lookup"><span data-stu-id="85ffc-267">In the sample environment, that feature makes it possible to get multiple smaller backup files instead of one 230-GB backup file.</span></span> <span data-ttu-id="85ffc-268">Le dimensioni ridotte del file hanno un impatto significativo sulle prestazioni (vedere l'articolo correlato [Backup di SAP HANA di Azure a livello di file](sap-hana-backup-file-level.md)).</span><span class="sxs-lookup"><span data-stu-id="85ffc-268">Smaller file size has a significant impact on performance (see the related article [SAP HANA Azure Backup on file level](sap-hana-backup-file-level.md)).</span></span>

## <a name="summary"></a><span data-ttu-id="85ffc-269">Riepilogo</span><span class="sxs-lookup"><span data-stu-id="85ffc-269">Summary</span></span>

<span data-ttu-id="85ffc-270">In base ai risultati dei test, le tabelle seguenti mostrano i vantaggi e gli svantaggi delle soluzioni per eseguire il backup di un database SAP HANA in esecuzione su macchine virtuali di Azure.</span><span class="sxs-lookup"><span data-stu-id="85ffc-270">Based on the test results the following tables show pros and cons of solutions to back up an SAP HANA database running on Azure virtual machines.</span></span>

<span data-ttu-id="85ffc-271">**Eseguire il backup di SAP HANA nel file system e copiare i file di backup in un secondo momento nella destinazione finale di backup**</span><span class="sxs-lookup"><span data-stu-id="85ffc-271">**Back up SAP HANA to the file system and copy backup files afterwards to the final backup destination**</span></span>

|<span data-ttu-id="85ffc-272">Soluzione</span><span class="sxs-lookup"><span data-stu-id="85ffc-272">Solution</span></span>                                           |<span data-ttu-id="85ffc-273">Vantaggi</span><span class="sxs-lookup"><span data-stu-id="85ffc-273">Pros</span></span>                                 |<span data-ttu-id="85ffc-274">Svantaggi</span><span class="sxs-lookup"><span data-stu-id="85ffc-274">Cons</span></span>                                  |
|---------------------------------------------------|-------------------------------------|--------------------------------------|
|<span data-ttu-id="85ffc-275">Mantenere i backup di HANA sui dischi della macchina virtuale</span><span class="sxs-lookup"><span data-stu-id="85ffc-275">Keep HANA backups on VM disks</span></span>                      |<span data-ttu-id="85ffc-276">Nessuno sforzo di gestione aggiuntivo</span><span class="sxs-lookup"><span data-stu-id="85ffc-276">No additional management efforts</span></span>     |<span data-ttu-id="85ffc-277">Consuma spazio sul disco della macchina virtuale locale</span><span class="sxs-lookup"><span data-stu-id="85ffc-277">Eats up local VM disk space</span></span>           |
|<span data-ttu-id="85ffc-278">Strumento Blobxfer per copiare i file di backup nell'archiviazione BLOB</span><span class="sxs-lookup"><span data-stu-id="85ffc-278">Blobxfer tool to copy backup files to blob storage</span></span> |<span data-ttu-id="85ffc-279">Parallelismo per copiare più file, scegliere di usare l'archiviazione BLOB per accesso sporadico</span><span class="sxs-lookup"><span data-stu-id="85ffc-279">Parallelism to copy multiple files, choice to use cool blob storage</span></span> | <span data-ttu-id="85ffc-280">Manutenzione aggiuntiva dello strumento e script personalizzato</span><span class="sxs-lookup"><span data-stu-id="85ffc-280">Additional tool maintenance and custom scripting</span></span> | 
|<span data-ttu-id="85ffc-281">Copia di BLOB tramite Powershell o interfaccia della riga di comando</span><span class="sxs-lookup"><span data-stu-id="85ffc-281">Blob copy via Powershell or CLI</span></span>                    |<span data-ttu-id="85ffc-282">Nessuno strumento aggiuntivo necessario, è possibile procedere con l'esecuzione tramite Azure Powershell o interfaccia della riga di comando</span><span class="sxs-lookup"><span data-stu-id="85ffc-282">No additional tool necessary, can be accomplished via Azure Powershell or CLI</span></span> |<span data-ttu-id="85ffc-283">Processo manuale, il cliente si deve occupare dello script e della gestione di BLOB copiati per il ripristino</span><span class="sxs-lookup"><span data-stu-id="85ffc-283">manual process, customer has to take care of scripting and management of copied blobs for restore</span></span>|
|<span data-ttu-id="85ffc-284">Copia nella condivisione NFS</span><span class="sxs-lookup"><span data-stu-id="85ffc-284">Copy to NFS share</span></span>                                  |<span data-ttu-id="85ffc-285">Post-elaborazione dei file di backup in altre macchine virtuali senza alcun impatto sul server HANA</span><span class="sxs-lookup"><span data-stu-id="85ffc-285">Post-processing of backup files on other VM without impact on the HANA server</span></span>|<span data-ttu-id="85ffc-286">Processo di copia lenta</span><span class="sxs-lookup"><span data-stu-id="85ffc-286">Slow copy process</span></span>|
|<span data-ttu-id="85ffc-287">Copia di blobxfer nel Servizio file di Azure</span><span class="sxs-lookup"><span data-stu-id="85ffc-287">Blobxfer copy to Azure File Service</span></span>                |<span data-ttu-id="85ffc-288">Non consuma spazio sui dischi della macchina virtuale locale</span><span class="sxs-lookup"><span data-stu-id="85ffc-288">Doesn't eat up space on local VM disks</span></span>|<span data-ttu-id="85ffc-289">Nessun supporto di scrittura diretto dal backup di HANA, la restrizione sulle dimensioni della condivisione di file è attualmente di 5 TB</span><span class="sxs-lookup"><span data-stu-id="85ffc-289">No direct write support by HANA backup, size restriction of file share currently at 5 TB</span></span>|
|<span data-ttu-id="85ffc-290">Agente di Backup di Azure</span><span class="sxs-lookup"><span data-stu-id="85ffc-290">Azure Backup Agent</span></span>                                 | <span data-ttu-id="85ffc-291">Soluzione preferibile</span><span class="sxs-lookup"><span data-stu-id="85ffc-291">Would be preferred solution</span></span>         | <span data-ttu-id="85ffc-292">Attualmente non disponibile su Linux</span><span class="sxs-lookup"><span data-stu-id="85ffc-292">Currently not available on Linux</span></span>    |



<span data-ttu-id="85ffc-293">**Backup di SAP HANA basato su snapshot di archiviazione**</span><span class="sxs-lookup"><span data-stu-id="85ffc-293">**Backup SAP HANA based on storage snapshots**</span></span>

|<span data-ttu-id="85ffc-294">Soluzione</span><span class="sxs-lookup"><span data-stu-id="85ffc-294">Solution</span></span>                                           |<span data-ttu-id="85ffc-295">Vantaggi</span><span class="sxs-lookup"><span data-stu-id="85ffc-295">Pros</span></span>                                 |<span data-ttu-id="85ffc-296">Svantaggi</span><span class="sxs-lookup"><span data-stu-id="85ffc-296">Cons</span></span>                                  |
|---------------------------------------------------|-------------------------------------|--------------------------------------|
|<span data-ttu-id="85ffc-297">Servizio Backup di Azure</span><span class="sxs-lookup"><span data-stu-id="85ffc-297">Azure Backup Service</span></span>                               | <span data-ttu-id="85ffc-298">Consente il backup delle macchine virtuali basato su snapshot BLOB</span><span class="sxs-lookup"><span data-stu-id="85ffc-298">Allows VM backup based on blob snapshots</span></span> | <span data-ttu-id="85ffc-299">Quando non si usa il ripristino a livello di file, è necessaria la creazione di una nuova macchina virtuale per il processo di ripristino, che quindi implica la necessità di una nuova chiave di licenza di SAP HANA.</span><span class="sxs-lookup"><span data-stu-id="85ffc-299">When not using file level restore, it requires the creation of a new VM for the restore process, which then implies the need of a new SAP HANA license key</span></span>|
|<span data-ttu-id="85ffc-300">Snapshot BLOB manuali</span><span class="sxs-lookup"><span data-stu-id="85ffc-300">Manual blob snapshots</span></span>                              | <span data-ttu-id="85ffc-301">Flessibilità per creare e ripristinare i dischi di macchina virtuale specifici senza modificare l'ID univoco della macchina virtuale.</span><span class="sxs-lookup"><span data-stu-id="85ffc-301">Flexibility to create and restore specific VM disks without changing the unique VM ID</span></span>|<span data-ttu-id="85ffc-302">Tutte attività manuali, che devono essere eseguite dal cliente</span><span class="sxs-lookup"><span data-stu-id="85ffc-302">All manual work, which has to be done by the customer</span></span>|

## <a name="next-steps"></a><span data-ttu-id="85ffc-303">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="85ffc-303">Next steps</span></span>
* <span data-ttu-id="85ffc-304">[Backup di SAP HANA di Azure a livello di file](sap-hana-backup-file-level.md) descrive l'opzione di backup basato su file.</span><span class="sxs-lookup"><span data-stu-id="85ffc-304">[SAP HANA Azure Backup on file level](sap-hana-backup-file-level.md) describes the file-based backup option.</span></span>
* <span data-ttu-id="85ffc-305">[Backup di SAP HANA basato su snapshot di archiviazione](sap-hana-backup-storage-snapshots.md) descrive l'opzione di backup basato su snapshot di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="85ffc-305">[SAP HANA backup based on storage snapshots](sap-hana-backup-storage-snapshots.md) describes the storage snapshot-based backup option.</span></span>
* <span data-ttu-id="85ffc-306">Per informazioni su come stabilire la disponibilità elevata e un piano di ripristino di emergenza di SAP HANA in Azure (istanze di grandi dimensioni), vedere [Disponibilità elevata e ripristino di emergenza di SAP HANA (istanze di grandi dimensioni) in Azure](hana-overview-high-availability-disaster-recovery.md).</span><span class="sxs-lookup"><span data-stu-id="85ffc-306">To learn how to establish high availability and plan for disaster recovery of SAP HANA on Azure (large instances), see [SAP HANA (large instances) high availability and disaster recovery on Azure](hana-overview-high-availability-disaster-recovery.md).</span></span>
