---
title: aaaInsulating applicazioni di Azure Service Bus da interruzioni e situazioni di emergenza | Documenti Microsoft
description: "Descrive tecniche che è possibile utilizzare applicazioni tooprotect su una potenziale interruzione del servizio Bus di servizio."
services: service-bus-messaging
documentationcenter: na
author: sethmanheim
manager: timlt
editor: tysonn
ms.assetid: fd9fa8ab-f4c4-43f7-974f-c876df1614d4
ms.service: service-bus-messaging
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 04/12/2017
ms.author: sethm
ms.openlocfilehash: 349b4968456c9f15375753d83495246f5a3ddfdb
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/06/2017
---
# <a name="best-practices-for-insulating-applications-against-service-bus-outages-and-disasters"></a><span data-ttu-id="e0d9d-103">Procedure consigliate per isolare le applicazioni del bus di servizio da interruzioni ed emergenze del servizio</span><span class="sxs-lookup"><span data-stu-id="e0d9d-103">Best practices for insulating applications against Service Bus outages and disasters</span></span>
<span data-ttu-id="e0d9d-104">Applicazioni mission-critical devono funzionare in modo continuo, anche in presenza di hello di interruzioni impreviste o situazioni di emergenza.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-104">Mission-critical applications must operate continuously, even in hello presence of unplanned outages or disasters.</span></span> <span data-ttu-id="e0d9d-105">Questo argomento descrive le tecniche che è possibile utilizzare applicazioni di Service Bus tooprotect rispetto a un potenziale interruzione del servizio o di emergenza.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-105">This topic describes techniques you can use tooprotect Service Bus applications against a potential service outage or disaster.</span></span>

<span data-ttu-id="e0d9d-106">Un'interruzione del servizio è definito come hello la temporanea indisponibilità del Bus di servizio di Azure.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-106">An outage is defined as hello temporary unavailability of Azure Service Bus.</span></span> <span data-ttu-id="e0d9d-107">un'interruzione di Hello può interessare alcuni componenti del Bus di servizio, ad esempio un archivio di messaggistica o hello anche l'intero Data Center.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-107">hello outage can affect some components of Service Bus, such as a messaging store, or even hello entire datacenter.</span></span> <span data-ttu-id="e0d9d-108">Dopo che è stato risolto il problema di hello, Bus di servizio diventa nuovamente disponibile.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-108">After hello problem has been fixed, Service Bus becomes available again.</span></span> <span data-ttu-id="e0d9d-109">In genere, un'interruzione non determina la perdita di messaggi o di altri dati.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-109">Typically, an outage does not cause loss of messages or other data.</span></span> <span data-ttu-id="e0d9d-110">Un esempio di errore di un componente è indisponibilità hello di un particolare archivio di messaggistica.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-110">An example of a component failure is hello unavailability of a particular messaging store.</span></span> <span data-ttu-id="e0d9d-111">Un esempio di un'interruzione del Data Center è un'interruzione dell'alimentazione del Data Center hello o un commutatore di rete difettosa Data Center.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-111">An example of a datacenter-wide outage is a power failure of hello datacenter, or a faulty datacenter network switch.</span></span> <span data-ttu-id="e0d9d-112">Un'interruzione può durare da pochi minuti tooa alcuni giorni.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-112">An outage can last from a few minutes tooa few days.</span></span>

<span data-ttu-id="e0d9d-113">Una situazione di emergenza è definito come perdita definitiva di hello di un'unità di scala di Bus di servizio o un Data Center.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-113">A disaster is defined as hello permanent loss of a Service Bus scale unit or datacenter.</span></span> <span data-ttu-id="e0d9d-114">Data Center di Hello può o può non nuovamente disponibile.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-114">hello datacenter may or may not become available again.</span></span> <span data-ttu-id="e0d9d-115">In genere, un'emergenza determina la perdita di alcuni o di tutti i messaggi o di altri dati.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-115">Typically a disaster causes loss of some or all messages or other data.</span></span> <span data-ttu-id="e0d9d-116">Un'emergenza può essere causata, ad esempio, da un incendio, un'inondazione o un terremoto.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-116">Examples of disasters are fire, flooding, or earthquake.</span></span>

## <a name="current-architecture"></a><span data-ttu-id="e0d9d-117">Architettura corrente</span><span class="sxs-lookup"><span data-stu-id="e0d9d-117">Current architecture</span></span>
<span data-ttu-id="e0d9d-118">Bus di servizio Usa più archivi toostore messaggi di messaggistica vengono inviati tooqueues o argomenti.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-118">Service Bus uses multiple messaging stores toostore messages that are sent tooqueues or topics.</span></span> <span data-ttu-id="e0d9d-119">Argomento o una coda non partizionato viene assegnato tooone archivio messaggi.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-119">A non-partitioned queue or topic is assigned tooone messaging store.</span></span> <span data-ttu-id="e0d9d-120">Se l'archivio di messaggistica in questione non è disponibile, tutte le operazioni eseguite sulla coda o sull'argomento avranno esito negativo.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-120">If this messaging store is unavailable, all operations on that queue or topic will fail.</span></span>

<span data-ttu-id="e0d9d-121">Tutte le entità del bus di servizio (code, argomenti, inoltri) risiedono in uno spazio dei nomi di servizio che è affiliato a un data center.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-121">All Service Bus messaging entities (queues, topics, relays) reside in a service namespace, which is affiliated with a datacenter.</span></span> <span data-ttu-id="e0d9d-122">Bus di servizio non abilitare la replica geografica automatica dei dati, né consentire toospan un spazio dei nomi più Data Center.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-122">Service Bus does not enable automatic geo-replication of data, nor does it allow a namespace toospan multiple datacenters.</span></span>

## <a name="protecting-against-acs-outages"></a><span data-ttu-id="e0d9d-123">Protezione da interruzioni del servizio di controllo di accesso (ACS)</span><span class="sxs-lookup"><span data-stu-id="e0d9d-123">Protecting against ACS outages</span></span>
<span data-ttu-id="e0d9d-124">Se si usano credenziali ACS e il servizio ACS non è disponibile, i client non possono più ottenere i token.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-124">If you are using ACS credentials, and ACS becomes unavailable, clients can no longer obtain tokens.</span></span> <span data-ttu-id="e0d9d-125">I client che dispone di un token in fase di hello che ACS si arresta possono continuare toouse Bus di servizio fino alla scadenza di token hello.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-125">Clients that have a token at hello time ACS goes down can continue toouse Service Bus until hello tokens expire.</span></span> <span data-ttu-id="e0d9d-126">durata del token Hello predefinito è 3 ore.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-126">hello default token lifetime is 3 hours.</span></span>

<span data-ttu-id="e0d9d-127">tooprotect da interruzioni di ACS, usare i token di firma di accesso condiviso (SAS).</span><span class="sxs-lookup"><span data-stu-id="e0d9d-127">tooprotect against ACS outages, use Shared Access Signature (SAS) tokens.</span></span> <span data-ttu-id="e0d9d-128">In questo caso, hello client esegue l'autenticazione direttamente con il Bus di servizio firmando un token coniato con una chiave privata.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-128">In this case, hello client authenticates directly with Service Bus by signing a self-minted token with a secret key.</span></span> <span data-ttu-id="e0d9d-129">TooACS chiamate non sono più necessari.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-129">Calls tooACS are no longer required.</span></span> <span data-ttu-id="e0d9d-130">Per altre informazioni sulla configurazione dei token di firma di accesso condiviso, vedere [Autenticazione e autorizzazione del bus di servizio][Service Bus authentication].</span><span class="sxs-lookup"><span data-stu-id="e0d9d-130">For more information about SAS tokens, see [Service Bus authentication][Service Bus authentication].</span></span>

## <a name="protecting-queues-and-topics-against-messaging-store-failures"></a><span data-ttu-id="e0d9d-131">Protezione di code e argomenti da errori degli archivi di messaggistica</span><span class="sxs-lookup"><span data-stu-id="e0d9d-131">Protecting queues and topics against messaging store failures</span></span>
<span data-ttu-id="e0d9d-132">Argomento o una coda non partizionato viene assegnato tooone archivio messaggi.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-132">A non-partitioned queue or topic is assigned tooone messaging store.</span></span> <span data-ttu-id="e0d9d-133">Se l'archivio di messaggistica in questione non è disponibile, tutte le operazioni eseguite sulla coda o sull'argomento avranno esito negativo.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-133">If this messaging store is unavailable, all operations on that queue or topic will fail.</span></span> <span data-ttu-id="e0d9d-134">Oggetto partizionata hello coda, invece, è costituito da più frammenti.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-134">A partitioned queue, on hello other hand, consists of multiple fragments.</span></span> <span data-ttu-id="e0d9d-135">ciascuno dei quali memorizzato in un archivio di messaggistica differente.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-135">Each fragment is stored in a different messaging store.</span></span> <span data-ttu-id="e0d9d-136">Quando viene inviato un messaggio tooa coda o argomento partizionato, Bus di servizio assegna tooone messaggio hello di frammenti di hello.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-136">When a message is sent tooa partitioned queue or topic, Service Bus assigns hello message tooone of hello fragments.</span></span> <span data-ttu-id="e0d9d-137">Se l'archivio di messaggistica corrispondente hello è disponibile, Bus di servizio scrive hello tooa diversi frammento di messaggio, se possibile.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-137">If hello corresponding messaging store is unavailable, Service Bus writes hello message tooa different fragment, if possible.</span></span> <span data-ttu-id="e0d9d-138">Per altre informazioni sulle entità partizionate, vedere le [entità di messaggistica partizionate][Partitioned messaging entities].</span><span class="sxs-lookup"><span data-stu-id="e0d9d-138">For more information about partitioned entities, see [Partitioned messaging entities][Partitioned messaging entities].</span></span>

## <a name="protecting-against-datacenter-outages-or-disasters"></a><span data-ttu-id="e0d9d-139">Protezione da interruzioni o emergenze dei data center</span><span class="sxs-lookup"><span data-stu-id="e0d9d-139">Protecting against datacenter outages or disasters</span></span>
<span data-ttu-id="e0d9d-140">tooallow per un failover tra due Data Center, è possibile creare uno spazio dei nomi service Bus di servizio in ogni Data Center.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-140">tooallow for a failover between two datacenters, you can create a Service Bus service namespace in each datacenter.</span></span> <span data-ttu-id="e0d9d-141">Ad esempio, hello spazio dei nomi service Bus di servizio **contosoPrimary.servicebus.windows.net** potrebbe trovarsi in area Stati Uniti centro Nord hello e **contosoSecondary.servicebus.windows.net**potrebbe trovarsi nell'area Stati Uniti centro-meridionali hello.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-141">For example, hello Service Bus service namespace **contosoPrimary.servicebus.windows.net** might be located in hello United States North/Central region, and **contosoSecondary.servicebus.windows.net** might be located in hello US South/Central region.</span></span> <span data-ttu-id="e0d9d-142">Se un'entità di messaggistica di Service Bus deve rimanere accessibile in presenza di hello di un'interruzione del Data Center, è possibile creare tale entità in entrambi gli spazi dei nomi.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-142">If a Service Bus messaging entity must remain accessible in hello presence of a datacenter outage, you can create that entity in both namespaces.</span></span>

<span data-ttu-id="e0d9d-143">Per ulteriori informazioni, vedere "Errore di Service Bus in un Data Center di Azure" sezione hello [disponibilità elevata e modelli di messaggistica asincrona][Asynchronous messaging patterns and high availability].</span><span class="sxs-lookup"><span data-stu-id="e0d9d-143">For more information, see hello "Failure of Service Bus within an Azure datacenter" section in [Asynchronous messaging patterns and high availability][Asynchronous messaging patterns and high availability].</span></span>

## <a name="protecting-relay-endpoints-against-datacenter-outages-or-disasters"></a><span data-ttu-id="e0d9d-144">Protezione degli endpoint di inoltro da interruzioni o emergenze dei data center</span><span class="sxs-lookup"><span data-stu-id="e0d9d-144">Protecting relay endpoints against datacenter outages or disasters</span></span>
<span data-ttu-id="e0d9d-145">La replica geografica degli endpoint di inoltro consente a un servizio che espone un endpoint inoltro per toobe raggiungibile in presenza di hello di interruzioni del Bus di servizio.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-145">Geo-replication of relay endpoints allows a service that exposes a relay endpoint toobe reachable in hello presence of Service Bus outages.</span></span> <span data-ttu-id="e0d9d-146">tooachieve-replica geografica, servizio hello deve creare due endpoint di inoltro in spazi dei nomi diversi.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-146">tooachieve geo-replication, hello service must create two relay endpoints in different namespaces.</span></span> <span data-ttu-id="e0d9d-147">spazi dei nomi Hello devono trovarsi in Data Center diversi e due endpoint hello devono avere nomi diversi.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-147">hello namespaces must reside in different datacenters and hello two endpoints must have different names.</span></span> <span data-ttu-id="e0d9d-148">Ad esempio, un endpoint primario può essere raggiunto in **contosoPrimary.servicebus.windows.net/myPrimaryService**, mentre il corrispettivo endpoint secondario può essere raggiunto in **contosoSecondary.servicebus.windows.net/mySecondaryService**.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-148">For example, a primary endpoint can be reached under **contosoPrimary.servicebus.windows.net/myPrimaryService**, while its secondary counterpart can be reached under **contosoSecondary.servicebus.windows.net/mySecondaryService**.</span></span>

<span data-ttu-id="e0d9d-149">servizio di Hello è quindi in ascolto su entrambi gli endpoint e un client può richiamare il servizio di hello tramite degli endpoint.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-149">hello service then listens on both endpoints, and a client can invoke hello service via either endpoint.</span></span> <span data-ttu-id="e0d9d-150">Un'applicazione client in modo casuale sceglie uno di hello inoltri come endpoint primario hello e invia il relativo endpoint attivo toohello di richiesta.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-150">A client application randomly picks one of hello relays as hello primary endpoint, and sends its request toohello active endpoint.</span></span> <span data-ttu-id="e0d9d-151">Se l'operazione di hello ha esito negativo con un codice di errore, questo errore indica che tale endpoint di inoltro hello non è disponibile.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-151">If hello operation fails with an error code, this failure indicates that hello relay endpoint is not available.</span></span> <span data-ttu-id="e0d9d-152">un'applicazione Hello viene aperto un endpoint del canale toohello backup ed emette nuovamente richiesta hello.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-152">hello application opens a channel toohello backup endpoint and reissues hello request.</span></span> <span data-ttu-id="e0d9d-153">A questo punto hello attivo e gli endpoint di backup hello cambiano di ruolo: un'applicazione hello client considera toobe endpoint attivo precedente hello hello nuovo endpoint di backup e toobe endpoint di backup precedente hello hello nuovo endpoint attivo.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-153">At that point hello active and hello backup endpoints switch roles: hello client application considers hello old active endpoint toobe hello new backup endpoint, and hello old backup endpoint toobe hello new active endpoint.</span></span> <span data-ttu-id="e0d9d-154">Se entrambe esito negativo delle operazioni di invio, i ruoli di hello di due entità hello rimangono invariati e viene restituito un errore.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-154">If both send operations fail, hello roles of hello two entities remain unchanged and an error is returned.</span></span>

<span data-ttu-id="e0d9d-155">Hello [-replica geografica con il Bus di servizio di inoltro dei messaggi] [ Geo-replication with Service Bus relayed Messages] esempio viene illustrato come tooreplicate inoltra.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-155">hello [Geo-replication with Service Bus relayed messages][Geo-replication with Service Bus relayed Messages] sample demonstrates how tooreplicate relays.</span></span>

## <a name="protecting-queues-and-topics-against-datacenter-outages-or-disasters"></a><span data-ttu-id="e0d9d-156">Protezione delle code e degli argomenti da interruzioni o emergenze dei data center</span><span class="sxs-lookup"><span data-stu-id="e0d9d-156">Protecting queues and topics against datacenter outages or disasters</span></span>
<span data-ttu-id="e0d9d-157">resilienza tooachieve per interruzioni dei Data Center durante l'uso di messaggistica negoziata, Bus di servizio supporta due approcci: *active* e *passivo* replica.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-157">tooachieve resilience against datacenter outages when using brokered messaging, Service Bus supports two approaches: *active* and *passive* replication.</span></span> <span data-ttu-id="e0d9d-158">Per ciascun approccio, se una determinata coda o un argomento deve rimanere accessibile in presenza di hello di un'interruzione del Data Center, è possibile crearlo in entrambi gli spazi dei nomi.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-158">For each approach, if a given queue or topic must remain accessible in hello presence of a datacenter outage, you can create it in both namespaces.</span></span> <span data-ttu-id="e0d9d-159">Entrambe le entità possono avere hello stesso nome.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-159">Both entities can have hello same name.</span></span> <span data-ttu-id="e0d9d-160">Ad esempio, una coda primaria può essere raggiunta in **contosoPrimary.servicebus.windows.net/myQueue**, mentre la rispettiva coda secondaria può essere raggiunta in **contosoSecondary.servicebus.windows.net/myQueue**.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-160">For example, a primary queue can be reached under **contosoPrimary.servicebus.windows.net/myQueue**, while its secondary counterpart can be reached under **contosoSecondary.servicebus.windows.net/myQueue**.</span></span>

<span data-ttu-id="e0d9d-161">Se un'applicazione hello non richiede la comunicazione mittente-ricevitore permanente, un'applicazione hello possibile implementare una coda durevole lato client tooprevent perdita e tooshield hello mittente da eventuali errori temporanei di Bus di servizio.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-161">If hello application does not require permanent sender-to-receiver communication, hello application can implement a durable client-side queue tooprevent message loss and tooshield hello sender from any transient Service Bus errors.</span></span>

## <a name="active-replication"></a><span data-ttu-id="e0d9d-162">Replica attiva</span><span class="sxs-lookup"><span data-stu-id="e0d9d-162">Active replication</span></span>
<span data-ttu-id="e0d9d-163">La replica attiva usa entità in entrambi gli spazi dei nomi per ogni operazione.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-163">Active replication uses entities in both namespaces for every operation.</span></span> <span data-ttu-id="e0d9d-164">Qualsiasi client che invia un messaggio inviato due copie di hello stesso messaggio.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-164">Any client that sends a message sends two copies of hello same message.</span></span> <span data-ttu-id="e0d9d-165">prima copia Hello viene inviata l'entità primaria toohello (ad esempio, **contosoPrimary.servicebus.windows.net/sales**), e seconda copia di hello del messaggio hello viene inviato l'entità secondaria toohello (ad esempio,  **contosoSecondary.servicebus.windows.net/sales**).</span><span class="sxs-lookup"><span data-stu-id="e0d9d-165">hello first copy is sent toohello primary entity (for example, **contosoPrimary.servicebus.windows.net/sales**), and hello second copy of hello message is sent toohello secondary entity (for example, **contosoSecondary.servicebus.windows.net/sales**).</span></span>

<span data-ttu-id="e0d9d-166">Un client riceve messaggi da entrambe le code.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-166">A client receives messages from both queues.</span></span> <span data-ttu-id="e0d9d-167">i processi di ricevitore Hello hello prima copia di un messaggio e copia secondo hello viene eliminato.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-167">hello receiver processes hello first copy of a message, and hello second copy is suppressed.</span></span> <span data-ttu-id="e0d9d-168">toosuppress messaggi duplicati, il mittente hello deve contrassegnare ciascun messaggio con un identificatore univoco.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-168">toosuppress duplicate messages, hello sender must tag each message with a unique identifier.</span></span> <span data-ttu-id="e0d9d-169">Entrambe le copie del messaggio devono essere contrassegnate con hello stesso identificatore.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-169">Both copies of hello message must be tagged with hello same identifier.</span></span> <span data-ttu-id="e0d9d-170">È possibile utilizzare hello [BrokeredMessage.MessageId] [ BrokeredMessage.MessageId] o [BrokeredMessage.Label] [ BrokeredMessage.Label] proprietà o un hello tootag proprietà personalizzata Messaggio.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-170">You can use hello [BrokeredMessage.MessageId][BrokeredMessage.MessageId] or [BrokeredMessage.Label][BrokeredMessage.Label] properties, or a custom property tootag hello message.</span></span> <span data-ttu-id="e0d9d-171">ricevitore Hello deve gestire un elenco dei messaggi già ricevuti.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-171">hello receiver must maintain a list of messages that it has already received.</span></span>

<span data-ttu-id="e0d9d-172">Hello [replica geografica con i messaggi negoziati di Service Bus] [ Geo-replication with Service Bus Brokered Messages] illustra replica attiva delle entità di messaggistica.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-172">hello [Geo-replication with Service Bus Brokered Messages][Geo-replication with Service Bus Brokered Messages] sample demonstrates active replication of messaging entities.</span></span>

> [!NOTE]
> <span data-ttu-id="e0d9d-173">Hello replica attiva raddoppia il numero di hello di operazioni, pertanto questo approccio può comportare costi toohigher.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-173">hello active replication approach doubles hello number of operations, therefore this approach can lead toohigher cost.</span></span>
> 
> 

## <a name="passive-replication"></a><span data-ttu-id="e0d9d-174">Replica passiva</span><span class="sxs-lookup"><span data-stu-id="e0d9d-174">Passive replication</span></span>
<span data-ttu-id="e0d9d-175">In caso di errore senza hello, replica passiva viene usata solo una delle due entità di messaggistica hello.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-175">In hello fault-free case, passive replication uses only one of hello two messaging entities.</span></span> <span data-ttu-id="e0d9d-176">Un client invia l'entità attiva toohello di messaggio hello.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-176">A client sends hello message toohello active entity.</span></span> <span data-ttu-id="e0d9d-177">Se hello sull'entità attiva hello esito negativo con un codice di errore che indica Data Center hello che entità attiva di hello host potrebbe non essere disponibile, il client di hello invia una copia dell'entità di backup toohello messaggio hello.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-177">If hello operation on hello active entity fails with an error code that indicates hello datacenter that hosts hello active entity might be unavailable, hello client sends a copy of hello message toohello backup entity.</span></span> <span data-ttu-id="e0d9d-178">A questo punto hello attiva e le entità di backup hello cambiano di ruolo: client mittente hello considera hello entità attiva toobe hello nuova entità di backup precedente e l'entità di backup precedente hello è nuova entità attiva hello.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-178">At that point hello active and hello backup entities switch roles: hello sending client considers hello old active entity toobe hello new backup entity, and hello old backup entity is hello new active entity.</span></span> <span data-ttu-id="e0d9d-179">Se entrambe esito negativo delle operazioni di invio, i ruoli di hello di due entità hello rimangono invariati e viene restituito un errore.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-179">If both send operations fail, hello roles of hello two entities remain unchanged and an error is returned.</span></span>

<span data-ttu-id="e0d9d-180">Un client riceve messaggi da entrambe le code.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-180">A client receives messages from both queues.</span></span> <span data-ttu-id="e0d9d-181">Poiché è probabile che ricevitore hello riceve due copie dello stesso messaggio hello hello ricevitore deve eliminare i messaggi duplicati.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-181">Because there is a chance that hello receiver receives two copies of hello same message, hello receiver must suppress duplicate messages.</span></span> <span data-ttu-id="e0d9d-182">È possibile eliminare duplicati nello hello come descritto per la replica attiva.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-182">You can suppress duplicates in hello same way as described for active replication.</span></span>

<span data-ttu-id="e0d9d-183">In genere, la replica passiva è più vantaggiosa di quella attiva perché nella maggior parte dei casi viene eseguita una sola operazione.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-183">In general, passive replication is more economical than active replication because in most cases only one operation is performed.</span></span> <span data-ttu-id="e0d9d-184">Latenza, velocità effettiva e il costo sono scenario non replicato toohello identici.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-184">Latency, throughput, and monetary cost are identical toohello non-replicated scenario.</span></span>

<span data-ttu-id="e0d9d-185">Quando si utilizza la replica passiva, in hello messaggi gli scenari seguenti possono essere persi o ricevuti due volte:</span><span class="sxs-lookup"><span data-stu-id="e0d9d-185">When using passive replication, in hello following scenarios messages can be lost or received twice:</span></span>

* <span data-ttu-id="e0d9d-186">**Messaggio ritardo o perdita**: si presuppone che hello mittente abbia inviato con una coda di messaggi m1 toohello primaria e coda hello diventa quindi disponibile prima di hello ricezione m1.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-186">**Message delay or loss**: Assume that hello sender successfully sent a message m1 toohello primary queue, and then hello queue becomes unavailable before hello receiver receives m1.</span></span> <span data-ttu-id="e0d9d-187">mittente Hello invia una coda di messaggi successivi m2 toohello secondario.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-187">hello sender sends a subsequent message m2 toohello secondary queue.</span></span> <span data-ttu-id="e0d9d-188">Se la coda primaria hello è temporaneamente non disponibile, il ricevitore hello riceve m1 dopo hello coda torna nuovamente disponibile.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-188">If hello primary queue is temporarily unavailable, hello receiver receives m1 after hello queue becomes available again.</span></span> <span data-ttu-id="e0d9d-189">In caso di emergenza, il ricevitore hello potrebbe non ricevere mai m1.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-189">In case of a disaster, hello receiver may never receive m1.</span></span>
* <span data-ttu-id="e0d9d-190">**Ricezione di duplicati**: si presuppone che mittente hello invia una coda di messaggi m toohello primario.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-190">**Duplicate reception**: Assume that hello sender sends a message m toohello primary queue.</span></span> <span data-ttu-id="e0d9d-191">Bus di servizio completato elabora m ma ha esito negativo toosend una risposta.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-191">Service Bus successfully processes m but fails toosend a response.</span></span> <span data-ttu-id="e0d9d-192">Dopo che hello inviare Timeout operazione, il mittente hello invia una copia identica della coda secondaria di toohello m.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-192">After hello send operation times out, hello sender sends an identical copy of m toohello secondary queue.</span></span> <span data-ttu-id="e0d9d-193">Se ricevitore hello è la prima copia hello tooreceive in grado di m che la coda primaria hello diventi non disponibile, il ricevitore hello riceve entrambe le copie di m a circa hello contemporaneamente.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-193">If hello receiver is able tooreceive hello first copy of m before hello primary queue becomes unavailable, hello receiver receives both copies of m at approximately hello same time.</span></span> <span data-ttu-id="e0d9d-194">Ricevitore hello non è la prima copia hello tooreceive in grado di m che la coda primaria hello diventi non disponibile, il ricevitore hello riceverà inizialmente solo hello seconda copia di m, ma riceve quindi una seconda copia di m quando la coda primaria hello diventa disponibile.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-194">If hello receiver is not able tooreceive hello first copy of m before hello primary queue becomes unavailable, hello receiver initially receives only hello second copy of m, but then receives a second copy of m when hello primary queue becomes available.</span></span>

<span data-ttu-id="e0d9d-195">Hello [-replica geografica con il Bus di servizio negoziata messaggi] [ Geo-replication with Service Bus Brokered Messages] illustra la replica passiva delle entità di messaggistica.</span><span class="sxs-lookup"><span data-stu-id="e0d9d-195">hello [Geo-replication with Service Bus brokered messages][Geo-replication with Service Bus Brokered Messages] sample demonstrates passive replication of messaging entities.</span></span>

## <a name="next-steps"></a><span data-ttu-id="e0d9d-196">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="e0d9d-196">Next steps</span></span>
<span data-ttu-id="e0d9d-197">toolearn più sul ripristino di emergenza, vedere i seguenti articoli:</span><span class="sxs-lookup"><span data-stu-id="e0d9d-197">toolearn more about disaster recovery, see these articles:</span></span>

* <span data-ttu-id="e0d9d-198">[Continuità aziendale del database SQL di Azure][Azure SQL Database Business Continuity]</span><span class="sxs-lookup"><span data-stu-id="e0d9d-198">[Azure SQL Database Business Continuity][Azure SQL Database Business Continuity]</span></span>
* <span data-ttu-id="e0d9d-199">[Progettazione di applicazioni resilienti per Azure][Azure resiliency technical guidance]</span><span class="sxs-lookup"><span data-stu-id="e0d9d-199">[Designing resilient applications for Azure][Azure resiliency technical guidance]</span></span>

[Service Bus Authentication]: service-bus-authentication-and-authorization.md
[Partitioned messaging entities]: service-bus-partitioning.md
[Asynchronous messaging patterns and high availability]: service-bus-async-messaging.md#failure-of-service-bus-within-an-azure-datacenter
[Geo-replication with Service Bus Relayed Messages]: http://code.msdn.microsoft.com/Geo-replication-with-16dbfecd
[BrokeredMessage.MessageId]: /dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_MessageId
[BrokeredMessage.Label]: /dotnet/api/microsoft.servicebus.messaging.brokeredmessage#Microsoft_ServiceBus_Messaging_BrokeredMessage_Label
[Geo-replication with Service Bus Brokered Messages]: http://code.msdn.microsoft.com/Geo-replication-with-f5688664
[Azure SQL Database Business Continuity]: ../sql-database/sql-database-business-continuity.md
[Azure resiliency technical guidance]: /azure/architecture/resiliency
