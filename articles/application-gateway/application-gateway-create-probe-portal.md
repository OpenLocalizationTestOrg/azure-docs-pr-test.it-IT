---
title: Creare un probe personalizzato - Gateway applicazione di Azure - Portale di Azure | Microsoft Docs
description: Informazioni su come creare un probe personalizzato per un gateway applicazione usando il portale
services: application-gateway
documentationcenter: na
author: georgewallace
manager: timlt
editor: 
tags: azure-resource-manager
ms.assetid: 33fd5564-43a7-4c54-a9ec-b1235f661f97
ms.service: application-gateway
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 04/26/2017
ms.author: gwallace
ms.openlocfilehash: 65e9bba4ce9ac41ae2a9a8c3fa7f661165fc1403
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/03/2017
---
# <a name="create-a-custom-probe-for-application-gateway-by-using-the-portal"></a><span data-ttu-id="698f5-103">Creare un probe personalizzato per un gateway applicazione con il portale</span><span class="sxs-lookup"><span data-stu-id="698f5-103">Create a custom probe for Application Gateway by using the portal</span></span>

> [!div class="op_single_selector"]
> * [<span data-ttu-id="698f5-104">Portale di Azure</span><span class="sxs-lookup"><span data-stu-id="698f5-104">Azure portal</span></span>](application-gateway-create-probe-portal.md)
> * [<span data-ttu-id="698f5-105">PowerShell per Azure Resource Manager</span><span class="sxs-lookup"><span data-stu-id="698f5-105">Azure Resource Manager PowerShell</span></span>](application-gateway-create-probe-ps.md)
> * [<span data-ttu-id="698f5-106">PowerShell per Azure classico</span><span class="sxs-lookup"><span data-stu-id="698f5-106">Azure Classic PowerShell</span></span>](application-gateway-create-probe-classic-ps.md)

<span data-ttu-id="698f5-107">In questo articolo viene aggiunto un probe personalizzato a un gateway applicazione esistente tramite il portale di Azure.</span><span class="sxs-lookup"><span data-stu-id="698f5-107">In this article, you add a custom probe to an existing application gateway through the Azure portal.</span></span> <span data-ttu-id="698f5-108">I probe personalizzati sono utili per le applicazioni che dispongono di una pagina di controllo dell'integrità specifica o per quelle che non rispondono in modo corretto all'applicazione Web predefinita.</span><span class="sxs-lookup"><span data-stu-id="698f5-108">Custom probes are useful for applications that have a specific health check page or for applications that do not provide a successful response on the default web application.</span></span>

## <a name="before-you-begin"></a><span data-ttu-id="698f5-109">Prima di iniziare</span><span class="sxs-lookup"><span data-stu-id="698f5-109">Before you begin</span></span>

<span data-ttu-id="698f5-110">Se non si dispone già di un gateway applicazione, vedere [Creare un gateway applicazione con il portale](application-gateway-create-gateway-portal.md) per creare un gateway applicazione da usare.</span><span class="sxs-lookup"><span data-stu-id="698f5-110">If you do not already have an application gateway, visit [Create an Application Gateway](application-gateway-create-gateway-portal.md) to create an application gateway to work with.</span></span>

## <span data-ttu-id="698f5-111"><a name="createprobe"></a>Creare il probe</span><span class="sxs-lookup"><span data-stu-id="698f5-111"><a name="createprobe"></a>Create the probe</span></span>

<span data-ttu-id="698f5-112">I probe vengono configurati con un processo in due passaggi nel portale.</span><span class="sxs-lookup"><span data-stu-id="698f5-112">Probes are configured in a two-step process through the portal.</span></span> <span data-ttu-id="698f5-113">Il primo passaggio consiste nel creare il probe.</span><span class="sxs-lookup"><span data-stu-id="698f5-113">The first step is to create the probe.</span></span> <span data-ttu-id="698f5-114">Nel secondo passaggio lo si aggiunge alle impostazioni http back-end del gateway applicazione.</span><span class="sxs-lookup"><span data-stu-id="698f5-114">In the second step, you add the probe to the backend http settings of the application gateway.</span></span>

1. <span data-ttu-id="698f5-115">Accedere al [Portale di Azure](https://portal.azure.com).</span><span class="sxs-lookup"><span data-stu-id="698f5-115">Log in to the [Azure portal](https://portal.azure.com).</span></span> <span data-ttu-id="698f5-116">Se non si dispone già di un account, è possibile iscriversi per ottenere una [versione di valutazione gratuita della durata di un mese](https://azure.microsoft.com/free).</span><span class="sxs-lookup"><span data-stu-id="698f5-116">If you don't already have an account, you can sign up for a [free one-month trial](https://azure.microsoft.com/free)</span></span>

1. <span data-ttu-id="698f5-117">Nel riquadro Preferiti del portale di Azure fare clic su Tutte le risorse.</span><span class="sxs-lookup"><span data-stu-id="698f5-117">In the Azure portal Favorites pane, click All resources.</span></span> <span data-ttu-id="698f5-118">Fare clic su gateway applicazione nel pannello Tutte le risorse.</span><span class="sxs-lookup"><span data-stu-id="698f5-118">Click the application gateway in the All resources blade.</span></span> <span data-ttu-id="698f5-119">Se nella sottoscrizione selezionata sono già presenti risorse, è possibile immettere partners.contoso.net nella casella Filtra per nome</span><span class="sxs-lookup"><span data-stu-id="698f5-119">If the subscription you selected already has several resources in it, you can enter partners.contoso.net in the Filter by name…</span></span> <span data-ttu-id="698f5-120">per accedere con facilità al gateway applicazione.</span><span class="sxs-lookup"><span data-stu-id="698f5-120">box to easily access the application gateway.</span></span>

1. <span data-ttu-id="698f5-121">Fare clic su **Probe** e quindi su **Aggiungi** per aggiungere un probe.</span><span class="sxs-lookup"><span data-stu-id="698f5-121">Click **Probes** and click the **Add** button to add a probe.</span></span>

  ![Pannello Aggiungi probe con informazioni inserite][1]

1. <span data-ttu-id="698f5-123">Nel pannello **Aggiungi probe integrità** specificare le informazioni necessarie per il probe e al termine fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="698f5-123">On the **Add health probe** blade, fill out the required information for the probe, and when complete click **OK**.</span></span>

  |<span data-ttu-id="698f5-124">**Impostazione**</span><span class="sxs-lookup"><span data-stu-id="698f5-124">**Setting**</span></span> | <span data-ttu-id="698f5-125">**Valore**</span><span class="sxs-lookup"><span data-stu-id="698f5-125">**Value**</span></span> | <span data-ttu-id="698f5-126">**Dettagli**</span><span class="sxs-lookup"><span data-stu-id="698f5-126">**Details**</span></span>|
  |---|---|---|
  |<span data-ttu-id="698f5-127">**Nome**</span><span class="sxs-lookup"><span data-stu-id="698f5-127">**Name**</span></span>|<span data-ttu-id="698f5-128">customProbe</span><span class="sxs-lookup"><span data-stu-id="698f5-128">customProbe</span></span>|<span data-ttu-id="698f5-129">Nome descrittivo del probe accessibile nel portale.</span><span class="sxs-lookup"><span data-stu-id="698f5-129">This value is a friendly name to the probe that is accessible in the portal.</span></span>|
  |<span data-ttu-id="698f5-130">**Protocollo**</span><span class="sxs-lookup"><span data-stu-id="698f5-130">**Protocol**</span></span>|<span data-ttu-id="698f5-131">HTTP o HTTPS</span><span class="sxs-lookup"><span data-stu-id="698f5-131">HTTP or HTTPS</span></span> | <span data-ttu-id="698f5-132">Protocollo usato per il probe di integrità.</span><span class="sxs-lookup"><span data-stu-id="698f5-132">The protocol that the health probe uses.</span></span>|
  |<span data-ttu-id="698f5-133">**Host**</span><span class="sxs-lookup"><span data-stu-id="698f5-133">**Host**</span></span>|<span data-ttu-id="698f5-134">vale a dire</span><span class="sxs-lookup"><span data-stu-id="698f5-134">i.e</span></span> <span data-ttu-id="698f5-135">contoso.com</span><span class="sxs-lookup"><span data-stu-id="698f5-135">contoso.com</span></span>|<span data-ttu-id="698f5-136">Nome host usato per il probe.</span><span class="sxs-lookup"><span data-stu-id="698f5-136">This value is the host name that is used for the probe.</span></span> <span data-ttu-id="698f5-137">Applicabile solo quando vengono configurati più siti nel gateway applicazione. In caso contrario, usare "127.0.0.1".</span><span class="sxs-lookup"><span data-stu-id="698f5-137">Applicable only when multi-site is configured on Application Gateway, otherwise use '127.0.0.1'.</span></span> <span data-ttu-id="698f5-138">Questo valore è diverso dal nome host della VM.</span><span class="sxs-lookup"><span data-stu-id="698f5-138">This value is different from the VM host name.</span></span>|
  |<span data-ttu-id="698f5-139">**Percorso**</span><span class="sxs-lookup"><span data-stu-id="698f5-139">**Path**</span></span>|<span data-ttu-id="698f5-140">/ o un altro percorso</span><span class="sxs-lookup"><span data-stu-id="698f5-140">/ or another path</span></span>|<span data-ttu-id="698f5-141">Parte restante dell'URL completo per il probe personalizzato.</span><span class="sxs-lookup"><span data-stu-id="698f5-141">The remainder of the full url for the custom probe.</span></span> <span data-ttu-id="698f5-142">Un percorso valido inizia con "/".</span><span class="sxs-lookup"><span data-stu-id="698f5-142">A valid path starts with '/'.</span></span> <span data-ttu-id="698f5-143">Per il percorso predefinito http://contoso.com è sufficiente usare "/"</span><span class="sxs-lookup"><span data-stu-id="698f5-143">For the default path of http://contoso.com just use '/'</span></span> |
  |<span data-ttu-id="698f5-144">**Intervallo (sec)**</span><span class="sxs-lookup"><span data-stu-id="698f5-144">**Interval (secs)**</span></span>|<span data-ttu-id="698f5-145">30</span><span class="sxs-lookup"><span data-stu-id="698f5-145">30</span></span>|<span data-ttu-id="698f5-146">Frequenza con cui viene eseguito il probe per controllare l'integrità.</span><span class="sxs-lookup"><span data-stu-id="698f5-146">How often the probe is run to check for health.</span></span> <span data-ttu-id="698f5-147">Non è consigliabile impostare un valore inferiore a 30 secondi.</span><span class="sxs-lookup"><span data-stu-id="698f5-147">It is not recommended to set the lower than 30 seconds.</span></span>|
  |<span data-ttu-id="698f5-148">**Timeout (secondi)**</span><span class="sxs-lookup"><span data-stu-id="698f5-148">**Timeout (secs)**</span></span>|<span data-ttu-id="698f5-149">30</span><span class="sxs-lookup"><span data-stu-id="698f5-149">30</span></span>|<span data-ttu-id="698f5-150">Durata dell'attesa prima che si verifichi il timeout del probe.</span><span class="sxs-lookup"><span data-stu-id="698f5-150">The amount of time the probe waits before timing out.</span></span> <span data-ttu-id="698f5-151">L'intervallo di timeout deve essere abbastanza elevato da poter effettuare una chiamata http per assicurarsi che la pagina relativa all'integrità del back-end sia disponibile.</span><span class="sxs-lookup"><span data-stu-id="698f5-151">The timeout interval needs to be high enough that an http call can be made to ensure the backend health page is available.</span></span>|
  |<span data-ttu-id="698f5-152">**Soglia non integra**</span><span class="sxs-lookup"><span data-stu-id="698f5-152">**Unhealthy threshold**</span></span>|<span data-ttu-id="698f5-153">3</span><span class="sxs-lookup"><span data-stu-id="698f5-153">3</span></span>|<span data-ttu-id="698f5-154">Numero di tentativi non riusciti prima che venga stabilito uno stato di non integrità.</span><span class="sxs-lookup"><span data-stu-id="698f5-154">Number of failed attempts to be considered unhealthy.</span></span> <span data-ttu-id="698f5-155">Se la soglia è 0 significa che, se un controllo integrità ha esito negativo, il back-end verrà immediatamente considerato non integro.</span><span class="sxs-lookup"><span data-stu-id="698f5-155">A threshold of 0 means that if a health check fails the back-end is determined unhealthy immediately.</span></span>|

  > [!IMPORTANT]
  > <span data-ttu-id="698f5-156">Il nome host non è uguale al nome del server.</span><span class="sxs-lookup"><span data-stu-id="698f5-156">The host name is not the same as server name.</span></span> <span data-ttu-id="698f5-157">Questo valore è il nome dell'host virtuale in esecuzione nel server applicazioni.</span><span class="sxs-lookup"><span data-stu-id="698f5-157">This value is the name of the virtual host running on the application server.</span></span> <span data-ttu-id="698f5-158">Il probe viene inviato a http://(name host):(porta da impostazioni HTTP)/percorsoURL</span><span class="sxs-lookup"><span data-stu-id="698f5-158">The probe is sent to http://(host name):(port from httpsetting)/urlPath</span></span>

## <a name="add-probe-to-the-gateway"></a><span data-ttu-id="698f5-159">Aggiungere il probe al gateway</span><span class="sxs-lookup"><span data-stu-id="698f5-159">Add probe to the gateway</span></span>

<span data-ttu-id="698f5-160">Ora che il probe è stato creato, deve essere aggiunto al gateway.</span><span class="sxs-lookup"><span data-stu-id="698f5-160">Now that the probe has been created, it is time to add it to the gateway.</span></span> <span data-ttu-id="698f5-161">Le impostazioni del probe vengono definite nelle impostazioni HTTP back-end del gateway applicazione.</span><span class="sxs-lookup"><span data-stu-id="698f5-161">Probe settings are set on the backend http settings of the application gateway.</span></span>

1. <span data-ttu-id="698f5-162">Fare clic su **Impostazioni HTTP** nel gateway applicazione e quindi fare clic sulle impostazioni HTTP back-end correnti presenti nella finestra per visualizzare il pannello di configurazione.</span><span class="sxs-lookup"><span data-stu-id="698f5-162">Click **HTTP settings** on the application gateway, to bring up the configuration blade click the current backend http settings listed in the window.</span></span>

  ![Finestra delle impostazioni HTTP][2]

1. <span data-ttu-id="698f5-164">Nel pannello delle impostazioni **appGatewayBackEndHttpSettings** selezionare la casella di controllo **Usa probe personalizzato** e scegliere il probe creato nella sezione [Creare il probe](#createprobe) nell'elenco a discesa **Probe personalizzato**.</span><span class="sxs-lookup"><span data-stu-id="698f5-164">On the **appGatewayBackEndHttpSettings** settings blade, check the **Use custom probe** checkbox and choose the probe created in the [Create the probe](#createprobe) section on the **Custom probe** drop-down..</span></span>
<span data-ttu-id="698f5-165">Al termine fare clic su **Salva** per applicare le impostazioni.</span><span class="sxs-lookup"><span data-stu-id="698f5-165">When complete, click **Save** and the settings are applied.</span></span>

<span data-ttu-id="698f5-166">Il probe predefinito controlla l'accesso predefinito all'applicazione Web.</span><span class="sxs-lookup"><span data-stu-id="698f5-166">The default probe checks the default access to the web application.</span></span> <span data-ttu-id="698f5-167">Ora che è stato creato un probe personalizzato, il gateway applicazione usa il percorso personalizzato definito per monitorare l'integrità per i server back-end.</span><span class="sxs-lookup"><span data-stu-id="698f5-167">Now that a custom probe has been created, the application gateway uses the custom path defined to monitor health for the backend servers.</span></span> <span data-ttu-id="698f5-168">In base ai criteri definiti, il gateway applicazione controlla il percorso specificato nel probe.</span><span class="sxs-lookup"><span data-stu-id="698f5-168">Based on the criteria that was defined, the application gateway checks the path specified in the probe.</span></span> <span data-ttu-id="698f5-169">Se la chiamata a host:Porta/percorso non restituisce una risposta di stato HTTP 200-399, dopo che è stata raggiunta la soglia di non integrità il server viene escluso dalla rotazione.</span><span class="sxs-lookup"><span data-stu-id="698f5-169">If the call to host:Port/path does not return an HTTP 200-399 status response, the server is taken out of rotation after the unhealthy threshold is reached.</span></span> <span data-ttu-id="698f5-170">Il probe continua a essere eseguito sull'istanza non integra per determinare quando risulterà di nuovo integra.</span><span class="sxs-lookup"><span data-stu-id="698f5-170">Probing continues on the unhealthy instance to determine when it becomes healthy again.</span></span> <span data-ttu-id="698f5-171">Quando l'istanza viene nuovamente aggiunta al pool di server integri, il flusso del traffico verso l'istanza riprenderà e il relativo probe verrà eseguito all'intervallo normale specificato dall'utente.</span><span class="sxs-lookup"><span data-stu-id="698f5-171">Once the instance is added back to healthy server pool, traffic begins flowing to it again and probing to the instance continues at user specified interval as normal.</span></span>

## <a name="next-steps"></a><span data-ttu-id="698f5-172">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="698f5-172">Next steps</span></span>

<span data-ttu-id="698f5-173">Per informazioni su come configurare l'offload SSL con un gateway applicazione di Azure, vedere [Configurare un gateway applicazione per l'offload SSL con il portale](application-gateway-ssl-portal.md)</span><span class="sxs-lookup"><span data-stu-id="698f5-173">To learn how to configure SSL Offloading with Azure Application Gateway, see [Configure SSL Offload](application-gateway-ssl-portal.md)</span></span>

[1]: ./media/application-gateway-create-probe-portal/figure1.png
[2]: ./media/application-gateway-create-probe-portal/figure2.png

