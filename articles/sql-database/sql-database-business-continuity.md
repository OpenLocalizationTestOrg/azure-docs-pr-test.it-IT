---
title: "Continuità aziendale cloud - Ripristino del database - Database SQL | Documentazione Microsoft"
description: "Informazioni su come il database SQL di Azure supporta la continuità aziendale cloud e il ripristino del database e consente di mantenere le applicazioni cloud cruciali in esecuzione."
keywords: "continuità aziendale, continuità aziendale cloud, ripristino di emergenza del database, ripristino del database"
services: sql-database
documentationcenter: 
author: anosov1960
manager: jhubbard
editor: 
ms.assetid: 18e5d3f1-bfe5-4089-b6fd-76988ab29822
ms.service: sql-database
ms.custom: business continuity
ms.devlang: NA
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 05/15/2017
ms.author: sashan
ms.openlocfilehash: cc93ee34a37a4a8688fa2eca338126c13b9940c0
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/29/2017
---
# <a name="overview-of-business-continuity-with-azure-sql-database"></a><span data-ttu-id="4d360-104">Panoramica della continuità aziendale del database SQL di Azure</span><span class="sxs-lookup"><span data-stu-id="4d360-104">Overview of business continuity with Azure SQL Database</span></span>

<span data-ttu-id="4d360-105">Questa panoramica descrive le funzionalità offerte dal database SQL di Azure per la continuità aziendale e il ripristino di emergenza.</span><span class="sxs-lookup"><span data-stu-id="4d360-105">This overview describes the capabilities that Azure SQL Database provides for business continuity and disaster recovery.</span></span> <span data-ttu-id="4d360-106">Informazioni su opzioni, raccomandazioni ed esercitazioni per il ripristino da eventi di arresto improvviso che potrebbero provocare la perdita di dati o la disattivazione del database e dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="4d360-106">Learn about options, recommendations, and tutorials for recovering from disruptive events that could cause data loss or cause your database and application to become unavailable.</span></span> <span data-ttu-id="4d360-107">Informazioni sulle operazioni da eseguire quando si verifica un errore generato da un utente o da un'applicazione che influisce sull'integrità dei dati, se in un'area di Azure si verifica un'interruzione o quando l'applicazione richiede manutenzione.</span><span class="sxs-lookup"><span data-stu-id="4d360-107">Learn what to do when a user or application error affects data integrity, an Azure region has an outage, or your application requires maintenance.</span></span>

## <a name="sql-database-features-that-you-can-use-to-provide-business-continuity"></a><span data-ttu-id="4d360-108">Funzionalità del database SQL che è possibile usare per assicurare la continuità aziendale</span><span class="sxs-lookup"><span data-stu-id="4d360-108">SQL Database features that you can use to provide business continuity</span></span>

<span data-ttu-id="4d360-109">Il database SQL offre diverse funzionalità di continuità aziendale, inclusi i backup automatici e la replica facoltativa del database.</span><span class="sxs-lookup"><span data-stu-id="4d360-109">SQL Database provides several business continuity features, including automated backups and optional database replication.</span></span> <span data-ttu-id="4d360-110">Ogni funzionalità presenta caratteristiche diverse in termini di tempo di recupero stimato (ERT) e di potenziale perdita di dati per le transazioni recenti.</span><span class="sxs-lookup"><span data-stu-id="4d360-110">Each has different characteristics for estimated recovery time (ERT) and potential data loss for recent transactions.</span></span> <span data-ttu-id="4d360-111">Dopo aver compreso le opzioni disponibili, è possibile scegliere una di esse o, nella maggior parte dei casi, usarle in modo combinato per i diversi scenari.</span><span class="sxs-lookup"><span data-stu-id="4d360-111">Once you understand these options, you can choose among them - and, in most scenarios, use them together for different scenarios.</span></span> <span data-ttu-id="4d360-112">Quando si sviluppa il piano di continuità aziendale, è necessario comprendere il tempo massimo accettabile prima che l'applicazione venga ripristinata completamente dopo l'evento di arresto improvviso. Si tratta dell'obiettivo del tempo di ripristino (RTO).</span><span class="sxs-lookup"><span data-stu-id="4d360-112">As you develop your business continuity plan, you need to understand the maximum acceptable time before the application fully recovers after the disruptive event - this is your recovery time objective (RTO).</span></span> <span data-ttu-id="4d360-113">È anche necessario conoscere la perdita massima di aggiornamenti di dati recenti (intervallo di tempo) che l'applicazione è in grado di tollerare durante il ripristino dopo l'evento di arresto improvviso, ovvero l'obiettivo del punto di recupero (RPO).</span><span class="sxs-lookup"><span data-stu-id="4d360-113">You also need to understand the maximum amount of recent data updates (time interval) the application can tolerate losing when recovering after the disruptive event - this is your recovery point objective (RPO).</span></span>

<span data-ttu-id="4d360-114">La tabella seguente mette a confronto i valori ERT e RPO per i tre scenari più comuni.</span><span class="sxs-lookup"><span data-stu-id="4d360-114">The following table compares the ERT and RPO for the three most common scenarios.</span></span>

| <span data-ttu-id="4d360-115">Funzionalità</span><span class="sxs-lookup"><span data-stu-id="4d360-115">Capability</span></span> | <span data-ttu-id="4d360-116">Livello Basic</span><span class="sxs-lookup"><span data-stu-id="4d360-116">Basic tier</span></span> | <span data-ttu-id="4d360-117">Livello Standard</span><span class="sxs-lookup"><span data-stu-id="4d360-117">Standard tier</span></span> | <span data-ttu-id="4d360-118">Livello Premium</span><span class="sxs-lookup"><span data-stu-id="4d360-118">Premium tier</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="4d360-119">Ripristino temporizzato dal backup</span><span class="sxs-lookup"><span data-stu-id="4d360-119">Point in Time Restore from backup</span></span> |<span data-ttu-id="4d360-120">Qualsiasi punto di ripristino entro 7 giorni</span><span class="sxs-lookup"><span data-stu-id="4d360-120">Any restore point within 7 days</span></span> |<span data-ttu-id="4d360-121">Qualsiasi punto di ripristino entro 35 giorni</span><span class="sxs-lookup"><span data-stu-id="4d360-121">Any restore point within 35 days</span></span> |<span data-ttu-id="4d360-122">Qualsiasi punto di ripristino entro 35 giorni</span><span class="sxs-lookup"><span data-stu-id="4d360-122">Any restore point within 35 days</span></span> |
| <span data-ttu-id="4d360-123">Ripristino geografico dai backup con replica geografica</span><span class="sxs-lookup"><span data-stu-id="4d360-123">Geo-restore from geo-replicated backups</span></span> |<span data-ttu-id="4d360-124">ERT < 12 ore, RPO < 1 ora</span><span class="sxs-lookup"><span data-stu-id="4d360-124">ERT < 12h, RPO < 1h</span></span> |<span data-ttu-id="4d360-125">ERT < 12 ore, RPO < 1 ora</span><span class="sxs-lookup"><span data-stu-id="4d360-125">ERT < 12h, RPO < 1h</span></span> |<span data-ttu-id="4d360-126">ERT < 12 ore, RPO < 1 ora</span><span class="sxs-lookup"><span data-stu-id="4d360-126">ERT < 12h, RPO < 1h</span></span> |
| <span data-ttu-id="4d360-127">Ripristino dall'insieme di credenziali di Backup di Azure</span><span class="sxs-lookup"><span data-stu-id="4d360-127">Restore from Azure Backup Vault</span></span> |<span data-ttu-id="4d360-128">ERT < 12 ore, RPO < 1 sett</span><span class="sxs-lookup"><span data-stu-id="4d360-128">ERT < 12h, RPO < 1 wk</span></span> |<span data-ttu-id="4d360-129">ERT < 12 ore, RPO < 1 sett</span><span class="sxs-lookup"><span data-stu-id="4d360-129">ERT < 12h, RPO < 1 wk</span></span> |<span data-ttu-id="4d360-130">ERT < 12 ore, RPO < 1 sett</span><span class="sxs-lookup"><span data-stu-id="4d360-130">ERT < 12h, RPO < 1 wk</span></span> |
| <span data-ttu-id="4d360-131">Replica geografica attiva</span><span class="sxs-lookup"><span data-stu-id="4d360-131">Active geo-replication</span></span> |<span data-ttu-id="4d360-132">ERT < 30 sec, RPO < 5 sec</span><span class="sxs-lookup"><span data-stu-id="4d360-132">ERT < 30s, RPO < 5s</span></span> |<span data-ttu-id="4d360-133">ERT < 30 sec, RPO < 5 sec</span><span class="sxs-lookup"><span data-stu-id="4d360-133">ERT < 30s, RPO < 5s</span></span> |<span data-ttu-id="4d360-134">ERT < 30 sec, RPO < 5 sec</span><span class="sxs-lookup"><span data-stu-id="4d360-134">ERT < 30s, RPO < 5s</span></span> |

### <a name="use-database-backups-to-recover-a-database"></a><span data-ttu-id="4d360-135">Usare backup del database per il ripristinare</span><span class="sxs-lookup"><span data-stu-id="4d360-135">Use database backups to recover a database</span></span>

<span data-ttu-id="4d360-136">Il database SQL esegue automaticamente una combinazione di backup completi su base settimanale, backup differenziali del database di backup ogni ora e backup dei log delle transazioni ogni 5-10 minuti per proteggere l'azienda dalla perdita di dati.</span><span class="sxs-lookup"><span data-stu-id="4d360-136">SQL Database automatically performs a combination of full database backups weekly, differential database backups hourly, and transaction log backups every five - ten minutes to protect your business from data loss.</span></span> <span data-ttu-id="4d360-137">Questi backup vengono archiviati nel servizio di archiviazione con ridondanza geografica per 35 giorni per i database dei livelli di servizio Standard e Premium e per 7 giorni per il database del livello Basic.</span><span class="sxs-lookup"><span data-stu-id="4d360-137">These backups are stored in geo-redundant storage for 35 days for databases in the Standard and Premium service tiers and 7 days for databases in the Basic service tier.</span></span> <span data-ttu-id="4d360-138">Per altre informazioni, vedere [livelli di servizio](sql-database-service-tiers.md).</span><span class="sxs-lookup"><span data-stu-id="4d360-138">For more information, see [service tiers](sql-database-service-tiers.md).</span></span> <span data-ttu-id="4d360-139">Se il periodo di memorizzazione per il livello di servizio non soddisfa i requisiti aziendali, è possibile aumentare il periodo di memorizzazione [modificando il livello di servizio](sql-database-service-tiers.md).</span><span class="sxs-lookup"><span data-stu-id="4d360-139">If the retention period for your service tier does not meet your business requirements, you can increase the retention period by [changing the service tier](sql-database-service-tiers.md).</span></span> <span data-ttu-id="4d360-140">I backup completi e differenziali del database vengono replicati anche su un [data center abbinato](../best-practices-availability-paired-regions.md) per la protezione da un'interruzione del data center.</span><span class="sxs-lookup"><span data-stu-id="4d360-140">The full and differential database backups are also replicated to a [paired data center](../best-practices-availability-paired-regions.md) for protection against a data center outage.</span></span> <span data-ttu-id="4d360-141">Per altre informazioni, vedere [backup automatici del database SQL](sql-database-automated-backups.md).</span><span class="sxs-lookup"><span data-stu-id="4d360-141">For more information, see [automatic database backups](sql-database-automated-backups.md).</span></span>

<span data-ttu-id="4d360-142">Se il periodo di memorizzazione predefinito non è sufficiente per l'applicazione, è possibile estenderlo configurando criteri di conservazione a lungo termine per il database.</span><span class="sxs-lookup"><span data-stu-id="4d360-142">If the built-in retention period is not sufficient for your application, you can extend it by configuring a database long-term retention policy.</span></span> <span data-ttu-id="4d360-143">Per altre informazioni, vedere [Long-term retention](sql-database-long-term-retention.md) (Conservazione a lungo termine).</span><span class="sxs-lookup"><span data-stu-id="4d360-143">For more information, see [long-term retention](sql-database-long-term-retention.md).</span></span>

<span data-ttu-id="4d360-144">È possibile usare questi backup automatici del database per ripristinare un database da una serie di eventi di arresto improvviso, sia all'interno del proprio data center sia verso un altro data center.</span><span class="sxs-lookup"><span data-stu-id="4d360-144">You can use these automatic database backups to recover a database from various disruptive events, both within your data center and to another data center.</span></span> <span data-ttu-id="4d360-145">Il tempo stimato per il ripristino tramite backup automatici del database dipende da diversi fattori, tra cui il numero totale di database in fase di ripristino nella stessa area contemporaneamente, le dimensioni del database, le dimensioni del log delle transazioni e la larghezza di banda della rete.</span><span class="sxs-lookup"><span data-stu-id="4d360-145">Using automatic database backups, the estimated time of recovery depends on several factors including the total number of databases recovering in the same region at the same time, the database size, the transaction log size, and network bandwidth.</span></span> <span data-ttu-id="4d360-146">Il tempo di recupero di solito è inferiore a 12 ore.</span><span class="sxs-lookup"><span data-stu-id="4d360-146">The recovery time is usually less than 12 hours.</span></span> <span data-ttu-id="4d360-147">Durante il ripristino verso un'altra area dati, la potenziale perdita di dati è limitata a 1 ora per l'archiviazione con ridondanza geografica dei backup differenziali del database che si verificano ogni ora.</span><span class="sxs-lookup"><span data-stu-id="4d360-147">When recovering to another data region, the potential data loss is limited to 1 hour by the geo-redundant storage of hourly differential database backups.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="4d360-148">Per eseguire il ripristino tramite i backup automatici, è necessario essere un membro del ruolo di collaboratore di SQL Server o proprietario della sottoscrizione. Vedere [Controllo degli accessi in base al ruolo: ruoli predefiniti](../active-directory/role-based-access-built-in-roles.md).</span><span class="sxs-lookup"><span data-stu-id="4d360-148">To recover using automated backups, you must be a member of the SQL Server Contributor role or the subscription owner - see [RBAC: Built-in roles](../active-directory/role-based-access-built-in-roles.md).</span></span> <span data-ttu-id="4d360-149">Per il ripristino, è possibile usare il portale di Azure, PowerShell o l'API REST.</span><span class="sxs-lookup"><span data-stu-id="4d360-149">You can recover using the Azure portal, PowerShell, or the REST API.</span></span> <span data-ttu-id="4d360-150">Non è possibile usare Transact-SQL.</span><span class="sxs-lookup"><span data-stu-id="4d360-150">You cannot use Transact-SQL.</span></span>
>

<span data-ttu-id="4d360-151">Usare i backup automatici come meccanismo di continuità e ripristino aziendale, se l'applicazione:</span><span class="sxs-lookup"><span data-stu-id="4d360-151">Use automated backups as your business continuity and recovery mechanism if your application:</span></span>

* <span data-ttu-id="4d360-152">Non è considerata cruciale.</span><span class="sxs-lookup"><span data-stu-id="4d360-152">Is not considered mission critical.</span></span>
* <span data-ttu-id="4d360-153">Non ha un contratto di servizio vincolante: un tempo di inattività di 24 o più ore non comporta alcuna responsabilità finanziaria.</span><span class="sxs-lookup"><span data-stu-id="4d360-153">Doesn't have a binding SLA - a downtime of 24 hours or longer does not result in financial liability.</span></span>
* <span data-ttu-id="4d360-154">Ha una bassa frequenza di modifica dei dati, ovvero poche transazioni per ora, e la perdita di un massimo di un'ora di modifica dei dati è accettabile.</span><span class="sxs-lookup"><span data-stu-id="4d360-154">Has a low rate of data change (low transactions per hour) and losing up to an hour of change is an acceptable data loss.</span></span>
* <span data-ttu-id="4d360-155">Dipende dal costo.</span><span class="sxs-lookup"><span data-stu-id="4d360-155">Is cost sensitive.</span></span>

<span data-ttu-id="4d360-156">Se è necessario un ripristino più veloce, usare la [Replica geografica attiva](sql-database-geo-replication-overview.md) (più avanti).</span><span class="sxs-lookup"><span data-stu-id="4d360-156">If you need faster recovery, use [active geo-replication](sql-database-geo-replication-overview.md) (discussed next).</span></span> <span data-ttu-id="4d360-157">Se è necessario essere in grado di ripristinare i dati da un periodo antecedente a 35 giorni, usare la [conservazione dei backup a lungo termine](sql-database-long-term-retention.md).</span><span class="sxs-lookup"><span data-stu-id="4d360-157">If you need to be able to recover data from a period older than 35 days, use [long-term backup retention](sql-database-long-term-retention.md).</span></span> 

### <a name="use-active-geo-replication-and-auto-failover-groups-in-preview-to-reduce-recovery-time-and-limit-data-loss-associated-with-a-recovery"></a><span data-ttu-id="4d360-158">Usare la replica geografica attiva e i gruppi di failover automatico (in anteprima) per ridurre il tempo di recupero e limitare la perdita di dati associata a un ripristino</span><span class="sxs-lookup"><span data-stu-id="4d360-158">Use active geo-replication and auto-failover groups (in-preview) to reduce recovery time and limit data loss associated with a recovery</span></span>

<span data-ttu-id="4d360-159">Oltre a usare i backup del database per il ripristino del database se si verifica un'interruzione aziendale, è possibile usare la [replica geografica attiva](sql-database-geo-replication-overview.md) per configurare un database in modo da avere fino a 4 database secondari leggibili nelle aree scelte.</span><span class="sxs-lookup"><span data-stu-id="4d360-159">In addition to using database backups for database recovery if a business disruption occurs, you can use [active geo-replication](sql-database-geo-replication-overview.md) to configure a database to have up to four readable secondary databases in the regions of your choice.</span></span> <span data-ttu-id="4d360-160">Questi database secondari vengono mantenuti sincronizzati con il database primario tramite un meccanismo di replica asincrona.</span><span class="sxs-lookup"><span data-stu-id="4d360-160">These secondary databases are kept synchronized with the primary database using an asynchronous replication mechanism.</span></span> <span data-ttu-id="4d360-161">Questa funzionalità viene usata per la protezione da interruzioni delle attività aziendali se si verifica un'interruzione del data center o durante un aggiornamento dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="4d360-161">This feature is used to protect against business disruption if a data center outage occurs or during an application upgrade.</span></span> <span data-ttu-id="4d360-162">La replica geografica attiva può anche essere usata per offrire agli utenti situati in aree geografiche diverse prestazioni migliori per le query di sola lettura.</span><span class="sxs-lookup"><span data-stu-id="4d360-162">Active geo-replication can also be used to provide better query performance for read-only queries to geographically dispersed users.</span></span>

<span data-ttu-id="4d360-163">Per abilitare il failover automatico e trasparente è necessario organizzare i database replicati geograficamente in gruppi tramite la funzionalità [auto-failover group](sql-database-geo-replication-overview.md) del database SQL (in anteprima).</span><span class="sxs-lookup"><span data-stu-id="4d360-163">To enable automated and transparent failover you should organize your geo-replicated databases into groups using the [auto-failover group](sql-database-geo-replication-overview.md) feature of SQL Database (in-preview).</span></span>

<span data-ttu-id="4d360-164">Se il database primario viene portato offline in modo imprevisto o è necessario portarlo online per attività di manutenzione, è possibile convertire rapidamente un database secondario perché diventi il database primario (detto anche failover) e configurare le applicazioni per la connessione al database primario alzato di livello.</span><span class="sxs-lookup"><span data-stu-id="4d360-164">If the primary database goes offline unexpectedly or you need to take it offline for maintenance activities, you can quickly promote a secondary to become the primary (also called a failover) and configure applications to connect to the promoted primary.</span></span> <span data-ttu-id="4d360-165">Se l'applicazione si connette ai database tramite il listener del gruppo di failover, non è necessario modificare la configurazione della stringa di connessione SQL dopo il failover.</span><span class="sxs-lookup"><span data-stu-id="4d360-165">If your application is connecting to the databases using the failover group listener, you don’t need to change the SQL connection string configuration after failover.</span></span> <span data-ttu-id="4d360-166">Con un failover pianificato, non si verificano perdite di dati.</span><span class="sxs-lookup"><span data-stu-id="4d360-166">With a planned failover, there is no data loss.</span></span> <span data-ttu-id="4d360-167">Con un failover non pianificato, potrebbero verificarsi piccole perdite di dati per le transazioni molto recenti a causa della natura di replica asincrona.</span><span class="sxs-lookup"><span data-stu-id="4d360-167">With an unplanned failover, there may be some small amount of data loss for very recent transactions due to the nature of asynchronous replication.</span></span> <span data-ttu-id="4d360-168">Con l'uso di gruppi con failover automatico (in anteprima), è possibile personalizzare i criteri di failover per ridurre al minimo la perdita di dati.</span><span class="sxs-lookup"><span data-stu-id="4d360-168">Using auto-failover groups (in-preview), you can customize the failover policy to minimize the potential data loss.</span></span> <span data-ttu-id="4d360-169">Dopo un failover, è possibile eseguire un failback sulla base di un piano o del momento in cui il data center ritorna online.</span><span class="sxs-lookup"><span data-stu-id="4d360-169">After a failover, you can later failback - either according to a plan or when the data center comes back online.</span></span> <span data-ttu-id="4d360-170">In tutti i casi, gli utenti riscontrano un breve tempo di inattività e devono eseguire nuovamente la connessione.</span><span class="sxs-lookup"><span data-stu-id="4d360-170">In all cases, users experience a small amount of downtime and need to reconnect.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="4d360-171">Per usare la replica geografica attiva e i gruppi di failover automatico (in anteprima), è necessario essere il proprietario della sottoscrizione o disporre delle autorizzazioni di amministrazione in SQL Server.</span><span class="sxs-lookup"><span data-stu-id="4d360-171">To use active geo-replication and auto-failover groups (in-preview), you must either be the subscription owner or have administrative permissions in SQL Server.</span></span> <span data-ttu-id="4d360-172">È possibile configurare ed eseguire il failover tramite il portale di Azure, PowerShell o l'API REST usando le autorizzazioni della sottoscrizione o usando Transact-SQL con le autorizzazioni di SQL Server.</span><span class="sxs-lookup"><span data-stu-id="4d360-172">You can configure and fail over using the Azure portal, PowerShell, or the REST API using Azure subscription permissions or using Transact-SQL with SQL Server permissions.</span></span>
> 

<span data-ttu-id="4d360-173">Usare la replica geografica attiva e i gruppi con failover automatico (in anteprima) se l'applicazione soddisfa qualcuno dei criteri seguenti:</span><span class="sxs-lookup"><span data-stu-id="4d360-173">Use active geo-replication and auto-failover groups (in preview) if your application meets any of these criteria:</span></span>

* <span data-ttu-id="4d360-174">È considerata cruciale.</span><span class="sxs-lookup"><span data-stu-id="4d360-174">Is mission critical.</span></span>
* <span data-ttu-id="4d360-175">Ha un contratto di servizio che non consente più di 24 ore di inattività.</span><span class="sxs-lookup"><span data-stu-id="4d360-175">Has a service level agreement (SLA) that does not allow for 24 hours or more of downtime.</span></span>
* <span data-ttu-id="4d360-176">Il tempo di inattività può implicare responsabilità finanziaria.</span><span class="sxs-lookup"><span data-stu-id="4d360-176">Downtime may result in financial liability.</span></span>
* <span data-ttu-id="4d360-177">Ha una frequenza elevata di modifica dei dati e la perdita di un'ora di dati non è accettabile.</span><span class="sxs-lookup"><span data-stu-id="4d360-177">Has a high rate of data change is high and losing an hour of data is not acceptable.</span></span>
* <span data-ttu-id="4d360-178">Il costo aggiuntivo della replica geografica attiva è inferiore rispetto alla potenziale responsabilità finanziaria e alla perdita di profitto associata.</span><span class="sxs-lookup"><span data-stu-id="4d360-178">The additional cost of active geo-replication is lower than the potential financial liability and associated loss of business.</span></span>

>
> [!VIDEO https://channel9.msdn.com/Blogs/Azure/Azure-SQL-Database-protecting-important-DBs-from-regional-disasters-is-easy/player]
>

## <a name="recover-a-database-after-a-user-or-application-error"></a><span data-ttu-id="4d360-179">Ripristinare un database in seguito a errore di un'applicazione o un utente</span><span class="sxs-lookup"><span data-stu-id="4d360-179">Recover a database after a user or application error</span></span>
<span data-ttu-id="4d360-180">* Nessuno è perfetto!</span><span class="sxs-lookup"><span data-stu-id="4d360-180">*No one is perfect!</span></span> <span data-ttu-id="4d360-181">Un utente potrebbe accidentalmente eliminare alcuni dati, una tabella importante o addirittura un intero database.</span><span class="sxs-lookup"><span data-stu-id="4d360-181">A user might accidentally delete some data, inadvertently drop an important table, or even drop an entire database.</span></span> <span data-ttu-id="4d360-182">In alternativa un'applicazione potrebbe sovrascrivere accidentalmente dei dati con dati errati a causa di un difetto dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="4d360-182">Or, an application might accidentally overwrite good data with bad data due to an application defect.</span></span>

<span data-ttu-id="4d360-183">In questo scenario, ecco sono le opzioni di ripristino.</span><span class="sxs-lookup"><span data-stu-id="4d360-183">In this scenario, these are your recovery options.</span></span>

### <a name="perform-a-point-in-time-restore"></a><span data-ttu-id="4d360-184">Eseguire un ripristino temporizzato</span><span class="sxs-lookup"><span data-stu-id="4d360-184">Perform a point-in-time restore</span></span>
<span data-ttu-id="4d360-185">È possibile usare i backup automatici per ripristinare una copia del database a un punto valido nel tempo, purché rientri nel periodo di memorizzazione del database.</span><span class="sxs-lookup"><span data-stu-id="4d360-185">You can use the automated backups to recover a copy of your database to a known good point in time, provided that time is within the database retention period.</span></span> <span data-ttu-id="4d360-186">Dopo il ripristino del database, è possibile sostituire il database originale con il database ripristinato o copiare i dati necessari dai dati ripristinati nel database originale.</span><span class="sxs-lookup"><span data-stu-id="4d360-186">After the database is restored, you can either replace the original database with the restored database or copy the needed data from the restored data into the original database.</span></span> <span data-ttu-id="4d360-187">Se il database usa la replica geografica attiva, è consigliabile copiare i dati necessari dalla copia ripristinata nel database originale.</span><span class="sxs-lookup"><span data-stu-id="4d360-187">If the database uses active geo-replication, we recommend copying the required data from the restored copy into the original database.</span></span> <span data-ttu-id="4d360-188">Se il database originale viene sostituito con il database ripristinato, è necessario riconfigurare e risincronizzare la replica geografica attiva (cosa che può richiedere molto tempo per un database di grandi dimensioni).</span><span class="sxs-lookup"><span data-stu-id="4d360-188">If you replace the original database with the restored database, you need to reconfigure and resynchronize active geo-replication (which can take quite some time for a large database).</span></span>

<span data-ttu-id="4d360-189">Per altre informazioni e per i passaggi dettagliati per il ripristino di un database in un punto nel tempo tramite il portale di Azure o PowerShell, vedere [Ripristino temporizzato](sql-database-recovery-using-backups.md#point-in-time-restore).</span><span class="sxs-lookup"><span data-stu-id="4d360-189">For more information and for detailed steps for restoring a database to a point in time using the Azure portal or using PowerShell, see [point-in-time restore](sql-database-recovery-using-backups.md#point-in-time-restore).</span></span> <span data-ttu-id="4d360-190">Non è possibile eseguire il ripristino tramite Transact-SQL.</span><span class="sxs-lookup"><span data-stu-id="4d360-190">You cannot recover using Transact-SQL.</span></span>

### <a name="restore-a-deleted-database"></a><span data-ttu-id="4d360-191">Ripristino di un database eliminato</span><span class="sxs-lookup"><span data-stu-id="4d360-191">Restore a deleted database</span></span>
<span data-ttu-id="4d360-192">Se il database viene eliminato, ma il server logico non è stato eliminato, è possibile ripristinare il database eliminato sul punto in cui è stato eliminato.</span><span class="sxs-lookup"><span data-stu-id="4d360-192">If the database is deleted but the logical server has not been deleted, you can restore the deleted database to the point at which it was deleted.</span></span> <span data-ttu-id="4d360-193">Ciò consente di ripristinare un backup del database nello stesso server SQL logico da cui è stato eliminato.</span><span class="sxs-lookup"><span data-stu-id="4d360-193">This restores a database backup to the same logical SQL server from which it was deleted.</span></span> <span data-ttu-id="4d360-194">È possibile eseguire il ripristino usando il nome originale o fornire un nuovo nome al database ripristinato.</span><span class="sxs-lookup"><span data-stu-id="4d360-194">You can restore it using the original name or provide a new name or the restored database.</span></span>

<span data-ttu-id="4d360-195">Per altre informazioni e per i passaggi dettagliati per il ripristino di un database eliminato tramite il portale di Azure o PowerShell, vedere [Ripristino di un database eliminato](sql-database-recovery-using-backups.md#deleted-database-restore).</span><span class="sxs-lookup"><span data-stu-id="4d360-195">For more information and for detailed steps for restoring a deleted database using the Azure portal or using PowerShell, see [restore a deleted database](sql-database-recovery-using-backups.md#deleted-database-restore).</span></span> <span data-ttu-id="4d360-196">Non è possibile eseguire il recupero tramite Transact-SQL.</span><span class="sxs-lookup"><span data-stu-id="4d360-196">You cannot restore using Transact-SQL.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="4d360-197">Se il server logico viene eliminato, non è possibile recuperare un database eliminato.</span><span class="sxs-lookup"><span data-stu-id="4d360-197">If the logical server is deleted, you cannot recover a deleted database.</span></span>
>
>

### <a name="restore-from-azure-backup-vault"></a><span data-ttu-id="4d360-198">Ripristino dall'insieme di credenziali di Backup di Azure</span><span class="sxs-lookup"><span data-stu-id="4d360-198">Restore from Azure Backup Vault</span></span>
<span data-ttu-id="4d360-199">Se la perdita di dati si è verificata fuori dal periodo di memorizzazione corrente per i backup automatici e il database è configurato per la conservazione a lungo termine, è possibile eseguire il ripristino da un backup settimanale nell'insieme di credenziali di Backup di Azure in un nuovo database.</span><span class="sxs-lookup"><span data-stu-id="4d360-199">If the data loss occurred outside the current retention period for automated backups and your database is configured for long-term retention, you can restore from a weekly backup in Azure Backup Vault to a new database.</span></span> <span data-ttu-id="4d360-200">A questo punto, è possibile sostituire il database originale con il database ripristinato o copiare i dati necessari dai dati ripristinati nel database originale.</span><span class="sxs-lookup"><span data-stu-id="4d360-200">At this point, you can either replace the original database with the restored database or copy the needed data from the restored database into the original database.</span></span> <span data-ttu-id="4d360-201">Se si vuole recuperare una versione precedente del database prima di un aggiornamento importante dell'applicazione oppure soddisfare una richiesta dei revisori o di carattere legale, è possibile creare un database usando un backup completo salvato nell'insieme di credenziali di Backup di Azure.</span><span class="sxs-lookup"><span data-stu-id="4d360-201">If you need to retrieve an old version of your database prior to a major application upgrade, satisfy a request from auditors or a legal order, you can create a database using a full backup saved in the Azure Backup Vault.</span></span>  <span data-ttu-id="4d360-202">Per altre informazioni, vedere [Long-term retention](sql-database-long-term-retention.md) (Conservazione a lungo termine).</span><span class="sxs-lookup"><span data-stu-id="4d360-202">For more information, see [Long-term retention](sql-database-long-term-retention.md).</span></span>

## <a name="recover-a-database-to-another-region-from-an-azure-regional-data-center-outage"></a><span data-ttu-id="4d360-203">Ripristinare un database in un'altra area da un'interruzione del data center regionale di Azure</span><span class="sxs-lookup"><span data-stu-id="4d360-203">Recover a database to another region from an Azure regional data center outage</span></span>
<!-- Explain this scenario -->

<span data-ttu-id="4d360-204">Anche se raramente, un data center di Azure può subire un'interruzione del servizio.</span><span class="sxs-lookup"><span data-stu-id="4d360-204">Although rare, an Azure data center can have an outage.</span></span> <span data-ttu-id="4d360-205">Quando si verifica un'interruzione, viene generata un'interruzione delle attività che potrebbe durare solo pochi minuti oppure ore.</span><span class="sxs-lookup"><span data-stu-id="4d360-205">When an outage occurs, it causes a business disruption that might only last a few minutes or might last for hours.</span></span>

* <span data-ttu-id="4d360-206">Una delle opzioni è attendere che il database torni online al termine dell'interruzione del data center.</span><span class="sxs-lookup"><span data-stu-id="4d360-206">One option is to wait for your database to come back online when the data center outage is over.</span></span> <span data-ttu-id="4d360-207">Questa opzione funziona per le applicazioni che possono rimanere con il database offline.</span><span class="sxs-lookup"><span data-stu-id="4d360-207">This works for applications that can afford to have the database offline.</span></span> <span data-ttu-id="4d360-208">Ad esempio, un progetto di sviluppo o una versione di valutazione gratuita su cui non è necessario lavorare costantemente.</span><span class="sxs-lookup"><span data-stu-id="4d360-208">For example, a development project or free trial you don't need to work on constantly.</span></span> <span data-ttu-id="4d360-209">Quando un data center registra un'interruzione del servizio, non si sa quanto tempo essa durerà. Pertanto, questa opzione funziona solo se è possibile rinunciare al database per un periodo di tempo.</span><span class="sxs-lookup"><span data-stu-id="4d360-209">When a data center has an outage, you do not know how long the outage might last, so this option only works if you don't need your database for a while.</span></span>
* <span data-ttu-id="4d360-210">Un'altra opzione consiste nell'eseguire il failover in un'altra area dati se si usa la replica geografica attiva o il ripristino di un database tramite backup di database con ridondanza geografica (ripristino geografico).</span><span class="sxs-lookup"><span data-stu-id="4d360-210">Another option is to either fail over to another data region if you are using active geo-replication or the recover a database using geo-redundant database backups (geo-restore).</span></span> <span data-ttu-id="4d360-211">Il failover richiede solo pochi secondi mentre il ripristino del database da backup richiede ore.</span><span class="sxs-lookup"><span data-stu-id="4d360-211">Failover takes only a few seconds while database recovery from backups takes hours.</span></span>

<span data-ttu-id="4d360-212">Quando si esegue l'operazione, il tempo necessario per eseguire il ripristino e la quantità di dati persi dipendono dalle modalità in cui si decide di usare la funzionalità di continuità aziendale nell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="4d360-212">When you take action, how long it takes you to recover, and how much data loss you incur depends upon how you decide to use these business continuity features in your application.</span></span> <span data-ttu-id="4d360-213">In effetti, è possibile scegliere di usare una combinazione di backup del database e replica geografica attiva a seconda dei requisiti dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="4d360-213">Indeed, you may choose to use a combination of database backups and active geo-replication depending upon your application requirements.</span></span> <span data-ttu-id="4d360-214">Per una descrizione delle considerazioni sulla progettazione di applicazioni per database autonomi e pool elastici tramite queste funzioni di continuità aziendale, vedere [Progettare un'applicazione per il ripristino di emergenza cloud](sql-database-designing-cloud-solutions-for-disaster-recovery.md) e [Strategie di ripristino di emergenza per applicazioni che usano il pool elastico del database SQL](sql-database-disaster-recovery-strategies-for-applications-with-elastic-pool.md).</span><span class="sxs-lookup"><span data-stu-id="4d360-214">For a discussion of application design considerations for stand-alone databases and for elastic pools using these business continuity features, see [Design an application for cloud disaster recovery](sql-database-designing-cloud-solutions-for-disaster-recovery.md) and [Elastic Pool disaster recovery strategies](sql-database-disaster-recovery-strategies-for-applications-with-elastic-pool.md).</span></span>

<span data-ttu-id="4d360-215">Le sezioni seguenti forniscono una panoramica della procedura per eseguire il ripristino tramite backup del database o replica geografica attiva.</span><span class="sxs-lookup"><span data-stu-id="4d360-215">The following sections provide an overview of the steps to recover using either database backups or active geo-replication.</span></span> <span data-ttu-id="4d360-216">Per la procedura dettagliata, inclusa la pianificazione dei requisiti, i passaggi successivi al ripristino e informazioni su come simulare un'interruzione del servizio per eseguire un'analisi del ripristino di emergenza, vedere [Ripristinare un database SQL di Azure o eseguire il failover in un database secondario](sql-database-disaster-recovery.md).</span><span class="sxs-lookup"><span data-stu-id="4d360-216">For detailed steps including planning requirements, post recovery steps, and information about how to simulate an outage to perform a disaster recovery drill, see [Recover a SQL Database from an outage](sql-database-disaster-recovery.md).</span></span>

### <a name="prepare-for-an-outage"></a><span data-ttu-id="4d360-217">Prepararsi a un'interruzione del servizio</span><span class="sxs-lookup"><span data-stu-id="4d360-217">Prepare for an outage</span></span>
<span data-ttu-id="4d360-218">Indipendentemente dalla funzionalità di continuità aziendale in uso, è necessario:</span><span class="sxs-lookup"><span data-stu-id="4d360-218">Regardless of the business continuity feature you use, you must:</span></span>

* <span data-ttu-id="4d360-219">Identificare e preparare il server di destinazione, tra cui le regole del firewall a livello di server, gli account di accesso e le autorizzazioni a livello di database master.</span><span class="sxs-lookup"><span data-stu-id="4d360-219">Identify and prepare the target server, including server-level firewall rules, logins, and master database level permissions.</span></span>
* <span data-ttu-id="4d360-220">Stabilire come verranno reindirizzati i client e le applicazioni client verso il nuovo server</span><span class="sxs-lookup"><span data-stu-id="4d360-220">Determine how to redirect clients and client applications to the new server</span></span>
* <span data-ttu-id="4d360-221">Documentare altre dipendenze, ad esempio impostazioni di controllo e avvisi</span><span class="sxs-lookup"><span data-stu-id="4d360-221">Document other dependencies, such as auditing settings and alerts</span></span>

<span data-ttu-id="4d360-222">Se non ci si prepara adeguatamente al ripristino, riportare online le applicazioni dopo un failover o un ripristino del database richiederà ulteriore tempo e probabilmente la risoluzione di problemi aggiuntivi in un momento di stress: una combinazione da evitare.</span><span class="sxs-lookup"><span data-stu-id="4d360-222">If you do not prepare properly, bringing your applications online after a failover or a database recovery takes additional time and likely also require troubleshooting at a time of stress - a bad combination.</span></span>

### <a name="fail-over-to-a-geo-replicated-secondary-database"></a><span data-ttu-id="4d360-223">Failover a un database secondario con replica geografica</span><span class="sxs-lookup"><span data-stu-id="4d360-223">Fail over to a geo-replicated secondary database</span></span>
<span data-ttu-id="4d360-224">Se si usa la replica geografica attiva e i gruppi con failover automatico (in anteprima) come meccanismo di ripristino, è possibile configurare i criteri di failover automatico o usare il [failover manuale](sql-database-disaster-recovery.md#fail-over-to-geo-replicated-secondary-database).</span><span class="sxs-lookup"><span data-stu-id="4d360-224">If you are using active geo-replication and auto-failover groups (in-preview) as your recovery mechanism, you can configure an automatic failover policy or use [manual failover](sql-database-disaster-recovery.md#fail-over-to-geo-replicated-secondary-database).</span></span> <span data-ttu-id="4d360-225">Una volta avviato, il failover fa sì che il database secondario venga alzato di livello come nuovo database primario e sia pronto per registrare nuove transazioni e rispondere a tutte le query, con una perdita di dati minima per i dati non ancora replicati.</span><span class="sxs-lookup"><span data-stu-id="4d360-225">Once initiated, the failover causes the secondary to become the new primary and ready to record new transactions and respond to queries - with minimal data loss for the data not yet replicated.</span></span> <span data-ttu-id="4d360-226">Per informazioni su come progettare il processo di failover, vedere [Progettare un'applicazione per il ripristino di emergenza cloud](sql-database-designing-cloud-solutions-for-disaster-recovery.md).</span><span class="sxs-lookup"><span data-stu-id="4d360-226">For information on designing the failover process, see [Design an application for cloud disaster recovery](sql-database-designing-cloud-solutions-for-disaster-recovery.md).</span></span>

> [!NOTE]
> <span data-ttu-id="4d360-227">Quando il data center ritorna in linea, i database primari precedenti si ricollegano automaticamente al nuovo database primario e diventano database secondari.</span><span class="sxs-lookup"><span data-stu-id="4d360-227">When the data center comes back online the old primaries automatically reconnect to the new primary and become secondary databases.</span></span> <span data-ttu-id="4d360-228">Se si desidera spostare di nuovo il database primario nell'area originale è possibile avviare manualmente un failover pianificato (failback).</span><span class="sxs-lookup"><span data-stu-id="4d360-228">If you need to relocate the primary back to the original region, you can initiate a planned failover manually (failback).</span></span> 
> 

### <a name="perform-a-geo-restore"></a><span data-ttu-id="4d360-229">Eseguire un ripristino geografico</span><span class="sxs-lookup"><span data-stu-id="4d360-229">Perform a geo-restore</span></span>
<span data-ttu-id="4d360-230">Se si usano backup automatici con la replica dell'archiviazione con ridondanza geografica come meccanismo di ripristino, [avviare il ripristino del database tramite ripristino geografico](sql-database-disaster-recovery.md#recover-using-geo-restore).</span><span class="sxs-lookup"><span data-stu-id="4d360-230">If you are using automated backups with geo-redundant storage replication as your recovery mechanism, [initiate a database recovery using geo-restore](sql-database-disaster-recovery.md#recover-using-geo-restore).</span></span> <span data-ttu-id="4d360-231">In genere il ripristino avviene entro 12 ore, con perdita di dati fino a 1 ora dall'ultima acquisizione e replica del backup differenziale orario.</span><span class="sxs-lookup"><span data-stu-id="4d360-231">Recovery usually takes place within 12 hours - with data loss of up to one hour determined by when the last hourly differential backup with taken and replicated.</span></span> <span data-ttu-id="4d360-232">Fino a quando non viene completato il ripristino, il database non è in grado di registrare tutte le transazioni o rispondere a tutte le query.</span><span class="sxs-lookup"><span data-stu-id="4d360-232">Until the recovery completes, the database is unable to record any transactions or respond to any queries.</span></span> <span data-ttu-id="4d360-233">Quando si ripristina un database all'ultimo punto disponibile il ripristino geo-secondario in qualsiasi punto nel tempo non è attualmente supportato.</span><span class="sxs-lookup"><span data-stu-id="4d360-233">While this restores a database to the last available point in time, restoring the geo-secondary to any point in time is not currently supported.</span></span>

> [!NOTE]
> <span data-ttu-id="4d360-234">Se il data center ritorna online prima che l'applicazione venga spostata sul database ripristinato, è possibile annullare il ripristino.</span><span class="sxs-lookup"><span data-stu-id="4d360-234">If the data center comes back online before you switch your application over to the recovered database, you can cancel the recovery.</span></span>  
>
>

### <a name="perform-post-failover--recovery-tasks"></a><span data-ttu-id="4d360-235">Eseguire attività successive al filover/ripristino</span><span class="sxs-lookup"><span data-stu-id="4d360-235">Perform post failover / recovery tasks</span></span>
<span data-ttu-id="4d360-236">Dopo il ripristino da un meccanismo di ripristino, è necessario eseguire le seguenti attività aggiuntive prima che utenti e applicazioni siano nuovamente attivi e in esecuzione:</span><span class="sxs-lookup"><span data-stu-id="4d360-236">After recovery from either recovery mechanism, you must perform the following additional tasks before your users and applications are back up and running:</span></span>

* <span data-ttu-id="4d360-237">Reindirizzare i client e le applicazioni client verso il nuovo server e il database ripristinato</span><span class="sxs-lookup"><span data-stu-id="4d360-237">Redirect clients and client applications to the new server and restored database</span></span>
* <span data-ttu-id="4d360-238">Verificare che siano disponibili le regole del firewall a livello di server appropriate per consentire agli utenti di connettersi o usare i [firewall a livello di database](sql-database-firewall-configure.md#creating-and-managing-firewall-rules)</span><span class="sxs-lookup"><span data-stu-id="4d360-238">Ensure appropriate server-level firewall rules are in place for users to connect (or use [database-level firewalls](sql-database-firewall-configure.md#creating-and-managing-firewall-rules))</span></span>
* <span data-ttu-id="4d360-239">Verificare che siano presenti gli account di accesso appropriato e le autorizzazioni a livello di database master o usare gli [utenti contenuti](https://msdn.microsoft.com/library/ff929188.aspx)</span><span class="sxs-lookup"><span data-stu-id="4d360-239">Ensure appropriate logins and master database level permissions are in place (or use [contained users](https://msdn.microsoft.com/library/ff929188.aspx))</span></span>
* <span data-ttu-id="4d360-240">Configurare il controllo in base alle proprie esigenze.</span><span class="sxs-lookup"><span data-stu-id="4d360-240">Configure auditing, as appropriate</span></span>
* <span data-ttu-id="4d360-241">Configurare gli avvisi in base alle proprie esigenze.</span><span class="sxs-lookup"><span data-stu-id="4d360-241">Configure alerts, as appropriate</span></span>

## <a name="upgrade-an-application-with-minimal-downtime"></a><span data-ttu-id="4d360-242">Aggiornare un'applicazione con tempo di inattività minimo</span><span class="sxs-lookup"><span data-stu-id="4d360-242">Upgrade an application with minimal downtime</span></span>
<span data-ttu-id="4d360-243">A volte un'applicazione deve essere portata offline per ragioni di manutenzione pianificata, ad esempio un aggiornamento dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="4d360-243">Sometimes an application must be taken offline because of planned maintenance such as an application upgrade.</span></span> <span data-ttu-id="4d360-244">[Gestione degli aggiornamenti dell'applicazione](sql-database-manage-application-rolling-upgrade.md) descrive come usare la replica geografica attiva per consentire gli aggiornamenti in sequenza dell'applicazione cloud al fine di ridurre al minimo i tempi di inattività durante gli aggiornamenti e fornire un percorso di recupero se si verificano problemi.</span><span class="sxs-lookup"><span data-stu-id="4d360-244">[Manage application upgrades](sql-database-manage-application-rolling-upgrade.md) describes how to use active geo-replication to enable rolling upgrades of your cloud application to minimize downtime during upgrades and provide a recovery path if something goes wrong.</span></span> 

## <a name="next-steps"></a><span data-ttu-id="4d360-245">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="4d360-245">Next steps</span></span>
<span data-ttu-id="4d360-246">Per una descrizione delle considerazioni sulla progettazione di applicazioni per database autonomi e pool elastici, vedere [Progettare un'applicazione per il ripristino di emergenza cloud](sql-database-designing-cloud-solutions-for-disaster-recovery.md) e [Strategie di ripristino di emergenza per applicazioni che usano il pool elastico del database SQL](sql-database-disaster-recovery-strategies-for-applications-with-elastic-pool.md).</span><span class="sxs-lookup"><span data-stu-id="4d360-246">For a discussion of application design considerations for stand-alone databases and for elastic pools, see [Design an application for cloud disaster recovery](sql-database-designing-cloud-solutions-for-disaster-recovery.md) and [Elastic Pool disaster recovery strategies](sql-database-disaster-recovery-strategies-for-applications-with-elastic-pool.md).</span></span>
