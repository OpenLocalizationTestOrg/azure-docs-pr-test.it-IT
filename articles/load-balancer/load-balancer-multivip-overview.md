---
title: aaaMultiple VIP di bilanciamento del carico di Azure | Documenti Microsoft
description: "Panoramica di più indirizzi VIP in Azure Load Balancer"
services: load-balancer
documentationcenter: na
author: chkuhtz
manager: narayan
editor: 
ms.assetid: 748e50cd-3087-4c2e-a9e1-ac0ecce4f869
ms.service: load-balancer
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 08/11/2016
ms.author: chkuhtz
ms.openlocfilehash: e186e1248e7d187e7efd0668dc3244465ce3e156
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/06/2017
---
# <a name="multiple-vips-for-azure-load-balancer"></a><span data-ttu-id="3f001-103">Più indirizzi VIP per Azure Load Balancer</span><span class="sxs-lookup"><span data-stu-id="3f001-103">Multiple VIPs for Azure Load Balancer</span></span>

<span data-ttu-id="3f001-104">Bilanciamento del carico di Azure consente di bilanciare i servizi tooload su più porte, più indirizzi IP o entrambi.</span><span class="sxs-lookup"><span data-stu-id="3f001-104">Azure Load Balancer allows you tooload balance services on multiple ports, multiple IP addresses, or both.</span></span> <span data-ttu-id="3f001-105">È possibile utilizzare flussi bilanciamento di carico pubblici e interni del servizio di bilanciamento definizioni tooload in un set di macchine virtuali.</span><span class="sxs-lookup"><span data-stu-id="3f001-105">You can use public and internal load balancer definitions tooload balance flows across a set of VMs.</span></span>

<span data-ttu-id="3f001-106">Questo articolo descrive i principi fondamentali di hello di questa possibilità, i concetti importanti e vincoli.</span><span class="sxs-lookup"><span data-stu-id="3f001-106">This article describes hello fundamentals of this ability, important concepts, and constraints.</span></span> <span data-ttu-id="3f001-107">Se si intendono solo servizi tooexpose un indirizzo IP, è possibile trovare istruzioni semplificate per [pubblica](load-balancer-get-started-internet-portal.md) o [interno](load-balancer-get-started-ilb-arm-portal.md) caricare le configurazioni di bilanciamento del carico.</span><span class="sxs-lookup"><span data-stu-id="3f001-107">If you only intend tooexpose services on one IP address, you can find simplified instructions for [public](load-balancer-get-started-internet-portal.md) or [internal](load-balancer-get-started-ilb-arm-portal.md) load balancer configurations.</span></span> <span data-ttu-id="3f001-108">Aggiunta di più indirizzi VIP è una configurazione VIP singolo tooa incrementale.</span><span class="sxs-lookup"><span data-stu-id="3f001-108">Adding Multiple VIPs is incremental tooa single VIP configuration.</span></span> <span data-ttu-id="3f001-109">Usa concetti hello in questo articolo, è possibile espandere una configurazione semplificata in qualsiasi momento.</span><span class="sxs-lookup"><span data-stu-id="3f001-109">Using hello concepts in this article, you can expand a simplified configuration at any time.</span></span>

<span data-ttu-id="3f001-110">Quando si definisce un'istanza di Azure Load Balancer, vengono connessi un front-end e un back-end con regole.</span><span class="sxs-lookup"><span data-stu-id="3f001-110">When you define an Azure Load Balancer, a frontend and a backend configuration are connected with rules.</span></span> <span data-ttu-id="3f001-111">probe di integrità a cui fa riferimento la regola hello Hello è usato toodetermine di nuovi flussi inviati tooa nodo nel pool back-end hello.</span><span class="sxs-lookup"><span data-stu-id="3f001-111">hello health probe referenced by hello rule is used toodetermine how new flows are sent tooa node in hello backend pool.</span></span> <span data-ttu-id="3f001-112">front-end Hello è definito da un IP virtuale (VIP), che è una tupla con 3 elementi formata da un indirizzo IP (pubblico o interno), un protocollo di trasporto (UDP o TCP) e un numero di porta.</span><span class="sxs-lookup"><span data-stu-id="3f001-112">hello frontend is defined by a Virtual IP (VIP), which is a 3-tuple comprised of an IP address (public or internal), a transport protocol (UDP or TCP), and a port number.</span></span> <span data-ttu-id="3f001-113">Un DIP è che un indirizzo IP su una scheda di rete virtuale Azure associata tooa macchina virtuale in pool back-end hello.</span><span class="sxs-lookup"><span data-stu-id="3f001-113">A DIP is an IP address on an Azure virtual NIC attached tooa VM in hello backend pool.</span></span>

<span data-ttu-id="3f001-114">Hello nella tabella seguente contiene alcune configurazioni di server front-end di esempio:</span><span class="sxs-lookup"><span data-stu-id="3f001-114">hello following table contains some example frontend configurations:</span></span>

| <span data-ttu-id="3f001-115">Indirizzo VIP</span><span class="sxs-lookup"><span data-stu-id="3f001-115">VIP</span></span> | <span data-ttu-id="3f001-116">Indirizzo IP</span><span class="sxs-lookup"><span data-stu-id="3f001-116">IP address</span></span> | <span data-ttu-id="3f001-117">protocol</span><span class="sxs-lookup"><span data-stu-id="3f001-117">protocol</span></span> | <span data-ttu-id="3f001-118">port</span><span class="sxs-lookup"><span data-stu-id="3f001-118">port</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="3f001-119">1</span><span class="sxs-lookup"><span data-stu-id="3f001-119">1</span></span> |<span data-ttu-id="3f001-120">65.52.0.1</span><span class="sxs-lookup"><span data-stu-id="3f001-120">65.52.0.1</span></span> |<span data-ttu-id="3f001-121">TCP</span><span class="sxs-lookup"><span data-stu-id="3f001-121">TCP</span></span> |<span data-ttu-id="3f001-122">80</span><span class="sxs-lookup"><span data-stu-id="3f001-122">80</span></span> |
| <span data-ttu-id="3f001-123">2</span><span class="sxs-lookup"><span data-stu-id="3f001-123">2</span></span> |<span data-ttu-id="3f001-124">65.52.0.1</span><span class="sxs-lookup"><span data-stu-id="3f001-124">65.52.0.1</span></span> |<span data-ttu-id="3f001-125">TCP</span><span class="sxs-lookup"><span data-stu-id="3f001-125">TCP</span></span> |<span data-ttu-id="3f001-126">*8080*</span><span class="sxs-lookup"><span data-stu-id="3f001-126">*8080*</span></span> |
| <span data-ttu-id="3f001-127">3</span><span class="sxs-lookup"><span data-stu-id="3f001-127">3</span></span> |<span data-ttu-id="3f001-128">65.52.0.1</span><span class="sxs-lookup"><span data-stu-id="3f001-128">65.52.0.1</span></span> |<span data-ttu-id="3f001-129">*UDP*</span><span class="sxs-lookup"><span data-stu-id="3f001-129">*UDP*</span></span> |<span data-ttu-id="3f001-130">80</span><span class="sxs-lookup"><span data-stu-id="3f001-130">80</span></span> |
| <span data-ttu-id="3f001-131">4</span><span class="sxs-lookup"><span data-stu-id="3f001-131">4</span></span> |<span data-ttu-id="3f001-132">*65.52.0.2*</span><span class="sxs-lookup"><span data-stu-id="3f001-132">*65.52.0.2*</span></span> |<span data-ttu-id="3f001-133">TCP</span><span class="sxs-lookup"><span data-stu-id="3f001-133">TCP</span></span> |<span data-ttu-id="3f001-134">80</span><span class="sxs-lookup"><span data-stu-id="3f001-134">80</span></span> |

<span data-ttu-id="3f001-135">tabella Hello Mostra quattro server di front-end diversi.</span><span class="sxs-lookup"><span data-stu-id="3f001-135">hello table shows four different frontends.</span></span> <span data-ttu-id="3f001-136">I front-end 1, 2 e 3 rappresentano un unico indirizzo VIP con più regole.</span><span class="sxs-lookup"><span data-stu-id="3f001-136">Frontends #1, #2 and #3 are a single VIP with multiple rules.</span></span> <span data-ttu-id="3f001-137">Hello stesso indirizzo IP viene utilizzato anche hello porta o protocollo diverso per ogni server front-end.</span><span class="sxs-lookup"><span data-stu-id="3f001-137">hello same IP address is used but hello port or protocol is different for each frontend.</span></span> <span data-ttu-id="3f001-138">Server front-end n. 1 e &#4; sono un esempio di più indirizzi VIP, in cui hello stesso protocollo front-end e la porta vengono riutilizzati in più indirizzi VIP.</span><span class="sxs-lookup"><span data-stu-id="3f001-138">Frontends #1 and #4 are an example of Multiple VIPs, where hello same frontend protocol and port are reused across multiple VIPs.</span></span>

<span data-ttu-id="3f001-139">Bilanciamento del carico di Azure fornisce flessibilità nella definizione di regole di bilanciamento del carico di hello.</span><span class="sxs-lookup"><span data-stu-id="3f001-139">Azure Load Balancer provides flexibility in defining hello load balancing rules.</span></span> <span data-ttu-id="3f001-140">Una regola dichiara come un indirizzo e porta del server front-end hello toohello mappato l'indirizzo di destinazione e la porta sul back-end hello.</span><span class="sxs-lookup"><span data-stu-id="3f001-140">A rule declares how an address and port on hello frontend is mapped toohello destination address and port on hello backend.</span></span> <span data-ttu-id="3f001-141">Se le porte di back-end vengono riutilizzate attraverso le regole dipende dal tipo di hello della regola hello.</span><span class="sxs-lookup"><span data-stu-id="3f001-141">Whether or not backend ports are reused across rules depends on hello type of hello rule.</span></span> <span data-ttu-id="3f001-142">Ogni tipo di regola presenta requisiti specifici che possono influire sulla configurazione degli host e la progettazione dei probe.</span><span class="sxs-lookup"><span data-stu-id="3f001-142">Each type of rule has specific requirements that can affect host configuration and probe design.</span></span> <span data-ttu-id="3f001-143">Esistono due tipi di regole:</span><span class="sxs-lookup"><span data-stu-id="3f001-143">There are two types of rules:</span></span>

1. <span data-ttu-id="3f001-144">riutilizzare regola predefinita Hello con nessuna porta back-end</span><span class="sxs-lookup"><span data-stu-id="3f001-144">hello default rule with no backend port reuse</span></span>
2. <span data-ttu-id="3f001-145">regola di IP mobile Hello in cui vengono riutilizzate porte back-end</span><span class="sxs-lookup"><span data-stu-id="3f001-145">hello Floating IP rule where backend ports are reused</span></span>

<span data-ttu-id="3f001-146">Bilanciamento del carico di Azure consente toomix entrambi i tipi di regola su hello stessa configurazione di bilanciamento del carico.</span><span class="sxs-lookup"><span data-stu-id="3f001-146">Azure Load Balancer allows you toomix both rule types on hello same load balancer configuration.</span></span> <span data-ttu-id="3f001-147">bilanciamento del carico Hello poterle usare contemporaneamente per una macchina virtuale specificata o qualsiasi combinazione, purché si attengano ai vincoli di hello della regola hello.</span><span class="sxs-lookup"><span data-stu-id="3f001-147">hello load balancer can use them simultaneously for a given VM, or any combination, as long as you abide by hello constraints of hello rule.</span></span> <span data-ttu-id="3f001-148">Quale tipo di regola scelto dipende dai requisiti di hello l'applicazione e hello nella complessità di supportare tale configurazione.</span><span class="sxs-lookup"><span data-stu-id="3f001-148">Which rule type you choose depends on hello requirements of your application and hello complexity of supporting that configuration.</span></span> <span data-ttu-id="3f001-149">È necessario valutare quali tipi di regole siano più adatti allo scenario.</span><span class="sxs-lookup"><span data-stu-id="3f001-149">You should evaluate which rule types are best for your scenario.</span></span>

<span data-ttu-id="3f001-150">Vengono illustrati questi scenari ulteriormente a partire dal comportamento predefinito di hello.</span><span class="sxs-lookup"><span data-stu-id="3f001-150">We explore these scenarios further by starting with hello default behavior.</span></span>

## <a name="rule-type-1-no-backend-port-reuse"></a><span data-ttu-id="3f001-151">Regola di tipo 1: nessun riutilizzo delle porte back-end</span><span class="sxs-lookup"><span data-stu-id="3f001-151">Rule type #1: No backend port reuse</span></span>

![Illustrazione di più indirizzi VIP](./media/load-balancer-multivip-overview/load-balancer-multivip.png)

<span data-ttu-id="3f001-153">In questo scenario, front-end hello VIP sono configurate come indicato di seguito:</span><span class="sxs-lookup"><span data-stu-id="3f001-153">In this scenario, hello frontend VIPs are configured as follows:</span></span>

| <span data-ttu-id="3f001-154">Indirizzo VIP</span><span class="sxs-lookup"><span data-stu-id="3f001-154">VIP</span></span> | <span data-ttu-id="3f001-155">Indirizzo IP</span><span class="sxs-lookup"><span data-stu-id="3f001-155">IP address</span></span> | <span data-ttu-id="3f001-156">protocol</span><span class="sxs-lookup"><span data-stu-id="3f001-156">protocol</span></span> | <span data-ttu-id="3f001-157">port</span><span class="sxs-lookup"><span data-stu-id="3f001-157">port</span></span> |
| --- | --- | --- | --- |
| ![Indirizzo VIP](./media/load-balancer-multivip-overview/load-balancer-rule-green.png) <span data-ttu-id="3f001-159">1</span><span class="sxs-lookup"><span data-stu-id="3f001-159">1</span></span> |<span data-ttu-id="3f001-160">65.52.0.1</span><span class="sxs-lookup"><span data-stu-id="3f001-160">65.52.0.1</span></span> |<span data-ttu-id="3f001-161">TCP</span><span class="sxs-lookup"><span data-stu-id="3f001-161">TCP</span></span> |<span data-ttu-id="3f001-162">80</span><span class="sxs-lookup"><span data-stu-id="3f001-162">80</span></span> |
| ![Indirizzo VIP](./media/load-balancer-multivip-overview/load-balancer-rule-purple.png) <span data-ttu-id="3f001-164">2</span><span class="sxs-lookup"><span data-stu-id="3f001-164">2</span></span> |<span data-ttu-id="3f001-165">*65.52.0.2*</span><span class="sxs-lookup"><span data-stu-id="3f001-165">*65.52.0.2*</span></span> |<span data-ttu-id="3f001-166">TCP</span><span class="sxs-lookup"><span data-stu-id="3f001-166">TCP</span></span> |<span data-ttu-id="3f001-167">80</span><span class="sxs-lookup"><span data-stu-id="3f001-167">80</span></span> |

<span data-ttu-id="3f001-168">Hello DIP è destinazione hello hello in ingresso del flusso.</span><span class="sxs-lookup"><span data-stu-id="3f001-168">hello DIP is hello destination of hello inbound flow.</span></span> <span data-ttu-id="3f001-169">Nel pool back-end hello, ogni macchina virtuale espone servizio hello desiderata su una porta univoca in un DIP.</span><span class="sxs-lookup"><span data-stu-id="3f001-169">In hello backend pool, each VM exposes hello desired service on a unique port on a DIP.</span></span> <span data-ttu-id="3f001-170">Questo servizio è associato a hello server front-end tramite una definizione della regola.</span><span class="sxs-lookup"><span data-stu-id="3f001-170">This service is associated with hello frontend through a rule definition.</span></span>

<span data-ttu-id="3f001-171">Si definiscono due regole:</span><span class="sxs-lookup"><span data-stu-id="3f001-171">We define two rules:</span></span>

| <span data-ttu-id="3f001-172">Regola</span><span class="sxs-lookup"><span data-stu-id="3f001-172">Rule</span></span> | <span data-ttu-id="3f001-173">Mapping frontend</span><span class="sxs-lookup"><span data-stu-id="3f001-173">Map frontend</span></span> | <span data-ttu-id="3f001-174">pool toobackend</span><span class="sxs-lookup"><span data-stu-id="3f001-174">toobackend pool</span></span> |
| --- | --- | --- |
| <span data-ttu-id="3f001-175">1</span><span class="sxs-lookup"><span data-stu-id="3f001-175">1</span></span> |![Indirizzo VIP](./media/load-balancer-multivip-overview/load-balancer-rule-green.png) <span data-ttu-id="3f001-177">VIP1:80</span><span class="sxs-lookup"><span data-stu-id="3f001-177">VIP1:80</span></span> |![back-end](./media/load-balancer-multivip-overview/load-balancer-rule-green.png) <span data-ttu-id="3f001-179">DIP1:80,</span><span class="sxs-lookup"><span data-stu-id="3f001-179">DIP1:80,</span></span> ![back-end](./media/load-balancer-multivip-overview/load-balancer-rule-green.png) <span data-ttu-id="3f001-181">DIP2:80</span><span class="sxs-lookup"><span data-stu-id="3f001-181">DIP2:80</span></span> |
| <span data-ttu-id="3f001-182">2</span><span class="sxs-lookup"><span data-stu-id="3f001-182">2</span></span> |![Indirizzo VIP](./media/load-balancer-multivip-overview/load-balancer-rule-purple.png) <span data-ttu-id="3f001-184">VIP2:80</span><span class="sxs-lookup"><span data-stu-id="3f001-184">VIP2:80</span></span> |![back-end](./media/load-balancer-multivip-overview/load-balancer-rule-purple.png) <span data-ttu-id="3f001-186">DIP1:81,</span><span class="sxs-lookup"><span data-stu-id="3f001-186">DIP1:81,</span></span> ![back-end](./media/load-balancer-multivip-overview/load-balancer-rule-purple.png) <span data-ttu-id="3f001-188">DIP2:81</span><span class="sxs-lookup"><span data-stu-id="3f001-188">DIP2:81</span></span> |

<span data-ttu-id="3f001-189">mapping di completo Hello nel bilanciamento del carico di Azure è ora il seguente:</span><span class="sxs-lookup"><span data-stu-id="3f001-189">hello complete mapping in Azure Load Balancer is now as follows:</span></span>

| <span data-ttu-id="3f001-190">Regola</span><span class="sxs-lookup"><span data-stu-id="3f001-190">Rule</span></span> | <span data-ttu-id="3f001-191">Indirizzo IP VIP</span><span class="sxs-lookup"><span data-stu-id="3f001-191">VIP IP address</span></span> | <span data-ttu-id="3f001-192">protocol</span><span class="sxs-lookup"><span data-stu-id="3f001-192">protocol</span></span> | <span data-ttu-id="3f001-193">port</span><span class="sxs-lookup"><span data-stu-id="3f001-193">port</span></span> | <span data-ttu-id="3f001-194">Destination</span><span class="sxs-lookup"><span data-stu-id="3f001-194">Destination</span></span> | <span data-ttu-id="3f001-195">port</span><span class="sxs-lookup"><span data-stu-id="3f001-195">port</span></span> |
| --- | --- | --- | --- | --- | --- |
| ![Regola](./media/load-balancer-multivip-overview/load-balancer-rule-green.png) <span data-ttu-id="3f001-197">1</span><span class="sxs-lookup"><span data-stu-id="3f001-197">1</span></span> |<span data-ttu-id="3f001-198">65.52.0.1</span><span class="sxs-lookup"><span data-stu-id="3f001-198">65.52.0.1</span></span> |<span data-ttu-id="3f001-199">TCP</span><span class="sxs-lookup"><span data-stu-id="3f001-199">TCP</span></span> |<span data-ttu-id="3f001-200">80</span><span class="sxs-lookup"><span data-stu-id="3f001-200">80</span></span> |<span data-ttu-id="3f001-201">Indirizzo IP DIP</span><span class="sxs-lookup"><span data-stu-id="3f001-201">DIP IP Address</span></span> |<span data-ttu-id="3f001-202">80</span><span class="sxs-lookup"><span data-stu-id="3f001-202">80</span></span> |
| ![Regola](./media/load-balancer-multivip-overview/load-balancer-rule-purple.png) <span data-ttu-id="3f001-204">2</span><span class="sxs-lookup"><span data-stu-id="3f001-204">2</span></span> |<span data-ttu-id="3f001-205">65.52.0.2</span><span class="sxs-lookup"><span data-stu-id="3f001-205">65.52.0.2</span></span> |<span data-ttu-id="3f001-206">TCP</span><span class="sxs-lookup"><span data-stu-id="3f001-206">TCP</span></span> |<span data-ttu-id="3f001-207">80</span><span class="sxs-lookup"><span data-stu-id="3f001-207">80</span></span> |<span data-ttu-id="3f001-208">Indirizzo IP DIP</span><span class="sxs-lookup"><span data-stu-id="3f001-208">DIP IP Address</span></span> |<span data-ttu-id="3f001-209">81</span><span class="sxs-lookup"><span data-stu-id="3f001-209">81</span></span> |

<span data-ttu-id="3f001-210">Ogni regola deve produrre un flusso con una combinazione univoca di indirizzo IP di destinazione e porta di destinazione.</span><span class="sxs-lookup"><span data-stu-id="3f001-210">Each rule must produce a flow with a unique combination of destination IP address and destination port.</span></span> <span data-ttu-id="3f001-211">Dalla porta di destinazione hello variabili del flusso di hello, più regole possono recapitare i flussi toohello DIP stesso su porte diverse.</span><span class="sxs-lookup"><span data-stu-id="3f001-211">By varying hello destination port of hello flow, multiple rules can deliver flows toohello same DIP on different ports.</span></span>

<span data-ttu-id="3f001-212">Probe di integrità sono sempre toohello diretto DIP di una macchina virtuale.</span><span class="sxs-lookup"><span data-stu-id="3f001-212">Health probes are always directed toohello DIP of a VM.</span></span> <span data-ttu-id="3f001-213">È necessario che il probe riflette integrità hello di hello macchina virtuale.</span><span class="sxs-lookup"><span data-stu-id="3f001-213">You must ensure you that your probe reflects hello health of hello VM.</span></span>

## <a name="rule-type-2-backend-port-reuse-by-using-floating-ip"></a><span data-ttu-id="3f001-214">Regola di tipo 2: riutilizzo delle porte back-end tramite indirizzo IP mobile</span><span class="sxs-lookup"><span data-stu-id="3f001-214">Rule type #2: backend port reuse by using Floating IP</span></span>

<span data-ttu-id="3f001-215">Il bilanciamento del carico Azure flessibilità hello porta front-end di tooreuse hello in più indirizzi VIP indipendentemente dal tipo di regola hello utilizzato.</span><span class="sxs-lookup"><span data-stu-id="3f001-215">Azure Load Balancer provides hello flexibility tooreuse hello frontend port across multiple VIPs regardless of hello rule type used.</span></span> <span data-ttu-id="3f001-216">Inoltre, alcuni scenari di applicazione preferiscano o richiedono hello stessa porta utilizzata da più istanze dell'applicazione in una singola macchina virtuale nel pool back-end hello toobe.</span><span class="sxs-lookup"><span data-stu-id="3f001-216">Additionally, some application scenarios prefer or require hello same port toobe used by multiple application instances on a single VM in hello backend pool.</span></span> <span data-ttu-id="3f001-217">Esempi comuni di riutilizzo delle porte includono il clustering per la disponibilità elevata, le appliance virtuali di rete e l'esposizione di più endpoint TLS senza rieseguire la crittografia di rete.</span><span class="sxs-lookup"><span data-stu-id="3f001-217">Common examples of port reuse include clustering for high availability, network virtual appliances, and exposing multiple TLS endpoints without re-encryption.</span></span>

<span data-ttu-id="3f001-218">Se si desidera porta back-end di hello tooreuse tra più regole, è necessario abilitare l'indirizzo IP mobile nella definizione della regola hello.</span><span class="sxs-lookup"><span data-stu-id="3f001-218">If you want tooreuse hello backend port across multiple rules, you must enable Floating IP in hello rule definition.</span></span>

<span data-ttu-id="3f001-219">L'indirizzo IP mobile è una parte di ciò che è noto come Direct Server Return (DSR).</span><span class="sxs-lookup"><span data-stu-id="3f001-219">Floating IP is a portion of what is known as Direct Server Return (DSR).</span></span> <span data-ttu-id="3f001-220">Il DSR è costituito da due parti: una topologia di flussi e uno schema di mappatura degli indirizzi IP.</span><span class="sxs-lookup"><span data-stu-id="3f001-220">DSR consists of two parts: a flow topology and an IP address mapping scheme.</span></span> <span data-ttu-id="3f001-221">A livello di piattaforma, Azure Load Balancer viene sempre eseguito in una topologia di flussi DSR indipendentemente dal fatto che l'indirizzo IP mobile sia abilitato o meno.</span><span class="sxs-lookup"><span data-stu-id="3f001-221">At a platform level, Azure Load Balancer always operates in a DSR flow topology regardless of whether Floating IP is enabled or not.</span></span> <span data-ttu-id="3f001-222">Ciò significa che parte in uscita di hello di un flusso è sempre origine toohello direttamente indietro tooflow riscritto in modo corretto.</span><span class="sxs-lookup"><span data-stu-id="3f001-222">This means that hello outbound part of a flow is always correctly rewritten tooflow directly back toohello origin.</span></span>

<span data-ttu-id="3f001-223">Con tipo di regola predefinita hello Azure espone schema di mapping di indirizzi IP per facilitare l'utilizzo di bilanciamento del carico tradizionale.</span><span class="sxs-lookup"><span data-stu-id="3f001-223">With hello default rule type, Azure exposes a traditional load balancing IP address mapping scheme for ease of use.</span></span> <span data-ttu-id="3f001-224">L'abilitazione di IP mobile modifica tooallow lo schema di mapping di indirizzi IP hello per una maggiore flessibilità, come illustrato di seguito.</span><span class="sxs-lookup"><span data-stu-id="3f001-224">Enabling Floating IP changes hello IP address mapping scheme tooallow for additional flexibility as explained below.</span></span>

<span data-ttu-id="3f001-225">Hello seguente diagramma viene illustrata questa configurazione:</span><span class="sxs-lookup"><span data-stu-id="3f001-225">hello following diagram illustrates this configuration:</span></span>

![Illustrazione di più indirizzi VIP](./media/load-balancer-multivip-overview/load-balancer-multivip-dsr.png)

<span data-ttu-id="3f001-227">Per questo scenario, ogni macchina virtuale nel pool back-end hello dispone di tre interfacce di rete:</span><span class="sxs-lookup"><span data-stu-id="3f001-227">For this scenario, every VM in hello backend pool has three network interfaces:</span></span>

* <span data-ttu-id="3f001-228">DIP: una NIC virtuale associata a hello macchina virtuale (configurazione IP della risorsa di rete di Azure)</span><span class="sxs-lookup"><span data-stu-id="3f001-228">DIP: a Virtual NIC associated with hello VM (IP configuration of Azure's NIC resource)</span></span>
* <span data-ttu-id="3f001-229">VIP1: un'interfaccia di loopback all'interno del sistema operativo guest configurato con l'indirizzo IP di VIP1</span><span class="sxs-lookup"><span data-stu-id="3f001-229">VIP1: a loopback interface within guest OS that is configured with IP address of VIP1</span></span>
* <span data-ttu-id="3f001-230">VIP2: un'interfaccia di loopback all'interno del sistema operativo guest configurato con l'indirizzo IP di VIP2</span><span class="sxs-lookup"><span data-stu-id="3f001-230">VIP2: a loopback interface within guest OS that is configured with IP address of VIP2</span></span>

> [!IMPORTANT]
> <span data-ttu-id="3f001-231">configurazione di Hello di interfacce logiche hello viene eseguita all'interno del sistema operativo guest hello.</span><span class="sxs-lookup"><span data-stu-id="3f001-231">hello configuration of hello logical interfaces is performed within hello guest OS.</span></span> <span data-ttu-id="3f001-232">Questa configurazione non viene eseguita o gestita da Azure.</span><span class="sxs-lookup"><span data-stu-id="3f001-232">This configuration is not performed or managed by Azure.</span></span> <span data-ttu-id="3f001-233">Senza questa configurazione, le regole di hello non funzionerà.</span><span class="sxs-lookup"><span data-stu-id="3f001-233">Without this configuration, hello rules will not function.</span></span> <span data-ttu-id="3f001-234">Le definizioni dei probe di integrità usano hello DIP di hello VM anziché di hello VIP logico.</span><span class="sxs-lookup"><span data-stu-id="3f001-234">Health probe definitions use hello DIP of hello VM rather than hello logical VIP.</span></span> <span data-ttu-id="3f001-235">Pertanto, il servizio deve fornire le risposte di probe su una porta DIP che riflettono lo stato di hello del servizio hello disponibile in hello logico VIP.</span><span class="sxs-lookup"><span data-stu-id="3f001-235">Therefore, your service must provide probe responses on a DIP port that reflect hello status of hello service offered on hello logical VIP.</span></span>

<span data-ttu-id="3f001-236">Si supponga ad esempio hello stessa configurazione front-end come nello scenario precedente hello:</span><span class="sxs-lookup"><span data-stu-id="3f001-236">Let's assume hello same frontend configuration as in hello previous scenario:</span></span>

| <span data-ttu-id="3f001-237">Indirizzo VIP</span><span class="sxs-lookup"><span data-stu-id="3f001-237">VIP</span></span> | <span data-ttu-id="3f001-238">Indirizzo IP</span><span class="sxs-lookup"><span data-stu-id="3f001-238">IP address</span></span> | <span data-ttu-id="3f001-239">protocol</span><span class="sxs-lookup"><span data-stu-id="3f001-239">protocol</span></span> | <span data-ttu-id="3f001-240">port</span><span class="sxs-lookup"><span data-stu-id="3f001-240">port</span></span> |
| --- | --- | --- | --- |
| ![Indirizzo VIP](./media/load-balancer-multivip-overview/load-balancer-rule-green.png) <span data-ttu-id="3f001-242">1</span><span class="sxs-lookup"><span data-stu-id="3f001-242">1</span></span> |<span data-ttu-id="3f001-243">65.52.0.1</span><span class="sxs-lookup"><span data-stu-id="3f001-243">65.52.0.1</span></span> |<span data-ttu-id="3f001-244">TCP</span><span class="sxs-lookup"><span data-stu-id="3f001-244">TCP</span></span> |<span data-ttu-id="3f001-245">80</span><span class="sxs-lookup"><span data-stu-id="3f001-245">80</span></span> |
| ![Indirizzo VIP](./media/load-balancer-multivip-overview/load-balancer-rule-purple.png) <span data-ttu-id="3f001-247">2</span><span class="sxs-lookup"><span data-stu-id="3f001-247">2</span></span> |<span data-ttu-id="3f001-248">*65.52.0.2*</span><span class="sxs-lookup"><span data-stu-id="3f001-248">*65.52.0.2*</span></span> |<span data-ttu-id="3f001-249">TCP</span><span class="sxs-lookup"><span data-stu-id="3f001-249">TCP</span></span> |<span data-ttu-id="3f001-250">80</span><span class="sxs-lookup"><span data-stu-id="3f001-250">80</span></span> |

<span data-ttu-id="3f001-251">Si definiscono due regole:</span><span class="sxs-lookup"><span data-stu-id="3f001-251">We define two rules:</span></span>

| <span data-ttu-id="3f001-252">Regola</span><span class="sxs-lookup"><span data-stu-id="3f001-252">Rule</span></span> | <span data-ttu-id="3f001-253">Mapping frontend</span><span class="sxs-lookup"><span data-stu-id="3f001-253">Map frontend</span></span> | <span data-ttu-id="3f001-254">pool toobackend</span><span class="sxs-lookup"><span data-stu-id="3f001-254">toobackend pool</span></span> |
| --- | --- | --- |
| <span data-ttu-id="3f001-255">1</span><span class="sxs-lookup"><span data-stu-id="3f001-255">1</span></span> |![Regola](./media/load-balancer-multivip-overview/load-balancer-rule-green.png) <span data-ttu-id="3f001-257">VIP1:80</span><span class="sxs-lookup"><span data-stu-id="3f001-257">VIP1:80</span></span> |![back-end](./media/load-balancer-multivip-overview/load-balancer-rule-green.png) <span data-ttu-id="3f001-259">VIP1:80 (in VM1 e VM2)</span><span class="sxs-lookup"><span data-stu-id="3f001-259">VIP1:80 (in VM1 and VM2)</span></span> |
| <span data-ttu-id="3f001-260">2</span><span class="sxs-lookup"><span data-stu-id="3f001-260">2</span></span> |![Regola](./media/load-balancer-multivip-overview/load-balancer-rule-purple.png) <span data-ttu-id="3f001-262">VIP2:80</span><span class="sxs-lookup"><span data-stu-id="3f001-262">VIP2:80</span></span> |![back-end](./media/load-balancer-multivip-overview/load-balancer-rule-purple.png) <span data-ttu-id="3f001-264">VIP2:80 (in VM1 e VM2)</span><span class="sxs-lookup"><span data-stu-id="3f001-264">VIP2:80 (in VM1 and VM2)</span></span> |

<span data-ttu-id="3f001-265">Hello nella tabella seguente mostra il mapping completo hello nel servizio di bilanciamento del carico hello:</span><span class="sxs-lookup"><span data-stu-id="3f001-265">hello following table shows hello complete mapping in hello load balancer:</span></span>

| <span data-ttu-id="3f001-266">Regola</span><span class="sxs-lookup"><span data-stu-id="3f001-266">Rule</span></span> | <span data-ttu-id="3f001-267">Indirizzo IP VIP</span><span class="sxs-lookup"><span data-stu-id="3f001-267">VIP IP address</span></span> | <span data-ttu-id="3f001-268">protocol</span><span class="sxs-lookup"><span data-stu-id="3f001-268">protocol</span></span> | <span data-ttu-id="3f001-269">port</span><span class="sxs-lookup"><span data-stu-id="3f001-269">port</span></span> | <span data-ttu-id="3f001-270">Destination</span><span class="sxs-lookup"><span data-stu-id="3f001-270">Destination</span></span> | <span data-ttu-id="3f001-271">port</span><span class="sxs-lookup"><span data-stu-id="3f001-271">port</span></span> |
| --- | --- | --- | --- | --- | --- |
| ![Indirizzo VIP](./media/load-balancer-multivip-overview/load-balancer-rule-green.png) <span data-ttu-id="3f001-273">1</span><span class="sxs-lookup"><span data-stu-id="3f001-273">1</span></span> |<span data-ttu-id="3f001-274">65.52.0.1</span><span class="sxs-lookup"><span data-stu-id="3f001-274">65.52.0.1</span></span> |<span data-ttu-id="3f001-275">TCP</span><span class="sxs-lookup"><span data-stu-id="3f001-275">TCP</span></span> |<span data-ttu-id="3f001-276">80</span><span class="sxs-lookup"><span data-stu-id="3f001-276">80</span></span> |<span data-ttu-id="3f001-277">come indirizzo VIP (65.52.0.1)</span><span class="sxs-lookup"><span data-stu-id="3f001-277">same as VIP (65.52.0.1)</span></span> |<span data-ttu-id="3f001-278">come indirizzo VIP (80)</span><span class="sxs-lookup"><span data-stu-id="3f001-278">same as VIP (80)</span></span> |
| ![Indirizzo VIP](./media/load-balancer-multivip-overview/load-balancer-rule-purple.png) <span data-ttu-id="3f001-280">2</span><span class="sxs-lookup"><span data-stu-id="3f001-280">2</span></span> |<span data-ttu-id="3f001-281">65.52.0.2</span><span class="sxs-lookup"><span data-stu-id="3f001-281">65.52.0.2</span></span> |<span data-ttu-id="3f001-282">TCP</span><span class="sxs-lookup"><span data-stu-id="3f001-282">TCP</span></span> |<span data-ttu-id="3f001-283">80</span><span class="sxs-lookup"><span data-stu-id="3f001-283">80</span></span> |<span data-ttu-id="3f001-284">come indirizzo VIP (65.52.0.2)</span><span class="sxs-lookup"><span data-stu-id="3f001-284">same as VIP (65.52.0.2)</span></span> |<span data-ttu-id="3f001-285">come indirizzo VIP (80)</span><span class="sxs-lookup"><span data-stu-id="3f001-285">same as VIP (80)</span></span> |

<span data-ttu-id="3f001-286">destinazione Hello di hello flusso in ingresso è l'indirizzo VIP hello sull'interfaccia di loopback hello in hello VM.</span><span class="sxs-lookup"><span data-stu-id="3f001-286">hello destination of hello inbound flow is hello VIP address on hello loopback interface in hello VM.</span></span> <span data-ttu-id="3f001-287">Ogni regola deve produrre un flusso con una combinazione univoca di indirizzo IP di destinazione e porta di destinazione.</span><span class="sxs-lookup"><span data-stu-id="3f001-287">Each rule must produce a flow with a unique combination of destination IP address and destination port.</span></span> <span data-ttu-id="3f001-288">Da vari hello indirizzo IP di destinazione del flusso di hello, è possibile sul riutilizzo delle porte hello stessa macchina virtuale.</span><span class="sxs-lookup"><span data-stu-id="3f001-288">By varying hello destination IP address of hello flow, port reuse is possible on hello same VM.</span></span> <span data-ttu-id="3f001-289">Il servizio è servizio di bilanciamento del carico toohello esposto mediante l'associazione dell'indirizzo VIP toohello indirizzo IP e porta dell'interfaccia di loopback rispettivi hello.</span><span class="sxs-lookup"><span data-stu-id="3f001-289">Your service is exposed toohello load balancer by binding it toohello VIP’s IP address and port of hello respective loopback interface.</span></span>

<span data-ttu-id="3f001-290">Si noti che in questo esempio non modifica la porta di destinazione hello.</span><span class="sxs-lookup"><span data-stu-id="3f001-290">Notice that this example does not change hello destination port.</span></span> <span data-ttu-id="3f001-291">Anche se si tratta di uno scenario di IP mobile, bilanciamento del carico di Azure supporta anche la definizione di una porta di destinazione regola toorewrite hello back-end e toomake è diversa dalla porta di destinazione hello front-end.</span><span class="sxs-lookup"><span data-stu-id="3f001-291">Even though this is a Floating IP scenario, Azure Load Balancer also supports defining a rule toorewrite hello backend destination port and toomake it different from hello frontend destination port.</span></span>

<span data-ttu-id="3f001-292">il tipo di regola di IP mobile Hello è foundation hello più modelli di configurazione del servizio di bilanciamento di carico.</span><span class="sxs-lookup"><span data-stu-id="3f001-292">hello Floating IP rule type is hello foundation of several load balancer configuration patterns.</span></span> <span data-ttu-id="3f001-293">Un esempio che è attualmente disponibile è hello [AlwaysOn SQL con più listener](../virtual-machines/windows/sql/virtual-machines-windows-portal-sql-ps-alwayson-int-listener.md) configurazione.</span><span class="sxs-lookup"><span data-stu-id="3f001-293">One example that is currently available is hello [SQL AlwaysOn with Multiple Listeners](../virtual-machines/windows/sql/virtual-machines-windows-portal-sql-ps-alwayson-int-listener.md) configuration.</span></span> <span data-ttu-id="3f001-294">Altri scenari di questo tipo verranno documentati nel tempo.</span><span class="sxs-lookup"><span data-stu-id="3f001-294">Over time, we will document more of these scenarios.</span></span>

## <a name="limitations"></a><span data-ttu-id="3f001-295">Limitazioni</span><span class="sxs-lookup"><span data-stu-id="3f001-295">Limitations</span></span>

* <span data-ttu-id="3f001-296">Più configurazioni di indirizzi VIP sono supportate solo con le macchine virtuali IaaS.</span><span class="sxs-lookup"><span data-stu-id="3f001-296">Multiple VIP configurations are only supported with IaaS VMs.</span></span>
* <span data-ttu-id="3f001-297">Con una regola di IP mobile hello, l'applicazione deve usare hello DIP per i flussi in uscita.</span><span class="sxs-lookup"><span data-stu-id="3f001-297">With hello Floating IP rule, your application must use hello DIP for outbound flows.</span></span> <span data-ttu-id="3f001-298">Se l'applicazione associa indirizzo VIP toohello configurato sull'interfaccia di loopback hello nel sistema operativo guest hello, quindi SNAT non è disponibile toorewrite flusso in uscita di hello e flusso hello non riesce.</span><span class="sxs-lookup"><span data-stu-id="3f001-298">If your application binds toohello VIP address configured on hello loopback interface in hello guest OS, then SNAT is not available toorewrite hello outbound flow and hello flow fails.</span></span>
* <span data-ttu-id="3f001-299">Gli indirizzi IP pubblici hanno un effetto sulla fatturazione.</span><span class="sxs-lookup"><span data-stu-id="3f001-299">Public IP addresses have an effect on billing.</span></span> <span data-ttu-id="3f001-300">Per altre informazioni, vedere [Prezzi per gli indirizzi IP](https://azure.microsoft.com/pricing/details/ip-addresses/)</span><span class="sxs-lookup"><span data-stu-id="3f001-300">For more information, see [IP Address pricing](https://azure.microsoft.com/pricing/details/ip-addresses/)</span></span>
* <span data-ttu-id="3f001-301">Si applicano i limiti delle sottoscrizioni.</span><span class="sxs-lookup"><span data-stu-id="3f001-301">Subscription limits apply.</span></span> <span data-ttu-id="3f001-302">Per altre informazioni, vedere i [limiti del servizio](../azure-subscription-service-limits.md#networking-limits) .</span><span class="sxs-lookup"><span data-stu-id="3f001-302">For more information, see [Service limits](../azure-subscription-service-limits.md#networking-limits) for details.</span></span>
