---
title: Automation DSC la distribuzione continua con Chocolatey aaaAzure | Documenti Microsoft
description: Distribuzione continua in DevOps con Gestione pacchetti di Automation DSC per Azure e Chocolatey.  Esempio con modello ARM JSON completo e codice sorgente di PowerShell.
services: automation
documentationcenter: 
author: eslesar
manager: carmonm
editor: tysonn
ms.assetid: c0baa411-eb76-4f91-8d14-68f68b4805b6
ms.service: automation
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: vm-windows
ms.workload: na
ms.date: 10/29/2016
ms.author: golive
ms.openlocfilehash: 60af52af5f834fd48e3a0dc4677919397b53f0f4
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/06/2017
---
# <a name="usage-example-continuous-deployment-toovirtual-machines-using-automation-dsc-and-chocolatey"></a><span data-ttu-id="d4834-104">Esempio di utilizzo: La distribuzione continua tooVirtual macchine tramite DSC di automazione e Chocolatey</span><span class="sxs-lookup"><span data-stu-id="d4834-104">Usage Example: Continuous deployment tooVirtual Machines using Automation DSC and Chocolatey</span></span>
<span data-ttu-id="d4834-105">In un mondo DevOps sono disponibili molti strumenti tooassist con vari punti nella pipeline di integrazione continua hello.</span><span class="sxs-lookup"><span data-stu-id="d4834-105">In a DevOps world there are many tools tooassist with various points in hello Continuous Integration pipeline.</span></span>  <span data-ttu-id="d4834-106">Configurazione dello stato desiderato di automazione di Azure (DSC) è un nuovo aggiunta toohello le opzioni di installazione in grado di utilizzare i team DevOps.</span><span class="sxs-lookup"><span data-stu-id="d4834-106">Azure Automation Desired State Configuration (DSC) is a welcome new addition toohello options that DevOps teams can employ.</span></span>  <span data-ttu-id="d4834-107">Questo articolo illustra come configurare la distribuzione continua per un computer Windows.</span><span class="sxs-lookup"><span data-stu-id="d4834-107">This article demonstrates setting up Continuous Deployment (CD) for a Windows computer.</span></span>  <span data-ttu-id="d4834-108">È possibile estendere facilmente hello tecnica tooinclude tutti i computer Windows in base alle esigenze nel ruolo hello (ad esempio un sito web) e da tooadditional sono anche i ruoli.</span><span class="sxs-lookup"><span data-stu-id="d4834-108">You can easily extend hello technique tooinclude as many Windows computers as necessary in hello role (a web site, for example), and from there tooadditional roles as well.</span></span>

![Distribuzione continua con VM IaaS](./media/automation-dsc-cd-chocolatey/cdforiaasvm.png)

## <a name="at-a-high-level"></a><span data-ttu-id="d4834-110">A livello generale</span><span class="sxs-lookup"><span data-stu-id="d4834-110">At a high level</span></span>
<span data-ttu-id="d4834-111">Gli aspetti da considerare sono molteplici, ma possono comunque essere suddivisi in due processi principali:</span><span class="sxs-lookup"><span data-stu-id="d4834-111">There is quite a bit going on here, but fortunately it can be broken into two main processes:</span></span> 

* <span data-ttu-id="d4834-112">Scrittura di codice e test, creazione e pubblicazione di pacchetti di installazione per le versioni principale e secondaria del sistema hello.</span><span class="sxs-lookup"><span data-stu-id="d4834-112">Writing code and testing it, then creating and publishing installation packages for major and minor versions of hello system.</span></span> 
* <span data-ttu-id="d4834-113">Creazione e gestione di macchine virtuali che verranno installati e di eseguire codice hello in pacchetti hello.</span><span class="sxs-lookup"><span data-stu-id="d4834-113">Creating and managing VMs that will install and execute hello code in hello packages.</span></span>  

<span data-ttu-id="d4834-114">Quando entrambi i processi principali sono presenti, passaggio breve tooautomatically hello pacchetto di aggiornamento sia in esecuzione su qualsiasi determinata macchina virtuale come nuove versioni create e distribuite.</span><span class="sxs-lookup"><span data-stu-id="d4834-114">Once both of these core processes are in place, it’s a short step tooautomatically update hello package running on any particular VM as new versions are created and deployed.</span></span>

## <a name="component-overview"></a><span data-ttu-id="d4834-115">Panoramica dei componenti</span><span class="sxs-lookup"><span data-stu-id="d4834-115">Component overview</span></span>
<span data-ttu-id="d4834-116">Creare un pacchetto, ad esempio gestori di [apt get](https://en.wikipedia.org/wiki/Advanced_Packaging_Tool) sono molto ben noti in Linux HelloWorld, ma non tanto in ambito Windows hello.</span><span class="sxs-lookup"><span data-stu-id="d4834-116">Package managers such as [apt-get](https://en.wikipedia.org/wiki/Advanced_Packaging_Tool) are pretty well known in hello Linux world, but not so much in hello Windows world.</span></span>  <span data-ttu-id="d4834-117">[Chocolatey](https://chocolatey.org/) è tale aspetto e di Scott Hanselman [blog](http://www.hanselman.com/blog/IsTheWindowsUserReadyForAptget.aspx) su hello argomento è un'ottima introduzione.</span><span class="sxs-lookup"><span data-stu-id="d4834-117">[Chocolatey](https://chocolatey.org/) is such a thing, and Scott Hanselman’s [blog](http://www.hanselman.com/blog/IsTheWindowsUserReadyForAptget.aspx) on hello topic is a great intro.</span></span>  <span data-ttu-id="d4834-118">In breve, Chocolatey consente tooinstall pacchetti da un repository centrale dei pacchetti in un sistema di Windows tramite riga di comando hello.</span><span class="sxs-lookup"><span data-stu-id="d4834-118">In a nutshell, Chocolatey allows you tooinstall packages from a central repository of packages into a Windows system using hello command line.</span></span>  <span data-ttu-id="d4834-119">È possibile creare e gestire un repository personalizzato e Chocolatey può installare pacchetti da tutti i repository designati dall'utente.</span><span class="sxs-lookup"><span data-stu-id="d4834-119">You can create and manage your own repository, and Chocolatey can install packages from any number of repositories that you designate.</span></span>

<span data-ttu-id="d4834-120">Desired State Configuration (DSC) ([Panoramica](https://technet.microsoft.com/library/dn249912.aspx)) è uno strumento di PowerShell che consente una configurazione di hello toodeclare desiderata per una macchina.</span><span class="sxs-lookup"><span data-stu-id="d4834-120">Desired State Configuration (DSC) ([overview](https://technet.microsoft.com/library/dn249912.aspx)) is a PowerShell tool that allows you toodeclare hello configuration that you want for a machine.</span></span>  <span data-ttu-id="d4834-121">Si può ad esempio dichiarare di voler installare Chocolatey o IIS, di voler aprire la porta 80 e di voler installare la versione 1.0.0 del proprio sito Web.</span><span class="sxs-lookup"><span data-stu-id="d4834-121">For example, you can say, “I want Chocolatey installed, I want IIS installed, I want port 80 opened, I want version 1.0.0 of my website installed.”</span></span>  <span data-ttu-id="d4834-122">Hello DSC Gestione configurazione locale (LCM) implementa la configurazione.</span><span class="sxs-lookup"><span data-stu-id="d4834-122">hello DSC Local Configuration Manager (LCM) implements that configuration.</span></span> <span data-ttu-id="d4834-123">Un server di pull DSC mantiene un repository di configurazioni per i computer dell'utente.</span><span class="sxs-lookup"><span data-stu-id="d4834-123">A DSC Pull Server holds a repository of configurations for your machines.</span></span> <span data-ttu-id="d4834-124">Hello Gestione configurazione locale in ogni computer archivia toosee periodicamente se la configurazione corrisponde la configurazione archiviata hello.</span><span class="sxs-lookup"><span data-stu-id="d4834-124">hello LCM on each machine checks in periodically toosee if its configuration matches hello stored configuration.</span></span> <span data-ttu-id="d4834-125">Può segnalare lo stato o tentare macchina hello toobring in allineamento con la configurazione archiviata hello.</span><span class="sxs-lookup"><span data-stu-id="d4834-125">It can either report status or attempt toobring hello machine back into alignment with hello stored configuration.</span></span> <span data-ttu-id="d4834-126">È possibile modificare hello configurazione archiviata nel hello pull server toocause un computer o un set di macchine toocome in allineamento con configurazione hello modificato.</span><span class="sxs-lookup"><span data-stu-id="d4834-126">You can edit hello stored configuration on hello pull server toocause a machine or set of machines toocome into alignment with hello changed configuration.</span></span>

<span data-ttu-id="d4834-127">Automazione di Azure è un servizio gestito in Microsoft Azure che consente di tooautomate varie attività con i runbook, i nodi, le credenziali, risorse e risorse, ad esempio le pianificazioni e le variabili globali.</span><span class="sxs-lookup"><span data-stu-id="d4834-127">Azure Automation is a managed service in Microsoft Azure that allows you tooautomate various tasks using runbooks, nodes, credentials, resources and assets such as schedules and global variables.</span></span> <span data-ttu-id="d4834-128">DSC di automazione di Azure estende questa automazione strumenti di PowerShell DSC tooinclude funzionalità.</span><span class="sxs-lookup"><span data-stu-id="d4834-128">Azure Automation DSC extends this automation capability tooinclude PowerShell DSC tools.</span></span>  <span data-ttu-id="d4834-129">Ecco un'interessante [panoramica](automation-dsc-overview.md).</span><span class="sxs-lookup"><span data-stu-id="d4834-129">Here’s a great [overview](automation-dsc-overview.md).</span></span>

<span data-ttu-id="d4834-130">Una risorsa DSC è un modulo di codice con funzionalità specifiche, ad esempio per la gestione della rete, di Active Directory o SQL Server.</span><span class="sxs-lookup"><span data-stu-id="d4834-130">A DSC Resource is a module of code that has specific capabilities, such as managing networking, Active Directory, or SQL Server.</span></span>  <span data-ttu-id="d4834-131">Hello Chocolatey risorsa DSC, nota come tooaccess un NuGet Server (tra gli altri), scaricare i pacchetti, installare i pacchetti e così via.</span><span class="sxs-lookup"><span data-stu-id="d4834-131">hello Chocolatey DSC Resource knows how tooaccess a NuGet Server (among others), download packages, install packages, and so on.</span></span>  <span data-ttu-id="d4834-132">Sono disponibili molte altre risorse DSC in hello [PowerShell Gallery](http://www.powershellgallery.com/packages?q=dsc+resources&prerelease=&sortOrder=package-title).</span><span class="sxs-lookup"><span data-stu-id="d4834-132">There are many other DSC Resources in hello [PowerShell Gallery](http://www.powershellgallery.com/packages?q=dsc+resources&prerelease=&sortOrder=package-title).</span></span>  <span data-ttu-id="d4834-133">Questi moduli vengono installati dall'utente nel server di pull di Automation DSC per Azure, per poter essere usati nelle configurazioni personalizzate.</span><span class="sxs-lookup"><span data-stu-id="d4834-133">These modules are installed into your Azure Automation DSC Pull Server (by you) so they can be used by your configurations.</span></span>

<span data-ttu-id="d4834-134">I modelli di Resource Manager offrono un modo dichiarativo per la generazione dell'infrastruttura, ad esempio reti, subnet, routing e sicurezza di rete, servizi di bilanciamento del carico, NIC, VM e così via.</span><span class="sxs-lookup"><span data-stu-id="d4834-134">Resource Manager templates provide a declarative way of generating your infrastructure - things like networks, subnets, network security and routing, load balancers, NICs, VMs, and so on.</span></span>  <span data-ttu-id="d4834-135">Ecco un [articolo](../azure-resource-manager/resource-manager-deployment-model.md) che confronta hello modello di distribuzione di gestione risorse (dichiarativo) con hello Azure Service Management (ASM o classica) la distribuzione del modello (imperativo) e vengono illustrati risorse principali hello provider, calcolo, archiviazione e rete.</span><span class="sxs-lookup"><span data-stu-id="d4834-135">Here’s an [article](../azure-resource-manager/resource-manager-deployment-model.md) that compares hello Resource Manager deployment model (declarative) with hello Azure Service Management (ASM, or classic) deployment model (imperative), and discusses hello core resource providers, compute, storage and network.</span></span>

<span data-ttu-id="d4834-136">Una caratteristica fondamentale di un modello di gestione risorse è relativo tooinstall possibilità un'estensione della macchina virtuale nella macchina virtuale hello è disponibile.</span><span class="sxs-lookup"><span data-stu-id="d4834-136">One key feature of an Resource Manager template is its ability tooinstall a VM extension into hello VM as it’s provisioned.</span></span>  <span data-ttu-id="d4834-137">Un'estensione VM include funzionalità specifiche, come l'esecuzione di uno script personalizzato, l'installazione di software antivirus o l'esecuzione di uno script di configurazione DSC.</span><span class="sxs-lookup"><span data-stu-id="d4834-137">A VM extension has specific capabilities such as running a custom script, installing anti-virus software, or running a DSC configuration script.</span></span>  <span data-ttu-id="d4834-138">Sono disponibili molti altri tipi di estensioni VM.</span><span class="sxs-lookup"><span data-stu-id="d4834-138">There are many other types of VM extensions.</span></span>

## <a name="quick-trip-around-hello-diagram"></a><span data-ttu-id="d4834-139">Rapido viaggi diagramma hello</span><span class="sxs-lookup"><span data-stu-id="d4834-139">Quick trip around hello diagram</span></span>
<span data-ttu-id="d4834-140">A partire dalla parte superiore di hello, la scrittura del codice, compilare e testare, quindi creare un pacchetto di installazione.</span><span class="sxs-lookup"><span data-stu-id="d4834-140">Starting at hello top, you write your code, build and test, then create an installation package.</span></span>  <span data-ttu-id="d4834-141">Chocolatey può gestire diversi tipi di pacchetti di installazione, ad esempio MSI, MSU, ZIP.</span><span class="sxs-lookup"><span data-stu-id="d4834-141">Chocolatey can handle various types of installation packages, such as MSI, MSU, ZIP.</span></span>  <span data-ttu-id="d4834-142">E si dispone di potenza hello di installazione di PowerShell toodo hello effettivo se alle funzionalità native del Chocolatey non sono abbastanza alto tooit.</span><span class="sxs-lookup"><span data-stu-id="d4834-142">And you have hello full power of PowerShell toodo hello actual installation if Chocolatey’s native capabilities aren’t quite up tooit.</span></span>  <span data-ttu-id="d4834-143">Inserire i pacchetti hello in identificabile raggiungibile: un repository di pacchetti.</span><span class="sxs-lookup"><span data-stu-id="d4834-143">Put hello package into someplace reachable – a package repository.</span></span>  <span data-ttu-id="d4834-144">Questo esempio di utilizzo usa una cartella pubblica in un account di archiviazione BLOB di Azure, ma può trovarsi anche in un'altra posizione.</span><span class="sxs-lookup"><span data-stu-id="d4834-144">This usage example uses a public folder in an Azure blob storage account, but it can be anywhere.</span></span>  <span data-ttu-id="d4834-145">Chocolatey funziona in modalità nativa con i server NuGet e alcuni altri per la gestione dei metadati dei pacchetti.</span><span class="sxs-lookup"><span data-stu-id="d4834-145">Chocolatey works natively with NuGet servers and a few others for management of package metadata.</span></span>  <span data-ttu-id="d4834-146">[In questo articolo](https://github.com/chocolatey/choco/wiki/How-To-Host-Feed) vengono descritte le opzioni di hello.</span><span class="sxs-lookup"><span data-stu-id="d4834-146">[This article](https://github.com/chocolatey/choco/wiki/How-To-Host-Feed) describes hello options.</span></span>  <span data-ttu-id="d4834-147">Questo esempio di utilizzo usa NuGet.</span><span class="sxs-lookup"><span data-stu-id="d4834-147">This usage example uses NuGet.</span></span>  <span data-ttu-id="d4834-148">Nuspec sono i metadati relativi ai pacchetti.</span><span class="sxs-lookup"><span data-stu-id="d4834-148">A Nuspec is metadata about your packages.</span></span>  <span data-ttu-id="d4834-149">Nuspec Hello "compilazione" in NuPkg e archiviati in un server NuGet.</span><span class="sxs-lookup"><span data-stu-id="d4834-149">hello Nuspec’s are “compiled” into NuPkg’s and stored in a NuGet server.</span></span>  <span data-ttu-id="d4834-150">Quando la configurazione richiede un pacchetto in base al nome e fa riferimento a un server NuGet, hello Chocolatey risorsa DSC (ora su hello VM) acquisisce pacchetto hello e lo installa automaticamente.</span><span class="sxs-lookup"><span data-stu-id="d4834-150">When your configuration requests a package by name, and references a NuGet server, hello Chocolatey DSC Resource (now on hello VM) grabs hello package and installs it for you.</span></span>  <span data-ttu-id="d4834-151">È anche possibile richiedere una versione specifica di un pacchetto.</span><span class="sxs-lookup"><span data-stu-id="d4834-151">You can also request a specific version of a package.</span></span>

<span data-ttu-id="d4834-152">Hello a sinistra nella parte inferiore dell'immagine di hello, prevede un modello di Azure Resource Manager (ARM).</span><span class="sxs-lookup"><span data-stu-id="d4834-152">In hello bottom left portion of hello picture, there is an Azure Resource Manager (ARM) template.</span></span>  <span data-ttu-id="d4834-153">In questo esempio di utilizzo, hello estensione della macchina virtuale registra hello VM con hello Azure Server di Pull DSC di automazione (ovvero, un server di pull) come un nodo.</span><span class="sxs-lookup"><span data-stu-id="d4834-153">In this usage example, hello VM extension registers hello VM with hello Azure Automation DSC Pull Server (that is, a pull server) as a Node.</span></span>  <span data-ttu-id="d4834-154">configurazione di Hello viene archiviata nel server di pull hello.</span><span class="sxs-lookup"><span data-stu-id="d4834-154">hello configuration is stored in hello pull server.</span></span>  <span data-ttu-id="d4834-155">In realtà viene archiviata due volte, cioè una volta come testo normale e una volta compilata come file MOF, un'indicazione per coloro che hanno familiarità con questi elementi.  Nel portale di hello hello MOF è una configurazione"nodi" (come toosimply anziché "configurazione").</span><span class="sxs-lookup"><span data-stu-id="d4834-155">Actually, it’s stored twice: once as plain text and once compiled as an MOF file (for those that know about such things.)  In hello portal, hello MOF is a “node configuration” (as opposed toosimply “configuration”).</span></span>  <span data-ttu-id="d4834-156">Di hello artefatto associato a un nodo in modo nodo hello riconoscerà la relativa configurazione.</span><span class="sxs-lookup"><span data-stu-id="d4834-156">It’s hello artifact that’s associated with a Node so hello node will know its configuration.</span></span>  <span data-ttu-id="d4834-157">I dettagli di seguito mostrano come tooassign hello toohello nodo configurazione.</span><span class="sxs-lookup"><span data-stu-id="d4834-157">Details below show how tooassign hello node configuration toohello node.</span></span>

<span data-ttu-id="d4834-158">Probabilmente si sta già eseguendo bit hello nella parte superiore di hello o la maggior parte di esso.</span><span class="sxs-lookup"><span data-stu-id="d4834-158">Presumably you’re already doing hello bit at hello top, or most of it.</span></span>  <span data-ttu-id="d4834-159">Creazione di hello nuspec, la compilazione e archiviare i dati in un server NuGet è una piccola cosa.</span><span class="sxs-lookup"><span data-stu-id="d4834-159">Creating hello nuspec, compiling and storing it in a NuGet server is a small thing.</span></span>  <span data-ttu-id="d4834-160">e si stanno già gestendo le VM.</span><span class="sxs-lookup"><span data-stu-id="d4834-160">And you’re already managing VMs.</span></span>  <span data-ttu-id="d4834-161">Tenendo hello successivo passaggio toocontinuous distribuzione richiede l'impostazione server di pull hello (una volta), registrazione i nodi con esso () e la creazione e archiviazione sono configurazione hello (inizialmente).</span><span class="sxs-lookup"><span data-stu-id="d4834-161">Taking hello next step toocontinuous deployment requires setting up hello pull server (once), registering your nodes with it (once), and creating and storing hello configuration there (initially).</span></span>  <span data-ttu-id="d4834-162">Aggiornare quindi i pacchetti vengono aggiornati e distribuiti toohello repository, hello configurazione e configurazione di un nodo nel server di pull hello (ripetizione in base alle necessità).</span><span class="sxs-lookup"><span data-stu-id="d4834-162">Then as packages are upgraded and deployed toohello repository, refresh hello Configuration and Node Configuration in hello pull server (repeat as needed).</span></span>

<span data-ttu-id="d4834-163">Il procedimento funziona anche se non si inizia con un modello ARM.</span><span class="sxs-lookup"><span data-stu-id="d4834-163">If you’re not starting with an ARM template, that’s also OK.</span></span>  <span data-ttu-id="d4834-164">Esistono PowerShell cmdlet progettati toohelp registrare le macchine virtuali con server di pull hello e tutte le restanti hello.</span><span class="sxs-lookup"><span data-stu-id="d4834-164">There are PowerShell cmdlets designed toohelp you register your VMs with hello pull server and all of hello rest.</span></span> <span data-ttu-id="d4834-165">Per altre informazioni dettagliate, vedere l'articolo [Caricamento di computer per la gestione con Automation DSC per Azure](automation-dsc-onboarding.md)</span><span class="sxs-lookup"><span data-stu-id="d4834-165">For more details, see this article: [Onboarding machines for management by Azure Automation DSC](automation-dsc-onboarding.md)</span></span>

## <a name="step-1-setting-up-hello-pull-server-and-automation-account"></a><span data-ttu-id="d4834-166">Passaggio 1: Impostazione di account di automazione e i server di pull hello</span><span class="sxs-lookup"><span data-stu-id="d4834-166">Step 1: Setting up hello pull server and automation account</span></span>
<span data-ttu-id="d4834-167">In una riga di comando di PowerShell (Add-AzureRmAccount) autenticata: (può richiedere alcuni minuti mentre viene configurato il server di pull hello)</span><span class="sxs-lookup"><span data-stu-id="d4834-167">At an authenticated (Add-AzureRmAccount) PowerShell command line:  (can take a few minutes while hello pull server is set up)</span></span>

    New-AzureRmResourceGroup –Name MY-AUTOMATION-RG –Location MY-RG-LOCATION-IN-QUOTES
    New-AzureRmAutomationAccount –ResourceGroupName MY-AUTOMATION-RG –Location MY-RG-LOCATION-IN-QUOTES –Name MY-AUTOMATION-ACCOUNT 

<span data-ttu-id="d4834-168">È possibile inserire l'account di automazione in una delle seguenti aree (detto anche percorso) hello: Stati Uniti orientali 2, centro-meridionali, ci Gov Virginia, Europa occidentale, Asia sudorientale, Giappone orientale, India centrale e Australia sudorientale, centrale Canada, Europa settentrionale.</span><span class="sxs-lookup"><span data-stu-id="d4834-168">You can put your automation account into any of hello following regions (aka location):  East US 2, South Central US, US Gov Virginia, West Europe, Southeast Asia, Japan East, Central India and Australia Southeast, Canada Central, North Europe.</span></span>

## <a name="step-2-vm-extension-tweaks-toohello-arm-template"></a><span data-ttu-id="d4834-169">Passaggio 2: Modello ARM toohello di modifiche per estensione della macchina virtuale</span><span class="sxs-lookup"><span data-stu-id="d4834-169">Step 2: VM extension tweaks toohello ARM template</span></span>
<span data-ttu-id="d4834-170">Dettagli per la registrazione della macchina virtuale (con estensione VM DSC PowerShell hello) forniti in questo [il modello di avvio rapido di Azure](https://github.com/Azure/azure-quickstart-templates/tree/master/dsc-extension-azure-automation-pullserver).</span><span class="sxs-lookup"><span data-stu-id="d4834-170">Details for VM registration (using hello PowerShell DSC VM extension) provided in this [Azure Quickstart Template](https://github.com/Azure/azure-quickstart-templates/tree/master/dsc-extension-azure-automation-pullserver).</span></span>  <span data-ttu-id="d4834-171">Questo passaggio registra la nuova macchina virtuale con il server di pull hello nell'elenco di hello dei nodi DSC.</span><span class="sxs-lookup"><span data-stu-id="d4834-171">This step registers your new VM with hello pull server in hello list of DSC Nodes.</span></span>  <span data-ttu-id="d4834-172">Parte di questa registrazione specificano hello nodo Configurazione toohello toobe applicato.</span><span class="sxs-lookup"><span data-stu-id="d4834-172">Part of this registration is specifying hello node configuration toobe applied toohello node.</span></span>  <span data-ttu-id="d4834-173">Questa configurazione del nodo non ha tooexist ancora nel server di pull hello, pertanto è OK di passaggio 4 in cui questa operazione viene eseguita per hello prima volta.</span><span class="sxs-lookup"><span data-stu-id="d4834-173">This node configuration doesn't have tooexist yet in hello pull server, so it's OK that Step 4 is where this is done for hello first time.</span></span>  <span data-ttu-id="d4834-174">Ma nel passaggio 2 di seguito è necessario nome hello deciso toohave del nodo hello e il nome di hello della configurazione di hello.</span><span class="sxs-lookup"><span data-stu-id="d4834-174">But here in Step 2 you do need toohave decided hello name of hello node and hello name of hello configuration.</span></span>  <span data-ttu-id="d4834-175">In questo esempio di utilizzo, nodo hello è 'isvbox' e la configurazione di hello è 'ISVBoxConfig'.</span><span class="sxs-lookup"><span data-stu-id="d4834-175">In this usage example, hello node is 'isvbox' and hello configuration is 'ISVBoxConfig'.</span></span>  <span data-ttu-id="d4834-176">Nome configurazione del nodo hello (toobe specificato in DeploymentTemplate.json) è così 'ISVBoxConfig.isvbox'.</span><span class="sxs-lookup"><span data-stu-id="d4834-176">So hello node configuration name (toobe specified in DeploymentTemplate.json) is 'ISVBoxConfig.isvbox'.</span></span>  

## <a name="step-3-adding-required-dsc-resources-toohello-pull-server"></a><span data-ttu-id="d4834-177">Passaggio 3: Aggiunta di server di pull toohello DSC risorse necessarie</span><span class="sxs-lookup"><span data-stu-id="d4834-177">Step 3: Adding required DSC resources toohello pull server</span></span>
<span data-ttu-id="d4834-178">Hello PowerShell Gallery è instrumentato tooinstall le risorse DSC nell'account di automazione di Azure.</span><span class="sxs-lookup"><span data-stu-id="d4834-178">hello PowerShell Gallery is instrumented tooinstall DSC resources into your Azure Automation account.</span></span>  <span data-ttu-id="d4834-179">Passare toohello risorsa desiderato e fare clic sul pulsante "Distribuisci tooAzure automazione" hello.</span><span class="sxs-lookup"><span data-stu-id="d4834-179">Navigate toohello resource you want and click hello “Deploy tooAzure Automation” button.</span></span>

![Esempio di PowerShell Gallery](./media/automation-dsc-cd-chocolatey/xNetworking.PNG)

<span data-ttu-id="d4834-181">Un'altra tecnica aggiunto di recente toohello portale di Azure consente toopull in moduli di aggiornamento esistente o di nuovo.</span><span class="sxs-lookup"><span data-stu-id="d4834-181">Another technique recently added toohello Azure Portal allows you toopull in new modules or update existing modules.</span></span> <span data-ttu-id="d4834-182">Fare clic sulle risorse di Account di automazione hello riquadro asset hello e infine riquadro moduli hello.</span><span class="sxs-lookup"><span data-stu-id="d4834-182">Click through hello Automation Account resource, hello Assets tile, and finally hello Modules tile.</span></span>  <span data-ttu-id="d4834-183">icona Sfoglia raccolta Hello consente elenco hello toosee dei moduli nella raccolta di hello, drill-down nei dettagli e infine importare nell'Account di automazione.</span><span class="sxs-lookup"><span data-stu-id="d4834-183">hello Browse Gallery icon allows you toosee hello list of modules in hello gallery, drill down into details and ultimately import into your Automation Account.</span></span> <span data-ttu-id="d4834-184">Questo è tookeep un modo utile per i moduli di toodate da tootime ora.</span><span class="sxs-lookup"><span data-stu-id="d4834-184">This is a great way tookeep your modules up toodate from time tootime.</span></span> <span data-ttu-id="d4834-185">E funzionalità di importazione hello controlla le dipendenze con altri tooensure moduli che Nothing Ottiene sincronizzato.</span><span class="sxs-lookup"><span data-stu-id="d4834-185">And, hello import feature checks dependencies with other modules tooensure nothing gets out of sync.</span></span>

<span data-ttu-id="d4834-186">In alternativa, è l'approccio manuale hello.</span><span class="sxs-lookup"><span data-stu-id="d4834-186">Or, there’s hello manual approach.</span></span>  <span data-ttu-id="d4834-187">struttura di cartelle Hello di un modulo di integrazione per un computer di Windows PowerShell è leggermente diversa dalla struttura delle cartelle hello previsto dal hello automazione di Azure.</span><span class="sxs-lookup"><span data-stu-id="d4834-187">hello folder structure of a PowerShell Integration Module for a Windows computer is a little different from hello folder structure expected by hello Azure Automation.</span></span>  <span data-ttu-id="d4834-188">perciò richiede alcune modifiche da parte dell'utente.</span><span class="sxs-lookup"><span data-stu-id="d4834-188">This requires a little tweaking on your part.</span></span>  <span data-ttu-id="d4834-189">Ma non è difficile e viene eseguita una sola volta per ogni risorsa (a meno che non si desidera tooupgrade in futuro.)  Per altre informazioni sulla creazione di moduli di integrazione di PowerShell, vedere l'articolo relativo alla [creazione di moduli di integrazione per Automazione di Azure](https://azure.microsoft.com/blog/authoring-integration-modules-for-azure-automation/)</span><span class="sxs-lookup"><span data-stu-id="d4834-189">But it’s not hard, and it’s done only once per resource (unless you want tooupgrade it in future.)  For more information on authoring PowerShell Integration Modules, see this article: [Authoring Integration Modules for Azure Automation](https://azure.microsoft.com/blog/authoring-integration-modules-for-azure-automation/)</span></span>

* <span data-ttu-id="d4834-190">Installare il modulo hello desiderati nella workstation, come indicato di seguito:</span><span class="sxs-lookup"><span data-stu-id="d4834-190">Install hello module that you need on your workstation, as follows:</span></span>
  * <span data-ttu-id="d4834-191">Installare [Windows Management Framework versione 5](http://aka.ms/wmf5latest) (non necessario per Windows 10).</span><span class="sxs-lookup"><span data-stu-id="d4834-191">Install [Windows Management Framework, v5](http://aka.ms/wmf5latest) (not needed for Windows 10)</span></span>
  * <span data-ttu-id="d4834-192">`Install-Module –Name MODULE-NAME`<-acrobazie hello modulo dalla hello PowerShell Gallery</span><span class="sxs-lookup"><span data-stu-id="d4834-192">`Install-Module –Name MODULE-NAME`    <—grabs hello module from hello PowerShell Gallery</span></span> 
* <span data-ttu-id="d4834-193">Cartella del modulo hello copia da `c:\Program Files\WindowsPowerShell\Modules\MODULE-NAME` tooa la cartella temp</span><span class="sxs-lookup"><span data-stu-id="d4834-193">Copy hello module folder from `c:\Program Files\WindowsPowerShell\Modules\MODULE-NAME` tooa temp folder</span></span> 
* <span data-ttu-id="d4834-194">Eliminare gli esempi e documentazione dalla cartella principale di hello</span><span class="sxs-lookup"><span data-stu-id="d4834-194">Delete samples and documentation from hello main folder</span></span> 
* <span data-ttu-id="d4834-195">Cartella principale hello ZIP, denominazione esattamente i file ZIP hello hello stesso come cartella hello</span><span class="sxs-lookup"><span data-stu-id="d4834-195">Zip hello main folder, naming hello ZIP file exactly hello same as hello folder</span></span> 
* <span data-ttu-id="d4834-196">Inserire file ZIP di hello in un percorso HTTP raggiungibile, ad esempio l'archiviazione di blob in un Account di archiviazione di Azure.</span><span class="sxs-lookup"><span data-stu-id="d4834-196">Put hello ZIP file into a reachable HTTP location, such as blob storage in an Azure Storage Account.</span></span>
* <span data-ttu-id="d4834-197">Eseguire questo comando di PowerShell:</span><span class="sxs-lookup"><span data-stu-id="d4834-197">Run this PowerShell:</span></span>
  
      New-AzureRmAutomationModule `
          -ResourceGroupName MY-AUTOMATION-RG -AutomationAccountName MY-AUTOMATION-ACCOUNT `
          -Name MODULE-NAME –ContentLink "https://STORAGE-URI/CONTAINERNAME/MODULE-NAME.zip"

<span data-ttu-id="d4834-198">esempio Hello incluso esegue questi passaggi per cChoco e xNetworking.</span><span class="sxs-lookup"><span data-stu-id="d4834-198">hello included example performs these steps for cChoco and xNetworking.</span></span> <span data-ttu-id="d4834-199">Vedere hello [note](#notes) per una gestione speciale per cChoco.</span><span class="sxs-lookup"><span data-stu-id="d4834-199">See hello [Notes](#notes) for special handling for cChoco.</span></span>

## <a name="step-4-adding-hello-node-configuration-toohello-pull-server"></a><span data-ttu-id="d4834-200">Passaggio 4: Aggiunta di server di pull toohello hello nodo Configurazione</span><span class="sxs-lookup"><span data-stu-id="d4834-200">Step 4: Adding hello node configuration toohello pull server</span></span>
<span data-ttu-id="d4834-201">Non è speciale hello prima che importare la configurazione in compilazione e il server di pull hello.</span><span class="sxs-lookup"><span data-stu-id="d4834-201">There’s nothing special about hello first time you import your configuration into hello pull server and compile.</span></span>  <span data-ttu-id="d4834-202">Importazione/compila tutti i successivi di hello stessa configurazione controllare esattamente hello stesso.</span><span class="sxs-lookup"><span data-stu-id="d4834-202">All subsequent import/compiles of hello same configuration look exactly hello same.</span></span>  <span data-ttu-id="d4834-203">Ogni volta che si aggiorna il pacchetto ed è necessario impostarlo tooproduction eseguire questo passaggio dopo aver verificato il file di configurazione di hello toopush sia corretto: inclusi hello nuova versione del pacchetto.</span><span class="sxs-lookup"><span data-stu-id="d4834-203">Each time you update your package and need toopush it out tooproduction you do this step after ensuring hello configuration file is correct – including hello new version of your package.</span></span>  <span data-ttu-id="d4834-204">Ecco il file di configurazione di hello e PowerShell:</span><span class="sxs-lookup"><span data-stu-id="d4834-204">Here’s hello configuration file and PowerShell:</span></span>

<span data-ttu-id="d4834-205">ISVBoxConfig.ps1:</span><span class="sxs-lookup"><span data-stu-id="d4834-205">ISVBoxConfig.ps1:</span></span>

    Configuration ISVBoxConfig 
    { 
        Import-DscResource -ModuleName cChoco 
        Import-DscResource -ModuleName xNetworking

        Node "isvbox" {   

            cChocoInstaller installChoco 
            { 
                InstallDir = "C:\choco" 
            }

            WindowsFeature installIIS 
            { 
                Ensure="Present" 
                Name="Web-Server" 
            }

            xFirewall WebFirewallRule 
            { 
                Direction = "Inbound" 
                Name = "Web-Server-TCP-In" 
                DisplayName = "Web Server (TCP-In)" 
                Description = "IIS allow incoming web site traffic." 
                DisplayGroup = "IIS Incoming Traffic" 
                State = "Enabled" 
                Access = "Allow" 
                Protocol = "TCP" 
                LocalPort = "80" 
                Ensure = "Present" 
            }

            cChocoPackageInstaller trivialWeb 
            {            
                Name = "trivialweb" 
                Version = "1.0.0" 
                Source = “MY-NUGET-V2-SERVER-ADDRESS” 
                DependsOn = "[cChocoInstaller]installChoco", 
                "[WindowsFeature]installIIS" 
            } 
        }    
    }

<span data-ttu-id="d4834-206">New-ConfigurationScript.ps1:</span><span class="sxs-lookup"><span data-stu-id="d4834-206">New-ConfigurationScript.ps1:</span></span>

    Import-AzureRmAutomationDscConfiguration ` 
        -ResourceGroupName MY-AUTOMATION-RG –AutomationAccountName MY-AUTOMATION-ACCOUNT ` 
        -SourcePath C:\temp\AzureAutomationDsc\ISVBoxConfig.ps1 ` 
        -Published –Force

    $jobData = Start-AzureRmAutomationDscCompilationJob ` 
        -ResourceGroupName MY-AUTOMATION-RG –AutomationAccountName MY-AUTOMATION-ACCOUNT ` 
        -ConfigurationName ISVBoxConfig 

    $compilationJobId = $jobData.Id

    Get-AzureRmAutomationDscCompilationJob ` 
        -ResourceGroupName MY-AUTOMATION-RG –AutomationAccountName MY-AUTOMATION-ACCOUNT ` 
        -Id $compilationJobId

<span data-ttu-id="d4834-207">Risultato questi passaggi in una nuova configurazione nodo denominato "ISVBoxConfig.isvbox" viene inserito nel server di pull hello.</span><span class="sxs-lookup"><span data-stu-id="d4834-207">These steps result in a new node configuration named “ISVBoxConfig.isvbox” being placed on hello pull server.</span></span>  <span data-ttu-id="d4834-208">nome di configurazione del nodo Hello viene compilato come "configurationName.nodeName".</span><span class="sxs-lookup"><span data-stu-id="d4834-208">hello node configuration name is built as “configurationName.nodeName”.</span></span>

## <a name="step-5-creating-and-maintaining-package-metadata"></a><span data-ttu-id="d4834-209">Passaggio 5: Creazione e gestione dei metadati del pacchetto</span><span class="sxs-lookup"><span data-stu-id="d4834-209">Step 5: Creating and maintaining package metadata</span></span>
<span data-ttu-id="d4834-210">Per ogni pacchetto che inserite nel repository di pacchetti hello, è necessario un nuspec che lo descrive.</span><span class="sxs-lookup"><span data-stu-id="d4834-210">For each package that you put into hello package repository, you need a nuspec that describes it.</span></span>  <span data-ttu-id="d4834-211">Questo Nuspec deve essere compilato e archiviato nel server NuGet.</span><span class="sxs-lookup"><span data-stu-id="d4834-211">That nuspec must be compiled and stored in your NuGet server.</span></span> <span data-ttu-id="d4834-212">Questo processo è descritto [qui](http://docs.nuget.org/create/creating-and-publishing-a-package).</span><span class="sxs-lookup"><span data-stu-id="d4834-212">This process is described [here](http://docs.nuget.org/create/creating-and-publishing-a-package).</span></span>  <span data-ttu-id="d4834-213">È possibile usare MyGet.org come server NuGet.</span><span class="sxs-lookup"><span data-stu-id="d4834-213">You can use MyGet.org as a NuGet server.</span></span>  <span data-ttu-id="d4834-214">Il servizio è a pagamento, ma viene offerto gratuitamente uno SKU di avvio.</span><span class="sxs-lookup"><span data-stu-id="d4834-214">They sell this service, but have a starter SKU that’s free.</span></span>  <span data-ttu-id="d4834-215">In NuGet.org sono disponibili istruzioni sull'installazione di un server NuGet personalizzato per i pacchetti privati.</span><span class="sxs-lookup"><span data-stu-id="d4834-215">At NuGet.org you’ll find instructions on installing your own NuGet server for your private packages.</span></span>

## <a name="step-6-tying-it-all-together"></a><span data-ttu-id="d4834-216">Passaggio 6: Verifica di tutti gli elementi</span><span class="sxs-lookup"><span data-stu-id="d4834-216">Step 6: Tying it all together</span></span>
<span data-ttu-id="d4834-217">Ogni volta che una versione passa QA e viene approvata per la distribuzione, viene creato il pacchetto di hello, nupkg e nuspec aggiornata e distribuita toohello NuGet server.</span><span class="sxs-lookup"><span data-stu-id="d4834-217">Each time a version passes QA and is approved for deployment, hello package is created, nuspec and nupkg updated and deployed toohello NuGet server.</span></span>  <span data-ttu-id="d4834-218">Inoltre, hello configurazione (passaggio 4 sopra) deve essere aggiornato tooagree con il nuovo numero di versione hello.</span><span class="sxs-lookup"><span data-stu-id="d4834-218">In addition, hello configuration (Step 4 above) must be updated tooagree with hello new version number.</span></span>  <span data-ttu-id="d4834-219">Server di pull toohello inviato e compilato.</span><span class="sxs-lookup"><span data-stu-id="d4834-219">It must be sent toohello pull server and compiled.</span></span>  <span data-ttu-id="d4834-220">Da quel momento in poi è le VM toohello che dipendono da tale aggiornamento della configurazione toopull hello e installarlo.</span><span class="sxs-lookup"><span data-stu-id="d4834-220">From that point on, it's up toohello VMs that depend on that configuration toopull hello update and install it.</span></span>  <span data-ttu-id="d4834-221">Questi aggiornamenti sono semplici: solo una o due righe di PowerShell.</span><span class="sxs-lookup"><span data-stu-id="d4834-221">Each of these updates are simple - just a line or two of PowerShell.</span></span>  <span data-ttu-id="d4834-222">Nel caso di hello di Visual Studio Team Services, alcuni di essi vengono incapsulati in attività di compilazione che possono essere concatenate in una compilazione.</span><span class="sxs-lookup"><span data-stu-id="d4834-222">In hello case of Visual Studio Team Services, some of them are encapsulated in build tasks that can be chained together in a build.</span></span>  <span data-ttu-id="d4834-223">Per altre informazioni dettagliate, vedere questo [articolo](https://www.visualstudio.com/en-us/docs/alm-devops-feature-index#continuous-delivery).</span><span class="sxs-lookup"><span data-stu-id="d4834-223">This [article](https://www.visualstudio.com/en-us/docs/alm-devops-feature-index#continuous-delivery) provides more details.</span></span>  <span data-ttu-id="d4834-224">Questo [repository GitHub](https://github.com/Microsoft/vso-agent-tasks) dettagli hello varie attività di compilazione disponibile.</span><span class="sxs-lookup"><span data-stu-id="d4834-224">This [GitHub repo](https://github.com/Microsoft/vso-agent-tasks) details hello various available build tasks.</span></span>

## <a name="notes"></a><span data-ttu-id="d4834-225">Note</span><span class="sxs-lookup"><span data-stu-id="d4834-225">Notes</span></span>
<span data-ttu-id="d4834-226">Questo esempio di utilizzo inizia con una macchina virtuale da un'immagine di Windows Server 2012 R2 generica da hello raccolta di Azure.</span><span class="sxs-lookup"><span data-stu-id="d4834-226">This usage example starts with a VM from a generic Windows Server 2012 R2 image from hello Azure gallery.</span></span>  <span data-ttu-id="d4834-227">È possibile iniziare da qualsiasi immagine archiviata e quindi modificare da lì, con la configurazione DSC hello.</span><span class="sxs-lookup"><span data-stu-id="d4834-227">You can start from any stored image and then tweak from there with hello DSC configuration.</span></span>  <span data-ttu-id="d4834-228">Tuttavia, la modifica di configurazione che è baked in un'immagine è molto più difficile rispetto all'aggiornamento in modo dinamico configurazione hello Usa DSC.</span><span class="sxs-lookup"><span data-stu-id="d4834-228">However, changing configuration that is baked into an image is much harder than dynamically updating hello configuration using DSC.</span></span>

<span data-ttu-id="d4834-229">Non è disponibile un modello ARM toouse e hello VM estensione toouse questa tecnica con le macchine virtuali.</span><span class="sxs-lookup"><span data-stu-id="d4834-229">You don’t have toouse an ARM template and hello VM extension toouse this technique with your VMs.</span></span>  <span data-ttu-id="d4834-230">E le macchine virtuali non toobe in Azure toobe sotto la gestione di CD-ROM.</span><span class="sxs-lookup"><span data-stu-id="d4834-230">And your VMs don’t have toobe on Azure toobe under CD management.</span></span>  <span data-ttu-id="d4834-231">Tutto ciò che è necessario sia tale Chocolatey e hello configurato Gestione configurazione locale nella macchina virtuale hello indicargli hello server di pull in.</span><span class="sxs-lookup"><span data-stu-id="d4834-231">All that’s necessary is that Chocolatey be installed and hello LCM configured on hello VM so it knows where hello pull server is.</span></span>  

<span data-ttu-id="d4834-232">Naturalmente, quando si aggiorna un pacchetto in una macchina virtuale nell'ambiente di produzione, è necessario tootake tale macchina virtuale dalla rotazione durante l'installazione dell'aggiornamento hello.</span><span class="sxs-lookup"><span data-stu-id="d4834-232">Of course, when you update a package on a VM that’s in production, you need tootake that VM out of rotation while hello update is installed.</span></span>  <span data-ttu-id="d4834-233">La procedura per eseguire questa operazione varia ampiamente.</span><span class="sxs-lookup"><span data-stu-id="d4834-233">How you do this varies widely.</span></span>  <span data-ttu-id="d4834-234">Ad esempio, per una VM con bilanciamento del carico di Azure è possibile aggiungere un probe personalizzato.</span><span class="sxs-lookup"><span data-stu-id="d4834-234">For example, with a VM behind an Azure Load Balancer, you can add a Custom Probe.</span></span>  <span data-ttu-id="d4834-235">Durante l'aggiornamento hello VM, hanno endpoint probe hello restituiscono un 400.</span><span class="sxs-lookup"><span data-stu-id="d4834-235">While updating hello VM, have hello probe endpoint return a 400.</span></span>  <span data-ttu-id="d4834-236">Hello tweak necessarie toocause questa modifica può essere all'interno della configurazione, come possibile hello tooswitch tweak nuovamente tooreturning 200 dopo l'aggiornamento di hello è stata completata.</span><span class="sxs-lookup"><span data-stu-id="d4834-236">hello tweak necessary toocause this change can be inside your configuration, as can hello tweak tooswitch it back tooreturning a 200 once hello update is complete.</span></span>

<span data-ttu-id="d4834-237">Il codice sorgente completo per questo esempio di utilizzo si trova in [questo progetto di Visual Studio](https://github.com/sebastus/ARM/tree/master/CDIaaSVM) su GitHub.</span><span class="sxs-lookup"><span data-stu-id="d4834-237">Full source for this usage example is in [this Visual Studio project](https://github.com/sebastus/ARM/tree/master/CDIaaSVM) on GitHub.</span></span>

## <a name="related-articles"></a><span data-ttu-id="d4834-238">Articoli correlati</span><span class="sxs-lookup"><span data-stu-id="d4834-238">Related Articles</span></span>
* [<span data-ttu-id="d4834-239">Panoramica della piattaforma DSC di Automazione di Azure</span><span class="sxs-lookup"><span data-stu-id="d4834-239">Azure Automation DSC Overview</span></span>](automation-dsc-overview.md)
* [<span data-ttu-id="d4834-240">Cmdlet di Automation DSC per Azure</span><span class="sxs-lookup"><span data-stu-id="d4834-240">Azure Automation DSC cmdlets</span></span>](https://msdn.microsoft.com/library/mt244122.aspx)
* [<span data-ttu-id="d4834-241">Caricamento di computer per la gestione con Automation DSC per Azure</span><span class="sxs-lookup"><span data-stu-id="d4834-241">Onboarding machines for management by Azure Automation DSC</span></span>](automation-dsc-onboarding.md)

