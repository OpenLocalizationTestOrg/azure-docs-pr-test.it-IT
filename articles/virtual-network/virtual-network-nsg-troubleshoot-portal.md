---
title: aaaTroubleshoot gruppi di sicurezza di rete - portale | Documenti Microsoft
description: Informazioni su come gruppi di sicurezza di rete tootroubleshoot nella distribuzione di Azure Resource Manager hello del modello utilizzando hello portale di Azure.
services: virtual-network
documentationcenter: na
author: AnithaAdusumilli
manager: narayan
editor: 
tags: azure-resource-manager
ms.assetid: a54feccf-0123-4e49-a743-eb8d0bdd1ebc
ms.service: virtual-network
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 09/23/2016
ms.author: anithaa
ms.openlocfilehash: 0d3d2110fe1507f36e3b933de924a0876db2747a
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/06/2017
---
# <a name="troubleshoot-network-security-groups-using-hello-azure-portal"></a><span data-ttu-id="db444-103">Risolvere i problemi relativi a gruppi di sicurezza di rete utilizzando hello portale di Azure</span><span class="sxs-lookup"><span data-stu-id="db444-103">Troubleshoot Network Security Groups using hello Azure Portal</span></span>
> [!div class="op_single_selector"]
> * [<span data-ttu-id="db444-104">Portale di Azure</span><span class="sxs-lookup"><span data-stu-id="db444-104">Azure Portal</span></span>](virtual-network-nsg-troubleshoot-portal.md)
> * [<span data-ttu-id="db444-105">PowerShell</span><span class="sxs-lookup"><span data-stu-id="db444-105">PowerShell</span></span>](virtual-network-nsg-troubleshoot-powershell.md)
> 
> 

<span data-ttu-id="db444-106">Se si sono verificati problemi di connettività di macchina virtuale configurato rete sicurezza gruppi sulla macchina virtuale (VM), in questo articolo fornisce una panoramica delle funzionalità di diagnostica per NSGs toohelp risolvere il problema.</span><span class="sxs-lookup"><span data-stu-id="db444-106">If you configured Network Security Groups (NSGs) on your virtual machine (VM) and are experiencing VM connectivity issues, this article provides an overview of diagnostics capabilities for NSGs toohelp troubleshoot further.</span></span>

<span data-ttu-id="db444-107">NSGs consentono tipi hello toocontrol di traffico che il flusso da e verso le macchine virtuali (VM).</span><span class="sxs-lookup"><span data-stu-id="db444-107">NSGs enable you toocontrol hello types of traffic that flow in and out of your virtual machines (VMs).</span></span> <span data-ttu-id="db444-108">NSGs può essere applicato toosubnets in una rete virtuale di Azure (VNet), le interfacce di rete (NIC) o entrambi.</span><span class="sxs-lookup"><span data-stu-id="db444-108">NSGs can be applied toosubnets in an Azure Virtual Network (VNet), network interfaces (NIC), or both.</span></span> <span data-ttu-id="db444-109">Hello regole efficaci applicate tooa NIC sono un'aggregazione di regole hello esistenti hello NSGs applicato tooa NIC e hello subnet è connesso a.</span><span class="sxs-lookup"><span data-stu-id="db444-109">hello effective rules applied tooa NIC are an aggregation of hello rules that exist in hello NSGs applied tooa NIC and hello subnet it is connected to.</span></span> <span data-ttu-id="db444-110">Talvolta le regole nei gruppi di sicurezza di rete possono essere in conflitto tra loro e influire sulla connettività di rete della VM.</span><span class="sxs-lookup"><span data-stu-id="db444-110">Rules across these NSGs can sometimes conflict with each other and impact a VM's network connectivity.</span></span>  

<span data-ttu-id="db444-111">È possibile visualizzare tutte le regole di sicurezza efficace hello dal NSGs, così come applicato nelle schede NIC della macchina virtuale.</span><span class="sxs-lookup"><span data-stu-id="db444-111">You can view all hello effective security rules from your NSGs, as applied on your VM's NICs.</span></span> <span data-ttu-id="db444-112">Questo articolo illustra come problemi di connettività VM tootroubleshoot usando queste regole in hello modello di distribuzione Azure Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="db444-112">This article shows how tootroubleshoot VM connectivity issues using these rules in hello Azure Resource Manager deployment model.</span></span> <span data-ttu-id="db444-113">Se non si ha familiarità con i concetti di rete virtuale e di gruppo, leggere hello [rete virtuale](virtual-networks-overview.md) e [gruppi di sicurezza di rete](virtual-networks-nsg.md) articoli Panoramica.</span><span class="sxs-lookup"><span data-stu-id="db444-113">If you're not familiar with VNet and NSG concepts, read hello [Virtual network](virtual-networks-overview.md) and [Network security groups](virtual-networks-nsg.md) overview articles.</span></span>

## <a name="using-effective-security-rules-tootroubleshoot-vm-traffic-flow"></a><span data-ttu-id="db444-114">Utilizzando le regole di sicurezza efficace tootroubleshoot VM il flusso del traffico</span><span class="sxs-lookup"><span data-stu-id="db444-114">Using Effective Security Rules tootroubleshoot VM traffic flow</span></span>
<span data-ttu-id="db444-115">scenario di Hello che segue è un esempio di un problema di connessione comuni:</span><span class="sxs-lookup"><span data-stu-id="db444-115">hello scenario that follows is an example of a common connection problem:</span></span>

<span data-ttu-id="db444-116">Una macchina virtuale denominata *VM1* fa parte di una subnet denominata *Subnet1* in una rete virtuale denominata *WestUS-VNet1*.</span><span class="sxs-lookup"><span data-stu-id="db444-116">A VM named *VM1* is part of a subnet named *Subnet1* within a VNet named *WestUS-VNet1*.</span></span> <span data-ttu-id="db444-117">Un toohello tooconnect tentativo di VM che utilizzano il protocollo RDP sulla porta TCP 3389 ha esito negativo.</span><span class="sxs-lookup"><span data-stu-id="db444-117">An attempt tooconnect toohello VM using RDP over TCP port 3389 fails.</span></span> <span data-ttu-id="db444-118">NSGs vengono applicate a entrambi hello NIC *VM1 NIC1* e hello subnet *Subnet1*.</span><span class="sxs-lookup"><span data-stu-id="db444-118">NSGs are applied at both hello NIC *VM1-NIC1* and hello subnet *Subnet1*.</span></span> <span data-ttu-id="db444-119">La porta 3389 tooTCP di traffico è consentita in hello NSG associata con l'interfaccia di rete hello *VM1 NIC1*, tuttavia TCP effettuare il ping ha esito 3389 negativo di porta del tooVM1.</span><span class="sxs-lookup"><span data-stu-id="db444-119">Traffic tooTCP port 3389 is allowed in hello NSG associated with hello network interface *VM1-NIC1*, however TCP ping tooVM1's port 3389 fails.</span></span>

<span data-ttu-id="db444-120">Mentre in questo esempio viene usata la porta TCP 3389, hello i passaggi seguenti può essere utilizzati toodetermine errori di connessione in ingresso e in uscita su qualsiasi porta.</span><span class="sxs-lookup"><span data-stu-id="db444-120">While this example uses TCP port 3389, hello following steps can be used toodetermine inbound and outbound connection failures over any port.</span></span>

### <span data-ttu-id="db444-121"><a name="vm"></a>Visualizzare le regole di sicurezza effettive per una macchina virtuale</span><span class="sxs-lookup"><span data-stu-id="db444-121"><a name="vm"></a>View effective security rules for a virtual machine</span></span>
<span data-ttu-id="db444-122">Completare hello seguendo i passaggi tootroubleshoot NSGs per una macchina virtuale:</span><span class="sxs-lookup"><span data-stu-id="db444-122">Complete hello following steps tootroubleshoot NSGs for a VM:</span></span>

<span data-ttu-id="db444-123">È possibile visualizzare l'elenco completo delle regole di sicurezza efficace hello su una scheda di rete dalla macchina virtuale stessa hello.</span><span class="sxs-lookup"><span data-stu-id="db444-123">You can view full list of hello effective security rules on a NIC, from hello VM itself.</span></span> <span data-ttu-id="db444-124">È inoltre possibile aggiungere, modificare ed eliminare le regole di gruppo NIC sia subnet dal pannello regole efficaci hello, se si dispone delle autorizzazioni tooperform queste operazioni.</span><span class="sxs-lookup"><span data-stu-id="db444-124">You can also add, modify, and delete both NIC and subnet NSG rules from hello effective rules blade, if you have permissions tooperform these operations.</span></span>

1. <span data-ttu-id="db444-125">Portale di Azure all'indirizzo https://portal.azure.com toohello di account di accesso.</span><span class="sxs-lookup"><span data-stu-id="db444-125">Login toohello Azure portal at https://portal.azure.com.</span></span>
2. <span data-ttu-id="db444-126">Fare clic su **più servizi**, quindi fare clic su **macchine virtuali** nell'elenco visualizzato hello.</span><span class="sxs-lookup"><span data-stu-id="db444-126">Click **More services**, then click **Virtual machines** in hello list that appears.</span></span>
3. <span data-ttu-id="db444-127">Selezionare tootroubleshoot una macchina virtuale dall'elenco di hello che viene visualizzata e viene visualizzato un pannello della macchina virtuale con opzioni.</span><span class="sxs-lookup"><span data-stu-id="db444-127">Select a VM tootroubleshoot from hello list that appears and a VM blade with options appears.</span></span>
4. <span data-ttu-id="db444-128">Fare clic su **Diagnostica e risoluzione dei problemi** e quindi selezionare un problema comune.</span><span class="sxs-lookup"><span data-stu-id="db444-128">Click **Diagnose & solve problems** and then select a common problem.</span></span> <span data-ttu-id="db444-129">Per questo esempio, **toomy macchina virtuale di Windows non riesco a connettermi** è selezionata.</span><span class="sxs-lookup"><span data-stu-id="db444-129">For this example, **I can’t connect toomy Windows VM** is selected.</span></span> 
   
    ![](./media/virtual-network-nsg-troubleshoot-portal/image1.png)
5. <span data-ttu-id="db444-130">Passaggi appaiono sotto problema hello, come illustrato nella seguente immagine hello:</span><span class="sxs-lookup"><span data-stu-id="db444-130">Steps appear under hello problem, as shown in hello following picture:</span></span> 
   
    ![](./media/virtual-network-nsg-troubleshoot-portal/image2.png)
   
    <span data-ttu-id="db444-131">Fare clic su *regole gruppo di sicurezza efficace* nell'elenco di hello di procedure consigliate.</span><span class="sxs-lookup"><span data-stu-id="db444-131">Click *effective security group rules* in hello list of recommended steps.</span></span>
6. <span data-ttu-id="db444-132">Hello **ottenere le regole di sicurezza efficace** pannello viene visualizzato, come illustrato nella seguente immagine hello:</span><span class="sxs-lookup"><span data-stu-id="db444-132">hello **Get effective security rules** blade appears, as shown in hello following picture:</span></span>
   
    ![](./media/virtual-network-nsg-troubleshoot-portal/image3.png)
   
    <span data-ttu-id="db444-133">Tenere presente le sezioni seguenti di immagine hello hello:</span><span class="sxs-lookup"><span data-stu-id="db444-133">Notice hello following sections of hello picture:</span></span>
   
   * <span data-ttu-id="db444-134">**Ambito:** impostare troppo*VM1*, hello macchina virtuale selezionata nel passaggio 3.</span><span class="sxs-lookup"><span data-stu-id="db444-134">**Scope:** Set too*VM1*, hello VM selected in step 3.</span></span>
   * <span data-ttu-id="db444-135">**Interfaccia di rete:***VM1-NIC1* .</span><span class="sxs-lookup"><span data-stu-id="db444-135">**Network interface:** *VM1-NIC1* is selected.</span></span> <span data-ttu-id="db444-136">Una VM può avere più interfacce di rete (NIC).</span><span class="sxs-lookup"><span data-stu-id="db444-136">A VM can have multiple network interfaces (NIC).</span></span> <span data-ttu-id="db444-137">Ogni interfaccia di rete può avere regole di sicurezza effettive univoche.</span><span class="sxs-lookup"><span data-stu-id="db444-137">Each NIC can have unique effective security rules.</span></span> <span data-ttu-id="db444-138">Per risolvere il problema, le regole di sicurezza efficace hello tooview potrebbe essere necessario per ogni scheda di rete.</span><span class="sxs-lookup"><span data-stu-id="db444-138">When troubleshooting, you may need tooview hello effective security rules for each NIC.</span></span>
   * <span data-ttu-id="db444-139">**Associato NSGs:** NSGs può essere applicato tooboth hello NIC e hello subnet hello è connessa al.</span><span class="sxs-lookup"><span data-stu-id="db444-139">**Associated NSGs:** NSGs can be applied tooboth hello NIC and hello subnet hello NIC is connected to.</span></span> <span data-ttu-id="db444-140">Nell'immagine di hello, un gruppo è stato applicato tooboth hello NIC e hello subnet a che è connesso.</span><span class="sxs-lookup"><span data-stu-id="db444-140">In hello picture, an NSG has been applied tooboth hello NIC and hello subnet it's connected to.</span></span> <span data-ttu-id="db444-141">È possibile fare clic sui nomi di gruppo hello toodirectly modificare le regole in hello NSGs.</span><span class="sxs-lookup"><span data-stu-id="db444-141">You can click on hello NSG names toodirectly modify rules in hello NSGs.</span></span>
   * <span data-ttu-id="db444-142">**Scheda VM1 nsg:** elenco hello delle regole visualizzate nell'immagine di hello è hello NSG applicato toohello scheda di rete.</span><span class="sxs-lookup"><span data-stu-id="db444-142">**VM1-nsg tab:** hello list of rules displayed in hello picture is for hello NSG applied toohello NIC.</span></span> <span data-ttu-id="db444-143">Azure crea diverse regole predefinite quando viene creato un gruppo di sicurezza di rete.</span><span class="sxs-lookup"><span data-stu-id="db444-143">Several default rules are created by Azure whenever an NSG is created.</span></span> <span data-ttu-id="db444-144">Non è possibile rimuovere le regole predefinite di hello, ma è possibile eseguirne l'override con regole di priorità più alta.</span><span class="sxs-lookup"><span data-stu-id="db444-144">You can't remove hello default rules, but you can override them with rules of higher priority.</span></span> <span data-ttu-id="db444-145">altre informazioni sulle regole predefinite, leggere hello toolearn [Panoramica gruppo](virtual-networks-nsg.md#default-rules) articolo.</span><span class="sxs-lookup"><span data-stu-id="db444-145">toolearn more about default rules, read hello [NSG overview](virtual-networks-nsg.md#default-rules) article.</span></span>
   * <span data-ttu-id="db444-146">**Colonna di destinazione:** alcune regole hello con testo nella colonna hello, mentre gli altri sono i prefissi di indirizzo.</span><span class="sxs-lookup"><span data-stu-id="db444-146">**DESTINATION column:** Some of hello rules have text in hello column, while others have address prefixes.</span></span> <span data-ttu-id="db444-147">testo Hello è il nome di hello della regola di sicurezza predefinita tag applicati toohello quando è stata creata.</span><span class="sxs-lookup"><span data-stu-id="db444-147">hello text is hello name of default tags applied toohello security rule when it was created.</span></span> <span data-ttu-id="db444-148">tag di Hello sono identificatori forniti dal sistema che rappresentano più prefissi.</span><span class="sxs-lookup"><span data-stu-id="db444-148">hello tags are system-provided identifiers that represent multiple prefixes.</span></span> <span data-ttu-id="db444-149">Selezione di una regola con un tag, ad esempio *AllowInternetOutBound*, Elenca i prefissi di hello in hello **prefissi di indirizzo** blade.</span><span class="sxs-lookup"><span data-stu-id="db444-149">Selecting a rule with a tag, such as *AllowInternetOutBound*, lists hello prefixes in hello **Address prefixes** blade.</span></span>
   * <span data-ttu-id="db444-150">**Download:** elenco hello delle regole può richiedere tempi lungo.</span><span class="sxs-lookup"><span data-stu-id="db444-150">**Download:** hello list of rules can be long.</span></span> <span data-ttu-id="db444-151">È possibile scaricare un file CSV di regole hello per l'analisi non in linea, fare clic su **scaricare** e salvataggio file hello.</span><span class="sxs-lookup"><span data-stu-id="db444-151">You can download a .csv file of hello rules for offline analysis by clicking **Download** and saving hello file.</span></span>
   * <span data-ttu-id="db444-152">**AllowRDP** regola in ingresso: questa regola consente a toohello connessioni RDP macchina virtuale.</span><span class="sxs-lookup"><span data-stu-id="db444-152">**AllowRDP** Inbound rule: This rule allows RDP connections toohello VM.</span></span>
7. <span data-ttu-id="db444-153">Fare clic su hello **Subnet1 NSG** scheda tooview hello valide le regole da hello NSG applicate toohello subnet, come illustrato nella seguente immagine hello:</span><span class="sxs-lookup"><span data-stu-id="db444-153">Click hello **Subnet1-NSG** tab tooview hello effective rules from hello NSG applied toohello subnet, as shown in hello following picture:</span></span> 
   
    ![](./media/virtual-network-nsg-troubleshoot-portal/image4.png)
   
    <span data-ttu-id="db444-154">Hello preavviso *denyRDP* **in ingresso** regola.</span><span class="sxs-lookup"><span data-stu-id="db444-154">Notice hello *denyRDP* **Inbound** rule.</span></span> <span data-ttu-id="db444-155">Le regole in entrata applicate al subnet hello vengono valutate prima delle regole applicate all'interfaccia di rete hello.</span><span class="sxs-lookup"><span data-stu-id="db444-155">Inbound rules applied at hello subnet are evaluated before rules applied at hello network interface.</span></span> <span data-ttu-id="db444-156">Poiché hello Nega regola viene applicata a subnet hello, hello richiesta tooconnect tooTCP 3389 ha esito negativo, hello consente la regola in hello NIC non viene mai valutata.</span><span class="sxs-lookup"><span data-stu-id="db444-156">Since hello deny rule is applied at hello subnet, hello request tooconnect tooTCP 3389 fails, because hello allow rule at hello NIC is never evaluated.</span></span> 
   
    <span data-ttu-id="db444-157">Hello *denyRDP* regola è motivo di hello motivi hello connessione RDP.</span><span class="sxs-lookup"><span data-stu-id="db444-157">hello *denyRDP* rule is hello reason why hello RDP connection is failing.</span></span> <span data-ttu-id="db444-158">Rimuoverlo dovrebbe risolvere il problema di hello.</span><span class="sxs-lookup"><span data-stu-id="db444-158">Removing it should resolve hello problem.</span></span>
   
   > [!NOTE]
   > <span data-ttu-id="db444-159">Se hello VM associata con hello NIC non è in esecuzione, o NSGs non sono stato applicato toohello NIC o una subnet, le regole non vengono visualizzate.</span><span class="sxs-lookup"><span data-stu-id="db444-159">If hello VM associated with hello NIC is not in a running state, or NSGs haven't been applied toohello NIC or subnet, no rules are shown.</span></span>
   > 
   > 
8. <span data-ttu-id="db444-160">Fare clic su regole NSG tooedit, *Subnet1 NSG* in hello **NSGs associata** sezione.</span><span class="sxs-lookup"><span data-stu-id="db444-160">tooedit NSG rules, click *Subnet1-NSG* in hello **Associated NSGs** section.</span></span>
   <span data-ttu-id="db444-161">Verrà visualizzata hello **Subnet1 NSG** blade.</span><span class="sxs-lookup"><span data-stu-id="db444-161">This opens hello **Subnet1-NSG** blade.</span></span> <span data-ttu-id="db444-162">È possibile modificare direttamente le regole di hello facendo clic su **sicurezza regole connessioni in entrata**.</span><span class="sxs-lookup"><span data-stu-id="db444-162">You can directly edit hello rules by clicking on **Inbound security rules**.</span></span>
   
    ![](./media/virtual-network-nsg-troubleshoot-portal/image7.png)
9. <span data-ttu-id="db444-163">Dopo la rimozione di hello *denyRDP* regola in entrata in hello **Subnet1 NSG** e l'aggiunta di un *allowRDP* regola, l'elenco di regole efficaci hello è simile a hello seguente immagine:</span><span class="sxs-lookup"><span data-stu-id="db444-163">After removing hello *denyRDP* inbound rule in hello **Subnet1-NSG** and adding an *allowRDP* rule, hello effective rules list looks like hello following picture:</span></span>
   
    ![](./media/virtual-network-nsg-troubleshoot-portal/image8.png)
   
    <span data-ttu-id="db444-164">Verificare che la porta TCP 3389 sia aperta aprendo un toohello connessione RDP macchina virtuale o lo strumento PsPing hello.</span><span class="sxs-lookup"><span data-stu-id="db444-164">Confirm that TCP port 3389 is open by opening an RDP connection toohello VM or using hello PsPing tool.</span></span> <span data-ttu-id="db444-165">È possibile approfondire PsPing da lettura hello [pagina di download PsPing](https://technet.microsoft.com/sysinternals/psping.aspx).</span><span class="sxs-lookup"><span data-stu-id="db444-165">You can learn more about PsPing by reading hello [PsPing download page](https://technet.microsoft.com/sysinternals/psping.aspx).</span></span>

### <span data-ttu-id="db444-166"><a name="nic"></a>Visualizzare le regole di sicurezza effettive per un'interfaccia di rete</span><span class="sxs-lookup"><span data-stu-id="db444-166"><a name="nic"></a>View effective security rules for a network interface</span></span>
<span data-ttu-id="db444-167">Se il flusso di traffico della macchina virtuale ha un impatto per una scheda di rete specifico, è possibile visualizzare un elenco completo delle regole di validità hello per hello NIC dal contesto di interfacce di rete hello completando hello alla procedura seguente:</span><span class="sxs-lookup"><span data-stu-id="db444-167">If your VM traffic flow is impacted for a specific NIC, you can view a full list of hello effective rules for hello NIC from hello network interfaces context by completing hello following steps:</span></span>

1. <span data-ttu-id="db444-168">Portale di Azure all'indirizzo https://portal.azure.com toohello di account di accesso.</span><span class="sxs-lookup"><span data-stu-id="db444-168">Login toohello Azure portal at https://portal.azure.com.</span></span>
2. <span data-ttu-id="db444-169">Fare clic su **più servizi**, quindi fare clic su **interfacce di rete** nell'elenco visualizzato hello.</span><span class="sxs-lookup"><span data-stu-id="db444-169">Click **More services**, then click **Network interfaces** in hello list that appears.</span></span>
3. <span data-ttu-id="db444-170">Selezionare un'interfaccia di rete.</span><span class="sxs-lookup"><span data-stu-id="db444-170">Select a network interface.</span></span> <span data-ttu-id="db444-171">In hello seguente immagine, una scheda di rete denominata *VM1 NIC1* è selezionata.</span><span class="sxs-lookup"><span data-stu-id="db444-171">In hello following picture, a NIC named *VM1-NIC1* is selected.</span></span>
   
    ![](./media/virtual-network-nsg-troubleshoot-portal/image5.png)
   
    <span data-ttu-id="db444-172">Si noti che hello **ambito** è impostata l'interfaccia di rete toohello selezionata.</span><span class="sxs-lookup"><span data-stu-id="db444-172">Notice that hello **Scope** is set toohello network interface selected.</span></span> <span data-ttu-id="db444-173">altre informazioni sulle toolearn hello informazioni aggiuntive visualizzate, leggere passaggio 6 di hello **NSGs risoluzione dei problemi per una macchina virtuale** sezione di questo articolo.</span><span class="sxs-lookup"><span data-stu-id="db444-173">toolearn more about hello additional information shown, read step 6 of hello **Troubleshoot NSGs for a VM** section of this article.</span></span>
   
   > [!NOTE]
   > <span data-ttu-id="db444-174">Se un gruppo viene rimosso da un'interfaccia di rete, subnet hello gruppo è ancora valida in hello data scheda di rete.</span><span class="sxs-lookup"><span data-stu-id="db444-174">If an NSG is removed from a network interface, hello subnet NSG is still effective on hello given NIC.</span></span> <span data-ttu-id="db444-175">In questo caso, output di hello permetterebbe di visualizzare solo le regole dalla subnet hello gruppo.</span><span class="sxs-lookup"><span data-stu-id="db444-175">In this case, hello output would only show rules from hello subnet NSG.</span></span> <span data-ttu-id="db444-176">Le regole vengono visualizzate solo se hello NIC associata tooa macchina virtuale.</span><span class="sxs-lookup"><span data-stu-id="db444-176">Rules only appear if hello NIC is attached tooa VM.</span></span>
   > 
   > 
4. <span data-ttu-id="db444-177">È possibile modificare direttamente le regole per i gruppi di sicurezza di rete associati a un'interfaccia di rete e a una subnet.</span><span class="sxs-lookup"><span data-stu-id="db444-177">You can directly edit rules for NSGs associated with a NIC and a subnet.</span></span> <span data-ttu-id="db444-178">toolearn, vedere passaggio 8 di hello **visualizzare le regole di sicurezza efficace per una macchina virtuale** sezione di questo articolo.</span><span class="sxs-lookup"><span data-stu-id="db444-178">toolearn how, read step 8 of hello **View effective security rules for a virtual machine** section of this article.</span></span>

## <span data-ttu-id="db444-179"><a name="nsg"></a>Visualizzare le regole di sicurezza effettive per un gruppo di sicurezza di rete</span><span class="sxs-lookup"><span data-stu-id="db444-179"><a name="nsg"></a>View effective security rules for a network security group (NSG)</span></span>
<span data-ttu-id="db444-180">Quando la modifica delle regole di gruppo, è opportuno impatto hello tooreview delle regole di hello aggiunto in una determinata macchina virtuale.</span><span class="sxs-lookup"><span data-stu-id="db444-180">When modifying NSG rules, you may want tooreview hello impact of hello rules being added on a particular VM.</span></span> <span data-ttu-id="db444-181">È possibile visualizzare un elenco completo delle regole di sicurezza efficace hello per tutti hello NIC che viene applicato un determinato gruppo, senza la necessità di contesto tooswitch da hello pannello gruppo specificato.</span><span class="sxs-lookup"><span data-stu-id="db444-181">You can view a full list of hello effective security rules for all hello NICs that a given NSG is applied to, without having tooswitch context from hello given NSG blade.</span></span> <span data-ttu-id="db444-182">tootroubleshoot regole valide all'interno di un gruppo, hello completo alla procedura seguente:</span><span class="sxs-lookup"><span data-stu-id="db444-182">tootroubleshoot effective rules within an NSG, complete hello following steps:</span></span>

1. <span data-ttu-id="db444-183">Portale di Azure all'indirizzo https://portal.azure.com toohello di account di accesso.</span><span class="sxs-lookup"><span data-stu-id="db444-183">Login toohello Azure portal at https://portal.azure.com.</span></span>
2. <span data-ttu-id="db444-184">Fare clic su **più servizi**, quindi fare clic su **gruppi di sicurezza di rete** nell'elenco visualizzato hello.</span><span class="sxs-lookup"><span data-stu-id="db444-184">Click **More services**, then click **Network security groups** in hello list that appears.</span></span>
3. <span data-ttu-id="db444-185">Selezionare un gruppo di sicurezza di rete.</span><span class="sxs-lookup"><span data-stu-id="db444-185">Select an NSG.</span></span> <span data-ttu-id="db444-186">Nella seguente immagine di hello, è stato selezionato un gruppo denominato VM1 gruppo.</span><span class="sxs-lookup"><span data-stu-id="db444-186">In hello following picture, an NSG named VM1-nsg was selected.</span></span>
   
    ![](./media/virtual-network-nsg-troubleshoot-portal/image6.png)
   
    <span data-ttu-id="db444-187">Tenere presente le sezioni seguenti di immagine precedente hello hello:</span><span class="sxs-lookup"><span data-stu-id="db444-187">Notice hello following sections of hello previous picture:</span></span>
   
   * <span data-ttu-id="db444-188">**Ambito:** impostare toohello gruppo selezionato.</span><span class="sxs-lookup"><span data-stu-id="db444-188">**Scope:** Set toohello NSG selected.</span></span>
   * <span data-ttu-id="db444-189">**Macchina virtuale:** NSG un quando è applicato tooa subnet, è subnet della rete interfacce tooall collegato macchine virtuali connesse toohello tooall applicato.</span><span class="sxs-lookup"><span data-stu-id="db444-189">**Virtual machine:** When an NSG is applied tooa subnet, it's applied tooall network interfaces attached tooall VMs connected toohello subnet.</span></span> <span data-ttu-id="db444-190">Questo elenco indica tutte le VM alle quali è applicato questo gruppo di sicurezza di rete.</span><span class="sxs-lookup"><span data-stu-id="db444-190">This list shows all VMs this NSG is applied to.</span></span> <span data-ttu-id="db444-191">È possibile selezionare qualsiasi macchina virtuale dall'elenco di hello.</span><span class="sxs-lookup"><span data-stu-id="db444-191">You can select any VM from hello list.</span></span>
     
     > [!NOTE]
     > <span data-ttu-id="db444-192">Se un gruppo è applicato tooonly una subnet vuota, non verranno elencate le macchine virtuali.</span><span class="sxs-lookup"><span data-stu-id="db444-192">If an NSG is applied tooonly an empty subnet, VMs will not be listed.</span></span> <span data-ttu-id="db444-193">Se un gruppo è applicato tooa scheda di rete che non è associata a una macchina virtuale, le schede NIC anche non verranno elencate.</span><span class="sxs-lookup"><span data-stu-id="db444-193">If an NSG is applied tooa NIC which is not associated with a VM, those NICs will also not be listed.</span></span> 
     > 
     > 
   * <span data-ttu-id="db444-194">**Interfaccia di rete:** una macchina virtuale può avere più interfacce di rete.</span><span class="sxs-lookup"><span data-stu-id="db444-194">**Network Interface:** A VM can have multiple network interfaces.</span></span> <span data-ttu-id="db444-195">È possibile selezionare un'interfaccia di rete toohello collegato selezionato macchina virtuale.</span><span class="sxs-lookup"><span data-stu-id="db444-195">You can select a network interface attached toohello selected VM.</span></span>
   * <span data-ttu-id="db444-196">**AssociatedNSGs:** in qualsiasi momento, una scheda di rete può essere composto tootwo NSGs efficace, uno applicato toohello NIC e le altre subnet toohello hello.</span><span class="sxs-lookup"><span data-stu-id="db444-196">**AssociatedNSGs:** At any time, a NIC can have up tootwo effective NSGs, one applied toohello NIC and hello other toohello subnet.</span></span> <span data-ttu-id="db444-197">Sebbene l'ambito hello VM1-gruppo, viene selezionata se hello NIC è una subnet efficace NSG, output di hello verranno visualizzati entrambi NSGs.</span><span class="sxs-lookup"><span data-stu-id="db444-197">Although hello scope is selected as VM1-nsg, if hello NIC has an effective subnet NSG, hello output will show both NSGs.</span></span>
4. <span data-ttu-id="db444-198">È possibile modificare direttamente le regole per i gruppi di sicurezza di rete associati a un'interfaccia di rete o a una subnet.</span><span class="sxs-lookup"><span data-stu-id="db444-198">You can directly edit rules for NSGs associated with a NIC or subnet.</span></span> <span data-ttu-id="db444-199">toolearn, vedere passaggio 8 di hello **visualizzare le regole di sicurezza efficace per una macchina virtuale** sezione di questo articolo.</span><span class="sxs-lookup"><span data-stu-id="db444-199">toolearn how, read step 8 of hello **View effective security rules for a virtual machine** section of this article.</span></span>

<span data-ttu-id="db444-200">altre informazioni sulle toolearn hello informazioni aggiuntive visualizzate, leggere passaggio 6 di hello **visualizzare le regole di sicurezza efficace per una macchina virtuale** sezione di questo articolo.</span><span class="sxs-lookup"><span data-stu-id="db444-200">toolearn more about hello additional information shown, read step 6 of hello **View effective security rules for a virtual machine** section of this article.</span></span>

> [!NOTE]
> <span data-ttu-id="db444-201">Sebbene ogni una subnet e la scheda di rete può avere un solo gruppo applicato toothem, un gruppo può essere associato toomultiple NIC e più subnet.</span><span class="sxs-lookup"><span data-stu-id="db444-201">Though a subnet and NIC can each have only one NSG applied toothem, an NSG can be associated toomultiple NICs and multiple subnets.</span></span>
> 
> 

## <a name="considerations"></a><span data-ttu-id="db444-202">Considerazioni</span><span class="sxs-lookup"><span data-stu-id="db444-202">Considerations</span></span>
<span data-ttu-id="db444-203">Prendere in considerazione hello seguenti punti durante la risoluzione dei problemi di connettività:</span><span class="sxs-lookup"><span data-stu-id="db444-203">Consider hello following points when troubleshooting connectivity problems:</span></span>

* <span data-ttu-id="db444-204">Regole predefinite di NSG bloccherà l'accesso in ingresso da hello internet e solo Consenti rete virtuale il traffico in ingresso.</span><span class="sxs-lookup"><span data-stu-id="db444-204">Default NSG rules will block inbound access from hello internet and only permit VNet inbound traffic.</span></span> <span data-ttu-id="db444-205">Le regole devono essere aggiunto esplicitamente tooallow accesso in entrata da Internet, come richiesto.</span><span class="sxs-lookup"><span data-stu-id="db444-205">Rules should be explicitly added tooallow inbound access from Internet, as required.</span></span>
* <span data-ttu-id="db444-206">Se non sono presenti regole di sicurezza gruppo causando toofail connettività di rete della macchina virtuale, problema di hello può essere dovuto a:</span><span class="sxs-lookup"><span data-stu-id="db444-206">If there are no NSG security rules causing a VM’s network connectivity toofail, hello problem may be due to:</span></span>
  * <span data-ttu-id="db444-207">Software di firewall in esecuzione all'interno del sistema operativo della macchina virtuale di hello</span><span class="sxs-lookup"><span data-stu-id="db444-207">Firewall software running within hello VM's operating system</span></span>
  * <span data-ttu-id="db444-208">Route configurate per appliance virtuali o traffico locale.</span><span class="sxs-lookup"><span data-stu-id="db444-208">Routes configured for virtual appliances or on-premises traffic.</span></span> <span data-ttu-id="db444-209">Il traffico Internet può essere reindirizzati tooon locali tramite il tunneling forzato.</span><span class="sxs-lookup"><span data-stu-id="db444-209">Internet traffic can be redirected tooon-premises via forced-tunneling.</span></span> <span data-ttu-id="db444-210">Una connessione RDP/SSH da hello Internet tooyour macchina virtuale potrebbe non funzionare con questa impostazione, a seconda di come hardware di rete locale hello gestisce tale traffico.</span><span class="sxs-lookup"><span data-stu-id="db444-210">An RDP/SSH connection from hello Internet tooyour VM may not work with this setting, depending on how hello on-premises network hardware handles this traffic.</span></span> <span data-ttu-id="db444-211">Hello lettura [risoluzione dei problemi delle route](virtual-network-routes-troubleshoot-powershell.md) toolearn articolo come problemi di route toodiagnose che potrebbero ostacolare hello flusso del traffico in e out di hello macchina virtuale.</span><span class="sxs-lookup"><span data-stu-id="db444-211">Read hello [Troubleshooting Routes](virtual-network-routes-troubleshoot-powershell.md) article toolearn how toodiagnose route problems that may be impeding hello flow of traffic in and out of hello VM.</span></span> 
* <span data-ttu-id="db444-212">Se si dispongano di peering reti virtuali, per impostazione predefinita, hello tag VIRTUAL_NETWORK espanderà automaticamente i prefissi tooinclude per il peering reti virtuali.</span><span class="sxs-lookup"><span data-stu-id="db444-212">If you have peered VNets, by default, hello VIRTUAL_NETWORK tag will automatically expand tooinclude prefixes for peered VNets.</span></span> <span data-ttu-id="db444-213">È possibile visualizzare tali prefissi nella hello **ExpandedAddressPrefix** elencare, tootroubleshoot qualsiasi tooVNet correlate a problemi peering di connettività.</span><span class="sxs-lookup"><span data-stu-id="db444-213">You can view these prefixes in hello **ExpandedAddressPrefix** list, tootroubleshoot any issues related tooVNet peering connectivity.</span></span> 
* <span data-ttu-id="db444-214">Le regole di sicurezza efficace vengono visualizzate solo se è che un gruppo associato della macchina virtuale di hello NIC e o una subnet.</span><span class="sxs-lookup"><span data-stu-id="db444-214">Effective security rules are only shown if there is an NSG associated with hello VM’s NIC and or subnet.</span></span> 
* <span data-ttu-id="db444-215">Se non sono non NSGs associato hello NIC o subnet e si dispone di un indirizzo IP pubblico assegnato tooyour VM, tutte le porte sarà aperte per l'accesso in ingresso e in uscita.</span><span class="sxs-lookup"><span data-stu-id="db444-215">If there are no NSGs associated with hello NIC or subnet and you have a public IP address assigned tooyour VM, all ports will be open for inbound and outbound access.</span></span> <span data-ttu-id="db444-216">Se hello macchina virtuale ha un indirizzo IP pubblico, l'applicazione NSGs toohello NIC o una subnet è consigliabile.</span><span class="sxs-lookup"><span data-stu-id="db444-216">If hello VM has a public IP address, applying NSGs toohello NIC or subnet is strongly recommended.</span></span>

