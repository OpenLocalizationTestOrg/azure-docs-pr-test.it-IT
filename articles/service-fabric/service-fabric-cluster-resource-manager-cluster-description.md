---
title: Descrizione del Cluster di gestione risorse aaaCluster | Documenti Microsoft
description: "Che descrive un cluster di Service Fabric specificando i domini di errore, domini di aggiornamento, le proprietà del nodo e le capacità dei nodi di hello gestione delle risorse Cluster."
services: service-fabric
documentationcenter: .net
author: masnider
manager: timlt
editor: 
ms.assetid: 55f8ab37-9399-4c9a-9e6c-d2d859de6766
ms.service: Service-Fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 08/18/2017
ms.author: masnider
ms.openlocfilehash: f2822075976bd54402af5ad56991b5b360dfb1d8
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/06/2017
---
# <a name="describing-a-service-fabric-cluster"></a><span data-ttu-id="a5f80-103">Descrizione di un cluster di Service Fabric</span><span class="sxs-lookup"><span data-stu-id="a5f80-103">Describing a service fabric cluster</span></span>
<span data-ttu-id="a5f80-104">Hello servizio di gestione delle risorse Cluster dell'infrastruttura offre diversi meccanismi per la descrizione di un cluster.</span><span class="sxs-lookup"><span data-stu-id="a5f80-104">hello Service Fabric Cluster Resource Manager provides several mechanisms for describing a cluster.</span></span> <span data-ttu-id="a5f80-105">Durante la fase di esecuzione, hello gestione delle risorse Cluster utilizza questa informazioni tooensure un'elevata disponibilità dei servizi di hello in esecuzione nel cluster hello.</span><span class="sxs-lookup"><span data-stu-id="a5f80-105">During runtime, hello Cluster Resource Manager uses this information tooensure high availability of hello services running in hello cluster.</span></span> <span data-ttu-id="a5f80-106">Durante l'applicazione di queste regole importanti, tenta anche l'utilizzo delle risorse hello toooptimize all'interno di cluster hello.</span><span class="sxs-lookup"><span data-stu-id="a5f80-106">While enforcing these important rules, it also attempts toooptimize hello resource consumption within hello cluster.</span></span>

## <a name="key-concepts"></a><span data-ttu-id="a5f80-107">Concetti chiave</span><span class="sxs-lookup"><span data-stu-id="a5f80-107">Key concepts</span></span>
<span data-ttu-id="a5f80-108">Hello gestione delle risorse Cluster supporta numerose funzioni che descrivono un cluster:</span><span class="sxs-lookup"><span data-stu-id="a5f80-108">hello Cluster Resource Manager supports several features that describe a cluster:</span></span>

* <span data-ttu-id="a5f80-109">Domini di errore</span><span class="sxs-lookup"><span data-stu-id="a5f80-109">Fault Domains</span></span>
* <span data-ttu-id="a5f80-110">Domini di aggiornamento</span><span class="sxs-lookup"><span data-stu-id="a5f80-110">Upgrade Domains</span></span>
* <span data-ttu-id="a5f80-111">Proprietà del nodo</span><span class="sxs-lookup"><span data-stu-id="a5f80-111">Node Properties</span></span>
* <span data-ttu-id="a5f80-112">Capacità del nodo</span><span class="sxs-lookup"><span data-stu-id="a5f80-112">Node Capacities</span></span>

## <a name="fault-domains"></a><span data-ttu-id="a5f80-113">Domini di errore</span><span class="sxs-lookup"><span data-stu-id="a5f80-113">Fault domains</span></span>
<span data-ttu-id="a5f80-114">Un dominio di errore è un'area di errore coordinato.</span><span class="sxs-lookup"><span data-stu-id="a5f80-114">A Fault Domain is any area of coordinated failure.</span></span> <span data-ttu-id="a5f80-115">Un singolo computer è un dominio di errore (dal momento che può avere esito negativo nel proprio per vari motivi, dal firmware NIC power alimentatore errori toodrive errori toobad).</span><span class="sxs-lookup"><span data-stu-id="a5f80-115">A single machine is a Fault Domain (since it can fail on its own for various reasons, from power supply failures toodrive failures toobad NIC firmware).</span></span> <span data-ttu-id="a5f80-116">Connesso toohello stesso commutatore Ethernet presenti hello stesso dominio di errore, come i computer sono macchine la condivisione di una singola origine di energia elettrica o in un'unica posizione.</span><span class="sxs-lookup"><span data-stu-id="a5f80-116">Machines connected toohello same Ethernet switch are in hello same Fault Domain, as are machines sharing a single source of power or in a single location.</span></span> <span data-ttu-id="a5f80-117">Poiché è naturale che toooverlap errori hardware, i domini di errore sono intrinsecamente gerarchici e sono rappresentati come URI di Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="a5f80-117">Since it's natural for hardware faults toooverlap, Fault Domains are inherently hierarchal and are represented as URIs in Service Fabric.</span></span>

<span data-ttu-id="a5f80-118">È importante che i domini di errore siano impostati correttamente poiché Service Fabric utilizza servizi di posizione toosafely questa informazioni.</span><span class="sxs-lookup"><span data-stu-id="a5f80-118">It is important that Fault Domains are set up correctly since Service Fabric uses this information toosafely place services.</span></span> <span data-ttu-id="a5f80-119">Service Fabric non desidera tooplace services tale perdita hello di un dominio di errore (a causa di errore hello di qualche componente) fa sì che un servizio toogo verso il basso.</span><span class="sxs-lookup"><span data-stu-id="a5f80-119">Service Fabric doesn't want tooplace services such that hello loss of a Fault Domain (caused by hello failure of some component) causes a service toogo down.</span></span> <span data-ttu-id="a5f80-120">In ambiente Azure Service Fabric utilizza informazioni di dominio di errore hello fornite da hello ambiente toocorrectly hello configurare nodi hello hello cluster per conto dell'utente.</span><span class="sxs-lookup"><span data-stu-id="a5f80-120">In hello Azure environment Service Fabric uses hello Fault Domain information provided by hello environment toocorrectly configure hello nodes in hello cluster on your behalf.</span></span> <span data-ttu-id="a5f80-121">Per il servizio Fabric autonomo, i domini di errore vengono definite in fase di hello tale cluster hello è impostato</span><span class="sxs-lookup"><span data-stu-id="a5f80-121">For Service Fabric Standalone, Fault Domains are defined at hello time that hello cluster is set up</span></span> 

> [!WARNING]
> <span data-ttu-id="a5f80-122">È importante che le informazioni di dominio di errore hello fornito tooService dell'infrastruttura sia corrette.</span><span class="sxs-lookup"><span data-stu-id="a5f80-122">It is important that hello Fault Domain information provided tooService Fabric is accurate.</span></span> <span data-ttu-id="a5f80-123">Si supponga, ad esempio, che i nodi del cluster di Service Fabric siano in esecuzione all'interno di dieci macchine virtuali, a loro volta in esecuzione su cinque host fisici.</span><span class="sxs-lookup"><span data-stu-id="a5f80-123">For example, let's say that your Service Fabric cluster's nodes are running inside 10 virtual machines, running on five physical hosts.</span></span> <span data-ttu-id="a5f80-124">In questo caso, anche se sono presenti dieci macchine virtuali, sono presenti solo cinque domini di errore diversi (livello superiore).</span><span class="sxs-lookup"><span data-stu-id="a5f80-124">In this case, even though there are 10 virtual machines, there's only 5 different (top level) fault domains.</span></span> <span data-ttu-id="a5f80-125">Condivisione hello nello stesso host fisico fa sì che le macchine virtuali tooshare hello stesso dominio di errore di radice, poiché le macchine virtuali esperienza hello coordinato errore se ha esito negativo dell'host fisico.</span><span class="sxs-lookup"><span data-stu-id="a5f80-125">Sharing hello same physical host causes VMs tooshare hello same root fault domain, since hello VMs experience coordinated failure if their physical host fails.</span></span>  
>
> <span data-ttu-id="a5f80-126">Poiché Service Fabric prevede che il dominio di errore di un nodo non toochange hello.</span><span class="sxs-lookup"><span data-stu-id="a5f80-126">Since Service Fabric expects hello Fault Domain of a node not toochange.</span></span> <span data-ttu-id="a5f80-127">Altri meccanismi di garantire la disponibilità elevata di hello macchine virtuali, ad esempio [macchine virtuali a disponibilità elevata](https://technet.microsoft.com/en-us/library/cc967323.aspx), utilizzare transparent migrazione di macchine virtuali da un host tooanother.</span><span class="sxs-lookup"><span data-stu-id="a5f80-127">Other mechanisms of ensuring high availability of hello VMs, such as [HA-VMs](https://technet.microsoft.com/en-us/library/cc967323.aspx), use transparent migration of VMs from one host tooanother.</span></span> <span data-ttu-id="a5f80-128">Questi meccanismi non riconfigurare o notificare hello in esecuzione di codice all'interno di hello macchina virtuale.</span><span class="sxs-lookup"><span data-stu-id="a5f80-128">These mechanisms do not reconfigure or notify hello running code inside hello VM.</span></span> <span data-ttu-id="a5f80-129">Di conseguenza, **non sono supportati** come ambienti per l'esecuzione dei cluster di Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="a5f80-129">As such, they are **not supported** as environments for running Service Fabric clusters.</span></span> <span data-ttu-id="a5f80-130">Service Fabric deve essere utilizzata la tecnologia hello solo a disponibilità elevata.</span><span class="sxs-lookup"><span data-stu-id="a5f80-130">Service Fabric should be hello only high-availability technology employed.</span></span> <span data-ttu-id="a5f80-131">Non sono necessari meccanismi quali la migrazione in tempo reale della macchina virtuale, SAN, o altri.</span><span class="sxs-lookup"><span data-stu-id="a5f80-131">Mechanisms like live VM migration, SANs, or others are not necessary.</span></span> <span data-ttu-id="a5f80-132">Se usati insieme a Service Fabric, questi meccanismi _riducono_ la disponibilità e l'affidabilità dell'applicazione, poiché introducono complessità aggiuntive, aggiungono origini centralizzate di errore e usano strategie di disponibilità e affidabilità che possono entrare in conflitto con quelle presenti in Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="a5f80-132">If used in conjunction with Service Fabric, these mechanisms _reduce_ application availability and reliability because they introduce additional complexity, add centralized sources of failure, and utilize reliability and availability strategies that conflict with those in Service Fabric.</span></span> 
>
>

<span data-ttu-id="a5f80-133">Nella figura seguente hello è di colore tutte le entità hello che contribuiscono a domini tooFault ed elenco che tutti hello diversi domini di errore risultanti.</span><span class="sxs-lookup"><span data-stu-id="a5f80-133">In hello graphic below we color all hello entities that contribute tooFault Domains and list all hello different Fault Domains that result.</span></span> <span data-ttu-id="a5f80-134">In questo esempio sono presenti data center ("DC"), rack ("R") e pannelli ("B").</span><span class="sxs-lookup"><span data-stu-id="a5f80-134">In this example, we have datacenters ("DC"), racks ("R"), and blades ("B").</span></span> <span data-ttu-id="a5f80-135">Ovviamente, ogni pannello contiene più di una macchina virtuale, potrebbe verificarsi un altro livello nella gerarchia di dominio di errore hello.</span><span class="sxs-lookup"><span data-stu-id="a5f80-135">Conceivably, if each blade holds more than one virtual machine, there could be another layer in hello Fault Domain hierarchy.</span></span>

<span data-ttu-id="a5f80-136"><center>
![Nodi organizzati tramite domini di errore][Image1]
</center></span><span class="sxs-lookup"><span data-stu-id="a5f80-136"><center>
![Nodes organized via Fault Domains][Image1]
</center></span></span>

<span data-ttu-id="a5f80-137">Durante la fase di esecuzione, hello gestione delle risorse Cluster dell'infrastruttura del servizio prende in considerazione i domini di errore hello cluster hello e piani di layout.</span><span class="sxs-lookup"><span data-stu-id="a5f80-137">During runtime, hello Service Fabric Cluster Resource Manager considers hello Fault Domains in hello cluster and plans layouts.</span></span> <span data-ttu-id="a5f80-138">Hello repliche con state o istanze senza informazioni sullo stato per un determinato servizio vengono distribuite in modo che siano in domini di errore.</span><span class="sxs-lookup"><span data-stu-id="a5f80-138">hello stateful replicas or stateless instances for a given service are distributed so they are in separate Fault Domains.</span></span> <span data-ttu-id="a5f80-139">Distribuzione del servizio hello tra domini di errore assicura la disponibilità di hello del servizio di hello non vengano compromessi quando si verifica un errore di un dominio di errore a qualsiasi livello della gerarchia di hello.</span><span class="sxs-lookup"><span data-stu-id="a5f80-139">Distributing hello service across fault domains ensures hello availability of hello service is not compromised when a Fault Domain fails at any level of hello hierarchy.</span></span>

<span data-ttu-id="a5f80-140">Gestione delle risorse dell'infrastruttura servizio Cluster non è rilevante il numero dei livelli nella gerarchia di dominio di errore hello non esistono.</span><span class="sxs-lookup"><span data-stu-id="a5f80-140">Service Fabric’s Cluster Resource Manager doesn’t care how many layers there are in hello Fault Domain hierarchy.</span></span> <span data-ttu-id="a5f80-141">Tuttavia, viene effettuato tooensure che perdita hello di qualsiasi parte di una gerarchia hello di non avere alcun impatto servizi in esecuzione.</span><span class="sxs-lookup"><span data-stu-id="a5f80-141">However, it tries tooensure that hello loss of any one portion of hello hierarchy doesn’t impact services running in it.</span></span> 

<span data-ttu-id="a5f80-142">È consigliabile se sono presenti hello stesso numero di nodi a ogni livello di profondità in hello gerarchia di dominio di errore.</span><span class="sxs-lookup"><span data-stu-id="a5f80-142">It is best if there are hello same number of nodes at each level of depth in hello Fault Domain hierarchy.</span></span> <span data-ttu-id="a5f80-143">Se hello "struttura" di domini di errore è sbilanciato del cluster, rende più difficile per hello toofigure di gestione delle risorse Cluster out allocazione migliore di hello dei servizi.</span><span class="sxs-lookup"><span data-stu-id="a5f80-143">If hello “tree” of Fault Domains is unbalanced in your cluster, it makes it harder for hello Cluster Resource Manager toofigure out hello best allocation of services.</span></span> <span data-ttu-id="a5f80-144">Layout di domini di errore sbilanciato significa tale perdita hello di alcuni domini disponibilità hello impatto dei servizi a più di altri domini.</span><span class="sxs-lookup"><span data-stu-id="a5f80-144">Imbalanced Fault Domains layouts mean that hello loss of some domains impact hello availability of services more than other domains.</span></span> <span data-ttu-id="a5f80-145">Di conseguenza, viene eliminata in hello gestione delle risorse Cluster tra i due obiettivi: desidera macchine hello toouse nel dominio "elevato" inserendo i servizi su di essi, e si desidera tooplace servizi negli altri domini in modo che la perdita di hello di un dominio non causa problemi.</span><span class="sxs-lookup"><span data-stu-id="a5f80-145">As a result, hello Cluster Resource Manager is torn between two goals: It wants toouse hello machines in that “heavy” domain by placing services on them, and it wants tooplace services in other domains so that hello loss of a domain doesn’t cause problems.</span></span> 

<span data-ttu-id="a5f80-146">Come appaiono i domini sbilanciati?</span><span class="sxs-lookup"><span data-stu-id="a5f80-146">What do imbalanced domains look like?</span></span> <span data-ttu-id="a5f80-147">Nel seguente diagramma hello vengono illustrati due layout diversi cluster.</span><span class="sxs-lookup"><span data-stu-id="a5f80-147">In hello diagram below, we show two different cluster layouts.</span></span> <span data-ttu-id="a5f80-148">Nel primo esempio hello, nodi hello vengono distribuiti uniformemente tra hello domini di errore.</span><span class="sxs-lookup"><span data-stu-id="a5f80-148">In hello first example, hello nodes are distributed evenly across hello Fault Domains.</span></span> <span data-ttu-id="a5f80-149">Nel secondo esempio hello, un dominio di errore ha molte più nodi rispetto hello altri domini di errore.</span><span class="sxs-lookup"><span data-stu-id="a5f80-149">In hello second example, one Fault Domain has many more nodes than hello other Fault Domains.</span></span> 

<span data-ttu-id="a5f80-150"><center>
![Due layout diversi per i cluster][Image2]
</center></span><span class="sxs-lookup"><span data-stu-id="a5f80-150"><center>
![Two different cluster layouts][Image2]
</center></span></span>

<span data-ttu-id="a5f80-151">In Azure, scelta hello del quale dominio di errore contiene un nodo viene gestita.</span><span class="sxs-lookup"><span data-stu-id="a5f80-151">In Azure, hello choice of which Fault Domain contains a node is managed for you.</span></span> <span data-ttu-id="a5f80-152">Tuttavia, in base al numero di hello di nodi che si esegue il provisioning è comunque possibile avere con domini di errore con più nodi in essi contenuti rispetto ad altri utenti.</span><span class="sxs-lookup"><span data-stu-id="a5f80-152">However, depending on hello number of nodes that you provision you can still end up with Fault Domains with more nodes in them than others.</span></span> <span data-ttu-id="a5f80-153">Ad esempio, si dispone di cinque domini di errore in cluster hello ma eseguire il provisioning di sette nodi per un determinato tipo di nodo.</span><span class="sxs-lookup"><span data-stu-id="a5f80-153">For example, say you have five Fault Domains in hello cluster but provision seven nodes for a given NodeType.</span></span> <span data-ttu-id="a5f80-154">In questo caso, hello innanzitutto due domini di errore finire con più nodi.</span><span class="sxs-lookup"><span data-stu-id="a5f80-154">In this case, hello first two Fault Domains end up with more nodes.</span></span> <span data-ttu-id="a5f80-155">Se si continua toodeploy ulteriori NodeTypes con solo due istanze, problema hello Ottiene peggiore.</span><span class="sxs-lookup"><span data-stu-id="a5f80-155">If you continue toodeploy more NodeTypes with only a couple instances, hello problem gets worse.</span></span> <span data-ttu-id="a5f80-156">Per questo motivo, è consigliabile che hello numero di nodi in ogni tipo di nodo è un multiplo del numero di hello di domini di errore.</span><span class="sxs-lookup"><span data-stu-id="a5f80-156">For this reason it's recommended that hello number of nodes in each node type is a multiple of hello number of Fault Domains.</span></span>

## <a name="upgrade-domains"></a><span data-ttu-id="a5f80-157">Domini di aggiornamento</span><span class="sxs-lookup"><span data-stu-id="a5f80-157">Upgrade domains</span></span>
<span data-ttu-id="a5f80-158">Domini di aggiornamento sono un'altra caratteristica che consente di hello servizio di gestione delle risorse Cluster dell'infrastruttura comprendere il layout di hello del cluster di hello.</span><span class="sxs-lookup"><span data-stu-id="a5f80-158">Upgrade Domains are another feature that helps hello Service Fabric Cluster Resource Manager understand hello layout of hello cluster.</span></span> <span data-ttu-id="a5f80-159">Domini di aggiornamento definiscono set di nodi che vengono aggiornati in hello contemporaneamente.</span><span class="sxs-lookup"><span data-stu-id="a5f80-159">Upgrade Domains define sets of nodes that are upgraded at hello same time.</span></span> <span data-ttu-id="a5f80-160">Guida hello, gestione delle risorse Cluster comprendere e orchestrare le operazioni di gestione come gli aggiornamenti di domini di aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="a5f80-160">Upgrade Domains help hello Cluster Resource Manager understand and orchestrate management operations like upgrades.</span></span>

<span data-ttu-id="a5f80-161">I domini di aggiornamento sono molto simili ai domini di errore, ma con un paio di differenze essenziali.</span><span class="sxs-lookup"><span data-stu-id="a5f80-161">Upgrade Domains are a lot like Fault Domains, but with a couple key differences.</span></span> <span data-ttu-id="a5f80-162">Innanzitutto, i domini di errore vengono definiti da aree di errori hardware coordinati.</span><span class="sxs-lookup"><span data-stu-id="a5f80-162">First, areas of coordinated hardware failures define Fault Domains.</span></span> <span data-ttu-id="a5f80-163">Domini di aggiornamento, in hello invece, vengono definiti dai criteri.</span><span class="sxs-lookup"><span data-stu-id="a5f80-163">Upgrade Domains, on hello other hand, are defined by policy.</span></span> <span data-ttu-id="a5f80-164">Viene visualizzato il numero desiderato, invece, la dettatura dall'ambiente hello toodecide.</span><span class="sxs-lookup"><span data-stu-id="a5f80-164">You get toodecide how many you want, rather than it being dictated by hello environment.</span></span> <span data-ttu-id="a5f80-165">È possibile disporre dello stesso numero di domini di aggiornamento e di nodi.</span><span class="sxs-lookup"><span data-stu-id="a5f80-165">You could have as many Upgrade Domains as you do nodes.</span></span> <span data-ttu-id="a5f80-166">Un'altra differenza tra i domini di errore e i domini di aggiornamento è che questi ultimi non sono gerarchici.</span><span class="sxs-lookup"><span data-stu-id="a5f80-166">Another difference between Fault Domains and Upgrade Domains is that Upgrade Domains are not hierarchical.</span></span> <span data-ttu-id="a5f80-167">Sono invece più simili a un semplice tag.</span><span class="sxs-lookup"><span data-stu-id="a5f80-167">Instead, they are more like a simple tag.</span></span> 

<span data-ttu-id="a5f80-168">Hello diagramma seguente mostra tre che domini di aggiornamento sono suddivisi in tre domini di errore.</span><span class="sxs-lookup"><span data-stu-id="a5f80-168">hello following diagram shows three Upgrade Domains are striped across three Fault Domains.</span></span> <span data-ttu-id="a5f80-169">Illustra anche una sola posizione possibile per tre repliche diverse di un servizio con stato, dove ciascuna finisce in diversi domini di errore e di aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="a5f80-169">It also shows one possible placement for three different replicas of a stateful service, where each ends up in different Fault and Upgrade Domains.</span></span> <span data-ttu-id="a5f80-170">Questa posizione consente perdita hello di un dominio di errore in intermedio hello di un aggiornamento del servizio e ancora una copia di codice hello e i dati.</span><span class="sxs-lookup"><span data-stu-id="a5f80-170">This placement allows hello loss of a Fault Domain while in hello middle of a service upgrade and still have one copy of hello code and data.</span></span>  

<span data-ttu-id="a5f80-171"><center>
![Posizionamento con domini di errore e di aggiornamento][Image3]
</center></span><span class="sxs-lookup"><span data-stu-id="a5f80-171"><center>
![Placement With Fault and Upgrade Domains][Image3]
</center></span></span>

<span data-ttu-id="a5f80-172">Esistono vantaggi e svantaggi toohaving un numero elevato di domini di aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="a5f80-172">There are pros and cons toohaving large numbers of Upgrade Domains.</span></span> <span data-ttu-id="a5f80-173">Più domini di aggiornamento significa che ogni passaggio dell'aggiornamento hello più granulare e pertanto influisce su un numero minore di nodi o servizi.</span><span class="sxs-lookup"><span data-stu-id="a5f80-173">More Upgrade Domains means each step of hello upgrade is more granular and therefore affects a smaller number of nodes or services.</span></span> <span data-ttu-id="a5f80-174">Di conseguenza, i servizi meno hanno toomove contemporaneamente, introduzione meno varianza nel sistema hello.</span><span class="sxs-lookup"><span data-stu-id="a5f80-174">As a result, fewer services have toomove at a time, introducing less churn into hello system.</span></span> <span data-ttu-id="a5f80-175">Questa impostazione tende tooimprove affidabilità, poiché è minore del servizio hello è interessato da qualsiasi problema introdotto durante l'aggiornamento di hello.</span><span class="sxs-lookup"><span data-stu-id="a5f80-175">This tends tooimprove reliability, since less of hello service is impacted by any issue introduced during hello upgrade.</span></span> <span data-ttu-id="a5f80-176">Più domini di aggiornamento significa anche che è necessario meno buffer disponibile sull'impatto di hello toohandle altri nodi di hello eseguire l'aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="a5f80-176">More Upgrade Domains also means that you need less available buffer on other nodes toohandle hello impact of hello upgrade.</span></span> <span data-ttu-id="a5f80-177">Ad esempio, se si dispone di cinque domini di aggiornamento, i nodi di hello in ogni gestisce circa 20% del traffico.</span><span class="sxs-lookup"><span data-stu-id="a5f80-177">For example, if you have five Upgrade Domains, hello nodes in each are handling roughly 20% of your traffic.</span></span> <span data-ttu-id="a5f80-178">Se è necessario tootake verso il basso tale dominio di aggiornamento per un aggiornamento, il carico deve in genere toogo in un punto.</span><span class="sxs-lookup"><span data-stu-id="a5f80-178">If you need tootake down that Upgrade Domain for an upgrade, that load usually needs toogo somewhere.</span></span> <span data-ttu-id="a5f80-179">Poiché si dispone di quattro domini di aggiornamento rimanenti, ogni deve disporre di spazio per circa il 5% di traffico totale hello.</span><span class="sxs-lookup"><span data-stu-id="a5f80-179">Since you have four remaining Upgrade Domains, each must have room for about 5% of hello total traffic.</span></span> <span data-ttu-id="a5f80-180">Più domini di aggiornamento, che sono necessari meno buffer su nodi hello hello cluster.</span><span class="sxs-lookup"><span data-stu-id="a5f80-180">More Upgrade Domains means you need less buffer on hello nodes in hello cluster.</span></span> <span data-ttu-id="a5f80-181">Si consideri, ad esempio, di disporre invece di dieci domini di aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="a5f80-181">For example, consider if you had 10 Upgrade Domains instead.</span></span> <span data-ttu-id="a5f80-182">In tal caso, ogni UD verrebbe solo gestito circa il 10% del traffico totale hello.</span><span class="sxs-lookup"><span data-stu-id="a5f80-182">In that case, each UD would only be handling about 10% of hello total traffic.</span></span> <span data-ttu-id="a5f80-183">Quando un aggiornamento esaminato cluster hello, ogni dominio sufficiente spazio toohave per circa 1.1% del traffico totale hello.</span><span class="sxs-lookup"><span data-stu-id="a5f80-183">When an upgrade steps through hello cluster, each domain would only need toohave room for about 1.1% of hello total traffic.</span></span> <span data-ttu-id="a5f80-184">Più domini di aggiornamento consentono in genere toorun i nodi con un utilizzo superiore, poiché è necessaria una capacità riservata minore.</span><span class="sxs-lookup"><span data-stu-id="a5f80-184">More Upgrade Domains generally allow you toorun your nodes at higher utilization, since you need less reserved capacity.</span></span> <span data-ttu-id="a5f80-185">Hello stesso vale per i domini di errore.</span><span class="sxs-lookup"><span data-stu-id="a5f80-185">hello same is true for Fault Domains.</span></span>  

<span data-ttu-id="a5f80-186">svantaggio Hello di disporre di molti domini di aggiornamento è che gli aggiornamenti tendono tootake più lungo.</span><span class="sxs-lookup"><span data-stu-id="a5f80-186">hello downside of having many Upgrade Domains is that upgrades tend tootake longer.</span></span> <span data-ttu-id="a5f80-187">Service Fabric attende un breve periodo di tempo dopo un aggiornamento del dominio viene completato ed esegue i controlli prima di avviare tooupgrade hello successivo.</span><span class="sxs-lookup"><span data-stu-id="a5f80-187">Service Fabric waits a short period of time after an Upgrade Domain is completed and performs checks before starting tooupgrade hello next one.</span></span> <span data-ttu-id="a5f80-188">I ritardi consentono di rilevare i problemi introdotti dall'aggiornamento hello prima di avviare l'aggiornamento di hello.</span><span class="sxs-lookup"><span data-stu-id="a5f80-188">These delays enable detecting issues introduced by hello upgrade before hello upgrade proceeds.</span></span> <span data-ttu-id="a5f80-189">compromesso di Hello è accettabile in quanto impedisce le modifiche non valide di che interessano una quantità eccessiva servizio hello alla volta.</span><span class="sxs-lookup"><span data-stu-id="a5f80-189">hello tradeoff is acceptable because it prevents bad changes from affecting too much of hello service at a time.</span></span>

<span data-ttu-id="a5f80-190">Anche l'uso di un numero troppo ridotto di domini di aggiornamento ha effetti collaterali negativi: mentre ogni singolo dominio di aggiornamento è inattivo e in fase di aggiornamento, una parte elevata della capacità complessiva non risulta disponibile.</span><span class="sxs-lookup"><span data-stu-id="a5f80-190">Too few Upgrade Domains has many negative side effects – while each individual Upgrade Domain is down and being upgraded a large portion of your overall capacity is unavailable.</span></span> <span data-ttu-id="a5f80-191">Ad esempio, se sono presenti solo tre domini di aggiornamento, 1/3 circa della capacità complessiva del servizio o del cluster non sarà disponibile in un determinato momento.</span><span class="sxs-lookup"><span data-stu-id="a5f80-191">For example, if you only have three Upgrade Domains you are taking down about 1/3 of your overall service or cluster capacity at a time.</span></span> <span data-ttu-id="a5f80-192">Disporre moltissime operazioni del servizio verso il basso in una sola volta non è auspicabile poiché sono presenti toohave una capacità sufficiente rest hello cluster toohandle hello del carico di lavoro.</span><span class="sxs-lookup"><span data-stu-id="a5f80-192">Having so much of your service down at once isn’t desirable since you have toohave enough capacity in hello rest of your cluster toohandle hello workload.</span></span> <span data-ttu-id="a5f80-193">Gestire quel buffer significa che durante il normale funzionamento i nodi avranno minor carico di quanto dovuto.</span><span class="sxs-lookup"><span data-stu-id="a5f80-193">Maintaining that buffer means that during normal operation those nodes are less loaded than they would be otherwise.</span></span> <span data-ttu-id="a5f80-194">In questo modo si aumenta il costo di hello dell'esecuzione del servizio.</span><span class="sxs-lookup"><span data-stu-id="a5f80-194">This increases hello cost of running your service.</span></span>

<span data-ttu-id="a5f80-195">Non vi è alcun limite effettivo toohello numero totale di domini di aggiornamento o di errore in un ambiente o i vincoli in modo che si sovrappongano.</span><span class="sxs-lookup"><span data-stu-id="a5f80-195">There’s no real limit toohello total number of fault or Upgrade Domains in an environment, or constraints on how they overlap.</span></span> <span data-ttu-id="a5f80-196">Ciò premesso, sono disponibili vari modelli comuni:</span><span class="sxs-lookup"><span data-stu-id="a5f80-196">That said, there are several common patterns:</span></span>

- <span data-ttu-id="a5f80-197">Corrispondenza 1:1 fra domini di errore e domini di aggiornamento</span><span class="sxs-lookup"><span data-stu-id="a5f80-197">Fault Domains and Upgrade Domains mapped 1:1</span></span>
- <span data-ttu-id="a5f80-198">Un dominio di aggiornamento per nodo (istanza del sistema operativo fisico o virtuale)</span><span class="sxs-lookup"><span data-stu-id="a5f80-198">One Upgrade Domain per Node (physical or virtual OS instance)</span></span>
- <span data-ttu-id="a5f80-199">Un modello "striping" o "matrice" in domini di errore hello e domini di aggiornamento formano una matrice con computer che eseguono in genere verso il basso diagonali hello</span><span class="sxs-lookup"><span data-stu-id="a5f80-199">A “striped” or “matrix” model where hello Fault Domains and Upgrade Domains form a matrix with machines usually running down hello diagonals</span></span>

<span data-ttu-id="a5f80-200"><center>
![Layout dei domini di errore e di aggiornamento][Image4]
</center></span><span class="sxs-lookup"><span data-stu-id="a5f80-200"><center>
![Fault and Upgrade Domain Layouts][Image4]
</center></span></span>

<span data-ttu-id="a5f80-201">Non esiste che alcun meglio non risposta toochoose quali layout, ognuno presenta vantaggi e svantaggi.</span><span class="sxs-lookup"><span data-stu-id="a5f80-201">There’s no best answer which layout toochoose, each has some pros and cons.</span></span> <span data-ttu-id="a5f80-202">Ad esempio modello 1FD:1UD hello è tooset semplice.</span><span class="sxs-lookup"><span data-stu-id="a5f80-202">For example, hello 1FD:1UD model is simple tooset up.</span></span> <span data-ttu-id="a5f80-203">Hello dominio di aggiornamento 1 per ogni modello di nodo è più simile a quella vengono utilizzate per le persone.</span><span class="sxs-lookup"><span data-stu-id="a5f80-203">hello 1 Upgrade Domain per Node model is most like what people are used to.</span></span> <span data-ttu-id="a5f80-204">Durante l'aggiornamento, ogni nodo viene aggiornato in modo indipendente.</span><span class="sxs-lookup"><span data-stu-id="a5f80-204">During upgrades each node is updated independently.</span></span> <span data-ttu-id="a5f80-205">Questa operazione è simile toohow piccoli set di computer sono stati aggiornati manualmente in hello precedente.</span><span class="sxs-lookup"><span data-stu-id="a5f80-205">This is similar toohow small sets of machines were upgraded manually in hello past.</span></span> 

<span data-ttu-id="a5f80-206">modello più comune di Hello è una matrice di FD/UD hello, in cui hello domini di errore e domini di aggiornamento formano una tabella e i nodi vengono inseriti a partire lungo hello diagonale.</span><span class="sxs-lookup"><span data-stu-id="a5f80-206">hello most common model is hello FD/UD matrix, where hello FDs and UDs form a table and nodes are placed starting along hello diagonal.</span></span> <span data-ttu-id="a5f80-207">Questo è il modello di hello utilizzato per impostazione predefinita nei cluster di Service Fabric in Azure.</span><span class="sxs-lookup"><span data-stu-id="a5f80-207">This is hello model used by default in Service Fabric clusters in Azure.</span></span> <span data-ttu-id="a5f80-208">Per i cluster con molti nodi di tutti gli elementi finisce simile al modello di matrice di tipo dense hello precedente.</span><span class="sxs-lookup"><span data-stu-id="a5f80-208">For clusters with many nodes everything ends up looking like hello dense matrix pattern above.</span></span>

## <a name="fault-and-upgrade-domain-constraints-and-resulting-behavior"></a><span data-ttu-id="a5f80-209">Vincoli del dominio di errore e di aggiornamento e comportamento risultante</span><span class="sxs-lookup"><span data-stu-id="a5f80-209">Fault and Upgrade Domain constraints and resulting behavior</span></span>
<span data-ttu-id="a5f80-210">Gestione delle risorse Cluster Hello considera desiderio hello tookeep un servizio bilanciato tra domini di errore e l'aggiornamento come vincolo.</span><span class="sxs-lookup"><span data-stu-id="a5f80-210">hello Cluster Resource Manager treats hello desire tookeep a service balanced across fault and Upgrade Domains as a constraint.</span></span> <span data-ttu-id="a5f80-211">È possibile trovare altre informazioni sui vincoli [in questo articolo](service-fabric-cluster-resource-manager-management-integration.md).</span><span class="sxs-lookup"><span data-stu-id="a5f80-211">You can find out more about constraints in [this article](service-fabric-cluster-resource-manager-management-integration.md).</span></span> <span data-ttu-id="a5f80-212">Hello stato vincoli al dominio di aggiornamento e di errore: "per una partizione del servizio specificato non deve mai essere presente una differenza *maggiore di uno* numero hello degli oggetti servizio (istanze del servizio senza stato o le repliche di servizio con stato) tra due domini."</span><span class="sxs-lookup"><span data-stu-id="a5f80-212">hello Fault and Upgrade Domain constraints state: "For a given service partition there should never be a difference *greater than one* in hello number of service objects (stateless service instances or stateful service replicas) between two domains."</span></span> <span data-ttu-id="a5f80-213">Ciò impedisce determinati spostamenti o disposizioni che violano il vincolo.</span><span class="sxs-lookup"><span data-stu-id="a5f80-213">This prevents certain moves or arrangements that violate this constraint.</span></span>

<span data-ttu-id="a5f80-214">Esaminiamo un esempio.</span><span class="sxs-lookup"><span data-stu-id="a5f80-214">Let's look at one example.</span></span> <span data-ttu-id="a5f80-215">Si supponga di avere un cluster con sei nodi, configurato con cinque domini di errore e cinque domini di aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="a5f80-215">Let's say that we have a cluster with six nodes, configured with five Fault Domains and five Upgrade Domains.</span></span>

|  | <span data-ttu-id="a5f80-216">FD0</span><span class="sxs-lookup"><span data-stu-id="a5f80-216">FD0</span></span> | <span data-ttu-id="a5f80-217">FD1</span><span class="sxs-lookup"><span data-stu-id="a5f80-217">FD1</span></span> | <span data-ttu-id="a5f80-218">FD2</span><span class="sxs-lookup"><span data-stu-id="a5f80-218">FD2</span></span> | <span data-ttu-id="a5f80-219">FD3</span><span class="sxs-lookup"><span data-stu-id="a5f80-219">FD3</span></span> | <span data-ttu-id="a5f80-220">FD4</span><span class="sxs-lookup"><span data-stu-id="a5f80-220">FD4</span></span> |
| --- |:---:|:---:|:---:|:---:|:---:|
| <span data-ttu-id="a5f80-221">**UD0**</span><span class="sxs-lookup"><span data-stu-id="a5f80-221">**UD0**</span></span> |<span data-ttu-id="a5f80-222">N1</span><span class="sxs-lookup"><span data-stu-id="a5f80-222">N1</span></span> | | | | |
| <span data-ttu-id="a5f80-223">**UD1**</span><span class="sxs-lookup"><span data-stu-id="a5f80-223">**UD1**</span></span> |<span data-ttu-id="a5f80-224">N6</span><span class="sxs-lookup"><span data-stu-id="a5f80-224">N6</span></span> |<span data-ttu-id="a5f80-225">N2</span><span class="sxs-lookup"><span data-stu-id="a5f80-225">N2</span></span> | | | |
| <span data-ttu-id="a5f80-226">**UD2**</span><span class="sxs-lookup"><span data-stu-id="a5f80-226">**UD2**</span></span> | | |<span data-ttu-id="a5f80-227">N3</span><span class="sxs-lookup"><span data-stu-id="a5f80-227">N3</span></span> | | |
| <span data-ttu-id="a5f80-228">**UD3**</span><span class="sxs-lookup"><span data-stu-id="a5f80-228">**UD3**</span></span> | | | |<span data-ttu-id="a5f80-229">N4</span><span class="sxs-lookup"><span data-stu-id="a5f80-229">N4</span></span> | |
| <span data-ttu-id="a5f80-230">**UD4**</span><span class="sxs-lookup"><span data-stu-id="a5f80-230">**UD4**</span></span> | | | | |<span data-ttu-id="a5f80-231">N5</span><span class="sxs-lookup"><span data-stu-id="a5f80-231">N5</span></span> |

<span data-ttu-id="a5f80-232">Si supponga ora di creare un servizio con TargetReplicaSetSize (oppure, per un servizio senza stato InstanceCount) pari a cinque.</span><span class="sxs-lookup"><span data-stu-id="a5f80-232">Now let's say that we create a service with a TargetReplicaSetSize (or, for a stateless service an InstanceCount) of five.</span></span> <span data-ttu-id="a5f80-233">repliche Hello visualizzata N1 N5.</span><span class="sxs-lookup"><span data-stu-id="a5f80-233">hello replicas land on N1-N5.</span></span> <span data-ttu-id="a5f80-234">N6 non verrà mai usato indipendentemente dal numero di servizi simili creati.</span><span class="sxs-lookup"><span data-stu-id="a5f80-234">In fact, N6 is never used no matter how many services like this you create.</span></span> <span data-ttu-id="a5f80-235">Ma perché?</span><span class="sxs-lookup"><span data-stu-id="a5f80-235">But why?</span></span> <span data-ttu-id="a5f80-236">Diamo un'occhiata differenza hello layout corrente hello e che cosa accadrebbe se si sceglie N6.</span><span class="sxs-lookup"><span data-stu-id="a5f80-236">Let's look at hello difference between hello current layout and what would happen if N6 is chosen.</span></span>

<span data-ttu-id="a5f80-237">Ecco layout hello è ottenuto e hello numero massimo di repliche per ogni errore e dominio di aggiornamento:</span><span class="sxs-lookup"><span data-stu-id="a5f80-237">Here's hello layout we got and hello total number of replicas per Fault and Upgrade Domain:</span></span>

|  | <span data-ttu-id="a5f80-238">FD0</span><span class="sxs-lookup"><span data-stu-id="a5f80-238">FD0</span></span> | <span data-ttu-id="a5f80-239">FD1</span><span class="sxs-lookup"><span data-stu-id="a5f80-239">FD1</span></span> | <span data-ttu-id="a5f80-240">FD2</span><span class="sxs-lookup"><span data-stu-id="a5f80-240">FD2</span></span> | <span data-ttu-id="a5f80-241">FD3</span><span class="sxs-lookup"><span data-stu-id="a5f80-241">FD3</span></span> | <span data-ttu-id="a5f80-242">FD4</span><span class="sxs-lookup"><span data-stu-id="a5f80-242">FD4</span></span> | <span data-ttu-id="a5f80-243">UDTotal</span><span class="sxs-lookup"><span data-stu-id="a5f80-243">UDTotal</span></span> |
| --- |:---:|:---:|:---:|:---:|:---:|:---:|
| <span data-ttu-id="a5f80-244">**UD0**</span><span class="sxs-lookup"><span data-stu-id="a5f80-244">**UD0**</span></span> |<span data-ttu-id="a5f80-245">R1</span><span class="sxs-lookup"><span data-stu-id="a5f80-245">R1</span></span> | | | | |<span data-ttu-id="a5f80-246">1</span><span class="sxs-lookup"><span data-stu-id="a5f80-246">1</span></span> |
| <span data-ttu-id="a5f80-247">**UD1**</span><span class="sxs-lookup"><span data-stu-id="a5f80-247">**UD1**</span></span> | |<span data-ttu-id="a5f80-248">R2</span><span class="sxs-lookup"><span data-stu-id="a5f80-248">R2</span></span> | | | |<span data-ttu-id="a5f80-249">1</span><span class="sxs-lookup"><span data-stu-id="a5f80-249">1</span></span> |
| <span data-ttu-id="a5f80-250">**UD2**</span><span class="sxs-lookup"><span data-stu-id="a5f80-250">**UD2**</span></span> | | |<span data-ttu-id="a5f80-251">R3</span><span class="sxs-lookup"><span data-stu-id="a5f80-251">R3</span></span> | | |<span data-ttu-id="a5f80-252">1</span><span class="sxs-lookup"><span data-stu-id="a5f80-252">1</span></span> |
| <span data-ttu-id="a5f80-253">**UD3**</span><span class="sxs-lookup"><span data-stu-id="a5f80-253">**UD3**</span></span> | | | |<span data-ttu-id="a5f80-254">R4</span><span class="sxs-lookup"><span data-stu-id="a5f80-254">R4</span></span> | |<span data-ttu-id="a5f80-255">1</span><span class="sxs-lookup"><span data-stu-id="a5f80-255">1</span></span> |
| <span data-ttu-id="a5f80-256">**UD4**</span><span class="sxs-lookup"><span data-stu-id="a5f80-256">**UD4**</span></span> | | | | |<span data-ttu-id="a5f80-257">R5</span><span class="sxs-lookup"><span data-stu-id="a5f80-257">R5</span></span> |<span data-ttu-id="a5f80-258">1</span><span class="sxs-lookup"><span data-stu-id="a5f80-258">1</span></span> |
| <span data-ttu-id="a5f80-259">**FDTotal**</span><span class="sxs-lookup"><span data-stu-id="a5f80-259">**FDTotal**</span></span> |<span data-ttu-id="a5f80-260">1</span><span class="sxs-lookup"><span data-stu-id="a5f80-260">1</span></span> |<span data-ttu-id="a5f80-261">1</span><span class="sxs-lookup"><span data-stu-id="a5f80-261">1</span></span> |<span data-ttu-id="a5f80-262">1</span><span class="sxs-lookup"><span data-stu-id="a5f80-262">1</span></span> |<span data-ttu-id="a5f80-263">1</span><span class="sxs-lookup"><span data-stu-id="a5f80-263">1</span></span> |<span data-ttu-id="a5f80-264">1</span><span class="sxs-lookup"><span data-stu-id="a5f80-264">1</span></span> |- |

<span data-ttu-id="a5f80-265">Questo layout è equilibrato in termini di nodi per dominio di errore e dominio di aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="a5f80-265">This layout is balanced in terms of nodes per Fault Domain and Upgrade Domain.</span></span> <span data-ttu-id="a5f80-266">Inoltre viene bilanciato in termini di numero hello di repliche per ogni errore e di aggiornamento del dominio.</span><span class="sxs-lookup"><span data-stu-id="a5f80-266">It is also balanced in terms of hello number of replicas per Fault and Upgrade Domain.</span></span> <span data-ttu-id="a5f80-267">Ogni dominio ha hello stesso numero di nodi e hello stesso numero di repliche.</span><span class="sxs-lookup"><span data-stu-id="a5f80-267">Each domain has hello same number of nodes and hello same number of replicas.</span></span>

<span data-ttu-id="a5f80-268">A questo punto vediamo cosa accadrebbe se usassimo N6 invece di N2.</span><span class="sxs-lookup"><span data-stu-id="a5f80-268">Now, let's look at what would happen if we'd used N6 instead of N2.</span></span> <span data-ttu-id="a5f80-269">Come repliche hello vengono distribuite quindi?</span><span class="sxs-lookup"><span data-stu-id="a5f80-269">How would hello replicas be distributed then?</span></span>

|  | <span data-ttu-id="a5f80-270">FD0</span><span class="sxs-lookup"><span data-stu-id="a5f80-270">FD0</span></span> | <span data-ttu-id="a5f80-271">FD1</span><span class="sxs-lookup"><span data-stu-id="a5f80-271">FD1</span></span> | <span data-ttu-id="a5f80-272">FD2</span><span class="sxs-lookup"><span data-stu-id="a5f80-272">FD2</span></span> | <span data-ttu-id="a5f80-273">FD3</span><span class="sxs-lookup"><span data-stu-id="a5f80-273">FD3</span></span> | <span data-ttu-id="a5f80-274">FD4</span><span class="sxs-lookup"><span data-stu-id="a5f80-274">FD4</span></span> | <span data-ttu-id="a5f80-275">UDTotal</span><span class="sxs-lookup"><span data-stu-id="a5f80-275">UDTotal</span></span> |
| --- |:---:|:---:|:---:|:---:|:---:|:---:|
| <span data-ttu-id="a5f80-276">**UD0**</span><span class="sxs-lookup"><span data-stu-id="a5f80-276">**UD0**</span></span> |<span data-ttu-id="a5f80-277">R1</span><span class="sxs-lookup"><span data-stu-id="a5f80-277">R1</span></span> | | | | |<span data-ttu-id="a5f80-278">1</span><span class="sxs-lookup"><span data-stu-id="a5f80-278">1</span></span> |
| <span data-ttu-id="a5f80-279">**UD1**</span><span class="sxs-lookup"><span data-stu-id="a5f80-279">**UD1**</span></span> |<span data-ttu-id="a5f80-280">R5</span><span class="sxs-lookup"><span data-stu-id="a5f80-280">R5</span></span> | | | | |<span data-ttu-id="a5f80-281">1</span><span class="sxs-lookup"><span data-stu-id="a5f80-281">1</span></span> |
| <span data-ttu-id="a5f80-282">**UD2**</span><span class="sxs-lookup"><span data-stu-id="a5f80-282">**UD2**</span></span> | | |<span data-ttu-id="a5f80-283">R2</span><span class="sxs-lookup"><span data-stu-id="a5f80-283">R2</span></span> | | |<span data-ttu-id="a5f80-284">1</span><span class="sxs-lookup"><span data-stu-id="a5f80-284">1</span></span> |
| <span data-ttu-id="a5f80-285">**UD3**</span><span class="sxs-lookup"><span data-stu-id="a5f80-285">**UD3**</span></span> | | | |<span data-ttu-id="a5f80-286">R3</span><span class="sxs-lookup"><span data-stu-id="a5f80-286">R3</span></span> | |<span data-ttu-id="a5f80-287">1</span><span class="sxs-lookup"><span data-stu-id="a5f80-287">1</span></span> |
| <span data-ttu-id="a5f80-288">**UD4**</span><span class="sxs-lookup"><span data-stu-id="a5f80-288">**UD4**</span></span> | | | | |<span data-ttu-id="a5f80-289">R4</span><span class="sxs-lookup"><span data-stu-id="a5f80-289">R4</span></span> |<span data-ttu-id="a5f80-290">1</span><span class="sxs-lookup"><span data-stu-id="a5f80-290">1</span></span> |
| <span data-ttu-id="a5f80-291">**FDTotal**</span><span class="sxs-lookup"><span data-stu-id="a5f80-291">**FDTotal**</span></span> |<span data-ttu-id="a5f80-292">2</span><span class="sxs-lookup"><span data-stu-id="a5f80-292">2</span></span> |<span data-ttu-id="a5f80-293">0</span><span class="sxs-lookup"><span data-stu-id="a5f80-293">0</span></span> |<span data-ttu-id="a5f80-294">1</span><span class="sxs-lookup"><span data-stu-id="a5f80-294">1</span></span> |<span data-ttu-id="a5f80-295">1</span><span class="sxs-lookup"><span data-stu-id="a5f80-295">1</span></span> |<span data-ttu-id="a5f80-296">1</span><span class="sxs-lookup"><span data-stu-id="a5f80-296">1</span></span> |- |

<span data-ttu-id="a5f80-297">Questo layout viola la definizione per hello vincolo di dominio di errore.</span><span class="sxs-lookup"><span data-stu-id="a5f80-297">This layout violates our definition for hello Fault Domain constraint.</span></span> <span data-ttu-id="a5f80-298">FD0 include due repliche, mentre FD1 include zero, la differenza di hello tra FD0 e FD1 un totale di due.</span><span class="sxs-lookup"><span data-stu-id="a5f80-298">FD0 has two replicas, while FD1 has zero, making hello difference between FD0 and FD1 a total of two.</span></span> <span data-ttu-id="a5f80-299">Hello gestione delle risorse Cluster non consente tale disposizione.</span><span class="sxs-lookup"><span data-stu-id="a5f80-299">hello Cluster Resource Manager does not allow this arrangement.</span></span> <span data-ttu-id="a5f80-300">Allo stesso modo, se si scegliesse N2 e N6 (anziché N1 e N2) si otterrebbe:</span><span class="sxs-lookup"><span data-stu-id="a5f80-300">Similarly if we picked N2 and N6 (instead of N1 and N2) we'd get:</span></span>

|  | <span data-ttu-id="a5f80-301">FD0</span><span class="sxs-lookup"><span data-stu-id="a5f80-301">FD0</span></span> | <span data-ttu-id="a5f80-302">FD1</span><span class="sxs-lookup"><span data-stu-id="a5f80-302">FD1</span></span> | <span data-ttu-id="a5f80-303">FD2</span><span class="sxs-lookup"><span data-stu-id="a5f80-303">FD2</span></span> | <span data-ttu-id="a5f80-304">FD3</span><span class="sxs-lookup"><span data-stu-id="a5f80-304">FD3</span></span> | <span data-ttu-id="a5f80-305">FD4</span><span class="sxs-lookup"><span data-stu-id="a5f80-305">FD4</span></span> | <span data-ttu-id="a5f80-306">UDTotal</span><span class="sxs-lookup"><span data-stu-id="a5f80-306">UDTotal</span></span> |
| --- |:---:|:---:|:---:|:---:|:---:|:---:|
| <span data-ttu-id="a5f80-307">**UD0**</span><span class="sxs-lookup"><span data-stu-id="a5f80-307">**UD0**</span></span> | | | | | |<span data-ttu-id="a5f80-308">0</span><span class="sxs-lookup"><span data-stu-id="a5f80-308">0</span></span> |
| <span data-ttu-id="a5f80-309">**UD1**</span><span class="sxs-lookup"><span data-stu-id="a5f80-309">**UD1**</span></span> |<span data-ttu-id="a5f80-310">R5</span><span class="sxs-lookup"><span data-stu-id="a5f80-310">R5</span></span> |<span data-ttu-id="a5f80-311">R1</span><span class="sxs-lookup"><span data-stu-id="a5f80-311">R1</span></span> | | | |<span data-ttu-id="a5f80-312">2</span><span class="sxs-lookup"><span data-stu-id="a5f80-312">2</span></span> |
| <span data-ttu-id="a5f80-313">**UD2**</span><span class="sxs-lookup"><span data-stu-id="a5f80-313">**UD2**</span></span> | | |<span data-ttu-id="a5f80-314">R2</span><span class="sxs-lookup"><span data-stu-id="a5f80-314">R2</span></span> | | |<span data-ttu-id="a5f80-315">1</span><span class="sxs-lookup"><span data-stu-id="a5f80-315">1</span></span> |
| <span data-ttu-id="a5f80-316">**UD3**</span><span class="sxs-lookup"><span data-stu-id="a5f80-316">**UD3**</span></span> | | | |<span data-ttu-id="a5f80-317">R3</span><span class="sxs-lookup"><span data-stu-id="a5f80-317">R3</span></span> | |<span data-ttu-id="a5f80-318">1</span><span class="sxs-lookup"><span data-stu-id="a5f80-318">1</span></span> |
| <span data-ttu-id="a5f80-319">**UD4**</span><span class="sxs-lookup"><span data-stu-id="a5f80-319">**UD4**</span></span> | | | | |<span data-ttu-id="a5f80-320">R4</span><span class="sxs-lookup"><span data-stu-id="a5f80-320">R4</span></span> |<span data-ttu-id="a5f80-321">1</span><span class="sxs-lookup"><span data-stu-id="a5f80-321">1</span></span> |
| <span data-ttu-id="a5f80-322">**FDTotal**</span><span class="sxs-lookup"><span data-stu-id="a5f80-322">**FDTotal**</span></span> |<span data-ttu-id="a5f80-323">1</span><span class="sxs-lookup"><span data-stu-id="a5f80-323">1</span></span> |<span data-ttu-id="a5f80-324">1</span><span class="sxs-lookup"><span data-stu-id="a5f80-324">1</span></span> |<span data-ttu-id="a5f80-325">1</span><span class="sxs-lookup"><span data-stu-id="a5f80-325">1</span></span> |<span data-ttu-id="a5f80-326">1</span><span class="sxs-lookup"><span data-stu-id="a5f80-326">1</span></span> |<span data-ttu-id="a5f80-327">1</span><span class="sxs-lookup"><span data-stu-id="a5f80-327">1</span></span> |- |

<span data-ttu-id="a5f80-328">Questo layout è bilanciato in termini di domini di errore.</span><span class="sxs-lookup"><span data-stu-id="a5f80-328">This layout is balanced in terms of Fault Domains.</span></span> <span data-ttu-id="a5f80-329">Tuttavia, ora è violano il vincolo di aggiornamento del dominio hello.</span><span class="sxs-lookup"><span data-stu-id="a5f80-329">However, now it's violating hello Upgrade Domain constraint.</span></span> <span data-ttu-id="a5f80-330">Ciò avviene perché UD0 ha zero repliche mentre UD1 ne ha due.</span><span class="sxs-lookup"><span data-stu-id="a5f80-330">This is because UD0 has zero replicas while UD1 has two.</span></span> <span data-ttu-id="a5f80-331">Pertanto, questo layout inoltre non è valido e non verranno utilizzato dal gestore delle risorse Cluster hello.</span><span class="sxs-lookup"><span data-stu-id="a5f80-331">Therefore, this layout is also invalid and won't be picked by hello Cluster Resource Manager.</span></span> 

## <a name="configuring-fault-and-upgrade-domains"></a><span data-ttu-id="a5f80-332">Configurazione dei domini di errore e di aggiornamento</span><span class="sxs-lookup"><span data-stu-id="a5f80-332">Configuring fault and Upgrade Domains</span></span>
<span data-ttu-id="a5f80-333">La definizione dei domini di errore e dei domini di aggiornamento viene eseguita automaticamente nelle distribuzioni di Service Fabric ospitate in Azure.</span><span class="sxs-lookup"><span data-stu-id="a5f80-333">Defining Fault Domains and Upgrade Domains is done automatically in Azure hosted Service Fabric deployments.</span></span> <span data-ttu-id="a5f80-334">Service Fabric preleva e utilizza le informazioni sull'ambiente hello da Azure.</span><span class="sxs-lookup"><span data-stu-id="a5f80-334">Service Fabric picks up and uses hello environment information from Azure.</span></span>

<span data-ttu-id="a5f80-335">Se si sta creando un cluster personale (o toorun una topologia in fase di sviluppo), è possibile fornire informazioni di dominio di errore e dominio di aggiornamento hello.</span><span class="sxs-lookup"><span data-stu-id="a5f80-335">If you’re creating your own cluster (or want toorun a particular topology in development), you can provide hello Fault Domain and Upgrade Domain information yourself.</span></span> <span data-ttu-id="a5f80-336">In questo esempio definiamo un cluster di sviluppo locale con nove nodi che si estende su tre "data center" (ognuno con tre rack).</span><span class="sxs-lookup"><span data-stu-id="a5f80-336">In this example, we define a nine node local development cluster that spans three “datacenters” (each with three racks).</span></span> <span data-ttu-id="a5f80-337">Il cluster ha anche tre domini di aggiornamento distribuiti sui tre data center.</span><span class="sxs-lookup"><span data-stu-id="a5f80-337">This cluster also has three Upgrade Domains striped across those three datacenters.</span></span> <span data-ttu-id="a5f80-338">Di seguito viene riportato un esempio di configurazione hello:</span><span class="sxs-lookup"><span data-stu-id="a5f80-338">An example of hello configuration is below:</span></span> 

<span data-ttu-id="a5f80-339">ClusterManifest.xml</span><span class="sxs-lookup"><span data-stu-id="a5f80-339">ClusterManifest.xml</span></span>

```xml
  <Infrastructure>
    <!-- IsScaleMin indicates that this cluster runs on one-box /one single server -->
    <WindowsServer IsScaleMin="true">
      <NodeList>
        <Node NodeName="Node01" IPAddressOrFQDN="localhost" NodeTypeRef="NodeType01" FaultDomain="fd:/DC01/Rack01" UpgradeDomain="UpgradeDomain1" IsSeedNode="true" />
        <Node NodeName="Node02" IPAddressOrFQDN="localhost" NodeTypeRef="NodeType02" FaultDomain="fd:/DC01/Rack02" UpgradeDomain="UpgradeDomain2" IsSeedNode="true" />
        <Node NodeName="Node03" IPAddressOrFQDN="localhost" NodeTypeRef="NodeType03" FaultDomain="fd:/DC01/Rack03" UpgradeDomain="UpgradeDomain3" IsSeedNode="true" />
        <Node NodeName="Node04" IPAddressOrFQDN="localhost" NodeTypeRef="NodeType04" FaultDomain="fd:/DC02/Rack01" UpgradeDomain="UpgradeDomain1" IsSeedNode="true" />
        <Node NodeName="Node05" IPAddressOrFQDN="localhost" NodeTypeRef="NodeType05" FaultDomain="fd:/DC02/Rack02" UpgradeDomain="UpgradeDomain2" IsSeedNode="true" />
        <Node NodeName="Node06" IPAddressOrFQDN="localhost" NodeTypeRef="NodeType06" FaultDomain="fd:/DC02/Rack03" UpgradeDomain="UpgradeDomain3" IsSeedNode="true" />
        <Node NodeName="Node07" IPAddressOrFQDN="localhost" NodeTypeRef="NodeType07" FaultDomain="fd:/DC03/Rack01" UpgradeDomain="UpgradeDomain1" IsSeedNode="true" />
        <Node NodeName="Node08" IPAddressOrFQDN="localhost" NodeTypeRef="NodeType08" FaultDomain="fd:/DC03/Rack02" UpgradeDomain="UpgradeDomain2" IsSeedNode="true" />
        <Node NodeName="Node09" IPAddressOrFQDN="localhost" NodeTypeRef="NodeType09" FaultDomain="fd:/DC03/Rack03" UpgradeDomain="UpgradeDomain3" IsSeedNode="true" />
      </NodeList>
    </WindowsServer>
  </Infrastructure>
```

<span data-ttu-id="a5f80-340">mediante ClusterConfig.json per le distribuzioni autonome</span><span class="sxs-lookup"><span data-stu-id="a5f80-340">via ClusterConfig.json for Standalone deployments</span></span>

```json
"nodes": [
  {
    "nodeName": "vm1",
    "iPAddress": "localhost",
    "nodeTypeRef": "NodeType0",
    "faultDomain": "fd:/dc1/r0",
    "upgradeDomain": "UD1"
  },
  {
    "nodeName": "vm2",
    "iPAddress": "localhost",
    "nodeTypeRef": "NodeType0",
    "faultDomain": "fd:/dc1/r0",
    "upgradeDomain": "UD2"
  },
  {
    "nodeName": "vm3",
    "iPAddress": "localhost",
    "nodeTypeRef": "NodeType0",
    "faultDomain": "fd:/dc1/r0",
    "upgradeDomain": "UD3"
  },
  {
    "nodeName": "vm4",
    "iPAddress": "localhost",
    "nodeTypeRef": "NodeType0",
    "faultDomain": "fd:/dc2/r0",
    "upgradeDomain": "UD1"
  },
  {
    "nodeName": "vm5",
    "iPAddress": "localhost",
    "nodeTypeRef": "NodeType0",
    "faultDomain": "fd:/dc2/r0",
    "upgradeDomain": "UD2"
  },
  {
    "nodeName": "vm6",
    "iPAddress": "localhost",
    "nodeTypeRef": "NodeType0",
    "faultDomain": "fd:/dc2/r0",
    "upgradeDomain": "UD3"
  },
  {
    "nodeName": "vm7",
    "iPAddress": "localhost",
    "nodeTypeRef": "NodeType0",
    "faultDomain": "fd:/dc3/r0",
    "upgradeDomain": "UD1"
  },
  {
    "nodeName": "vm8",
    "iPAddress": "localhost",
    "nodeTypeRef": "NodeType0",
    "faultDomain": "fd:/dc3/r0",
    "upgradeDomain": "UD2"
  },
  {
    "nodeName": "vm9",
    "iPAddress": "localhost",
    "nodeTypeRef": "NodeType0",
    "faultDomain": "fd:/dc3/r0",
    "upgradeDomain": "UD3"
  }
],
```

> [!NOTE]
> <span data-ttu-id="a5f80-341">Quando si definiscono i cluster con Azure Resource Manager, Azure assegna i domini di errore e i domini di aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="a5f80-341">When defining clusters via Azure Resource Manager, Fault Domains and Upgrade Domains are assigned by Azure.</span></span> <span data-ttu-id="a5f80-342">Pertanto, la definizione di hello di set di scalabilità di macchine virtuali e i tipi di nodo di nel modello di gestione risorse di Azure include informazioni di aggiornamento del dominio o dominio di errore.</span><span class="sxs-lookup"><span data-stu-id="a5f80-342">Therefore, hello definition of your Node Types and Virtual Machine Scale Sets in your Azure Resource Manager template does not include Fault Domain or Upgrade Domain information.</span></span>
>

## <a name="node-properties-and-placement-constraints"></a><span data-ttu-id="a5f80-343">Proprietà dei nodi e vincoli di posizionamento</span><span class="sxs-lookup"><span data-stu-id="a5f80-343">Node properties and placement constraints</span></span>
<span data-ttu-id="a5f80-344">In alcuni casi (in effetti, la maggior parte del tempo di hello) sarà tooensure toowant alcuni carichi di lavoro eseguiti solo in determinati tipi di nodi nel cluster hello.</span><span class="sxs-lookup"><span data-stu-id="a5f80-344">Sometimes (in fact, most of hello time) you’re going toowant tooensure that certain workloads run only on certain types of nodes in hello cluster.</span></span> <span data-ttu-id="a5f80-345">Ad esempio, è possibile che alcuni carichi di lavoro richiedano GPU o SSD, mentre altri no.</span><span class="sxs-lookup"><span data-stu-id="a5f80-345">For example, some workload may require GPUs or SSDs while others may not.</span></span> <span data-ttu-id="a5f80-346">Un ottimo esempio di destinazione i carichi di lavoro di hardware tooparticular è quasi ogni architettura a più livelli disponibili.</span><span class="sxs-lookup"><span data-stu-id="a5f80-346">A great example of targeting hardware tooparticular workloads is almost every n-tier architecture out there.</span></span> <span data-ttu-id="a5f80-347">Alcune macchine fungono hello front-end o l'API del lato dell'applicazione hello e sono esposte toohello client o hello internet.</span><span class="sxs-lookup"><span data-stu-id="a5f80-347">Certain machines serve as hello front end or API serving side of hello application and are exposed toohello clients or hello internet.</span></span> <span data-ttu-id="a5f80-348">Computer diversi, spesso con risorse hardware diverso, gestire il lavoro hello dei livelli di archiviazione o di calcolo hello.</span><span class="sxs-lookup"><span data-stu-id="a5f80-348">Different machines, often with different hardware resources, handle hello work of hello compute or storage layers.</span></span> <span data-ttu-id="a5f80-349">Si tratta in genere _non_ esposto direttamente tooclients o hello internet.</span><span class="sxs-lookup"><span data-stu-id="a5f80-349">These are usually _not_ directly exposed tooclients or hello internet.</span></span> <span data-ttu-id="a5f80-350">Service Fabric è previsto che vi sono casi in cui i carichi di lavoro specifici necessario toorun sulle configurazioni hardware specifico.</span><span class="sxs-lookup"><span data-stu-id="a5f80-350">Service Fabric expects that there are cases where particular workloads need toorun on particular hardware configurations.</span></span> <span data-ttu-id="a5f80-351">ad esempio:</span><span class="sxs-lookup"><span data-stu-id="a5f80-351">For example:</span></span>

* <span data-ttu-id="a5f80-352">Un'applicazione esistente con n livelli è stata "elevata e spostata" in un ambiente Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="a5f80-352">an existing n-tier application has been “lifted and shifted” into a Service Fabric environment</span></span>
* <span data-ttu-id="a5f80-353">un carico di lavoro vuole toorun su hardware specifico per le prestazioni, scalabilità o motivi di isolamento di sicurezza</span><span class="sxs-lookup"><span data-stu-id="a5f80-353">a workload wants toorun on specific hardware for performance, scale, or security isolation reasons</span></span>
* <span data-ttu-id="a5f80-354">Un carico di lavoro deve essere isolato da altri carichi di lavoro per motivi relativi ai criteri o all'uso delle risorse</span><span class="sxs-lookup"><span data-stu-id="a5f80-354">A workload should be isolated from other workloads for policy or resource consumption reasons</span></span>

<span data-ttu-id="a5f80-355">toosupport questi tipi di configurazioni, Service Fabric è una nozione di tag che possono essere applicati toonodes prima classe.</span><span class="sxs-lookup"><span data-stu-id="a5f80-355">toosupport these sorts of configurations, Service Fabric has a first class notion of tags that can be applied toonodes.</span></span> <span data-ttu-id="a5f80-356">Questi tag vengono chiamati **proprietà del nodo**.</span><span class="sxs-lookup"><span data-stu-id="a5f80-356">These tags are called **node properties**.</span></span> <span data-ttu-id="a5f80-357">**Vincoli di posizionamento** sono istruzioni hello associati servizi tooindividual selezionato per uno o più proprietà del nodo.</span><span class="sxs-lookup"><span data-stu-id="a5f80-357">**Placement constraints** are hello statements attached tooindividual services that select for one or more node properties.</span></span> <span data-ttu-id="a5f80-358">Definiscono la posizione in cui i servizi devono essere eseguiti.</span><span class="sxs-lookup"><span data-stu-id="a5f80-358">Placement constraints define where services should run.</span></span> <span data-ttu-id="a5f80-359">Hello set di vincoli è estendibile, può utilizzare qualsiasi coppia chiave/valore.</span><span class="sxs-lookup"><span data-stu-id="a5f80-359">hello set of constraints is extensible - any key/value pair can work.</span></span> 

<span data-ttu-id="a5f80-360"><center>
![Layout di cluster con carichi di lavoro diversi][Image5]
</center></span><span class="sxs-lookup"><span data-stu-id="a5f80-360"><center>
![Cluster Layout Different Workloads][Image5]
</center></span></span>

### <a name="built-in-node-properties"></a><span data-ttu-id="a5f80-361">Proprietà predefinite del nodo</span><span class="sxs-lookup"><span data-stu-id="a5f80-361">Built in node properties</span></span>
<span data-ttu-id="a5f80-362">Service Fabric definisce alcune proprietà di nodo predefinito che può essere utilizzato automaticamente senza utente hello toodefine con essi.</span><span class="sxs-lookup"><span data-stu-id="a5f80-362">Service Fabric defines some default node properties that can be used automatically without hello user having toodefine them.</span></span> <span data-ttu-id="a5f80-363">le proprietà predefinite di Hello definite in ogni nodo sono hello **NodeType** hello e **NodeName**.</span><span class="sxs-lookup"><span data-stu-id="a5f80-363">hello default properties defined at each node are hello **NodeType** and hello **NodeName**.</span></span> <span data-ttu-id="a5f80-364">Ad esempio è possibile scrivere un vincolo di posizionamento come `"(NodeType == NodeType03)"`.</span><span class="sxs-lookup"><span data-stu-id="a5f80-364">So for example you could write a placement constraint as `"(NodeType == NodeType03)"`.</span></span> <span data-ttu-id="a5f80-365">In genere sono stati rilevati NodeType toobe una delle proprietà hello comunemente utilizzato.</span><span class="sxs-lookup"><span data-stu-id="a5f80-365">Generally we have found NodeType toobe one of hello most commonly used properties.</span></span> <span data-ttu-id="a5f80-366">È utile poiché ha una corrispondenza di 1:1 con un tipo di computer.</span><span class="sxs-lookup"><span data-stu-id="a5f80-366">It is useful since it corresponds 1:1 with a type of a machine.</span></span> <span data-ttu-id="a5f80-367">Ogni tipo di computer corrisponde tooa tipo di carico di lavoro in un'applicazione a più livelli tradizionale.</span><span class="sxs-lookup"><span data-stu-id="a5f80-367">Each type of machine corresponds tooa type of workload in a traditional n-tier application.</span></span>

<span data-ttu-id="a5f80-368"><center>
![Vincoli di posizionamento e proprietà dei nodi][Image6]
</center></span><span class="sxs-lookup"><span data-stu-id="a5f80-368"><center>
![Placement Constraints and Node Properties][Image6]
</center></span></span>

## <a name="placement-constraint-and-node-property-syntax"></a><span data-ttu-id="a5f80-369">Vincoli di posizionamento e sintassi delle proprietà dei nodi</span><span class="sxs-lookup"><span data-stu-id="a5f80-369">Placement Constraint and Node Property Syntax</span></span> 
<span data-ttu-id="a5f80-370">il valore di Hello specificato nelle proprietà dei nodi hello può essere una stringa, bool, o una firma lunga.</span><span class="sxs-lookup"><span data-stu-id="a5f80-370">hello value specified in hello node property can be a string, bool, or signed long.</span></span> <span data-ttu-id="a5f80-371">istruzione Hello servizio hello viene chiamato un posizionamento *vincolo* poiché vincola in cui è possibile eseguire il servizio di hello cluster hello.</span><span class="sxs-lookup"><span data-stu-id="a5f80-371">hello statement at hello service is called a placement *constraint* since it constrains where hello service can run in hello cluster.</span></span> <span data-ttu-id="a5f80-372">vincolo Hello può essere qualsiasi istruzione booleana che opera sulle proprietà di nodo diverso hello cluster hello.</span><span class="sxs-lookup"><span data-stu-id="a5f80-372">hello constraint can be any Boolean statement that operates on hello different node properties in hello cluster.</span></span> <span data-ttu-id="a5f80-373">i selettori valido Hello in queste istruzioni booleane sono:</span><span class="sxs-lookup"><span data-stu-id="a5f80-373">hello valid selectors in these boolean statements are:</span></span>

1) <span data-ttu-id="a5f80-374">controlli condizionali per la creazione di istruzioni specifiche</span><span class="sxs-lookup"><span data-stu-id="a5f80-374">conditional checks for creating particular statements</span></span>

| <span data-ttu-id="a5f80-375">Istruzione</span><span class="sxs-lookup"><span data-stu-id="a5f80-375">Statement</span></span> | <span data-ttu-id="a5f80-376">Sintassi</span><span class="sxs-lookup"><span data-stu-id="a5f80-376">Syntax</span></span> |
| --- |:---:|
| <span data-ttu-id="a5f80-377">"uguale a"</span><span class="sxs-lookup"><span data-stu-id="a5f80-377">"equal to"</span></span> | <span data-ttu-id="a5f80-378">"=="</span><span class="sxs-lookup"><span data-stu-id="a5f80-378">"=="</span></span> |
| <span data-ttu-id="a5f80-379">"diverso da"</span><span class="sxs-lookup"><span data-stu-id="a5f80-379">"not equal to"</span></span> | <span data-ttu-id="a5f80-380">"!="</span><span class="sxs-lookup"><span data-stu-id="a5f80-380">"!="</span></span> |
| <span data-ttu-id="a5f80-381">"maggiore di"</span><span class="sxs-lookup"><span data-stu-id="a5f80-381">"greater than"</span></span> | <span data-ttu-id="a5f80-382">">"</span><span class="sxs-lookup"><span data-stu-id="a5f80-382">">"</span></span> |
| <span data-ttu-id="a5f80-383">"maggiore o uguale a"</span><span class="sxs-lookup"><span data-stu-id="a5f80-383">"greater than or equal to"</span></span> | <span data-ttu-id="a5f80-384">">="</span><span class="sxs-lookup"><span data-stu-id="a5f80-384">">="</span></span> |
| <span data-ttu-id="a5f80-385">"minore di"</span><span class="sxs-lookup"><span data-stu-id="a5f80-385">"less than"</span></span> | <span data-ttu-id="a5f80-386">"<"</span><span class="sxs-lookup"><span data-stu-id="a5f80-386">"<"</span></span> |
| <span data-ttu-id="a5f80-387">"minore o uguale a"</span><span class="sxs-lookup"><span data-stu-id="a5f80-387">"less than or equal to"</span></span> | <span data-ttu-id="a5f80-388">"<="</span><span class="sxs-lookup"><span data-stu-id="a5f80-388">"<="</span></span> |

2) <span data-ttu-id="a5f80-389">istruzioni booleane per il raggruppamento e le operazioni logiche</span><span class="sxs-lookup"><span data-stu-id="a5f80-389">boolean statements for grouping and logical operations</span></span>

| <span data-ttu-id="a5f80-390">Istruzione</span><span class="sxs-lookup"><span data-stu-id="a5f80-390">Statement</span></span> | <span data-ttu-id="a5f80-391">Sintassi</span><span class="sxs-lookup"><span data-stu-id="a5f80-391">Syntax</span></span> |
| --- |:---:|
| <span data-ttu-id="a5f80-392">"and"</span><span class="sxs-lookup"><span data-stu-id="a5f80-392">"and"</span></span> | <span data-ttu-id="a5f80-393">"&&"</span><span class="sxs-lookup"><span data-stu-id="a5f80-393">"&&"</span></span> |
| <span data-ttu-id="a5f80-394">"or"</span><span class="sxs-lookup"><span data-stu-id="a5f80-394">"or"</span></span> | <span data-ttu-id="a5f80-395">"&#124;&#124;"</span><span class="sxs-lookup"><span data-stu-id="a5f80-395">"&#124;&#124;"</span></span> |
| <span data-ttu-id="a5f80-396">"not"</span><span class="sxs-lookup"><span data-stu-id="a5f80-396">"not"</span></span> | <span data-ttu-id="a5f80-397">"!"</span><span class="sxs-lookup"><span data-stu-id="a5f80-397">"!"</span></span> |
| <span data-ttu-id="a5f80-398">"raggruppamento come singola istruzione"</span><span class="sxs-lookup"><span data-stu-id="a5f80-398">"group as single statement"</span></span> | <span data-ttu-id="a5f80-399">"()"</span><span class="sxs-lookup"><span data-stu-id="a5f80-399">"()"</span></span> |

<span data-ttu-id="a5f80-400">Di seguito sono riportati alcuni esempi di semplici istruzioni di vincolo.</span><span class="sxs-lookup"><span data-stu-id="a5f80-400">Here are some examples of basic constraint statements.</span></span>

  * `"Value >= 5"`
  * `"NodeColor != green"`
  * `"((OneProperty < 100) || ((AnotherProperty == false) && (OneProperty >= 100)))"`

<span data-ttu-id="a5f80-401">Solo i nodi in cui hello complessiva posizionamento vincolo istruzione restituisce troppo "True" possono avere servizio hello posizionato su di esso.</span><span class="sxs-lookup"><span data-stu-id="a5f80-401">Only nodes where hello overall placement constraint statement evaluates too“True” can have hello service placed on it.</span></span> <span data-ttu-id="a5f80-402">I nodi per i quali sono state definite proprietà non corrispondono ad alcun vincolo di posizionamento che contiene proprietà.</span><span class="sxs-lookup"><span data-stu-id="a5f80-402">Nodes that do not have a property defined do not match any placement constraint containing that property.</span></span>

<span data-ttu-id="a5f80-403">Si supponga che hello successivo nodo proprietà sono state definite per un tipo di nodo specificato:</span><span class="sxs-lookup"><span data-stu-id="a5f80-403">Let’s say that hello following node properties were defined for a given node type:</span></span>

<span data-ttu-id="a5f80-404">ClusterManifest.xml</span><span class="sxs-lookup"><span data-stu-id="a5f80-404">ClusterManifest.xml</span></span>

```xml
    <NodeType Name="NodeType01">
      <PlacementProperties>
        <Property Name="HasSSD" Value="true"/>
        <Property Name="NodeColor" Value="green"/>
        <Property Name="SomeProperty" Value="5"/>
      </PlacementProperties>
    </NodeType>
```

<span data-ttu-id="a5f80-405">mediante ClusterConfig.json per le distribuzioni autonome o Template.json per cluster ospitati in Azure.</span><span class="sxs-lookup"><span data-stu-id="a5f80-405">via ClusterConfig.json for Standalone deployments or Template.json for Azure hosted clusters.</span></span> 

> [!NOTE]
> <span data-ttu-id="a5f80-406">Nel nodo hello Azure Resource Manager modello tipo è in genere con parametri.</span><span class="sxs-lookup"><span data-stu-id="a5f80-406">In your Azure Resource Manager template hello node type is usually parameterized.</span></span> <span data-ttu-id="a5f80-407">e più simile a "[parameters('vmNodeType1Name')]" che non a "NodeType01".</span><span class="sxs-lookup"><span data-stu-id="a5f80-407">It would look like "[parameters('vmNodeType1Name')]" rather than "NodeType01".</span></span>
>

```json
"nodeTypes": [
    {
        "name": "NodeType01",
        "placementProperties": {
            "HasSSD": "true",
            "NodeColor": "green",
            "SomeProperty": "5"
        },
    }
],
```

<span data-ttu-id="a5f80-408">È possibile creare *vincoli* di posizionamento del servizio per un servizio in modo analogo al seguente:</span><span class="sxs-lookup"><span data-stu-id="a5f80-408">You can create service placement *constraints* for a service like as follows:</span></span>

<span data-ttu-id="a5f80-409">C#</span><span class="sxs-lookup"><span data-stu-id="a5f80-409">C#</span></span>

```csharp
FabricClient fabricClient = new FabricClient();
StatefulServiceDescription serviceDescription = new StatefulServiceDescription();
serviceDescription.PlacementConstraints = "(HasSSD == true && SomeProperty >= 4)";
// add other required servicedescription fields
//...
await fabricClient.ServiceManager.CreateServiceAsync(serviceDescription);
```

<span data-ttu-id="a5f80-410">Powershell:</span><span class="sxs-lookup"><span data-stu-id="a5f80-410">Powershell:</span></span>

```posh
New-ServiceFabricService -ApplicationName $applicationName -ServiceName $serviceName -ServiceTypeName $serviceType -Stateful -MinReplicaSetSize 3 -TargetReplicaSetSize 3 -PartitionSchemeSingleton -PlacementConstraint "HasSSD == true && SomeProperty >= 4"
```

<span data-ttu-id="a5f80-411">Se tutti i nodi di NodeType01 sono validi, è possibile anche selezionare un tipo di nodo con il vincolo hello "(NodeType == NodeType01)".</span><span class="sxs-lookup"><span data-stu-id="a5f80-411">If all nodes of NodeType01 are valid, you can also select that node type with hello constraint "(NodeType == NodeType01)".</span></span>

<span data-ttu-id="a5f80-412">Una delle operazioni più interessanti hello sui vincoli di posizionamento di un servizio è che possono essere aggiornate in modo dinamico in fase di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="a5f80-412">One of hello cool things about a service’s placement constraints is that they can be updated dynamically during runtime.</span></span> <span data-ttu-id="a5f80-413">Pertanto se si desidera, è possibile spostarsi di un servizio cluster hello, aggiungere e rimuovere requisiti e così via. Si occupa Service Fabric per garantire che servizio hello rimane attivo e disponibili anche quando questi tipi di modifiche vengono apportati.</span><span class="sxs-lookup"><span data-stu-id="a5f80-413">So if you need to, you can move a service around in hello cluster, add and remove requirements, etc. Service Fabric takes care of ensuring that hello service stays up and available even when these types of changes are made.</span></span>

<span data-ttu-id="a5f80-414">C#:</span><span class="sxs-lookup"><span data-stu-id="a5f80-414">C#:</span></span>

```csharp
StatefulServiceUpdateDescription updateDescription = new StatefulServiceUpdateDescription();
updateDescription.PlacementConstraints = "NodeType == NodeType01";
await fabricClient.ServiceManager.UpdateServiceAsync(new Uri("fabric:/app/service"), updateDescription);
```

<span data-ttu-id="a5f80-415">Powershell:</span><span class="sxs-lookup"><span data-stu-id="a5f80-415">Powershell:</span></span>

```posh
Update-ServiceFabricService -Stateful -ServiceName $serviceName -PlacementConstraints "NodeType == NodeType01"
```

<span data-ttu-id="a5f80-416">I vincoli di posizionamento vengono specificati per ogni istanza del servizio denominata in modo differente.</span><span class="sxs-lookup"><span data-stu-id="a5f80-416">Placement constraints are specified for every different named service instance.</span></span> <span data-ttu-id="a5f80-417">Eseguire gli aggiornamenti sempre hello di (sovrascrittura) quanto specificato in precedenza.</span><span class="sxs-lookup"><span data-stu-id="a5f80-417">Updates always take hello place of (overwrite) what was previously specified.</span></span>

<span data-ttu-id="a5f80-418">definizione di cluster Hello definisce le proprietà di hello in un nodo.</span><span class="sxs-lookup"><span data-stu-id="a5f80-418">hello cluster definition defines hello properties on a node.</span></span> <span data-ttu-id="a5f80-419">Per modificare le proprietà di un nodo è necessario un aggiornamento della configurazione del cluster.</span><span class="sxs-lookup"><span data-stu-id="a5f80-419">Changing a node's properties requires a cluster configuration upgrade.</span></span> <span data-ttu-id="a5f80-420">L'aggiornamento di proprietà di un nodo richiede ogni tooreport toorestart nodo interessato le nuove proprietà.</span><span class="sxs-lookup"><span data-stu-id="a5f80-420">Upgrading a node's properties requires each affected node toorestart tooreport its new properties.</span></span> <span data-ttu-id="a5f80-421">Questi aggiornamenti in sequenza sono gestiti da Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="a5f80-421">These rolling upgrades are managed by Service Fabric.</span></span>

## <a name="describing-and-managing-cluster-resources"></a><span data-ttu-id="a5f80-422">Descrizione e gestione delle risorse del cluster</span><span class="sxs-lookup"><span data-stu-id="a5f80-422">Describing and Managing Cluster Resources</span></span>
<span data-ttu-id="a5f80-423">Uno dei più importanti dei processi di qualsiasi orchestrator è toohelp hello gestire il consumo di risorse cluster hello.</span><span class="sxs-lookup"><span data-stu-id="a5f80-423">One of hello most important jobs of any orchestrator is toohelp manage resource consumption in hello cluster.</span></span> <span data-ttu-id="a5f80-424">Gestione delle risorse del cluster può avere significati diversi.</span><span class="sxs-lookup"><span data-stu-id="a5f80-424">Managing cluster resources can mean a couple of different things.</span></span> <span data-ttu-id="a5f80-425">Innanzitutto, è necessario verificare che i computer non siano sovraccarichi,</span><span class="sxs-lookup"><span data-stu-id="a5f80-425">First, there's ensuring that machines are not overloaded.</span></span> <span data-ttu-id="a5f80-426">ovvero che non eseguano più servizi di quanti ne possano gestire.</span><span class="sxs-lookup"><span data-stu-id="a5f80-426">This means making sure that machines aren't running more services than they can handle.</span></span> <span data-ttu-id="a5f80-427">In secondo luogo, è bilanciamento del carico e ottimizzazione che è critico toorunning servizi in modo efficiente.</span><span class="sxs-lookup"><span data-stu-id="a5f80-427">Second, there's balancing and optimization which is critical toorunning services efficiently.</span></span> <span data-ttu-id="a5f80-428">Costo effettivo o prestazioni offerte di servizio riservati non possono consentire a caldo toobe alcuni nodi mentre altri sono freddi.</span><span class="sxs-lookup"><span data-stu-id="a5f80-428">Cost effective or performance sensitive service offerings can't allow some nodes toobe hot while others are cold.</span></span> <span data-ttu-id="a5f80-429">I nodi a caldo provocare contesa tooresource riduzioni delle prestazioni e nodi freddo rappresentano sprecato e risorse aumento dei costi.</span><span class="sxs-lookup"><span data-stu-id="a5f80-429">Hot nodes lead tooresource contention and poor performance, and cold nodes represent wasted resources and increased costs.</span></span> 

<span data-ttu-id="a5f80-430">Service Fabric rappresenta le risorse come `Metrics`.</span><span class="sxs-lookup"><span data-stu-id="a5f80-430">Service Fabric represents resources as `Metrics`.</span></span> <span data-ttu-id="a5f80-431">Le metriche sono qualsiasi risorsa fisica o logica che si desidera toodescribe tooService dell'infrastruttura.</span><span class="sxs-lookup"><span data-stu-id="a5f80-431">Metrics are any logical or physical resource that you want toodescribe tooService Fabric.</span></span> <span data-ttu-id="a5f80-432">ad esempio "WorkQueueDepth" o "MemoryInMb".</span><span class="sxs-lookup"><span data-stu-id="a5f80-432">Examples of metrics are things like “WorkQueueDepth” or “MemoryInMb”.</span></span> <span data-ttu-id="a5f80-433">Per informazioni sulle risorse fisiche hello che può essere regolato a Service Fabric in nodi, vedere [governance delle risorse](service-fabric-resource-governance.md).</span><span class="sxs-lookup"><span data-stu-id="a5f80-433">For information about hello physical resources that Service Fabric can govern on nodes, see [resource governance](service-fabric-resource-governance.md).</span></span> <span data-ttu-id="a5f80-434">Per informazioni sulla configurazione di metriche personalizzate e sul loro utilizzo, vedere [questo articolo](service-fabric-cluster-resource-manager-metrics.md)</span><span class="sxs-lookup"><span data-stu-id="a5f80-434">For information on configuring custom metrics and their uses, see [this article](service-fabric-cluster-resource-manager-metrics.md)</span></span>

<span data-ttu-id="a5f80-435">Le metriche sono diverse dai vincoli di posizionamento e dalle proprietà del nodo.</span><span class="sxs-lookup"><span data-stu-id="a5f80-435">Metrics are different from placements constraints and node properties.</span></span> <span data-ttu-id="a5f80-436">Proprietà dei nodi sono statici descrittori degli stessi nodi di hello.</span><span class="sxs-lookup"><span data-stu-id="a5f80-436">Node properties are static descriptors of hello nodes themselves.</span></span> <span data-ttu-id="a5f80-437">Le metriche descrivono le risorse di cui dispongono i nodi e che vengono consumate dai servizi quando vengono eseguiti in un nodo.</span><span class="sxs-lookup"><span data-stu-id="a5f80-437">Metrics describe resources that nodes have and that services consume when they are run on a node.</span></span> <span data-ttu-id="a5f80-438">Proprietà di un nodo può essere "HasSSD" ed è stato possibile impostare tootrue o false.</span><span class="sxs-lookup"><span data-stu-id="a5f80-438">A node property could be "HasSSD" and could be set tootrue or false.</span></span> <span data-ttu-id="a5f80-439">quantità di Hello di spazio disponibile su tale unità SSD e la quantità è utilizzato da servizi sarebbe una metrica, ad esempio "DriveSpaceInMb".</span><span class="sxs-lookup"><span data-stu-id="a5f80-439">hello amount of space available on that SSD and how much is consumed by services would be a metric like “DriveSpaceInMb”.</span></span> 

<span data-ttu-id="a5f80-440">È importante toonote che esattamente come per i vincoli di posizione e le proprietà di nodo, hello gestione delle risorse Cluster dell'infrastruttura del servizio non ha capito quali nomi hello hello metriche medio.</span><span class="sxs-lookup"><span data-stu-id="a5f80-440">It is important toonote that just like for placement constraints and node properties, hello Service Fabric Cluster Resource Manager doesn't understand what hello names of hello metrics mean.</span></span> <span data-ttu-id="a5f80-441">I nomi delle metriche sono semplicemente stringhe.</span><span class="sxs-lookup"><span data-stu-id="a5f80-441">Metric names are just strings.</span></span> <span data-ttu-id="a5f80-442">È un'unità toodeclare buona norma come parte di nomi di metrica hello creati quando potrebbe essere ambigua.</span><span class="sxs-lookup"><span data-stu-id="a5f80-442">It is a good practice toodeclare units as a part of hello metric names that you create when it could be ambiguous.</span></span>

## <a name="capacity"></a><span data-ttu-id="a5f80-443">Capacity</span><span class="sxs-lookup"><span data-stu-id="a5f80-443">Capacity</span></span>
<span data-ttu-id="a5f80-444">Se si disattiva completamente il *bilanciamento*di tutte le risorse, Cluster Resource Manager di Service Fabric tenta comunque di assicurare che nessun nodo superi la propria capacità consentita.</span><span class="sxs-lookup"><span data-stu-id="a5f80-444">If you turned off all resource *balancing*, Service Fabric’s Cluster Resource Manager would still ensure that no node ended up over its capacity.</span></span> <span data-ttu-id="a5f80-445">I sovraccarichi di capacità di gestione è possibile, a meno che non cluster hello è piena o il carico di lavoro di hello è maggiore di qualsiasi nodo.</span><span class="sxs-lookup"><span data-stu-id="a5f80-445">Managing capacity overruns is possible unless hello cluster is too full or hello workload is larger than any node.</span></span> <span data-ttu-id="a5f80-446">Capacità è un altro *vincolo* tale gestore delle risorse Cluster hello utilizza toounderstand la quantità di una risorsa di un nodo è.</span><span class="sxs-lookup"><span data-stu-id="a5f80-446">Capacity is another *constraint* that hello Cluster Resource Manager uses toounderstand how much of a resource a node has.</span></span> <span data-ttu-id="a5f80-447">La capacità residua viene registrata anche per i cluster di hello nel suo complesso.</span><span class="sxs-lookup"><span data-stu-id="a5f80-447">Remaining capacity is also tracked for hello cluster as a whole.</span></span> <span data-ttu-id="a5f80-448">Sia la capacità di hello e utilizzo di hello a livello di servizio hello sono espressi in termini di metriche.</span><span class="sxs-lookup"><span data-stu-id="a5f80-448">Both hello capacity and hello consumption at hello service level are expressed in terms of metrics.</span></span> <span data-ttu-id="a5f80-449">Ad esempio, la metrica hello potrebbe essere "ClientConnections" e un determinato nodo potrebbe avere una capacità per "ClientConnections" di 32768.</span><span class="sxs-lookup"><span data-stu-id="a5f80-449">So for example, hello metric might be "ClientConnections" and a given Node may have a capacity for "ClientConnections" of 32768.</span></span> <span data-ttu-id="a5f80-450">Gli altri nodi possono avere altri limiti di un servizio in esecuzione nel nodo possono ad esempio attualmente richiedere 32256 della metrica hello "ClientConnections".</span><span class="sxs-lookup"><span data-stu-id="a5f80-450">Other nodes can have other limits Some service running on that node can say it is currently consuming 32256 of hello metric "ClientConnections".</span></span>

<span data-ttu-id="a5f80-451">Durante la fase di esecuzione, hello gestione delle risorse Cluster tiene traccia delle relative capacità rimanenti nel cluster hello e sui nodi.</span><span class="sxs-lookup"><span data-stu-id="a5f80-451">During runtime, hello Cluster Resource Manager tracks remaining capacity in hello cluster and on nodes.</span></span> <span data-ttu-id="a5f80-452">In ordine tootrack hello capacità gestione delle risorse Cluster sottrae sull'utilizzo di ciascun servizio dalla capacità del nodo in cui viene eseguito il servizio di hello.</span><span class="sxs-lookup"><span data-stu-id="a5f80-452">In order tootrack capacity hello Cluster Resource Manager subtracts each service's usage from node's capacity where hello service runs.</span></span> <span data-ttu-id="a5f80-453">Con queste informazioni, hello servizio di gestione delle risorse Cluster dell'infrastruttura può stabilire dove tooplace o spostare le repliche in modo che i nodi non superare la capacità.</span><span class="sxs-lookup"><span data-stu-id="a5f80-453">With this information, hello Service Fabric Cluster Resource Manager can figure out where tooplace or move replicas so that nodes don’t go over capacity.</span></span>

<span data-ttu-id="a5f80-454"><center>
![Nodi e capacità del cluster][Image7]
</center></span><span class="sxs-lookup"><span data-stu-id="a5f80-454"><center>
![Cluster nodes and capacity][Image7]
</center></span></span>

<span data-ttu-id="a5f80-455">C#:</span><span class="sxs-lookup"><span data-stu-id="a5f80-455">C#:</span></span>

```csharp
StatefulServiceDescription serviceDescription = new StatefulServiceDescription();
ServiceLoadMetricDescription metric = new ServiceLoadMetricDescription();
metric.Name = "ClientConnections";
metric.PrimaryDefaultLoad = 1024;
metric.SecondaryDefaultLoad = 0;
metric.Weight = ServiceLoadMetricWeight.High;
serviceDescription.Metrics.Add(metric);
await fabricClient.ServiceManager.CreateServiceAsync(serviceDescription);
```

<span data-ttu-id="a5f80-456">Powershell:</span><span class="sxs-lookup"><span data-stu-id="a5f80-456">Powershell:</span></span>

```posh
New-ServiceFabricService -ApplicationName $applicationName -ServiceName $serviceName -ServiceTypeName $serviceTypeName –Stateful -MinReplicaSetSize 3 -TargetReplicaSetSize 3 -PartitionSchemeSingleton –Metric @("ClientConnections,High,1024,0)
```

<span data-ttu-id="a5f80-457">È possibile visualizzare i valori riferiti alla capacità definita nel manifesto del cluster hello:</span><span class="sxs-lookup"><span data-stu-id="a5f80-457">You can see capacities defined in hello cluster manifest:</span></span>

<span data-ttu-id="a5f80-458">ClusterManifest.xml</span><span class="sxs-lookup"><span data-stu-id="a5f80-458">ClusterManifest.xml</span></span>

```xml
    <NodeType Name="NodeType03">
      <Capacities>
        <Capacity Name="ClientConnections" Value="65536"/>
      </Capacities>
    </NodeType>
```

<span data-ttu-id="a5f80-459">mediante ClusterConfig.json per le distribuzioni autonome o Template.json per cluster ospitati in Azure.</span><span class="sxs-lookup"><span data-stu-id="a5f80-459">via ClusterConfig.json for Standalone deployments or Template.json for Azure hosted clusters.</span></span> 

```json
"nodeTypes": [
    {
        "name": "NodeType03",
        "capacities": {
            "ClientConnections": "65536",
        }
    }
],
```

<span data-ttu-id="a5f80-460">In genere il carico di un servizio cambia in modo dinamico.</span><span class="sxs-lookup"><span data-stu-id="a5f80-460">Commonly a service’s load changes dynamically.</span></span> <span data-ttu-id="a5f80-461">Si supponga che il caricamento di una replica di "ClientConnections" è stato modificato da 1024 too2048, ma nodo hello è in esecuzione su quindi disponesse di 512 capacità rimanente per tale metrica.</span><span class="sxs-lookup"><span data-stu-id="a5f80-461">Say that a replica's load of "ClientConnections" changed from 1024 too2048, but hello node it was running on then only had 512 capacity remaining for that metric.</span></span> <span data-ttu-id="a5f80-462">Ora il posizionamento della replica o dell'istanza non è valido, poiché in quel nodo non c'è spazio sufficiente.</span><span class="sxs-lookup"><span data-stu-id="a5f80-462">Now that replica or instance's placement is invalid, since there's not enough room on that node.</span></span> <span data-ttu-id="a5f80-463">Gestione delle risorse Cluster Hello può tookick in e ottenere nodo hello capacità minore.</span><span class="sxs-lookup"><span data-stu-id="a5f80-463">hello Cluster Resource Manager has tookick in and get hello node back below capacity.</span></span> <span data-ttu-id="a5f80-464">Riduce il carico sul nodo hello capacità di failover mediante lo spostamento di uno o più repliche hello o istanze da tale tooother dei nodi.</span><span class="sxs-lookup"><span data-stu-id="a5f80-464">It reduces load on hello node that is over capacity by moving one or more of hello replicas or instances from that node tooother nodes.</span></span> <span data-ttu-id="a5f80-465">Quando si spostano le repliche, hello gestione delle risorse Cluster tenta costo hello toominimize di tali spostamenti di tipo.</span><span class="sxs-lookup"><span data-stu-id="a5f80-465">When moving replicas, hello Cluster Resource Manager tries toominimize hello cost of those movements.</span></span> <span data-ttu-id="a5f80-466">Viene descritto il costo dello spostamento in [questo articolo](service-fabric-cluster-resource-manager-movement-cost.md) più su hello gestione delle risorse Cluster di ribilanciamento strategie e le regole è descritto [qui](service-fabric-cluster-resource-manager-metrics.md).</span><span class="sxs-lookup"><span data-stu-id="a5f80-466">Movement cost is discussed in [this article](service-fabric-cluster-resource-manager-movement-cost.md) and more about hello Cluster Resource Manager's rebalancing strategies and rules is described [here](service-fabric-cluster-resource-manager-metrics.md).</span></span>

## <a name="cluster-capacity"></a><span data-ttu-id="a5f80-467">Capacità del cluster</span><span class="sxs-lookup"><span data-stu-id="a5f80-467">Cluster capacity</span></span>
<span data-ttu-id="a5f80-468">In che modo hello gestione delle risorse Cluster di Service Fabric keep hello complessivo del cluster da troppo piena?</span><span class="sxs-lookup"><span data-stu-id="a5f80-468">So how does hello Service Fabric Cluster Resource Manager keep hello overall cluster from being too full?</span></span> <span data-ttu-id="a5f80-469">Con il carico dinamico non è possibile intervenire in modo netto.</span><span class="sxs-lookup"><span data-stu-id="a5f80-469">Well, with dynamic load there’s not a lot it can do.</span></span> <span data-ttu-id="a5f80-470">I servizi possono avere i picchi di carico indipendentemente dalle azioni eseguite da gestore delle risorse Cluster hello.</span><span class="sxs-lookup"><span data-stu-id="a5f80-470">Services can have their load spike independently of actions taken by hello Cluster Resource Manager.</span></span> <span data-ttu-id="a5f80-471">Di conseguenza un cluster che dispone di molta capacità oggi può non essere abbastanza potente domani se l'utilizzo aumenta.</span><span class="sxs-lookup"><span data-stu-id="a5f80-471">As a result, your cluster with plenty of headroom today may be underpowered when you become famous tomorrow.</span></span> <span data-ttu-id="a5f80-472">Ciò premesso, esistono alcuni controlli sono ricorrere alla tooprevent problemi.</span><span class="sxs-lookup"><span data-stu-id="a5f80-472">That said, there are some controls that are baked in tooprevent problems.</span></span> <span data-ttu-id="a5f80-473">innanzitutto Hello che possiamo è impedire hello creazione di nuovi carichi di lavoro che provocherebbero hello cluster toobecome completo.</span><span class="sxs-lookup"><span data-stu-id="a5f80-473">hello first thing we can do is prevent hello creation of new workloads that would cause hello cluster toobecome full.</span></span>

<span data-ttu-id="a5f80-474">Si supponga di creare un servizio senza stato al quale è associato un carico.</span><span class="sxs-lookup"><span data-stu-id="a5f80-474">Say that you create a stateless service and it has some load associated with it.</span></span> <span data-ttu-id="a5f80-475">Si supponga che il servizio hello interessare la metrica "DiskSpaceInMb" hello.</span><span class="sxs-lookup"><span data-stu-id="a5f80-475">Let’s say that hello service cares about hello "DiskSpaceInMb" metric.</span></span> <span data-ttu-id="a5f80-476">Si supponga inoltre che sia continua tooconsume cinque unità del "DiskSpaceInMb" per ogni istanza del servizio hello.</span><span class="sxs-lookup"><span data-stu-id="a5f80-476">Let's also say that it is going tooconsume five units of "DiskSpaceInMb" for every instance of hello service.</span></span> <span data-ttu-id="a5f80-477">Si desidera toocreate tre istanze del servizio hello.</span><span class="sxs-lookup"><span data-stu-id="a5f80-477">You want toocreate three instances of hello service.</span></span> <span data-ttu-id="a5f80-478">L'installazione è riuscita.</span><span class="sxs-lookup"><span data-stu-id="a5f80-478">Great!</span></span> <span data-ttu-id="a5f80-479">In modo che significa che è necessario 15 unità del toobe "DiskSpaceInMb" presenti nel cluster hello in ordine per noi tooeven essere in grado di toocreate queste istanze del servizio.</span><span class="sxs-lookup"><span data-stu-id="a5f80-479">So that means that we need 15 units of "DiskSpaceInMb" toobe present in hello cluster in order for us tooeven be able toocreate these service instances.</span></span> <span data-ttu-id="a5f80-480">Gestione delle risorse Cluster Hello calcola continuamente capacità hello e l'utilizzo di ogni metrica pertanto può determinare residua hello cluster hello.</span><span class="sxs-lookup"><span data-stu-id="a5f80-480">hello Cluster Resource Manager continually calculates hello capacity and consumption of each metric so it can determine hello remaining capacity in hello cluster.</span></span> <span data-ttu-id="a5f80-481">Se non vi è spazio sufficiente, gestione delle risorse Cluster Rifiuta hello hello creare chiamata del servizio.</span><span class="sxs-lookup"><span data-stu-id="a5f80-481">If there isn't enough space, hello Cluster Resource Manager rejects hello create service call.</span></span>

<span data-ttu-id="a5f80-482">Poiché il requisito di hello è solo che vi siano 15 unità disponibile, questo stato possibile allocare spazio molti modi diversi.</span><span class="sxs-lookup"><span data-stu-id="a5f80-482">Since hello requirement is only that there be 15 units available, this space could be allocated many different ways.</span></span> <span data-ttu-id="a5f80-483">Ad esempio potrebbe esserci un'unità di capacità rimanente in 15 nodi diversi oppure tre unità di capacità rimanenti in cinque nodi diversi.</span><span class="sxs-lookup"><span data-stu-id="a5f80-483">For example, there could be one remaining unit of capacity on 15 different nodes, or three remaining units of capacity on five different nodes.</span></span> <span data-ttu-id="a5f80-484">Se hello Gestione risorse di Cluster possibile ridisporre operazioni in modo è 5 unità disponibile in tre nodi, viene inserito il servizio di hello.</span><span class="sxs-lookup"><span data-stu-id="a5f80-484">If hello Cluster Resource Manager can rearrange things so there's five units available on three nodes, it places hello service.</span></span> <span data-ttu-id="a5f80-485">La ridisposizione cluster hello è generalmente possibile, a meno che non cluster hello è quasi pieno o servizi esistenti hello non possono essere consolidati per qualche motivo.</span><span class="sxs-lookup"><span data-stu-id="a5f80-485">Rearranging hello cluster is usually possible unless hello cluster is almost full or hello existing services can't be consolidated for some reason.</span></span>

## <a name="buffered-capacity"></a><span data-ttu-id="a5f80-486">Capacità in buffering</span><span class="sxs-lookup"><span data-stu-id="a5f80-486">Buffered Capacity</span></span>
<span data-ttu-id="a5f80-487">Capacità di memorizzazione nel buffer è un'altra funzionalità di gestione delle risorse Cluster hello.</span><span class="sxs-lookup"><span data-stu-id="a5f80-487">Buffered capacity is another feature of hello Cluster Resource Manager.</span></span> <span data-ttu-id="a5f80-488">Consente di prenotazione di alcune parti del hello capacità del nodo Generale.</span><span class="sxs-lookup"><span data-stu-id="a5f80-488">It allows reservation of some portion of hello overall node capacity.</span></span> <span data-ttu-id="a5f80-489">Questo buffer di capacità è servizi tooplace utilizzato solo durante gli aggiornamenti e gli errori di nodo.</span><span class="sxs-lookup"><span data-stu-id="a5f80-489">This capacity buffer is only used tooplace services during upgrades and node failures.</span></span> <span data-ttu-id="a5f80-490">La capacità in buffering è specificata a livello globale per ogni metrica e per tutti i nodi.</span><span class="sxs-lookup"><span data-stu-id="a5f80-490">Buffered Capacity is specified globally per metric for all nodes.</span></span> <span data-ttu-id="a5f80-491">il valore di Hello selezionato per la capacità riservata hello è una funzione del numero di hello di domini di errore e l'aggiornamento disporre nel cluster hello.</span><span class="sxs-lookup"><span data-stu-id="a5f80-491">hello value you pick for hello reserved capacity is a function of hello number of Fault and Upgrade Domains you have in hello cluster.</span></span> <span data-ttu-id="a5f80-492">Quando è presente un numero maggiore di domini di errore e di aggiornamento è possibile scegliere un valore inferiore per il buffer di capacità.</span><span class="sxs-lookup"><span data-stu-id="a5f80-492">More Fault and Upgrade Domains means that you can pick a lower number for your buffered capacity.</span></span> <span data-ttu-id="a5f80-493">Se si hanno più domini, è possibile prevedere più piccole quantità di toobe il cluster non disponibile durante gli aggiornamenti e gli errori.</span><span class="sxs-lookup"><span data-stu-id="a5f80-493">If you have more domains, you can expect smaller amounts of your cluster toobe unavailable during upgrades and failures.</span></span> <span data-ttu-id="a5f80-494">Specifica di capacità del buffer ha senso solo se si dispone anche di capacità del nodo hello specificato per una metrica.</span><span class="sxs-lookup"><span data-stu-id="a5f80-494">Specifying Buffered Capacity only makes sense if you have also specified hello node capacity for a metric.</span></span>

<span data-ttu-id="a5f80-495">Di seguito è riportato un esempio di come toospecify memorizzato nel buffer di capacità:</span><span class="sxs-lookup"><span data-stu-id="a5f80-495">Here's an example of how toospecify buffered capacity:</span></span>

<span data-ttu-id="a5f80-496">ClusterManifest.xml</span><span class="sxs-lookup"><span data-stu-id="a5f80-496">ClusterManifest.xml</span></span>

```xml
        <Section Name="NodeBufferPercentage">
            <Parameter Name="SomeMetric" Value="0.15" />
            <Parameter Name="SomeOtherMetric" Value="0.20" />
        </Section>
```

<span data-ttu-id="a5f80-497">mediante ClusterConfig.json per le distribuzioni autonome o Template.json per i cluster ospitati in Azure:</span><span class="sxs-lookup"><span data-stu-id="a5f80-497">via ClusterConfig.json for Standalone deployments or Template.json for Azure hosted clusters:</span></span>

```json
"fabricSettings": [
  {
    "name": "NodeBufferPercentage",
    "parameters": [
      {
          "name": "SomeMetric",
          "value": "0.15"
      },
      {
          "name": "SomeOtherMetric",
          "value": "0.20"
      }
    ]
  }
]
```

<span data-ttu-id="a5f80-498">creazione di Hello dei nuovi servizi non riesce quando cluster hello ha esaurito la capacità di memorizzazione nel buffer per una metrica.</span><span class="sxs-lookup"><span data-stu-id="a5f80-498">hello creation of new services fails when hello cluster is out of buffered capacity for a metric.</span></span> <span data-ttu-id="a5f80-499">Impedire la creazione di hello di nuovo buffer di hello toopreserve services garantisce che gli errori e gli aggiornamenti non comportano nodi toogo capacità di failover.</span><span class="sxs-lookup"><span data-stu-id="a5f80-499">Preventing hello creation of new services toopreserve hello buffer ensures that upgrades and failures don’t cause nodes toogo over capacity.</span></span> <span data-ttu-id="a5f80-500">Il buffer di capacità è un'opzione facoltativa ma consigliata per tutti i cluster che definiscono una capacità per una metrica.</span><span class="sxs-lookup"><span data-stu-id="a5f80-500">Buffered capacity is optional but is recommended in any cluster that defines a capacity for a metric.</span></span>

<span data-ttu-id="a5f80-501">Gestione delle risorse Cluster Hello espone queste informazioni di carico.</span><span class="sxs-lookup"><span data-stu-id="a5f80-501">hello Cluster Resource Manager exposes this load information.</span></span> <span data-ttu-id="a5f80-502">Per ogni metrica, le informazioni includono:</span><span class="sxs-lookup"><span data-stu-id="a5f80-502">For each metric, this information includes:</span></span> 
  - <span data-ttu-id="a5f80-503">Hello memorizzato nel buffer delle impostazioni di capacità</span><span class="sxs-lookup"><span data-stu-id="a5f80-503">hello buffered capacity settings</span></span>
  - <span data-ttu-id="a5f80-504">capacità totale Hello</span><span class="sxs-lookup"><span data-stu-id="a5f80-504">hello total capacity</span></span>
  - <span data-ttu-id="a5f80-505">utilizzo corrente di Hello</span><span class="sxs-lookup"><span data-stu-id="a5f80-505">hello current consumption</span></span>
  - <span data-ttu-id="a5f80-506">se ogni metrica può essere considerata bilanciata oppure no</span><span class="sxs-lookup"><span data-stu-id="a5f80-506">whether each metric is considered balanced or not</span></span>
  - <span data-ttu-id="a5f80-507">statistiche relative a deviazione standard hello</span><span class="sxs-lookup"><span data-stu-id="a5f80-507">statistics about hello standard deviation</span></span>
  - <span data-ttu-id="a5f80-508">nodi di Hello che hanno hello carico minimo e la maggior parte delle</span><span class="sxs-lookup"><span data-stu-id="a5f80-508">hello nodes which have hello most and least load</span></span>  
  
<span data-ttu-id="a5f80-509">Di seguito un esempio dell'output:</span><span class="sxs-lookup"><span data-stu-id="a5f80-509">Below we see an example of that output:</span></span>

```posh
PS C:\Users\user> Get-ServiceFabricClusterLoadInformation
LastBalancingStartTimeUtc : 9/1/2016 12:54:59 AM
LastBalancingEndTimeUtc   : 9/1/2016 12:54:59 AM
LoadMetricInformation     :
                            LoadMetricName        : Metric1
                            IsBalancedBefore      : False
                            IsBalancedAfter       : False
                            DeviationBefore       : 0.192450089729875
                            DeviationAfter        : 0.192450089729875
                            BalancingThreshold    : 1
                            Action                : NoActionNeeded
                            ActivityThreshold     : 0
                            ClusterCapacity       : 189
                            ClusterLoad           : 45
                            ClusterRemainingCapacity : 144
                            NodeBufferPercentage  : 10
                            ClusterBufferedCapacity : 170
                            ClusterRemainingBufferedCapacity : 125
                            ClusterCapacityViolation : False
                            MinNodeLoadValue      : 0
                            MinNodeLoadNodeId     : 3ea71e8e01f4b0999b121abcbf27d74d
                            MaxNodeLoadValue      : 15
                            MaxNodeLoadNodeId     : 2cc648b6770be1bc9824fa995d5b68b1
```

## <a name="next-steps"></a><span data-ttu-id="a5f80-510">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="a5f80-510">Next steps</span></span>
* <span data-ttu-id="a5f80-511">Per informazioni sul flusso hello di architettura e le informazioni all'interno di gestione delle risorse Cluster hello, estrarre [in questo articolo](service-fabric-cluster-resource-manager-architecture.md)</span><span class="sxs-lookup"><span data-stu-id="a5f80-511">For information on hello architecture and information flow within hello Cluster Resource Manager, check out [this article ](service-fabric-cluster-resource-manager-architecture.md)</span></span>
* <span data-ttu-id="a5f80-512">La definizione di metriche di deframmentazione in linea è tooconsolidate unidirezionale carico sui nodi anziché distribuirlo. toolearn come tooconfigure deframmentazione, fare riferimento troppo[in questo articolo](service-fabric-cluster-resource-manager-defragmentation-metrics.md)</span><span class="sxs-lookup"><span data-stu-id="a5f80-512">Defining Defragmentation Metrics is one way tooconsolidate load on nodes instead of spreading it out. toolearn how tooconfigure defragmentation, refer too[this article](service-fabric-cluster-resource-manager-defragmentation-metrics.md)</span></span>
* <span data-ttu-id="a5f80-513">Iniziare dall'inizio hello e [ottenere un servizio di gestione delle risorse Cluster dell'infrastruttura di toohello introduzione](service-fabric-cluster-resource-manager-introduction.md)</span><span class="sxs-lookup"><span data-stu-id="a5f80-513">Start from hello beginning and [get an Introduction toohello Service Fabric Cluster Resource Manager](service-fabric-cluster-resource-manager-introduction.md)</span></span>
* <span data-ttu-id="a5f80-514">toofind out sulla modalità di gestione delle risorse Cluster hello gestisce e bilancia il carico nel cluster hello, controllare l'articolo hello [bilanciamento del carico](service-fabric-cluster-resource-manager-balancing.md)</span><span class="sxs-lookup"><span data-stu-id="a5f80-514">toofind out about how hello Cluster Resource Manager manages and balances load in hello cluster, check out hello article on [balancing load](service-fabric-cluster-resource-manager-balancing.md)</span></span>

[Image1]:./media/service-fabric-cluster-resource-manager-cluster-description/cluster-fault-domains.png
[Image2]:./media/service-fabric-cluster-resource-manager-cluster-description/cluster-uneven-fault-domain-layout.png
[Image3]:./media/service-fabric-cluster-resource-manager-cluster-description/cluster-fault-and-upgrade-domains-with-placement.png
[Image4]:./media/service-fabric-cluster-resource-manager-cluster-description/cluster-fault-and-upgrade-domain-layout-strategies.png
[Image5]:./media/service-fabric-cluster-resource-manager-cluster-description/cluster-layout-different-workloads.png
[Image6]:./media/service-fabric-cluster-resource-manager-cluster-description/cluster-placement-constraints-node-properties.png
[Image7]:./media/service-fabric-cluster-resource-manager-cluster-description/cluster-nodes-and-capacity.png
