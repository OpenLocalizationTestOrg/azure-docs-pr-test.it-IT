---
title: Come configurare la persistenza dei dati per una Cache Redis di Azure Premium
description: Informazioni su come configurare e gestire la persistenza dei dati per le istanze di Cache Redis di Azure di livello Premium
services: redis-cache
documentationcenter: 
author: steved0x
manager: douge
editor: 
ms.assetid: b01cf279-60a0-4711-8c5f-af22d9540d38
ms.service: cache
ms.workload: tbd
ms.tgt_pltfrm: cache-redis
ms.devlang: na
ms.topic: article
ms.date: 08/24/2017
ms.author: sdanie
ms.openlocfilehash: 638f0154d3a4fd091197a2da86374a053b31c4c0
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/29/2017
---
# <a name="how-to-configure-data-persistence-for-a-premium-azure-redis-cache"></a><span data-ttu-id="f0a16-103">Come configurare la persistenza dei dati per una Cache Redis di Azure Premium</span><span class="sxs-lookup"><span data-stu-id="f0a16-103">How to configure data persistence for a Premium Azure Redis Cache</span></span>
<span data-ttu-id="f0a16-104">Cache Redis di Azure dispone di diverse offerte di cache che assicurano flessibilità nella scelta delle funzionalità e delle dimensioni della cache, incluse le funzionalità del livello Premium quali clustering, persistenza e supporto della rete virtuale.</span><span class="sxs-lookup"><span data-stu-id="f0a16-104">Azure Redis Cache has different cache offerings which provide flexibility in the choice of cache size and features, including Premium tier features such as clustering, persistence, and virtual network support.</span></span> <span data-ttu-id="f0a16-105">In questo articolo viene descritto come configurare la persistenza in un'istanza Premium di Cache Redis di Azure.</span><span class="sxs-lookup"><span data-stu-id="f0a16-105">This article describes how to configure persistence in a premium Azure Redis Cache instance.</span></span>

<span data-ttu-id="f0a16-106">Per informazioni su altre funzionalità di cache premium, vedere [Introduzione al piano Premium di Cache Redis di Azure](cache-premium-tier-intro.md).</span><span class="sxs-lookup"><span data-stu-id="f0a16-106">For information on other premium cache features, see [Introduction to the Azure Redis Cache Premium tier](cache-premium-tier-intro.md).</span></span>

## <a name="what-is-data-persistence"></a><span data-ttu-id="f0a16-107">Che cos'è la persistenza dei dati?</span><span class="sxs-lookup"><span data-stu-id="f0a16-107">What is data persistence?</span></span>
<span data-ttu-id="f0a16-108">La [persistenza Redis](https://redis.io/topics/persistence) consente di rendere persistenti i dati archiviati in Redis.</span><span class="sxs-lookup"><span data-stu-id="f0a16-108">[Redis persistence](https://redis.io/topics/persistence) allows you to persist data stored in Redis.</span></span> <span data-ttu-id="f0a16-109">È inoltre possibile creare snapshot ed eseguire il backup dei dati, per consentirne il caricamento in caso di errore hardware.</span><span class="sxs-lookup"><span data-stu-id="f0a16-109">You can also take snapshots and back up the data, which you can load in case of a hardware failure.</span></span> <span data-ttu-id="f0a16-110">Si tratta di un enorme vantaggio rispetto al livello Basic o Standard in cui tutti i dati vengono archiviati in memoria ed esiste il rischio di potenziali perdite di dati in caso di errore quando i nodi della cache sono inattivi.</span><span class="sxs-lookup"><span data-stu-id="f0a16-110">This is a huge advantage over Basic or Standard tier where all the data is stored in memory and there can be potential data loss in case of a failure where Cache nodes are down.</span></span> 

<span data-ttu-id="f0a16-111">Il servizio Cache Redis di Azure offre i modelli di persistenza Redis seguenti:</span><span class="sxs-lookup"><span data-stu-id="f0a16-111">Azure Redis Cache offers Redis persistence using the following models:</span></span>

* <span data-ttu-id="f0a16-112">**Persistenza RDB**: quando si configura la persistenza RDB (database Redis), Cache Redis di Azure salva in modo permanente uno snapshot della cache Redis in un formato binario Redis su disco in base a una frequenza di backup configurabile.</span><span class="sxs-lookup"><span data-stu-id="f0a16-112">**RDB persistence** - When RDB (Redis database) persistence is configured, Azure Redis Cache persists a snapshot of the Redis cache in a Redis binary format to disk based on a configurable backup frequency.</span></span> <span data-ttu-id="f0a16-113">Se si verifica un evento catastrofico che disabilita sia la cache primaria che quella di replica, la cache viene ricostruita usando lo snapshot più recente.</span><span class="sxs-lookup"><span data-stu-id="f0a16-113">If a catastrophic event occurs that disables both the primary and replica cache, the cache is reconstructed using the most recent snapshot.</span></span> <span data-ttu-id="f0a16-114">Altre informazioni sono disponibili sui [vantaggi](https://redis.io/topics/persistence#rdb-advantages) e gli [svantaggi](https://redis.io/topics/persistence#rdb-disadvantages) della persistenza RDB.</span><span class="sxs-lookup"><span data-stu-id="f0a16-114">Learn more about the [advantages](https://redis.io/topics/persistence#rdb-advantages) and [disadvantages](https://redis.io/topics/persistence#rdb-disadvantages) of RDB persistence.</span></span>
* <span data-ttu-id="f0a16-115">**Persistenza AOF**: quando si configura la persistenza AOF (Append only file), Cache Redis di Azure salva ogni operazione di scrittura in un log che viene salvato almeno una volta al secondo in un account di archiviazione di Azure.</span><span class="sxs-lookup"><span data-stu-id="f0a16-115">**AOF persistence** - When AOF (Append only file) persistence is configured, Azure Redis Cache saves every write operation to a log that is saved at least once per second into an Azure Storage account.</span></span> <span data-ttu-id="f0a16-116">Se si verifica un evento catastrofico che disabilita sia la cache primaria che quella di replica, la cache viene ricostruita usando le operazioni di scrittura più recenti.</span><span class="sxs-lookup"><span data-stu-id="f0a16-116">If a catastrophic event occurs that disables both the primary and replica cache, the cache is reconstructed using the stored write operations.</span></span> <span data-ttu-id="f0a16-117">Altre informazioni sono disponibili sui [vantaggi](https://redis.io/topics/persistence#aof-advantages) e gli [svantaggi](https://redis.io/topics/persistence#aof-disadvantages) della persistenza AOF.</span><span class="sxs-lookup"><span data-stu-id="f0a16-117">Learn more about the [advantages](https://redis.io/topics/persistence#aof-advantages) and [disadvantages](https://redis.io/topics/persistence#aof-disadvantages) of AOF persistence.</span></span>

<span data-ttu-id="f0a16-118">La persistenza può essere configurata nel pannello **Nuova cache Redis** durante la creazione della cache e nel **menu Risorse** per le cache premium esistenti.</span><span class="sxs-lookup"><span data-stu-id="f0a16-118">Persistence is configured from the **New Redis Cache** blade during cache creation and on the **Resource menu** for existing premium caches.</span></span>

[!INCLUDE [redis-cache-create](../../includes/redis-cache-premium-create.md)]

<span data-ttu-id="f0a16-119">Dopo aver selezionato un piano tariffario Premium, fare clic su **Persistenza Redis**.</span><span class="sxs-lookup"><span data-stu-id="f0a16-119">Once a premium pricing tier is selected, click **Redis persistence**.</span></span>

![Persistenza Redis][redis-cache-persistence]

<span data-ttu-id="f0a16-121">La procedura illustrata nella sezione che segue descrive come configurare la persistenza Redis per la nuova cache premium.</span><span class="sxs-lookup"><span data-stu-id="f0a16-121">The steps in the next section describe how to configure Redis persistence on your new premium cache.</span></span> <span data-ttu-id="f0a16-122">Una volta configurata la persistenza di Redis, fare clic su **Crea** per creare la nuova cache premium con persistenza di Redis.</span><span class="sxs-lookup"><span data-stu-id="f0a16-122">Once Redis persistence is configured, click **Create** to create your new premium cache with Redis persistence.</span></span>

## <a name="enable-redis-persistence"></a><span data-ttu-id="f0a16-123">Abilitare la persistenza Redis</span><span class="sxs-lookup"><span data-stu-id="f0a16-123">Enable Redis persistence</span></span>

<span data-ttu-id="f0a16-124">È possibile abilitare la persistenza Redis nel pannello **Persistenza dei dati Redis** scegliendo tra la persistenza **RDB** o **AOF**.</span><span class="sxs-lookup"><span data-stu-id="f0a16-124">Redis persistence is enabled on the **Redis data persistence** blade by choosing either **RDB** or **AOF** persistence.</span></span> <span data-ttu-id="f0a16-125">Per le nuove cache, questo pannello è accessibile durante il processo di creazione della cache, come descritto nella sezione precedente.</span><span class="sxs-lookup"><span data-stu-id="f0a16-125">For new caches, this blade is accessed during the cache creation process, as described in the previous section.</span></span> <span data-ttu-id="f0a16-126">Per le cache esistenti, è possibile accedere al pannello **Persistenza dei dati di Redis** dal **menu Risorse** della cache.</span><span class="sxs-lookup"><span data-stu-id="f0a16-126">For existing caches, the **Redis data persistence** blade is accessed from the **Resource menu** for your cache.</span></span>

![Impostazioni di Redis][redis-cache-settings]


## <a name="configure-rdb-persistence"></a><span data-ttu-id="f0a16-128">Configurare la persistenza RDB</span><span class="sxs-lookup"><span data-stu-id="f0a16-128">Configure RDB persistence</span></span>

<span data-ttu-id="f0a16-129">Per abilitare la persistenza RDB, fare clic su **RDB**.</span><span class="sxs-lookup"><span data-stu-id="f0a16-129">To enable RDB persistence, click **RDB**.</span></span> <span data-ttu-id="f0a16-130">Per disabilitare la persistenza RDB in una cache premium precedentemente abilitata, fare clic su **Disabilita**.</span><span class="sxs-lookup"><span data-stu-id="f0a16-130">To disable RDB persistence on a previously enabled premium cache, click **Disabled**.</span></span>

![Persistenza RDB di Redis][redis-cache-rdb-persistence]

<span data-ttu-id="f0a16-132">Per configurare l'intervallo di backup, selezionare una **Frequenza di Backup** dall'elenco a discesa.</span><span class="sxs-lookup"><span data-stu-id="f0a16-132">To configure the backup interval, select a **Backup Frequency** from the drop-down list.</span></span> <span data-ttu-id="f0a16-133">Le opzioni disponibili includono **15 minuti**, **30 minuti**, **60 minuti**, **6 ore**, **12 ore** e **24 ore**.</span><span class="sxs-lookup"><span data-stu-id="f0a16-133">Choices include **15 Minutes**, **30 minutes**, **60 minutes**, **6 hours**, **12 hours**, and **24 hours**.</span></span> <span data-ttu-id="f0a16-134">Il conto alla rovescia per l'intervallo inizia dopo il corretto completamento dell'operazione di backup precedente e al termine viene avviato un nuovo backup.</span><span class="sxs-lookup"><span data-stu-id="f0a16-134">This interval starts counting down after the previous backup operation successfully completes and when it elapses a new backup is initiated.</span></span>

<span data-ttu-id="f0a16-135">Fare clic su **Account di archiviazione** per selezionare l'account di archiviazione da usare e scegliere la **Chiave primaria** o la **Chiave secondaria** da usare dall'elenco a discesa **Chiave di archiviazione**.</span><span class="sxs-lookup"><span data-stu-id="f0a16-135">Click **Storage Account** to select the storage account to use, and choose either the **Primary key** or **Secondary key** to use from the **Storage Key** drop-down.</span></span> <span data-ttu-id="f0a16-136">È necessario scegliere un account di archiviazione nella stessa area della cache ed è consigliato un account **Archiviazione Premium** , poiché archiviazione premium ha una velocità effettiva maggiore.</span><span class="sxs-lookup"><span data-stu-id="f0a16-136">You must choose a storage account in the same region as the cache, and a **Premium Storage** account is recommended because premium storage has higher throughput.</span></span> 

> [!IMPORTANT]
> <span data-ttu-id="f0a16-137">Se la chiave di archiviazione per l'account di persistenza viene rigenerata, è necessario riconfigurare la chiave desiderata dall'elenco a discesa **Chiave di archiviazione**.</span><span class="sxs-lookup"><span data-stu-id="f0a16-137">If the storage key for your persistence account is regenerated, you must reconfigure the desired key from the **Storage Key** drop-down.</span></span>
> 
> 

<span data-ttu-id="f0a16-138">Fare clic su **OK** per salvare la configurazione della persistenza.</span><span class="sxs-lookup"><span data-stu-id="f0a16-138">Click **OK** to save the persistence configuration.</span></span>

<span data-ttu-id="f0a16-139">Una volta trascorso l'intervallo di frequenza di backup, viene avviato il backup successivo (o il primo backup per le nuove cache).</span><span class="sxs-lookup"><span data-stu-id="f0a16-139">The next backup (or first backup for new caches) is initiated once the backup frequency interval elapses.</span></span>

## <a name="configure-aof-persistence"></a><span data-ttu-id="f0a16-140">Configurare la persistenza AOF</span><span class="sxs-lookup"><span data-stu-id="f0a16-140">Configure AOF persistence</span></span>

<span data-ttu-id="f0a16-141">Per abilitare la persistenza AOF, fare clic su **AOF**.</span><span class="sxs-lookup"><span data-stu-id="f0a16-141">To enable AOF persistence, click **AOF**.</span></span> <span data-ttu-id="f0a16-142">Per disabilitare la persistenza AOF in una cache premium precedentemente abilitata, fare clic su **Disabilita**.</span><span class="sxs-lookup"><span data-stu-id="f0a16-142">To disable AOF persistence on a previously enabled premium cache, click **Disabled**.</span></span>

![Persistenza AOF di Redis][redis-cache-aof-persistence]

<span data-ttu-id="f0a16-144">Per configurare la persistenza AOF, specificare un **primo account di archiviazione**.</span><span class="sxs-lookup"><span data-stu-id="f0a16-144">To configure AOF persistence, specify a **First Storage Account**.</span></span> <span data-ttu-id="f0a16-145">Questo account deve trovarsi nella stessa area della cache e deve essere preferibilmente un account di **Archiviazione Premium** perché questo tipo di archiviazione offre una velocità effettiva superiore.</span><span class="sxs-lookup"><span data-stu-id="f0a16-145">This storage account must be in the same region as the cache, and a **Premium Storage** account is recommended because premium storage has higher throughput.</span></span> <span data-ttu-id="f0a16-146">Facoltativamente, è possibile configurare un account di archiviazione aggiuntivo denominato **secondo account di archiviazione**.</span><span class="sxs-lookup"><span data-stu-id="f0a16-146">You can optionally configure an additional storage account named **Second Storage Account**.</span></span> <span data-ttu-id="f0a16-147">Se si configura un secondo account di archiviazione, è qui che vengono scritte le operazioni di scrittura alla cache di replica.</span><span class="sxs-lookup"><span data-stu-id="f0a16-147">If a second storage account is configured, the writes to the replica cache are written to this second storage account.</span></span> <span data-ttu-id="f0a16-148">Per ogni account di archiviazione configurato, scegliere la **Chiave primaria** o la **Chiave secondaria** da usare dall'elenco a discesa **Chiave di archiviazione**.</span><span class="sxs-lookup"><span data-stu-id="f0a16-148">For each configured storage account, choose either the **Primary key** or **Secondary key** to use from the **Storage Key** drop-down.</span></span> 

> [!IMPORTANT]
> <span data-ttu-id="f0a16-149">Se la chiave di archiviazione per l'account di persistenza viene rigenerata, è necessario riconfigurare la chiave desiderata dall'elenco a discesa **Chiave di archiviazione**.</span><span class="sxs-lookup"><span data-stu-id="f0a16-149">If the storage key for your persistence account is regenerated, you must reconfigure the desired key from the **Storage Key** drop-down.</span></span>
> 
> 

<span data-ttu-id="f0a16-150">Quando la persistenza AOF è abilitata, le operazioni di scrittura alla cache vengono salvate nell'account di archiviazione designato (o negli account se è stato configurato un secondo account di archiviazione).</span><span class="sxs-lookup"><span data-stu-id="f0a16-150">When AOF persistence is enabled, write operations to the cache are saved to the designated storage account (or accounts if you have configured a second storage account).</span></span> <span data-ttu-id="f0a16-151">In caso di un errore irreversibile che danneggia sia la cache primaria che quella di replica, viene usato il log AOF archiviato per ricreare la cache.</span><span class="sxs-lookup"><span data-stu-id="f0a16-151">In the event of a catastrophic failure that takes down both the primary and replica cache, the stored AOF log is used to rebuild the cache.</span></span>

## <a name="persistence-faq"></a><span data-ttu-id="f0a16-152">Domande frequenti sulla persistenza</span><span class="sxs-lookup"><span data-stu-id="f0a16-152">Persistence FAQ</span></span>
<span data-ttu-id="f0a16-153">Nell'elenco seguente sono fornite le risposte alle domande poste comunemente sulla persistenza di Cache Redis di Azure.</span><span class="sxs-lookup"><span data-stu-id="f0a16-153">The following list contains answers to commonly asked questions about Azure Redis Cache persistence.</span></span>

* [<span data-ttu-id="f0a16-154">È possibile abilitare la persistenza per una cache creata in precedenza?</span><span class="sxs-lookup"><span data-stu-id="f0a16-154">Can I enable persistence on a previously created cache?</span></span>](#can-i-enable-persistence-on-a-previously-created-cache)
* [<span data-ttu-id="f0a16-155">È possibile abilitare la persistenza AOF e RDB allo stesso tempo?</span><span class="sxs-lookup"><span data-stu-id="f0a16-155">Can I enable AOF and RDB persistence at the same time?</span></span>](#can-i-enable-aof-and-rdb-persistence-at-the-same-time)
* [<span data-ttu-id="f0a16-156">Quale modello di persistenza è consigliabile scegliere?</span><span class="sxs-lookup"><span data-stu-id="f0a16-156">Which persistence model should I choose?</span></span>](#which-persistence-model-should-i-choose)
* [<span data-ttu-id="f0a16-157">Cosa accade se si è passati a una dimensione diversa e viene ripristinato un backup creato prima dell'operazione di ridimensionamento?</span><span class="sxs-lookup"><span data-stu-id="f0a16-157">What happens if I have scaled to a different size and a backup is restored that was made before the scaling operation?</span></span>](#what-happens-if-i-have-scaled-to-a-different-size-and-a-backup-is-restored-that-was-made-before-the-scaling-operation)


### <a name="rdb-persistence"></a><span data-ttu-id="f0a16-158">Persistenza RDB</span><span class="sxs-lookup"><span data-stu-id="f0a16-158">RDB persistence</span></span>
* [<span data-ttu-id="f0a16-159">È possibile modificare la frequenza di backup RDB dopo avere creato la cache?</span><span class="sxs-lookup"><span data-stu-id="f0a16-159">Can I change the RDB backup frequency after I create the cache?</span></span>](#can-i-change-the-rdb-backup-frequency-after-i-create-the-cache)
* [<span data-ttu-id="f0a16-160">Perché trascorrono più di 60 minuti tra i backup se è stata impostata una frequenza di backup RDB di 60 minuti?</span><span class="sxs-lookup"><span data-stu-id="f0a16-160">Why if I have an RDB backup frequency of 60 minutes there is more than 60 minutes between backups?</span></span>](#why-if-i-have-an-rdb-backup-frequency-of-60-minutes-there-is-more-than-60-minutes-between-backups)
* [<span data-ttu-id="f0a16-161">Cosa accade ai backup RDB precedenti quando viene eseguito un nuovo backup?</span><span class="sxs-lookup"><span data-stu-id="f0a16-161">What happens to the old RDB backups when a new backup is made?</span></span>](#what-happens-to-the-old-rdb-backups-when-a-new-backup-is-made)

### <a name="aof-persistence"></a><span data-ttu-id="f0a16-162">Persistenza AOF</span><span class="sxs-lookup"><span data-stu-id="f0a16-162">AOF persistence</span></span>
* [<span data-ttu-id="f0a16-163">Quando è consigliabile usare un secondo account di archiviazione?</span><span class="sxs-lookup"><span data-stu-id="f0a16-163">When should I use a second storage account?</span></span>](#when-should-i-use-a-second-storage-account)
* [<span data-ttu-id="f0a16-164">La persistenza AOF influisce sulla velocità effettiva, la latenza o le prestazioni della cache?</span><span class="sxs-lookup"><span data-stu-id="f0a16-164">Does AOF persistence affect throughout, latency, or performance of my cache?</span></span>](#does-aof-persistence-affect-throughout-latency-or-performance-of-my-cache)
* [<span data-ttu-id="f0a16-165">Come si rimuove il secondo account di archiviazione?</span><span class="sxs-lookup"><span data-stu-id="f0a16-165">How can I remove the second storage account?</span></span>](#how-can-i-remove-the-second-storage-account)
* [<span data-ttu-id="f0a16-166">Che cos'è un'operazione di riscrittura e in che modo influisce sulla cache?</span><span class="sxs-lookup"><span data-stu-id="f0a16-166">What is a rewrite and how does it affect my cache?</span></span>](#what-is-a-rewrite-and-how-does-it-affect-my-cache)
* [<span data-ttu-id="f0a16-167">Quali potrebbero essere gli effetti del ridimensionamento di una cache con la persistenza AOF abilitata?</span><span class="sxs-lookup"><span data-stu-id="f0a16-167">What should I expect when scaling a cache with AOF enabled?</span></span>](#what-should-i-expect-when-scaling-a-cache-with-aof-enabled)
* [<span data-ttu-id="f0a16-168">Come vengono organizzati i dati AOF nello spazio di archiviazione?</span><span class="sxs-lookup"><span data-stu-id="f0a16-168">How is my AOF data organized in storage?</span></span>](#how-is-my-aof-data-organized-in-storage)


### <a name="can-i-enable-persistence-on-a-previously-created-cache"></a><span data-ttu-id="f0a16-169">È possibile abilitare la persistenza per una cache creata in precedenza?</span><span class="sxs-lookup"><span data-stu-id="f0a16-169">Can I enable persistence on a previously created cache?</span></span>
<span data-ttu-id="f0a16-170">Sì, la persistenza di Redis può essere configurata sia al momento della creazione della cache che nelle cache premium esistenti.</span><span class="sxs-lookup"><span data-stu-id="f0a16-170">Yes, Redis persistence can be configured both at cache creation and on existing premium caches.</span></span>

### <a name="can-i-enable-aof-and-rdb-persistence-at-the-same-time"></a><span data-ttu-id="f0a16-171">È possibile abilitare la persistenza AOF e RDB allo stesso tempo?</span><span class="sxs-lookup"><span data-stu-id="f0a16-171">Can I enable AOF and RDB persistence at the same time?</span></span>

<span data-ttu-id="f0a16-172">No, è necessario scegliere una delle due. Non è possibile usarle entrambe contemporaneamente.</span><span class="sxs-lookup"><span data-stu-id="f0a16-172">No, you can enable only RDB or AOF, but not both at the same time.</span></span>

### <a name="which-persistence-model-should-i-choose"></a><span data-ttu-id="f0a16-173">Quale modello di persistenza è consigliabile scegliere?</span><span class="sxs-lookup"><span data-stu-id="f0a16-173">Which persistence model should I choose?</span></span>

<span data-ttu-id="f0a16-174">La persistenza AOF salva ogni operazione di scrittura in un log e questa operazione ha un certo impatto sulla velocità effettiva. La persistenza RDB invece salva i backup in base all'intervallo di backup configurato con un impatto minimo sulle prestazioni.</span><span class="sxs-lookup"><span data-stu-id="f0a16-174">AOF persistence saves every write to a log, which has some impact on throughput, compared with RDB persistence which saves backups based on the configured backup interval, with minimal impact on performance.</span></span> <span data-ttu-id="f0a16-175">È consigliabile scegliere la persistenza AOF se lo scopo principale è ridurre al minimo la perdita di dati e si è in grado di gestire una diminuzione della velocità effettiva per la cache.</span><span class="sxs-lookup"><span data-stu-id="f0a16-175">Choose AOF persistence if your primary goal is to minimize data loss, and you can handle a decrease in throughput for your cache.</span></span> <span data-ttu-id="f0a16-176">Se si desidera invece mantenere la velocità effettiva ottimale nella cache e avere comunque un meccanismo per il ripristino dei dati, è preferibile scegliere la persistenza RDB.</span><span class="sxs-lookup"><span data-stu-id="f0a16-176">Choose RDB persistence if you wish to maintain optimal throughput on your cache, but still want a mechanism for data recovery.</span></span>

* <span data-ttu-id="f0a16-177">Altre informazioni sono disponibili sui [vantaggi](https://redis.io/topics/persistence#rdb-advantages) e gli [svantaggi](https://redis.io/topics/persistence#rdb-disadvantages) della persistenza RDB.</span><span class="sxs-lookup"><span data-stu-id="f0a16-177">Learn more about the [advantages](https://redis.io/topics/persistence#rdb-advantages) and [disadvantages](https://redis.io/topics/persistence#rdb-disadvantages) of RDB persistence.</span></span>
* <span data-ttu-id="f0a16-178">Altre informazioni sono disponibili sui [vantaggi](https://redis.io/topics/persistence#aof-advantages) e gli [svantaggi](https://redis.io/topics/persistence#aof-disadvantages) della persistenza AOF.</span><span class="sxs-lookup"><span data-stu-id="f0a16-178">Learn more about the [advantages](https://redis.io/topics/persistence#aof-advantages) and [disadvantages](https://redis.io/topics/persistence#aof-disadvantages) of AOF persistence.</span></span>

<span data-ttu-id="f0a16-179">Per altre informazioni sulle prestazioni quando si usa la persistenza AOF, vedere [La persistenza AOF influisce sulla velocità effettiva, la latenza o le prestazioni della cache?](#does-aof-persistence-affect-throughout-latency-or-performance-of-my-cache)</span><span class="sxs-lookup"><span data-stu-id="f0a16-179">For more information on performance when using AOF persistence, see [Does AOF persistence affect throughout, latency, or performance of my cache?](#does-aof-persistence-affect-throughout-latency-or-performance-of-my-cache)</span></span>

### <a name="what-happens-if-i-have-scaled-to-a-different-size-and-a-backup-is-restored-that-was-made-before-the-scaling-operation"></a><span data-ttu-id="f0a16-180">Cosa accade se si è passati a una dimensione diversa e viene ripristinato un backup creato prima dell'operazione di ridimensionamento?</span><span class="sxs-lookup"><span data-stu-id="f0a16-180">What happens if I have scaled to a different size and a backup is restored that was made before the scaling operation?</span></span>

<span data-ttu-id="f0a16-181">Per la persistenza sia RDB sia AOF:</span><span class="sxs-lookup"><span data-stu-id="f0a16-181">For both RDB and AOF persistence:</span></span>

* <span data-ttu-id="f0a16-182">Se si è passati a una dimensione maggiore, non ci sono conseguenze.</span><span class="sxs-lookup"><span data-stu-id="f0a16-182">If you have scaled to a larger size, there is no impact.</span></span>
* <span data-ttu-id="f0a16-183">Se si è passati a una dimensione minore e l'impostazione dei [database](cache-configure.md#databases) personalizzata è superiore al [limite dei database](cache-configure.md#databases) per la nuova dimensione, i dati di questi database non vengono ripristinati.</span><span class="sxs-lookup"><span data-stu-id="f0a16-183">If you have scaled to a smaller size, and you have a custom [databases](cache-configure.md#databases) setting that is greater than the [databases limit](cache-configure.md#databases) for your new size, data in those databases isn't restored.</span></span> <span data-ttu-id="f0a16-184">Per altre informazioni, vedere [L'impostazione databases personalizzata viene modificata durante il ridimensionamento?](cache-how-to-scale.md#is-my-custom-databases-setting-affected-during-scaling)</span><span class="sxs-lookup"><span data-stu-id="f0a16-184">For more information, see [Is my custom databases setting affected during scaling?](cache-how-to-scale.md#is-my-custom-databases-setting-affected-during-scaling)</span></span>
* <span data-ttu-id="f0a16-185">Se si è passati a una dimensione minore che non è abbastanza grande per contenere tutti i dati del backup più recente, le chiavi verranno rimosse durante il processo di ripristino, in genere usando il criterio di rimozione [allkeys-lru](http://redis.io/topics/lru-cache) .</span><span class="sxs-lookup"><span data-stu-id="f0a16-185">If you have scaled to a smaller size, and there isn't enough room in the smaller size to hold all of the data from the last backup, keys will be evicted during the restore process, typically using the [allkeys-lru](http://redis.io/topics/lru-cache) eviction policy.</span></span>

### <a name="can-i-change-the-rdb-backup-frequency-after-i-create-the-cache"></a><span data-ttu-id="f0a16-186">È possibile modificare la frequenza di backup RDB dopo avere creato la cache?</span><span class="sxs-lookup"><span data-stu-id="f0a16-186">Can I change the RDB backup frequency after I create the cache?</span></span>
<span data-ttu-id="f0a16-187">Sì, è possibile modificare la frequenza di backup per la persistenza RDB nel pannello **Persistenza dei dati di Redis**.</span><span class="sxs-lookup"><span data-stu-id="f0a16-187">Yes, you can change the backup frequency for RDB persistence on the **Redis data persistence** blade.</span></span> <span data-ttu-id="f0a16-188">Per istruzioni, vedere [Configurare la persistenza di Redis](#configure-redis-persistence).</span><span class="sxs-lookup"><span data-stu-id="f0a16-188">For instructions, see [Configure Redis persistence](#configure-redis-persistence).</span></span>

### <a name="why-if-i-have-an-rdb-backup-frequency-of-60-minutes-there-is-more-than-60-minutes-between-backups"></a><span data-ttu-id="f0a16-189">Perché trascorrono più di 60 minuti tra i backup se è stata impostata una frequenza di backup RDB di 60 minuti?</span><span class="sxs-lookup"><span data-stu-id="f0a16-189">Why if I have an RDB backup frequency of 60 minutes there is more than 60 minutes between backups?</span></span>
<span data-ttu-id="f0a16-190">L'intervallo di frequenza di backup della persistenza RDB inizia solo dopo il completamento del processo di backup precedente.</span><span class="sxs-lookup"><span data-stu-id="f0a16-190">The RDB persistence backup frequency interval does not start until the previous backup process has completed successfully.</span></span> <span data-ttu-id="f0a16-191">Se la frequenza di backup è 60 minuti e per il corretto completamento del processo di backup sono richiesti 15 minuti, il backup successivo verrà avviato solo 75 minuti dopo l'ora di inizio del backup precedente.</span><span class="sxs-lookup"><span data-stu-id="f0a16-191">If the backup frequency is 60 minutes and it takes a backup process 15 minutes to successfully complete, the next backup won't start until 75 minutes after the start time of the previous backup.</span></span>

### <a name="what-happens-to-the-old-rdb-backups-when-a-new-backup-is-made"></a><span data-ttu-id="f0a16-192">Cosa accade ai backup RDB precedenti quando viene eseguito un nuovo backup?</span><span class="sxs-lookup"><span data-stu-id="f0a16-192">What happens to the old RDB backups when a new backup is made?</span></span>
<span data-ttu-id="f0a16-193">A eccezione di quello più recente, tutti i backup della persistenza RDB vengono eliminati automaticamente.</span><span class="sxs-lookup"><span data-stu-id="f0a16-193">All RDB persistence backups except for the most recent one are automatically deleted.</span></span> <span data-ttu-id="f0a16-194">L'eliminazione potrebbe non avvenire immediatamente, ma i backup meno recenti non vengono mantenuti per un tempo illimitato.</span><span class="sxs-lookup"><span data-stu-id="f0a16-194">This deletion may not happen immediately but older backups are not persisted indefinitely.</span></span>


### <a name="when-should-i-use-a-second-storage-account"></a><span data-ttu-id="f0a16-195">Quando è consigliabile usare un secondo account di archiviazione?</span><span class="sxs-lookup"><span data-stu-id="f0a16-195">When should I use a second storage account?</span></span>

<span data-ttu-id="f0a16-196">È consigliabile usare un secondo account di archiviazione per la persistenza AOF quando si ritiene di avere un numero di operazioni set nella cache superiore a quello previsto.</span><span class="sxs-lookup"><span data-stu-id="f0a16-196">You should use a second storage account for AOF persistence when you believe you have higher than expected set operations on the cache.</span></span>  <span data-ttu-id="f0a16-197">L'impostazione del secondo account di archiviazione aiuta a garantire che la cache non raggiunga i limiti di larghezza di banda di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="f0a16-197">Setting up the secondary storage account helps ensure your cache doesn't reach storage bandwidth limits.</span></span>

### <a name="does-aof-persistence-affect-throughout-latency-or-performance-of-my-cache"></a><span data-ttu-id="f0a16-198">La persistenza AOF influisce sulla velocità effettiva, la latenza o le prestazioni della cache?</span><span class="sxs-lookup"><span data-stu-id="f0a16-198">Does AOF persistence affect throughout, latency, or performance of my cache?</span></span>

<span data-ttu-id="f0a16-199">La persistenza AOF influisce sulla velocità effettiva di circa il 15-20% quando la cache è al di sotto del carico massimo (carico di CPU e server inferiore al 90%).</span><span class="sxs-lookup"><span data-stu-id="f0a16-199">AOF persistence affects throughput by about 15% – 20% when the cache is below maximum load (CPU and Server Load both under 90%).</span></span> <span data-ttu-id="f0a16-200">Quando la cache lavora entro questi limiti, non si verificano problemi di latenza.</span><span class="sxs-lookup"><span data-stu-id="f0a16-200">There should not be latency issues when the cache is within these limits.</span></span> <span data-ttu-id="f0a16-201">La cache raggiunge tuttavia questi limiti prima con la persistenza AOF abilitata.</span><span class="sxs-lookup"><span data-stu-id="f0a16-201">However, the cache will reach these limits sooner with AOF enabled.</span></span>

### <a name="how-can-i-remove-the-second-storage-account"></a><span data-ttu-id="f0a16-202">Come si rimuove il secondo account di archiviazione?</span><span class="sxs-lookup"><span data-stu-id="f0a16-202">How can I remove the second storage account?</span></span>

<span data-ttu-id="f0a16-203">È possibile rimuovere l'account di archiviazione secondario della persistenza AOF impostandolo come il primo account di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="f0a16-203">You can remove the AOF persistence secondary storage account by setting the second storage account to be the same as the first storage account.</span></span> <span data-ttu-id="f0a16-204">Per istruzioni, vedere [Configurare la persistenza AOF](#configure-aof-persistence).</span><span class="sxs-lookup"><span data-stu-id="f0a16-204">For instructions, see [Configure AOF persistence](#configure-aof-persistence).</span></span>

### <a name="what-is-a-rewrite-and-how-does-it-affect-my-cache"></a><span data-ttu-id="f0a16-205">Che cos'è un'operazione di riscrittura e in che modo influisce sulla cache?</span><span class="sxs-lookup"><span data-stu-id="f0a16-205">What is a rewrite and how does it affect my cache?</span></span>

<span data-ttu-id="f0a16-206">Quando il file AOF diventa sufficientemente grande, viene automaticamente accodata una riscrittura nella cache.</span><span class="sxs-lookup"><span data-stu-id="f0a16-206">When the AOF file becomes large enough, a rewrite is automatically queued on the cache.</span></span> <span data-ttu-id="f0a16-207">L'operazione di riscrittura ridimensiona il file AOF con il set minimo di operazioni necessarie per creare il set di dati corrente.</span><span class="sxs-lookup"><span data-stu-id="f0a16-207">The rewrite resizes the AOF file with the minimal set of operations needed to create the current data set.</span></span> <span data-ttu-id="f0a16-208">Durante l'operazione di riscrittura è normale raggiungere prima i limiti di prestazioni, soprattutto quando si usano grandi set di dati.</span><span class="sxs-lookup"><span data-stu-id="f0a16-208">During rewrites, expect to reach performance limits sooner especially when dealing with large datasets.</span></span> <span data-ttu-id="f0a16-209">L'operazione di riscrittura avviene meno spesso man mano che il file AOF diventa più grande, ma quando a quel punto si renderà necessaria, richiederà molto più tempo.</span><span class="sxs-lookup"><span data-stu-id="f0a16-209">Rewrites occur less often as the AOF file becomes larger, but will take a significant amount of time when it happens.</span></span>

### <a name="what-should-i-expect-when-scaling-a-cache-with-aof-enabled"></a><span data-ttu-id="f0a16-210">Quali potrebbero essere gli effetti del ridimensionamento di una cache con la persistenza AOF abilitata?</span><span class="sxs-lookup"><span data-stu-id="f0a16-210">What should I expect when scaling a cache with AOF enabled?</span></span>

<span data-ttu-id="f0a16-211">Se il file AOF al momento del ridimensionamento è molto grande, l'operazione di ridimensionamento richiede più tempo del previsto perché ricarica il file dopo che il ridimensionamento è stato completato.</span><span class="sxs-lookup"><span data-stu-id="f0a16-211">If the AOF file at the time of scaling is significantly large, then expect the scale operation to take longer than expected since it will be reloading the file after scaling has finished.</span></span>

<span data-ttu-id="f0a16-212">Per altre informazioni sul ridimensionamento, vedere [Cosa accade se si è passati a una dimensione diversa e viene ripristinato un backup creato prima dell'operazione di ridimensionamento?](#what-happens-if-i-have-scaled-to-a-different-size-and-a-backup-is-restored-that-was-made-before-the-scaling-operation)</span><span class="sxs-lookup"><span data-stu-id="f0a16-212">For more information on scaling, see [What happens if I have scaled to a different size and a backup is restored that was made before the scaling operation?](#what-happens-if-i-have-scaled-to-a-different-size-and-a-backup-is-restored-that-was-made-before-the-scaling-operation)</span></span>

### <a name="how-is-my-aof-data-organized-in-storage"></a><span data-ttu-id="f0a16-213">Come vengono organizzati i dati AOF nello spazio di archiviazione?</span><span class="sxs-lookup"><span data-stu-id="f0a16-213">How is my AOF data organized in storage?</span></span>

<span data-ttu-id="f0a16-214">I dati archiviati nei file AOF sono suddivisi in più BLOB di pagine per ogni nodo per migliorare le prestazioni nel salvataggio dei dati nello spazio di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="f0a16-214">Data stored in AOF files is divided into multiple page blobs per node to increase performance of saving the data to storage.</span></span> <span data-ttu-id="f0a16-215">La tabella seguente illustra il numero di BLOB di pagine usato per ogni piano tariffario:</span><span class="sxs-lookup"><span data-stu-id="f0a16-215">The following table displays how many page blobs are used for each pricing tier:</span></span>

| <span data-ttu-id="f0a16-216">Livello Premium</span><span class="sxs-lookup"><span data-stu-id="f0a16-216">Premium tier</span></span> | <span data-ttu-id="f0a16-217">Blobs</span><span class="sxs-lookup"><span data-stu-id="f0a16-217">Blobs</span></span> |
|--------------|-------|
| <span data-ttu-id="f0a16-218">P1</span><span class="sxs-lookup"><span data-stu-id="f0a16-218">P1</span></span>           | <span data-ttu-id="f0a16-219">4 per partizione</span><span class="sxs-lookup"><span data-stu-id="f0a16-219">4 per shard</span></span>    |
| <span data-ttu-id="f0a16-220">P2</span><span class="sxs-lookup"><span data-stu-id="f0a16-220">P2</span></span>           | <span data-ttu-id="f0a16-221">8 per partizione</span><span class="sxs-lookup"><span data-stu-id="f0a16-221">8 per shard</span></span>    |
| <span data-ttu-id="f0a16-222">P3</span><span class="sxs-lookup"><span data-stu-id="f0a16-222">P3</span></span>           | <span data-ttu-id="f0a16-223">16 per partizione</span><span class="sxs-lookup"><span data-stu-id="f0a16-223">16 per shard</span></span>   |
| <span data-ttu-id="f0a16-224">P4</span><span class="sxs-lookup"><span data-stu-id="f0a16-224">P4</span></span>           | <span data-ttu-id="f0a16-225">20 per partizione</span><span class="sxs-lookup"><span data-stu-id="f0a16-225">20 per shard</span></span>   |

<span data-ttu-id="f0a16-226">Quando è abilitato il clustering, ogni partizione nella cache ha un proprio set di BLOB di pagine, come indicato nella tabella precedente.</span><span class="sxs-lookup"><span data-stu-id="f0a16-226">When clustering is enabled, each shard in the cache has its own set of page blobs, as indicated in the previous table.</span></span> <span data-ttu-id="f0a16-227">Una cache P2 con tre partizioni, ad esempio, distribuisce il proprio file AOF su 24 BLOB di pagine (8 BLOB per partizione, con 3 partizioni).</span><span class="sxs-lookup"><span data-stu-id="f0a16-227">For example, a P2 cache with three shards distributes its AOF file across 24 page blobs (8 blobs per shard, with 3 shards).</span></span>

<span data-ttu-id="f0a16-228">Dopo una riscrittura, nello spazio di archiviazione sono presenti due set di file AOF.</span><span class="sxs-lookup"><span data-stu-id="f0a16-228">After a rewrite, two sets of AOF files exist in storage.</span></span> <span data-ttu-id="f0a16-229">L'operazione di riscrittura avviene in background e si accoda al primo set di file, mentre le operazioni set che vengono inviate alla cache durante la riscrittura si accodano al secondo set.</span><span class="sxs-lookup"><span data-stu-id="f0a16-229">Rewrites occur in the background and append to the first set of files, while set operations that are sent to the cache during the rewrite append to the second set.</span></span> <span data-ttu-id="f0a16-230">Una copia di backup viene archiviata temporaneamente durante la riscrittura in caso di errore, ma viene eliminata immediatamente dopo il completamento della riscrittura.</span><span class="sxs-lookup"><span data-stu-id="f0a16-230">A backup is temporarily stored during rewrites in case of failure, but is promptly deleted after a rewrite finishes.</span></span>


## <a name="next-steps"></a><span data-ttu-id="f0a16-231">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="f0a16-231">Next steps</span></span>
<span data-ttu-id="f0a16-232">Informazioni su come usare altre funzionalità di cache premium.</span><span class="sxs-lookup"><span data-stu-id="f0a16-232">Learn how to use more premium cache features.</span></span>

* [<span data-ttu-id="f0a16-233">Introduzione al piano Premium di Cache Redis di Azure</span><span class="sxs-lookup"><span data-stu-id="f0a16-233">Introduction to the Azure Redis Cache Premium tier</span></span>](cache-premium-tier-intro.md)

<!-- IMAGES -->

[redis-cache-premium-pricing-tier]: ./media/cache-how-to-premium-persistence/redis-cache-premium-pricing-tier.png

[redis-cache-persistence]: ./media/cache-how-to-premium-persistence/redis-cache-persistence.png

[redis-cache-rdb-persistence]: ./media/cache-how-to-premium-persistence/redis-cache-rdb-persistence.png

[redis-cache-aof-persistence]: ./media/cache-how-to-premium-persistence/redis-cache-aof-persistence.png

[redis-cache-settings]: ./media/cache-how-to-premium-persistence/redis-cache-settings.png
