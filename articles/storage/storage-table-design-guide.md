---
title: Guida alla progettazione di archiviazione tabella aaaAzure | Documenti Microsoft
description: Progettare tabelle scalabili ed efficienti in Archiviazione tabelle di Azure
services: storage
documentationcenter: na
author: jasonnewyork
manager: tadb
editor: tysonn
ms.assetid: 8e228b0c-2998-4462-8101-9f16517393ca
ms.service: storage
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: storage
ms.date: 02/28/2017
ms.author: jahogg
ms.openlocfilehash: bbac5e83fe994c1ba1408dd43367fbcfca6a2148
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/06/2017
---
# <a name="azure-storage-table-design-guide-designing-scalable-and-performant-tables"></a><span data-ttu-id="dc5a6-103">Guida alla progettazione della tabella di archiviazione di Azure: Progettazione scalabile e Tabelle ad alte prestazioni </span><span class="sxs-lookup"><span data-stu-id="dc5a6-103">Azure Storage Table Design Guide: Designing Scalable and Performant Tables</span></span>
[!INCLUDE [storage-table-cosmos-db-tip-include](../../includes/storage-table-cosmos-db-tip-include.md)]

<span data-ttu-id="dc5a6-104">toodesign scalabile e ad alte prestazioni tabelle è necessario considerare diversi fattori, ad esempio prestazioni, scalabilità e costi.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-104">toodesign scalable and performant tables you must consider a number of factors such as performance, scalability, and cost.</span></span> <span data-ttu-id="dc5a6-105">Se è stato creato in precedenza gli schemi per i database relazionali, queste considerazioni sarà tooyou familiare, ma sono presenti alcune somiglianze tra modello di archiviazione del servizio tabelle di Azure hello e i modelli relazionali, esistono anche molti importanti differenze.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-105">If you have previously designed schemas for relational databases, these considerations will be familiar tooyou, but while there are some similarities between hello Azure Table service storage model and relational models, there are also many important differences.</span></span> <span data-ttu-id="dc5a6-106">In genere queste differenze determinano inevitabilmente un toovery diverse progettazioni che potrebbero essere poco plausibile o errato toosomeone familiarità con i database relazionali, ma cui effettuare una scelta appropriata se si sta progettando per un archivio chiave-valore NoSQL, ad esempio hello del servizio tabelle di Azure.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-106">These differences typically lead toovery different designs that may look counter-intuitive or wrong toosomeone familiar with relational databases, but which do make good sense if you are designing for a NoSQL key/value store such as hello Azure Table service.</span></span> <span data-ttu-id="dc5a6-107">Molte delle differenze di progettazione del rifletterà hello fatto che il servizio di tabella hello toosupport progettato le applicazioni a livello di cloud che possono contenere anche su miliardi di entità (righe nella terminologia dei database relazionali) dei dati o per i set di dati che devono essere supportati molto elevato volumi di transazioni: pertanto, è necessario toothink in modo diverso sulla modalità di archiviazione dei dati e comprendere il funzionamento di hello del servizio tabelle.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-107">Many of your design differences will reflect hello fact that hello Table service is designed toosupport cloud-scale applications that can contain billions of entities (rows in relational database terminology) of data or for datasets that must support very high transaction volumes: therefore, you need toothink differently about how you store your data and understand how hello Table service works.</span></span> <span data-ttu-id="dc5a6-108">Archivio dati NoSQL ben progettato è possibile abilitare tooscale la soluzione maggiore (e a un costo inferiore) rispetto a una soluzione che utilizza un database relazionale.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-108">A well designed NoSQL data store can enable your solution tooscale much further (and at a lower cost) than a solution that uses a relational database.</span></span> <span data-ttu-id="dc5a6-109">Questa guida illustra proprio questi argomenti.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-109">This guide helps you with these topics.</span></span>  

## <a name="about-hello-azure-table-service"></a><span data-ttu-id="dc5a6-110">Su hello del servizio tabelle di Azure</span><span class="sxs-lookup"><span data-stu-id="dc5a6-110">About hello Azure Table service</span></span>
<span data-ttu-id="dc5a6-111">In questa sezione illustra alcune hello le funzionalità principali di servizio tabelle hello che sono particolarmente rilevanti toodesigning per prestazioni e scalabilità.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-111">This section highlights some of hello key features of hello Table service that are especially relevant toodesigning for performance and scalability.</span></span> <span data-ttu-id="dc5a6-112">Se si tooAzure nuova archiviazione e del servizio tabelle hello, leggere prima [tooMicrosoft introduzione di archiviazione di Azure](storage-introduction.md) e [Introduzione all'archiviazione tabelle di Azure usando .NET](storage-dotnet-how-to-use-tables.md) prima di leggere il resto di hello del articolo.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-112">If you are new tooAzure Storage and hello Table service, first read [Introduction tooMicrosoft Azure Storage](storage-introduction.md) and [Get started with Azure Table Storage using .NET](storage-dotnet-how-to-use-tables.md) before reading hello remainder of this article.</span></span> <span data-ttu-id="dc5a6-113">Sebbene hello di questa guida è attiva hello del servizio tabelle, che include alcuni discussione di hello coda di Azure e i servizi Blob e come è possibile utilizzare insieme hello del servizio tabelle in una soluzione.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-113">Although hello focus of this guide is on hello Table service, it will include some discussion of hello Azure Queue and Blob services, and how you might use them along with hello Table service in a solution.</span></span>  

<span data-ttu-id="dc5a6-114">Novità del servizio tabelle hello?</span><span class="sxs-lookup"><span data-stu-id="dc5a6-114">What is hello Table service?</span></span> <span data-ttu-id="dc5a6-115">Come previsto dal nome hello, hello del servizio tabelle utilizza i dati di toostore un formato tabulare.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-115">As you might expect from hello name, hello Table service uses a tabular format toostore data.</span></span> <span data-ttu-id="dc5a6-116">Nella terminologia standard hello, ogni riga della tabella hello rappresenta un'entità e archivio colonne hello hello varie proprietà di tale entità.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-116">In hello standard terminology, each row of hello table represents an entity, and hello columns store hello various properties of that entity.</span></span> <span data-ttu-id="dc5a6-117">Ogni entità dispone di una coppia di chiavi toouniquely identificarlo e una colonna timestamp che hello del servizio tabelle utilizza tootrack dell'ultimo aggiornamento entità hello (ciò avviene automaticamente e non è possibile sovrascrivere manualmente hello timestamp con un valore arbitrario).</span><span class="sxs-lookup"><span data-stu-id="dc5a6-117">Every entity has a pair of keys toouniquely identify it, and a timestamp column that hello Table service uses tootrack when hello entity was last updated (this happens automatically and you cannot manually overwrite hello timestamp with an arbitrary value).</span></span> <span data-ttu-id="dc5a6-118">Hello del servizio tabelle utilizza questo timestamp ultima modifica (LMT) toomanage la concorrenza ottimistica.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-118">hello Table service uses this last-modified timestamp (LMT) toomanage optimistic concurrency.</span></span>  

> [!NOTE]
> <span data-ttu-id="dc5a6-119">operazioni API REST del servizio tabelle Hello inoltre restituiranno un **ETag** valore da cui deriva il timestamp di ultima modifica di hello (LMT).</span><span class="sxs-lookup"><span data-stu-id="dc5a6-119">hello Table service REST API operations also return an **ETag** value that it derives from hello last-modified timestamp (LMT).</span></span> <span data-ttu-id="dc5a6-120">In questo documento si utilizzerà hello termini ETag e LMT indifferentemente perché fanno riferimento toohello stessi dati sottostanti.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-120">In this document we will use hello terms ETag and LMT interchangeably because they refer toohello same underlying data.</span></span>  
> 
> 

<span data-ttu-id="dc5a6-121">Hello riportato di seguito toostore di progettazione una semplice tabella entità dipendente e reparto.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-121">hello following example shows a simple table design toostore employee and department entities.</span></span> <span data-ttu-id="dc5a6-122">Molti degli esempi di hello illustrati più avanti in questa guida si basano su questo progetto semplice.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-122">Many of hello examples shown later in this guide are based on this simple design.</span></span>  

<table>
<tr>
<th><span data-ttu-id="dc5a6-123">PartitionKey</span><span class="sxs-lookup"><span data-stu-id="dc5a6-123">PartitionKey</span></span></th>
<th><span data-ttu-id="dc5a6-124">RowKey</span><span class="sxs-lookup"><span data-stu-id="dc5a6-124">RowKey</span></span></th>
<th><span data-ttu-id="dc5a6-125">Timestamp</span><span class="sxs-lookup"><span data-stu-id="dc5a6-125">Timestamp</span></span></th>
<th></th>
</tr>
<tr>
<td><span data-ttu-id="dc5a6-126">Marketing</span><span class="sxs-lookup"><span data-stu-id="dc5a6-126">Marketing</span></span></td>
<td><span data-ttu-id="dc5a6-127">00001</span><span class="sxs-lookup"><span data-stu-id="dc5a6-127">00001</span></span></td>
<td><span data-ttu-id="dc5a6-128">2014-08-22T00:50:32Z</span><span class="sxs-lookup"><span data-stu-id="dc5a6-128">2014-08-22T00:50:32Z</span></span></td>
<td>
<table>
<tr>
<th><span data-ttu-id="dc5a6-129">FirstName</span><span class="sxs-lookup"><span data-stu-id="dc5a6-129">FirstName</span></span></th>
<th><span data-ttu-id="dc5a6-130">LastName</span><span class="sxs-lookup"><span data-stu-id="dc5a6-130">LastName</span></span></th>
<th><span data-ttu-id="dc5a6-131">Age</span><span class="sxs-lookup"><span data-stu-id="dc5a6-131">Age</span></span></th>
<th><span data-ttu-id="dc5a6-132">Email</span><span class="sxs-lookup"><span data-stu-id="dc5a6-132">Email</span></span></th>
</tr>
<tr>
<td><span data-ttu-id="dc5a6-133">Don</span><span class="sxs-lookup"><span data-stu-id="dc5a6-133">Don</span></span></td>
<td><span data-ttu-id="dc5a6-134">Hall</span><span class="sxs-lookup"><span data-stu-id="dc5a6-134">Hall</span></span></td>
<td><span data-ttu-id="dc5a6-135">34</span><span class="sxs-lookup"><span data-stu-id="dc5a6-135">34</span></span></td>
<td>donh@contoso.com</td>
</tr>
</table>
</tr>
<tr>
<td><span data-ttu-id="dc5a6-136">Marketing</span><span class="sxs-lookup"><span data-stu-id="dc5a6-136">Marketing</span></span></td>
<td><span data-ttu-id="dc5a6-137">00002</span><span class="sxs-lookup"><span data-stu-id="dc5a6-137">00002</span></span></td>
<td><span data-ttu-id="dc5a6-138">2014-08-22T00:50:34Z</span><span class="sxs-lookup"><span data-stu-id="dc5a6-138">2014-08-22T00:50:34Z</span></span></td>
<td>
<table>
<tr>
<th><span data-ttu-id="dc5a6-139">FirstName</span><span class="sxs-lookup"><span data-stu-id="dc5a6-139">FirstName</span></span></th>
<th><span data-ttu-id="dc5a6-140">LastName</span><span class="sxs-lookup"><span data-stu-id="dc5a6-140">LastName</span></span></th>
<th><span data-ttu-id="dc5a6-141">Age</span><span class="sxs-lookup"><span data-stu-id="dc5a6-141">Age</span></span></th>
<th><span data-ttu-id="dc5a6-142">Email</span><span class="sxs-lookup"><span data-stu-id="dc5a6-142">Email</span></span></th>
</tr>
<tr>
<td><span data-ttu-id="dc5a6-143">Jun</span><span class="sxs-lookup"><span data-stu-id="dc5a6-143">Jun</span></span></td>
<td><span data-ttu-id="dc5a6-144">Cao</span><span class="sxs-lookup"><span data-stu-id="dc5a6-144">Cao</span></span></td>
<td><span data-ttu-id="dc5a6-145">47</span><span class="sxs-lookup"><span data-stu-id="dc5a6-145">47</span></span></td>
<td>junc@contoso.com</td>
</tr>
</table>
</tr>
<tr>
<td><span data-ttu-id="dc5a6-146">Marketing</span><span class="sxs-lookup"><span data-stu-id="dc5a6-146">Marketing</span></span></td>
<td><span data-ttu-id="dc5a6-147">Department</span><span class="sxs-lookup"><span data-stu-id="dc5a6-147">Department</span></span></td>
<td><span data-ttu-id="dc5a6-148">2014-08-22T00:50:30Z</span><span class="sxs-lookup"><span data-stu-id="dc5a6-148">2014-08-22T00:50:30Z</span></span></td>
<td>
<table>
<tr>
<th><span data-ttu-id="dc5a6-149">DepartmentName</span><span class="sxs-lookup"><span data-stu-id="dc5a6-149">DepartmentName</span></span></th>
<th><span data-ttu-id="dc5a6-150">EmployeeCount</span><span class="sxs-lookup"><span data-stu-id="dc5a6-150">EmployeeCount</span></span></th>
</tr>
<tr>
<td><span data-ttu-id="dc5a6-151">Marketing</span><span class="sxs-lookup"><span data-stu-id="dc5a6-151">Marketing</span></span></td>
<td><span data-ttu-id="dc5a6-152">153</span><span class="sxs-lookup"><span data-stu-id="dc5a6-152">153</span></span></td>
</tr>
</table>
</td>
</tr>
<tr>
<td><span data-ttu-id="dc5a6-153">Sales</span><span class="sxs-lookup"><span data-stu-id="dc5a6-153">Sales</span></span></td>
<td><span data-ttu-id="dc5a6-154">00010</span><span class="sxs-lookup"><span data-stu-id="dc5a6-154">00010</span></span></td>
<td><span data-ttu-id="dc5a6-155">2014-08-22T00:50:44Z</span><span class="sxs-lookup"><span data-stu-id="dc5a6-155">2014-08-22T00:50:44Z</span></span></td>
<td>
<table>
<tr>
<th><span data-ttu-id="dc5a6-156">FirstName</span><span class="sxs-lookup"><span data-stu-id="dc5a6-156">FirstName</span></span></th>
<th><span data-ttu-id="dc5a6-157">LastName</span><span class="sxs-lookup"><span data-stu-id="dc5a6-157">LastName</span></span></th>
<th><span data-ttu-id="dc5a6-158">Age</span><span class="sxs-lookup"><span data-stu-id="dc5a6-158">Age</span></span></th>
<th><span data-ttu-id="dc5a6-159">Email</span><span class="sxs-lookup"><span data-stu-id="dc5a6-159">Email</span></span></th>
</tr>
<tr>
<td><span data-ttu-id="dc5a6-160">Ken</span><span class="sxs-lookup"><span data-stu-id="dc5a6-160">Ken</span></span></td>
<td><span data-ttu-id="dc5a6-161">Kwok</span><span class="sxs-lookup"><span data-stu-id="dc5a6-161">Kwok</span></span></td>
<td><span data-ttu-id="dc5a6-162">23</span><span class="sxs-lookup"><span data-stu-id="dc5a6-162">23</span></span></td>
<td>kenk@contoso.com</td>
</tr>
</table>
</td>
</tr>
</table>


<span data-ttu-id="dc5a6-163">Finora, questa è molto simile tooa tabella in un database relazionale con le differenze principali di hello viene hello colonne obbligatorie e hello toostore possibilità entità più tipi in hello stessa tabella.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-163">So far, this looks very similar tooa table in a relational database with hello key differences being hello mandatory columns, and hello ability toostore multiple entity types in hello same table.</span></span> <span data-ttu-id="dc5a6-164">Inoltre, ogni hello proprietà definite dall'utente, ad esempio **FirstName** o **Age** ha un tipo di dati, ad esempio integer o string, solo come una colonna in un database relazionale.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-164">In addition, each of hello user-defined properties such as **FirstName** or **Age** has a data type, such as integer or string, just like a column in a relational database.</span></span> <span data-ttu-id="dc5a6-165">Anche se a differenza di un database relazionale, hello significa servizio di tabella che non deve avere una proprietà di natura senza schema hello hello stesso tipo di dati per ogni entità.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-165">Although unlike in a relational database, hello schema-less nature of hello Table service means that a property need not have hello same data type on each entity.</span></span> <span data-ttu-id="dc5a6-166">tipi di dati complessi toostore in una singola proprietà, è necessario utilizzare un formato serializzato come JSON o XML.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-166">toostore complex data types in a single property, you must use a serialized format such as JSON or XML.</span></span> <span data-ttu-id="dc5a6-167">Per ulteriori informazioni sui tipi di dati di hello tabella servizio supportato, ad esempio, gli intervalli di date supportato, le regole di denominazione e vincoli relativi alle dimensioni, vedere [hello comprensione modello di dati del servizio tabelle](http://msdn.microsoft.com/library/azure/dd179338.aspx).</span><span class="sxs-lookup"><span data-stu-id="dc5a6-167">For more information about hello table service such as supported data types, supported date ranges, naming rules, and size constraints, see [Understanding hello Table Service Data Model](http://msdn.microsoft.com/library/azure/dd179338.aspx).</span></span>

<span data-ttu-id="dc5a6-168">Come si vedrà, la scelta di **PartitionKey** e **RowKey** è fondamentale toogood progettazione della tabella.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-168">As you will see, your choice of **PartitionKey** and **RowKey** is fundamental toogood table design.</span></span> <span data-ttu-id="dc5a6-169">Ogni entità archiviata in una tabella deve avere una combinazione univoca di **PartitionKey** e **RowKey**.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-169">Every entity stored in a table must have a unique combination of **PartitionKey** and **RowKey**.</span></span> <span data-ttu-id="dc5a6-170">Come con chiavi in una tabella di database relazionale, hello **PartitionKey** e **RowKey** valori indicizzati toocreate un indice cluster che consente le ricerche veloci; hello del servizio tabelle, tuttavia, non viene creato alcun gli indici secondari, pertanto questi sono hello solo due indicizzati proprietà (alcuni dei modelli di hello descritti di seguito mostra come è possibile aggirare questa limitazione apparente).</span><span class="sxs-lookup"><span data-stu-id="dc5a6-170">As with keys in a relational database table, hello **PartitionKey** and **RowKey** values are indexed toocreate a clustered index that enables fast look-ups; however, hello Table service does not create any secondary indexes so these are hello only two indexed properties (some of hello patterns described later show how you can work around this apparent limitation).</span></span>  

<span data-ttu-id="dc5a6-171">Una tabella è costituita da una o più partizioni, e come si vedrà, molte di hello progettazione decisioni verrà intorno alla scelta di un oggetto utilizzabile **PartitionKey** e **RowKey** toooptimize la soluzione.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-171">A table is made up of one or more partitions, and as you will see, many of hello design decisions you make will be around choosing a suitable **PartitionKey** and **RowKey** toooptimize your solution.</span></span> <span data-ttu-id="dc5a6-172">Una soluzione può essere costituita da una sola tabella contenente tutte le entità organizzate in partizioni, ma normalmente una soluzione comprende più tabelle.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-172">A solution could consist of just a single table that contains all your entities organized into partitions, but typically a solution will have multiple tables.</span></span> <span data-ttu-id="dc5a6-173">Tabelle consentono di toologically organizzare le entità e consentono di gestire dati di accesso toohello mediante access control list, è possibile eliminare un'intera tabella utilizzando una singola operazione di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-173">Tables help you toologically organize your entities, help you manage access toohello data using access control lists, and you can drop an entire table using a single storage operation.</span></span>  

### <a name="table-partitions"></a><span data-ttu-id="dc5a6-174">Partizioni della tabella</span><span class="sxs-lookup"><span data-stu-id="dc5a6-174">Table partitions</span></span>
<span data-ttu-id="dc5a6-175">nome dell'account Hello, il nome di tabella e **PartitionKey** identificano insieme partizione hello all'interno del servizio di archiviazione hello in cui il servizio di tabella hello archivia entità hello.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-175">hello account name, table name and **PartitionKey** together identify hello partition within hello storage service where hello table service stores hello entity.</span></span> <span data-ttu-id="dc5a6-176">Oltre a far parte di hello allo schema per le entità di indirizzamento, le partizioni definiscono un ambito per le transazioni (vedere [gruppi di entità](#entity-group-transactions) sotto) e form di base hello di scalabilità di servizio tabelle hello.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-176">As well as being part of hello addressing scheme for entities, partitions define a scope for transactions (see [Entity Group Transactions](#entity-group-transactions) below), and form hello basis of how hello table service scales.</span></span> <span data-ttu-id="dc5a6-177">Per altre informazioni sulle partizioni, vedere [Obiettivi di scalabilità e prestazioni per Archiviazione di Azure](storage-scalability-targets.md).</span><span class="sxs-lookup"><span data-stu-id="dc5a6-177">For more information on partitions see [Azure Storage Scalability and Performance Targets](storage-scalability-targets.md).</span></span>  

<span data-ttu-id="dc5a6-178">Nel servizio tabelle hello, un singolo nodo servizi uno o più partizioni di completare e hello servizio scale dal bilanciamento del carico in modo dinamico le partizioni tra i nodi.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-178">In hello Table service, an individual node services one or more complete partitions and hello service scales by dynamically load-balancing partitions across nodes.</span></span> <span data-ttu-id="dc5a6-179">Se un nodo è in condizioni di carico, è possibile del servizio tabelle hello *dividere* intervallo hello delle partizioni elaborate dal nodo in nodi diversi; quando diminuisce il traffico, è possibile servizio hello *unione* partizione hello compreso tra nodi non interattiva in un singolo nodo.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-179">If a node is under load, hello table service can *split* hello range of partitions serviced by that node onto different nodes; when traffic subsides, hello service can *merge* hello partition ranges from quiet nodes back onto a single node.</span></span>  

<span data-ttu-id="dc5a6-180">Per ulteriori informazioni su hello servizio tabelle dettagli interni di hello e in particolare come servizio hello gestisce le partizioni, vedere il documento hello [archiviazione di Microsoft Azure: A elevata disponibilità servizio di archiviazione Cloud con verifica coerenza sicuro](http://blogs.msdn.com/b/windowsazurestorage/archive/2011/11/20/windows-azure-storage-a-highly-available-cloud-storage-service-with-strong-consistency.aspx).</span><span class="sxs-lookup"><span data-stu-id="dc5a6-180">For more information about hello internal details of hello Table service, and in particular how hello service manages partitions, see hello paper [Microsoft Azure Storage: A Highly Available Cloud Storage Service with Strong Consistency](http://blogs.msdn.com/b/windowsazurestorage/archive/2011/11/20/windows-azure-storage-a-highly-available-cloud-storage-service-with-strong-consistency.aspx).</span></span>  

### <a name="entity-group-transactions"></a><span data-ttu-id="dc5a6-181">Transazioni dei gruppi di entità</span><span class="sxs-lookup"><span data-stu-id="dc5a6-181">Entity Group Transactions</span></span>
<span data-ttu-id="dc5a6-182">In hello del servizio tabelle, gruppi di entità (EGTs) sono un meccanismo solo integrato hello per l'esecuzione di aggiornamenti atomici in più entità.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-182">In hello Table service, Entity Group Transactions (EGTs) are hello only built-in mechanism for performing atomic updates across multiple entities.</span></span> <span data-ttu-id="dc5a6-183">EGTs sono anche cui tooas *batch transazioni* nella parte della documentazione.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-183">EGTs are also referred tooas *batch transactions* in some documentation.</span></span> <span data-ttu-id="dc5a6-184">EGTs può essere utilizzato solo per le entità archiviate in hello stessa partizione (condivisione hello stessa chiave di partizione in una determinata tabella), pertanto ogni volta che è necessario un comportamento transazionale atomico in più entità, è necessario tooensure le entità presenti hello stessa partizione.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-184">EGTs can only operate on entities stored in hello same partition (share hello same partition key in a given table), so anytime you need atomic transactional behavior across multiple entities you need tooensure that those entities are in hello same partition.</span></span> <span data-ttu-id="dc5a6-185">Questo è spesso un motivo per mantenere più tipi di entità in hello stessa tabella (e di partizione) e non utilizzare più tabelle per i tipi di entità diversa.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-185">This is often a reason for keeping multiple entity types in hello same table (and partition) and not using multiple tables for different entity types.</span></span> <span data-ttu-id="dc5a6-186">Una sola EGT può agire al massimo su 100 entità.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-186">A single EGT can operate on at most 100 entities.</span></span>  <span data-ttu-id="dc5a6-187">Se si inviano più EGTs simultanee per l'elaborazione è importante tooensure tali EGTs non funzionano per le entità che sono comuni tra EGTs come in caso contrario, l'elaborazione può essere ritardato.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-187">If you submit multiple concurrent EGTs for processing it is important tooensure  those EGTs do not operate on entities that are common across EGTs as otherwise processing can be delayed.</span></span>

<span data-ttu-id="dc5a6-188">EGTs introduce inoltre un compromesso potenziali per tooevaluate nella progettazione: utilizzo di più partizioni aumenterà scalabilità hello dell'applicazione in quanto Azure offre maggiori opportunità per il bilanciamento del carico delle richieste tra i nodi, ma ciò potrebbe limitare hello possibilità di transazioni atomiche applicazione tooperform e mantenere la coerenza assoluta per i dati.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-188">EGTs also introduce a potential trade-off for you tooevaluate in your design: using more partitions will increase hello scalability of your application because Azure has more opportunities for load balancing requests across nodes, but this might limit hello ability of your application tooperform atomic transactions and maintain strong consistency for your data.</span></span> <span data-ttu-id="dc5a6-189">Inoltre, vi sono obiettivi di scalabilità specifici a livello di hello di una partizione che potrebbe limitare la velocità effettiva hello delle transazioni, è probabile che per un singolo nodo: per ulteriori informazioni sulle destinazioni di scalabilità hello per gli account di archiviazione di Azure e tabella hello servizio, vedere [Azure obiettivi di scalabilità e prestazioni](storage-scalability-targets.md).</span><span class="sxs-lookup"><span data-stu-id="dc5a6-189">Furthermore, there are specific scalability targets at hello level of a partition that might limit hello throughput of transactions you can expect for a single node: for more information about hello scalability targets for Azure storage accounts and hello table service, see [Azure Storage Scalability and Performance Targets](storage-scalability-targets.md).</span></span> <span data-ttu-id="dc5a6-190">Nelle sezioni successive di questa guida discutere sulle diverse strategie che consentono di gestire i compromessi come e viene illustrato il modo migliore toochoose la chiave di partizione in base ai requisiti specifici di hello dell'applicazione client di progettazione.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-190">Later sections of this guide discuss various design strategies that help you manage trade-offs such as this one, and discuss how best toochoose your partition key based on hello specific requirements of your client application.</span></span>  

### <a name="capacity-considerations"></a><span data-ttu-id="dc5a6-191">Considerazioni sulla capacità</span><span class="sxs-lookup"><span data-stu-id="dc5a6-191">Capacity considerations</span></span>
<span data-ttu-id="dc5a6-192">Hello nella tabella seguente sono incluse alcune delle toobe di valori di chiave hello conoscere quando si progetta una soluzione di servizio di tabella:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-192">hello following table includes some of hello key values toobe aware of when you are designing a Table service solution:</span></span>  

| <span data-ttu-id="dc5a6-193">Capacità totale di un account di archiviazione di Azure</span><span class="sxs-lookup"><span data-stu-id="dc5a6-193">Total capacity of an Azure storage account</span></span> | <span data-ttu-id="dc5a6-194">500 TB</span><span class="sxs-lookup"><span data-stu-id="dc5a6-194">500 TB</span></span> |
| --- | --- |
| <span data-ttu-id="dc5a6-195">Numero di tabelle in un account di archiviazione di Azure</span><span class="sxs-lookup"><span data-stu-id="dc5a6-195">Number of tables in an Azure storage account</span></span> |<span data-ttu-id="dc5a6-196">Limitato solo dalla capacità di hello hello dell'account di archiviazione</span><span class="sxs-lookup"><span data-stu-id="dc5a6-196">Limited only by hello capacity of hello storage account</span></span> |
| <span data-ttu-id="dc5a6-197">Numero di partizioni in una tabella</span><span class="sxs-lookup"><span data-stu-id="dc5a6-197">Number of partitions in a table</span></span> |<span data-ttu-id="dc5a6-198">Limitato solo dalla capacità di hello hello dell'account di archiviazione</span><span class="sxs-lookup"><span data-stu-id="dc5a6-198">Limited only by hello capacity of hello storage account</span></span> |
| <span data-ttu-id="dc5a6-199">Numero di entità in una partizione</span><span class="sxs-lookup"><span data-stu-id="dc5a6-199">Number of entities in a partition</span></span> |<span data-ttu-id="dc5a6-200">Limitato solo dalla capacità di hello hello dell'account di archiviazione</span><span class="sxs-lookup"><span data-stu-id="dc5a6-200">Limited only by hello capacity of hello storage account</span></span> |
| <span data-ttu-id="dc5a6-201">Dimensioni di una singola entità</span><span class="sxs-lookup"><span data-stu-id="dc5a6-201">Size of an individual entity</span></span> |<span data-ttu-id="dc5a6-202">Backup MB too1 con un massimo di 255 proprietà (inclusi hello **PartitionKey**, **RowKey**, e **Timestamp**)</span><span class="sxs-lookup"><span data-stu-id="dc5a6-202">Up too1 MB with a maximum of 255 properties (including hello **PartitionKey**, **RowKey**, and **Timestamp**)</span></span> |
| <span data-ttu-id="dc5a6-203">Dimensioni di hello **PartitionKey**</span><span class="sxs-lookup"><span data-stu-id="dc5a6-203">Size of hello **PartitionKey**</span></span> |<span data-ttu-id="dc5a6-204">Una stringa di dimensioni too1 KB</span><span class="sxs-lookup"><span data-stu-id="dc5a6-204">A string up too1 KB in size</span></span> |
| <span data-ttu-id="dc5a6-205">Dimensioni di hello **RowKey**</span><span class="sxs-lookup"><span data-stu-id="dc5a6-205">Size of hello **RowKey**</span></span> |<span data-ttu-id="dc5a6-206">Una stringa di dimensioni too1 KB</span><span class="sxs-lookup"><span data-stu-id="dc5a6-206">A string up too1 KB in size</span></span> |
| <span data-ttu-id="dc5a6-207">Dimensioni di una transazione di gruppi di entità</span><span class="sxs-lookup"><span data-stu-id="dc5a6-207">Size of an Entity Group Transaction</span></span> |<span data-ttu-id="dc5a6-208">Una transazione può includere al massimo 100 entità e payload hello deve essere minore di 4 MB.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-208">A transaction can include at most 100 entities and hello payload must be less than 4 MB in size.</span></span> <span data-ttu-id="dc5a6-209">Una transazione EGT può aggiornare una sola entità per volta.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-209">An EGT can only update an entity once.</span></span> |

<span data-ttu-id="dc5a6-210">Per ulteriori informazioni, vedere [hello comprensione modello di dati del servizio tabelle](http://msdn.microsoft.com/library/azure/dd179338.aspx).</span><span class="sxs-lookup"><span data-stu-id="dc5a6-210">For more information, see [Understanding hello Table Service Data Model](http://msdn.microsoft.com/library/azure/dd179338.aspx).</span></span>  

### <a name="cost-considerations"></a><span data-ttu-id="dc5a6-211">Considerazioni sul costo</span><span class="sxs-lookup"><span data-stu-id="dc5a6-211">Cost considerations</span></span>
<span data-ttu-id="dc5a6-212">Archiviazione tabelle è relativamente poco costosa, ma è consigliabile includere le stime dei costi per la quantità di informazioni sull'utilizzo e hello entrambe le capacità di transazioni come parte di una valutazione di una soluzione che utilizza il servizio tabella hello.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-212">Table storage is relatively inexpensive, but you should include cost estimates for both capacity usage and hello quantity of transactions as part of your evaluation of any solution that uses hello Table service.</span></span> <span data-ttu-id="dc5a6-213">Tuttavia, in molti scenari l'archiviazione dati denormalizzati o duplicati in hello tooimprove ordine prestazioni o la scalabilità della soluzione è tootake un approccio valido.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-213">However, in many scenarios storing denormalized or duplicate data in order tooimprove hello performance or scalability of your solution is a valid approach tootake.</span></span> <span data-ttu-id="dc5a6-214">Per altre informazioni sui prezzi, vedere [Prezzi di Archiviazione di Azure](https://azure.microsoft.com/pricing/details/storage/).</span><span class="sxs-lookup"><span data-stu-id="dc5a6-214">For more information about pricing, see [Azure Storage Pricing](https://azure.microsoft.com/pricing/details/storage/).</span></span>  

## <a name="guidelines-for-table-design"></a><span data-ttu-id="dc5a6-215">Linee guida per la progettazione di tabelle</span><span class="sxs-lookup"><span data-stu-id="dc5a6-215">Guidelines for table design</span></span>
<span data-ttu-id="dc5a6-216">Questi elenchi riepilogano alcune linee guida fondamentali di hello che è necessario tenere presenti quando si progettano le tabelle e verrà risolverli in modo più dettagliato più avanti in questa Guida.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-216">These lists summarize some of hello key guidelines you should keep in mind when you are designing your tables, and this guide will address them all in more detail later in.</span></span> <span data-ttu-id="dc5a6-217">Queste linee guida sono molto diverse da linee guida hello in genere è necessario seguire per la progettazione di database relazionale.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-217">These guidelines are very different from hello guidelines you would typically follow for relational database design.</span></span>  

<span data-ttu-id="dc5a6-218">La progettazione del toobe di soluzioni di servizio tabella *leggere* efficiente:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-218">Designing your Table service solution toobe *read* efficient:</span></span>

* <span data-ttu-id="dc5a6-219">***Progettazione per le query nelle applicazioni con intensa attività di lettura.***</span><span class="sxs-lookup"><span data-stu-id="dc5a6-219">***Design for querying in read-heavy applications.***</span></span> <span data-ttu-id="dc5a6-220">Quando si progettano le tabelle, considerare le query di hello (soprattutto hello la latenza quelle riservate) che verrà eseguita prima di pianificare la modalità si aggiornerà le entità.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-220">When you are designing your tables, think about hello queries (especially hello latency sensitive ones) that you will execute before you think about how you will update your entities.</span></span> <span data-ttu-id="dc5a6-221">Ciò comporta in genere una soluzione efficiente e ad alte prestazioni.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-221">This typically results in an efficient and performant solution.</span></span>  
* <span data-ttu-id="dc5a6-222">***Specificare PartitionKey e RowKey nelle query.***</span><span class="sxs-lookup"><span data-stu-id="dc5a6-222">***Specify both PartitionKey and RowKey in your queries.***</span></span> <span data-ttu-id="dc5a6-223">*Scegliere query* , ad esempio si tratta di query sul servizio tabella più efficiente hello.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-223">*Point queries* such as these are hello most efficient table service queries.</span></span>  
* <span data-ttu-id="dc5a6-224">***Prendere in considerazione l'archiviazione di copie duplicate delle entità.***</span><span class="sxs-lookup"><span data-stu-id="dc5a6-224">***Consider storing duplicate copies of entities.***</span></span> <span data-ttu-id="dc5a6-225">Archiviazione tabelle è economica opportuno considerare l'archiviazione hello stessa entità più volte (con chiavi diverse) tooenable query più efficienti.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-225">Table storage is cheap so consider storing hello same entity multiple times (with different keys) tooenable more efficient queries.</span></span>  
* <span data-ttu-id="dc5a6-226">***Considerare la denormalizzazione dei dati.***</span><span class="sxs-lookup"><span data-stu-id="dc5a6-226">***Consider denormalizing your data.***</span></span> <span data-ttu-id="dc5a6-227">L’archiviazione delle tabelle è economica, dunque è opportuno considerare la denormalizzazione dei dati.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-227">Table storage is cheap so consider denormalizing your data.</span></span> <span data-ttu-id="dc5a6-228">Ad esempio, archiviare le entità di riepilogo in modo che le query sui dati aggregati sufficiente tooaccess una singola entità.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-228">For example, store summary entities so that queries for aggregate data only need tooaccess a single entity.</span></span>  
* <span data-ttu-id="dc5a6-229">***Usare valori chiave composti.***</span><span class="sxs-lookup"><span data-stu-id="dc5a6-229">***Use compound key values.***</span></span> <span data-ttu-id="dc5a6-230">sono Hello solo le chiavi sono **PartitionKey** e **RowKey**.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-230">hello only keys you have are **PartitionKey** and **RowKey**.</span></span> <span data-ttu-id="dc5a6-231">Ad esempio, utilizzare i valori di chiave composta tooenable accesso con chiave alternativo percorsi tooentities.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-231">For example, use compound key values tooenable alternate keyed access paths tooentities.</span></span>  
* <span data-ttu-id="dc5a6-232">***Usare la proiezione di query.***</span><span class="sxs-lookup"><span data-stu-id="dc5a6-232">***Use query projection.***</span></span> <span data-ttu-id="dc5a6-233">È possibile ridurre la quantità hello di dati che vengono trasferite in rete hello utilizzando le query che selezionano solo i campi di hello che è necessario.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-233">You can reduce hello amount of data that you transfer over hello network by using queries that select just hello fields you need.</span></span>  

<span data-ttu-id="dc5a6-234">La progettazione del toobe di soluzioni di servizio tabella *scrivere* efficiente:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-234">Designing your Table service solution toobe *write* efficient:</span></span>  

* <span data-ttu-id="dc5a6-235">***Non creare partizioni critiche.***</span><span class="sxs-lookup"><span data-stu-id="dc5a6-235">***Do not create hot partitions.***</span></span> <span data-ttu-id="dc5a6-236">Scegliere le chiavi che consentono di toospread le richieste tra più partizioni in qualsiasi momento.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-236">Choose keys that enable you toospread your requests across multiple partitions at any point of time.</span></span>  
* <span data-ttu-id="dc5a6-237">***Evitare picchi di traffico.***</span><span class="sxs-lookup"><span data-stu-id="dc5a6-237">***Avoid spikes in traffic.***</span></span> <span data-ttu-id="dc5a6-238">Smooth traffico hello in un periodo di tempo ragionevole ed evitare picchi di traffico.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-238">Smooth hello traffic over a reasonable period of time and avoid spikes in traffic.</span></span>
* <span data-ttu-id="dc5a6-239">***Non creare necessariamente una tabella separata per ogni tipo di entità.***</span><span class="sxs-lookup"><span data-stu-id="dc5a6-239">***Don't necessarily create a separate table for each type of entity.***</span></span> <span data-ttu-id="dc5a6-240">Quando si richiedono transazioni atomiche tra tipi di entità, è possibile archiviare più di questi tipi di entità nella stessa partizione hello hello stessa tabella.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-240">When you require atomic transactions across entity types, you can store these multiple entity types in hello same partition in hello same table.</span></span>
* <span data-ttu-id="dc5a6-241">***Prendere in considerazione la velocità effettiva massima hello che è necessario ottenere.***</span><span class="sxs-lookup"><span data-stu-id="dc5a6-241">***Consider hello maximum throughput you must achieve.***</span></span> <span data-ttu-id="dc5a6-242">È necessario essere a conoscenza di obiettivi di scalabilità hello per hello del servizio tabelle e garantire che il progetto non è tooexceed li.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-242">You must be aware of hello scalability targets for hello Table service and ensure that your design will not cause you tooexceed them.</span></span>  

<span data-ttu-id="dc5a6-243">Questa guida contiene esempi in cui vengono messi in pratica tutti questi principi.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-243">As you read this guide, you will see examples that put all of these principles into practice.</span></span>  

## <a name="design-for-querying"></a><span data-ttu-id="dc5a6-244">Progettazione per le query</span><span class="sxs-lookup"><span data-stu-id="dc5a6-244">Design for querying</span></span>
<span data-ttu-id="dc5a6-245">Soluzioni di servizio di tabella possono essere letti con utilizzo intensivo, con un utilizzo elevato di scrittura o una combinazione di due hello.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-245">Table service solutions may be read intensive, write intensive, or a mix of hello two.</span></span> <span data-ttu-id="dc5a6-246">In questa sezione è incentrata sulla toobear operazioni hello in considerazione quando si progetta il toosupport servizio tabella operazioni di lettura in modo efficiente.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-246">This section focuses on hello things toobear in mind when you are designing your Table service toosupport read operations efficiently.</span></span> <span data-ttu-id="dc5a6-247">Una progettazione che supporta in modo efficiente le operazioni di lettura è in genere efficiente anche nelle operazioni di scrittura.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-247">Typically, a design that supports read operations efficiently is also efficient for write operations.</span></span> <span data-ttu-id="dc5a6-248">Tuttavia, esistono ulteriori considerazioni toobear presente quando progettazione toosupport scrittura, illustrato nella sezione successiva hello, [progettazione per la modifica dei dati](#design-for-data-modification).</span><span class="sxs-lookup"><span data-stu-id="dc5a6-248">However, there are additional considerations toobear in mind when designing toosupport write operations, discussed in hello next section, [Design for data modification](#design-for-data-modification).</span></span>

<span data-ttu-id="dc5a6-249">Un buon punto di partenza per la progettazione del tooenable di soluzioni di servizio tabella tooread dati in modo efficiente sono tooask "quali sono le query verranno i dati dell'applicazione necessario tooexecute tooretrieve hello che necessari dal servizio tabelle hello?"</span><span class="sxs-lookup"><span data-stu-id="dc5a6-249">A good starting point for designing your Table service solution tooenable you tooread data efficiently is tooask "What queries will my application need tooexecute tooretrieve hello data it needs from hello Table service?"</span></span>  

> [!NOTE]
> <span data-ttu-id="dc5a6-250">Con hello del servizio tabelle, è importante tooget hello progettazione corretto inizio perché è difficile e costoso toochange posticipato.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-250">With hello Table service, it's important tooget hello design correct up front because it's difficult and expensive toochange it later.</span></span> <span data-ttu-id="dc5a6-251">Ad esempio, in un database relazionale è spesso tooaddress possibili problemi di prestazioni semplicemente aggiungendo indici database esistente tooan: non è un'opzione con hello del servizio tabelle.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-251">For example, in a relational database it's often possible tooaddress performance issues simply by adding indexes tooan existing database: this is not an option with hello Table service.</span></span>  
> 
> 

<span data-ttu-id="dc5a6-252">Questa sezione vengono illustrati i problemi di chiave hello che è necessario risolvere quando si progettano le tabelle per l'esecuzione di query.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-252">This section focuses on hello key issues you must address when you design your tables for querying.</span></span> <span data-ttu-id="dc5a6-253">Hello argomenti trattati in questa sezione includono:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-253">hello topics covered in this section include:</span></span>

* [<span data-ttu-id="dc5a6-254">Come la scelta di PartitionKey e RowKey compromette le prestazioni delle query</span><span class="sxs-lookup"><span data-stu-id="dc5a6-254">How your choice of PartitionKey and RowKey impacts query performance</span></span>](#how-your-choice-of-partitionkey-and-rowkey-impacts-query-performance)
* [<span data-ttu-id="dc5a6-255">Scelta di un valore PartitionKey appropriato</span><span class="sxs-lookup"><span data-stu-id="dc5a6-255">Choosing an appropriate PartitionKey</span></span>](#choosing-an-appropriate-partitionkey)
* [<span data-ttu-id="dc5a6-256">Ottimizzazione delle query per hello del servizio tabelle</span><span class="sxs-lookup"><span data-stu-id="dc5a6-256">Optimizing queries for hello Table service</span></span>](#optimizing-queries-for-the-table-service)
* [<span data-ttu-id="dc5a6-257">Ordinamento dati nel servizio tabelle hello</span><span class="sxs-lookup"><span data-stu-id="dc5a6-257">Sorting data in hello Table service</span></span>](#sorting-data-in-the-table-service)

### <a name="how-your-choice-of-partitionkey-and-rowkey-impacts-query-performance"></a><span data-ttu-id="dc5a6-258">Come la scelta di PartitionKey e RowKey compromette le prestazioni delle query</span><span class="sxs-lookup"><span data-stu-id="dc5a6-258">How your choice of PartitionKey and RowKey impacts query performance</span></span>
<span data-ttu-id="dc5a6-259">Hello esempi seguenti presuppongono servizio tabella hello è l'archiviazione delle entità employee con hello seguente struttura (la maggior parte degli esempi di hello omettere hello **Timestamp** proprietà per maggiore chiarezza):</span><span class="sxs-lookup"><span data-stu-id="dc5a6-259">hello following examples assume hello table service is storing employee entities with hello following structure (most of hello examples omit hello **Timestamp** property for clarity):</span></span>  

| <span data-ttu-id="dc5a6-260">*Nome colonna*</span><span class="sxs-lookup"><span data-stu-id="dc5a6-260">*Column name*</span></span> | <span data-ttu-id="dc5a6-261">*Tipo di dati*</span><span class="sxs-lookup"><span data-stu-id="dc5a6-261">*Data type*</span></span> |
| --- | --- |
| <span data-ttu-id="dc5a6-262">**PartitionKey** (nome del reparto)</span><span class="sxs-lookup"><span data-stu-id="dc5a6-262">**PartitionKey** (Department Name)</span></span> |<span data-ttu-id="dc5a6-263">String</span><span class="sxs-lookup"><span data-stu-id="dc5a6-263">String</span></span> |
| <span data-ttu-id="dc5a6-264">**RowKey** (ID dipendente)</span><span class="sxs-lookup"><span data-stu-id="dc5a6-264">**RowKey** (Employee Id)</span></span> |<span data-ttu-id="dc5a6-265">String</span><span class="sxs-lookup"><span data-stu-id="dc5a6-265">String</span></span> |
| <span data-ttu-id="dc5a6-266">**FirstName**</span><span class="sxs-lookup"><span data-stu-id="dc5a6-266">**FirstName**</span></span> |<span data-ttu-id="dc5a6-267">String</span><span class="sxs-lookup"><span data-stu-id="dc5a6-267">String</span></span> |
| <span data-ttu-id="dc5a6-268">**LastName**</span><span class="sxs-lookup"><span data-stu-id="dc5a6-268">**LastName**</span></span> |<span data-ttu-id="dc5a6-269">String</span><span class="sxs-lookup"><span data-stu-id="dc5a6-269">String</span></span> |
| <span data-ttu-id="dc5a6-270">**Age**</span><span class="sxs-lookup"><span data-stu-id="dc5a6-270">**Age**</span></span> |<span data-ttu-id="dc5a6-271">Integer</span><span class="sxs-lookup"><span data-stu-id="dc5a6-271">Integer</span></span> |
| <span data-ttu-id="dc5a6-272">**EmailAddress**</span><span class="sxs-lookup"><span data-stu-id="dc5a6-272">**EmailAddress**</span></span> |<span data-ttu-id="dc5a6-273">String</span><span class="sxs-lookup"><span data-stu-id="dc5a6-273">String</span></span> |

<span data-ttu-id="dc5a6-274">Hello precedente sezione [Panoramica del servizio tabelle di Azure](#overview) descrive alcune delle hello le funzionalità principali di hello del servizio tabelle di Azure che influiscono direttamente sulla progettazione per la query.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-274">hello earlier section [Azure Table service overview](#overview) describes some of hello key features of hello Azure Table service that have a direct influence on designing for query.</span></span> <span data-ttu-id="dc5a6-275">In tal modo hello seguenti linee guida generali per la progettazione di query sul servizio di tabella.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-275">These result in hello following general guidelines for designing Table service queries.</span></span> <span data-ttu-id="dc5a6-276">Si noti che la sintassi di filtro hello utilizzata negli esempi di hello riportato di seguito è da hello tabella API REST del servizio, per ulteriori informazioni, vedere [Query Entities](http://msdn.microsoft.com/library/azure/dd179421.aspx).</span><span class="sxs-lookup"><span data-stu-id="dc5a6-276">Note that hello filter syntax used in hello examples below is from hello Table service REST API, for more information see [Query Entities](http://msdn.microsoft.com/library/azure/dd179421.aspx).</span></span>  

* <span data-ttu-id="dc5a6-277">Oggetto ***punto Query*** è hello toouse di ricerca più efficiente ed è consigliata toobe usati per ricerche di volumi elevati o ricerche che richiedono la latenza più bassa.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-277">A ***Point Query*** is hello most efficient lookup toouse and is recommended toobe used for high-volume lookups or lookups requiring lowest latency.</span></span> <span data-ttu-id="dc5a6-278">Tale query può utilizzare in modo molto efficiente hello indici toolocate una singola entità specificando entrambi hello **PartitionKey** e **RowKey** valori.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-278">Such a query can use hello indexes toolocate an individual entity very efficiently by specifying both hello **PartitionKey** and **RowKey** values.</span></span> <span data-ttu-id="dc5a6-279">Ad esempio, $filter=(PartitionKey eq 'Sales') e (RowKey eq '2')</span><span class="sxs-lookup"><span data-stu-id="dc5a6-279">For example: $filter=(PartitionKey eq 'Sales') and (RowKey eq '2')</span></span>  
* <span data-ttu-id="dc5a6-280">In secondo luogo è un ***Query di intervallo*** che utilizza hello **PartitionKey** e i filtri su un intervallo di **RowKey** valori tooreturn più di un'entità.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-280">Second best is a ***Range Query*** that uses hello **PartitionKey** and filters on a range of **RowKey** values tooreturn more than one entity.</span></span> <span data-ttu-id="dc5a6-281">Hello **PartitionKey** valore identifica una partizione specifica e hello **RowKey** valori identificano un subset di entità hello in tale partizione.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-281">hello **PartitionKey** value identifies a specific partition, and hello **RowKey** values identify a subset of hello entities in that partition.</span></span> <span data-ttu-id="dc5a6-282">Ad esempio, $filter=PartitionKey eq 'Sales' e RowKey ge 'S' e RowKey lt 'T'</span><span class="sxs-lookup"><span data-stu-id="dc5a6-282">For example: $filter=PartitionKey eq 'Sales' and RowKey ge 'S' and RowKey lt 'T'</span></span>  
* <span data-ttu-id="dc5a6-283">Terzo migliore è un ***partizione analisi*** che utilizza hello **PartitionKey** e filtri in un'altra proprietà non chiave e che possono restituire più di un'entità.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-283">Third best is a ***Partition Scan*** that uses hello **PartitionKey** and filters on another non-key property and that may return more than one entity.</span></span> <span data-ttu-id="dc5a6-284">Hello **PartitionKey** valore identifica una partizione specifica e i valori delle proprietà di hello select per un subset di entità hello in tale partizione.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-284">hello **PartitionKey** value identifies a specific partition, and hello property values select for a subset of hello entities in that partition.</span></span> <span data-ttu-id="dc5a6-285">Ad esempio: $filter=PartitionKey eq 'Sales' e LastName eq 'Smith'</span><span class="sxs-lookup"><span data-stu-id="dc5a6-285">For example: $filter=PartitionKey eq 'Sales' and LastName eq 'Smith'</span></span>  
* <span data-ttu-id="dc5a6-286">Oggetto ***Table Scan*** non include hello **PartitionKey** ed è molto efficiente perché viene eseguita la ricerca di tutte le partizioni di hello che costituiscono la tabella a sua volta per tutte le entità corrispondenti.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-286">A ***Table Scan*** does not include hello **PartitionKey** and is very inefficient because it searches all of hello partitions that make up your table in turn for any matching entities.</span></span> <span data-ttu-id="dc5a6-287">Verrà eseguita una scansione di tabella indipendentemente dal fatto che il filtro Usa hello **RowKey**.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-287">It will perform a table scan regardless of whether or not your filter uses hello **RowKey**.</span></span> <span data-ttu-id="dc5a6-288">Ad esempio: $filter = LastName eq 'Jones'</span><span class="sxs-lookup"><span data-stu-id="dc5a6-288">For example: $filter=LastName eq 'Jones'</span></span>  
* <span data-ttu-id="dc5a6-289">Le query che restituiscono più entità le ordinano in base a **PartitionKey** e **RowKey**.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-289">Queries that return multiple entities return them sorted in **PartitionKey** and **RowKey** order.</span></span> <span data-ttu-id="dc5a6-290">entità hello ricorrere tooavoid client hello, scegliere un **RowKey** che definisce hello più comuni di ordinamento.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-290">tooavoid resorting hello entities in hello client, choose a **RowKey** that defines hello most common sort order.</span></span>  

<span data-ttu-id="dc5a6-291">Si noti che l'utilizzo un "**o**" toospecify un filtro basato su **RowKey** valori dei risultati in una scansione di partizione e non viene considerato come una query di intervallo.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-291">Note that using an "**or**" toospecify a filter based on **RowKey** values results in a partition scan and is not treated as a range query.</span></span> <span data-ttu-id="dc5a6-292">Pertanto, è consigliabile evitare query che utilizzano filtri ad esempio: $filter = PartitionKey eq "Sales" e (RowKey '121' o RowKey eq '322')</span><span class="sxs-lookup"><span data-stu-id="dc5a6-292">Therefore, you should avoid queries that use filters such as: $filter=PartitionKey eq 'Sales' and (RowKey eq '121' or RowKey eq '322')</span></span>  

<span data-ttu-id="dc5a6-293">Per esempi di codice lato client che usano query efficienti tooexecute di hello libreria Client di archiviazione, vedere:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-293">For examples of client-side code that use hello Storage Client Library tooexecute efficient queries, see:</span></span>  

* [<span data-ttu-id="dc5a6-294">Esegue una query di punto utilizzando hello libreria Client di archiviazione</span><span class="sxs-lookup"><span data-stu-id="dc5a6-294">Executing a point query using hello Storage Client Library</span></span>](#executing-a-point-query-using-the-storage-client-library)
* [<span data-ttu-id="dc5a6-295">Recupero di più entità usando LINQ</span><span class="sxs-lookup"><span data-stu-id="dc5a6-295">Retrieving multiple entities using LINQ</span></span>](#retrieving-multiple-entities-using-linq)
* [<span data-ttu-id="dc5a6-296">Proiezione lato server</span><span class="sxs-lookup"><span data-stu-id="dc5a6-296">Server-side projection</span></span>](#server-side-projection)  

<span data-ttu-id="dc5a6-297">Per esempi di codice sul lato client in grado di gestire più entità tipi archiviati in hello stessa tabella, vedere:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-297">For examples of client-side code that can handle multiple entity types stored in hello same table, see:</span></span>  

* [<span data-ttu-id="dc5a6-298">Uso di tipi di entità eterogenei</span><span class="sxs-lookup"><span data-stu-id="dc5a6-298">Working with heterogeneous entity types</span></span>](#working-with-heterogeneous-entity-types)  

### <a name="choosing-an-appropriate-partitionkey"></a><span data-ttu-id="dc5a6-299">Scelta di un valore PartitionKey appropriato</span><span class="sxs-lookup"><span data-stu-id="dc5a6-299">Choosing an appropriate PartitionKey</span></span>
<span data-ttu-id="dc5a6-300">La scelta di **PartitionKey** deve bilanciare hello necessità tooenables hello ricorso EGTs (tooensure coerenza) su hello requisito toodistribute le entità tra più partizioni (tooensure una soluzione scalabile).</span><span class="sxs-lookup"><span data-stu-id="dc5a6-300">Your choice of **PartitionKey** should balance hello need tooenables hello use of EGTs (tooensure consistency) against hello requirement toodistribute your entities across multiple partitions (tooensure a scalable solution).</span></span>  

<span data-ttu-id="dc5a6-301">A un'estremità, è possibile archiviare tutte le entità in una singola partizione, ma ciò potrebbe limitare la scalabilità hello della soluzione e potrebbe impedire servizio tabella hello in grado di tooload-bilanciamento delle richieste.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-301">At one extreme, you could store all your entities in a single partition, but this may limit hello scalability of your solution and would prevent hello table service from being able tooload-balance requests.</span></span> <span data-ttu-id="dc5a6-302">In hello altra estremità, è possibile archiviare un'entità per ogni partizione, che potrebbe essere estremamente scalabile e che consente di hello tabella tooload bilanciamento delle richieste, ma che potrebbe impedire l'utilizzo di gruppi di entità.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-302">At hello other extreme, you could store one entity per partition, which would be highly scalable and which enables hello table service tooload-balance requests, but which would prevent you from using entity group transactions.</span></span>  

<span data-ttu-id="dc5a6-303">L'obiettivo ideale **PartitionKey** uno che consente di eseguire query efficienti toouse e tooensure partizioni sufficienti che è la soluzione è scalabile.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-303">An ideal **PartitionKey** is one that enables you toouse efficient queries and that has sufficient partitions tooensure your solution is scalable.</span></span> <span data-ttu-id="dc5a6-304">Di solito le entità dispongono una proprietà apposita che le distribuisce in un numero sufficiente di partizioni.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-304">Typically, you will find that your entities will have a suitable property that distributes your entities across sufficient partitions.</span></span>

> [!NOTE]
> <span data-ttu-id="dc5a6-305">Ad esempio, in un sistema che archivia le informazioni sugli utenti o i dipendenti, l'ID utente può essere un valore PartitionKey valido.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-305">For example, in a system that stores information about users or employees, UserID may be a good PartitionKey.</span></span> <span data-ttu-id="dc5a6-306">È possibile diverse entità che utilizzano un ID utente specificato come chiave di partizione hello.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-306">You may have several entities that use a given UserID as hello partition key.</span></span> <span data-ttu-id="dc5a6-307">Ogni entità che archivia i dati su un utente è raggruppata in una singola partizione e quindi queste entità sono accessibili tramite gruppi di entità, mantenendo la scalabilità elevata.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-307">Each entity that stores data about a user is grouped into a single partition, and so these entities are accessible via entity group transactions, while still being highly scalable.</span></span>
> 
> 

<span data-ttu-id="dc5a6-308">Esistono ulteriori considerazioni nella scelta di **PartitionKey** relative toohow verrà inserire, aggiornare ed eliminare entità: vedere la sezione hello [progettazione per la modifica dei dati](#design-for-data-modification) sotto.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-308">There are additional considerations in your choice of **PartitionKey** that relate toohow you will insert, update, and delete entities: see hello section [Design for data modification](#design-for-data-modification) below.</span></span>  

### <a name="optimizing-queries-for-hello-table-service"></a><span data-ttu-id="dc5a6-309">Ottimizzazione delle query per hello del servizio tabelle</span><span class="sxs-lookup"><span data-stu-id="dc5a6-309">Optimizing queries for hello Table service</span></span>
<span data-ttu-id="dc5a6-310">Hello del servizio tabelle vengono indicizzati automaticamente le entità utilizzando hello **PartitionKey** e **RowKey** valori in un solo indice cluster, pertanto hello motivo che punto query sono hello toouse più efficiente .</span><span class="sxs-lookup"><span data-stu-id="dc5a6-310">hello Table service automatically indexes your entities using hello **PartitionKey** and **RowKey** values in a single clustered index, hence hello reason that point queries are hello most efficient toouse.</span></span> <span data-ttu-id="dc5a6-311">Tuttavia, non sono presenti indici diverso da quello in indice cluster hello hello **PartitionKey** e **RowKey**.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-311">However, there are no indexes other than that on hello clustered index on hello **PartitionKey** and **RowKey**.</span></span>

<span data-ttu-id="dc5a6-312">Molte progettazioni devono soddisfare ricerca tooenable requisiti di entità in base a più criteri.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-312">Many designs must meet requirements tooenable lookup of entities based on multiple criteria.</span></span> <span data-ttu-id="dc5a6-313">ad esempio trovare le entità dipendente in base a indirizzo di posta elettronica, ID dipendente o cognome.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-313">For example, locating employee entities based on email, employee id, or last name.</span></span> <span data-ttu-id="dc5a6-314">Hello in seguito nella sezione hello modelli [modelli di progettazione tabella](#table-design-patterns) risolvere questi tipi di requisiti e una descrizione delle modalità di utilizzo intorno fatti hello del servizio tabelle hello non fornisce indici secondari:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-314">hello following patterns in hello section [Table Design Patterns](#table-design-patterns) address these types of requirement and describe ways of working around hello fact that hello Table service does not provide secondary indexes:</span></span>  

* <span data-ttu-id="dc5a6-315">[Modello di indice secondario intra-partition](#intra-partition-secondary-index-pattern) -archiviazione di più copie di ogni entità mediante diverse **RowKey** valori (in hello stessa partizione) tooenable veloci ed efficienti ricerche e ordinamento alternativo gli ordini tramite diversi **RowKey** valori.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-315">[Intra-partition secondary index pattern](#intra-partition-secondary-index-pattern) - Store multiple copies of each entity using different **RowKey** values (in hello same partition) tooenable fast and efficient lookups and alternate sort orders by using different **RowKey** values.</span></span>  
* <span data-ttu-id="dc5a6-316">[Modello di indice secondario partizione tra](#inter-partition-secondary-index-pattern) : archiviazione di più copie di ogni entità utilizzando i diversi valori RowKey in partizioni distinte o in tabelle separate tooenable veloce e ricerche efficienti e ordinamento alternativo gli ordini con diversi **RowKey** valori.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-316">[Inter-partition secondary index pattern](#inter-partition-secondary-index-pattern) - Store multiple copies of each entity using different RowKey values in separate partitions or in separate tables tooenable fast and efficient lookups and alternate sort orders by using different **RowKey** values.</span></span>  
* <span data-ttu-id="dc5a6-317">[Modello di entità indice](#index-entities-pattern) -Gestisci entità tooenable efficienti ricerche che restituiscono elenchi di entità.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-317">[Index Entities Pattern](#index-entities-pattern) - Maintain index entities tooenable efficient searches that return lists of entities.</span></span>  

### <a name="sorting-data-in-hello-table-service"></a><span data-ttu-id="dc5a6-318">Ordinamento dati nel servizio tabelle hello</span><span class="sxs-lookup"><span data-stu-id="dc5a6-318">Sorting data in hello Table service</span></span>
<span data-ttu-id="dc5a6-319">Hello del servizio tabelle restituisce entità ordinate in ordine crescente in base **PartitionKey** e quindi per **RowKey**.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-319">hello Table service returns entities sorted in ascending order based on **PartitionKey** and then by **RowKey**.</span></span> <span data-ttu-id="dc5a6-320">Queste chiavi sono i valori stringa e tooensure che i valori numerici ordinare in modo corretto, è necessario convertirli in lunghezza fissata tooa e li riempire con zeri.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-320">These keys are string values and tooensure that numeric values sort correctly, you should convert them tooa fixed length and pad them with zeroes.</span></span> <span data-ttu-id="dc5a6-321">Ad esempio, se hello valore di id dipendente è utilizzare come hello **RowKey** è un valore intero, è necessario convertire l'id dipendente **123** troppo**00000123**.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-321">For example, if hello employee id value you use as hello **RowKey** is an integer value, you should convert employee id **123** too**00000123**.</span></span>  

<span data-ttu-id="dc5a6-322">Molte applicazioni hanno requisiti toouse dati ordinati in ordine diverso: ordinamento, ad esempio, i dipendenti in base al nome o creando un join di Data.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-322">Many applications have requirements toouse data sorted in different orders: for example, sorting employees by name, or by joining date.</span></span> <span data-ttu-id="dc5a6-323">Hello in seguito nella sezione hello modelli [modelli di progettazione tabella](#table-design-patterns) come tooalternate di ordinamento per le entità di indirizzi:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-323">hello following patterns in hello section [Table Design Patterns](#table-design-patterns) address how tooalternate sort orders for your entities:</span></span>  

* <span data-ttu-id="dc5a6-324">[Modello di indice secondario intra-partition](#intra-partition-secondary-index-pattern) -archiviazione di più copie di ogni entità utilizzando i diversi valori RowKey (in hello stessa partizione) tooenable veloci ed efficienti ricerche e ordinamento alternativo gli ordini con diversi valori RowKey.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-324">[Intra-partition secondary index pattern](#intra-partition-secondary-index-pattern) - Store multiple copies of each entity using different RowKey values (in hello same partition) tooenable fast and efficient lookups and alternate sort orders by using different RowKey values.</span></span>  
* <span data-ttu-id="dc5a6-325">[Modello di indice secondario partizione tra](#inter-partition-secondary-index-pattern) : archiviazione di più copie di ogni entità con diversi valori RowKey in partizioni distinte in tabelle separate tooenable veloce e ricerche efficienti e ordinamento alternativo gli ordini con RowKey diversi valori.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-325">[Inter-partition secondary index pattern](#inter-partition-secondary-index-pattern) - Store multiple copies of each entity using different RowKey values in separate partitions in separate tables tooenable fast and efficient lookups and alternate sort orders by using different RowKey values.</span></span>
* <span data-ttu-id="dc5a6-326">[Modello della parte finale del log](#log-tail-pattern) -hello recuperare  *n*  le entità aggiunte più di recente tooa partizione utilizzando un **RowKey** valore che ordina in data inversa e l'ordine temporale.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-326">[Log tail pattern](#log-tail-pattern) - Retrieve hello *n* entities most recently added tooa partition by using a **RowKey** value that sorts in reverse date and time order.</span></span>  

## <a name="design-for-data-modification"></a><span data-ttu-id="dc5a6-327">Progettazione per la modifica dei dati</span><span class="sxs-lookup"><span data-stu-id="dc5a6-327">Design for data modification</span></span>
<span data-ttu-id="dc5a6-328">In questa sezione è incentrata sulle considerazioni relative alla progettazione di hello per l'ottimizzazione di inserimenti, aggiornamenti ed eliminazioni.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-328">This section focuses on hello design considerations for optimizing inserts, updates, and deletes.</span></span> <span data-ttu-id="dc5a6-329">In alcuni casi, è necessario ottimizzare per l'esecuzione di query sui progetti che ottimizza per la modifica dei dati, come avviene nelle progettazioni per i database relazionali (anche se per la gestione di tecniche di hello hello progettazione le progettazioni conciliare hello tooevaluate vantaggi e svantaggi sono diversi in un database relazionale).</span><span class="sxs-lookup"><span data-stu-id="dc5a6-329">In some cases, you will need tooevaluate hello trade-off between designs that optimize for querying against designs that optimize for data modification just as you do in designs for relational databases (although hello techniques for managing hello design trade-offs are different in a relational database).</span></span> <span data-ttu-id="dc5a6-330">Hello sezione [modelli di progettazione tabella](#table-design-patterns) vengono descritti alcuni modelli di progettazione dettagliata per hello del servizio tabelle e vengono evidenziate alcune questi vantaggi e svantaggi.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-330">hello section [Table Design Patterns](#table-design-patterns) describes some detailed design patterns for hello Table service and highlights some these trade-offs.</span></span> <span data-ttu-id="dc5a6-331">In pratica si vedrà che molte progettazioni ottimizzate per le query delle entità vanno bene anche per la modifica delle entità.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-331">In practice, you will find that many designs optimized for querying entities also work well for modifying entities.</span></span>  

### <a name="optimizing-hello-performance-of-insert-update-and-delete-operations"></a><span data-ttu-id="dc5a6-332">Ottimizzazione delle prestazioni di hello di inserimento, aggiornamento ed eliminazione</span><span class="sxs-lookup"><span data-stu-id="dc5a6-332">Optimizing hello performance of insert, update, and delete operations</span></span>
<span data-ttu-id="dc5a6-333">tooupdate o eliminare un'entità, è necessario essere in grado di tooidentify usando hello **PartitionKey** e **RowKey** valori.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-333">tooupdate or delete an entity, you must be able tooidentify it by using hello **PartitionKey** and **RowKey** values.</span></span> <span data-ttu-id="dc5a6-334">In questo senso, la scelta di **PartitionKey** e **RowKey** per la modifica di entità deve seguire simile criteri tooyour scelta toosupport scegliere query dal momento che le entità tooidentify come più efficiente possibile.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-334">In this respect, your choice of **PartitionKey** and **RowKey** for modifying entities should follow similar criteria tooyour choice toosupport point queries because you want tooidentify entities as efficiently as possible.</span></span> <span data-ttu-id="dc5a6-335">Non si desidera un inefficiente partizione o tabella analisi toolocate un'entità in hello toodiscover ordine toouse **PartitionKey** e **RowKey** valori, è necessario tooupdate oppure eliminarla.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-335">You do not want toouse an inefficient partition or table scan toolocate an entity in order toodiscover hello **PartitionKey** and **RowKey** values you need tooupdate or delete it.</span></span>  

<span data-ttu-id="dc5a6-336">Hello in seguito nella sezione hello modelli [modelli di progettazione tabella](#table-design-patterns) indirizzo l'ottimizzazione delle prestazioni di hello o l'inserimento, aggiornamento e le operazioni di eliminazione:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-336">hello following patterns in hello section [Table Design Patterns](#table-design-patterns) address optimizing hello performance or your insert, update, and delete operations:</span></span>  

* <span data-ttu-id="dc5a6-337">[Eliminazione di volumi elevati con un modello](#high-volume-delete-pattern) -eliminazione hello attiva di un volume elevato di entità mediante l'archiviazione di tutte le entità hello per l'eliminazione simultanea nella propria tabella separata, ma eliminare entità hello eliminando hello tabella.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-337">[High volume delete pattern](#high-volume-delete-pattern) - Enable hello deletion of a high volume of entities by storing all hello entities for simultaneous deletion in their own separate table; you delete hello entities by deleting hello table.</span></span>  
* <span data-ttu-id="dc5a6-338">[Modello serie di dati](#data-series-pattern) -archivio dati completo serie in un numero di hello toominimize singola entità richieste di effettuate.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-338">[Data series pattern](#data-series-pattern) - Store complete data series in a single entity toominimize hello number of requests you make.</span></span>  
* <span data-ttu-id="dc5a6-339">[Modello di entità Wide](#wide-entities-pattern) -utilizzare come entità logiche più entità fisiche toostore con più di 252 proprietà.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-339">[Wide entities pattern](#wide-entities-pattern) - Use multiple physical entities toostore logical entities with more than 252 properties.</span></span>  
* <span data-ttu-id="dc5a6-340">[Modello di entità di grandi dimensioni](#large-entities-pattern) -utilizza valori di proprietà di grandi dimensioni toostore archiviazione blob.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-340">[Large entities pattern](#large-entities-pattern) - Use blob storage toostore large property values.</span></span>  

### <a name="ensuring-consistency-in-your-stored-entities"></a><span data-ttu-id="dc5a6-341">Verifica della coerenza nelle entità archiviate</span><span class="sxs-lookup"><span data-stu-id="dc5a6-341">Ensuring consistency in your stored entities</span></span>
<span data-ttu-id="dc5a6-342">altri fattori chiave che influenza la scelta di chiavi per l'ottimizzazione delle modifiche dei dati è Hello come tooensure coerenza con le transazioni atomiche.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-342">hello other key factor that influences your choice of keys for optimizing data modifications is how tooensure consistency by using atomic transactions.</span></span> <span data-ttu-id="dc5a6-343">È possibile utilizzare solo un toooperate EGT in entità archiviate in hello stessa partizione.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-343">You can only use an EGT toooperate on entities stored in hello same partition.</span></span>  

<span data-ttu-id="dc5a6-344">Hello in seguito nella sezione hello modelli [modelli di progettazione tabella](#table-design-patterns) la gestione della coerenza di indirizzi:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-344">hello following patterns in hello section [Table Design Patterns](#table-design-patterns) address managing consistency:</span></span>  

* <span data-ttu-id="dc5a6-345">[Modello di indice secondario intra-partition](#intra-partition-secondary-index-pattern) -archiviazione di più copie di ogni entità mediante diverse **RowKey** valori (in hello stessa partizione) tooenable veloci ed efficienti ricerche e ordinamento alternativo gli ordini tramite diversi **RowKey** valori.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-345">[Intra-partition secondary index pattern](#intra-partition-secondary-index-pattern) - Store multiple copies of each entity using different **RowKey** values (in hello same partition) tooenable fast and efficient lookups and alternate sort orders by using different **RowKey** values.</span></span>  
* <span data-ttu-id="dc5a6-346">[Modello di indice secondario partizione tra](#inter-partition-secondary-index-pattern) : archiviazione di più copie di ogni entità utilizzando i diversi valori RowKey in partizioni distinte o in tabelle separate tooenable veloce e ricerche efficienti e ordinamento alternativo gli ordini con diversi **RowKey** valori.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-346">[Inter-partition secondary index pattern](#inter-partition-secondary-index-pattern) - Store multiple copies of each entity using different RowKey values in separate partitions or in separate tables tooenable fast and efficient lookups and alternate sort orders by using different **RowKey** values.</span></span>  
* <span data-ttu-id="dc5a6-347">[Modello per transazioni con coerenza finale](#eventually-consistent-transactions-pattern) - Abilita un comportamento di coerenza finale tra i limiti della partizione o i limiti del sistema di archiviazione usando le code di Azure.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-347">[Eventually consistent transactions pattern](#eventually-consistent-transactions-pattern) - Enable eventually consistent behavior across partition boundaries or storage system boundaries by using Azure queues.</span></span>
* <span data-ttu-id="dc5a6-348">[Modello di entità indice](#index-entities-pattern) -Gestisci entità tooenable efficienti ricerche che restituiscono elenchi di entità.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-348">[Index Entities Pattern](#index-entities-pattern) - Maintain index entities tooenable efficient searches that return lists of entities.</span></span>  
* <span data-ttu-id="dc5a6-349">[Modello denormalizzazione](#denormalization-pattern) -combinare i dati relativi insieme in una singola entità tooenable tooretrieve tutti hello è necessario con una query con singolo punto dati.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-349">[Denormalization pattern](#denormalization-pattern) - Combine related data together in a single entity tooenable you tooretrieve all hello data you need with a single point query.</span></span>  
* <span data-ttu-id="dc5a6-350">[Modello serie di dati](#data-series-pattern) -archivio dati completo serie in un numero di hello toominimize singola entità richieste di effettuate.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-350">[Data series pattern](#data-series-pattern) - Store complete data series in a single entity toominimize hello number of requests you make.</span></span>  

<span data-ttu-id="dc5a6-351">Per informazioni sui gruppi di entità, vedere la sezione hello [gruppi di entità](#entity-group-transactions).</span><span class="sxs-lookup"><span data-stu-id="dc5a6-351">For information about entity group transactions, see hello section [Entity Group Transactions](#entity-group-transactions).</span></span>  

### <a name="ensuring-your-design-for-efficient-modifications-facilitates-efficient-queries"></a><span data-ttu-id="dc5a6-352">Verifica della capacità della progettazione per modifiche efficienti di facilitare query efficienti</span><span class="sxs-lookup"><span data-stu-id="dc5a6-352">Ensuring your design for efficient modifications facilitates efficient queries</span></span>
<span data-ttu-id="dc5a6-353">In molti casi, una progettazione per i risultati di query efficienti modifiche efficiente, ma è sempre necessario valutare se hello caso dello scenario specifico.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-353">In many cases, a design for efficient querying results in efficient modifications, but you should always evaluate whether this is hello case for your specific scenario.</span></span> <span data-ttu-id="dc5a6-354">Alcuni dei modelli di hello nella sezione hello [modelli di progettazione tabella](#table-design-patterns) in modo esplicito, valutare i compromessi tra l'esecuzione di query e modifica di entità e tenere sempre in numero di hello conto di ogni tipo di operazione.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-354">Some of hello patterns in hello section [Table Design Patterns](#table-design-patterns) explicitly evaluate trade-offs between querying and modifying entities, and you should always take into account hello number of each type of operation.</span></span>  

<span data-ttu-id="dc5a6-355">Hello in seguito nella sezione hello modelli [modelli di progettazione tabella](#table-design-patterns) indirizzo compromessi tra la progettazione di query efficienti e la progettazione per la modifica dei dati efficiente:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-355">hello following patterns in hello section [Table Design Patterns](#table-design-patterns) address trade-offs between designing for efficient queries and designing for efficient data modification:</span></span>  

* <span data-ttu-id="dc5a6-356">[Modello di chiave composta](#compound-key-pattern) -utilizzare composta **RowKey** tooenable valori toolookup un client relativi dati con un singolo punto di query.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-356">[Compound key pattern](#compound-key-pattern) - Use compound **RowKey** values tooenable a client toolookup related data with a single point query.</span></span>  
* <span data-ttu-id="dc5a6-357">[Modello della parte finale del log](#log-tail-pattern) -hello recuperare  *n*  le entità aggiunte più di recente tooa partizione utilizzando un **RowKey** valore che ordina in data inversa e l'ordine temporale.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-357">[Log tail pattern](#log-tail-pattern) - Retrieve hello *n* entities most recently added tooa partition by using a **RowKey** value that sorts in reverse date and time order.</span></span>  

## <a name="encrypting-table-data"></a><span data-ttu-id="dc5a6-358">Crittografia dei dati di tabella</span><span class="sxs-lookup"><span data-stu-id="dc5a6-358">Encrypting Table Data</span></span>
<span data-ttu-id="dc5a6-359">Libreria Client di archiviazione Azure .NET supporta crittografia stringa proprietà dell'entità per l'inserimento di Hello e sostituire operazioni.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-359">hello .NET Azure Storage Client Library supports encryption of string entity properties for insert and replace operations.</span></span> <span data-ttu-id="dc5a6-360">crittografato Hello sono archiviate nel servizio hello come proprietà binarie e vengono convertiti toostrings indietro dopo la decrittografia.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-360">hello encrypted strings are stored on hello service as binary properties, and they are converted back toostrings after decryption.</span></span>    

<span data-ttu-id="dc5a6-361">Per le tabelle, inoltre i criteri di crittografia toohello, gli utenti devono specificare toobe proprietà hello crittografati.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-361">For tables, in addition toohello encryption policy, users must specify hello properties toobe encrypted.</span></span> <span data-ttu-id="dc5a6-362">Questa operazione può essere eseguita specificando un attributo [EncryptProperty] \(per le entità POCO che derivano da TableEntity) o un resolver di crittografia nelle opzioni di richiesta.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-362">This can be done by either specifying an [EncryptProperty] attribute (for POCO entities that derive from TableEntity) or an encryption resolver in request options.</span></span> <span data-ttu-id="dc5a6-363">Un resolver di crittografia è un delegato che accetta una chiave di partizione, una chiave di riga e un nome di proprietà e restituisce un valore booleano che indica se tale proprietà deve essere crittografata.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-363">An encryption resolver is a delegate that takes a partition key, row key, and property name and returns a Boolean that indicates whether that property should be encrypted.</span></span> <span data-ttu-id="dc5a6-364">Durante la crittografia, la libreria client di hello utilizzerà questo toodecide informazioni se una proprietà deve essere crittografata durante la scrittura di transito toohello.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-364">During encryption, hello client library will use this information toodecide whether a property should be encrypted while writing toohello wire.</span></span> <span data-ttu-id="dc5a6-365">delegato di Hello fornisce anche la possibilità di hello di logica per la modalità di crittografia delle proprietà.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-365">hello delegate also provides for hello possibility of logic around how properties are encrypted.</span></span> <span data-ttu-id="dc5a6-366">(Ad esempio, se X, quindi crittografa la proprietà A; in caso contrario crittografa le proprietà A e B). Si noti che è necessario non tooprovide queste informazioni durante la lettura o di una query sulle entità.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-366">(For example, if X, then encrypt property A; otherwise encrypt properties A and B.) Note that it is not necessary tooprovide this information while reading or querying entities.</span></span>

<span data-ttu-id="dc5a6-367">Si noti che l'unione non è attualmente supportata.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-367">Note that merge is not currently supported.</span></span> <span data-ttu-id="dc5a6-368">Poiché un subset delle proprietà è stato crittografato in precedenza usando una chiave diversa, semplicemente l'unione di nuove proprietà hello e l'aggiornamento dei metadati hello comporterà la perdita di dati.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-368">Since a subset of properties may have been encrypted previously using a different key, simply merging hello new properties and updating hello metadata will result in data loss.</span></span> <span data-ttu-id="dc5a6-369">L'unione di uno, è necessario rendere servizio aggiuntivo chiama entità preesistente di hello tooread dal servizio hello o utilizzando una nuova chiave per ogni proprietà, che non sono adatti per motivi di prestazioni.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-369">Merging either requires making extra service calls tooread hello pre-existing entity from hello service, or using a new key per property, both of which are not suitable for performance reasons.</span></span>     

<span data-ttu-id="dc5a6-370">Per informazioni sulla crittografia dei dati di tabella, vedere [Crittografia lato client e insieme di credenziali delle chiavi di Azure per Archiviazione di Microsoft Azure](storage-client-side-encryption.md).</span><span class="sxs-lookup"><span data-stu-id="dc5a6-370">For information about encrypting table data, see [Client-Side Encryption and Azure Key Vault for Microsoft Azure Storage](storage-client-side-encryption.md).</span></span>  

## <a name="modelling-relationships"></a><span data-ttu-id="dc5a6-371">Modellazione di relazioni</span><span class="sxs-lookup"><span data-stu-id="dc5a6-371">Modelling relationships</span></span>
<span data-ttu-id="dc5a6-372">Compilazione di modelli di dominio è un passaggio fondamentale nella progettazione di hello dei sistemi complessi.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-372">Building domain models is a key step in hello design of complex systems.</span></span> <span data-ttu-id="dc5a6-373">In genere, usare hello modellazione processo tooidentify entità e relazioni hello tra di esse come un modo toounderstand hello dominio aziendale e indicano progettazione hello del sistema.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-373">Typically, you use hello modelling process tooidentify entities and hello relationships between them as a way toounderstand hello business domain and inform hello design of your system.</span></span> <span data-ttu-id="dc5a6-374">Questa sezione viene illustrato come è possibile convertire i tipi relazione comuni hello trovato nel dominio modelli toodesigns per hello del servizio tabelle.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-374">This section focuses on how you can translate some of hello common relationship types found in domain models toodesigns for hello Table service.</span></span> <span data-ttu-id="dc5a6-375">il processo di Hello di mapping da un tooa modello di dati logico fisico basato su modello dati NoSQL-è molto diverso da quella utilizzata quando si progetta un database relazionale.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-375">hello process of mapping from a logical data-model tooa physical NoSQL based data-model is very different from that used when designing a relational database.</span></span> <span data-ttu-id="dc5a6-376">Progettazione di database relazionali presuppone che in genere un processo di normalizzazione dei dati ottimizzato per ridurre al minimo di ridondanza e una funzionalità di query dichiarativa che astrae hello come implementazione del funzionamento di database hello.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-376">Relational databases design typically assumes a data normalization process optimized for minimizing redundancy – and a declarative querying capability that abstracts how hello implementation of how hello database works.</span></span>  

### <a name="one-to-many-relationships"></a><span data-ttu-id="dc5a6-377">Relazioni uno a molti</span><span class="sxs-lookup"><span data-stu-id="dc5a6-377">One-to-many relationships</span></span>
<span data-ttu-id="dc5a6-378">Le relazioni uno a molti tra gli oggetti del dominio aziendale sono molto frequenti: ad esempio, un reparto ha più dipendenti.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-378">One-to-many relationships between business domain objects occur very frequently: for example, one department has many employees.</span></span> <span data-ttu-id="dc5a6-379">Esistono diverse relazioni uno-a-molti di tooimplement modi hello del servizio tabelle ogni con i vantaggi e svantaggi che possono essere rilevanti toohello particolare scenario.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-379">There are several ways tooimplement one-to-many relationships in hello Table service each with pros and cons that may be relevant toohello particular scenario.</span></span>  

<span data-ttu-id="dc5a6-380">Considerare l'esempio hello di una grande azienda multinazionale con decine di migliaia di servizi e le entità dipendente in ogni reparto ha molti dipendenti e ogni dipendente come associata a un reparto specifico.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-380">Consider hello example of a large multi-national corporation with tens of thousands of departments and employee entities where every department has many employees and each employee as associated with one specific department.</span></span> <span data-ttu-id="dc5a6-381">Un approccio consiste reparto separato toostore e le entità dipendente come i seguenti:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-381">One approach is toostore separate department and employee entities such as these:</span></span>  

![][1]

<span data-ttu-id="dc5a6-382">Questo esempio mostra una relazione uno-a-molti implicita tra tipi di hello basati su hello **PartitionKey** valore.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-382">This example shows an implicit one-to-many relationship between hello types based on hello **PartitionKey** value.</span></span> <span data-ttu-id="dc5a6-383">Ogni reparto può avere più dipendenti.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-383">Each department can have many employees.</span></span>  

<span data-ttu-id="dc5a6-384">In questo esempio viene inoltre un'entità di reparto e le entità correlate dipendente in hello stessa partizione.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-384">This example also shows a department entity and its related employee entities in hello same partition.</span></span> <span data-ttu-id="dc5a6-385">È possibile scegliere anche gli account di archiviazione per i tipi di entità diversa hello, tabelle o partizioni diverse toouse.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-385">You could choose toouse different partitions, tables, or even storage accounts for hello different entity types.</span></span>  

<span data-ttu-id="dc5a6-386">Un approccio alternativo è toodenormalize le entità dipendente solo dati e l'archivio dati denormalizzati reparto, come illustrato nell'esempio seguente hello.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-386">An alternative approach is toodenormalize your data and store only employee entities with denormalized department data as shown in hello following example.</span></span> <span data-ttu-id="dc5a6-387">In questo scenario specifico, questo approccio denormalizzato potrebbe non essere hello migliore se si hanno requisito toobe toochange in grado di hello i dettagli su un responsabile del reparto perché toodo ciò è necessario tooupdate ogni dipendente nel reparto hello.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-387">In this particular scenario, this denormalized approach may not be hello best if you have a requirement toobe able toochange hello details of a department manager because toodo this you need tooupdate every employee in hello department.</span></span>  

![][2]

<span data-ttu-id="dc5a6-388">Per ulteriori informazioni, vedere hello [modello denormalizzazione](#denormalization-pattern) più avanti in questa Guida.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-388">For more information, see hello [Denormalization pattern](#denormalization-pattern) later in this guide.</span></span>  

<span data-ttu-id="dc5a6-389">Hello nella tabella seguente sono riepilogate hello vantaggi e svantaggi di ognuno di hello approcci descritti in precedenza per l'archiviazione di dipendente ed entità reparto che hanno una relazione uno-a-molti.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-389">hello following table summarizes hello pros and cons of each of hello approaches outlined above for storing employee and department entities that have a one-to-many relationship.</span></span> <span data-ttu-id="dc5a6-390">È necessario considerare anche la frequenza con cui si prevede che tooperform diverse operazioni: può essere accettabile toohave una struttura che include un'operazione costosa se tale operazione viene eseguita solo raramente.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-390">You should also consider how often you expect tooperform various operations: it may be acceptable toohave a design that includes an expensive operation if that operation only happens infrequently.</span></span>  

<table>
<tr>
<th><span data-ttu-id="dc5a6-391">Approccio</span><span class="sxs-lookup"><span data-stu-id="dc5a6-391">Approach</span></span></th>
<th><span data-ttu-id="dc5a6-392">Vantaggi</span><span class="sxs-lookup"><span data-stu-id="dc5a6-392">Pros</span></span></th>
<th><span data-ttu-id="dc5a6-393">Svantaggi</span><span class="sxs-lookup"><span data-stu-id="dc5a6-393">Cons</span></span></th>
</tr>
<tr>
<td><span data-ttu-id="dc5a6-394">Tipi di entità distinti, stessa partizione, stessa tabella</span><span class="sxs-lookup"><span data-stu-id="dc5a6-394">Separate entity types, same partition, same table</span></span></td>
<td>
<ul>
<li><span data-ttu-id="dc5a6-395">È possibile aggiornare un'entità reparto con un'unica operazione.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-395">You can update a department entity with a single operation.</span></span></li>
<li><span data-ttu-id="dc5a6-396">Se si dispone di un requisito toomodify un'entità di reparto, è possibile utilizzare una coerenza toomaintain EGT ogni volta che si aggiornamenti, inserimenti ed eliminazioni un'entità employee.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-396">You can use an EGT toomaintain consistency if you have a requirement toomodify a department entity whenever you update/insert/delete an employee entity.</span></span> <span data-ttu-id="dc5a6-397">ad esempio se si mantiene un conteggio dei dipendenti per ogni reparto.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-397">For example if you maintain a departmental employee count for each department.</span></span></li>
</ul>
</td>
<td>
<ul>
<li><span data-ttu-id="dc5a6-398">Potrebbe essere necessario tooretrieve sia un dipendente e un'entità di reparto per alcune attività di client.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-398">You may need tooretrieve both an employee and a department entity for some client activities.</span></span></li>
<li><span data-ttu-id="dc5a6-399">Operazioni di archiviazione si verificano in hello stessa partizione.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-399">Storage operations happen in hello same partition.</span></span> <span data-ttu-id="dc5a6-400">Con volumi di transazioni elevati, potrebbe risultarne un hotspot.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-400">At high transaction volumes, this may result in a hotspot.</span></span></li>
<li><span data-ttu-id="dc5a6-401">È possibile spostare un reparto di nuovo tooa dipendente utilizzando un EGT.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-401">You cannot move an employee tooa new department using an EGT.</span></span></li>
</ul>
</td>
</tr>
<tr>
<td><span data-ttu-id="dc5a6-402">Tipi di entità distinti, partizioni o tabelle o account di archiviazione diversi</span><span class="sxs-lookup"><span data-stu-id="dc5a6-402">Separate entity types, different partitions or tables or storage accounts</span></span></td>
<td>
<ul>
<li><span data-ttu-id="dc5a6-403">È possibile aggiornare un'entità reparto o un'entità dipendente con un'unica operazione.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-403">You can update a department entity or employee entity with a single operation.</span></span></li>
<li><span data-ttu-id="dc5a6-404">Volumi elevati di transazioni, favorisce la diffusione hello carico tra più partizioni.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-404">At high transaction volumes, this may help spread hello load across more partitions.</span></span></li>
</ul>
</td>
<td>
<ul>
<li><span data-ttu-id="dc5a6-405">Potrebbe essere necessario tooretrieve sia un dipendente e un'entità di reparto per alcune attività di client.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-405">You may need tooretrieve both an employee and a department entity for some client activities.</span></span></li>
<li><span data-ttu-id="dc5a6-406">Non è possibile utilizzare EGTs toomaintain coerenza quando si aggiorna, inserimenti ed eliminazioni un dipendente e aggiornamento di un reparto.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-406">You cannot use EGTs toomaintain consistency when you update/insert/delete an employee and update a department.</span></span> <span data-ttu-id="dc5a6-407">ad esempio quando si aggiorna un conteggio dipendenti in un'entità reparto.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-407">For example, updating an employee count in a department entity.</span></span></li>
<li><span data-ttu-id="dc5a6-408">È possibile spostare un reparto di nuovo tooa dipendente utilizzando un EGT.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-408">You cannot move an employee tooa new department using an EGT.</span></span></li>
</ul>
</td>
</tr>
<tr>
<td><span data-ttu-id="dc5a6-409">Denormalizzazione in un solo tipo di entità</span><span class="sxs-lookup"><span data-stu-id="dc5a6-409">Denormalize into single entity type</span></span></td>
<td>
<ul>
<li><span data-ttu-id="dc5a6-410">È possibile recuperare tutte le informazioni di hello che è necessario con una singola richiesta.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-410">You can retrieve all hello information you need with a single request.</span></span></li>
</ul>
</td>
<td>
<ul>
<li><span data-ttu-id="dc5a6-411">Se sono necessarie informazioni di reparto tooupdate (ciò richiederebbe si tooupdate tutti i dipendenti hello in un reparto) può essere costoso toomaintain coerenza.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-411">It may be expensive toomaintain consistency if you need tooupdate department information (this would require you tooupdate all hello employees in a department).</span></span></li>
</ul>
</td>
</tr>
</table>

<span data-ttu-id="dc5a6-412">Come si sceglie tra queste opzioni e che di professionisti hello e gli svantaggi sono i più importanti, dipende gli scenari dell'applicazione specifici.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-412">How you choose between these options, and which of hello pros and cons are most significant, depends on your specific application scenarios.</span></span> <span data-ttu-id="dc5a6-413">Ad esempio, la frequenza con cui modificare le entità reparto; tutte le query dipendente necessario hello reparto informazioni; come chiudere sei toohello limiti di scalabilità su partizioni o account di archiviazione?</span><span class="sxs-lookup"><span data-stu-id="dc5a6-413">For example, how often do you modify department entities; do all your employee queries need hello additional departmental information; how close are you toohello scalability limits on your partitions or your storage account?</span></span>  

### <a name="one-to-one-relationships"></a><span data-ttu-id="dc5a6-414">Relazioni uno a uno</span><span class="sxs-lookup"><span data-stu-id="dc5a6-414">One-to-one relationships</span></span>
<span data-ttu-id="dc5a6-415">I modelli di dominio possono includere relazioni uno a uno tra le entità.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-415">Domain models may include one-to-one relationships between entities.</span></span> <span data-ttu-id="dc5a6-416">Se è necessario tooimplement una relazione uno a uno in hello del servizio tabelle, è necessario scegliere come toolink hello due entità correlate quando è necessario tooretrieve entrambi.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-416">If you need tooimplement a one-to-one relationship in hello Table service, you must also choose how toolink hello two related entities when you need tooretrieve them both.</span></span> <span data-ttu-id="dc5a6-417">Questo collegamento può essere implicita, in base a una convenzione di valori di chiave hello o esplicita tramite l'archiviazione di un collegamento nel formato hello **PartitionKey** e **RowKey** valori in ogni tooits entità entità correlata.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-417">This link can be either implicit, based on a convention in hello key values, or explicit by storing a link in hello form of **PartitionKey** and **RowKey** values in each entity tooits related entity.</span></span> <span data-ttu-id="dc5a6-418">Per una discussione su se è consigliabile archiviare hello le entità correlate in hello stessa partizione, vedere la sezione hello [uno-a-molti relazioni](#one-to-many-relationships).</span><span class="sxs-lookup"><span data-stu-id="dc5a6-418">For a discussion of whether you should store hello related entities in hello same partition, see hello section [One-to-many relationships](#one-to-many-relationships).</span></span>  

<span data-ttu-id="dc5a6-419">Si noti che esistono inoltre considerazioni sull'implementazione che si potrebbero generare relazioni uno a uno tooimplement nel servizio tabelle hello:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-419">Note that there are also implementation considerations that might lead you tooimplement one-to-one relationships in hello Table service:</span></span>  

* <span data-ttu-id="dc5a6-420">Gestione di entità di grandi dimensioni (per altre informazioni, vedere [Modello di entità di grandi dimensioni](#large-entities-pattern)).</span><span class="sxs-lookup"><span data-stu-id="dc5a6-420">Handling large entities (for more information, see [Large Entities Pattern](#large-entities-pattern)).</span></span>  
* <span data-ttu-id="dc5a6-421">Implementazione di controlli di accesso. Per altre informazioni, vedere [Controllo dell'accesso con le firme di accesso condiviso](#controlling-access-with-shared-access-signatures).</span><span class="sxs-lookup"><span data-stu-id="dc5a6-421">Implementing access controls (for more information, see [Controlling access with Shared Access Signatures](#controlling-access-with-shared-access-signatures)).</span></span>  

### <a name="join-in-hello-client"></a><span data-ttu-id="dc5a6-422">Creare un join nel client hello</span><span class="sxs-lookup"><span data-stu-id="dc5a6-422">Join in hello client</span></span>
<span data-ttu-id="dc5a6-423">Anche se esistono relazioni toomodel modi in hello del servizio tabelle, non si dimenticare che i due motivi principali hello per l'utilizzo del servizio tabelle hello siano scalabilità e prestazioni.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-423">Although there are ways toomodel relationships in hello Table service, you should not forget that hello two prime reasons for using hello Table service are scalability and performance.</span></span> <span data-ttu-id="dc5a6-424">Se che si sono modellazione molte relazioni che compromettono le prestazioni di hello e la scalabilità della soluzione, è necessario richiedere manualmente che se è necessario toobuild tutti hello relazioni tra i dati nella struttura della tabella.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-424">If you find you are modelling many relationships that compromise hello performance and scalability of your solution, you should ask yourself if it is necessary toobuild all hello data relationships into your table design.</span></span> <span data-ttu-id="dc5a6-425">È possibile toosimplify in grado di hello progettazioni e migliorare hello scalabilità e prestazioni della soluzione, se si consente l'applicazione client di eseguire tutti i join necessari.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-425">You may be able toosimplify hello design and improve hello scalability and performance of your solution if you let your client application perform any necessary joins.</span></span>  

<span data-ttu-id="dc5a6-426">Ad esempio, se si dispongono di tabelle di piccole dimensioni contenenti dati che vengono modificati spesso, quindi è possibile recuperare i dati una volta e memorizzarlo nella cache sul client hello.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-426">For example, if you have small tables that contain data that does not change very often, then you can retrieve this data once and cache it on hello client.</span></span> <span data-ttu-id="dc5a6-427">Ciò consente di evitare round trip ripetuti tooretrieve hello stessi dati.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-427">This can avoid repeated roundtrips tooretrieve hello same data.</span></span> <span data-ttu-id="dc5a6-428">Negli esempi di hello esaminata in questa Guida, hello set reparti in un'organizzazione di piccole dimensioni è probabilmente toobe di piccole dimensioni e modificare raramente rende un ottimo candidato per l'applicazione client è possibile scaricare una volta i dati e della cache come cercare dati.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-428">In hello examples we have looked at in this guide, hello set of departments in a small organization is likely toobe small and change infrequently making it a good candidate for data that client application can download once and cache as look up data.</span></span>  

### <a name="inheritance-relationships"></a><span data-ttu-id="dc5a6-429">Relazioni di ereditarietà</span><span class="sxs-lookup"><span data-stu-id="dc5a6-429">Inheritance relationships</span></span>
<span data-ttu-id="dc5a6-430">Se l'applicazione client utilizza un set di classi che fanno parte di un'entità di business toorepresent relazione di ereditarietà, è possibile mantenere facilmente le entità nel servizio tabelle hello.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-430">If your client application uses a set of classes that form part of an inheritance relationship toorepresent business entities, you can easily persist those entities in hello Table service.</span></span> <span data-ttu-id="dc5a6-431">Ad esempio, potrebbe essere hello seguente insieme di classi definite nell'applicazione client in cui **persona** è una classe astratta.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-431">For example, you might have hello following set of classes defined in your client application where **Person** is an abstract class.</span></span>

![][3]

<span data-ttu-id="dc5a6-432">È possibile rendere persistenti le istanze di due classi concrete hello in hello del servizio tabelle utilizzando una singola tabella di persona con entità in un aspetto simile al seguente:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-432">You can persist instances of hello two concrete classes in hello Table service using a single Person table using entities in that look like this:</span></span>  

![][4]

<span data-ttu-id="dc5a6-433">Per ulteriori informazioni sull'utilizzo di più tipi di entità nella stessa tabella nel codice client hello, vedere la sezione hello [utilizzo dei tipi di entità eterogenee](#working-with-heterogeneous-entity-types) più avanti in questa Guida.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-433">For more information about working with multiple entity types in hello same table in client code, see hello section [Working with heterogeneous entity types](#working-with-heterogeneous-entity-types) later in this guide.</span></span> <span data-ttu-id="dc5a6-434">Questo fornisce esempi di come toorecognize hello il tipo di entità nel codice client.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-434">This provides examples of how toorecognize hello entity type in client code.</span></span>  

## <a name="table-design-patterns"></a><span data-ttu-id="dc5a6-435">Modelli di progettazione tabella</span><span class="sxs-lookup"><span data-stu-id="dc5a6-435">Table Design Patterns</span></span>
<span data-ttu-id="dc5a6-436">Nelle sezioni precedenti, sono state illustrate alcune discussioni dettagliate su come toooptimize tabella progettate per entrambi il recupero dei dati di entità tramite query e per l'inserimento, aggiornamento ed eliminazione di dati di entità.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-436">In previous sections, you have seen some detailed discussions about how toooptimize your table design for both retrieving entity data using queries and for inserting, updating, and deleting entity data.</span></span> <span data-ttu-id="dc5a6-437">Questa sezione descrive alcuni modelli adatti all'uso con le soluzioni di servizio tabelle.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-437">This section describes some patterns appropriate for use with Table service solutions.</span></span> <span data-ttu-id="dc5a6-438">Inoltre, si noterà come praticamente è possibile risolvere alcuni dei problemi di hello e compromessi generati in precedenza in questa Guida.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-438">In addition, you will see how you can practically address some of hello issues and trade-offs raised previously in this guide.</span></span> <span data-ttu-id="dc5a6-439">Hello diagramma seguente vengono riepilogate le relazioni di hello tra modelli diversi di hello:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-439">hello following diagram summarizes hello relationships between hello different patterns:</span></span>  

![][5]

<span data-ttu-id="dc5a6-440">mappa di schema Hello sopra sono evidenziate alcune relazioni tra modelli (blu) e anti-pattern (arancione) che sono documentati in questa Guida.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-440">hello pattern map above highlights some relationships between patterns (blue) and anti-patterns (orange) that are documented in this guide.</span></span> <span data-ttu-id="dc5a6-441">Ovviamente esistono molti altri modelli utili.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-441">There are of course many other patterns that are worth considering.</span></span> <span data-ttu-id="dc5a6-442">Ad esempio, uno dei principali scenari di hello per il servizio tabelle è hello toouse [materializzata vista modello](https://msdn.microsoft.com/library/azure/dn589782.aspx) da hello [comando Query Responsibility Segregation (CQRS)](https://msdn.microsoft.com/library/azure/jj554200.aspx) modello.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-442">For example, one of hello key scenarios for Table Service is toouse hello [Materialized View Pattern](https://msdn.microsoft.com/library/azure/dn589782.aspx) from hello [Command Query Responsibility Segregation (CQRS)](https://msdn.microsoft.com/library/azure/jj554200.aspx) pattern.</span></span>  

### <a name="intra-partition-secondary-index-pattern"></a><span data-ttu-id="dc5a6-443">Modello per indice secondario intrapartizione</span><span class="sxs-lookup"><span data-stu-id="dc5a6-443">Intra-partition secondary index pattern</span></span>
<span data-ttu-id="dc5a6-444">Archiviazione di più copie di ogni entità mediante diverse **RowKey** valori (in hello stessa partizione) tooenable veloci ed efficienti ricerche e ordinamento alternativo gli ordini con diversi **RowKey** valori.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-444">Store multiple copies of each entity using different **RowKey** values (in hello same partition) tooenable fast and efficient lookups and alternate sort orders by using different **RowKey** values.</span></span> <span data-ttu-id="dc5a6-445">Gli aggiornamenti tra copie possono essere mantenuti coerenti usando transazioni EGT.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-445">Updates between copies can be kept consistent using EGT's.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="dc5a6-446">Contesto e problema</span><span class="sxs-lookup"><span data-stu-id="dc5a6-446">Context and problem</span></span>
<span data-ttu-id="dc5a6-447">Hello del servizio tabelle vengono indicizzati automaticamente le entità utilizzando hello **PartitionKey** e **RowKey** valori.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-447">hello Table service automatically indexes entities using hello **PartitionKey** and **RowKey** values.</span></span> <span data-ttu-id="dc5a6-448">In questo modo un tooretrieve applicazione client di un'entità in modo efficiente utilizzando questi valori.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-448">This enables a client application tooretrieve an entity efficiently using these values.</span></span> <span data-ttu-id="dc5a6-449">Ad esempio, utilizzando una struttura della tabella hello illustrato di seguito, un'applicazione client consente tooretrieve di query un punto di un'entità di singolo dipendente utilizzando il nome di reparto hello e id dipendente hello (hello **PartitionKey** e  **RowKey** valori).</span><span class="sxs-lookup"><span data-stu-id="dc5a6-449">For example, using hello table structure shown below, a client application can use a point query tooretrieve an individual employee entity by using hello department name and hello employee id (hello **PartitionKey** and **RowKey** values).</span></span> <span data-ttu-id="dc5a6-450">Un client può anche recuperare entità ordinate per ID dipendente in ogni reparto.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-450">A client can also retrieve entities sorted by employee id within each department.</span></span>

![][6]

<span data-ttu-id="dc5a6-451">Se si desidera anche toobe in grado di toofind un'entità dipendente in base al valore di hello di un'altra proprietà, ad esempio indirizzo di posta elettronica, è necessario utilizzare un livello di efficienza minore toofind di analisi partizione una corrispondenza.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-451">If you also want toobe able toofind an employee entity based on hello value of another property, such as email address, you must use a less efficient partition scan toofind a match.</span></span> <span data-ttu-id="dc5a6-452">Questo avviene perché il servizio tabelle hello non fornisce indici secondari.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-452">This is because hello table service does not provide secondary indexes.</span></span> <span data-ttu-id="dc5a6-453">Inoltre, non è toorequest alcuna opzione un elenco di dipendenti in un ordine diverso rispetto a **RowKey** ordine.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-453">In addition, there is no option toorequest a list of employees sorted in a different order than **RowKey** order.</span></span>  

#### <a name="solution"></a><span data-ttu-id="dc5a6-454">Soluzione</span><span class="sxs-lookup"><span data-stu-id="dc5a6-454">Solution</span></span>
<span data-ttu-id="dc5a6-455">toowork intorno mancanza hello di indici secondari, è possibile archiviare più copie di ogni entità con ciascuna copia con un altro **RowKey** valore.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-455">toowork around hello lack of secondary indexes, you can store multiple copies of each entity with each copy using a different **RowKey** value.</span></span> <span data-ttu-id="dc5a6-456">Se si archivia un'entità con strutture hello illustrate di seguito, è possibile recuperare in modo efficiente l'entità dipendente in base all'id dipendente o di indirizzo di posta elettronica. i valori del prefisso per hello Hello **RowKey**, "empid_" e "email_" consentono di tooquery per un singolo dipendente o un intervallo di dipendenti con un intervallo di indirizzi di posta elettronica o gli ID dipendente.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-456">If you store an entity with hello structures shown below, you can efficiently retrieve employee entities based on email address or employee id. hello prefix values for hello **RowKey**, "empid_" and "email_" enable you tooquery for a single employee or a range of employees by using a range of email addresses or employee ids.</span></span>  

![][7]

<span data-ttu-id="dc5a6-457">Hello seguenti due criteri di filtro (una ricerca con id dipendente e una ricerca con indirizzo di posta elettronica) entrambi specifica query punto:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-457">hello following two filter criteria (one looking up by employee id and one looking up by email address) both specify point queries:</span></span>  

* <span data-ttu-id="dc5a6-458">$filter=(PartitionKey eq 'Sales') e (RowKey eq 'empid_000223)</span><span class="sxs-lookup"><span data-stu-id="dc5a6-458">$filter=(PartitionKey eq 'Sales') and (RowKey eq 'empid_000223')</span></span>  
* <span data-ttu-id="dc5a6-459">$filter=(PartitionKey eq 'Sales') e (RowKey eq 'email_jonesj@contoso.com')</span><span class="sxs-lookup"><span data-stu-id="dc5a6-459">$filter=(PartitionKey eq 'Sales') and (RowKey eq 'email_jonesj@contoso.com')</span></span>  

<span data-ttu-id="dc5a6-460">Se si esegue una query per un intervallo di entità dipendente, è possibile specificare un intervallo ordinato in ordine di id dipendente o un intervallo ordinato in ordine di indirizzo di posta elettronica eseguendo una query per le entità con prefisso appropriato di hello in hello **RowKey**.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-460">If you query for a range of employee entities, you can specify a range sorted in employee id order, or a range sorted in email address order by querying for entities with hello appropriate prefix in hello **RowKey**.</span></span>  

* <span data-ttu-id="dc5a6-461">utilizzano tutti i dipendenti hello nel reparto vendite hello con un id dipendente in hello intervallo 000100 too000199 toofind: $filter = (PartitionKey eq 'Sales') e (ge RowKey 'empid_000100') e (le RowKey 'empid_000199')</span><span class="sxs-lookup"><span data-stu-id="dc5a6-461">toofind all hello employees in hello Sales department with an employee id in hello range 000100 too000199 use: $filter=(PartitionKey eq 'Sales') and (RowKey ge 'empid_000100') and (RowKey le 'empid_000199')</span></span>  
* <span data-ttu-id="dc5a6-462">toofind tutti hello impiegati nel reparto vendite hello con un indirizzo di posta elettronica a partire da hello rappresentato dalla lettera 'a' utilizzo: $filter = (PartitionKey eq 'Sales') e (ge RowKey 'email_a') (RowKey lt 'email_b') e</span><span class="sxs-lookup"><span data-stu-id="dc5a6-462">toofind all hello employees in hello Sales department with an email address starting with hello letter 'a' use: $filter=(PartitionKey eq 'Sales') and (RowKey ge 'email_a') and (RowKey lt 'email_b')</span></span>  
  
  <span data-ttu-id="dc5a6-463">Si noti che la sintassi di filtro hello utilizzata negli esempi di hello sopra è da hello tabella API REST del servizio, per ulteriori informazioni, vedere [Query Entities](http://msdn.microsoft.com/library/azure/dd179421.aspx).</span><span class="sxs-lookup"><span data-stu-id="dc5a6-463">Note that hello filter syntax used in hello examples above is from hello Table service REST API, for more information see [Query Entities](http://msdn.microsoft.com/library/azure/dd179421.aspx).</span></span>  

#### <a name="issues-and-considerations"></a><span data-ttu-id="dc5a6-464">Considerazioni e problemi</span><span class="sxs-lookup"><span data-stu-id="dc5a6-464">Issues and considerations</span></span>
<span data-ttu-id="dc5a6-465">Considerare i seguenti punti quando si decide di hello come tooimplement questo modello:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-465">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="dc5a6-466">Archiviazione tabelle è relativamente conveniente toouse pertanto hello costi aggiuntivi della memorizzazione dei dati duplicati non deve essere un problema.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-466">Table storage is relatively cheap toouse so hello cost overhead of storing duplicate data should not be a major concern.</span></span> <span data-ttu-id="dc5a6-467">È tuttavia sempre valutare il costo di hello di progettazione in base ai requisiti di archiviazione previste e aggiungere le entità duplicate le query di hello toosupport che l'applicazione client viene eseguita solo.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-467">However, you should always evaluate hello cost of your design based on your anticipated storage requirements and only add duplicate entities toosupport hello queries your client application will execute.</span></span>  
* <span data-ttu-id="dc5a6-468">Poiché l'entità di indice secondario hello sono archiviate nella stessa partizione come entità originale hello hello, è necessario assicurarsi che non superi obiettivi di scalabilità hello per una singola partizione.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-468">Because hello secondary index entities are stored in hello same partition as hello original entities, you should ensure that you do not exceed hello scalability targets for an individual partition.</span></span>  
* <span data-ttu-id="dc5a6-469">È possibile mantenere le entità duplicate coerenti tra loro tramite EGTs tooupdate hello due copie dell'entità hello in modo atomico.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-469">You can keep your duplicate entities consistent with each other by using EGTs tooupdate hello two copies of hello entity atomically.</span></span> <span data-ttu-id="dc5a6-470">Ciò implica che è necessario archiviare tutte le copie di un'entità in hello stessa partizione.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-470">This implies that you should store all copies of an entity in hello same partition.</span></span> <span data-ttu-id="dc5a6-471">Per ulteriori informazioni, vedere la sezione hello [utilizzando transazioni di gruppi di entità](#entity-group-transactions).</span><span class="sxs-lookup"><span data-stu-id="dc5a6-471">For more information, see hello section [Using Entity Group Transactions](#entity-group-transactions).</span></span>  
* <span data-ttu-id="dc5a6-472">valore utilizzato per hello Hello **RowKey** deve essere univoco per ogni entità.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-472">hello value used for hello **RowKey** must be unique for each entity.</span></span> <span data-ttu-id="dc5a6-473">Provare a usare valori di chiave composti.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-473">Consider using compound key values.</span></span>  
* <span data-ttu-id="dc5a6-474">Spaziatura interna di valori numerici in hello **RowKey** (ad esempio, id dipendente hello 000223), consente di correggere l'ordinamento e filtro in base a intervallo di valori.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-474">Padding numeric values in hello **RowKey** (for example, hello employee id 000223), enables correct sorting and filtering based on upper and lower bounds.</span></span>  
* <span data-ttu-id="dc5a6-475">Non è necessariamente necessario tooduplicate tutte le proprietà di hello dell'entità.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-475">You do not necessarily need tooduplicate all hello properties of your entity.</span></span> <span data-ttu-id="dc5a6-476">Ad esempio, se hello query di entità di ricerca hello hello tramite posta elettronica di indirizzi in hello **RowKey** mai necessario età hello del dipendente, queste entità potrebbe avere hello seguente struttura:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-476">For example, if hello queries that lookup hello entities using hello email address in hello **RowKey** never need hello employee's age, these entities could have hello following structure:</span></span>

![][8]

* <span data-ttu-id="dc5a6-477">È in genere migliore toostore duplicazione dei dati e garantire che è possibile recuperare tutti i dati di hello è necessario con una singola query, toouse toolocate di una query rispetto a un'entità e un altro hello toolookup i dati necessari.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-477">It is typically better toostore duplicate data and ensure that you can retrieve all hello data you need with a single query, than toouse one query toolocate an entity and another toolookup hello required data.</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="dc5a6-478">Quando toouse questo modello</span><span class="sxs-lookup"><span data-stu-id="dc5a6-478">When toouse this pattern</span></span>
<span data-ttu-id="dc5a6-479">Utilizzare questo modello quando l'applicazione client deve tooretrieve entità utilizzando un'ampia gamma di chiavi diverse, quando il client deve entità tooretrieve in diversi tipi di ordinamento e in cui è possibile identificare ogni entità utilizzando un'ampia gamma di valori univoci.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-479">Use this pattern when your client application needs tooretrieve entities using a variety of different keys, when your client needs tooretrieve entities in different sort orders, and where you can identify each entity using a variety of unique values.</span></span> <span data-ttu-id="dc5a6-480">Tuttavia, è necessario assicurarsi che non superi i limiti di scalabilità di hello partizione quando si eseguono ricerche di entità utilizzando diversi hello **RowKey** valori.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-480">However, you should be sure that you do not exceed hello partition scalability limits when you are performing entity lookups using hello different **RowKey** values.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="dc5a6-481">Modelli correlati e informazioni aggiuntive</span><span class="sxs-lookup"><span data-stu-id="dc5a6-481">Related patterns and guidance</span></span>
<span data-ttu-id="dc5a6-482">Hello modelli e le indicazioni seguenti possono anche essere importanti quando si implementa il pattern di:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-482">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="dc5a6-483">Modello per indice secondario interpartizione</span><span class="sxs-lookup"><span data-stu-id="dc5a6-483">Inter-partition secondary index pattern</span></span>](#inter-partition-secondary-index-pattern)
* [<span data-ttu-id="dc5a6-484">Modello per chiave composta</span><span class="sxs-lookup"><span data-stu-id="dc5a6-484">Compound key pattern</span></span>](#compound-key-pattern)
* [<span data-ttu-id="dc5a6-485">Transazioni dei gruppi di entità</span><span class="sxs-lookup"><span data-stu-id="dc5a6-485">Entity Group Transactions</span></span>](#entity-group-transactions)
* [<span data-ttu-id="dc5a6-486">Uso di tipi di entità eterogenei</span><span class="sxs-lookup"><span data-stu-id="dc5a6-486">Working with heterogeneous entity types</span></span>](#working-with-heterogeneous-entity-types)

### <a name="inter-partition-secondary-index-pattern"></a><span data-ttu-id="dc5a6-487">Modello per indice secondario intrapartizione</span><span class="sxs-lookup"><span data-stu-id="dc5a6-487">Inter-partition secondary index pattern</span></span>
<span data-ttu-id="dc5a6-488">Archiviazione di più copie di ogni entità mediante diverse **RowKey** valori partizioni distinte o ricerche veloci ed efficienti tooenable di tabelle distinte e tipi di ordinamento alternativo utilizzando diversi **RowKey**valori.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-488">Store multiple copies of each entity using different **RowKey** values in separate partitions or in separate tables tooenable fast and efficient lookups and alternate sort orders by using different **RowKey** values.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="dc5a6-489">Contesto e problema</span><span class="sxs-lookup"><span data-stu-id="dc5a6-489">Context and problem</span></span>
<span data-ttu-id="dc5a6-490">Hello del servizio tabelle vengono indicizzati automaticamente le entità utilizzando hello **PartitionKey** e **RowKey** valori.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-490">hello Table service automatically indexes entities using hello **PartitionKey** and **RowKey** values.</span></span> <span data-ttu-id="dc5a6-491">In questo modo un tooretrieve applicazione client di un'entità in modo efficiente utilizzando questi valori.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-491">This enables a client application tooretrieve an entity efficiently using these values.</span></span> <span data-ttu-id="dc5a6-492">Ad esempio, utilizzando una struttura della tabella hello illustrato di seguito, un'applicazione client consente tooretrieve di query un punto di un'entità di singolo dipendente utilizzando il nome di reparto hello e id dipendente hello (hello **PartitionKey** e  **RowKey** valori).</span><span class="sxs-lookup"><span data-stu-id="dc5a6-492">For example, using hello table structure shown below, a client application can use a point query tooretrieve an individual employee entity by using hello department name and hello employee id (hello **PartitionKey** and **RowKey** values).</span></span> <span data-ttu-id="dc5a6-493">Un client può anche recuperare entità ordinate per ID dipendente in ogni reparto.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-493">A client can also retrieve entities sorted by employee id within each department.</span></span>  

![][9]

<span data-ttu-id="dc5a6-494">Se si desidera anche toobe in grado di toofind un'entità dipendente in base al valore di hello di un'altra proprietà, ad esempio indirizzo di posta elettronica, è necessario utilizzare un livello di efficienza minore toofind di analisi partizione una corrispondenza.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-494">If you also want toobe able toofind an employee entity based on hello value of another property, such as email address, you must use a less efficient partition scan toofind a match.</span></span> <span data-ttu-id="dc5a6-495">Questo avviene perché il servizio tabelle hello non fornisce indici secondari.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-495">This is because hello table service does not provide secondary indexes.</span></span> <span data-ttu-id="dc5a6-496">Inoltre, non è toorequest alcuna opzione un elenco di dipendenti in un ordine diverso rispetto a **RowKey** ordine.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-496">In addition, there is no option toorequest a list of employees sorted in a different order than **RowKey** order.</span></span>  

<span data-ttu-id="dc5a6-497">Si è prevedono un volume molto elevato di transazioni su queste entità e si desidera rischio hello toominimize hello del servizio tabelle, la limitazione delle richieste del client.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-497">You are anticipating a very high volume of transactions against these entities and want toominimize hello risk of hello Table service throttling your client.</span></span>  

#### <a name="solution"></a><span data-ttu-id="dc5a6-498">Soluzione</span><span class="sxs-lookup"><span data-stu-id="dc5a6-498">Solution</span></span>
<span data-ttu-id="dc5a6-499">toowork intorno mancanza hello di indici secondari, è possibile archiviare più copie di ogni entità con ciascuna copia utilizzando diversi **PartitionKey** e **RowKey** valori.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-499">toowork around hello lack of secondary indexes, you can store multiple copies of each entity with each copy using different **PartitionKey** and **RowKey** values.</span></span> <span data-ttu-id="dc5a6-500">Se si archivia un'entità con strutture hello illustrate di seguito, è possibile recuperare in modo efficiente l'entità dipendente in base all'id dipendente o di indirizzo di posta elettronica. i valori del prefisso per hello Hello **PartitionKey**, "empid_" e "email_" consentono di tooidentify quale indice si desidera toouse per una query.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-500">If you store an entity with hello structures shown below, you can efficiently retrieve employee entities based on email address or employee id. hello prefix values for hello **PartitionKey**, "empid_" and "email_" enable you tooidentify which index you want toouse for a query.</span></span>  

![][10]

<span data-ttu-id="dc5a6-501">Hello seguenti due criteri di filtro (una ricerca con id dipendente e una ricerca con indirizzo di posta elettronica) entrambi specifica query punto:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-501">hello following two filter criteria (one looking up by employee id and one looking up by email address) both specify point queries:</span></span>  

* <span data-ttu-id="dc5a6-502">$filter=(PartitionKey 'empid_Sales') e (RowKey eq '000223')</span><span class="sxs-lookup"><span data-stu-id="dc5a6-502">$filter=(PartitionKey eq 'empid_Sales') and (RowKey eq '000223')</span></span>
* <span data-ttu-id="dc5a6-503">$filter=(PartitionKey eq 'email_Sales') e (RowKey eq 'jonesj@contoso.com')</span><span class="sxs-lookup"><span data-stu-id="dc5a6-503">$filter=(PartitionKey eq 'email_Sales') and (RowKey eq 'jonesj@contoso.com')</span></span>  

<span data-ttu-id="dc5a6-504">Se si esegue una query per un intervallo di entità dipendente, è possibile specificare un intervallo ordinato in ordine di id dipendente o un intervallo ordinato in ordine di indirizzo di posta elettronica eseguendo una query per le entità con prefisso appropriato di hello in hello **RowKey**.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-504">If you query for a range of employee entities, you can specify a range sorted in employee id order, or a range sorted in email address order by querying for entities with hello appropriate prefix in hello **RowKey**.</span></span>  

* <span data-ttu-id="dc5a6-505">tutti i dipendenti di hello toofind hello reparto vendite con un id dipendente nell'intervallo di hello **000100** troppo**000199** ordinati employee id ordine utilizzato: $filter = (PartitionKey eq ' empid_Sales') e (ge RowKey ' 000100') e (le RowKey '000199')</span><span class="sxs-lookup"><span data-stu-id="dc5a6-505">toofind all hello employees in hello Sales department with an employee id in hello range **000100** too**000199** sorted in employee id order use: $filter=(PartitionKey eq 'empid_Sales') and (RowKey ge '000100') and (RowKey le '000199')</span></span>  
* <span data-ttu-id="dc5a6-506">toofind utilizzare ordine indirizzo di posta elettronica tutti i dipendenti hello reparto vendite hello con un indirizzo di posta elettronica che inizia con 'a' ordinato in: $filter = (PartitionKey eq ' email_Sales') e (ge RowKey 'a') e (RowKey lt 'b')</span><span class="sxs-lookup"><span data-stu-id="dc5a6-506">toofind all hello employees in hello Sales department with an email address that starts with 'a' sorted in email address order use: $filter=(PartitionKey eq 'email_Sales') and (RowKey ge 'a') and (RowKey lt 'b')</span></span>  

<span data-ttu-id="dc5a6-507">Si noti che la sintassi di filtro hello utilizzata negli esempi di hello sopra è da hello tabella API REST del servizio, per ulteriori informazioni, vedere [Query Entities](http://msdn.microsoft.com/library/azure/dd179421.aspx).</span><span class="sxs-lookup"><span data-stu-id="dc5a6-507">Note that hello filter syntax used in hello examples above is from hello Table service REST API, for more information see [Query Entities](http://msdn.microsoft.com/library/azure/dd179421.aspx).</span></span>  

#### <a name="issues-and-considerations"></a><span data-ttu-id="dc5a6-508">Considerazioni e problemi</span><span class="sxs-lookup"><span data-stu-id="dc5a6-508">Issues and considerations</span></span>
<span data-ttu-id="dc5a6-509">Considerare i seguenti punti quando si decide di hello come tooimplement questo modello:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-509">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="dc5a6-510">È possibile mantenere le entità duplicate alla fine coerente tra loro tramite hello [modello alla fine coerente transazioni](#eventually-consistent-transactions-pattern) le entità di toomaintain hello indice primario e secondario.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-510">You can keep your duplicate entities eventually consistent with each other by using hello [Eventually consistent transactions pattern](#eventually-consistent-transactions-pattern) toomaintain hello primary and secondary index entities.</span></span>  
* <span data-ttu-id="dc5a6-511">Archiviazione tabelle è relativamente conveniente toouse pertanto hello costi aggiuntivi della memorizzazione dei dati duplicati non deve essere un problema.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-511">Table storage is relatively cheap toouse so hello cost overhead of storing duplicate data should not be a major concern.</span></span> <span data-ttu-id="dc5a6-512">È tuttavia sempre valutare il costo di hello di progettazione in base ai requisiti di archiviazione previste e aggiungere le entità duplicate le query di hello toosupport che l'applicazione client viene eseguita solo.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-512">However, you should always evaluate hello cost of your design based on your anticipated storage requirements and only add duplicate entities toosupport hello queries your client application will execute.</span></span>  
* <span data-ttu-id="dc5a6-513">valore utilizzato per hello Hello **RowKey** deve essere univoco per ogni entità.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-513">hello value used for hello **RowKey** must be unique for each entity.</span></span> <span data-ttu-id="dc5a6-514">Provare a usare valori di chiave composti.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-514">Consider using compound key values.</span></span>  
* <span data-ttu-id="dc5a6-515">Spaziatura interna di valori numerici in hello **RowKey** (ad esempio, id dipendente hello 000223), consente di correggere l'ordinamento e filtro in base a intervallo di valori.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-515">Padding numeric values in hello **RowKey** (for example, hello employee id 000223), enables correct sorting and filtering based on upper and lower bounds.</span></span>  
* <span data-ttu-id="dc5a6-516">Non è necessariamente necessario tooduplicate tutte le proprietà di hello dell'entità.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-516">You do not necessarily need tooduplicate all hello properties of your entity.</span></span> <span data-ttu-id="dc5a6-517">Ad esempio, se hello query di entità di ricerca hello hello tramite posta elettronica di indirizzi in hello **RowKey** mai necessario età hello del dipendente, queste entità potrebbe avere hello seguente struttura:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-517">For example, if hello queries that lookup hello entities using hello email address in hello **RowKey** never need hello employee's age, these entities could have hello following structure:</span></span>
  
  ![][11]
* <span data-ttu-id="dc5a6-518">È in genere migliore toostore duplicazione dei dati e assicurarsi che è possibile recuperare tutti i dati di hello che è necessario con una singola query di toouse toolocate di una query un'entità mediante hello indice secondario e un altro toolookup hello dati necessari nell'indice primario hello.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-518">It is typically better toostore duplicate data and ensure that you can retrieve all hello data you need with a single query than toouse one query toolocate an entity using hello secondary index and another toolookup hello required data in hello primary index.</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="dc5a6-519">Quando toouse questo modello</span><span class="sxs-lookup"><span data-stu-id="dc5a6-519">When toouse this pattern</span></span>
<span data-ttu-id="dc5a6-520">Utilizzare questo modello quando l'applicazione client deve tooretrieve entità utilizzando un'ampia gamma di chiavi diverse, quando il client deve entità tooretrieve in diversi tipi di ordinamento e in cui è possibile identificare ogni entità utilizzando un'ampia gamma di valori univoci.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-520">Use this pattern when your client application needs tooretrieve entities using a variety of different keys, when your client needs tooretrieve entities in different sort orders, and where you can identify each entity using a variety of unique values.</span></span> <span data-ttu-id="dc5a6-521">Utilizzare questo modello quando si desidera tooavoid superamento dei limiti di scalabilità di hello partizione quando si eseguono ricerche di entità utilizzando diversi hello **RowKey** valori.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-521">Use this pattern when you want tooavoid exceeding hello partition scalability limits when you are performing entity lookups using hello different **RowKey** values.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="dc5a6-522">Modelli correlati e informazioni aggiuntive</span><span class="sxs-lookup"><span data-stu-id="dc5a6-522">Related patterns and guidance</span></span>
<span data-ttu-id="dc5a6-523">Hello modelli e le indicazioni seguenti possono anche essere importanti quando si implementa il pattern di:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-523">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="dc5a6-524">Modello per transazioni con coerenza finale</span><span class="sxs-lookup"><span data-stu-id="dc5a6-524">Eventually consistent transactions pattern</span></span>](#eventually-consistent-transactions-pattern)  
* [<span data-ttu-id="dc5a6-525">Modello per indice secondario intrapartizione</span><span class="sxs-lookup"><span data-stu-id="dc5a6-525">Intra-partition secondary index pattern</span></span>](#intra-partition-secondary-index-pattern)  
* [<span data-ttu-id="dc5a6-526">Modello per chiave composta</span><span class="sxs-lookup"><span data-stu-id="dc5a6-526">Compound key pattern</span></span>](#compound-key-pattern)  
* [<span data-ttu-id="dc5a6-527">Transazioni dei gruppi di entità</span><span class="sxs-lookup"><span data-stu-id="dc5a6-527">Entity Group Transactions</span></span>](#entity-group-transactions)  
* [<span data-ttu-id="dc5a6-528">Uso di tipi di entità eterogenei</span><span class="sxs-lookup"><span data-stu-id="dc5a6-528">Working with heterogeneous entity types</span></span>](#working-with-heterogeneous-entity-types)  

### <a name="eventually-consistent-transactions-pattern"></a><span data-ttu-id="dc5a6-529">Modello per transazioni con coerenza finale</span><span class="sxs-lookup"><span data-stu-id="dc5a6-529">Eventually consistent transactions pattern</span></span>
<span data-ttu-id="dc5a6-530">abilita un comportamento di coerenza finale tra i limiti della partizione o i limiti del sistema di archiviazione usando le code di Azure.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-530">Enable eventually consistent behavior across partition boundaries or storage system boundaries by using Azure queues.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="dc5a6-531">Contesto e problema</span><span class="sxs-lookup"><span data-stu-id="dc5a6-531">Context and problem</span></span>
<span data-ttu-id="dc5a6-532">EGTs Abilita transazioni atomiche in più entità che condividono hello stessa chiave di partizione.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-532">EGTs enable atomic transactions across multiple entities that share hello same partition key.</span></span> <span data-ttu-id="dc5a6-533">Per motivi di scalabilità e prestazioni, è possibile decidere toostore entità che hanno requisiti di coerenza in partizioni distinte o in un sistema di archiviazione distinti: in questo caso, non è possibile utilizzare EGTs toomaintain coerenza.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-533">For performance and scalability reasons, you might decide toostore entities that have consistency requirements in separate partitions or in a separate storage system: in such a scenario, you cannot use EGTs toomaintain consistency.</span></span> <span data-ttu-id="dc5a6-534">Ad esempio, potrebbe essere una requisito toomaintain la coerenza eventuale tra:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-534">For example, you might have a requirement toomaintain eventual consistency between:</span></span>  

* <span data-ttu-id="dc5a6-535">Entità archiviate in due partizioni diverse nella stessa tabella, in tabelle diverse, in diversi account di archiviazione hello.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-535">Entities stored in two different partitions in hello same table, in different tables, in in different storage accounts.</span></span>  
* <span data-ttu-id="dc5a6-536">Un'entità archiviati nel servizio tabelle hello e un blob archiviato in hello servizio Blob.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-536">An entity stored in hello Table service and a blob stored in hello Blob service.</span></span>  
* <span data-ttu-id="dc5a6-537">Un'entità archiviata nel servizio tabelle hello e un file in un file system.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-537">An entity stored in hello Table service and a file in a file system.</span></span>  
* <span data-ttu-id="dc5a6-538">Un'entità archiviare nel servizio tabelle hello ancora indicizzato tramite il servizio di ricerca di Azure hello.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-538">An entity store in hello Table service yet indexed using hello Azure Search service.</span></span>  

#### <a name="solution"></a><span data-ttu-id="dc5a6-539">Soluzione</span><span class="sxs-lookup"><span data-stu-id="dc5a6-539">Solution</span></span>
<span data-ttu-id="dc5a6-540">Usando le code di Azure, è possibile implementare una soluzione che offre coerenza finale tra due o più partizioni o sistemi di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-540">By using Azure queues, you can implement a solution that delivers eventual consistency across two or more partitions or storage systems.</span></span>
<span data-ttu-id="dc5a6-541">tooillustrate questo approccio, si supponga di avere un requisito toobe tooarchive in grado di dipendente le entità precedenti.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-541">tooillustrate this approach, assume you have a requirement toobe able tooarchive old employee entities.</span></span> <span data-ttu-id="dc5a6-542">Queste entità sono raramente oggetto di query e devono essere escluse da tutte le attività associate ai dipendenti correnti.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-542">Old employee entities are rarely queried and should be excluded from any activities that deal with current employees.</span></span> <span data-ttu-id="dc5a6-543">tooimplement questo requisito si archiviano i dipendenti attivi in hello **corrente** tabella e i dipendenti precedenti hello **archivio** tabella.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-543">tooimplement this requirement you store active employees in hello **Current** table and old employees in hello **Archive** table.</span></span> <span data-ttu-id="dc5a6-544">Archiviazione di un dipendente richiede entità hello toodelete hello **corrente** tabella e aggiungere hello entità toohello **archivio** tabella, ma è possibile utilizzare un tooperform EGT queste due operazioni.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-544">Archiving an employee requires you toodelete hello entity from hello **Current** table and add hello entity toohello **Archive** table, but you cannot use an EGT tooperform these two operations.</span></span> <span data-ttu-id="dc5a6-545">rischio hello tooavoid che un errore causa tooappear un'entità in entrambe o nessuna delle due tabelle, l'operazione di archiviazione hello deve essere alla fine coerente.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-545">tooavoid hello risk that a failure causes an entity tooappear in both or neither tables, hello archive operation must be eventually consistent.</span></span> <span data-ttu-id="dc5a6-546">Hello diagramma sequenza seguente descrive i passaggi di hello in questa operazione.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-546">hello following sequence diagram outlines hello steps in this operation.</span></span> <span data-ttu-id="dc5a6-547">Dettaglio è disponibile per i percorsi delle eccezioni in seguito il testo hello.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-547">More detail is provided for exception paths in hello text following.</span></span>  

![][12]

<span data-ttu-id="dc5a6-548">Un client avvia l'operazione di archiviazione hello inserendo un messaggio in una coda di Azure, in questo dipendente di esempio tooarchive #456.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-548">A client initiates hello archive operation by placing a message on an Azure queue, in this example tooarchive employee #456.</span></span> <span data-ttu-id="dc5a6-549">Un ruolo di lavoro viene eseguito il polling della coda di hello per i nuovi messaggi. Quando ne viene trovato uno, legge il messaggio hello e lascia una copia nascosta nella coda di hello.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-549">A worker role polls hello queue for new messages; when it finds one, it reads hello message and leaves a hidden copy on hello queue.</span></span> <span data-ttu-id="dc5a6-550">ruolo di lavoro Hello successivamente recupera una copia dell'entità hello dal hello **corrente** tabella, inserisce una copia in hello **archivio** tabella e quindi Elimina hello originale da hello **corrente**tabella.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-550">hello worker role next fetches a copy of hello entity from hello **Current** table, inserts a copy in hello **Archive** table, and then deletes hello original from hello **Current** table.</span></span> <span data-ttu-id="dc5a6-551">Infine, se non sono presenti errori nei passaggi precedenti hello, ruolo di lavoro hello Elimina messaggio nascosto hello dalla coda di hello.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-551">Finally, if there were no errors from hello previous steps, hello worker role deletes hello hidden message from hello queue.</span></span>  

<span data-ttu-id="dc5a6-552">In questo esempio, il passaggio 4 inserisce dipendente hello hello **archivio** tabella.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-552">In this example, step 4 inserts hello employee into hello **Archive** table.</span></span> <span data-ttu-id="dc5a6-553">È possibile aggiungere il blob tooa dipendente di hello nel servizio Blob hello o un file in un file system.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-553">It could add hello employee tooa blob in hello Blob service or a file in a file system.</span></span>  

#### <a name="recovering-from-failures"></a><span data-ttu-id="dc5a6-554">Ripristino da errori</span><span class="sxs-lookup"><span data-stu-id="dc5a6-554">Recovering from failures</span></span>
<span data-ttu-id="dc5a6-555">È importante che le operazioni nei passaggi di hello **4** e **5** deve essere *idempotente* nel caso in cui il ruolo di lavoro hello deve toorestart operazione di archiviazione hello.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-555">It is important that hello operations in steps **4** and **5** must be *idempotent* in case hello worker role needs toorestart hello archive operation.</span></span> <span data-ttu-id="dc5a6-556">Se si utilizza servizio tabella hello, per passaggio **4** è necessario utilizzare un'operazione "inserire o sostituire", per passaggio **5** si consiglia di utilizzare un "eliminare se esiste" operazione nella libreria client hello in uso.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-556">If you are using hello Table service, for step **4** you should use an "insert or replace" operation; for step **5** you should use a "delete if exists" operation in hello client library you are using.</span></span> <span data-ttu-id="dc5a6-557">Se si sta usando un altro sistema di archiviazione, è consigliabile usare un'operazione idempotente appropriata.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-557">If you are using another storage system, you must use an appropriate idempotent operation.</span></span>  

<span data-ttu-id="dc5a6-558">Se il ruolo di lavoro hello mai completata passaggio **6**, quindi dopo un messaggio hello di timeout viene visualizzato nuovamente nella coda di hello prepararla per hello lavoro ruolo tootry tooreprocess.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-558">If hello worker role never completes step **6**, then after a timeout hello message reappears on hello queue ready for hello worker role tootry tooreprocess it.</span></span> <span data-ttu-id="dc5a6-559">ruolo di lavoro Hello può controllare quante volte è stato letto un messaggio in coda hello e, se necessario, è un messaggio "non elaborabile" per l'analisi mediante l'invio tooa flag separare coda.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-559">hello worker role can check how many times a message on hello queue has been read and, if necessary, flag it is a "poison" message for investigation by sending it tooa separate queue.</span></span> <span data-ttu-id="dc5a6-560">Per ulteriori informazioni sulla lettura dei messaggi in coda e il controllo hello conteggio rimozione dalla coda, vedere [Get Messages](https://msdn.microsoft.com/library/azure/dd179474.aspx).</span><span class="sxs-lookup"><span data-stu-id="dc5a6-560">For more information about reading queue messages and checking hello dequeue count, see [Get Messages](https://msdn.microsoft.com/library/azure/dd179474.aspx).</span></span>  

<span data-ttu-id="dc5a6-561">Alcuni errori da servizi di tabella e coda hello sono gli errori temporanei e l'applicazione client deve includere toohandle logica di ripetizione adatto li.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-561">Some errors from hello Table and Queue services are transient errors, and your client application should include suitable retry logic toohandle them.</span></span>  

#### <a name="issues-and-considerations"></a><span data-ttu-id="dc5a6-562">Considerazioni e problemi</span><span class="sxs-lookup"><span data-stu-id="dc5a6-562">Issues and considerations</span></span>
<span data-ttu-id="dc5a6-563">Considerare i seguenti punti quando si decide di hello come tooimplement questo modello:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-563">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="dc5a6-564">Questa soluzione non prevede l'isolamento delle transazioni.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-564">This solution does not provide for transaction isolation.</span></span> <span data-ttu-id="dc5a6-565">Ad esempio, un client può leggere hello **corrente** e **archivio** tabelle quando il ruolo di lavoro hello è tra i vari passaggi **4** e **5**e vedere un visualizzazione non coerente dei dati hello.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-565">For example, a client could read hello **Current** and **Archive** tables when hello worker role was between steps **4** and **5**, and see an inconsistent view of hello data.</span></span> <span data-ttu-id="dc5a6-566">Si noti che i dati di hello sarà coerenti alla fine.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-566">Note that hello data will be consistent eventually.</span></span>  
* <span data-ttu-id="dc5a6-567">È necessario assicurarsi che i passaggi 4 e 5 sono idempotenti in coerenza finale tooensure di ordine.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-567">You must be sure that steps 4 and 5 are idempotent in order tooensure eventual consistency.</span></span>  
* <span data-ttu-id="dc5a6-568">È possibile ridimensionare la soluzione hello utilizzando più code e istanze del ruolo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-568">You can scale hello solution by using multiple queues and worker role instances.</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="dc5a6-569">Quando toouse questo modello</span><span class="sxs-lookup"><span data-stu-id="dc5a6-569">When toouse this pattern</span></span>
<span data-ttu-id="dc5a6-570">Utilizzare questo modello quando si desidera che la coerenza eventuale tooguarantee tra le entità presenti in tabelle o partizioni diverse.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-570">Use this pattern when you want tooguarantee eventual consistency between entities that exist in different partitions or tables.</span></span> <span data-ttu-id="dc5a6-571">Consente di estendere questo modello tooensure la coerenza eventuale per le operazioni del servizio tabelle hello e servizio Blob hello e altre origini dati non correlati all'archiviazione Azure, ad esempio database o hello file system.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-571">You can extend this pattern tooensure eventual consistency for operations across hello Table service and hello Blob service and other non-Azure Storage data sources such as database or hello file system.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="dc5a6-572">Modelli correlati e informazioni aggiuntive</span><span class="sxs-lookup"><span data-stu-id="dc5a6-572">Related patterns and guidance</span></span>
<span data-ttu-id="dc5a6-573">Hello modelli e le indicazioni seguenti possono anche essere importanti quando si implementa il pattern di:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-573">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="dc5a6-574">Transazioni dei gruppi di entità</span><span class="sxs-lookup"><span data-stu-id="dc5a6-574">Entity Group Transactions</span></span>](#entity-group-transactions)  
* [<span data-ttu-id="dc5a6-575">Unione o sostituzione</span><span class="sxs-lookup"><span data-stu-id="dc5a6-575">Merge or replace</span></span>](#merge-or-replace)  

> [!NOTE]
> <span data-ttu-id="dc5a6-576">Se l'isolamento delle transazioni è importante tooyour soluzione, è consigliabile riprogettare le tabelle tooenable è toouse EGTs.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-576">If transaction isolation is important tooyour solution, you should consider redesigning your tables tooenable you toouse EGTs.</span></span>  
> 
> 

### <a name="index-entities-pattern"></a><span data-ttu-id="dc5a6-577">Modello per entità di indice</span><span class="sxs-lookup"><span data-stu-id="dc5a6-577">Index Entities Pattern</span></span>
<span data-ttu-id="dc5a6-578">Gestire le entità tooenable efficienti ricerche che restituiscono elenchi di entità.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-578">Maintain index entities tooenable efficient searches that return lists of entities.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="dc5a6-579">Contesto e problema</span><span class="sxs-lookup"><span data-stu-id="dc5a6-579">Context and problem</span></span>
<span data-ttu-id="dc5a6-580">Hello del servizio tabelle vengono indicizzati automaticamente le entità utilizzando hello **PartitionKey** e **RowKey** valori.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-580">hello Table service automatically indexes entities using hello **PartitionKey** and **RowKey** values.</span></span> <span data-ttu-id="dc5a6-581">In questo modo un tooretrieve applicazione client un'entità in modo efficiente utilizzando una query del punto.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-581">This enables a client application tooretrieve an entity efficiently using a point query.</span></span> <span data-ttu-id="dc5a6-582">Ad esempio, utilizzando una struttura della tabella hello illustrato di seguito, un'applicazione client può recuperare in modo efficiente un'entità employee singole utilizzando il nome di reparto hello e id dipendente hello (hello **PartitionKey** e **RowKey** ).</span><span class="sxs-lookup"><span data-stu-id="dc5a6-582">For example, using hello table structure shown below, a client application can efficiently retrieve an individual employee entity by using hello department name and hello employee id (hello **PartitionKey** and **RowKey**).</span></span>  

![][13]

<span data-ttu-id="dc5a6-583">Se si desidera anche tooretrieve in grado di toobe un elenco di entità dipendente in base hello valore di un'altra proprietà non è univoco, ad esempio cognome, è necessario utilizzare una partizione meno efficiente analisi toofind corrispondenze anziché un indice toolook li backup direttamente.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-583">If you also want toobe able tooretrieve a list of employee entities based on hello value of another non-unique property, such as their last name, you must use a less efficient partition scan toofind matches rather than using an index toolook them up directly.</span></span> <span data-ttu-id="dc5a6-584">Questo avviene perché il servizio tabelle hello non fornisce indici secondari.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-584">This is because hello table service does not provide secondary indexes.</span></span>  

#### <a name="solution"></a><span data-ttu-id="dc5a6-585">Soluzione</span><span class="sxs-lookup"><span data-stu-id="dc5a6-585">Solution</span></span>
<span data-ttu-id="dc5a6-586">ricerca tooenable in base al cognome con struttura entità hello illustrato sopra, è necessario mantenere elenchi di ID dipendente.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-586">tooenable lookup by last name with hello entity structure shown above, you must maintain lists of employee ids.</span></span> <span data-ttu-id="dc5a6-587">Se si desidera che le entità di tooretrieve hello dipendente con un determinato cognome, ad esempio Jones, è necessario innanzitutto individuare elenco hello di ID dipendente per i dipendenti con Jones come cognome e quindi recuperare tali entità employee.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-587">If you want tooretrieve hello employee entities with a particular last name, such as Jones, you must first locate hello list of employee ids for employees with Jones as their last name, and then retrieve those employee entities.</span></span> <span data-ttu-id="dc5a6-588">Sono disponibili tre opzioni principali per l'archiviazione di elenchi di hello di ID dipendente:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-588">There are three main options for storing hello lists of employee ids:</span></span>  

* <span data-ttu-id="dc5a6-589">Usare l'archiviazione BLOB.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-589">Use blob storage.</span></span>  
* <span data-ttu-id="dc5a6-590">Creare le entità di indice nella stessa partizione come entità employee hello hello.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-590">Create index entities in hello same partition as hello employee entities.</span></span>  
* <span data-ttu-id="dc5a6-591">Creare entità di indice in una tabella o una partizione separata.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-591">Create index entities in a separate partition or table.</span></span>  

<span data-ttu-id="dc5a6-592"><u>Opzione 1: usare l'archiviazione BLOB</u></span><span class="sxs-lookup"><span data-stu-id="dc5a6-592"><u>Option #1: Use blob storage</u></span></span>  

<span data-ttu-id="dc5a6-593">Per la prima opzione hello, creare un blob per ogni nome ultimo univoco in ogni archivio blob un elenco di hello **PartitionKey** (reparto) e **RowKey** valori (id dipendente) per i dipendenti che hanno questo ultimo nome.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-593">For hello first option, you create a blob for every unique last name, and in each blob store a list of hello **PartitionKey** (department) and **RowKey** (employee id) values for employees that have that last name.</span></span> <span data-ttu-id="dc5a6-594">Quando si aggiunge o elimina un dipendente, è necessario assicurarsi che il contenuto di hello del blob rilevanti hello è alla fine coerente con l'entità dipendente hello.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-594">When you add or delete an employee you should ensure that hello content of hello relevant blob is eventually consistent with hello employee entities.</span></span>  

<span data-ttu-id="dc5a6-595"><u>Opzione &#2;:</u> entità Crea indice hello stessa partizione</span><span class="sxs-lookup"><span data-stu-id="dc5a6-595"><u>Option #2:</u> Create index entities in hello same partition</span></span>  

<span data-ttu-id="dc5a6-596">Per la seconda opzione hello, utilizzare le entità di indice che memorizzano hello dati seguenti:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-596">For hello second option, use index entities that store hello following data:</span></span>  

![][14]

<span data-ttu-id="dc5a6-597">Hello **EmployeeIDs** proprietà contiene un elenco di ID dipendente per i dipendenti con cognome hello archiviati in hello **RowKey**.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-597">hello **EmployeeIDs** property contains a list of employee ids for employees with hello last name stored in hello **RowKey**.</span></span>  

<span data-ttu-id="dc5a6-598">Hello seguito viene illustrato il processo di hello da seguire quando si aggiunge un nuovo dipendente se si utilizza l'opzione secondo hello.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-598">hello following steps outline hello process you should follow when you are adding a new employee if you are using hello second option.</span></span> <span data-ttu-id="dc5a6-599">In questo esempio, si sta aggiungendo un dipendente con Id 000152 e un cognome Jones nel reparto vendite hello:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-599">In this example, we are adding an employee with Id 000152 and a last name Jones in hello Sales department:</span></span>  

1. <span data-ttu-id="dc5a6-600">Recuperare hello indice entità con un **PartitionKey** "Sales" e hello valore **RowKey** valore "Jones".</span><span class="sxs-lookup"><span data-stu-id="dc5a6-600">Retrieve hello index entity with a **PartitionKey** value "Sales" and hello **RowKey** value "Jones."</span></span> <span data-ttu-id="dc5a6-601">Salvare hello ETag della toouse entità nel passaggio 2.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-601">Save hello ETag of this entity toouse in step 2.</span></span>  
2. <span data-ttu-id="dc5a6-602">Creare una transazione di gruppo di entità (ovvero, un'operazione batch) che inserisce l'entità employee nuovo hello (**PartitionKey** valore "Sales" e **RowKey** valore "000152"), e gli aggiornamenti hello entità indice ( **PartitionKey** valore "Sales" e **RowKey** valore "Jones") tramite l'aggiunta di hello nuovo dipendente id toohello elenco nel campo EmployeeIDs hello.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-602">Create an entity group transaction (that is, a batch operation) that inserts hello new employee entity (**PartitionKey** value "Sales" and **RowKey** value "000152"), and updates hello index entity (**PartitionKey** value "Sales" and **RowKey** value "Jones") by adding hello new employee id toohello list in hello EmployeeIDs field.</span></span> <span data-ttu-id="dc5a6-603">Per informazioni sulle transazioni di gruppi di entità, vedere la sezione [Transazioni di gruppi di entità](#entity-group-transactions).</span><span class="sxs-lookup"><span data-stu-id="dc5a6-603">For more information about entity group transactions, see [Entity Group Transactions](#entity-group-transactions).</span></span>  
3. <span data-ttu-id="dc5a6-604">Se transazione di gruppo di entità hello non riesce a causa di un errore di concorrenza ottimistica (un altro utente ha modificato solo hello indice entità), è necessario toostart al passaggio 1 nuovamente.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-604">If hello entity group transaction fails because of an optimistic concurrency error (someone else has just modified hello index entity), then you need toostart over at step 1 again.</span></span>  

<span data-ttu-id="dc5a6-605">Se si utilizza hello seconda opzione, è possibile utilizzare un toodeleting approccio simile, un dipendente.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-605">You can use a similar approach toodeleting an employee if you are using hello second option.</span></span> <span data-ttu-id="dc5a6-606">Modifica il cognome del dipendente è leggermente più complessa, poiché sarà necessaria una transazione di gruppo di entità che aggiorna tre entità tooexecute: hello entità employee, l'entità di indice hello per cognome precedente hello ed entità indice hello per cognome nuovo hello.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-606">Changing an employee's last name is slightly more complex because you will need tooexecute an entity group transaction that updates three entities: hello employee entity, hello index entity for hello old last name, and hello index entity for hello new last name.</span></span> <span data-ttu-id="dc5a6-607">È necessario recuperare ogni entità prima di apportare modifiche nell'ordine valori ETag di hello tooretrieve che è possibile utilizzare gli aggiornamenti di hello tooperform la concorrenza ottimistica.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-607">You must retrieve each entity before making any changes in order tooretrieve hello ETag values that you can then use tooperform hello updates using optimistic concurrency.</span></span>  

<span data-ttu-id="dc5a6-608">Hello seguito viene illustrato il processo di hello da seguire quando è necessario toolook backup di tutti i dipendenti con un determinato cognome in un reparto hello se si utilizza l'opzione secondo hello.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-608">hello following steps outline hello process you should follow when you need toolook up all hello employees with a given last name in a department if you are using hello second option.</span></span> <span data-ttu-id="dc5a6-609">In questo esempio, ci rivolgiamo backup di tutti i dipendenti con cognome Jones nel reparto vendite hello hello:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-609">In this example, we are looking up all hello employees with last name Jones in hello Sales department:</span></span>  

1. <span data-ttu-id="dc5a6-610">Recuperare hello indice entità con un **PartitionKey** "Sales" e hello valore **RowKey** valore "Jones".</span><span class="sxs-lookup"><span data-stu-id="dc5a6-610">Retrieve hello index entity with a **PartitionKey** value "Sales" and hello **RowKey** value "Jones."</span></span>  
2. <span data-ttu-id="dc5a6-611">Analizzare l'elenco di hello ID nel campo EmployeeIDs hello di dipendenti.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-611">Parse hello list of employee Ids in hello EmployeeIDs field.</span></span>  
3. <span data-ttu-id="dc5a6-612">Se sono necessarie ulteriori informazioni su ciascuno di questi dipendenti (ad esempio gli indirizzi di posta elettronica), ognuna delle entità employee hello utilizzando recuperare **PartitionKey** valore "Sales" e **RowKey** i valori elenco di Hello di dipendenti ottenuto nel passaggio 2.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-612">If you need additional information about each of these employees (such as their email addresses), retrieve each of hello employee entities using **PartitionKey** value "Sales" and **RowKey** values from hello list of employees you obtained in step 2.</span></span>  

<span data-ttu-id="dc5a6-613"><u>Opzione 3:</u> creare entità di indice in una tabella o una partizione separata</span><span class="sxs-lookup"><span data-stu-id="dc5a6-613"><u>Option #3:</u> Create index entities in a separate partition or table</span></span>  

<span data-ttu-id="dc5a6-614">Per la terza opzione hello, utilizzare le entità di indice che memorizzano hello dati seguenti:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-614">For hello third option, use index entities that store hello following data:</span></span>  

![][15]

<span data-ttu-id="dc5a6-615">Hello **EmployeeIDs** proprietà contiene un elenco di ID dipendente per i dipendenti con cognome hello archiviati in hello **RowKey**.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-615">hello **EmployeeIDs** property contains a list of employee ids for employees with hello last name stored in hello **RowKey**.</span></span>  

<span data-ttu-id="dc5a6-616">Con l'opzione terzo hello, è possibile utilizzare EGTs toomaintain coerenza perché sono entità indice hello in una partizione separata dall'entità employee hello.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-616">With hello third option, you cannot use EGTs toomaintain consistency because hello index entities are in a separate partition from hello employee entities.</span></span> <span data-ttu-id="dc5a6-617">È necessario assicurarsi che le entità di indice hello sono alla fine coerente con l'entità dipendente hello.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-617">You should ensure that hello index entities are eventually consistent with hello employee entities.</span></span>  

#### <a name="issues-and-considerations"></a><span data-ttu-id="dc5a6-618">Considerazioni e problemi</span><span class="sxs-lookup"><span data-stu-id="dc5a6-618">Issues and considerations</span></span>
<span data-ttu-id="dc5a6-619">Considerare i seguenti punti quando si decide di hello come tooimplement questo modello:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-619">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="dc5a6-620">Questa soluzione richiede almeno due query tooretrieve corrispondenti entità: uno tooquery hello indice tooobtain hello elenco entità di **RowKey** valori e quindi esegue una query tooretrieve ogni entità nell'elenco di hello.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-620">This solution requires at least two queries tooretrieve matching entities: one tooquery hello index entities tooobtain hello list of **RowKey** values, and then queries tooretrieve each entity in hello list.</span></span>  
* <span data-ttu-id="dc5a6-621">Dato che una singola entità è una dimensione massima di 1 MB, opzione #2 e l'opzione #3 nella soluzione hello presuppone elenco hello di ID dipendente per un determinato cognome non è mai maggiore di 1 MB.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-621">Given that an individual entity has a maximum size of 1 MB, option #2 and option #3 in hello solution assume that hello list of employee ids for any given last name is never greater than 1 MB.</span></span> <span data-ttu-id="dc5a6-622">Se hello elenco di ID dipendente toobe probabilmente maggiore di 1 MB di dimensioni, utilizzare l'opzione #1 e archiviare i dati dell'indice hello nell'archiviazione blob.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-622">If hello list of employee ids is likely toobe greater than 1 MB in size, use option #1 and store hello index data in blob storage.</span></span>  
* <span data-ttu-id="dc5a6-623">Se si utilizza l'opzione #2 (tramite EGTs toohandle aggiunta e l'eliminazione di dipendenti e modifica il cognome del dipendente) è necessario valutare se il volume di hello di transazioni raggiungeranno limiti di scalabilità hello in una determinata partizione.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-623">If you use option #2 (using EGTs toohandle adding and deleting employees, and changing an employee's last name) you must evaluate if hello volume of transactions will approach hello scalability limits in a given partition.</span></span> <span data-ttu-id="dc5a6-624">In caso di hello, considerare una soluzione alla fine coerente (opzione &#1; o #3) che usa code toohandle hello update richieste e consente di toostore le entità di indice in una partizione separata dall'entità employee hello.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-624">If this is hello case, you should consider an eventually consistent solution (option #1 or option #3) that uses queues toohandle hello update requests and enables you toostore your index entities in a separate partition from hello employee entities.</span></span>  
* <span data-ttu-id="dc5a6-625">Opzione #2 in questa soluzione si presuppone che si desidera ripristinare toolook in base al cognome in un reparto: ad esempio, si desidera un elenco di dipendenti con un cognome Jones nel reparto vendite hello tooretrieve.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-625">Option #2 in this solution assumes that you want toolook up by last name within a department: for example, you want tooretrieve a list of employees with a last name Jones in hello Sales department.</span></span> <span data-ttu-id="dc5a6-626">Se si desidera toobe toolook in grado di backup di tutti i dipendenti il cui cognome Jones intera organizzazione hello hello, utilizzare l'opzione &#1; o #3.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-626">If you want toobe able toolook up all hello employees with a last name Jones across hello whole organization, use either option #1 or option #3.</span></span>
* <span data-ttu-id="dc5a6-627">È possibile implementare una soluzione basata su coda che offre la coerenza eventuale (vedere hello [modello alla fine coerente transazioni](#eventually-consistent-transactions-pattern) per altri dettagli).</span><span class="sxs-lookup"><span data-stu-id="dc5a6-627">You can implement a queue-based solution that delivers eventual consistency (see hello [Eventually consistent transactions pattern](#eventually-consistent-transactions-pattern) for more details).</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="dc5a6-628">Quando toouse questo modello</span><span class="sxs-lookup"><span data-stu-id="dc5a6-628">When toouse this pattern</span></span>
<span data-ttu-id="dc5a6-629">Utilizzare questo modello quando si desidera un set di entità che condividono un valore di proprietà comuni, ad esempio tutti i dipendenti con cognome hello Jones toolookup.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-629">Use this pattern when you want toolookup a set of entities that all share a common property value, such as all employees with hello last name Jones.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="dc5a6-630">Modelli correlati e informazioni aggiuntive</span><span class="sxs-lookup"><span data-stu-id="dc5a6-630">Related patterns and guidance</span></span>
<span data-ttu-id="dc5a6-631">Hello modelli e le indicazioni seguenti possono anche essere importanti quando si implementa il pattern di:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-631">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="dc5a6-632">Modello per chiave composta</span><span class="sxs-lookup"><span data-stu-id="dc5a6-632">Compound key pattern</span></span>](#compound-key-pattern)  
* [<span data-ttu-id="dc5a6-633">Modello per transazioni con coerenza finale</span><span class="sxs-lookup"><span data-stu-id="dc5a6-633">Eventually consistent transactions pattern</span></span>](#eventually-consistent-transactions-pattern)  
* [<span data-ttu-id="dc5a6-634">Transazioni dei gruppi di entità</span><span class="sxs-lookup"><span data-stu-id="dc5a6-634">Entity Group Transactions</span></span>](#entity-group-transactions)  
* [<span data-ttu-id="dc5a6-635">Uso di tipi di entità eterogenei</span><span class="sxs-lookup"><span data-stu-id="dc5a6-635">Working with heterogeneous entity types</span></span>](#working-with-heterogeneous-entity-types)  

### <a name="denormalization-pattern"></a><span data-ttu-id="dc5a6-636">Modello di denormalizzazione</span><span class="sxs-lookup"><span data-stu-id="dc5a6-636">Denormalization pattern</span></span>
<span data-ttu-id="dc5a6-637">Combinare i dati correlati in una singola entità di tooenable tooretrieve tutti hello è necessario con una query con singolo punto dati.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-637">Combine related data together in a single entity tooenable you tooretrieve all hello data you need with a single point query.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="dc5a6-638">Contesto e problema</span><span class="sxs-lookup"><span data-stu-id="dc5a6-638">Context and problem</span></span>
<span data-ttu-id="dc5a6-639">In un database relazionale, è in genere possibile normalizzare la duplicazione dei tooremove dati risultanti in query che recuperano dati da più tabelle.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-639">In a relational database, you typically normalize data tooremove duplication resulting in queries that retrieve data from multiple tables.</span></span> <span data-ttu-id="dc5a6-640">Se si esegue la normalizzazione dei dati in tabelle di Azure, è necessario apportare più round trip da hello client toohello server tooretrieve i dati correlati.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-640">If you normalize your data in Azure tables, you must make multiple round trips from hello client toohello server tooretrieve your related data.</span></span> <span data-ttu-id="dc5a6-641">Ad esempio, con la struttura di tabella hello illustrato di seguito è necessario due round trip tooretrieve hello dettagli un reparto: entità reparto di hello uno toofetch che include l'id del responsabile hello e i dettagli di gestione quindi un'altra richiesta toofetch hello in un dipendente entità.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-641">For example, with hello table structure shown below you need two round trips tooretrieve hello details for a department: one toofetch hello department entity that includes hello manager's id, and then another request toofetch hello manager's details in an employee entity.</span></span>  

![][16]

#### <a name="solution"></a><span data-ttu-id="dc5a6-642">Soluzione</span><span class="sxs-lookup"><span data-stu-id="dc5a6-642">Solution</span></span>
<span data-ttu-id="dc5a6-643">Invece di archiviare dati hello in due entità separate, denormalizzare dati hello e conservare una copia dei dettagli del gestore hello in entità reparto hello.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-643">Instead of storing hello data in two separate entities, denormalize hello data and keep a copy of hello manager's details in hello department entity.</span></span> <span data-ttu-id="dc5a6-644">ad esempio:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-644">For example:</span></span>  

![][17]

<span data-ttu-id="dc5a6-645">Con entità reparto archiviate con queste proprietà, è ora possibile recuperare tutti i dettagli di hello che necessarie su un reparto utilizzando una query del punto.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-645">With department entities stored with these properties, you can now retrieve all hello details you need about a department using a point query.</span></span>  

#### <a name="issues-and-considerations"></a><span data-ttu-id="dc5a6-646">Considerazioni e problemi</span><span class="sxs-lookup"><span data-stu-id="dc5a6-646">Issues and considerations</span></span>
<span data-ttu-id="dc5a6-647">Considerare i seguenti punti quando si decide di hello come tooimplement questo modello:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-647">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="dc5a6-648">Archiviare alcuni dati due volte comporta un aumento dei costi.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-648">There is some cost overhead associated with storing some data twice.</span></span> <span data-ttu-id="dc5a6-649">miglioramento delle prestazioni (risultante dal servizio di archiviazione di un numero inferiore richieste toohello) in genere Hello supera l'incremento marginale hello dei costi di archiviazione (e il costo dell'offset parzialmente con una riduzione del numero di hello di transazioni si richiedono i dettagli di hello toofetch di un reparto).</span><span class="sxs-lookup"><span data-stu-id="dc5a6-649">hello performance benefit (resulting from fewer requests toohello storage service) typically outweighs hello marginal increase in storage costs (and this cost is partially offset by a reduction in hello number of transactions you require toofetch hello details of a department).</span></span>  
* <span data-ttu-id="dc5a6-650">È necessario mantenere la coerenza di hello di due entità hello che archiviano informazioni sui Manager.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-650">You must maintain hello consistency of hello two entities that store information about managers.</span></span> <span data-ttu-id="dc5a6-651">È possibile gestire il problema di coerenza hello utilizzando EGTs tooupdate più entità in una singola transazione atomica: in questo caso, vengono archiviati entità reparto hello ed entità employee hello responsabile del reparto hello in hello stessa partizione.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-651">You can handle hello consistency issue by using EGTs tooupdate multiple entities in a single atomic transaction: in this case, hello department entity, and hello employee entity for hello department manager are stored in hello same partition.</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="dc5a6-652">Quando toouse questo modello</span><span class="sxs-lookup"><span data-stu-id="dc5a6-652">When toouse this pattern</span></span>
<span data-ttu-id="dc5a6-653">Utilizzare questo modello quando è spesso necessario toolook le informazioni correlate.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-653">Use this pattern when you frequently need toolook up related information.</span></span> <span data-ttu-id="dc5a6-654">Questo modello consente di ridurre il numero di hello di query, per che il client deve effettuare tooretrieve hello i dati che necessari.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-654">This pattern reduces hello number of queries your client must make tooretrieve hello data it requires.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="dc5a6-655">Modelli correlati e informazioni aggiuntive</span><span class="sxs-lookup"><span data-stu-id="dc5a6-655">Related patterns and guidance</span></span>
<span data-ttu-id="dc5a6-656">Hello modelli e le indicazioni seguenti possono anche essere importanti quando si implementa il pattern di:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-656">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="dc5a6-657">Modello per chiave composta</span><span class="sxs-lookup"><span data-stu-id="dc5a6-657">Compound key pattern</span></span>](#compound-key-pattern)  
* [<span data-ttu-id="dc5a6-658">Transazioni dei gruppi di entità</span><span class="sxs-lookup"><span data-stu-id="dc5a6-658">Entity Group Transactions</span></span>](#entity-group-transactions)  
* [<span data-ttu-id="dc5a6-659">Uso di tipi di entità eterogenei</span><span class="sxs-lookup"><span data-stu-id="dc5a6-659">Working with heterogeneous entity types</span></span>](#working-with-heterogeneous-entity-types)

### <a name="compound-key-pattern"></a><span data-ttu-id="dc5a6-660">Modello per chiave composta</span><span class="sxs-lookup"><span data-stu-id="dc5a6-660">Compound key pattern</span></span>
<span data-ttu-id="dc5a6-661">Utilizzare composta **RowKey** tooenable valori toolookup un client relativi dati con un singolo punto di query.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-661">Use compound **RowKey** values tooenable a client toolookup related data with a single point query.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="dc5a6-662">Contesto e problema</span><span class="sxs-lookup"><span data-stu-id="dc5a6-662">Context and problem</span></span>
<span data-ttu-id="dc5a6-663">In un database relazionale, è piuttosto naturale toouse join nelle query tooreturn relative parti del client toohello dati in una singola query.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-663">In a relational database, it is quite natural toouse joins in queries tooreturn related pieces of data toohello client in a single query.</span></span> <span data-ttu-id="dc5a6-664">Ad esempio, è possibile utilizzare hello employee id toolook un elenco di entità correlate che contengono le prestazioni ed esaminare i dati per il dipendente.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-664">For example, you might use hello employee id toolook up a list of related entities that contain performance and review data for that employee.</span></span>  

<span data-ttu-id="dc5a6-665">Si supponga che l'entità dipendente vengono archiviati nel servizio tabelle hello utilizzando hello seguente struttura:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-665">Assume you are storing employee entities in hello Table service using hello following structure:</span></span>  

![][18]

<span data-ttu-id="dc5a6-666">È inoltre necessario toostore dati cronologici relativi tooreviews e prestazioni per ogni dipendente hello anno ha lavorato per l'organizzazione e necessario tooaccess in grado di toobe queste informazioni per anno.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-666">You also need toostore historical data relating tooreviews and performance for each year hello employee has worked for your organization and you need toobe able tooaccess this information by year.</span></span> <span data-ttu-id="dc5a6-667">Un'opzione è toocreate un'altra tabella che contiene le entità con hello seguente struttura:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-667">One option is toocreate another table that stores entities with hello following structure:</span></span>  

![][19]

<span data-ttu-id="dc5a6-668">Si noti che con questo approccio si potrebbero decidere tooduplicate alcune informazioni (ad esempio nome e cognome) hello nuova entità tooenable si tooretrieve i dati con una singola richiesta.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-668">Notice that with this approach you may decide tooduplicate some information (such as first name and last name) in hello new entity tooenable you tooretrieve your data with a single request.</span></span> <span data-ttu-id="dc5a6-669">Tuttavia, non è possibile garantire la coerenza sicura perché non è possibile utilizzare un due entità hello tooupdate EGT in modo atomico.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-669">However, you cannot maintain strong consistency because you cannot use an EGT tooupdate hello two entities atomically.</span></span>  

#### <a name="solution"></a><span data-ttu-id="dc5a6-670">Soluzione</span><span class="sxs-lookup"><span data-stu-id="dc5a6-670">Solution</span></span>
<span data-ttu-id="dc5a6-671">Archiviare un nuovo tipo di entità nella tabella originale con entità hello seguente struttura:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-671">Store a new entity type in your original table using entities with hello following structure:</span></span>  

![][20]

<span data-ttu-id="dc5a6-672">Si noti come hello **RowKey** è ora una chiave composta costituita da id dipendente hello e anno hello dati revisione hello che consente di tooretrieve hello delle prestazioni del dipendente ed esaminare i dati con una singola richiesta per una singola entità.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-672">Notice how hello **RowKey** is now a compound key made up of hello employee id and hello year of hello review data that enables you tooretrieve hello employee's performance and review data with a single request for a single entity.</span></span>  

<span data-ttu-id="dc5a6-673">Hello di esempio seguente viene illustrato come recuperare tutti i dati di revisione hello per un dipendente specifico (ad esempio employee 000123 nel reparto vendite hello):</span><span class="sxs-lookup"><span data-stu-id="dc5a6-673">hello following example outlines how you can retrieve all hello review data for a particular employee (such as employee 000123 in hello Sales department):</span></span>  

<span data-ttu-id="dc5a6-674">$filter=(PartitionKey eq 'Sales') and (RowKey ge 'empid_000123') and (RowKey lt 'empid_000124')&$select=RowKey,Manager Rating,Peer Rating,Comments</span><span class="sxs-lookup"><span data-stu-id="dc5a6-674">$filter=(PartitionKey eq 'Sales') and (RowKey ge 'empid_000123') and (RowKey lt 'empid_000124')&$select=RowKey,Manager Rating,Peer Rating,Comments</span></span>  

#### <a name="issues-and-considerations"></a><span data-ttu-id="dc5a6-675">Considerazioni e problemi</span><span class="sxs-lookup"><span data-stu-id="dc5a6-675">Issues and considerations</span></span>
<span data-ttu-id="dc5a6-676">Considerare i seguenti punti quando si decide di hello come tooimplement questo modello:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-676">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="dc5a6-677">È consigliabile utilizzare un carattere separatore appropriato che rende facile tooparse hello **RowKey** valore: ad esempio, **000123_2012**.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-677">You should use a suitable separator character that makes it easy tooparse hello **RowKey** value: for example, **000123_2012**.</span></span>  
* <span data-ttu-id="dc5a6-678">Questa entità vengono inoltre archiviati nella stessa partizione delle altre entità che contengono dati correlati per hello hello stesso dipendente, pertanto è possibile utilizzare EGTs toomaintain la coerenza assoluta.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-678">You are also storing this entity in hello same partition as other entities that contain related data for hello same employee, which means you can use EGTs toomaintain strong consistency.</span></span>
* <span data-ttu-id="dc5a6-679">È necessario considerare la frequenza si richiederà hello dati toodetermine se questo modello è appropriato.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-679">You should consider how frequently you will query hello data toodetermine whether this pattern is appropriate.</span></span>  <span data-ttu-id="dc5a6-680">Ad esempio, se è necessario accedere hello raramente data di revisione e hello principale i dati dei dipendenti spesso che deve essere conservato come entità separate.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-680">For example, if you will access hello review data infrequently and hello main employee data often you should keep them as separate entities.</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="dc5a6-681">Quando toouse questo modello</span><span class="sxs-lookup"><span data-stu-id="dc5a6-681">When toouse this pattern</span></span>
<span data-ttu-id="dc5a6-682">Utilizzare questo modello quando è necessario toostore uno o più entità correlate ai cui si eseguono query frequentemente.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-682">Use this pattern when you need toostore one or more related entities that you query frequently.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="dc5a6-683">Modelli correlati e informazioni aggiuntive</span><span class="sxs-lookup"><span data-stu-id="dc5a6-683">Related patterns and guidance</span></span>
<span data-ttu-id="dc5a6-684">Hello modelli e le indicazioni seguenti possono anche essere importanti quando si implementa il pattern di:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-684">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="dc5a6-685">Transazioni dei gruppi di entità</span><span class="sxs-lookup"><span data-stu-id="dc5a6-685">Entity Group Transactions</span></span>](#entity-group-transactions)  
* [<span data-ttu-id="dc5a6-686">Uso di tipi di entità eterogenei</span><span class="sxs-lookup"><span data-stu-id="dc5a6-686">Working with heterogeneous entity types</span></span>](#working-with-heterogeneous-entity-types)  
* [<span data-ttu-id="dc5a6-687">Modello per transazioni con coerenza finale</span><span class="sxs-lookup"><span data-stu-id="dc5a6-687">Eventually consistent transactions pattern</span></span>](#eventually-consistent-transactions-pattern)  

### <a name="log-tail-pattern"></a><span data-ttu-id="dc5a6-688">Modello della parte finale del log</span><span class="sxs-lookup"><span data-stu-id="dc5a6-688">Log tail pattern</span></span>
<span data-ttu-id="dc5a6-689">Recuperare hello  *n*  le entità aggiunte più di recente tooa partizione utilizzando un **RowKey** valore che ordina in data inversa e l'ordine temporale.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-689">Retrieve hello *n* entities most recently added tooa partition by using a **RowKey** value that sorts in reverse date and time order.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="dc5a6-690">Contesto e problema</span><span class="sxs-lookup"><span data-stu-id="dc5a6-690">Context and problem</span></span>
<span data-ttu-id="dc5a6-691">Un requisito comune è in grado di tooretrieve entità hello creato di recente, ad esempio hello dieci più recente di rimborso spese inviata da un dipendente.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-691">A common requirement is be able tooretrieve hello most recently created entities, for example hello ten most recent expense claims submitted by an employee.</span></span> <span data-ttu-id="dc5a6-692">Supporto di una query nella tabella un **$top** hello tooreturn operazione di query prima  *n*  entità da un set: non vi è nessuna query equivalente operazione tooreturn hello ultimi n entità in un set.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-692">Table queries support a **$top** query operation tooreturn hello first *n* entities from a set: there is no equivalent query operation tooreturn hello last n entities in a set.</span></span>  

#### <a name="solution"></a><span data-ttu-id="dc5a6-693">Soluzione</span><span class="sxs-lookup"><span data-stu-id="dc5a6-693">Solution</span></span>
<span data-ttu-id="dc5a6-694">Le entità hello archivio utilizzando un **RowKey** che naturalmente Ordina in senso inverso data/ora ordine utilizzando in modo che la voce più recente di hello è sempre hello presente nella tabella hello.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-694">Store hello entities using a **RowKey** that naturally sorts in reverse date/time order by using so hello most recent entry is always hello first one in hello table.</span></span>  

<span data-ttu-id="dc5a6-695">Ad esempio, tooretrieve in grado di toobe hello dieci più recente di rimborso spese inviata da un dipendente, è possibile utilizzare un valore di apice inverso derivato da hello data/ora corrente.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-695">For example, toobe able tooretrieve hello ten most recent expense claims submitted by an employee, you can use a reverse tick value derived from hello current date/time.</span></span> <span data-ttu-id="dc5a6-696">Hello c# esempio seguente viene illustrato un modo toocreate un valore di "invertito segni di graduazione" appropriato per un **RowKey** che ordina da hello più recente toohello meno recente:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-696">hello following C# code sample shows one way toocreate a suitable "inverted ticks" value for a **RowKey** that sorts from hello most recent toohello oldest:</span></span>  

`string invertedTicks = string.Format("{0:D19}", DateTime.MaxValue.Ticks - DateTime.UtcNow.Ticks);`  

<span data-ttu-id="dc5a6-697">È possibile ottenere il valore del tempo data toohello tramite hello seguente codice:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-697">You can get back toohello date time value using hello following code:</span></span>  

`DateTime dt = new DateTime(DateTime.MaxValue.Ticks - Int64.Parse(invertedTicks));`  

<span data-ttu-id="dc5a6-698">query di tabella Hello è simile al seguente:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-698">hello table query looks like this:</span></span>  

`https://myaccount.table.core.windows.net/EmployeeExpense(PartitionKey='empid')?$top=10`  

#### <a name="issues-and-considerations"></a><span data-ttu-id="dc5a6-699">Considerazioni e problemi</span><span class="sxs-lookup"><span data-stu-id="dc5a6-699">Issues and considerations</span></span>
<span data-ttu-id="dc5a6-700">Considerare i seguenti punti quando si decide di hello come tooimplement questo modello:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-700">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="dc5a6-701">È necessario aggiungere il valore di apice inverso hello con zeri iniziali valore di stringa hello tooensure Ordina come previsto.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-701">You must pad hello reverse tick value with leading zeroes tooensure hello string value sorts as expected.</span></span>  
* <span data-ttu-id="dc5a6-702">È necessario essere consapevoli di obiettivi di scalabilità hello a livello di hello di una partizione.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-702">You must be aware of hello scalability targets at hello level of a partition.</span></span> <span data-ttu-id="dc5a6-703">Fare attenzione a non creare partizioni critiche.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-703">Be careful not create hot spot partitions.</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="dc5a6-704">Quando toouse questo modello</span><span class="sxs-lookup"><span data-stu-id="dc5a6-704">When toouse this pattern</span></span>
<span data-ttu-id="dc5a6-705">Utilizzare questo modello quando è necessario tooaccess entità in ordine inverso di data/ora o quando è necessario più di recente hello tooaccess aggiunto le entità.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-705">Use this pattern when you need tooaccess entities in reverse date/time order or when you need tooaccess hello most recently added entities.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="dc5a6-706">Modelli correlati e informazioni aggiuntive</span><span class="sxs-lookup"><span data-stu-id="dc5a6-706">Related patterns and guidance</span></span>
<span data-ttu-id="dc5a6-707">Hello modelli e le indicazioni seguenti possono anche essere importanti quando si implementa il pattern di:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-707">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="dc5a6-708">Anti-modello prepend/append</span><span class="sxs-lookup"><span data-stu-id="dc5a6-708">Prepend / append anti-pattern</span></span>](#prepend-append-anti-pattern)  
* [<span data-ttu-id="dc5a6-709">Recupero di entità</span><span class="sxs-lookup"><span data-stu-id="dc5a6-709">Retrieving entities</span></span>](#retrieving-entities)  

### <a name="high-volume-delete-pattern"></a><span data-ttu-id="dc5a6-710">Modello di eliminazione volume elevato</span><span class="sxs-lookup"><span data-stu-id="dc5a6-710">High volume delete pattern</span></span>
<span data-ttu-id="dc5a6-711">Abilitare l'eliminazione di hello di un volume elevato di entità mediante l'archiviazione di tutte le entità hello per l'eliminazione simultanea nella tabella propria separata. eliminare le entità hello tabella hello.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-711">Enable hello deletion of a high volume of entities by storing all hello entities for simultaneous deletion in their own separate table; you delete hello entities by deleting hello table.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="dc5a6-712">Contesto e problema</span><span class="sxs-lookup"><span data-stu-id="dc5a6-712">Context and problem</span></span>
<span data-ttu-id="dc5a6-713">Molte applicazioni eliminare i dati obsoleti che non necessita più dell'applicazione client di toobe tooa disponibile o che un'applicazione hello è archiviato il supporto di archiviazione tooanother.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-713">Many applications delete old data which no longer needs toobe available tooa client application, or that hello application has archived tooanother storage medium.</span></span> <span data-ttu-id="dc5a6-714">È in genere identificare tali dati da una data: ad esempio, si dispone di un record di toodelete requisito di tutte le richieste di accesso di più di 60 giorni.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-714">You typically identify such data by a date: for example, you have a requirement toodelete records of all login requests that are more than 60 days old.</span></span>  

<span data-ttu-id="dc5a6-715">Uno schema possibili è toouse hello data e ora della richiesta di accesso hello in hello **RowKey**:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-715">One possible design is toouse hello date and time of hello login request in hello **RowKey**:</span></span>  

![][21]

<span data-ttu-id="dc5a6-716">Questo approccio evita hotspot partizione perché un'applicazione hello può inserire ed eliminare entità di account di accesso per ogni utente in una partizione separata.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-716">This approach avoids partition hotspots because hello application can insert and delete login entities for each user in a separate partition.</span></span> <span data-ttu-id="dc5a6-717">Tuttavia, questo approccio può essere costoso e molto tempo se si dispone di un numero elevato di entità perché è necessario innanzitutto tooperform una scansione di tabella in ordine tooidentify tutti hello entità toodelete e quindi è necessario eliminare ogni entità precedente.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-717">However, this approach may be costly and time consuming if you have a large number of entities because first you need tooperform a table scan in order tooidentify all hello entities toodelete, and then you must delete each old entity.</span></span> <span data-ttu-id="dc5a6-718">Si noti che è possibile ridurre il numero di hello di round trip toohello server necessarie toodelete hello precedente entità suddividendo in batch più richieste di eliminazione in EGTs.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-718">Note that you can reduce hello number of round trips toohello server required toodelete hello old entities by batching multiple delete requests into EGTs.</span></span>  

#### <a name="solution"></a><span data-ttu-id="dc5a6-719">Soluzione</span><span class="sxs-lookup"><span data-stu-id="dc5a6-719">Solution</span></span>
<span data-ttu-id="dc5a6-720">Usare una tabella separata per ogni giorno di tentativi di accesso.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-720">Use a separate table for each day of login attempts.</span></span> <span data-ttu-id="dc5a6-721">Quando si inseriscono entità e l'eliminazione di entità precedente è ora sufficiente una domanda di eliminazione di una tabella di ogni giorno, è possibile utilizzare progettazione entità hello sopra hotspot tooavoid (una singola operazione di archiviazione) invece di ricerca e all'eliminazione di centinaia di migliaia di entità di singoli account di accesso ogni giorno.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-721">You can use hello entity design above tooavoid hotspots when you are inserting entities, and deleting old entities is now simply a question of deleting one table every day (a single storage operation) instead of finding and deleting hundreds and thousands of individual login entities every day.</span></span>  

#### <a name="issues-and-considerations"></a><span data-ttu-id="dc5a6-722">Considerazioni e problemi</span><span class="sxs-lookup"><span data-stu-id="dc5a6-722">Issues and considerations</span></span>
<span data-ttu-id="dc5a6-723">Considerare i seguenti punti quando si decide di hello come tooimplement questo modello:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-723">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="dc5a6-724">Il progetto supporta altri modi in cui l'applicazione utilizzerà dati hello, ad esempio la ricerca di entità specifica, il collegamento con altri dati o generare informazioni di aggregazione?</span><span class="sxs-lookup"><span data-stu-id="dc5a6-724">Does your design support other ways your application will use hello data such as looking up specific entities, linking with other data, or generating aggregate information?</span></span>  
* <span data-ttu-id="dc5a6-725">La progettazione consente di evitare hotspot durante l'inserimento di nuove entità?</span><span class="sxs-lookup"><span data-stu-id="dc5a6-725">Does your design avoid hot spots when you are inserting new entities?</span></span>  
* <span data-ttu-id="dc5a6-726">Prevedere un ritardo se si desidera tooreuse hello stesso nome di tabella dopo l'eliminazione.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-726">Expect a delay if you want tooreuse hello same table name after deleting it.</span></span> <span data-ttu-id="dc5a6-727">È meglio i nomi di tabella univoco di utilizzare tooalways.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-727">It's better tooalways use unique table names.</span></span>  
* <span data-ttu-id="dc5a6-728">È probabile che alcune la limitazione delle richieste quando si usa una nuova tabella mentre hello del servizio tabelle apprende i modelli di accesso hello e distribuisce le partizioni hello tra i nodi.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-728">Expect some throttling when you first use a new table while hello Table service learns hello access patterns and distributes hello partitions across nodes.</span></span> <span data-ttu-id="dc5a6-729">È necessario considerare la frequenza con cui è necessario toocreate nuove tabelle.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-729">You should consider how frequently you need toocreate new tables.</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="dc5a6-730">Quando toouse questo modello</span><span class="sxs-lookup"><span data-stu-id="dc5a6-730">When toouse this pattern</span></span>
<span data-ttu-id="dc5a6-731">Utilizzare questo modello quando si dispone di un volume elevato di entità che è necessario eliminare in hello contemporaneamente.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-731">Use this pattern when you have a high volume of entities that you must delete at hello same time.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="dc5a6-732">Modelli correlati e informazioni aggiuntive</span><span class="sxs-lookup"><span data-stu-id="dc5a6-732">Related patterns and guidance</span></span>
<span data-ttu-id="dc5a6-733">Hello modelli e le indicazioni seguenti possono anche essere importanti quando si implementa il pattern di:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-733">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="dc5a6-734">Transazioni dei gruppi di entità</span><span class="sxs-lookup"><span data-stu-id="dc5a6-734">Entity Group Transactions</span></span>](#entity-group-transactions)
* [<span data-ttu-id="dc5a6-735">Modifica di entità</span><span class="sxs-lookup"><span data-stu-id="dc5a6-735">Modifying entities</span></span>](#modifying-entities)  

### <a name="data-series-pattern"></a><span data-ttu-id="dc5a6-736">Modello di serie di dati</span><span class="sxs-lookup"><span data-stu-id="dc5a6-736">Data series pattern</span></span>
<span data-ttu-id="dc5a6-737">Archivio dati completo serie in un numero di hello toominimize singola entità richieste di effettuate.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-737">Store complete data series in a single entity toominimize hello number of requests you make.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="dc5a6-738">Contesto e problema</span><span class="sxs-lookup"><span data-stu-id="dc5a6-738">Context and problem</span></span>
<span data-ttu-id="dc5a6-739">Uno scenario comune è per un'applicazione toostore una serie di dati che è in genere necessario tooretrieve tutti contemporaneamente.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-739">A common scenario is for an application toostore a series of data that it typically needs tooretrieve all at once.</span></span> <span data-ttu-id="dc5a6-740">L'applicazione potrebbe ad esempio, registrare il numero di messaggi di messaggistica immediata ogni dipendente invia ogni ora e quindi utilizzare questa tooplot informazioni il numero di messaggi inviati da ogni utente in hello 24 ore precedenti.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-740">For example, your application might record how many IM messages each employee sends every hour, and then use this information tooplot how many messages each user sent over hello preceding 24 hours.</span></span> <span data-ttu-id="dc5a6-741">Uno schema potrebbe essere toostore 24 entità per ogni dipendente:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-741">One design might be toostore 24 entities for each employee:</span></span>  

![][22]

<span data-ttu-id="dc5a6-742">Con questa struttura, si possono individuare e aggiornare hello entità tooupdate per ogni dipendente, ogni volta che un'applicazione hello deve tooupdate valore del conteggio messaggio hello.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-742">With this design, you can easily locate and update hello entity tooupdate for each employee whenever hello application needs tooupdate hello message count value.</span></span> <span data-ttu-id="dc5a6-743">Tuttavia, tooretrieve hello informazioni tooplot un grafico delle attività di hello per hello 24 ore precedenti, è necessario recuperare 24 entità.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-743">However, tooretrieve hello information tooplot a chart of hello activity for hello preceding 24 hours, you must retrieve 24 entities.</span></span>  

#### <a name="solution"></a><span data-ttu-id="dc5a6-744">Soluzione</span><span class="sxs-lookup"><span data-stu-id="dc5a6-744">Solution</span></span>
<span data-ttu-id="dc5a6-745">Utilizzare hello seguente struttura con un numero di messaggi hello toostore proprietà separata per ogni ora:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-745">Use hello following design with a separate property toostore hello message count for each hour:</span></span>  

![][23]

<span data-ttu-id="dc5a6-746">Con questa struttura, è possibile utilizzare un numero di messaggi hello tooupdate operazione di merge per un dipendente per un'ora specifica.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-746">With this design, you can use a merge operation tooupdate hello message count for an employee for a specific hour.</span></span> <span data-ttu-id="dc5a6-747">A questo punto, è possibile recuperare tutte le informazioni di hello occorre grafico hello tooplot usando una richiesta per una singola entità.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-747">Now, you can retrieve all hello information you need tooplot hello chart using a request for a single entity.</span></span>  

#### <a name="issues-and-considerations"></a><span data-ttu-id="dc5a6-748">Considerazioni e problemi</span><span class="sxs-lookup"><span data-stu-id="dc5a6-748">Issues and considerations</span></span>
<span data-ttu-id="dc5a6-749">Considerare i seguenti punti quando si decide di hello come tooimplement questo modello:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-749">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="dc5a6-750">Se la serie di dati completo non è sufficiente una singola entità (un'entità può avere proprietà too252), utilizzare un archivio di dati alternativi, ad esempio un blob.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-750">If your complete data series does not fit into a single entity (an entity can have up too252 properties), use an alternative data store such as a blob.</span></span>  
* <span data-ttu-id="dc5a6-751">Se si dispone di più client contemporaneamente l'aggiornamento di un'entità, sarà necessario hello toouse **ETag** tooimplement la concorrenza ottimistica.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-751">If you have multiple clients updating an entity simultaneously, you will need toouse hello **ETag** tooimplement optimistic concurrency.</span></span> <span data-ttu-id="dc5a6-752">Se si dispone di molti client, potrebbe verificarsi un conflitto elevato.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-752">If you have many clients, you may experience high contention.</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="dc5a6-753">Quando toouse questo modello</span><span class="sxs-lookup"><span data-stu-id="dc5a6-753">When toouse this pattern</span></span>
<span data-ttu-id="dc5a6-754">Utilizzare questo modello quando è necessario tooupdate e recuperare una serie di dati associata a una singola entità.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-754">Use this pattern when you need tooupdate and retrieve a data series associated with an individual entity.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="dc5a6-755">Modelli correlati e informazioni aggiuntive</span><span class="sxs-lookup"><span data-stu-id="dc5a6-755">Related patterns and guidance</span></span>
<span data-ttu-id="dc5a6-756">Hello modelli e le indicazioni seguenti possono anche essere importanti quando si implementa il pattern di:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-756">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="dc5a6-757">Modello di entità di grandi dimensioni</span><span class="sxs-lookup"><span data-stu-id="dc5a6-757">Large entities pattern</span></span>](#large-entities-pattern)  
* [<span data-ttu-id="dc5a6-758">Unione o sostituzione</span><span class="sxs-lookup"><span data-stu-id="dc5a6-758">Merge or replace</span></span>](#merge-or-replace)  
* <span data-ttu-id="dc5a6-759">[Il modello alla fine coerente transazioni](#eventually-consistent-transactions-pattern) (se si archiviano serie di dati hello in un blob)</span><span class="sxs-lookup"><span data-stu-id="dc5a6-759">[Eventually consistent transactions pattern](#eventually-consistent-transactions-pattern) (if you are storing hello data series in a blob)</span></span>  

### <a name="wide-entities-pattern"></a><span data-ttu-id="dc5a6-760">Modello di entità di grandi dimensioni</span><span class="sxs-lookup"><span data-stu-id="dc5a6-760">Wide entities pattern</span></span>
<span data-ttu-id="dc5a6-761">Utilizzare come entità logiche più entità fisiche toostore con più di 252 proprietà.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-761">Use multiple physical entities toostore logical entities with more than 252 properties.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="dc5a6-762">Contesto e problema</span><span class="sxs-lookup"><span data-stu-id="dc5a6-762">Context and problem</span></span>
<span data-ttu-id="dc5a6-763">Una singola entità può disporre di proprietà non deve superare 252 (escluse le proprietà del sistema obbligatorio hello) e non è possibile archiviare più di 1 MB di dati in totale.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-763">An individual entity can have no more than 252 properties (excluding hello mandatory system properties) and cannot store more than 1 MB of data in total.</span></span> <span data-ttu-id="dc5a6-764">In un database relazionale, è in genere ottenuto round eventuali limiti di dimensioni hello di una riga aggiunta una nuova tabella e a imporre una relazione 1 a 1 tra di essi.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-764">In a relational database, you would typically get round any limits on hello size of a row by adding a new table and enforcing a 1-to-1 relationship between them.</span></span>  

#### <a name="solution"></a><span data-ttu-id="dc5a6-765">Soluzione</span><span class="sxs-lookup"><span data-stu-id="dc5a6-765">Solution</span></span>
<span data-ttu-id="dc5a6-766">Utilizzo del servizio tabelle hello, è possibile archiviare più entità toorepresent un oggetto di business di grandi dimensioni con più di 252 proprietà.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-766">Using hello Table service, you can store multiple entities toorepresent a single large business object with more than 252 properties.</span></span> <span data-ttu-id="dc5a6-767">Ad esempio, se si desidera toostore hello numero di messaggi immediati inviati da ogni dipendente per hello ultimi 365 giorni, è possibile utilizzare hello seguito progettazione che usa due entità con schemi diversi:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-767">For example, if you want toostore a count of hello number of IM messages sent by each employee for hello last 365 days, you could use hello following design that uses two entities with different schemas:</span></span>  

![][24]

<span data-ttu-id="dc5a6-768">Se è necessario toomake una modifica che richiede l'aggiornamento sia tookeep entità li sincronizzati con l'altro è possibile utilizzare un EGT.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-768">If you need toomake a change that requires updating both entities tookeep them synchronized with each other you can use an EGT.</span></span> <span data-ttu-id="dc5a6-769">In caso contrario, è possibile utilizzare un numero di messaggi di unione singola operazione tooupdate hello per un giorno specifico.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-769">Otherwise, you can use a single merge operation tooupdate hello message count for a specific day.</span></span> <span data-ttu-id="dc5a6-770">tooretrieve tutti hello dati per un singolo dipendente, è necessario recuperare entrambe le entità, che è possibile eseguire con due richieste efficiente di utilizzano sia un **PartitionKey** e **RowKey** valore.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-770">tooretrieve all hello data for an individual employee you must retrieve both entities, which you can do with two efficient requests that use both a **PartitionKey** and a **RowKey** value.</span></span>  

#### <a name="issues-and-considerations"></a><span data-ttu-id="dc5a6-771">Considerazioni e problemi</span><span class="sxs-lookup"><span data-stu-id="dc5a6-771">Issues and considerations</span></span>
<span data-ttu-id="dc5a6-772">Considerare i seguenti punti quando si decide di hello come tooimplement questo modello:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-772">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="dc5a6-773">Recupero di un'entità logica completa richiede almeno due transazioni di archiviazione: entità fisica uno tooretrieve.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-773">Retrieving a complete logical entity involves at least two storage transactions: one tooretrieve each physical entity.</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="dc5a6-774">Quando toouse questo modello</span><span class="sxs-lookup"><span data-stu-id="dc5a6-774">When toouse this pattern</span></span>
<span data-ttu-id="dc5a6-775">Utilizzare questo modello quando è necessario toostore entità la cui dimensione o il numero di proprietà supera i limiti di hello per una singola entità in hello servizio tabelle.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-775">Use this pattern when  need toostore entities whose size or number of properties exceeds hello limits for an individual entity in hello Table service.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="dc5a6-776">Modelli correlati e informazioni aggiuntive</span><span class="sxs-lookup"><span data-stu-id="dc5a6-776">Related patterns and guidance</span></span>
<span data-ttu-id="dc5a6-777">Hello modelli e le indicazioni seguenti possono anche essere importanti quando si implementa il pattern di:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-777">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="dc5a6-778">Transazioni dei gruppi di entità</span><span class="sxs-lookup"><span data-stu-id="dc5a6-778">Entity Group Transactions</span></span>](#entity-group-transactions)
* [<span data-ttu-id="dc5a6-779">Unione o sostituzione</span><span class="sxs-lookup"><span data-stu-id="dc5a6-779">Merge or replace</span></span>](#merge-or-replace)

### <a name="large-entities-pattern"></a><span data-ttu-id="dc5a6-780">Modello di entità di grandi dimensioni</span><span class="sxs-lookup"><span data-stu-id="dc5a6-780">Large entities pattern</span></span>
<span data-ttu-id="dc5a6-781">Utilizzare valori di proprietà di grandi dimensioni toostore archiviazione blob.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-781">Use blob storage toostore large property values.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="dc5a6-782">Contesto e problema</span><span class="sxs-lookup"><span data-stu-id="dc5a6-782">Context and problem</span></span>
<span data-ttu-id="dc5a6-783">Una singola entità non può memorizzare più di 1 MB di dati in totale.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-783">An individual entity cannot store more than 1 MB of data in total.</span></span> <span data-ttu-id="dc5a6-784">Se una o più delle proprietà di archiviare i valori che determinano questo valore di dimensione totale di hello di tooexceed l'entità, è possibile archiviare l'intera entità hello in hello del servizio tabelle.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-784">If one or several of your properties store values that cause hello total size of your entity tooexceed this value, you cannot store hello entire entity in hello Table service.</span></span>  

#### <a name="solution"></a><span data-ttu-id="dc5a6-785">Soluzione</span><span class="sxs-lookup"><span data-stu-id="dc5a6-785">Solution</span></span>
<span data-ttu-id="dc5a6-786">Se l'entità supera 1 MB di dimensioni perché una o più proprietà contengono una grande quantità di dati, è possibile archiviare i dati nel servizio Blob hello e quindi archiviare indirizzo hello del blob hello in una proprietà nell'entità hello.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-786">If your entity exceeds 1 MB in size because one or more properties contain a large amount of data, you can store data in hello Blob service and then store hello address of hello blob in a property in hello entity.</span></span> <span data-ttu-id="dc5a6-787">Ad esempio, è possibile archiviare foto hello di un dipendente nell'archiviazione blob e archiviare una foto toohello collegamento in hello **foto** proprietà dell'entità dipendente:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-787">For example, you can store hello photo of an employee in blob storage and store a link toohello photo in hello **Photo** property of your employee entity:</span></span>  

![][25]

#### <a name="issues-and-considerations"></a><span data-ttu-id="dc5a6-788">Considerazioni e problemi</span><span class="sxs-lookup"><span data-stu-id="dc5a6-788">Issues and considerations</span></span>
<span data-ttu-id="dc5a6-789">Considerare i seguenti punti quando si decide di hello come tooimplement questo modello:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-789">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="dc5a6-790">la coerenza eventuale toomaintain tra entità hello in hello del servizio tabelle e dati hello hello servizio Blob, utilizzare hello [modello alla fine coerente transazioni](#eventually-consistent-transactions-pattern) toomaintain le entità.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-790">toomaintain eventual consistency between hello entity in hello Table service and hello data in hello Blob service, use hello [Eventually consistent transactions pattern](#eventually-consistent-transactions-pattern) toomaintain your entities.</span></span>
* <span data-ttu-id="dc5a6-791">Recupero di un'entità completa richiede almeno due transazioni di archiviazione: un'entità di hello tooretrieve e hello un tooretrieve blob di dati.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-791">Retrieving a complete entity involves at least two storage transactions: one tooretrieve hello entity and one tooretrieve hello blob data.</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="dc5a6-792">Quando toouse questo modello</span><span class="sxs-lookup"><span data-stu-id="dc5a6-792">When toouse this pattern</span></span>
<span data-ttu-id="dc5a6-793">Utilizzare questo modello quando è necessario toostore entità la cui dimensione supera i limiti di hello per una singola entità nel servizio tabelle hello.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-793">Use this pattern when you need toostore entities whose size exceeds hello limits for an individual entity in hello Table service.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="dc5a6-794">Modelli correlati e informazioni aggiuntive</span><span class="sxs-lookup"><span data-stu-id="dc5a6-794">Related patterns and guidance</span></span>
<span data-ttu-id="dc5a6-795">Hello modelli e le indicazioni seguenti possono anche essere importanti quando si implementa il pattern di:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-795">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="dc5a6-796">Modello per transazioni con coerenza finale</span><span class="sxs-lookup"><span data-stu-id="dc5a6-796">Eventually consistent transactions pattern</span></span>](#eventually-consistent-transactions-pattern)  
* [<span data-ttu-id="dc5a6-797">Modello di entità di grandi dimensioni</span><span class="sxs-lookup"><span data-stu-id="dc5a6-797">Wide entities pattern</span></span>](#wide-entities-pattern)

<a name="prepend-append-anti-pattern"></a>

### <a name="prependappend-anti-pattern"></a><span data-ttu-id="dc5a6-798">Anti-modello prepend/append</span><span class="sxs-lookup"><span data-stu-id="dc5a6-798">Prepend/append anti-pattern</span></span>
<span data-ttu-id="dc5a6-799">Aumentare la scalabilità quando si dispone di un volume elevato di inserimenti distribuendo hello inserimenti tra più partizioni.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-799">Increase scalability when you have a high volume of inserts by spreading hello inserts across multiple partitions.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="dc5a6-800">Contesto e problema</span><span class="sxs-lookup"><span data-stu-id="dc5a6-800">Context and problem</span></span>
<span data-ttu-id="dc5a6-801">Anteponendo o l'aggiunta di entità di entità tooyour archiviati in genere comporta l'aggiunta di nuove entità toohello innanzitutto un'applicazione hello o l'ultima partizione di una sequenza di partizioni.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-801">Prepending or appending entities tooyour stored entities typically results in hello application adding new entities toohello first or last partition of a sequence of partitions.</span></span> <span data-ttu-id="dc5a6-802">In questo caso, tutti gli inserimenti hello in qualsiasi momento vengono eseguite nella stessa partizione, la creazione di un'area sensibile che impedisce che il bilanciamento del carico del servizio tabelle hello inserisce in più nodi hello e causando la scalabilità dell'applicazione toohit hello destinazioni per partizione.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-802">In this case, all of hello inserts at any given time are taking place in hello same partition, creating a hotspot that prevents hello table service from load balancing inserts across multiple nodes, and possibly causing your application toohit hello scalability targets for partition.</span></span> <span data-ttu-id="dc5a6-803">Ad esempio, se si dispone di un'applicazione che accedono a risorse e rete registri dai dipendenti, quindi potrebbe causare una struttura di entità, come illustrato di seguito hello partizione dell'ora corrente diventi un punto di accesso se il volume di hello delle transazioni raggiunge l'obiettivo di scalabilità hello per una singola partizione:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-803">For example, if you have an application that logs network and resource access by employees, then an entity structure as shown below could result in hello current hour's partition becoming a hotspot if hello volume of transactions reaches hello scalability target for an individual partition:</span></span>  

![][26]

#### <a name="solution"></a><span data-ttu-id="dc5a6-804">Soluzione</span><span class="sxs-lookup"><span data-stu-id="dc5a6-804">Solution</span></span>
<span data-ttu-id="dc5a6-805">Hello struttura entità alternativa seguente consente di evitare un'area sensibile in qualsiasi partizione specifica come i log eventi dell'applicazione hello:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-805">hello following alternative entity structure avoids a hotspot on any particular partition as hello application logs events:</span></span>  

![][27]

<span data-ttu-id="dc5a6-806">Si noti con questo esempio come entrambi hello **PartitionKey** e **RowKey** sono chiavi composte.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-806">Notice with this example how both hello **PartitionKey** and **RowKey** are compound keys.</span></span> <span data-ttu-id="dc5a6-807">Hello **PartitionKey** Usa reparto hello e registrazione di hello toodistribute id dipendente tra più partizioni.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-807">hello **PartitionKey** uses both hello department and employee id toodistribute hello logging across multiple partitions.</span></span>  

#### <a name="issues-and-considerations"></a><span data-ttu-id="dc5a6-808">Considerazioni e problemi</span><span class="sxs-lookup"><span data-stu-id="dc5a6-808">Issues and considerations</span></span>
<span data-ttu-id="dc5a6-809">Considerare i seguenti punti quando si decide di hello come tooimplement questo modello:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-809">Consider hello following points when deciding how tooimplement this pattern:</span></span>  

* <span data-ttu-id="dc5a6-810">Fa hello chiave struttura alternativa che evita la creazione di partizioni di frequente operazioni di inserimento in modo efficiente query per il supporto hello rende l'applicazione client?</span><span class="sxs-lookup"><span data-stu-id="dc5a6-810">Does hello alternative key structure that avoids creating hot partitions on inserts efficiently support hello queries your client application makes?</span></span>  
* <span data-ttu-id="dc5a6-811">Il volume previsto di transazioni significa che sono probabilmente tooreach obiettivi di scalabilità hello per una singola partizione e di essere limitate dal servizio di archiviazione hello?</span><span class="sxs-lookup"><span data-stu-id="dc5a6-811">Does your anticipated volume of transactions mean that you are likely tooreach hello scalability targets for an individual partition and be throttled by hello storage service?</span></span>  

#### <a name="when-toouse-this-pattern"></a><span data-ttu-id="dc5a6-812">Quando toouse questo modello</span><span class="sxs-lookup"><span data-stu-id="dc5a6-812">When toouse this pattern</span></span>
<span data-ttu-id="dc5a6-813">Evitare hello accodare o anteporre anti-pattern quando il volume di transazioni è probabilmente tooresult di limitazione dal servizio di archiviazione hello quando si accede a una partizione a caldo.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-813">Avoid hello prepend/append anti-pattern when your volume of transactions is likely tooresult in throttling by hello storage service when you access a hot partition.</span></span>  

#### <a name="related-patterns-and-guidance"></a><span data-ttu-id="dc5a6-814">Modelli correlati e informazioni aggiuntive</span><span class="sxs-lookup"><span data-stu-id="dc5a6-814">Related patterns and guidance</span></span>
<span data-ttu-id="dc5a6-815">Hello modelli e le indicazioni seguenti possono anche essere importanti quando si implementa il pattern di:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-815">hello following patterns and guidance may also be relevant when implementing this pattern:</span></span>  

* [<span data-ttu-id="dc5a6-816">Modello per chiave composta</span><span class="sxs-lookup"><span data-stu-id="dc5a6-816">Compound key pattern</span></span>](#compound-key-pattern)  
* [<span data-ttu-id="dc5a6-817">Modello della parte finale del log</span><span class="sxs-lookup"><span data-stu-id="dc5a6-817">Log tail pattern</span></span>](#log-tail-pattern)  
* [<span data-ttu-id="dc5a6-818">Modifica di entità</span><span class="sxs-lookup"><span data-stu-id="dc5a6-818">Modifying entities</span></span>](#modifying-entities)  

### <a name="log-data-anti-pattern"></a><span data-ttu-id="dc5a6-819">Anti-modello dei dati di log</span><span class="sxs-lookup"><span data-stu-id="dc5a6-819">Log data anti-pattern</span></span>
<span data-ttu-id="dc5a6-820">In genere, è consigliabile utilizzare hello servizio Blob anziché hello dati del log toostore servizio tabella.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-820">Typically, you should use hello Blob service instead of hello Table service toostore log data.</span></span>  

#### <a name="context-and-problem"></a><span data-ttu-id="dc5a6-821">Contesto e problema</span><span class="sxs-lookup"><span data-stu-id="dc5a6-821">Context and problem</span></span>
<span data-ttu-id="dc5a6-822">Caso di utilizzo comune per i dati di log sono tooretrieve una selezione di voci di log per un intervallo di data/ora specifico: ad esempio, si desidera toofind tutti hello messaggi di errore e critico che ha registrato l'applicazione dal 15:04 / 15:06 in una data specifica.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-822">A common use case for log data is tooretrieve a selection of log entries for a specific date/time range: for example, you want toofind all hello error and critical messages that your application logged between 15:04 and 15:06 on a specific date.</span></span> <span data-ttu-id="dc5a6-823">Non si desidera toouse hello data e ora della partizione hello hello log messaggio toodetermine si salva entità log: che i risultati in una partizione di frequente perché in qualsiasi momento, tutte le entità di log hello condivideranno hello stesso **PartitionKey** valore (vedere la sezione hello [accodare o anteporre anti-pattern](#prepend-append-anti-pattern)).</span><span class="sxs-lookup"><span data-stu-id="dc5a6-823">You do not want toouse hello date and time of hello log message toodetermine hello partition you save log entities to: that results in a hot partition because at any given time, all hello log entities will share hello same **PartitionKey** value (see hello section [Prepend/append anti-pattern](#prepend-append-anti-pattern)).</span></span> <span data-ttu-id="dc5a6-824">Ad esempio, hello segue lo schema dell'entità per un messaggio di log comporta una partizione di frequente perché un'applicazione hello scrive tutti i messaggi di log partizione toohello per hello data e ora:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-824">For example, hello following entity schema for a log message results in a hot partition because hello application writes all log messages toohello partition for hello current date and hour:</span></span>  

![][28]

<span data-ttu-id="dc5a6-825">In questo esempio hello **RowKey** include hello data e ora di hello log messaggio tooensure che i messaggi di log vengono archiviati in ordine di data/ora e un id di messaggio nel caso in cui più messaggi di log condividono hello stessa data e ora.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-825">In this example, hello **RowKey** includes hello date and time of hello log message tooensure that log messages are stored sorted in date/time order, and includes a message id in case multiple log messages share hello same date and time.</span></span>  

<span data-ttu-id="dc5a6-826">Un altro approccio consiste toouse un **PartitionKey** che assicura che un'applicazione hello scrive i messaggi in un intervallo di partizioni.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-826">Another approach is toouse a **PartitionKey** that ensures that hello application writes messages across a range of partitions.</span></span> <span data-ttu-id="dc5a6-827">Ad esempio, se origine hello del messaggio registro hello fornisce un modo toodistribute messaggi in più partizioni, è possibile utilizzare hello segue lo schema dell'entità:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-827">For example, if hello source of hello log message provides a way toodistribute messages across many partitions, you could use hello following entity schema:</span></span>  

![][29]

<span data-ttu-id="dc5a6-828">Tuttavia, il problema di hello con questo schema è che tooretrieve tutti i messaggi di log per un periodo di tempo specifico è necessario eseguire la ricerca di hello ogni partizione nella tabella hello.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-828">However, hello problem with this schema is that tooretrieve all hello log messages for a specific time span you must search every partition in hello table.</span></span>

#### <a name="solution"></a><span data-ttu-id="dc5a6-829">Soluzione</span><span class="sxs-lookup"><span data-stu-id="dc5a6-829">Solution</span></span>
<span data-ttu-id="dc5a6-830">Hello precedente sezione evidenziata hello problema di toouse hello voci di log toostore servizio tabella e due, insoddisfacenti suggerito, progettazioni.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-830">hello previous section highlighted hello problem of trying toouse hello Table service toostore log entries and suggested two, unsatisfactory, designs.</span></span> <span data-ttu-id="dc5a6-831">Una soluzione ha portata tooa a caldo di partizione con il rischio di hello di una riduzione delle prestazioni di scrittura di messaggi di log. Hello altre soluzioni ha restituito le prestazioni delle query a causa di hello requisito tooscan ogni partizione in hello tabella tooretrieve log i messaggi per un periodo di tempo specifico.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-831">One solution led tooa hot partition with hello risk of poor performance writing log messages; hello other solution resulted in poor query performance because of hello requirement tooscan every partition in hello table tooretrieve log messages for a specific time span.</span></span> <span data-ttu-id="dc5a6-832">Archiviazione BLOB offre una soluzione migliore per questo tipo di scenario e si tratta di Azure come archiviazione Analitica archivia hello log i dati vengono raccolti.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-832">Blob storage offers a better solution for this type of scenario and this is how Azure Storage Analytics stores hello log data it collects.</span></span>  

<span data-ttu-id="dc5a6-833">Questa sezione descrive come archiviazione Analitica archivia i dati del log nell'archiviazione blob come un'illustrazione di questi dati toostoring approccio che si esegue una query in genere dall'intervallo.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-833">This section outlines how Storage Analytics stores log data in blob storage as an illustration of this approach toostoring data that you typically query by range.</span></span>  

<span data-ttu-id="dc5a6-834">Analisi archiviazione archivia i messaggi di log in un formato delimitato in più BLOB.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-834">Storage Analytics stores log messages in a delimited format in multiple blobs.</span></span> <span data-ttu-id="dc5a6-835">formato delimitato Hello semplifica per un client dati hello tooparse dell'applicazione nel messaggio hello del registro.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-835">hello delimited format makes it easy for a client application tooparse hello data in hello log message.</span></span>  

<span data-ttu-id="dc5a6-836">Archiviazione Analitica utilizza una convenzione di denominazione per i blob che permette di blob hello di toolocate (o BLOB) che contengono messaggi hello del registro che sta cercando.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-836">Storage Analytics uses a naming convention for blobs that enables you toolocate hello blob (or blobs) that contain hello log messages for which you are searching.</span></span> <span data-ttu-id="dc5a6-837">Ad esempio, un blob denominato "queue/2014/07/31/1800/000001.log" contiene i messaggi di log correlati toohello servizio di Accodamento per ora hello a partire da 18:00 del 31 luglio 2014.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-837">For example, a blob named "queue/2014/07/31/1800/000001.log" contains log messages that relate toohello queue service for hello hour starting at 18:00 on 31 July 2014.</span></span> <span data-ttu-id="dc5a6-838">Hello "000001" indica che questo è il primo file di log hello per questo periodo.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-838">hello "000001" indicates that this is hello first log file for this period.</span></span> <span data-ttu-id="dc5a6-839">Archiviazione Analitica registra inoltre innanzitutto hello timestamp di hello e ultimo log i messaggi archiviati nel file hello come parte dei metadati del blob hello.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-839">Storage Analytics also records hello timestamps of hello first and last log messages stored in hello file as part of hello blob's metadata.</span></span> <span data-ttu-id="dc5a6-840">Hello API per consente di archiviazione blob individuare i BLOB in un contenitore in base a un prefisso del nome: toolocate tutti i BLOB contenenti coda hello registrare i dati per ora hello a partire da 18:00, è possibile usare hello prefisso "coda/2014/07/31/1800."</span><span class="sxs-lookup"><span data-stu-id="dc5a6-840">hello API for blob storage enables you locate blobs in a container based on a name prefix: toolocate all hello blobs that contain queue log data for hello hour starting at 18:00, you can use hello prefix "queue/2014/07/31/1800."</span></span>  

<span data-ttu-id="dc5a6-841">Archiviazione Analitica buffer internamente i messaggi di log e quindi aggiorna periodicamente blob appropriato hello o crea uno nuovo con l'ultimo batch di hello di voci di log.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-841">Storage Analytics buffers log messages internally and then periodically updates hello appropriate blob or creates a new one with hello latest batch of log entries.</span></span> <span data-ttu-id="dc5a6-842">Questo riduce il numero di hello servizio blob toohello deve eseguire operazioni di scrittura.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-842">This reduces hello number of writes it must perform toohello blob service.</span></span>  

<span data-ttu-id="dc5a6-843">Se si implementa una soluzione simile nella propria applicazione, è necessario considerare come toomanage hello compromesso tra l'affidabilità (scrittura ogni archiviazione tooblob voce di log in questo caso) e i costi e scalabilità (memorizzazione nel buffer gli aggiornamenti dell'applicazione e memorizzarli tooblob archiviazione in batch).</span><span class="sxs-lookup"><span data-stu-id="dc5a6-843">If you are implementing a similar solution in your own application, you must consider how toomanage hello trade-off between reliability (writing every log entry tooblob storage as it happens) and cost and scalability (buffering updates in your application and writing them tooblob storage in batches).</span></span>  

#### <a name="issues-and-considerations"></a><span data-ttu-id="dc5a6-844">Considerazioni e problemi</span><span class="sxs-lookup"><span data-stu-id="dc5a6-844">Issues and considerations</span></span>
<span data-ttu-id="dc5a6-845">Considerare i seguenti punti quando si decide la modalità di registrazione dei dati toostore hello:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-845">Consider hello following points when deciding how toostore log data:</span></span>  

* <span data-ttu-id="dc5a6-846">Se si crea una progettazione di tabella che consente di evitare potenziali partizioni critiche, è possibile che non si possa accedere ai dati di log in modo efficiente.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-846">If you create a table design that avoids potential hot partitions, you may find that you cannot access your log data efficiently.</span></span>  
* <span data-ttu-id="dc5a6-847">tooprocess registrare i dati, un client deve spesso tooload numero di record.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-847">tooprocess log data, a client often needs tooload many records.</span></span>  
* <span data-ttu-id="dc5a6-848">Nonostante i dati di log siano spesso strutturati, l'archiviazione BLOB può essere una soluzione migliore.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-848">Although log data is often structured, blob storage may be a better solution.</span></span>  

### <a name="implementation-considerations"></a><span data-ttu-id="dc5a6-849">Considerazioni sull'implementazione</span><span class="sxs-lookup"><span data-stu-id="dc5a6-849">Implementation considerations</span></span>
<span data-ttu-id="dc5a6-850">In questa sezione vengono illustrati alcuni toobear considerazioni hello in considerazione quando si implementa il pattern hello descritto nelle sezioni precedenti hello.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-850">This section discusses some of hello considerations toobear in mind when you implement hello patterns described in hello previous sections.</span></span> <span data-ttu-id="dc5a6-851">La maggior parte di questa sezione utilizza esempi scritti in c# che utilizzano la libreria Client di archiviazione (versione 4.3.0 in fase di scrittura di hello) hello.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-851">Most of this section uses examples written in C# that use hello Storage Client Library (version 4.3.0 at hello time of writing).</span></span>  

### <a name="retrieving-entities"></a><span data-ttu-id="dc5a6-852">Recupero di entità</span><span class="sxs-lookup"><span data-stu-id="dc5a6-852">Retrieving entities</span></span>
<span data-ttu-id="dc5a6-853">Come illustrato nella sezione hello [progettazione per l'esecuzione di query](#design-for-querying), query più efficiente hello è un punto.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-853">As discussed in hello section [Design for querying](#design-for-querying), hello most efficient query is a point query.</span></span> <span data-ttu-id="dc5a6-854">Tuttavia, in alcuni scenari potrebbe essere tooretrieve più entità.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-854">However, in some scenarios you may need tooretrieve multiple entities.</span></span> <span data-ttu-id="dc5a6-855">Questa sezione descrive alcune entità di tooretrieving approcci comuni utilizzando hello libreria Client di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-855">This section describes some common approaches tooretrieving entities using hello Storage Client Library.</span></span>  

#### <a name="executing-a-point-query-using-hello-storage-client-library"></a><span data-ttu-id="dc5a6-856">Esegue una query di punto utilizzando hello libreria Client di archiviazione</span><span class="sxs-lookup"><span data-stu-id="dc5a6-856">Executing a point query using hello Storage Client Library</span></span>
<span data-ttu-id="dc5a6-857">tooexecute delle modalità più semplice una query del punto di Hello è hello toouse **recuperare** operazione di tabella, come illustrato nell'hello seguente frammento di codice c# che recupera un'entità con un **PartitionKey** del valore "Sales" e un  **RowKey** del valore "212":</span><span class="sxs-lookup"><span data-stu-id="dc5a6-857">hello easiest way tooexecute a point query is toouse hello **Retrieve** table operation as shown in hello following C# code snippet that retrieves an entity with a **PartitionKey** of value "Sales" and a **RowKey** of value "212":</span></span>  

```csharp
TableOperation retrieveOperation = TableOperation.Retrieve<EmployeeEntity>("Sales", "212");
var retrieveResult = employeeTable.Execute(retrieveOperation);
if (retrieveResult.Result != null)
{
    EmployeeEntity employee = (EmployeeEntity)retrieveResult.Result;
    ...
}  
```

<span data-ttu-id="dc5a6-858">Si noti come entità hello è previsto in questo esempio viene recuperato toobe di tipo **EmployeeEntity**.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-858">Notice how this example expects hello entity it retrieves toobe of type **EmployeeEntity**.</span></span>  

#### <a name="retrieving-multiple-entities-using-linq"></a><span data-ttu-id="dc5a6-859">Recupero di più entità usando LINQ</span><span class="sxs-lookup"><span data-stu-id="dc5a6-859">Retrieving multiple entities using LINQ</span></span>
<span data-ttu-id="dc5a6-860">È possibile recuperare più entità usando LINQ con la libreria client di archiviazione e specificando una query con una clausola **where** .</span><span class="sxs-lookup"><span data-stu-id="dc5a6-860">You can retrieve multiple entities by using LINQ with Storage Client Library and specifying a query with a **where** clause.</span></span> <span data-ttu-id="dc5a6-861">tooavoid una scansione di tabella, è necessario includere sempre hello **PartitionKey** valore hello dove clausola e se possibile hello **RowKey** valore tooavoid scansioni di tabella e di partizione.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-861">tooavoid a table scan, you should always include hello **PartitionKey** value in hello where clause, and if possible hello **RowKey** value tooavoid table and partition scans.</span></span> <span data-ttu-id="dc5a6-862">Hello del servizio tabelle supporta un set limitato di toouse (maggiore di, maggiore o uguale a, minore di, minore o uguale, uguale e non uguale) gli operatori di confronto in hello dove clausola.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-862">hello table service supports a limited set of comparison operators (greater than, greater than or equal, less than, less than or equal, equal, and not equal) toouse in hello where clause.</span></span> <span data-ttu-id="dc5a6-863">Hello seguente frammento di codice c# consente di individuare tutti i dipendenti hello il cui cognome inizia con "B" (presupponendo che hello **RowKey** archivi hello cognome) nel reparto vendite hello (presupponendo che hello **PartitionKey** Archivia il nome di reparto hello):</span><span class="sxs-lookup"><span data-stu-id="dc5a6-863">hello following C# code snippet finds all hello employees whose last name starts with "B" (assuming that hello **RowKey** stores hello last name) in hello sales department (assuming hello **PartitionKey** stores hello department name):</span></span>  

```csharp
TableQuery<EmployeeEntity> employeeQuery = employeeTable.CreateQuery<EmployeeEntity>();
var query = (from employee in employeeQuery
            where employee.PartitionKey == "Sales" &&
            employee.RowKey.CompareTo("B") >= 0 &&
            employee.RowKey.CompareTo("C") < 0
            select employee).AsTableQuery();
var employees = query.Execute();  
```

<span data-ttu-id="dc5a6-864">Si noti come query hello specifica sia un **RowKey** e **PartitionKey** tooensure ottenere prestazioni migliori.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-864">Notice how hello query specifies both a **RowKey** and a **PartitionKey** tooensure better performance.</span></span>  

<span data-ttu-id="dc5a6-865">Hello nell'esempio di codice seguente viene illustrata una funzionalità equivalente utilizzando l'API fluent hello (per ulteriori informazioni sulle API fluent in generale, vedere [le procedure consigliate per la progettazione di un'API intuitiva](http://visualstudiomagazine.com/articles/2013/12/01/best-practices-for-designing-a-fluent-api.aspx)):</span><span class="sxs-lookup"><span data-stu-id="dc5a6-865">hello following code sample shows equivalent functionality using hello fluent API (for more information about fluent APIs in general, see [Best Practices for Designing a Fluent API](http://visualstudiomagazine.com/articles/2013/12/01/best-practices-for-designing-a-fluent-api.aspx)):</span></span>  

```csharp
TableQuery<EmployeeEntity> employeeQuery = new TableQuery<EmployeeEntity>().Where(
    TableQuery.CombineFilters(
    TableQuery.CombineFilters(
        TableQuery.GenerateFilterCondition(
    "PartitionKey", QueryComparisons.Equal, "Sales"),
    TableOperators.And,
    TableQuery.GenerateFilterCondition(
    "RowKey", QueryComparisons.GreaterThanOrEqual, "B")
),
TableOperators.And,
TableQuery.GenerateFilterCondition("RowKey", QueryComparisons.LessThan, "C")
    )
);
var employees = employeeTable.ExecuteQuery(employeeQuery);  
```

> [!NOTE]
> <span data-ttu-id="dc5a6-866">esempio Hello nidifica più **CombineFilters** tooinclude metodi hello tre condizioni di filtro.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-866">hello sample nests multiple **CombineFilters** methods tooinclude hello three filter conditions.</span></span>  
> 
> 

#### <a name="retrieving-large-numbers-of-entities-from-a-query"></a><span data-ttu-id="dc5a6-867">Recupero di un numero elevato di entità da una query</span><span class="sxs-lookup"><span data-stu-id="dc5a6-867">Retrieving large numbers of entities from a query</span></span>
<span data-ttu-id="dc5a6-868">Una query ottimale restituisce una singola entità in base a un valore **PartitionKey** e a un valore **RowKey**.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-868">An optimal query returns an individual entity based on a **PartitionKey** value and a **RowKey** value.</span></span> <span data-ttu-id="dc5a6-869">Tuttavia, in alcuni scenari potrebbe essere un requisito tooreturn molte entità da hello stessa partizione o anche dal numero di partizioni.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-869">However, in some scenarios you may have a requirement tooreturn many entities from hello same partition or even from many partitions.</span></span>  

<span data-ttu-id="dc5a6-870">In questi scenari, è consigliabile testare sempre completamente hello delle prestazioni dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-870">You should always fully test hello performance of your application in such scenarios.</span></span>  

<span data-ttu-id="dc5a6-871">Una query sul servizio tabella hello può restituire un massimo di 1.000 entità contemporaneamente e può essere eseguita per un massimo di cinque secondi.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-871">A query against hello table service may return a maximum of 1,000 entities at one time and may execute for a maximum of five seconds.</span></span> <span data-ttu-id="dc5a6-872">Se il set di risultati hello contiene più di 1.000 entità, se hello query non viene completata entro cinque secondi, o se la query hello supera il limite di partizione hello, hello del servizio tabelle restituisce un tooenable token di continuazione hello hello toorequest di applicazione client set successivo di entità.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-872">If hello result set contains more than 1,000 entities, if hello query did not complete within five seconds, or if hello query crosses hello partition boundary, hello Table service returns a continuation token tooenable hello client application toorequest hello next set of entities.</span></span> <span data-ttu-id="dc5a6-873">Per altre informazioni sul funzionamento dei token di continuazione, vedere [Timeout e paginazione delle query](http://msdn.microsoft.com/library/azure/dd135718.aspx).</span><span class="sxs-lookup"><span data-stu-id="dc5a6-873">For more information about how continuation tokens work, see [Query Timeout and Pagination](http://msdn.microsoft.com/library/azure/dd135718.aspx).</span></span>  

<span data-ttu-id="dc5a6-874">Se si utilizza hello libreria Client di archiviazione, può automaticamente gestire i token di continuazione per l'utente che restituisca le entità da hello del servizio tabelle.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-874">If you are using hello Storage Client Library, it can automatically handle continuation tokens for you as it returns entities from hello Table service.</span></span> <span data-ttu-id="dc5a6-875">Hello c# codice riportato di seguito utilizzando hello libreria Client di archiviazione automaticamente gestisce i token di continuazione del servizio tabelle hello li restituisce in una risposta:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-875">hello following C# code sample using hello Storage Client Library automatically handles continuation tokens if hello table service returns them in a response:</span></span>  

```csharp
string filter = TableQuery.GenerateFilterCondition(
        "PartitionKey", QueryComparisons.Equal, "Sales");
TableQuery<EmployeeEntity> employeeQuery =
        new TableQuery<EmployeeEntity>().Where(filter);

var employees = employeeTable.ExecuteQuery(employeeQuery);
foreach (var emp in employees)
{
        ...
}  
```

<span data-ttu-id="dc5a6-876">codice c# seguente Hello gestisce i token di continuazione in modo esplicito:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-876">hello following C# code handles continuation tokens explicitly:</span></span>  

```csharp
string filter = TableQuery.GenerateFilterCondition(
        "PartitionKey", QueryComparisons.Equal, "Sales");
TableQuery<EmployeeEntity> employeeQuery =
        new TableQuery<EmployeeEntity>().Where(filter);

TableContinuationToken continuationToken = null;

do
{
        var employees = employeeTable.ExecuteQuerySegmented(
        employeeQuery, continuationToken);
    foreach (var emp in employees)
    {
    ...
    }
    continuationToken = employees.ContinuationToken;
} while (continuationToken != null);  
```

<span data-ttu-id="dc5a6-877">Tramite i token di continuazione in modo esplicito, è possibile controllare quando l'applicazione recupera successivo segmento di dati di hello.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-877">By using continuation tokens explicitly, you can control when your application retrieves hello next segment of data.</span></span> <span data-ttu-id="dc5a6-878">Ad esempio, se l'applicazione client consente agli utenti toopage tramite le entità hello archiviati in una tabella, un utente può decidere non toopage tramite tutte le entità hello recuperati dalla query di hello quindi l'applicazione solo utilizzato successivamente un hello tooretrieve token di continuazione segmento quando hello utente ha terminato il paging di tutte le entità hello nel segmento corrente hello.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-878">For example, if your client application enables users toopage through hello entities stored in a table, a user may decide not toopage through all hello entities retrieved by hello query so your application would only use a continuation token tooretrieve hello next segment when hello user had finished paging through all hello entities in hello current segment.</span></span> <span data-ttu-id="dc5a6-879">Questo approccio offre diversi vantaggi:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-879">This approach has several benefits:</span></span>  

* <span data-ttu-id="dc5a6-880">Consente di quantità di hello toolimit di tooretrieve dati dal servizio tabelle hello e che si sposta sulla rete hello.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-880">It enables you toolimit hello amount of data tooretrieve from hello Table service and that you move over hello network.</span></span>  
* <span data-ttu-id="dc5a6-881">In questo modo si tooperform IO asincroni in .NET.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-881">It enables you tooperform asynchronous IO in .NET.</span></span>  
* <span data-ttu-id="dc5a6-882">Consente di archiviazione di token toopersistent tooserialize hello continuazione in modo è possibile continuare in caso di hello di un arresto anomalo dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-882">It enables you tooserialize hello continuation token toopersistent storage so you can continue in hello event of an application crash.</span></span>  

> [!NOTE]
> <span data-ttu-id="dc5a6-883">Un token di continuazione in genere restituisce un segmento contenente al massimo 1.000 entità.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-883">A continuation token typically returns a segment containing 1,000 entities, although it may be fewer.</span></span> <span data-ttu-id="dc5a6-884">Ciò avviene anche hello se si limita il numero di hello di voci di una query restituisce utilizzando **richiedere** tooreturn hello primo n entità che soddisfano i criteri di ricerca: servizio tabella hello può restituire un segmento contenente meno di n entità lungo con un tooenable token di continuazione è tooretrieve hello entità rimanenti.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-884">This is also hello case if you limit hello number of entries a query returns by using **Take** tooreturn hello first n entities that match your lookup criteria: hello table service may return a segment containing fewer than n entities along with a continuation token tooenable you tooretrieve hello remaining entities.</span></span>  
> 
> 

<span data-ttu-id="dc5a6-885">Hello codice c# seguente viene illustrato come numero di hello toomodify di entità restituito all'interno di un segmento:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-885">hello following C# code shows how toomodify hello number of entities returned inside a segment:</span></span>  

```csharp
employeeQuery.TakeCount = 50;  
```

#### <a name="server-side-projection"></a><span data-ttu-id="dc5a6-886">Proiezione lato server</span><span class="sxs-lookup"><span data-stu-id="dc5a6-886">Server-side projection</span></span>
<span data-ttu-id="dc5a6-887">Una singola entità può avere le proprietà too255 e di dimensioni too1 MB.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-887">A single entity can have up too255 properties and be up too1 MB in size.</span></span> <span data-ttu-id="dc5a6-888">Quando si esegue una query tabella hello e recuperare le entità, si potrebbe non essere necessario tutte le proprietà di hello e possibile evitare il trasferimento dei dati inutilmente (toohelp ridurre la latenza e costo).</span><span class="sxs-lookup"><span data-stu-id="dc5a6-888">When you query hello table and retrieve entities, you may not need all hello properties and can avoid transferring data unnecessarily (toohelp reduce latency and cost).</span></span> <span data-ttu-id="dc5a6-889">È possibile utilizzare le proprietà di hello solo tootransfer proiezione sul lato server che è necessario.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-889">You can use server-side projection tootransfer just hello properties you need.</span></span> <span data-ttu-id="dc5a6-890">Hello riportato di seguito è recupera solo hello **posta elettronica** proprietà (insieme a **PartitionKey**, **RowKey**, **Timestamp**e  **ETag**) dalle entità hello selezionata dalla query hello.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-890">hello following example is retrieves just hello **Email** property (along with **PartitionKey**, **RowKey**, **Timestamp**, and **ETag**) from hello entities selected by hello query.</span></span>  

```csharp
string filter = TableQuery.GenerateFilterCondition(
        "PartitionKey", QueryComparisons.Equal, "Sales");
List<string> columns = new List<string>() { "Email" };
TableQuery<EmployeeEntity> employeeQuery =
        new TableQuery<EmployeeEntity>().Where(filter).Select(columns);

var entities = employeeTable.ExecuteQuery(employeeQuery);
foreach (var e in entities)
{
        Console.WriteLine("RowKey: {0}, EmployeeEmail: {1}", e.RowKey, e.Email);
}  
```

<span data-ttu-id="dc5a6-891">Si noti come hello **RowKey** valore è disponibile anche se non è stato incluso nell'elenco di hello di tooretrieve di proprietà.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-891">Notice how hello **RowKey** value is available even though it was not included in hello list of properties tooretrieve.</span></span>  

### <a name="modifying-entities"></a><span data-ttu-id="dc5a6-892">Modifica di entità</span><span class="sxs-lookup"><span data-stu-id="dc5a6-892">Modifying entities</span></span>
<span data-ttu-id="dc5a6-893">Libreria Client di archiviazione Hello consente toomodify le entità archiviate nel servizio di tabella hello da inserimento, eliminazione e aggiornamento di entità.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-893">hello Storage Client Library enables you toomodify your entities stored in hello table service by inserting, deleting, and updating entities.</span></span> <span data-ttu-id="dc5a6-894">È possibile utilizzare EGTs toobatch più insert, update e le operazioni di eliminazione numero hello tooreduce insieme di round trip necessari e migliorare le prestazioni di hello della soluzione.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-894">You can use EGTs toobatch multiple insert, update, and delete operations together tooreduce hello number of round trips required and improve hello performance of your solution.</span></span>  

<span data-ttu-id="dc5a6-895">Si noti che le eccezioni generate quando hello libreria Client di archiviazione viene eseguito un EGT in genere includono indice hello dell'entità di hello che ha provocato hello batch toofail.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-895">Note that exceptions thrown when hello Storage Client Library executes an EGT typically include hello index of hello entity that caused hello batch toofail.</span></span> <span data-ttu-id="dc5a6-896">Ciò è utile quando si esegue il debug di codice che usa le transazioni EGT.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-896">This is helpful when you are debugging code that uses EGTs.</span></span>  

<span data-ttu-id="dc5a6-897">È inoltre opportuno considerare l'influenza della progettazione sul modo in cui l'applicazione gestisce le operazioni di concorrenza e aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-897">You should also consider how your design affects how your client application handles concurrency and update operations.</span></span>  

#### <a name="managing-concurrency"></a><span data-ttu-id="dc5a6-898">Gestione della concorrenza</span><span class="sxs-lookup"><span data-stu-id="dc5a6-898">Managing concurrency</span></span>
<span data-ttu-id="dc5a6-899">Per impostazione predefinita, il servizio di tabella hello implementa i controlli di concorrenza ottimistica a livello di hello di singole entità per **inserire**, **Merge**, e **eliminare** operazioni, Sebbene sia possibile per un messaggi hello del client tooforce tabella toobypass servizio questi controlli.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-899">By default, hello table service implements optimistic concurrency checks at hello level of individual entities for **Insert**, **Merge**, and **Delete** operations, although it is possible for a client tooforce hello table service toobypass these checks.</span></span> <span data-ttu-id="dc5a6-900">Per ulteriori informazioni sulle modalità di gestione della concorrenza del servizio tabelle hello, vedere [gestione della concorrenza in archiviazione di Microsoft Azure](storage-concurrency.md).</span><span class="sxs-lookup"><span data-stu-id="dc5a6-900">For more information about how hello table service manages concurrency, see  [Managing Concurrency in Microsoft Azure Storage](storage-concurrency.md).</span></span>  

#### <a name="merge-or-replace"></a><span data-ttu-id="dc5a6-901">Unione o sostituzione</span><span class="sxs-lookup"><span data-stu-id="dc5a6-901">Merge or replace</span></span>
<span data-ttu-id="dc5a6-902">Hello **sostituire** metodo hello **TableOperation** classe sostituisce sempre un'entità completa hello, hello del servizio tabelle.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-902">hello **Replace** method of hello **TableOperation** class always replaces hello complete entity in hello Table service.</span></span> <span data-ttu-id="dc5a6-903">Se non si include una proprietà nella richiesta di hello quando tale proprietà è presente in entità hello archiviato, richiesta hello rimuove proprietà hello archiviate entità.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-903">If you do not include a property in hello request when that property exists in hello stored entity, hello request removes that property from hello stored entity.</span></span> <span data-ttu-id="dc5a6-904">Se non si desidera tooremove una proprietà in modo esplicito da un'entità archiviata, è necessario includere tutte le proprietà nella richiesta di hello.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-904">Unless you want tooremove a property explicitly from a stored entity, you must include every property in hello request.</span></span>  

<span data-ttu-id="dc5a6-905">È possibile utilizzare hello **Merge** metodo hello **TableOperation** quantità hello tooreduce di classe di dati che si invia servizio tabelle toohello quando si desidera tooupdate un'entità.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-905">You can use hello **Merge** method of hello **TableOperation** class tooreduce hello amount of data that you send toohello Table service when you want tooupdate an entity.</span></span> <span data-ttu-id="dc5a6-906">Hello **Merge** metodo sostituisce qualsiasi proprietà nell'entità hello archiviato con i valori delle proprietà di entità hello incluse nella richiesta di hello, ma lascia invariati qualsiasi proprietà hello archiviati entità che non sono inclusi nella richiesta di hello.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-906">hello **Merge** method replaces any properties in hello stored entity with property values from hello entity included in hello request, but leaves intact any properties in hello stored entity that are not included in hello request.</span></span> <span data-ttu-id="dc5a6-907">Ciò è utile se si dispone di entità di grandi dimensioni ed è solo necessario tooupdate un piccolo numero di proprietà in una richiesta.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-907">This is useful if you have large entities and only need tooupdate a small number of properties in a request.</span></span>  

> [!NOTE]
> <span data-ttu-id="dc5a6-908">Hello **sostituire** e **Merge** metodi hanno esito negativo se hello entità non esiste.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-908">hello **Replace** and **Merge** methods fail if hello entity does not exist.</span></span> <span data-ttu-id="dc5a6-909">In alternativa, è possibile utilizzare hello **InsertOrReplace** e **InsertOrMerge** metodi che creano una nuova entità se non esiste.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-909">As an alternative, you can use hello **InsertOrReplace** and **InsertOrMerge** methods that create a new entity if it doesn't exist.</span></span>  
> 
> 

### <a name="working-with-heterogeneous-entity-types"></a><span data-ttu-id="dc5a6-910">Uso di tipi di entità eterogenei</span><span class="sxs-lookup"><span data-stu-id="dc5a6-910">Working with heterogeneous entity types</span></span>
<span data-ttu-id="dc5a6-911">Hello del servizio tabelle è un *senza schema* archivio tabelle che significa che una singola tabella possa archiviare le entità di più tipi che fornisce una notevole flessibilità nella progettazione.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-911">hello Table service is a *schema-less* table store that means that a single table can store entities of multiple types providing great flexibility in your design.</span></span> <span data-ttu-id="dc5a6-912">Hello seguente esempio viene illustrata una tabella di archiviazione sia dipendente ed entità reparto:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-912">hello following example illustrates a table storing both employee and department entities:</span></span>  

<table>
<tr>
<th><span data-ttu-id="dc5a6-913">PartitionKey</span><span class="sxs-lookup"><span data-stu-id="dc5a6-913">PartitionKey</span></span></th>
<th><span data-ttu-id="dc5a6-914">RowKey</span><span class="sxs-lookup"><span data-stu-id="dc5a6-914">RowKey</span></span></th>
<th><span data-ttu-id="dc5a6-915">Timestamp</span><span class="sxs-lookup"><span data-stu-id="dc5a6-915">Timestamp</span></span></th>
<th></th>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>
<table>
<tr>
<th><span data-ttu-id="dc5a6-916">FirstName</span><span class="sxs-lookup"><span data-stu-id="dc5a6-916">FirstName</span></span></th>
<th><span data-ttu-id="dc5a6-917">LastName</span><span class="sxs-lookup"><span data-stu-id="dc5a6-917">LastName</span></span></th>
<th><span data-ttu-id="dc5a6-918">Age</span><span class="sxs-lookup"><span data-stu-id="dc5a6-918">Age</span></span></th>
<th><span data-ttu-id="dc5a6-919">Email</span><span class="sxs-lookup"><span data-stu-id="dc5a6-919">Email</span></span></th>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</table>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>
<table>
<tr>
<th><span data-ttu-id="dc5a6-920">FirstName</span><span class="sxs-lookup"><span data-stu-id="dc5a6-920">FirstName</span></span></th>
<th><span data-ttu-id="dc5a6-921">LastName</span><span class="sxs-lookup"><span data-stu-id="dc5a6-921">LastName</span></span></th>
<th><span data-ttu-id="dc5a6-922">Age</span><span class="sxs-lookup"><span data-stu-id="dc5a6-922">Age</span></span></th>
<th><span data-ttu-id="dc5a6-923">Email</span><span class="sxs-lookup"><span data-stu-id="dc5a6-923">Email</span></span></th>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</table>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>
<table>
<tr>
<th><span data-ttu-id="dc5a6-924">DepartmentName</span><span class="sxs-lookup"><span data-stu-id="dc5a6-924">DepartmentName</span></span></th>
<th><span data-ttu-id="dc5a6-925">EmployeeCount</span><span class="sxs-lookup"><span data-stu-id="dc5a6-925">EmployeeCount</span></span></th>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</table>
</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>
<table>
<tr>
<th><span data-ttu-id="dc5a6-926">FirstName</span><span class="sxs-lookup"><span data-stu-id="dc5a6-926">FirstName</span></span></th>
<th><span data-ttu-id="dc5a6-927">LastName</span><span class="sxs-lookup"><span data-stu-id="dc5a6-927">LastName</span></span></th>
<th><span data-ttu-id="dc5a6-928">Age</span><span class="sxs-lookup"><span data-stu-id="dc5a6-928">Age</span></span></th>
<th><span data-ttu-id="dc5a6-929">Email</span><span class="sxs-lookup"><span data-stu-id="dc5a6-929">Email</span></span></th>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</table>
</td>
</tr>
</table>

<span data-ttu-id="dc5a6-930">Si noti che ogni entità deve disporre comunque dei valori **PartitionKey**, **RowKey** e **Timestamp**, ma può avere qualsiasi set di proprietà.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-930">Note that each entity must still have **PartitionKey**, **RowKey**, and **Timestamp** values, but may have any set of properties.</span></span> <span data-ttu-id="dc5a6-931">Inoltre, non è hello tooindicate tipo di un'entità, a meno che non si sceglie toostore tali informazioni in un punto.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-931">Furthermore, there is nothing tooindicate hello type of an entity unless you choose toostore that information somewhere.</span></span> <span data-ttu-id="dc5a6-932">Sono disponibili due opzioni per identificare il tipo di entità hello:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-932">There are two options for identifying hello entity type:</span></span>  

* <span data-ttu-id="dc5a6-933">Anteporre hello entità tipo toohello **RowKey** (o eventualmente hello **PartitionKey**).</span><span class="sxs-lookup"><span data-stu-id="dc5a6-933">Prepend hello entity type toohello **RowKey** (or possibly hello **PartitionKey**).</span></span> <span data-ttu-id="dc5a6-934">Ad esempio, **EMPLOYEE_000123** o **DEPARTMENT_SALES** come valori **RowKey**.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-934">For example, **EMPLOYEE_000123** or **DEPARTMENT_SALES** as **RowKey** values.</span></span>  
* <span data-ttu-id="dc5a6-935">Utilizzare un tipo di entità di proprietà separata toorecord hello come illustrato nella tabella hello riportata di seguito.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-935">Use a separate property toorecord hello entity type as shown in hello table below.</span></span>  

<table>
<tr>
<th><span data-ttu-id="dc5a6-936">PartitionKey</span><span class="sxs-lookup"><span data-stu-id="dc5a6-936">PartitionKey</span></span></th>
<th><span data-ttu-id="dc5a6-937">RowKey</span><span class="sxs-lookup"><span data-stu-id="dc5a6-937">RowKey</span></span></th>
<th><span data-ttu-id="dc5a6-938">Timestamp</span><span class="sxs-lookup"><span data-stu-id="dc5a6-938">Timestamp</span></span></th>
<th></th>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>
<table>
<tr>
<th><span data-ttu-id="dc5a6-939">EntityType</span><span class="sxs-lookup"><span data-stu-id="dc5a6-939">EntityType</span></span></th>
<th><span data-ttu-id="dc5a6-940">FirstName</span><span class="sxs-lookup"><span data-stu-id="dc5a6-940">FirstName</span></span></th>
<th><span data-ttu-id="dc5a6-941">LastName</span><span class="sxs-lookup"><span data-stu-id="dc5a6-941">LastName</span></span></th>
<th><span data-ttu-id="dc5a6-942">Age</span><span class="sxs-lookup"><span data-stu-id="dc5a6-942">Age</span></span></th>
<th><span data-ttu-id="dc5a6-943">Email</span><span class="sxs-lookup"><span data-stu-id="dc5a6-943">Email</span></span></th>
</tr>
<tr>
<td><span data-ttu-id="dc5a6-944">Employee</span><span class="sxs-lookup"><span data-stu-id="dc5a6-944">Employee</span></span></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</table>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>
<table>
<tr>
<th><span data-ttu-id="dc5a6-945">EntityType</span><span class="sxs-lookup"><span data-stu-id="dc5a6-945">EntityType</span></span></th>
<th><span data-ttu-id="dc5a6-946">FirstName</span><span class="sxs-lookup"><span data-stu-id="dc5a6-946">FirstName</span></span></th>
<th><span data-ttu-id="dc5a6-947">LastName</span><span class="sxs-lookup"><span data-stu-id="dc5a6-947">LastName</span></span></th>
<th><span data-ttu-id="dc5a6-948">Age</span><span class="sxs-lookup"><span data-stu-id="dc5a6-948">Age</span></span></th>
<th><span data-ttu-id="dc5a6-949">Email</span><span class="sxs-lookup"><span data-stu-id="dc5a6-949">Email</span></span></th>
</tr>
<tr>
<td><span data-ttu-id="dc5a6-950">Employee</span><span class="sxs-lookup"><span data-stu-id="dc5a6-950">Employee</span></span></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</table>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>
<table>
<tr>
<th><span data-ttu-id="dc5a6-951">EntityType</span><span class="sxs-lookup"><span data-stu-id="dc5a6-951">EntityType</span></span></th>
<th><span data-ttu-id="dc5a6-952">DepartmentName</span><span class="sxs-lookup"><span data-stu-id="dc5a6-952">DepartmentName</span></span></th>
<th><span data-ttu-id="dc5a6-953">EmployeeCount</span><span class="sxs-lookup"><span data-stu-id="dc5a6-953">EmployeeCount</span></span></th>
</tr>
<tr>
<td><span data-ttu-id="dc5a6-954">department</span><span class="sxs-lookup"><span data-stu-id="dc5a6-954">Department</span></span></td>
<td></td>
<td></td>
</tr>
</table>
</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td>
<table>
<tr>
<th><span data-ttu-id="dc5a6-955">EntityType</span><span class="sxs-lookup"><span data-stu-id="dc5a6-955">EntityType</span></span></th>
<th><span data-ttu-id="dc5a6-956">FirstName</span><span class="sxs-lookup"><span data-stu-id="dc5a6-956">FirstName</span></span></th>
<th><span data-ttu-id="dc5a6-957">LastName</span><span class="sxs-lookup"><span data-stu-id="dc5a6-957">LastName</span></span></th>
<th><span data-ttu-id="dc5a6-958">Age</span><span class="sxs-lookup"><span data-stu-id="dc5a6-958">Age</span></span></th>
<th><span data-ttu-id="dc5a6-959">Email</span><span class="sxs-lookup"><span data-stu-id="dc5a6-959">Email</span></span></th>
</tr>
<tr>
<td><span data-ttu-id="dc5a6-960">Employee</span><span class="sxs-lookup"><span data-stu-id="dc5a6-960">Employee</span></span></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</table>
</td>
</tr>
</table>

<span data-ttu-id="dc5a6-961">prima opzione Hello, anteponendo hello entità tipo toohello **RowKey**, è utile se è possibile che due entità di tipo diverso potrebbe avere hello stesso valore della chiave.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-961">hello first option, prepending hello entity type toohello **RowKey**, is useful if there is a possibility that two entities of different types might have hello same key value.</span></span> <span data-ttu-id="dc5a6-962">Inoltre, raggruppa entità dello stesso tipo insieme nella partizione hello hello.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-962">It also groups entities of hello same type together in hello partition.</span></span>  

<span data-ttu-id="dc5a6-963">le tecniche descritte in questa sezione Hello sono particolarmente rilevanti toohello discussione [le relazioni di ereditarietà](#inheritance-relationships) più indietro in questa Guida, nella sezione hello [modellazione relazioni](#modelling-relationships).</span><span class="sxs-lookup"><span data-stu-id="dc5a6-963">hello techniques discussed in this section are especially relevant toohello discussion [Inheritance relationships](#inheritance-relationships) earlier in this guide in hello section [Modelling relationships](#modelling-relationships).</span></span>  

> [!NOTE]
> <span data-ttu-id="dc5a6-964">È consigliabile includere un numero di versione nel hello tipo valore tooenable client applicazioni tooevolve POCO oggetti entità e utilizzare versioni diverse.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-964">You should consider including a version number in hello entity type value tooenable client applications tooevolve POCO objects and work with different versions.</span></span>  
> 
> 

<span data-ttu-id="dc5a6-965">Hello resto di questa sezione vengono descritte alcune delle funzionalità di hello hello libreria Client di archiviazione che semplificano l'utilizzo di più tipi di entità in hello stessa tabella.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-965">hello remainder of this section describes some of hello features in hello Storage Client Library that facilitate working with multiple entity types in hello same table.</span></span>  

#### <a name="retrieving-heterogeneous-entity-types"></a><span data-ttu-id="dc5a6-966">Recupero di tipi di entità eterogenei</span><span class="sxs-lookup"><span data-stu-id="dc5a6-966">Retrieving heterogeneous entity types</span></span>
<span data-ttu-id="dc5a6-967">Se si utilizza hello libreria Client di archiviazione, sono disponibili tre opzioni per l'utilizzo di più tipi di entità.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-967">If you are using hello Storage Client Library, you have three options for working with multiple entity types.</span></span>  

<span data-ttu-id="dc5a6-968">Se si conosce il tipo di hello dell'entità hello archiviato con uno specifico **RowKey** e **PartitionKey** valori, è possibile specificare il tipo di entità hello quando si recupera entità hello, come illustrato negli esempi di hello due precedenti che consentono di recuperare le entità di tipo **EmployeeEntity**: [esegue una query di punto utilizzando hello libreria Client di archiviazione](#executing-a-point-query-using-the-storage-client-library) e [il recupero di più entità utilizzando LINQ](#retrieving-multiple-entities-using-linq).</span><span class="sxs-lookup"><span data-stu-id="dc5a6-968">If you know hello type of hello entity stored with a specific **RowKey** and **PartitionKey** values, then you can specify hello entity type when you retrieve hello entity as shown in hello previous two examples that retrieve entities of type **EmployeeEntity**: [Executing a point query using hello Storage Client Library](#executing-a-point-query-using-the-storage-client-library) and [Retrieving multiple entities using LINQ](#retrieving-multiple-entities-using-linq).</span></span>  

<span data-ttu-id="dc5a6-969">seconda opzione Hello è hello toouse **DynamicTableEntity** tipo (un contenitore di proprietà) anziché un tipo di entità POCO concreto (questa opzione può anche migliorare le prestazioni poiché non esiste alcuna necessità tooserialize e deserializzare troppo entità hello. Tipi di rete).</span><span class="sxs-lookup"><span data-stu-id="dc5a6-969">hello second option is toouse hello **DynamicTableEntity** type (a property bag) instead of a concrete POCO entity type (this option may also improve performance because there is no need tooserialize and deserialize hello entity too.NET types).</span></span> <span data-ttu-id="dc5a6-970">Dopo il codice c# potenzialmente Hello recupera più entità di tipo diverso dalla tabella hello, ma restituisce tutte le entità come **DynamicTableEntity** istanze.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-970">hello following C# code potentially retrieves multiple entities of different types from hello table, but returns all entities as **DynamicTableEntity** instances.</span></span> <span data-ttu-id="dc5a6-971">Viene quindi utilizzato hello **EntityType** tipo hello toodetermine di proprietà di ogni entità:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-971">It then uses hello **EntityType** property toodetermine hello type of each entity:</span></span>  

```csharp
string filter = TableQuery.CombineFilters(
    TableQuery.GenerateFilterCondition("PartitionKey",
    QueryComparisons.Equal, "Sales"),
    TableOperators.And,
    TableQuery.CombineFilters(
    TableQuery.GenerateFilterCondition("RowKey",
                    QueryComparisons.GreaterThanOrEqual, "B"),
        TableOperators.And,
        TableQuery.GenerateFilterCondition("RowKey",
        QueryComparisons.LessThan, "F")
    )
);
TableQuery<DynamicTableEntity> entityQuery =
    new TableQuery<DynamicTableEntity>().Where(filter);
var employees = employeeTable.ExecuteQuery(entityQuery);

IEnumerable<DynamicTableEntity> entities = employeeTable.ExecuteQuery(entityQuery);
foreach (var e in entities)
{
EntityProperty entityTypeProperty;
if (e.Properties.TryGetValue("EntityType", out entityTypeProperty))
{
    if (entityTypeProperty.StringValue == "Employee")
    {
        // Use entityTypeProperty, RowKey, PartitionKey, Etag, and Timestamp
        }
    }
}  
```

<span data-ttu-id="dc5a6-972">Si noti che tooretrieve altre proprietà, è necessario utilizzare hello **TryGetValue** metodo hello **proprietà** proprietà di hello **DynamicTableEntity** classe.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-972">Note that tooretrieve other properties you must use hello **TryGetValue** method on hello **Properties** property of hello **DynamicTableEntity** class.</span></span>  

<span data-ttu-id="dc5a6-973">Una terza opzione è toocombine utilizzando hello **DynamicTableEntity** tipo e un **EntityResolver** istanza.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-973">A third option is toocombine using hello **DynamicTableEntity** type and an **EntityResolver** instance.</span></span> <span data-ttu-id="dc5a6-974">In questo modo è tooresolve toomultiple POCO tipi hello stessa query.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-974">This enables you tooresolve toomultiple POCO types in hello same query.</span></span> <span data-ttu-id="dc5a6-975">In questo esempio hello **EntityResolver** delegato utilizza hello **EntityType** toodistinguish proprietà tra i tipi di hello due entità che hello restituite dalla query.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-975">In this example, hello **EntityResolver** delegate is using hello **EntityType** property toodistinguish between hello two types of entity that hello query returns.</span></span> <span data-ttu-id="dc5a6-976">Hello **risolvere** metodo utilizza hello **resolver** delegato tooresolve **DynamicTableEntity** istanze troppo**TableEntity** istanze.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-976">hello **Resolve** method uses hello **resolver** delegate tooresolve **DynamicTableEntity** instances too**TableEntity** instances.</span></span>  

```csharp
EntityResolver<TableEntity> resolver = (pk, rk, ts, props, etag) =>
{

        TableEntity resolvedEntity = null;
        if (props["EntityType"].StringValue == "Department")
        {
        resolvedEntity = new DepartmentEntity();
        }
        else if (props["EntityType"].StringValue == "Employee")
        {
        resolvedEntity = new EmployeeEntity();
        }
        else throw new ArgumentException("Unrecognized entity", "props");

        resolvedEntity.PartitionKey = pk;
        resolvedEntity.RowKey = rk;
        resolvedEntity.Timestamp = ts;
        resolvedEntity.ETag = etag;
        resolvedEntity.ReadEntity(props, null);
        return resolvedEntity;
};

string filter = TableQuery.GenerateFilterCondition(
        "PartitionKey", QueryComparisons.Equal, "Sales");
TableQuery<DynamicTableEntity> entityQuery =
        new TableQuery<DynamicTableEntity>().Where(filter);

var entities = employeeTable.ExecuteQuery(entityQuery, resolver);
foreach (var e in entities)
{
        if (e is DepartmentEntity)
        {
    ...
        }
        if (e is EmployeeEntity)
        {
    ...
        }
}  
```

#### <a name="modifying-heterogeneous-entity-types"></a><span data-ttu-id="dc5a6-977">Modifica dei tipi di entità eterogenei</span><span class="sxs-lookup"><span data-stu-id="dc5a6-977">Modifying heterogeneous entity types</span></span>
<span data-ttu-id="dc5a6-978">Tipo di hello tooknow di toodelete un'entità non è necessario e si desidera conoscere sempre tipo hello di un'entità per l'inserimento.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-978">You do not need tooknow hello type of an entity toodelete it, and you always know hello type of an entity when you insert it.</span></span> <span data-ttu-id="dc5a6-979">Tuttavia, è possibile utilizzare **DynamicTableEntity** digitare tooupdate un'entità senza conoscerne il tipo e senza utilizzare una classe di entità POCO.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-979">However, you can use **DynamicTableEntity** type tooupdate an entity without knowing its type and without using a POCO entity class.</span></span> <span data-ttu-id="dc5a6-980">Hello nell'esempio di codice seguente recupera una singola entità e controlla hello **EmployeeCount** proprietà esiste prima dell'aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-980">hello following code sample retrieves a single entity, and checks hello **EmployeeCount** property exists before updating it.</span></span>  

```csharp
TableResult result =
        employeeTable.Execute(TableOperation.Retrieve(partitionKey, rowKey));
DynamicTableEntity department = (DynamicTableEntity)result.Result;

EntityProperty countProperty;

if (!department.Properties.TryGetValue("EmployeeCount", out countProperty))
{
        throw new
        InvalidOperationException("Invalid entity, EmployeeCount property not found.");
}
countProperty.Int32Value += 1;
employeeTable.Execute(TableOperation.Merge(department));  
```

### <a name="controlling-access-with-shared-access-signatures"></a><span data-ttu-id="dc5a6-981">Controllo dell'accesso con le firme di accesso condiviso</span><span class="sxs-lookup"><span data-stu-id="dc5a6-981">Controlling access with Shared Access Signatures</span></span>
<span data-ttu-id="dc5a6-982">È possibile utilizzare toomodify applicazioni client di firma di accesso condiviso (SAS) token tooenable (e di query) entità tabella direttamente senza hello necessario tooauthenticate direttamente con il servizio tabella hello.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-982">You can use Shared Access Signature (SAS) tokens tooenable client applications toomodify (and query) table entities directly without hello need tooauthenticate directly with hello table service.</span></span> <span data-ttu-id="dc5a6-983">In genere, sono disponibili tre vantaggi principali toousing SAS nell'applicazione:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-983">Typically, there are three main benefits toousing SAS in your application:</span></span>  

* <span data-ttu-id="dc5a6-984">Non è necessario toodistribute lo spazio di archiviazione account tooan chiave di piattaforma non protetta (ad esempio, un dispositivo mobile) in ordine tooallow tooaccess tale dispositivo e modificare le entità nel servizio tabelle hello.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-984">You do not need toodistribute your storage account key tooan insecure platform (such as a mobile device) in order tooallow that device tooaccess and modify entities in hello Table service.</span></span>  
* <span data-ttu-id="dc5a6-985">È possibile trasferire una parte del lavoro hello che web e ruoli di lavoro di eseguire la gestione dei dispositivi tooclient entità, ad esempio computer degli utenti finali e i dispositivi mobili.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-985">You can offload some of hello work that web and worker roles perform in managing your entities tooclient devices such as end-user computers and mobile devices.</span></span>  
* <span data-ttu-id="dc5a6-986">È possibile assegnare un vincolata e set di client tooa autorizzazioni (ad esempio per consentire l'accesso in sola lettura le risorse toospecific) limitate nel tempo.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-986">You can assign a constrained and time limited set of permissions tooa client (such as allowing read-only access toospecific resources).</span></span>  

<span data-ttu-id="dc5a6-987">Per ulteriori informazioni sull'utilizzo di token di firma di accesso condiviso con hello del servizio tabelle, vedere [tramite firme di accesso condiviso (SAS)](storage-dotnet-shared-access-signature-part-1.md).</span><span class="sxs-lookup"><span data-stu-id="dc5a6-987">For more information about using SAS tokens with hello Table service, see [Using Shared Access Signatures (SAS)](storage-dotnet-shared-access-signature-part-1.md).</span></span>  

<span data-ttu-id="dc5a6-988">Tuttavia, è comunque necessario generare token SAS hello che concedono l'entità toohello applicazione nel servizio tabelle hello un client: è necessario farlo in un ambiente che dispone di proteggere l'accesso alle chiavi dell'account di archiviazione tooyour.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-988">However, you must still generate hello SAS tokens that grant a client application toohello entities in hello table service: you should do this in an environment that has secure access tooyour storage account keys.</span></span> <span data-ttu-id="dc5a6-989">In genere, si utilizza un web o lavoro ruolo toogenerate hello SAS token e inviarli toohello le applicazioni client che devono accedere tooyour entità.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-989">Typically, you use a web or worker role toogenerate hello SAS tokens and deliver them toohello client applications that need access tooyour entities.</span></span> <span data-ttu-id="dc5a6-990">Poiché non esiste ancora un overhead coinvolti nella generazione e il recapito tooclients i token di firma di accesso condiviso, è consigliabile tooreduce ottimale questo overhead, specialmente negli scenari con volumi elevati.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-990">Because there is still an overhead involved in generating and delivering SAS tokens tooclients, you should consider how best tooreduce this overhead, especially in high-volume scenarios.</span></span>  

<span data-ttu-id="dc5a6-991">È possibile toogenerate un token di firma di accesso condiviso che concede l'accesso tooa subset di entità hello in una tabella.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-991">It is possible toogenerate a SAS token that grants access tooa subset of hello entities in a table.</span></span> <span data-ttu-id="dc5a6-992">Per impostazione predefinita, si crea un token di firma di accesso condiviso per un'intera tabella, ma è anche possibile toospecify che tooeither di accesso grant token SAS hello un intervallo di **PartitionKey** valori o un intervallo di **PartitionKey** e  **RowKey** valori.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-992">By default, you create a SAS token for an entire table, but it is also possible toospecify that hello SAS token grant access tooeither a range of **PartitionKey** values, or a range of **PartitionKey** and **RowKey** values.</span></span> <span data-ttu-id="dc5a6-993">È possibile scegliere toogenerate i token di firma di accesso condiviso per i singoli utenti del sistema in modo che il token di firma di accesso condiviso di ciascun utente solo consente loro di accedere tootheir entità personalizzate in hello servizio tabelle.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-993">You might choose toogenerate SAS tokens for individual users of your system such that each user's SAS token only allows them access tootheir own entities in hello table service.</span></span>  

### <a name="asynchronous-and-parallel-operations"></a><span data-ttu-id="dc5a6-994">Operazioni asincrone e parallele</span><span class="sxs-lookup"><span data-stu-id="dc5a6-994">Asynchronous and parallel operations</span></span>
<span data-ttu-id="dc5a6-995">A condizione che le richieste vengano distribuite in più partizioni, è possibile migliorare la velocità effettiva e la velocità di risposta del client usando le query parallele o asincrone.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-995">Provided you are spreading your requests across multiple partitions, you can improve throughput and client responsiveness by using asynchronous or parallel queries.</span></span>
<span data-ttu-id="dc5a6-996">Ad esempio, si potrebbero avere due o più istanze del ruolo di lavoro che accedono alle tabelle in parallelo.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-996">For example, you might have two or more worker role instances accessing your tables in parallel.</span></span> <span data-ttu-id="dc5a6-997">È possibile disporre di ruoli di lavoro singole responsabili particolare set di partizioni o semplicemente avere più istanze del ruolo di lavoro, ogni possibile tooaccess tutti hello partizioni in una tabella.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-997">You could have individual worker roles responsible for particular sets of partitions, or simply have multiple worker role instances, each able tooaccess all hello partitions in a table.</span></span>  

<span data-ttu-id="dc5a6-998">All'interno di un'istanza del client, è possibile migliorare la velocità effettiva effettuando operazioni di archiviazione in modo asincrono.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-998">Within a client instance, you can improve throughput by executing storage operations asynchronously.</span></span> <span data-ttu-id="dc5a6-999">Libreria Client di archiviazione Hello rende modifiche e query asincrona toowrite semplice.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-999">hello Storage Client Library makes it easy toowrite asynchronous queries and modifications.</span></span> <span data-ttu-id="dc5a6-1000">Ad esempio, è possibile iniziare con metodo sincrono hello che recupera tutte le entità hello in una partizione, come illustrato nel seguente codice c# di hello:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-1000">For example, you might start with hello synchronous method that retrieves all hello entities in a partition as shown in hello following C# code:</span></span>  

```csharp
private static void ManyEntitiesQuery(CloudTable employeeTable, string department)
{
        string filter = TableQuery.GenerateFilterCondition(
        "PartitionKey", QueryComparisons.Equal, department);
        TableQuery<EmployeeEntity> employeeQuery =
        new TableQuery<EmployeeEntity>().Where(filter);

        TableContinuationToken continuationToken = null;

        do
        {
        var employees = employeeTable.ExecuteQuerySegmented(
                employeeQuery, continuationToken);
        foreach (var emp in employees)
    {
        ...
    }
        continuationToken = employees.ContinuationToken;
        } while (continuationToken != null);
}  
```

<span data-ttu-id="dc5a6-1001">È possibile modificare questo codice facilmente query hello con cui viene eseguito in modo asincrono come indicato di seguito:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-1001">You can easily modify this code so that hello query runs asynchronously as follows:</span></span>  

```csharp
private static async Task ManyEntitiesQueryAsync(CloudTable employeeTable, string department)
{
        string filter = TableQuery.GenerateFilterCondition(
        "PartitionKey", QueryComparisons.Equal, department);
        TableQuery<EmployeeEntity> employeeQuery =
        new TableQuery<EmployeeEntity>().Where(filter);
        TableContinuationToken continuationToken = null;

        do
        {
        var employees = await employeeTable.ExecuteQuerySegmentedAsync(
                employeeQuery, continuationToken);
        foreach (var emp in employees)
        {
            ...
        }
        continuationToken = employees.ContinuationToken;
            } while (continuationToken != null);
}  
```

<span data-ttu-id="dc5a6-1002">In questo esempio asincrono, è possibile visualizzare le modifiche seguenti di hello dalla versione sincrona hello:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-1002">In this asynchronous example, you can see hello following changes from hello synchronous version:</span></span>  

* <span data-ttu-id="dc5a6-1003">firma del metodo Hello include ora hello **async** modificatore e restituisce un **attività** istanza.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-1003">hello method signature now includes hello **async** modifier and returns a **Task** instance.</span></span>  
* <span data-ttu-id="dc5a6-1004">Anziché chiamare hello **ExecuteSegmented** tooretrieve risultati del metodo, hello metodo ora chiamate hello **ExecuteSegmentedAsync** hello metodo e viene utilizzato **await** modificatore tooretrieve comporta in modo asincrono.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-1004">Instead of calling hello **ExecuteSegmented** method tooretrieve results, hello method now calls hello **ExecuteSegmentedAsync** method and uses hello **await** modifier tooretrieve results asynchronously.</span></span>  

<span data-ttu-id="dc5a6-1005">un'applicazione Hello client può chiamare questo metodo più volte (con valori diversi per hello **reparto** parametro), e ogni query verrà eseguita in un thread separato.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-1005">hello client application can call this method multiple times (with different values for hello **department** parameter), and each query will run on a separate thread.</span></span>  

<span data-ttu-id="dc5a6-1006">Si noti che non è una versione asincrona di hello **Execute** metodo hello **TableQuery** classe perché hello **IEnumerable** interfaccia non supporta asincrona enumerazione.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-1006">Note that there is no asynchronous version of hello **Execute** method in hello **TableQuery** class because hello **IEnumerable** interface does not support asynchronous enumeration.</span></span>  

<span data-ttu-id="dc5a6-1007">È inoltre possibile inserire, aggiornare ed eliminare entità in modo asincrono.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-1007">You can also insert, update, and delete entities asynchronously.</span></span> <span data-ttu-id="dc5a6-1008">Hello esempio c# seguente viene illustrato un metodo sincrono, semplice di tooinsert o sostituita un'entità dipendente:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-1008">hello following C# example shows a simple, synchronous method tooinsert or replace an employee entity:</span></span>  

```csharp
private static void SimpleEmployeeUpsert(CloudTable employeeTable,
        EmployeeEntity employee)
{
        TableResult result = employeeTable
        .Execute(TableOperation.InsertOrReplace(employee));
        Console.WriteLine("HTTP Status: {0}", result.HttpStatusCode);
}  
```

<span data-ttu-id="dc5a6-1009">È possibile modificare questo codice facilmente in modo che aggiornamento hello eseguito in modo asincrono come indicato di seguito:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-1009">You can easily modify this code so that hello update runs asynchronously as follows:</span></span>  

```csharp
private static async Task SimpleEmployeeUpsertAsync(CloudTable employeeTable,
        EmployeeEntity employee)
{
        TableResult result = await employeeTable
        .ExecuteAsync(TableOperation.InsertOrReplace(employee));
        Console.WriteLine("HTTP Status: {0}", result.HttpStatusCode);
}  
```

<span data-ttu-id="dc5a6-1010">In questo esempio asincrono, è possibile visualizzare le modifiche seguenti di hello dalla versione sincrona hello:</span><span class="sxs-lookup"><span data-stu-id="dc5a6-1010">In this asynchronous example, you can see hello following changes from hello synchronous version:</span></span>  

* <span data-ttu-id="dc5a6-1011">firma del metodo Hello include ora hello **async** modificatore e restituisce un **attività** istanza.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-1011">hello method signature now includes hello **async** modifier and returns a **Task** instance.</span></span>  
* <span data-ttu-id="dc5a6-1012">Anziché chiamare hello **Execute** entità hello tooupdate del metodo, hello metodo ora chiamate hello **ExecuteAsync** hello metodo e viene utilizzato **await** tooretrieve modificatore risultati in modo asincrono.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-1012">Instead of calling hello **Execute** method tooupdate hello entity, hello method now calls hello **ExecuteAsync** method and uses hello **await** modifier tooretrieve results asynchronously.</span></span>  

<span data-ttu-id="dc5a6-1013">un'applicazione Hello client può chiamare più metodi asincroni come questa, e ogni chiamata al metodo verrà eseguita in un thread separato.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-1013">hello client application can call multiple asynchronous methods like this one, and each method invocation will run on a separate thread.</span></span>  

### <a name="credits"></a><span data-ttu-id="dc5a6-1014">Credits</span><span class="sxs-lookup"><span data-stu-id="dc5a6-1014">Credits</span></span>
<span data-ttu-id="dc5a6-1015">Desideriamo hello toothank segue i membri del team di Azure per il loro contributo hello: Dominic Betts, Jason Hogg, Jean Ghanem, Jai Haridas, Jeff Irwin, Vamshidhar Kommineni, Shah Vinay Serdar Ozler nonché Tom Hollander da DX Microsoft.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-1015">We would like toothank hello following members of hello Azure team for their contributions: Dominic Betts, Jason Hogg, Jean Ghanem, Jai Haridas, Jeff Irwin, Vamshidhar Kommineni, Vinay Shah and Serdar Ozler as well as  Tom Hollander from Microsoft DX.</span></span> 

<span data-ttu-id="dc5a6-1016">Desideriamo anche hello toothank seguente MVP di Microsoft per i commenti e suggerimenti utili durante i cicli di revisione: Igor Papirov e Edward Bakker.</span><span class="sxs-lookup"><span data-stu-id="dc5a6-1016">We would also like toothank hello following Microsoft MVP's for their valuable feedback during review cycles: Igor Papirov and Edward Bakker.</span></span>

[1]: ./media/storage-table-design-guide/storage-table-design-IMAGE01.png
[2]: ./media/storage-table-design-guide/storage-table-design-IMAGE02.png
[3]: ./media/storage-table-design-guide/storage-table-design-IMAGE03.png
[4]: ./media/storage-table-design-guide/storage-table-design-IMAGE04.png
[5]: ./media/storage-table-design-guide/storage-table-design-IMAGE05.png
[6]: ./media/storage-table-design-guide/storage-table-design-IMAGE06.png
[7]: ./media/storage-table-design-guide/storage-table-design-IMAGE07.png
[8]: ./media/storage-table-design-guide/storage-table-design-IMAGE08.png
[9]: ./media/storage-table-design-guide/storage-table-design-IMAGE09.png
[10]: ./media/storage-table-design-guide/storage-table-design-IMAGE10.png
[11]: ./media/storage-table-design-guide/storage-table-design-IMAGE11.png
[12]: ./media/storage-table-design-guide/storage-table-design-IMAGE12.png
[13]: ./media/storage-table-design-guide/storage-table-design-IMAGE13.png
[14]: ./media/storage-table-design-guide/storage-table-design-IMAGE14.png
[15]: ./media/storage-table-design-guide/storage-table-design-IMAGE15.png
[16]: ./media/storage-table-design-guide/storage-table-design-IMAGE16.png
[17]: ./media/storage-table-design-guide/storage-table-design-IMAGE17.png
[18]: ./media/storage-table-design-guide/storage-table-design-IMAGE18.png
[19]: ./media/storage-table-design-guide/storage-table-design-IMAGE19.png
[20]: ./media/storage-table-design-guide/storage-table-design-IMAGE20.png
[21]: ./media/storage-table-design-guide/storage-table-design-IMAGE21.png
[22]: ./media/storage-table-design-guide/storage-table-design-IMAGE22.png
[23]: ./media/storage-table-design-guide/storage-table-design-IMAGE23.png
[24]: ./media/storage-table-design-guide/storage-table-design-IMAGE24.png
[25]: ./media/storage-table-design-guide/storage-table-design-IMAGE25.png
[26]: ./media/storage-table-design-guide/storage-table-design-IMAGE26.png
[27]: ./media/storage-table-design-guide/storage-table-design-IMAGE27.png
[28]: ./media/storage-table-design-guide/storage-table-design-IMAGE28.png
[29]: ./media/storage-table-design-guide/storage-table-design-IMAGE29.png

