---
title: Come risolvere i problemi di Cache Redis di Azure | Microsoft Docs
description: Informazioni su come risolvere problemi comuni di Cache Redis di Azure.
services: redis-cache
documentationcenter: 
author: steved0x
manager: douge
editor: 
ms.assetid: 928b9b9c-d64f-4252-884f-af7ba8309af6
ms.service: cache
ms.workload: tbd
ms.tgt_pltfrm: cache-redis
ms.devlang: na
ms.topic: article
ms.date: 01/06/2017
ms.author: sdanie
ms.openlocfilehash: 2e9d1b644f1e80c7d916a261a6c47fcc11a1ffe0
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 07/11/2017
---
# <a name="how-to-troubleshoot-azure-redis-cache"></a><span data-ttu-id="05bee-103">Come risolvere i problemi di Cache Redis di Azure</span><span class="sxs-lookup"><span data-stu-id="05bee-103">How to troubleshoot Azure Redis Cache</span></span>
<span data-ttu-id="05bee-104">Questo articolo include indicazioni per la risoluzione delle categorie seguenti di problemi di Cache Redis di Azure.</span><span class="sxs-lookup"><span data-stu-id="05bee-104">This article provides guidance for troubleshooting the following categories of Azure Redis Cache issues.</span></span>

* <span data-ttu-id="05bee-105">[Risoluzione dei problemi lato client](#client-side-troubleshooting) : questa sezione fornisce linee guida per identificare e risolvere i problemi causati dall'applicazione che si connette a Cache Redis di Azure.</span><span class="sxs-lookup"><span data-stu-id="05bee-105">[Client side troubleshooting](#client-side-troubleshooting) - This section provides guidelines on identifying and resolving issues caused by the application connecting to Azure Redis Cache.</span></span>
* <span data-ttu-id="05bee-106">[Risoluzione dei problemi lato server](#server-side-troubleshooting) : questa sezione fornisce linee guida per identificare e risolvere i problemi causati sul lato server di Cache Redis di Azure.</span><span class="sxs-lookup"><span data-stu-id="05bee-106">[Server side troubleshooting](#server-side-troubleshooting) - This section provides guidelines on identifying and resolving issues caused on the Azure Redis Cache server side.</span></span>
* <span data-ttu-id="05bee-107">[Eccezioni di timeout di StackExchange.Redis](#stackexchangeredis-timeout-exceptions) : questa sezione fornisce informazioni sulla risoluzione dei problemi quando si usa il client StackExchange.Redis.</span><span class="sxs-lookup"><span data-stu-id="05bee-107">[StackExchange.Redis timeout exceptions](#stackexchangeredis-timeout-exceptions) - This section provides information on troubleshooting issues when using the StackExchange.Redis client.</span></span>

> [!NOTE]
> <span data-ttu-id="05bee-108">Diversi passaggi per la risoluzione dei problemi illustrati in questa guida includono istruzioni per eseguire comandi di Redis e monitorare svariate metriche delle prestazioni.</span><span class="sxs-lookup"><span data-stu-id="05bee-108">Several of the troubleshooting steps in this guide include instructions to run Redis commands and monitor various performance metrics.</span></span> <span data-ttu-id="05bee-109">Per altre informazioni e istruzioni, vedere gli articoli della sezione [Informazioni aggiuntive](#additional-information) .</span><span class="sxs-lookup"><span data-stu-id="05bee-109">For more information and instructions, see the articles in the [Additional information](#additional-information) section.</span></span>
> 
> 

## <a name="client-side-troubleshooting"></a><span data-ttu-id="05bee-110">Risoluzione dei problemi lato client</span><span class="sxs-lookup"><span data-stu-id="05bee-110">Client side troubleshooting</span></span>
<span data-ttu-id="05bee-111">Questa sezione illustra la risoluzione dei problemi che si verificano a causa di una condizione nell'applicazione client.</span><span class="sxs-lookup"><span data-stu-id="05bee-111">This section discusses troubleshooting issues that occur because of a condition on the client application.</span></span>

* [<span data-ttu-id="05bee-112">Utilizzo elevato di memoria nel client</span><span class="sxs-lookup"><span data-stu-id="05bee-112">Memory pressure on the client</span></span>](#memory-pressure-on-the-client)
* [<span data-ttu-id="05bee-113">Burst di traffico</span><span class="sxs-lookup"><span data-stu-id="05bee-113">Burst of traffic</span></span>](#burst-of-traffic)
* [<span data-ttu-id="05bee-114">Utilizzo elevato della CPU client</span><span class="sxs-lookup"><span data-stu-id="05bee-114">High client CPU usage</span></span>](#high-client-cpu-usage)
* [<span data-ttu-id="05bee-115">Larghezza di banda lato client superata</span><span class="sxs-lookup"><span data-stu-id="05bee-115">Client Side Bandwidth Exceeded</span></span>](#client-side-bandwidth-exceeded)
* [<span data-ttu-id="05bee-116">Dimensioni elevate della richiesta/risposta</span><span class="sxs-lookup"><span data-stu-id="05bee-116">Large Request/Response Size</span></span>](#large-requestresponse-size)
* [<span data-ttu-id="05bee-117">Che cosa è successo ai dati in Redis?</span><span class="sxs-lookup"><span data-stu-id="05bee-117">What happened to my data in Redis?</span></span>](#what-happened-to-my-data-in-redis)

### <a name="memory-pressure-on-the-client"></a><span data-ttu-id="05bee-118">Utilizzo elevato di memoria nel client</span><span class="sxs-lookup"><span data-stu-id="05bee-118">Memory pressure on the client</span></span>
#### <a name="problem"></a><span data-ttu-id="05bee-119">Problema</span><span class="sxs-lookup"><span data-stu-id="05bee-119">Problem</span></span>
<span data-ttu-id="05bee-120">L'utilizzo elevato di memoria nel computer client causa tutti i tipi di problemi di prestazioni che possono ritardare l'elaborazione dei dati inviati tempestivamente dall'istanza di Redis.</span><span class="sxs-lookup"><span data-stu-id="05bee-120">Memory pressure on the client machine leads to all kinds of performance problems that can delay processing of data that was sent by the Redis instance without any delay.</span></span> <span data-ttu-id="05bee-121">Quando si verifica un utilizzo elevato di memoria, il sistema in genere deve restituire una pagina di dati dalla memoria fisica alla memoria virtuale su disco.</span><span class="sxs-lookup"><span data-stu-id="05bee-121">When memory pressure hits, the system typically has to page data from physical memory to virtual memory which is on disk.</span></span> <span data-ttu-id="05bee-122">Questo *errore di pagina* causa un rallentamento significativo del sistema.</span><span class="sxs-lookup"><span data-stu-id="05bee-122">This *page faulting* causes the system to slow down significantly.</span></span>

#### <a name="measurement"></a><span data-ttu-id="05bee-123">Misura</span><span class="sxs-lookup"><span data-stu-id="05bee-123">Measurement</span></span>
1. <span data-ttu-id="05bee-124">Monitorare l'utilizzo della memoria nel computer per verificare che non superi la memoria disponibile.</span><span class="sxs-lookup"><span data-stu-id="05bee-124">Monitor memory usage on machine to make sure that it does not exceed available memory.</span></span> 
2. <span data-ttu-id="05bee-125">Monitorare il contatore delle prestazioni `Page Faults/Sec` .</span><span class="sxs-lookup"><span data-stu-id="05bee-125">Monitor the `Page Faults/Sec` performance counter.</span></span> <span data-ttu-id="05bee-126">Poiché la maggior parte dei sistemi presenterà alcuni errori di pagina anche durante il normale funzionamento, controllare i picchi in questo contatore delle prestazioni degli errori di pagina corrispondenti ai timeout.</span><span class="sxs-lookup"><span data-stu-id="05bee-126">Most systems will have some page faults even during normal operation, so watch for spikes in this page faults performance counter which correspond with timeouts.</span></span>

#### <a name="resolution"></a><span data-ttu-id="05bee-127">Risoluzione</span><span class="sxs-lookup"><span data-stu-id="05bee-127">Resolution</span></span>
<span data-ttu-id="05bee-128">Aggiornare il client a una dimensione maggiore della VM client con più memoria o esaminare i modelli di utilizzo della memoria per ridurre il consumo di memoria.</span><span class="sxs-lookup"><span data-stu-id="05bee-128">Upgrade your client to a larger client VM size with more memory or dig into your memory usage patterns to reduce memory consuption.</span></span>

### <a name="burst-of-traffic"></a><span data-ttu-id="05bee-129">Burst di traffico</span><span class="sxs-lookup"><span data-stu-id="05bee-129">Burst of traffic</span></span>
#### <a name="problem"></a><span data-ttu-id="05bee-130">Problema</span><span class="sxs-lookup"><span data-stu-id="05bee-130">Problem</span></span>
<span data-ttu-id="05bee-131">I burst di traffico combinati con impostazioni `ThreadPool` insufficienti possono causare ritardi nell'elaborazione dei dati già inviati dal server Redis, ma non ancora utilizzati sul lato client.</span><span class="sxs-lookup"><span data-stu-id="05bee-131">Bursts of traffic combined with poor `ThreadPool` settings can result in delays in processing data already sent by the Redis Server but not yet consumed on the client side.</span></span>

#### <a name="measurement"></a><span data-ttu-id="05bee-132">Misura</span><span class="sxs-lookup"><span data-stu-id="05bee-132">Measurement</span></span>
<span data-ttu-id="05bee-133">Monitorare il cambiamento delle statistiche `ThreadPool` nel corso del tempo usando un codice [come questo](https://github.com/JonCole/SampleCode/blob/master/ThreadPoolMonitor/ThreadPoolLogger.cs).</span><span class="sxs-lookup"><span data-stu-id="05bee-133">Monitor how your `ThreadPool` statistics change over time using code [like this](https://github.com/JonCole/SampleCode/blob/master/ThreadPoolMonitor/ThreadPoolLogger.cs).</span></span> <span data-ttu-id="05bee-134">È anche possibile esaminare il messaggio `TimeoutException` da StackExchange.Redis.</span><span class="sxs-lookup"><span data-stu-id="05bee-134">You can also look at the `TimeoutException` message from StackExchange.Redis.</span></span> <span data-ttu-id="05bee-135">Di seguito è fornito un esempio:</span><span class="sxs-lookup"><span data-stu-id="05bee-135">Here is an example :</span></span>

    System.TimeoutException: Timeout performing EVAL, inst: 8, mgr: Inactive, queue: 0, qu: 0, qs: 0, qc: 0, wr: 0, wq: 0, in: 64221, ar: 0, 
    IOCP: (Busy=6,Free=999,Min=2,Max=1000), WORKER: (Busy=7,Free=8184,Min=2,Max=8191)

<span data-ttu-id="05bee-136">Nel messaggio precedente sono presenti diversi problemi interessanti:</span><span class="sxs-lookup"><span data-stu-id="05bee-136">In the above message, there are several issues that are interesting:</span></span>

1. <span data-ttu-id="05bee-137">Si noti che nella sezione `IOCP` e nella sezione `WORKER` è presente un valore `Busy` maggiore del valore `Min`.</span><span class="sxs-lookup"><span data-stu-id="05bee-137">Notice that in the `IOCP` section and the `WORKER` section you have a `Busy` value that is greater than the `Min` value.</span></span> <span data-ttu-id="05bee-138">Ciò significa che le impostazioni `ThreadPool` devono essere modificate.</span><span class="sxs-lookup"><span data-stu-id="05bee-138">This means that your `ThreadPool` settings need adjusting.</span></span>
2. <span data-ttu-id="05bee-139">È anche possibile osservare `in: 64221`</span><span class="sxs-lookup"><span data-stu-id="05bee-139">You can also see `in: 64221`.</span></span> <span data-ttu-id="05bee-140">che indica che sono stati ricevuti 64211 byte a livello di socket kernel, che però non sono ancora stati letti dall'applicazione, ad esempio StackExchange.Redis.</span><span class="sxs-lookup"><span data-stu-id="05bee-140">This indicates that 64211 bytes have been received at the kernel socket layer but haven't yet been read by the application (e.g. StackExchange.Redis).</span></span> <span data-ttu-id="05bee-141">Ciò significa in genere che l'applicazione non legge i dati dalla rete con la stessa velocità con cui li invia il server.</span><span class="sxs-lookup"><span data-stu-id="05bee-141">This typically means that your application isn't reading data from the network as quickly as the server is sending it to you.</span></span>

#### <a name="resolution"></a><span data-ttu-id="05bee-142">Risoluzione</span><span class="sxs-lookup"><span data-stu-id="05bee-142">Resolution</span></span>
<span data-ttu-id="05bee-143">Configurare le [impostazioni ThreadPool](https://gist.github.com/JonCole/e65411214030f0d823cb) per essere certi che il pool di thread aumenterà rapidamente le prestazioni negli scenari di burst.</span><span class="sxs-lookup"><span data-stu-id="05bee-143">Configure your [ThreadPool Settings](https://gist.github.com/JonCole/e65411214030f0d823cb) to make sure that your thread pool will scale up quickly under burst scenarios.</span></span>

### <a name="high-client-cpu-usage"></a><span data-ttu-id="05bee-144">Utilizzo elevato della CPU client</span><span class="sxs-lookup"><span data-stu-id="05bee-144">High client CPU usage</span></span>
#### <a name="problem"></a><span data-ttu-id="05bee-145">Problema</span><span class="sxs-lookup"><span data-stu-id="05bee-145">Problem</span></span>
<span data-ttu-id="05bee-146">L'utilizzo elevato della CPU nel client indica che il sistema non riesce a gestire il lavoro che gli viene chiesto di eseguire.</span><span class="sxs-lookup"><span data-stu-id="05bee-146">High CPU usage on the client is an indication that the system cannot keep up with the work that it has been asked to perform.</span></span> <span data-ttu-id="05bee-147">Ciò significa che il client potrebbe non riuscire a elaborare tempestivamente una risposta da Redis anche se Redis ha inviato la risposta molto rapidamente.</span><span class="sxs-lookup"><span data-stu-id="05bee-147">This means that the client may fail to process a response from Redis in a timely fashion even though Redis sent the response very quickly.</span></span>

#### <a name="measurement"></a><span data-ttu-id="05bee-148">Misura</span><span class="sxs-lookup"><span data-stu-id="05bee-148">Measurement</span></span>
<span data-ttu-id="05bee-149">Monitorare l'utilizzo della CPU a livello di sistema tramite il portale di Azure o il contatore delle prestazioni associato.</span><span class="sxs-lookup"><span data-stu-id="05bee-149">Monitor the System Wide CPU usage through the Azure Portal or through the associated performance counter.</span></span> <span data-ttu-id="05bee-150">Prestare attenzione a non monitorare la CPU del *processo* perché un singolo processo può avere un utilizzo della CPU basso, ma contemporaneamente l'utilizzo della CPU di sistema complessiva può essere elevato.</span><span class="sxs-lookup"><span data-stu-id="05bee-150">Be careful not to monitor *process* CPU because a single process can have low CPU usage at the same time that overall system CPU can be high.</span></span> <span data-ttu-id="05bee-151">Cercare nell'utilizzo della CPU i picchi corrispondenti ai timeout.</span><span class="sxs-lookup"><span data-stu-id="05bee-151">Watch for spikes in CPU usage that correspond with timeouts.</span></span> <span data-ttu-id="05bee-152">Con un utilizzo elevato della CPU, è anche possibile osservare valori `in: XXX` elevati nei messaggi di errore `TimeoutException`, come illustrato nelle sezione [Burst di traffico](#burst-of-traffic).</span><span class="sxs-lookup"><span data-stu-id="05bee-152">As a result of high CPU, you may also see high `in: XXX` values in `TimeoutException` error messages as described in the [Burst of traffic](#burst-of-traffic) section.</span></span>

> [!NOTE]
> <span data-ttu-id="05bee-153">StackExchange.Redis 1.1.603 e versioni successive includono la metrica `local-cpu` nei messaggi di errore `TimeoutException`.</span><span class="sxs-lookup"><span data-stu-id="05bee-153">StackExchange.Redis 1.1.603 and later includes the `local-cpu` metric in `TimeoutException` error messages.</span></span> <span data-ttu-id="05bee-154">Assicurarsi di usare la versione più recente del [pacchetto NuGet StackExchange.Redis](https://www.nuget.org/packages/StackExchange.Redis/).</span><span class="sxs-lookup"><span data-stu-id="05bee-154">Ensure you using the latest version of the [StackExchange.Redis NuGet package](https://www.nuget.org/packages/StackExchange.Redis/).</span></span> <span data-ttu-id="05bee-155">È importante avere la versione più recente perché i bug del codice vengono continuamente fissati per renderlo più solido in caso di timeout.</span><span class="sxs-lookup"><span data-stu-id="05bee-155">There are bugs constantly being fixed in the code to make it more robust to timeouts so having the latest version is important.</span></span>
> 
> 

#### <a name="resolution"></a><span data-ttu-id="05bee-156">Risoluzione</span><span class="sxs-lookup"><span data-stu-id="05bee-156">Resolution</span></span>
<span data-ttu-id="05bee-157">Eseguire l'aggiornamento a una dimensione maggiore della VM con più capacità di CPU o verificare la causa dei picchi della CPU.</span><span class="sxs-lookup"><span data-stu-id="05bee-157">Upgrade to a larger VM size with more CPU capacity or investigate what is causing CPU spikes.</span></span> 

### <a name="client-side-bandwidth-exceeded"></a><span data-ttu-id="05bee-158">Larghezza di banda lato client superata</span><span class="sxs-lookup"><span data-stu-id="05bee-158">Client side bandwidth exceeded</span></span>
#### <a name="problem"></a><span data-ttu-id="05bee-159">Problema</span><span class="sxs-lookup"><span data-stu-id="05bee-159">Problem</span></span>
<span data-ttu-id="05bee-160">Esistono limitazioni alla quantità di larghezza di banda disponibile per computer client con dimensioni diverse.</span><span class="sxs-lookup"><span data-stu-id="05bee-160">Different sized client machines have limitations on how much network bandwidth they have available.</span></span> <span data-ttu-id="05bee-161">Se il client supera la larghezza di banda disponibile, i dati non verranno elaborati sul lato client con la stessa velocità con cui il server li invia.</span><span class="sxs-lookup"><span data-stu-id="05bee-161">If the client exceeds the available bandwidth, then data will not be processed on the client side as quickly as the server is sending it.</span></span> <span data-ttu-id="05bee-162">Ciò può causare un timeout.</span><span class="sxs-lookup"><span data-stu-id="05bee-162">This can lead to timeouts.</span></span>

#### <a name="measurement"></a><span data-ttu-id="05bee-163">Misura</span><span class="sxs-lookup"><span data-stu-id="05bee-163">Measurement</span></span>
<span data-ttu-id="05bee-164">Monitorare il cambiamento dell'utilizzo della larghezza di banda nel corso del tempo usando un codice [come questo](https://github.com/JonCole/SampleCode/blob/master/BandWidthMonitor/BandwidthLogger.cs).</span><span class="sxs-lookup"><span data-stu-id="05bee-164">Monitor how your Bandwidth usage change over time using code [like this](https://github.com/JonCole/SampleCode/blob/master/BandWidthMonitor/BandwidthLogger.cs).</span></span> <span data-ttu-id="05bee-165">Si noti che non è possibile eseguire correttamente questo codice in alcuni ambienti con autorizzazioni con restrizioni (ad esempio, i siti Web Azure).</span><span class="sxs-lookup"><span data-stu-id="05bee-165">Note that this code may not run successfully in some environments with restricted permissions (like Azure web sites).</span></span>

#### <a name="resolution"></a><span data-ttu-id="05bee-166">Risoluzione</span><span class="sxs-lookup"><span data-stu-id="05bee-166">Resolution</span></span>
<span data-ttu-id="05bee-167">Aumentare le dimensioni della VM client o ridurre il consumo di larghezza di banda di rete.</span><span class="sxs-lookup"><span data-stu-id="05bee-167">Increase Client VM size or reduce network bandwidth consumption.</span></span>

### <a name="large-requestresponse-size"></a><span data-ttu-id="05bee-168">Dimensioni elevate della richiesta/risposta</span><span class="sxs-lookup"><span data-stu-id="05bee-168">Large Request/Response Size</span></span>
#### <a name="problem"></a><span data-ttu-id="05bee-169">Problema</span><span class="sxs-lookup"><span data-stu-id="05bee-169">Problem</span></span>
<span data-ttu-id="05bee-170">Una richiesta/risposta di grandi dimensioni può causare un timeout.</span><span class="sxs-lookup"><span data-stu-id="05bee-170">A large request/response can cause timeouts.</span></span> <span data-ttu-id="05bee-171">Si supponga, ad esempio, che il valore di timeout configurato nel client sia di 1 secondo.</span><span class="sxs-lookup"><span data-stu-id="05bee-171">As an example, Suppose your timeout value configured on your client is 1 second.</span></span> <span data-ttu-id="05bee-172">L'applicazione richiede due chiavi, ad esempio "A" e "B", nello stesso momento, usando la stessa connessione di rete fisica.</span><span class="sxs-lookup"><span data-stu-id="05bee-172">Your application requests two keys (e.g. 'A' and 'B') at the same time (using the same physical network connection).</span></span> <span data-ttu-id="05bee-173">La maggior parte dei client supporta il "pipelining" delle richieste, in modo che entrambe le richieste "A" e "B" vengano inviate in rete al server una dopo l'altra senza attendere le risposte.</span><span class="sxs-lookup"><span data-stu-id="05bee-173">Most clients support "Pipelining" of requests, such that both requests 'A' and 'B' are sent on the wire to the server one after the other without waiting for the responses.</span></span> <span data-ttu-id="05bee-174">Il server invierà le risposte nello stesso ordine.</span><span class="sxs-lookup"><span data-stu-id="05bee-174">The server will send the responses back in the same order.</span></span> <span data-ttu-id="05bee-175">Se la risposta "A" è di dimensioni piuttosto grandi, può usare la maggior parte del timeout per le richieste successive.</span><span class="sxs-lookup"><span data-stu-id="05bee-175">If response 'A' is large enough it can eat up most of the timeout for subsequent requests.</span></span> 

<span data-ttu-id="05bee-176">L'esempio seguente illustra questo scenario.</span><span class="sxs-lookup"><span data-stu-id="05bee-176">The following example demonstrates this scenario.</span></span> <span data-ttu-id="05bee-177">In questo scenario le richieste "A" e "B" vengono inviate rapidamente, il server inizia a inviare rapidamente le risposte "A" e "B", ma a causa dei tempi di trasferimento dati, "B" si blocca dietro l'altra richiesta e si verifica il timeout anche se il server ha risposto rapidamente.</span><span class="sxs-lookup"><span data-stu-id="05bee-177">In this scenario, Request 'A' and 'B' are sent quickly, the server starts sending responses 'A' and 'B' quickly, but because of data transfer times, 'B' get stuck behind the other request and times out even though the server responded quickly.</span></span>

    |-------- 1 Second Timeout (A)----------|
    |-Request A-|
         |-------- 1 Second Timeout (B) ----------|
         |-Request B-|
                |- Read Response A --------|
                                           |- Read Response B-| (**TIMEOUT**)



#### <a name="measurement"></a><span data-ttu-id="05bee-178">Misura</span><span class="sxs-lookup"><span data-stu-id="05bee-178">Measurement</span></span>
<span data-ttu-id="05bee-179">Non è semplice risolvere questo problema.</span><span class="sxs-lookup"><span data-stu-id="05bee-179">This is a difficult one to measure.</span></span> <span data-ttu-id="05bee-180">Essenzialmente è necessario instrumentare il codice client per tenere traccia di richieste e risposte di grandi dimensioni.</span><span class="sxs-lookup"><span data-stu-id="05bee-180">You basically have to instrument your client code to track large requests and responses.</span></span> 

#### <a name="resolution"></a><span data-ttu-id="05bee-181">Risoluzione</span><span class="sxs-lookup"><span data-stu-id="05bee-181">Resolution</span></span>
1. <span data-ttu-id="05bee-182">Redis è ottimizzato per molti valori bassi, invece che per pochi valori elevati.</span><span class="sxs-lookup"><span data-stu-id="05bee-182">Redis is optimized for a large number of small values, rather than a few large values.</span></span> <span data-ttu-id="05bee-183">La soluzione migliore consiste nel dividere i dati in valori più bassi correlati.</span><span class="sxs-lookup"><span data-stu-id="05bee-183">The preferred solution is to break up your data into related smaller values.</span></span> <span data-ttu-id="05bee-184">Vedere il post in cui viene chiesto [qual è l'intervallo di dimensioni dei valori ideale per Redis e se 100 KB sono troppi](https://groups.google.com/forum/#!searchin/redis-db/size/redis-db/n7aa2A4DZDs/3OeEPHSQBAAJ) per una spiegazione dettagliata del perché siano preferibili valori più bassi.</span><span class="sxs-lookup"><span data-stu-id="05bee-184">See the [What is the ideal value size range for redis? Is 100KB too large?](https://groups.google.com/forum/#!searchin/redis-db/size/redis-db/n7aa2A4DZDs/3OeEPHSQBAAJ) post for details around why smaller values are recommended.</span></span>
2. <span data-ttu-id="05bee-185">Aumentare le dimensioni della VM (per il client e per il server Cache Redis), per ottenere capacità di larghezza di banda maggiori, riducendo i tempi di trasferimento dati per le risposte più grandi.</span><span class="sxs-lookup"><span data-stu-id="05bee-185">Increase the size of your VM (for client and Redis Cache Server), to get higher bandwidth capabilities, reducing data transfer times for larger responses.</span></span> <span data-ttu-id="05bee-186">Si noti che una larghezza di banda maggiore solo sul server o solo sul client potrebbe non essere sufficiente.</span><span class="sxs-lookup"><span data-stu-id="05bee-186">Note that getting more bandwidth on just the server or just on the client may not be enough.</span></span> <span data-ttu-id="05bee-187">Misurare l'utilizzo della larghezza di banda e confrontarlo con le capacità delle dimensioni della VM attuali.</span><span class="sxs-lookup"><span data-stu-id="05bee-187">Measure your bandwidth usage and compare it to the capabilities of the size of VM you currently have.</span></span>
3. <span data-ttu-id="05bee-188">Aumentare il numero di oggetti `ConnectionMultiplexer` usati ed eseguire il round robin delle richieste su connessioni diverse.</span><span class="sxs-lookup"><span data-stu-id="05bee-188">Increase the number of `ConnectionMultiplexer` objects you use and round-robin requests over different connections.</span></span>

### <a name="what-happened-to-my-data-in-redis"></a><span data-ttu-id="05bee-189">Che cosa è successo ai dati in Redis?</span><span class="sxs-lookup"><span data-stu-id="05bee-189">What happened to my data in Redis?</span></span>
#### <a name="problem"></a><span data-ttu-id="05bee-190">Problema</span><span class="sxs-lookup"><span data-stu-id="05bee-190">Problem</span></span>
<span data-ttu-id="05bee-191">Si era previsto di trovare determinati dati nell'istanza di Cache Redis di Azure, ma sembra che non sia così.</span><span class="sxs-lookup"><span data-stu-id="05bee-191">I expected for certain data to be in my Azure Redis Cache instance but it didn't seem to be there.</span></span>

#### <a name="resolution"></a><span data-ttu-id="05bee-192">Risoluzione</span><span class="sxs-lookup"><span data-stu-id="05bee-192">Resolution</span></span>
<span data-ttu-id="05bee-193">Vedere [Che cosa è successo ai dati in Redis?](https://gist.github.com/JonCole/b6354d92a2d51c141490f10142884ea4#file-whathappenedtomydatainredis-md) per le possibili cause e risoluzioni.</span><span class="sxs-lookup"><span data-stu-id="05bee-193">See [What happened to my data in Redis?](https://gist.github.com/JonCole/b6354d92a2d51c141490f10142884ea4#file-whathappenedtomydatainredis-md) for possible causes and resolutions.</span></span>

## <a name="server-side-troubleshooting"></a><span data-ttu-id="05bee-194">Risoluzione dei problemi lato server</span><span class="sxs-lookup"><span data-stu-id="05bee-194">Server side troubleshooting</span></span>
<span data-ttu-id="05bee-195">Questa sezione illustra la risoluzione dei problemi che si verificano a causa di una condizione nel server di cache.</span><span class="sxs-lookup"><span data-stu-id="05bee-195">This section discusses troubleshooting issues that occur because of a condition on the cache server.</span></span>

* [<span data-ttu-id="05bee-196">Utilizzo elevato di memoria nel server</span><span class="sxs-lookup"><span data-stu-id="05bee-196">Memory Pressure on the server</span></span>](#memory-pressure-on-the-server)
* [<span data-ttu-id="05bee-197">Utilizzo della CPU/carico del server elevato</span><span class="sxs-lookup"><span data-stu-id="05bee-197">High CPU usage / Server Load</span></span>](#high-cpu-usage-server-load)
* [<span data-ttu-id="05bee-198">Larghezza di banda lato server superata</span><span class="sxs-lookup"><span data-stu-id="05bee-198">Server Side Bandwidth Exceeded</span></span>](#server-side-bandwidth-exceeded)

### <a name="memory-pressure-on-the-server"></a><span data-ttu-id="05bee-199">Utilizzo elevato di memoria nel server</span><span class="sxs-lookup"><span data-stu-id="05bee-199">Memory Pressure on the server</span></span>
#### <a name="problem"></a><span data-ttu-id="05bee-200">Problema</span><span class="sxs-lookup"><span data-stu-id="05bee-200">Problem</span></span>
<span data-ttu-id="05bee-201">L'utilizzo elevato di memoria sul lato server causa tutti i tipi di problemi di prestazioni che possono ritardare l'elaborazione delle richieste.</span><span class="sxs-lookup"><span data-stu-id="05bee-201">Memory pressure on the server side leads to all kinds of performance problems that can delay processing of requests.</span></span> <span data-ttu-id="05bee-202">Quando si verifica un utilizzo elevato di memoria, il sistema in genere deve restituire una pagina di dati dalla memoria fisica alla memoria virtuale su disco.</span><span class="sxs-lookup"><span data-stu-id="05bee-202">When memory pressure hits, the system typically has to page data from physical memory to virtual memory which is on disk.</span></span> <span data-ttu-id="05bee-203">Questo *errore di pagina* causa un rallentamento significativo del sistema.</span><span class="sxs-lookup"><span data-stu-id="05bee-203">This *page faulting* causes the system to slow down significantly.</span></span> <span data-ttu-id="05bee-204">Le possibili cause di questo utilizzo elevato di memoria sono diverse:</span><span class="sxs-lookup"><span data-stu-id="05bee-204">There are several possible causes of this memory pressure:</span></span> 

1. <span data-ttu-id="05bee-205">Sono stati inseriti dati nella cache fino a esaurirne la capacità.</span><span class="sxs-lookup"><span data-stu-id="05bee-205">You have filled the cache to full capacity with data.</span></span> 
2. <span data-ttu-id="05bee-206">Redis sta osservando un'elevata frammentazione della memoria che molto spesso è causata dall'archiviazione di oggetti di grandi dimensioni, mentre Redis è ottimizzato per oggetti di piccole dimensioni. Vedere il post in cui viene chiesto [qual è l'intervallo di dimensioni dei valori ideale per Redis e se 100 KB sono troppi](https://groups.google.com/forum/#!searchin/redis-db/size/redis-db/n7aa2A4DZDs/3OeEPHSQBAAJ) per i dettagli.</span><span class="sxs-lookup"><span data-stu-id="05bee-206">Redis is seeing high memory fragmentation - most often caused by storing large objects (Redis is optimized for a small objects - See the [What is the ideal value size range for redis? Is 100KB too large?](https://groups.google.com/forum/#!searchin/redis-db/size/redis-db/n7aa2A4DZDs/3OeEPHSQBAAJ) post for details).</span></span> 

#### <a name="measurement"></a><span data-ttu-id="05bee-207">Misura</span><span class="sxs-lookup"><span data-stu-id="05bee-207">Measurement</span></span>
<span data-ttu-id="05bee-208">Redis espone due metriche che consentono di identificare questo problema.</span><span class="sxs-lookup"><span data-stu-id="05bee-208">Redis exposes two metrics that can help you identify this issue.</span></span> <span data-ttu-id="05bee-209">La prima è `used_memory` e l'altra è `used_memory_rss`.</span><span class="sxs-lookup"><span data-stu-id="05bee-209">The first is `used_memory` and the other is `used_memory_rss`.</span></span> <span data-ttu-id="05bee-210">[Queste metriche](cache-how-to-monitor.md#available-metrics-and-reporting-intervals) sono disponibili nel portale di Azure o tramite il comando [Redis INFO](http://redis.io/commands/info).</span><span class="sxs-lookup"><span data-stu-id="05bee-210">[These metrics](cache-how-to-monitor.md#available-metrics-and-reporting-intervals) are available in the Azure Portal or through the [Redis INFO](http://redis.io/commands/info) command.</span></span>

#### <a name="resolution"></a><span data-ttu-id="05bee-211">Risoluzione</span><span class="sxs-lookup"><span data-stu-id="05bee-211">Resolution</span></span>
<span data-ttu-id="05bee-212">È possibile apportare diverse modifiche che consentono di mantenere integro l'utilizzo della memoria:</span><span class="sxs-lookup"><span data-stu-id="05bee-212">There are several possible changes that you can make to help keep memory usage healthy:</span></span>

1. <span data-ttu-id="05bee-213">[Configurare un criterio per la memoria](cache-configure.md#maxmemory-policy-and-maxmemory-reserved) e impostare scadenze per le chiavi.</span><span class="sxs-lookup"><span data-stu-id="05bee-213">[Configure a memory policy](cache-configure.md#maxmemory-policy-and-maxmemory-reserved) and set expiration times on your keys.</span></span> <span data-ttu-id="05bee-214">Si noti che questa risoluzione potrebbe non essere sufficiente in caso di frammentazione.</span><span class="sxs-lookup"><span data-stu-id="05bee-214">Note that this may not be sufficient if you have fragmentation.</span></span>
2. <span data-ttu-id="05bee-215">[Configurare un valore maxmemory-reserved](cache-configure.md#maxmemory-policy-and-maxmemory-reserved) abbastanza grande da compensare la frammentazione della memoria.</span><span class="sxs-lookup"><span data-stu-id="05bee-215">[Configure a maxmemory-reserved value](cache-configure.md#maxmemory-policy-and-maxmemory-reserved) that is large enough to compensate for memory fragmentation.</span></span>
3. <span data-ttu-id="05bee-216">Suddividere gli oggetti di grandi dimensioni memorizzati nella cache in oggetti correlati più piccoli.</span><span class="sxs-lookup"><span data-stu-id="05bee-216">Break up your large cached objects into smaller related objects.</span></span>
4. <span data-ttu-id="05bee-217">[Passare](cache-how-to-scale.md) a una dimensione della cache maggiore.</span><span class="sxs-lookup"><span data-stu-id="05bee-217">[Scale](cache-how-to-scale.md) to a larger cache size.</span></span>
5. <span data-ttu-id="05bee-218">Se si usa una [cache Premium con il cluster Redis abilitato](cache-how-to-premium-clustering.md), è possibile [aumentare il numero di partizioni](cache-how-to-premium-clustering.md#change-the-cluster-size-on-a-running-premium-cache).</span><span class="sxs-lookup"><span data-stu-id="05bee-218">If you are using a [premium cache with Redis cluster enabled](cache-how-to-premium-clustering.md) you can [increase the number of shards](cache-how-to-premium-clustering.md#change-the-cluster-size-on-a-running-premium-cache).</span></span>

### <a name="high-cpu-usage--server-load"></a><span data-ttu-id="05bee-219">Utilizzo della CPU/carico del server elevato</span><span class="sxs-lookup"><span data-stu-id="05bee-219">High CPU usage / Server Load</span></span>
#### <a name="problem"></a><span data-ttu-id="05bee-220">Problema</span><span class="sxs-lookup"><span data-stu-id="05bee-220">Problem</span></span>
<span data-ttu-id="05bee-221">Un utilizzo elevato della CPU può significare che il lato client può non riuscire a elaborare tempestivamente una risposta da Redis anche se Redis ha inviato la risposta molto rapidamente.</span><span class="sxs-lookup"><span data-stu-id="05bee-221">High CPU usage can mean that the client side can fail to process a response from Redis in a timely fashion even though Redis sent the response very quickly.</span></span>

#### <a name="measurement"></a><span data-ttu-id="05bee-222">Misura</span><span class="sxs-lookup"><span data-stu-id="05bee-222">Measurement</span></span>
<span data-ttu-id="05bee-223">Monitorare l'utilizzo della CPU a livello di sistema tramite il portale di Azure o il contatore delle prestazioni associato.</span><span class="sxs-lookup"><span data-stu-id="05bee-223">Monitor the System Wide CPU usage through the Azure Portal or through the associated performance counter.</span></span> <span data-ttu-id="05bee-224">Prestare attenzione a non monitorare la CPU del *processo* perché un singolo processo può avere un utilizzo della CPU basso, ma contemporaneamente l'utilizzo della CPU di sistema complessiva può essere elevato.</span><span class="sxs-lookup"><span data-stu-id="05bee-224">Be careful not to monitor *process* CPU because a single process can have low CPU usage at the same time that overall system CPU can be high.</span></span> <span data-ttu-id="05bee-225">Cercare nell'utilizzo della CPU i picchi corrispondenti ai timeout.</span><span class="sxs-lookup"><span data-stu-id="05bee-225">Watch for spikes in CPU usage that correspond with timeouts.</span></span>

#### <a name="resolution"></a><span data-ttu-id="05bee-226">Risoluzione</span><span class="sxs-lookup"><span data-stu-id="05bee-226">Resolution</span></span>
<span data-ttu-id="05bee-227">[Passare](cache-how-to-scale.md) a un piano superiore per la cache con più capacità di CPU o verificare la causa dei picchi della CPU.</span><span class="sxs-lookup"><span data-stu-id="05bee-227">[Scale](cache-how-to-scale.md) to a larger cache tier with more CPU capacity or investigate what is causing CPU spikes.</span></span> 

### <a name="server-side-bandwidth-exceeded"></a><span data-ttu-id="05bee-228">Larghezza di banda lato server superata</span><span class="sxs-lookup"><span data-stu-id="05bee-228">Server Side Bandwidth Exceeded</span></span>
#### <a name="problem"></a><span data-ttu-id="05bee-229">Problema</span><span class="sxs-lookup"><span data-stu-id="05bee-229">Problem</span></span>
<span data-ttu-id="05bee-230">Esistono limitazioni alla quantità di larghezza di banda disponibile per le istanze della cache con dimensioni diverse.</span><span class="sxs-lookup"><span data-stu-id="05bee-230">Different sized cache instances have limitations on how much network bandwidth they have available.</span></span> <span data-ttu-id="05bee-231">Se il server supera la larghezza di banda disponibile, i dati non verranno inviati al client altrettanto rapidamente.</span><span class="sxs-lookup"><span data-stu-id="05bee-231">If the server exceeds the available bandwidth, then data will not be sent to the client as quickly.</span></span> <span data-ttu-id="05bee-232">Ciò può causare un timeout.</span><span class="sxs-lookup"><span data-stu-id="05bee-232">This can lead to timeouts.</span></span>

#### <a name="measurement"></a><span data-ttu-id="05bee-233">Misura</span><span class="sxs-lookup"><span data-stu-id="05bee-233">Measurement</span></span>
<span data-ttu-id="05bee-234">È possibile monitorare la metrica `Cache Read` , ovvero la quantità di dati letti dalla cache in megabyte al secondo (MB/s) durante l'intervallo di report specificato.</span><span class="sxs-lookup"><span data-stu-id="05bee-234">You can monitor the `Cache Read` metric, which is the amount of data read from the cache in Megabytes per second (MB/s) during the specified reporting interval.</span></span> <span data-ttu-id="05bee-235">Questo valore corrisponde alla larghezza di banda della rete usata da questa cache.</span><span class="sxs-lookup"><span data-stu-id="05bee-235">This value corresponds to the network bandwidth used by this cache.</span></span> <span data-ttu-id="05bee-236">Per configurare avvisi per i limiti della larghezza di banda della rete lato server, è possibile crearli usando questo contatore `Cache Read` .</span><span class="sxs-lookup"><span data-stu-id="05bee-236">If you want to set up alerts for server side network bandwidth limits, you can create them using this `Cache Read` counter.</span></span> <span data-ttu-id="05bee-237">Confrontare le letture con i valori in [questa tabella](cache-faq.md#cache-performance) per i limiti della larghezza di banda osservati nei diversi piani tariffari e nelle varie dimensioni della cache.</span><span class="sxs-lookup"><span data-stu-id="05bee-237">Compare your readings with the values in [this table](cache-faq.md#cache-performance) for the observed bandwidth limits for various cache pricing tiers and sizes.</span></span>

#### <a name="resolution"></a><span data-ttu-id="05bee-238">Risoluzione</span><span class="sxs-lookup"><span data-stu-id="05bee-238">Resolution</span></span>
<span data-ttu-id="05bee-239">Se si è quasi sempre vicini alla larghezza di banda massima osservata per il piano tariffario e le dimensioni della cache, considerare la possibilità di [passare](cache-how-to-scale.md) a un piano tariffario o a dimensioni con un piano tariffario di rete maggiore, usando i valori di [questa tabella](cache-faq.md#cache-performance) come riferimento.</span><span class="sxs-lookup"><span data-stu-id="05bee-239">If you are consistently near the observed maximum bandwidth for your pricing tier and cache size, consider [scaling](cache-how-to-scale.md) to a pricing tier or size that has greater network bandwidth, using the values in [this table](cache-faq.md#cache-performance) as a guide.</span></span>

## <a name="stackexchangeredis-timeout-exceptions"></a><span data-ttu-id="05bee-240">Eccezioni di timeout di StackExchange.Redis</span><span class="sxs-lookup"><span data-stu-id="05bee-240">StackExchange.Redis timeout exceptions</span></span>
<span data-ttu-id="05bee-241">StackExchange.Redis usa un'impostazione di configurazione denominata `synctimeout` per le operazioni sincrone, che ha un valore predefinito di 1000 ms.</span><span class="sxs-lookup"><span data-stu-id="05bee-241">StackExchange.Redis uses a configuration setting named `synctimeout` for synchronous operations which has a default value  of 1000 ms.</span></span> <span data-ttu-id="05bee-242">Se una chiamata sincrona non viene completata nel tempo stabilito, il client StackExchange.Redis genera un errore di timeout simile all'esempio seguente.</span><span class="sxs-lookup"><span data-stu-id="05bee-242">If a synchronous call doesn’t complete in the stipulated time, the StackExchange.Redis client throws a timeout error similar to the following example.</span></span>

    System.TimeoutException: Timeout performing MGET 2728cc84-58ae-406b-8ec8-3f962419f641, inst: 1,mgr: Inactive, queue: 73, qu=6, qs=67, qc=0, wr=1/1, in=0/0 IOCP: (Busy=6, Free=999, Min=2,Max=1000), WORKER (Busy=7,Free=8184,Min=2,Max=8191)


<span data-ttu-id="05bee-243">Questo messaggio di errore contiene metriche che consentono di trovare la causa e la possibile risoluzione del problema.</span><span class="sxs-lookup"><span data-stu-id="05bee-243">This error message contains metrics that can help point you to the cause and possible resolution of the issue.</span></span> <span data-ttu-id="05bee-244">La tabella seguente contiene i dettagli delle metriche del messaggio di errore.</span><span class="sxs-lookup"><span data-stu-id="05bee-244">The following table contains details about the error message metrics.</span></span>

| <span data-ttu-id="05bee-245">Metrica del messaggio di errore</span><span class="sxs-lookup"><span data-stu-id="05bee-245">Error message metric</span></span> | <span data-ttu-id="05bee-246">Dettagli</span><span class="sxs-lookup"><span data-stu-id="05bee-246">Details</span></span> |
| --- | --- |
| <span data-ttu-id="05bee-247">inst</span><span class="sxs-lookup"><span data-stu-id="05bee-247">inst</span></span> |<span data-ttu-id="05bee-248">Nell'ultimo periodo di tempo sono stati eseguiti 0 comandi.</span><span class="sxs-lookup"><span data-stu-id="05bee-248">In the last time slice: 0 commands have been issued</span></span> |
| <span data-ttu-id="05bee-249">mgr</span><span class="sxs-lookup"><span data-stu-id="05bee-249">mgr</span></span> |<span data-ttu-id="05bee-250">Il gestore socket sta eseguendo `socket.select`, ovvero sta chiedendo al sistema operativo di indicare un socket con operazioni da eseguire. In sostanza, il lettore non sta attivamente leggendo dalla rete perché non ritiene che ci siano operazioni da eseguire.</span><span class="sxs-lookup"><span data-stu-id="05bee-250">The socket manager is performing `socket.select` which means it is asking the OS to indicate a socket that has something to do; basically: the reader is not actively reading from the network because it doesn't think there is anything to do</span></span> |
| <span data-ttu-id="05bee-251">coda</span><span class="sxs-lookup"><span data-stu-id="05bee-251">queue</span></span> |<span data-ttu-id="05bee-252">In totale sono in corso 73 operazioni.</span><span class="sxs-lookup"><span data-stu-id="05bee-252">There are 73 total in-progress operations</span></span> |
| <span data-ttu-id="05bee-253">qu</span><span class="sxs-lookup"><span data-stu-id="05bee-253">qu</span></span> |<span data-ttu-id="05bee-254">6 delle operazioni in corso sono nella coda degli elementi non inviati e non sono ancora state scritte nella rete in uscita.</span><span class="sxs-lookup"><span data-stu-id="05bee-254">6 of the in-progress operations are in the unsent queue and have not yet been written to the outbound network</span></span> |
| <span data-ttu-id="05bee-255">qs</span><span class="sxs-lookup"><span data-stu-id="05bee-255">qs</span></span> |<span data-ttu-id="05bee-256">67 delle operazioni in corso sono state inviate al server, ma non è ancora disponibile una risposta.</span><span class="sxs-lookup"><span data-stu-id="05bee-256">67 of he in-progress operations have been sent to the server but a response is not yet available.</span></span> <span data-ttu-id="05bee-257">La risposta può essere `Not yet sent by the server` o `sent by the server but not yet processed by the client.`</span><span class="sxs-lookup"><span data-stu-id="05bee-257">The response could be `Not yet sent by the server` or `sent by the server but not yet processed by the client.`</span></span> |
| <span data-ttu-id="05bee-258">qc</span><span class="sxs-lookup"><span data-stu-id="05bee-258">qc</span></span> |<span data-ttu-id="05bee-259">0 delle operazioni in corso hanno avuto risposta, ma non sono ancora state contrassegnate come completate perché sono in attesa del ciclo di completamento.</span><span class="sxs-lookup"><span data-stu-id="05bee-259">0 of the in-progress operations have seen replies but have not yet been marked as complete due to waiting on the completion loop</span></span> |
| <span data-ttu-id="05bee-260">wr</span><span class="sxs-lookup"><span data-stu-id="05bee-260">wr</span></span> |<span data-ttu-id="05bee-261">C'è un writer attivo (che significa che le 6 richieste non inviate non verranno ignorate). Vengono indicati i byte per writer attivo.</span><span class="sxs-lookup"><span data-stu-id="05bee-261">There is an active writer (meaning the 6 unsent requests are not being ignored) bytes/activewriters</span></span> |
| <span data-ttu-id="05bee-262">iniziare</span><span class="sxs-lookup"><span data-stu-id="05bee-262">in</span></span> |<span data-ttu-id="05bee-263">Non ci sono lettori attivi e sono disponibili zero byte da leggere nella scheda di interfaccia di rete. Vengono indicati i byte per lettore attivo.</span><span class="sxs-lookup"><span data-stu-id="05bee-263">There are no active readers and zero bytes are available to be read on the NIC bytes/activereaders</span></span> |

### <a name="steps-to-investigate"></a><span data-ttu-id="05bee-264">Passaggi di verifica</span><span class="sxs-lookup"><span data-stu-id="05bee-264">Steps to investigate</span></span>
1. <span data-ttu-id="05bee-265">Come procedura consigliata, verificare di usare il modello seguente per connettersi quando si usa il client StackExchange.Redis.</span><span class="sxs-lookup"><span data-stu-id="05bee-265">As a best practice make sure you are using the following pattern to connect when using the StackExchange.Redis client.</span></span>

    ```c#
    private static Lazy<ConnectionMultiplexer> lazyConnection = new Lazy<ConnectionMultiplexer>(() =>
    {
        return ConnectionMultiplexer.Connect("cachename.redis.cache.windows.net,abortConnect=false,ssl=true,password=...");
    
    });
    
    public static ConnectionMultiplexer Connection
    {
        get
        {
            return lazyConnection.Value;
        }
    }
    ````

    <span data-ttu-id="05bee-266">Per altre informazioni, vedere [Connettersi alla cache usando StackExchange.Redis](cache-dotnet-how-to-use-azure-redis-cache.md#connect-to-the-cache).</span><span class="sxs-lookup"><span data-stu-id="05bee-266">For more information, see [Connect to the cache using StackExchange.Redis](cache-dotnet-how-to-use-azure-redis-cache.md#connect-to-the-cache).</span></span>

1. <span data-ttu-id="05bee-267">Assicurarsi che Cache Redis di Azure e l'applicazione client siano nella stessa area di Azure.</span><span class="sxs-lookup"><span data-stu-id="05bee-267">Ensure that your Azure Redis Cache and the client application are in the same region in Azure.</span></span> <span data-ttu-id="05bee-268">È possibile ad esempio, che si verifichino timeout quando la cache è negli Stati Uniti orientali, ma il client è negli Stati Uniti occidentali e la richiesta non viene completata entro l'intervallo `synctimeout` oppure è possibile che si verifichino timeout quando si esegue il debug dal computer di sviluppo locale.</span><span class="sxs-lookup"><span data-stu-id="05bee-268">For example, you might be getting timeouts when your cache is in East US but the client is in West US and the request doesn't complete within the `synctimeout` interval or you might be getting timeouts when you are debugging from your local development machine.</span></span> 
   
    <span data-ttu-id="05bee-269">È consigliabile avere la cache e il client nella stessa area di Azure.</span><span class="sxs-lookup"><span data-stu-id="05bee-269">It’s highly recommended to have the cache and in the client in the same Azure region.</span></span> <span data-ttu-id="05bee-270">Nel caso di uno scenario che include chiamate da più aree, è consigliabile impostare l'intervallo `synctimeout` su un valore maggiore dell'intervallo predefinito di 1000 ms includendo una proprietà `synctimeout` nella stringa di connessione.</span><span class="sxs-lookup"><span data-stu-id="05bee-270">If you have a scenario that includes cross region calls, you should set the `synctimeout` interval to a value higher than the default 1000 ms interval by including a `synctimeout` property in the connection string.</span></span> <span data-ttu-id="05bee-271">L'esempio seguente illustra un frammento della stringa di connessione alla cache StackExchange.Redis con un valore `synctimeout` di 2000 ms.</span><span class="sxs-lookup"><span data-stu-id="05bee-271">The following example shows a StackExchange.Redis cache connection string snippet with a `synctimeout` of 2000 ms.</span></span>
   
        synctimeout=2000,cachename.redis.cache.windows.net,abortConnect=false,ssl=true,password=...
2. <span data-ttu-id="05bee-272">Assicurarsi di usare la versione più recente del [pacchetto NuGet StackExchange.Redis](https://www.nuget.org/packages/StackExchange.Redis/).</span><span class="sxs-lookup"><span data-stu-id="05bee-272">Ensure you using the latest version of the [StackExchange.Redis NuGet package](https://www.nuget.org/packages/StackExchange.Redis/).</span></span> <span data-ttu-id="05bee-273">È importante avere la versione più recente perché i bug del codice vengono continuamente fissati per renderlo più solido in caso di timeout.</span><span class="sxs-lookup"><span data-stu-id="05bee-273">There are bugs constantly being fixed in the code to make it more robust to timeouts so having the latest version is important.</span></span>
3. <span data-ttu-id="05bee-274">Se nel server o nel client sono presenti richieste soggette a limitazioni di larghezza di banda, il completamento di queste richieste sarà più lungo e di conseguenza potrebbero verificarsi dei timeout.</span><span class="sxs-lookup"><span data-stu-id="05bee-274">If there are requests that are getting bound by bandwidth limitations on the server or client, it will take longer for them to complete and thereby cause timeouts.</span></span> <span data-ttu-id="05bee-275">Per verificare se il timeout è causato dalla larghezza di banda di rete nel server, vedere [Larghezza di banda lato server superata](#server-side-bandwidth-exceeded).</span><span class="sxs-lookup"><span data-stu-id="05bee-275">To see if your timeout is due to network bandwidth on the server, see [Server side bandwidth exceeded](#server-side-bandwidth-exceeded).</span></span> <span data-ttu-id="05bee-276">Per verificare se il timeout è causato dalla larghezza di banda di rete nel client, vedere [Larghezza di banda lato client superata](#client-side-bandwidth-exceeded).</span><span class="sxs-lookup"><span data-stu-id="05bee-276">To see if your timeout is due to client network bandwidth, see [Client side bandwidth exceeded](#client-side-bandwidth-exceeded).</span></span>
4. <span data-ttu-id="05bee-277">Esistono limiti per la CPU nel server o nel client?</span><span class="sxs-lookup"><span data-stu-id="05bee-277">Are you getting CPU bound on the server or on the client?</span></span>
   
   * <span data-ttu-id="05bee-278">Controllare se esistono limiti per la CPU nel client che possono causare la mancata elaborazione della richiesta entro l'intervallo `synctimeout` , provocando così un timeout.</span><span class="sxs-lookup"><span data-stu-id="05bee-278">Check if you are getting bound by CPU on your client which could cause the request to not be processed within the `synctimeout` interval, thus causing a timeout.</span></span> <span data-ttu-id="05bee-279">Per controllare questo problema, passare a dimensioni maggiori per il client o distribuire il carico.</span><span class="sxs-lookup"><span data-stu-id="05bee-279">Moving to a larger client size or distributing the load can help to control this.</span></span> 
   * <span data-ttu-id="05bee-280">Controllare se esistono limiti per la CPU nel server monitorando la [metrica delle prestazioni della cache](cache-how-to-monitor.md#available-metrics-and-reporting-intervals) `CPU`.</span><span class="sxs-lookup"><span data-stu-id="05bee-280">Check if you are getting CPU bound on the server by monitoring the `CPU` [cache performance metric](cache-how-to-monitor.md#available-metrics-and-reporting-intervals).</span></span> <span data-ttu-id="05bee-281">Le richieste in arrivo mentre Redis è limitato dalla CPU possono causare il timeout di tali richieste.</span><span class="sxs-lookup"><span data-stu-id="05bee-281">Requests coming in while Redis is CPU bound can cause those requests to timeout.</span></span> <span data-ttu-id="05bee-282">Per risolvere il problema, è possibile distribuire il carico tra più partizioni in una cache Premium o eseguire l'aggiornamento a dimensioni o a un piano tariffario superiore.</span><span class="sxs-lookup"><span data-stu-id="05bee-282">To address this you can distribute the load across multiple shards in a premium cache, or upgrade to a larger size or pricing tier.</span></span> <span data-ttu-id="05bee-283">Per altre informazioni, vedere [Larghezza di banda lato server superata](#server-side-bandwidth-exceeded).</span><span class="sxs-lookup"><span data-stu-id="05bee-283">For more information, see [Server Side Bandwidth Exceeded](#server-side-bandwidth-exceeded).</span></span>
5. <span data-ttu-id="05bee-284">Ci sono comandi la cui elaborazione nel server richiede molto tempo?</span><span class="sxs-lookup"><span data-stu-id="05bee-284">Are there commands taking long time to process on the server?</span></span> <span data-ttu-id="05bee-285">I comandi con esecuzione di lunga durata la cui elaborazione richiede molto tempo nel server Redis possono causare timeout.</span><span class="sxs-lookup"><span data-stu-id="05bee-285">Long running commands that are taking long time to process on the redis-server can cause timeouts.</span></span> <span data-ttu-id="05bee-286">Alcuni esempi di comandi con esecuzione di lunga durata sono `mget` con numeri di chiave elevati, `keys *` o script lua scritti in modo inadeguato.</span><span class="sxs-lookup"><span data-stu-id="05bee-286">Some examples of long running commands are `mget` with large numbers of keys, `keys *` or poorly written lua scripts.</span></span> <span data-ttu-id="05bee-287">È possibile connettersi all'istanza di Cache Redis di Azure usando il client redis-cli o usare la [console Redis](cache-configure.md#redis-console) ed eseguire il comando [SlowLog](http://redis.io/commands/slowlog) per verificare se sono presenti richieste che richiedono più tempo del previsto.</span><span class="sxs-lookup"><span data-stu-id="05bee-287">You can connect to your Azure Redis Cache instance using the redis-cli client or use the [Redis Console](cache-configure.md#redis-console) and run the [SlowLog](http://redis.io/commands/slowlog) command to see if there are requests taking longer than expected.</span></span> <span data-ttu-id="05bee-288">Il server Redis e StackExchange.Redis sono ottimizzati per numerose richieste di piccole dimensioni invece che per meno richieste di grandi dimensioni.</span><span class="sxs-lookup"><span data-stu-id="05bee-288">Redis Server and StackExchange.Redis are optimized for many small requests rather than fewer large requests.</span></span> <span data-ttu-id="05bee-289">Dividere i dati in blocchi più piccoli può facilitare le operazioni.</span><span class="sxs-lookup"><span data-stu-id="05bee-289">Splitting your data into smaller chunks may improve things here.</span></span> 
   
    <span data-ttu-id="05bee-290">Per informazioni sulla connessione all'endpoint SSL di Cache Redis di Azure con redis-cli e stunnel, vedere il post di blog contenente l' [Annuncio della versione di anteprima del provider di stato della sessione ASP.NET per Redis](http://blogs.msdn.com/b/webdev/archive/2014/05/12/announcing-asp-net-session-state-provider-for-redis-preview-release.aspx) .</span><span class="sxs-lookup"><span data-stu-id="05bee-290">For information on connecting to the Azure Redis Cache SSL endpoint using redis-cli and stunnel, see the [Announcing ASP.NET Session State Provider for Redis Preview Release](http://blogs.msdn.com/b/webdev/archive/2014/05/12/announcing-asp-net-session-state-provider-for-redis-preview-release.aspx) blog post.</span></span> <span data-ttu-id="05bee-291">Per altre informazioni, vedere [SlowLog](http://redis.io/commands/slowlog).</span><span class="sxs-lookup"><span data-stu-id="05bee-291">For more information, see [SlowLog](http://redis.io/commands/slowlog).</span></span>
6. <span data-ttu-id="05bee-292">Un carico del server Redis elevato può causare timeout.</span><span class="sxs-lookup"><span data-stu-id="05bee-292">High Redis server load can cause timeouts.</span></span> <span data-ttu-id="05bee-293">È possibile monitorare il carico del server monitorando la [metrica delle prestazioni della cache](cache-how-to-monitor.md#available-metrics-and-reporting-intervals) `Redis Server Load`.</span><span class="sxs-lookup"><span data-stu-id="05bee-293">You can monitor the server load by monitoring the `Redis Server Load` [cache performance metric](cache-how-to-monitor.md#available-metrics-and-reporting-intervals).</span></span> <span data-ttu-id="05bee-294">Un carico del server pari a 100 (valore massimo) indica che il server Redis è stato occupato, senza tempo di inattività, a elaborare le richieste.</span><span class="sxs-lookup"><span data-stu-id="05bee-294">A server load of 100 (maximum value) signifies that the redis server has been busy, with no idle time, processing requests.</span></span> <span data-ttu-id="05bee-295">Per verificare se determinate richieste stanno esaurendo la capacità del server, eseguire il comando SlowLog, come descritto nel paragrafo precedente.</span><span class="sxs-lookup"><span data-stu-id="05bee-295">To see if certain requests are taking up all of the server capability, run the SlowLog command, as described in the previous paragraph.</span></span> <span data-ttu-id="05bee-296">Per altre informazioni, vedere [Utilizzo della CPU/carico del server elevato](#high-cpu-usage-server-load).</span><span class="sxs-lookup"><span data-stu-id="05bee-296">For more information, see [High CPU usage / Server Load](#high-cpu-usage-server-load).</span></span>
7. <span data-ttu-id="05bee-297">Si sono verificati altri eventi sul lato client che potrebbero aver causato un problema di rete?</span><span class="sxs-lookup"><span data-stu-id="05bee-297">Was there any other event on the client side that could have caused a network blip?</span></span> <span data-ttu-id="05bee-298">Controllare nel client (Web, ruolo di lavoro o VM Iaas) se si è verificato un evento, ad esempio l'aumento o la riduzione del numero di istanze client o la distribuzione di una nuova versione del client o se è abilitato il ridimensionamento automatico. Nel test è stato scoperto che il ridimensionamento automatico o il passaggio a un piano superiore/inferiore può causare la perdita della connettività di rete per diversi secondi.</span><span class="sxs-lookup"><span data-stu-id="05bee-298">Check on the client (web, worker role or an Iaas VM) if there was an event like scaling the number of client instances up or down, or deploying a new version of the client or auto-scale is enabled?In our testing we have found that autoscale or scaling up/down can cause outbound network connectivity can be lost for several seconds.</span></span> <span data-ttu-id="05bee-299">Il codice StackExchange.Redis è resiliente a tali eventi ed eseguirà una nuova connessione.</span><span class="sxs-lookup"><span data-stu-id="05bee-299">StackExchange.Redis code is resilient to such events and will reconnect.</span></span> <span data-ttu-id="05bee-300">Durante la riconnessione può verificarsi il timeout delle richieste nella coda.</span><span class="sxs-lookup"><span data-stu-id="05bee-300">During this time of re-connection any requests in the queue can time out.</span></span>
8. <span data-ttu-id="05bee-301">Si è verificato il timeout di una richiesta di grandi dimensioni che precedeva diverse richieste di piccole dimensioni a Cache Redis?</span><span class="sxs-lookup"><span data-stu-id="05bee-301">Was there a big request preceding several small requests to the Redis Cache that timed out?</span></span> <span data-ttu-id="05bee-302">Il parametro `qs` nel messaggio di errore indica quante richieste sono state inviate dal client al server, ma non hanno ancora elaborato una risposta.</span><span class="sxs-lookup"><span data-stu-id="05bee-302">The parameter `qs` in the error message tells you how many requests were sent from the client to the server, but have not yet processed a response.</span></span> <span data-ttu-id="05bee-303">Questo valore può continuare ad aumentare perché StackExchange.Redis usa una sola connessione TCP e può leggere solo una risposta per volta.</span><span class="sxs-lookup"><span data-stu-id="05bee-303">This value can keep growing because StackExchange.Redis uses a single TCP connection and can only read one response at a time.</span></span> <span data-ttu-id="05bee-304">Anche se si è verificato il timeout della prima operazione, l'invio dei dati al/dal server non viene arrestato e le altre richieste vengono bloccate finché la prima non viene completata, causando i timeout.</span><span class="sxs-lookup"><span data-stu-id="05bee-304">Even though the first operation timed out, it does not stop the data being sent to/from the server, and other requests are blocked until this is finished, causing time outs.</span></span> <span data-ttu-id="05bee-305">Una soluzione consiste nel ridurre al minimo la possibilità di timeout assicurandosi che la cache sia abbastanza grande per il carico di lavoro e dividendo i valori elevati in blocchi più piccoli.</span><span class="sxs-lookup"><span data-stu-id="05bee-305">One solution is to minimize the chance of timeouts by ensuring that your cache is large enough for your workload and splitting large values into smaller chunks.</span></span> <span data-ttu-id="05bee-306">Un'altra possibile soluzione consiste nell'usare un pool di oggetti `ConnectionMultiplexer` nel client e nello scegliere il `ConnectionMultiplexer` con il carico minore quando si invia una nuova richiesta.</span><span class="sxs-lookup"><span data-stu-id="05bee-306">Another possible solution is to use a pool of `ConnectionMultiplexer` objects in your client, and choose the least loaded `ConnectionMultiplexer` when sending a new request.</span></span> <span data-ttu-id="05bee-307">In questo modo si eviterà che un singolo timeout provochi il timeout anche delle altre richieste.</span><span class="sxs-lookup"><span data-stu-id="05bee-307">This should prevent a single timeout from causing other requests to also timeout.</span></span>
9. <span data-ttu-id="05bee-308">Se si usa `RedisSessionStateprovider`, verificare di avere impostato correttamente il timeout per i tentativi.</span><span class="sxs-lookup"><span data-stu-id="05bee-308">If you are using `RedisSessionStateprovider`, ensure you have set the retry timeout correctly.</span></span> <span data-ttu-id="05bee-309">`retrytimeoutInMilliseconds` deve essere maggiore di `operationTimeoutinMilliseonds`. In caso contrario, non verranno effettuati nuovi tentativi.</span><span class="sxs-lookup"><span data-stu-id="05bee-309">`retrytimeoutInMilliseconds` should be higher than `operationTimeoutinMilliseonds`, otherwise no retries will occur.</span></span> <span data-ttu-id="05bee-310">Nell'esempio seguente `retrytimeoutInMilliseconds` è impostato su 3000.</span><span class="sxs-lookup"><span data-stu-id="05bee-310">In the following example `retrytimeoutInMilliseconds` is set to 3000.</span></span> <span data-ttu-id="05bee-311">Per altre informazioni, vedere [Provider di stato della sessione ASP.NET per Cache Redis di Azure](cache-aspnet-session-state-provider.md) e [How to use the configuration parameters of Session State Provider and Output Cache Provider](https://github.com/Azure/aspnet-redis-providers/wiki/Configuration) (Come usare i parametri di configurazione del provider di stato della sessione e del provider di cache di output).</span><span class="sxs-lookup"><span data-stu-id="05bee-311">For more information, see [ASP.NET Session State Provider for Azure Redis Cache](cache-aspnet-session-state-provider.md) and [How to use the configuration parameters of Session State Provider and Output Cache Provider](https://github.com/Azure/aspnet-redis-providers/wiki/Configuration).</span></span>

    <add
      name="AFRedisCacheSessionStateProvider"
      type="Microsoft.Web.Redis.RedisSessionStateProvider"
      host="enbwcache.redis.cache.windows.net"
      port="6380"
      accessKey="…"
      ssl="true"
      databaseId="0"
      applicationName="AFRedisCacheSessionState"
      connectionTimeoutInMilliseconds = "5000"
      operationTimeoutInMilliseconds = "1000"
      retryTimeoutInMilliseconds="3000" />


1. <span data-ttu-id="05bee-312">Controllare l'utilizzo della memoria nel server Cache Redis di Azure [monitorando](cache-how-to-monitor.md#available-metrics-and-reporting-intervals) `Used Memory RSS` e `Used Memory`.</span><span class="sxs-lookup"><span data-stu-id="05bee-312">Check memory usage on the Azure Redis Cache server by [monitoring](cache-how-to-monitor.md#available-metrics-and-reporting-intervals) `Used Memory RSS` and `Used Memory`.</span></span> <span data-ttu-id="05bee-313">Se è in uso un criterio di rimozione, Redis inizia a rimuovere le chiavi quando `Used_Memory` raggiunge le dimensioni della cache.</span><span class="sxs-lookup"><span data-stu-id="05bee-313">If an eviction policy is in place, Redis starts evicting keys when `Used_Memory` reaches the cache size.</span></span> <span data-ttu-id="05bee-314">Idealmente, `Used Memory RSS` deve essere solo di poco più elevato di `Used memory`.</span><span class="sxs-lookup"><span data-stu-id="05bee-314">Ideally, `Used Memory RSS` should be only slightly higher than `Used memory`.</span></span> <span data-ttu-id="05bee-315">Una grande differenza indica la frammentazione della memoria (interna o esterna).</span><span class="sxs-lookup"><span data-stu-id="05bee-315">A large difference means there is memory fragmentation (internal or external.</span></span> <span data-ttu-id="05bee-316">Quando `Used Memory RSS` è minore di `Used Memory`, significa che il sistema operativo ha effettuato lo swapping di parte della memoria della cache.</span><span class="sxs-lookup"><span data-stu-id="05bee-316">When `Used Memory RSS` is less than `Used Memory`, it means part of the cache memory has been swapped  by the operating system.</span></span> <span data-ttu-id="05bee-317">In questo caso, possono verificarsi alcune latenze significative.</span><span class="sxs-lookup"><span data-stu-id="05bee-317">If this occurs you can expect some significant latencies.</span></span> <span data-ttu-id="05bee-318">Poiché Redis non ha il controllo sull'esecuzione del mapping delle allocazioni alle pagine di memoria, un valore `Used Memory RSS` elevato è spesso il risultato di un picco nell'utilizzo della memoria.</span><span class="sxs-lookup"><span data-stu-id="05bee-318">Because Redis does not have control over how its allocations are mapped to memory pages, high `Used Memory RSS` is often the result of a spike in memory usage.</span></span> <span data-ttu-id="05bee-319">Quando Redis libera la memoria, la memoria viene restituita all'allocatore che può restituire o meno la memoria al sistema.</span><span class="sxs-lookup"><span data-stu-id="05bee-319">When Redis frees memory, the memory is given back to the allocator, and the allocator may or may not give the memory back to the system.</span></span> <span data-ttu-id="05bee-320">Può esistere una discrepanza tra il valore `Used Memory` e l'utilizzo di memoria segnalato dal sistema operativo,</span><span class="sxs-lookup"><span data-stu-id="05bee-320">There may be a discrepancy between the `Used Memory` value and memory consumption as reported by the operating system.</span></span> <span data-ttu-id="05bee-321">che può essere dovuta al fatto che la memoria è stata usata e rilasciata da Redis, ma non restituita al sistema</span><span class="sxs-lookup"><span data-stu-id="05bee-321">It may be due to the fact memory has been used and released by Redis, but not given back to the system.</span></span> <span data-ttu-id="05bee-322">Per ridurre i problemi di memoria, è possibile eseguire questa procedura.</span><span class="sxs-lookup"><span data-stu-id="05bee-322">To help mitigate memory issues you can perform the following steps.</span></span>
   
   * <span data-ttu-id="05bee-323">Aggiornare la cache a una dimensione maggiore per evitare di imbattersi in limitazioni della memoria nel sistema.</span><span class="sxs-lookup"><span data-stu-id="05bee-323">Upgrade the cache to a larger size so that you are not running up against memory limitations on the system.</span></span>
   * <span data-ttu-id="05bee-324">Impostare le scadenze per le chiavi in modo che i valori meno recenti vengano rimossi in modo proattivo.</span><span class="sxs-lookup"><span data-stu-id="05bee-324">Set expiration times on the keys so that older values are evicted proactively.</span></span>
   * <span data-ttu-id="05bee-325">Monitorare la metrica della cache `used_memory_rss` .</span><span class="sxs-lookup"><span data-stu-id="05bee-325">Monitor the the `used_memory_rss` cache metric.</span></span> <span data-ttu-id="05bee-326">Quando questo valore si avvicina alle dimensioni della cache, è probabile che si inizino a notare problemi di prestazioni.</span><span class="sxs-lookup"><span data-stu-id="05bee-326">When this value approaches the size of their cache, you are likely to start seeing performance issues.</span></span> <span data-ttu-id="05bee-327">Distribuire i dati in più partizioni se si usa una cache Premium o eseguire l'aggiornamento a una cache di dimensioni superiori.</span><span class="sxs-lookup"><span data-stu-id="05bee-327">Distribute the data across multiple shards if you are using a premium cache, or upgrade to a larger cache size.</span></span>
   
   <span data-ttu-id="05bee-328">Per altre informazioni, vedere [Utilizzo elevato di memoria nel server](#memory-pressure-on-the-server).</span><span class="sxs-lookup"><span data-stu-id="05bee-328">For more information, see [Memory Pressure on the server](#memory-pressure-on-the-server).</span></span>

## <a name="additional-information"></a><span data-ttu-id="05bee-329">Informazioni aggiuntive</span><span class="sxs-lookup"><span data-stu-id="05bee-329">Additional information</span></span>
* [<span data-ttu-id="05bee-330">Quali offerte e dimensioni della Cache Redis è consigliabile usare?</span><span class="sxs-lookup"><span data-stu-id="05bee-330">What Redis Cache offering and size should I use?</span></span>](cache-faq.md#what-redis-cache-offering-and-size-should-i-use)
* [<span data-ttu-id="05bee-331">In che modo è possibile valutare e testare le prestazioni della cache?</span><span class="sxs-lookup"><span data-stu-id="05bee-331">How can I benchmark and test the performance of my cache?</span></span>](cache-faq.md#how-can-i-benchmark-and-test-the-performance-of-my-cache)
* [<span data-ttu-id="05bee-332">Come si eseguono i comandi Redis?</span><span class="sxs-lookup"><span data-stu-id="05bee-332">How can I run Redis commands?</span></span>](cache-faq.md#how-can-i-run-redis-commands)
* [<span data-ttu-id="05bee-333">Come monitorare Cache Redis di Azure</span><span class="sxs-lookup"><span data-stu-id="05bee-333">How to monitor Azure Redis Cache</span></span>](cache-how-to-monitor.md)

