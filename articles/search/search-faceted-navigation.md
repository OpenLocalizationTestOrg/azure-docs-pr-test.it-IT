---
title: Come implementare l'esplorazione in base a facet in Ricerca di Azure | Documentazione Microsoft
description: Aggiungere Esplorazione in base a facet alle applicazioni che si integrano con la Ricerca di Azure, un servizio di ricerca ospitato sul cloud in Microsoft Azure.
services: search
documentationcenter: 
author: HeidiSteen
manager: mblythe
editor: 
ms.assetid: cdf98fd4-63fd-4b50-b0b0-835cb08ad4d3
ms.service: search
ms.devlang: rest-api
ms.workload: search
ms.topic: article
ms.tgt_pltfrm: na
ms.date: 3/10/2017
ms.author: heidist
ms.openlocfilehash: 413f498eeb0bbc9a971c7a65200ed2fd8caa9aaf
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 07/11/2017
---
# <a name="how-to-implement-faceted-navigation-in-azure-search"></a><span data-ttu-id="09f30-103">Come implementare l'esplorazione in base a facet in Ricerca di Azure</span><span class="sxs-lookup"><span data-stu-id="09f30-103">How to implement faceted navigation in Azure Search</span></span>
<span data-ttu-id="09f30-104">L'esplorazione in base a facet è un meccanismo di filtro che consente un'esplorazione drill-down mirata nelle applicazioni di ricerca.</span><span class="sxs-lookup"><span data-stu-id="09f30-104">Faceted navigation is a filtering mechanism that provides self-directed drilldown navigation in search applications.</span></span> <span data-ttu-id="09f30-105">Il termine "esplorazione in base a facet" può essere poco noto, ma probabilmente è già stato usato in precedenza.</span><span class="sxs-lookup"><span data-stu-id="09f30-105">The term 'faceted navigation' may be unfamiliar, but you've probably used it before.</span></span> <span data-ttu-id="09f30-106">Come illustrato nell'esempio seguente, l'esplorazione in base a facet non è rappresentata dalle categorie usate per filtrare i risultati.</span><span class="sxs-lookup"><span data-stu-id="09f30-106">As the following example shows, faceted navigation is nothing more than the categories used to filter results.</span></span>

 ![Job Portal Demo di Ricerca di Azure][1]

<span data-ttu-id="09f30-108">L'esplorazione in base a facet è un punto di partenza alternativo per la ricerca.</span><span class="sxs-lookup"><span data-stu-id="09f30-108">Faceted navigation is an alternative entry point to search.</span></span> <span data-ttu-id="09f30-109">Offre una valida alternativa all'immissione manuale di espressioni di ricerca complesse.</span><span class="sxs-lookup"><span data-stu-id="09f30-109">It offers a convenient alternative to typing complex search expressions by hand.</span></span> <span data-ttu-id="09f30-110">I facet consentono di trovare ciò che si sta cercando con una percentuale di successo accertata.</span><span class="sxs-lookup"><span data-stu-id="09f30-110">Facets can help you find what you're looking for, while ensuring that you don’t get zero results.</span></span> <span data-ttu-id="09f30-111">Per gli sviluppatori i facet consentono di esporre i criteri di ricerca più utili per lo spostamento del corpo di ricerca.</span><span class="sxs-lookup"><span data-stu-id="09f30-111">As a developer, facets let you expose the most useful search criteria for navigating your search corpus.</span></span> <span data-ttu-id="09f30-112">Nelle applicazioni di vendita online, l'esplorazione in base a facet si basa spesso sulle marche, sui reparti (scarpe per bambini), sulla taglia, sul prezzo, sulla popolarità e sulle classificazioni.</span><span class="sxs-lookup"><span data-stu-id="09f30-112">In online retail applications, faceted navigation is often built over brands, departments (kid’s shoes), size, price, popularity, and ratings.</span></span> 

<span data-ttu-id="09f30-113">L'implementazione dell'esplorazione in base a facet si distingue tra le tecnologie di ricerca.</span><span class="sxs-lookup"><span data-stu-id="09f30-113">Implementing faceted navigation differs across search technologies.</span></span> <span data-ttu-id="09f30-114">Nella Ricerca di Azure, l'esplorazione in base a facet viene creata in fase di query, usando campi attribuiti precedenti nello schema.</span><span class="sxs-lookup"><span data-stu-id="09f30-114">In Azure Search, faceted navigation is built at query time, using fields that you previously attributed in your schema.</span></span>

-   <span data-ttu-id="09f30-115">Le query compilate dall'applicazione devono consentire l'invio dei *parametri di query facet* per ottenere i valori di filtro facet disponibili per il set di risultati dei documenti.</span><span class="sxs-lookup"><span data-stu-id="09f30-115">In the queries that your application builds, a query must send *facet query parameters* to get the available facet filter values for that document result set.</span></span>

-   <span data-ttu-id="09f30-116">Per ridurre effettivamente il set di risultati dei risultati, l'applicazione deve applicare anche un'espressione `$filter`.</span><span class="sxs-lookup"><span data-stu-id="09f30-116">To actually trim the document result set, the application must also apply a `$filter` expression.</span></span>

<span data-ttu-id="09f30-117">Nello sviluppo di applicazioni la scrittura di codice che crea query costituisce la maggior parte del lavoro.</span><span class="sxs-lookup"><span data-stu-id="09f30-117">In your application development, writing code that constructs queries constitutes the bulk of the work.</span></span> <span data-ttu-id="09f30-118">Molti dei comportamenti dell'applicazione previsti per l'esplorazione in base a facet vengono forniti dal servizio, inclusi il supporto predefinito per la definizione degli intervalli e il recupero dei conteggi relativi ai risultati di facet.</span><span class="sxs-lookup"><span data-stu-id="09f30-118">Many of the application behaviors that you would expect from faceted navigation are provided by the service, including built-in support for defining ranges and getting counts for facet results.</span></span> <span data-ttu-id="09f30-119">Il servizio include anche valori predefiniti appropriati che consentono di evitare le strutture di spostamento ingombranti.</span><span class="sxs-lookup"><span data-stu-id="09f30-119">The service also includes sensible defaults that help you avoid unwieldy navigation structures.</span></span> 

## <a name="sample-code-and-demo"></a><span data-ttu-id="09f30-120">Demo e codice di esempio</span><span class="sxs-lookup"><span data-stu-id="09f30-120">Sample code and demo</span></span>
<span data-ttu-id="09f30-121">Questo articolo usa un portale di ricerca dei processi come esempio.</span><span class="sxs-lookup"><span data-stu-id="09f30-121">This article uses a job search portal as an example.</span></span> <span data-ttu-id="09f30-122">L'esempio viene implementato come applicazione MVC ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="09f30-122">The example is implemented as an ASP.NET MVC application.</span></span>

-   <span data-ttu-id="09f30-123">Esaminare e testare la demo di lavoro online in [Job Portal Demo di Ricerca di Azure](http://azjobsdemo.azurewebsites.net/).</span><span class="sxs-lookup"><span data-stu-id="09f30-123">See and test the working demo online at [Azure Search Job Portal Demo](http://azjobsdemo.azurewebsites.net/).</span></span>

-   <span data-ttu-id="09f30-124">Scaricare il codice dal [repository di esempi di Azure su GitHub](https://github.com/Azure-Samples/search-dotnet-asp-net-mvc-jobs).</span><span class="sxs-lookup"><span data-stu-id="09f30-124">Download the code from the [Azure-Samples repo on GitHub](https://github.com/Azure-Samples/search-dotnet-asp-net-mvc-jobs).</span></span>

## <a name="get-started"></a><span data-ttu-id="09f30-125">Introduzione</span><span class="sxs-lookup"><span data-stu-id="09f30-125">Get started</span></span>
<span data-ttu-id="09f30-126">Se non si ha familiarità con lo sviluppo di funzionalità di ricerca, per comprendere l'esplorazione in base a facet, tenere presente che mostra le diverse possibilità di ricerca autodeterminata.</span><span class="sxs-lookup"><span data-stu-id="09f30-126">If you're new to search development, the best way to think of faceted navigation is that it shows the possibilities for self-directed search.</span></span> <span data-ttu-id="09f30-127">Si tratta di un tipo di esperienza di ricerca drill-down, basata su filtri predefiniti usati per limitare rapidamente i risultati di ricerca tramite semplici azioni in un solo clic.</span><span class="sxs-lookup"><span data-stu-id="09f30-127">It’s a type of drill-down search experience, based on predefined filters, used for quickly narrowing down search results through point-and-click actions.</span></span> 

### <a name="interaction-model"></a><span data-ttu-id="09f30-128">Modello di interazione</span><span class="sxs-lookup"><span data-stu-id="09f30-128">Interaction model</span></span>

<span data-ttu-id="09f30-129">L'esperienza di ricerca dell'esplorazione in base a facet è iterativa. Pertanto, è opportuno iniziare con il concepirlo come una sequenza di query create in risposta ad azioni dell'utente.</span><span class="sxs-lookup"><span data-stu-id="09f30-129">The search experience for faceted navigation is iterative, so let’s start by understanding it as a sequence of queries that unfold in response to user actions.</span></span>

<span data-ttu-id="09f30-130">Il punto di partenza è una pagina dell'applicazione che consente un'esplorazione in base a facet, in genere sul perimetro.</span><span class="sxs-lookup"><span data-stu-id="09f30-130">The starting point is an application page that provides faceted navigation, typically placed on the periphery.</span></span> <span data-ttu-id="09f30-131">L'esplorazione in base a facet è spesso una struttura ad albero, con caselle di controllo per ogni valore o testo selezionabile.</span><span class="sxs-lookup"><span data-stu-id="09f30-131">Faceted navigation is often a tree structure, with checkboxes for each value, or clickable text.</span></span> 

1. <span data-ttu-id="09f30-132">Una query inviata a Ricerca di Azure specifica la struttura dell'esplorazione in base a facet tramite uno o più parametri di query del facet.</span><span class="sxs-lookup"><span data-stu-id="09f30-132">A query sent to Azure Search specifies the faceted navigation structure via one or more facet query parameters.</span></span> <span data-ttu-id="09f30-133">Ad esempio, la query potrebbe includere `facet=Rating`, ad esempio con l’opzione `:values` o `:sort` per specificare ulteriormente la presentazione.</span><span class="sxs-lookup"><span data-stu-id="09f30-133">For instance, the query might include `facet=Rating`, perhaps with a `:values` or `:sort` option to further refine the presentation.</span></span>
2. <span data-ttu-id="09f30-134">Il livello di presentazione consente di eseguire il rendering di una pagina di ricerca che permette l'esplorazione in base ai facet specificati nella richiesta.</span><span class="sxs-lookup"><span data-stu-id="09f30-134">The presentation layer renders a search page that provides faceted navigation, using the facets specified on the request.</span></span>
3. <span data-ttu-id="09f30-135">A fronte di una struttura di esplorazione in base a facet che include la classificazione, si fa clic su "4" per indicare che devono essere visualizzati solo i prodotti con una valutazione pari a 4 stelle o superiore.</span><span class="sxs-lookup"><span data-stu-id="09f30-135">Given a faceted navigation structure that includes Rating, you click "4" to indicate that only products with a rating of 4 or higher should be shown.</span></span> 
4. <span data-ttu-id="09f30-136">In risposta, l'applicazione invia una query che include `$filter=Rating ge 4`</span><span class="sxs-lookup"><span data-stu-id="09f30-136">In response, the application sends a query that includes `$filter=Rating ge 4`</span></span> 
5. <span data-ttu-id="09f30-137">Il livello di presentazione aggiorna la pagina con un set di risultati ridotto, contenente solo gli elementi che soddisfano i nuovi criteri (in questo caso, i prodotti valutati con 4 stelle e superiore).</span><span class="sxs-lookup"><span data-stu-id="09f30-137">The presentation layer updates the page, showing a reduced result set, containing just those items that satisfy the new criteria (in this case, products rated 4 and up).</span></span>

<span data-ttu-id="09f30-138">Il facet è un parametro di query, da non confondere con l'input della query.</span><span class="sxs-lookup"><span data-stu-id="09f30-138">A facet is a query parameter, but do not confuse it with query input.</span></span> <span data-ttu-id="09f30-139">Non viene mai usato come criterio di selezione in una query.</span><span class="sxs-lookup"><span data-stu-id="09f30-139">It is never used as selection criteria in a query.</span></span> <span data-ttu-id="09f30-140">Al contrario, occorre concepire i parametri di query di un facet come input per la struttura di navigazione che viene restituita nella risposta.</span><span class="sxs-lookup"><span data-stu-id="09f30-140">Instead, think of facet query parameters as inputs to the navigation structure that comes back in the response.</span></span> <span data-ttu-id="09f30-141">Per ogni parametro di query del facet fornito, Ricerca di Azure restituisce quanti documenti sono presenti nei risultati parziali per ogni valore del facet.</span><span class="sxs-lookup"><span data-stu-id="09f30-141">For each facet query parameter you provide, Azure Search evaluates how many documents are in the partial results for each facet value.</span></span>

<span data-ttu-id="09f30-142">Si noti il `$filter` nel passaggio 4.</span><span class="sxs-lookup"><span data-stu-id="09f30-142">Notice the `$filter` in step 4.</span></span> <span data-ttu-id="09f30-143">Il filtro è un aspetto importante dell'esplorazione in base a facet.</span><span class="sxs-lookup"><span data-stu-id="09f30-143">The filter is an important aspect of faceted navigation.</span></span> <span data-ttu-id="09f30-144">Sebbene facet e filtri siano indipendenti nell'API, sono necessari entrambi per offrire l'esperienza desiderata.</span><span class="sxs-lookup"><span data-stu-id="09f30-144">Although facets and filters are independent in the API, you need both to deliver the experience you intend.</span></span> 

### <a name="app-design-pattern"></a><span data-ttu-id="09f30-145">Schema progettuale di app</span><span class="sxs-lookup"><span data-stu-id="09f30-145">App design pattern</span></span>

<span data-ttu-id="09f30-146">Nel codice dell'applicazione, il modello consiste nell'usare parametri di query di facet per restituire la struttura di navigazione in base a facet con i risultati di facet, oltre a un'espressione $filter.</span><span class="sxs-lookup"><span data-stu-id="09f30-146">In application code, the pattern is to use facet query parameters to return the faceted navigation structure along with facet results, plus a $filter expression.</span></span>  <span data-ttu-id="09f30-147">L'espressione filtro gestisce l'evento clic sul valore del facet.</span><span class="sxs-lookup"><span data-stu-id="09f30-147">The filter expression handles the click event on the facet value.</span></span> <span data-ttu-id="09f30-148">L'espressione `$filter` deve essere considerata come il codice alla base della riduzione effettiva dei risultati della ricerca restituiti al livello di presentazione.</span><span class="sxs-lookup"><span data-stu-id="09f30-148">Think of the `$filter` expression as the code behind the actual trimming of search results returned to the presentation layer.</span></span> <span data-ttu-id="09f30-149">A fronte di un facet di colori, la selezione del colore rosso viene implementata tramite un'espressione `$filter` che consente di selezionare solo gli elementi di colore rosso.</span><span class="sxs-lookup"><span data-stu-id="09f30-149">Given a Colors facet, clicking the color Red is implemented through a `$filter` expression that selects only those items that have a color of red.</span></span> 

### <a name="query-basics"></a><span data-ttu-id="09f30-150">Nozioni di base sulle query</span><span class="sxs-lookup"><span data-stu-id="09f30-150">Query basics</span></span>

<span data-ttu-id="09f30-151">In Ricerca di Azure una richiesta viene specificata tramite uno o più parametri di query (vedere [Eseguire ricerche nei documenti](http://msdn.microsoft.com/library/azure/dn798927.aspx) per una descrizione di ciascuno di essi).</span><span class="sxs-lookup"><span data-stu-id="09f30-151">In Azure Search, a request is specified through one or more query parameters (see [Search Documents](http://msdn.microsoft.com/library/azure/dn798927.aspx) for a description of each one).</span></span> <span data-ttu-id="09f30-152">Nessuno dei parametri di query è obbligatorio, ma è necessario disporre di almeno di uno affinché una query sia valida.</span><span class="sxs-lookup"><span data-stu-id="09f30-152">None of the query parameters are required, but you must have at least one in order for a query to be valid.</span></span>

<span data-ttu-id="09f30-153">La precisione, interpretata come la possibilità di filtrare i riscontri irrilevanti, avviene attraverso una o entrambe queste espressioni:</span><span class="sxs-lookup"><span data-stu-id="09f30-153">Precision, understood as the ability to filter out irrelevant hits, is achieved through one or both of these expressions:</span></span>

-   <span data-ttu-id="09f30-154">**ricerca =**</span><span class="sxs-lookup"><span data-stu-id="09f30-154">**search=**</span></span>  
    <span data-ttu-id="09f30-155">Il valore di questo parametro rappresenta l'espressione di ricerca.</span><span class="sxs-lookup"><span data-stu-id="09f30-155">The value of this parameter constitutes the search expression.</span></span> <span data-ttu-id="09f30-156">Potrebbe essere una singola parte di testo o un'espressione di ricerca complessa che include più termini e operatori.</span><span class="sxs-lookup"><span data-stu-id="09f30-156">It might be a single piece of text, or a complex search expression that includes multiple terms and operators.</span></span> <span data-ttu-id="09f30-157">Nel server un'espressione di ricerca viene usata per la ricerca full-text, per l'esecuzione di query su campi disponibili per la ricerca nell'indice di termini corrispondenti, per la restituzione dei risultati in ordine di classificazione.</span><span class="sxs-lookup"><span data-stu-id="09f30-157">On the server, a search expression is used for full-text search, querying searchable fields in the index for matching terms, returning results in rank order.</span></span> <span data-ttu-id="09f30-158">Se si imposta `search` su null, l'esecuzione della query va oltre l'intero indice (ovvero, `search=*`).</span><span class="sxs-lookup"><span data-stu-id="09f30-158">If you set `search` to null, query execution is over the entire index (that is, `search=*`).</span></span> <span data-ttu-id="09f30-159">In questo caso, gli altri elementi della query, ad esempio `$filter` o un profilo di punteggio, sono i fattori primari che determinano quali documenti vengono restituiti `($filter`) e in quale ordine (`scoringProfile` o `$orderby`).</span><span class="sxs-lookup"><span data-stu-id="09f30-159">In this case, other elements of the query, such as a `$filter` or scoring profile, are the primary factors affecting which documents are returned `($filter`) and in what order (`scoringProfile` or `$orderby`).</span></span>

-   <span data-ttu-id="09f30-160">**$filter=**</span><span class="sxs-lookup"><span data-stu-id="09f30-160">**$filter=**</span></span>  
    <span data-ttu-id="09f30-161">Un filtro è un meccanismo potente per limitare le dimensioni dei risultati della ricerca in base ai valori degli attributi del documento specifico.</span><span class="sxs-lookup"><span data-stu-id="09f30-161">A filter is a powerful mechanism for limiting the size of search results based on the values of specific document attributes.</span></span> <span data-ttu-id="09f30-162">Viene prima valutato un `$filter` , seguito dalla logica di facet che genera i valori disponibili e i conteggi corrispondenti per ciascun valore.</span><span class="sxs-lookup"><span data-stu-id="09f30-162">A `$filter` is evaluated first, followed by faceting logic that generates the available values and corresponding counts for each value</span></span>

<span data-ttu-id="09f30-163">Le espressioni di ricerca complesse comportano una riduzione delle prestazioni della query.</span><span class="sxs-lookup"><span data-stu-id="09f30-163">Complex search expressions decrease the performance of the query.</span></span> <span data-ttu-id="09f30-164">Ove possibile, usare le espressioni di filtro ben strutturate per aumentare la precisione e migliorare le prestazioni delle query.</span><span class="sxs-lookup"><span data-stu-id="09f30-164">Where possible, use well-constructed filter expressions to increase precision and improve query performance.</span></span>

<span data-ttu-id="09f30-165">Per comprendere meglio in che modo un filtro aggiunge maggiore precisione, confrontare un'espressione di ricerca complessa che includa un'espressione di filtro:</span><span class="sxs-lookup"><span data-stu-id="09f30-165">To better understand how a filter adds more precision, compare a complex search expression to one that includes a filter expression:</span></span>

-   `GET /indexes/hotel/docs?search=lodging budget +Seattle –motel +parking`
-   `GET /indexes/hotel/docs?search=lodging&$filter=City eq ‘Seattle’ and Parking and Type ne ‘motel’`

<span data-ttu-id="09f30-166">Entrambe le query sono valide, ma la seconda è migliore se si stanno cercando non motel con parcheggio in Seattle.</span><span class="sxs-lookup"><span data-stu-id="09f30-166">Both queries are valid, but the second is superior if you’re looking for non-motels with parking in Seattle.</span></span>
-   <span data-ttu-id="09f30-167">La prima query si basa su tali parole specifiche non indicate nei campi stringa come nome, descrizione e qualsiasi altro campo contenente dati disponibili per la ricerca.</span><span class="sxs-lookup"><span data-stu-id="09f30-167">The first query relies on those specific words being mentioned or not mentioned in string fields like Name, Description, and any other field containing searchable data.</span></span>
-   <span data-ttu-id="09f30-168">La seconda query consente di cercare le corrispondenze precise sui dati strutturati e probabilmente più accurate.</span><span class="sxs-lookup"><span data-stu-id="09f30-168">The second query looks for precise matches on structured data and is likely to be much more accurate.</span></span>

<span data-ttu-id="09f30-169">Nelle applicazioni che includono l'esplorazione in base a facet, è necessario assicurarsi che ogni azione dell'utente su una struttura di esplorazione in base a facet sia accompagnata da una restrizione dei risultati della ricerca.</span><span class="sxs-lookup"><span data-stu-id="09f30-169">In applications that include faceted navigation, make sure that each user action over a faceted navigation structure is accompanied by a narrowing of search results.</span></span> <span data-ttu-id="09f30-170">Per limitare i risultati, usare un'espressione filtro.</span><span class="sxs-lookup"><span data-stu-id="09f30-170">To narrow results, use a filter expression.</span></span>

<a name="howtobuildit"></a>

## <a name="build-a-faceted-navigation-app"></a><span data-ttu-id="09f30-171">Creare un'app di esplorazione in base a facet</span><span class="sxs-lookup"><span data-stu-id="09f30-171">Build a faceted navigation app</span></span>
<span data-ttu-id="09f30-172">Si implementa l'esplorazione in base a facet con Ricerca di Azure nel codice dell'applicazione che crea la richiesta di ricerca.</span><span class="sxs-lookup"><span data-stu-id="09f30-172">You implement faceted navigation with Azure Search in your application code that builds the search request.</span></span> <span data-ttu-id="09f30-173">L'esplorazione in base a facet si basa su elementi dello schema definiti in precedenza.</span><span class="sxs-lookup"><span data-stu-id="09f30-173">The faceted navigation relies on elements in your schema that you defined previously.</span></span>

<span data-ttu-id="09f30-174">Predefinito nell'indice di ricerca è l'attributo dell'indice `Facetable [true|false]` , impostato in campi selezionati per abilitare o disabilitare l'uso in una struttura di esplorazione in base a facet.</span><span class="sxs-lookup"><span data-stu-id="09f30-174">Predefined in your search index is the `Facetable [true|false]` index attribute, set on selected fields to enable or disable their use in a faceted navigation structure.</span></span> <span data-ttu-id="09f30-175">Senza `"Facetable" = true`un campo non può essere usato nell'esplorazione in base a facet.</span><span class="sxs-lookup"><span data-stu-id="09f30-175">Without `"Facetable" = true`, a field cannot be used in facet navigation.</span></span>

<span data-ttu-id="09f30-176">Il livello di presentazione del codice offre l'esperienza dell'utente.</span><span class="sxs-lookup"><span data-stu-id="09f30-176">The presentation layer in your code provides the user experience.</span></span> <span data-ttu-id="09f30-177">Dovrebbero essere indicate le parti costitutive dell'esplorazione in base a facet, ad esempio l'etichetta, i valori, le caselle di controllo e il conteggio.</span><span class="sxs-lookup"><span data-stu-id="09f30-177">It should list the constituent parts of the faceted navigation, such as the label, values, check boxes, and the count.</span></span> <span data-ttu-id="09f30-178">L'API REST di Ricerca di Azure è indipendente dalla piattaforma, quindi è possibile usare qualsiasi lingua e la piattaforma desiderata.</span><span class="sxs-lookup"><span data-stu-id="09f30-178">The Azure Search REST API is platform agnostic, so use whatever language and platform you want.</span></span> <span data-ttu-id="09f30-179">L'aspetto importante consiste nell'includere gli elementi dell'interfaccia utente che supportano l'aggiornamento incrementale, con lo stato dell'interfaccia utente aggiornato man mano che vengono selezionate facet aggiuntive.</span><span class="sxs-lookup"><span data-stu-id="09f30-179">The important thing is to include UI elements that support incremental refresh, with updated UI state as each additional facet is selected.</span></span> 

<span data-ttu-id="09f30-180">In fase di query, il codice dell'applicazione consente di creare una richiesta che include `facet=[string]`, un parametro di richiesta che fornisce i facet per il campo.</span><span class="sxs-lookup"><span data-stu-id="09f30-180">At query time, your application code creates a request that includes `facet=[string]`, a request parameter that provides the field to facet by.</span></span> <span data-ttu-id="09f30-181">Una query può avere più facet, ad esempio `&facet=color&facet=category&facet=rating`, ciascuno separato da un carattere e commerciale (&).</span><span class="sxs-lookup"><span data-stu-id="09f30-181">A query can have multiple facets, such as `&facet=color&facet=category&facet=rating`, each one separated by an ampersand (&) character.</span></span>

<span data-ttu-id="09f30-182">Il codice dell'applicazione deve inoltre consentire la creazione di un'espressione `$filter` per gestire gli eventi di selezione nell'esplorazione in base a facet.</span><span class="sxs-lookup"><span data-stu-id="09f30-182">Application code must also construct a `$filter` expression to handle the click events in faceted navigation.</span></span> <span data-ttu-id="09f30-183">`$filter` riduce i risultati della ricerca, usando il valore del facet come criteri di filtro.</span><span class="sxs-lookup"><span data-stu-id="09f30-183">A `$filter` reduces the search results, using the facet value as filter criteria.</span></span>

<span data-ttu-id="09f30-184">Ricerca di Azure restituisce i risultati della ricerca in base a uno o più termini immessi, insieme agli aggiornamenti della struttura di esplorazione in base a facet.</span><span class="sxs-lookup"><span data-stu-id="09f30-184">Azure Search returns the search results, based on one or more terms that you enter, along with updates to the faceted navigation structure.</span></span> <span data-ttu-id="09f30-185">In Ricerca di Azure l'esplorazione in base a facet è una costruzione a livello singolo, con valori di facet, che calcola il numero di risultati trovati per ciascuno di essi.</span><span class="sxs-lookup"><span data-stu-id="09f30-185">In Azure Search, faceted navigation is a single-level construction, with facet values, and counts of how many results are found for each one.</span></span>

<span data-ttu-id="09f30-186">Nelle sezioni seguenti verrà esaminata più in dettaglio la compilazione di ogni parte.</span><span class="sxs-lookup"><span data-stu-id="09f30-186">In the following sections, we take a closer look at how to build each part.</span></span>

<a name="buildindex"></a>

## <a name="build-the-index"></a><span data-ttu-id="09f30-187">Compilare l'indice</span><span class="sxs-lookup"><span data-stu-id="09f30-187">Build the index</span></span>
<span data-ttu-id="09f30-188">L'esplorazione in base a facet viene abilitata per ogni campo singolarmente, tramite l'attributo di indice: `"Facetable": true`.</span><span class="sxs-lookup"><span data-stu-id="09f30-188">Faceting is enabled on a field-by-field basis in the index, via this index attribute: `"Facetable": true`.</span></span>  
<span data-ttu-id="09f30-189">Tutti i tipi di campo che possono essere usati in esplorazione in base a facet sono `Facetable` per impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="09f30-189">All field types that could possibly be used in faceted navigation are `Facetable` by default.</span></span> <span data-ttu-id="09f30-190">Tali tipi di campo includono `Edm.String`, `Edm.DateTimeOffset` e tutti i tipi di campo numerico (ossia, tutti i tipi di campo consentono un'esplorazione in base a facet tranne `Edm.GeographyPoint`, che non può essere usato nell'esplorazione in base a facet).</span><span class="sxs-lookup"><span data-stu-id="09f30-190">Such field types include `Edm.String`, `Edm.DateTimeOffset`, and all the numeric field types (essentially, all field types are facetable except `Edm.GeographyPoint`, which can’t be used in faceted navigation).</span></span> 

<span data-ttu-id="09f30-191">Durante la creazione di un indice, è consigliabile disattivare in modo esplicito l'esplorazione in base a facet per i campi che non devono mai essere usati come un facet.</span><span class="sxs-lookup"><span data-stu-id="09f30-191">When building an index, a best practice for faceted navigation is to explicitly turn faceting off for fields that should never be used as a facet.</span></span>  <span data-ttu-id="09f30-192">In particolare, i campi stringa per i valori singleton, ad esempio un nome di prodotto o ID, devono essere impostati su `"Facetable": false` per impedirne l'uso accidentale (e inefficace) nell'esplorazione in base a facet.</span><span class="sxs-lookup"><span data-stu-id="09f30-192">In particular, string fields for singleton values, such as an ID or product name, should be set to `"Facetable": false` to prevent their accidental (and ineffective) use in faceted navigation.</span></span> <span data-ttu-id="09f30-193">La disattivazione dell'esplorazione in base a facet, laddove non necessaria, consente di mantenere ridotte le dimensioni dell'indice e in genere di migliorare le prestazioni.</span><span class="sxs-lookup"><span data-stu-id="09f30-193">Turning faceting off where you don’t need it helps keep the size of the index small, and typically improves performance.</span></span>

<span data-ttu-id="09f30-194">Di seguito è riportata una parte dello schema per l'app di esempio Job Portal Demo, senza alcuni attributi per ridurre le dimensioni:</span><span class="sxs-lookup"><span data-stu-id="09f30-194">Following is part of the schema for the Job Portal Demo sample app, trimmed of some attributes to reduce the size:</span></span>

```json
{
  ...
  "name": "nycjobs",
  "fields": [
    { “name”: "id",                 "type": "Edm.String",              "searchable": false, "filterable": false, ... "facetable": false, ... },
    { “name”: "job_id",             "type": "Edm.String",              "searchable": false, "filterable": false, ... "facetable": false, ... },
    { “name”: "agency",              "type": "Edm.String",             "searchable": true,  "filterable": true, ...  "facetable": true, ...  },
    { “name”: "posting_type",        "type": "Edm.String",             "searchable": true,  "filterable": true, ...  "facetable": true, ...  },
    { “name”: "num_of_positions",    "type": "Edm.Int32",              "searchable": false, "filterable": true, ...  "facetable": true, ...  },
    { “name”: "business_title",      "type": "Edm.String",             "searchable": true,  "filterable": true, ...  "facetable": true, ...  },
    { “name”: "civil_service_title", "type": "Edm.String",             "searchable": true,  "filterable": true, ...  "facetable": true, ...  },
    { “name”: "title_code_no",       "type": "Edm.String",             "searchable": true,  "filterable": true, ...  "facetable": true, ...  },
    { “name”: "level",               "type": "Edm.String",             "searchable": true,  "filterable": true, ...  "facetable": true, ...  },
    { “name”: "salary_range_from",   "type": "Edm.Int32",              "searchable": false, "filterable": true, ...  "facetable": true, ...  },
    { “name”: "salary_range_to",     "type": "Edm.Int32",              "searchable": false, "filterable": true, ...  "facetable": true, ...  },
    { “name”: "salary_frequency",    "type": "Edm.String",             "searchable": true,  "filterable": true, ...  "facetable": true, ...  },
    { “name”: "work_location",       "type": "Edm.String",             "searchable": true,  "filterable": true, ...  "facetable": true, ...  },
…
    { “name”: "geo_location",        "type": "Edm.GeographyPoint",     "searchable": false, "filterable": true, ...  "facetable": false, ... },
    { “name”: "tags",                "type": "Collection(Edm.String)", "searchable": true,  "filterable": true, ...  "facetable": true, ...  }
  ],
…
}
```

<span data-ttu-id="09f30-195">Come risulta dallo schema di esempio, `Facetable` è disattivato per i campi stringa che non devono essere usati come facet, ad esempio i valori ID.</span><span class="sxs-lookup"><span data-stu-id="09f30-195">As you can see in the sample schema, `Facetable` is turned off for string fields that shouldn’t be used as facets, such as ID values.</span></span> <span data-ttu-id="09f30-196">La disattivazione dell'esplorazione in base a facet, laddove non necessaria, consente di mantenere ridotte le dimensioni dell'indice e in genere di migliorare le prestazioni.</span><span class="sxs-lookup"><span data-stu-id="09f30-196">Turning faceting off where you don’t need it helps keep the size of the index small, and typically improves performance.</span></span>

> [!TIP]
> <span data-ttu-id="09f30-197">Come procedura consigliata, includere il set completo di attributi dell'indice per ogni campo.</span><span class="sxs-lookup"><span data-stu-id="09f30-197">As a best practice, include the full set of index attributes for each field.</span></span> <span data-ttu-id="09f30-198">Benché `Facetable` sia attivato per impostazione predefinita per quasi tutti i campi, l'impostazione intenzionale di ogni attributo consentono di valutare le implicazioni di ogni decisione di schema.</span><span class="sxs-lookup"><span data-stu-id="09f30-198">Although `Facetable` is on by default for almost all fields, purposely setting each attribute can help you think through the implications of each schema decision.</span></span> 

<a name="checkdata"></a>

## <a name="check-the-data"></a><span data-ttu-id="09f30-199">Controllare i dati</span><span class="sxs-lookup"><span data-stu-id="09f30-199">Check the data</span></span>
<span data-ttu-id="09f30-200">La qualità dei dati ha un effetto diretto sulla possibilità che la struttura di esplorazione in base a facet si prospetti come previsto.</span><span class="sxs-lookup"><span data-stu-id="09f30-200">The quality of your data has a direct effect on whether the faceted navigation structure materializes as you expect it to.</span></span> <span data-ttu-id="09f30-201">Influisce anche sulla facilità di creazione di filtri per ridurre il set di risultati.</span><span class="sxs-lookup"><span data-stu-id="09f30-201">It also affects the ease of constructing filters to reduce the result set.</span></span>

<span data-ttu-id="09f30-202">Se si desidera effettuare un'esplorazione in base a facet per marca o prezzo, ciascun documento deve contenere i valori relativi a *BrandName* e *ProductPrice* che sono validi, coerenti e produttivi come opzione di filtro.</span><span class="sxs-lookup"><span data-stu-id="09f30-202">If you want to facet by Brand or Price, each document should contain values for *BrandName* and *ProductPrice* that are valid, consistent, and productive as a filter option.</span></span>

<span data-ttu-id="09f30-203">Di seguito sono elencati alcuni promemoria di ciò che è necessario eliminare:</span><span class="sxs-lookup"><span data-stu-id="09f30-203">Here are a few reminders of what to scrub for:</span></span>

* <span data-ttu-id="09f30-204">Per ogni campo da usare per l'esplorazione in base a facet, è necessario stabilire se contiene valori adatti all'uso come filtri nella ricerca mirata.</span><span class="sxs-lookup"><span data-stu-id="09f30-204">For every field that you want to facet by, ask yourself whether it contains values that are suitable as filters in self-directed search.</span></span> <span data-ttu-id="09f30-205">I valori devono essere brevi, descrittivi sufficientemente distintivi per offrire una scelta definita tra opzioni concorrenti.</span><span class="sxs-lookup"><span data-stu-id="09f30-205">The values should be short, descriptive, and sufficiently distinctive to offer a clear choice between competing options.</span></span>
* <span data-ttu-id="09f30-206">Errori di ortografia o valori quasi corrispondenti.</span><span class="sxs-lookup"><span data-stu-id="09f30-206">Misspellings or nearly matching values.</span></span> <span data-ttu-id="09f30-207">Se si effettua l'esplorazione in base a facet per Colore e i valori dei campi includono Arancione e Arncione (un errore di ortografia), un'esplorazione in base a facet in base al campo colore comporterebbe la selezione di entrambi.</span><span class="sxs-lookup"><span data-stu-id="09f30-207">If you facet on Color, and field values include Orange and Ornage (a misspelling), a facet based on the Color field would pick up both.</span></span>
* <span data-ttu-id="09f30-208">Il testo con maiuscole e minuscole e può inoltre provocare danni all'esplorazione in base a facet con arancione e Arancione visualizzati come due valori diversi.</span><span class="sxs-lookup"><span data-stu-id="09f30-208">Mixed case text can also wreak havoc in faceted navigation, with orange and Orange appearing as two different values.</span></span> 
* <span data-ttu-id="09f30-209">Le versioni singolari e plurali dello stesso valore possono comportare un facet separato.</span><span class="sxs-lookup"><span data-stu-id="09f30-209">Single and plural versions of the same value can result in a separate facet for each.</span></span>

<span data-ttu-id="09f30-210">Come si può immaginare, la scrupolosità di preparazione dei dati è un aspetto essenziale dell'esplorazione in base a facet.</span><span class="sxs-lookup"><span data-stu-id="09f30-210">As you can imagine, diligence in preparing the data is an essential aspect of effective faceted navigation.</span></span>

<a name="presentationlayer"></a>

## <a name="build-the-ui"></a><span data-ttu-id="09f30-211">Creare l'interfaccia utente</span><span class="sxs-lookup"><span data-stu-id="09f30-211">Build the UI</span></span>
<span data-ttu-id="09f30-212">Partire dal livello di presentazione consente di scoprire i requisiti che è possibile non vengano individuati in caso contrario e di comprendere le funzionalità essenziali per l'esperienza di ricerca.</span><span class="sxs-lookup"><span data-stu-id="09f30-212">Working back from the presentation layer can help you uncover requirements that might be missed otherwise, and understand which capabilities are essential to the search experience.</span></span>

<span data-ttu-id="09f30-213">In termini di esplorazione in base a facet, la pagina Web o un'applicazione consente di visualizzare la struttura del sito di collaborazione, rileva l'input dell'utente nella pagina e inserisce gli elementi modificati.</span><span class="sxs-lookup"><span data-stu-id="09f30-213">In terms of faceted navigation, your web or application page displays the faceted navigation structure, detects user input on the page, and inserts the changed elements.</span></span> 

<span data-ttu-id="09f30-214">Per le applicazioni Web, viene comunemente usata la tecnologia AJAX nel livello di presentazione, poiché consente di aggiornare le modifiche incrementali.</span><span class="sxs-lookup"><span data-stu-id="09f30-214">For web applications, AJAX is commonly used in the presentation layer because it allows you to refresh incremental changes.</span></span> <span data-ttu-id="09f30-215">È inoltre possibile usare ASP.NET MVC o qualsiasi altra piattaforma di visualizzazione che può connettersi a un servizio di Ricerca di Azure tramite HTTP.</span><span class="sxs-lookup"><span data-stu-id="09f30-215">You could also use ASP.NET MVC or any other visualization platform that can connect to an Azure Search service over HTTP.</span></span> <span data-ttu-id="09f30-216">L'applicazione di esempio a cui fa riferimento in questo articolo, **Job Portal Demo di Ricerca di Azure**, è un'applicazione MVC ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="09f30-216">The sample application referenced throughout this article -- the **Azure Search Job Portal Demo** – happens to be an ASP.NET MVC application.</span></span>

<span data-ttu-id="09f30-217">Nell'esempio, l'esplorazione in base a facet viene creata nella pagina di risultati della ricerca.</span><span class="sxs-lookup"><span data-stu-id="09f30-217">In the sample, faceted navigation is built into the search results page.</span></span> <span data-ttu-id="09f30-218">L'esempio seguente, tratto dal file `index.cshtml` dell'applicazione di esempio, mostra la struttura HTML dinamica per la visualizzazione dell'esplorazione in base a facet nella pagina dei risultati di ricerca.</span><span class="sxs-lookup"><span data-stu-id="09f30-218">The following example, taken from the `index.cshtml` file of the sample application, shows the static HTML structure for displaying faceted navigation on the search results page.</span></span> <span data-ttu-id="09f30-219">L'elenco di facet viene compilato o ricompilato in modo dinamico quando si invia un termine di ricerca oppure si seleziona o deseleziona un facet.</span><span class="sxs-lookup"><span data-stu-id="09f30-219">The list of facets is built or rebuilt dynamically when you submit a search term, or select or clear a facet.</span></span>

```html
<div class="widget sidebar-widget jobs-filter-widget">
  <h5 class="widget-title">Filter Results</h5>
    <p id="filterReset"></p>
    <div class="widget-content">

      <h6 id="businessTitleFacetTitle">Business Title</h6>
      <ul class="filter-list" id="business_title_facets">
      </ul>

      <h6>Location</h6>
      <ul class="filter-list" id="posting_type_facets">
      </ul>

      <h6>Posting Type</h6>
      <ul class="filter-list" id="posting_type_facets"></ul>

      <h6>Minimum Salary</h6>
      <ul class="filter-list" id="salary_range_facets">
      </ul>

  </div>
</div>
```

<span data-ttu-id="09f30-220">Il frammento di codice seguente, tratto dalla pagina `index.cshtml`, crea in modo dinamico il codice HTML per visualizzare il primo facet, Business Title.</span><span class="sxs-lookup"><span data-stu-id="09f30-220">The following code snippet from the `index.cshtml` page dynamically builds the HTML to display the first facet, Business Title.</span></span> <span data-ttu-id="09f30-221">Funzioni simili compilano in modo dinamico il codice HTML per gli altri facet.</span><span class="sxs-lookup"><span data-stu-id="09f30-221">Similar functions dynamically build the HTML for the other facets.</span></span> <span data-ttu-id="09f30-222">Ogni facet contiene un'etichetta e un conteggio, che visualizza il numero di elementi trovati per questo risultato di facet.</span><span class="sxs-lookup"><span data-stu-id="09f30-222">Each facet has a label and a count, which displays the number of items found for that facet result.</span></span>

```js
function UpdateBusinessTitleFacets(data) {
  var facetResultsHTML = '';
  for (var i = 0; i < data.length; i++) {
    facetResultsHTML += '<li><a href="javascript:void(0)" onclick="ChooseBusinessTitleFacet(\'' + data[i].Value + '\');">' + data[i].Value + ' (' + data[i].Count + ')</span></a></li>';
  }

  $("#business_title_facets").html(facetResultsHTML);
}
```

> [!TIP]
> <span data-ttu-id="09f30-223">Quando si progetta la pagina dei risultati di ricerca, ricordarsi di aggiungere un meccanismo per la cancellazione dei facet.</span><span class="sxs-lookup"><span data-stu-id="09f30-223">When you design the search results page, remember to add a mechanism for clearing facets.</span></span> <span data-ttu-id="09f30-224">Se si aggiungono caselle di controllo, gli utenti possono facilmente intuire come cancellare i filtri.</span><span class="sxs-lookup"><span data-stu-id="09f30-224">If you add check boxes, you can easily see how to clear the filters.</span></span> <span data-ttu-id="09f30-225">Per altri layout potrebbe essere necessario un modello di navigazione o un altro approccio creativo.</span><span class="sxs-lookup"><span data-stu-id="09f30-225">For other layouts, you might need a breadcrumb pattern or another creative approach.</span></span> <span data-ttu-id="09f30-226">Ad esempio, nell'applicazione di esempio Job Search Portal è possibile fare clic su `[X]` dopo un facet selezionato per cancellare il facet.</span><span class="sxs-lookup"><span data-stu-id="09f30-226">For example, in the Job Search Portal sample application, you can click the `[X]` after a selected facet to clear the facet.</span></span>

<a name="buildquery"></a>

## <a name="build-the-query"></a><span data-ttu-id="09f30-227">Creare la query</span><span class="sxs-lookup"><span data-stu-id="09f30-227">Build the query</span></span>
<span data-ttu-id="09f30-228">Il codice creato per la creazione di query deve specificare tutte le parti di una query valida, tra cui espressioni di ricerca, i facet, i filtri, l'assegnazione dei punteggi dei profili, ovvero qualsiasi elemento che consente di formulare una richiesta.</span><span class="sxs-lookup"><span data-stu-id="09f30-228">The code that you write for building queries should specify all parts of a valid query, including search expressions, facets, filters, scoring profiles– anything used to formulate a request.</span></span> <span data-ttu-id="09f30-229">In questa sezione verrà illustrata la collocazione dei facet in una query e l'uso dei filtri con i facet per fornire un set di risultati ridotto.</span><span class="sxs-lookup"><span data-stu-id="09f30-229">In this section, we explore where facets fit into a query, and how filters are used with facets to deliver a reduced result set.</span></span>

<span data-ttu-id="09f30-230">Si noti che i facet sono parte integrante di questa applicazione di esempio.</span><span class="sxs-lookup"><span data-stu-id="09f30-230">Notice that facets are integral in this sample application.</span></span> <span data-ttu-id="09f30-231">La funzionalità di ricerca in Job Portal Demo è progettata sulla base dei filtri e dell'esplorazione in base a facet.</span><span class="sxs-lookup"><span data-stu-id="09f30-231">The search experience in the Job Portal Demo is designed around faceted navigation and filters.</span></span> <span data-ttu-id="09f30-232">Il posizionamento principale nella pagina dell'esplorazione in base a facet ne dimostra l'importanza.</span><span class="sxs-lookup"><span data-stu-id="09f30-232">The prominent placement of faceted navigation on the page demonstrates its importance.</span></span> 

<span data-ttu-id="09f30-233">Un esempio è spesso un buon punto di inizio.</span><span class="sxs-lookup"><span data-stu-id="09f30-233">An example is often a good place to begin.</span></span> <span data-ttu-id="09f30-234">L'esempio seguente, tratto dal file `JobsSearch.cs`, crea una richiesta che permette l'esplorazione in base a facet basata su qualifica professionale, posizione, tipo di pubblicazione e stipendio minimo.</span><span class="sxs-lookup"><span data-stu-id="09f30-234">The following example, taken from the `JobsSearch.cs` file, builds a request that creates facet navigation based on Business Title, Location, Posting Type, and Minimum Salary.</span></span> 

```cs
SearchParameters sp = new SearchParameters()
{
  ...
  // Add facets
  Facets = new List<String>() { "business_title", "posting_type", "level", "salary_range_from,interval:50000" },
};
```

<span data-ttu-id="09f30-235">Un parametro di query del facet è impostato su un campo e a seconda del tipo di dati usati, può essere ulteriormente dotato di parametri in un elenco delimitato da virgole che includa `count:<integer>`, `sort:<>`, `interval:<integer>` e `values:<list>`.</span><span class="sxs-lookup"><span data-stu-id="09f30-235">A facet query parameter is set to a field and depending on the data type, can be further parameterized by comma-delimited list that includes `count:<integer>`, `sort:<>`, `interval:<integer>`, and `values:<list>`.</span></span> <span data-ttu-id="09f30-236">Durante l'impostazione di intervalli è supportato un elenco di valori per i dati numerici.</span><span class="sxs-lookup"><span data-stu-id="09f30-236">A values list is supported for numeric data when setting up ranges.</span></span> <span data-ttu-id="09f30-237">Per informazioni dettagliate, vedere [Eseguire ricerche nei documenti (API di Ricerca di Azure)](http://msdn.microsoft.com/library/azure/dn798927.aspx) .</span><span class="sxs-lookup"><span data-stu-id="09f30-237">See [Search Documents (Azure Search API)](http://msdn.microsoft.com/library/azure/dn798927.aspx) for usage details.</span></span>

<span data-ttu-id="09f30-238">Insieme ai facet, la richiesta formulata dall'applicazione deve anche permettere la creazione di filtri per limitare il set di documenti candidato in base alla selezione di un valore di facet.</span><span class="sxs-lookup"><span data-stu-id="09f30-238">Along with facets, the request formulated by your application should also build filters to narrow down the set of candidate documents based on a facet value selection.</span></span> <span data-ttu-id="09f30-239">Per uno store di biciclette, l'esplorazione in base a facet fornisce indicazioni a domande su *colore, produttore e tipi di bicicletta disponibili*.</span><span class="sxs-lookup"><span data-stu-id="09f30-239">For a bike store, faceted navigation provides clues to questions like *What colors, manufacturers, and types of bikes are available?*.</span></span> <span data-ttu-id="09f30-240">Il filtro risponde a domande come *Quali biciclette sono mountain bike rosse in questa fascia di prezzo?*.</span><span class="sxs-lookup"><span data-stu-id="09f30-240">Filtering answers questions like *Which exact bikes are red, mountain bikes, in this price range?*.</span></span> <span data-ttu-id="09f30-241">Quando si fa clic su "Red" per indicare che devono essere visualizzati solo i prodotti rossi, la query successiva inviata dall'applicazione include `$filter=Color eq ‘Red’`.</span><span class="sxs-lookup"><span data-stu-id="09f30-241">When you click "Red" to indicate that only Red products should be shown, the next query the application sends includes `$filter=Color eq ‘Red’`.</span></span>

<span data-ttu-id="09f30-242">Il frammento di codice seguente della pagina `JobsSearch.cs` aggiunge il Business Title selezionato al filtro, se si seleziona un valore dal facet Business Title.</span><span class="sxs-lookup"><span data-stu-id="09f30-242">The following code snippet from the `JobsSearch.cs` page adds the selected Business Title to the filter if you select a value from the Business Title facet.</span></span>

```cs
if (businessTitleFacet != "")
  filter = "business_title eq '" + businessTitleFacet + "'";
```

<a name="tips"></a> 

## <a name="tips-and-best-practices"></a><span data-ttu-id="09f30-243">Suggerimenti e procedure consigliate</span><span class="sxs-lookup"><span data-stu-id="09f30-243">Tips and best practices</span></span>

### <a name="indexing-tips"></a><span data-ttu-id="09f30-244">Suggerimenti per l'indicizzazione</span><span class="sxs-lookup"><span data-stu-id="09f30-244">Indexing tips</span></span>
<span data-ttu-id="09f30-245">**Migliorare l'efficienza di un indice se non si usa una casella di ricerca**</span><span class="sxs-lookup"><span data-stu-id="09f30-245">**Improve index efficiency if you don't use a Search box**</span></span>

<span data-ttu-id="09f30-246">Se l'applicazione usa esclusivamente l'esplorazione in base a facet (vale a dire nessuna casella di ricerca), è possibile contrassegnare il campo come `searchable=false`, `facetable=true` per produrre un indice più compatto.</span><span class="sxs-lookup"><span data-stu-id="09f30-246">If your application uses faceted navigation exclusively (that is, no search box), you can mark the field as `searchable=false`, `facetable=true` to produce a more compact index.</span></span> <span data-ttu-id="09f30-247">Inoltre, l'indicizzazione si verifica solo su valori di facet interi con nessuna interruzione parola o indicizzazione delle parti di un valore per più parole.</span><span class="sxs-lookup"><span data-stu-id="09f30-247">In addition, indexing occurs only on whole facet values, with no word-break or indexing of the component parts of a multi-word value.</span></span>

<span data-ttu-id="09f30-248">**Specificare quali campi possono essere usati come facet**</span><span class="sxs-lookup"><span data-stu-id="09f30-248">**Specify which fields can be used as facets**</span></span>

<span data-ttu-id="09f30-249">Tenere presente che lo schema dell'indice determina quali campi sono disponibili da usare come facet.</span><span class="sxs-lookup"><span data-stu-id="09f30-249">Recall that the schema of the index determines which fields are available to use as a facet.</span></span> <span data-ttu-id="09f30-250">Presupponendo che un campo consenta un'esplorazione in base a facet, la query specifica per quali campi eseguirla.</span><span class="sxs-lookup"><span data-stu-id="09f30-250">Assuming a field is facetable, the query specifies which fields to facet by.</span></span> <span data-ttu-id="09f30-251">Il campo per cui si eseguire l'esplorazione in base a facet fornisce i valori visualizzati sotto l'etichetta.</span><span class="sxs-lookup"><span data-stu-id="09f30-251">The field by which you are faceting provides the values that appear below the label.</span></span> 

<span data-ttu-id="09f30-252">I valori visualizzati in ogni etichetta vengono recuperati dall'indice.</span><span class="sxs-lookup"><span data-stu-id="09f30-252">The values that appear under each label are retrieved from the index.</span></span> <span data-ttu-id="09f30-253">Ad esempio, se il campo del facet è il *colore*, i valori disponibili per i filtri aggiuntivi sono i valori per il campo, come rosso, bianco e così via.</span><span class="sxs-lookup"><span data-stu-id="09f30-253">For example, if the facet field is *Color*, the values available for additional filtering are the values for that field - Red, Black, and so forth.</span></span>

<span data-ttu-id="09f30-254">Per valori numerici e data/ora solo, è possibile impostare in modo esplicito i valori nel campo facet (ad esempio, `facet=Rating,values:1|2|3|4|5`).</span><span class="sxs-lookup"><span data-stu-id="09f30-254">For Numeric and DateTime values only, you can explicitly set values on the facet field (for example, `facet=Rating,values:1|2|3|4|5`).</span></span> <span data-ttu-id="09f30-255">È consentito un elenco di valori per questi tipi di campo semplificare la separazione dei risultati di facet in intervalli contigui (entrambi gli intervalli in base a valori numerici o periodi di tempo).</span><span class="sxs-lookup"><span data-stu-id="09f30-255">A values list is allowed for these field types to simplify the separation of facet results into contiguous ranges (either ranges based on numeric values or time periods).</span></span> 

<span data-ttu-id="09f30-256">**Per impostazione predefinita, è possibile avere un solo livello di esplorazione in base a facet**</span><span class="sxs-lookup"><span data-stu-id="09f30-256">**By default you can only have one level of faceted navigation**</span></span> 

<span data-ttu-id="09f30-257">Come accennato, non esiste alcun supporto diretto per la nidificazione facet in una gerarchia.</span><span class="sxs-lookup"><span data-stu-id="09f30-257">As noted, there is no direct support for nesting facets in a hierarchy.</span></span> <span data-ttu-id="09f30-258">Per impostazione predefinita, l'esplorazione in base a facet in Ricerca di Azure supporta solo un livello di filtri.</span><span class="sxs-lookup"><span data-stu-id="09f30-258">By default, faceted navigation in Azure Search only supports one level of filters.</span></span> <span data-ttu-id="09f30-259">Tuttavia, esistono soluzioni alternative.</span><span class="sxs-lookup"><span data-stu-id="09f30-259">However, workarounds do exist.</span></span> <span data-ttu-id="09f30-260">È possibile codificare una struttura gerarchica facet in un `Collection(Edm.String)` con un punto di ingresso per singola gerarchia.</span><span class="sxs-lookup"><span data-stu-id="09f30-260">You can encode a hierarchical facet structure in a `Collection(Edm.String)` with one entry point per hierarchy.</span></span> <span data-ttu-id="09f30-261">L'implementazione di questa soluzione alternativa esula dall'ambito di questo articolo.</span><span class="sxs-lookup"><span data-stu-id="09f30-261">Implementing this workaround is beyond the scope of this article.</span></span> 

### <a name="querying-tips"></a><span data-ttu-id="09f30-262">Suggerimenti per le query</span><span class="sxs-lookup"><span data-stu-id="09f30-262">Querying tips</span></span>
<span data-ttu-id="09f30-263">**Convalidare i campi**</span><span class="sxs-lookup"><span data-stu-id="09f30-263">**Validate fields**</span></span>

<span data-ttu-id="09f30-264">Se si compila l'elenco di facet dinamicamente in base all'input dell'utente non attendibile, verificare che i nomi dei campi in base ai facet siano validi.</span><span class="sxs-lookup"><span data-stu-id="09f30-264">If you build the list of facets dynamically based on untrusted user input, validate that the names of the faceted fields are valid.</span></span> <span data-ttu-id="09f30-265">In alternativa, escluderne i nomi durante la creazione degli URL usando `Uri.EscapeDataString()` in .NET o l'equivalente nella piattaforma preferita.</span><span class="sxs-lookup"><span data-stu-id="09f30-265">Or, escape the names when building URLs by using either `Uri.EscapeDataString()` in .NET, or the equivalent in your platform of choice.</span></span>

### <a name="filtering-tips"></a><span data-ttu-id="09f30-266">Suggerimenti per i filtri</span><span class="sxs-lookup"><span data-stu-id="09f30-266">Filtering tips</span></span>
<span data-ttu-id="09f30-267">**Aumentare la precisione della ricerca con i filtri**</span><span class="sxs-lookup"><span data-stu-id="09f30-267">**Increase search precision with filters**</span></span>

<span data-ttu-id="09f30-268">Usare i filtri.</span><span class="sxs-lookup"><span data-stu-id="09f30-268">Use filters.</span></span> <span data-ttu-id="09f30-269">Se si usano solo le espressioni di ricerca, lo stemming può comportare la restituzione di un documento che non dispone del valore di facet esatto in uno dei relativi campi.</span><span class="sxs-lookup"><span data-stu-id="09f30-269">If you rely on just search expressions alone, stemming could cause a document to be returned that doesn’t have the precise facet value in any of its fields.</span></span>

<span data-ttu-id="09f30-270">**Aumentare le prestazioni della ricerca con i filtri**</span><span class="sxs-lookup"><span data-stu-id="09f30-270">**Increase search performance with filters**</span></span>

<span data-ttu-id="09f30-271">I filtri riducono il set di documenti candidati per la ricerca ed escluderli dalla classificazione.</span><span class="sxs-lookup"><span data-stu-id="09f30-271">Filters narrow down the set of candidate documents for search and exclude them from ranking.</span></span> <span data-ttu-id="09f30-272">Se si dispone di un ampio set di documenti, l'uso di un drill-down di facet selettivo spesso consente un miglioramento significativo delle prestazioni.</span><span class="sxs-lookup"><span data-stu-id="09f30-272">If you have a large set of documents, using a selective facet drill-down often gives you better performance.</span></span>
  
<span data-ttu-id="09f30-273">**Filtrare solo i campi con facet**</span><span class="sxs-lookup"><span data-stu-id="09f30-273">**Filter only the faceted fields**</span></span>

<span data-ttu-id="09f30-274">In un drill-down dell'esplorazione in base a facet, è possibile includere solo i documenti che contengono il valore del facet in un campo specifico (con facet), non in qualsiasi punto in tutti i campi disponibili per la ricerca.</span><span class="sxs-lookup"><span data-stu-id="09f30-274">In faceted drill-down, you typically want to only include documents that have the facet value in a specific (faceted) field, not anywhere across all searchable fields.</span></span> <span data-ttu-id="09f30-275">L'aggiunta di un filtro mette in evidenza il campo di destinazione indirizzando il servizio alla ricerca solo nel campo di esplorazione in base a facet per un valore corrispondente.</span><span class="sxs-lookup"><span data-stu-id="09f30-275">Adding a filter reinforces the target field by directing the service to search only in the faceted field for a matching value.</span></span>

<span data-ttu-id="09f30-276">**Ridurre i risultati di facet con altri filtri**</span><span class="sxs-lookup"><span data-stu-id="09f30-276">**Trim facet results with more filters**</span></span>

<span data-ttu-id="09f30-277">I risultati facet sono documenti trovati nei risultati della ricerca che corrispondono a un termine di facet.</span><span class="sxs-lookup"><span data-stu-id="09f30-277">Facet results are documents found in the search results that match a facet term.</span></span> <span data-ttu-id="09f30-278">Nell'esempio seguente, nei risultati della ricerca per il *cloud computing*, i 254 elementi dispongono inoltre di una *specifica interna* come tipo di contenuto.</span><span class="sxs-lookup"><span data-stu-id="09f30-278">In the following example, in search results for *cloud computing*, 254 items also have *internal specification* as a content type.</span></span> <span data-ttu-id="09f30-279">Gli elementi non si escludono necessariamente a vicenda.</span><span class="sxs-lookup"><span data-stu-id="09f30-279">Items are not necessarily mutually exclusive.</span></span> <span data-ttu-id="09f30-280">Se un elemento soddisfa i criteri di entrambi i filtri, viene conteggiato in ognuno di essi.</span><span class="sxs-lookup"><span data-stu-id="09f30-280">If an item meets the criteria of both filters, it is counted in each one.</span></span> <span data-ttu-id="09f30-281">Questa duplicazione è possibile quando si esegue l'esplorazione in base a facet su campi `Collection(Edm.String)` che vengono spesso usati per implementare l'aggiunta di tag nel documento.</span><span class="sxs-lookup"><span data-stu-id="09f30-281">This duplication is possible when faceting on `Collection(Edm.String)` fields, which are often used to implement document tagging.</span></span>

        Search term: "cloud computing"
        Content type
           Internal specification (254)
           Video (10) 

<span data-ttu-id="09f30-282">In generale, se si ritiene che i risultati dei facet siano costantemente troppo elevati, è consigliabile che aggiungere altri filtri per offrire agli utenti più opzioni per restringere la ricerca.</span><span class="sxs-lookup"><span data-stu-id="09f30-282">In general, if you find that facet results are consistently too large, we recommend that you add more filters to give users more options for narrowing the search.</span></span>

### <a name="tips-about-result-count"></a><span data-ttu-id="09f30-283">Suggerimenti sul conteggio dei risultati</span><span class="sxs-lookup"><span data-stu-id="09f30-283">Tips about result count</span></span>

<span data-ttu-id="09f30-284">**Limitare il numero di elementi nell'esplorazione in base a facet**</span><span class="sxs-lookup"><span data-stu-id="09f30-284">**Limit the number of items in the facet navigation**</span></span>

<span data-ttu-id="09f30-285">Per ogni campo di esplorazione in base a facet nella struttura di spostamento, esiste un limite predefinito di 10 valori.</span><span class="sxs-lookup"><span data-stu-id="09f30-285">For each faceted field in the navigation tree, there is a default limit of 10 values.</span></span> <span data-ttu-id="09f30-286">Questa impostazione predefinita risulta utile per le strutture di navigazione perché mantiene l'elenco di valori a un livello gestibile.</span><span class="sxs-lookup"><span data-stu-id="09f30-286">This default makes sense for navigation structures because it keeps the values list to a manageable size.</span></span> <span data-ttu-id="09f30-287">È possibile sostituire il valore predefinito assegnando un valore per il conteggio.</span><span class="sxs-lookup"><span data-stu-id="09f30-287">You can override the default by assigning a value to count.</span></span>

* <span data-ttu-id="09f30-288">`&facet=city,count:5` specifica che solo le prime 5 città incluse nei risultati migliori vengono restituite come risultato di facet.</span><span class="sxs-lookup"><span data-stu-id="09f30-288">`&facet=city,count:5` specifies that only the first five cities found in the top ranked results are returned as a facet result.</span></span> <span data-ttu-id="09f30-289">Si consideri una query di esempio con un termine di ricerca di "aeroporto" e 32 corrispondenze.</span><span class="sxs-lookup"><span data-stu-id="09f30-289">Consider a sample query with a search term of “airport” and 32 matches.</span></span> <span data-ttu-id="09f30-290">Se la query specifica `&facet=city,count:5`, solo le prime cinque città univoche con il maggior numero di documenti nei risultati della ricerca vengono incluse nei risultati del facet.</span><span class="sxs-lookup"><span data-stu-id="09f30-290">If the query specifies `&facet=city,count:5`, only the first five unique cities with the most documents in the search results are included in the facet results.</span></span>

<span data-ttu-id="09f30-291">Si noti la distinzione tra i risultati di facet e i risultati della ricerca.</span><span class="sxs-lookup"><span data-stu-id="09f30-291">Notice the distinction between facet results and search results.</span></span> <span data-ttu-id="09f30-292">I risultati della ricerca sono tutti i documenti che corrispondono alla query.</span><span class="sxs-lookup"><span data-stu-id="09f30-292">Search results are all the documents that match the query.</span></span> <span data-ttu-id="09f30-293">I risultati facet sono le corrispondenze per ogni valore del facet.</span><span class="sxs-lookup"><span data-stu-id="09f30-293">Facet results are the matches for each facet value.</span></span> <span data-ttu-id="09f30-294">Nell'esempio vengono restituiti nomi di città non presenti nell'elenco di classificazione dei facet, 5 nel nostro esempio.</span><span class="sxs-lookup"><span data-stu-id="09f30-294">In the example, search results include City names that are not in the facet classification list (5 in our example).</span></span> <span data-ttu-id="09f30-295">I risultati che vengono filtrati tramite l'esplorazione in base a facet diventano visibili quando si cancellano i facet o si scelgono altri facet oltre a città.</span><span class="sxs-lookup"><span data-stu-id="09f30-295">Results that are filtered out through faceted navigation become visible when you clear facets, or choose other facets besides City.</span></span> 

> [!NOTE]
> <span data-ttu-id="09f30-296">La discussione relativa a `count` quando ne esiste più di un tipo potrebbe portare a confusione.</span><span class="sxs-lookup"><span data-stu-id="09f30-296">Discussing `count` when there is more than one type can be confusing.</span></span> <span data-ttu-id="09f30-297">La tabella seguente offre un breve riepilogo di come viene usato il termine nell'API di Ricerca di Azure, nel codice di esempio e nella documentazione.</span><span class="sxs-lookup"><span data-stu-id="09f30-297">The following table offers a brief summary of how the term is used in Azure Search API, sample code, and documentation.</span></span> 

* `@colorFacet.count`<br/>
  <span data-ttu-id="09f30-298">Nel codice di presentazione, si noterà un parametro di conteggio del facet usato per visualizzare il numero di risultati facet.</span><span class="sxs-lookup"><span data-stu-id="09f30-298">In presentation code, you should see a count parameter on the facet, used to display the number of facet results.</span></span> <span data-ttu-id="09f30-299">Nei risultati facet, Conteggio indica il numero di documenti che corrispondono a un intervallo o termine facet.</span><span class="sxs-lookup"><span data-stu-id="09f30-299">In facet results, count indicates the number of documents that match on the facet term or range.</span></span>
* `&facet=City,count:12`<br/>
  <span data-ttu-id="09f30-300">In una query di facet, è possibile impostare il conteggio su un valore.</span><span class="sxs-lookup"><span data-stu-id="09f30-300">In a facet query, you can set count to a value.</span></span>  <span data-ttu-id="09f30-301">Il valore predefinito è 10, ma è possibile impostarlo a un livello superiore o inferiore.</span><span class="sxs-lookup"><span data-stu-id="09f30-301">The default is 10, but you can set it higher or lower.</span></span> <span data-ttu-id="09f30-302">L'impostazione `count:12` consente di recuperare le 12 corrispondenze principali nei risultati di facet per numero di documenti.</span><span class="sxs-lookup"><span data-stu-id="09f30-302">Setting `count:12` gets the top 12 matches in facet results by document count.</span></span>
* <span data-ttu-id="09f30-303">"`@odata.count`"</span><span class="sxs-lookup"><span data-stu-id="09f30-303">"`@odata.count`"</span></span><br/>
  <span data-ttu-id="09f30-304">Nella risposta alla query, questo valore indica il numero di elementi corrispondenti nei risultati della ricerca.</span><span class="sxs-lookup"><span data-stu-id="09f30-304">In the query response, this value indicates the number of matching items in the search results.</span></span> <span data-ttu-id="09f30-305">In media, è maggiore della somma di tutti i facet risultati combinati, a causa della presenza di elementi che corrispondono al termine di ricerca, ma senza corrispondenze di valore del facet.</span><span class="sxs-lookup"><span data-stu-id="09f30-305">On average, it’s larger than the sum of all facet results combined, due to the presence of items that match the search term, but have no facet value matches.</span></span>

<span data-ttu-id="09f30-306">**Ottenere i conteggi nei risultati di facet**</span><span class="sxs-lookup"><span data-stu-id="09f30-306">**Get counts in facet results**</span></span>

<span data-ttu-id="09f30-307">Quando si aggiunge un filtro a una query in base a facet, è possibile mantenere l'istruzione facet (ad esempio, `facet=Rating&$filter=Rating ge 4`).</span><span class="sxs-lookup"><span data-stu-id="09f30-307">When you add a filter to a faceted query, you might want to retain the facet statement (for example, `facet=Rating&$filter=Rating ge 4`).</span></span> <span data-ttu-id="09f30-308">Tecnicamente, facet=Rating non è necessaria, ma mantenerla permette di restituire i conteggi dei valori di facet per le classificazioni a 4 stelle e superiori.</span><span class="sxs-lookup"><span data-stu-id="09f30-308">Technically, facet=Rating isn’t needed, but keeping it returns the counts of facet values for ratings 4 and higher.</span></span> <span data-ttu-id="09f30-309">Ad esempio, se si fa clic su "4" e la query include un filtro per maggiore o uguale a "4", i conteggi vengono restituiti per ciascuna valutazione uguale a 4 e superiore.</span><span class="sxs-lookup"><span data-stu-id="09f30-309">For example, if you click "4" and the query includes a filter for greater or equal to "4", counts are returned for each rating that is 4 and higher.</span></span>  

<span data-ttu-id="09f30-310">**Verificare di ottenere conteggi di facet accurati**</span><span class="sxs-lookup"><span data-stu-id="09f30-310">**Make sure you get accurate facet counts**</span></span>

<span data-ttu-id="09f30-311">In determinate circostanze, si noterà che i conteggi facet non corrispondono ai set di risultati (vedere [navigazione collaborazione nella Ricerca di Azure (post di forum)](https://social.msdn.microsoft.com/Forums/azure/06461173-ea26-4e6a-9545-fbbd7ee61c8f/faceting-on-azure-search?forum=azuresearch)).</span><span class="sxs-lookup"><span data-stu-id="09f30-311">Under certain circumstances, you might find that facet counts do not match the result sets (see [Faceted navigation in Azure Search (forum post)](https://social.msdn.microsoft.com/Forums/azure/06461173-ea26-4e6a-9545-fbbd7ee61c8f/faceting-on-azure-search?forum=azuresearch)).</span></span>

<span data-ttu-id="09f30-312">I conteggi di facet possono essere inesatti grazie all'architettura di partizionamento orizzontale.</span><span class="sxs-lookup"><span data-stu-id="09f30-312">Facet counts can be inaccurate due to the sharding architecture.</span></span> <span data-ttu-id="09f30-313">Ogni indice di ricerca include più partizioni e ciascuno di essi segnala i principali N facet per numero di documenti, combinando poi i dati in un singolo risultato.</span><span class="sxs-lookup"><span data-stu-id="09f30-313">Every search index has multiple shards, and each shard reports the top N facets by document count, which is then combined into a single result.</span></span> <span data-ttu-id="09f30-314">Se alcune partizioni dispongono di numerosi valori corrispondenti a differenza di altre, è probabile che alcuni valori di facet siano mancanti o non calcolati nei risultati.</span><span class="sxs-lookup"><span data-stu-id="09f30-314">If some shards have many matching values, while others have fewer, you may find that some facet values are missing or under-counted in the results.</span></span>

<span data-ttu-id="09f30-315">Sebbene questo comportamento potrebbe cambiare in qualsiasi momento, se si verifica subito, è possibile risolverlo "gonfiando" artificialmente il conteggio:<number> per un numero elevato di documenti e applicare il report completo di ogni partizione.</span><span class="sxs-lookup"><span data-stu-id="09f30-315">Although this behavior could change at any time, if you encounter this behavior today, you can work around it by artificially inflating the count:<number> to a large number to enforce full reporting from each shard.</span></span> <span data-ttu-id="09f30-316">Se il valore del conteggio è maggiore o uguale al numero di valori univoci nel campo, vengono garantiti risultati accurati.</span><span class="sxs-lookup"><span data-stu-id="09f30-316">If the value of count: is greater than or equal to the number of unique values in the field, you are guaranteed accurate results.</span></span> <span data-ttu-id="09f30-317">Tuttavia, quando i conteggi di documenti sono elevati, si verifica una riduzione delle prestazioni ed è quindi consigliabile usare questa opzione con cautela.</span><span class="sxs-lookup"><span data-stu-id="09f30-317">However, when document counts are high, there is a performance penalty, so use this option judiciously.</span></span>

### <a name="user-interface-tips"></a><span data-ttu-id="09f30-318">Suggerimenti per l'interfaccia utente</span><span class="sxs-lookup"><span data-stu-id="09f30-318">User interface tips</span></span>
<span data-ttu-id="09f30-319">**Aggiungere etichette per ogni campo nella navigazione facet**</span><span class="sxs-lookup"><span data-stu-id="09f30-319">**Add labels for each field in facet navigation**</span></span>

<span data-ttu-id="09f30-320">Le etichette vengono in genere definite nel codice HTML o nel modulo (`index.cshtml` nell'applicazione di esempio).</span><span class="sxs-lookup"><span data-stu-id="09f30-320">Labels are typically defined in the HTML or form (`index.cshtml` in the sample application).</span></span> <span data-ttu-id="09f30-321">Non esiste alcuna API in Ricerca di Azure per le etichette di navigazione facet o qualsiasi altro metadato.</span><span class="sxs-lookup"><span data-stu-id="09f30-321">There is no API in Azure Search for facet navigation labels or any other metadata.</span></span>

<a name="rangefacets"></a>

## <a name="filter-based-on-a-range"></a><span data-ttu-id="09f30-322">Filtro basato su un intervallo</span><span class="sxs-lookup"><span data-stu-id="09f30-322">Filter based on a range</span></span>
<span data-ttu-id="09f30-323">L'esplorazione in base a facet su intervalli di valori è un requisito comune delle applicazioni di ricerca.</span><span class="sxs-lookup"><span data-stu-id="09f30-323">Faceting over ranges of values is a common search application requirement.</span></span> <span data-ttu-id="09f30-324">Gli intervalli sono supportati per i dati numerici e i valori DateTime.</span><span class="sxs-lookup"><span data-stu-id="09f30-324">Ranges are supported for numeric data and DateTime values.</span></span> <span data-ttu-id="09f30-325">Per ulteriori informazioni su ogni approccio in [Eseguire ricerche nei documenti (API di Ricerca di Azure)](http://msdn.microsoft.com/library/azure/dn798927.aspx).</span><span class="sxs-lookup"><span data-stu-id="09f30-325">You can read more about each approach in [Search Documents (Azure Search API)](http://msdn.microsoft.com/library/azure/dn798927.aspx).</span></span>

<span data-ttu-id="09f30-326">Ricerca di Azure semplifica la creazione degli intervalli fornendo due approcci per l'elaborazione di un intervallo.</span><span class="sxs-lookup"><span data-stu-id="09f30-326">Azure Search simplifies range construction by providing two approaches for computing a range.</span></span> <span data-ttu-id="09f30-327">Per entrambi gli approcci Ricerca di Azure crea gli intervalli appropriati in base agli input resi disponibili.</span><span class="sxs-lookup"><span data-stu-id="09f30-327">For both approaches, Azure Search creates the appropriate ranges given the inputs you’ve provided.</span></span> <span data-ttu-id="09f30-328">Ad esempio, se si specificano valori di intervallo di 10|20|30, vengono creati automaticamente gli intervalli 0-10, 10-20, 20-30.</span><span class="sxs-lookup"><span data-stu-id="09f30-328">For instance, if you specify range values of 10|20|30, it automatically creates ranges of 0-10, 10-20, 20-30.</span></span> <span data-ttu-id="09f30-329">L'applicazione può facoltativamente rimuovere qualsiasi intervallo vuoto.</span><span class="sxs-lookup"><span data-stu-id="09f30-329">Your application can optionally remove any intervals that are empty.</span></span> 

<span data-ttu-id="09f30-330">**Approccio 1: utilizzare il parametro intervallo**</span><span class="sxs-lookup"><span data-stu-id="09f30-330">**Approach 1: Use the interval parameter**</span></span>  
<span data-ttu-id="09f30-331">Per impostare i facet di prezzo in incrementi di 10 dollari, è necessario specificare: `&facet=price,interval:10`</span><span class="sxs-lookup"><span data-stu-id="09f30-331">To set price facets in $10 increments, you would specify: `&facet=price,interval:10`</span></span>

<span data-ttu-id="09f30-332">**Approccio 2: utilizzare un elenco di valori**</span><span class="sxs-lookup"><span data-stu-id="09f30-332">**Approach 2: Use a values list**</span></span>  
<span data-ttu-id="09f30-333">Per dati numerici, è possibile usare un elenco di valori.</span><span class="sxs-lookup"><span data-stu-id="09f30-333">For numeric data, you can use a values list.</span></span>  <span data-ttu-id="09f30-334">Prendere in considerazione l'intervallo di facet per il campo `listPrice`, sottoposto a rendering come segue:</span><span class="sxs-lookup"><span data-stu-id="09f30-334">Consider the facet range for a `listPrice` field, rendered as follows:</span></span>

  ![Elenco di valori di esempio][5]

<span data-ttu-id="09f30-336">Per specificare un intervallo di facet come quello nello screenshot precedente, usare un elenco di valori:</span><span class="sxs-lookup"><span data-stu-id="09f30-336">To specify a facet range like the one in the preceding screen shot, use a values list:</span></span>

    facet=listPrice,values:10|25|100|500|1000|2500

<span data-ttu-id="09f30-337">Ogni intervallo viene compilato usando 0 come punto di partenza e un valore dall'elenco come endpoint e quindi privato dell'intervallo precedente per creare intervalli discreti.</span><span class="sxs-lookup"><span data-stu-id="09f30-337">Each range is built using 0 as a starting point, a value from the list as an endpoint, and then trimmed of the previous range to create discrete intervals.</span></span> <span data-ttu-id="09f30-338">Ricerca di Azure esegue questa operazione nell'ambito dell'esplorazione in base facet.</span><span class="sxs-lookup"><span data-stu-id="09f30-338">Azure Search does these things as part of faceted navigation.</span></span> <span data-ttu-id="09f30-339">Non è necessario scrivere codice per la struttura di ogni intervallo.</span><span class="sxs-lookup"><span data-stu-id="09f30-339">You do not have to write code for structuring each interval.</span></span>

### <a name="build-a-filter-for-a-range"></a><span data-ttu-id="09f30-340">Creare un filtro per un intervallo</span><span class="sxs-lookup"><span data-stu-id="09f30-340">Build a filter for a range</span></span>
<span data-ttu-id="09f30-341">Per filtrare i documenti in base a un intervallo selezionato, è possibile usare gli operatori di filtro `"ge"` e `"lt"` in un'espressione in due parti che definisce gli endpoint dell'intervallo.</span><span class="sxs-lookup"><span data-stu-id="09f30-341">To filter documents based on a range you select, you can use the `"ge"` and `"lt"` filter operators in a two-part expression that defines the endpoints of the range.</span></span> <span data-ttu-id="09f30-342">Ad esempio, se si sceglie l'intervallo 10-25 per un campo `listPrice`, il filtro sarà `$filter=listPrice ge 10 and listPrice lt 25`.</span><span class="sxs-lookup"><span data-stu-id="09f30-342">For example, if you choose the range 10-25 for a `listPrice` field, the filter would be `$filter=listPrice ge 10 and listPrice lt 25`.</span></span> <span data-ttu-id="09f30-343">Nel codice di esempio l'espressione filtro usa i parametri **priceFrom** e **priceTo** per impostare gli endpoint.</span><span class="sxs-lookup"><span data-stu-id="09f30-343">In the sample code, the filter expression uses **priceFrom** and **priceTo** parameters to set the endpoints.</span></span> 

  ![Query per un intervallo di valori][6]

<a name="geofacets"></a> 

## <a name="filter-based-on-distance"></a><span data-ttu-id="09f30-345">Filtro basato sulla distanza</span><span class="sxs-lookup"><span data-stu-id="09f30-345">Filter based on distance</span></span>
<span data-ttu-id="09f30-346">È comune vedere filtri che consentono di scegliere un negozio, un ristorante o una destinazione in base alla prossimità alla posizione corrente.</span><span class="sxs-lookup"><span data-stu-id="09f30-346">It’s common to see filters that help you choose a store, restaurant, or destination based on its proximity to your current location.</span></span> <span data-ttu-id="09f30-347">Questo tipo di filtro potrebbe somigliare all'esplorazione in base a facet, ma è semplicemente un filtro.</span><span class="sxs-lookup"><span data-stu-id="09f30-347">While this type of filter might look like faceted navigation, it’s just a filter.</span></span> <span data-ttu-id="09f30-348">Viene menzionato per coloro che cercano in particolare consigli di implementazione per tale problema particolare di progettazione.</span><span class="sxs-lookup"><span data-stu-id="09f30-348">We mention it here for those of you who are specifically looking for implementation advice for that particular design problem.</span></span>

<span data-ttu-id="09f30-349">Sono disponibili due funzioni geospaziali in Ricerca di Azure, **geo.distance** e **geo.intersects**.</span><span class="sxs-lookup"><span data-stu-id="09f30-349">There are two Geospatial functions in Azure Search, **geo.distance** and **geo.intersects**.</span></span>

* <span data-ttu-id="09f30-350">La funzione **geo** restituisce la distanza in chilometri tra due punti.</span><span class="sxs-lookup"><span data-stu-id="09f30-350">The **geo.distance** function returns the distance in kilometers between two points.</span></span> <span data-ttu-id="09f30-351">Un punto è un campo e l'altro è una costante passata come parte del filtro.</span><span class="sxs-lookup"><span data-stu-id="09f30-351">One point is a field and other is a constant passed as part of the filter.</span></span> 
* <span data-ttu-id="09f30-352">La funzione **intersects** restituisce true se un punto specificato si trova all'interno di un poligono specificato.</span><span class="sxs-lookup"><span data-stu-id="09f30-352">The **geo.intersects** function returns true if a given point is within a given polygon.</span></span> <span data-ttu-id="09f30-353">Il punto è un campo e il poligono è specificato come un elenco costante di coordinate passate come parte del filtro.</span><span class="sxs-lookup"><span data-stu-id="09f30-353">The point is a field and the polygon is specified as a constant list of coordinates passed as part of the filter.</span></span>

<span data-ttu-id="09f30-354">È possibile trovare alcuni esempi di filtri in [Sintassi dell'espressione di OData (Ricerca di Azure)](http://msdn.microsoft.com/library/azure/dn798921.aspx).</span><span class="sxs-lookup"><span data-stu-id="09f30-354">You can find filter examples in [OData expression syntax (Azure Search)](http://msdn.microsoft.com/library/azure/dn798921.aspx).</span></span>

<a name="tryitout"></a>

## <a name="try-the-demo"></a><span data-ttu-id="09f30-355">Provare la demo</span><span class="sxs-lookup"><span data-stu-id="09f30-355">Try the demo</span></span>
<span data-ttu-id="09f30-356">Job Portal Demo di Ricerca di Azure contiene gli esempi descritti nel presente articolo.</span><span class="sxs-lookup"><span data-stu-id="09f30-356">The Azure Search Job Portal Demo contains the examples referenced in this article.</span></span>

-   <span data-ttu-id="09f30-357">Esaminare e testare la demo di lavoro online in [Job Portal Demo di Ricerca di Azure](http://azjobsdemo.azurewebsites.net/).</span><span class="sxs-lookup"><span data-stu-id="09f30-357">See and test the working demo online at [Azure Search Job Portal Demo](http://azjobsdemo.azurewebsites.net/).</span></span>

-   <span data-ttu-id="09f30-358">Scaricare il codice dal [repository di esempi di Azure su GitHub](https://github.com/Azure-Samples/search-dotnet-asp-net-mvc-jobs).</span><span class="sxs-lookup"><span data-stu-id="09f30-358">Download the code from the [Azure-Samples repo on GitHub](https://github.com/Azure-Samples/search-dotnet-asp-net-mvc-jobs).</span></span>

<span data-ttu-id="09f30-359">Quando si lavora con i risultati, controllare l'URL per le modifiche nella costruzione delle query.</span><span class="sxs-lookup"><span data-stu-id="09f30-359">As you work with search results, watch the URL for changes in query construction.</span></span> <span data-ttu-id="09f30-360">Questa applicazione è casualmente incaricata all'accodamento i facet all'URI a ogni selezione.</span><span class="sxs-lookup"><span data-stu-id="09f30-360">This application happens to append facets to the URI as you select each one.</span></span>

1. <span data-ttu-id="09f30-361">Per usare la funzionalità di mapping dell'app demo, ottenere una chiave Bing Mappe dal [Bing Maps Dev Center](https://www.bingmapsportal.com/).</span><span class="sxs-lookup"><span data-stu-id="09f30-361">To use the mapping functionality of the demo app, get a Bing Maps key from the [Bing Maps Dev Center](https://www.bingmapsportal.com/).</span></span> <span data-ttu-id="09f30-362">Incollare il codice sulla chiave esistente nella pagina `index.cshtml`.</span><span class="sxs-lookup"><span data-stu-id="09f30-362">Paste it over the existing key in the `index.cshtml` page.</span></span> <span data-ttu-id="09f30-363">L'impostazione `BingApiKey` nel file `Web.config` non viene usata.</span><span class="sxs-lookup"><span data-stu-id="09f30-363">The `BingApiKey` setting in the `Web.config` file is not used.</span></span> 

2. <span data-ttu-id="09f30-364">Eseguire l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="09f30-364">Run the application.</span></span> <span data-ttu-id="09f30-365">Iniziare la presentazione facoltativa o chiudere la finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="09f30-365">Take the optional tour, or dismiss the dialog box.</span></span>
   
3. <span data-ttu-id="09f30-366">Immettere un termine di ricerca, ad esempio "analyst" e fare clic sull'icona di ricerca.</span><span class="sxs-lookup"><span data-stu-id="09f30-366">Enter a search term, such as "analyst", and click the Search icon.</span></span> <span data-ttu-id="09f30-367">La query viene eseguita rapidamente.</span><span class="sxs-lookup"><span data-stu-id="09f30-367">The query executes quickly.</span></span>
   
   <span data-ttu-id="09f30-368">Una struttura di esplorazione in base a facet viene inoltre restituita con i risultati della ricerca.</span><span class="sxs-lookup"><span data-stu-id="09f30-368">A faceted navigation structure is also returned with the search results.</span></span> <span data-ttu-id="09f30-369">Nella pagina dei risultati di ricerca la struttura di esplorazione in base a facet include conteggi per ogni risultato facet.</span><span class="sxs-lookup"><span data-stu-id="09f30-369">In the search result page, the faceted navigation structure includes counts for each facet result.</span></span> <span data-ttu-id="09f30-370">Non sono stati selezionati facet e quindi vengono restituiti tutti i risultati corrispondenti.</span><span class="sxs-lookup"><span data-stu-id="09f30-370">No facets are selected, so all matching results are returned.</span></span>
   
   ![Risultati della ricerca prima della selezione di facet][11]

4. <span data-ttu-id="09f30-372">Fare clic su un valore per Business Title, Location o Minimum Salary.</span><span class="sxs-lookup"><span data-stu-id="09f30-372">Click a Business Title, Location, or Minimum Salary.</span></span> <span data-ttu-id="09f30-373">I facet sono null in una ricerca iniziale, ma come assumono i valori, vengono eliminati i risultati della ricerca di elementi che non corrispondono.</span><span class="sxs-lookup"><span data-stu-id="09f30-373">Facets were null on the initial search, but as they take on values, the search results are trimmed of items that no longer match.</span></span>
   
   ![Risultati della ricerca dopo la selezione di facet][12]

5. <span data-ttu-id="09f30-375">Per cancellare la query basata su facet in modo che sia possibile provare i comportamenti di query diversi, fare clic su `[X]` dopo i facet selezionati per cancellarli.</span><span class="sxs-lookup"><span data-stu-id="09f30-375">To clear the faceted query so that you can try different query behaviors, click the `[X]` after the selected facets to clear the facets.</span></span>
   
<a name="nextstep"></a>

## <a name="learn-more"></a><span data-ttu-id="09f30-376">Altre informazioni</span><span class="sxs-lookup"><span data-stu-id="09f30-376">Learn more</span></span>
<span data-ttu-id="09f30-377">Guardare [Azure Search Deep Dive](http://channel9.msdn.com/Events/TechEd/Europe/2014/DBI-B410) (Approfondimenti su Ricerca di Azure).</span><span class="sxs-lookup"><span data-stu-id="09f30-377">Watch [Azure Search Deep Dive](http://channel9.msdn.com/Events/TechEd/Europe/2014/DBI-B410).</span></span> <span data-ttu-id="09f30-378">Al minuto 45:25 è presente una dimostrazione su come implementare i facet.</span><span class="sxs-lookup"><span data-stu-id="09f30-378">At 45:25, there is a demo on how to implement facets.</span></span>

<span data-ttu-id="09f30-379">Per altre informazioni sui principi di progettazione per l'esplorazione in base a facet, è consigliabile usare i collegamenti seguenti:</span><span class="sxs-lookup"><span data-stu-id="09f30-379">For more insights on design principles for faceted navigation, we recommend the following links:</span></span>

* [<span data-ttu-id="09f30-380">Progettazione per la ricerca con esplorazione in base a facet</span><span class="sxs-lookup"><span data-stu-id="09f30-380">Designing for Faceted Search</span></span>](http://www.uie.com/articles/faceted_search/)
* [<span data-ttu-id="09f30-381">Modelli di progettazione: esplorazione in base a facet</span><span class="sxs-lookup"><span data-stu-id="09f30-381">Design Patterns: Faceted Navigation</span></span>](http://alistapart.com/article/design-patterns-faceted-navigation)


<!--Anchors-->
[How to build it]: #howtobuildit
[Build the presentation layer]: #presentationlayer
[Build the index]: #buildindex
[Check for data quality]: #checkdata
[Build the query]: #buildquery
[Tips on how to control faceted navigation]: #tips
[Faceted navigation based on range values]: #rangefacets
[Faceted navigation based on GeoPoints]: #geofacets
[Try it out]: #tryitout

<!--Image references-->
[1]: ./media/search-faceted-navigation/azure-search-faceting-example.PNG
[2]: ./media/search-faceted-navigation/Facet-2-CSHTML.PNG
[3]: ./media/search-faceted-navigation/Facet-3-schema.PNG
[4]: ./media/search-faceted-navigation/Facet-4-SearchMethod.PNG
[5]: ./media/search-faceted-navigation/Facet-5-Prices.PNG
[6]: ./media/search-faceted-navigation/Facet-6-buildfilter.PNG
[7]: ./media/search-faceted-navigation/Facet-7-appstart.png
[8]: ./media/search-faceted-navigation/Facet-8-appbike.png
[9]: ./media/search-faceted-navigation/Facet-9-appbikefaceted.png
[10]: ./media/search-faceted-navigation/Facet-10-appTitle.png
[11]: ./media/search-faceted-navigation/faceted-search-before-facets.png
[12]: ./media/search-faceted-navigation/faceted-search-after-facets.png

<!--Link references-->
[Designing for Faceted Search]: http://www.uie.com/articles/faceted_search/
[Design Patterns: Faceted Navigation]: http://alistapart.com/article/design-patterns-faceted-navigation
[Create your first application]: search-create-first-solution.md
[OData expression syntax (Azure Search)]: http://msdn.microsoft.com/library/azure/dn798921.aspx
[Azure Search Adventure Works Demo]: https://azuresearchadventureworksdemo.codeplex.com/
[http://www.odata.org/documentation/odata-version-2-0/overview/]: http://www.odata.org/documentation/odata-version-2-0/overview/ 
[Faceting on Azure Search forum post]: ../faceting-on-azure-search.md?forum=azuresearch
[Search Documents (Azure Search API)]: http://msdn.microsoft.com/library/azure/dn798927.aspx

