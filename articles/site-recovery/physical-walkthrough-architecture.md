---
title: architettura di hello aaaReview per server fisico replica tooAzure usando Azure Site Recovery | Documenti Microsoft
description: In questo articolo viene fornita una panoramica dei componenti e architettura utilizzata per la replica locale server fisici tooAzure con hello servizio Azure Site Recovery
services: site-recovery
documentationcenter: 
author: rayne-wiselman
manager: carmonm
editor: 
ms.assetid: 09c9b136-35f5-465e-8d0f-f4c5d5d9f880
ms.service: site-recovery
ms.workload: storage-backup-recovery
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 06/27/2017
ms.author: raynew
ms.openlocfilehash: 4f334c181fa6f0821adf978ebe9dbd7d36a3c753
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/06/2017
---
# <a name="step-1-review-hello-architecture-for-physical-server-replication-tooazure"></a><span data-ttu-id="b9c7d-103">Passaggio 1: Esaminare l'architettura di hello per tooAzure replica server fisico</span><span class="sxs-lookup"><span data-stu-id="b9c7d-103">Step 1: Review hello architecture for physical server replication tooAzure</span></span>

<span data-ttu-id="b9c7d-104">In questo articolo vengono descritti i componenti di hello e processi utilizzati durante la replica locale tooAzure di server fisici Windows/Linux, usando hello [Azure Site Recovery](site-recovery-overview.md) servizio.</span><span class="sxs-lookup"><span data-stu-id="b9c7d-104">This article describes hello components and processes used when you replicate on-premises Windows/Linux physical servers tooAzure, using hello [Azure Site Recovery](site-recovery-overview.md) service.</span></span>

<span data-ttu-id="b9c7d-105">Inviare eventuali commenti nella parte inferiore di hello di questo articolo, o porre domande in hello [forum sui servizi di ripristino di Azure](https://social.msdn.microsoft.com/forums/azure/home?forum=hypervrecovmgr).</span><span class="sxs-lookup"><span data-stu-id="b9c7d-105">Post any comments at hello bottom of this article, or ask questions in hello [Azure Recovery Services Forum](https://social.msdn.microsoft.com/forums/azure/home?forum=hypervrecovmgr).</span></span>


## <a name="architectural-components"></a><span data-ttu-id="b9c7d-106">Componenti dell'architettura</span><span class="sxs-lookup"><span data-stu-id="b9c7d-106">Architectural components</span></span>

<span data-ttu-id="b9c7d-107">tabella Hello vengono riepilogati i componenti di hello che è necessario.</span><span class="sxs-lookup"><span data-stu-id="b9c7d-107">hello table summarizes hello components you need.</span></span>

<span data-ttu-id="b9c7d-108">**Componente**</span><span class="sxs-lookup"><span data-stu-id="b9c7d-108">**Component**</span></span> | <span data-ttu-id="b9c7d-109">**Requisito**</span><span class="sxs-lookup"><span data-stu-id="b9c7d-109">**Requirement**</span></span> | <span data-ttu-id="b9c7d-110">**Dettagli**</span><span class="sxs-lookup"><span data-stu-id="b9c7d-110">**Details**</span></span>
--- | --- | ---
<span data-ttu-id="b9c7d-111">**Azzurro**</span><span class="sxs-lookup"><span data-stu-id="b9c7d-111">**Azure**</span></span> | <span data-ttu-id="b9c7d-112">Sono necessari un account di Azure, un account di archiviazione di Azure e una rete di Azure.</span><span class="sxs-lookup"><span data-stu-id="b9c7d-112">You need an Azure account, an Azure storage account, and an Azure network.</span></span> | <span data-ttu-id="b9c7d-113">Dati replicati vengono archiviati nell'account di archiviazione hello e macchine virtuali di Azure vengono create con i dati replicato hello quando si verifica il failover.</span><span class="sxs-lookup"><span data-stu-id="b9c7d-113">Replicated data is stored in hello storage account, and Azure VMs are created with hello replicated data when failover occurs.</span></span> <span data-ttu-id="b9c7d-114">Macchine virtuali di Azure connettono toohello rete virtuale di Azure quando vengono creati.</span><span class="sxs-lookup"><span data-stu-id="b9c7d-114">Azure VMs connect toohello Azure virtual network when they're created.</span></span>
<span data-ttu-id="b9c7d-115">**Server di configurazione**</span><span class="sxs-lookup"><span data-stu-id="b9c7d-115">**Configuration server**</span></span> | <span data-ttu-id="b9c7d-116">Un singolo server di gestione (server fisico o VMware VM) che esegue i componenti di Site Recovery tutte hello in locale in locale.</span><span class="sxs-lookup"><span data-stu-id="b9c7d-116">A single on-premises management server (physical server or VMware VM) that runs all hello on-premises Site Recovery components.</span></span> <span data-ttu-id="b9c7d-117">Sono inclusi un server di configurazione, un server di elaborazione e un server di destinazione master.</span><span class="sxs-lookup"><span data-stu-id="b9c7d-117">These include a configuration server, process server, master target server.</span></span> | <span data-ttu-id="b9c7d-118">componente server di configurazione Hello coordina le comunicazioni tra sedi locali e Azure e gestisce la replica dei dati.</span><span class="sxs-lookup"><span data-stu-id="b9c7d-118">hello configuration server component coordinates communications between on-premises and Azure, and manages data replication.</span></span>
 <span data-ttu-id="b9c7d-119">**Server di elaborazione**</span><span class="sxs-lookup"><span data-stu-id="b9c7d-119">**Process server**</span></span>  | <span data-ttu-id="b9c7d-120">Installato per impostazione predefinita nel server di configurazione hello.</span><span class="sxs-lookup"><span data-stu-id="b9c7d-120">Installed by default on hello configuration server.</span></span> | <span data-ttu-id="b9c7d-121">Agisce come un gateway di replica.</span><span class="sxs-lookup"><span data-stu-id="b9c7d-121">Acts as a replication gateway.</span></span> <span data-ttu-id="b9c7d-122">Riceve dati di replica, consente di ottimizzare con la memorizzazione nella cache, la compressione e crittografia e lo invia tooAzure archiviazione.</span><span class="sxs-lookup"><span data-stu-id="b9c7d-122">Receives replication data, optimizes it with caching, compression, and encryption, and sends it tooAzure storage.</span></span><br/><br/> <span data-ttu-id="b9c7d-123">server di elaborazione Hello gestisce inoltre l'installazione push del computer tooprotected del servizio di mobilità hello.</span><span class="sxs-lookup"><span data-stu-id="b9c7d-123">hello process server also handles push installation of hello Mobility service tooprotected machines.</span></span><br/><br/> <span data-ttu-id="b9c7d-124">È possibile aggiungere i server aggiuntivi processo dedicato separato, toohandle aumentare i volumi di traffico di replica.</span><span class="sxs-lookup"><span data-stu-id="b9c7d-124">You can add additional separate dedicated process servers, toohandle increasing volumes of replication traffic.</span></span>
 <span data-ttu-id="b9c7d-125">**Server master di destinazione**</span><span class="sxs-lookup"><span data-stu-id="b9c7d-125">**Master target server**</span></span> | <span data-ttu-id="b9c7d-126">Installato per impostazione predefinita nel server di configurazione di on-premise hello.</span><span class="sxs-lookup"><span data-stu-id="b9c7d-126">Installed by default on hello on-premises configuration server.</span></span> | <span data-ttu-id="b9c7d-127">Gestisce i dati di replica durante il failback da Azure.</span><span class="sxs-lookup"><span data-stu-id="b9c7d-127">Handles replication data during failback from Azure.</span></span><br/><br/> <span data-ttu-id="b9c7d-128">Se i volumi del traffico di failback sono elevati, è possibile distribuire un server di destinazione master separato per il failback.</span><span class="sxs-lookup"><span data-stu-id="b9c7d-128">If volumes of failback traffic are high, you can deploy a separate master target server for failback.</span></span>
<span data-ttu-id="b9c7d-129">**Server replicati**</span><span class="sxs-lookup"><span data-stu-id="b9c7d-129">**Replicated servers**</span></span> | <span data-ttu-id="b9c7d-130">Hello componente del servizio di mobilità è installato in ogni server di Windows/Linux si desidera tooreplicate.</span><span class="sxs-lookup"><span data-stu-id="b9c7d-130">hello Mobility service component is installed on each Windows/Linux server you want tooreplicate.</span></span> <span data-ttu-id="b9c7d-131">Può essere installato manualmente su ogni computer o con un'installazione push dal server di elaborazione hello.</span><span class="sxs-lookup"><span data-stu-id="b9c7d-131">It can be installed manually on each machine, or with a push installation from hello process server.</span></span>
<span data-ttu-id="b9c7d-132">**Failback**</span><span class="sxs-lookup"><span data-stu-id="b9c7d-132">**Failback**</span></span> | <span data-ttu-id="b9c7d-133">Per il failback è necessaria un'infrastruttura VMware.</span><span class="sxs-lookup"><span data-stu-id="b9c7d-133">For failback a VMware infrastructure is required.</span></span> <span data-ttu-id="b9c7d-134">È possibile eseguire il server fisico tooa indietro.</span><span class="sxs-lookup"><span data-stu-id="b9c7d-134">You can't fail back tooa physical server.</span></span>


<span data-ttu-id="b9c7d-135">**Figura 1: I componenti fisici tooAzure**</span><span class="sxs-lookup"><span data-stu-id="b9c7d-135">**Figure 1: Physical tooAzure components**</span></span>

![Componenti](./media/physical-walkthrough-architecture/arch-enhanced.png)

## <a name="replication-process"></a><span data-ttu-id="b9c7d-137">Processo di replica</span><span class="sxs-lookup"><span data-stu-id="b9c7d-137">Replication process</span></span>

1. <span data-ttu-id="b9c7d-138">Impostare la distribuzione di hello, inclusi i componenti di Azure e locali.</span><span class="sxs-lookup"><span data-stu-id="b9c7d-138">You set up hello deployment, including on-premises and Azure components.</span></span> <span data-ttu-id="b9c7d-139">Nell'insieme di credenziali con servizi di ripristino di hello specificare origine della replica hello e destinazione, configurare il server di configurazione di hello, creare un criterio di replica, distribuire il servizio di mobilità hello, abilitare la replica ed eseguire un failover di test.</span><span class="sxs-lookup"><span data-stu-id="b9c7d-139">In hello Recovery Services vault, you specify hello replication source and target, set up hello configuration server, create a replication policy, deploy hello Mobility service, enable replication, and run a test failover.</span></span>
2.  <span data-ttu-id="b9c7d-140">Replicare macchine in base ai criteri di replica hello e una copia iniziale dei dati hello è archiviazione tooAzure replicati.</span><span class="sxs-lookup"><span data-stu-id="b9c7d-140">Machines replicate in accordance with hello replication policy, and an initial copy of hello data is replicated tooAzure storage.</span></span>
4. <span data-ttu-id="b9c7d-141">Al termine della replica iniziale, avvia la replica di tooAzure le modifiche delta.</span><span class="sxs-lookup"><span data-stu-id="b9c7d-141">After initial replication finishes, replication of delta changes tooAzure begins.</span></span> <span data-ttu-id="b9c7d-142">Le modifiche rilevate vengono salvate in un file HRL.</span><span class="sxs-lookup"><span data-stu-id="b9c7d-142">Tracked changes for a machine are held in a .hrl file.</span></span>
    - <span data-ttu-id="b9c7d-143">La replica macchine comunicano con server di configurazione hello sulla porta HTTPS 443 in entrata per la gestione della replica.</span><span class="sxs-lookup"><span data-stu-id="b9c7d-143">Replicating machines communicate with hello configuration server on port HTTPS 443 inbound, for replication management.</span></span>
    - <span data-ttu-id="b9c7d-144">La replica macchine inviano server di elaborazione toohello dati di replica sulla porta HTTPS 9443 in ingresso (può essere modificato).</span><span class="sxs-lookup"><span data-stu-id="b9c7d-144">Replicating machines send replication data toohello process server on port HTTPS 9443 inbound (can be modified).</span></span>
    - <span data-ttu-id="b9c7d-145">il server di configurazione di Hello Orchestra la gestione di replica in Azure tramite la porta HTTPS 443 in uscita.</span><span class="sxs-lookup"><span data-stu-id="b9c7d-145">hello configuration server orchestrates replication management with Azure over port HTTPS 443 outbound.</span></span>
    - <span data-ttu-id="b9c7d-146">server di elaborazione Hello riceve dati dal computer di origine, Ottimizza e crittografa e invia tooAzure archiviazione tramite la porta 443 in uscita.</span><span class="sxs-lookup"><span data-stu-id="b9c7d-146">hello process server receives data from source machines, optimizes and encrypts it, and sends it tooAzure storage over port 443 outbound.</span></span>
    - <span data-ttu-id="b9c7d-147">Se si abilita la coerenza tra più macchine, quindi nel gruppo di replica hello macchine comunicano tra loro attraverso la porta 20004.</span><span class="sxs-lookup"><span data-stu-id="b9c7d-147">If you enable multi-VM consistency, then machines in hello replication group communicate with each other over port 20004.</span></span> <span data-ttu-id="b9c7d-148">La coerenza tra più VM viene usata se si raggruppano più computer in gruppi di replica che condividono punti di ripristino coerenti con l'arresto anomalo del sistema e coerenti con l'app quando si esegue il failover.</span><span class="sxs-lookup"><span data-stu-id="b9c7d-148">Multi-VM is used if you group multiple machines into replication groups that share crash-consistent and app-consistent recovery points when they fail over.</span></span> <span data-ttu-id="b9c7d-149">Ciò è utile se sono in esecuzione macchine hello stesso carico di lavoro ed è necessario toobe coerente.</span><span class="sxs-lookup"><span data-stu-id="b9c7d-149">This is useful if machines are running hello same workload and need toobe consistent.</span></span>
5. <span data-ttu-id="b9c7d-150">Il traffico è superiore all'endpoint pubblici di archiviazione replicata tooAzure, hello internet.</span><span class="sxs-lookup"><span data-stu-id="b9c7d-150">Traffic is replicated tooAzure storage public endpoints, over hello internet.</span></span> <span data-ttu-id="b9c7d-151">In alternativa, è possibile usare il [peering pubblico](../expressroute/expressroute-circuit-peerings.md#public-peering) di Azure ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="b9c7d-151">Alternately, you can use Azure ExpressRoute [public peering](../expressroute/expressroute-circuit-peerings.md#public-peering).</span></span> <span data-ttu-id="b9c7d-152">Non è supportata la replica del traffico tramite una VPN da sito a sito da un tooAzure sito locale.</span><span class="sxs-lookup"><span data-stu-id="b9c7d-152">Replicating traffic over a site-to-site VPN from an on-premises site tooAzure isn't supported.</span></span>

<span data-ttu-id="b9c7d-153">**Figura 2: TooAzure fisico replica**</span><span class="sxs-lookup"><span data-stu-id="b9c7d-153">**Figure 2: Physical tooAzure replication**</span></span>

![Avanzato](./media/physical-walkthrough-architecture/v2a-architecture-henry.png)

## <a name="failover-and-failback-process"></a><span data-ttu-id="b9c7d-155">Processo di failover e failback</span><span class="sxs-lookup"><span data-stu-id="b9c7d-155">Failover and failback process</span></span>

<span data-ttu-id="b9c7d-156">Dopo aver verificato che il failover di test funzioni come previsto, è possibile eseguire failover pianificati tooAzure come richiesto.</span><span class="sxs-lookup"><span data-stu-id="b9c7d-156">After you verify that test failover is working as expected, you can run unplanned failovers tooAzure as required.</span></span> <span data-ttu-id="b9c7d-157">Quando si esegue un failover, vengono create VM di Azure dai dati replicati.</span><span class="sxs-lookup"><span data-stu-id="b9c7d-157">When you run a failover, Azure VMs are created from replicated data.</span></span> <span data-ttu-id="b9c7d-158">Quando il sito locale primario è di nuovo disponibile, è quindi possibile effettuare il failback.</span><span class="sxs-lookup"><span data-stu-id="b9c7d-158">Then, when your primary on-premises site is available again, you can fail back.</span></span> <span data-ttu-id="b9c7d-159">Si noti che:</span><span class="sxs-lookup"><span data-stu-id="b9c7d-159">Note that:</span></span>

- <span data-ttu-id="b9c7d-160">Il failover pianificato non è supportato.</span><span class="sxs-lookup"><span data-stu-id="b9c7d-160">Planned failover isn't supported.</span></span>
- <span data-ttu-id="b9c7d-161">È possibile eseguire il failover a un singolo computer o creare [i piani di ripristino](site-recovery-create-recovery-plans.md), toofail su più computer contemporaneamente.</span><span class="sxs-lookup"><span data-stu-id="b9c7d-161">You can fail over a single machine, or create [recovery plans](site-recovery-create-recovery-plans.md), toofail over multiple machines together.</span></span>
- <span data-ttu-id="b9c7d-162">Si esegue il commit di un failover toostart accesso hello carico di lavoro dalla replica hello macchina virtuale di Azure.</span><span class="sxs-lookup"><span data-stu-id="b9c7d-162">You commit a failover toostart accessing hello workload from hello replica Azure VM.</span></span>
- <span data-ttu-id="b9c7d-163">Quando è nuovamente disponibile il sito primario di hello, macchina hello vengono replicati dal sito primario di hello toohello secondario.</span><span class="sxs-lookup"><span data-stu-id="b9c7d-163">When hello primary site is available again, you replicate hello machine from hello secondary toohello primary site.</span></span> <span data-ttu-id="b9c7d-164">Quindi, eseguire un failover non pianificato da sito secondario hello.</span><span class="sxs-lookup"><span data-stu-id="b9c7d-164">Then, run an unplanned failover from hello secondary site.</span></span> <span data-ttu-id="b9c7d-165">Dopo il commit, il failover dati sarà nascosto in locale e occorre tooenable replica tooAzure nuovamente.</span><span class="sxs-lookup"><span data-stu-id="b9c7d-165">After you commit this failover, data will be back on-premises, and you need tooenable replication tooAzure again.</span></span>

<span data-ttu-id="b9c7d-166">I componenti di failback includono:</span><span class="sxs-lookup"><span data-stu-id="b9c7d-166">Failback components include:</span></span>

- <span data-ttu-id="b9c7d-167">**Server di elaborazione temporaneo in Azure**: È necessario tooset di una macchina virtuale di Azure tooact come un server di elaborazione, la replica di toohandle da Azure.</span><span class="sxs-lookup"><span data-stu-id="b9c7d-167">**Temporary process server in Azure**: You need tooset up an Azure VM tooact as a process server, toohandle replication from Azure.</span></span> <span data-ttu-id="b9c7d-168">Questa VM può essere eliminata al termine del failback.</span><span class="sxs-lookup"><span data-stu-id="b9c7d-168">You can delete this VM after failback finishes.</span></span>
- <span data-ttu-id="b9c7d-169">**Connessione VPN**: È necessario una connessione VPN (o Azure ExpressRoute) da sito locale toohello rete Azure di hello.</span><span class="sxs-lookup"><span data-stu-id="b9c7d-169">**VPN connection**: You need a VPN connection (or Azure ExpressRoute) from hello Azure network toohello on-premises site.</span></span>
- <span data-ttu-id="b9c7d-170">**Server di destinazione master locale separato**: server di destinazione master locale hello (installato per impostazione predefinita nel server di configurazione hello) gestisce il failback.</span><span class="sxs-lookup"><span data-stu-id="b9c7d-170">**Separate on-premises master target server**: hello on-premises master target server (installed by default on hello configuration server) handles failback.</span></span> <span data-ttu-id="b9c7d-171">Se si effettua il failback di grandi volumi di traffico, è consigliabile configurare un server di destinazione master locale distinto a questo scopo.</span><span class="sxs-lookup"><span data-stu-id="b9c7d-171">If you fail back large volumes of traffic, you should set up a separate on-premises master target server for this purpose.</span></span>
- <span data-ttu-id="b9c7d-172">**Criteri di failback**: sono necessari criteri di failback.</span><span class="sxs-lookup"><span data-stu-id="b9c7d-172">**Failback policy**: You need a failback policy.</span></span> <span data-ttu-id="b9c7d-173">che viene creato automaticamente quando si crea il criterio di replica.</span><span class="sxs-lookup"><span data-stu-id="b9c7d-173">This is automatically created when you created your replication policy.</span></span>
- <span data-ttu-id="b9c7d-174">**Infrastruttura VMware**: È necessario eseguire il failback tooan locale VM VMware.</span><span class="sxs-lookup"><span data-stu-id="b9c7d-174">**VMware infrastructure**: You must fail back tooan on-premises VMware VM.</span></span> <span data-ttu-id="b9c7d-175">Il che richiede un'infrastruttura VMware in locale, anche se si esegue la replica tooAzure server fisici locali.</span><span class="sxs-lookup"><span data-stu-id="b9c7d-175">This means you need an on-premises VMware infrastructure, even if you're replicating on-premises physical servers tooAzure.</span></span>

<span data-ttu-id="b9c7d-176">**Figura 3: Failback del server fisico**</span><span class="sxs-lookup"><span data-stu-id="b9c7d-176">**Figure 3: Physical server failback**</span></span>

![Failback](./media/physical-walkthrough-architecture/enhanced-failback.png)


## <a name="next-steps"></a><span data-ttu-id="b9c7d-178">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="b9c7d-178">Next steps</span></span>

<span data-ttu-id="b9c7d-179">Andare troppo[passaggio 2: verificare i prerequisiti e limitazioni](physical-walkthrough-prerequisites.md)</span><span class="sxs-lookup"><span data-stu-id="b9c7d-179">Go too[Step 2: Verify prerequisites and limitations](physical-walkthrough-prerequisites.md)</span></span>
