---
title: Uso delle firme di accesso condiviso in Archiviazione di Azure | Documentazione Microsoft
description: Informazioni su come usare le firme di accesso condiviso per delegare l'accesso alle risorse di Archiviazione di Azure, tra cui BLOB, code, tabelle e file.
services: storage
documentationcenter: 
author: mmacy
manager: timlt
editor: tysonn
ms.assetid: 46fd99d7-36b3-4283-81e3-f214b29f1152
ms.service: storage
ms.workload: storage
ms.tgt_pltfrm: na
ms.devlang: dotnet
ms.topic: article
ms.date: 04/18/2017
ms.author: marsma
ms.openlocfilehash: a753fd481c9f91d94b6a2bd3633142e2dddedaec
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/29/2017
---
# <a name="using-shared-access-signatures-sas"></a><span data-ttu-id="d9665-103">Uso delle firme di accesso condiviso</span><span class="sxs-lookup"><span data-stu-id="d9665-103">Using shared access signatures (SAS)</span></span>

<span data-ttu-id="d9665-104">Una firma di accesso condiviso costituisce un potente strumento per concedere ad altri client l'accesso limitato agli oggetti dell'account di archiviazione, senza dover esporre la chiave dell'account.</span><span class="sxs-lookup"><span data-stu-id="d9665-104">A shared access signature (SAS) provides you with a way to grant limited access to objects in your storage account to other clients, without exposing your account key.</span></span> <span data-ttu-id="d9665-105">In questo articolo è fornita una panoramica del modello di firma di accesso condiviso e delle procedure consigliate per la firma di accesso condiviso con alcuni esempi.</span><span class="sxs-lookup"><span data-stu-id="d9665-105">In this article, we provide an overview of the SAS model, review SAS best practices, and look at some examples.</span></span>

<span data-ttu-id="d9665-106">Per altri esempi di codice che usano la firma di accesso condiviso, oltre a quelli già presentati qui, vedere [Introduzione all'archiviazione BLOB di Azure con .NET](https://azure.microsoft.com/documentation/samples/storage-blob-dotnet-getting-started/) e altri esempi disponibili nella libreria [Esempi di codice per Azure](https://azure.microsoft.com/documentation/samples/?service=storage).</span><span class="sxs-lookup"><span data-stu-id="d9665-106">For additional code examples using SAS beyond those presented here, see [Getting Started with Azure Blob Storage in .NET](https://azure.microsoft.com/documentation/samples/storage-blob-dotnet-getting-started/) and other samples available in the [Azure Code Samples](https://azure.microsoft.com/documentation/samples/?service=storage) library.</span></span> <span data-ttu-id="d9665-107">È possibile scaricare le applicazioni di esempio ed eseguirle oppure esaminare il codice in GitHub.</span><span class="sxs-lookup"><span data-stu-id="d9665-107">You can download the sample applications and run them, or browse the code on GitHub.</span></span>

## <a name="what-is-a-shared-access-signature"></a><span data-ttu-id="d9665-108">Informazioni sulle firme di accesso condiviso</span><span class="sxs-lookup"><span data-stu-id="d9665-108">What is a shared access signature?</span></span>
<span data-ttu-id="d9665-109">Una firma di accesso condiviso fornisce accesso delegato controllato alle risorse dell'account di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="d9665-109">A shared access signature provides delegated access to resources in your storage account.</span></span> <span data-ttu-id="d9665-110">Con una firma di accesso condiviso è possibile concedere ai client l'accesso alle risorse nell'account di archiviazione, senza condividere le chiavi dell'account.</span><span class="sxs-lookup"><span data-stu-id="d9665-110">With a SAS, you can grant clients access to resources in your storage account, without sharing your account keys.</span></span> <span data-ttu-id="d9665-111">Questo è il punto chiave associato all'uso delle firme di accesso condiviso nelle applicazioni: una firma di accesso condiviso rappresenta un metodo sicuro per condividere le risorse di archiviazione senza compromettere le chiavi dell'account.</span><span class="sxs-lookup"><span data-stu-id="d9665-111">This is the key point of using shared access signatures in your applications--a SAS is a secure way to share your storage resources without compromising your account keys.</span></span>

[!INCLUDE [storage-account-key-note-include](../../../includes/storage-account-key-note-include.md)]

<span data-ttu-id="d9665-112">Una firma di accesso condiviso assicura un controllo granulare sul tipo di accesso concesso ai client che dispongono di firma di accesso condiviso, tra cui:</span><span class="sxs-lookup"><span data-stu-id="d9665-112">A SAS gives you granular control over the type of access you grant to clients who have the SAS, including:</span></span>

* <span data-ttu-id="d9665-113">L'intervallo di validità della firma di accesso condiviso, incluse l'ora di inizio e quella di scadenza.</span><span class="sxs-lookup"><span data-stu-id="d9665-113">The interval over which the SAS is valid, including the start time and the expiry time.</span></span>
* <span data-ttu-id="d9665-114">Le autorizzazioni concesse dalla firma di accesso condiviso.</span><span class="sxs-lookup"><span data-stu-id="d9665-114">The permissions granted by the SAS.</span></span> <span data-ttu-id="d9665-115">Ad esempio, una firma di accesso condiviso per un BLOB potrebbe concedere le autorizzazioni di lettura e di scrittura per questo BLOB, ma non eliminare le autorizzazioni.</span><span class="sxs-lookup"><span data-stu-id="d9665-115">For example, a SAS for a blob might grant read and write permissions to that blob, but not delete permissions.</span></span>
* <span data-ttu-id="d9665-116">Un indirizzo IP facoltativo o un intervallo di indirizzi IP dai quali Archiviazione di Azure accetterà la firma di accesso condiviso.</span><span class="sxs-lookup"><span data-stu-id="d9665-116">An optional IP address or range of IP addresses from which Azure Storage will accept the SAS.</span></span> <span data-ttu-id="d9665-117">Ad esempio, è possibile specificare un intervallo di indirizzi IP appartenenti all'organizzazione.</span><span class="sxs-lookup"><span data-stu-id="d9665-117">For example, you might specify a range of IP addresses belonging to your organization.</span></span>
* <span data-ttu-id="d9665-118">Il protocollo su cui Archiviazione di Azure accetterà la firma di accesso condiviso.</span><span class="sxs-lookup"><span data-stu-id="d9665-118">The protocol over which Azure Storage will accept the SAS.</span></span> <span data-ttu-id="d9665-119">È possibile usare questo parametro facoltativo per limitare l'accesso ai client tramite HTTPS.</span><span class="sxs-lookup"><span data-stu-id="d9665-119">You can use this optional parameter to restrict access to clients using HTTPS.</span></span>

## <a name="when-should-you-use-a-shared-access-signature"></a><span data-ttu-id="d9665-120">Perché usare una firma di accesso condiviso</span><span class="sxs-lookup"><span data-stu-id="d9665-120">When should you use a shared access signature?</span></span>
<span data-ttu-id="d9665-121">È possibile usare una firma di accesso condiviso quando si desidera fornire l'accesso alle risorse dell'account di archiviazione a un client che non possiede le chiavi di accesso dell'account di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="d9665-121">You can use a SAS when you want to provide access to resources in your storage account to any client not possessing your storage account's access keys.</span></span> <span data-ttu-id="d9665-122">L'account di archiviazione include una chiave di accesso primaria e una secondaria, che garantiscono entrambe l'accesso amministrativo all'account e a tutte le risorse presenti in esso.</span><span class="sxs-lookup"><span data-stu-id="d9665-122">Your storage account includes both a primary and secondary access key, both of which grant administrative access to your account, and all resources within it.</span></span> <span data-ttu-id="d9665-123">Se si espone una di queste chiavi, è possibile che l'account venga usato in modo dannoso o non appropriato.</span><span class="sxs-lookup"><span data-stu-id="d9665-123">Exposing either of these keys opens your account to the possibility of malicious or negligent use.</span></span> <span data-ttu-id="d9665-124">Le firme di accesso condiviso costituiscono un'alternativa sicura per consentire ai client di leggere, scrivere ed eliminare dati nell'account di archiviazione sulla base delle autorizzazioni concesse esplicitamente e senza richiedere la chiave dell'account.</span><span class="sxs-lookup"><span data-stu-id="d9665-124">Shared access signatures provide a safe alternative that allows clients to read, write, and delete data in your storage account according to the permissions you've explicitly granted, and without need for an account key.</span></span>

<span data-ttu-id="d9665-125">Uno scenario comune in cui la firma di accesso condiviso risulta utile è costituito da un servizio in cui gli utenti leggono e scrivono i propri dati nell'account di archiviazione di un utente specifico.</span><span class="sxs-lookup"><span data-stu-id="d9665-125">A common scenario where a SAS is useful is a service where users read and write their own data to your storage account.</span></span> <span data-ttu-id="d9665-126">Uno scenario in cui i dati utente vengono archiviati nell'account di archiviazione è caratterizzato da due modelli di progettazione standard:</span><span class="sxs-lookup"><span data-stu-id="d9665-126">In a scenario where a storage account stores user data, there are two typical design patterns:</span></span>

1. <span data-ttu-id="d9665-127">I client caricano e scaricano dati tramite un servizio proxy front-end che esegue l'autenticazione.</span><span class="sxs-lookup"><span data-stu-id="d9665-127">Clients upload and download data via a front-end proxy service, which performs authentication.</span></span> <span data-ttu-id="d9665-128">Tale servizio presenta il vantaggio di consentire la convalida delle regole di business, tuttavia per grandi quantità di dati o per transazioni con volumi elevati, la creazione di un servizio scalabile in base alla domanda può risultare oneroso o complesso.</span><span class="sxs-lookup"><span data-stu-id="d9665-128">This front-end proxy service has the advantage of allowing validation of business rules, but for large amounts of data or high-volume transactions, creating a service that can scale to match demand may be expensive or difficult.</span></span>

  ![Diagramma dello scenario: il servizio proxy front-end](./media/storage-dotnet-shared-access-signature-part-1/sas-storage-fe-proxy-service.png)   

1. <span data-ttu-id="d9665-130">Un servizio semplificato autentica il client in base alle necessità e quindi genera una firma di accesso condiviso.</span><span class="sxs-lookup"><span data-stu-id="d9665-130">A lightweight service authenticates the client as needed and then generates a SAS.</span></span> <span data-ttu-id="d9665-131">Dopo aver ricevuto la firma di accesso condiviso, il client può quindi accedere alle risorse dell'account di archiviazione direttamente con le autorizzazioni definite dalla firma e per l'intervallo consentito dalla firma.</span><span class="sxs-lookup"><span data-stu-id="d9665-131">Once the client receives the SAS, they can access storage account resources directly with the permissions defined by the SAS and for the interval allowed by the SAS.</span></span> <span data-ttu-id="d9665-132">La firma di accesso condiviso consente di ridurre la necessità di instradare tutti i dati tramite il servizio proxy front-end.</span><span class="sxs-lookup"><span data-stu-id="d9665-132">The SAS mitigates the need for routing all data through the front-end proxy service.</span></span>

  ![Diagramma dello scenario: servizio provider di firma di accesso condiviso](./media/storage-dotnet-shared-access-signature-part-1/sas-storage-provider-service.png)   

<span data-ttu-id="d9665-134">Molti servizi reali possono usare una combinazione di questi due approcci.</span><span class="sxs-lookup"><span data-stu-id="d9665-134">Many real-world services may use a hybrid of these two approaches.</span></span> <span data-ttu-id="d9665-135">Ad esempio, alcuni dati potrebbero essere elaborati e convalidati tramite il proxy front-end, mentre altri vengono salvati e/o letti direttamente tramite la firma di accesso condiviso.</span><span class="sxs-lookup"><span data-stu-id="d9665-135">For example, some data might be processed and validated via the front-end proxy, while other data is saved and/or read directly using SAS.</span></span>

<span data-ttu-id="d9665-136">Inoltre, è necessario utilizzare una firma di accesso condiviso per autenticare l'oggetto di origine in un'operazione di copia in determinati scenari:</span><span class="sxs-lookup"><span data-stu-id="d9665-136">Additionally, you will need to use a SAS to authenticate the source object in a copy operation in certain scenarios:</span></span>

* <span data-ttu-id="d9665-137">Quando si copia un BLOB in un altro BLOB che risiede in un account di archiviazione diverso, è necessario utilizzare una firma di accesso condiviso per autenticare il BLOB di origine.</span><span class="sxs-lookup"><span data-stu-id="d9665-137">When you copy a blob to another blob that resides in a different storage account, you must use a SAS to authenticate the source blob.</span></span> <span data-ttu-id="d9665-138">È possibile usare una firma di accesso condiviso per autenticare il BLOB di destinazione.</span><span class="sxs-lookup"><span data-stu-id="d9665-138">You can optionally use a SAS to authenticate the destination blob as well.</span></span>
* <span data-ttu-id="d9665-139">Quando si copia un file a un altro file che si trova in un account di archiviazione diverso, è necessario utilizzare una firma di accesso condiviso per autenticare il file di origine.</span><span class="sxs-lookup"><span data-stu-id="d9665-139">When you copy a file to another file that resides in a different storage account, you must use a SAS to authenticate the source file.</span></span> <span data-ttu-id="d9665-140">È possibile usare una firma di accesso condiviso per autenticare il file di destinazione.</span><span class="sxs-lookup"><span data-stu-id="d9665-140">You can optionally use a SAS to authenticate the destination file as well.</span></span>
* <span data-ttu-id="d9665-141">Quando si copia un BLOB in un file o un file in un BLOB, è necessario utilizzare una firma di accesso condiviso (SAS) per autenticare l'oggetto di origine, anche se gli oggetti di origine e di destinazione si trovano nello stesso account di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="d9665-141">When you copy a blob to a file, or a file to a blob, you must use a SAS to authenticate the source object, even if the source and destination objects reside within the same storage account.</span></span>

## <a name="types-of-shared-access-signatures"></a><span data-ttu-id="d9665-142">Tipi di firme di accesso condiviso</span><span class="sxs-lookup"><span data-stu-id="d9665-142">Types of shared access signatures</span></span>
<span data-ttu-id="d9665-143">È possibile creare due tipi di firme di accesso condiviso:</span><span class="sxs-lookup"><span data-stu-id="d9665-143">You can create two types of shared access signatures:</span></span>

* <span data-ttu-id="d9665-144">**Firma di accesso condiviso del servizio.**</span><span class="sxs-lookup"><span data-stu-id="d9665-144">**Service SAS.**</span></span> <span data-ttu-id="d9665-145">La firma di accesso condiviso del servizio delega l'accesso a una risorsa in uno solo dei servizi di archiviazione, ovvero nel servizio BLOB, nel servizio di accodamento, nel servizio tabelle o nel servizio file.</span><span class="sxs-lookup"><span data-stu-id="d9665-145">The service SAS delegates access to a resource in just one of the storage services: the Blob, Queue, Table, or File service.</span></span> <span data-ttu-id="d9665-146">Per informazioni approfondite su come creare il token di firma di accesso condiviso del servizio, vedere [Constructing a Service SAS](https://msdn.microsoft.com/library/dn140255.aspx) (Creare una firma di accesso condiviso del servizio) e [Service SAS Examples](https://msdn.microsoft.com/library/dn140256.aspx) (Esempi di firma di accesso condiviso del servizio).</span><span class="sxs-lookup"><span data-stu-id="d9665-146">See [Constructing a Service SAS](https://msdn.microsoft.com/library/dn140255.aspx) and [Service SAS Examples](https://msdn.microsoft.com/library/dn140256.aspx) for in-depth information about constructing the service SAS token.</span></span>
* <span data-ttu-id="d9665-147">**Firma di accesso condiviso dell'account.**</span><span class="sxs-lookup"><span data-stu-id="d9665-147">**Account SAS.**</span></span> <span data-ttu-id="d9665-148">La firma di accesso condiviso dell'account delega l'accesso alle risorse in uno o più servizi di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="d9665-148">The account SAS delegates access to resources in one or more of the storage services.</span></span> <span data-ttu-id="d9665-149">Tutte le operazioni disponibili tramite la firma di accesso condiviso del servizio lo sono anche tramite la firma di accesso condiviso dell'account.</span><span class="sxs-lookup"><span data-stu-id="d9665-149">All of the operations available via a service SAS are also available via an account SAS.</span></span> <span data-ttu-id="d9665-150">Con la firma di accesso condiviso dell'account è anche possibile delegare l'accesso a operazioni che si applicano a un servizio specifico, ad esempio **Get/Set Service Properties** e **Get Service Stats**. È anche possibile delegare l'accesso alle operazioni di lettura, scrittura ed eliminazioni in contenitori BLOB, tabelle, code e condivisioni file, che con una firma di accesso condiviso del servizio non è consentito.</span><span class="sxs-lookup"><span data-stu-id="d9665-150">Additionally, with the account SAS, you can delegate access to operations that apply to a given service, such as **Get/Set Service Properties** and **Get Service Stats**. You can also delegate access to read, write, and delete operations on blob containers, tables, queues, and file shares that are not permitted with a service SAS.</span></span> <span data-ttu-id="d9665-151">Per informazioni approfondite su come creare il token di firma di accesso condiviso dell'account, vedere [Creazione di una firma di accesso condiviso dell'account](https://msdn.microsoft.com/library/mt584140.aspx).</span><span class="sxs-lookup"><span data-stu-id="d9665-151">See [Constructing an Account SAS](https://msdn.microsoft.com/library/mt584140.aspx) for in-depth information about constructing the account SAS token.</span></span>

## <a name="how-a-shared-access-signature-works"></a><span data-ttu-id="d9665-152">Funzionamento della firma di accesso condiviso</span><span class="sxs-lookup"><span data-stu-id="d9665-152">How a shared access signature works</span></span>
<span data-ttu-id="d9665-153">Una firma di accesso condiviso è un URI con fimra che punta a una o più risorse di archiviazione e include un token che contiene un set di parametri di query speciale.</span><span class="sxs-lookup"><span data-stu-id="d9665-153">A shared access signature is a signed URI that points to one or more storage resources and includes a token that contains a special set of query parameters.</span></span> <span data-ttu-id="d9665-154">Il token indica la modalità di accesso alla risorsa da parte del client.</span><span class="sxs-lookup"><span data-stu-id="d9665-154">The token indicates how the resources may be accessed by the client.</span></span> <span data-ttu-id="d9665-155">Uno dei parametri di query, ovvero la firma, viene creato dai parametri della firma di accesso condiviso e viene firmato con la chiave dell'account.</span><span class="sxs-lookup"><span data-stu-id="d9665-155">One of the query parameters, the signature, is constructed from the SAS parameters and signed with the account key.</span></span> <span data-ttu-id="d9665-156">Tale firma viene utilizzata dal servizio di archiviazione di Azure per autenticare la firma di accesso condiviso.</span><span class="sxs-lookup"><span data-stu-id="d9665-156">This signature is used by Azure Storage to authenticate the SAS.</span></span>

<span data-ttu-id="d9665-157">Di seguito è riportato un esempio di un URI di firma di accesso condiviso, che mostra il token di firma di accesso condiviso e l'URI della risorsa:</span><span class="sxs-lookup"><span data-stu-id="d9665-157">Here's an example of a SAS URI, showing the resource URI and the SAS token:</span></span>

![Componenti di un URI di firma di accesso condiviso](./media/storage-dotnet-shared-access-signature-part-1/sas-storage-uri.png)   

<span data-ttu-id="d9665-159">Il token di firma di accesso condiviso è una stringa generata sul lato *client*. Per alcuni esempi di codice, vedere la sezione degli [esempi di firma di accesso condiviso](#sas-examples).</span><span class="sxs-lookup"><span data-stu-id="d9665-159">The SAS token is a string you generate on the *client* side (see the [SAS examples](#sas-examples) section for code examples).</span></span> <span data-ttu-id="d9665-160">Un token di firma di accesso condiviso generato con la libreria client di archiviazione, ad esempio, non viene rilevato da Archiviazione di Azure in alcun modo.</span><span class="sxs-lookup"><span data-stu-id="d9665-160">A SAS token you generate with the storage client library, for example, is not tracked by Azure Storage in any way.</span></span> <span data-ttu-id="d9665-161">È possibile creare un numero illimitato di token di firma di accesso condiviso sul lato client.</span><span class="sxs-lookup"><span data-stu-id="d9665-161">You can create an unlimited number of SAS tokens on the client side.</span></span>

<span data-ttu-id="d9665-162">Quando un client fornisce un URI di firma di accesso condiviso ad Archiviazione di Azure come parte di una richiesta, il servizio controlla i parametri di firma di accesso condiviso e la firma per verificarne la validità per l'autenticazione della richiesta.</span><span class="sxs-lookup"><span data-stu-id="d9665-162">When a client provides a SAS URI to Azure Storage as part of a request, the service checks the SAS parameters and signature to verify that it is valid for authenticating the request.</span></span> <span data-ttu-id="d9665-163">Se il servizio conferma che la firma è valida, la richiesta viene autenticata.</span><span class="sxs-lookup"><span data-stu-id="d9665-163">If the service verifies that the signature is valid, then the request is authenticated.</span></span> <span data-ttu-id="d9665-164">In caso contrario, la richiesta viene rifiutata con il codice errore 403 (accesso negato).</span><span class="sxs-lookup"><span data-stu-id="d9665-164">Otherwise, the request is declined with error code 403 (Forbidden).</span></span>

## <a name="shared-access-signature-parameters"></a><span data-ttu-id="d9665-165">Parametri della firma di accesso condiviso</span><span class="sxs-lookup"><span data-stu-id="d9665-165">Shared access signature parameters</span></span>
<span data-ttu-id="d9665-166">I token di firma di accesso condiviso dell'account e del servizio includono parametri comuni e accettano alcuni parametri diversi.</span><span class="sxs-lookup"><span data-stu-id="d9665-166">The account SAS and service SAS tokens include some common parameters, and also take a few parameters that that are different.</span></span>

### <a name="parameters-common-to-account-sas-and-service-sas-tokens"></a><span data-ttu-id="d9665-167">Parametri comuni per la firma di accesso condiviso dell'account e del servizio</span><span class="sxs-lookup"><span data-stu-id="d9665-167">Parameters common to account SAS and service SAS tokens</span></span>
* <span data-ttu-id="d9665-168">**Api version** Parametro facoltativo che specifica la versione del servizio di archiviazione da usare per eseguire la richiesta.</span><span class="sxs-lookup"><span data-stu-id="d9665-168">**Api version** An optional parameter that specifies the storage service version to use to execute the request.</span></span>
* <span data-ttu-id="d9665-169">**Service version** Parametro obbligatorio che specifica la versione del servizio di archiviazione da usare per autenticare la richiesta.</span><span class="sxs-lookup"><span data-stu-id="d9665-169">**Service version** A required parameter that specifies the storage service version to use to authenticate the request.</span></span>
* <span data-ttu-id="d9665-170">**Ora di inizio.**</span><span class="sxs-lookup"><span data-stu-id="d9665-170">**Start time.**</span></span> <span data-ttu-id="d9665-171">Si riferisce all'ora in cui la firma di accesso condiviso diventa valida.</span><span class="sxs-lookup"><span data-stu-id="d9665-171">This is the time at which the SAS becomes valid.</span></span> <span data-ttu-id="d9665-172">L'ora di inizio di una firma di accesso condiviso è facoltativa.</span><span class="sxs-lookup"><span data-stu-id="d9665-172">The start time for a shared access signature is optional.</span></span> <span data-ttu-id="d9665-173">Se l'ora di inizio viene omessa, la firma diventa immediatamente efficace.</span><span class="sxs-lookup"><span data-stu-id="d9665-173">If a start time is omitted, the SAS is effective immediately.</span></span> <span data-ttu-id="d9665-174">L'ora di inizio deve essere espressa in UTC (Coordinated Universal Time), con uno speciale designatore UTC ("Z"), ad esempio `1994-11-05T13:15:30Z`.</span><span class="sxs-lookup"><span data-stu-id="d9665-174">The start time must be expressed in UTC (Coordinated Universal Time), with a special UTC designator ("Z"), for example `1994-11-05T13:15:30Z`.</span></span>
* <span data-ttu-id="d9665-175">**Scadenza.**</span><span class="sxs-lookup"><span data-stu-id="d9665-175">**Expiry time.**</span></span> <span data-ttu-id="d9665-176">Si riferisce all'ora dopo la quale la firma di accesso condiviso non è più valida.</span><span class="sxs-lookup"><span data-stu-id="d9665-176">This is the time after which the SAS is no longer valid.</span></span> <span data-ttu-id="d9665-177">Secondo le procedure consigliate è preferibile specificare una data di scadenza per una firma di accesso condiviso oppure associarla a criteri di accesso archiviati.</span><span class="sxs-lookup"><span data-stu-id="d9665-177">Best practices recommend that you either specify an expiry time for a SAS, or associate it with a stored access policy.</span></span> <span data-ttu-id="d9665-178">L'ora di scadenza deve essere espressa in UTC (Coordinated Universal Time), con uno speciale designatore UTC ("Z"), ad esempio `1994-11-05T13:15:30Z` (altre informazioni sono riportate di seguito).</span><span class="sxs-lookup"><span data-stu-id="d9665-178">The expiry time must be expressed in UTC (Coordinated Universal Time), with a special UTC designator ("Z"), for example `1994-11-05T13:15:30Z` (see more below).</span></span>
* <span data-ttu-id="d9665-179">**Autorizzazione.**</span><span class="sxs-lookup"><span data-stu-id="d9665-179">**Permissions.**</span></span> <span data-ttu-id="d9665-180">Le autorizzazioni specificate per la firma di accesso condiviso indicano le autorizzazioni che il client può eseguire sulla risorsa di archiviazione usando la firma.</span><span class="sxs-lookup"><span data-stu-id="d9665-180">The permissions specified on the SAS indicate what operations the client can perform against the storage resource using the SAS.</span></span> <span data-ttu-id="d9665-181">Le autorizzazioni disponibili per la firma di accesso condiviso dell'account e del servizio sono diverse.</span><span class="sxs-lookup"><span data-stu-id="d9665-181">Available permissions differ for an account SAS and a service SAS.</span></span>
* <span data-ttu-id="d9665-182">**IP.**</span><span class="sxs-lookup"><span data-stu-id="d9665-182">**IP.**</span></span> <span data-ttu-id="d9665-183">Un parametro facoltativo che specifica un indirizzo IP o un intervallo di indirizzi IP all'esterno di Azure (vedere la sezione [Stato di configurazione della sessione di Routing](../../expressroute/expressroute-workflows.md#routing-session-configuration-state) per Express route) da cui si desidera accettare le richieste.</span><span class="sxs-lookup"><span data-stu-id="d9665-183">An optional parameter that specifies an IP address or a range of IP addresses outside of Azure (see the section [Routing session configuration state](../../expressroute/expressroute-workflows.md#routing-session-configuration-state) for Express Route) from which to accept requests.</span></span>
* <span data-ttu-id="d9665-184">**Protocol.**</span><span class="sxs-lookup"><span data-stu-id="d9665-184">**Protocol.**</span></span> <span data-ttu-id="d9665-185">Parametro facoltativo che specifica il protocollo consentito per una richiesta.</span><span class="sxs-lookup"><span data-stu-id="d9665-185">An optional parameter that specifies the protocol permitted for a request.</span></span> <span data-ttu-id="d9665-186">I valori possibili sono HTTPS e HTTP (`https,http`), ovvero il valore predefinito, oppure solo HTTPS (`https`).</span><span class="sxs-lookup"><span data-stu-id="d9665-186">Possible values are both HTTPS and HTTP (`https,http`), which is the default value, or HTTPS only (`https`).</span></span> <span data-ttu-id="d9665-187">Si noti che HTTP only non è un valore consentito.</span><span class="sxs-lookup"><span data-stu-id="d9665-187">Note that HTTP only is not a permitted value.</span></span>
* <span data-ttu-id="d9665-188">**Signature.**</span><span class="sxs-lookup"><span data-stu-id="d9665-188">**Signature.**</span></span> <span data-ttu-id="d9665-189">La firma viene creata dagli altri parametri specificati come parte token e quindi crittografati.</span><span class="sxs-lookup"><span data-stu-id="d9665-189">The signature is constructed from the other parameters specified as part token and then encrypted.</span></span> <span data-ttu-id="d9665-190">Viene quindi usata per autenticare la firma di accesso condiviso.</span><span class="sxs-lookup"><span data-stu-id="d9665-190">It's used to authenticate the SAS.</span></span>

### <a name="parameters-for-a-service-sas-token"></a><span data-ttu-id="d9665-191">Parametri per il token della firma di accesso condiviso del servizio</span><span class="sxs-lookup"><span data-stu-id="d9665-191">Parameters for a service SAS token</span></span>
* <span data-ttu-id="d9665-192">**Risorsa di archiviazione.**</span><span class="sxs-lookup"><span data-stu-id="d9665-192">**Storage resource.**</span></span> <span data-ttu-id="d9665-193">Le risorse di archiviazione per cui è possibile delegare l'accesso con una firma di accesso condiviso del servizio sono:</span><span class="sxs-lookup"><span data-stu-id="d9665-193">Storage resources for which you can delegate access with a service SAS include:</span></span>
  * <span data-ttu-id="d9665-194">Contenitori e BLOB</span><span class="sxs-lookup"><span data-stu-id="d9665-194">Containers and blobs</span></span>
  * <span data-ttu-id="d9665-195">Condivisioni di file e file</span><span class="sxs-lookup"><span data-stu-id="d9665-195">File shares and files</span></span>
  * <span data-ttu-id="d9665-196">Queues</span><span class="sxs-lookup"><span data-stu-id="d9665-196">Queues</span></span>
  * <span data-ttu-id="d9665-197">Le tabelle e gli intervalli di entità della tabella.</span><span class="sxs-lookup"><span data-stu-id="d9665-197">Tables and ranges of table entities.</span></span>

### <a name="parameters-for-an-account-sas-token"></a><span data-ttu-id="d9665-198">Parametri per il token della firma di accesso condiviso dell'account</span><span class="sxs-lookup"><span data-stu-id="d9665-198">Parameters for an account SAS token</span></span>
* <span data-ttu-id="d9665-199">**Servizio o servizi.**</span><span class="sxs-lookup"><span data-stu-id="d9665-199">**Service or services.**</span></span> <span data-ttu-id="d9665-200">La firma di accesso condiviso può delegare l'accesso a uno o più servizi di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="d9665-200">An account SAS can delegate access to one or more of the storage services.</span></span> <span data-ttu-id="d9665-201">Ad esempio, è possibile creare una firma di accesso condiviso dell'account che delega l'accesso al servizio BLOB e al servizio File.</span><span class="sxs-lookup"><span data-stu-id="d9665-201">For example, you can create an account SAS that delegates access to the Blob and File service.</span></span> <span data-ttu-id="d9665-202">Oppure, è possibile creare una firma di accesso condiviso che delega l'accesso a tutti e quattro i servizi (BLOB, Coda, Tabelle e File).</span><span class="sxs-lookup"><span data-stu-id="d9665-202">Or you can create a SAS that delegates access to all four services (Blob, Queue, Table, and File).</span></span>
* <span data-ttu-id="d9665-203">**Tipi di risorse di archiviazione.**</span><span class="sxs-lookup"><span data-stu-id="d9665-203">**Storage resource types.**</span></span> <span data-ttu-id="d9665-204">Una firma di accesso condiviso dell'account si applica a una o più classi di risorse di archiviazione, piuttosto che a una risorsa specifica.</span><span class="sxs-lookup"><span data-stu-id="d9665-204">An account SAS applies to one or more classes of storage resources, rather than a specific resource.</span></span> <span data-ttu-id="d9665-205">È possibile creare una firma di accesso condiviso dell'account per delegare l'accesso a:</span><span class="sxs-lookup"><span data-stu-id="d9665-205">You can create an account SAS to delegate access to:</span></span>
  * <span data-ttu-id="d9665-206">API a livello di servizio, che vengono chiamate sulla risorsa dell'account di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="d9665-206">Service-level APIs, which are called against the storage account resource.</span></span> <span data-ttu-id="d9665-207">Ad esempio: **Get/Set Service Properties**, **Get Service Stats** e **List Containers/Queues/Tables/Shares**.</span><span class="sxs-lookup"><span data-stu-id="d9665-207">Examples include **Get/Set Service Properties**, **Get Service Stats**, and **List Containers/Queues/Tables/Shares**.</span></span>
  * <span data-ttu-id="d9665-208">API a livello di contenitore, che vengono chiamate sugli oggetti contenitore per ogni servizio, contenitore BLOB, code, tabelle e condivisioni file.</span><span class="sxs-lookup"><span data-stu-id="d9665-208">Container-level APIs, which are called against the container objects for each service: blob containers, queues, tables, and file shares.</span></span> <span data-ttu-id="d9665-209">Ad esempio: **Create/Delete Container**, **Create/Delete Queue**, **Create/Delete Table**, **Create/Delete Share** e **List Blobs/Files and Directories**.</span><span class="sxs-lookup"><span data-stu-id="d9665-209">Examples include **Create/Delete Container**, **Create/Delete Queue**, **Create/Delete Table**, **Create/Delete Share**, and **List Blobs/Files and Directories**.</span></span>
  * <span data-ttu-id="d9665-210">API a livello di oggetto, che vengono chiamate su BLOB, messaggi di coda, entità tabelle e file.</span><span class="sxs-lookup"><span data-stu-id="d9665-210">Object-level APIs, which are called against blobs, queue messages, table entities, and files.</span></span> <span data-ttu-id="d9665-211">Ad esempio: **Put Blob**, **Query Entity**, **Get Messages** e **Create File**.</span><span class="sxs-lookup"><span data-stu-id="d9665-211">For example, **Put Blob**, **Query Entity**, **Get Messages**, and **Create File**.</span></span>

## <a name="examples-of-sas-uris"></a><span data-ttu-id="d9665-212">Esempi di URI di firma di accesso condiviso</span><span class="sxs-lookup"><span data-stu-id="d9665-212">Examples of SAS URIs</span></span>

### <a name="service-sas-uri-example"></a><span data-ttu-id="d9665-213">Esempio di URI di firma di accesso condiviso del servizio</span><span class="sxs-lookup"><span data-stu-id="d9665-213">Service SAS URI example</span></span>

<span data-ttu-id="d9665-214">Di seguito è riportato un esempio di URI di firma di accesso condiviso del servizio che fornisce autorizzazioni di lettura e scrittura a un BLOB.</span><span class="sxs-lookup"><span data-stu-id="d9665-214">Here is an example of a service SAS URI that provides read and write permissions to a blob.</span></span> <span data-ttu-id="d9665-215">Nella tabella le singole parti dell'URI della firma di accesso condiviso vengono descritte separatamente per facilitarne la comprensione:</span><span class="sxs-lookup"><span data-stu-id="d9665-215">The table breaks down each part of the URI to understand how it contributes to the SAS:</span></span>

```
https://myaccount.blob.core.windows.net/sascontainer/sasblob.txt?sv=2015-04-05&st=2015-04-29T22%3A18%3A26Z&se=2015-04-30T02%3A23%3A26Z&sr=b&sp=rw&sip=168.1.5.60-168.1.5.70&spr=https&sig=Z%2FRHIX5Xcg0Mq2rqI3OlWTjEg2tYkboXr1P9ZUXDtkk%3D
```

| <span data-ttu-id="d9665-216">Nome</span><span class="sxs-lookup"><span data-stu-id="d9665-216">Name</span></span> | <span data-ttu-id="d9665-217">Parte firma di accesso condiviso</span><span class="sxs-lookup"><span data-stu-id="d9665-217">SAS portion</span></span> | <span data-ttu-id="d9665-218">Descrizione</span><span class="sxs-lookup"><span data-stu-id="d9665-218">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="d9665-219">URI del BLOB</span><span class="sxs-lookup"><span data-stu-id="d9665-219">Blob URI</span></span> |`https://myaccount.blob.core.windows.net/sascontainer/sasblob.txt` |<span data-ttu-id="d9665-220">Indirizzo del BLOB.</span><span class="sxs-lookup"><span data-stu-id="d9665-220">The address of the blob.</span></span> <span data-ttu-id="d9665-221">Si noti che è vivamente consigliato l'uso di HTTPS.</span><span class="sxs-lookup"><span data-stu-id="d9665-221">Note that using HTTPS is highly recommended.</span></span> |
| <span data-ttu-id="d9665-222">Versione dei servizi di archiviazione</span><span class="sxs-lookup"><span data-stu-id="d9665-222">Storage services version</span></span> |`sv=2015-04-05` |<span data-ttu-id="d9665-223">Per i servizi di archiviazione della versione 2012-02-12 e successive questo parametro indica la versione da usare.</span><span class="sxs-lookup"><span data-stu-id="d9665-223">For storage services version 2012-02-12 and later, this parameter indicates the version to use.</span></span> |
| <span data-ttu-id="d9665-224">Ora di inizio</span><span class="sxs-lookup"><span data-stu-id="d9665-224">Start time</span></span> |`st=2015-04-29T22%3A18%3A26Z` |<span data-ttu-id="d9665-225">Specificata nell'ora UTC.</span><span class="sxs-lookup"><span data-stu-id="d9665-225">Specified in UTC time.</span></span> <span data-ttu-id="d9665-226">Se si desidera che la firma di accesso condiviso sia immediatamente valida, omettere l'ora di inizio.</span><span class="sxs-lookup"><span data-stu-id="d9665-226">If you want the SAS to be valid immediately, omit the start time.</span></span> |
| <span data-ttu-id="d9665-227">Scadenza</span><span class="sxs-lookup"><span data-stu-id="d9665-227">Expiry time</span></span> |`se=2015-04-30T02%3A23%3A26Z` |<span data-ttu-id="d9665-228">Specificata nell'ora UTC.</span><span class="sxs-lookup"><span data-stu-id="d9665-228">Specified in UTC time.</span></span> |
| <span data-ttu-id="d9665-229">Risorsa</span><span class="sxs-lookup"><span data-stu-id="d9665-229">Resource</span></span> |`sr=b` |<span data-ttu-id="d9665-230">La risorsa è un BLOB.</span><span class="sxs-lookup"><span data-stu-id="d9665-230">The resource is a blob.</span></span> |
| <span data-ttu-id="d9665-231">autorizzazioni</span><span class="sxs-lookup"><span data-stu-id="d9665-231">Permissions</span></span> |`sp=rw` |<span data-ttu-id="d9665-232">Le autorizzazioni concesse dalla firma di accesso condiviso includono lettura (r) e scrittura (w).</span><span class="sxs-lookup"><span data-stu-id="d9665-232">The permissions granted by the SAS include Read (r) and Write (w).</span></span> |
| <span data-ttu-id="d9665-233">Intervallo IP</span><span class="sxs-lookup"><span data-stu-id="d9665-233">IP range</span></span> |`sip=168.1.5.60-168.1.5.70` |<span data-ttu-id="d9665-234">Intervallo di indirizzi IP da cui verrà accettata una richiesta.</span><span class="sxs-lookup"><span data-stu-id="d9665-234">The range of IP addresses from which a request will be accepted.</span></span> |
| <span data-ttu-id="d9665-235">Protocollo</span><span class="sxs-lookup"><span data-stu-id="d9665-235">Protocol</span></span> |`spr=https` |<span data-ttu-id="d9665-236">Sono consentite solo richieste tramite HTTPS.</span><span class="sxs-lookup"><span data-stu-id="d9665-236">Only requests using HTTPS are permitted.</span></span> |
| <span data-ttu-id="d9665-237">Firma</span><span class="sxs-lookup"><span data-stu-id="d9665-237">Signature</span></span> |`sig=Z%2FRHIX5Xcg0Mq2rqI3OlWTjEg2tYkboXr1P9ZUXDtkk%3D` |<span data-ttu-id="d9665-238">Utilizzata per autenticare l'accesso al BLOB.</span><span class="sxs-lookup"><span data-stu-id="d9665-238">Used to authenticate access to the blob.</span></span> <span data-ttu-id="d9665-239">La firma è un HMAC calcolato sulla base di una stringa da firmare e della chiave mediante l'algoritmo SHA256, e quindi codificato con la codifica Base64.</span><span class="sxs-lookup"><span data-stu-id="d9665-239">The signature is an HMAC computed over a string-to-sign and key using the SHA256 algorithm, and then encoded using Base64 encoding.</span></span> |

### <a name="account-sas-uri-example"></a><span data-ttu-id="d9665-240">Esempio di URI di firma di accesso condiviso dell'account</span><span class="sxs-lookup"><span data-stu-id="d9665-240">Account SAS URI example</span></span>

<span data-ttu-id="d9665-241">Di seguito è riportato un esempio di firma di accesso condiviso dell'account che usa gli stessi parametri comuni nel token.</span><span class="sxs-lookup"><span data-stu-id="d9665-241">Here is an example of an account SAS that uses the same common parameters on the token.</span></span> <span data-ttu-id="d9665-242">Poiché questi parametri sono già stati illustrati in precedenza, non sono descritti qui.</span><span class="sxs-lookup"><span data-stu-id="d9665-242">Since these parameters are described above, they are not described here.</span></span> <span data-ttu-id="d9665-243">La tabella seguente include solo i parametri specifici per la firma di accesso condiviso dell'account.</span><span class="sxs-lookup"><span data-stu-id="d9665-243">Only the parameters that are specific to account SAS are described in the table below.</span></span>

```
https://myaccount.blob.core.windows.net/?restype=service&comp=properties&sv=2015-04-05&ss=bf&srt=s&st=2015-04-29T22%3A18%3A26Z&se=2015-04-30T02%3A23%3A26Z&sr=b&sp=rw&sip=168.1.5.60-168.1.5.70&spr=https&sig=F%6GRVAZ5Cdj2Pw4tgU7IlSTkWgn7bUkkAg8P6HESXwmf%4B
```

| <span data-ttu-id="d9665-244">Nome</span><span class="sxs-lookup"><span data-stu-id="d9665-244">Name</span></span> | <span data-ttu-id="d9665-245">Parte firma di accesso condiviso</span><span class="sxs-lookup"><span data-stu-id="d9665-245">SAS portion</span></span> | <span data-ttu-id="d9665-246">Descrizione</span><span class="sxs-lookup"><span data-stu-id="d9665-246">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="d9665-247">URI della risorsa</span><span class="sxs-lookup"><span data-stu-id="d9665-247">Resource URI</span></span> |`https://myaccount.blob.core.windows.net/?restype=service&comp=properties` |<span data-ttu-id="d9665-248">Endpoint di servizio BLOB con parametri per ottenere le proprietà del servizio (operazione GET) o per impostare le proprietà del servizio (operazione SET).</span><span class="sxs-lookup"><span data-stu-id="d9665-248">The Blob service endpoint, with parameters for getting service properties (when called with GET) or setting service properties (when called with SET).</span></span> |
| <span data-ttu-id="d9665-249">Services</span><span class="sxs-lookup"><span data-stu-id="d9665-249">Services</span></span> |`ss=bf` |<span data-ttu-id="d9665-250">La firma di accesso condiviso si applica ai servizi BLOB e File</span><span class="sxs-lookup"><span data-stu-id="d9665-250">The SAS applies to the Blob and File services</span></span> |
| <span data-ttu-id="d9665-251">Tipi di risorse</span><span class="sxs-lookup"><span data-stu-id="d9665-251">Resource types</span></span> |`srt=s` |<span data-ttu-id="d9665-252">La firma di accesso condiviso si applica alle operazioni a livello di servizio.</span><span class="sxs-lookup"><span data-stu-id="d9665-252">The SAS applies to service-level operations.</span></span> |
| <span data-ttu-id="d9665-253">autorizzazioni</span><span class="sxs-lookup"><span data-stu-id="d9665-253">Permissions</span></span> |`sp=rw` |<span data-ttu-id="d9665-254">Le autorizzazioni concedono l'accesso alle operazioni di lettura e scrittura.</span><span class="sxs-lookup"><span data-stu-id="d9665-254">The permissions grant access to read and write operations.</span></span> |

<span data-ttu-id="d9665-255">Poiché le autorizzazioni sono limitate a livello di servizio, le operazioni accessibili tramite questa firma di accesso condiviso sono **Get Blob Service Properties** (lettura) e **Set Blob Service Properties** (scrittura).</span><span class="sxs-lookup"><span data-stu-id="d9665-255">Given that permissions are restricted to the service level, accessible operations with this SAS are **Get Blob Service Properties** (read) and **Set Blob Service Properties** (write).</span></span> <span data-ttu-id="d9665-256">Con un URI di risorsa diverso, lo stesso token di firma di accesso condiviso può tuttavia essere usato per delegare l'accesso all'operazione **Get Blob Service Stats** (lettura).</span><span class="sxs-lookup"><span data-stu-id="d9665-256">However, with a different resource URI, the same SAS token could also be used to delegate access to **Get Blob Service Stats** (read).</span></span>

## <a name="controlling-a-sas-with-a-stored-access-policy"></a><span data-ttu-id="d9665-257">Controllo di una firma di accesso condiviso con criteri di accesso archiviati</span><span class="sxs-lookup"><span data-stu-id="d9665-257">Controlling a SAS with a stored access policy</span></span>
<span data-ttu-id="d9665-258">Una firma di accesso condiviso può assumere una delle due forme seguenti:</span><span class="sxs-lookup"><span data-stu-id="d9665-258">A shared access signature can take one of two forms:</span></span>

* <span data-ttu-id="d9665-259">**SAS ad hoc:** quando si crea una firma di accesso condiviso ad hoc, l'ora di inizio, la scadenza e le autorizzazioni vengono tutte specificate nell'URI corrispondente oppure sono implicite, nel caso in cui l'ora di inizio viene omessa.</span><span class="sxs-lookup"><span data-stu-id="d9665-259">**Ad hoc SAS:** When you create an ad hoc SAS, the start time, expiry time, and permissions for the SAS are all specified in the SAS URI (or implied, in the case where start time is omitted).</span></span> <span data-ttu-id="d9665-260">È possibile creare questa firma di accesso condiviso come firma di accesso condiviso dell'account o del servizio.</span><span class="sxs-lookup"><span data-stu-id="d9665-260">This type of SAS can be created as an account SAS or a service SAS.</span></span>
* <span data-ttu-id="d9665-261">**SAS con politica di accesso archiviazione:** i criteri di accesso archiviati vengono definiti per un contenitore di risorse, ovvero un contenitore BLOB, una tabella o una coda, e possono essere usati per gestire i vincoli per una o più firme di accesso condiviso.</span><span class="sxs-lookup"><span data-stu-id="d9665-261">**SAS with stored access policy:** A stored access policy is defined on a resource container--a blob container, table, queue, or file share--and can be used to manage constraints for one or more shared access signatures.</span></span> <span data-ttu-id="d9665-262">Quando si associa una firma di accesso condiviso a criteri di accesso archiviati, la firma eredita i vincoli, ovvero ora di inizio, scadenza e autorizzazioni, definiti per i criteri di accesso archiviati.</span><span class="sxs-lookup"><span data-stu-id="d9665-262">When you associate a SAS with a stored access policy, the SAS inherits the constraints--the start time, expiry time, and permissions--defined for the stored access policy.</span></span>

> [!NOTE]
> <span data-ttu-id="d9665-263">Al momento, una firma di accesso condiviso dell'account deve essere una firma di accesso condiviso ad-hoc.</span><span class="sxs-lookup"><span data-stu-id="d9665-263">Currently, an account SAS must be an ad hoc SAS.</span></span> <span data-ttu-id="d9665-264">I criteri di accesso archiviati non sono ancora supportati per la firma di accesso condiviso dell'account.</span><span class="sxs-lookup"><span data-stu-id="d9665-264">Stored access policies are not yet supported for account SAS.</span></span>

<span data-ttu-id="d9665-265">La differenza tra le due forme è importante un unico scenario chiave, la revoca.</span><span class="sxs-lookup"><span data-stu-id="d9665-265">The difference between the two forms is important for one key scenario: revocation.</span></span> <span data-ttu-id="d9665-266">Poiché un URI di firma di accesso condiviso è un URL, qualsiasi utente che ottiene la firma può usarla, indipendentemente da chi l'ha creata originariamente.</span><span class="sxs-lookup"><span data-stu-id="d9665-266">Because a SAS URI is a URL, anyone that obtains the SAS can use it, regardless of who originally created it.</span></span> <span data-ttu-id="d9665-267">Se la firma di accesso condiviso è stata pubblicata e resa pubblica, può essere usata da chiunque in tutto il mondo.</span><span class="sxs-lookup"><span data-stu-id="d9665-267">If a SAS is published publicly, it can be used by anyone in the world.</span></span> <span data-ttu-id="d9665-268">Una firma di accesso condiviso concede l'accesso alle risorse a chiunque ne disponga, fino a quando non si verifica una di queste quattro cose:</span><span class="sxs-lookup"><span data-stu-id="d9665-268">A SAS grants access to resources to anyone possessing it until one of four things happens:</span></span>

1. <span data-ttu-id="d9665-269">Viene raggiunta la scadenza specificata nella firma.</span><span class="sxs-lookup"><span data-stu-id="d9665-269">The expiry time specified on the SAS is reached.</span></span>
2. <span data-ttu-id="d9665-270">Viene raggiunta la scadenza specificata nei criteri di accesso archiviati cui viene fatto riferimento nella firma (se viene fatto riferimento a criteri di accesso archiviati e se questi indicano una scadenza).</span><span class="sxs-lookup"><span data-stu-id="d9665-270">The expiry time specified on the stored access policy referenced by the SAS is reached (if a stored access policy is referenced, and if it specifies an expiry time).</span></span> <span data-ttu-id="d9665-271">Tale situazione può verificarsi alla scadenza dell'intervallo oppure perché i criteri di accesso archiviati sono stati modificati in modo che la scadenza ricorra nel passato, e questo è uno dei modi per revocare la firma di accesso condiviso.</span><span class="sxs-lookup"><span data-stu-id="d9665-271">This can occur either because the interval elapses, or because you've modified the stored access policy with an expiry time in the past, which is one way to revoke the SAS.</span></span>
3. <span data-ttu-id="d9665-272">I criteri di accesso archiviati cui viene fatto riferimento nella firma di accesso condiviso vengono eliminati e ciò corrisponde a un altro modo per revocare la firma.</span><span class="sxs-lookup"><span data-stu-id="d9665-272">The stored access policy referenced by the SAS is deleted, which is another way to revoke the SAS.</span></span> <span data-ttu-id="d9665-273">Si noti che se si ricreano i criteri di accesso archiviati con lo stesso nome, tutti i token esistenti della firma di accesso condiviso saranno ancora validi in base alle autorizzazioni associate ai criteri (presupponendo che non sia stata superata la scadenza indicata nella firma).</span><span class="sxs-lookup"><span data-stu-id="d9665-273">Note that if you recreate the stored access policy with exactly the same name, all existing SAS tokens will again be valid according to the permissions associated with that stored access policy (assuming that the expiry time on the SAS has not passed).</span></span> <span data-ttu-id="d9665-274">Se si intende revocare la firma di accesso condiviso, assicurarsi di usare un nome diverso per ricreare i criteri di accesso archiviati con scadenza nel futuro.</span><span class="sxs-lookup"><span data-stu-id="d9665-274">If you are intending to revoke the SAS, be sure to use a different name if you recreate the access policy with an expiry time in the future.</span></span>
4. <span data-ttu-id="d9665-275">La chiave dell'account utilizzata per creare la firma di accesso condiviso viene rigenerata.</span><span class="sxs-lookup"><span data-stu-id="d9665-275">The account key that was used to create the SAS is regenerated.</span></span> <span data-ttu-id="d9665-276">Rigenerando una chiave di account, tutti i componenti dell'applicazione che usano la chiave non verranno più autenticati finché non saranno aggiornati in modo da usare l'altra chiave dell'account valida oppure la chiave dell'account appena rigenerata.</span><span class="sxs-lookup"><span data-stu-id="d9665-276">Regenerating an account key will cause all application components using that key to fail to authenticate until they're updated to use either the other valid account key or the newly regenerated account key.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="d9665-277">L'URI di una firma di accesso condiviso è associato alla chiave dell'account usata per creare la firma e ai relativi criteri di accesso archiviati (se presenti).</span><span class="sxs-lookup"><span data-stu-id="d9665-277">A shared access signature URI is associated with the account key used to create the signature, and the associated stored access policy (if any).</span></span> <span data-ttu-id="d9665-278">Se non sono specificati criteri di accesso archiviati, l'unico modo per revocare una firma di accesso condiviso consiste nel modificare la chiave dell'account.</span><span class="sxs-lookup"><span data-stu-id="d9665-278">If no stored access policy is specified, the only way to revoke a shared access signature is to change the account key.</span></span>

## <a name="authenticating-from-a-client-application-with-a-sas"></a><span data-ttu-id="d9665-279">Autenticazione da un'applicazione client con una firma di accesso condiviso</span><span class="sxs-lookup"><span data-stu-id="d9665-279">Authenticating from a client application with a SAS</span></span>
<span data-ttu-id="d9665-280">Un client che dispone di una firma di accesso condiviso può usare la firma per autenticare una richiesta a un account di archiviazione per il quale non dispone di chiavi dell'account.</span><span class="sxs-lookup"><span data-stu-id="d9665-280">A client who is in possession of a SAS can use the SAS to authenticate a request against a storage account for which they do not possess the account keys.</span></span> <span data-ttu-id="d9665-281">Una firma di accesso condiviso può essere inclusa in una stringa di connessione o usata direttamente dal metodo o dal costruttore appropriato.</span><span class="sxs-lookup"><span data-stu-id="d9665-281">A SAS can be included in a connection string, or used directly from the appropriate constructor or method.</span></span>

### <a name="using-a-sas-in-a-connection-string"></a><span data-ttu-id="d9665-282">Uso di una firma di accesso condiviso in una stringa di connessione</span><span class="sxs-lookup"><span data-stu-id="d9665-282">Using a SAS in a connection string</span></span>
[!INCLUDE [storage-use-sas-in-connection-string-include](../../../includes/storage-use-sas-in-connection-string-include.md)]

### <a name="using-a-sas-in-a-constructor-or-method"></a><span data-ttu-id="d9665-283">Uso di una firma di accesso condiviso in un costruttore o in un metodo</span><span class="sxs-lookup"><span data-stu-id="d9665-283">Using a SAS in a constructor or method</span></span>
<span data-ttu-id="d9665-284">Diversi costruttori di libreria e overload di metodi di archiviazione di Azure offrono un parametro di firma di accesso condiviso affinché sia possibile autenticare una richiesta al servizio con una firma di accesso condiviso.</span><span class="sxs-lookup"><span data-stu-id="d9665-284">Several Azure Storage client library constructors and method overloads offer a SAS parameter, so that you can authenticate a request to the service with a SAS.</span></span>

<span data-ttu-id="d9665-285">Ad esempio, in questo caso viene usato un URI di firma di accesso condiviso per creare un riferimento a un BLOB in blocchi.</span><span class="sxs-lookup"><span data-stu-id="d9665-285">For example, here a SAS URI is used to create a reference to a block blob.</span></span> <span data-ttu-id="d9665-286">Il provider di firma di accesso condiviso fornisce solo le credenziali necessarie per la richiesta.</span><span class="sxs-lookup"><span data-stu-id="d9665-286">The SAS provides the only credentials needed for the request.</span></span> <span data-ttu-id="d9665-287">Il riferimento al BLOB in blocchi viene quindi usato per un'operazione di scrittura:</span><span class="sxs-lookup"><span data-stu-id="d9665-287">The block blob reference is then used for a write operation:</span></span>

```csharp
string sasUri = "https://storagesample.blob.core.windows.net/sample-container/" +
    "sampleBlob.txt?sv=2015-07-08&sr=b&sig=39Up9JzHkxhUIhFEjEH9594DJxe7w6cIRCg0V6lCGSo%3D" +
    "&se=2016-10-18T21%3A51%3A37Z&sp=rcw";

CloudBlockBlob blob = new CloudBlockBlob(new Uri(sasUri));

// Create operation: Upload a blob with the specified name to the container.
// If the blob does not exist, it will be created. If it does exist, it will be overwritten.
try
{
    MemoryStream msWrite = new MemoryStream(Encoding.UTF8.GetBytes(blobContent));
    msWrite.Position = 0;
    using (msWrite)
    {
        await blob.UploadFromStreamAsync(msWrite);
    }

    Console.WriteLine("Create operation succeeded for SAS {0}", sasUri);
    Console.WriteLine();
}
catch (StorageException e)
{
    if (e.RequestInformation.HttpStatusCode == 403)
    {
        Console.WriteLine("Create operation failed for SAS {0}", sasUri);
        Console.WriteLine("Additional error information: " + e.Message);
        Console.WriteLine();
    }
    else
    {
        Console.WriteLine(e.Message);
        Console.ReadLine();
        throw;
    }
}

```

## <a name="best-practices-when-using-sas"></a><span data-ttu-id="d9665-288">Procedure consigliate per l'uso di SAS</span><span class="sxs-lookup"><span data-stu-id="d9665-288">Best practices when using SAS</span></span>
<span data-ttu-id="d9665-289">Quando si utilizzano le firme di accesso condiviso nell'applicazione, è necessario essere consapevoli di due rischi potenziali:</span><span class="sxs-lookup"><span data-stu-id="d9665-289">When you use shared access signatures in your applications, you need to be aware of two potential risks:</span></span>

* <span data-ttu-id="d9665-290">In caso di diffusione di una firma di accesso condiviso, chiunque la ottiene può usarla e questo potrebbe compromettere l'account di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="d9665-290">If a SAS is leaked, it can be used by anyone who obtains it, which can potentially compromise your storage account.</span></span>
* <span data-ttu-id="d9665-291">Se una firma di accesso condiviso fornita a un'applicazione client scade e l'applicazione non è in grado di recuperarne una nuova dal servizio, è possibile che le funzionalità dell'applicazione potrebbero risentirne.</span><span class="sxs-lookup"><span data-stu-id="d9665-291">If a SAS provided to a client application expires and the application is unable to retrieve a new SAS from your service, then the application's functionality may be hindered.</span></span>

<span data-ttu-id="d9665-292">Per mitigare questi rischi, è consigliabile attenersi ai consigli seguenti relativi all'utilizzo di firme di accesso condiviso:</span><span class="sxs-lookup"><span data-stu-id="d9665-292">The following recommendations for using shared access signatures can help mitigate these risks:</span></span>

1. <span data-ttu-id="d9665-293">**Usare sempre HTTPS** per creare o distribuire una firma di accesso condiviso.</span><span class="sxs-lookup"><span data-stu-id="d9665-293">**Always use HTTPS** to create or distribute a SAS.</span></span> <span data-ttu-id="d9665-294">Se una firma di accesso condiviso passata tramite HTTP viene intercettata, un utente malintenzionato che esegue un attacco man-in-the-middle è in grado di leggere la firma e quindi di usarla come se fosse l'utente cui è destinata, e questo potrebbe comportare la compromissione di dati sensibili o il danneggiamento di dati da parte dell'utente malintenzionato.</span><span class="sxs-lookup"><span data-stu-id="d9665-294">If a SAS is passed over HTTP and intercepted, an attacker performing a man-in-the-middle attack is able to read the SAS and then use it just as the intended user could have, potentially compromising sensitive data or allowing for data corruption by the malicious user.</span></span>
2. <span data-ttu-id="d9665-295">**Laddove possibile fare riferimento a criteri di accesso archiviati.**</span><span class="sxs-lookup"><span data-stu-id="d9665-295">**Reference stored access policies where possible.**</span></span> <span data-ttu-id="d9665-296">I criteri di accesso archiviati consentono di revocare le autorizzazioni senza rigenerare le chiavi dell'account di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="d9665-296">Stored access policies give you the option to revoke permissions without having to regenerate the storage account keys.</span></span> <span data-ttu-id="d9665-297">Impostare la loro scadenza a un momento molto lontano nel futuro (o infinito) e assicurarsi che venga aggiornata regolarmente in modo che ricorra nel futuro.</span><span class="sxs-lookup"><span data-stu-id="d9665-297">Set the expiration on these very far in the future (or infinite) and make sure it's regularly updated to move it farther into the future.</span></span>
3. <span data-ttu-id="d9665-298">**Usare scadenze a breve termine per una firma di accesso condiviso ad hoc.**</span><span class="sxs-lookup"><span data-stu-id="d9665-298">**Use near-term expiration times on an ad hoc SAS.**</span></span> <span data-ttu-id="d9665-299">In questo modo, anche se una firma di accesso condiviso viene compromessa, è valida solo per un breve periodo di tempo.</span><span class="sxs-lookup"><span data-stu-id="d9665-299">In this way, even if a SAS is compromised, it's valid only for a short time.</span></span> <span data-ttu-id="d9665-300">Questo consiglio è particolarmente importante se non è possibile fare riferimento a criteri di accesso archiviati</span><span class="sxs-lookup"><span data-stu-id="d9665-300">This practice is especially important if you cannot reference a stored access policy.</span></span> <span data-ttu-id="d9665-301">Una scadenza breve consente anche di limitare la quantità di dati che è possibile scrivere in un BLOB riducendo il tempo disponibile per il caricamento.</span><span class="sxs-lookup"><span data-stu-id="d9665-301">Near-term expiration times also limit the amount of data that can be written to a blob by limiting the time available to upload to it.</span></span>
4. <span data-ttu-id="d9665-302"><seg>
  **Se necessario, chiedere ai client di rinnovare automaticamente la firma di accesso condiviso..**</seg></span><span class="sxs-lookup"><span data-stu-id="d9665-302">**Have clients automatically renew the SAS if necessary.**</span></span> <span data-ttu-id="d9665-303">È consigliabile rinnovare la firma di accesso condiviso nei client prima della scadenza in modo da avere la possibilità di effettuare altri tentativi qualora il servizio che fornisce la firma di accesso condiviso non sia disponibile.</span><span class="sxs-lookup"><span data-stu-id="d9665-303">Clients should renew the SAS well before the expiration, in order to allow time for retries if the service providing the SAS is unavailable.</span></span> <span data-ttu-id="d9665-304">Se la firma di accesso condiviso è destinata a essere utilizzata per poche operazioni immediate e di breve durata da completare entro la data di scadenza, il rinnovo della firma di accesso condiviso non è necessario.</span><span class="sxs-lookup"><span data-stu-id="d9665-304">If your SAS is meant to be used for a small number of immediate, short-lived operations that are expected to be completed within the expiration period, then this may be unnecessary as the SAS is not expected to be renewed.</span></span> <span data-ttu-id="d9665-305">Se tuttavia si dispone di client che effettuano normalmente richieste tramite la firma di accesso condiviso, è necessario considerare la possibilità che la firma scada.</span><span class="sxs-lookup"><span data-stu-id="d9665-305">However, if you have client that is routinely making requests via SAS, then the possibility of expiration comes into play.</span></span> <span data-ttu-id="d9665-306">In questo caso è essenziale trovare un punto di equilibrio tale da garantire che la firma di accesso condiviso sia di breve durata (come indicato in precedenza) e che il client richieda il rinnovo in tempo utile per evitare malfunzionamenti causati dalla scadenza della firma prima del rinnovo.</span><span class="sxs-lookup"><span data-stu-id="d9665-306">The key consideration is to balance the need for the SAS to be short-lived (as previously stated) with the need to ensure that the client is requesting renewal early enough (to avoid disruption due to the SAS expiring prior to successful renewal).</span></span>
5. <span data-ttu-id="d9665-307">**Prestare attenzione all'ora di inizio della firma di accesso condiviso.**</span><span class="sxs-lookup"><span data-stu-id="d9665-307">**Be careful with SAS start time.**</span></span> <span data-ttu-id="d9665-308">Se si imposta l'ora di inizio della firma di accesso condiviso su **ora**, a causa dello sfasamento di orario, ovvero delle differenze dell'ora corrente a seconda del computer in uso, potrebbero verificarsi problemi intermittenti nei primi minuti.</span><span class="sxs-lookup"><span data-stu-id="d9665-308">If you set the start time for a SAS to **now**, then due to clock skew (differences in current time according to different machines), failures may be observed intermittently for the first few minutes.</span></span> <span data-ttu-id="d9665-309">In generale, impostare l'ora di inizio ad almeno 15 minuti prima.</span><span class="sxs-lookup"><span data-stu-id="d9665-309">In general, set the start time to be at least 15 minutes in the past.</span></span> <span data-ttu-id="d9665-310">Oppure evitare di impostarla, in modo che la firma diventi immediatamente valida in tutti i casi.</span><span class="sxs-lookup"><span data-stu-id="d9665-310">Or, don't set it at all, which will make it valid immediately in all cases.</span></span> <span data-ttu-id="d9665-311">Le stesse considerazioni sono valide anche per la scadenza, pertanto è consigliabile osservare fino a 15 minuti di sfasamento di orario in entrambe le direzioni per qualsiasi richiesta.</span><span class="sxs-lookup"><span data-stu-id="d9665-311">The same generally applies to expiry time as well--remember that you may observe up to 15 minutes of clock skew in either direction on any request.</span></span> <span data-ttu-id="d9665-312">Per i client che usano una versione di REST precedente la 2012-02-12, la durata massima della firma di accesso condiviso che non fa riferimento a criteri di accesso archiviati è di 1 ora, pertanto tutti i criteri di durata maggiore non saranno validi.</span><span class="sxs-lookup"><span data-stu-id="d9665-312">For clients using a REST version prior to 2012-02-12, the maximum duration for a SAS that does not reference a stored access policy is 1 hour, and any policies specifying longer term than that will fail.</span></span>
6. <span data-ttu-id="d9665-313">**Indicare in modo specifico la risorsa cui accedere.**</span><span class="sxs-lookup"><span data-stu-id="d9665-313">**Be specific with the resource to be accessed.**</span></span> <span data-ttu-id="d9665-314">Una procedura di sicurezza consigliata consiste nel fornire a un utente i privilegi minimi necessari.</span><span class="sxs-lookup"><span data-stu-id="d9665-314">A security best practice is to provide a user with the minimum required privileges.</span></span> <span data-ttu-id="d9665-315">Se un utente necessita solo dell'accesso in lettura a una singola entità, concedere solo tale tipo di accesso per tale entità e non l'accesso in lettura/scrittura/eliminazione per tutte le entità.</span><span class="sxs-lookup"><span data-stu-id="d9665-315">If a user only needs read access to a single entity, then grant them read access to that single entity, and not read/write/delete access to all entities.</span></span> <span data-ttu-id="d9665-316">Ciò consente anche di ridurre i danni se una firma di accesso condiviso viene compromessa in quanto la firma è meno potente nelle mani di un utente malintenzionato.</span><span class="sxs-lookup"><span data-stu-id="d9665-316">This also helps lessen the damage if a SAS is compromised because the SAS has less power in the hands of an attacker.</span></span>
7. <span data-ttu-id="d9665-317">**Comprendere che all'account verrà fatturato qualsiasi tipo di utilizzo, incluso quello effettuato con la firma di accesso condiviso.**</span><span class="sxs-lookup"><span data-stu-id="d9665-317">**Understand that your account will be billed for any usage, including that done with SAS.**</span></span> <span data-ttu-id="d9665-318">Se si fornisce accesso in scrittura a un BLOB, un utente potrebbe scegliere di caricare un BLOB da 200 GB.</span><span class="sxs-lookup"><span data-stu-id="d9665-318">If you provide write access to a blob, a user may choose to upload a 200GB blob.</span></span> <span data-ttu-id="d9665-319">Se si offre anche l'accesso in lettura, l'utente potrebbe scegliere di scaricarlo 10 volte e ciò potrebbe comportare 2 TB di costi in uscita.</span><span class="sxs-lookup"><span data-stu-id="d9665-319">If you've given them read access as well, they may choose to download it 10 times, incurring 2 TB in egress costs for you.</span></span> <span data-ttu-id="d9665-320">Anche in questo caso, fornire autorizzazioni limitate per ridurre l'impatto potenziale delle azioni di utenti malintenzionati.</span><span class="sxs-lookup"><span data-stu-id="d9665-320">Again, provide limited permissions to help mitigate the potential actions of malicious users.</span></span> <span data-ttu-id="d9665-321">Per ridurre questa minaccia, usare firme di accesso condiviso di breve durata, prestando però attenzione allo sfasamento di orario per la scadenza.</span><span class="sxs-lookup"><span data-stu-id="d9665-321">Use short-lived SAS to reduce this threat (but be mindful of clock skew on the end time).</span></span>
8. <span data-ttu-id="d9665-322">**Convalidare i dati scritti tramite la firma di accesso condiviso.**</span><span class="sxs-lookup"><span data-stu-id="d9665-322">**Validate data written using SAS.**</span></span> <span data-ttu-id="d9665-323">Quando un'applicazione client scrive i dati nell'account di archiviazione, tenere presente che tali dati potrebbero causare problemi.</span><span class="sxs-lookup"><span data-stu-id="d9665-323">When a client application writes data to your storage account, keep in mind that there can be problems with that data.</span></span> <span data-ttu-id="d9665-324">Se l'applicazione richiede che i dati vengano convalidati o autorizzati prima dell'uso, è necessario eseguire la convalida dopo la scrittura dei dati e prima che vengano utilizzati dall'applicazione.</span><span class="sxs-lookup"><span data-stu-id="d9665-324">If your application requires that that data be validated or authorized before it is ready to use, you should perform this validation after the data is written and before it is used by your application.</span></span> <span data-ttu-id="d9665-325">Questa procedura consente inoltre di evitare la scrittura di dati danneggiati o dannosi nell'account da parte da un utente che ha acquisito correttamente la firma di accesso condiviso o di un utente che sfrutta una firma diffusa per errore.</span><span class="sxs-lookup"><span data-stu-id="d9665-325">This practice also protects against corrupt or malicious data being written to your account, either by a user who properly acquired the SAS, or by a user exploiting a leaked SAS.</span></span>
9. <span data-ttu-id="d9665-326">**Non usare sempre SAS.**</span><span class="sxs-lookup"><span data-stu-id="d9665-326">**Don't always use SAS.**</span></span> <span data-ttu-id="d9665-327">Talvolta i rischi associati a una particolare operazione su un account di archiviazione superano i benefici derivanti dall'uso della firma di accesso condiviso.</span><span class="sxs-lookup"><span data-stu-id="d9665-327">Sometimes the risks associated with a particular operation against your storage account outweigh the benefits of SAS.</span></span> <span data-ttu-id="d9665-328">Per tali operazioni creare un servizio di livello intermedio che effettui operazioni di scrittura nell'account di archiviazione dopo autenticazione, controllo e convalida di regole di business.</span><span class="sxs-lookup"><span data-stu-id="d9665-328">For such operations, create a middle-tier service that writes to your storage account after performing business rule validation, authentication, and auditing.</span></span> <span data-ttu-id="d9665-329">Talvolta è inoltre più semplice gestire l'accesso in modi diversi.</span><span class="sxs-lookup"><span data-stu-id="d9665-329">Also, sometimes it's simpler to manage access in other ways.</span></span> <span data-ttu-id="d9665-330">Se ad esempio si desidera rendere pubblicamente leggibili tutti i BLOB di un contenitore, è possibile rendere pubblico il contenitore anziché fornire una firma di accesso condiviso a ogni client per consentire l'accesso.</span><span class="sxs-lookup"><span data-stu-id="d9665-330">For example, if you want to make all blobs in a container publically readable, you can make the container Public, rather than providing a SAS to every client for access.</span></span>
10. <span data-ttu-id="d9665-331">**Usare Analisi archiviazione per monitorare l'applicazione.**</span><span class="sxs-lookup"><span data-stu-id="d9665-331">**Use Storage Analytics to monitor your application.**</span></span> <span data-ttu-id="d9665-332">È possibile usare la registrazione e la metrica per osservare eventuali picchi di errori di autenticazione causati da un'interruzione del servizio del provider di firme di accesso condiviso oppure dalla rimozione accidentale di criteri di accesso archiviati.</span><span class="sxs-lookup"><span data-stu-id="d9665-332">You can use logging and metrics to observe any spike in authentication failures due to an outage in your SAS provider service or to the inadvertent removal of a stored access policy.</span></span> <span data-ttu-id="d9665-333">Per altre informazioni, vedere il [blog del team del servizio di archiviazione di Azure](http://blogs.msdn.com/b/windowsazurestorage/archive/2011/08/03/windows-azure-storage-logging-using-logs-to-track-storage-requests.aspx) .</span><span class="sxs-lookup"><span data-stu-id="d9665-333">See the [Azure Storage Team Blog](http://blogs.msdn.com/b/windowsazurestorage/archive/2011/08/03/windows-azure-storage-logging-using-logs-to-track-storage-requests.aspx) for additional information.</span></span>

## <a name="sas-examples"></a><span data-ttu-id="d9665-334">Esempi di firma di accesso condiviso</span><span class="sxs-lookup"><span data-stu-id="d9665-334">SAS examples</span></span>
<span data-ttu-id="d9665-335">Di seguito sono riportati alcuni esempi di entrambi i tipi di firma di accesso condiviso, dell'account e del servizio.</span><span class="sxs-lookup"><span data-stu-id="d9665-335">Below are some examples of both types of shared access signatures, account SAS and service SAS.</span></span>

<span data-ttu-id="d9665-336">Per eseguire questi esempi in C# è necessario fare riferimento ai seguenti pacchetti NuGet nel progetto:</span><span class="sxs-lookup"><span data-stu-id="d9665-336">To run these C# examples, you need to reference the following NuGet packages in your project:</span></span>

* <span data-ttu-id="d9665-337">[Azure Storage Client Library for .NET](http://www.nuget.org/packages/WindowsAzure.Storage), versione 6.x o versione successiva (per usare l'account SAS).</span><span class="sxs-lookup"><span data-stu-id="d9665-337">[Azure Storage Client Library for .NET](http://www.nuget.org/packages/WindowsAzure.Storage), version 6.x or later (to use account SAS).</span></span>
* [<span data-ttu-id="d9665-338">Gestione configurazione di Azure</span><span class="sxs-lookup"><span data-stu-id="d9665-338">Azure Configuration Manager</span></span>](http://www.nuget.org/packages/Microsoft.WindowsAzure.ConfigurationManager)

<span data-ttu-id="d9665-339">Per altri esempi che illustrano come creare e testare una firma di accesso condiviso, vedere [Esempi di codice per Azure per Archiviazione](https://azure.microsoft.com/documentation/samples/?service=storage).</span><span class="sxs-lookup"><span data-stu-id="d9665-339">For additional examples that show how to create and test a SAS, see [Azure Code Samples for Storage](https://azure.microsoft.com/documentation/samples/?service=storage).</span></span>

### <a name="example-create-and-use-an-account-sas"></a><span data-ttu-id="d9665-340">Esempio: Creare e usare una firma di accesso condiviso dell'account</span><span class="sxs-lookup"><span data-stu-id="d9665-340">Example: Create and use an account SAS</span></span>
<span data-ttu-id="d9665-341">L'esempio di codice seguente crea una firma di accesso condiviso valida per i servizi BLOB e File e concede al client le autorizzazioni di lettura, scrittura ed elenco per accedere alle API a livello di servizio.</span><span class="sxs-lookup"><span data-stu-id="d9665-341">The following code example creates an account SAS that is valid for the Blob and File services, and gives the client permissions read, write, and list permissions to access service-level APIs.</span></span> <span data-ttu-id="d9665-342">Per la firma di accesso condiviso dell'account il protocollo è limitato ad HTTPS, pertanto è necessario creare una richiesta HTTPS.</span><span class="sxs-lookup"><span data-stu-id="d9665-342">The account SAS restricts the protocol to HTTPS, so the request must be made with HTTPS.</span></span>

```csharp
static string GetAccountSASToken()
{
    // To create the account SAS, you need to use your shared key credentials. Modify for your account.
    const string ConnectionString = "DefaultEndpointsProtocol=https;AccountName=account-name;AccountKey=account-key";
    CloudStorageAccount storageAccount = CloudStorageAccount.Parse(ConnectionString);

    // Create a new access policy for the account.
    SharedAccessAccountPolicy policy = new SharedAccessAccountPolicy()
        {
            Permissions = SharedAccessAccountPermissions.Read | SharedAccessAccountPermissions.Write | SharedAccessAccountPermissions.List,
            Services = SharedAccessAccountServices.Blob | SharedAccessAccountServices.File,
            ResourceTypes = SharedAccessAccountResourceTypes.Service,
            SharedAccessExpiryTime = DateTime.UtcNow.AddHours(24),
            Protocols = SharedAccessProtocol.HttpsOnly
        };

    // Return the SAS token.
    return storageAccount.GetSharedAccessSignature(policy);
}
```

<span data-ttu-id="d9665-343">Per usare la firma di accesso condiviso dell'account per accedere alle API a livello di servizio per il servizio BLOB, creare un oggetto client BLOB usando la firma di accesso condiviso e l'endpoint account di archiviazione per l'account di archiviazione corrente.</span><span class="sxs-lookup"><span data-stu-id="d9665-343">To use the account SAS to access service-level APIs for the Blob service, construct a Blob client object using the SAS and the Blob storage endpoint for your storage account.</span></span>

```csharp
static void UseAccountSAS(string sasToken)
{
    // Create new storage credentials using the SAS token.
    StorageCredentials accountSAS = new StorageCredentials(sasToken);
    // Use these credentials and the account name to create a Blob service client.
    CloudStorageAccount accountWithSAS = new CloudStorageAccount(accountSAS, "account-name", endpointSuffix: null, useHttps: true);
    CloudBlobClient blobClientWithSAS = accountWithSAS.CreateCloudBlobClient();

    // Now set the service properties for the Blob client created with the SAS.
    blobClientWithSAS.SetServiceProperties(new ServiceProperties()
    {
        HourMetrics = new MetricsProperties()
        {
            MetricsLevel = MetricsLevel.ServiceAndApi,
            RetentionDays = 7,
            Version = "1.0"
        },
        MinuteMetrics = new MetricsProperties()
        {
            MetricsLevel = MetricsLevel.ServiceAndApi,
            RetentionDays = 7,
            Version = "1.0"
        },
        Logging = new LoggingProperties()
        {
            LoggingOperations = LoggingOperations.All,
            RetentionDays = 14,
            Version = "1.0"
        }
    });

    // The permissions granted by the account SAS also permit you to retrieve service properties.
    ServiceProperties serviceProperties = blobClientWithSAS.GetServiceProperties();
    Console.WriteLine(serviceProperties.HourMetrics.MetricsLevel);
    Console.WriteLine(serviceProperties.HourMetrics.RetentionDays);
    Console.WriteLine(serviceProperties.HourMetrics.Version);
}
```

### <a name="example-create-a-stored-access-policy"></a><span data-ttu-id="d9665-344">Esempio: Creare criteri di accesso archiviati</span><span class="sxs-lookup"><span data-stu-id="d9665-344">Example: Create a stored access policy</span></span>
<span data-ttu-id="d9665-345">Il codice seguente crea un criterio di accesso archiviato su un contenitore.</span><span class="sxs-lookup"><span data-stu-id="d9665-345">The following code creates a stored access policy on a container.</span></span> <span data-ttu-id="d9665-346">È possibile usare i criteri di accesso per specificare i vincoli per una firma di accesso condiviso del servizio sul contenitore o i relativi BLOB.</span><span class="sxs-lookup"><span data-stu-id="d9665-346">You can use the access policy to specify constraints for a service SAS on the container or its blobs.</span></span>

```csharp
private static async Task CreateSharedAccessPolicyAsync(CloudBlobContainer container, string policyName)
{
    // Create a new shared access policy and define its constraints.
    // The access policy provides create, write, read, list, and delete permissions.
    SharedAccessBlobPolicy sharedPolicy = new SharedAccessBlobPolicy()
    {
        // When the start time for the SAS is omitted, the start time is assumed to be the time when the storage service receives the request.
        // Omitting the start time for a SAS that is effective immediately helps to avoid clock skew.
        SharedAccessExpiryTime = DateTime.UtcNow.AddHours(24),
        Permissions = SharedAccessBlobPermissions.Read | SharedAccessBlobPermissions.List |
            SharedAccessBlobPermissions.Write | SharedAccessBlobPermissions.Create | SharedAccessBlobPermissions.Delete
    };

    // Get the container's existing permissions.
    BlobContainerPermissions permissions = await container.GetPermissionsAsync();

    // Add the new policy to the container's permissions, and set the container's permissions.
    permissions.SharedAccessPolicies.Add(policyName, sharedPolicy);
    await container.SetPermissionsAsync(permissions);
}
```

### <a name="example-create-a-service-sas-on-a-container"></a><span data-ttu-id="d9665-347">Esempio: Creare una firma di accesso condiviso del servizio su un contenitore</span><span class="sxs-lookup"><span data-stu-id="d9665-347">Example: Create a service SAS on a container</span></span>
<span data-ttu-id="d9665-348">Il codice seguente crea una firma di accesso condiviso su un contenitore.</span><span class="sxs-lookup"><span data-stu-id="d9665-348">The following code creates a SAS on a container.</span></span> <span data-ttu-id="d9665-349">Se viene specificato il nome di un criterio di accesso archiviato esistente, tale criterio è associato alla firma di accesso condiviso.</span><span class="sxs-lookup"><span data-stu-id="d9665-349">If the name of an existing stored access policy is provided, that policy is associated with the SAS.</span></span> <span data-ttu-id="d9665-350">Se non viene specificato alcun criterio di accesso archiviato, il codice crea una firma di accesso condiviso ad hoc sul contenitore.</span><span class="sxs-lookup"><span data-stu-id="d9665-350">If no stored access policy is provided, then the code creates an ad-hoc SAS on the container.</span></span>

```csharp
private static string GetContainerSasUri(CloudBlobContainer container, string storedPolicyName = null)
{
    string sasContainerToken;

    // If no stored policy is specified, create a new access policy and define its constraints.
    if (storedPolicyName == null)
    {
        // Note that the SharedAccessBlobPolicy class is used both to define the parameters of an ad-hoc SAS, and
        // to construct a shared access policy that is saved to the container's shared access policies.
        SharedAccessBlobPolicy adHocPolicy = new SharedAccessBlobPolicy()
        {
            // When the start time for the SAS is omitted, the start time is assumed to be the time when the storage service receives the request.
            // Omitting the start time for a SAS that is effective immediately helps to avoid clock skew.
            SharedAccessExpiryTime = DateTime.UtcNow.AddHours(24),
            Permissions = SharedAccessBlobPermissions.Write | SharedAccessBlobPermissions.List
        };

        // Generate the shared access signature on the container, setting the constraints directly on the signature.
        sasContainerToken = container.GetSharedAccessSignature(adHocPolicy, null);

        Console.WriteLine("SAS for blob container (ad hoc): {0}", sasContainerToken);
        Console.WriteLine();
    }
    else
    {
        // Generate the shared access signature on the container. In this case, all of the constraints for the
        // shared access signature are specified on the stored access policy, which is provided by name.
        // It is also possible to specify some constraints on an ad-hoc SAS and others on the stored access policy.
        sasContainerToken = container.GetSharedAccessSignature(null, storedPolicyName);

        Console.WriteLine("SAS for blob container (stored access policy): {0}", sasContainerToken);
        Console.WriteLine();
    }

    // Return the URI string for the container, including the SAS token.
    return container.Uri + sasContainerToken;
}
```

### <a name="example-create-a-service-sas-on-a-blob"></a><span data-ttu-id="d9665-351">Esempio: Creare una firma di accesso condiviso del servizio su un BLOB</span><span class="sxs-lookup"><span data-stu-id="d9665-351">Example: Create a service SAS on a blob</span></span>
<span data-ttu-id="d9665-352">Il codice seguente crea una firma di accesso condiviso su un BLOB.</span><span class="sxs-lookup"><span data-stu-id="d9665-352">The following code creates a SAS on a blob.</span></span> <span data-ttu-id="d9665-353">Se viene specificato il nome di un criterio di accesso archiviato esistente, tale criterio è associato alla firma di accesso condiviso.</span><span class="sxs-lookup"><span data-stu-id="d9665-353">If the name of an existing stored access policy is provided, that policy is associated with the SAS.</span></span> <span data-ttu-id="d9665-354">Se non viene specificato alcun criterio di accesso archiviato, il codice crea una firma di accesso condiviso ad hoc sul BLOB.</span><span class="sxs-lookup"><span data-stu-id="d9665-354">If no stored access policy is provided, then the code creates an ad-hoc SAS on the blob.</span></span>

```csharp
private static string GetBlobSasUri(CloudBlobContainer container, string blobName, string policyName = null)
{
    string sasBlobToken;

    // Get a reference to a blob within the container.
    // Note that the blob may not exist yet, but a SAS can still be created for it.
    CloudBlockBlob blob = container.GetBlockBlobReference(blobName);

    if (policyName == null)
    {
        // Create a new access policy and define its constraints.
        // Note that the SharedAccessBlobPolicy class is used both to define the parameters of an ad-hoc SAS, and
        // to construct a shared access policy that is saved to the container's shared access policies.
        SharedAccessBlobPolicy adHocSAS = new SharedAccessBlobPolicy()
        {
            // When the start time for the SAS is omitted, the start time is assumed to be the time when the storage service receives the request.
            // Omitting the start time for a SAS that is effective immediately helps to avoid clock skew.
            SharedAccessExpiryTime = DateTime.UtcNow.AddHours(24),
            Permissions = SharedAccessBlobPermissions.Read | SharedAccessBlobPermissions.Write | SharedAccessBlobPermissions.Create
        };

        // Generate the shared access signature on the blob, setting the constraints directly on the signature.
        sasBlobToken = blob.GetSharedAccessSignature(adHocSAS);

        Console.WriteLine("SAS for blob (ad hoc): {0}", sasBlobToken);
        Console.WriteLine();
    }
    else
    {
        // Generate the shared access signature on the blob. In this case, all of the constraints for the
        // shared access signature are specified on the container's stored access policy.
        sasBlobToken = blob.GetSharedAccessSignature(null, policyName);

        Console.WriteLine("SAS for blob (stored access policy): {0}", sasBlobToken);
        Console.WriteLine();
    }

    // Return the URI string for the container, including the SAS token.
    return blob.Uri + sasBlobToken;
}
```

## <a name="conclusion"></a><span data-ttu-id="d9665-355">Conclusioni</span><span class="sxs-lookup"><span data-stu-id="d9665-355">Conclusion</span></span>
<span data-ttu-id="d9665-356">Le firme di accesso condiviso sono utili per offrire autorizzazioni limitate all'account di archiviazione ai client ai quali non si desidera fornire la chiave dell'account.</span><span class="sxs-lookup"><span data-stu-id="d9665-356">Shared access signatures are useful for providing limited permissions to your storage account to clients that should not have the account key.</span></span> <span data-ttu-id="d9665-357">In quanto tali, costituiscono una parte essenziale del modello di sicurezza di qualsiasi applicazione che utilizza il servizio di archiviazione di Azure.</span><span class="sxs-lookup"><span data-stu-id="d9665-357">As such, they are a vital part of the security model for any application using Azure Storage.</span></span> <span data-ttu-id="d9665-358">Il rispetto delle procedure consigliate sopra elencate consente di usare la firma di accesso condiviso per offrire accesso ancor più flessibile alle risorse dell'account di archiviazione senza compromettere la sicurezza dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="d9665-358">If you follow the best practices listed here, you can use SAS to provide greater flexibility of access to resources in your storage account, without compromising the security of your application.</span></span>

## <a name="next-steps"></a><span data-ttu-id="d9665-359">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="d9665-359">Next Steps</span></span>
* [<span data-ttu-id="d9665-360">Gestire l'accesso in lettura anonimo a contenitori e BLOB</span><span class="sxs-lookup"><span data-stu-id="d9665-360">Manage anonymous read access to containers and blobs</span></span>](../blobs/storage-manage-access-to-resources.md)
* [<span data-ttu-id="d9665-361">Delega dell'accesso con una firma di accesso condiviso</span><span class="sxs-lookup"><span data-stu-id="d9665-361">Delegating Access with a Shared Access Signature</span></span>](http://msdn.microsoft.com/library/azure/ee395415.aspx)
* [<span data-ttu-id="d9665-362">Introduzione alla firma di accesso condiviso per tabelle e code</span><span class="sxs-lookup"><span data-stu-id="d9665-362">Introducing Table and Queue SAS</span></span>](http://blogs.msdn.com/b/windowsazurestorage/archive/2012/06/12/introducing-table-sas-shared-access-signature-queue-sas-and-update-to-blob-sas.aspx)
