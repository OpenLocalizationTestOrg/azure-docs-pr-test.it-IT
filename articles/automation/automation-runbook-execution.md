---
title: Esecuzione del Runbook in Automazione di Azure | Microsoft Docs
description: Descrive i dettagli dell'elaborazione di un runbook in Automazione di Azure.
services: automation
documentationcenter: 
author: mgoedtel
manager: jwhit
editor: tysonn
ms.assetid: d10c8ce2-2c0b-4ea7-ba3c-d20e09b2c9ca
ms.service: automation
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 08/17/2017
ms.author: bwren
ms.openlocfilehash: 14f923e3f08dd3b286218ae56012ce14edcc4058
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/29/2017
---
# <a name="runbook-execution-in-azure-automation"></a><span data-ttu-id="e391b-103">Esecuzione di runbook in Automazione di Azure</span><span class="sxs-lookup"><span data-stu-id="e391b-103">Runbook execution in Azure Automation</span></span>
<span data-ttu-id="e391b-104">Quando si avvia un runbook in Automazione di Azure, viene creato un processo.</span><span class="sxs-lookup"><span data-stu-id="e391b-104">When you start a runbook in Azure Automation, a job is created.</span></span> <span data-ttu-id="e391b-105">Un processo è una singola istanza di esecuzione di un runbook.</span><span class="sxs-lookup"><span data-stu-id="e391b-105">A job is a single execution instance of a runbook.</span></span> <span data-ttu-id="e391b-106">Per eseguire ogni processo, viene assegnato un computer di lavoro di Automazione di Azure.</span><span class="sxs-lookup"><span data-stu-id="e391b-106">An Azure Automation worker is assigned to run each job.</span></span> <span data-ttu-id="e391b-107">I computer di lavoro sono condivisi da più account Azure, mentre i processi di account di automazione diversi sono isolati l'uno dall'altro.</span><span class="sxs-lookup"><span data-stu-id="e391b-107">While workers are shared by multiple Azure accounts, jobs from different Automation accounts are isolated from one another.</span></span> <span data-ttu-id="e391b-108">Non si dispone di alcun controllo sul computer di lavoro che gestisce la richiesta per il processo.</span><span class="sxs-lookup"><span data-stu-id="e391b-108">You do not have control over which worker services the request for your job.</span></span>  <span data-ttu-id="e391b-109">In un singolo runbook possono venire eseguiti più processi contemporaneamente.</span><span class="sxs-lookup"><span data-stu-id="e391b-109">A single runbook can have multiple jobs running at one time.</span></span> <span data-ttu-id="e391b-110">Quando si visualizza l'elenco dei runbook nel portale di Azure, è visibile lo stato di tutti i processi avviati per ogni runbook.</span><span class="sxs-lookup"><span data-stu-id="e391b-110">When you view the list of runbooks in the Azure portal, it lists the status of all jobs that were started for each runbook.</span></span> <span data-ttu-id="e391b-111">È possibile visualizzare l'elenco dei processi per il singolo runbook per tenere traccia dello stato di ognuno.</span><span class="sxs-lookup"><span data-stu-id="e391b-111">You can view the list of jobs for each runbook in order to track the status of each.</span></span> <span data-ttu-id="e391b-112">Per una descrizione dei diversi stati dei processi, vedere [Stati dei processi](#job-statuses).</span><span class="sxs-lookup"><span data-stu-id="e391b-112">For a description of the different job statuses, see [Job Statuses](#job-statuses).</span></span>

<span data-ttu-id="e391b-113">Nel diagramma seguente viene illustrato il ciclo di vita di un processo del Runbook per [Runbook grafici](automation-runbook-types.md#graphical-runbooks) e [Runbook del flusso di lavoro PowerShell](automation-runbook-types.md#powershell-workflow-runbooks).</span><span class="sxs-lookup"><span data-stu-id="e391b-113">The following diagram shows the lifecycle of a runbook job for [Graphical runbooks](automation-runbook-types.md#graphical-runbooks) and [PowerShell Workflow runbooks](automation-runbook-types.md#powershell-workflow-runbooks).</span></span>

![Stati del processo - Flusso di lavoro PowerShell](./media/automation-runbook-execution/job-statuses.png)

<span data-ttu-id="e391b-115">Nel diagramma seguente viene illustrato il ciclo di vita di un processo runbook per [Runbook PowerShell](automation-runbook-types.md#powershell-runbooks).</span><span class="sxs-lookup"><span data-stu-id="e391b-115">The following diagram shows the lifecycle of a runbook job for [PowerShell runbooks](automation-runbook-types.md#powershell-runbooks).</span></span>

![Stati del processo - Script PowerShell](./media/automation-runbook-execution/job-statuses-script.png)

<span data-ttu-id="e391b-117">I processi accedono alle risorse di Azure eseguendo una connessione alla sottoscrizione di Azure.</span><span class="sxs-lookup"><span data-stu-id="e391b-117">Your jobs have access to your Azure resources by making a connection to your Azure subscription.</span></span> <span data-ttu-id="e391b-118">Possono accedere solo alle risorse del data center dell'utente se tali risorse sono accessibili dal cloud pubblico.</span><span class="sxs-lookup"><span data-stu-id="e391b-118">They only have access to resources in your data center if those resources are accessible from the public cloud.</span></span>

## <a name="job-statuses"></a><span data-ttu-id="e391b-119">Stati dei processi</span><span class="sxs-lookup"><span data-stu-id="e391b-119">Job statuses</span></span>
<span data-ttu-id="e391b-120">La tabella seguente descrive i diversi stati possibili per un processo.</span><span class="sxs-lookup"><span data-stu-id="e391b-120">The following table describes the different statuses that are possible for a job.</span></span>

| <span data-ttu-id="e391b-121">Stato</span><span class="sxs-lookup"><span data-stu-id="e391b-121">Status</span></span> | <span data-ttu-id="e391b-122">Descrizione</span><span class="sxs-lookup"><span data-stu-id="e391b-122">Description</span></span> |
|:--- |:--- |
| <span data-ttu-id="e391b-123">Completed</span><span class="sxs-lookup"><span data-stu-id="e391b-123">Completed</span></span> |<span data-ttu-id="e391b-124">Il processo è stato completato.</span><span class="sxs-lookup"><span data-stu-id="e391b-124">The job completed successfully.</span></span> |
| <span data-ttu-id="e391b-125">Failed</span><span class="sxs-lookup"><span data-stu-id="e391b-125">Failed</span></span> |<span data-ttu-id="e391b-126">Per [Runbook grafico e runbook flusso di lavoro PowerShell](automation-runbook-types.md), la compilazione di runbook non è riuscita.</span><span class="sxs-lookup"><span data-stu-id="e391b-126">For [Graphical and PowerShell Workflow runbooks](automation-runbook-types.md), the runbook failed to compile.</span></span>  <span data-ttu-id="e391b-127">Per [Runbook di Script di PowerShell](automation-runbook-types.md), non è stato possibile avviare il runbook o il processo ha rilevato un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="e391b-127">For [PowerShell Script runbooks](automation-runbook-types.md), the runbook failed to start or the job encountered an exception.</span></span> |
| <span data-ttu-id="e391b-128">Failed, waiting for resources</span><span class="sxs-lookup"><span data-stu-id="e391b-128">Failed, waiting for resources</span></span> |<span data-ttu-id="e391b-129">Il processo non è riuscito perché ha raggiunto il limite di [condivisione equa](#fairshare) tre volte iniziando ogni volta dallo stesso checkpoint o dall'inizio del runbook.</span><span class="sxs-lookup"><span data-stu-id="e391b-129">The job failed because it reached the [fair share](#fairshare) limit three times and started from the same checkpoint or from the start of the runbook each time.</span></span> |
| <span data-ttu-id="e391b-130">Queued</span><span class="sxs-lookup"><span data-stu-id="e391b-130">Queued</span></span> |<span data-ttu-id="e391b-131">Il processo è in attesa che diventino disponibili risorse in un computer di lavoro di Automazione per poter essere avviato.</span><span class="sxs-lookup"><span data-stu-id="e391b-131">The job is waiting for resources on an Automation worker to come available so that it can be started.</span></span> |
| <span data-ttu-id="e391b-132">Starting</span><span class="sxs-lookup"><span data-stu-id="e391b-132">Starting</span></span> |<span data-ttu-id="e391b-133">Il processo è stato assegnato a un computer di lavoro e il sistema lo sta avviando.</span><span class="sxs-lookup"><span data-stu-id="e391b-133">The job has been assigned to a worker, and the system is in the process of starting it.</span></span> |
| <span data-ttu-id="e391b-134">Resuming</span><span class="sxs-lookup"><span data-stu-id="e391b-134">Resuming</span></span> |<span data-ttu-id="e391b-135">Il sistema sta per riprendere il processo dopo che è stato sospeso.</span><span class="sxs-lookup"><span data-stu-id="e391b-135">The system is in the process of resuming the job after it was suspended.</span></span> |
| <span data-ttu-id="e391b-136">Running</span><span class="sxs-lookup"><span data-stu-id="e391b-136">Running</span></span> |<span data-ttu-id="e391b-137">Il processo è in esecuzione.</span><span class="sxs-lookup"><span data-stu-id="e391b-137">The job is running.</span></span> |
| <span data-ttu-id="e391b-138">Running, waiting for resources</span><span class="sxs-lookup"><span data-stu-id="e391b-138">Running, waiting for resources</span></span> |<span data-ttu-id="e391b-139">Il processo è stato scaricato perché ha raggiunto il limite di [condivisione equa](#fairshare) .</span><span class="sxs-lookup"><span data-stu-id="e391b-139">The job has been unloaded because it reached the [fair share](#fairshare) limit.</span></span> <span data-ttu-id="e391b-140">Riprende a breve dall'ultimo checkpoint.</span><span class="sxs-lookup"><span data-stu-id="e391b-140">It resumes shortly from its last checkpoint.</span></span> |
| <span data-ttu-id="e391b-141">Arrestato</span><span class="sxs-lookup"><span data-stu-id="e391b-141">Stopped</span></span> |<span data-ttu-id="e391b-142">Il processo è stato arrestato dall'utente prima del completamento.</span><span class="sxs-lookup"><span data-stu-id="e391b-142">The job was stopped by the user before it was completed.</span></span> |
| <span data-ttu-id="e391b-143">Stopping</span><span class="sxs-lookup"><span data-stu-id="e391b-143">Stopping</span></span> |<span data-ttu-id="e391b-144">Il sistema sta arrestando il processo.</span><span class="sxs-lookup"><span data-stu-id="e391b-144">The system is in the process of stopping the job.</span></span> |
| <span data-ttu-id="e391b-145">Suspended</span><span class="sxs-lookup"><span data-stu-id="e391b-145">Suspended</span></span> |<span data-ttu-id="e391b-146">Il processo è stato sospeso dall'utente, dal sistema o da un comando del runbook.</span><span class="sxs-lookup"><span data-stu-id="e391b-146">The job was suspended by the user, by the system, or by a command in the runbook.</span></span> <span data-ttu-id="e391b-147">Un processo sospeso può essere riavviato e viene ripreso dall'ultimo checkpoint o dall'inizio del runbook se non è in possesso di checkpoint.</span><span class="sxs-lookup"><span data-stu-id="e391b-147">A job that is suspended can be started again and resume from its last checkpoint or from the beginning of the runbook if it doesn't have checkpoints.</span></span> <span data-ttu-id="e391b-148">Il runbook verrà sospeso dal sistema quando ha luogo un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="e391b-148">The runbook will only be suspended by the system when an exception occurs.</span></span> <span data-ttu-id="e391b-149">Per impostazione predefinita, il valore di ErrorActionPreference è impostato su **Continua**, a indicare che il processo continua a essere eseguito in caso di errore.</span><span class="sxs-lookup"><span data-stu-id="e391b-149">By default, ErrorActionPreference is set to **Continue**, meaning that the job keeps running on an error.</span></span> <span data-ttu-id="e391b-150">Se questa variabile di preferenza è impostata su **Stop**, il processo viene sospeso in caso di errore.</span><span class="sxs-lookup"><span data-stu-id="e391b-150">If this preference variable is set to **Stop**, then the job suspends on an error.</span></span>  <span data-ttu-id="e391b-151">Si applica solo a [Runbook grafico e al flusso di lavoro PowerShell](automation-runbook-types.md) .</span><span class="sxs-lookup"><span data-stu-id="e391b-151">Applies to [Graphical and PowerShell Workflow runbooks](automation-runbook-types.md) only.</span></span> |
| <span data-ttu-id="e391b-152">Suspending</span><span class="sxs-lookup"><span data-stu-id="e391b-152">Suspending</span></span> |<span data-ttu-id="e391b-153">Il sistema sta tentando di sospendere il processo su richiesta dell'utente.</span><span class="sxs-lookup"><span data-stu-id="e391b-153">The system is attempting to suspend the job at the request of the user.</span></span> <span data-ttu-id="e391b-154">Il runbook deve raggiungere il checkpoint successivo prima di poter essere sospeso.</span><span class="sxs-lookup"><span data-stu-id="e391b-154">The runbook must reach its next checkpoint before it can be suspended.</span></span> <span data-ttu-id="e391b-155">Se ha già superato l'ultimo checkpoint, il processo viene completato prima di poter essere sospeso.</span><span class="sxs-lookup"><span data-stu-id="e391b-155">If it already passed its last checkpoint, then it completes before it can be suspended.</span></span>  <span data-ttu-id="e391b-156">Si applica solo a [Runbook grafico e al flusso di lavoro PowerShell](automation-runbook-types.md) .</span><span class="sxs-lookup"><span data-stu-id="e391b-156">Applies to [Graphical and PowerShell Workflow runbooks](automation-runbook-types.md) only.</span></span> |

## <a name="viewing-job-status-from-the-azure-portal"></a><span data-ttu-id="e391b-157">Visualizzazione dello stato del processo dal portale di Azure</span><span class="sxs-lookup"><span data-stu-id="e391b-157">Viewing job status from the Azure portal</span></span>
<span data-ttu-id="e391b-158">È possibile visualizzare lo stato riassuntivo di tutti i processi del Runbook oppure esaminare i dettagli di uno specifico processo del Runbook nel portale di Azure o configurando l'integrazione con l'area di lavoro di Log Analytics di Microsoft Operations Management Suite (OMS) per inoltrare i flussi e lo stato del processo del Runbook.</span><span class="sxs-lookup"><span data-stu-id="e391b-158">You can view a summarized status of all runbook jobs or drill into details of a specific runbook job in the Azure portal or by configuring integration with your Microsoft Operations Management Suite (OMS) Log Analytics workspace to forward runbook job status and job streams.</span></span>  <span data-ttu-id="e391b-159">Per altre informazioni sull'integrazione con Log Analytics di OMS, vedere [Inoltrare lo stato e i flussi del processo da Automazione a Log Analytics (OMS)](automation-manage-send-joblogs-log-analytics.md).</span><span class="sxs-lookup"><span data-stu-id="e391b-159">For more information about integrating with OMS Log Analytics, see [Forward job status and job streams from Automation to Log Analytics (OMS)](automation-manage-send-joblogs-log-analytics.md).</span></span>  

### <a name="automation-runbook-jobs-summary"></a><span data-ttu-id="e391b-160">Riepilogo dei processi del Runbook di Automazione</span><span class="sxs-lookup"><span data-stu-id="e391b-160">Automation runbook jobs summary</span></span>
<span data-ttu-id="e391b-161">A destra dell'account di Automazione selezionato, è possibile visualizzare tutti i processi del Runbook relativi a un account di Automazione selezionato sotto al riquadro **Statistiche processi**.</span><span class="sxs-lookup"><span data-stu-id="e391b-161">On the right of your selected Automation account, you can see a summary of all of the runbook jobs for a selected Automation account under **Job Statistics** tile.</span></span><br><br> <span data-ttu-id="e391b-162">![Riquadro Statistiche processi](./media/automation-runbook-execution/automation-account-job-status-summary.png).</span><span class="sxs-lookup"><span data-stu-id="e391b-162">![Job Statistics tile](./media/automation-runbook-execution/automation-account-job-status-summary.png).</span></span><br> <span data-ttu-id="e391b-163">Questo riquadro visualizza un conteggio e una rappresentazione grafica dello stato dei processi per tutti i processi eseguiti.</span><span class="sxs-lookup"><span data-stu-id="e391b-163">This tile displays a count and graphical representation of the job status for all jobs executed.</span></span>  

<span data-ttu-id="e391b-164">Facendo clic sul riquadro appare il pannello **Processi**, che include un elenco riepilogativo di tutti i processi eseguiti, indicando lo stato e l'ora di avvio e di completamento del processo.</span><span class="sxs-lookup"><span data-stu-id="e391b-164">Clicking on the tile presents the **Jobs** blade, which includes a summarized list of all jobs executed, with status, job execution, and start and completion times.</span></span><br><br> <span data-ttu-id="e391b-165">![Pannello dei processi di account di Automazione](./media/automation-runbook-execution/automation-account-jobs-status-blade.png)</span><span class="sxs-lookup"><span data-stu-id="e391b-165">![Automation account Jobs blade](./media/automation-runbook-execution/automation-account-jobs-status-blade.png)</span></span><br><br>  <span data-ttu-id="e391b-166">È possibile filtrare l'elenco dei processi selezionando **Filtra processi** e filtrare in uno specifico runbook, lo stato del processo, o dall'elenco a discesa, l'intervallo di data/ora entro cui eseguire la ricerca.</span><span class="sxs-lookup"><span data-stu-id="e391b-166">You can filter the list of jobs by selecting **Filter jobs**  and filter on a specific runbook, job status, or from the drop-down list, the date/time range to search within.</span></span><br><br> <span data-ttu-id="e391b-167">![Filtrare lo stato dei processi](./media/automation-runbook-execution/automation-account-jobs-filter.png)</span><span class="sxs-lookup"><span data-stu-id="e391b-167">![Filter Job status](./media/automation-runbook-execution/automation-account-jobs-filter.png)</span></span>

<span data-ttu-id="e391b-168">In alternativa, è possibile visualizzare i dettagli di riepilogo dei processi per un runbook specifico selezionando tale runbook dal pannello **Runbook** nel proprio account di Automazione e, successivamente, selezionare il riquadro **Processi**.</span><span class="sxs-lookup"><span data-stu-id="e391b-168">Alternatively, you can view job summary details for a specific runbook by selecting that runbook from the **Runbooks** blade in your Automation account, and then select the **Jobs** tile.</span></span>  <span data-ttu-id="e391b-169">A questo punto viene visualizzato il pannello **Processi**, dove è possibile fare clic sul record del processo per visualizzarne i dettagli e l'output.</span><span class="sxs-lookup"><span data-stu-id="e391b-169">This presents the **Jobs** blade, and from there you can click on the job record to view its detail and output.</span></span><br><br> <span data-ttu-id="e391b-170">![Pannello dei processi di account di Automazione](./media/automation-runbook-execution/automation-runbook-job-summary-blade.png)</span><span class="sxs-lookup"><span data-stu-id="e391b-170">![Automation account Jobs blade](./media/automation-runbook-execution/automation-runbook-job-summary-blade.png)</span></span><br> 

### <a name="job-summary"></a><span data-ttu-id="e391b-171">Riepilogo dei processi</span><span class="sxs-lookup"><span data-stu-id="e391b-171">Job Summary</span></span>
<span data-ttu-id="e391b-172">È possibile visualizzare un elenco di tutti i processi creati per un determinato runbook e il relativo stato più recente.</span><span class="sxs-lookup"><span data-stu-id="e391b-172">You can view a list of all of the jobs that have been created for a particular runbook and their most recent status.</span></span> <span data-ttu-id="e391b-173">È possibile filtrare l'elenco in base allo stato del processo e all'intervallo di date dell'ultima modifica del processo.</span><span class="sxs-lookup"><span data-stu-id="e391b-173">You can filter this list by job status and the range of dates for the last change to the job.</span></span> <span data-ttu-id="e391b-174">Fare clic sul nome di un processo per visualizzarne le informazioni dettagliate e l'output.</span><span class="sxs-lookup"><span data-stu-id="e391b-174">To view its detailed information and output, click on the name of a job.</span></span> <span data-ttu-id="e391b-175">La visualizzazione dettagliata del processo include i valori per i parametri del runbook che sono stati forniti al processo.</span><span class="sxs-lookup"><span data-stu-id="e391b-175">The detailed view of the job includes the values for the runbook parameters that were provided to that job.</span></span>

<span data-ttu-id="e391b-176">Per visualizzare i processi per un runbook, seguire questa procedura.</span><span class="sxs-lookup"><span data-stu-id="e391b-176">You can use the following steps to view the jobs for a runbook.</span></span>

1. <span data-ttu-id="e391b-177">Nel portale di Azure, selezionare **Automazione** e selezionare il nome di un account di automazione.</span><span class="sxs-lookup"><span data-stu-id="e391b-177">In the Azure portal, select **Automation** and then select the name of an Automation account.</span></span>
2. <span data-ttu-id="e391b-178">Dall'hub, selezionare **Runbook** e quindi sul pannello **Runbook** selezionare un runbook dall'elenco.</span><span class="sxs-lookup"><span data-stu-id="e391b-178">From the hub, select **Runbooks** and then on the **Runbooks** blade select a runbook from the list.</span></span>
3. <span data-ttu-id="e391b-179">Nel pannello per il runbook selezionato, fare clic sul riquadro **Processi**.</span><span class="sxs-lookup"><span data-stu-id="e391b-179">On the blade for the selected runbook, click the **Jobs** tile.</span></span>
4. <span data-ttu-id="e391b-180">Fare clic su uno dei processi nell'elenco e nel pannello dei dettagli del processo di runbook è possibile visualizzarne i dettagli e l'output.</span><span class="sxs-lookup"><span data-stu-id="e391b-180">Click on one of the jobs in the list and on the runbook job details blade you can view its detail and output.</span></span>

## <a name="retrieving-job-status-using-windows-powershell"></a><span data-ttu-id="e391b-181">Recupero dello stato di un processo tramite Windows PowerShell</span><span class="sxs-lookup"><span data-stu-id="e391b-181">Retrieving job status using Windows PowerShell</span></span>
<span data-ttu-id="e391b-182">È possibile usare [Get-AzureRmAutomationJob](https://msdn.microsoft.com/library/mt619440.aspx) per recuperare i processi creati per un runbook e i dettagli di un processo specifico.</span><span class="sxs-lookup"><span data-stu-id="e391b-182">You can use the [Get-AzureRmAutomationJob](https://msdn.microsoft.com/library/mt619440.aspx) to retrieve the jobs created for a runbook and the details of a particular job.</span></span> <span data-ttu-id="e391b-183">Se si avvia un runbook con Windows PowerShell tramite [Start-AzureRmAutomationRunbook](https://msdn.microsoft.com/library/mt603661.aspx), viene restituito il processo risultante.</span><span class="sxs-lookup"><span data-stu-id="e391b-183">If you start a runbook with Windows PowerShell using [Start-AzureRmAutomationRunbook](https://msdn.microsoft.com/library/mt603661.aspx), then it returns the resulting job.</span></span> <span data-ttu-id="e391b-184">Usare [Get-AzureRmAutomationJob](https://msdn.microsoft.com/library/mt619440.aspx)per ottenere l'output di un processo.</span><span class="sxs-lookup"><span data-stu-id="e391b-184">Use [Get-AzureRmAutomationJob](https://msdn.microsoft.com/library/mt619440.aspx)Output to get a job’s output.</span></span>

<span data-ttu-id="e391b-185">I comandi di esempio seguenti recuperano l'ultimo processo per un runbook di esempio e ne visualizzano lo stato, i valori specificati per i parametri del runbook e l'output del processo.</span><span class="sxs-lookup"><span data-stu-id="e391b-185">The following sample commands retrieve the last job for a sample runbook and displays its status, the values provided for the runbook parameters, and the output from the job.</span></span>

    $job = (Get-AzureRmAutomationJob –AutomationAccountName "MyAutomationAccount" `
    –RunbookName "Test-Runbook" -ResourceGroupName "ResourceGroup01" | sort LastModifiedDate –desc)[0]
    $job.Status
    $job.JobParameters
    Get-AzureRmAutomationJobOutput -ResourceGroupName "ResourceGroup01" `
    –AutomationAccountName "MyAutomationAcct" -Id $job.JobId –Stream Output

## <a name="fair-share"></a><span data-ttu-id="e391b-186">condivisione equa</span><span class="sxs-lookup"><span data-stu-id="e391b-186">Fair share</span></span>
<span data-ttu-id="e391b-187">Per condividere le risorse tra tutti i runbook nel cloud, Automazione di Azure scaricherà temporaneamente qualsiasi processo in esecuzione da tre ore.</span><span class="sxs-lookup"><span data-stu-id="e391b-187">In order to share resources among all runbooks in the cloud, Azure Automation will temporarily unload any job after it has been running for three hours.</span></span>  <span data-ttu-id="e391b-188">Durante questo periodo, i processi per [runbook basati su PowerShell](automation-runbook-types.md#powershell-runbooks) vengono arrestati e non verranno riavviati.</span><span class="sxs-lookup"><span data-stu-id="e391b-188">During this time, jobs for [PowerShell-based runbooks](automation-runbook-types.md#powershell-runbooks) are stopped and will not be restarted.</span></span>  <span data-ttu-id="e391b-189">Lo stato processo visualizza **Arrestato**.</span><span class="sxs-lookup"><span data-stu-id="e391b-189">The job status shows **Stopped**.</span></span>  <span data-ttu-id="e391b-190">Questo tipo di runbook viene sempre riavviato dall'inizio perché non supporta i checkpoint.</span><span class="sxs-lookup"><span data-stu-id="e391b-190">This type of runbook is always restarted from the beginning since they don't support checkpoints.</span></span>  

<span data-ttu-id="e391b-191">[I runbook basati su Workflow-PowerShell](automation-runbook-types.md#powershell-workflow-runbooks) verranno ripresi dall'ultimo [checkpoint](https://docs.microsoft.com/system-center/sma/overview-powershell-workflows#bk_Checkpoints).</span><span class="sxs-lookup"><span data-stu-id="e391b-191">[PowerShell-Workflow-based runbooks](automation-runbook-types.md#powershell-workflow-runbooks) will be resumed from their last [checkpoint](https://docs.microsoft.com/system-center/sma/overview-powershell-workflows#bk_Checkpoints).</span></span>  <span data-ttu-id="e391b-192">Dopo essere eseguito tre ore, il processo del runbook verrà sospeso dal servizio e il relativo stato visualizza **In esecuzione, in attesa delle risorse**.</span><span class="sxs-lookup"><span data-stu-id="e391b-192">After running three hours, the runbook job will be suspended by the service and its status shows **Running, waiting for resources**.</span></span>  <span data-ttu-id="e391b-193">Quando un sandbox diventa disponibile, il runbook verrà riavviato automaticamente dal servizio di Automazione di Azure e ripreso dall'ultimo checkpoint.</span><span class="sxs-lookup"><span data-stu-id="e391b-193">When a sandbox becomes available, the runbook will be automatically restarted by the Automation service and resumes from the last checkpoint.</span></span>  <span data-ttu-id="e391b-194">Questo è il comportamento normale di Workflow-PowerShell per sospendere/riavviare.</span><span class="sxs-lookup"><span data-stu-id="e391b-194">This is normal PowerShell-Workflow behavior for suspend/restart.</span></span>  <span data-ttu-id="e391b-195">Se il runbook supera nuovamente tre ore di runtime, il processo viene ripetuto fino a tre volte.</span><span class="sxs-lookup"><span data-stu-id="e391b-195">If the runbook again exceeds three hours of runtime, the process repeats, up to three times.</span></span>  <span data-ttu-id="e391b-196">Dopo il terzo riavvio, se il runbook ancora non è stato completato in tre ore, allora il processo di runbook non ha esito positivo, e lo stato del processo visualizza **Non riuscito, in attesa di risorse**.</span><span class="sxs-lookup"><span data-stu-id="e391b-196">After the third restart, if the runbook still has not completed in three hours, then the runbook job is failed, and the job status shows **Failed, waiting for resources**.</span></span>  <span data-ttu-id="e391b-197">In tal caso, l'operazione avrà esito negativo e si riceve un'eccezione che indica quanto segue.</span><span class="sxs-lookup"><span data-stu-id="e391b-197">In this case, you receive the following exception with the failure.</span></span>

<span data-ttu-id="e391b-198">*L'esecuzione del processo non può continuare perché il processo è stato rimosso ripetutamente dallo stesso checkpoint. Verificare che il runbook non esegua operazioni di lunga durata senza rendere persistente il proprio stato.*</span><span class="sxs-lookup"><span data-stu-id="e391b-198">*The job cannot continue running because it was repeatedly evicted from the same checkpoint. Please make sure your Runbook does not perform lengthy operations without persisting its state.*</span></span>

<span data-ttu-id="e391b-199">Questo avviene per impedire che nel servizio i runbook vengano eseguiti all'infinito senza essere completati, in quanto non riusciranno a giungere al checkpoint successivo senza essere scaricati di nuovo.</span><span class="sxs-lookup"><span data-stu-id="e391b-199">This is to protect the service from runbooks running indefinitely without completing, as they are not able to make it to the next checkpoint without being unloaded again.</span></span>

<span data-ttu-id="e391b-200">Se il runbook non dispone di alcun checkpoint o non ha raggiunto il primo checkpoint prima di essere scaricato, viene riavviato dall'inizio.</span><span class="sxs-lookup"><span data-stu-id="e391b-200">If the runbook has no checkpoints or the job had not reached the first checkpoint before being unloaded, then it restarts from the beginning.</span></span>  

<span data-ttu-id="e391b-201">Quando si crea un runbook, è consigliabile assicurarsi che il tempo necessario per eseguire qualsiasi attività tra due checkpoint non superi le tre ore.</span><span class="sxs-lookup"><span data-stu-id="e391b-201">When you create a runbook, you should ensure that the time to run any activities between two checkpoints does not exceed three hours.</span></span> <span data-ttu-id="e391b-202">Può essere necessario aggiungere checkpoint al runbook per garantire che non raggiunga tale limite o suddividere le operazioni che richiedono una lunga esecuzione.</span><span class="sxs-lookup"><span data-stu-id="e391b-202">You may need to add checkpoints to your runbook to ensure that it does not reach this three hour limit or break up long running operations.</span></span> <span data-ttu-id="e391b-203">Ad esempio, il runbook potrebbe eseguire una reindicizzazione su un database SQL di grandi dimensioni.</span><span class="sxs-lookup"><span data-stu-id="e391b-203">For example, your runbook might perform a reindex on a large SQL database.</span></span> <span data-ttu-id="e391b-204">Se questa singola operazione non viene completata entro il limite di condivisione equa, il processo viene scaricato e riavviato dall'inizio.</span><span class="sxs-lookup"><span data-stu-id="e391b-204">If this single operation does not complete within the fair share limit, then the job are unloaded and restarted from the beginning.</span></span> <span data-ttu-id="e391b-205">In tal caso, è opportuno suddividere l'operazione di reindicizzazione in più passaggi, ad esempio specificando la reindicizzazione di una tabella alla volta, e quindi inserire un checkpoint dopo ogni operazione in modo che il processo possa riprendere dopo l'ultima operazione da completare.</span><span class="sxs-lookup"><span data-stu-id="e391b-205">In this case, you should break up the reindex operation into multiple steps, such as reindexing one table at a time, and then insert a checkpoint after each operation so that the job could resume after the last operation to complete.</span></span>

## <a name="next-steps"></a><span data-ttu-id="e391b-206">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="e391b-206">Next steps</span></span>
* <span data-ttu-id="e391b-207">Per altre informazioni sui diversi metodi che possono essere usati per avviare un runbook in Automazione di Azure, vedere [Avvio di un runbook in Automazione di Azure](automation-starting-a-runbook.md)</span><span class="sxs-lookup"><span data-stu-id="e391b-207">To learn more about the different methods that can be used to start a runbook in Azure Automation, see [Starting a runbook in Azure Automation](automation-starting-a-runbook.md)</span></span>

