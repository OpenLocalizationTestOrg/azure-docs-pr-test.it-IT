---
title: ripristino di emergenza di Service Fabric aaaAzure | Documenti Microsoft
description: "Azure Service Fabric offre hello toodeal necessarie di funzionalità con tutti i tipi di situazioni di emergenza. Questo articolo vengono descritti i tipi di hello di emergenze che possono verificarsi e come toodeal con essi."
services: service-fabric
documentationcenter: .net
author: masnider
manager: timlt
editor: 
ms.assetid: ab49c4b9-74a8-4907-b75b-8d2ee84c6d90
ms.service: service-fabric
ms.devlang: dotNet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 08/18/2017
ms.author: masnider
ms.openlocfilehash: 04b8348fb63e8a1c76a8f722c4c8255b339908e2
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/06/2017
---
# <a name="disaster-recovery-in-azure-service-fabric"></a><span data-ttu-id="f6762-104">Ripristino di emergenza in Azure Service Fabric</span><span class="sxs-lookup"><span data-stu-id="f6762-104">Disaster recovery in Azure Service Fabric</span></span>
<span data-ttu-id="f6762-105">Una parte fondamentale della distribuzione a disponibilità elevata consiste nel garantire la resistenza dei servizi a tutti i tipi di errori.</span><span class="sxs-lookup"><span data-stu-id="f6762-105">A critical part of delivering high-availability is ensuring that services can survive all different types of failures.</span></span> <span data-ttu-id="f6762-106">Ciò è particolarmente importante per gli errori imprevisti e incontrollabili.</span><span class="sxs-lookup"><span data-stu-id="f6762-106">This is especially important for failures that are unplanned and outside of your control.</span></span> <span data-ttu-id="f6762-107">Questo articolo descrive alcune modalità di errore comuni che possono generare situazioni di emergenza se non organizzate e gestite correttamente.</span><span class="sxs-lookup"><span data-stu-id="f6762-107">This article describes some common failure modes that could be disasters if not modeled and managed correctly.</span></span> <span data-ttu-id="f6762-108">Inoltre illustrate tootake le misure di attenuazione e le azioni se si è verificata un'emergenza comunque.</span><span class="sxs-lookup"><span data-stu-id="f6762-108">It also discuss mitigations and actions tootake if a disaster happened anyway.</span></span> <span data-ttu-id="f6762-109">obiettivo di Hello è toolimit o eliminare il rischio di hello del tempo di inattività o perdita di dati quando si verificano errori, pianificati o in caso contrario, si verificano.</span><span class="sxs-lookup"><span data-stu-id="f6762-109">hello goal is toolimit or eliminate hello risk of downtime or data loss when they occur failures, planned or otherwise, occur.</span></span>

## <a name="avoiding-disaster"></a><span data-ttu-id="f6762-110">Evitare situazioni di emergenza</span><span class="sxs-lookup"><span data-stu-id="f6762-110">Avoiding disaster</span></span>
<span data-ttu-id="f6762-111">Obiettivo principale di Service Fabric è toohelp l'ambiente sia i servizi in modo che i tipi di errore comuni non sono emergenze del modello.</span><span class="sxs-lookup"><span data-stu-id="f6762-111">Service Fabric's primary goal is toohelp you model both your environment and your services in such a way that common failure types are not disasters.</span></span> 

<span data-ttu-id="f6762-112">Esistono, in generale, due tipi di scenari di emergenza/errore:</span><span class="sxs-lookup"><span data-stu-id="f6762-112">In general there are two types of disaster/failure scenarios:</span></span>

1. <span data-ttu-id="f6762-113">Errori hardware o software</span><span class="sxs-lookup"><span data-stu-id="f6762-113">Hardware or software faults</span></span>
2. <span data-ttu-id="f6762-114">Errori operativi</span><span class="sxs-lookup"><span data-stu-id="f6762-114">Operational faults</span></span>

### <a name="hardware-and-software-faults"></a><span data-ttu-id="f6762-115">Errori hardware e software</span><span class="sxs-lookup"><span data-stu-id="f6762-115">Hardware and software faults</span></span>
<span data-ttu-id="f6762-116">Gli errori hardware e software sono imprevedibili.</span><span class="sxs-lookup"><span data-stu-id="f6762-116">Hardware and software faults are unpredictable.</span></span> <span data-ttu-id="f6762-117">gli errori toosurvive modo più semplici Hello è in esecuzione più copie del servizio hello occupate attraverso i limiti di errore hardware o software.</span><span class="sxs-lookup"><span data-stu-id="f6762-117">hello easiest way toosurvive faults is running more copies of hello service  spanned across hardware or software fault boundaries.</span></span> <span data-ttu-id="f6762-118">Ad esempio, se il servizio viene eseguito solo su un determinato computer, quindi hello errore di un computer è una situazione di emergenza per il servizio.</span><span class="sxs-lookup"><span data-stu-id="f6762-118">For example, if your service is running only on one particular machine, then hello failure of that one machine is a disaster for that service.</span></span> <span data-ttu-id="f6762-119">Hello semplice tooavoid questo tipo di emergenza è tooensure che hello sia effettivamente in esecuzione su più computer.</span><span class="sxs-lookup"><span data-stu-id="f6762-119">hello simple way tooavoid this disaster is tooensure that hello service is actually running on multiple machines.</span></span> <span data-ttu-id="f6762-120">Test è errore hello tooensure necessarie di una macchina non interrotta hello in esecuzione del servizio.</span><span class="sxs-lookup"><span data-stu-id="f6762-120">Testing is also necessary tooensure hello failure of one machine doesn't disrupt hello running service.</span></span> <span data-ttu-id="f6762-121">Pianificazione della capacità garantisce un'istanza di sostituzione possono essere creata in un' posizione e che la riduzione della capacità non eseguire l'overload hello rimanenti servizi.</span><span class="sxs-lookup"><span data-stu-id="f6762-121">Capacity planning ensures a replacement instance can be created elsewhere and that reduction in capacity doesn't overload hello remaining services.</span></span> <span data-ttu-id="f6762-122">Hello stesso modello funziona indipendentemente dal fatto che si sta tentando errore hello tooavoid di.</span><span class="sxs-lookup"><span data-stu-id="f6762-122">hello same pattern works regardless of what you're trying tooavoid hello failure of.</span></span> <span data-ttu-id="f6762-123">Ad esempio,</span><span class="sxs-lookup"><span data-stu-id="f6762-123">For example.</span></span> <span data-ttu-id="f6762-124">Se si teme errore hello di una rete SAN, si esegue tra più nomi alternativi del soggetto.</span><span class="sxs-lookup"><span data-stu-id="f6762-124">if you're concerned about hello failure of a SAN, you run across multiple SANs.</span></span> <span data-ttu-id="f6762-125">Se si teme la perdita di hello di un rack di server, di eseguire in più rack.</span><span class="sxs-lookup"><span data-stu-id="f6762-125">If you're concerned about hello loss of a rack of servers, you run across multiple racks.</span></span> <span data-ttu-id="f6762-126">Se si ritiene che la perdita di hello dei centri dati, il servizio deve essere eseguito in più aree di Azure o Data Center.</span><span class="sxs-lookup"><span data-stu-id="f6762-126">If you're worried about hello loss of datacenters, your service should run across multiple Azure regions or datacenters.</span></span> 

<span data-ttu-id="f6762-127">Quando si esegue questo tipo di modalità estesi, si è ancora soggetto toosome tipi di errori simultanei, ma solo errori anche più di un determinato tipo (ad esempio: un singolo errore collegamento di una macchina virtuale o di rete) vengono gestiti automaticamente (e pertanto non è più di "emergenza").</span><span class="sxs-lookup"><span data-stu-id="f6762-127">When running in this type of spanned mode, you're still subject toosome types of simultaneous failures, but single and even multiple failures of a particular type (ex: a single VM or network link failing) are automatically handled (and so no longer a "disaster").</span></span> <span data-ttu-id="f6762-128">Service Fabric fornisce molti meccanismi per l'espansione di cluster hello e gli handle di restituzione di nodi con errori e i servizi.</span><span class="sxs-lookup"><span data-stu-id="f6762-128">Service Fabric provides many mechanisms for expanding hello cluster and handles bringing failed nodes and services back.</span></span> <span data-ttu-id="f6762-129">Service Fabric inoltre consente di eseguire molte istanze dei servizi in ordine tooavoid questi tipi di errori non pianificati da attivare in emergenze reale.</span><span class="sxs-lookup"><span data-stu-id="f6762-129">Service Fabric also allows running many instances of your services in order tooavoid these types of unplanned failures from turning into real disasters.</span></span>

<span data-ttu-id="f6762-130">È possibile motivi per cui eseguire una toospan sufficientemente grande distribuzione negli errori non praticabile.</span><span class="sxs-lookup"><span data-stu-id="f6762-130">There may be reasons why running a deployment large enough toospan over failures is not feasible.</span></span> <span data-ttu-id="f6762-131">Ad esempio, potrebbe richiedere altre risorse hardware che non si è disposti toopay per toohello relativa probabilità di errore.</span><span class="sxs-lookup"><span data-stu-id="f6762-131">For example, it may take more hardware resources than you're not willing toopay for relative toohello chance of failure.</span></span> <span data-ttu-id="f6762-132">Quando si lavora con le applicazioni distribuite, è possibile che gli hop di comunicazione o i costi di replica di stato aggiuntivi su distanze geografiche causino una latenza inaccettabile.</span><span class="sxs-lookup"><span data-stu-id="f6762-132">When dealing with distributed applications, it could be that additional communication hops or state replication costs across geographic distances causes unacceptable latency.</span></span> <span data-ttu-id="f6762-133">La posizione di questa linea di confine varia per ogni applicazione.</span><span class="sxs-lookup"><span data-stu-id="f6762-133">Where this line is drawn differs for each application.</span></span> <span data-ttu-id="f6762-134">Per gli errori software, in particolare, errore hello potrebbe essere in servizio hello che si sta tentando di tooscale.</span><span class="sxs-lookup"><span data-stu-id="f6762-134">For software faults specifically, hello fault could be in hello service that you are trying tooscale.</span></span> <span data-ttu-id="f6762-135">In questo caso più copie non impediscano emergenza hello, poiché la condizione di errore hello è correlata a tutte le istanze di hello.</span><span class="sxs-lookup"><span data-stu-id="f6762-135">In this case more copies don't prevent hello disaster, since hello failure condition is correlated across all hello instances.</span></span>

### <a name="operational-faults"></a><span data-ttu-id="f6762-136">Errori operativi</span><span class="sxs-lookup"><span data-stu-id="f6762-136">Operational faults</span></span>
<span data-ttu-id="f6762-137">Anche se il servizio viene eseguito lo spanning tutto il mondo hello con molti ridondanze, è comunque possibile sperimentare disastrosi eventi.</span><span class="sxs-lookup"><span data-stu-id="f6762-137">Even if your service is spanned across hello globe with many redundancies, it can still experience disastrous events.</span></span> <span data-ttu-id="f6762-138">Ad esempio, se un utente riconfigura nome dns hello servizio hello, accidentalmente o eliminarlo definitive.</span><span class="sxs-lookup"><span data-stu-id="f6762-138">For example, if someone accidentally reconfigures hello dns name for hello service, or deletes it outright.</span></span> <span data-ttu-id="f6762-139">Si supponga, ad esempio, di disporre di un servizio di Service Fabric con stato e che un utente lo abbia eliminato inavvertitamente.</span><span class="sxs-lookup"><span data-stu-id="f6762-139">As an example, let's say you had a stateful Service Fabric service, and someone deleted that service accidentally.</span></span> <span data-ttu-id="f6762-140">A meno che non esistano alcune riduzione dei rischi, che il servizio e tutte le hello stato è finalmente disponibile.</span><span class="sxs-lookup"><span data-stu-id="f6762-140">Unless there's some other mitigation, that service and all of hello state it had is now gone.</span></span> <span data-ttu-id="f6762-141">Questi tipi di emergenze operative ("errori") richiedono mitigazioni e procedure per il ripristino diverse rispetto ai normali errori imprevisti.</span><span class="sxs-lookup"><span data-stu-id="f6762-141">These types of operational disasters ("oops") require different mitigations and steps for recovery than regular unplanned failures.</span></span> 

<span data-ttu-id="f6762-142">questi tipi di errori operational tooavoid modi migliori Hello devono</span><span class="sxs-lookup"><span data-stu-id="f6762-142">hello best ways tooavoid these types of operational faults are to</span></span>
1. <span data-ttu-id="f6762-143">limitare l'ambiente di accesso operativi toohello</span><span class="sxs-lookup"><span data-stu-id="f6762-143">restrict operational access toohello environment</span></span>
2. <span data-ttu-id="f6762-144">controllare rigorosamente le operazioni pericolose</span><span class="sxs-lookup"><span data-stu-id="f6762-144">strictly audit dangerous operations</span></span>
3. <span data-ttu-id="f6762-145">imporre l'automazione, impedire manuale o modifiche fuori banda e convalidare le modifiche specifiche su ambiente effettivo hello prima dell'applicazione delle loro</span><span class="sxs-lookup"><span data-stu-id="f6762-145">impose automation, prevent manual or out of band changes, and validate specific changes against hello actual environment before enacting them</span></span>
4. <span data-ttu-id="f6762-146">assicurarsi che le operazioni distruttive siano "soft".</span><span class="sxs-lookup"><span data-stu-id="f6762-146">ensure that destructive operations are "soft".</span></span> <span data-ttu-id="f6762-147">Le operazioni soft non hanno effetto immediato o possono essere annullate entro un intervallo di tempo.</span><span class="sxs-lookup"><span data-stu-id="f6762-147">Soft operations don't take effect immediately or can be undone within some time window</span></span>

<span data-ttu-id="f6762-148">Service Fabric fornisce alcuni meccanismi errori operational tooprevent, ad esempio fornire [basata sui ruoli](service-fabric-cluster-security-roles.md) controllo dell'accesso per le operazioni del cluster.</span><span class="sxs-lookup"><span data-stu-id="f6762-148">Service Fabric provides some mechanisms tooprevent operational faults, such as providing [role-based](service-fabric-cluster-security-roles.md) access control for cluster operations.</span></span> <span data-ttu-id="f6762-149">La maggior parte di questi errori operativi richiede tuttavia attività organizzative e altri sistemi.</span><span class="sxs-lookup"><span data-stu-id="f6762-149">However, most of these operational faults require organizational efforts and other systems.</span></span> <span data-ttu-id="f6762-150">Service Fabric offre alcuni meccanismi per resistere agli errori operativi, i più noti dei quali sono il backup e il ripristino per i servizi con stato.</span><span class="sxs-lookup"><span data-stu-id="f6762-150">Service Fabric does provide some mechanism for surviving operational faults, most notably backup and restore for stateful services.</span></span>

## <a name="managing-failures"></a><span data-ttu-id="f6762-151">Gestione degli errori</span><span class="sxs-lookup"><span data-stu-id="f6762-151">Managing failures</span></span>
<span data-ttu-id="f6762-152">obiettivo di Hello di Service Fabric è quasi sempre la gestione automatica degli errori.</span><span class="sxs-lookup"><span data-stu-id="f6762-152">hello goal of Service Fabric is almost always automatic management of failures.</span></span> <span data-ttu-id="f6762-153">Tuttavia, in ordine toohandle alcuni tipi di errori, è necessario utilizzare codice aggiuntivo.</span><span class="sxs-lookup"><span data-stu-id="f6762-153">However, in order toohandle some types of failures, services must have additional code.</span></span> <span data-ttu-id="f6762-154">Altri tipi di errori _non_ devono essere risolti automaticamente per motivi di continuità e sicurezza aziendali.</span><span class="sxs-lookup"><span data-stu-id="f6762-154">Other types of failures should _not_ be automatically addressed because of safety and business continuity reasons.</span></span> 

### <a name="handling-single-failures"></a><span data-ttu-id="f6762-155">Gestione di errori singoli</span><span class="sxs-lookup"><span data-stu-id="f6762-155">Handling single failures</span></span>
<span data-ttu-id="f6762-156">I computer singoli possono essere soggetti a errori per ogni genere di motivo.</span><span class="sxs-lookup"><span data-stu-id="f6762-156">Single machines can fail for all sorts of reasons.</span></span> <span data-ttu-id="f6762-157">Alcuni di questi sono causati dall'hardware, ad esempio i guasti agli alimentatori e all'hardware di rete.</span><span class="sxs-lookup"><span data-stu-id="f6762-157">Some of these are hardware causes, like power supplies and networking hardware failures.</span></span> <span data-ttu-id="f6762-158">Altri errori sono nel software.</span><span class="sxs-lookup"><span data-stu-id="f6762-158">Other failures are in software.</span></span> <span data-ttu-id="f6762-159">Sono inclusi errori di sistema operativo effettiva hello e servizio hello stesso.</span><span class="sxs-lookup"><span data-stu-id="f6762-159">These include failures of hello actual operating system and hello service itself.</span></span> <span data-ttu-id="f6762-160">Service Fabric rileva automaticamente questi tipi di errori, inclusi i casi in cui la macchina hello diventa isolata dagli altri computer a causa di problemi di toonetwork.</span><span class="sxs-lookup"><span data-stu-id="f6762-160">Service Fabric automatically detects these types of failures, including cases where hello machine becomes isolated from other machines due toonetwork issues.</span></span>

<span data-ttu-id="f6762-161">Indipendentemente dal tipo di hello del servizio, in esecuzione una sola istanza risultati tempi di inattività per il servizio se tale singola copia di codice hello non riesce per qualsiasi motivo.</span><span class="sxs-lookup"><span data-stu-id="f6762-161">Regardless of hello type of service, running a single instance results in downtime for that service if that single copy of hello code fails for any reason.</span></span> 

<span data-ttu-id="f6762-162">In ordine toohandle qualsiasi errore, hello più semplice possibile è tooensure che i servizi eseguiti in più di un nodo per impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="f6762-162">In order toohandle any single failure, hello simplest thing you can do is tooensure that your services run on more than one node by default.</span></span> <span data-ttu-id="f6762-163">Per i servizi senza stato questo risultato si ottiene con un `InstanceCount` maggiore di 1.</span><span class="sxs-lookup"><span data-stu-id="f6762-163">For stateless services, this can be accomplished by having an `InstanceCount` greater than 1.</span></span> <span data-ttu-id="f6762-164">Per i servizi con stati, indicazione minimo hello è sempre un `TargetReplicaSetSize` e `MinReplicaSetSize` almeno 3.</span><span class="sxs-lookup"><span data-stu-id="f6762-164">For stateful services, hello minimum recommendation is always a `TargetReplicaSetSize` and `MinReplicaSetSize` of at least 3.</span></span> <span data-ttu-id="f6762-165">L'esecuzione di più copie del codice del servizio assicura al servizio la capacità di gestire qualsiasi errore automaticamente.</span><span class="sxs-lookup"><span data-stu-id="f6762-165">Running more copies of your service code ensures that your service can handle any single failure automatically.</span></span> 

### <a name="handling-coordinated-failures"></a><span data-ttu-id="f6762-166">Gestione di errori coordinati</span><span class="sxs-lookup"><span data-stu-id="f6762-166">Handling coordinated failures</span></span>
<span data-ttu-id="f6762-167">Coordinati gli errori possono verificarsi in un cluster a causa di tooeither pianificata o errori dell'infrastruttura non pianificato e le modifiche o modifiche software pianificato.</span><span class="sxs-lookup"><span data-stu-id="f6762-167">Coordinated failures can happen in a cluster due tooeither planned or unplanned infrastructure failures and changes, or planned software changes.</span></span> <span data-ttu-id="f6762-168">Service Fabric crea le zone di infrastruttura che sperimentano errori coordinati come domini di errore.</span><span class="sxs-lookup"><span data-stu-id="f6762-168">Service Fabric models infrastructure zones that experience coordinated failures as Fault Domains.</span></span> <span data-ttu-id="f6762-169">Le aree che sperimentano le modifiche software coordinate vengono modellate come domini di aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="f6762-169">Areas that will experience coordinated software changes are modeled as Upgrade Domains.</span></span> <span data-ttu-id="f6762-170">Altre informazioni sui domini di errore e di aggiornamento sono disponibili in [questo documento](service-fabric-cluster-resource-manager-cluster-description.md) che descrive la definizione e la topologia del cluster.</span><span class="sxs-lookup"><span data-stu-id="f6762-170">More information about fault and upgrade domains is in [this document](service-fabric-cluster-resource-manager-cluster-description.md) that describes cluster topology and definition.</span></span>

<span data-ttu-id="f6762-171">Per impostazione predefinita, Service Fabric considera i domini di errore e di aggiornamento quando si pianificano le posizioni di esecuzione dei servizi.</span><span class="sxs-lookup"><span data-stu-id="f6762-171">By default Service Fabric considers fault and upgrade domains when planning where your services should run.</span></span> <span data-ttu-id="f6762-172">Per impostazione predefinita, Service Fabric prova tooensure i servizi eseguiti in diversi domini di errore e di aggiornamento in modo se le modifiche pianificate o i servizi rimangono disponibili.</span><span class="sxs-lookup"><span data-stu-id="f6762-172">By default, Service Fabric tries tooensure that your services run across several fault and upgrade domains so if planned or unplanned changes happen your services remain available.</span></span> 

<span data-ttu-id="f6762-173">Ad esempio, si supponga che una fonte di alimentazione in errore determina un rack di toofail macchine contemporaneamente.</span><span class="sxs-lookup"><span data-stu-id="f6762-173">For example, let's say that failure of a power source causes a rack of machines toofail simultaneously.</span></span> <span data-ttu-id="f6762-174">Con più copie del servizio hello perdita hello di molti computer è in esecuzione nel dominio di errore diventa infatti un altro esempio di errore solo per un determinato servizio.</span><span class="sxs-lookup"><span data-stu-id="f6762-174">With multiple copies of hello service running hello loss of many machines in fault domain failure turns into just another example of single failure for a given service.</span></span> <span data-ttu-id="f6762-175">Ecco perché la gestione di domini di errore è critico tooensuring elevata disponibilità dei servizi.</span><span class="sxs-lookup"><span data-stu-id="f6762-175">This is why managing fault domains is critical tooensuring high availability of your services.</span></span> <span data-ttu-id="f6762-176">Quando si esegue Azure Service Fabric, i domini di errore vengono gestiti automaticamente.</span><span class="sxs-lookup"><span data-stu-id="f6762-176">When running Service Fabric in Azure, fault domains are managed automatically.</span></span> <span data-ttu-id="f6762-177">In altri ambienti potrebbero non esserlo.</span><span class="sxs-lookup"><span data-stu-id="f6762-177">In other environments they may not be.</span></span> <span data-ttu-id="f6762-178">Se si sta creando cluster in locale, toomap verificare e pianificare correttamente il layout di dominio di errore.</span><span class="sxs-lookup"><span data-stu-id="f6762-178">If you're building your own clusters on premises, be sure toomap and plan your fault domain layout correctly.</span></span>

<span data-ttu-id="f6762-179">Domini di aggiornamento sono utili per la modellazione delle aree in cui software verrà aggiornato toobe in hello stesso tempo.</span><span class="sxs-lookup"><span data-stu-id="f6762-179">Upgrade Domains are useful for modeling areas where software is going toobe upgraded at hello same time.</span></span> <span data-ttu-id="f6762-180">Per questo motivo, domini di aggiornamento anche spesso definiscono i limiti di hello in software è disattivato durante gli aggiornamenti pianificati.</span><span class="sxs-lookup"><span data-stu-id="f6762-180">Because of this, Upgrade Domains also often define hello boundaries where software is taken down during planned upgrades.</span></span> <span data-ttu-id="f6762-181">Gli aggiornamenti di Service Fabric e i servizi seguono hello stesso modello.</span><span class="sxs-lookup"><span data-stu-id="f6762-181">Upgrades of both Service Fabric and your services follow hello same model.</span></span> <span data-ttu-id="f6762-182">Per ulteriori informazioni sul modello di integrità di Service Fabric hello che consente di evitare modifiche accidentali conseguenze cluster hello e il servizio, i domini di aggiornamento gli aggiornamenti in sequenza, vedere questi documenti:</span><span class="sxs-lookup"><span data-stu-id="f6762-182">For more on rolling upgrades, upgrade domains, and hello Service Fabric health model that helps prevent unintended changes from impacting hello cluster and your service, see these documents:</span></span>

 - [<span data-ttu-id="f6762-183">Aggiornamento dell'applicazione</span><span class="sxs-lookup"><span data-stu-id="f6762-183">Application Upgrade</span></span>](service-fabric-application-upgrade.md)
 - [<span data-ttu-id="f6762-184">Esercitazione sull'aggiornamento di un'applicazione </span><span class="sxs-lookup"><span data-stu-id="f6762-184">Application Upgrade Tutorial</span></span>](service-fabric-application-upgrade-tutorial.md)
 - <span data-ttu-id="f6762-185">[Service Fabric Health Model](service-fabric-health-introduction.md) (Modello di integrità di Service Fabric)</span><span class="sxs-lookup"><span data-stu-id="f6762-185">[Service Fabric Health Model](service-fabric-health-introduction.md)</span></span>

<span data-ttu-id="f6762-186">È possibile visualizzare il layout di hello del cluster tramite fornita nella mappa del cluster hello [Service Fabric Explorer](service-fabric-visualizing-your-cluster.md):</span><span class="sxs-lookup"><span data-stu-id="f6762-186">You can visualize hello layout of your cluster using hello cluster map provided in [Service Fabric Explorer](service-fabric-visualizing-your-cluster.md):</span></span>

<span data-ttu-id="f6762-187"><center>
![Nodi distribuiti nei domini di errore in Service Fabric Explorer][sfx-cluster-map]
</center></span><span class="sxs-lookup"><span data-stu-id="f6762-187"><center>
![Nodes spread across fault domains in Service Fabric Explorer][sfx-cluster-map]
</center></span></span>

> [!NOTE]
> <span data-ttu-id="f6762-188">Modellazione di aree di errore, aggiornamenti in sequenza, l'esecuzione di molte istanze di servizio codice e stato, posizionamento regole tooensure i servizi eseguito tra domini di errore e di aggiornamento e il monitoraggio dello stato predefinito sono solo **alcuni** di hello funzionalità che fornisce Service Fabric in problemi operativi di ordine tookeep normale e gli errori di attivazione in situazioni di emergenza.</span><span class="sxs-lookup"><span data-stu-id="f6762-188">Modeling areas of failure, rolling upgrades, running many instances of your service code and state, placement rules tooensure your services run across fault and upgrade domains, and built-in health monitoring are just **some** of hello features that Service Fabric provides in order tookeep normal operational issues and failures from turning into disasters.</span></span> 
>

### <a name="handling-simultaneous-hardware-or-software-failures"></a><span data-ttu-id="f6762-189">Gestione di errori hardware o software simultanei</span><span class="sxs-lookup"><span data-stu-id="f6762-189">Handling simultaneous hardware or software failures</span></span>
<span data-ttu-id="f6762-190">Si è parlato finora degli errori singoli.</span><span class="sxs-lookup"><span data-stu-id="f6762-190">Above we talked about single failures.</span></span> <span data-ttu-id="f6762-191">Come si può notare, sono facilmente toohandle per i servizi senza stato mantenendo più copie di codice hello (e stato) in esecuzione in errore e domini di aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="f6762-191">As you can see, are easy toohandle for both stateless and stateful services just by keeping more copies of hello code (and state) running across fault and upgrade domains.</span></span> <span data-ttu-id="f6762-192">I servizi possono essere interessati anche da più errori casuali simultanei.</span><span class="sxs-lookup"><span data-stu-id="f6762-192">Multiple simultaneous random failures can also happen.</span></span> <span data-ttu-id="f6762-193">Si tratta probabilmente emergenza effettivo di tooan toolead.</span><span class="sxs-lookup"><span data-stu-id="f6762-193">These are more likely toolead tooan actual disaster.</span></span>


### <a name="random-failures-leading-tooservice-failures"></a><span data-ttu-id="f6762-194">Errori casuali iniziali tooservice errori</span><span class="sxs-lookup"><span data-stu-id="f6762-194">Random failures leading tooservice failures</span></span>
<span data-ttu-id="f6762-195">Si supponga che il servizio hello aveva un `InstanceCount` di 5 e diversi nodi tali istanze in esecuzione tutti non è riuscito a hello stesso tempo.</span><span class="sxs-lookup"><span data-stu-id="f6762-195">Let's say that hello service had an `InstanceCount` of 5, and several nodes running those instances all failed at hello same time.</span></span> <span data-ttu-id="f6762-196">Service Fabric risponde creando automaticamente istanze sostitutive in altri nodi.</span><span class="sxs-lookup"><span data-stu-id="f6762-196">Service Fabric responds by automatically creating replacement instances on other nodes.</span></span> <span data-ttu-id="f6762-197">Creazione di sostituzioni fino a quando non è nuovamente disponibile il servizio hello tooits desiderato conteggio delle istanze continuerà.</span><span class="sxs-lookup"><span data-stu-id="f6762-197">It will continue creating replacements until hello service is back tooits desired instance count.</span></span> <span data-ttu-id="f6762-198">Ad esempio, si supponga che si è verificato un servizio senza stato con un `InstanceCount`-1, ovvero viene eseguito in tutti i nodi del cluster hello validi.</span><span class="sxs-lookup"><span data-stu-id="f6762-198">As another example, let's say there was a stateless service with an `InstanceCount`of -1, meaning it runs on all valid nodes in hello cluster.</span></span> <span data-ttu-id="f6762-199">Si supponga che alcuni di tali istanze sono state toofail.</span><span class="sxs-lookup"><span data-stu-id="f6762-199">Let's say that some of those instances were toofail.</span></span> <span data-ttu-id="f6762-200">In questo caso, Service Fabric nota che il servizio di hello non è nello stato desiderato e tenta di istanze di hello toocreate sui nodi di hello in cui sono disponibili.</span><span class="sxs-lookup"><span data-stu-id="f6762-200">In this case, Service Fabric notices that hello service is not in its desired state, and tries toocreate hello instances on hello nodes where they are missing.</span></span> 

<span data-ttu-id="f6762-201">Per i servizi con stati situazione hello varia a seconda se il servizio hello ha uno stato persistente o non.</span><span class="sxs-lookup"><span data-stu-id="f6762-201">For stateful services hello situation depends on whether hello service has persisted state or not.</span></span> <span data-ttu-id="f6762-202">Dipende inoltre quanti repliche hello servizio e il numero non è riuscito.</span><span class="sxs-lookup"><span data-stu-id="f6762-202">It also depends on how many replicas hello service had and how many failed.</span></span> <span data-ttu-id="f6762-203">La determinazione di una situazione di emergenza per un servizio con stato e la relativa gestione seguono tre fasi:</span><span class="sxs-lookup"><span data-stu-id="f6762-203">Determining whether a disaster occurred for a stateful service and managing it follows three stages:</span></span>

1. <span data-ttu-id="f6762-204">Determinazione di una eventuale perdita del quorum</span><span class="sxs-lookup"><span data-stu-id="f6762-204">Determining if there has been quorum loss or not</span></span>
 - <span data-ttu-id="f6762-205">Una perdita del quorum è qualsiasi momento la maggioranza delle repliche hello di un servizio con stato non sono attivi in hello stessa durata, comprendenti hello primario.</span><span class="sxs-lookup"><span data-stu-id="f6762-205">A quorum loss is any time a majority of hello replicas of a stateful service are down at hello same time, including hello Primary.</span></span>
2. <span data-ttu-id="f6762-206">Determinare se la perdita di quorum hello è permanente</span><span class="sxs-lookup"><span data-stu-id="f6762-206">Determining if hello quorum loss is permanent or not</span></span>
 - <span data-ttu-id="f6762-207">La maggior parte del tempo di hello, gli errori sono temporanei.</span><span class="sxs-lookup"><span data-stu-id="f6762-207">Most of hello time, failures are transient.</span></span> <span data-ttu-id="f6762-208">I processi, i nodi e le VM vengono riavviati e le partizioni di rete vengono corrette.</span><span class="sxs-lookup"><span data-stu-id="f6762-208">Processes are restarted, nodes are restarted, VMs are relaunched, network partitions heal.</span></span> <span data-ttu-id="f6762-209">In alcuni casi invece gli errori sono permanenti.</span><span class="sxs-lookup"><span data-stu-id="f6762-209">Sometimes though, failures are permanent.</span></span> 
    - <span data-ttu-id="f6762-210">Per i servizi senza stato persistente, un errore di uno o più quorum di repliche determina _immediatamente_ una perdita del quorum permanente.</span><span class="sxs-lookup"><span data-stu-id="f6762-210">For services without persisted state, a failure of a quorum or more of replicas results _immediately_ in permanent quorum loss.</span></span> <span data-ttu-id="f6762-211">Quando Service Fabric rileva perdita del quorum in un servizio con stato non persistente, procede immediatamente dataloss toostep 3 dichiarando (potenziali).</span><span class="sxs-lookup"><span data-stu-id="f6762-211">When Service Fabric detects quorum loss in a stateful non-persistent service, it immediately proceeds toostep 3 by declaring (potential) dataloss.</span></span> <span data-ttu-id="f6762-212">Procedere toodataloss è utile perché Service Fabric sa che è presente alcun punto in attesa per il backup di hello repliche toocome, perché anche se essi sono stati recuperati potrebbero essere vuote.</span><span class="sxs-lookup"><span data-stu-id="f6762-212">Proceeding toodataloss makes sense because Service Fabric knows that there's no point in waiting for hello replicas toocome back, because even if they were recovered they would be empty.</span></span>
    - <span data-ttu-id="f6762-213">Per i servizi permanenti con stati, un errore di più di un quorum di repliche causa toostart Service Fabric in attesa di hello nuovamente toocome di repliche e quorum di ripristino.</span><span class="sxs-lookup"><span data-stu-id="f6762-213">For stateful persistent services, a failure of a quorum or more of replicas causes Service Fabric toostart waiting for hello replicas toocome back and restore quorum.</span></span> <span data-ttu-id="f6762-214">Di conseguenza, un'interruzione del servizio per qualsiasi _scrive_ toohello interessata partizione (o "set di repliche") del servizio hello.</span><span class="sxs-lookup"><span data-stu-id="f6762-214">This results in a service outage for any _writes_ toohello affected partition (or "replica set") of hello service.</span></span> <span data-ttu-id="f6762-215">Le operazioni di lettura restano invece ancora possibili con una minore garanzia di coerenza.</span><span class="sxs-lookup"><span data-stu-id="f6762-215">However, reads may still be possible with reduced consistency guarantees.</span></span> <span data-ttu-id="f6762-216">quantità di tempo di attesa di Service Fabric per toobe quorum ripristinato predefinita Hello è infinito, poiché è un evento dataloss (potenzialmente) e comporta altri rischi di procedere.</span><span class="sxs-lookup"><span data-stu-id="f6762-216">hello default amount of time that Service Fabric waits for quorum toobe restored is infinite, since proceeding is a (potential) dataloss event and carries other risks.</span></span> <span data-ttu-id="f6762-217">Eseguire l'override hello predefinito `QuorumLossWaitDuration` valore, è possibile ma non è consigliato.</span><span class="sxs-lookup"><span data-stu-id="f6762-217">Overriding hello default `QuorumLossWaitDuration` value is possible but is not recommended.</span></span> <span data-ttu-id="f6762-218">In questo momento, invece tutte le attività devono essere apportate hello toorestore verso il basso le repliche.</span><span class="sxs-lookup"><span data-stu-id="f6762-218">Instead at this time, all efforts should be made toorestore hello down replicas.</span></span> <span data-ttu-id="f6762-219">È necessario riportare hello nodi che sono inattivi back backup e garantire che è possibile rimontare unità hello in cui sono archiviati lo stato permanente locale hello.</span><span class="sxs-lookup"><span data-stu-id="f6762-219">This requires bringing hello nodes that are down back up, and ensuring that they can remount hello drives where they stored hello local persistent state.</span></span> <span data-ttu-id="f6762-220">Se perdita del quorum hello è causata da un errore di processo, Service Fabric tenta processi hello toorecreate e riavviare automaticamente le repliche di hello in essi contenuti.</span><span class="sxs-lookup"><span data-stu-id="f6762-220">If hello quorum loss is caused by process failure, Service Fabric automatically tries toorecreate hello processes and restart hello replicas inside them.</span></span> <span data-ttu-id="f6762-221">Se l'operazione non riesce, Service Fabric segnala errori di integrità.</span><span class="sxs-lookup"><span data-stu-id="f6762-221">If this fails, Service Fabric reports health errors.</span></span> <span data-ttu-id="f6762-222">Se questi possono essere risolti repliche hello in genere tornare.</span><span class="sxs-lookup"><span data-stu-id="f6762-222">If these can be resolved then hello replicas usually come back.</span></span> <span data-ttu-id="f6762-223">In alcuni casi, tuttavia, repliche hello non possono essere riportate.</span><span class="sxs-lookup"><span data-stu-id="f6762-223">Sometimes, though, hello replicas can't be brought back.</span></span> <span data-ttu-id="f6762-224">Ad esempio, le unità hello tutti non è riuscito o macchine hello fisicamente eliminati definitivamente in qualche modo.</span><span class="sxs-lookup"><span data-stu-id="f6762-224">For example, hello drives may all have failed, or hello machines physically destroyed somehow.</span></span> <span data-ttu-id="f6762-225">In questi casi ci si trova in presenza di un evento di perdita del quorum permanente.</span><span class="sxs-lookup"><span data-stu-id="f6762-225">In these cases, we now have a permanent quorum loss event.</span></span> <span data-ttu-id="f6762-226">tootell Service Fabric toostop in attesa di hello verso il basso toocome repliche, un amministratore di cluster è necessario determinare quali partizioni dei quali servizi sono interessati e chiamare hello `Repair-ServiceFabricPartition -PartitionId` o ` System.Fabric.FabricClient.ClusterManagementClient.RecoverPartitionAsync(Guid partitionId)` API.</span><span class="sxs-lookup"><span data-stu-id="f6762-226">tootell Service Fabric toostop waiting for hello down replicas toocome back, a cluster administrator must determine which partitions of which services are affected and call hello `Repair-ServiceFabricPartition -PartitionId` or ` System.Fabric.FabricClient.ClusterManagementClient.RecoverPartitionAsync(Guid partitionId)` API.</span></span>  <span data-ttu-id="f6762-227">Questa API consente di specificare l'ID di hello di hello partizione toomove fuori QuorumLoss e in dataloss potenziale.</span><span class="sxs-lookup"><span data-stu-id="f6762-227">This API allows specifying hello ID of hello partition toomove out of QuorumLoss and into potential dataloss.</span></span>

> [!NOTE]
> <span data-ttu-id="f6762-228">È _mai_ toouse provvisoria questa API diverso nella modalità in partizioni specifiche.</span><span class="sxs-lookup"><span data-stu-id="f6762-228">It is _never_ safe toouse this API other than in a targeted way against specific partitions.</span></span> 
>

3. <span data-ttu-id="f6762-229">Determinazione se vi è stata una effettiva perdita di dati e ripristino da backup</span><span class="sxs-lookup"><span data-stu-id="f6762-229">Determining if there has been actual data loss, and restoring from backups</span></span>
  - <span data-ttu-id="f6762-230">Quando Service Fabric chiama hello `OnDataLossAsync` è sempre il metodo _sospetti_ dataloss.</span><span class="sxs-lookup"><span data-stu-id="f6762-230">When Service Fabric calls hello `OnDataLossAsync` method it is always because of _suspected_ dataloss.</span></span> <span data-ttu-id="f6762-231">Service Fabric assicura che la chiamata viene recapitata toohello _migliore_ replica rimanente.</span><span class="sxs-lookup"><span data-stu-id="f6762-231">Service Fabric ensures that this call is delivered toohello _best_ remaining replica.</span></span> <span data-ttu-id="f6762-232">Si tratta indipendentemente da quale replica avanzamento hello la maggior parte delle.</span><span class="sxs-lookup"><span data-stu-id="f6762-232">This is whichever replica has made hello most progress.</span></span> <span data-ttu-id="f6762-233">Hello motivo diciamo sempre _sospetti_ dataloss è che è possibile che la replica rimanenti hello ha effettivamente tutti stesso stato hello primario aveva quando è arrestato.</span><span class="sxs-lookup"><span data-stu-id="f6762-233">hello reason we always say _suspected_ dataloss is that it is possible that hello remaining replica actually has all same state as hello Primary did when it went down.</span></span> <span data-ttu-id="f6762-234">Tuttavia, senza toocompare tale stato è, non è valida per Service Fabric o operatori tooknow con certezza.</span><span class="sxs-lookup"><span data-stu-id="f6762-234">However, without that state toocompare it to, there's no good way for Service Fabric or operators tooknow for sure.</span></span> <span data-ttu-id="f6762-235">A questo punto, Service Fabric conosce hello altre repliche non sono confermata.</span><span class="sxs-lookup"><span data-stu-id="f6762-235">At this point, Service Fabric also knows hello other replicas are not coming back.</span></span> <span data-ttu-id="f6762-236">Che è stata effettuata quando si è arrestato in attesa di tooresolve di perdita di quorum hello stesso decisione di hello.</span><span class="sxs-lookup"><span data-stu-id="f6762-236">That was hello decision made when we stopped waiting for hello quorum loss tooresolve itself.</span></span> <span data-ttu-id="f6762-237">Hello migliore per il servizio hello è in genere toofreeze e attendere un intervento amministrativo specifico.</span><span class="sxs-lookup"><span data-stu-id="f6762-237">hello best course of action for hello service is usually toofreeze and wait for specific administrative intervention.</span></span> <span data-ttu-id="f6762-238">Pertanto, cosa che un'implementazione tipica di hello `OnDataLossAsync` metodo eseguire?</span><span class="sxs-lookup"><span data-stu-id="f6762-238">So what does a typical implementation of hello `OnDataLossAsync` method do?</span></span>
  - <span data-ttu-id="f6762-239">Registra prima di tutto che è stato generato un evento `OnDataLossAsync` e genera tutti i necessari avvisi amministrativi.</span><span class="sxs-lookup"><span data-stu-id="f6762-239">First, log that `OnDataLossAsync` has been triggered, and fire off any necessary administrative alerts.</span></span>
   - <span data-ttu-id="f6762-240">In genere a questo punto, toopause e attendere ulteriormente le decisioni e azioni manuali toobe eseguita.</span><span class="sxs-lookup"><span data-stu-id="f6762-240">Usually at this point, toopause and wait for further decisions and manual actions toobe taken.</span></span> <span data-ttu-id="f6762-241">Infatti, anche se sono disponibili backup può essere necessario toobe preparato.</span><span class="sxs-lookup"><span data-stu-id="f6762-241">This is because even if backups are available they may need toobe prepared.</span></span> <span data-ttu-id="f6762-242">Ad esempio, se i due servizi diversi coordinano informazioni, questi backup potrebbe essere necessario toobe modificato in ordine tooensure che dopo il ripristino di hello si verifica che le informazioni di hello questi due servizi interessano è coerente.</span><span class="sxs-lookup"><span data-stu-id="f6762-242">For example, if two different services coordinate information, those backups may need toobe modified in order tooensure that once hello restore happens that hello information those two services care about is consistent.</span></span> 
  - <span data-ttu-id="f6762-243">Spesso è anche alcuni altri dati di telemetria o di scarico dal servizio hello.</span><span class="sxs-lookup"><span data-stu-id="f6762-243">Often there is also some other telemetry or exhaust from hello service.</span></span> <span data-ttu-id="f6762-244">Questi metadati possono essere contenuti in altri servizi o in registri.</span><span class="sxs-lookup"><span data-stu-id="f6762-244">This metadata may be contained in other services or in logs.</span></span> <span data-ttu-id="f6762-245">Queste informazioni possono essere utilizzati toodetermine necessari se si sono verificati eventuali chiamate ricevuto ed elaborato in hello primario che non erano presenti in una determinata replica di backup o replicato toothis hello.</span><span class="sxs-lookup"><span data-stu-id="f6762-245">This information can be used needed toodetermine if there were any calls received and processed at hello primary that were not present in hello backup or replicated toothis particular replica.</span></span> <span data-ttu-id="f6762-246">Prima di ripristino è possibile, questi potrebbe essere necessario toobe toohello riprodotta o è stato aggiunto backup.</span><span class="sxs-lookup"><span data-stu-id="f6762-246">These may need toobe replayed or added toohello backup before restoration is feasible.</span></span>  
   - <span data-ttu-id="f6762-247">Confronti di hello rimanenti toothat lo stato della replica contenuti in tutti i backup disponibili.</span><span class="sxs-lookup"><span data-stu-id="f6762-247">Comparisons of hello remaining replica's state toothat contained in any backups that are available.</span></span> <span data-ttu-id="f6762-248">Se l'utilizzo di raccolte affidabile di hello Service Fabric quindi sono disponibili strumenti e processi disponibile per questa operazione, descritti in [questo articolo](service-fabric-reliable-services-backup-restore.md).</span><span class="sxs-lookup"><span data-stu-id="f6762-248">If using hello Service Fabric reliable collections then there are tools and processes available for doing so, described in [this article](service-fabric-reliable-services-backup-restore.md).</span></span> <span data-ttu-id="f6762-249">obiettivo di Hello è toosee se lo stato di hello all'interno di replica hello è sufficiente o anche il backup di hello potrebbe mancare.</span><span class="sxs-lookup"><span data-stu-id="f6762-249">hello goal is toosee if hello state within hello replica is sufficient, or also what hello backup may be missing.</span></span>
  - <span data-ttu-id="f6762-250">Una volta in cui viene eseguito confronto hello e se è stata completata ripristino necessarie hello, codice del servizio hello deve restituire true se sono state apportate le modifiche di stato.</span><span class="sxs-lookup"><span data-stu-id="f6762-250">Once hello comparison is done, and if necessary hello restore completed, hello service code should return true if any state changes were made.</span></span> <span data-ttu-id="f6762-251">Se replica hello determinato che era hello meglio disponibili copia dello stato di hello e non apportata alcuna modifica, restituisce false.</span><span class="sxs-lookup"><span data-stu-id="f6762-251">If hello replica determined that it was hello best available copy of hello state and made no changes, then return false.</span></span> <span data-ttu-id="f6762-252">True indica che qualsiasi _altra_ replica rimanente potrebbe ora essere incoerente con questa.</span><span class="sxs-lookup"><span data-stu-id="f6762-252">True indicates that any _other_ remaining replicas may now be inconsistent with this one.</span></span> <span data-ttu-id="f6762-253">Le repliche rimanenti verranno eliminate e ricreate da questa replica.</span><span class="sxs-lookup"><span data-stu-id="f6762-253">They will be dropped and rebuilt from this replica.</span></span> <span data-ttu-id="f6762-254">False indica che non stato sono state apportate modifiche, pertanto hello consente di mantenere cosa hanno altre repliche.</span><span class="sxs-lookup"><span data-stu-id="f6762-254">False indicates that no state changes were made, so hello other replicas can keep what they have.</span></span> 

<span data-ttu-id="f6762-255">È estremamente importante che gli autori del servizio applichino gli scenari di errore e di potenziale perdita di dati prima che i servizi vengano distribuiti nell'ambiente di produzione.</span><span class="sxs-lookup"><span data-stu-id="f6762-255">It is critically important that service authors practice potential dataloss and failure scenarios before services are ever deployed in production.</span></span> <span data-ttu-id="f6762-256">tooprotect contro il possibilità hello di dataloss, è importante tooperiodically [eseguire il backup dello stato di hello](service-fabric-reliable-services-backup-restore.md) di qualsiasi del Negozio con ridondanza geografica tooa servizi con stato.</span><span class="sxs-lookup"><span data-stu-id="f6762-256">tooprotect against hello possibility of dataloss, it is important tooperiodically [back up hello state](service-fabric-reliable-services-backup-restore.md) of any of your stateful services tooa geo-redundant store.</span></span> <span data-ttu-id="f6762-257">È anche necessario assicurarsi di aver toorestore possibilità hello è.</span><span class="sxs-lookup"><span data-stu-id="f6762-257">You must also ensure that you have hello ability toorestore it.</span></span> <span data-ttu-id="f6762-258">Poiché i backup di numerosi servizi diversi vengono eseguiti in momenti diversi, è necessario tooensure dopo il ripristino dei servizi dispongano di una visualizzazione coerenza tra loro.</span><span class="sxs-lookup"><span data-stu-id="f6762-258">Since backups of many different services are taken at different times, you need tooensure that after a restore your services have a consistent view of each other.</span></span> <span data-ttu-id="f6762-259">Ad esempio, si consideri una situazione in cui un servizio genera un numero e archivia e la invia tooanother servizio che viene inoltre archiviato.</span><span class="sxs-lookup"><span data-stu-id="f6762-259">For example, consider a situation where one service generates a number and stores it, then sends it tooanother service that also stores it.</span></span> <span data-ttu-id="f6762-260">Dopo un ripristino, è possibile riscontrare che secondo servizio hello è il numero di hello differenza hello prima di tutto, poiché il backup non include tale operazione.</span><span class="sxs-lookup"><span data-stu-id="f6762-260">After a restore, you might discover that hello second service has hello number but hello first does not, because it's backup didn't include that operation.</span></span>

<span data-ttu-id="f6762-261">Se si scopre che hello rimanenti le repliche sono insufficienti toocontinue da in uno scenario dataloss e non è possibile ricostruire lo stato del servizio dalla telemetria o di scarico, frequenza di hello dei backup determina l'obiettivo del punto di ripristino (RPO) migliore .</span><span class="sxs-lookup"><span data-stu-id="f6762-261">If you find out that hello remaining replicas are insufficient toocontinue from in a dataloss scenario, and you can't reconstruct service state from telemetry or exhaust, hello frequency of your backups determines your best possible recovery point objective (RPO).</span></span> <span data-ttu-id="f6762-262">Service Fabric include molti strumenti per testare vari scenari di errore, tra cui il quorum permanente e la perdita di dati che richiede il ripristino da un backup.</span><span class="sxs-lookup"><span data-stu-id="f6762-262">Service Fabric provides many tools for testing various failure scenarios, including permanent quorum and dataloss requiring restoration from a backup.</span></span> <span data-ttu-id="f6762-263">Questi scenari sono inclusi come parte di strumenti di testabilità dell'infrastruttura servizio gestito da hello errore Analysis Services.</span><span class="sxs-lookup"><span data-stu-id="f6762-263">These scenarios are included as a part of Service Fabric's testability tools, managed by hello Fault Analysis Service.</span></span> <span data-ttu-id="f6762-264">Altre informazioni su questi strumenti e criteri sono disponibili [qui](service-fabric-testability-overview.md).</span><span class="sxs-lookup"><span data-stu-id="f6762-264">More info on those tools and patterns is available [here](service-fabric-testability-overview.md).</span></span> 

> [!NOTE]
> <span data-ttu-id="f6762-265">Servizi di sistema possono inoltre subire una perdita di quorum, con un impatto hello viene toohello specifico servizio in questione.</span><span class="sxs-lookup"><span data-stu-id="f6762-265">System services can also suffer quorum loss, with hello impact being specific toohello service in question.</span></span> <span data-ttu-id="f6762-266">Ad esempio perdita del quorum nel servizio di denominazione hello influisce sulla risoluzione dei nomi, mentre perdita del quorum nel servizio di gestione failover hello blocca i failover e la creazione del nuovo servizio.</span><span class="sxs-lookup"><span data-stu-id="f6762-266">For instance, quorum loss in hello naming service impacts name resolution, whereas quorum loss in hello failover manager service blocks new service creation and failovers.</span></span> <span data-ttu-id="f6762-267">Mentre i servizi di sistema di Service Fabric hello seguono hello stesso schema come i servizi per la gestione dello stato, non è consigliabile che è consigliabile tentare toomove loro fuori perdita del Quorum e in dataloss potenziale.</span><span class="sxs-lookup"><span data-stu-id="f6762-267">While hello Service Fabric system services follow hello same pattern as your services for state management, it is not recommended that you should attempt toomove them out of Quorum Loss and into potential dataloss.</span></span> <span data-ttu-id="f6762-268">indicazione di Hello è invece troppo[seek supporto](service-fabric-support.md) toodetermine una soluzione destinata tooyour specifica situazione.</span><span class="sxs-lookup"><span data-stu-id="f6762-268">hello recommendation is instead too[seek support](service-fabric-support.md) toodetermine a solution that is targeted tooyour specific situation.</span></span>  <span data-ttu-id="f6762-269">In genere è preferibile toosimply attesa finché hello verso il basso le repliche restituite.</span><span class="sxs-lookup"><span data-stu-id="f6762-269">Usually it is preferable toosimply wait until hello down replicas return.</span></span>
>

## <a name="availability-of-hello-service-fabric-cluster"></a><span data-ttu-id="f6762-270">Disponibilità del cluster di Service Fabric hello</span><span class="sxs-lookup"><span data-stu-id="f6762-270">Availability of hello Service Fabric cluster</span></span>
<span data-ttu-id="f6762-271">In generale, i cluster di Service Fabric hello stesso è un ambiente ampiamente distribuito senza singoli punti di errore.</span><span class="sxs-lookup"><span data-stu-id="f6762-271">Generally speaking, hello Service Fabric cluster itself is a highly distributed environment with no single points of failure.</span></span> <span data-ttu-id="f6762-272">Un errore di un qualsiasi nodo non comporta la disponibilità o problemi di affidabilità per cluster hello, principalmente perché servizi di sistema di Service Fabric hello seguono hello stesse linee guida fornite in precedenza: essere sempre eseguiti con tre o più repliche per impostazione predefinita e tutti i nodi vengono eseguiti i servizi di sistema che sono senza stati.</span><span class="sxs-lookup"><span data-stu-id="f6762-272">A failure of any one node will not cause availability or reliability issues for hello cluster, primarily because hello Service Fabric system services follow hello same guidelines provided earlier: they always run with three or more replicas by default, and those system services that are stateless run on all nodes.</span></span> <span data-ttu-id="f6762-273">rete di Service Fabric sottostante Hello e livelli di rilevamento di errori sono completamente distribuiti.</span><span class="sxs-lookup"><span data-stu-id="f6762-273">hello underlying Service Fabric networking and failure detection layers are fully distributed.</span></span> <span data-ttu-id="f6762-274">La maggior parte dei servizi di sistema può essere ricompilati dai metadati cluster hello o sapere come tooresynchronize lo stato da altre posizioni.</span><span class="sxs-lookup"><span data-stu-id="f6762-274">Most system services can be rebuilt from metadata in hello cluster, or know how tooresynchronize their state from other places.</span></span> <span data-ttu-id="f6762-275">disponibilità Hello hello cluster potrebbe essere compromessa se servizi di sistema visualizzato in quorum perdita situazioni come quelle descritte sopra.</span><span class="sxs-lookup"><span data-stu-id="f6762-275">hello availability of hello cluster can become compromised if system services get into quorum loss situations like those described above.</span></span> <span data-ttu-id="f6762-276">In questi casi potrebbe non essere in grado di tooperform determinate operazioni nel cluster hello come avviare un aggiornamento o la distribuzione di nuovi servizi, ma i cluster hello stesso sia ancora attivo.</span><span class="sxs-lookup"><span data-stu-id="f6762-276">In these cases you may not be able tooperform certain operations on hello cluster like starting an upgrade or deploying new services, but hello cluster itself is still up.</span></span> <span data-ttu-id="f6762-277">Servizi in esecuzione rimarrà in esecuzione in queste condizioni a meno che non richiedono operazioni di scrittura toohello sistema servizi toocontinue funzionante.</span><span class="sxs-lookup"><span data-stu-id="f6762-277">Services on already running will remain running in these conditions unless they require writes toohello system services toocontinue functioning.</span></span> <span data-ttu-id="f6762-278">Ad esempio, in caso di perdita di quorum hello gestione Failover tutti i servizi continuerà toorun, ma tutti i servizi che non soddisfano non saranno in grado di tooautomatically riavvio, poiché questo richiede il coinvolgimento di hello di hello gestione Failover.</span><span class="sxs-lookup"><span data-stu-id="f6762-278">For example, if hello Failover Manager is in quorum loss all services will continue toorun, but any services that fail will not be able tooautomatically restart, since this requires hello involvement of hello Failover Manager.</span></span> 

### <a name="failures-of-a-datacenter-or-azure-region"></a><span data-ttu-id="f6762-279">Errori di un data center o un'area di Azure</span><span class="sxs-lookup"><span data-stu-id="f6762-279">Failures of a datacenter or Azure region</span></span>
<span data-ttu-id="f6762-280">In rari casi, può diventare temporaneamente disponibile a causa di un data center fisico tooloss di alimentazione o connettività di rete.</span><span class="sxs-lookup"><span data-stu-id="f6762-280">In rare cases, a physical data center can become temporarily unavailable due tooloss of power or network connectivity.</span></span> <span data-ttu-id="f6762-281">In questi casi i cluster e i servizi di Service Fabric presenti nel data center o nell'area di Azure non saranno disponibili.</span><span class="sxs-lookup"><span data-stu-id="f6762-281">In these cases, your Service Fabric clusters and services in that datacenter or Azure region will be unavailable.</span></span> <span data-ttu-id="f6762-282">_I dati saranno tuttavia preservati_.</span><span class="sxs-lookup"><span data-stu-id="f6762-282">However, _your data is preserved_.</span></span> <span data-ttu-id="f6762-283">Per i cluster in esecuzione in Azure, è possibile visualizzare gli aggiornamenti su interruzioni in hello [pagina stato Azure][azure-status-dashboard].</span><span class="sxs-lookup"><span data-stu-id="f6762-283">For clusters running in Azure, you can view updates on outages on hello [Azure status page][azure-status-dashboard].</span></span> <span data-ttu-id="f6762-284">In hello altamente improbabile che un centro dati fisico è completamente o parzialmente eliminato definitivamente, tutti i cluster di Service Fabric ospitati non esiste o servizi hello in essi contenuti potrebbero essere persi.</span><span class="sxs-lookup"><span data-stu-id="f6762-284">In hello highly unlikely event that a physical data center is partially or fully destroyed, any Service Fabric clusters hosted there or hello services inside them could be lost.</span></span> <span data-ttu-id="f6762-285">Sono inclusi tutti gli stati di cui non è stato eseguito il backup al di fuori del data center o dell'area.</span><span class="sxs-lookup"><span data-stu-id="f6762-285">This includes any state not backed up outside of that datacenter or region.</span></span>

<span data-ttu-id="f6762-286">È presente due diverse strategie per il superamento hello errore permanente o prolungato di un singolo Data Center o area geografica.</span><span class="sxs-lookup"><span data-stu-id="f6762-286">There's two different strategies for surviving hello permanent or sustained failure of a single datacenter or region.</span></span> 

1. <span data-ttu-id="f6762-287">Eseguire cluster di Service Fabric distinti in più aree e usare un qualche sistema per il failover e il failback tra questi ambienti.</span><span class="sxs-lookup"><span data-stu-id="f6762-287">Run separate Service Fabric clusters in multiple such regions, and utilize some mechanism for failover and fail-back between these environments.</span></span> <span data-ttu-id="f6762-288">Questo tipo di modello multi-cluster attivo-attivo o attivo-passivo richiede codice di gestione e operativo aggiuntivo.</span><span class="sxs-lookup"><span data-stu-id="f6762-288">This sort of multi-cluster active-active or active-passive model requires additional management and operations code.</span></span> <span data-ttu-id="f6762-289">È inoltre necessario coordinamento dei backup da servizi di hello in un Data Center o area geografica in modo che siano disponibili in altri Data Center o in aree quando uno ha esito negativo.</span><span class="sxs-lookup"><span data-stu-id="f6762-289">This also requires coordination of backups from hello services in one datacenter or region so that they are available in other datacenters or regions when one fails.</span></span> 
2. <span data-ttu-id="f6762-290">Eseguire un singolo cluster di Service Fabric che si estende su più data center o più aree.</span><span class="sxs-lookup"><span data-stu-id="f6762-290">Run a single Service Fabric cluster that spans multiple datacenters or regions.</span></span> <span data-ttu-id="f6762-291">Hello minimi delle configurazioni supportate per questo oggetto è tre aree o Data Center.</span><span class="sxs-lookup"><span data-stu-id="f6762-291">hello minimum supported configuration for this is three datacenters or regions.</span></span> <span data-ttu-id="f6762-292">Hello numero consigliato di aree o Data Center è cinque.</span><span class="sxs-lookup"><span data-stu-id="f6762-292">hello recommended number of regions or datacenters is five.</span></span> <span data-ttu-id="f6762-293">Questo modello richiede una topologia di cluster più complessa.</span><span class="sxs-lookup"><span data-stu-id="f6762-293">This requires a more complex cluster topology.</span></span> <span data-ttu-id="f6762-294">Tuttavia, hello vantaggio di questo modello è che un errore di un Data Center o area geografica viene convertito da una situazione di emergenza in un errore normale.</span><span class="sxs-lookup"><span data-stu-id="f6762-294">However, hello benefit of this model is that failure of one datacenter or region is converted from a disaster into a normal failure.</span></span> <span data-ttu-id="f6762-295">Questi errori possono essere gestiti dai meccanismi hello che funzionano per i cluster in una singola regione.</span><span class="sxs-lookup"><span data-stu-id="f6762-295">These failures can be handled by hello mechanisms that work for clusters within a single region.</span></span> <span data-ttu-id="f6762-296">I domini di errore, i domini di aggiornamento e le regole di posizionamento di Service Fabric assicurano che i carichi di lavoro vengano distribuiti in modo da essere in grado di tollerare gli errori normali.</span><span class="sxs-lookup"><span data-stu-id="f6762-296">Fault domains, upgrade domains, and Service Fabric's placement rules ensure workloads are distributed so that they tolerate normal failures.</span></span> <span data-ttu-id="f6762-297">Per altre informazioni sui criteri che aiutano a far funzionare i servizi in questo tipo di cluster, leggere l'articolo relativo ai [criteri di posizionamento](service-fabric-cluster-resource-manager-advanced-placement-rules-placement-policies.md).</span><span class="sxs-lookup"><span data-stu-id="f6762-297">For more information on policies that can help operate services in this type of cluster, read up on [placement policies](service-fabric-cluster-resource-manager-advanced-placement-rules-placement-policies.md)</span></span>

### <a name="random-failures-leading-toocluster-failures"></a><span data-ttu-id="f6762-298">Errori casuali iniziali toocluster errori</span><span class="sxs-lookup"><span data-stu-id="f6762-298">Random failures leading toocluster failures</span></span>
<span data-ttu-id="f6762-299">Service Fabric esiste il concetto di hello di nodi.</span><span class="sxs-lookup"><span data-stu-id="f6762-299">Service Fabric has hello concept of Seed Nodes.</span></span> <span data-ttu-id="f6762-300">Si tratta di nodi che gestiscono la disponibilità di hello del cluster sottostante hello.</span><span class="sxs-lookup"><span data-stu-id="f6762-300">These are nodes that maintain hello availability of hello underlying cluster.</span></span> <span data-ttu-id="f6762-301">Questi nodi consentono tooensure hello cluster rimane backup mediante la definizione di lease con gli altri nodi e che funge da spareggi durante determinati tipi di errori di rete.</span><span class="sxs-lookup"><span data-stu-id="f6762-301">These nodes help tooensure hello cluster remains up by establishing leases with other nodes and serving as tiebreakers during certain kinds of network failures.</span></span> <span data-ttu-id="f6762-302">Se errori casuali rimuove una maggioranza dei nodi seme hello cluster hello e non portare indietro, cluster hello automaticamente arrestato.</span><span class="sxs-lookup"><span data-stu-id="f6762-302">If random failures remove a majority of hello seed nodes in hello cluster and they are not brought back, hello cluster automatically shuts down.</span></span> <span data-ttu-id="f6762-303">In Azure, i nodi vengono gestiti automaticamente: vengono distribuiti in domini di aggiornamento e di errore disponibile hello e se un nodo singolo valore di inizializzazione viene rimosso dal cluster hello al suo posto verrà creato un altro.</span><span class="sxs-lookup"><span data-stu-id="f6762-303">In Azure, Seed Nodes are automatically managed: they are distributed over hello available fault and upgrade domains, and if a single seed node is removed from hello cluster another one will be created in its place.</span></span> 

<span data-ttu-id="f6762-304">Nel cluster di Service Fabric autonomo e Azure, "Tipo di nodo primario" hello è hello uno che esegue il seeding di hello.</span><span class="sxs-lookup"><span data-stu-id="f6762-304">In both standalone Service Fabric clusters and Azure, hello "Primary Node Type" is hello one that runs hello seeds.</span></span> <span data-ttu-id="f6762-305">Quando si definisce un tipo di nodo primario, Service Fabric automaticamente sfrutterà numero hello di nodi forniti tramite la creazione di nodi too9 e 9 repliche di ciascuno dei servizi di sistema hello.</span><span class="sxs-lookup"><span data-stu-id="f6762-305">When defining a primary node type, Service Fabric will automatically take advantage of hello number of nodes provided by creating up too9 seed nodes and 9 replicas of each of hello system services.</span></span> <span data-ttu-id="f6762-306">Se un set di errori casuali accetta contemporaneamente out la maggior parte di tali repliche del servizio di sistema, servizi di sistema hello verranno attivata la perdita del quorum, come descritto sopra.</span><span class="sxs-lookup"><span data-stu-id="f6762-306">If a set of random failures takes out a majority of those system service replicas simultaneously, hello system services will enter quorum loss, as we described above.</span></span> <span data-ttu-id="f6762-307">Se la maggioranza dei nodi seme hello viene persa, cluster hello verrà arrestato subito dopo.</span><span class="sxs-lookup"><span data-stu-id="f6762-307">If a majority of hello seed nodes are lost, hello cluster will shut down soon after.</span></span>

## <a name="next-steps"></a><span data-ttu-id="f6762-308">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="f6762-308">Next steps</span></span>
- <span data-ttu-id="f6762-309">Informazioni su come toosimulate diversi errori utilizzando hello [framework testabilità](service-fabric-testability-overview.md)</span><span class="sxs-lookup"><span data-stu-id="f6762-309">Learn how toosimulate various failures using hello [testability framework](service-fabric-testability-overview.md)</span></span>
- <span data-ttu-id="f6762-310">Lettura di altre risorse sul ripristino di emergenza e sulla disponibilità elevata.</span><span class="sxs-lookup"><span data-stu-id="f6762-310">Read other disaster-recovery and high-availability resources.</span></span> <span data-ttu-id="f6762-311">Microsoft ha pubblicato molti documenti su questi argomenti.</span><span class="sxs-lookup"><span data-stu-id="f6762-311">Microsoft has published a large amount of guidance on these topics.</span></span> <span data-ttu-id="f6762-312">Mentre alcuni di questi documenti si riferiscono toospecific tecniche per l'uso in altri prodotti, contengono molte procedure consigliate generali che è possibile applicare nel contesto di Service Fabric hello anche:</span><span class="sxs-lookup"><span data-stu-id="f6762-312">While some of these documents refer toospecific techniques for use in other products, they contain many general best practices you can apply in hello Service Fabric context as well:</span></span>
  - [<span data-ttu-id="f6762-313">Elenco di controllo della disponibilità</span><span class="sxs-lookup"><span data-stu-id="f6762-313">Availability checklist</span></span>](../best-practices-availability-checklist.md)
  - [<span data-ttu-id="f6762-314">Esercitazione nel ripristino di emergenza</span><span class="sxs-lookup"><span data-stu-id="f6762-314">Performing a disaster recovery drill</span></span>](../sql-database/sql-database-disaster-recovery-drills.md)
  - <span data-ttu-id="f6762-315">[Ripristino di emergenza e disponibilità elevata per le applicazioni Azure][dr-ha-guide]</span><span class="sxs-lookup"><span data-stu-id="f6762-315">[Disaster recovery and high availability for Azure applications][dr-ha-guide]</span></span>
- <span data-ttu-id="f6762-316">Informazioni sulle [opzioni di supporto di Service Fabric](service-fabric-support.md)</span><span class="sxs-lookup"><span data-stu-id="f6762-316">Learn about [Service Fabric support options](service-fabric-support.md)</span></span>

<!-- External links -->

[repair-partition-ps]: https://msdn.microsoft.com/library/mt163522.aspx
[azure-status-dashboard]:https://azure.microsoft.com/status/
[azure-regions]: https://azure.microsoft.com/regions/
[dr-ha-guide]: https://msdn.microsoft.com/library/azure/dn251004.aspx


<!-- Images -->

[sfx-cluster-map]: ./media/service-fabric-disaster-recovery/sfx-clustermap.png
