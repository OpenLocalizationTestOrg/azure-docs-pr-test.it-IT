---
title: distribuzione aaaFlighting (beta test), in Azure App Service
description: "Informazioni su come tooflight nuove funzionalità nell'applicazione o beta testare gli aggiornamenti in questa esercitazione end-to-end. Questa soluzione combina le funzionalità del servizio app, come pubblicazione continua, slot, routing del traffico e l'integrazione di Application Insights."
services: app-service\web
documentationcenter: 
author: cephalin
manager: erikre
editor: 
ms.assetid: 17953c51-38f8-442d-bb0b-f69c1542f0e9
ms.service: app-service-web
ms.workload: web
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 02/02/2016
ms.author: cephalin
ms.openlocfilehash: e83477b1fe46be09e5baa7bc2bd239b840b05cf7
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/06/2017
---
# <a name="flighting-deployment-beta-testing-in-azure-app-service"></a><span data-ttu-id="95b88-104">Distribuzione di versioni di anteprima (test beta) nel servizio app di Azure</span><span class="sxs-lookup"><span data-stu-id="95b88-104">Flighting deployment (beta testing) in Azure App Service</span></span>
<span data-ttu-id="95b88-105">In questa esercitazione illustra come toodo *anteprima distribuzioni* integrando hello varie funzionalità di [Azure App Service](http://go.microsoft.com/fwlink/?LinkId=529714) e [Azure Application Insights](/services/application-insights/).</span><span class="sxs-lookup"><span data-stu-id="95b88-105">This tutorial shows you how toodo *flighting deployments* by integrating hello various capabilities of [Azure App Service](http://go.microsoft.com/fwlink/?LinkId=529714) and [Azure Application Insights](/services/application-insights/).</span></span>

<span data-ttu-id="95b88-106">*distribuzione di versioni di anteprima* è un processo che convalida una nuova funzionalità o una modifica con un numero limitato di clienti reali ed è un test importante in uno scenario di produzione.</span><span class="sxs-lookup"><span data-stu-id="95b88-106">*Flighting* is a deployment process that validates a new feature or change with a limited number of real customers, and is a major testing in production scenario.</span></span> <span data-ttu-id="95b88-107">Si tratta di analogia toobeta test e viene talvolta definito come "test controllato volo".</span><span class="sxs-lookup"><span data-stu-id="95b88-107">It is akin toobeta testing and is sometimes known as "controlled test flight".</span></span> <span data-ttu-id="95b88-108">Molte aziende di grandi dimensioni con una presenza Web usano questo approccio per ottenere la convalida preventiva degli aggiornamenti di app nella proprià attività di [sviluppo Agile](https://en.wikipedia.org/wiki/Agile_software_development).</span><span class="sxs-lookup"><span data-stu-id="95b88-108">Many large enterprises with a web presence use this approach to get early validation on their app updates in their practice of [agile development](https://en.wikipedia.org/wiki/Agile_software_development).</span></span> <span data-ttu-id="95b88-109">Servizio App di Azure permette toointegrate test nell'ambiente di produzione con la pubblicazione continua e Application Insights tooimplement hello stesso scenario DevOps.</span><span class="sxs-lookup"><span data-stu-id="95b88-109">Azure App Service enables you toointegrate test in production with continous publishing and Application Insights tooimplement hello same DevOps scenario.</span></span> <span data-ttu-id="95b88-110">I vantaggi di questo approccio includono:</span><span class="sxs-lookup"><span data-stu-id="95b88-110">Benefits of this approach include:</span></span>

* <span data-ttu-id="95b88-111">**Ottenere commenti e suggerimenti reale *prima* gli aggiornamenti sono rilasciati tooproduction** -hello solo vantaggio ottenere commenti e suggerimenti, non appena si rilascia sta per essere commenti e suggerimenti prima di rilasciare.</span><span class="sxs-lookup"><span data-stu-id="95b88-111">**Gain real feedback *before* updates are released tooproduction** - hello only thing better than gaining feedback as soon as you release is gaining feedback before you release.</span></span> <span data-ttu-id="95b88-112">È possibile testare gli aggiornamenti con traffico utente reale e i comportamenti anticipata desiderate per il ciclo di vita di hello prodotto.</span><span class="sxs-lookup"><span data-stu-id="95b88-112">You can test updates with real user traffic and behaviors as early as you desire in hello product life cycle.</span></span>
* <span data-ttu-id="95b88-113">**Migliorare lo [sviluppo continuo basato su test (CTDD, Continuous test-driven development)](https://en.wikipedia.org/wiki/Continuous_test-driven_development)**: grazie all'integrazione di test nell'ambiente di produzione con l'integrazione continua e la strumentazione con Application Insights, la convalida dell'utente avviene tempestivamente e automaticamente nel ciclo di vita del prodotto.</span><span class="sxs-lookup"><span data-stu-id="95b88-113">**Enhance [continuous test-driven development (CTDD)](https://en.wikipedia.org/wiki/Continuous_test-driven_development)** - By integrating test in production with continuous integration and instrumentation with Application Insights, user validation happens early and automatically in your product life cycle.</span></span> <span data-ttu-id="95b88-114">Questo approccio consente di ridurre gli investimenti in termini di tempo per l'esecuzione di test manuali.</span><span class="sxs-lookup"><span data-stu-id="95b88-114">This helps reduce time investments in manual test execution.</span></span>
* <span data-ttu-id="95b88-115">**Ottimizzazione del flusso di lavoro di test** -tramite l'automazione dei test nell'ambiente di produzione con la strumentazione di monitoraggio continuata, è possibile potenzialmente realizzare obiettivi hello di vari tipi di test in un unico processo, ad esempio [integrazione](https://en.wikipedia.org/wiki/Integration_testing), [regressione](https://en.wikipedia.org/wiki/Regression_testing), [usabilità](https://en.wikipedia.org/wiki/Usability_testing), accessibilità, localizzazione, [prestazioni](https://en.wikipedia.org/wiki/Software_performance_testing), [sicurezza](https://en.wikipedia.org/wiki/Security_testing), e [ accettazione](https://en.wikipedia.org/wiki/Acceptance_testing).</span><span class="sxs-lookup"><span data-stu-id="95b88-115">**Optimize test workflow** - By automating test in production with continuous monitoring instrumentation, you can potentially accomplish hello goals of various kinds of tests in a single process, such as [integration](https://en.wikipedia.org/wiki/Integration_testing), [regression](https://en.wikipedia.org/wiki/Regression_testing), [usability](https://en.wikipedia.org/wiki/Usability_testing), accessibility, localization, [performance](https://en.wikipedia.org/wiki/Software_performance_testing), [security](https://en.wikipedia.org/wiki/Security_testing), and [acceptance](https://en.wikipedia.org/wiki/Acceptance_testing).</span></span>

<span data-ttu-id="95b88-116">Una distribuzione di versioni di anteprima non riguarda semplicemente il routing del traffico live.</span><span class="sxs-lookup"><span data-stu-id="95b88-116">A flighting deployment is not just about routing live traffic.</span></span> <span data-ttu-id="95b88-117">In questo tipo di distribuzione desiderato toogain una visione più rapidamente possibile, sia che si tratti di un errore imprevisto, un calo delle prestazioni, problemi relativi all'esperienza utente.</span><span class="sxs-lookup"><span data-stu-id="95b88-117">In such a deployment you want toogain insight as quickly as possible, whether it be an unexpected bug, performance degradation, user experience issues.</span></span> <span data-ttu-id="95b88-118">Tenere presente che si sta trattando con clienti reali.</span><span class="sxs-lookup"><span data-stu-id="95b88-118">Remember, you are dealing with real customers.</span></span> <span data-ttu-id="95b88-119">In questo caso toodo, a destra, è necessario assicurarsi che impostati il flighting toogather distribuzione tutti i dati di hello è necessario toomake una decisione consapevole per consentire il passaggio successivo.</span><span class="sxs-lookup"><span data-stu-id="95b88-119">So toodo it right, you must make sure that you have set up your flighting deployment toogather all hello data you need in order toomake an informed decision for your next step.</span></span> <span data-ttu-id="95b88-120">Questa esercitazione viene illustrato come dati toocollect con Application Insights, ma è possono usare New Relic o altre tecnologie che si adatta al proprio scenario.</span><span class="sxs-lookup"><span data-stu-id="95b88-120">This tutorial shows you how toocollect data with Application Insights, but you can use New Relic or other technologies that suits your scenario.</span></span>

## <a name="what-you-will-do"></a><span data-ttu-id="95b88-121">Contenuto dell'esercitazione</span><span class="sxs-lookup"><span data-stu-id="95b88-121">What you will do</span></span>
<span data-ttu-id="95b88-122">In questa esercitazione si apprenderà come toobring hello seguenti tootest insieme di scenari, l'applicazione di servizio App nell'ambiente di produzione:</span><span class="sxs-lookup"><span data-stu-id="95b88-122">In this tutorial, you will learn how toobring hello following scenarios together tootest your App Service app in production:</span></span>

* <span data-ttu-id="95b88-123">[Instradare il traffico di produzione](app-service-web-test-in-production-get-start.md) tooyour beta app</span><span class="sxs-lookup"><span data-stu-id="95b88-123">[Route production traffic](app-service-web-test-in-production-get-start.md) tooyour beta app</span></span>
* <span data-ttu-id="95b88-124">[Instrumentare l'app](../application-insights/app-insights-web-track-usage.md) tooobtain utile metriche</span><span class="sxs-lookup"><span data-stu-id="95b88-124">[Instrument your app](../application-insights/app-insights-web-track-usage.md) tooobtain useful metrics</span></span>
* <span data-ttu-id="95b88-125">Distribuire continuamente l'app beta e tenere traccia della metrica dell'app attiva</span><span class="sxs-lookup"><span data-stu-id="95b88-125">Continuously deploy your beta app and track live app metrics</span></span>
* <span data-ttu-id="95b88-126">Le metriche di confronto tra app di produzione hello e hello beta app toosee come codice cambia traducono tooresults</span><span class="sxs-lookup"><span data-stu-id="95b88-126">Compare metrics between hello production app and hello beta app toosee how code changes translate tooresults</span></span>

## <a name="what-you-will-need"></a><span data-ttu-id="95b88-127">Prerequisiti</span><span class="sxs-lookup"><span data-stu-id="95b88-127">What you will need</span></span>
* <span data-ttu-id="95b88-128">Un account Azure</span><span class="sxs-lookup"><span data-stu-id="95b88-128">An Azure account</span></span>
* <span data-ttu-id="95b88-129">Un account [GitHub](https://github.com/)</span><span class="sxs-lookup"><span data-stu-id="95b88-129">A [GitHub](https://github.com/) account</span></span>
* <span data-ttu-id="95b88-130">Visual Studio 2015 - è possibile scaricare hello [Community edition](https://www.visualstudio.com/en-us/products/visual-studio-express-vs.aspx).</span><span class="sxs-lookup"><span data-stu-id="95b88-130">Visual Studio 2015 - you can download hello [Community edition](https://www.visualstudio.com/en-us/products/visual-studio-express-vs.aspx).</span></span>
* <span data-ttu-id="95b88-131">GIT Shell (installato con [GitHub per Windows](https://windows.github.com/))-in questo modo si toorun entrambi i comandi Git e PowerShell di hello in hello stessa sessione</span><span class="sxs-lookup"><span data-stu-id="95b88-131">Git Shell (installed with [GitHub for Windows](https://windows.github.com/)) - this enables you toorun both hello Git and PowerShell commands in hello same session</span></span>
* <span data-ttu-id="95b88-132">Ultimi bit di [Azure PowerShell](https://github.com/Azure/azure-powershell/releases/download/v0.9.8-September2015/azure-powershell.0.9.8.msi)</span><span class="sxs-lookup"><span data-stu-id="95b88-132">Latest [Azure PowerShell](https://github.com/Azure/azure-powershell/releases/download/v0.9.8-September2015/azure-powershell.0.9.8.msi) bits</span></span>
* <span data-ttu-id="95b88-133">Conoscenza di base seguenti hello:</span><span class="sxs-lookup"><span data-stu-id="95b88-133">Basic understanding of hello following:</span></span>
  * <span data-ttu-id="95b88-134">Distribuzione di modelli di [Azure Resource Manager](../azure-resource-manager/resource-group-overview.md); vedere [Distribuire un'applicazione complessa in modo prevedibile in Azure](app-service-deploy-complex-application-predictably.md)</span><span class="sxs-lookup"><span data-stu-id="95b88-134">[Azure Resource Manager](../azure-resource-manager/resource-group-overview.md) template deployment (see [Deploy a complex application predictably in Azure](app-service-deploy-complex-application-predictably.md))</span></span>
  * [<span data-ttu-id="95b88-135">Git</span><span class="sxs-lookup"><span data-stu-id="95b88-135">Git</span></span>](http://git-scm.com/documentation)
  * [<span data-ttu-id="95b88-136">PowerShell</span><span class="sxs-lookup"><span data-stu-id="95b88-136">PowerShell</span></span>](https://technet.microsoft.com/library/bb978526.aspx)

> [!NOTE]
> <span data-ttu-id="95b88-137">È necessario un account di Azure di toocomplete questa esercitazione:</span><span class="sxs-lookup"><span data-stu-id="95b88-137">You need an Azure account toocomplete this tutorial:</span></span>
>
> * <span data-ttu-id="95b88-138">È possibile [aprire un account Azure, gratuitamente](https://azure.microsoft.com/pricing/free-trial/) -si ottiene crediti è possibile utilizzare tootry out a pagamento di servizi di Azure e anche dopo che consentono è possibile tenere conto di hello e libero di utilizzare servizi di Azure, ad esempio le applicazioni Web.</span><span class="sxs-lookup"><span data-stu-id="95b88-138">You can [open an Azure account for free](https://azure.microsoft.com/pricing/free-trial/) - You get credits you can use tootry out paid Azure services, and even after they're used up you can keep hello account and use free Azure services, such as Web Apps.</span></span>
> * <span data-ttu-id="95b88-139">È possibile [attivare i benefici della sottoscrizione Visual Studio](https://azure.microsoft.com/pricing/member-offers/msdn-benefits-details/): con la sottoscrizione Visual Studio ogni mese si accumulano crediti che è possibile usare per i servizi di Azure a pagamento.</span><span class="sxs-lookup"><span data-stu-id="95b88-139">You can [activate Visual Studio subscriber benefits](https://azure.microsoft.com/pricing/member-offers/msdn-benefits-details/) - Your Visual Studio subscription gives you credits every month that you can use for paid Azure services.</span></span>
>
> <span data-ttu-id="95b88-140">Se si desidera tooget avviato con il servizio App di Azure prima di effettuare l'iscrizione per un account Azure, andare troppo[tenta di servizio App](https://azure.microsoft.com/try/app-service/), in cui è possibile creare subito un'app web di breve durata starter nel servizio App.</span><span class="sxs-lookup"><span data-stu-id="95b88-140">If you want tooget started with Azure App Service before signing up for an Azure account, go too[Try App Service](https://azure.microsoft.com/try/app-service/), where you can immediately create a short-lived starter web app in App Service.</span></span> <span data-ttu-id="95b88-141">Non è necessario fornire una carta di credito né impegnarsi in alcun modo.</span><span class="sxs-lookup"><span data-stu-id="95b88-141">No credit cards required; no commitments.</span></span>
>
>

## <a name="set-up-your-production-web-app"></a><span data-ttu-id="95b88-142">Configurare l'app Web di produzione</span><span class="sxs-lookup"><span data-stu-id="95b88-142">Set up your production web app</span></span>
> [!NOTE]
> <span data-ttu-id="95b88-143">script Hello utilizzato in questa esercitazione verranno configurate automaticamente la pubblicazione continua dall'archivio GitHub.</span><span class="sxs-lookup"><span data-stu-id="95b88-143">hello script used in this tutorial will automatically configure continuous publishing from your GitHub repository.</span></span> <span data-ttu-id="95b88-144">È necessario che le credenziali per GitHub già archiviate in Azure, in caso contrario la distribuzione di hello inserito nello script non riuscirà quando si tenta di impostazioni di controllo tooconfigure origine per le app web hello.</span><span class="sxs-lookup"><span data-stu-id="95b88-144">This requires that your GitHub credentials are already stored in Azure, otherwise hello scripted deployment will fail when attempting tooconfigure source control settings for hello web apps.</span></span>
>
> <span data-ttu-id="95b88-145">toostore il GitHub credenziali in Azure, creare un'app web in hello [portale Azure](https://portal.azure.com/) e [configurare la distribuzione di GitHub](app-service-continuous-deployment.md).</span><span class="sxs-lookup"><span data-stu-id="95b88-145">toostore your GitHub credentials in Azure, create a web app in hello [Azure Portal](https://portal.azure.com/) and [configure GitHub deployment](app-service-continuous-deployment.md).</span></span> <span data-ttu-id="95b88-146">È necessario solo toodo questo volta.</span><span class="sxs-lookup"><span data-stu-id="95b88-146">You only need toodo this once.</span></span>
>
>

<span data-ttu-id="95b88-147">In uno scenario tipico DevOps, si dispone di un'applicazione che è in esecuzione in tempo reale in Azure e si desidera toomake modifiche tooit tramite la pubblicazione continua.</span><span class="sxs-lookup"><span data-stu-id="95b88-147">In a typical DevOps scenario, you have an application that’s running live in Azure, and you want toomake changes tooit through continuous publishing.</span></span> <span data-ttu-id="95b88-148">In questo scenario, si distribuirà tooproduction un modello che sono stati sviluppati e testati.</span><span class="sxs-lookup"><span data-stu-id="95b88-148">In this scenario, you will deploy tooproduction a template that you have developed and tested.</span></span>

1. <span data-ttu-id="95b88-149">Creare il propria fork di hello [ToDoApp](https://github.com/azure-appservice-samples/ToDoApp) repository.</span><span class="sxs-lookup"><span data-stu-id="95b88-149">Create your own fork of hello [ToDoApp](https://github.com/azure-appservice-samples/ToDoApp) repository.</span></span> <span data-ttu-id="95b88-150">Per informazioni sulla creazione della biforcazione, vedere la pagina relativa alla [biforcazione di un repository](https://help.github.com/articles/fork-a-repo/).</span><span class="sxs-lookup"><span data-stu-id="95b88-150">For information on creating your fork, see [Fork a Repo](https://help.github.com/articles/fork-a-repo/).</span></span> <span data-ttu-id="95b88-151">Una volta creata la biforcazione, è possibile visualizzarla nel browser.</span><span class="sxs-lookup"><span data-stu-id="95b88-151">Once your fork is created, you can see it in your browser.</span></span>

   ![](./media/app-service-agile-software-development/production-1-private-repo.png)
2. <span data-ttu-id="95b88-152">Aprire una sessione di Git Shell.</span><span class="sxs-lookup"><span data-stu-id="95b88-152">Open a Git Shell session.</span></span> <span data-ttu-id="95b88-153">Se non si ha ancora Git Shell, installare [GitHub per Windows](https://windows.github.com/) .</span><span class="sxs-lookup"><span data-stu-id="95b88-153">If you don't have Git Shell yet, install [GitHub for Windows](https://windows.github.com/) now.</span></span>
3. <span data-ttu-id="95b88-154">Creare un clone locale nel fork eseguendo hello comando seguente:</span><span class="sxs-lookup"><span data-stu-id="95b88-154">Create a local clone of your fork by executing hello following command:</span></span>

     <span data-ttu-id="95b88-155">git clone https://github.com/<fork>/ToDoApp.git</span><span class="sxs-lookup"><span data-stu-id="95b88-155">git clone https://github.com/<your_fork>/ToDoApp.git</span></span>
4. <span data-ttu-id="95b88-156">Dopo aver creato il clone locale, passare troppo*&lt;repository_root >*\ARMTemplates e hello esecuzione deploy.ps1 script con un suffisso univoco, come mostrato di seguito:</span><span class="sxs-lookup"><span data-stu-id="95b88-156">Once you have your local clone, navigate too*&lt;repository_root>*\ARMTemplates, and run hello deploy.ps1 script with a unique suffix, as shown below:</span></span>

     <span data-ttu-id="95b88-157">.\deploy.ps1 –RepoUrl https://github.com/<fork>/todoapp.git -ResourceGroupSuffix <suffisso_personalizzato></span><span class="sxs-lookup"><span data-stu-id="95b88-157">.\deploy.ps1 –RepoUrl https://github.com/<your_fork>/todoapp.git -ResourceGroupSuffix <your_suffix></span></span>
5. <span data-ttu-id="95b88-158">Quando richiesto, digitare nome utente hello desiderato e la password per l'accesso al database.</span><span class="sxs-lookup"><span data-stu-id="95b88-158">When prompted, type in hello desired username and password for database access.</span></span> <span data-ttu-id="95b88-159">Memorizza le credenziali del database poiché è necessario toospecify usarle nuovamente quando l'aggiornamento hello gruppo di risorse.</span><span class="sxs-lookup"><span data-stu-id="95b88-159">Remember your database credentials because you will need toospecify them again when updating hello resource group.</span></span>

   <span data-ttu-id="95b88-160">Dovrebbe essere hello provisioning lo stato di avanzamento delle varie risorse di Azure.</span><span class="sxs-lookup"><span data-stu-id="95b88-160">You should see hello provisioning progress of various Azure resources.</span></span> <span data-ttu-id="95b88-161">Al termine del processo di distribuzione, script hello avviare un'applicazione hello nel browser hello e offrono un segnale acustico descrittivo.</span><span class="sxs-lookup"><span data-stu-id="95b88-161">When deployment completes, hello script will launch hello application in hello browser and give you a friendly beep.</span></span>
   ![](./media/app-service-web-test-in-production-controlled-test-flight/00.1-app-in-browser.png)
6. <span data-ttu-id="95b88-162">Tornare alla sessione di Git Shell ed eseguire:</span><span class="sxs-lookup"><span data-stu-id="95b88-162">Back in your Git Shell session, run:</span></span>

     <span data-ttu-id="95b88-163">.\swap –Name ToDoApp<suffisso_personalizzato></span><span class="sxs-lookup"><span data-stu-id="95b88-163">.\swap –Name ToDoApp<your_suffix></span></span>

   ![](./media/app-service-web-test-in-production-controlled-test-flight/00.2-swap-to-production.png)
7. <span data-ttu-id="95b88-164">Al termine dell'esecuzione dello script hello, tornare indietro indirizzo del toobrowse toohello server front-end (http://ToDoApp*&lt;your_suffix >*.azurewebsites.net/) toosee un'applicazione hello in esecuzione nell'ambiente di produzione.</span><span class="sxs-lookup"><span data-stu-id="95b88-164">When hello script finishes, go back toobrowse toohello frontend’s address (http://ToDoApp*&lt;your_suffix>*.azurewebsites.net/) toosee hello application running in production.</span></span>
8. <span data-ttu-id="95b88-165">Accedere al hello [portale Azure](https://portal.azure.com/) e diamo un'occhiata a ciò che viene creato.</span><span class="sxs-lookup"><span data-stu-id="95b88-165">Log into hello [Azure Portal](https://portal.azure.com/) and take a look at what’s created.</span></span>

   <span data-ttu-id="95b88-166">Dovrebbe essere in grado di toosee due web App in hello stesso gruppo di risorse, uno con hello `Api` suffisso nel nome hello.</span><span class="sxs-lookup"><span data-stu-id="95b88-166">You should be able toosee two web apps in hello same resource group, one with hello `Api` suffix in hello name.</span></span> <span data-ttu-id="95b88-167">Se si osserva visualizzazione gruppo risorse di hello, si verifica anche hello Database SQL e server, hello piano di servizio App e slot di gestione temporanea hello per le app web hello.</span><span class="sxs-lookup"><span data-stu-id="95b88-167">If you look at hello resource group view, you will also see hello SQL Database and server, hello App Service plan, and hello staging slots for hello web apps.</span></span> <span data-ttu-id="95b88-168">Esplorare le diverse risorse hello e confrontarle con  *&lt;repository_root >*toosee \ARMTemplates\ProdAndStage.json modo in cui sono configurati nel modello di hello.</span><span class="sxs-lookup"><span data-stu-id="95b88-168">Browse through hello different resources and compare them with *&lt;repository_root>*\ARMTemplates\ProdAndStage.json toosee how they are configured in hello template.</span></span>

   ![](./media/app-service-web-test-in-production-controlled-test-flight/00.3-resource-group-view.png)

<span data-ttu-id="95b88-169">Impostare hello dell'applicazione di produzione.</span><span class="sxs-lookup"><span data-stu-id="95b88-169">You have set up hello production app.</span></span>  <span data-ttu-id="95b88-170">A questo punto, si supponga di ricevere commenti e suggerimenti che non sono soddisfacenti per app hello usabilità.</span><span class="sxs-lookup"><span data-stu-id="95b88-170">Now, let's imagine that you receive feedback that usability is poor for hello app.</span></span> <span data-ttu-id="95b88-171">Pertanto, si decide di tooinvestigate.</span><span class="sxs-lookup"><span data-stu-id="95b88-171">So you decide tooinvestigate.</span></span> <span data-ttu-id="95b88-172">Si userà tooinstrument toogive l'app è commenti e suggerimenti.</span><span class="sxs-lookup"><span data-stu-id="95b88-172">You're going tooinstrument your app toogive you feedback.</span></span>

## <a name="investigate-instrument-your-client-app-for-monitoringmetrics"></a><span data-ttu-id="95b88-173">Procedere all'approfondimento: instrumentare l'app client per il monitoraggio e la metrica</span><span class="sxs-lookup"><span data-stu-id="95b88-173">Investigate: Instrument your client app for monitoring/metrics</span></span>
1. <span data-ttu-id="95b88-174">Aprire *&lt;radice_repository >*\src\MultiChannelToDo.sln in Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="95b88-174">Open *&lt;repository_root>*\src\MultiChannelToDo.sln in Visual Studio.</span></span>
2. <span data-ttu-id="95b88-175">Ripristinare tutti i pacchetti Nuget facendo clic con il pulsante destro del mouse sulla soluzione > **Gestisci pacchetti NuGet per la soluzione** > **Ripristina**.</span><span class="sxs-lookup"><span data-stu-id="95b88-175">Restore all Nuget packages by right-clicking solution > **Manage NuGet Packages for Solution** > **Restore**.</span></span>
3. <span data-ttu-id="95b88-176">Fare doppio clic su **MultiChannelToDo.Web** > **Aggiungi Application Insights Telemetry** > **Configura impostazioni** > Modifica gruppo di risorse tooToDoApp*&lt;your_suffix >* > **Aggiungi Application Insights tooProject**.</span><span class="sxs-lookup"><span data-stu-id="95b88-176">Right-click **MultiChannelToDo.Web** > **Add Application Insights Telemetry** > **Configure Settings** > Change resource group tooToDoApp*&lt;your_suffix>* > **Add Application Insights tooProject**.</span></span>
4. <span data-ttu-id="95b88-177">Nel portale di Azure hello, aprire Pannello hello hello **MultiChannelToDo.Web** risorsa di Application Insights.</span><span class="sxs-lookup"><span data-stu-id="95b88-177">In hello Azure Portal, open hello blade for hello **MultiChannelToDo.Web** Application Insight resource.</span></span> <span data-ttu-id="95b88-178">Quindi in hello **integrità applicazione** parte, fare clic su **informazioni su come caricare i dati toocollect pagina nel browser** > Copia codice.</span><span class="sxs-lookup"><span data-stu-id="95b88-178">Then in hello **Application health** part, click **Learn how toocollect browser page load data** > copy code.</span></span>
5. <span data-ttu-id="95b88-179">Aggiungere hello copiata il codice strumentazione JS troppo*&lt;repository_root >*\src\MultiChannelToDo.Web\app\Index.cshtml, appena prima della chiusura hello `<heading>` tag.</span><span class="sxs-lookup"><span data-stu-id="95b88-179">Add hello copied JS instrumentation code too*&lt;repository_root>*\src\MultiChannelToDo.Web\app\Index.cshtml, just before hello closing `<heading>` tag.</span></span> <span data-ttu-id="95b88-180">Deve contenere una chiave di strumentazione univoco hello della risorsa di Application Insights.</span><span class="sxs-lookup"><span data-stu-id="95b88-180">It should contain hello unique instrumentation key of your Application Insight resource.</span></span>

        <script type="text/javascript">
        var appInsights=window.appInsights||function(config){
            function s(config){t[config]=function(){var i=arguments;t.queue.push(function(){t[config].apply(t,i)})}}var t={config:config},r=document,f=window,e="script",o=r.createElement(e),i,u;for(o.src=config.url||"//az416426.vo.msecnd.net/scripts/a/ai.0.js",r.getElementsByTagName(e)[0].parentNode.appendChild(o),t.cookie=r.cookie,t.queue=[],i=["Event","Exception","Metric","PageView","Trace"];i.length;)s("track"+i.pop());return config.disableExceptionTracking||(i="onerror",s("_"+i),u=f[i],f[i]=function(config,r,f,e,o){var s=u&&u(config,r,f,e,o);return s!==!0&&t["_"+i](config,r,f,e,o),s}),t
        }({
            instrumentationKey:"<your_unique_instrumentation_key>"
        });

        window.appInsights=appInsights;
        appInsights.trackPageView();
        </script>
6. <span data-ttu-id="95b88-181">Invia eventi personalizzati tooApplication informazioni dettagliate per i clic del mouse aggiungendo hello inferiore toohello codice del corpo seguente:</span><span class="sxs-lookup"><span data-stu-id="95b88-181">Send custom events tooApplication Insights for mouse clicks by adding hello following code toohello bottom of body:</span></span>

       <script>
           $(document.body).find("*").click(function(event) {

               appInsights.trackEvent(event.target.tagName + ": " + event.target.className);
           });
       </script>

   <span data-ttu-id="95b88-182">Questo frammento di codice JavaScript invia tooApplication un evento personalizzato Insights ogni volta che un utente fa clic in un punto qualsiasi nell'app web hello.</span><span class="sxs-lookup"><span data-stu-id="95b88-182">This JavaScript snippet sends a custom event tooApplication Insights every time a user clicks anywhere in hello web app.</span></span>
7. <span data-ttu-id="95b88-183">Nella Shell di Git, eseguire il commit e push nel fork tooyour modifiche in GitHub.</span><span class="sxs-lookup"><span data-stu-id="95b88-183">In Git Shell, commit and push your changes tooyour fork in GitHub.</span></span> <span data-ttu-id="95b88-184">Attendere quindi browser toorefresh client.</span><span class="sxs-lookup"><span data-stu-id="95b88-184">Then, wait for clients toorefresh browser.</span></span>

       git add -A :/
       git commit -m "add AI configuration for client app"
       git push origin master
8. <span data-ttu-id="95b88-185">Scambiare hello distribuito app modifiche tooproduction:</span><span class="sxs-lookup"><span data-stu-id="95b88-185">Swap hello deployed app changes tooproduction:</span></span>

     <span data-ttu-id="95b88-186">.\swap –Name ToDoApp<suffisso_personalizzato></span><span class="sxs-lookup"><span data-stu-id="95b88-186">.\swap –Name ToDoApp<your_suffix></span></span>
9. <span data-ttu-id="95b88-187">Sfoglia risorsa di Application Insights toohello configurato.</span><span class="sxs-lookup"><span data-stu-id="95b88-187">Browse toohello Application Insights resource that you configured.</span></span> <span data-ttu-id="95b88-188">Fare clic su Eventi personalizzati.</span><span class="sxs-lookup"><span data-stu-id="95b88-188">Click Custom events.</span></span>

   ![](./media/app-service-web-test-in-production-controlled-test-flight/01-custom-events.png)

   <span data-ttu-id="95b88-189">Se non viene visualizzata la metrica per gli eventi personalizzati, attendere alcuni minuti e fare clic su **Aggiorna**.</span><span class="sxs-lookup"><span data-stu-id="95b88-189">If you don't see metrics for custom events, wait a few minutes and click **Refresh**.</span></span>

<span data-ttu-id="95b88-190">Si supponga di visualizzare un grafico come il seguente:</span><span class="sxs-lookup"><span data-stu-id="95b88-190">Suppose you see a chart like below:</span></span>

![](./media/app-service-web-test-in-production-controlled-test-flight/02-custom-events-chart-view.png)

<span data-ttu-id="95b88-191">E griglia di eventi hello sotto di essa:</span><span class="sxs-lookup"><span data-stu-id="95b88-191">And hello event grid below it:</span></span>

![](./media/app-service-web-test-in-production-controlled-test-flight/03-custom-event-grid-view.png)

<span data-ttu-id="95b88-192">In base tooyour ToDoApp codice dell'applicazione, hello **pulsante** evento corrisponde pulsante Invia toohello e hello **INPUT** evento corrisponde toohello casella di testo.</span><span class="sxs-lookup"><span data-stu-id="95b88-192">According tooyour ToDoApp application code, hello **BUTTON** event corresponds toohello submit button, and hello **INPUT** event corresponds toohello textbox.</span></span> <span data-ttu-id="95b88-193">Fino a questo punto, è tutto chiaro.</span><span class="sxs-lookup"><span data-stu-id="95b88-193">So far, things make sense.</span></span> <span data-ttu-id="95b88-194">Tuttavia, sembra che è una discreta quantità di clic e pochi clic sugli elementi di attività da eseguire hello (hello **LI** eventi).</span><span class="sxs-lookup"><span data-stu-id="95b88-194">However, it looks like there's a good amount of clicks and very few clicks on hello to-do items (hello **LI** events).</span></span>

<span data-ttu-id="95b88-195">Basato su, questo modulo è l'ipotesi che alcuni utenti sono confusi quale parte della hello dell'interfaccia utente è selezionabili ed è perché cursore hello è concepito per la selezione di testo quando viene posizionato in voci di elenco hello e le icone.</span><span class="sxs-lookup"><span data-stu-id="95b88-195">Based on this, you form your hypothesis that some users are confused which part of hello UI is clickable and it is because hello cursor is styled for text selection when it hovers on hello list items and their icons.</span></span>

![](./media/app-service-web-test-in-production-controlled-test-flight/04-to-do-list-item-ui.png)

<span data-ttu-id="95b88-196">Potrebbe trattarsi di un esempio improbabile.</span><span class="sxs-lookup"><span data-stu-id="95b88-196">This might be a contrived example.</span></span> <span data-ttu-id="95b88-197">Tuttavia, è corso toomake un'app tooyour analisi utilizzo software e quindi eseguire un commenti e suggerimenti di flighting distribuzione tooget usabilità dei clienti in tempo reale.</span><span class="sxs-lookup"><span data-stu-id="95b88-197">Nevertheless, you're going toomake an improvement tooyour app, and then perform a flighting deployment tooget usability feedback from live customers.</span></span>

### <a name="instrument-your-server-app-for-monitoringmetrics"></a><span data-ttu-id="95b88-198">Instrumentare l'app server per il monitoraggio e la metrica</span><span class="sxs-lookup"><span data-stu-id="95b88-198">Instrument your server app for monitoring/metrics</span></span>
<span data-ttu-id="95b88-199">Si tratta di una tangente poiché scenario hello illustrato in questa esercitazione sono disponibili solo app client hello.</span><span class="sxs-lookup"><span data-stu-id="95b88-199">This is a tangent since hello scenario demonstrated in this tutorial only deals with hello client app.</span></span> <span data-ttu-id="95b88-200">Tuttavia, per motivi di completezza imposterà hello sul lato server app.</span><span class="sxs-lookup"><span data-stu-id="95b88-200">However, for completeness you will set up hello server-side app.</span></span>

1. <span data-ttu-id="95b88-201">Fare doppio clic su **MultiChannelToDo** > **Aggiungi Application Insights Telemetry** > **Configura impostazioni** > Modifica gruppo di risorse tooToDoApp*&lt;your_suffix >* > **Aggiungi Application Insights tooProject**.</span><span class="sxs-lookup"><span data-stu-id="95b88-201">Right-click **MultiChannelToDo** > **Add Application Insights Telemetry** > **Configure Settings** > Change resource group tooToDoApp*&lt;your_suffix>* > **Add Application Insights tooProject**.</span></span>
2. <span data-ttu-id="95b88-202">Nella Shell di Git, eseguire il commit e push nel fork tooyour modifiche in GitHub.</span><span class="sxs-lookup"><span data-stu-id="95b88-202">In Git Shell, commit and push your changes tooyour fork in GitHub.</span></span> <span data-ttu-id="95b88-203">Attendere quindi browser toorefresh client.</span><span class="sxs-lookup"><span data-stu-id="95b88-203">Then, wait for clients toorefresh browser.</span></span>

       git add -A :/
       git commit -m "add AI configuration for server app"
       git push origin master
3. <span data-ttu-id="95b88-204">Scambiare hello distribuito app modifiche tooproduction:</span><span class="sxs-lookup"><span data-stu-id="95b88-204">Swap hello deployed app changes tooproduction:</span></span>

     <span data-ttu-id="95b88-205">.\swap –Name ToDoApp<suffisso_personalizzato></span><span class="sxs-lookup"><span data-stu-id="95b88-205">.\swap –Name ToDoApp<your_suffix></span></span>

<span data-ttu-id="95b88-206">L'operazione è terminata.</span><span class="sxs-lookup"><span data-stu-id="95b88-206">That's it!</span></span>

## <a name="investigate-add-slot-specific-tags-tooyour-client-app-metrics"></a><span data-ttu-id="95b88-207">Provare a utilizzare: Aggiungere metriche di app client tooyour tag specifici dello slot</span><span class="sxs-lookup"><span data-stu-id="95b88-207">Investigate: Add slot-specific tags tooyour client app metrics</span></span>
<span data-ttu-id="95b88-208">In questa sezione, si configurerà hello distribuzione diversi slot toosend specifici dello slot telemetria toohello stessa risorsa di Application Insights.</span><span class="sxs-lookup"><span data-stu-id="95b88-208">In this section, you will configure hello different deployment slots toosend slot-specific telemetry toohello same Application Insights resource.</span></span> <span data-ttu-id="95b88-209">In questo modo, è possibile confrontare dati di telemetria dei dati tra il traffico proveniente da tooeasily slot diversi (ambienti di distribuzione), vedere effetto hello delle modifiche alle app.</span><span class="sxs-lookup"><span data-stu-id="95b88-209">This way, you can compare telemetry data between traffic from different slots (deployment environments) tooeasily see hello effect of your app changes.</span></span> <span data-ttu-id="95b88-210">AT hello stesso tempo, è possibile separare il traffico di produzione di hello dal resto hello in modo è possibile continuare toomonitor l'app di produzione in base alle esigenze.</span><span class="sxs-lookup"><span data-stu-id="95b88-210">At hello same time, you can separate hello production traffic from hello rest so you can continue toomonitor your production app as needed.</span></span>

<span data-ttu-id="95b88-211">Poiché si sta la raccolta dei dati sul comportamento del client, avrà [un tooyour inizializzatore telemetria codice JavaScript aggiungere](../application-insights/app-insights-api-filtering-sampling.md) in cshtml.</span><span class="sxs-lookup"><span data-stu-id="95b88-211">Since you're gathering data on client behavior, you will [add a telemetry initializer tooyour JavaScript code](../application-insights/app-insights-api-filtering-sampling.md) in index.cshtml.</span></span> <span data-ttu-id="95b88-212">Se si desidera tootest prestazioni sul lato server, ad esempio, è possibile anche eseguire in modo analogo nel codice server (vedere [Application Insights API per gli eventi personalizzati e le metriche](../application-insights/app-insights-api-custom-events-metrics.md).</span><span class="sxs-lookup"><span data-stu-id="95b88-212">If you want tootest server-side performance, for example, you can also do similarly in your server code (see [Application Insights API for custom events and metrics](../application-insights/app-insights-api-custom-events-metrics.md).</span></span>

1. <span data-ttu-id="95b88-213">Aggiungere innanzitutto hello bewteen tramite codice hello due `//` commenti sotto blocco JavaScript hello aggiunto toohello `<heading>` tag in precedenza.</span><span class="sxs-lookup"><span data-stu-id="95b88-213">First, add hello code bewteen hello two `//` comments below in hello JavaScript block that you added toohello `<heading>` tag earlier.</span></span>

        window.appInsights = appInsights;

        // Begin new code
        appInsights.queue.push(function () {
            appInsights.context.addTelemetryInitializer(function (envelope) {
                var telemetryItem = envelope.data.baseData;
                telemetryItem.properties = telemetryItem.properties || {};
                telemetryItem.properties["Environment"] = "@System.Configuration.ConfigurationManager.AppSettings["environment"]";
            });
        });
        // End new code

        appInsights.trackPageView();

    <span data-ttu-id="95b88-214">Questo codice inizializzatore causa hello `appInsights` tooadd oggetto hello una proprietà personalizzata denominata `Environment` tooevery pezzo di dati di telemetria Invia.</span><span class="sxs-lookup"><span data-stu-id="95b88-214">This initializer code causes hello `appInsights` object tooadd hello a custom property called `Environment` tooevery piece of telemetry it sends.</span></span>
2. <span data-ttu-id="95b88-215">Aggiungere quindi questa proprietà personalizzata come [impostazione dello slot](web-sites-staged-publishing.md#AboutConfiguration) per l'app Web in Azure.</span><span class="sxs-lookup"><span data-stu-id="95b88-215">Next, add this custom property as a [slot setting](web-sites-staged-publishing.md#AboutConfiguration) for your web app in Azure.</span></span> <span data-ttu-id="95b88-216">toodo, hello esecuzione seguendo i comandi nella sessione della Shell di Git.</span><span class="sxs-lookup"><span data-stu-id="95b88-216">toodo this, run hello following commands in your Git Shell session.</span></span>

        $app = Get-AzureWebsite -Name todoapp<your_suffix> -Slot production
        $app.AppSettings.Add("environment", "Production")
        $app.SlotStickyAppSettingNames.Add("environment")
        $app | Set-AzureWebsite -Name todoapp<your_suffix> -Slot production

    <span data-ttu-id="95b88-217">Hello Web. config nel progetto definisce già hello `environment` impostazione dell'app.</span><span class="sxs-lookup"><span data-stu-id="95b88-217">hello Web.config in your project already defines hello `environment` app setting.</span></span> <span data-ttu-id="95b88-218">Con questa impostazione, durante il test in locale, l'applicazione hello le metriche verranno contrassegnate con `VS Debugger`.</span><span class="sxs-lookup"><span data-stu-id="95b88-218">With this setting, when you test hello app locally, your metrics will be tagged with `VS Debugger`.</span></span> <span data-ttu-id="95b88-219">Tuttavia, quando si esegue il push tooAzure le modifiche, Azure verrà trovare e utilizzare hello `environment` verranno contrassegnato con l'impostazione nella configurazione dell'applicazione web hello invece app e le metriche `Production`.</span><span class="sxs-lookup"><span data-stu-id="95b88-219">However, when you push your changes tooAzure, Azure will find and use hello `environment` app setting in hello web app's configuration instead, and your metrics will be tagged with `Production`.</span></span>
3. <span data-ttu-id="95b88-220">Eseguire il commit e push nel fork tooyour modifiche di codice su GitHub e quindi attendere che gli utenti toouse hello nuova app (necessità toorefresh hello browser).</span><span class="sxs-lookup"><span data-stu-id="95b88-220">Commit and push your code changes tooyour fork on GitHub, and then wait for your users toouse hello new app (need toorefresh hello browser).</span></span> <span data-ttu-id="95b88-221">Occupa circa 15 minuti per hello nuova proprietà tooshow nell'Application Insights `MultiChannelToDo.Web` risorse.</span><span class="sxs-lookup"><span data-stu-id="95b88-221">It takes about 15 minutes for hello new property tooshow up in your Application Insights `MultiChannelToDo.Web` resource.</span></span>

        git add -A :/
        git commit -m "add environment property tooAI events for client app"
        git push origin master
4. <span data-ttu-id="95b88-222">A questo punto, passare toohello **eventi personalizzati** pannello nuovamente e filtro hello metriche in `Environment=Production`.</span><span class="sxs-lookup"><span data-stu-id="95b88-222">Now, go toohello **Custom events** blade again and filter hello metrics on `Environment=Production`.</span></span> <span data-ttu-id="95b88-223">Dovrebbe ora essere in grado di toosee tutti hello nuovo gli eventi personalizzati nell'ambiente di produzione hello slot con questo filtro.</span><span class="sxs-lookup"><span data-stu-id="95b88-223">You should now be able toosee all hello new custom events in hello production slot with this filter.</span></span>

    ![](./media/app-service-web-test-in-production-controlled-test-flight/05-filter-on-production-environment.png)
5. <span data-ttu-id="95b88-224">Fare clic su hello **Preferiti** come pulsante toosave hello corrente Esplora metriche impostazioni toosomething **eventi personalizzati: produzione**.</span><span class="sxs-lookup"><span data-stu-id="95b88-224">Click hello **Favorites** button toosave hello current Metrics Explorer settings toosomething like **Custom events: Production**.</span></span> <span data-ttu-id="95b88-225">È possibile passare facilmente tra questa visualizzazione e una visualizzazione dello slot di distribuzione in un secondo momento.</span><span class="sxs-lookup"><span data-stu-id="95b88-225">You can easily switch between this view and a deployment slot view later.</span></span>

   > [!TIP]
   > <span data-ttu-id="95b88-226">Per analisi ancora più avanzate, prendere in considerazione l' [l'integrazione della risorsa di Application Insights con Power BI](../application-insights/app-insights-export-power-bi.md).</span><span class="sxs-lookup"><span data-stu-id="95b88-226">For even more powerful analytics, consider [integrating your Application Insights resource with Power BI](../application-insights/app-insights-export-power-bi.md).</span></span>
   >
   >

### <a name="add-slot-specific-tags-tooyour-server-app-metrics"></a><span data-ttu-id="95b88-227">Aggiungere tag specifici dello slot tooyour server app metriche</span><span class="sxs-lookup"><span data-stu-id="95b88-227">Add slot-specific tags tooyour server app metrics</span></span>
<span data-ttu-id="95b88-228">Nuovamente, per motivi di completezza si imposterà hello sul lato server app.</span><span class="sxs-lookup"><span data-stu-id="95b88-228">Again, for completeness you will set up hello server-side app.</span></span> <span data-ttu-id="95b88-229">A differenza di app client hello è instrumentato in JavaScript, il tag di slot specifici per l'app server hello è instrumentato con codice .NET.</span><span class="sxs-lookup"><span data-stu-id="95b88-229">Unlike hello client app which is instrumented in JavaScript, slot-specific tags for hello server app is instrumented with .NET code.</span></span>

1. <span data-ttu-id="95b88-230">Aprire *&lt;radice_repository >*\src\MultiChannelToDo\Global.asax.cs.</span><span class="sxs-lookup"><span data-stu-id="95b88-230">Open *&lt;repository_root>*\src\MultiChannelToDo\Global.asax.cs.</span></span> <span data-ttu-id="95b88-231">Aggiungere hello un blocco di codice seguente, appena prima hello dello spazio dei nomi tra parentesi graffe.</span><span class="sxs-lookup"><span data-stu-id="95b88-231">Add hello code block below, just before hello closing namespace curly brace.</span></span>

        namespace MultiChannelToDo
        {
                ...

                // Begin new code
            public class ConfigInitializer
            : ITelemetryInitializer
            {
                void ITelemetryInitializer.Initialize(ITelemetry telemetry)
                {
                    telemetry.Context.Properties["Environment"] = System.Configuration.ConfigurationManager.AppSettings["environment"];
                }
            }
                // End new code
        }
2. <span data-ttu-id="95b88-232">Correggere gli errori di risoluzione nome hello aggiungendo hello `using` istruzioni sotto toohello inizio del file hello:</span><span class="sxs-lookup"><span data-stu-id="95b88-232">Correct hello name resolution errors by adding hello `using` statements below toohello beginning of hello file:</span></span>

        using Microsoft.ApplicationInsights.Channel;
        using Microsoft.ApplicationInsights.Extensibility;
3. <span data-ttu-id="95b88-233">Aggiungere codice hello sotto toohello inizio hello `Application_Start()` metodo:</span><span class="sxs-lookup"><span data-stu-id="95b88-233">Add hello code below toohello beginning of hello `Application_Start()` method:</span></span>

        TelemetryConfiguration.Active.TelemetryInitializers.Add(new ConfigInitializer());
4. <span data-ttu-id="95b88-234">Eseguire il commit e push nel fork tooyour modifiche di codice su GitHub e quindi attendere che gli utenti toouse hello nuova app (necessità toorefresh hello browser).</span><span class="sxs-lookup"><span data-stu-id="95b88-234">Commit and push your code changes tooyour fork on GitHub, and then wait for your users toouse hello new app (need toorefresh hello browser).</span></span> <span data-ttu-id="95b88-235">Occupa circa 15 minuti per hello nuova proprietà tooshow nell'Application Insights `MultiChannelToDo` risorse.</span><span class="sxs-lookup"><span data-stu-id="95b88-235">It takes about 15 minutes for hello new property tooshow up in your Application Insights `MultiChannelToDo` resource.</span></span>

        git add -A :/
        git commit -m "add environment property tooAI events for server app"
        git push origin master

## <a name="update-set-up-your-beta-branch"></a><span data-ttu-id="95b88-236">Procedere all'aggiornamento: configurare il ramo beta</span><span class="sxs-lookup"><span data-stu-id="95b88-236">Update: Set up your beta branch</span></span>
1. <span data-ttu-id="95b88-237">Aprire  *&lt;repository_root >*\ARMTemplates\ProdAndStagetest.json e individuare hello `appsettings` risorse (cercare `"name": "appsettings"`).</span><span class="sxs-lookup"><span data-stu-id="95b88-237">Open *&lt;repository_root>*\ARMTemplates\ProdAndStagetest.json and find hello `appsettings` resources (search for `"name": "appsettings"`).</span></span> <span data-ttu-id="95b88-238">Ne sono disponibili 4, una per ogni slot.</span><span class="sxs-lookup"><span data-stu-id="95b88-238">There are 4 of them, one for each slot.</span></span>
2. <span data-ttu-id="95b88-239">Per ogni `appsettings` risorse, aggiungere un `"environment": "[parameters('slotName')]"` app impostazione toohello fine hello `properties` matrice.</span><span class="sxs-lookup"><span data-stu-id="95b88-239">For each `appsettings` resource, add an  `"environment": "[parameters('slotName')]"` app setting toohello end of hello `properties` array.</span></span> <span data-ttu-id="95b88-240">Non dimenticare di riga precedente di hello tooend con una virgola.</span><span class="sxs-lookup"><span data-stu-id="95b88-240">Don't forget tooend hello previous line with a comma.</span></span>

    ![](./media/app-service-web-test-in-production-controlled-test-flight/06-arm-app-setting-with-slot-name.png)

    <span data-ttu-id="95b88-241">Si è appena aggiunto hello `environment` app impostazione tooall slot hello nel modello di hello.</span><span class="sxs-lookup"><span data-stu-id="95b88-241">You have just added hello `environment` app setting tooall hello slots in hello template.</span></span>
3. <span data-ttu-id="95b88-242">In hello stesso file, trovare hello `slotconfignames` risorse (cercare `"name": "slotconfignames"`).</span><span class="sxs-lookup"><span data-stu-id="95b88-242">In hello same file, find hello `slotconfignames` resources (search for `"name": "slotconfignames"`).</span></span> <span data-ttu-id="95b88-243">Ne sono disponibili 2, una per ogni app.</span><span class="sxs-lookup"><span data-stu-id="95b88-243">There are 2 of them, one for each app.</span></span>
4. <span data-ttu-id="95b88-244">Per ogni `slotconfignames` risorse, aggiungere `"environment"` toohello fine hello `appSettingNames` matrice.</span><span class="sxs-lookup"><span data-stu-id="95b88-244">For each `slotconfignames` resource, add `"environment"` toohello end of hello `appSettingNames` array.</span></span> <span data-ttu-id="95b88-245">Non dimenticare di riga precedente di hello tooend con una virgola.</span><span class="sxs-lookup"><span data-stu-id="95b88-245">Don't forget tooend hello previous line with a comma.</span></span>

    <span data-ttu-id="95b88-246">Sono state apportate hello `environment` app impostazione stick tooits rispettivi slot di distribuzione per entrambe le app.</span><span class="sxs-lookup"><span data-stu-id="95b88-246">You have just made hello `environment` app setting stick tooits respective deployment slot for both apps.</span></span>  
5. <span data-ttu-id="95b88-247">Nella sessione di Git Shell hello eseguire comandi che seguono con hello stesso suffisso di gruppo di risorse usato in precedenza.</span><span class="sxs-lookup"><span data-stu-id="95b88-247">In your Git Shell session, run hello following commands with hello same resource group suffix that you used before.</span></span>

        git checkout -b beta
        git push origin beta
        .\deploy.ps1 -RepoUrl https://github.com/<your_fork>/ToDoApp.git -ResourceGroupSuffix <your_suffix> -SlotName beta -Branch beta
6. <span data-ttu-id="95b88-248">Quando richiesto, specificare hello stesse credenziali di database SQL come prima.</span><span class="sxs-lookup"><span data-stu-id="95b88-248">When prompted, specify hello same SQL database credentials as before.</span></span> <span data-ttu-id="95b88-249">Quindi, quando richiesto tooupdate hello gruppo di risorse tipo `Y`, quindi `ENTER`.</span><span class="sxs-lookup"><span data-stu-id="95b88-249">Then, when asked tooupdate hello resource group, type `Y`, then `ENTER`.</span></span>

    <span data-ttu-id="95b88-250">Una volta al termine dello script hello, tutte le risorse nel gruppo di risorse hello originale vengono mantenute, ma un nuovo slot denominato "beta" è stato creato con hello stesso configurazione come slot di "Gestione temporanea" hello creato in inizio hello.</span><span class="sxs-lookup"><span data-stu-id="95b88-250">Once hello script finishes, all your resources in hello original resource group are retained, but a new slot named "beta" is created in it with hello same configuration as hello "Staging" slot that was created in hello beginning.</span></span>

   > [!NOTE]
   > <span data-ttu-id="95b88-251">Questo metodo di creazione di diversi ambienti di distribuzione è diverso dal metodo hello in [sviluppo Agile di software con il servizio App di Azure](app-service-agile-software-development.md).</span><span class="sxs-lookup"><span data-stu-id="95b88-251">This method of creating different deployment environments is different from hello method in [Agile software development with Azure App Service](app-service-agile-software-development.md).</span></span> <span data-ttu-id="95b88-252">Con questo metodo si creano ambienti di distribuzione con slot di distribuzione, mentre con l'altro si creano ambienti di distribuzione con gruppi di risorse.</span><span class="sxs-lookup"><span data-stu-id="95b88-252">Here, you create deployment environments with deployment slots, where as there you create deployment environments with resource groups.</span></span> <span data-ttu-id="95b88-253">La gestione di ambienti di distribuzione con gruppi di risorse consente toodevelopers ambiente di produzione hello tookeep off-limits, ma non è facile toodo test nell'ambiente di produzione, è possibile eseguire facilmente con gli slot.</span><span class="sxs-lookup"><span data-stu-id="95b88-253">Managing deployment environments with resource groups enables you tookeep hello production environment off-limits toodevelopers, but it's not easy toodo testing in production, which you can do easily with slots.</span></span>
   >
   >

<span data-ttu-id="95b88-254">Se necessario, è anche possibile creare un'app alfa con il codice seguente</span><span class="sxs-lookup"><span data-stu-id="95b88-254">If you wish, you can also create an alpha app by running</span></span>

    git checkout -b alpha
    git push origin alpha
    .\deploy.ps1 -RepoUrl https://github.com/<your_fork>/ToDoApp.git -ResourceGroupSuffix <your_suffix> -SlotName beta -Branch alpha

<span data-ttu-id="95b88-255">Per questa esercitazione si continuerà a usare l'app beta.</span><span class="sxs-lookup"><span data-stu-id="95b88-255">For this tutorial, you will just keep using your beta app.</span></span>

## <a name="update-push-your-updates-toohello-beta-app"></a><span data-ttu-id="95b88-256">Aggiornamento: Push app aggiornamenti toohello beta</span><span class="sxs-lookup"><span data-stu-id="95b88-256">Update: Push your updates toohello beta app</span></span>
<span data-ttu-id="95b88-257">Eseguire il backup tooyour app che si desidera tooimprove.</span><span class="sxs-lookup"><span data-stu-id="95b88-257">Back tooyour app that you want tooimprove.</span></span>

1. <span data-ttu-id="95b88-258">Verificare di trovarsi nel ramo beta</span><span class="sxs-lookup"><span data-stu-id="95b88-258">Make sure you're now in your beta branch</span></span>

        git checkout beta
2. <span data-ttu-id="95b88-259">In  *&lt;repository_root >*\src\MultiChannelToDo.Web\app\Index.cshtml, hello trova `<li>` tag e aggiungere hello `style="cursor:pointer"` attributo, come illustrato di seguito.</span><span class="sxs-lookup"><span data-stu-id="95b88-259">In *&lt;repository_root>*\src\MultiChannelToDo.Web\app\Index.cshtml, find hello `<li>` tag and add hello `style="cursor:pointer"` attribute, as shown below.</span></span>

    ![](./media/app-service-web-test-in-production-controlled-test-flight/07-change-cursor-style-on-li.png)
3. <span data-ttu-id="95b88-260">eseguire il commit e push tooAzure.</span><span class="sxs-lookup"><span data-stu-id="95b88-260">commit and push tooAzure.</span></span>
4. <span data-ttu-id="95b88-261">Verificare che la modifica hello viene ora rispecchiata nello slot beta hello passando toohttp://todoapp*&lt;your_suffix >*-beta.azurewebsites.net/.</span><span class="sxs-lookup"><span data-stu-id="95b88-261">Verify that hello change is now reflected in hello beta slot by navigating toohttp://todoapp*&lt;your_suffix>*-beta.azurewebsites.net/.</span></span> <span data-ttu-id="95b88-262">Se non viene visualizzato hello modificare ancora, aggiornare il codice di javascript nuovo browser tooget hello.</span><span class="sxs-lookup"><span data-stu-id="95b88-262">If you don't see hello change yet, refresh your browser tooget hello new javascript code.</span></span>

    ![](./media/app-service-web-test-in-production-controlled-test-flight/08-verify-change-in-beta-site.png)

<span data-ttu-id="95b88-263">Dopo aver creato la modifica in esecuzione nello slot di hello beta, si è pronti tooperform una distribuzione flighting.</span><span class="sxs-lookup"><span data-stu-id="95b88-263">Now that you have your change running in hello beta slot, you are ready tooperform a flighting deployment.</span></span>

## <a name="validate-route-traffic-toohello-beta-app"></a><span data-ttu-id="95b88-264">Convalida: Route traffico toohello app beta</span><span class="sxs-lookup"><span data-stu-id="95b88-264">Validate: Route traffic toohello beta app</span></span>
<span data-ttu-id="95b88-265">In questa sezione, si indirizza il traffico toohello beta app.</span><span class="sxs-lookup"><span data-stu-id="95b88-265">In this section, you will route traffic toohello beta app.</span></span> <span data-ttu-id="95b88-266">Ai fini del, semplicità della dimostrazione, si userà una parte significativa dei hello utente traffico tooit tooroute.</span><span class="sxs-lookup"><span data-stu-id="95b88-266">For sake of clarity of demonstration, you're going tooroute a significant portion of hello user traffic tooit.</span></span> <span data-ttu-id="95b88-267">In realtà, hello quantità di traffico che si desidera tooroute dipenderanno dalla situazione specifica.</span><span class="sxs-lookup"><span data-stu-id="95b88-267">In reality, hello amount of traffic you want tooroute will depend on your specific situation.</span></span> <span data-ttu-id="95b88-268">Ad esempio, se il sito è su larga scala hello Microsoft.com, si potrebbe essere minore di 1% del traffico totale in dati utili toogain di ordine.</span><span class="sxs-lookup"><span data-stu-id="95b88-268">For example, if your site is at hello scale of microsoft.com, then you may need less than one percent of your total traffic in order toogain useful data.</span></span>

1. <span data-ttu-id="95b88-269">Nella sessione della Git Shell, eseguire hello seguenti comandi tooroute metà dello slot di hello produzione traffico toohello beta:</span><span class="sxs-lookup"><span data-stu-id="95b88-269">In your Git Shell session, run hello following commands tooroute half of hello production traffic toohello beta slot:</span></span>

        $siteName = "ToDoApp<your suffix>"
        $rule = New-Object Microsoft.WindowsAzure.Commands.Utilities.Websites.Services.WebEntities.RampUpRule
        $rule.ActionHostName = "$siteName-beta.azurewebsites.net"
        $rule.ReroutePercentage = 50
        $rule.Name = "beta"
        Set-AzureWebsite $siteName -Slot Production -RoutingRules $rule

   <span data-ttu-id="95b88-270">Hello `ReroutePercentage=50` proprietà specifica che 50% di traffico di produzione hello sarà l'URL dell'app toohello indirizzato beta (specificato da hello `ActionHostName` proprietà).</span><span class="sxs-lookup"><span data-stu-id="95b88-270">hello `ReroutePercentage=50` property specifies that 50% of hello production traffic will be routed toohello beta app's URL (specified by hello `ActionHostName` property).</span></span>
2. <span data-ttu-id="95b88-271">Passare ora toohttp://ToDoApp*&lt;your_suffix >*. azurewebsites.net.</span><span class="sxs-lookup"><span data-stu-id="95b88-271">Now navigate toohttp://ToDoApp*&lt;your_suffix>*.azurewebsites.net.</span></span> <span data-ttu-id="95b88-272">50% di traffico hello dovrebbe ora essere slot beta toohello reindirizzato.</span><span class="sxs-lookup"><span data-stu-id="95b88-272">50% of hello traffic should now be redirected toohello beta slot.</span></span>
3. <span data-ttu-id="95b88-273">Nella risorsa di Application Insights, filtrare le metriche hello dall'ambiente = "beta".</span><span class="sxs-lookup"><span data-stu-id="95b88-273">In your Application Insights resource, filter hello metrics by environment="beta".</span></span>

   > [!NOTE]
   > <span data-ttu-id="95b88-274">Se si salva questa visualizzazione filtrata come preferito di un'altra, è possibile scorrere facilmente viste di Esplora metriche hello tra produzione e le viste beta.</span><span class="sxs-lookup"><span data-stu-id="95b88-274">If you save this filtered view as another favorite, then you can easily flip hello metric explorer views between production and beta views.</span></span>
   >
   >

<span data-ttu-id="95b88-275">Si supponga che in Application Insights viene visualizzato un codice simile toohello seguenti:</span><span class="sxs-lookup"><span data-stu-id="95b88-275">Suppose in Application Insights you see something similar toohello following:</span></span>

![](./media/app-service-web-test-in-production-controlled-test-flight/09-test-beta-site-in-production.png)

<span data-ttu-id="95b88-276">Non solo è questa visualizzazione sono presenti molti più clic su hello `<li>` tag, ma ci toobe un aumento del mouse su `<li>` tag.</span><span class="sxs-lookup"><span data-stu-id="95b88-276">Not only is this showing that there are many more clicks on hello `<li>` tags, but there seems toobe a surge of clicks on `<li>` tags.</span></span> <span data-ttu-id="95b88-277">È quindi possibile concludere che gli utenti sono individuati hello nuovo `<li>` i tag sono selezionabili e sta ora cancellando tutte le attività già completati nell'app hello.</span><span class="sxs-lookup"><span data-stu-id="95b88-277">You can then conclude that people have discovered hello new `<li>` tags are clickable and are now clearing all their previously-completed tasks in hello app.</span></span>

<span data-ttu-id="95b88-278">In base ai dati di hello della distribuzione flighting, si può decidere che la nuova interfaccia utente è pronto per la produzione.</span><span class="sxs-lookup"><span data-stu-id="95b88-278">Based on hello data of your flighting deployment, you decide that your new UI is ready for production.</span></span>

## <a name="go-live-move-your-new-code-into-production"></a><span data-ttu-id="95b88-279">Passare alla fase operativa: spostare di nuovo codice nell'ambiente di produzione</span><span class="sxs-lookup"><span data-stu-id="95b88-279">Go live: Move your new code into production</span></span>
<span data-ttu-id="95b88-280">Si è ora pronto toomove tooproduction l'aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="95b88-280">You're now ready toomove your update tooproduction.</span></span> <span data-ttu-id="95b88-281">Che cos'è ideale è che ora si è certi che l'aggiornamento è già stato convalidato *prima* esso viene inserito tooproduction.</span><span class="sxs-lookup"><span data-stu-id="95b88-281">What's great is that now you know that your update has already been validated *before* it is pushed tooproduction.</span></span> <span data-ttu-id="95b88-282">A questo punto è possibile distribuirlo.</span><span class="sxs-lookup"><span data-stu-id="95b88-282">So now you can confidently deploy it.</span></span> <span data-ttu-id="95b88-283">Poiché è stata effettuata un'app client di aggiornamento toohello AngularJS, codice lato client hello convalidati solo.</span><span class="sxs-lookup"><span data-stu-id="95b88-283">Since you made an update toohello AngularJS client app, you only validated hello client-side code.</span></span> <span data-ttu-id="95b88-284">Se si toomake modifiche toohello back-end Web app per le API, è possibile convalidare le modifiche allo stesso modo semplice e rapido.</span><span class="sxs-lookup"><span data-stu-id="95b88-284">If you were toomake changes toohello back-end Web API app, you could validate your changes similarly and easily.</span></span>

1. <span data-ttu-id="95b88-285">Nella Shell di Git, rimuovere regola di routing del traffico hello eseguendo hello comando seguente:</span><span class="sxs-lookup"><span data-stu-id="95b88-285">In Git Shell, remove hello traffic routing rule by running hello following command:</span></span>

        Set-AzureWebsite $siteName -Slot Production -RoutingRules @()
2. <span data-ttu-id="95b88-286">Eseguire i comandi Git hello:</span><span class="sxs-lookup"><span data-stu-id="95b88-286">Run hello Git commands:</span></span>

        git checkout master
        git pull origin master
        git merge beta
        git push origin master
3. <span data-ttu-id="95b88-287">Attendere alcuni minuti per hello nuovo codice toohello toobe distribuito nello slot di gestione temporanea, quindi avviare http://ToDoApp*&lt;your_suffix >*-tooverify staging.azurewebsites.net che hello nuovo aggiornamento è stato riscaldato in gestione temporanea hello slot.</span><span class="sxs-lookup"><span data-stu-id="95b88-287">Wait for a few minutes for hello new code toobe deployed toohello staging slot, then launch http://ToDoApp*&lt;your_suffix>*-staging.azurewebsites.net tooverify that hello new update is warmed up in hello staging slot.</span></span> <span data-ttu-id="95b88-288">Tenere presente che hello ramo master di divisione è collegato a gestione temporanea toohello slot dell'app.</span><span class="sxs-lookup"><span data-stu-id="95b88-288">Remember that hello your fork's master branch is linked toohello staging slot of your app.</span></span>
4. <span data-ttu-id="95b88-289">Ora, scambio hello slot di gestione temporanea nell'ambiente di produzione</span><span class="sxs-lookup"><span data-stu-id="95b88-289">Now, swap hello staging slot into production</span></span>

        cd <ROOT>\ToDoApp\ARMTemplates
        .\swap.ps1 -Name todoapp<your_suffix>

## <a name="summary"></a><span data-ttu-id="95b88-290">Riepilogo</span><span class="sxs-lookup"><span data-stu-id="95b88-290">Summary</span></span>
<span data-ttu-id="95b88-291">Servizio App di Azure semplifica per le aziende toomedium-piccola tootest delle App per i clienti nell'ambiente di produzione, che in genere eseguito in grandi aziende.</span><span class="sxs-lookup"><span data-stu-id="95b88-291">Azure App Service makes it easy for small- toomedium-sized businesses tootest their customer-facing apps in production, something that has been traditionally done in big enterprises.</span></span> <span data-ttu-id="95b88-292">Probabilmente questa esercitazione è state ricevute hello conoscenze necessarie toobring insieme Application Insights e servizio App toomake possibili anteprima scenari di distribuzione e anche altri test in produzione, il mondo DevOps.</span><span class="sxs-lookup"><span data-stu-id="95b88-292">Hopefully, this tutorial has given you hello knowledge you need toobring together App Service and Application Insights toomake possible flighting deployment, and even other test-in-production scenarios, in your DevOps world.</span></span>

## <a name="more-resources"></a><span data-ttu-id="95b88-293">Altre risorse</span><span class="sxs-lookup"><span data-stu-id="95b88-293">More resources</span></span>
* [<span data-ttu-id="95b88-294">Agile Software Development con il servizio app di Azure</span><span class="sxs-lookup"><span data-stu-id="95b88-294">Agile software development with Azure App Service</span></span>](app-service-agile-software-development.md)
* [<span data-ttu-id="95b88-295">Configurare ambienti di staging per le app Web nel servizio app di Azure</span><span class="sxs-lookup"><span data-stu-id="95b88-295">Set up staging environments for web apps in Azure App Service</span></span>](web-sites-staged-publishing.md)
* [<span data-ttu-id="95b88-296">Distribuire un'applicazione complessa in modo prevedibile in Azure</span><span class="sxs-lookup"><span data-stu-id="95b88-296">Deploy a complex application predictably in Azure</span></span>](app-service-deploy-complex-application-predictably.md)
* [<span data-ttu-id="95b88-297">Creazione di modelli di Gestione risorse di Azure</span><span class="sxs-lookup"><span data-stu-id="95b88-297">Authoring Azure Resource Manager Templates</span></span>](../azure-resource-manager/resource-group-authoring-templates.md)
* [<span data-ttu-id="95b88-298">JSONLint - hello Validator JSON</span><span class="sxs-lookup"><span data-stu-id="95b88-298">JSONLint - hello JSON Validator</span></span>](http://jsonlint.com/)
* [<span data-ttu-id="95b88-299">Diramazione Git - Diramazione e unione di base</span><span class="sxs-lookup"><span data-stu-id="95b88-299">Git Branching – Basic Branching and Merging</span></span>](http://www.git-scm.com/book/en/v2/Git-Branching-Basic-Branching-and-Merging)
* [<span data-ttu-id="95b88-300">Azure PowerShell</span><span class="sxs-lookup"><span data-stu-id="95b88-300">Azure PowerShell</span></span>](/powershell/azure/overview)
* [<span data-ttu-id="95b88-301">Wiki del progetto Kudu</span><span class="sxs-lookup"><span data-stu-id="95b88-301">Project Kudu Wiki</span></span>](https://github.com/projectkudu/kudu/wiki)
