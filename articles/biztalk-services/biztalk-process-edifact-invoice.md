---
title: 'Esercitazione: Elaborare fatture EDIFACT con Servizi BizTalk di Azure | Documentazione Microsoft'
description: Come creare e configurare l'app per le API o il connettore Box e usarlo in un'app per la logica in Azure App Service
services: biztalk-services
documentationcenter: .net,nodejs,java
author: msftman
manager: erikre
editor: 
ms.assetid: 7e0b93fa-3e2b-4a9c-89ef-abf1d3aa8fa9
ms.service: biztalk-services
ms.devlang: multiple
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: integration
ms.date: 05/31/2016
ms.author: deonhe
ms.openlocfilehash: 4597ee28e4c3b797c0ab050b21a126a95d9e8191
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/03/2017
---
# <a name="tutorial-process-edifact-invoices-using-azure-biztalk-services"></a><span data-ttu-id="47bfb-103">Esercitazione: Elaborare fatture EDIFACT con Servizi BizTalk di Azure</span><span class="sxs-lookup"><span data-stu-id="47bfb-103">Tutorial: Process EDIFACT invoices using Azure BizTalk Services</span></span>

> [!INCLUDE [BizTalk Services is being retired, and replaced with Azure Logic Apps](../../includes/biztalk-services-retirement.md)]

<span data-ttu-id="47bfb-104">È possibile utilizzare il portale Servizi BizTalk per configurare e distribuire accordi EDIFACT e X12.</span><span class="sxs-lookup"><span data-stu-id="47bfb-104">You can use the BizTalk Services Portal to configure and deploy X12 and EDIFACT agreements.</span></span> <span data-ttu-id="47bfb-105">In questa esercitazione viene illustrato come creare un accordo EDIFACT per lo scambio di fatture tra partner commerciali.</span><span class="sxs-lookup"><span data-stu-id="47bfb-105">In this tutorial, we look at how to create an EDIFACT agreement for exchanging invoices between trading partners.</span></span> <span data-ttu-id="47bfb-106">L'esercitazione è relativa a una soluzione aziendale end-to-end che coinvolge due partner commerciali, Northwind e Contoso, che si scambiano messaggi EDIFAC.</span><span class="sxs-lookup"><span data-stu-id="47bfb-106">This tutorial is written around an end-to-end business solution involving two trading partners, Northwind and Contoso that exchange EDIFACT messages.</span></span>  

## <a name="sample-based-on-this-tutorial"></a><span data-ttu-id="47bfb-107">Esempio basato su questa esercitazione</span><span class="sxs-lookup"><span data-stu-id="47bfb-107">Sample based on this tutorial</span></span>
<span data-ttu-id="47bfb-108">Questa esercitazione è stata scritta in base a un esempio, **Sending EDIFACT Invoices Using BizTalk Services** (Invio di fatture EDIFACT con Servizi BizTalk), disponibile per il download in [MSDN Code Gallery](http://go.microsoft.com/fwlink/?LinkId=401005).</span><span class="sxs-lookup"><span data-stu-id="47bfb-108">This tutorial is written around a sample, **Sending EDIFACT Invoices Using BizTalk Services**, which is available to download from the [MSDN Code Gallery](http://go.microsoft.com/fwlink/?LinkId=401005).</span></span> <span data-ttu-id="47bfb-109">È possibile usare l'esempio e scorrere questa esercitazione per comprendere come è stato creato</span><span class="sxs-lookup"><span data-stu-id="47bfb-109">You could use the sample and go through this tutorial to understand how the sample was built.</span></span> <span data-ttu-id="47bfb-110">oppure usare l'esercitazione per creare la propria soluzione.</span><span class="sxs-lookup"><span data-stu-id="47bfb-110">Or, you could use this tutorial to create your own solution ground-up.</span></span> <span data-ttu-id="47bfb-111">Questa esercitazione è mirata al secondo approccio, in modo che si possa comprendere come è stata creata questa soluzione.</span><span class="sxs-lookup"><span data-stu-id="47bfb-111">This tutorial is targeted towards the second approach so that you understand how this solution was built.</span></span> <span data-ttu-id="47bfb-112">Inoltre, per quanto possibile, l'esercitazione è coerente con l'esempio e usa gli stessi nomi per gli elementi (ad esempio schemi e trasformazioni).</span><span class="sxs-lookup"><span data-stu-id="47bfb-112">Also, as much as possible, the tutorial is consistent with the sample and uses the same names for artifacts (for example, schemas, transforms) as used in the sample.</span></span>  

> [!NOTE]
> <span data-ttu-id="47bfb-113">Poiché questa soluzione prevede l'invio di un messaggio da un bridge EAI a un bridge EDI, riusa l' [esempio di concatenamento di bridge di Servizi BizTalk](http://code.msdn.microsoft.com/BizTalk-Bridge-chaining-2246b104) .</span><span class="sxs-lookup"><span data-stu-id="47bfb-113">Because this solution involves sending a message from an EAI bridge to an EDI bridge, it reuses the [BizTalk Services Bridge chaining sample](http://code.msdn.microsoft.com/BizTalk-Bridge-chaining-2246b104) sample.</span></span>  
> 
> 

## <a name="what-does-the-solution-do"></a><span data-ttu-id="47bfb-114">Scopo della soluzione</span><span class="sxs-lookup"><span data-stu-id="47bfb-114">What does the solution do?</span></span>
<span data-ttu-id="47bfb-115">In questa soluzione Northwind riceve da Contoso fatture EDIFACT</span><span class="sxs-lookup"><span data-stu-id="47bfb-115">In this solution, Northwind receives EDIFACT invoices from Contoso.</span></span> <span data-ttu-id="47bfb-116">che non sono in un formato EDI standard.</span><span class="sxs-lookup"><span data-stu-id="47bfb-116">These invoices are not in a standard EDI format.</span></span> <span data-ttu-id="47bfb-117">Pertanto, prima dell'invio a Northwind, una fattura deve essere convertita in un documento fattura EDIFACT (nota anche come INVOIC).</span><span class="sxs-lookup"><span data-stu-id="47bfb-117">So, before sending the invoice to Northwind, it must be transformed to an EDIFACT invoice (also called INVOIC) document.</span></span> <span data-ttu-id="47bfb-118">Alla ricezione, Northwind deve elaborare la fattura EDIFACT e restituire a Contoso un messaggio di controllo (noto anche come CONTRL).</span><span class="sxs-lookup"><span data-stu-id="47bfb-118">On receipt, Northwind must process the EDIFACT invoice, and return a control message (also called CONTRL) to Contoso.</span></span>

![][1]  

<span data-ttu-id="47bfb-119">Per ottenere questo scenario aziendale, Contoso usa le funzionalità fornite con Servizi BizTalk di Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="47bfb-119">To achieve this business scenario, Contoso uses the features provided with Microsoft Azure BizTalk Services.</span></span>

* <span data-ttu-id="47bfb-120">Contoso usa bridge EAI per convertire la fattura originale in INVOIC EDIFACT.</span><span class="sxs-lookup"><span data-stu-id="47bfb-120">Contoso uses EAI bridges to transform the original invoice to EDIFACT INVOIC.</span></span>
* <span data-ttu-id="47bfb-121">Il bridge EAI quindi invia il messaggio a un bridge di trasmissione EDI distribuito come parte di un accordo configurato nel portale Servizi BizTalk.</span><span class="sxs-lookup"><span data-stu-id="47bfb-121">The EAI bridge then sends the message to an EDI send bridge deployed as part of an agreement configured in the BizTalk Services Portal.</span></span>
* <span data-ttu-id="47bfb-122">Il bridge di trasmissione EDI elabora la fattura INVOIC EDIFACT e la instrada a Northwind.</span><span class="sxs-lookup"><span data-stu-id="47bfb-122">The EDI send bridge processes the EDIFACT INVOIC and routes it to Northwind.</span></span>
* <span data-ttu-id="47bfb-123">Dopo aver ricevuto la fattura, Northwind restituisce un messaggio CONTRL al bridge di ricezione EDI distribuito come parte dell'accordo.</span><span class="sxs-lookup"><span data-stu-id="47bfb-123">After receiving the invoice, Northwind returns a CONTRL message to the EDI receive bridge deployed as part of the agreement.</span></span>  

> [!NOTE]
> <span data-ttu-id="47bfb-124">Facoltativamente, questa soluzione illustra anche come usare l'invio in batch per trasmettere le fatture in batch anziché singolarmente.</span><span class="sxs-lookup"><span data-stu-id="47bfb-124">Optionally, this solution also demonstrates how to use batching to send the invoices in batches, instead of sending each invoice separately.</span></span>  
> 
> 

<span data-ttu-id="47bfb-125">Per completare lo scenario, vengono usate code di bus di servizio per inviare la fattura da Contoso a Northwind o ricevere un acknowledgement da Northwind.</span><span class="sxs-lookup"><span data-stu-id="47bfb-125">To complete the scenario, we use Service Bus queues to send invoice from Contoso to Northwind or receive acknowledgement from Northwind.</span></span> <span data-ttu-id="47bfb-126">Queste code possono essere create usando un'applicazione client, disponibile come download e inclusa nel pacchetto di esempio fornito come parte dell'esercitazione.</span><span class="sxs-lookup"><span data-stu-id="47bfb-126">These queues can be created using a client application, which is available as a download and is included in the sample package that is available as part of this tutorial.</span></span>  

## <a name="prerequisites"></a><span data-ttu-id="47bfb-127">Prerequisiti</span><span class="sxs-lookup"><span data-stu-id="47bfb-127">Prerequisites</span></span>
* <span data-ttu-id="47bfb-128">È necessario disporre di uno spazio dei nomi di bus di servizio.</span><span class="sxs-lookup"><span data-stu-id="47bfb-128">You must have a Service Bus namespace.</span></span> <span data-ttu-id="47bfb-129">Per istruzioni sulla creazione di uno spazio dei nomi, vedere [Procedura: Creare o modificare uno spazio dei nomi del servizio del bus di servizio](https://msdn.microsoft.com/library/azure/hh674478.aspx).</span><span class="sxs-lookup"><span data-stu-id="47bfb-129">For instructions on creating a namespace, see [How To: Create or Modify a Service Bus Service Namespace](https://msdn.microsoft.com/library/azure/hh674478.aspx).</span></span> <span data-ttu-id="47bfb-130">Si supponga di aver già effettuato il provisioning di uno spazio dei nomi di bus di servizio, denominato **edifactbts**.</span><span class="sxs-lookup"><span data-stu-id="47bfb-130">Let us assume that you already have a Service Bus namespace provisioned, called **edifactbts**.</span></span>
* <span data-ttu-id="47bfb-131">È necessario disporre di una sottoscrizione a Servizi BizTalk.</span><span class="sxs-lookup"><span data-stu-id="47bfb-131">You must have a BizTalk Services subscription.</span></span> <span data-ttu-id="47bfb-132">Per le istruzioni, vedere [Creazione di servizi BizTalk tramite il portale di Azure](http://go.microsoft.com/fwlink/?LinkID=302280).</span><span class="sxs-lookup"><span data-stu-id="47bfb-132">For instructions, see [Create a BizTalk Service using Azure classic portal](http://go.microsoft.com/fwlink/?LinkID=302280).</span></span> <span data-ttu-id="47bfb-133">Per questa esercitazione, si supponga di avere una sottoscrizione a Servizi BizTalk, denominata **contosowabs**.</span><span class="sxs-lookup"><span data-stu-id="47bfb-133">For this tutorial, let us assume you have a BizTalk Services subscription, called **contosowabs**.</span></span>
* <span data-ttu-id="47bfb-134">Registrare la propria sottoscrizione a Servizi BizTalk nel portale di Servizi BizTalk.</span><span class="sxs-lookup"><span data-stu-id="47bfb-134">Register your BizTalk Services subscription on the BizTalk Services Portal.</span></span> <span data-ttu-id="47bfb-135">Per istruzioni, vedere [Registrazione e aggiornamento di una distribuzione del servizio BizTalk nel portale dei servizi BizTalk](https://msdn.microsoft.com/library/hh689837.aspx)</span><span class="sxs-lookup"><span data-stu-id="47bfb-135">For instructions, see [Registering a BizTalk Service Deployment on the BizTalk Services Portal](https://msdn.microsoft.com/library/hh689837.aspx)</span></span>
* <span data-ttu-id="47bfb-136">È necessario aver installato Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="47bfb-136">You must have Visual Studio installed.</span></span>
* <span data-ttu-id="47bfb-137">È necessario aver installato BizTalk Services SDK.</span><span class="sxs-lookup"><span data-stu-id="47bfb-137">You must have BizTalk Services SDK installed.</span></span> <span data-ttu-id="47bfb-138">È possibile scaricare l'SDK dal sito Web all'indirizzo [http://go.microsoft.com/fwlink/?LinkId=235057](http://go.microsoft.com/fwlink/?LinkId=235057)</span><span class="sxs-lookup"><span data-stu-id="47bfb-138">You can download the SDK from [http://go.microsoft.com/fwlink/?LinkId=235057](http://go.microsoft.com/fwlink/?LinkId=235057)</span></span>  

## <a name="step-1-create-the-service-bus-queues"></a><span data-ttu-id="47bfb-139">Passaggio 1: creare le code del bus di servizio</span><span class="sxs-lookup"><span data-stu-id="47bfb-139">Step 1: Create the Service Bus queues</span></span>
<span data-ttu-id="47bfb-140">Questa soluzione usa code di bus di servizio per lo scambio di messaggi tra i partner commerciali.</span><span class="sxs-lookup"><span data-stu-id="47bfb-140">This solution uses Service Bus queues to exchange messages between trading partners.</span></span> <span data-ttu-id="47bfb-141">Contoso e Northwind inviano messaggi alle code, da dove vengono usati dai bridge EAI e/o EDI.</span><span class="sxs-lookup"><span data-stu-id="47bfb-141">Contoso and Northwind send messages to the queues from where the EAI and/or EDI bridges consume them.</span></span> <span data-ttu-id="47bfb-142">Per questa soluzione, sono necessarie tre code del bus di servizio:</span><span class="sxs-lookup"><span data-stu-id="47bfb-142">For this solution, you need three Service Bus queues:</span></span>

* <span data-ttu-id="47bfb-143">**northwindreceive** : Northwind riceve la fattura da Contoso tramite questa coda.</span><span class="sxs-lookup"><span data-stu-id="47bfb-143">**northwindreceive** – Northwind receives the invoice from Contoso over this queue.</span></span>
* <span data-ttu-id="47bfb-144">**contosoreceive** : Contoso riceve l'acknowledgement da Northwind tramite questa coda.</span><span class="sxs-lookup"><span data-stu-id="47bfb-144">**contosoreceive** – Contoso receives the acknowledgement from Northwind over this queue.</span></span>
* <span data-ttu-id="47bfb-145">**suspended** – A questa coda vengono instradati tutti i messaggi sospesi.</span><span class="sxs-lookup"><span data-stu-id="47bfb-145">**suspended** – All suspended messages are routed to this queue.</span></span> <span data-ttu-id="47bfb-146">I messaggi vengono sospesi se presentano errori durante l'elaborazione.</span><span class="sxs-lookup"><span data-stu-id="47bfb-146">Messages are suspended if they fail during processing.</span></span>

<span data-ttu-id="47bfb-147">È possibile creare queste code di bus di servizio usando un'applicazione client inclusa nel pacchetto di esempio.</span><span class="sxs-lookup"><span data-stu-id="47bfb-147">You can create these Service Bus queues by using a client application included in the sample package.</span></span>  

1. <span data-ttu-id="47bfb-148">Dal percorso in cui è stato scaricato l'esempio, aprire **Tutorial Sending Invoices Using BizTalk Services EDI Bridges.sln**.</span><span class="sxs-lookup"><span data-stu-id="47bfb-148">From the location where you downloaded the sample, open **Tutorial Sending Invoices Using BizTalk Services EDI Bridges.sln**.</span></span>
2. <span data-ttu-id="47bfb-149">Premere **F5** per compilare e avviare l'applicazione **Tutorial Client** (Client esercitazione).</span><span class="sxs-lookup"><span data-stu-id="47bfb-149">Press **F5** to build and start the **Tutorial Client** application.</span></span>
3. <span data-ttu-id="47bfb-150">Nella schermata immettere lo spazio dei nomi, nonché il nome e la chiave dell'emittente ACS del bus di servizio.</span><span class="sxs-lookup"><span data-stu-id="47bfb-150">In the screen, enter the Service Bus ACS namespace, issuer name, and issuer key.</span></span>
   
   ![][2]  
4. <span data-ttu-id="47bfb-151">Un messaggio informa che verranno create tre code nello spazio dei nomi del bus di servizio.</span><span class="sxs-lookup"><span data-stu-id="47bfb-151">A message box prompts that three queues will be created in your Service Bus namespace.</span></span> <span data-ttu-id="47bfb-152">Fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="47bfb-152">Click **OK**.</span></span>
5. <span data-ttu-id="47bfb-153">Lasciare in esecuzione il client dell'esercitazione.</span><span class="sxs-lookup"><span data-stu-id="47bfb-153">Leave the Tutorial Client running.</span></span> <span data-ttu-id="47bfb-154">Aprire , fare clic su **Bus di servizio** > ***spazio dei nomi del bus di servizio*** > **Code** e verificare che le tre code siano state create.</span><span class="sxs-lookup"><span data-stu-id="47bfb-154">Open the , click **Service Bus** > ***your Service Bus namespace*** > **Queues**, and verify that the three queues are created.</span></span>  

## <a name="step-2-create-and-deploy-trading-partner-agreement"></a><span data-ttu-id="47bfb-155">Passaggio 2: creare e distribuire un contratto tra partner commerciali</span><span class="sxs-lookup"><span data-stu-id="47bfb-155">Step 2: Create and deploy trading partner agreement</span></span>
<span data-ttu-id="47bfb-156">Creare un accordo tra partner commerciali tra Contoso e Northwind.</span><span class="sxs-lookup"><span data-stu-id="47bfb-156">Create a trading partner agreement between Contoso and Northwind.</span></span> <span data-ttu-id="47bfb-157">Questo tipo di accordo definisce un contratto per gli scambi tra i due partner commerciali, ad esempio quale schema dei messaggi usare, quale protocollo di messaggistica applicare e così via. Un accordo tra partner commerciali include due bridge EDI, uno per inviare messaggi ai partner commerciali (denominato **bridge di trasmissione EDI**) e uno per ricevere messaggi dai partner commerciali (denominato **bridge di ricezione EDI**).</span><span class="sxs-lookup"><span data-stu-id="47bfb-157">A trading partner agreement defines a trade contract between the two business partners, such as which message schema to use, which messaging protocol to use, etc. A trading partner agreement includes two EDI bridges, one to send messages to trading partners (called the **EDI Send bridge**) and one to receive messages from trading partners (called the **EDI Receive bridge**).</span></span>

<span data-ttu-id="47bfb-158">Nel contesto di questa soluzione il bridge di trasmissione EDI corrisponde al lato invio dell'accordo e viene usato per inviare la fattura EDIFACT da Contoso a Northwind.</span><span class="sxs-lookup"><span data-stu-id="47bfb-158">In the context of this solution, the EDI send bridge corresponds to the send-side of the agreement and is used to send the EDIFACT invoice from Contoso to Northwind.</span></span> <span data-ttu-id="47bfb-159">Analogamente, il bridge di ricezione EDI corrisponde al lato ricezione dell'accordo e viene usato per ricevere gli acknowledgement da Northwind.</span><span class="sxs-lookup"><span data-stu-id="47bfb-159">Similarly, the EDI receive bridge corresponds to the receive-side of the agreement and is used to receive acknowledgements from Northwind.</span></span>  

### <a name="create-the-trading-partners"></a><span data-ttu-id="47bfb-160">Creare i partner commerciali</span><span class="sxs-lookup"><span data-stu-id="47bfb-160">Create the trading partners</span></span>
<span data-ttu-id="47bfb-161">Per iniziare, creare i partner commerciali per Contoso e Northwind.</span><span class="sxs-lookup"><span data-stu-id="47bfb-161">To start with, create trading partners for Contoso and Northwind.</span></span>  

1. <span data-ttu-id="47bfb-162">Nel portale di Servizi BizTalk fare clic su **Aggiungi** nella scheda **Partner**.</span><span class="sxs-lookup"><span data-stu-id="47bfb-162">In the BizTalk Services Portal, on the **Partners** tab, click **Add**.</span></span>
2. <span data-ttu-id="47bfb-163">Nella pagina Nuovo partner immettere **Contoso** come nome del partner, quindi fare clic su **Salva**.</span><span class="sxs-lookup"><span data-stu-id="47bfb-163">In the New partner page, enter **Contoso** as a partner name, and then click **Save**.</span></span>
3. <span data-ttu-id="47bfb-164">Ripetere il passaggio per creare il secondo partner, **Northwind**.</span><span class="sxs-lookup"><span data-stu-id="47bfb-164">Repeat the step to create the second partner, **Northwind**.</span></span>  

### <a name="create-the-agreement"></a><span data-ttu-id="47bfb-165">Creare il contratto</span><span class="sxs-lookup"><span data-stu-id="47bfb-165">Create the agreement</span></span>
<span data-ttu-id="47bfb-166">Gli accordi tra partner commerciali vengono creati tra i profili di business dei partner coinvolti.</span><span class="sxs-lookup"><span data-stu-id="47bfb-166">Trading partner agreements are created between business profiles of trading partners.</span></span> <span data-ttu-id="47bfb-167">Questa soluzione usa i profili di partner predefiniti creati automaticamente quando sono stati creati i partner.</span><span class="sxs-lookup"><span data-stu-id="47bfb-167">This solution uses the default partner profiles that are automatically created when we created the partners.</span></span>  

1. <span data-ttu-id="47bfb-168">Nel portale di Servizi BizTalk fare clic su **Contratti** > **Aggiungi**.</span><span class="sxs-lookup"><span data-stu-id="47bfb-168">In the BizTalk Services Portal, click **Agreements** > **Add**.</span></span>
2. <span data-ttu-id="47bfb-169">Nella pagina **Impostazioni generali** del nuovo accordo specificare i valori mostrati nell'immagine seguente, quindi fare clic su **Continua**.</span><span class="sxs-lookup"><span data-stu-id="47bfb-169">In the new agreement’s **General Settings** page, specify the values as shown in the image below, and then click **Continue**.</span></span>
   
   ![][3]  
   
   <span data-ttu-id="47bfb-170">Dopo avere fatto clic su **Continua**, diventano disponibili due schede, **Impostazioni di ricezione** e **Impostazioni di invio**.</span><span class="sxs-lookup"><span data-stu-id="47bfb-170">After you click **Continue**, two tabs, **Receive Settings** and **Send Settings** become available.</span></span>
3. <span data-ttu-id="47bfb-171">Creare l'accordo di invio tra Contoso e Northwind.</span><span class="sxs-lookup"><span data-stu-id="47bfb-171">Create the send agreement between Contoso and Northwind.</span></span> <span data-ttu-id="47bfb-172">Questo accordo definisce le modalità con cui Contoso invia la fattura EDIFACT a Northwind.</span><span class="sxs-lookup"><span data-stu-id="47bfb-172">This agreement governs how Contoso sends the EDIFACT invoice to Northwind.</span></span>
   
   1. <span data-ttu-id="47bfb-173">Fare clic su **Send Settings**.</span><span class="sxs-lookup"><span data-stu-id="47bfb-173">Click **Send Settings**.</span></span>
   2. <span data-ttu-id="47bfb-174">Mantenere i valori predefiniti nelle schede **Inbound URL** (URL in ingresso), **Trasforma** e **Batch**.</span><span class="sxs-lookup"><span data-stu-id="47bfb-174">Retain the default values on the **Inbound URL**, **Transform**, and **Batching** tabs.</span></span>
   3. <span data-ttu-id="47bfb-175">Nella scheda **Protocollo** caricare lo schema **EFACT_D93A_INVOIC.xsd** nella sezione **Schemi**.</span><span class="sxs-lookup"><span data-stu-id="47bfb-175">On the **Protocol** tab, under the **Schemas** section, upload the **EFACT_D93A_INVOIC.xsd** schema.</span></span> <span data-ttu-id="47bfb-176">Questo schema è disponibile con il pacchetto di esempio.</span><span class="sxs-lookup"><span data-stu-id="47bfb-176">This schema is available with the sample package.</span></span>
      
      ![][4]  
   4. <span data-ttu-id="47bfb-177">Nella scheda **Trasporto** specificare i dettagli delle code del bus di servizio.</span><span class="sxs-lookup"><span data-stu-id="47bfb-177">On the **Transport** tab, specify the details for the Service Bus queues.</span></span> <span data-ttu-id="47bfb-178">Per l'accordo sul lato invio, viene usata la coda **northwindreceive** per inviare la fattura EDIFACT a Northwind, mentre la coda **suspended** viene usata per instradare gli eventuali messaggi che presentano problemi durante l'elaborazione e vengono sospesi.</span><span class="sxs-lookup"><span data-stu-id="47bfb-178">For the send-side agreement, we use the **northwindreceive** queue to send the EDIFACT invoice to Northwind, and the **suspended** queue to route any messages that fail during processing and are suspended.</span></span> <span data-ttu-id="47bfb-179">Queste code sono state create nel **Passaggio 1: Creare le code del bus di servizio** di questo argomento.</span><span class="sxs-lookup"><span data-stu-id="47bfb-179">You created these queues in **Step 1: Create the Service Bus queues** (in this topic).</span></span>
      
      ![][5]  
      
      <span data-ttu-id="47bfb-180">In **Impostazioni trasporto > Tipo trasporto** e in **Message Suspension Settings (Impostazioni di sospensione messaggi) > Tipo trasporto** selezionare Bus di servizio di Azure e specificare i valori mostrati nell'immagine.</span><span class="sxs-lookup"><span data-stu-id="47bfb-180">Under **Transport Settings > Transport type** and **Message Suspension Settings > Transport type**, select Azure Service Bus and provide the values as shown in the image.</span></span>
4. <span data-ttu-id="47bfb-181">Creare l'accordo di ricezione tra Contoso e Northwind.</span><span class="sxs-lookup"><span data-stu-id="47bfb-181">Create the receive agreement between Contoso and Northwind.</span></span> <span data-ttu-id="47bfb-182">Questo accordo definisce le modalità con cui Contoso riceve l'acknowledgement da Northwind.</span><span class="sxs-lookup"><span data-stu-id="47bfb-182">This agreement governs how Contoso receives the acknowledgement from Northwind.</span></span>
   
   1. <span data-ttu-id="47bfb-183">Fare clic su **Receive Settings**.</span><span class="sxs-lookup"><span data-stu-id="47bfb-183">Click **Receive Settings**.</span></span>
   2. <span data-ttu-id="47bfb-184">Mantenere i valori predefiniti nelle schede **Trasporto** e **Trasforma**.</span><span class="sxs-lookup"><span data-stu-id="47bfb-184">Retain the default values on the **Transport** and **Transform** tabs.</span></span>
   3. <span data-ttu-id="47bfb-185">Nella scheda **Protocollo** caricare lo schema **EFACT_4.1_CONTRL.xsd** nella sezione **Schemi**.</span><span class="sxs-lookup"><span data-stu-id="47bfb-185">On the **Protocol** tab, under the **Schemas** section, upload the **EFACT_4.1_CONTRL.xsd** schema.</span></span> <span data-ttu-id="47bfb-186">Questo schema è disponibile con il pacchetto di esempio.</span><span class="sxs-lookup"><span data-stu-id="47bfb-186">This schema is available with the sample package.</span></span>
   4. <span data-ttu-id="47bfb-187">Nella scheda **Route** creare un filtro per assicurarsi che a Contoso vengano instradati solo gli acknowledgement di Northwind.</span><span class="sxs-lookup"><span data-stu-id="47bfb-187">On the **Route** tab, create a filter to ensure that only acknowledgements from Northwind are routed to Contoso.</span></span> <span data-ttu-id="47bfb-188">In **Route Settings** (Impostazioni route) fare clic su **Aggiungi** per creare il filtro di routing.</span><span class="sxs-lookup"><span data-stu-id="47bfb-188">Under **Route Settings**, click **Add** to create the routing filter.</span></span>
      
      ![][6]  
      
      1. <span data-ttu-id="47bfb-189">Nei campi **Nome regola**, **Route rule** (Regola route) e **Route destination** (Destinazione route) specificare i valori mostrati nell'immagine.</span><span class="sxs-lookup"><span data-stu-id="47bfb-189">Provide values for **Rule Name**, **Route rule**, and **Route destination** as shown in the image.</span></span>
      2. <span data-ttu-id="47bfb-190">Fare clic su **Salva**.</span><span class="sxs-lookup"><span data-stu-id="47bfb-190">Click **Save**.</span></span>
   5. <span data-ttu-id="47bfb-191">Sempre nella scheda **Route** , specificare dove devono essere instradati gli acknowledgement sospesi, ossia gli acknowledgement che presentano problemi durante l'elaborazione.</span><span class="sxs-lookup"><span data-stu-id="47bfb-191">On the **Route** tab again, specify where suspended acknowledgements (acknowledgements that fail during processing) are routed to.</span></span> <span data-ttu-id="47bfb-192">Impostare il tipo di trasporto su Bus di servizio di Azure, il tipo di destinazione route su **Coda**, il tipo di autenticazione su **Firma di accesso condiviso**, specificare la relativa stringa di connessione per lo spazio dei nomi di bus di servizio quindi immettere **suspended** come nome della coda.</span><span class="sxs-lookup"><span data-stu-id="47bfb-192">Set the transport type to Azure Service Bus, route destination type to **Queue**, authentication type to **Shared Access Signature** (SAS), provide the SAS connection string for the Service Bus namespace, and then enter the queue name as **suspended**.</span></span>
5. <span data-ttu-id="47bfb-193">Fare infine clic su **Distribuisci** per distribuire l'accordo.</span><span class="sxs-lookup"><span data-stu-id="47bfb-193">Finally, click **Deploy** to deploy the agreement.</span></span> <span data-ttu-id="47bfb-194">Notare gli endpoint in cui vengono distribuiti gli accordi di invio e ricezione.</span><span class="sxs-lookup"><span data-stu-id="47bfb-194">Note the endpoints where the send and receive agreements get deployed.</span></span>
   
   * <span data-ttu-id="47bfb-195">Nella scheda **Impostazioni di invio** prendere nota dell'endpoint in **Inbound URL** (URL in ingresso).</span><span class="sxs-lookup"><span data-stu-id="47bfb-195">On the **Send Settings** tab, under **Inbound URL**, note the endpoint.</span></span> <span data-ttu-id="47bfb-196">Per inviare un messaggio da Contoso a Northwind usando il bridge di trasmissione EDI è necessario inviare un messaggio a questo endpoint.</span><span class="sxs-lookup"><span data-stu-id="47bfb-196">To send a message from Contoso to Northwind using the EDI send bridge, you must send a message to this endpoint.</span></span>
   * <span data-ttu-id="47bfb-197">Nella scheda **Impostazioni di ricezione** prendere nota dell'endpoint in **Trasporto**.</span><span class="sxs-lookup"><span data-stu-id="47bfb-197">On the **Receive Settings** tab, under **Transport**, note the endpoint.</span></span> <span data-ttu-id="47bfb-198">Per inviare un messaggio da Northwind a Contoso usando il bridge di ricezione EDI è necessario inviare un messaggio a questo endpoint.</span><span class="sxs-lookup"><span data-stu-id="47bfb-198">To send a message from Northwind to Contoso using the EDI receive bridge, you must send a message to this endpoint.</span></span>  

## <a name="step-3-create-and-deploy-the-biztalk-services-project"></a><span data-ttu-id="47bfb-199">Passaggio 3: creare e distribuire il progetto di Servizi BizTalk</span><span class="sxs-lookup"><span data-stu-id="47bfb-199">Step 3: Create and deploy the BizTalk Services project</span></span>
<span data-ttu-id="47bfb-200">Nel passaggio precedente sono stati distribuiti gli accordi di invio e ricezione EDI per elaborare le fatture EDIFACT e gli acknowledgement.</span><span class="sxs-lookup"><span data-stu-id="47bfb-200">In the previous step, you deployed the EDI send and receive agreements to process EDIFACT invoices and acknowledgements.</span></span> <span data-ttu-id="47bfb-201">Questi accordi possono elaborare solo messaggi conformi allo schema EDIFACT standard.</span><span class="sxs-lookup"><span data-stu-id="47bfb-201">These agreements can only process messages that conform to the standard EDIFACT message schema.</span></span> <span data-ttu-id="47bfb-202">Tuttavia, in base allo scenario per questa soluzione, Contoso invia a Northwind una fattura in uno schema proprietario interno.</span><span class="sxs-lookup"><span data-stu-id="47bfb-202">However, per the scenario for this solution, Contoso sends an invoice to Northwind in an in-house proprietary schema.</span></span> <span data-ttu-id="47bfb-203">Pertanto, prima di essere inviato al bridge di trasmissione EDI, il messaggio deve essere convertito dallo schema interno allo schema di fattura EDIFACT standard.</span><span class="sxs-lookup"><span data-stu-id="47bfb-203">So, before the message is sent to the EDI send bridge, it must be transformed from the in-house schema to the standard EDIFACT invoice schema.</span></span> <span data-ttu-id="47bfb-204">Questa operazione viene eseguita dal progetto EAI di Servizi BizTalk.</span><span class="sxs-lookup"><span data-stu-id="47bfb-204">The BizTalk Services EAI project does that.</span></span>

<span data-ttu-id="47bfb-205">Anche il progetto di Servizi BizTalk, **InvoiceProcessingBridge**, che converte il messaggio, è incluso come parte dell'esempio scaricato.</span><span class="sxs-lookup"><span data-stu-id="47bfb-205">The BizTalk Services project, **InvoiceProcessingBridge**, that transforms the message is also included as part of the sample you downloaded.</span></span> <span data-ttu-id="47bfb-206">Il progetto contiene i seguenti elementi:</span><span class="sxs-lookup"><span data-stu-id="47bfb-206">The project includes the following artifacts:</span></span>

* <span data-ttu-id="47bfb-207">**INHOUSEINVOICE.XSD** :schema della fattura interna che viene inviata a Northwind.</span><span class="sxs-lookup"><span data-stu-id="47bfb-207">**INHOUSEINVOICE.XSD** – Schema of the in-house invoice that is sent to Northwind.</span></span>
* <span data-ttu-id="47bfb-208">**EFACT_D93A_INVOIC.XSD**: schema della fattura EDIFACT standard.</span><span class="sxs-lookup"><span data-stu-id="47bfb-208">**EFACT_D93A_INVOIC.XSD** – Schema of the standard EDIFACT invoice.</span></span>
* <span data-ttu-id="47bfb-209">**EFACT_4.1_CONTRL.XSD**: schema dell'acknowledgement EDIFACT che Northwind invia a Contoso.</span><span class="sxs-lookup"><span data-stu-id="47bfb-209">**EFACT_4.1_CONTRL.XSD** – Schema of the EDIFACT acknowledgement that Northwind sends to Contoso.</span></span>
* <span data-ttu-id="47bfb-210">**INHOUSEINVOICE_to_D93AINVOIC.TRFM**: trasformazione che esegue il mapping dello schema della fattura interna allo schema della fattura EDIFACT standard.</span><span class="sxs-lookup"><span data-stu-id="47bfb-210">**INHOUSEINVOICE_to_D93AINVOIC.TRFM** – The transform that maps the in-house invoice schema to the standard EDIFACT invoice schema.</span></span>  

### <a name="create-the-biztalk-services-project"></a><span data-ttu-id="47bfb-211">Creare il progetto di Servizi BizTalk</span><span class="sxs-lookup"><span data-stu-id="47bfb-211">Create the BizTalk Services project</span></span>
1. <span data-ttu-id="47bfb-212">Nella soluzione di Visual Studio espandere il progetto InvoiceProcessingBridge, quindi aprire il file **MessageFlowItinerary.bcs** .</span><span class="sxs-lookup"><span data-stu-id="47bfb-212">In the Visual Studio solution, expand the InvoiceProcessingBridge project, and then open the **MessageFlowItinerary.bcs** file.</span></span>
2. <span data-ttu-id="47bfb-213">Fare clic in qualsiasi punto del canvas e impostare **BizTalk Service URL** nella sezione delle proprietà in modo da specificare il nome della propria sottoscrizione a Servizi BizTalk.</span><span class="sxs-lookup"><span data-stu-id="47bfb-213">Click anywhere on the canvas and set the **BizTalk Service URL** in the property box to specify your BizTalk Services subscription name.</span></span> <span data-ttu-id="47bfb-214">Ad esempio: `https://contosowabs.biztalk.windows.net`.</span><span class="sxs-lookup"><span data-stu-id="47bfb-214">For example, `https://contosowabs.biztalk.windows.net`.</span></span>
   
   ![][7]  
3. <span data-ttu-id="47bfb-215">Dalla casella degli strumenti trascinare uno strumento **Bridge XML unidirezionale** nel canvas.</span><span class="sxs-lookup"><span data-stu-id="47bfb-215">From the toolbox, drag an **Xml One-Way Bridge** to the canvas.</span></span> <span data-ttu-id="47bfb-216">Impostare le proprietà **Nome entità** e **Indirizzo relativo** del bridge su **ProcessInvoiceBridge**.</span><span class="sxs-lookup"><span data-stu-id="47bfb-216">Set the **Entity Name** and **Relative Address** properties of the bridge to **ProcessInvoiceBridge**.</span></span> <span data-ttu-id="47bfb-217">Fare doppio clic su **ProcessInvoiceBridge** per aprire l'area di configurazione del bridge.</span><span class="sxs-lookup"><span data-stu-id="47bfb-217">Double-click **ProcessInvoiceBridge** to open the bridge configuration surface.</span></span>
4. <span data-ttu-id="47bfb-218">Nella casella **Tipi di messaggio** fare clic sul pulsante più (**+**) per specificare lo schema del messaggio in arrivo.</span><span class="sxs-lookup"><span data-stu-id="47bfb-218">Within the **Message Types** box, click the plus (**+**) button to specify the schema of the incoming message.</span></span> <span data-ttu-id="47bfb-219">Poiché il messaggio in arrivo per il bridge EAI è sempre la fattura interna, impostarlo su **INHOUSEINVOICE**.</span><span class="sxs-lookup"><span data-stu-id="47bfb-219">Because the incoming message for the EAI bridge is always the in-house invoice, set this to **INHOUSEINVOICE**.</span></span>
   
   ![][8]  
5. <span data-ttu-id="47bfb-220">Fare clic sulla forma **Trasformazione XML** e nella sezione delle proprietà, per la proprietà **Mappe**, fare clic sul pulsante con i puntini di sospensione (**...**).</span><span class="sxs-lookup"><span data-stu-id="47bfb-220">Click the **Xml Transform** shape, and in the property box, for the **Maps** property, click the ellipsis (**...**) button.</span></span> <span data-ttu-id="47bfb-221">Nella finestra di dialogo **Maps Selection** (Selezione mappe) selezionare il file di trasformazione **INHOUSEINVOICE_to_D93AINVOIC**, quindi fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="47bfb-221">In the **Maps Selection** dialog box, select the **INHOUSEINVOICE_to_D93AINVOIC** transform file, and then click **OK**.</span></span>
   
   ![][9]  
6. <span data-ttu-id="47bfb-222">Tornare a **MessageFlowItinerary.bcs** e dalla casella degli strumenti trascinare un **endpoint di servizio esterno bidirezionale** a destra di **ProcessInvoiceBridge**.</span><span class="sxs-lookup"><span data-stu-id="47bfb-222">Go back to **MessageFlowItinerary.bcs**, and from the toolbox, drag a **Two-Way External Service Endpoint** to the right of the **ProcessInvoiceBridge**.</span></span> <span data-ttu-id="47bfb-223">Impostare la proprietà **Nome entità** su **EDIBridge**.</span><span class="sxs-lookup"><span data-stu-id="47bfb-223">Set its **Entity Name** property to **EDIBridge**.</span></span>
7. <span data-ttu-id="47bfb-224">In Esplora soluzioni espandere **MessageFlowItinerary.bcs** e fare doppio clic sul file **EDIBridge.config file**.</span><span class="sxs-lookup"><span data-stu-id="47bfb-224">In the Solution Explorer, expand the **MessageFlowItinerary.bcs** and double-click the **EDIBridge.config** file.</span></span> <span data-ttu-id="47bfb-225">Sostituire il contenuto di **EDIBridge.config** con quanto segue.</span><span class="sxs-lookup"><span data-stu-id="47bfb-225">Replace the content of the **EDIBridge.config** with the following.</span></span>
   
   > [!NOTE]
   > <span data-ttu-id="47bfb-226">Perché è necessario modificare il file con estensione config?</span><span class="sxs-lookup"><span data-stu-id="47bfb-226">Why do I need to edit the .config file?</span></span> <span data-ttu-id="47bfb-227">L'endpoint del servizio esterno aggiunto al canvas di progettazione del bridge rappresenta i bridge EDI distribuiti in precedenza.</span><span class="sxs-lookup"><span data-stu-id="47bfb-227">The external service endpoint that we added to the bridge designer canvas represents the EDI bridges that we deployed earlier.</span></span> <span data-ttu-id="47bfb-228">I bridge EDI sono bidirezionali, con un lato invio e un lato ricezione.</span><span class="sxs-lookup"><span data-stu-id="47bfb-228">EDI bridges are two-way bridges, with a send and receive side.</span></span> <span data-ttu-id="47bfb-229">Il bridge EAI aggiunto al canvas di progettazione è però un bridge unidirezionale.</span><span class="sxs-lookup"><span data-stu-id="47bfb-229">However, the EAI bridge that we added to the bridge designer is a one-way bridge.</span></span> <span data-ttu-id="47bfb-230">Pertanto, per gestire i diversi modelli di scambio dei messaggi dei due bridge, viene usato un comportamento di bridge personalizzato includendo la relativa configurazione nel file config.</span><span class="sxs-lookup"><span data-stu-id="47bfb-230">So, to handle the different message exchange patterns of the two bridges, we use a custom bridge behavior by including its configuration in the .config file.</span></span> <span data-ttu-id="47bfb-231">Il comportamento personalizzato gestisce anche l'autenticazione nell'endpoint del bridge di trasmissione EDI. Questo comportamento personalizzato è disponibile come esempio separato in [BizTalk Services Bridge chaining sample - EAI to EDI](http://code.msdn.microsoft.com/BizTalk-Bridge-chaining-2246b104) (Esempio di concatenamento di bridge di Servizi BizTalk: da EAI a EDI).</span><span class="sxs-lookup"><span data-stu-id="47bfb-231">Additionally, the custom behavior also handles the authentication to the EDI send bridge endpoint.This custom behavior is available as a separate sample at [BizTalk Services Bridge chaining sample - EAI to EDI](http://code.msdn.microsoft.com/BizTalk-Bridge-chaining-2246b104).</span></span> <span data-ttu-id="47bfb-232">Questa soluzione riusa l'esempio.</span><span class="sxs-lookup"><span data-stu-id="47bfb-232">This solution reuses the sample.</span></span>  
   > 
   > 
   
   ```
   <?xml version="1.0" encoding="utf-8"?>
   <configuration>
     <system.serviceModel>
       <extensions>
         <behaviorExtensions>
           <add name="BridgeAuthentication" 
                 type="Microsoft.BizTalk.Bridge.Behaviour.BridgeBehaviorElement, Microsoft.BizTalk.Bridge.Behaviour, Version=1.0.0.0, Culture=neutral, PublicKeyToken=ae58f69b69495c05" />
         </behaviorExtensions>
       </extensions>
       <behaviors>
         <endpointBehaviors>
           <behavior name="BridgeAuthenticationConfiguration">
             <!-- Enter the ACS namespace, issuer name and issuer secret of the BizTalk Services deployment -->
             <BridgeAuthentication acsnamespace="[YOUR ACS NAMESPACE]" 
                                   issuername="owner" 
                                   issuersecret="[YOUR ACS SECRET]" />
             <webHttp />
           </behavior>
         </endpointBehaviors>
       </behaviors>
       <bindings>
         <webHttpBinding>
           <binding name="BridgeBindingConfiguration">
             <security mode="Transport" />
           </binding>
         </webHttpBinding>
       </bindings>
       <client>
         <clear />
         <!--
           Go BizTalk Portal > Agreement > Send Settings > Inbound URL
           Copy the Endpoint URL and paste it in the below address field
         -->
         <endpoint name="TwoWayExternalServiceEndpointReference1" 
                   address="[YOUR EDI BRIDGE SEND URI]" 
                   behaviorConfiguration="BridgeAuthenticationConfiguration" 
                   binding="webHttpBinding" 
                   bindingConfiguration="BridgeBindingConfiguration" 
                   contract="System.ServiceModel.Routing.IRequestReplyRouter" />
       </client>
     </system.serviceModel>
   </configuration>
   
   ```
8. <span data-ttu-id="47bfb-233">Aggiornare il file EDIBridge.config in modo da includere i dettagli di configurazione</span><span class="sxs-lookup"><span data-stu-id="47bfb-233">Update the EDIBridge.config file to include configuration details</span></span>
   
   * <span data-ttu-id="47bfb-234">In *<behaviors>* specificare lo spazio dei nomi del servizio contenitore di Azure e la chiave associati alla sottoscrizione a Servizi BizTalk.</span><span class="sxs-lookup"><span data-stu-id="47bfb-234">Under *<behaviors>*, provide the ACS namespace and key associated with the BizTalk Services subscription.</span></span>
   * <span data-ttu-id="47bfb-235">In *<client>* specificare l'endpoint in cui è distribuito il contratto di invio EDI.</span><span class="sxs-lookup"><span data-stu-id="47bfb-235">Under *<client>*, provide the endpoint where the EDI send agreement is deployed.</span></span>
   
   <span data-ttu-id="47bfb-236">Salvare le modifiche e chiudere il file di configurazione.</span><span class="sxs-lookup"><span data-stu-id="47bfb-236">Save changes and close the configuration file.</span></span>
9. <span data-ttu-id="47bfb-237">Nella casella degli strumenti fare clic su **Connettore** e aggiungere i componenti **ProcessInvoiceBridge** ed **EDIBridge**.</span><span class="sxs-lookup"><span data-stu-id="47bfb-237">From the Toolbox, click the **Connector** and join the **ProcessInvoiceBridge** and **EDIBridge** components.</span></span> <span data-ttu-id="47bfb-238">Selezionare il connettore e nella casella delle proprietà impostare **Condizione filtro** su **Match All** (Corrispondenza con tutti).</span><span class="sxs-lookup"><span data-stu-id="47bfb-238">Select the connector, and in Properties box, set **Filter Condition** to **Match All**.</span></span> <span data-ttu-id="47bfb-239">In questo modo, tutti i messaggi elaborati dal bridge EAI vengono instradati al bridge EDI.</span><span class="sxs-lookup"><span data-stu-id="47bfb-239">This ensures that all messages processed by the EAI bridge are routed to the EDI bridge.</span></span>
   
   ![][10]  
10. <span data-ttu-id="47bfb-240">Salvare le modifiche apportate alla soluzione.</span><span class="sxs-lookup"><span data-stu-id="47bfb-240">Save changes to the solution.</span></span>  

### <a name="deploy-the-project"></a><span data-ttu-id="47bfb-241">Distribuire il progetto</span><span class="sxs-lookup"><span data-stu-id="47bfb-241">Deploy the project</span></span>
1. <span data-ttu-id="47bfb-242">Nel computer in cui è stato creato il progetto di Servizi BizTalk scaricare e installare il certificato SSL per la propria sottoscrizione a Servizi BizTalk.</span><span class="sxs-lookup"><span data-stu-id="47bfb-242">On the computer where you created the BizTalk Services project, download and install the SSL certificate for your BizTalk Services subscription.</span></span> <span data-ttu-id="47bfb-243">Da , in Servizi BizTalk fare clic su **Dashboard**, quindi su **Scarica certificato SSL**.</span><span class="sxs-lookup"><span data-stu-id="47bfb-243">From , under BizTalk Services, click **Dashboard**, and then click **Download SSL Certificate**.</span></span> <span data-ttu-id="47bfb-244">Fare doppio clic sul certificato e seguire i messaggi di richiesta per completare l'installazione.</span><span class="sxs-lookup"><span data-stu-id="47bfb-244">Double-click the certificate and follow the prompt to complete the installation.</span></span> <span data-ttu-id="47bfb-245">Assicurarsi di installare il certificato nell'archivio certificati **Autorità di certificazione radice disponibile nell'elenco locale** .</span><span class="sxs-lookup"><span data-stu-id="47bfb-245">Make sure you install the certificate under **Trusted Root Certification Authorities** certificate store.</span></span>
2. <span data-ttu-id="47bfb-246">In Esplora soluzioni di Visual Studio fare clic con il pulsante destro del mouse sul progetto **InvoiceProcessingBridge** e scegliere **Distribuisci**.</span><span class="sxs-lookup"><span data-stu-id="47bfb-246">In Visual Studio Solution Explorer, right-click the **InvoiceProcessingBridge** project, and then click **Deploy**.</span></span>
3. <span data-ttu-id="47bfb-247">Specificare i valori mostrati nell'immagine, quindi fare clic su **Distribuisci**.</span><span class="sxs-lookup"><span data-stu-id="47bfb-247">Provide the values as shown in the image, and then click **Deploy**.</span></span> <span data-ttu-id="47bfb-248">È possibile ottenere le credenziali ACS per i Servizi BizTalk facendo clic su **Informazioni di connessione** dal dashboard dei Servizi BizTalk.</span><span class="sxs-lookup"><span data-stu-id="47bfb-248">You can get the ACS credentials for BizTalk Services by clicking **Connection Information** from the BizTalk Services dashboard.</span></span>
   
   ![][11]  
   
   <span data-ttu-id="47bfb-249">Dal riquadro di output copiare l'endpoint in cui è distribuito il bridge EAI, ad esempio `https://contosowabs.biztalk.windows.net/default/ProcessInvoiceBridge`.</span><span class="sxs-lookup"><span data-stu-id="47bfb-249">From the output pane, copy the endpoint where the EAI bridge is deployed, for example, `https://contosowabs.biztalk.windows.net/default/ProcessInvoiceBridge`.</span></span> <span data-ttu-id="47bfb-250">L'URL di questo endpoint sarà necessario più avanti.</span><span class="sxs-lookup"><span data-stu-id="47bfb-250">You will need this endpoint URL later.</span></span>  

## <a name="step-4-test-the-solution"></a><span data-ttu-id="47bfb-251">Passaggio 4: testare la soluzione</span><span class="sxs-lookup"><span data-stu-id="47bfb-251">Step 4: Test the solution</span></span>
<span data-ttu-id="47bfb-252">In questo argomento viene illustrato come testare la soluzione utilizzando l'applicazione **client dell'esercitazione** fornita come parte dell'esempio.</span><span class="sxs-lookup"><span data-stu-id="47bfb-252">In this topic, we look at how to test the solution by using the **Tutorial Client** application provided as part of the sample.</span></span>  

1. <span data-ttu-id="47bfb-253">In Visual Studio premere F5 per avviare l'applicazione **client dell'esercitazione**.</span><span class="sxs-lookup"><span data-stu-id="47bfb-253">In Visual Studio, press F5 to start the **Tutorial Client**.</span></span>
2. <span data-ttu-id="47bfb-254">Nella schermata devono già essere inseriti i valori specificati nel passaggio in cui sono state create le code del bus di servizio.</span><span class="sxs-lookup"><span data-stu-id="47bfb-254">The screen must have the values prepopulated from the step where we created the Service Bus queues.</span></span> <span data-ttu-id="47bfb-255">Fare clic su **Avanti**.</span><span class="sxs-lookup"><span data-stu-id="47bfb-255">Click **Next**.</span></span>
3. <span data-ttu-id="47bfb-256">Nella finestra successiva specificare le credenziali ACS per la sottoscrizione a Servizi BizTalk e gli endpoint in cui sono distribuiti i bridge EAI ed EDI (ricezione).</span><span class="sxs-lookup"><span data-stu-id="47bfb-256">In the next window, provide ACS credentials for BizTalk Services subscription, and the endpoints where EAI and EDI (receive) bridges are deployed.</span></span>
   
   <span data-ttu-id="47bfb-257">L'endpoint del bridge EAI è stato copiato nel passaggio precedente.</span><span class="sxs-lookup"><span data-stu-id="47bfb-257">You had copied the EAI bridge endpoint in the previous step.</span></span> <span data-ttu-id="47bfb-258">Per l'endpoint del bridge di ricezione EDI, nel portale di Servizi BizTalk passare all'accordo > Receive Settings > Trasporto > Endpoint.</span><span class="sxs-lookup"><span data-stu-id="47bfb-258">For EDI receive bridge endpoint, in the BizTalk Services Portal, go to the agreement > Receive Settings > Transport > Endpoint.</span></span>
   
   ![][12]  
4. <span data-ttu-id="47bfb-259">Nella finestra successiva, in Contoso, fare clic sul pulsante **Send In-house Invoice** .</span><span class="sxs-lookup"><span data-stu-id="47bfb-259">In the next window, under Contoso, click the **Send In-house Invoice** button.</span></span> <span data-ttu-id="47bfb-260">Nella finestra di dialogo Apri file aprire il file INHOUSEINVOICE.txt.</span><span class="sxs-lookup"><span data-stu-id="47bfb-260">In the File open dialog box, open the INHOUSEINVOICE.txt file.</span></span> <span data-ttu-id="47bfb-261">Esaminare il contenuto del file, quindi fare clic su **OK** per inviare la fattura.</span><span class="sxs-lookup"><span data-stu-id="47bfb-261">Examine the content of the file and then click **OK** to send the invoice.</span></span>
   
   ![][13]  
5. <span data-ttu-id="47bfb-262">Dopo pochi secondi Northwind riceve la fattura.</span><span class="sxs-lookup"><span data-stu-id="47bfb-262">In a few seconds the invoice is received at Northwind.</span></span> <span data-ttu-id="47bfb-263">Fare clic sul collegamento **Visualizza messaggio** per visualizzare la fattura ricevuta da Northwind.</span><span class="sxs-lookup"><span data-stu-id="47bfb-263">Click the **View Message** link to see the invoice received by Northwind.</span></span> <span data-ttu-id="47bfb-264">Si noti che la fattura ricevuta da Northwind è nello schema EDIFACT standard, mentre quella inviata da Contoso era in uno schema interno.</span><span class="sxs-lookup"><span data-stu-id="47bfb-264">Notice how the invoice received by Northwind is in standard EDIFACT schema while the one sent by Contoso was an in-house schema.</span></span>
   
   ![][14]  
6. <span data-ttu-id="47bfb-265">Selezionare la fattura, quindi fare clic su **Send Acknowledgement**.</span><span class="sxs-lookup"><span data-stu-id="47bfb-265">Select the invoice and then click **Send Acknowledgement**.</span></span> <span data-ttu-id="47bfb-266">Nella finestra di dialogo che viene visualizzata si noti che l'ID dell'interscambio è uguale nella fattura ricevuta e nell'acknowledgement inviato.</span><span class="sxs-lookup"><span data-stu-id="47bfb-266">In the dialog box that pops up, notice that the interchange ID is same in the received invoice and the acknowledgement being sent.</span></span> <span data-ttu-id="47bfb-267">Fare clic su OK nella finestra di dialogo **Invia conferma** .</span><span class="sxs-lookup"><span data-stu-id="47bfb-267">Click OK in the **Send Acknowledgement** dialog box.</span></span>
   
   ![][15]  
7. <span data-ttu-id="47bfb-268">Dopo pochi secondi Contoso riceve correttamente l'acknowledgement.</span><span class="sxs-lookup"><span data-stu-id="47bfb-268">In a few seconds, the acknowledgement is successfully received at Contoso.</span></span>
   
   ![][16]  

## <a name="step-5-optional-send-edifact-invoice-in-batches"></a><span data-ttu-id="47bfb-269">Passaggio 5 (facoltativo): inviare le fatture EDIFACT in batch</span><span class="sxs-lookup"><span data-stu-id="47bfb-269">Step 5 (optional): Send EDIFACT invoice in batches</span></span>
<span data-ttu-id="47bfb-270">I bridge EDI di Servizi BizTalk supportano anche l'invio in batch dei messaggi in uscita.</span><span class="sxs-lookup"><span data-stu-id="47bfb-270">BizTalk Services EDI bridges also supports batching of outgoing messages.</span></span> <span data-ttu-id="47bfb-271">Questa funzionalità è utile per i partner destinatari che preferiscono ricevere un batch di messaggi (che soddisfano un determinato criterio) anziché messaggi singoli.</span><span class="sxs-lookup"><span data-stu-id="47bfb-271">This feature is useful for receiving partners that prefer to receive a batch of messages (meeting certain criterion) instead of individual messages.</span></span>

<span data-ttu-id="47bfb-272">Quando si usano i batch, l'aspetto più importante da considerare è l'effettivo rilascio del batch o, in altre parole, i criteri di rilascio.</span><span class="sxs-lookup"><span data-stu-id="47bfb-272">The most important aspect when working with batches is the actual release of the batch, also called the release criteria.</span></span> <span data-ttu-id="47bfb-273">I criteri di rilascio possono essere basati sulla modalità con cui il partner destinatario desidera ricevere i messaggi.</span><span class="sxs-lookup"><span data-stu-id="47bfb-273">The release criteria can be based on how the receiving partner wants to receive messages.</span></span> <span data-ttu-id="47bfb-274">Se l'invio in batch è abilitato, il bridge EDI non invia il messaggio in uscita al partner destinatario finché i criteri di rilascio non sono soddisfatti.</span><span class="sxs-lookup"><span data-stu-id="47bfb-274">If batching is enabled, the EDI bridge does not send the outgoing message to the receiving partner until the release criteria is fulfilled.</span></span> <span data-ttu-id="47bfb-275">Ad esempio, se si impostano criteri di invio in batch basati sul numero di messaggi, viene inviato un batch solo quando vengono raggruppati 'n' messaggi.</span><span class="sxs-lookup"><span data-stu-id="47bfb-275">For example, a batching criteria based on message size dispatches a batch only when ‘n’ messages are batched.</span></span> <span data-ttu-id="47bfb-276">I criteri di batch possono anche essere basati sul tempo e in questo caso un batch può ad esempio essere inviato ogni giorno a una determinata ora.</span><span class="sxs-lookup"><span data-stu-id="47bfb-276">A batch criteria can also be time-based, such that a batch is sent at a fixed time every day.</span></span> <span data-ttu-id="47bfb-277">In questa soluzione si tenta di usare criteri basati sulla dimensione del messaggio.</span><span class="sxs-lookup"><span data-stu-id="47bfb-277">In this solution, we try the message-size based criteria.</span></span>

1. <span data-ttu-id="47bfb-278">Nel portale di Servizi BizTalk fare clic sull'accordo creato in precedenza.</span><span class="sxs-lookup"><span data-stu-id="47bfb-278">In the BizTalk Services Portal, click the agreement you created earlier.</span></span> <span data-ttu-id="47bfb-279">Fare clic su Send Settings > Batch > Add Batch.</span><span class="sxs-lookup"><span data-stu-id="47bfb-279">Click Send Settings > Batching > Add Batch.</span></span>
2. <span data-ttu-id="47bfb-280">Come nome del batch immettere **InvoiceBatch**, specificare una descrizione, quindi fare clic su **Avanti**.</span><span class="sxs-lookup"><span data-stu-id="47bfb-280">For batch name, enter **InvoiceBatch**, provide a description, and then click **Next**.</span></span>
3. <span data-ttu-id="47bfb-281">Specificare criteri di batch che definiscano quali messaggi devono essere raggruppati.</span><span class="sxs-lookup"><span data-stu-id="47bfb-281">Specify a batch criteria, that defines which messages must be batched.</span></span> <span data-ttu-id="47bfb-282">In questa soluzione vengono raggruppati tutti i messaggi.</span><span class="sxs-lookup"><span data-stu-id="47bfb-282">In this solution, we batch all messages.</span></span> <span data-ttu-id="47bfb-283">Selezionare pertanto l'opzione Use advanced definitions e immettere **1 = 1**.</span><span class="sxs-lookup"><span data-stu-id="47bfb-283">So, select the Use advanced definitions option, and enter **1 = 1**.</span></span> <span data-ttu-id="47bfb-284">Questa è una condizione che sarà sempre vera, quindi tutti i messaggi verranno raggruppati in un batch.</span><span class="sxs-lookup"><span data-stu-id="47bfb-284">This is a condition which will always be true, and hence all messages will be batched.</span></span> <span data-ttu-id="47bfb-285">Fare clic su **Avanti**.</span><span class="sxs-lookup"><span data-stu-id="47bfb-285">Click **Next**.</span></span>
   
   ![][17]  
4. <span data-ttu-id="47bfb-286">Specificare criteri di rilascio del batch.</span><span class="sxs-lookup"><span data-stu-id="47bfb-286">Specify a batch release criteria.</span></span> <span data-ttu-id="47bfb-287">Dalla casella di riepilogo a discesa selezionare **MessageCountBased** e per **Conteggio** specificare **3**.</span><span class="sxs-lookup"><span data-stu-id="47bfb-287">From the drop-box, select **MessageCountBased**, and for **Count**, specify **3**.</span></span> <span data-ttu-id="47bfb-288">Questo significa che a Northwind verrà inviato un batch di tre messaggi.</span><span class="sxs-lookup"><span data-stu-id="47bfb-288">This means that a batch of three messages will be sent to Northwind.</span></span> <span data-ttu-id="47bfb-289">Fare clic su **Avanti**.</span><span class="sxs-lookup"><span data-stu-id="47bfb-289">Click **Next**.</span></span>
   
   ![][18]  
5. <span data-ttu-id="47bfb-290">Controllare il riepilogo, quindi fare clic su **Salva**.</span><span class="sxs-lookup"><span data-stu-id="47bfb-290">Review the summary and then click **Save**.</span></span> <span data-ttu-id="47bfb-291">Fare clic su **Distribuisci** per ridistribuire l'accordo.</span><span class="sxs-lookup"><span data-stu-id="47bfb-291">Click **Deploy** to redeploy the agreement.</span></span>
6. <span data-ttu-id="47bfb-292">Tornare all'applicazione **Tutorial Client** (Client esercitazione), fare clic su **Send In-house Invoice** (Invia fattura interna) e seguire i prompt per inviare la fattura.</span><span class="sxs-lookup"><span data-stu-id="47bfb-292">Go back to the **Tutorial Client**, click **Send In-house Invoice**, and follow the prompts to send the invoice.</span></span> <span data-ttu-id="47bfb-293">Si noterà che Northwind non riceve alcuna fattura perché i criteri relativi al numero di messaggi per il batch non sono soddisfatti.</span><span class="sxs-lookup"><span data-stu-id="47bfb-293">You will notice that no invoice is received at Northwind because the batch size is not met.</span></span> <span data-ttu-id="47bfb-294">Ripetere questo passaggio altre due volte, in modo da avere tre messaggi di fatture da inviare a Northwind.</span><span class="sxs-lookup"><span data-stu-id="47bfb-294">Repeat this step two more times, so that you have three invoice messages sent to Northwind.</span></span> <span data-ttu-id="47bfb-295">In questo caso, i criteri di rilascio, che prevedono un batch di 3 messaggi, vengono soddisfatti, pertanto ora dovrebbe risultare una fattura presso Northwind.</span><span class="sxs-lookup"><span data-stu-id="47bfb-295">This satisfies the batch release criteria of 3 messages and you should now see an invoice at Northwind.</span></span>

<!--Image references-->
[1]: ./media/biztalk-process-edifact-invoice/process-edifact-invoices-with-auzure-bts-1.PNG  
[2]: ./media/biztalk-process-edifact-invoice/process-edifact-invoices-with-auzure-bts-2.PNG  
[3]: ./media/biztalk-process-edifact-invoice/process-edifact-invoices-with-auzure-bts-3.PNG
[4]: ./media/biztalk-process-edifact-invoice/process-edifact-invoices-with-auzure-bts-4.PNG  
[5]: ./media/biztalk-process-edifact-invoice/process-edifact-invoices-with-auzure-bts-5.PNG  
[6]: ./media/biztalk-process-edifact-invoice/process-edifact-invoices-with-auzure-bts-6.PNG  
[7]: ./media/biztalk-process-edifact-invoice/process-edifact-invoices-with-auzure-bts-7.PNG  
[8]: ./media/biztalk-process-edifact-invoice/process-edifact-invoices-with-auzure-bts-8.PNG
[9]: ./media/biztalk-process-edifact-invoice/process-edifact-invoices-with-auzure-bts-9.PNG  
[10]: ./media/biztalk-process-edifact-invoice/process-edifact-invoices-with-auzure-bts-10.PNG  
[11]: ./media/biztalk-process-edifact-invoice/process-edifact-invoices-with-auzure-bts-11.PNG  
[12]: ./media/biztalk-process-edifact-invoice/process-edifact-invoices-with-auzure-bts-12.PNG  
[13]: ./media/biztalk-process-edifact-invoice/process-edifact-invoices-with-auzure-bts-13.PNG
[14]: ./media/biztalk-process-edifact-invoice/process-edifact-invoices-with-auzure-bts-14.PNG  
[15]: ./media/biztalk-process-edifact-invoice/process-edifact-invoices-with-auzure-bts-15.PNG  
[16]: ./media/biztalk-process-edifact-invoice/process-edifact-invoices-with-auzure-bts-16.PNG  
[17]: ./media/biztalk-process-edifact-invoice/process-edifact-invoices-with-auzure-bts-17.PNG  
[18]: ./media/biztalk-process-edifact-invoice/process-edifact-invoices-with-auzure-bts-18.PNG

