---
title: Automatizzare il ripristino di emergenza per le condivisioni di file StorSimple con Azure Site Recovery | Microsoft Docs
description: Descrive i passaggi e le procedure consigliate per la creazione di una soluzione di ripristino di emergenza per le condivisioni file ospitate nell'archiviazione Microsoft Azure StorSimple.
services: storsimple
documentationcenter: NA
author: vidarmsft
manager: syadav
editor: 
ms.assetid: 23049a2c-055e-4d0e-b8f5-af2a87ecf53f
ms.service: storsimple
ms.devlang: NA
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 06/09/2017
ms.author: vidarmsft
ms.openlocfilehash: b4d575587eec1bcf43c33c7faeb8360ec67b5214
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/03/2017
---
# <a name="automated-disaster-recovery-solution-using-azure-site-recovery-for-file-shares-hosted-on-storsimple"></a><span data-ttu-id="7f5aa-103">Soluzione di ripristino di emergenza automatizzato usando Azure Site Recovery per le condivisioni file ospitate su StorSimple</span><span class="sxs-lookup"><span data-stu-id="7f5aa-103">Automated Disaster Recovery solution using Azure Site Recovery for file shares hosted on StorSimple</span></span>
## <a name="overview"></a><span data-ttu-id="7f5aa-104">Panoramica</span><span class="sxs-lookup"><span data-stu-id="7f5aa-104">Overview</span></span>
<span data-ttu-id="7f5aa-105">Microsoft Azure StorSimple è una soluzione di archiviazione cloud ibrida che risolve le complessità dei dati non strutturati comunemente associate alle condivisioni file.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-105">Microsoft Azure StorSimple is a hybrid cloud storage solution that addresses the complexities of unstructured data commonly associated with file shares.</span></span> <span data-ttu-id="7f5aa-106">StorSimple usa l'archiviazione cloud come un'estensione della soluzione locale e organizza automaticamente i dati in livelli tra archiviazione locale e archiviazione cloud.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-106">StorSimple uses cloud storage as an extension of the on-premises solution and automatically tiers data across on-premises storage and cloud storage.</span></span> <span data-ttu-id="7f5aa-107">La protezione integrata dei dati, con snapshot locali e cloud, elimina la necessità di un'infrastruttura di archiviazione complessa.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-107">Integrated data protection, with local and cloud snapshots, eliminates the need for a sprawling storage infrastructure.</span></span>

<span data-ttu-id="7f5aa-108">[Azure Site Recovery](../site-recovery/site-recovery-overview.md) è un servizio basato su Azure che fornisce funzionalità di ripristino di emergenza per il coordinamento di replica, failover e ripristino delle macchine virtuali.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-108">[Azure Site Recovery](../site-recovery/site-recovery-overview.md) is an Azure-based service that provides disaster recovery (DR) capabilities by orchestrating replication, failover, and recovery of virtual machines.</span></span> <span data-ttu-id="7f5aa-109">Azure Site Recovery supporta una serie di tecnologie di replica per la replica, la protezione e il failover semplice di macchine virtuali e applicazioni nei cloud pubblici, privati oppure ospitati.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-109">Azure Site Recovery supports a number of replication technologies to consistently replicate, protect, and seamlessly fail over virtual machines and applications to private/public or hosted clouds.</span></span>

<span data-ttu-id="7f5aa-110">Usando Azure Site Recovery, la replica delle macchine virtuali e le funzionalità di snapshot cloud di StorSimple, è possibile proteggere l'ambiente di server di file completo.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-110">Using Azure Site Recovery, virtual machine replication, and StorSimple cloud snapshot capabilities, you can protect the complete file server environment.</span></span> <span data-ttu-id="7f5aa-111">In caso di interruzione, con un semplice clic è possibile portare le condivisioni di file online in Azure in pochi minuti.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-111">In the event of a disruption, you can use a single click to bring your file shares online in Azure in just a few minutes.</span></span>

<span data-ttu-id="7f5aa-112">Questo documento illustra in dettaglio come creare una soluzione di ripristino di emergenza per le condivisioni file ospitate nell'archiviazione di StorSimple ed eseguire failover pianificati, non pianificati e di test usando un piano di ripristino con un solo clic.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-112">This document explains in detail how you can create a disaster recovery solution for your file shares hosted on StorSimple storage, and perform planned, unplanned, and test failovers using a one-click recovery plan.</span></span> <span data-ttu-id="7f5aa-113">In pratica, mostra come modificare il piano di ripristino dell'insieme di credenziali di Azure Site Recovery per attivare i failover StorSimple durante gli scenari di emergenza.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-113">In essence, it shows how you can modify the Recovery Plan in your Azure Site Recovery vault to enable StorSimple failovers during disaster scenarios.</span></span> <span data-ttu-id="7f5aa-114">Inoltre, descrive le configurazioni supportate e i prerequisiti.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-114">In addition, it describes supported configurations and prerequisites.</span></span> <span data-ttu-id="7f5aa-115">Questo documento presuppone la conoscenza delle nozioni di base delle architetture di Azure Site Recovery e StorSimple.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-115">This document assumes that you are familiar with the basics of Azure Site Recovery and StorSimple architectures.</span></span>

## <a name="supported-azure-site-recovery-deployment-options"></a><span data-ttu-id="7f5aa-116">Opzioni di distribuzione di Azure Site Recovery</span><span class="sxs-lookup"><span data-stu-id="7f5aa-116">Supported Azure Site Recovery deployment options</span></span>
<span data-ttu-id="7f5aa-117">I clienti possono distribuire file server come server fisici o macchine virtuali (VM) in esecuzione in Hyper-V o VMware e quindi creare le condivisioni file da volumi ottenuti dall'archiviazione StorSimple.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-117">Customers can deploy file servers as physical servers or virtual machines (VMs) running on Hyper-V or VMware, and then create file shares from volumes carved out of StorSimple storage.</span></span> <span data-ttu-id="7f5aa-118">Azure Site Recovery può proteggere le distribuzioni fisiche e virtuali in un sito secondario o in Azure.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-118">Azure Site Recovery can protect both physical and virtual deployments to either a secondary site or to Azure.</span></span> <span data-ttu-id="7f5aa-119">Questo documento descrive in dettaglio una soluzione di ripristino di emergenza che usa Azure come sito di ripristino per una VM di file server ospitata in Hyper-V e con condivisioni file nell'archiviazione di StorSimple.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-119">This document covers details of a DR solution with Azure as the recovery site for a file server VM hosted on Hyper-V and with file shares on StorSimple storage.</span></span> <span data-ttu-id="7f5aa-120">Altri scenari in cui la VM del file server si trova in una VM VMware o in un computer fisico possono essere implementati in modo analogo.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-120">Other scenarios in which the file server VM is on a VMware VM or a physical machine can be implemented similarly.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="7f5aa-121">Prerequisiti</span><span class="sxs-lookup"><span data-stu-id="7f5aa-121">Prerequisites</span></span>
<span data-ttu-id="7f5aa-122">I prerequisiti di implementazione di una soluzione di ripristino di emergenza in un solo clic che usa Azure Site Recovery per le condivisioni file ospitate nell'archiviazione StorSimple sono i seguenti:</span><span class="sxs-lookup"><span data-stu-id="7f5aa-122">Implementing a one-click disaster recovery solution that uses Azure Site Recovery for file shares hosted on StorSimple storage has the following prerequisites:</span></span>

* <span data-ttu-id="7f5aa-123">VM del file server Windows Server 2012 R2 locale ospitata in Hyper-V, VMware o in un computer fisico</span><span class="sxs-lookup"><span data-stu-id="7f5aa-123">On-premises Windows Server 2012 R2 File server VM hosted on Hyper-V or VMware or a physical machine</span></span>
* <span data-ttu-id="7f5aa-124">Dispositivo di archiviazione StorSimple locale registrato con Azure StorSimple Manager</span><span class="sxs-lookup"><span data-stu-id="7f5aa-124">StorSimple storage device on-premises registered with Azure StorSimple manager</span></span>
* <span data-ttu-id="7f5aa-125">Appliance cloud StorSimple creata in Azure StorSimple Manager (può rimanere in stato di arresto)</span><span class="sxs-lookup"><span data-stu-id="7f5aa-125">StorSimple Cloud Appliance created in the Azure StorSimple manager (this can be kept in shut down state)</span></span>
* <span data-ttu-id="7f5aa-126">Condivisioni file ospitate nei volumi configurati sul dispositivo di archiviazione StorSimple</span><span class="sxs-lookup"><span data-stu-id="7f5aa-126">File shares hosted on the volumes configured on the StorSimple storage device</span></span>
* <span data-ttu-id="7f5aa-127">[insieme di credenziali dei servizi di Azure Site Recovery](../site-recovery/site-recovery-vmm-to-vmm.md) creato in una sottoscrizione di Microsoft Azure</span><span class="sxs-lookup"><span data-stu-id="7f5aa-127">[Azure Site Recovery services vault](../site-recovery/site-recovery-vmm-to-vmm.md) created in a Microsoft Azure subscription</span></span>

<span data-ttu-id="7f5aa-128">Inoltre, se Azure è il sito di ripristino, eseguire lo strumento [Azure Virtual Machine Readiness Assessment](http://azure.microsoft.com/downloads/vm-readiness-assessment/) nelle VM per assicurarsi che siano compatibili con le VM di Azure e i Servizi di Azure Site Recovery.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-128">In addition, if Azure is your recovery site, run the [Azure Virtual Machine Readiness Assessment tool](http://azure.microsoft.com/downloads/vm-readiness-assessment/) on VMs to ensure that they are compatible with Azure VMs and Azure Site Recovery services.</span></span>

<span data-ttu-id="7f5aa-129">Per evitare problemi di latenza (che potrebbero causare un aumento dei costi), assicurarsi di creare l'appliance cloud StorSimple, l'account di automazione e gli account di archiviazione nella stessa area.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-129">To avoid latency issues (which might result in higher costs), make sure that you create your StorSimple Cloud Appliance, automation account, and storage account(s) in the same region.</span></span>

## <a name="enable-dr-for-storsimple-file-shares"></a><span data-ttu-id="7f5aa-130">Abilitare il ripristino di emergenza per le condivisioni file di StorSimple</span><span class="sxs-lookup"><span data-stu-id="7f5aa-130">Enable DR for StorSimple file shares</span></span>
<span data-ttu-id="7f5aa-131">Ogni componente dell'ambiente locale deve essere protetto per abilitare la replica e il ripristino completi.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-131">Each component of the on-premises environment needs to be protected to enable complete replication and recovery.</span></span> <span data-ttu-id="7f5aa-132">Questa sezione illustra come:</span><span class="sxs-lookup"><span data-stu-id="7f5aa-132">This section describes how to:</span></span>

* <span data-ttu-id="7f5aa-133">Configurare la replica di Active Directory e DNS (facoltativo)</span><span class="sxs-lookup"><span data-stu-id="7f5aa-133">Set up Active Directory and DNS replication (optional)</span></span>
* <span data-ttu-id="7f5aa-134">Usare Azure Site Recovery per abilitare la protezione della VM del file server</span><span class="sxs-lookup"><span data-stu-id="7f5aa-134">Use Azure Site Recovery to enable protection of the file server VM</span></span>
* <span data-ttu-id="7f5aa-135">Abilitare la protezione dei volumi StorSimple</span><span class="sxs-lookup"><span data-stu-id="7f5aa-135">Enable protection of StorSimple volumes</span></span>
* <span data-ttu-id="7f5aa-136">Configurare la rete</span><span class="sxs-lookup"><span data-stu-id="7f5aa-136">Configure the network</span></span>

### <a name="set-up-active-directory-and-dns-replication-optional"></a><span data-ttu-id="7f5aa-137">Configurare la replica di Active Directory e DNS (facoltativo)</span><span class="sxs-lookup"><span data-stu-id="7f5aa-137">Set up Active Directory and DNS replication (optional)</span></span>
<span data-ttu-id="7f5aa-138">Se si vuole proteggere i computer che eseguono Active Directory e DNS in modo che siano disponibili nel sito di ripristino di emergenza, è necessario proteggerli in modo esplicito (in modo che i file server siano accessibili dopo il failover con autenticazione).</span><span class="sxs-lookup"><span data-stu-id="7f5aa-138">If you want to protect the machines running Active Directory and DNS so that they are available on the DR site, you need to explicitly protect them (so that the file servers are accessible after fail over with authentication).</span></span> <span data-ttu-id="7f5aa-139">Sono consigliate due opzioni a seconda della complessità dell'ambiente locale del cliente.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-139">There are two recommended options based on the complexity of the customer’s on-premises environment.</span></span>

#### <a name="option-1"></a><span data-ttu-id="7f5aa-140">Opzione 1</span><span class="sxs-lookup"><span data-stu-id="7f5aa-140">Option 1</span></span>
<span data-ttu-id="7f5aa-141">Se il cliente ha un numero limitato di applicazioni, un singolo controller di dominio per l'intero sito locale ed eseguirà il failover dell'intero sito, è consigliabile usare la replica di Azure Site Recovery per replicare il computer del controller di dominio nel sito secondario (applicabile sia per l'operazione da sito a sito, che da sito ad Azure).</span><span class="sxs-lookup"><span data-stu-id="7f5aa-141">If the customer has a small number of applications, a single domain controller for the entire on-premises site, and will be failing over the entire site, then we recommend using Azure Site Recovery replication to replicate the domain controller machine to a secondary site (this is applicable for both site-to-site and site-to-Azure).</span></span>

#### <a name="option-2"></a><span data-ttu-id="7f5aa-142">Opzione 2</span><span class="sxs-lookup"><span data-stu-id="7f5aa-142">Option 2</span></span>
<span data-ttu-id="7f5aa-143">Se il cliente ha un numero elevato di applicazioni, esegue una foresta Active Directory ed eseguirà il failover di poche applicazioni alla volta, è consigliabile configurare un controller di dominio aggiuntivo nel sito di ripristino di emergenza (indipendentemente dal fatto che si esegua il failover in un sito secondario o in Azure).</span><span class="sxs-lookup"><span data-stu-id="7f5aa-143">If the customer has a large number of applications, is running an Active Directory forest, and will be failing over a few applications at a time, then we recommend setting up an additional domain controller on the DR site (either a secondary site or in Azure).</span></span>

<span data-ttu-id="7f5aa-144">Consultare [Proteggere Active Directory e DNS con Azure Site Recovery](../site-recovery/site-recovery-active-directory.md) per informazioni su come procedere quando si rende disponibile un controller di dominio nel sito di ripristino di emergenza.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-144">Please refer to [Automated DR solution for Active Directory and DNS using Azure Site Recovery](../site-recovery/site-recovery-active-directory.md) for instructions when making a domain controller available on the DR site.</span></span> <span data-ttu-id="7f5aa-145">Nella parte restante di questo documento, si presuppone che sia disponibile un controller di dominio nel sito di ripristino di emergenza.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-145">For the remainder of this document, we will assume a domain controller is available on the DR site.</span></span>

### <a name="use-azure-site-recovery-to-enable-protection-of-the-file-server-vm"></a><span data-ttu-id="7f5aa-146">Usare Azure Site Recovery per abilitare la protezione della VM del file server</span><span class="sxs-lookup"><span data-stu-id="7f5aa-146">Use Azure Site Recovery to enable protection of the file server VM</span></span>
<span data-ttu-id="7f5aa-147">Questo passaggio richiede la preparazione dell'ambiente di file server locale, la creazione e la preparazione di un insieme di credenziali di Azure Site Recovery e l'abilitazione della protezione di file della VM.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-147">This step requires that you prepare the on-premises file server environment, create and prepare an Azure Site Recovery vault, and enable file protection of the VM.</span></span>

#### <a name="to-prepare-the-on-premises-file-server-environment"></a><span data-ttu-id="7f5aa-148">Per preparare l'ambiente di file server locale</span><span class="sxs-lookup"><span data-stu-id="7f5aa-148">To prepare the on-premises file server environment</span></span>
1. <span data-ttu-id="7f5aa-149">Impostare **Controllo dell'account utente** su **Never Notify** (Non notificare mai).</span><span class="sxs-lookup"><span data-stu-id="7f5aa-149">Set the **User Account Control** to **Never Notify**.</span></span> <span data-ttu-id="7f5aa-150">Questa operazione è necessaria per poter usare gli script di automazione di Azure per connettere le destinazioni iSCSI dopo il failover eseguito da Azure Site Recovery.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-150">This is required so that you can use Azure automation scripts to connect the iSCSI targets after fail over by Azure Site Recovery.</span></span>

   1. <span data-ttu-id="7f5aa-151">Premere il tasto Windows + Q e cercare **UAC**.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-151">Press the Windows key +Q and search for **UAC**.</span></span>
   2. <span data-ttu-id="7f5aa-152">Selezionare **Modifica impostazioni di Controllo dell'account utente**.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-152">Select **Change User Account Control settings**.</span></span>
   3. <span data-ttu-id="7f5aa-153">Trascinare la barra in basso verso **Non notificare mai**.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-153">Drag the bar to the bottom towards **Never Notify**.</span></span>
   4. <span data-ttu-id="7f5aa-154">Fare clic su **OK**, quindi selezionare **Sì** quando richiesto.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-154">Click **OK** and then select **Yes** when prompted.</span></span>

      ![](./media/storsimple-disaster-recovery-using-azure-site-recovery/image1.png)
2. <span data-ttu-id="7f5aa-155">Installare l'agente VM su ciascuna delle VM del file server.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-155">Install the VM Agent on each of the file server VMs.</span></span> <span data-ttu-id="7f5aa-156">Questa operazione è necessaria per poter eseguire gli script di automazione di Azure sulle VM sottoposte a failover.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-156">This is required so that you can run Azure automation scripts on the failed over VMs.</span></span>

   1. <span data-ttu-id="7f5aa-157">[Scaricare l'agente](http://aka.ms/vmagentwin) in `C:\\Users\\<username>\\Downloads`.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-157">[Download the agent](http://aka.ms/vmagentwin) to `C:\\Users\\<username>\\Downloads`.</span></span>
   2. <span data-ttu-id="7f5aa-158">Aprire Windows PowerShell in modalità amministratore (Esegui come amministratore) e quindi immettere il comando seguente per passare al percorso di download:</span><span class="sxs-lookup"><span data-stu-id="7f5aa-158">Open Windows PowerShell in Administrator mode (Run as Administrator), and then enter the following command to navigate to the download location:</span></span>

      `cd C:\\Users\\<username>\\Downloads\\WindowsAzureVmAgent.2.6.1198.718.rd\_art\_stable.150415-1739.fre.msi`

      > [!NOTE]
      > <span data-ttu-id="7f5aa-159">Il nome file può cambiare a seconda della versione.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-159">The file name may change depending on the version.</span></span>
      >
      >
3. <span data-ttu-id="7f5aa-160">Fare clic su **Avanti**.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-160">Click **Next**.</span></span>
4. <span data-ttu-id="7f5aa-161">Accettare le **condizioni del contratto** e quindi fare clic su **Avanti**.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-161">Accept the **Terms of Agreement** and then click **Next**.</span></span>
5. <span data-ttu-id="7f5aa-162">Fare clic su **Fine**.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-162">Click **Finish**.</span></span>
6. <span data-ttu-id="7f5aa-163">Creare condivisioni file usando volumi ottenuti dall'archiviazione StorSimple.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-163">Create file shares using volumes carved out of StorSimple storage.</span></span> <span data-ttu-id="7f5aa-164">Per maggiori informazioni, vedere l'articolo [Usare il servizio StorSimple Manager per gestire i volumi](storsimple-manage-volumes.md).</span><span class="sxs-lookup"><span data-stu-id="7f5aa-164">For more information, see [Use the StorSimple Manager service to manage volumes](storsimple-manage-volumes.md).</span></span>

   1. <span data-ttu-id="7f5aa-165">Nelle macchine virtuali locali premere il tasto Windows + Q e cercare **iSCSI**.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-165">On your on-premises VMs, press the Windows key +Q and search for **iSCSI**.</span></span>
   2. <span data-ttu-id="7f5aa-166">Selezionare **Iniziatore iSCSI**.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-166">Select **iSCSI initiator**.</span></span>
   3. <span data-ttu-id="7f5aa-167">Selezionare la scheda **Configurazione** e copiare il nome dell'iniziatore.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-167">Select the **Configuration** tab and copy the initiator name.</span></span>
   4. <span data-ttu-id="7f5aa-168">Accedere al [Portale di Azure](https://portal.azure.com/).</span><span class="sxs-lookup"><span data-stu-id="7f5aa-168">Log in to the [Azure portal](https://portal.azure.com/).</span></span>
   5. <span data-ttu-id="7f5aa-169">Selezionare la scheda **StorSimple** e quindi selezionare il servizio StorSimple Manager che contiene il dispositivo fisico.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-169">Select the **StorSimple** tab and then select the StorSimple Manager Service that contains the physical device.</span></span>
   6. <span data-ttu-id="7f5aa-170">Creare i contenitori di volumi e quindi creare i volumi</span><span class="sxs-lookup"><span data-stu-id="7f5aa-170">Create volume container(s) and then create volume(s).</span></span> <span data-ttu-id="7f5aa-171">(questi volumi sono destinati alle condivisione file nella macchine virtuali del file server).</span><span class="sxs-lookup"><span data-stu-id="7f5aa-171">(These volumes are for the file share(s) on the file server VMs).</span></span> <span data-ttu-id="7f5aa-172">Copiare il nome dell'iniziatore e assegnare un nome appropriato per i record di controllo di accesso quando si creano i volumi.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-172">Copy the initiator name and give an appropriate name for the Access Control Records when you create the volumes.</span></span>
   7. <span data-ttu-id="7f5aa-173">Selezionare la scheda **Configura** e prendere nota dell'indirizzo IP del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-173">Select the **Configure** tab and note down the IP address of the device.</span></span>
   8. <span data-ttu-id="7f5aa-174">Nelle macchine virtuali locali tornare a **Iniziatore iSCSI** e immettere l'indirizzo IP nella sezione connessione rapida.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-174">On your on-premises VMs, go to the **iSCSI initiator** again and enter the IP in the Quick Connect section.</span></span> <span data-ttu-id="7f5aa-175">Fare clic su **Connessione rapida** (il dispositivo ora deve essere connesso).</span><span class="sxs-lookup"><span data-stu-id="7f5aa-175">Click **Quick Connect** (the device should now be connected).</span></span>
   9. <span data-ttu-id="7f5aa-176">Aprire il portale di Azure e selezionare la scheda **Volumi e dispositivi**.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-176">Open the Azure portal and select the **Volumes and Devices** tab.</span></span> <span data-ttu-id="7f5aa-177">Fare clic su **Configura automaticamente**.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-177">Click **Auto Configure**.</span></span> <span data-ttu-id="7f5aa-178">Viene visualizzato il volume appena creato.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-178">The volume that you just created should appear.</span></span>
   10. <span data-ttu-id="7f5aa-179">Nel portale selezionare la scheda **Dispositivi** e quindi selezionare **Create a New Virtual Device** (Crea un nuovo dispositivo virtuale)</span><span class="sxs-lookup"><span data-stu-id="7f5aa-179">In the portal, select the **Devices** tab and then select **Create a New Virtual Device.**</span></span> <span data-ttu-id="7f5aa-180">(il dispositivo virtuale verrà usato se si verifica un failover).</span><span class="sxs-lookup"><span data-stu-id="7f5aa-180">(This virtual device will be used if a failover occurs).</span></span> <span data-ttu-id="7f5aa-181">Il nuovo dispositivo virtuale può essere mantenuto in uno stato offline per evitare costi aggiuntivi.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-181">This new virtual device can be kept in an offline state to avoid extra costs.</span></span> <span data-ttu-id="7f5aa-182">Per portare offline il dispositivo virtuale, passare alla sezione **Macchine virtuali** nel portale e arrestarlo.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-182">To take the virtual device offline, go to the **Virtual Machines** section on the Portal and shut it down.</span></span>
   11. <span data-ttu-id="7f5aa-183">Tornare alle macchine virtuali locali e aprire Gestione disco (premere il tasto Windows + X, quindi selezionare **Gestione disco**).</span><span class="sxs-lookup"><span data-stu-id="7f5aa-183">Go back to the on-premises VMs and open Disk Management (press the Windows key + X and select **Disk Management**).</span></span>
   12. <span data-ttu-id="7f5aa-184">Si noteranno alcuni dischi aggiuntivi (a seconda del numero di volumi creati).</span><span class="sxs-lookup"><span data-stu-id="7f5aa-184">You will notice some extra disks (depending on the number of volumes you have created).</span></span> <span data-ttu-id="7f5aa-185">Fare clic con il pulsante destro del mouse sul primo disco e scegliere **Inizializza disco**, quindi fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-185">Right-click the first one, select **Initialize Disk**, and select **OK**.</span></span> <span data-ttu-id="7f5aa-186">Fare doppio clic sulla sezione **Non allocato**, selezionare **Nuovo volume semplice**, assegnare una lettera di unità al volume e completare la procedura guidata.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-186">Right-click the **Unallocated** section, select **New Simple Volume**, assign it a drive letter, and finish the wizard.</span></span>
   13. <span data-ttu-id="7f5aa-187">Ripetere il primo passaggio per tutti i dischi.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-187">Repeat step l for all the disks.</span></span> <span data-ttu-id="7f5aa-188">È ora possibile visualizzare tutti i dischi in **Computer** in Esplora risorse di Windows.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-188">You can now see all the disks on **This PC** in the Windows Explorer.</span></span>
   14. <span data-ttu-id="7f5aa-189">Usare il ruolo Servizi file e archiviazione per creare condivisioni file in tali volumi.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-189">Use the File and Storage Services role to create file shares on these volumes.</span></span>

#### <a name="to-create-and-prepare-an-azure-site-recovery-vault"></a><span data-ttu-id="7f5aa-190">Per creare un insieme di credenziali di Azure Site Recovery</span><span class="sxs-lookup"><span data-stu-id="7f5aa-190">To create and prepare an Azure Site Recovery vault</span></span>
<span data-ttu-id="7f5aa-191">Vedere la [documentazione di Azure Site Recovery](../site-recovery/site-recovery-hyper-v-site-to-azure.md) per iniziare a usare Azure Site Recovery prima di proteggere la VM del file server.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-191">Refer to the [Azure Site Recovery documentation](../site-recovery/site-recovery-hyper-v-site-to-azure.md) to get started with Azure Site Recovery before protecting the file server VM.</span></span>

#### <a name="to-enable-protection"></a><span data-ttu-id="7f5aa-192">Per abilitare la protezione</span><span class="sxs-lookup"><span data-stu-id="7f5aa-192">To enable protection</span></span>
1. <span data-ttu-id="7f5aa-193">Disconnettere le destinazioni iSCSI dalle macchine virtuali locali che si vuole proteggere con Azure Site Recovery:</span><span class="sxs-lookup"><span data-stu-id="7f5aa-193">Disconnect the iSCSI target(s) from the on-premises VMs that you want to protect through Azure Site Recovery:</span></span>

   1. <span data-ttu-id="7f5aa-194">Premere il tasto Windows + Q e cercare **iSCSI**.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-194">Press Windows key + Q and search for **iSCSI**.</span></span>
   2. <span data-ttu-id="7f5aa-195">Selezionare **Configura iniziatore iSCSI**.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-195">Select **Set up iSCSI initiator**.</span></span>
   3. <span data-ttu-id="7f5aa-196">Disconnettere il dispositivo StorSimple connesso in precedenza.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-196">Disconnect the StorSimple device that you connected previously.</span></span> <span data-ttu-id="7f5aa-197">In alternativa, è possibile disattivare il file server per alcuni minuti quando si abilita la protezione.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-197">Alternatively, you can switch off the file server for a few minutes when enabling protection.</span></span>

   > [!NOTE]
   > <span data-ttu-id="7f5aa-198">In questo modo, le condivisioni file saranno temporaneamente non disponibili.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-198">This will cause the file shares to be temporarily unavailable.</span></span>
   >
   >
2. <span data-ttu-id="7f5aa-199">[Abilitare la protezione delle macchine virtuali](../site-recovery/site-recovery-hyper-v-site-to-azure.md) della VM del file server dal Portale di Azure Site Recovery.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-199">[Enable virtual machine protection](../site-recovery/site-recovery-hyper-v-site-to-azure.md) of the file server VM from the Azure Site Recovery portal.</span></span>
3. <span data-ttu-id="7f5aa-200">Quando viene avviata la sincronizzazione iniziale, è possibile riconnettere nuovamente la destinazione.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-200">When the initial synchronization begins, you can reconnect the target again.</span></span> <span data-ttu-id="7f5aa-201">Passare all'iniziatore iSCSI, selezionare un dispositivo StorSimple e fare clic su **Connetti**.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-201">Go to the iSCSI initiator, select the StorSimple device, and click **Connect**.</span></span>
4. <span data-ttu-id="7f5aa-202">Quando la sincronizzazione è completa e lo stato della VM è **Protetta**, selezionare la VM, selezionare la scheda **Configura** e aggiornare di conseguenza la rete della VM (si tratta della rete di cui faranno parte le VM sottoposte a failover).</span><span class="sxs-lookup"><span data-stu-id="7f5aa-202">When the synchronization is complete and the status of the VM is **Protected**, select the VM, select the **Configure** tab, and update the network of the VM accordingly (this is the network that the failed over VM(s) will be a part of).</span></span> <span data-ttu-id="7f5aa-203">Se la scheda non viene visualizzata, la sincronizzazione è ancora in corso.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-203">If the network doesn’t show up, it means that the sync is still going on.</span></span>

### <a name="enable-protection-of-storsimple-volumes"></a><span data-ttu-id="7f5aa-204">Abilitare la protezione dei volumi StorSimple</span><span class="sxs-lookup"><span data-stu-id="7f5aa-204">Enable protection of StorSimple volumes</span></span>
<span data-ttu-id="7f5aa-205">Se non è stata selezionata l'opzione **Abilita un criterio di backup predefinito per questo volume** per i volumi StorSimple, andare su **Criteri di backup** nel servizio StorSimple Manager e creare un criterio di backup appropriato per tutti i volumi.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-205">If you have not selected the **Enable a default backup for this volume** option for the StorSimple volumes, go to **Backup Policies** in the StorSimple Manager service, and create a suitable backup policy for all the volumes.</span></span> <span data-ttu-id="7f5aa-206">È consigliabile impostare la frequenza dei backup per l'obiettivo del punto di ripristino (RPO) che si vuole visualizzare per l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-206">We recommend that you set the frequency of backups to the recovery point objective (RPO) that you would like to see for the application.</span></span>

### <a name="configure-the-network"></a><span data-ttu-id="7f5aa-207">Configurare la rete</span><span class="sxs-lookup"><span data-stu-id="7f5aa-207">Configure the network</span></span>
<span data-ttu-id="7f5aa-208">Per la VM del file server configurare le impostazioni di rete in Azure Site Recovery in modo che le reti di VM siano collegate alla rete di ripristino di emergenza corretta dopo il failover.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-208">For the file server VM, configure network settings in Azure Site Recovery so that the VM networks are attached to the correct DR network after failover.</span></span>

<span data-ttu-id="7f5aa-209">È possibile selezionare la VM nella scheda **Elementi replicati** per configurare le impostazioni di rete, come mostrato nell'illustrazione seguente.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-209">You can select the VM in the **Replicated items** tab to configure the network settings, as shown in the following illustration.</span></span>

![](./media/storsimple-disaster-recovery-using-azure-site-recovery/image2.png)

## <a name="create-a-recovery-plan"></a><span data-ttu-id="7f5aa-210">Creare un piano di ripristino</span><span class="sxs-lookup"><span data-stu-id="7f5aa-210">Create a recovery plan</span></span>
<span data-ttu-id="7f5aa-211">È possibile creare un piano di ripristino in ASR per automatizzare il processo di failover delle condivisioni file.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-211">You can create a recovery plan in ASR to automate the failover process of the file shares.</span></span> <span data-ttu-id="7f5aa-212">Se si verifica un'interruzione, è possibile visualizzare le condivisioni file in pochi minuti con un semplice clic.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-212">If a disruption occurs, you can bring the file shares up in a few minutes with just a single click.</span></span> <span data-ttu-id="7f5aa-213">Per abilitare l'automazione, è necessario un account di Automazione di Azure.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-213">To enable this automation, you will need an Azure automation account.</span></span>

#### <a name="to-create-an-automation-account"></a><span data-ttu-id="7f5aa-214">Per creare un account di Automazione</span><span class="sxs-lookup"><span data-stu-id="7f5aa-214">To create an Automation account</span></span>
1. <span data-ttu-id="7f5aa-215">Passare al portale di Azure &gt; sezione **Automazione**.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-215">Go to the Azure portal &gt; **Automation** section.</span></span>
2. <span data-ttu-id="7f5aa-216">Fare clic sul pulsante **+ Aggiungi** e viene aperto il pannello sotto.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-216">Click **+ Add** button, opens below blade.</span></span>

   ![](./media/storsimple-disaster-recovery-using-azure-site-recovery/image11.png)

   * <span data-ttu-id="7f5aa-217">Nome: immettere un nuovo account di automazione</span><span class="sxs-lookup"><span data-stu-id="7f5aa-217">Name - Enter a new automation account</span></span>
   * <span data-ttu-id="7f5aa-218">Sottoscrizione: scegliere la sottoscrizione</span><span class="sxs-lookup"><span data-stu-id="7f5aa-218">Subscription - Choose subscription</span></span>
   * <span data-ttu-id="7f5aa-219">Gruppo di risorse: creare un nuovo gruppo di risorse o sceglierne uno esistente</span><span class="sxs-lookup"><span data-stu-id="7f5aa-219">Resource group - Create new/choose existing resource group</span></span>
   * <span data-ttu-id="7f5aa-220">Posizione: scegliere la posizione, usare la stessa area geografica/area in cui sono stati creati gli account dell'appliance cloud StorSimple e di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-220">Location - Choose location, keep it in the same geo/region in which the StorSimple Cloud Appliance and Storage Accounts were created.</span></span>
   * <span data-ttu-id="7f5aa-221">Creare un account RunAs di Azure: selezionare l'opzione **Sì**.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-221">Create Azure Run As account - Select **Yes** option.</span></span>

3. <span data-ttu-id="7f5aa-222">Passare all'account di automazione, fare clic su **Runbook** &gt; **Sfoglia raccolta** per importare tutti i runbook richiesti nell'account di automazione.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-222">Go to the Automation account, click **Runbooks** &gt; **Browse Gallery** to import all the required runbooks into the automation account.</span></span>
4. <span data-ttu-id="7f5aa-223">Aggiungere i runbook seguenti individuando il tag **Ripristino di emergenza** nella raccolta:</span><span class="sxs-lookup"><span data-stu-id="7f5aa-223">Add the following runbooks by finding **Disaster Recovery** tag in the gallery:</span></span>

   * <span data-ttu-id="7f5aa-224">Eliminare i volumi StorSimple dopo il failover di test</span><span class="sxs-lookup"><span data-stu-id="7f5aa-224">Clean up of StorSimple volumes after Test Failover (TFO)</span></span>
   * <span data-ttu-id="7f5aa-225">Eseguire il failover dei contenitori dei volumi StorSimple</span><span class="sxs-lookup"><span data-stu-id="7f5aa-225">Failover StorSimple volume containers</span></span>
   * <span data-ttu-id="7f5aa-226">Montare i volumi nel dispositivo StorSimple dopo il failover</span><span class="sxs-lookup"><span data-stu-id="7f5aa-226">Mount volumes on StorSimple device after failover</span></span>
   * <span data-ttu-id="7f5aa-227">Disinstallare l'estensione script personalizzata in una VM di Azure</span><span class="sxs-lookup"><span data-stu-id="7f5aa-227">Uninstall custom script extension in Azure VM</span></span>
   * <span data-ttu-id="7f5aa-228">Avviare l'appliance virtuale StorSimple</span><span class="sxs-lookup"><span data-stu-id="7f5aa-228">Start StorSimple Virtual Appliance</span></span>

     ![](./media/storsimple-disaster-recovery-using-azure-site-recovery/image3.png)

5. <span data-ttu-id="7f5aa-229">Pubblicare tutti gli script selezionando il runbook nell'account di automazione e fare clic su **Modifica** &gt; **Pubblica** e quindi **Sì** al messaggio di verifica.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-229">Publish all the scripts by selecting the runbook in the automation account and click **Edit** &gt; **Publish** and then **Yes** to the verification message.</span></span> <span data-ttu-id="7f5aa-230">Dopo questo passaggio, la scheda **Runbook** verrà visualizzata come segue:</span><span class="sxs-lookup"><span data-stu-id="7f5aa-230">After this step, the **Runbooks** tab will appear as follows:</span></span>

    ![](./media/storsimple-disaster-recovery-using-azure-site-recovery/image4.png)

6. <span data-ttu-id="7f5aa-231">Nell'account di automazione selezionare la scheda **Asset** &gt; fare clic su **Variabili** &gt; **Aggiungi variabile** e aggiungere le variabili seguenti.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-231">In the automation account, select the **Assets** tab &gt; click **Variables** &gt; **Add a variable** and add the following variables.</span></span> <span data-ttu-id="7f5aa-232">È possibile scegliere di crittografare questi asset.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-232">You can choose to encrypt these assets.</span></span> <span data-ttu-id="7f5aa-233">Queste variabili sono specifiche del piano di ripristino.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-233">These variables are recovery plan–specific.</span></span> <span data-ttu-id="7f5aa-234">Se il nome del piano di ripristino (che verrà creato nel passaggio successivo) è TestPlan, le variabili devono essere TestPlan-StorSimRegKey, TestPlan-AzureSubscriptionName e così via.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-234">If your recovery plan (which you will create in the next step) name is TestPlan, then your variables should be TestPlan-StorSimRegKey, TestPlan-AzureSubscriptionName, and so on.</span></span>

   * <span data-ttu-id="7f5aa-235">*RecoveryPlanName***-StorSimRegKey**: la chiave di registrazione per il servizio StorSimple Manager.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-235">*RecoveryPlanName***-StorSimRegKey**: The registration key for the StorSimple Manager service.</span></span>
   * <span data-ttu-id="7f5aa-236">*RecoveryPlanName***-AzureSubscriptionName**: il nome della sottoscrizione Azure.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-236">*RecoveryPlanName***-AzureSubscriptionName**: The name of the Azure subscription.</span></span>
   * <span data-ttu-id="7f5aa-237">*RecoveryPlanName***-ResourceName**: il nome della risorsa StorSimple con il dispositivo StorSimple.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-237">*RecoveryPlanName***-ResourceName**: The name of the StorSimple resource that has the StorSimple device.</span></span>
   * <span data-ttu-id="7f5aa-238">*RecoveryPlanName***-DeviceName**: il dispositivo che deve essere sottoposto a failover.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-238">*RecoveryPlanName***-DeviceName**: The device that has to be failed over.</span></span>
   * <span data-ttu-id="7f5aa-239">*RecoveryPlanName***-VolumeContainers**: una stringa con valori delimitati da virgole dei contenitori di volumi presenti sul dispositivo che devono essere sottoposti a failover, ad esempio, volcon1, volcon2, volcon3.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-239">*RecoveryPlanName***-VolumeContainers**: A comma-separated string of volume containers present on the device that need to be failed over; for example, volcon1,volcon2, volcon3.</span></span>
   * <span data-ttu-id="7f5aa-240">*RecoveryPlanName***-TargetDeviceName**: l'appliance cloud di StorSimple in cui eseguire il failover dei contenitori.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-240">*RecoveryPlanName***-TargetDeviceName**: The StorSimple Cloud Appliance on which the containers are to be failed over.</span></span>
   * <span data-ttu-id="7f5aa-241">*RecoveryPlanName***-TargetDeviceDnsName**: il nome del servizio del dispositivo di destinazione (disponibile nella sezione **Macchina virtuale**. Il nome del servizio è uguale al nome DNS).</span><span class="sxs-lookup"><span data-stu-id="7f5aa-241">*RecoveryPlanName***-TargetDeviceDnsName**: The service name of the target device (this can be found in the **Virtual Machine** section: the service name is the same as the DNS name).</span></span>
   * <span data-ttu-id="7f5aa-242">*RecoveryPlanName***-StorageAccountName**: il nome dell'account di archiviazione in cui verrà archiviato lo script (che deve essere eseguito nella VM sottoposta a failover).</span><span class="sxs-lookup"><span data-stu-id="7f5aa-242">*RecoveryPlanName***-StorageAccountName**: The storage account name in which the script (which has to run on the failed over VM) will be stored.</span></span> <span data-ttu-id="7f5aa-243">Può trattarsi di qualsiasi account di archiviazione in cui sia disponibile spazio per l'archiviazione temporanea dello script.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-243">This can be any storage account that has some space to store the script temporarily.</span></span>
   * <span data-ttu-id="7f5aa-244">*RecoveryPlanName***-StorageAccountKey**: la chiave di accesso per l'account di archiviazione indicato in precedenza.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-244">*RecoveryPlanName***-StorageAccountKey**: The access key for the above storage account.</span></span>
   * <span data-ttu-id="7f5aa-245">*RecoveryPlanName***-ScriptContainer**: il nome del contenitore in cui lo script verrà archiviato nel cloud.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-245">*RecoveryPlanName***-ScriptContainer**: The name of the container in which the script will be stored in the cloud.</span></span> <span data-ttu-id="7f5aa-246">Se il contenitore non esiste, verrà creato.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-246">If the container doesn’t exist, it will be created.</span></span>
   * <span data-ttu-id="7f5aa-247">*RecoveryPlanName***-VMGUIDS**: al momento di proteggere una VM, Azure Site Recovery assegna a ogni VM virtuale un ID univoco che fornisce i dettagli della VM sottoposta a failover.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-247">*RecoveryPlanName***-VMGUIDS**: Upon protecting a VM, Azure Site Recovery assigns every VM a unique ID that gives the details of the failed over VM.</span></span> <span data-ttu-id="7f5aa-248">Per ottenere VMGUID, selezionare la scheda **Servizi di ripristino** e quindi fare clic su **Elemento protetto** &gt; **Gruppi di protezione** &gt; **Macchine** &gt; **Proprietà**.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-248">To obtain the VMGUID, select the **Recovery Services** tab and click **Protected Item** &gt; **Protection Groups** &gt; **Machines** &gt; **Properties**.</span></span> <span data-ttu-id="7f5aa-249">Se sono presenti più VM, aggiungere i GUID come stringa con valori delimitati da virgole.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-249">If you have multiple VMs, then add the GUIDs as a comma-separated string.</span></span>
   * <span data-ttu-id="7f5aa-250">*RecoveryPlanName***-AutomationAccountName**: il nome dell'account di automazione in cui sono stati aggiunti i runbook e gli asset.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-250">*RecoveryPlanName***-AutomationAccountName** – The name of the automation account in which you have added the runbooks and the assets.</span></span>

  <span data-ttu-id="7f5aa-251">Ad esempio, se il nome del piano di ripristino è fileServerpredayRP, le schede **Credenziali**  &  **Variabili** dovrebbero essere visualizzate come segue dopo aver aggiunto tutti gli asset.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-251">For example, if the name of the recovery plan is fileServerpredayRP, then your **Credentials** & **Variables** tabs should appear as follows after you add all the assets.</span></span>

   ![](./media/storsimple-disaster-recovery-using-azure-site-recovery/image5.png)

7. <span data-ttu-id="7f5aa-252">Passare alla sezione **Servizi di ripristino** e selezionare l'insieme di credenziali di Azure Site Recovery creato in precedenza.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-252">Go to the **Recovery Services** section and select the Azure Site Recovery vault that you created earlier.</span></span>
8. <span data-ttu-id="7f5aa-253">Selezionare l'opzione **Piani di ripristino (Site Recovery)** dal gruppo **Gestisci** e creare un nuovo piano di ripristino come segue:</span><span class="sxs-lookup"><span data-stu-id="7f5aa-253">Select the **Recovery Plans (Site Recovery)** option from **Manage** group and create a new recovery plan as follows:</span></span>

   <span data-ttu-id="7f5aa-254">a.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-254">a.</span></span>  <span data-ttu-id="7f5aa-255">Fare clic sul pulsante **+ Piano di ripristino**. Verrà visualizzato il pannello seguente.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-255">Click **+ Recover plan** button, opens below blade.</span></span>

      ![](./media/storsimple-disaster-recovery-using-azure-site-recovery/image6.png)

   <span data-ttu-id="7f5aa-256">b.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-256">b.</span></span>  <span data-ttu-id="7f5aa-257">Immettere un nome del piano di ripristino e scegliere i valori di Origine, Destinazione e Modello di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-257">Enter a recovery plan name, choose Source, Target & Deployment model values.</span></span>

   <span data-ttu-id="7f5aa-258">c.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-258">c.</span></span>  <span data-ttu-id="7f5aa-259">Selezionare le VM dal gruppo protezione dati che si vuole includere nel piano di ripristino e fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-259">Select the VMs from the protection group that you want to include in the recovery plan and click **OK** button.</span></span>

   <span data-ttu-id="7f5aa-260">d.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-260">d.</span></span>  <span data-ttu-id="7f5aa-261">Selezionare il piano di ripristino creato in precedenza, fare clic sul pulsante **Personalizza** per aprire la visualizzazione di personalizzazione del piano di ripristino.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-261">Select Recovery plan that you created earlier, click **Customize** button to open the Recovery plan customization view.</span></span>

   <span data-ttu-id="7f5aa-262">e.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-262">e.</span></span>  <span data-ttu-id="7f5aa-263">Fare clic con il pulsante destro su **Spegnimento di tutti i gruppi** e fare clic su **Aggiungi pre-azione**.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-263">Right click on **All groups shutdown** and click **Add pre action**.</span></span>

   <span data-ttu-id="7f5aa-264">f.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-264">f.</span></span>  <span data-ttu-id="7f5aa-265">Nel pannello di inserimento azione immettere un nome, selezionare l'opzione **Lato primario** in Posizione di esecuzione, selezionare l'account di automazione (in cui sono stati aggiunti i runbook) e quindi selezionare il runbook **Container Failover-StorSimple-Volume**.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-265">Opens Insert action blade, enter a name, select **Primary side** option in Where to run option, select Automation account (in which you added the runbooks) and then select the **Failover-StorSimple-Volume-Containers** runbook.</span></span>

   <span data-ttu-id="7f5aa-266">g.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-266">g.</span></span>  <span data-ttu-id="7f5aa-267">Fare clic con il pulsante destro del mouse su **Gruppo 1: avvio**, fare clic sull'opzione **Aggiungi elementi protetti**, selezionare le macchine virtuali che devono essere protette nel piano di ripristino e quindi fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-267">Right click on **Group 1: Start** and click **Add protected items** option then select the VMs that are to be protected in the recovery plan and Click **Ok** button.</span></span> <span data-ttu-id="7f5aa-268">Facoltativo se le VM sono già selezionate.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-268">Optional, if it's already selected VMs.</span></span>

   <span data-ttu-id="7f5aa-269">h.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-269">h.</span></span>  <span data-ttu-id="7f5aa-270">Fare clic con il pulsante destro del mouse su **Gruppo 1: avvio**, fare clic sull'opzione **Registra azione** e quindi aggiungere tutti gli script seguenti:</span><span class="sxs-lookup"><span data-stu-id="7f5aa-270">Right click on **Group 1: Start** and click **Post action** option then add all the following scripts:</span></span>

   * <span data-ttu-id="7f5aa-271">Runbook Start-StorSimple-Virtual-Appliance</span><span class="sxs-lookup"><span data-stu-id="7f5aa-271">Start-StorSimple-Virtual-Appliance runbook</span></span>
   * <span data-ttu-id="7f5aa-272">Runbook Fail over-StorSimple-volume-containers</span><span class="sxs-lookup"><span data-stu-id="7f5aa-272">Fail over-StorSimple-volume-containers runbook</span></span>
   * <span data-ttu-id="7f5aa-273">Runbook Mount-volumes-after-failover</span><span class="sxs-lookup"><span data-stu-id="7f5aa-273">Mount-volumes-after-failover runbook</span></span>
   * <span data-ttu-id="7f5aa-274">Runbook Uninstall-custom-script-extension</span><span class="sxs-lookup"><span data-stu-id="7f5aa-274">Uninstall-custom-script-extension runbook</span></span>

   <span data-ttu-id="7f5aa-275">i.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-275">i.</span></span>  <span data-ttu-id="7f5aa-276">Aggiungere un'azione manuale dopo i quattro script precedenti nella stessa sezione **Gruppo 1: passaggi successivi** .</span><span class="sxs-lookup"><span data-stu-id="7f5aa-276">Add a manual action after the above 4 scripts in the same **Group 1: Post-steps** section.</span></span> <span data-ttu-id="7f5aa-277">Questa azione corrisponde al punto in cui è possibile verificare il corretto funzionamento.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-277">This action is the point at which you can verify that everything is working correctly.</span></span> <span data-ttu-id="7f5aa-278">Questa azione deve essere aggiunta solo come parte del failover di test (selezionare quindi solo la casella di controllo **Failover di test**).</span><span class="sxs-lookup"><span data-stu-id="7f5aa-278">This action needs to be added only as a part of Test failover (so only select the **Test Failover** checkbox).</span></span>

   <span data-ttu-id="7f5aa-279">j.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-279">j.</span></span>  <span data-ttu-id="7f5aa-280">Dopo l'azione manuale, aggiungere lo script di **pulizia** con la stessa procedura usata per gli altri runbook.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-280">After the manual action, add the **Cleanup** script using the same procedure that you used for the other runbooks.</span></span> <span data-ttu-id="7f5aa-281">**Salvare** il piano di ripristino.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-281">**Save** the recovery plan.</span></span>

    > [!NOTE]
    > <span data-ttu-id="7f5aa-282">Quando si esegue un failover di test, è necessario verificare tutti gli aspetti del passaggio relativo all'azione manuale perché i volumi StorSimple clonati sul dispositivo di destinazione verranno eliminati come parte della pulizia dopo il completamento dell'azione manuale.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-282">When running a test failover, you should verify everything at the manual action step because the StorSimple volumes that had been cloned on the target device will be deleted as a part of the cleanup after the manual action is completed.</span></span>
    >

    ![](./media/storsimple-disaster-recovery-using-azure-site-recovery/image7.png)

## <a name="perform-a-test-failover"></a><span data-ttu-id="7f5aa-283">Eseguire un failover di test</span><span class="sxs-lookup"><span data-stu-id="7f5aa-283">Perform a test failover</span></span>
<span data-ttu-id="7f5aa-284">Consultare la guida complementare relativa alla [soluzione di ripristino di emergenza di Active Directory](../site-recovery/site-recovery-active-directory.md) per considerazioni specifiche relative a Active Directory durante il failover di test.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-284">Refer to the [Active Directory DR Solution](../site-recovery/site-recovery-active-directory.md) companion guide for considerations specific to Active Directory during the test failover.</span></span> <span data-ttu-id="7f5aa-285">L'installazione locale non viene disturbata in alcun modo quando si verifica il failover di test.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-285">The on-premises setup is not disturbed at all when the test failover occurs.</span></span> <span data-ttu-id="7f5aa-286">I volumi StorSimple che erano collegati alla VM locale vengono clonati nell'appliance cloud StorSimple in Azure.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-286">The StorSimple volumes that were attached to the on-premises VM are cloned to the StorSimple Cloud Appliance on Azure.</span></span> <span data-ttu-id="7f5aa-287">A scopo di test, in Azure viene visualizzata una VM alla quale vengono collegati i volumi clonati.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-287">A VM for test purposes is brought up in Azure and the cloned volumes are attached to the VM.</span></span>

#### <a name="to-perform-the-test-failover"></a><span data-ttu-id="7f5aa-288">Per eseguire il failover di test</span><span class="sxs-lookup"><span data-stu-id="7f5aa-288">To perform the test failover</span></span>
1. <span data-ttu-id="7f5aa-289">Nel portale di Azure selezionare il proprio insieme di credenziali di Site Recovery.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-289">In the Azure portal, select your site recovery vault.</span></span>
2. <span data-ttu-id="7f5aa-290">Fare clic sul piano di ripristino creato per la VM del file server.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-290">Click the recovery plan created for the file server VM.</span></span>
3. <span data-ttu-id="7f5aa-291">Fare clic su **Failover di test**.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-291">Click **Test Failover**.</span></span>
4. <span data-ttu-id="7f5aa-292">Selezionare la rete virtuale di Azure a cui dovranno connettersi le VM di Azure dopo il failover.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-292">Select the Azure virtual network to which Azure VMs will be connected after failover occurs.</span></span>

   ![](./media/storsimple-disaster-recovery-using-azure-site-recovery/image8.png)
5. <span data-ttu-id="7f5aa-293">Fare clic su **OK** per iniziare il failover.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-293">Click **OK** to begin the failover.</span></span> <span data-ttu-id="7f5aa-294">Per tenere traccia dello stato del processo, fare clic sulla VM per visualizzarne le proprietà oppure fare clic sul processo **Failover di test** nel nome dell'insieme di credenziali &gt; **Processi** &gt; **Processi di Site Recovery**.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-294">You can track progress by clicking on the VM to open its properties, or on the **Test failover job** in vault name &gt; **Jobs** &gt; **Site Recovery jobs**.</span></span>
6. <span data-ttu-id="7f5aa-295">Al termine del failover dovrebbe essere possibile visualizzare nel portale di Azure &gt; **Macchine virtuali** anche la macchina virtuale di Azure di replica.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-295">After the failover completes, you should also be able to see the replica Azure machine appear in the Azure portal &gt; **Virtual Machines**.</span></span> <span data-ttu-id="7f5aa-296">È possibile eseguire le operazioni di convalida.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-296">You can perform your validations.</span></span>
7. <span data-ttu-id="7f5aa-297">Al termine delle convalide, fare clic su **Convalide complete**.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-297">After the validations are done, click **Validations Complete**.</span></span> <span data-ttu-id="7f5aa-298">Verrà eseguita la pulizia dei volumi di StorSimple e verrà arrestata l'appliance cloud StorSimple.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-298">This will cleanup the StorSimple Volumes and shutdown the StorSimple Cloud Appliance.</span></span>
8. <span data-ttu-id="7f5aa-299">Al termine, fare clic su **Cleanup test failover** (Pulizia failover di test) nel piano di ripristino.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-299">Once you're done, click **Cleanup test failover** on the recovery plan.</span></span> <span data-ttu-id="7f5aa-300">Usare le Note per registrare e salvare eventuali osservazioni associate al failover di test.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-300">In Notes record and save any observations associated with the test failover.</span></span> <span data-ttu-id="7f5aa-301">Verranno eliminate le macchine virtuali create durante il failover di test.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-301">This will delete the virtual machine that were created during test failover.</span></span>

## <a name="perform-a-planned-failover"></a><span data-ttu-id="7f5aa-302">Eseguire un failover pianificato</span><span class="sxs-lookup"><span data-stu-id="7f5aa-302">Perform a planned failover</span></span>
   <span data-ttu-id="7f5aa-303">Durante un failover pianificato la VM del file server locale viene arrestata correttamente e viene eseguita una snapshot di un backup su cloud dei volumi nel dispositivo StorSimple.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-303">During a planned failover, the on-premises file server VM is shut down gracefully and a cloud backup snapshot of the volumes on StorSimple device is taken.</span></span> <span data-ttu-id="7f5aa-304">I volumi StorSimple vengono sottoposti a failover nel dispositivo virtuale, una VM di replica viene visualizzata in Azure e i volumi vengono collegati alla VM.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-304">The StorSimple volumes are failed over to the virtual device, a replica VM is brought up on Azure, and the volumes are attached to the VM.</span></span>

#### <a name="to-perform-a-planned-failover"></a><span data-ttu-id="7f5aa-305">Per eseguire un failover pianificato</span><span class="sxs-lookup"><span data-stu-id="7f5aa-305">To perform a planned failover</span></span>
1. <span data-ttu-id="7f5aa-306">Nel portale di Azure selezionare l'insieme di credenziali **Servizi di ripristino** &gt; **Piani di ripristino (Site Recovery)** &gt; **pianodiripristino_nome** creato per la VM del file server.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-306">In the Azure portal, select **Recovery services** vault &gt; **Recovery plans (Site recovery)** &gt; **recoveryplan_name** created for the file server VM.</span></span>
2. <span data-ttu-id="7f5aa-307">Nel pannello del piano di ripristino fare clic su **Altro** &gt;  **Failover pianificato**.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-307">On the Recovery plan blade, Click **More** &gt;  **Planned failover**.</span></span>

   ![](./media/storsimple-disaster-recovery-using-azure-site-recovery/image9.png)
3. <span data-ttu-id="7f5aa-308">Nel pannello **Conferma failover pianificato** scegliere le posizioni di origine e destinazione, selezionare la rete di destinazione e fare clic sull'icona del segno di spunta ✓ per avviare il processo di failover.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-308">On the **Confirm Planned Failover** blade, choose the source and target locations and select target network and click the check icon ✓ to start the failover process.</span></span>
4. <span data-ttu-id="7f5aa-309">Dopo la replica le macchine virtuali create sono in uno stato di attesa di commit.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-309">After replica virtual machines are created they're in a commit pending state.</span></span> <span data-ttu-id="7f5aa-310">Fare clic su **Commit** per eseguire il commit del failover.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-310">Click **Commit** to commit the failover.</span></span>
5. <span data-ttu-id="7f5aa-311">Dopo il completamento della replica, le macchine virtuali vengono avviate nella località secondaria.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-311">After replication is complete, the virtual machines start up at the secondary location.</span></span>

## <a name="perform-a-failover"></a><span data-ttu-id="7f5aa-312">Eseguire un failover</span><span class="sxs-lookup"><span data-stu-id="7f5aa-312">Perform a failover</span></span>
<span data-ttu-id="7f5aa-313">Durante un failover non pianificato, i volumi StorSimple vengono sottoposti a failover nel dispositivo virtuale, una VM viene visualizzata in Azure e i volumi vengono collegati alla VM.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-313">During an unplanned failover, the StorSimple volumes are failed over to the virtual device, a replica VM will be brought up on Azure, and the volumes are attached to the VM.</span></span>

#### <a name="to-perform-a-failover"></a><span data-ttu-id="7f5aa-314">Per eseguire un failover</span><span class="sxs-lookup"><span data-stu-id="7f5aa-314">To perform a failover</span></span>
1. <span data-ttu-id="7f5aa-315">Nel portale di Azure selezionare l'insieme di credenziali **Servizi di ripristino** &gt; **Piani di ripristino (Site Recovery)** &gt; **pianodiripristino_nome** creato per la VM del file server.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-315">In the Azure portal, select **Recovery services** vault &gt; **Recovery plans (Site recovery)** &gt; **recoveryplan_name** created for the file server VM.</span></span>
2. <span data-ttu-id="7f5aa-316">Nel pannello del piano di ripristino fare clic su **Altro** &gt;  **Failover**.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-316">On the Recovery plan blade, Click **More** &gt;  **Failover**.</span></span>
3. <span data-ttu-id="7f5aa-317">Nel pannello **Conferma failover** selezionare i percorsi di origine e di destinazione.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-317">On the **Confirm Failover** blade, choose the source and target locations.</span></span>
4. <span data-ttu-id="7f5aa-318">Selezionare **Arresta le macchine virtuali e sincronizza i dati più recenti** per specificare che Site Recovery deve tentare di arrestare la macchina virtuale protetta e sincronizzare i dati in modo che venga eseguito il failover dei dati più recenti.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-318">Select **Shut down virtual machines and synchronize the latest data** to specify that Site Recovery should try to shut down the protected virtual machine and synchronize the data so that the latest version of the data will be failed over.</span></span>
5. <span data-ttu-id="7f5aa-319">Dopo il failover le macchine virtuali sono uno stato di attesa di commit.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-319">After the failover, the virtual machines are in a commit pending state.</span></span> <span data-ttu-id="7f5aa-320">Fare clic su **Commit** per eseguire il commit del failover.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-320">Click **Commit** to commit the failover.</span></span>


## <a name="perform-a-failback"></a><span data-ttu-id="7f5aa-321">Eseguire il failback</span><span class="sxs-lookup"><span data-stu-id="7f5aa-321">Perform a failback</span></span>
<span data-ttu-id="7f5aa-322">Durante il failback, i contenitori di volumi StorSimple vengono sottoposti a failover nel dispositivo fisico dopo un backup.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-322">During a failback, StorSimple volume containers are failed over back to the physical device after a backup is taken.</span></span>

#### <a name="to-perform-a-failback"></a><span data-ttu-id="7f5aa-323">Per eseguire un failback</span><span class="sxs-lookup"><span data-stu-id="7f5aa-323">To perform a failback</span></span>
1. <span data-ttu-id="7f5aa-324">Nel portale di Azure selezionare l'insieme di credenziali **Servizi di ripristino** &gt; **Piani di ripristino (Site Recovery)** &gt; **pianodiripristino_nome** creato per la VM del file server.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-324">In the Azure portal, select **Recovery services** vault &gt; **Recovery plans (Site Recovery)** &gt; **recoveryplan_name** created for the file server VM.</span></span>
2. <span data-ttu-id="7f5aa-325">Nel pannello del piano di ripristino fare clic su **Altro** &gt;  **Failover pianificato**.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-325">On the Recovery plan blade, Click **More** &gt;  **Planned Failover**.</span></span>
3. <span data-ttu-id="7f5aa-326">Scegliere le posizioni di origine e destinazione e selezionare le opzioni di sincronizzazione dati e creazione di macchine virtuali appropriate.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-326">Choose the source and target locations, select the appropriate Data synchronization and VM creation options.</span></span>
4. <span data-ttu-id="7f5aa-327">Fare clic su **OK** per avviare il processo di failback.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-327">Click **OK** button to start the failback process.</span></span>

   ![](./media/storsimple-disaster-recovery-using-azure-site-recovery/image10.png)

## <a name="best-practices"></a><span data-ttu-id="7f5aa-328">Procedure consigliate</span><span class="sxs-lookup"><span data-stu-id="7f5aa-328">Best Practices</span></span>
### <a name="capacity-planning-and-readiness-assessment"></a><span data-ttu-id="7f5aa-329">Pianificazione della capacità e valutazione della conformità</span><span class="sxs-lookup"><span data-stu-id="7f5aa-329">Capacity planning and readiness assessment</span></span>
#### <a name="hyper-v-site"></a><span data-ttu-id="7f5aa-330">Sito di Hyper-V</span><span class="sxs-lookup"><span data-stu-id="7f5aa-330">Hyper-V site</span></span>
<span data-ttu-id="7f5aa-331">Usare lo [strumento Capacity Planner](http://www.microsoft.com/download/details.aspx?id=39057) per progettare l'infrastruttura di server, archiviazione e rete per l'ambiente di replica Hyper-V.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-331">Use the [User Capacity planner tool](http://www.microsoft.com/download/details.aspx?id=39057) to design the server, storage, and network infrastructure for your Hyper-V replica environment.</span></span>

#### <a name="azure"></a><span data-ttu-id="7f5aa-332">Azure</span><span class="sxs-lookup"><span data-stu-id="7f5aa-332">Azure</span></span>
<span data-ttu-id="7f5aa-333">È possibile eseguire lo strumento [Azure Virtual Machine Readiness Assessment](http://azure.microsoft.com/downloads/vm-readiness-assessment/) nelle VM per assicurarsi che siano compatibili con le VM di Azure e i Servizi di Azure Site Recovery.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-333">You can run the [Azure Virtual Machine Readiness Assessment tool](http://azure.microsoft.com/downloads/vm-readiness-assessment/) on VMs to ensure that they are compatible with Azure VMs and Azure Site Recovery Services.</span></span> <span data-ttu-id="7f5aa-334">Lo strumento Readiness Assessment controlla le configurazioni delle macchine virtuali e visualizza un avviso quando le configurazioni non sono compatibili con Azure.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-334">The Readiness Assessment Tool checks VM configurations and warns when configurations are incompatible with Azure.</span></span> <span data-ttu-id="7f5aa-335">Ad esempio, genera un avviso se un'unità C: è maggiore di 127 GB.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-335">For example, it issues a warning if a C: drive is larger than 127 GB.</span></span>

<span data-ttu-id="7f5aa-336">La pianificazione della capacità prevede almeno due processi importanti:</span><span class="sxs-lookup"><span data-stu-id="7f5aa-336">Capacity planning is made up of at least two important processes:</span></span>

* <span data-ttu-id="7f5aa-337">Mapping delle VM Hyper-V locali alle dimensioni delle VM di Azure (ad esempio A6, A7, A8 e A9).</span><span class="sxs-lookup"><span data-stu-id="7f5aa-337">Mapping on-premises Hyper-V VMs to Azure VM sizes (such as A6, A7, A8, and A9).</span></span>
* <span data-ttu-id="7f5aa-338">Determinazione della larghezza di banda Internet necessaria.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-338">Determining the required Internet bandwidth.</span></span>

## <a name="limitations"></a><span data-ttu-id="7f5aa-339">Limitazioni</span><span class="sxs-lookup"><span data-stu-id="7f5aa-339">Limitations</span></span>
* <span data-ttu-id="7f5aa-340">Attualmente, solo un dispositivo StorSimple può essere sottoposto a failover (per un singolo appliance cloud StorSimple).</span><span class="sxs-lookup"><span data-stu-id="7f5aa-340">Currently, only 1 StorSimple device can be failed over (to a single StorSimple Cloud Appliance).</span></span> <span data-ttu-id="7f5aa-341">Lo scenario di un file server che si estende a più dispositivi StorSimple non è ancora supportato.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-341">The scenario of a file server that spans several StorSimple devices is not yet supported.</span></span>
* <span data-ttu-id="7f5aa-342">Se si verifica un errore durante l'abilitazione della protezione per una VM, assicurarsi di aver disconnesso le destinazioni iSCSI.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-342">If you get an error while enabling protection for a VM, make sure that you have disconnected the iSCSI targets.</span></span>
* <span data-ttu-id="7f5aa-343">Tutti i contenitori di volumi che sono stati raggruppati per effetto dei criteri di backup estesi ai vari contenitori di volumi verranno sottoposti a failover insieme.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-343">All the volume containers that have been grouped together because of backup policies spanning across volume containers will be failed over together.</span></span>
* <span data-ttu-id="7f5aa-344">Tutti i volumi dei contenitori di volumi scelti verranno sottoposti a failover.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-344">All the volumes in the volume containers you have chosen will be failed over.</span></span>
* <span data-ttu-id="7f5aa-345">I volumi superiori a 64 TB non possono essere sottoposti a failover perché la capacità massima di una singola appliance cloud StorSimple è di 64 TB.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-345">Volumes that add up to more than 64 TB can’t be failed over because the maximum capacity of a single StorSimple Cloud Appliance is 64 TB.</span></span>
* <span data-ttu-id="7f5aa-346">Se il failover pianificato o non pianificato non riesce e le VM vengono create in Azure, non eliminare le VM,</span><span class="sxs-lookup"><span data-stu-id="7f5aa-346">If the planned/unplanned failover fails and the VMs are created in Azure, then do not clean up the VMs.</span></span> <span data-ttu-id="7f5aa-347">ma eseguire un failback.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-347">Instead, do a failback.</span></span> <span data-ttu-id="7f5aa-348">Se si eliminano le VM, le VM locali non possono essere riattivate.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-348">If you delete the VMs then the on-premises VMs cannot be turned on again.</span></span>
* <span data-ttu-id="7f5aa-349">Dopo un failover, se non si riesce a visualizzare i volumi, passare alle VM, aprire Gestione disco, eseguire nuovamente la scansione dei dischi e portarli online.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-349">After a failover, if you are not able to see the volumes, go to the VMs, open Disk Management, rescan the disks, and then bring them online.</span></span>
* <span data-ttu-id="7f5aa-350">In alcuni casi, le lettere delle unità nel sito di ripristino di emergenza potrebbero essere diverse da quelle delle VM locali.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-350">In some instances, the drive letters in the DR site might be different than the letters on-premises.</span></span> <span data-ttu-id="7f5aa-351">In questo caso, sarà necessario correggere manualmente il problema al termine del failover.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-351">If this occurs, you will need to manually correct the problem after the failover is finished.</span></span>
* <span data-ttu-id="7f5aa-352">Multi-Factor Authentication deve essere disabilitata per le credenziali di Azure immesse nell'account di automazione come asset.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-352">Multi-factor authentication should be disabled for the Azure credential that is entered in the automation account as an asset.</span></span> <span data-ttu-id="7f5aa-353">Se il processo di autenticazione non viene disabilitato, gli script non potranno essere eseguiti automaticamente e il piano di ripristino non riuscirà.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-353">If this authentication is not disabled, scripts will not be allowed to run automatically and the recovery plan will fail.</span></span>
* <span data-ttu-id="7f5aa-354">Timeout del processo di failover: si verifica il timeout dello script StorSimple se il failover dei contenitori di volumi impiega più tempo rispetto al limite di Azure Site Recovery per ogni script (attualmente è di 120 minuti).</span><span class="sxs-lookup"><span data-stu-id="7f5aa-354">Failover job timeout: The StorSimple script will time out if the failover of volume containers takes more time than the Azure Site Recovery limit per script (currently 120 minutes).</span></span>
* <span data-ttu-id="7f5aa-355">Timeout del processo di backup: si verifica il timeout dello script StorSimple se il backup dei volumi impiega più tempo rispetto al limite di Azure Site Recovery per ogni script (attualmente è di 120 minuti).</span><span class="sxs-lookup"><span data-stu-id="7f5aa-355">Backup job timeout: The StorSimple script times out if the backup of volumes takes more time than the Azure Site Recovery limit per script (currently 120 minutes).</span></span>

  > [!IMPORTANT]
  > <span data-ttu-id="7f5aa-356">Eseguire il backup manualmente dal portale di Azure e quindi eseguire nuovamente il piano di ripristino.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-356">Run the backup manually from the Azure portal and then run the recovery plan again.</span></span>

* <span data-ttu-id="7f5aa-357">Timeout del processo di clonazione: si verifica il timeout dello script StorSimple se la clonazione dei volumi impiega più tempo rispetto al limite di Azure Site Recovery per ogni script (attualmente è di 120 minuti).</span><span class="sxs-lookup"><span data-stu-id="7f5aa-357">Clone job timeout: The StorSimple script times out if the cloning of volumes takes more time than the Azure Site Recovery limit per script (currently 120 minutes).</span></span>
* <span data-ttu-id="7f5aa-358">Errore di sincronizzazione dell'ora: si verifica un errore dello script StorSimple che informa dell'esito negativo dei backup anche in caso di esito positivo del backup nel portale.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-358">Time synchronization error: The StorSimple scripts errors out saying that the backups were unsuccessful even though the backup is successful in the portal.</span></span> <span data-ttu-id="7f5aa-359">Una possibile causa dell'errore potrebbe essere la mancata sincronizzazione dell'ora dell'appliance StorSimple con l'ora corrente del fuso orario.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-359">A possible cause for this might be that the StorSimple appliance’s time might be out of sync with the current time in the time zone.</span></span>

  > [!IMPORTANT]
  > <span data-ttu-id="7f5aa-360">Sincronizzare l'ora dell'appliance con l'ora corrente nel fuso orario.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-360">Sync the appliance time with the current time in the time zone.</span></span>

* <span data-ttu-id="7f5aa-361">Errore di failover dell'appliance: lo script di StorSimple potrebbe non riuscire se si verifica un failover dell'appliance durante l'esecuzione del piano di ripristino.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-361">Appliance failover error: The StorSimple script might fail if there is an appliance failover when the recovery plan is running.</span></span>

  > [!IMPORTANT]
  > <span data-ttu-id="7f5aa-362">Rieseguire il piano di ripristino al termine del failover dell'appliance.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-362">Rerun the recovery plan after the appliance failover is complete.</span></span>


## <a name="summary"></a><span data-ttu-id="7f5aa-363">Riepilogo</span><span class="sxs-lookup"><span data-stu-id="7f5aa-363">Summary</span></span>
<span data-ttu-id="7f5aa-364">Usando Azure Site Recovery è possibile creare un piano di ripristino di emergenza automatizzato completo per una VM del server file con condivisioni file ospitate nell'archiviazione StorSimple.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-364">Using Azure Site Recovery, you can create a complete automated disaster recovery plan for a file server VM having file shares hosted on StorSimple storage.</span></span> <span data-ttu-id="7f5aa-365">È possibile avviare il failover in pochi secondi da qualsiasi luogo in caso di un'interruzione e fare in modo che l'applicazione sia operativa in pochi minuti.</span><span class="sxs-lookup"><span data-stu-id="7f5aa-365">You can initiate the failover within seconds from anywhere in the event of a disruption and get the application up and running in a few minutes.</span></span>
