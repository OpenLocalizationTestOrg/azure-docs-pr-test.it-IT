---
title: una rete virtuale per una Cache Redis di Azure Premium aaaConfigure | Documenti Microsoft
description: Informazioni su come toocreate e gestire il supporto di rete virtuale per le istanze di Cache Redis di Azure di livello Premium
services: redis-cache
documentationcenter: 
author: steved0x
manager: douge
editor: 
ms.assetid: 8b1e43a0-a70e-41e6-8994-0ac246d8bf7f
ms.service: cache
ms.workload: tbd
ms.tgt_pltfrm: cache-redis
ms.devlang: na
ms.topic: article
ms.date: 05/15/2017
ms.author: sdanie
ms.openlocfilehash: fab715f4d9365ee4c2f8b89d2e2e58768c25b671
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/06/2017
---
# <a name="how-tooconfigure-virtual-network-support-for-a-premium-azure-redis-cache"></a><span data-ttu-id="07086-103">Come tooconfigure supporta la rete virtuale per una Cache Redis di Azure Premium</span><span class="sxs-lookup"><span data-stu-id="07086-103">How tooconfigure Virtual Network Support for a Premium Azure Redis Cache</span></span>
<span data-ttu-id="07086-104">Cache Redis di Azure ha diverse offerte di cache, che forniscono flessibilità nella scelta di hello della dimensione della cache e le funzionalità, incluse le funzionalità di livello Premium, ad esempio clustering, persistenza e il supporto di rete virtuale.</span><span class="sxs-lookup"><span data-stu-id="07086-104">Azure Redis Cache has different cache offerings, which provide flexibility in hello choice of cache size and features, including Premium tier features such as clustering, persistence, and virtual network support.</span></span> <span data-ttu-id="07086-105">Una rete virtuale è una rete privata nel cloud hello.</span><span class="sxs-lookup"><span data-stu-id="07086-105">A VNet is a private network in hello cloud.</span></span> <span data-ttu-id="07086-106">Quando un'istanza di Cache Redis di Azure è configurata con una rete virtuale, non è indirizzabile pubblicamente e accessibile solo dalle macchine virtuali e le applicazioni all'interno di hello rete virtuale.</span><span class="sxs-lookup"><span data-stu-id="07086-106">When an Azure Redis Cache instance is configured with a VNet, it is not publicly addressable and can only be accessed from virtual machines and applications within hello VNet.</span></span> <span data-ttu-id="07086-107">In questo articolo viene descritto come la rete virtuale tooconfigure il supporto per un'istanza di Cache Redis di Azure premium.</span><span class="sxs-lookup"><span data-stu-id="07086-107">This article describes how tooconfigure virtual network support for a premium Azure Redis Cache instance.</span></span>

> [!NOTE]
> <span data-ttu-id="07086-108">Cache Redis di Azure supporta le reti virtuali classiche e di Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="07086-108">Azure Redis Cache supports both classic and Resource Manager VNets.</span></span>
> 
> 

<span data-ttu-id="07086-109">Per informazioni su altre funzionalità di cache premium, vedere [livello Premium di Cache Redis di Azure di introduzione toohello](cache-premium-tier-intro.md).</span><span class="sxs-lookup"><span data-stu-id="07086-109">For information on other premium cache features, see [Introduction toohello Azure Redis Cache Premium tier](cache-premium-tier-intro.md).</span></span>

## <a name="why-vnet"></a><span data-ttu-id="07086-110">Perché usare una rete virtuale?</span><span class="sxs-lookup"><span data-stu-id="07086-110">Why VNet?</span></span>
<span data-ttu-id="07086-111">[Rete virtuale di Azure (VNet)](https://azure.microsoft.com/services/virtual-network/) distribuzione fornisce sicurezza avanzata e isolamento per Cache Redis di Azure, nonché le subnet, criteri di controllo di accesso e altre funzionalità toofurther limitare l'accesso.</span><span class="sxs-lookup"><span data-stu-id="07086-111">[Azure Virtual Network (VNet)](https://azure.microsoft.com/services/virtual-network/) deployment provides enhanced security and isolation for your Azure Redis Cache, as well as subnets, access control policies, and other features toofurther restrict access.</span></span>

## <a name="virtual-network-support"></a><span data-ttu-id="07086-112">Supporto della rete virtuale</span><span class="sxs-lookup"><span data-stu-id="07086-112">Virtual network support</span></span>
<span data-ttu-id="07086-113">Supporto di rete virtuale è configurato su hello **nuova Cache Redis** pannello durante la creazione della cache.</span><span class="sxs-lookup"><span data-stu-id="07086-113">Virtual Network (VNet) support is configured on hello **New Redis Cache** blade during cache creation.</span></span> 

[!INCLUDE [redis-cache-create](../../includes/redis-cache-premium-create.md)]

<span data-ttu-id="07086-114">Dopo aver selezionato un vantaggio a livello di prezzo, è possibile configurare l'integrazione della rete virtuale Redis selezionando una rete virtuale in hello stessa sottoscrizione e il percorso della cache.</span><span class="sxs-lookup"><span data-stu-id="07086-114">Once you have selected a premium pricing tier, you can configure Redis VNet integration by selecting a VNet that is in hello same subscription and location as your cache.</span></span> <span data-ttu-id="07086-115">toouse una nuova rete virtuale, prima è necessario crearla eseguendo la procedura descritta hello in [creare una rete virtuale usando il portale di Azure hello](../virtual-network/virtual-networks-create-vnet-arm-pportal.md) o [creare una rete virtuale (classico) tramite il portale di Azure hello](../virtual-network/virtual-networks-create-vnet-classic-pportal.md) e quindi restituire toohello **Nuova Cache Redis** toocreate blade e configurare la cache premium.</span><span class="sxs-lookup"><span data-stu-id="07086-115">toouse a new VNet, create it first by following hello steps in [Create a virtual network using hello Azure portal](../virtual-network/virtual-networks-create-vnet-arm-pportal.md) or [Create a virtual network (classic) by using hello Azure portal](../virtual-network/virtual-networks-create-vnet-classic-pportal.md) and then return toohello **New Redis Cache** blade toocreate and configure your premium cache.</span></span>

<span data-ttu-id="07086-116">tooconfigure hello rete virtuale per la nuova cache, fare clic su **rete virtuale** su hello **nuova Cache Redis** pannello e seleziona hello desiderato rete virtuale dall'elenco a discesa hello.</span><span class="sxs-lookup"><span data-stu-id="07086-116">tooconfigure hello VNet for your new cache, click **Virtual Network** on hello **New Redis Cache** blade, and select hello desired VNet from hello drop-down list.</span></span>

![Rete virtuale][redis-cache-vnet]

<span data-ttu-id="07086-118">Selezionare hello subnet desiderato da hello **Subnet** elenco a discesa elenco e specificare hello desiderato **indirizzo IP statico**.</span><span class="sxs-lookup"><span data-stu-id="07086-118">Select hello desired subnet from hello **Subnet** drop-down list, and specify hello desired **Static IP address**.</span></span> <span data-ttu-id="07086-119">Se si utilizza un classico hello di rete virtuale **indirizzo IP statico** campo è facoltativo e, se non viene specificato, dalla subnet hello selezionato viene scelto uno.</span><span class="sxs-lookup"><span data-stu-id="07086-119">If you are using a classic VNet hello **Static IP address** field is optional, and if none is specified, one is chosen from hello selected subnet.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="07086-120">Quando si distribuisce un tooa Cache Redis di Azure Resource Manager VNet, cache di hello deve essere in una subnet dedicata che non contiene altre risorse, ad eccezione delle istanze di Cache Redis di Azure.</span><span class="sxs-lookup"><span data-stu-id="07086-120">When deploying an Azure Redis Cache tooa Resource Manager VNet, hello cache must be in a dedicated subnet that contains no other resources except for Azure Redis Cache instances.</span></span> <span data-ttu-id="07086-121">Se viene effettuato un tentativo di toodeploy un tooa Cache Redis di Azure Resource Manager VNet tooa subnet che contiene altre risorse, distribuzione hello ha esito negativo.</span><span class="sxs-lookup"><span data-stu-id="07086-121">If an attempt is made toodeploy an Azure Redis Cache tooa Resource Manager VNet tooa subnet that contains other resources, hello deployment fails.</span></span>
> 
> 

![Rete virtuale][redis-cache-vnet-ip]

> [!IMPORTANT]
> <span data-ttu-id="07086-123">Azure riserva alcuni indirizzi IP all'interno di ogni subnet e questi indirizzi non possono essere usati.</span><span class="sxs-lookup"><span data-stu-id="07086-123">Azure reserves some IP addresses within each subnet, and these addresses can't be used.</span></span> <span data-ttu-id="07086-124">gli indirizzi IP e il cognome di subnet hello Hello sono riservati per conformità al protocollo, insieme a tre ulteriori indirizzi utilizzato per i servizi di Azure.</span><span class="sxs-lookup"><span data-stu-id="07086-124">hello first and last IP addresses of hello subnets are reserved for protocol conformance, along with three more addresses used for Azure services.</span></span> <span data-ttu-id="07086-125">Per altre informazioni, vedere [Esistono restrizioni sull'uso di indirizzi IP all'interno di tali subnet?](../virtual-network/virtual-networks-faq.md#are-there-any-restrictions-on-using-ip-addresses-within-these-subnets)</span><span class="sxs-lookup"><span data-stu-id="07086-125">For more information, see [Are there any restrictions on using IP addresses within these subnets?](../virtual-network/virtual-networks-faq.md#are-there-any-restrictions-on-using-ip-addresses-within-these-subnets)</span></span>
> 
> <span data-ttu-id="07086-126">In aggiunta toohello gli indirizzi IP utilizzati dall'infrastruttura di rete virtuale di Azure hello, ogni Redis istanza hello indirizzi IP della subnet usa due per partizione e un indirizzo IP aggiuntivo di bilanciamento del carico hello.</span><span class="sxs-lookup"><span data-stu-id="07086-126">In addition toohello IP addresses used by hello Azure VNET infrastructure, each Redis instance in hello subnet uses two IP addresses per shard and one additional IP address for hello load balancer.</span></span> <span data-ttu-id="07086-127">Una cache non cluster è considerata toohave una partizione.</span><span class="sxs-lookup"><span data-stu-id="07086-127">A non-clustered cache is considered toohave one shard.</span></span>
> 
> 

<span data-ttu-id="07086-128">Dopo la creazione della cache di hello, si può visualizzare la configurazione di hello per hello rete virtuale, fare clic su **rete virtuale** da hello **menu risorse**.</span><span class="sxs-lookup"><span data-stu-id="07086-128">After hello cache is created, you can view hello configuration for hello VNet by clicking **Virtual Network** from hello **Resource menu**.</span></span>

![Rete virtuale][redis-cache-vnet-info]

<span data-ttu-id="07086-130">tooconnect tooyour Azure Redis cache istanza quando si utilizza una rete virtuale, specificare il nome host hello della cache nella stringa di connessione hello, come illustrato nell'esempio seguente hello:</span><span class="sxs-lookup"><span data-stu-id="07086-130">tooconnect tooyour Azure Redis cache instance when using a VNet, specify hello host name of your cache in hello connection string as shown in hello following example:</span></span>

    private static Lazy<ConnectionMultiplexer> lazyConnection = new Lazy<ConnectionMultiplexer>(() =>
    {
        return ConnectionMultiplexer.Connect("contoso5premium.redis.cache.windows.net,abortConnect=false,ssl=true,password=password");
    });

    public static ConnectionMultiplexer Connection
    {
        get
        {
            return lazyConnection.Value;
        }
    }

## <a name="azure-redis-cache-vnet-faq"></a><span data-ttu-id="07086-131">Domande frequenti sulla rete virtuale di Cache Redis di Azure</span><span class="sxs-lookup"><span data-stu-id="07086-131">Azure Redis Cache VNet FAQ</span></span>
<span data-ttu-id="07086-132">Hello seguente elenco contiene le risposte toocommonly domande frequenti sulla scalabilità di hello Cache Redis di Azure.</span><span class="sxs-lookup"><span data-stu-id="07086-132">hello following list contains answers toocommonly asked questions about hello Azure Redis Cache scaling.</span></span>

* [<span data-ttu-id="07086-133">Quali sono alcuni problemi comuni di configurazione errata per Cache Redis di Azure e le reti virtuali?</span><span class="sxs-lookup"><span data-stu-id="07086-133">What are some common misconfiguration issues with Azure Redis Cache and VNets?</span></span>](#what-are-some-common-misconfiguration-issues-with-azure-redis-cache-and-vnets)
* [<span data-ttu-id="07086-134">Come è possibile verificare che la cache funzioni in una rete virtuale?</span><span class="sxs-lookup"><span data-stu-id="07086-134">How can I verify that my cache is working in a VNET?</span></span>](#how-can-i-verify-that-my-cache-is-working-in-a-vnet)
* [<span data-ttu-id="07086-135">È possibile usare reti virtuali con una cache Standard o Basic?</span><span class="sxs-lookup"><span data-stu-id="07086-135">Can I use VNets with a standard or basic cache?</span></span>](#can-i-use-vnets-with-a-standard-or-basic-cache)
* [<span data-ttu-id="07086-136">Perché la creazione di una cache Redis ha esito negativo in alcune subnet e non in altre?</span><span class="sxs-lookup"><span data-stu-id="07086-136">Why does creating a Redis cache fail in some subnets but not others?</span></span>](#why-does-creating-a-redis-cache-fail-in-some-subnets-but-not-others)
* [<span data-ttu-id="07086-137">Quali sono i requisiti dello spazio di indirizzi subnet hello?</span><span class="sxs-lookup"><span data-stu-id="07086-137">What are hello subnet address space requirements?</span></span>](#what-are-the-subnet-address-space-requirements)
* [<span data-ttu-id="07086-138">Tutte le funzionalità della cache funzionano quando si ospita una cache in una rete virtuale?</span><span class="sxs-lookup"><span data-stu-id="07086-138">Do all cache features work when hosting a cache in a VNET?</span></span>](#do-all-cache-features-work-when-hosting-a-cache-in-a-vnet)

## <a name="what-are-some-common-misconfiguration-issues-with-azure-redis-cache-and-vnets"></a><span data-ttu-id="07086-139">Quali sono alcuni problemi comuni di configurazione errata per Cache Redis di Azure e le reti virtuali?</span><span class="sxs-lookup"><span data-stu-id="07086-139">What are some common misconfiguration issues with Azure Redis Cache and VNets?</span></span>
<span data-ttu-id="07086-140">Quando la Cache Redis di Azure è ospitata in una rete virtuale, vengono utilizzate porte hello in hello le tabelle seguenti.</span><span class="sxs-lookup"><span data-stu-id="07086-140">When Azure Redis Cache is hosted in a VNet, hello ports in hello following tables are used.</span></span> 

>[!IMPORTANT]
><span data-ttu-id="07086-141">Se le porte hello in hello le tabelle seguenti sono bloccate, cache di hello potrebbe non funzionare correttamente.</span><span class="sxs-lookup"><span data-stu-id="07086-141">If hello ports in hello following tables are blocked, hello cache may not function correctly.</span></span> <span data-ttu-id="07086-142">Con uno o più di queste porte bloccate è il problema errata configurazione più comune di hello quando si usa una Cache Redis di Azure in una rete virtuale.</span><span class="sxs-lookup"><span data-stu-id="07086-142">Having one or more of these ports blocked is hello most common misconfiguration issue when using Azure Redis Cache in a VNet.</span></span>
> 
> 

- [<span data-ttu-id="07086-143">Requisiti delle porte in uscita</span><span class="sxs-lookup"><span data-stu-id="07086-143">Outbound port requirements</span></span>](#outbound-port-requirements)
- [<span data-ttu-id="07086-144">Requisiti delle porte in ingresso</span><span class="sxs-lookup"><span data-stu-id="07086-144">Inbound port requirements</span></span>](#inbound-port-requirements)

### <a name="outbound-port-requirements"></a><span data-ttu-id="07086-145">Requisiti delle porte in uscita</span><span class="sxs-lookup"><span data-stu-id="07086-145">Outbound port requirements</span></span>

<span data-ttu-id="07086-146">Vi sono sette requisiti delle porte in uscita.</span><span class="sxs-lookup"><span data-stu-id="07086-146">There are seven outbound port requirements.</span></span>

- <span data-ttu-id="07086-147">Se si desidera, tutte le connessioni in uscita toohello, internet può essere eseguita tramite un client controllo dispositivo locale.</span><span class="sxs-lookup"><span data-stu-id="07086-147">If desired, all outbound connections toohello internet can be made through a client's on-premises auditing device.</span></span>
- <span data-ttu-id="07086-148">Tre delle porte hello indirizzare endpoint tooAzure traffico per la manutenzione di archiviazione di Azure e DNS di Azure.</span><span class="sxs-lookup"><span data-stu-id="07086-148">Three of hello ports route traffic tooAzure endpoints servicing Azure Storage and Azure DNS.</span></span>
- <span data-ttu-id="07086-149">Hello rimanenti gli intervalli di porte e per le comunicazioni di subnet interne Redis.</span><span class="sxs-lookup"><span data-stu-id="07086-149">hello remaining port ranges and for internal Redis subnet communications.</span></span> <span data-ttu-id="07086-150">Per le comunicazioni subnet interne di Redis non è richiesta alcuna regola NSG subnet.</span><span class="sxs-lookup"><span data-stu-id="07086-150">No subnet NSG rules are required for internal Redis subnet communications.</span></span>

| <span data-ttu-id="07086-151">Porte</span><span class="sxs-lookup"><span data-stu-id="07086-151">Port(s)</span></span> | <span data-ttu-id="07086-152">Direzione</span><span class="sxs-lookup"><span data-stu-id="07086-152">Direction</span></span> | <span data-ttu-id="07086-153">Protocollo di trasporto</span><span class="sxs-lookup"><span data-stu-id="07086-153">Transport Protocol</span></span> | <span data-ttu-id="07086-154">Scopo</span><span class="sxs-lookup"><span data-stu-id="07086-154">Purpose</span></span> | <span data-ttu-id="07086-155">IP locale</span><span class="sxs-lookup"><span data-stu-id="07086-155">Local IP</span></span> | <span data-ttu-id="07086-156">IP remoto</span><span class="sxs-lookup"><span data-stu-id="07086-156">Remote IP</span></span> |
| --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="07086-157">80, 443</span><span class="sxs-lookup"><span data-stu-id="07086-157">80, 443</span></span> |<span data-ttu-id="07086-158">In uscita</span><span class="sxs-lookup"><span data-stu-id="07086-158">Outbound</span></span> |<span data-ttu-id="07086-159">TCP</span><span class="sxs-lookup"><span data-stu-id="07086-159">TCP</span></span> |<span data-ttu-id="07086-160">Dipendenze Redis in Archiviazione di Azure/PKI (Internet)</span><span class="sxs-lookup"><span data-stu-id="07086-160">Redis dependencies on Azure Storage/PKI (Internet)</span></span> | <span data-ttu-id="07086-161">(Subnet Redis)</span><span class="sxs-lookup"><span data-stu-id="07086-161">(Redis subnet)</span></span> |* |
| <span data-ttu-id="07086-162">53</span><span class="sxs-lookup"><span data-stu-id="07086-162">53</span></span> |<span data-ttu-id="07086-163">In uscita</span><span class="sxs-lookup"><span data-stu-id="07086-163">Outbound</span></span> |<span data-ttu-id="07086-164">TCP/UDP</span><span class="sxs-lookup"><span data-stu-id="07086-164">TCP/UDP</span></span> |<span data-ttu-id="07086-165">Dipendenze Redis nel DNS (Internet/rete virtuale)</span><span class="sxs-lookup"><span data-stu-id="07086-165">Redis dependencies on DNS (Internet/VNet)</span></span> | <span data-ttu-id="07086-166">(Subnet Redis)</span><span class="sxs-lookup"><span data-stu-id="07086-166">(Redis subnet)</span></span> |* |
| <span data-ttu-id="07086-167">8443</span><span class="sxs-lookup"><span data-stu-id="07086-167">8443</span></span> |<span data-ttu-id="07086-168">In uscita</span><span class="sxs-lookup"><span data-stu-id="07086-168">Outbound</span></span> |<span data-ttu-id="07086-169">TCP</span><span class="sxs-lookup"><span data-stu-id="07086-169">TCP</span></span> |<span data-ttu-id="07086-170">Comunicazioni interne per Redis</span><span class="sxs-lookup"><span data-stu-id="07086-170">Internal communications for Redis</span></span> | <span data-ttu-id="07086-171">(Subnet Redis)</span><span class="sxs-lookup"><span data-stu-id="07086-171">(Redis subnet)</span></span> | <span data-ttu-id="07086-172">(Subnet Redis)</span><span class="sxs-lookup"><span data-stu-id="07086-172">(Redis subnet)</span></span> |
| <span data-ttu-id="07086-173">10221-10231</span><span class="sxs-lookup"><span data-stu-id="07086-173">10221-10231</span></span> |<span data-ttu-id="07086-174">In uscita</span><span class="sxs-lookup"><span data-stu-id="07086-174">Outbound</span></span> |<span data-ttu-id="07086-175">TCP</span><span class="sxs-lookup"><span data-stu-id="07086-175">TCP</span></span> |<span data-ttu-id="07086-176">Comunicazioni interne per Redis</span><span class="sxs-lookup"><span data-stu-id="07086-176">Internal communications for Redis</span></span> | <span data-ttu-id="07086-177">(Subnet Redis)</span><span class="sxs-lookup"><span data-stu-id="07086-177">(Redis subnet)</span></span> | <span data-ttu-id="07086-178">(Subnet Redis)</span><span class="sxs-lookup"><span data-stu-id="07086-178">(Redis subnet)</span></span> |
| <span data-ttu-id="07086-179">20226</span><span class="sxs-lookup"><span data-stu-id="07086-179">20226</span></span> |<span data-ttu-id="07086-180">In uscita</span><span class="sxs-lookup"><span data-stu-id="07086-180">Outbound</span></span> |<span data-ttu-id="07086-181">TCP</span><span class="sxs-lookup"><span data-stu-id="07086-181">TCP</span></span> |<span data-ttu-id="07086-182">Comunicazioni interne per Redis</span><span class="sxs-lookup"><span data-stu-id="07086-182">Internal communications for Redis</span></span> | <span data-ttu-id="07086-183">(Subnet Redis)</span><span class="sxs-lookup"><span data-stu-id="07086-183">(Redis subnet)</span></span> |<span data-ttu-id="07086-184">(Subnet Redis)</span><span class="sxs-lookup"><span data-stu-id="07086-184">(Redis subnet)</span></span> |
| <span data-ttu-id="07086-185">13000-13999</span><span class="sxs-lookup"><span data-stu-id="07086-185">13000-13999</span></span> |<span data-ttu-id="07086-186">In uscita</span><span class="sxs-lookup"><span data-stu-id="07086-186">Outbound</span></span> |<span data-ttu-id="07086-187">TCP</span><span class="sxs-lookup"><span data-stu-id="07086-187">TCP</span></span> |<span data-ttu-id="07086-188">Comunicazioni interne per Redis</span><span class="sxs-lookup"><span data-stu-id="07086-188">Internal communications for Redis</span></span> | <span data-ttu-id="07086-189">(Subnet Redis)</span><span class="sxs-lookup"><span data-stu-id="07086-189">(Redis subnet)</span></span> |<span data-ttu-id="07086-190">(Subnet Redis)</span><span class="sxs-lookup"><span data-stu-id="07086-190">(Redis subnet)</span></span> |
| <span data-ttu-id="07086-191">15000-15999</span><span class="sxs-lookup"><span data-stu-id="07086-191">15000-15999</span></span> |<span data-ttu-id="07086-192">In uscita</span><span class="sxs-lookup"><span data-stu-id="07086-192">Outbound</span></span> |<span data-ttu-id="07086-193">TCP</span><span class="sxs-lookup"><span data-stu-id="07086-193">TCP</span></span> |<span data-ttu-id="07086-194">Comunicazioni interne per Redis</span><span class="sxs-lookup"><span data-stu-id="07086-194">Internal communications for Redis</span></span> | <span data-ttu-id="07086-195">(Subnet Redis)</span><span class="sxs-lookup"><span data-stu-id="07086-195">(Redis subnet)</span></span> |<span data-ttu-id="07086-196">(Subnet Redis)</span><span class="sxs-lookup"><span data-stu-id="07086-196">(Redis subnet)</span></span> |


### <a name="inbound-port-requirements"></a><span data-ttu-id="07086-197">Requisiti delle porte in ingresso</span><span class="sxs-lookup"><span data-stu-id="07086-197">Inbound port requirements</span></span>

<span data-ttu-id="07086-198">Vi sono otto requisiti delle porte in ingresso.</span><span class="sxs-lookup"><span data-stu-id="07086-198">There are eight inbound port range requirements.</span></span> <span data-ttu-id="07086-199">Sono richieste in ingresso in questi intervalli in ingresso da altri servizi ospitati in hello stessa rete virtuale o interno toohello comunicazioni subnet Redis.</span><span class="sxs-lookup"><span data-stu-id="07086-199">Inbound requests in these ranges are either inbound from other services hosted in hello same VNET or internal toohello Redis subnet communications.</span></span>

| <span data-ttu-id="07086-200">Porte</span><span class="sxs-lookup"><span data-stu-id="07086-200">Port(s)</span></span> | <span data-ttu-id="07086-201">Direzione</span><span class="sxs-lookup"><span data-stu-id="07086-201">Direction</span></span> | <span data-ttu-id="07086-202">Protocollo di trasporto</span><span class="sxs-lookup"><span data-stu-id="07086-202">Transport Protocol</span></span> | <span data-ttu-id="07086-203">Scopo</span><span class="sxs-lookup"><span data-stu-id="07086-203">Purpose</span></span> | <span data-ttu-id="07086-204">IP locale</span><span class="sxs-lookup"><span data-stu-id="07086-204">Local IP</span></span> | <span data-ttu-id="07086-205">IP remoto</span><span class="sxs-lookup"><span data-stu-id="07086-205">Remote IP</span></span> |
| --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="07086-206">6379, 6380</span><span class="sxs-lookup"><span data-stu-id="07086-206">6379, 6380</span></span> |<span data-ttu-id="07086-207">In ingresso</span><span class="sxs-lookup"><span data-stu-id="07086-207">Inbound</span></span> |<span data-ttu-id="07086-208">TCP</span><span class="sxs-lookup"><span data-stu-id="07086-208">TCP</span></span> |<span data-ttu-id="07086-209">TooRedis di comunicazione client, Azure il bilanciamento del carico</span><span class="sxs-lookup"><span data-stu-id="07086-209">Client communication tooRedis, Azure load balancing</span></span> | <span data-ttu-id="07086-210">(Subnet Redis)</span><span class="sxs-lookup"><span data-stu-id="07086-210">(Redis subnet)</span></span> |<span data-ttu-id="07086-211">Rete virtuale, Bilanciamento carico di Azure</span><span class="sxs-lookup"><span data-stu-id="07086-211">Virtual Network, Azure Load Balancer</span></span> |
| <span data-ttu-id="07086-212">8443</span><span class="sxs-lookup"><span data-stu-id="07086-212">8443</span></span> |<span data-ttu-id="07086-213">In ingresso</span><span class="sxs-lookup"><span data-stu-id="07086-213">Inbound</span></span> |<span data-ttu-id="07086-214">TCP</span><span class="sxs-lookup"><span data-stu-id="07086-214">TCP</span></span> |<span data-ttu-id="07086-215">Comunicazioni interne per Redis</span><span class="sxs-lookup"><span data-stu-id="07086-215">Internal communications for Redis</span></span> | <span data-ttu-id="07086-216">(Subnet Redis)</span><span class="sxs-lookup"><span data-stu-id="07086-216">(Redis subnet)</span></span> |<span data-ttu-id="07086-217">(Subnet Redis)</span><span class="sxs-lookup"><span data-stu-id="07086-217">(Redis subnet)</span></span> |
| <span data-ttu-id="07086-218">8500</span><span class="sxs-lookup"><span data-stu-id="07086-218">8500</span></span> |<span data-ttu-id="07086-219">In ingresso</span><span class="sxs-lookup"><span data-stu-id="07086-219">Inbound</span></span> |<span data-ttu-id="07086-220">TCP/UDP</span><span class="sxs-lookup"><span data-stu-id="07086-220">TCP/UDP</span></span> |<span data-ttu-id="07086-221">Bilanciamento del carico di Azure</span><span class="sxs-lookup"><span data-stu-id="07086-221">Azure load balancing</span></span> | <span data-ttu-id="07086-222">(Subnet Redis)</span><span class="sxs-lookup"><span data-stu-id="07086-222">(Redis subnet)</span></span> |<span data-ttu-id="07086-223">Azure Load Balancer</span><span class="sxs-lookup"><span data-stu-id="07086-223">Azure Load Balancer</span></span> |
| <span data-ttu-id="07086-224">10221-10231</span><span class="sxs-lookup"><span data-stu-id="07086-224">10221-10231</span></span> |<span data-ttu-id="07086-225">In ingresso</span><span class="sxs-lookup"><span data-stu-id="07086-225">Inbound</span></span> |<span data-ttu-id="07086-226">TCP</span><span class="sxs-lookup"><span data-stu-id="07086-226">TCP</span></span> |<span data-ttu-id="07086-227">Comunicazioni interne per Redis</span><span class="sxs-lookup"><span data-stu-id="07086-227">Internal communications for Redis</span></span> | <span data-ttu-id="07086-228">(Subnet Redis)</span><span class="sxs-lookup"><span data-stu-id="07086-228">(Redis subnet)</span></span> |<span data-ttu-id="07086-229">(Subnet Redis), bilanciamento del carico di Azure</span><span class="sxs-lookup"><span data-stu-id="07086-229">(Redis subnet), Azure Load Balancer</span></span> |
| <span data-ttu-id="07086-230">13000-13999</span><span class="sxs-lookup"><span data-stu-id="07086-230">13000-13999</span></span> |<span data-ttu-id="07086-231">In ingresso</span><span class="sxs-lookup"><span data-stu-id="07086-231">Inbound</span></span> |<span data-ttu-id="07086-232">TCP</span><span class="sxs-lookup"><span data-stu-id="07086-232">TCP</span></span> |<span data-ttu-id="07086-233">TooRedis di comunicazione client, i cluster di bilanciamento del carico di Azure</span><span class="sxs-lookup"><span data-stu-id="07086-233">Client communication tooRedis Clusters, Azure load balancing</span></span> | <span data-ttu-id="07086-234">(Subnet Redis)</span><span class="sxs-lookup"><span data-stu-id="07086-234">(Redis subnet)</span></span> |<span data-ttu-id="07086-235">Rete virtuale, Bilanciamento carico di Azure</span><span class="sxs-lookup"><span data-stu-id="07086-235">Virtual Network, Azure Load Balancer</span></span> |
| <span data-ttu-id="07086-236">15000-15999</span><span class="sxs-lookup"><span data-stu-id="07086-236">15000-15999</span></span> |<span data-ttu-id="07086-237">In ingresso</span><span class="sxs-lookup"><span data-stu-id="07086-237">Inbound</span></span> |<span data-ttu-id="07086-238">TCP</span><span class="sxs-lookup"><span data-stu-id="07086-238">TCP</span></span> |<span data-ttu-id="07086-239">TooRedis di comunicazione client cluster di Azure, il bilanciamento del carico</span><span class="sxs-lookup"><span data-stu-id="07086-239">Client communication tooRedis Clusters, Azure load Balancing</span></span> | <span data-ttu-id="07086-240">(Subnet Redis)</span><span class="sxs-lookup"><span data-stu-id="07086-240">(Redis subnet)</span></span> |<span data-ttu-id="07086-241">Rete virtuale, Bilanciamento carico di Azure</span><span class="sxs-lookup"><span data-stu-id="07086-241">Virtual Network, Azure Load Balancer</span></span> |
| <span data-ttu-id="07086-242">16001</span><span class="sxs-lookup"><span data-stu-id="07086-242">16001</span></span> |<span data-ttu-id="07086-243">In ingresso</span><span class="sxs-lookup"><span data-stu-id="07086-243">Inbound</span></span> |<span data-ttu-id="07086-244">TCP/UDP</span><span class="sxs-lookup"><span data-stu-id="07086-244">TCP/UDP</span></span> |<span data-ttu-id="07086-245">Bilanciamento del carico di Azure</span><span class="sxs-lookup"><span data-stu-id="07086-245">Azure load balancing</span></span> | <span data-ttu-id="07086-246">(Subnet Redis)</span><span class="sxs-lookup"><span data-stu-id="07086-246">(Redis subnet)</span></span> |<span data-ttu-id="07086-247">Azure Load Balancer</span><span class="sxs-lookup"><span data-stu-id="07086-247">Azure Load Balancer</span></span> |
| <span data-ttu-id="07086-248">20226</span><span class="sxs-lookup"><span data-stu-id="07086-248">20226</span></span> |<span data-ttu-id="07086-249">In ingresso</span><span class="sxs-lookup"><span data-stu-id="07086-249">Inbound</span></span> |<span data-ttu-id="07086-250">TCP</span><span class="sxs-lookup"><span data-stu-id="07086-250">TCP</span></span> |<span data-ttu-id="07086-251">Comunicazioni interne per Redis</span><span class="sxs-lookup"><span data-stu-id="07086-251">Internal communications for Redis</span></span> | <span data-ttu-id="07086-252">(Subnet Redis)</span><span class="sxs-lookup"><span data-stu-id="07086-252">(Redis subnet)</span></span> |<span data-ttu-id="07086-253">(Subnet Redis)</span><span class="sxs-lookup"><span data-stu-id="07086-253">(Redis subnet)</span></span> |

### <a name="additional-vnet-network-connectivity-requirements"></a><span data-ttu-id="07086-254">Ulteriori requisiti di connettività della rete VNET</span><span class="sxs-lookup"><span data-stu-id="07086-254">Additional VNET network connectivity requirements</span></span>

<span data-ttu-id="07086-255">Esistono requisiti di connettività di rete per Cache Redis di Azure che potrebbero non essere inizialmente soddisfatti in una rete virtuale.</span><span class="sxs-lookup"><span data-stu-id="07086-255">There are network connectivity requirements for Azure Redis Cache that may not be initially met in a virtual network.</span></span> <span data-ttu-id="07086-256">Cache Redis di Azure richiede che tutti hello segue gli elementi toofunction correttamente se utilizzato in una rete virtuale.</span><span class="sxs-lookup"><span data-stu-id="07086-256">Azure Redis Cache requires all hello following items toofunction properly when used within a virtual network.</span></span>

* <span data-ttu-id="07086-257">In uscita connettività tooAzure archiviazione gli endpoint di rete in tutto il mondo.</span><span class="sxs-lookup"><span data-stu-id="07086-257">Outbound network connectivity tooAzure Storage endpoints worldwide.</span></span> <span data-ttu-id="07086-258">Sono inclusi gli endpoint si trova in hello stessa area come istanza di Cache Redis di Azure hello, nonché gli endpoint di archiviazione si trova **altri** aree di Azure.</span><span class="sxs-lookup"><span data-stu-id="07086-258">This includes endpoints located in hello same region as hello Azure Redis Cache instance, as well as storage endpoints located in **other** Azure regions.</span></span> <span data-ttu-id="07086-259">Endpoint di archiviazione Azure risolvere in hello seguenti domini DNS: *t*, *>.BLOB.Core.Windows.NET*, *queue.core.windows.net*e *file.core.windows.net*.</span><span class="sxs-lookup"><span data-stu-id="07086-259">Azure Storage endpoints resolve under hello following DNS domains: *table.core.windows.net*, *blob.core.windows.net*, *queue.core.windows.net*, and *file.core.windows.net*.</span></span> 
* <span data-ttu-id="07086-260">In uscita connettività di rete troppo*ocsp.msocsp.com*, *mscrl.microsoft.com*, e *crl.microsoft.com*. La connettività è la funzionalità SSL toosupport necessari.</span><span class="sxs-lookup"><span data-stu-id="07086-260">Outbound network connectivity too*ocsp.msocsp.com*, *mscrl.microsoft.com*, and *crl.microsoft.com*. This connectivity is needed toosupport SSL functionality.</span></span>
* <span data-ttu-id="07086-261">configurazione del DNS per la rete virtuale hello Hello deve essere in grado di risolvere tutti gli endpoint hello e domini indicati hello punti precedenti.</span><span class="sxs-lookup"><span data-stu-id="07086-261">hello DNS configuration for hello virtual network must be capable of resolving all of hello endpoints and domains mentioned in hello earlier points.</span></span> <span data-ttu-id="07086-262">Questi requisiti di DNS possono essere soddisfatto garantendo un'infrastruttura DNS valida viene configurata e gestita per la rete virtuale hello.</span><span class="sxs-lookup"><span data-stu-id="07086-262">These DNS requirements can be met by ensuring a valid DNS infrastructure is configured and maintained for hello virtual network.</span></span>
* <span data-ttu-id="07086-263">Toohello di connettività di rete in uscita seguente endpoint Azure Monitoring, risolvere in hello seguenti domini DNS: shoebox2 black.shoebox2.metrics.nsatc.net, Nord-prod2.prod2.metrics.nsatc.net, azglobal-black.azglobal.metrics.nsatc.net, shoebox2-red.shoebox2.metrics.nsatc.net, est-prod2.prod2.metrics.nsatc.net, azglobal-red.azglobal.metrics.nsatc.net.</span><span class="sxs-lookup"><span data-stu-id="07086-263">Outbound network connectivity toohello following Azure Monitoring endpoints, which resolve under hello following DNS domains: shoebox2-black.shoebox2.metrics.nsatc.net, north-prod2.prod2.metrics.nsatc.net, azglobal-black.azglobal.metrics.nsatc.net, shoebox2-red.shoebox2.metrics.nsatc.net, east-prod2.prod2.metrics.nsatc.net, azglobal-red.azglobal.metrics.nsatc.net.</span></span>

### <a name="how-can-i-verify-that-my-cache-is-working-in-a-vnet"></a><span data-ttu-id="07086-264">Come è possibile verificare che la cache funzioni in una rete virtuale?</span><span class="sxs-lookup"><span data-stu-id="07086-264">How can I verify that my cache is working in a VNET?</span></span>

>[!IMPORTANT]
><span data-ttu-id="07086-265">Quando ci si connette l'istanza di Cache Redis di Azure tooan che è ospitato in una rete virtuale, la cache client devono essere in hello stessa rete virtuale, inclusi eventuali applicazioni di test o gli strumenti di diagnostica ping.</span><span class="sxs-lookup"><span data-stu-id="07086-265">When connecting tooan Azure Redis Cache instance that is hosted in a VNET, your cache clients must be in hello same VNET, including any test applications or diagnostic pinging tools.</span></span>
>
>

<span data-ttu-id="07086-266">Una volta requisiti hello per le porte configurati come descritto nella sezione precedente di hello, è possibile verificare che la cache funziona eseguendo hello alla procedura seguente.</span><span class="sxs-lookup"><span data-stu-id="07086-266">Once hello port requirements are configured as described in hello previous section, you can verify that your cache is working by performing hello following steps.</span></span>

- <span data-ttu-id="07086-267">[Riavviare il computer](cache-administration.md#reboot) tutti hello memorizzare nella cache i nodi.</span><span class="sxs-lookup"><span data-stu-id="07086-267">[Reboot](cache-administration.md#reboot) all of hello cache nodes.</span></span> <span data-ttu-id="07086-268">Se tutti hello richiesto non è possibile raggiungere le dipendenze della cache (come descritto in [in ingresso requisiti delle porte](cache-how-to-premium-vnet.md#inbound-port-requirements) e [requisiti delle porte in uscita](cache-how-to-premium-vnet.md#outbound-port-requirements)), cache di hello non sarà in grado di toorestart correttamente.</span><span class="sxs-lookup"><span data-stu-id="07086-268">If all of hello required cache dependencies can't be reached (as documented in [Inbound port requirements](cache-how-to-premium-vnet.md#inbound-port-requirements) and [Outbound port requirements](cache-how-to-premium-vnet.md#outbound-port-requirements)), hello cache won't be able toorestart successfully.</span></span>
- <span data-ttu-id="07086-269">Una volta che i nodi della cache di hello riavvio (come riportato dallo stato della cache di hello in hello portale di Azure), è possibile eseguire hello seguenti test:</span><span class="sxs-lookup"><span data-stu-id="07086-269">Once hello cache nodes have restarted (as reported by hello cache status in hello Azure portal), you can perform hello following tests:</span></span>
  - <span data-ttu-id="07086-270">eseguire il ping hello endpoint della cache (tramite la porta 6380) da un computer che si trova all'interno di hello stessa rete virtuale come hello nella cache, utilizzando [tcping](https://www.elifulkerson.com/projects/tcping.php).</span><span class="sxs-lookup"><span data-stu-id="07086-270">ping hello cache endpoint (using port 6380) from a machine that is within hello same VNET as hello cache, using [tcping](https://www.elifulkerson.com/projects/tcping.php).</span></span> <span data-ttu-id="07086-271">ad esempio:</span><span class="sxs-lookup"><span data-stu-id="07086-271">For example:</span></span>
    
    `tcping.exe contosocache.redis.cache.windows.net 6380`
    
    <span data-ttu-id="07086-272">Se hello `tcping` strumento segnala che hello porta è aperta, la cache di hello è disponibile per la connessione dal client nella rete virtuale hello.</span><span class="sxs-lookup"><span data-stu-id="07086-272">If hello `tcping` tool reports that hello port is open, hello cache is available for connection from clients in hello VNET.</span></span>

  - <span data-ttu-id="07086-273">Un altro modo tootest è toocreate un client della cache di test (che può essere una semplice applicazione console tramite stackexchange. Redis) che si connette toohello cache e aggiunge e recupera alcuni elementi dalla cache di hello.</span><span class="sxs-lookup"><span data-stu-id="07086-273">Another way tootest is toocreate a test cache client (which could be a simple console application using StackExchange.Redis) that connects toohello cache and adds and retrieves some items from hello cache.</span></span> <span data-ttu-id="07086-274">Installare l'applicazione client di esempio hello in una macchina virtuale nella stessa rete virtuale come cache di hello hello ed eseguirlo come cache di toohello tooverify connettività.</span><span class="sxs-lookup"><span data-stu-id="07086-274">Install hello sample client application onto a VM that is in hello same VNET as hello cache and run it tooverify connectivity toohello cache.</span></span>


### <a name="can-i-use-vnets-with-a-standard-or-basic-cache"></a><span data-ttu-id="07086-275">È possibile usare reti virtuali con una cache Standard o Basic?</span><span class="sxs-lookup"><span data-stu-id="07086-275">Can I use VNets with a standard or basic cache?</span></span>
<span data-ttu-id="07086-276">Le reti virtuali possono essere usate solo con cache Premium.</span><span class="sxs-lookup"><span data-stu-id="07086-276">VNets can only be used with premium caches.</span></span>

### <a name="why-does-creating-a-redis-cache-fail-in-some-subnets-but-not-others"></a><span data-ttu-id="07086-277">Perché la creazione di una cache Redis ha esito negativo in alcune subnet e non in altre?</span><span class="sxs-lookup"><span data-stu-id="07086-277">Why does creating a Redis cache fail in some subnets but not others?</span></span>
<span data-ttu-id="07086-278">Se si distribuisce un tooa Cache Redis di Azure Resource Manager VNet, in una subnet dedicata che contiene l'altro tipo di risorsa deve essere cache di hello.</span><span class="sxs-lookup"><span data-stu-id="07086-278">If you are deploying an Azure Redis Cache tooa Resource Manager VNet, hello cache must be in a dedicated subnet that contains no other resource type.</span></span> <span data-ttu-id="07086-279">Se viene effettuato un tentativo di toodeploy un tooa Cache Redis di Azure Resource Manager VNet subnet che contiene altre risorse, distribuzione hello ha esito negativo.</span><span class="sxs-lookup"><span data-stu-id="07086-279">If an attempt is made toodeploy an Azure Redis Cache tooa Resource Manager VNet subnet that contains other resources, hello deployment fails.</span></span> <span data-ttu-id="07086-280">È necessario eliminare le risorse esistenti hello interno hello subnet prima di poter creare una nuova cache Redis.</span><span class="sxs-lookup"><span data-stu-id="07086-280">You must delete hello existing resources inside hello subnet before you can create a new Redis cache.</span></span>

<span data-ttu-id="07086-281">È possibile distribuire più tipi di risorse tooa classico tra reti virtuali purché si disponga di sufficiente IP indirizzi disponibili.</span><span class="sxs-lookup"><span data-stu-id="07086-281">You can deploy multiple types of resources tooa classic VNet as long as you have enough IP addresses available.</span></span>

### <a name="what-are-hello-subnet-address-space-requirements"></a><span data-ttu-id="07086-282">Quali sono i requisiti dello spazio di indirizzi subnet hello?</span><span class="sxs-lookup"><span data-stu-id="07086-282">What are hello subnet address space requirements?</span></span>
<span data-ttu-id="07086-283">Azure riserva alcuni indirizzi IP all'interno di ogni subnet e questi indirizzi non possono essere usati.</span><span class="sxs-lookup"><span data-stu-id="07086-283">Azure reserves some IP addresses within each subnet, and these addresses can't be used.</span></span> <span data-ttu-id="07086-284">gli indirizzi IP e il cognome di subnet hello Hello sono riservati per conformità al protocollo, insieme a tre ulteriori indirizzi utilizzato per i servizi di Azure.</span><span class="sxs-lookup"><span data-stu-id="07086-284">hello first and last IP addresses of hello subnets are reserved for protocol conformance, along with three more addresses used for Azure services.</span></span> <span data-ttu-id="07086-285">Per altre informazioni, vedere [Esistono restrizioni sull'uso di indirizzi IP all'interno di tali subnet?](../virtual-network/virtual-networks-faq.md#are-there-any-restrictions-on-using-ip-addresses-within-these-subnets)</span><span class="sxs-lookup"><span data-stu-id="07086-285">For more information, see [Are there any restrictions on using IP addresses within these subnets?](../virtual-network/virtual-networks-faq.md#are-there-any-restrictions-on-using-ip-addresses-within-these-subnets)</span></span>

<span data-ttu-id="07086-286">In aggiunta toohello gli indirizzi IP utilizzati dall'infrastruttura di rete virtuale di Azure hello, ogni Redis istanza hello indirizzi IP della subnet usa due per partizione e un indirizzo IP aggiuntivo di bilanciamento del carico hello.</span><span class="sxs-lookup"><span data-stu-id="07086-286">In addition toohello IP addresses used by hello Azure VNET infrastructure, each Redis instance in hello subnet uses two IP addresses per shard and one additional IP address for hello load balancer.</span></span> <span data-ttu-id="07086-287">Una cache non cluster è considerata toohave una partizione.</span><span class="sxs-lookup"><span data-stu-id="07086-287">A non-clustered cache is considered toohave one shard.</span></span>

### <a name="do-all-cache-features-work-when-hosting-a-cache-in-a-vnet"></a><span data-ttu-id="07086-288">Tutte le funzionalità della cache funzionano quando si ospita una cache in una rete virtuale?</span><span class="sxs-lookup"><span data-stu-id="07086-288">Do all cache features work when hosting a cache in a VNET?</span></span>
<span data-ttu-id="07086-289">Quando la cache fa parte di una rete virtuale, solo i client nella rete virtuale hello possono accedere cache di hello.</span><span class="sxs-lookup"><span data-stu-id="07086-289">When your cache is part of a VNET, only clients in hello VNET can access hello cache.</span></span> <span data-ttu-id="07086-290">Di conseguenza, hello seguenti funzionalità di gestione della cache non funzionano in questo momento.</span><span class="sxs-lookup"><span data-stu-id="07086-290">As a result, hello following cache management features don't work at this time.</span></span>

* <span data-ttu-id="07086-291">Console redis: la Console Redis viene eseguita nel browser locale, non è compreso hello rete virtuale, non è possibile connettersi tooyour cache.</span><span class="sxs-lookup"><span data-stu-id="07086-291">Redis Console - Because Redis Console runs in your local browser, which is outside hello VNET, it can't connect tooyour cache.</span></span>

## <a name="use-expressroute-with-azure-redis-cache"></a><span data-ttu-id="07086-292">Usare ExpressRoute con Cache Redis di Azure</span><span class="sxs-lookup"><span data-stu-id="07086-292">Use ExpressRoute with Azure Redis Cache</span></span>
<span data-ttu-id="07086-293">I clienti possono collegare un [Azure ExpressRoute](https://azure.microsoft.com/services/expressroute/) infrastruttura di rete virtuale tootheir circuito, e quindi di estendere i tooAzure di rete locale.</span><span class="sxs-lookup"><span data-stu-id="07086-293">Customers can connect an [Azure ExpressRoute](https://azure.microsoft.com/services/expressroute/) circuit tootheir virtual network infrastructure, thus extending their on-premises network tooAzure.</span></span> 

<span data-ttu-id="07086-294">Per impostazione predefinita, un circuito ExpressRoute appena creato non esegue il tunneling forzato (annuncio della route predefinita, 0.0.0.0/0) in una rete virtuale.</span><span class="sxs-lookup"><span data-stu-id="07086-294">By default, a newly created ExpressRoute circuit does not perform forced tunneling (advertisement of a default route, 0.0.0.0/0) on a VNET.</span></span> <span data-ttu-id="07086-295">Di conseguenza, la connettività Internet in uscita è consentita direttamente dalla rete virtuale hello e applicazioni client sono in grado di tooconnect tooother Azure endpoint incluso Cache Redis di Azure.</span><span class="sxs-lookup"><span data-stu-id="07086-295">As a result, outbound Internet connectivity is allowed directly from hello VNET and client applications are able tooconnect tooother Azure endpoints including Azure Redis Cache.</span></span>

<span data-ttu-id="07086-296">Tuttavia una configurazione personalizzata comune è il tunneling forzato toouse (annunciano una route predefinita) che forza in uscita Internet traffico tooinstead flusso locale.</span><span class="sxs-lookup"><span data-stu-id="07086-296">However a common customer configuration is toouse forced tunneling (advertise a default route) which forces outbound Internet traffic tooinstead flow on-premises.</span></span> <span data-ttu-id="07086-297">Questo flusso di traffico si interrompe la connettività con Cache Redis di Azure, se il traffico in uscita hello è quindi bloccato in locale, tale hello istanza di Cache Redis di Azure non è in grado di toocommunicate con le relative dipendenze.</span><span class="sxs-lookup"><span data-stu-id="07086-297">This traffic flow breaks connectivity with Azure Redis Cache if hello outbound traffic is then blocked on-premises such that hello Azure Redis Cache instance is not able toocommunicate with its dependencies.</span></span>

<span data-ttu-id="07086-298">soluzione hello è toodefine (più) definito dall'utente route (UDRs) nella subnet hello contenente hello Cache Redis di Azure.</span><span class="sxs-lookup"><span data-stu-id="07086-298">hello solution is toodefine one (or more) user-defined routes (UDRs) on hello subnet that contains hello Azure Redis Cache.</span></span> <span data-ttu-id="07086-299">Un UDR definisce le route di subnet specifiche che verranno utilizzato il valore anziché route predefinita hello.</span><span class="sxs-lookup"><span data-stu-id="07086-299">A UDR defines subnet-specific routes that will be honored instead of hello default route.</span></span>

<span data-ttu-id="07086-300">Se possibile, è consigliabile hello toouse seguente configurazione:</span><span class="sxs-lookup"><span data-stu-id="07086-300">If possible, it is recommended toouse hello following configuration:</span></span>

* <span data-ttu-id="07086-301">configurazione di ExpressRoute Hello annuncia 0.0.0.0/0 e per impostazione predefinita force tunnel tutto il traffico in uscita in locale.</span><span class="sxs-lookup"><span data-stu-id="07086-301">hello ExpressRoute configuration advertises 0.0.0.0/0 and by default force tunnels all outbound traffic on-premises.</span></span>
* <span data-ttu-id="07086-302">subnet toohello UDR applicato contenente hello Cache Redis di Azure Hello definisce 0.0.0.0/0 con una route di lavoro per TCP/IP traffico toohello internet pubblica. ad esempio dall'impostazione hello hop successivo too'Internet di tipo '.</span><span class="sxs-lookup"><span data-stu-id="07086-302">hello UDR applied toohello subnet containing hello Azure Redis Cache defines 0.0.0.0/0 with a working route for TCP/IP traffic toohello public internet; for example by setting hello next hop type too'Internet'.</span></span>

<span data-ttu-id="07086-303">Hello effetto combinato di questi passaggi è che il livello di subnet hello UDR ha la precedenza su hello garantendo l'accesso a Internet in uscita da hello Cache Redis di Azure, tunneling forzato ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="07086-303">hello combined effect of these steps is that hello subnet level UDR takes precedence over hello ExpressRoute forced tunneling, thus ensuring outbound Internet access from hello Azure Redis Cache.</span></span>

<span data-ttu-id="07086-304">Istanza di Cache Redis di Azure tooan connessione da un'applicazione locale tramite ExpressRoute non è uno scenario di utilizzo tipico a causa di motivi tooperformance (per ottimizzare le prestazioni della Cache Redis di Azure, i client devono trovarsi in hello stessa area hello Cache Redis di Azure).</span><span class="sxs-lookup"><span data-stu-id="07086-304">Connecting tooan Azure Redis Cache instance from an on-premises application using ExpressRoute is not a typical usage scenario due tooperformance reasons (for best performance Azure Redis Cache clients should be in hello same region as hello Azure Redis Cache).</span></span>

>[!IMPORTANT] 
><span data-ttu-id="07086-305">Hello route definite in un UDR **deve** essere sufficientemente specifica tootake precedenza su qualsiasi route annunciate dalla configurazione di ExpressRoute hello.</span><span class="sxs-lookup"><span data-stu-id="07086-305">hello routes defined in a UDR **must** be specific enough tootake precedence over any routes advertised by hello ExpressRoute configuration.</span></span> <span data-ttu-id="07086-306">Hello seguente utilizza l'intervallo di indirizzi 0.0.0.0/0 ampie hello e di conseguenza possa accidentalmente sottoposto a override dagli annunci della route utilizzando più specifici intervalli di indirizzi.</span><span class="sxs-lookup"><span data-stu-id="07086-306">hello following example uses hello broad 0.0.0.0/0 address range, and as such can potentially be accidentally overridden by route advertisements using more specific address ranges.</span></span>

>[!WARNING]  
><span data-ttu-id="07086-307">Cache Redis di Azure non è supportata con ExpressRoute configurazioni che **in modo non corretto tra-annunciare le route da hello peering percorso toohello privata percorso di peering pubblico**.</span><span class="sxs-lookup"><span data-stu-id="07086-307">Azure Redis Cache is not supported with ExpressRoute configurations that **incorrectly cross-advertise routes from hello public peering path toohello private peering path**.</span></span> <span data-ttu-id="07086-308">Le configurazioni di ExpressRoute per cui è configurato il peering pubblico riceveranno gli annunci delle route da Microsoft per un elevato numero di intervalli di indirizzi IP di Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="07086-308">ExpressRoute configurations that have public peering configured, receive route advertisements from Microsoft for a large set of Microsoft Azure IP address ranges.</span></span> <span data-ttu-id="07086-309">Se questi intervalli di indirizzi in modo non corretto tra annunciati nel percorso di peering privato hello, risultato hello è che tutti i pacchetti di rete in uscita dalla subnet dell'istanza di Cache Redis di Azure hello sono rete locale del cliente in modo errato il tunneling forzato tooa infrastruttura.</span><span class="sxs-lookup"><span data-stu-id="07086-309">If these address ranges are incorrectly cross-advertised on hello private peering path, hello result is that all outbound network packets from hello Azure Redis Cache instance's subnet are incorrectly force-tunneled tooa customer's on-premises network infrastructure.</span></span> <span data-ttu-id="07086-310">Questo flusso di rete interromperà Cache Redis di Azure.</span><span class="sxs-lookup"><span data-stu-id="07086-310">This network flow breaks Azure Redis Cache.</span></span> <span data-ttu-id="07086-311">problema di toothis soluzione hello è toostop le route tra annunci hello peering percorso toohello privata percorso di peering pubblico.</span><span class="sxs-lookup"><span data-stu-id="07086-311">hello solution toothis problem is toostop cross-advertising routes from hello public peering path toohello private peering path.</span></span>


<span data-ttu-id="07086-312">Le informazioni generali sulle route definite dall'utente sono disponibili in questa [panoramica](../virtual-network/virtual-networks-udr-overview.md).</span><span class="sxs-lookup"><span data-stu-id="07086-312">Background information on user-defined routes is available in this [overview](../virtual-network/virtual-networks-udr-overview.md).</span></span>

<span data-ttu-id="07086-313">Per altre informazioni su ExpressRoute, vedere [Panoramica tecnica relativa a ExpressRoute](../expressroute/expressroute-introduction.md).</span><span class="sxs-lookup"><span data-stu-id="07086-313">For more information about ExpressRoute, see [ExpressRoute technical overview](../expressroute/expressroute-introduction.md).</span></span>

## <a name="next-steps"></a><span data-ttu-id="07086-314">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="07086-314">Next steps</span></span>
<span data-ttu-id="07086-315">Informazioni su come toouse premium più memorizzano nella cache le funzionalità.</span><span class="sxs-lookup"><span data-stu-id="07086-315">Learn how toouse more premium cache features.</span></span>

* [<span data-ttu-id="07086-316">Livello di introduzione toohello Premium di Cache Redis di Azure</span><span class="sxs-lookup"><span data-stu-id="07086-316">Introduction toohello Azure Redis Cache Premium tier</span></span>](cache-premium-tier-intro.md)

<!-- IMAGES -->

[redis-cache-vnet]: ./media/cache-how-to-premium-vnet/redis-cache-vnet.png

[redis-cache-vnet-ip]: ./media/cache-how-to-premium-vnet/redis-cache-vnet-ip.png

[redis-cache-vnet-info]: ./media/cache-how-to-premium-vnet/redis-cache-vnet-info.png

