---
title: Dettagli di configurazione di rete per l'uso di Express Route
description: Dettagli di configurazione di rete per eseguire ambienti del servizio app in reti virtuali connesse a un circuito ExpressRoute.
services: app-service
documentationcenter: 
author: stefsch
manager: nirma
editor: 
ms.assetid: 34b49178-2595-4d32-9b41-110c96dde6bf
ms.service: app-service
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 10/14/2016
ms.author: stefsch
ms.openlocfilehash: de1d998ee86c127149dee18e9df577705054ddb4
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 07/11/2017
---
# <a name="network-configuration-details-for-app-service-environments-with-expressroute"></a><span data-ttu-id="050fa-103">Dettagli della configurazione di rete per gli ambienti del servizio app con ExpressRoute</span><span class="sxs-lookup"><span data-stu-id="050fa-103">Network Configuration Details for App Service Environments with ExpressRoute</span></span>
## <a name="overview"></a><span data-ttu-id="050fa-104">Panoramica</span><span class="sxs-lookup"><span data-stu-id="050fa-104">Overview</span></span>
<span data-ttu-id="050fa-105">I clienti possono connettere un circuito [Azure ExpressRoute][ExpressRoute] all'infrastruttura di rete virtuale per estendere la rete locale ad Azure.</span><span class="sxs-lookup"><span data-stu-id="050fa-105">Customers can connect an [Azure ExpressRoute][ExpressRoute] circuit to their virtual network infrastructure, thus extending their on-premises network to Azure.</span></span>  <span data-ttu-id="050fa-106">Un ambiente del servizio app può essere creato in una subnet di questa infrastruttura di [rete virtuale][virtualnetwork].</span><span class="sxs-lookup"><span data-stu-id="050fa-106">An App Service Environment can  be created in a subnet of this [virtual network][virtualnetwork] infrastructure.</span></span>  <span data-ttu-id="050fa-107">Le app in esecuzione nell'ambiente del servizio app possono quindi stabilire connessioni sicure a risorse back-end accessibili solo tramite la connessione ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="050fa-107">Apps running on the App Service Environment can then establish secure connections to back-end resources accessible only over the ExpressRoute connection.</span></span>  

<span data-ttu-id="050fa-108">Un ambiente del servizio app può essere creato in una rete virtuale di Azure Resource Manager ******o** in una rete virtuale del modello di distribuzione classica.</span><span class="sxs-lookup"><span data-stu-id="050fa-108">An App Service Environment can be created in **either** an Azure Resource Manager virtual network, **or** a classic deployment model virtual network.</span></span>  <span data-ttu-id="050fa-109">Con una modifica recente apportata a giugno 2016, gli ambienti del servizio app possono essere distribuiti nelle reti virtuali che usano intervalli di indirizzi pubblici o spazi di indirizzi RFC1918, ovvero</span><span class="sxs-lookup"><span data-stu-id="050fa-109">With a recent change made in June 2016, ASEs can also now be deployed into virtual networks that use either public address ranges, or RFC1918 address spaces (i.e.</span></span> <span data-ttu-id="050fa-110">indirizzi privati.</span><span class="sxs-lookup"><span data-stu-id="050fa-110">private addresses).</span></span> 

[!INCLUDE [app-service-web-to-api-and-mobile](../../includes/app-service-web-to-api-and-mobile.md)]

## <a name="required-network-connectivity"></a><span data-ttu-id="050fa-111">Requisiti della connettività di rete</span><span class="sxs-lookup"><span data-stu-id="050fa-111">Required Network Connectivity</span></span>
<span data-ttu-id="050fa-112">Esistono requisiti di connettività di rete per gli ambienti del servizio app che potrebbero non essere inizialmente soddisfatti in una rete virtuale connessa a ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="050fa-112">There are network connectivity requirements for App Service Environments that may not be initially met in a virtual network connected to an ExpressRoute.</span></span>  <span data-ttu-id="050fa-113">I requisiti per il corretto funzionamento degli ambienti del servizio app sono i seguenti:</span><span class="sxs-lookup"><span data-stu-id="050fa-113">App Service Environments require all of the following in order to function properly:</span></span>

* <span data-ttu-id="050fa-114">Connettività di rete in uscita per endpoint di archiviazione di Azure su entrambe le porte, 80 e 443.</span><span class="sxs-lookup"><span data-stu-id="050fa-114">Outbound network connectivity to Azure Storage endpoints worldwide on both ports 80 and 443.</span></span>  <span data-ttu-id="050fa-115">Sono inclusi gli endpoint che si trovano nella stessa area dell'ambiente del servizio app, nonché gli endpoint di archiviazione che si trovano in **altre** aree di Azure.</span><span class="sxs-lookup"><span data-stu-id="050fa-115">This includes endpoints located in the same region as the App Service Environment, as well as storage endpoints located in **other** Azure regions.</span></span>  <span data-ttu-id="050fa-116">Gli endpoint di archiviazione di Azure vengono risolti nei seguenti domini DNS: *table.core.windows.net*, *blob.core.windows.net*, *queue.core.windows.net* e *file.core.windows.net*.</span><span class="sxs-lookup"><span data-stu-id="050fa-116">Azure Storage endpoints resolve under the following DNS domains: *table.core.windows.net*, *blob.core.windows.net*, *queue.core.windows.net* and *file.core.windows.net*.</span></span>  
* <span data-ttu-id="050fa-117">Connettività di rete in uscita verso il servizio File di Azure sulla porta 445.</span><span class="sxs-lookup"><span data-stu-id="050fa-117">Outbound network connectivity to the Azure Files service on port 445.</span></span>
* <span data-ttu-id="050fa-118">Connettività di rete in uscita agli endpoint Sql DB che si trovano nella stessa area dell'ambiente del servizio app.</span><span class="sxs-lookup"><span data-stu-id="050fa-118">Outbound network connectivity to Sql DB endpoints located in the same region as the App Service Environment.</span></span>  <span data-ttu-id="050fa-119">Gli endpoint del database SQL vengono risolti nel dominio seguente: *database.windows.net*.</span><span class="sxs-lookup"><span data-stu-id="050fa-119">Sql DB endpoints resolve under the following domain:  *database.windows.net*.</span></span>  <span data-ttu-id="050fa-120">Ciò richiede l'apertura dell'accesso alle porte 1433, 11000-11999 e 14000-14999.</span><span class="sxs-lookup"><span data-stu-id="050fa-120">This requires opening access to ports 1433, 11000-11999 and 14000-14999.</span></span>  <span data-ttu-id="050fa-121">Per altri dettagli, vedere [questo articolo sull'uso delle porte per il database SQL versione 12](../sql-database/sql-database-develop-direct-route-ports-adonet-v12.md).</span><span class="sxs-lookup"><span data-stu-id="050fa-121">For more details see [this article on Sql Database V12 port usage](../sql-database/sql-database-develop-direct-route-ports-adonet-v12.md).</span></span>
* <span data-ttu-id="050fa-122">Connettività di rete in uscita verso gli endpoint del piano di gestione di Azure (sia gli endpoint ASM che quelli ARM).</span><span class="sxs-lookup"><span data-stu-id="050fa-122">Outbound network connectivity to the Azure management plane endpoints (both ASM and ARM endpoints).</span></span>  <span data-ttu-id="050fa-123">È inclusa la connettività in uscita verso *management.core.windows.net* e *management.azure.com*.</span><span class="sxs-lookup"><span data-stu-id="050fa-123">This includes outbound connectivity to both *management.core.windows.net* and *management.azure.com*.</span></span> 
* <span data-ttu-id="050fa-124">Connettività di rete in uscita verso *ocsp.msocsp.com*, *mscrl.microsoft.com* e *crl.microsoft.com*.</span><span class="sxs-lookup"><span data-stu-id="050fa-124">Outbound network connectivity to *ocsp.msocsp.com*, *mscrl.microsoft.com* and *crl.microsoft.com*.</span></span>  <span data-ttu-id="050fa-125">È necessario per supportare la funzionalità SSL.</span><span class="sxs-lookup"><span data-stu-id="050fa-125">This is needed to support SSL functionality.</span></span>
* <span data-ttu-id="050fa-126">La configurazione DNS per la rete virtuale deve essere in grado di risolvere tutti gli endpoint e i domini indicati nei punti precedenti.</span><span class="sxs-lookup"><span data-stu-id="050fa-126">The DNS configuration for the virtual network must be capable of resolving all of the endpoints and domains mentioned in the earlier points.</span></span>  <span data-ttu-id="050fa-127">Se questi endpoint non possono essere risolti, il tentativo di creazione dell’ambiente del servizio App avrà esito negativo, e gli ambienti del servizio App esistenti verranno contrassegnati come non integri.</span><span class="sxs-lookup"><span data-stu-id="050fa-127">If these endpoints cannot be resolved, App Service Environment creation attempts will fail, and existing App Service Environments will be marked as unhealthy.</span></span>
* <span data-ttu-id="050fa-128">L'accesso in uscita sulla porta 53 è necessario per la comunicazione con i server DNS.</span><span class="sxs-lookup"><span data-stu-id="050fa-128">Outbound access on port 53 is required for communication with DNS servers.</span></span>
* <span data-ttu-id="050fa-129">Se è presente un server DNS personalizzato nell’altra estremità di un gateway VPN, il server DNS deve essere raggiungibile dalla subnet che contiene l’ambiente di servizio app.</span><span class="sxs-lookup"><span data-stu-id="050fa-129">If a custom DNS server exists on the other end of a VPN gateway, the DNS server must be reachable from the subnet containing the App Service Environment.</span></span> 
* <span data-ttu-id="050fa-130">Il percorso di rete in uscita non può attraversare i proxy aziendali interni, né può essere sottoposto a tunneling forzato all’ambiente locale.</span><span class="sxs-lookup"><span data-stu-id="050fa-130">The outbound network path cannot travel through internal corporate proxies, nor can it be force tunneled to on-premises.</span></span>  <span data-ttu-id="050fa-131">In questo modo viene modificato l'indirizzo NAT effettivo del traffico di rete in uscita dall'ambiente di servizio app.</span><span class="sxs-lookup"><span data-stu-id="050fa-131">Doing so changes the effective NAT address of outbound network traffic from the App Service Environment.</span></span>  <span data-ttu-id="050fa-132">La modifica dell'indirizzo NAT del traffico di rete in uscita di un ambiente del servizio app provocherà errori di connettività a molti degli endpoint sopra elencati.</span><span class="sxs-lookup"><span data-stu-id="050fa-132">Changing the NAT address of an App Service Environment's outbound network traffic will cause connectivity failures to many of the endpoints listed above.</span></span>  <span data-ttu-id="050fa-133">Ciò comporta dei tentativi non riusciti nella creazione dell’ambiente di servizio app, così come il fatto che ambienti di servizio app che prima erano integri vengano contrassegnati come non integri.</span><span class="sxs-lookup"><span data-stu-id="050fa-133">This results in failed App Service Environment creation attempts, as well as previously healthy App Service Environments being marked as unhealthy.</span></span>  
* <span data-ttu-id="050fa-134">L'accesso di rete in ingresso alle porte necessarie per gli ambienti del servizio app deve essere consentito come spiegato in questo [articolo][requiredports].</span><span class="sxs-lookup"><span data-stu-id="050fa-134">Inbound network access to required ports for App Service Environments must be allowed as described in this [article][requiredports].</span></span>

<span data-ttu-id="050fa-135">I requisiti DNS possono essere soddisfatti garantendo che un'infrastruttura DNS valida venga configurata e mantenuta per la rete virtuale.</span><span class="sxs-lookup"><span data-stu-id="050fa-135">The DNS requirements can be met by ensuring a valid DNS infrastructure is configured and maintained for the virtual network.</span></span>  <span data-ttu-id="050fa-136">Se per qualsiasi motivo viene modificata la configurazione DNS dopo aver creato un ambiente di servizio app, gli sviluppatori possono forzare un ambiente di servizio app per selezionare la nuova configurazione del DNS.</span><span class="sxs-lookup"><span data-stu-id="050fa-136">If for any reason the DNS configuration is changed after an App Service Environment has been created, developers can force an App Service Environment to pick up the new DNS configuration.</span></span>  <span data-ttu-id="050fa-137">L'attivazione di un riavvio di ambiente in sequenza con l'icona "Riavvia" disponibile nella parte superiore del pannello di gestione dell'ambiente del servizio app nel [portale di Azure][NewPortal] farà sì che l'ambiente selezioni la nuova configurazione del DNS.</span><span class="sxs-lookup"><span data-stu-id="050fa-137">Triggering a rolling environment reboot using the "Restart" icon located at the top of the App Service Environment management blade in the [Azure portal][NewPortal] will cause the environment to pick up the new DNS configuration.</span></span>

<span data-ttu-id="050fa-138">Per soddisfare i requisiti di accesso alla rete in ingresso, configurare un [gruppo di sicurezza di rete][NetworkSecurityGroups] nella subnet dell'ambiente del servizio app per consentire l'accesso necessario, come spiegato in questo [articolo][requiredports].</span><span class="sxs-lookup"><span data-stu-id="050fa-138">The inbound network access requirements can be met by configuring a [network security group][NetworkSecurityGroups] on the App Service Environment's subnet to allow the required access as described in this [article][requiredports].</span></span>

## <a name="enabling-outbound-network-connectivity-for-an-app-service-environment"></a><span data-ttu-id="050fa-139">Abilitazione della connettività di rete in uscita per un ambiente del servizio app</span><span class="sxs-lookup"><span data-stu-id="050fa-139">Enabling Outbound Network Connectivity for an App Service Environment</span></span>
<span data-ttu-id="050fa-140">Per impostazione predefinita, un circuito ExpressRoute appena creato annuncia una route predefinita che consente la connettività Internet in uscita.</span><span class="sxs-lookup"><span data-stu-id="050fa-140">By default, a newly created ExpressRoute circuit advertises a default route that allows outbound Internet connectivity.</span></span>  <span data-ttu-id="050fa-141">Con questa configurazione, un ambiente del servizio app sarà in grado di connettersi ad altri endpoint di Azure.</span><span class="sxs-lookup"><span data-stu-id="050fa-141">With this configuration an App Service Environment will be able to connect to other Azure endpoints.</span></span>

<span data-ttu-id="050fa-142">Tuttavia, secondo una diffusa configurazione, i clienti definiscono la propria route predefinita (0.0.0.0/0) verso la quale viene forzato il traffico Internet in uscita invece di far passare il flusso localmente.</span><span class="sxs-lookup"><span data-stu-id="050fa-142">However a common customer configuration is to define their own default route (0.0.0.0/0) which forces outbound Internet traffic to instead flow on-premises.</span></span>  <span data-ttu-id="050fa-143">Questo flusso di traffico interrompe sempre gli ambienti del servizio app perché il traffico in uscita è bloccato in locale o convertito tramite NAT in un set non riconoscibile di indirizzi che non usano più i diversi endpoint di Azure.</span><span class="sxs-lookup"><span data-stu-id="050fa-143">This traffic flow invariably breaks App Service Environments because the outbound traffic is either blocked on-premises, or NAT'd to an unrecognizable set of addresses that no longer work with various Azure endpoints.</span></span>

<span data-ttu-id="050fa-144">La soluzione consiste nel definire una o più route definite dall'utente (UDR, User Defined Route) nella subnet contenente l'ambiente del servizio app.</span><span class="sxs-lookup"><span data-stu-id="050fa-144">The solution is to define one (or more) user defined routes (UDRs) on the subnet that contains the App Service Environment.</span></span>  <span data-ttu-id="050fa-145">Una route UDR definisce le route specifiche della subnet che verranno accettate invece della route predefinita.</span><span class="sxs-lookup"><span data-stu-id="050fa-145">A UDR defines subnet-specific routes that will be honored instead of the default route.</span></span>

<span data-ttu-id="050fa-146">Se possibile, è consigliabile utilizzare la seguente configurazione:</span><span class="sxs-lookup"><span data-stu-id="050fa-146">If possible, it is recommended to use the following configuration:</span></span>

* <span data-ttu-id="050fa-147">La configurazione di ExpressRoute annuncia 0.0.0.0/0 e per impostazione predefinita esegue il tunneling forzato di tutto il traffico in uscita in un ambiente locale.</span><span class="sxs-lookup"><span data-stu-id="050fa-147">The ExpressRoute configuration advertises 0.0.0.0/0 and by default force tunnels all outbound traffic on-premises.</span></span>
* <span data-ttu-id="050fa-148">L’UDR applicato alla subnet contenente l'ambiente di servizio app definisce 0.0.0.0/0 con un tipo di hop successivo di Internet (è possibile trovare un esempio più avanti in questo articolo).</span><span class="sxs-lookup"><span data-stu-id="050fa-148">The UDR applied to the subnet containing the App Service Environment defines 0.0.0.0/0 with a next hop type of Internet (an example of this is farther down in this article).</span></span>

<span data-ttu-id="050fa-149">L'effetto combinato di questi passaggi è che il livello di subnet UDR avrà la precedenza sul tunneling forzato di ExpressRoute, garantendo l'accesso a Internet in uscita dall'ambiente di servizio app.</span><span class="sxs-lookup"><span data-stu-id="050fa-149">The combined effect of these steps is that the subnet level UDR will take precedence over the ExpressRoute forced tunneling, thus ensuring outbound Internet access from the App Service Environment.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="050fa-150">Le route definite in una route UDR **devono** essere sufficientemente specifiche da avere la precedenza su qualsiasi route annunciata dalla configurazione di ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="050fa-150">The routes defined in a UDR **must** be specific enough to  take precedence over any routes advertised by the ExpressRoute configuration.</span></span>  <span data-ttu-id="050fa-151">Nell'esempio di seguito viene utilizzato l'intervallo di indirizzi ampio 0.0.0.0/0 e pertanto può essere accidentalmente sottoposto a override dagli annunci di route mediante più intervalli di indirizzi specifici.</span><span class="sxs-lookup"><span data-stu-id="050fa-151">The example below uses the broad 0.0.0.0/0 address range, and as such can potentially be accidentally overridden by route advertisements using more specific address ranges.</span></span>
> 
> <span data-ttu-id="050fa-152">Gli ambienti del servizio app non sono supportati con le configurazioni di ExpressRoute con **annuncio incrociato di route dal percorso di peering pubblico al percorso di peering privato**.</span><span class="sxs-lookup"><span data-stu-id="050fa-152">App Service Environments are not supported with ExpressRoute configurations that **cross-advertise routes from the public peering path to the private peering path**.</span></span>  <span data-ttu-id="050fa-153">Le configurazioni di ExpressRoute che dispongono di peering pubblico configurato, riceveranno gli annunci di route da Microsoft per un elevato numero di intervalli di indirizzi IP di Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="050fa-153">ExpressRoute configurations that have public peering configured, will receive route advertisements from Microsoft for a large set of Microsoft Azure IP address ranges.</span></span>  <span data-ttu-id="050fa-154">In caso di annuncio incrociato di questi intervalli di indirizzi nel percorso di peering privato, il risultato finale è che tutti i pacchetti di rete in uscita dalla subnet dell'ambiente di servizio app servizio verranno sottoposti a tunneling forzato verso un'infrastruttura di rete locale del cliente.</span><span class="sxs-lookup"><span data-stu-id="050fa-154">If these address ranges are cross-advertised on the private peering path, the end result is that all outbound network packets from the App Service Environment's subnet will be force-tunneled to a customer's on-premises network infrastructure.</span></span>  <span data-ttu-id="050fa-155">Questo flusso di rete non è attualmente supportato con ambienti del servizio app.</span><span class="sxs-lookup"><span data-stu-id="050fa-155">This network flow is currently not supported with App Service Environments.</span></span>  <span data-ttu-id="050fa-156">Una soluzione a questo problema consiste nell'interrompere l'annuncio incrociato di route dal percorso di peering pubblico al percorso di peering privato.</span><span class="sxs-lookup"><span data-stu-id="050fa-156">One solution to this problem is to stop cross-advertising routes from the public peering path to the private peering path.</span></span>
> 
> 

<span data-ttu-id="050fa-157">Le informazioni generali sulle route definite dall'utente sono disponibili in questa [panoramica][UDROverview].</span><span class="sxs-lookup"><span data-stu-id="050fa-157">Background information on user defined routes is available in this [overview][UDROverview].</span></span>  

<span data-ttu-id="050fa-158">Le informazioni dettagliate sulla creazione e la configurazione di route definite dall'utente sono disponibili in questa [guida alle procedure][UDRHowTo].</span><span class="sxs-lookup"><span data-stu-id="050fa-158">Details on creating and configuring user defined routes is available in this [How To Guide][UDRHowTo].</span></span>

## <a name="example-udr-configuration-for-an-app-service-environment"></a><span data-ttu-id="050fa-159">Esempio di configurazione UDR per un ambiente del servizio app</span><span class="sxs-lookup"><span data-stu-id="050fa-159">Example UDR Configuration for an App Service Environment</span></span>
<span data-ttu-id="050fa-160">**Prerequisiti**</span><span class="sxs-lookup"><span data-stu-id="050fa-160">**Pre-requisites**</span></span>

1. <span data-ttu-id="050fa-161">Installare Azure PowerShell dalla [pagina di download di Azure][AzureDownloads] (con data giugno 2015 o successiva).</span><span class="sxs-lookup"><span data-stu-id="050fa-161">Install Azure Powershell from the [Azure Downloads page][AzureDownloads] (dated June 2015 or later).</span></span>  <span data-ttu-id="050fa-162">In "Strumenti da riga di comando" è presente un collegamento "Installa" in "Windows Powershell" che installerà i cmdlet di Powershell più recenti.</span><span class="sxs-lookup"><span data-stu-id="050fa-162">Under "Command-line tools" there is an "Install" link under "Windows Powershell" that will install the latest Powershell cmdlets.</span></span>
2. <span data-ttu-id="050fa-163">È consigliabile creare una subnet univoca da usare esclusivamente in un ambiente del servizio app.</span><span class="sxs-lookup"><span data-stu-id="050fa-163">It is recommended that a unique subnet is created for exclusive use by an App Service Environment.</span></span>  <span data-ttu-id="050fa-164">In questo modo le route UDR applicate alla subnet apriranno solo il traffico in uscita per l'ambiente del servizio app.</span><span class="sxs-lookup"><span data-stu-id="050fa-164">This ensures that the UDRs applied to the subnet will only open outbound traffic for the App Service Environment.</span></span>
3. <span data-ttu-id="050fa-165">**Importante**: distribuire l'ambiente del servizio app solo **dopo** aver eseguito questi passaggi di configurazione.</span><span class="sxs-lookup"><span data-stu-id="050fa-165">**Important**:  do not deploy the App Service Environment until **after** the following configuration steps are followed.</span></span>  <span data-ttu-id="050fa-166">Questo assicura che la connettività di rete in uscita sia disponibile prima di tentare di distribuire un ambiente del servizio app.</span><span class="sxs-lookup"><span data-stu-id="050fa-166">This ensures that outbound network connectivity is available before attempting to deploy an App Service Environment.</span></span>

<span data-ttu-id="050fa-167">**Passaggio 1: Creare una tabella di route denominata**</span><span class="sxs-lookup"><span data-stu-id="050fa-167">**Step 1:  Create a named route table**</span></span>

<span data-ttu-id="050fa-168">Il frammento seguente crea una tabella di route denominata "DirectInternetRouteTable" nell'area di Azure Stati Uniti occidentali:</span><span class="sxs-lookup"><span data-stu-id="050fa-168">The following snippet creates a route table called "DirectInternetRouteTable" in the West US Azure region:</span></span>

    New-AzureRouteTable -Name 'DirectInternetRouteTable' -Location uswest

<span data-ttu-id="050fa-169">**Passaggio 2: Creare una o più route nella tabella di route**</span><span class="sxs-lookup"><span data-stu-id="050fa-169">**Step 2:  Create one or more routes in the route table**</span></span>

<span data-ttu-id="050fa-170">Sarà necessario aggiungere una o più route alla tabella di route per consentire l'accesso Internet in uscita.</span><span class="sxs-lookup"><span data-stu-id="050fa-170">You will need to add one or more routes to the route table in order to enable outbound Internet access.</span></span>  

<span data-ttu-id="050fa-171">L'approccio consigliato per la configurazione dell'accesso in uscita a Internet consiste nel definire una route per 0.0.0.0/0, come illustrato di seguito.</span><span class="sxs-lookup"><span data-stu-id="050fa-171">The recommended approach for configuring outbound access to the Internet is to define a route for 0.0.0.0/0 as shown below.</span></span>

    Get-AzureRouteTable -Name 'DirectInternetRouteTable' | Set-AzureRoute -RouteName 'Direct Internet Range 0' -AddressPrefix 0.0.0.0/0 -NextHopType Internet

<span data-ttu-id="050fa-172">Tenere presente che 0.0.0.0/0 è un intervallo di indirizzi ampio e verrà quindi sottoposto a override da intervalli di indirizzi più specifici annunciati da ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="050fa-172">Remember that 0.0.0.0/0 is a broad address range, and as such will be overridden by more specific address ranges advertised by the ExpressRoute.</span></span>  <span data-ttu-id="050fa-173">Per reiterare il consiglio precedente, un UDR con una route 0.0.0.0/0 deve essere utilizzata insieme a una configurazione ExressRoute che allo stesso modo annuncia solo 0.0.0.0/0.</span><span class="sxs-lookup"><span data-stu-id="050fa-173">To re-iterate the earlier recommendation, a UDR with a 0.0.0.0/0 route should be used in conjunction with an ExressRoute configuration that only advertises 0.0.0.0/0 as well.</span></span> 

<span data-ttu-id="050fa-174">In alternativa, è possibile scaricare un elenco completo e aggiornato di intervalli CIDR utilizzato da Azure.</span><span class="sxs-lookup"><span data-stu-id="050fa-174">As an alternative, you can download a comprehensive and updated list of CIDR ranges in use by Azure.</span></span>  <span data-ttu-id="050fa-175">Il file XML contenente tutti gli intervalli di indirizzi IP di Azure è disponibile nell'[Area download Microsoft][DownloadCenterAddressRanges].</span><span class="sxs-lookup"><span data-stu-id="050fa-175">The Xml file containing all of the Azure IP address ranges is available from the [Microsoft Download Center][DownloadCenterAddressRanges].</span></span>  

<span data-ttu-id="050fa-176">Si noti tuttavia che questi intervalli cambiano nel tempo ed è quindi è necessario eseguire aggiornamenti manuali periodici delle route definite dall'utente per mantenere la sincronizzazione.</span><span class="sxs-lookup"><span data-stu-id="050fa-176">Note though that these ranges change over time, thus necessitating periodic manual updates to the user defined routes to keep in sync.</span></span>  <span data-ttu-id="050fa-177">A causa del limite massimo predefinito di 100 route in una singola route UDR, inoltre, sarà necessario "riepilogare" gli intervalli di indirizzi IP di Azure per rientrare nel limite di 100 route, tenendo presente che le route definite come UDR devono essere più specifiche rispetto alle route annunciate da ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="050fa-177">Also, since there is a default upper limit of 100 routes in a single UDR, you will need to "summarize" the Azure IP address ranges to fit within the 100 route limit, keeping in mind that UDR defined routes need to be more specific than the routes advertised by your ExpressRoute.</span></span>  

<span data-ttu-id="050fa-178">**Passaggio 3: Associare la tabella di route alla subnet contenente l'ambiente del servizio app**</span><span class="sxs-lookup"><span data-stu-id="050fa-178">**Step 3:  Associate the route table to the subnet containing the App Service Environment**</span></span>

<span data-ttu-id="050fa-179">Nell'ultimo passaggio della configurazione si associa la tabella di route alla subnet in cui verrà distribuito l'ambiente del servizio app.</span><span class="sxs-lookup"><span data-stu-id="050fa-179">The last  configuration step is to associate the route table to the subnet where the App Service Environment will be deployed.</span></span>  <span data-ttu-id="050fa-180">Il comando seguente associa "DirectInternetRouteTable" ad "ASESubnet" che alla fine conterrà un ambiente del servizio app.</span><span class="sxs-lookup"><span data-stu-id="050fa-180">The following command associates the "DirectInternetRouteTable" to the "ASESubnet" that will eventually contain an App Service Environment.</span></span>

    Set-AzureSubnetRouteTable -VirtualNetworkName 'YourVirtualNetworkNameHere' -SubnetName 'ASESubnet' -RouteTableName 'DirectInternetRouteTable'


<span data-ttu-id="050fa-181">**Passaggio 4: Procedura finale**</span><span class="sxs-lookup"><span data-stu-id="050fa-181">**Step 4:  Final Steps**</span></span>

<span data-ttu-id="050fa-182">Una volta associata la tabella di route alla subnet, si consiglia di testare e verificare l'effetto desiderato.</span><span class="sxs-lookup"><span data-stu-id="050fa-182">Once the route table is bound to the subnet, it is recommended to first test and confirm the intended effect.</span></span>  <span data-ttu-id="050fa-183">Ad esempio, distribuire una macchina virtuale nella subnet e verificare che:</span><span class="sxs-lookup"><span data-stu-id="050fa-183">For example, deploy a virtual machine into the subnet and confirm that:</span></span>

* <span data-ttu-id="050fa-184">Il traffico in uscita per endpoint di Azure e non indicato in precedenza in questo articolo **non** è indirizzato verso il basso nel circuito ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="050fa-184">Outbound traffic to both Azure and non-Azure endpoints mentioned earlier in this article is **not** flowing down the ExpressRoute circuit.</span></span>  <span data-ttu-id="050fa-185">È molto importante verificare questo comportamento, poiché se il traffico in uscita dalla subnet è comunque sottoposto a tunneling forzato in un ambiente locale, la creazione dell’ambiente di servizio app avrà sempre esito negativo.</span><span class="sxs-lookup"><span data-stu-id="050fa-185">It is very important to verify this behavior, since if outbound traffic from the subnet is still being forced tunneled on-premises, App Service Environment creation will always fail.</span></span> 
* <span data-ttu-id="050fa-186">Le ricerche DNS per gli endpoint indicati in precedenza hanno tutte esito positivo.</span><span class="sxs-lookup"><span data-stu-id="050fa-186">DNS lookups for the endpoints mentioned earlier are all resolving properly.</span></span> 

<span data-ttu-id="050fa-187">Una volta che i passaggi sopra riportati vengono confermati, è necessario eliminare la macchina virtuale perché la subnet deve essere "vuota" al momento della creazione dell’ambiente di servizio app.</span><span class="sxs-lookup"><span data-stu-id="050fa-187">Once the above steps are confirmed, you will need to delete the virtual machine because the subnet needs to be "empty" at the time the App Service Environment is created.</span></span>

<span data-ttu-id="050fa-188">Procedere quindi con la creazione di un ambiente di servizio app.</span><span class="sxs-lookup"><span data-stu-id="050fa-188">Then proceed with creating an App Service Environment!</span></span>

## <a name="getting-started"></a><span data-ttu-id="050fa-189">Introduzione</span><span class="sxs-lookup"><span data-stu-id="050fa-189">Getting started</span></span>
<span data-ttu-id="050fa-190">Tutti gli articoli e le procedure sugli ambienti del servizio app sono disponibili nel [file LEGGIMI per gli ambienti di servizio dell'applicazione](../app-service/app-service-app-service-environments-readme.md).</span><span class="sxs-lookup"><span data-stu-id="050fa-190">All articles and How-To's for App Service Environments are available in the [README for Application Service Environments](../app-service/app-service-app-service-environments-readme.md).</span></span>

<span data-ttu-id="050fa-191">Per iniziare a usare gli ambienti del servizio app, vedere [Introduzione all'ambiente del servizio app][IntroToAppServiceEnvironment]</span><span class="sxs-lookup"><span data-stu-id="050fa-191">To get started with App Service Environments, see [Introduction to App Service Environment][IntroToAppServiceEnvironment]</span></span>

<span data-ttu-id="050fa-192">Per altre informazioni sulla piattaforma del servizio app di Azure, vedere l'articolo relativo al [servizio app di Azure][AzureAppService].</span><span class="sxs-lookup"><span data-stu-id="050fa-192">For more information about the Azure App Service platform, see [Azure App Service][AzureAppService].</span></span>

<!-- LINKS -->
[virtualnetwork]: http://azure.microsoft.com/services/virtual-network/
[ExpressRoute]: http://azure.microsoft.com/services/expressroute/
[requiredports]: http://azure.microsoft.com/documentation/articles/app-service-app-service-environment-control-inbound-traffic/
[NetworkSecurityGroups]: http://azure.microsoft.com/documentation/articles/virtual-networks-nsg/
[UDROverview]: http://azure.microsoft.com/documentation/articles/virtual-networks-udr-overview/
[UDRHowTo]: http://azure.microsoft.com/documentation/articles/virtual-networks-udr-how-to/
[HowToCreateAnAppServiceEnvironment]: http://azure.microsoft.com/documentation/articles/app-service-web-how-to-create-an-app-service-environment/
[AzureDownloads]: http://azure.microsoft.com/en-us/downloads/ 
[DownloadCenterAddressRanges]: http://www.microsoft.com/download/details.aspx?id=41653  
[NetworkSecurityGroups]: https://azure.microsoft.com/documentation/articles/virtual-networks-nsg/
[AzureAppService]: http://azure.microsoft.com/documentation/articles/app-service-value-prop-what-is/
[IntroToAppServiceEnvironment]:  http://azure.microsoft.com/documentation/articles/app-service-app-service-environment-intro/
[NewPortal]:  https://portal.azure.com


<!-- IMAGES -->
