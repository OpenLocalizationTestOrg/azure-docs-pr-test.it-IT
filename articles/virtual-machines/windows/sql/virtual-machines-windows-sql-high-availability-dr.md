---
title: "aaaHigh disponibilità e ripristino di emergenza per SQL Server | Documenti Microsoft"
description: Una discussione su hello vari tipi di strategie HADR per SQL Server in esecuzione in macchine virtuali di Azure.
services: virtual-machines-windows
documentationcenter: na
author: MikeRayMSFT
manager: jhubbard
editor: 
tags: azure-service-management
ms.assetid: 53981f7e-8370-4979-b26a-93a5988d905f
ms.service: virtual-machines-sql
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: vm-windows-sql-server
ms.workload: iaas-sql-server
ms.date: 06/27/2017
ms.author: mikeray
ms.openlocfilehash: 2b62d8b30520952ba6b7da7177a2c2de95bea8ce
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/06/2017
---
# <a name="high-availability-and-disaster-recovery-for-sql-server-in-azure-virtual-machines"></a><span data-ttu-id="ebb67-103">Disponibilità elevata e ripristino di emergenza per SQL Server nelle macchine virtuali di Azure</span><span class="sxs-lookup"><span data-stu-id="ebb67-103">High availability and disaster recovery for SQL Server in Azure Virtual Machines</span></span>

<span data-ttu-id="ebb67-104">Macchine virtuali di Microsoft Azure (VM) con SQL Server consente di ridurre il costo hello di soluzione a elevata disponibilità e ripristino (HADR) del database.</span><span class="sxs-lookup"><span data-stu-id="ebb67-104">Microsoft Azure virtual machines (VMs) with SQL Server can help lower hello cost of a high availability and disaster recovery (HADR) database solution.</span></span> <span data-ttu-id="ebb67-105">Molte soluzioni HADR di SQL Server sono supportate nelle macchine virtuali di Azure, sia come soluzioni solo Azure sia come soluzioni ibride.</span><span class="sxs-lookup"><span data-stu-id="ebb67-105">Most SQL Server HADR solutions are supported in Azure virtual machines, both as Azure-only and as hybrid solutions.</span></span> <span data-ttu-id="ebb67-106">In una soluzione solo Azure, l'intero sistema HADR di hello viene eseguito in Azure.</span><span class="sxs-lookup"><span data-stu-id="ebb67-106">In an Azure-only solution, hello entire HADR system runs in Azure.</span></span> <span data-ttu-id="ebb67-107">In una configurazione ibrida, parte della soluzione hello in esecuzione in Azure e hello altra parte viene eseguito in locale nell'organizzazione.</span><span class="sxs-lookup"><span data-stu-id="ebb67-107">In a hybrid configuration, part of hello solution runs in Azure and hello other part runs on-premises in your organization.</span></span> <span data-ttu-id="ebb67-108">Hello flessibilità di hello ambiente Azure consente toomove completamente o parzialmente budget di hello toosatisfy tooAzure requisiti HADR e di SQL Server sistemi di database.</span><span class="sxs-lookup"><span data-stu-id="ebb67-108">hello flexibility of hello Azure environment enables you toomove partially or completely tooAzure toosatisfy hello budget and HADR requirements of your SQL Server database systems.</span></span>

[!INCLUDE [learn-about-deployment-models](../../../../includes/learn-about-deployment-models-both-include.md)]

## <a name="understanding-hello-need-for-an-hadr-solution"></a><span data-ttu-id="ebb67-109">Informazioni sulla necessità di hello per una soluzione HADR</span><span class="sxs-lookup"><span data-stu-id="ebb67-109">Understanding hello need for an HADR solution</span></span>
<span data-ttu-id="ebb67-110">È attivo tooyou tooensure dispone di funzionalità HADR hello hello contratto di servizio (SLA) richiede che il sistema di database.</span><span class="sxs-lookup"><span data-stu-id="ebb67-110">It is up tooyou tooensure that your database system possesses hello HADR capabilities that hello service-level agreement (SLA) requires.</span></span> <span data-ttu-id="ebb67-111">tabelle dei fatti Hello che Azure fornisce meccanismi di disponibilità elevata, ad esempio di correzione del servizio per servizi cloud e rilevamento del ripristino da errore per le macchine virtuali, non garantiscono di per sé che è possibile soddisfare SLA hello desiderato.</span><span class="sxs-lookup"><span data-stu-id="ebb67-111">hello fact that Azure provides high availability mechanisms, such as service healing for cloud services and failure recovery detection for Virtual Machines, does not itself guarantee you can meet hello desired SLA.</span></span> <span data-ttu-id="ebb67-112">Questi meccanismi proteggono la disponibilità elevata hello di hello macchine virtuali ma non hello la disponibilità elevata di SQL Server in esecuzione all'interno di hello macchine virtuali.</span><span class="sxs-lookup"><span data-stu-id="ebb67-112">These mechanisms protect hello high availability of hello VMs but not hello high availability of SQL Server running inside hello VMs.</span></span> <span data-ttu-id="ebb67-113">È possibile che toofail istanza di SQL Server hello mentre hello VM è online e integra.</span><span class="sxs-lookup"><span data-stu-id="ebb67-113">It is possible for hello SQL Server instance toofail while hello VM is online and healthy.</span></span> <span data-ttu-id="ebb67-114">Inoltre, i meccanismi di disponibilità elevata hello anche forniti da Azure consentono tempi di inattività delle macchine virtuali hello scadenza tooevents come il recupero da errori hardware o software e aggiornamenti del sistema operativo.</span><span class="sxs-lookup"><span data-stu-id="ebb67-114">Moreover, even hello high availability mechanisms provided by Azure allow for downtime of hello VMs due tooevents such as recovery from software or hardware failures and operating system upgrades.</span></span>

<span data-ttu-id="ebb67-115">Neppure l'archiviazione con ridondanza geografica di Azure, implementata con una funzionalità denominata replica geografica, costituisce un'adeguata soluzione di ripristino di emergenza per i database.</span><span class="sxs-lookup"><span data-stu-id="ebb67-115">In addition, Geo Redundant Storage (GRS) in Azure, which is implemented with a feature called geo-replication, may not be an adequate disaster recovery solution for your databases.</span></span> <span data-ttu-id="ebb67-116">Poiché la replica geografica invia dati in modo asincrono, gli aggiornamenti recenti possono perdersi nell'evento hello di emergenza.</span><span class="sxs-lookup"><span data-stu-id="ebb67-116">Because geo-replication sends data asynchronously, recent updates can be lost in hello event of disaster.</span></span> <span data-ttu-id="ebb67-117">Ulteriori informazioni sulla replica geografica limitazioni vengono trattati nelle hello [replica geografica non è supportata per i file di dati e di log in dischi separati](#geo-replication-support) sezione.</span><span class="sxs-lookup"><span data-stu-id="ebb67-117">More information regarding geo-replication limitations are covered in hello [Geo-replication not supported for data and log files on separate disks](#geo-replication-support) section.</span></span>

## <a name="hadr-deployment-architectures"></a><span data-ttu-id="ebb67-118">Architetture di distribuzione HADR</span><span class="sxs-lookup"><span data-stu-id="ebb67-118">HADR deployment architectures</span></span>
<span data-ttu-id="ebb67-119">Le tecnologie HADR di SQL Server supportate in Azure includono:</span><span class="sxs-lookup"><span data-stu-id="ebb67-119">SQL Server HADR technologies that are supported in Azure include:</span></span>

* [<span data-ttu-id="ebb67-120">Gruppi di disponibilità AlwaysOn</span><span class="sxs-lookup"><span data-stu-id="ebb67-120">Always On Availability Groups</span></span>](https://technet.microsoft.com/library/hh510230.aspx)
* [<span data-ttu-id="ebb67-121">Istanze del cluster di failover AlwaysOn</span><span class="sxs-lookup"><span data-stu-id="ebb67-121">Always On Failover Cluster Instances</span></span>](https://technet.microsoft.com/library/ms189134.aspx)
* [<span data-ttu-id="ebb67-122">Log shipping</span><span class="sxs-lookup"><span data-stu-id="ebb67-122">Log Shipping</span></span>](https://technet.microsoft.com/library/ms187103.aspx)
* [<span data-ttu-id="ebb67-123">Backup e ripristino di SQL Server con il servizio di archiviazione BLOB di Azure</span><span class="sxs-lookup"><span data-stu-id="ebb67-123">SQL Server Backup and Restore with Azure Blob Storage Service</span></span>](https://msdn.microsoft.com/library/jj919148.aspx)
* <span data-ttu-id="ebb67-124">[Mirroring del database](https://technet.microsoft.com/library/ms189852.aspx) - Deprecato in SQL Server 2016</span><span class="sxs-lookup"><span data-stu-id="ebb67-124">[Database Mirroring](https://technet.microsoft.com/library/ms189852.aspx) - Deprecated in SQL Server 2016</span></span>

<span data-ttu-id="ebb67-125">È possibile toocombine hello tecnologie insieme tooimplement una soluzione di SQL Server che include la disponibilità elevata e ripristino di emergenza.</span><span class="sxs-lookup"><span data-stu-id="ebb67-125">It is possible toocombine hello technologies together tooimplement a SQL Server solution that has both high availability and disaster recovery capabilities.</span></span> <span data-ttu-id="ebb67-126">A seconda di tecnologia hello da utilizzare, una distribuzione ibrida può richiedere un tunnel VPN con hello rete virtuale di Azure.</span><span class="sxs-lookup"><span data-stu-id="ebb67-126">Depending on hello technology you use, a hybrid deployment may require a VPN tunnel with hello Azure virtual network.</span></span> <span data-ttu-id="ebb67-127">Hello nelle sezioni seguenti vengono illustrano alcune delle architetture di distribuzione di esempio hello.</span><span class="sxs-lookup"><span data-stu-id="ebb67-127">hello sections below show you some of hello example deployment architectures.</span></span>

## <a name="azure-only-high-availability-solutions"></a><span data-ttu-id="ebb67-128">Solo Azure: soluzioni di disponibilità elevata</span><span class="sxs-lookup"><span data-stu-id="ebb67-128">Azure-only: High availability solutions</span></span>

<span data-ttu-id="ebb67-129">È possibile avere una soluzione a disponibilità elevata per SQL Server a livello di database con Gruppi di disponibilità Always On, denominati gruppi di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="ebb67-129">You can have a high availability solution for SQL Server at a database level with Always On Availability Groups - called availability groups.</span></span> <span data-ttu-id="ebb67-130">È anche possibile creare una soluzione a disponibilità elevata a livello di istanza con istanze del cluster di failover Always On, denominate istanze del cluster di failover.</span><span class="sxs-lookup"><span data-stu-id="ebb67-130">You can also create a high availability solution at an instance level with Always On Failover Cluster Instances - failover cluster instances.</span></span> <span data-ttu-id="ebb67-131">Per maggiore ridondanza, è anche possibile creare ridondanza per entrambi i livelli tramite la creazione di gruppi di disponibilità nelle istanze del cluster di failover.</span><span class="sxs-lookup"><span data-stu-id="ebb67-131">For additional redundancy, you can create redundancy at both levels by creating availability groups on failover cluster instances.</span></span> 

| <span data-ttu-id="ebb67-132">Tecnologia</span><span class="sxs-lookup"><span data-stu-id="ebb67-132">Technology</span></span> | <span data-ttu-id="ebb67-133">Architetture di esempio</span><span class="sxs-lookup"><span data-stu-id="ebb67-133">Example Architectures</span></span> |
| --- | --- |
| <span data-ttu-id="ebb67-134">**Gruppi di disponibilità**</span><span class="sxs-lookup"><span data-stu-id="ebb67-134">**Availability groups**</span></span> |<span data-ttu-id="ebb67-135">Hello di repliche di disponibilità in esecuzione in macchine virtuali di Azure nella stessa area garantire un'elevata disponibilità.</span><span class="sxs-lookup"><span data-stu-id="ebb67-135">Availability replicas running in Azure VMs in hello same region provide high availability.</span></span> <span data-ttu-id="ebb67-136">È necessario tooconfigure un controller di dominio macchina virtuale, in quanto il clustering di failover di Windows richiede un dominio di Active Directory.</span><span class="sxs-lookup"><span data-stu-id="ebb67-136">You need tooconfigure a domain controller VM, because Windows failover clustering requires an Active Directory domain.</span></span><br/> <span data-ttu-id="ebb67-137">![Gruppi di disponibilità](./media/virtual-machines-windows-sql-high-availability-dr/azure_only_ha_always_on.gif)</span><span class="sxs-lookup"><span data-stu-id="ebb67-137">![Availability Groups](./media/virtual-machines-windows-sql-high-availability-dr/azure_only_ha_always_on.gif)</span></span><br/><span data-ttu-id="ebb67-138">Per altre informazioni, vedere [Configurare manualmente un gruppo di disponibilità Always On nelle macchine virtuali di Azure tramite Resource Manager](virtual-machines-windows-portal-sql-alwayson-availability-groups.md).</span><span class="sxs-lookup"><span data-stu-id="ebb67-138">For more information, see [Configure Availability Groups in Azure (GUI)](virtual-machines-windows-portal-sql-alwayson-availability-groups.md).</span></span> |
| <span data-ttu-id="ebb67-139">**Istanze del cluster di failover**</span><span class="sxs-lookup"><span data-stu-id="ebb67-139">**Failover cluster instances**</span></span> |<span data-ttu-id="ebb67-140">Le istanze del cluster di failover, che richiedono l'archiviazione condivisa, possono essere create in 3 modi diversi.</span><span class="sxs-lookup"><span data-stu-id="ebb67-140">Failover Cluster Instances (FCI), which require shared storage, can be created in 3 different ways.</span></span><br/><br/><span data-ttu-id="ebb67-141">1. Un cluster di failover a due nodi in esecuzione in macchine virtuali di Azure con l'archiviazione associata [Windows Server 2016 spazi di archiviazione diretta \(S2D\) ](virtual-machines-windows-portal-sql-create-failover-cluster.md) tooprovide una SAN virtuale basata su software.</span><span class="sxs-lookup"><span data-stu-id="ebb67-141">1. A two-node failover cluster running in Azure VMs with attached storage using [Windows Server 2016 Storage Spaces Direct \(S2D\)](virtual-machines-windows-portal-sql-create-failover-cluster.md) tooprovide a software-based virtual SAN.</span></span><br/><br/><span data-ttu-id="ebb67-142">2. Un cluster di failover a due nodi in esecuzione su macchine virtuali di Azure con archiviazione supportata da una soluzione di clustering di terze parti.</span><span class="sxs-lookup"><span data-stu-id="ebb67-142">2. A two-node failover cluster running in Azure VMs with storage supported by a third-party clustering solution.</span></span> <span data-ttu-id="ebb67-143">Per un esempio specifico che usa SIOS DataKeeper, vedere [High availability for a file share using failover clustering and 3rd party software SIOS DataKeeper](https://azure.microsoft.com/blog/high-availability-for-a-file-share-using-wsfc-ilb-and-3rd-party-software-sios-datakeeper/) (Disponibilità elevata per una condivisione file basata su clustering di failover e sul software di terze parti SIOS DataKeeper).</span><span class="sxs-lookup"><span data-stu-id="ebb67-143">For a specific example that uses SIOS DataKeeper, see [High availability for a file share using failover clustering and 3rd party software SIOS DataKeeper](https://azure.microsoft.com/blog/high-availability-for-a-file-share-using-wsfc-ilb-and-3rd-party-software-sios-datakeeper/).</span></span><br/><br/><span data-ttu-id="ebb67-144">3. Un cluster di failover a due nodi in esecuzione su macchine virtuali di Azure con archiviazione a blocchi condivisa su una destinazione iSCSI remota tramite ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="ebb67-144">3. A two-node failover cluster running in Azure VMs with remote iSCSI Target shared block storage via ExpressRoute.</span></span> <span data-ttu-id="ebb67-145">Ad esempio, archiviazione privata NetApp (NPS) espone una destinazione iSCSI tramite ExpressRoute con Equinix tooAzure macchine virtuali.</span><span class="sxs-lookup"><span data-stu-id="ebb67-145">For example, NetApp Private Storage (NPS) exposes an iSCSI target via ExpressRoute with Equinix tooAzure VMs.</span></span><br/><br/><span data-ttu-id="ebb67-146">Per l'archiviazione condivisa di terze parti e soluzioni di replica di dati, contattare il fornitore hello per tutti i dati correlati tooaccessing problemi in caso di failover.</span><span class="sxs-lookup"><span data-stu-id="ebb67-146">For third-party shared storage and data replication solutions, you should contact hello vendor for any issues related tooaccessing data on failover.</span></span><br/><br/><span data-ttu-id="ebb67-147">Si noti che non è ancora supportato l'uso di istanze del cluster di failover nell' [archivio file di Azure](https://azure.microsoft.com/services/storage/files/) , perché questa soluzione non usa l'archiviazione Premium.</span><span class="sxs-lookup"><span data-stu-id="ebb67-147">Note that using FCI on top of [Azure File storage](https://azure.microsoft.com/services/storage/files/) is not supported yet, because this solution does not utilize Premium Storage.</span></span> <span data-ttu-id="ebb67-148">Stiamo lavorando toosupport questo breve.</span><span class="sxs-lookup"><span data-stu-id="ebb67-148">We are working toosupport this soon.</span></span> |

## <a name="azure-only-disaster-recovery-solutions"></a><span data-ttu-id="ebb67-149">Solo Azure: soluzioni di ripristino di emergenza</span><span class="sxs-lookup"><span data-stu-id="ebb67-149">Azure-only: Disaster recovery solutions</span></span>
<span data-ttu-id="ebb67-150">È possibile disporre di una soluzione di ripristino di emergenza per i database di SQL Server in Azure tramite i gruppi di disponibilità, il mirroring del database o funzionalità di backup e ripristino con i BLOB di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="ebb67-150">You can have a disaster recovery solution for your SQL Server databases in Azure using availability groups, database mirroring, or backup and restore with storage blobs.</span></span>

| <span data-ttu-id="ebb67-151">Tecnologia</span><span class="sxs-lookup"><span data-stu-id="ebb67-151">Technology</span></span> | <span data-ttu-id="ebb67-152">Architetture di esempio</span><span class="sxs-lookup"><span data-stu-id="ebb67-152">Example Architectures</span></span> |
| --- | --- |
| <span data-ttu-id="ebb67-153">**Gruppi di disponibilità**</span><span class="sxs-lookup"><span data-stu-id="ebb67-153">**Availability Groups**</span></span> |<span data-ttu-id="ebb67-154">Repliche di disponibilità in esecuzione tra più data center nelle macchine virtuali di Azure per il ripristino di emergenza.</span><span class="sxs-lookup"><span data-stu-id="ebb67-154">Availability replicas running across multiple datacenters in Azure VMs for disaster recovery.</span></span> <span data-ttu-id="ebb67-155">Questa soluzione per più aree protegge dalla completa interruzione dell'alimentazione del sito.</span><span class="sxs-lookup"><span data-stu-id="ebb67-155">This cross-region solution protects against complete site outage.</span></span> <br/> <span data-ttu-id="ebb67-156">![Gruppi di disponibilità](./media/virtual-machines-windows-sql-high-availability-dr/azure_only_dr_alwayson.png)</span><span class="sxs-lookup"><span data-stu-id="ebb67-156">![Availability Groups](./media/virtual-machines-windows-sql-high-availability-dr/azure_only_dr_alwayson.png)</span></span><br/><span data-ttu-id="ebb67-157">All'interno di un'area, tutte le repliche devono essere all'interno di hello stesso servizio cloud e hello stessa rete virtuale.</span><span class="sxs-lookup"><span data-stu-id="ebb67-157">Within a region, all replicas should be within hello same cloud service and hello same VNet.</span></span> <span data-ttu-id="ebb67-158">Poiché ogni area sarà caratterizzata da una VNet separata, queste soluzioni richiedono la connettività di rete virtuale tooVNet.</span><span class="sxs-lookup"><span data-stu-id="ebb67-158">Because each region will have a separate VNet, these solutions require VNet tooVNet connectivity.</span></span> <span data-ttu-id="ebb67-159">Per ulteriori informazioni, vedere [configura una rete virtuale multisito connessione usando il portale di Azure di hello](../../../vpn-gateway/vpn-gateway-howto-vnet-vnet-resource-manager-portal.md).</span><span class="sxs-lookup"><span data-stu-id="ebb67-159">For more information, see [Configure a VNet-to-VNet connection using hello Azure portal](../../../vpn-gateway/vpn-gateway-howto-vnet-vnet-resource-manager-portal.md).</span></span> <span data-ttu-id="ebb67-160">Per istruzioni dettagliate, vedere [Configurare un gruppo di disponibilità SQL Server in macchine virtuali di Azure in aree diverse](virtual-machines-windows-portal-sql-availability-group-dr.md).</span><span class="sxs-lookup"><span data-stu-id="ebb67-160">For detailed instructions, see [Configure a SQL Server Availability Group on Azure Virtual Machines in Different Regions](virtual-machines-windows-portal-sql-availability-group-dr.md).</span></span>|
| <span data-ttu-id="ebb67-161">**Mirroring del database**</span><span class="sxs-lookup"><span data-stu-id="ebb67-161">**Database Mirroring**</span></span> |<span data-ttu-id="ebb67-162">Tutti i server principali, mirror e di controllo in esecuzione in diversi data center per il ripristino di emergenza.</span><span class="sxs-lookup"><span data-stu-id="ebb67-162">Principal and mirror and servers running in different datacenters for disaster recovery.</span></span> <span data-ttu-id="ebb67-163">È necessario eseguire la distribuzione usando certificati del server perché un dominio di Active Directory non può essere esteso a più data center.</span><span class="sxs-lookup"><span data-stu-id="ebb67-163">You must deploy using server certificates because an active directory domain cannot span multiple datacenters.</span></span><br/>![Mirroring del database](./media/virtual-machines-windows-sql-high-availability-dr/azure_only_dr_dbmirroring.gif) |
| <span data-ttu-id="ebb67-165">**Backup e ripristino con il servizio di archiviazione BLOB di Azure**</span><span class="sxs-lookup"><span data-stu-id="ebb67-165">**Backup and Restore with Azure Blob Storage Service**</span></span> |<span data-ttu-id="ebb67-166">Archiviazione di tooblob direttamente in un Data Center diverso per il ripristino di emergenza backup dei database di produzione.</span><span class="sxs-lookup"><span data-stu-id="ebb67-166">Production databases backed up directly tooblob storage in a different datacenter for disaster recovery.</span></span><br/><span data-ttu-id="ebb67-167">![Backup e ripristino](./media/virtual-machines-windows-sql-high-availability-dr/azure_only_dr_backup_restore.gif)</span><span class="sxs-lookup"><span data-stu-id="ebb67-167">![Backup and Restore](./media/virtual-machines-windows-sql-high-availability-dr/azure_only_dr_backup_restore.gif)</span></span><br/><span data-ttu-id="ebb67-168">Per altre informazioni, vedere [Backup e ripristino per SQL Server in Macchine virtuali di Azure](virtual-machines-windows-sql-backup-recovery.md).</span><span class="sxs-lookup"><span data-stu-id="ebb67-168">For more information, see [Backup and Restore for SQL Server in Azure Virtual Machines](virtual-machines-windows-sql-backup-recovery.md).</span></span> |

## <a name="hybrid-it-disaster-recovery-solutions"></a><span data-ttu-id="ebb67-169">IT ibrido: soluzioni di ripristino di emergenza</span><span class="sxs-lookup"><span data-stu-id="ebb67-169">Hybrid IT: Disaster recovery solutions</span></span>
<span data-ttu-id="ebb67-170">È possibile disporre di una soluzione di ripristino di emergenza per i database di SQL Server in un ambiente IT ibrido tramite i gruppi di disponibilità, il mirroring del database, il log shipping e funzionalità di backup e ripristino con l'archiviazione BLOB di Azure.</span><span class="sxs-lookup"><span data-stu-id="ebb67-170">You can have a disaster recovery solution for your SQL Server databases in a hybrid-IT environment using availability groups, database mirroring, log shipping, and backup and restore with Azure blog storage.</span></span>

| <span data-ttu-id="ebb67-171">Tecnologia</span><span class="sxs-lookup"><span data-stu-id="ebb67-171">Technology</span></span> | <span data-ttu-id="ebb67-172">Architetture di esempio</span><span class="sxs-lookup"><span data-stu-id="ebb67-172">Example Architectures</span></span> |
| --- | --- |
| <span data-ttu-id="ebb67-173">**Gruppi di disponibilità**</span><span class="sxs-lookup"><span data-stu-id="ebb67-173">**Availability Groups**</span></span> |<span data-ttu-id="ebb67-174">Alcune repliche di disponibilità in esecuzione nelle macchine virtuali di Azure e altre in esecuzione in locale per il ripristino di emergenza tra siti.</span><span class="sxs-lookup"><span data-stu-id="ebb67-174">Some availability replicas running in Azure VMs and other replicas running on-premises for cross-site disaster recovery.</span></span> <span data-ttu-id="ebb67-175">Hello sito di produzione può essere in locale o in un Data Center Azure.</span><span class="sxs-lookup"><span data-stu-id="ebb67-175">hello production site can be either on-premises or in an Azure datacenter.</span></span><br/>![Gruppi di disponibilità](./media/virtual-machines-windows-sql-high-availability-dr/hybrid_dr_alwayson.gif)<br/><span data-ttu-id="ebb67-177">Poiché tutte le repliche di disponibilità devono essere hello stesso cluster di failover, hello cluster deve essere esteso a entrambe le reti (un cluster di failover su più subnet).</span><span class="sxs-lookup"><span data-stu-id="ebb67-177">Because all availability replicas must be in hello same failover cluster, hello cluster must span both networks (a multi-subnet failover cluster).</span></span> <span data-ttu-id="ebb67-178">Questa configurazione richiede una connessione VPN tra Azure e hello rete locale.</span><span class="sxs-lookup"><span data-stu-id="ebb67-178">This configuration requires a VPN connection between Azure and hello on-premises network.</span></span><br/><br/><span data-ttu-id="ebb67-179">Per corretto ripristino di emergenza dei database, è inoltre necessario installare un controller di dominio di replica nel sito di ripristino di emergenza hello.</span><span class="sxs-lookup"><span data-stu-id="ebb67-179">For successful disaster recovery of your databases, you should also install a replica domain controller at hello disaster recovery site.</span></span><br/><br/><span data-ttu-id="ebb67-180">È possibile toouse hello Aggiunta guidata di Replica in SQL Server Management Studio tooadd tooan una replica di Azure esistente gruppo di disponibilità AlwaysOn.</span><span class="sxs-lookup"><span data-stu-id="ebb67-180">It is possible toouse hello Add Replica Wizard in SSMS tooadd an Azure replica tooan existing Always On Availability Group.</span></span> <span data-ttu-id="ebb67-181">Per ulteriori informazioni, vedere l'esercitazione: estendere tooAzure il gruppo di disponibilità AlwaysOn.</span><span class="sxs-lookup"><span data-stu-id="ebb67-181">For more information, see Tutorial: Extend your Always On Availability Group tooAzure.</span></span> |
| <span data-ttu-id="ebb67-182">**Mirroring del database**</span><span class="sxs-lookup"><span data-stu-id="ebb67-182">**Database Mirroring**</span></span> |<span data-ttu-id="ebb67-183">Un partner è in esecuzione in una macchina virtuale di Azure e altri hello in esecuzione in locale per il ripristino di emergenza tra siti utilizzando certificati del server.</span><span class="sxs-lookup"><span data-stu-id="ebb67-183">One partner running in an Azure VM and hello other running on-premises for cross-site disaster recovery using server certificates.</span></span> <span data-ttu-id="ebb67-184">I partner non è necessario toobe in hello nello stesso dominio di Active Directory ed non è necessaria alcuna connessione VPN.</span><span class="sxs-lookup"><span data-stu-id="ebb67-184">Partners do not need toobe in hello same Active Directory domain, and no VPN connection is required.</span></span><br/><span data-ttu-id="ebb67-185">![Mirroring del database](./media/virtual-machines-windows-sql-high-availability-dr/hybrid_dr_dbmirroring.gif)</span><span class="sxs-lookup"><span data-stu-id="ebb67-185">![Database Mirroring](./media/virtual-machines-windows-sql-high-availability-dr/hybrid_dr_dbmirroring.gif)</span></span><br/><span data-ttu-id="ebb67-186">Scenario di mirroring di un altro database implica un partner è in esecuzione in una macchina virtuale di Azure e hello altra in esecuzione in locale in hello stesso dominio di Active Directory per il ripristino di emergenza tra siti.</span><span class="sxs-lookup"><span data-stu-id="ebb67-186">Another database mirroring scenario involves one partner running in an Azure VM and hello other running on-premises in hello same Active Directory domain for cross-site disaster recovery.</span></span> <span data-ttu-id="ebb67-187">Oggetto [connessione VPN tra la rete hello Azure virtuale hello e rete locale](../../../vpn-gateway/vpn-gateway-site-to-site-create.md) è obbligatorio.</span><span class="sxs-lookup"><span data-stu-id="ebb67-187">A [VPN connection between hello Azure virtual network and hello on-premises network](../../../vpn-gateway/vpn-gateway-site-to-site-create.md) is required.</span></span><br/><br/><span data-ttu-id="ebb67-188">Per corretto ripristino di emergenza dei database, è inoltre necessario installare un controller di dominio di replica nel sito di ripristino di emergenza hello.</span><span class="sxs-lookup"><span data-stu-id="ebb67-188">For successful disaster recovery of your databases, you should also install a replica domain controller at hello disaster recovery site.</span></span> |
| <span data-ttu-id="ebb67-189">**Log shipping**</span><span class="sxs-lookup"><span data-stu-id="ebb67-189">**Log Shipping**</span></span> |<span data-ttu-id="ebb67-190">Un server in esecuzione in una macchina virtuale di Azure e altri hello in esecuzione in locale per il ripristino di emergenza tra siti.</span><span class="sxs-lookup"><span data-stu-id="ebb67-190">One server running in an Azure VM and hello other running on-premises for cross-site disaster recovery.</span></span> <span data-ttu-id="ebb67-191">Il log shipping dipende dalla condivisione file di Windows, pertanto una connessione VPN tra hello rete virtuale di Azure e hello locale rete non è obbligatoria.</span><span class="sxs-lookup"><span data-stu-id="ebb67-191">Log shipping depends on Windows file sharing, so a VPN connection between hello Azure virtual network and hello on-premises network is required.</span></span><br/>![Log shipping](./media/virtual-machines-windows-sql-high-availability-dr/hybrid_dr_log_shipping.gif)<br/><span data-ttu-id="ebb67-193">Per corretto ripristino di emergenza dei database, è inoltre necessario installare un controller di dominio di replica nel sito di ripristino di emergenza hello.</span><span class="sxs-lookup"><span data-stu-id="ebb67-193">For successful disaster recovery of your databases, you should also install a replica domain controller at hello disaster recovery site.</span></span> |
| <span data-ttu-id="ebb67-194">**Backup e ripristino con il servizio di archiviazione BLOB di Azure**</span><span class="sxs-lookup"><span data-stu-id="ebb67-194">**Backup and Restore with Azure Blob Storage Service**</span></span> |<span data-ttu-id="ebb67-195">Database di produzione, eseguire il backup direttamente nell'archiviazione blob tooAzure per il ripristino di emergenza in locale.</span><span class="sxs-lookup"><span data-stu-id="ebb67-195">On-premises production databases backed up directly tooAzure blob storage for disaster recovery.</span></span><br/><span data-ttu-id="ebb67-196">![Backup e ripristino](./media/virtual-machines-windows-sql-high-availability-dr/hybrid_dr_backup_restore.gif)</span><span class="sxs-lookup"><span data-stu-id="ebb67-196">![Backup and Restore](./media/virtual-machines-windows-sql-high-availability-dr/hybrid_dr_backup_restore.gif)</span></span><br/><span data-ttu-id="ebb67-197">Per altre informazioni, vedere [Backup e ripristino per SQL Server in Macchine virtuali di Azure](virtual-machines-windows-sql-backup-recovery.md).</span><span class="sxs-lookup"><span data-stu-id="ebb67-197">For more information, see [Backup and Restore for SQL Server in Azure Virtual Machines](virtual-machines-windows-sql-backup-recovery.md).</span></span> |

## <a name="important-considerations-for-sql-server-hadr-in-azure"></a><span data-ttu-id="ebb67-198">Considerazioni importanti per HADR di SQL Server in Azure</span><span class="sxs-lookup"><span data-stu-id="ebb67-198">Important considerations for SQL Server HADR in Azure</span></span>
<span data-ttu-id="ebb67-199">La macchina virtuale, l'archiviazione e la rete di Azure hanno caratteristiche operative diverse rispetto a un'infrastruttura IT locale non virtualizzata.</span><span class="sxs-lookup"><span data-stu-id="ebb67-199">Azure VMs, storage, and networking have different operational characteristics than an on-premises, non-virtualized IT infrastructure.</span></span> <span data-ttu-id="ebb67-200">Una corretta implementazione di una soluzione HADR SQL Server in Azure, è necessario capire queste differenze e progettare la soluzione tooaccommodate li.</span><span class="sxs-lookup"><span data-stu-id="ebb67-200">A successful implementation of a HADR SQL Server solution in Azure requires that you understand these differences and design your solution tooaccommodate them.</span></span>

### <a name="high-availability-nodes-in-an-availability-set"></a><span data-ttu-id="ebb67-201">Nodi a disponibilità elevata in un set di disponibilità</span><span class="sxs-lookup"><span data-stu-id="ebb67-201">High availability nodes in an availability set</span></span>
<span data-ttu-id="ebb67-202">Set di disponibilità in Azure consentono di nodi a disponibilità elevata tooplace hello in domini di errore (Fd) e in domini di aggiornamento (UD) separato.</span><span class="sxs-lookup"><span data-stu-id="ebb67-202">Availability sets in Azure enable you tooplace hello high availability nodes into separate Fault Domains (FDs) and Update Domains (UDs).</span></span> <span data-ttu-id="ebb67-203">Per le macchine virtuali di Azure toobe inserito in hello stesso set di disponibilità, è necessario distribuirle in hello stesso servizio cloud.</span><span class="sxs-lookup"><span data-stu-id="ebb67-203">For Azure VMs toobe placed in hello same availability set, you must deploy them in hello same cloud service.</span></span> <span data-ttu-id="ebb67-204">Solo i nodi di hello nello stesso servizio cloud può partecipare hello stesso set di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="ebb67-204">Only nodes in hello same cloud service can participate in hello same availability set.</span></span> <span data-ttu-id="ebb67-205">Per ulteriori informazioni, vedere [Gestisci hello disponibilità delle macchine virtuali](../manage-availability.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).</span><span class="sxs-lookup"><span data-stu-id="ebb67-205">For more information, see [Manage hello Availability of Virtual Machines](../manage-availability.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json).</span></span>

### <a name="failover-cluster-behavior-in-azure-networking"></a><span data-ttu-id="ebb67-206">Comportamento del cluster di failover nella rete di Azure</span><span class="sxs-lookup"><span data-stu-id="ebb67-206">Failover cluster behavior in Azure networking</span></span>
<span data-ttu-id="ebb67-207">servizio DHCP non conforme a RFC di Hello in Azure può provocare la creazione di hello di determinati toofail le configurazioni di cluster di failover, a causa di nome di rete cluster toohello viene assegnato un indirizzo IP duplicato, ad esempio hello stesso IP address come uno dei nodi del cluster hello.</span><span class="sxs-lookup"><span data-stu-id="ebb67-207">hello non-RFC-compliant DHCP service in Azure can cause hello creation of certain failover cluster configurations toofail, due toohello cluster network name being assigned a duplicate IP address, such as hello same IP address as one of hello cluster nodes.</span></span> <span data-ttu-id="ebb67-208">Si tratta di un problema durante l'implementazione di gruppi di disponibilità, che dipende da funzionalità cluster di failover di Windows hello.</span><span class="sxs-lookup"><span data-stu-id="ebb67-208">This is an issue when you implement Availability Groups, which depends on hello Windows failover cluster feature.</span></span>

<span data-ttu-id="ebb67-209">Si consideri uno scenario di hello quando un cluster a due nodi viene creato e portato in linea:</span><span class="sxs-lookup"><span data-stu-id="ebb67-209">Consider hello scenario when a two-node cluster is created and brought online:</span></span>

1. <span data-ttu-id="ebb67-210">Hello cluster torna online e NODE1 richiede un indirizzo IP assegnato dinamicamente per nome di rete cluster hello.</span><span class="sxs-lookup"><span data-stu-id="ebb67-210">hello cluster comes online, then NODE1 requests a dynamically assigned IP address for hello cluster network name.</span></span>
2. <span data-ttu-id="ebb67-211">Nessun indirizzo IP diverso da indirizzo IP di NODE1 viene fornito dalla hello servizio DHCP, poiché hello servizio DHCP riconosce che la richiesta hello proviene da NODE1 stesso.</span><span class="sxs-lookup"><span data-stu-id="ebb67-211">No IP address other than NODE1’s own IP address is given by hello DHCP service, since hello DHCP service recognizes that hello request comes from NODE1 itself.</span></span>
3. <span data-ttu-id="ebb67-212">Windows rileva che un indirizzo duplicato viene assegnato tooNODE1 sia toohello nome di rete di cluster di failover e gruppo di cluster di hello predefinito non toocome online.</span><span class="sxs-lookup"><span data-stu-id="ebb67-212">Windows detects that a duplicate address is assigned both tooNODE1 and toohello failover cluster network name, and hello default cluster group fails toocome online.</span></span>
4. <span data-ttu-id="ebb67-213">gruppo cluster predefinito di Hello Sposta tooNODE2, che tratta l'indirizzo IP di NODE1 come indirizzo IP del cluster hello e porta gruppo cluster predefinito di hello online.</span><span class="sxs-lookup"><span data-stu-id="ebb67-213">hello default cluster group moves tooNODE2, which treats NODE1’s IP address as hello cluster IP address and brings hello default cluster group online.</span></span>
5. <span data-ttu-id="ebb67-214">Quando NODE2 tenta tooestablish connessione con NODE1, pacchetti indirizzati a NODE1 non lasciano mai NODE2 perché viene risolto tooitself di indirizzo IP di NODE1.</span><span class="sxs-lookup"><span data-stu-id="ebb67-214">When NODE2 attempts tooestablish connectivity with NODE1, packets directed at NODE1 never leave NODE2 because it resolves NODE1’s IP address tooitself.</span></span> <span data-ttu-id="ebb67-215">NODE2 non è possibile stabilire una connessione con NODE1, quindi perde il quorum e arresta hello cluster.</span><span class="sxs-lookup"><span data-stu-id="ebb67-215">NODE2 cannot establish connectivity with NODE1, then loses quorum and shuts down hello cluster.</span></span>
6. <span data-ttu-id="ebb67-216">Nel frattempo hello, NODE1 può inviare i pacchetti tooNODE2, ma NODE2 non può rispondere.</span><span class="sxs-lookup"><span data-stu-id="ebb67-216">In hello meantime, NODE1 can send packets tooNODE2, but NODE2 cannot reply.</span></span> <span data-ttu-id="ebb67-217">NODE1 perde il quorum e arresta hello cluster.</span><span class="sxs-lookup"><span data-stu-id="ebb67-217">NODE1 loses quorum and shuts down hello cluster.</span></span>

<span data-ttu-id="ebb67-218">È possibile evitare questo scenario assegnando un indirizzo IP statico inutilizzato, ad esempio un indirizzo IP locale al collegamento come 169.254.1.1, il nome di rete cluster toohello in ordine toobring hello nome di rete cluster online.</span><span class="sxs-lookup"><span data-stu-id="ebb67-218">This scenario can be avoided by assigning an unused static IP address, such as a link-local IP address like 169.254.1.1, toohello cluster network name in order toobring hello cluster network name online.</span></span> <span data-ttu-id="ebb67-219">toosimplify questo processo, vedere [cluster di failover la configurazione di Windows in Azure per i gruppi di disponibilità](http://social.technet.microsoft.com/wiki/contents/articles/14776.configuring-windows-failover-cluster-in-windows-azure-for-alwayson-availability-groups.aspx).</span><span class="sxs-lookup"><span data-stu-id="ebb67-219">toosimplify this process, see [Configuring Windows failover cluster in Azure for availability groups](http://social.technet.microsoft.com/wiki/contents/articles/14776.configuring-windows-failover-cluster-in-windows-azure-for-alwayson-availability-groups.aspx).</span></span>

<span data-ttu-id="ebb67-220">Per altre informazioni, vedere [Configurare manualmente un gruppo di disponibilità Always On nelle macchine virtuali di Azure tramite Resource Manager](virtual-machines-windows-portal-sql-alwayson-availability-groups.md).</span><span class="sxs-lookup"><span data-stu-id="ebb67-220">For more information, see [Configure availability groups in Azure (GUI)](virtual-machines-windows-portal-sql-alwayson-availability-groups.md).</span></span>

### <a name="availability-group-listener-support"></a><span data-ttu-id="ebb67-221">Supporto del listener del gruppo di disponibilità</span><span class="sxs-lookup"><span data-stu-id="ebb67-221">Availability group listener support</span></span>
<span data-ttu-id="ebb67-222">I listener del gruppo di disponibilità sono supportati nelle VM di Azure che eseguono Windows Server 2008 R2, Windows Server 2012, Windows Server 2012 R2 e Windows Server 2016.</span><span class="sxs-lookup"><span data-stu-id="ebb67-222">Availability group listeners are supported on Azure VMs running Windows Server 2008 R2, Windows Server 2012, Windows Server 2012 R2, and Windows Server 2016.</span></span> <span data-ttu-id="ebb67-223">Questo supporto viene realizzato mediante l'utilizzo di hello di endpoint con bilanciamento del carico abilitato nelle macchine virtuali di Azure hello che costituiscono nodi di gruppo di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="ebb67-223">This support is made possible by hello use of load-balanced endpoints enabled on hello Azure VMs that are availability group nodes.</span></span> <span data-ttu-id="ebb67-224">È necessario seguire i passaggi di configurazione speciale per toowork listener hello per le applicazioni client che sono in esecuzione in Azure, nonché quelli eseguiti in locale.</span><span class="sxs-lookup"><span data-stu-id="ebb67-224">You must follow special configuration steps for hello listeners toowork for both client applications that are running in Azure as well as those running on-premises.</span></span>

<span data-ttu-id="ebb67-225">Sono disponibili due opzioni principali per la configurazione del listener: esterno (pubblico) o interno.</span><span class="sxs-lookup"><span data-stu-id="ebb67-225">There are two main options for setting up your listener: external (public) or internal.</span></span> <span data-ttu-id="ebb67-226">Hello listener (pubblici) esterno Usa una connessione internet bilanciamento del carico è associato con un IP virtuale (VIP pubblico) che è accessibile tramite hello internet.</span><span class="sxs-lookup"><span data-stu-id="ebb67-226">hello external (public) listener uses an internet facing load balancer and is associated with a public Virtual IP (VIP) that is accessible over hello internet.</span></span> <span data-ttu-id="ebb67-227">Un listener interno utilizza un servizio di bilanciamento del carico interno e client supporta solo all'interno di hello stessa rete virtuale.</span><span class="sxs-lookup"><span data-stu-id="ebb67-227">An internal listener uses an internal load balancer and only supports clients within hello same Virtual Network.</span></span> <span data-ttu-id="ebb67-228">Per un tipo di bilanciamento del carico, è necessario abilitare Direct Server Return.</span><span class="sxs-lookup"><span data-stu-id="ebb67-228">For either load balancer type, you must enable Direct Server Return.</span></span> 

<span data-ttu-id="ebb67-229">Se hello gruppo di disponibilità si estende su più subnet di Azure (ad esempio una distribuzione che attraversa aree di Azure), stringa di connessione client hello deve includere "**MultisubnetFailover = True**".</span><span class="sxs-lookup"><span data-stu-id="ebb67-229">If hello Availability Group spans multiple Azure subnets (such as a deployment that crosses Azure regions), hello client connection string must include "**MultisubnetFailover=True**".</span></span> <span data-ttu-id="ebb67-230">In questo modo le repliche toohello tentativi di connessione parallela in subnet diverse hello.</span><span class="sxs-lookup"><span data-stu-id="ebb67-230">This results in parallel connection attempts toohello replicas in hello different subnets.</span></span> <span data-ttu-id="ebb67-231">Per istruzioni sull'impostazione di un listener, vedere</span><span class="sxs-lookup"><span data-stu-id="ebb67-231">For instructions on setting up a listener, see</span></span>

* <span data-ttu-id="ebb67-232">[Configurare un listener ILB per i gruppi di disponibilità in Azure](virtual-machines-windows-portal-sql-ps-alwayson-int-listener.md).</span><span class="sxs-lookup"><span data-stu-id="ebb67-232">[Configure an ILB listener for availability groups in Azure](virtual-machines-windows-portal-sql-ps-alwayson-int-listener.md).</span></span>
* <span data-ttu-id="ebb67-233">[Configurare un listener esterno per i gruppi di disponibilità in Azure](../classic/ps-sql-ext-listener.md).</span><span class="sxs-lookup"><span data-stu-id="ebb67-233">[Configure an external listener for availability groups in Azure](../classic/ps-sql-ext-listener.md).</span></span>

<span data-ttu-id="ebb67-234">È comunque possibile connettersi separatamente la replica di disponibilità tooeach connettendosi direttamente toohello istanza del servizio.</span><span class="sxs-lookup"><span data-stu-id="ebb67-234">You can still connect tooeach availability replica separately by connecting directly toohello service instance.</span></span> <span data-ttu-id="ebb67-235">Inoltre, poiché i gruppi di disponibilità sono compatibili con le versioni precedenti con i client di mirroring del database, è possibile connettersi toohello le repliche di disponibilità come partner di mirroring, purché le repliche hello configurate database mirroring toodatabase simile:</span><span class="sxs-lookup"><span data-stu-id="ebb67-235">Also, since availability groups are backward compatible with database mirroring clients, you can connect toohello availability replicas like database mirroring partners as long as hello replicas are configured similar toodatabase mirroring:</span></span>

* <span data-ttu-id="ebb67-236">Una replica primaria e una replica secondaria</span><span class="sxs-lookup"><span data-stu-id="ebb67-236">One primary replica and one secondary replica</span></span>
* <span data-ttu-id="ebb67-237">Hello replica secondaria è configurata come non leggibile (**secondario leggibile** opzione impostata troppo**n**)</span><span class="sxs-lookup"><span data-stu-id="ebb67-237">hello secondary replica is configured as non-readable (**Readable Secondary** option set too**No**)</span></span>

<span data-ttu-id="ebb67-238">Una stringa di connessione client di esempio corrispondente di configurazione di toothis simile al mirroring del database utilizzando ADO.NET o SQL Server Native Client è inferiore:</span><span class="sxs-lookup"><span data-stu-id="ebb67-238">An example client connection string that corresponds toothis database mirroring-like configuration using ADO.NET or SQL Server Native Client is below:</span></span>

    Data Source=ReplicaServer1;Failover Partner=ReplicaServer2;Initial Catalog=AvailabilityDatabase;

<span data-ttu-id="ebb67-239">Per altre informazioni sulla connettività client, vedere:</span><span class="sxs-lookup"><span data-stu-id="ebb67-239">For more information on client connectivity, see:</span></span>

* [<span data-ttu-id="ebb67-240">Utilizzo delle parole chiave delle stringhe di connessione con SQL Server Native Client</span><span class="sxs-lookup"><span data-stu-id="ebb67-240">Using Connection String Keywords with SQL Server Native Client</span></span>](https://msdn.microsoft.com/library/ms130822.aspx)
* [<span data-ttu-id="ebb67-241">Connettere i client tooa sessione di mirroring del Database (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="ebb67-241">Connect Clients tooa Database Mirroring Session (SQL Server)</span></span>](https://technet.microsoft.com/library/ms175484.aspx)
* [<span data-ttu-id="ebb67-242">Connessione tooAvailability listener del gruppo IT ibrido</span><span class="sxs-lookup"><span data-stu-id="ebb67-242">Connecting tooAvailability Group Listener in Hybrid IT</span></span>](http://blogs.msdn.com/b/sqlalwayson/archive/2013/02/14/connecting-to-availability-group-listener-in-hybrid-it.aspx)
* [<span data-ttu-id="ebb67-243">Listener del gruppo di disponibilità, connettività client e failover dell'applicazione (SQL Server)</span><span class="sxs-lookup"><span data-stu-id="ebb67-243">Availability Group Listeners, Client Connectivity, and Application Failover (SQL Server)</span></span>](https://technet.microsoft.com/library/hh213417.aspx)
* [<span data-ttu-id="ebb67-244">Utilizzo delle stringhe di connessione per il mirroring del database con Gruppi di disponibilità</span><span class="sxs-lookup"><span data-stu-id="ebb67-244">Using Database-Mirroring Connection Strings with Availability Groups</span></span>](https://technet.microsoft.com/library/hh213417.aspx)

### <a name="network-latency-in-hybrid-it"></a><span data-ttu-id="ebb67-245">Latenza di rete in ambiente IT ibrido</span><span class="sxs-lookup"><span data-stu-id="ebb67-245">Network latency in hybrid IT</span></span>
<span data-ttu-id="ebb67-246">È necessario distribuire la soluzione HADR con il presupposto hello che possono verificarsi periodi di tempo con latenza di rete elevata tra la rete locale e Azure.</span><span class="sxs-lookup"><span data-stu-id="ebb67-246">You should deploy your HADR solution with hello assumption that there may be periods of time with high network latency between your on-premises network and Azure.</span></span> <span data-ttu-id="ebb67-247">Quando si distribuisce tooAzure repliche, utilizzare commit asincrono anziché quello sincrono per la modalità di sincronizzazione hello.</span><span class="sxs-lookup"><span data-stu-id="ebb67-247">When deploying replicas tooAzure, you should use asynchronous commit instead of synchronous commit for hello synchronization mode.</span></span> <span data-ttu-id="ebb67-248">Quando la distribuzione di server di mirroring del database locale sia in Azure, utilizzare la modalità a prestazioni elevate hello anziché modalità a sicurezza elevata hello.</span><span class="sxs-lookup"><span data-stu-id="ebb67-248">When deploying database mirroring servers both on-premises and in Azure, use hello high-performance mode instead of hello high-safety mode.</span></span>

### <a name="geo-replication-support"></a><span data-ttu-id="ebb67-249">Supporto della replica geografica</span><span class="sxs-lookup"><span data-stu-id="ebb67-249">Geo-replication support</span></span>
<span data-ttu-id="ebb67-250">La replica geografica nei dischi di Azure non supporta i file di dati hello e file di log di hello stesso database toobe archiviati su dischi separati.</span><span class="sxs-lookup"><span data-stu-id="ebb67-250">Geo-replication in Azure disks does not support hello data file and log file of hello same database toobe stored on separate disks.</span></span> <span data-ttu-id="ebb67-251">L'archiviazione con ridondanza geografica replica le modifiche in ogni disco in modo indipendente e asincrono.</span><span class="sxs-lookup"><span data-stu-id="ebb67-251">GRS replicates changes on each disk independently and asynchronously.</span></span> <span data-ttu-id="ebb67-252">Questo meccanismo garantisce l'ordine di scrittura hello all'interno di un disco singolo nella copia replicata geograficamente hello, ma non per tutte le copie replicate geograficamente di più dischi.</span><span class="sxs-lookup"><span data-stu-id="ebb67-252">This mechanism guarantees hello write order within a single disk on hello geo-replicated copy, but not across geo-replicated copies of multiple disks.</span></span> <span data-ttu-id="ebb67-253">Se si configura un toostore database, file di dati e del file di log in dischi separati, hello recuperata dischi dopo un'emergenza potranno contenere una copia più aggiornata del file di dati hello hello che file di log, che interrompe hello log write-ahead in SQL Server e hello ACID proprietà delle transazioni.</span><span class="sxs-lookup"><span data-stu-id="ebb67-253">If you configure a database toostore its data file and its log file on separate disks, hello recovered disks after a disaster may contain a more up-to-date copy of hello data file than hello log file, which breaks hello write-ahead log in SQL Server and hello ACID properties of transactions.</span></span> <span data-ttu-id="ebb67-254">Se non si dispone hello opzione toodisable-replica geografica nell'account di archiviazione hello, è consigliabile mantenere tutti i dati e file di log per un determinato database su hello stesso disco.</span><span class="sxs-lookup"><span data-stu-id="ebb67-254">If you do not have hello option toodisable geo-replication on hello storage account, you should keep all data and log files for a given database on hello same disk.</span></span> <span data-ttu-id="ebb67-255">Se è necessario utilizzare più di un disco a causa delle dimensioni di toohello di hello database, è necessario toodeploy una delle soluzioni di ripristino di emergenza hello elencate in precedenza tooensure ridondanza dei dati.</span><span class="sxs-lookup"><span data-stu-id="ebb67-255">If you must use more than one disk due toohello size of hello database, you need toodeploy one of hello disaster recovery solutions listed above tooensure data redundancy.</span></span>

## <a name="next-steps"></a><span data-ttu-id="ebb67-256">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="ebb67-256">Next steps</span></span>
<span data-ttu-id="ebb67-257">Se è necessario toocreate una macchina virtuale di Azure con SQL Server, vedere [Provisioning di una macchina virtuale di SQL Server in Azure](virtual-machines-windows-portal-sql-server-provision.md).</span><span class="sxs-lookup"><span data-stu-id="ebb67-257">If you need toocreate an Azure virtual machine with SQL Server, see [Provisioning a SQL Server Virtual Machine on Azure](virtual-machines-windows-portal-sql-server-provision.md).</span></span>

<span data-ttu-id="ebb67-258">migliori prestazioni hello tooget da SQL Server in esecuzione in una macchina virtuale di Azure, vedere Guida hello in [procedure consigliate per SQL Server in macchine virtuali di Azure](virtual-machines-windows-sql-performance.md).</span><span class="sxs-lookup"><span data-stu-id="ebb67-258">tooget hello best performance from SQL Server running on an Azure VM, see hello guidance in [Performance Best Practices for SQL Server in Azure Virtual Machines](virtual-machines-windows-sql-performance.md).</span></span>

<span data-ttu-id="ebb67-259">Per altri argomenti correlati toorunning SQL Server in macchine virtuali di Azure, vedere [SQL Server in macchine virtuali di Azure](virtual-machines-windows-sql-server-iaas-overview.md).</span><span class="sxs-lookup"><span data-stu-id="ebb67-259">For other topics related toorunning SQL Server in Azure VMs, see [SQL Server on Azure Virtual Machines](virtual-machines-windows-sql-server-iaas-overview.md).</span></span>

### <a name="other-resources"></a><span data-ttu-id="ebb67-260">Altre risorse:</span><span class="sxs-lookup"><span data-stu-id="ebb67-260">Other resources</span></span>
* [<span data-ttu-id="ebb67-261">Installare una nuova foresta Active Directory in Azure</span><span class="sxs-lookup"><span data-stu-id="ebb67-261">Install a new Active Directory forest in Azure</span></span>](../../../active-directory/active-directory-new-forest-virtual-machine.md)
* [<span data-ttu-id="ebb67-262">Creare cluster di failover per i gruppi di disponibilità in una macchina virtuale di Azure</span><span class="sxs-lookup"><span data-stu-id="ebb67-262">Create Failover Cluster for availability groups in Azure VM</span></span>](http://gallery.technet.microsoft.com/scriptcenter/Create-WSFC-Cluster-for-7c207d3a)

