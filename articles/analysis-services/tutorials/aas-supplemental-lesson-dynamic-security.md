---
title: 'Lezione supplementare dell''esercitazione su Azure Analysis Services: sicurezza dinamica | Microsoft Docs'
description: Descrive come usare la sicurezza dinamica tramite filtri di riga nell'esercitazione su Azure Analysis Services.
services: analysis-services
documentationcenter: 
author: minewiskan
manager: erikre
editor: 
tags: 
ms.assetid: 
ms.service: analysis-services
ms.devlang: NA
ms.topic: get-started-article
ms.tgt_pltfrm: NA
ms.workload: na
ms.date: 05/26/2017
ms.author: owend
ms.openlocfilehash: 4e97a558ae1a2601b5275a73164b483351f03857
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/03/2017
---
# <a name="supplemental-lesson---dynamic-security"></a><span data-ttu-id="73ec9-103">Lezione supplementare: Sicurezza dinamica</span><span class="sxs-lookup"><span data-stu-id="73ec9-103">Supplemental lesson - Dynamic security</span></span>

[!INCLUDE[analysis-services-appliesto-aas-sql2017-later](../../../includes/analysis-services-appliesto-aas-sql2017-later.md)]

<span data-ttu-id="73ec9-104">In questa lezione supplementare si creerà un ruolo aggiuntivo che implementa la sicurezza dinamica.</span><span class="sxs-lookup"><span data-stu-id="73ec9-104">In this supplemental lesson, you create an additional role that implements dynamic security.</span></span> <span data-ttu-id="73ec9-105">La sicurezza dinamica offre un meccanismo di protezione a livello di riga basato sul nome utente o sull'ID di accesso dell'utente connesso.</span><span class="sxs-lookup"><span data-stu-id="73ec9-105">Dynamic security provides row-level security based on the user name or login id of the user currently logged on.</span></span> 
  
<span data-ttu-id="73ec9-106">Per implementare la sicurezza dinamica, è necessario aggiungere al modello una tabella con i nomi degli utenti che possono connettersi al modello ed esplorare dati e oggetti del modello.</span><span class="sxs-lookup"><span data-stu-id="73ec9-106">To implement dynamic security, you add a table to your model containing the user names of those users that can connect to the model and browse model objects and data.</span></span> <span data-ttu-id="73ec9-107">Il modello creato con questa esercitazione è nel contesto di Adventure Works. Per completare questa lezione, tuttavia, è necessario aggiungere una tabella contenente gli utenti del proprio dominio.</span><span class="sxs-lookup"><span data-stu-id="73ec9-107">The model you create using this tutorial is in the context of Adventure Works; however, to complete this lesson, you must add a table containing users from your own domain.</span></span> <span data-ttu-id="73ec9-108">Non occorrono le password per i nomi utente aggiunti.</span><span class="sxs-lookup"><span data-stu-id="73ec9-108">You do not need the passwords for the user names that are added.</span></span> <span data-ttu-id="73ec9-109">Per creare una tabella EmployeeSecurity con un piccolo campione di utenti del proprio dominio, usare la funzionalità Incolla e incollare i dati dei dipendenti da un foglio di calcolo di Excel.</span><span class="sxs-lookup"><span data-stu-id="73ec9-109">To create an EmployeeSecurity table, with a small sample of users from your own domain, you use the Paste feature, pasting employee data from an Excel spreadsheet.</span></span> <span data-ttu-id="73ec9-110">In uno scenario reale, la tabella contenente i nomi utente sarebbe di solito una tabella da un database effettivo usato come origine dati, ad esempio una tabella DimEmployee reale.</span><span class="sxs-lookup"><span data-stu-id="73ec9-110">In a real-world scenario, the table containing user names would typically be a table from an actual database as a data source; for example, a real DimEmployee table.</span></span>  
  
<span data-ttu-id="73ec9-111">Per implementare la sicurezza dinamica, verranno usate due funzioni DAX: [USERNAME](http://msdn.microsoft.com/22dddc4b-1648-4c89-8c93-f1151162b93f) e [LOOKUPVALUE](http://msdn.microsoft.com/73a51c4d-131c-4c33-a139-b1342d10caab).</span><span class="sxs-lookup"><span data-stu-id="73ec9-111">To implement dynamic security, you use two DAX functions: [USERNAME Function (DAX)](http://msdn.microsoft.com/22dddc4b-1648-4c89-8c93-f1151162b93f) and [LOOKUPVALUE Function (DAX)](http://msdn.microsoft.com/73a51c4d-131c-4c33-a139-b1342d10caab).</span></span> <span data-ttu-id="73ec9-112">Queste funzioni, applicate in una formula di filtro di riga, vengono definite in un nuovo ruolo.</span><span class="sxs-lookup"><span data-stu-id="73ec9-112">These functions, applied in a row filter formula, are defined in a new role.</span></span> <span data-ttu-id="73ec9-113">Usando la funzione LOOKUPVALUE, la formula specifica un valore dalla tabella EmployeeSecurity</span><span class="sxs-lookup"><span data-stu-id="73ec9-113">By using the LOOKUPVALUE function, the formula specifies a value from the EmployeeSecurity table.</span></span> <span data-ttu-id="73ec9-114">e quindi passa il valore alla funzione USERNAME, che specifica che il nome dell'utente connesso appartiene a questo ruolo.</span><span class="sxs-lookup"><span data-stu-id="73ec9-114">The formula then passes that value to the USERNAME function, which specifies the user name of the user logged on belongs to this role.</span></span> <span data-ttu-id="73ec9-115">L'utente può quindi esplorare solo i dati specificati dai filtri di riga del ruolo.</span><span class="sxs-lookup"><span data-stu-id="73ec9-115">The user can then browse only data specified by the role’s row filters.</span></span> <span data-ttu-id="73ec9-116">In questo scenario, si specifica che i dipendenti del reparto vendite possono solo visualizzare i dati relativi alle vendite Internet per i territori di vendita di cui sono membri.</span><span class="sxs-lookup"><span data-stu-id="73ec9-116">In this scenario, you specify that sales employees can only browse Internet sales data for the sales territories in which they are a member.</span></span>  
  
<span data-ttu-id="73ec9-117">Le attività specifiche per questo scenario di modello tabulare Adventure Works, non necessariamente applicabili a uno scenario reale verranno identificate come tali.</span><span class="sxs-lookup"><span data-stu-id="73ec9-117">Those tasks that are unique to this Adventure Works tabular model scenario, but would not necessarily apply to a real-world scenario are identified as such.</span></span> <span data-ttu-id="73ec9-118">Ogni attività include informazioni aggiuntive che descrivono lo scopo dell'attività.</span><span class="sxs-lookup"><span data-stu-id="73ec9-118">Each task includes additional information describing the purpose of the task.</span></span>  
  
<span data-ttu-id="73ec9-119">Tempo previsto per il completamento della lezione: **30 minuti**</span><span class="sxs-lookup"><span data-stu-id="73ec9-119">Estimated time to complete this lesson: **30 minutes**</span></span>  
  
## <a name="prerequisites"></a><span data-ttu-id="73ec9-120">Prerequisiti</span><span class="sxs-lookup"><span data-stu-id="73ec9-120">Prerequisites</span></span>  
<span data-ttu-id="73ec9-121">L'argomento di questa lezione supplementare fa parte di un'esercitazione sulla creazione di modelli tabulari, con lezioni che è consigliabile completare nell'ordine indicato.</span><span class="sxs-lookup"><span data-stu-id="73ec9-121">This supplemental lesson topic is part of a tabular modeling tutorial, which should be completed in order.</span></span> <span data-ttu-id="73ec9-122">Prima di eseguire le attività in questa lezione supplementare, è necessario avere completato tutte le lezioni precedenti.</span><span class="sxs-lookup"><span data-stu-id="73ec9-122">Before performing the tasks in this supplemental lesson, you should have completed all previous lessons.</span></span>  
  
## <a name="add-the-dimsalesterritory-table-to-the-aw-internet-sales-tabular-model-project"></a><span data-ttu-id="73ec9-123">Aggiungere la tabella DimSalesTerritory al progetto di modello tabulare AW Internet Sales</span><span class="sxs-lookup"><span data-stu-id="73ec9-123">Add the DimSalesTerritory table to the AW Internet Sales Tabular Model Project</span></span>  
<span data-ttu-id="73ec9-124">Per implementare la sicurezza dinamica per questo scenario di Adventure Works, è necessario aggiungere due tabelle al modello.</span><span class="sxs-lookup"><span data-stu-id="73ec9-124">To implement dynamic security for this Adventure Works scenario, you must add two additional tables to your model.</span></span> <span data-ttu-id="73ec9-125">La prima tabella da aggiungere è DimSalesTerritory (come Sales Territory) dallo stesso database AdventureWorksDW.</span><span class="sxs-lookup"><span data-stu-id="73ec9-125">The first table you add is DimSalesTerritory (as Sales Territory) from the same AdventureWorksDW database.</span></span> <span data-ttu-id="73ec9-126">In seguito si applicherà un filtro di riga alla tabella SalesTerritory che definisce i dati specifici che l'utente connesso può visualizzare.</span><span class="sxs-lookup"><span data-stu-id="73ec9-126">You later apply a row filter to the SalesTerritory table that defines the particular data the logged on user can browse.</span></span>  
  
#### <a name="to-add-the-dimsalesterritory-table"></a><span data-ttu-id="73ec9-127">Per aggiungere la tabella DimSalesTerritory</span><span class="sxs-lookup"><span data-stu-id="73ec9-127">To add the DimSalesTerritory table</span></span>  
  
1.  <span data-ttu-id="73ec9-128">In Esplora modelli tabulari espandere **Origini dati**, fare clic con il pulsante destro del mouse sulla connessione e quindi scegliere **Importa nuove tabelle**.</span><span class="sxs-lookup"><span data-stu-id="73ec9-128">In Tabular Model Explorer > **Data Sources**, right-click your connection, and then click **Import New Tables**.</span></span>  

    <span data-ttu-id="73ec9-129">Se viene visualizzata la finestra di dialogo Credenziali rappresentazione digitare le credenziali di rappresentazione usate nella lezione 2: Aggiungere dati.</span><span class="sxs-lookup"><span data-stu-id="73ec9-129">If the Impersonation Credentials dialog box appears, type the impersonation credentials you used in Lesson 2: Add Data.</span></span>
  
2.  <span data-ttu-id="73ec9-130">Nello strumento di navigazione selezionare la tabella **DimSalesTerritory** e quindi fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="73ec9-130">In Navigator, select the **DimSalesTerritory** table, and then click **OK**.</span></span>    
  
3.  <span data-ttu-id="73ec9-131">Nell'Editor di query fare clic sulla query **DimSalesTerritory** e quindi rimuovere la colonna **SalesTerritoryAlternateKey**.</span><span class="sxs-lookup"><span data-stu-id="73ec9-131">In Query Editor, click the **DimSalesTerritory** query, and then remove **SalesTerritoryAlternateKey** column.</span></span>  
  
7.  <span data-ttu-id="73ec9-132">Fare clic su **Importa**.</span><span class="sxs-lookup"><span data-stu-id="73ec9-132">Click **Import**.</span></span>  
  
    <span data-ttu-id="73ec9-133">La nuova tabella verrà aggiunta all'area di lavoro del modello.</span><span class="sxs-lookup"><span data-stu-id="73ec9-133">The new table is added to the model workspace.</span></span> <span data-ttu-id="73ec9-134">Gli oggetti e i dati dalla tabella di origine DimSalesTerritory vengono quindi importati nel modello tabulare AW Internet Sales.</span><span class="sxs-lookup"><span data-stu-id="73ec9-134">Objects and data from the source DimSalesTerritory table are then imported into your AW Internet Sales Tabular Model.</span></span>  
  
9. <span data-ttu-id="73ec9-135">Dopo aver completato l'importazione della tabella fare clic su **Chiudi**.</span><span class="sxs-lookup"><span data-stu-id="73ec9-135">After the table has been imported successfully, click **Close**.</span></span>  

## <a name="add-a-table-with-user-name-data"></a><span data-ttu-id="73ec9-136">Aggiungere una tabella con i dati dei nomi utente</span><span class="sxs-lookup"><span data-stu-id="73ec9-136">Add a table with user name data</span></span>  
<span data-ttu-id="73ec9-137">La tabella DimEmployee nel database di esempio AdventureWorksDW contiene utenti del dominio AdventureWorks.</span><span class="sxs-lookup"><span data-stu-id="73ec9-137">The DimEmployee table in the AdventureWorksDW sample database contains users from the AdventureWorks domain.</span></span> <span data-ttu-id="73ec9-138">Questo nomi utente, tuttavia, non esistono nel proprio ambiente.</span><span class="sxs-lookup"><span data-stu-id="73ec9-138">Those user names do not exist in your own environment.</span></span> <span data-ttu-id="73ec9-139">È necessario quindi creare una tabella nel modello che contenga un piccolo campione (almeno tre) di utenti reali dell'organizzazione.</span><span class="sxs-lookup"><span data-stu-id="73ec9-139">You must create a table in your model that contains a small sample (at least three) of actual users from your organization.</span></span> <span data-ttu-id="73ec9-140">Questi utenti verranno poi aggiunti come membri al nuovo ruolo.</span><span class="sxs-lookup"><span data-stu-id="73ec9-140">You then add these users as members to the new role.</span></span> <span data-ttu-id="73ec9-141">Non servono le password per i nomi utente del campione, ma sono necessari nomi utente di Windows effettivi del proprio dominio.</span><span class="sxs-lookup"><span data-stu-id="73ec9-141">You do not need the passwords for the sample user names, but you do need actual Windows user names from your own domain.</span></span>  
  
#### <a name="to-add-an-employeesecurity-table"></a><span data-ttu-id="73ec9-142">Per aggiungere una tabella EmployeeSecurity</span><span class="sxs-lookup"><span data-stu-id="73ec9-142">To add an EmployeeSecurity table</span></span>  
  
1.  <span data-ttu-id="73ec9-143">Aprire Microsoft Excel per creare un foglio di lavoro.</span><span class="sxs-lookup"><span data-stu-id="73ec9-143">Open Microsoft Excel, creating a worksheet.</span></span>  
  
2.  <span data-ttu-id="73ec9-144">Copiare la tabella seguente, inclusa la riga di intestazione e quindi incollarla nel foglio di lavoro.</span><span class="sxs-lookup"><span data-stu-id="73ec9-144">Copy the following table, including the header row, and then paste it into the worksheet.</span></span>  

    ```
      |EmployeeId|SalesTerritoryId|FirstName|LastName|LoginId|  
      |---------------|----------------------|--------------|-------------|------------|  
      |1|2|<user first name>|<user last name>|\<domain\username>|  
      |1|3|<user first name>|<user last name>|\<domain\username>|  
      |2|4|<user first name>|<user last name>|\<domain\username>|  
      |3|5|<user first name>|<user last name>|\<domain\username>|  
    ```

3.  <span data-ttu-id="73ec9-145">Sostituire nome, cognome e dominio\nomeutente con i nomi e gli ID di accesso dei tre utenti dell'organizzazione.</span><span class="sxs-lookup"><span data-stu-id="73ec9-145">Replace the first name, last name, and domain\username with the names and login ids of three users in your organization.</span></span> <span data-ttu-id="73ec9-146">Inserire lo stesso utente nelle prime due righe, in corrispondenza di EmployeeId 1, in modo da indicare che l'utente appartiene a più di un territorio di vendita.</span><span class="sxs-lookup"><span data-stu-id="73ec9-146">Put the same user on the first two rows, for EmployeeId 1, showing this user belongs to more than one sales territory.</span></span> <span data-ttu-id="73ec9-147">Lasciare invariati i campi EmployeeId e SalesTerritoryId.</span><span class="sxs-lookup"><span data-stu-id="73ec9-147">Leave the EmployeeId and SalesTerritoryId fields as they are.</span></span>  
  
4.  <span data-ttu-id="73ec9-148">Salvare il foglio di lavoro come **SampleEmployee**.</span><span class="sxs-lookup"><span data-stu-id="73ec9-148">Save the worksheet as **SampleEmployee**.</span></span>  
  
5.  <span data-ttu-id="73ec9-149">Nel foglio di lavoro selezionare tutte le celle con i dati dei dipendenti, incluse le intestazioni, quindi fare clic con il pulsante destro del mouse sui dati selezionati e scegliere **Copia**.</span><span class="sxs-lookup"><span data-stu-id="73ec9-149">In the worksheet, select all the cells with employee data, including the headers, then right-click the selected data, and then click **Copy**.</span></span>  
  
6.  <span data-ttu-id="73ec9-150">In SSDT scegliere **Incolla** dal menu **Modifica**.</span><span class="sxs-lookup"><span data-stu-id="73ec9-150">In SSDT, click the **Edit** menu, and then click **Paste**.</span></span>  
  
    <span data-ttu-id="73ec9-151">Se il comando Incolla è disattivato, fare clic in qualsiasi colonna di qualsiasi tabella nella finestra di progettazione dei modelli e riprovare.</span><span class="sxs-lookup"><span data-stu-id="73ec9-151">If Paste is grayed out, click any column in any table in the model designer window, and try again.</span></span>  
  
7.  <span data-ttu-id="73ec9-152">Nella finestra di dialogo **Anteprima Incolla** digitare **EmployeeSecurity** in **Nome tabella**.</span><span class="sxs-lookup"><span data-stu-id="73ec9-152">In the **Paste Preview** dialog box, in **Table Name**, type **EmployeeSecurity**.</span></span>  
  
8.  <span data-ttu-id="73ec9-153">In **Dati da incollare** verificare che i dati includano tutti i dati degli utenti e le intestazioni dal foglio di lavoro SampleEmployee.</span><span class="sxs-lookup"><span data-stu-id="73ec9-153">In **Data to be pasted**, verify the data includes all the user data and headers from the SampleEmployee worksheet.</span></span>  
  
9. <span data-ttu-id="73ec9-154">Verificare che l'opzione **Usa la prima riga per le intestazioni di colonna** sia selezionata e quindi fare clic su **Ok**.</span><span class="sxs-lookup"><span data-stu-id="73ec9-154">Verify **Use first row as column headers** is checked, and then click **Ok**.</span></span>  
  
    <span data-ttu-id="73ec9-155">Verrà creata una nuova tabella denominata EmployeeSecurity con i dati dei dipendenti copiati dal foglio di lavoro SampleEmployee.</span><span class="sxs-lookup"><span data-stu-id="73ec9-155">A new table named EmployeeSecurity with employee data copied from the SampleEmployee worksheet is created.</span></span>  
  
## <a name="create-relationships-between-factinternetsales-dimgeography-and-dimsalesterritory-table"></a><span data-ttu-id="73ec9-156">Creare relazioni tra le tabelle FactInternetSales, DimGeography e DimSalesTerritory</span><span class="sxs-lookup"><span data-stu-id="73ec9-156">Create relationships between FactInternetSales, DimGeography, and DimSalesTerritory table</span></span>  
<span data-ttu-id="73ec9-157">Le tabelle FactInternetSales, DimGeography e DimSalesTerritory contengono tutte una colonna in comune, SalesTerritoryId.</span><span class="sxs-lookup"><span data-stu-id="73ec9-157">The FactInternetSales, DimGeography, and DimSalesTerritory table all contain a common column, SalesTerritoryId.</span></span> <span data-ttu-id="73ec9-158">La colonna SalesTerritoryId nella tabella DimSalesTerritory contiene i valori con un ID diverso per ogni territorio di vendita.</span><span class="sxs-lookup"><span data-stu-id="73ec9-158">The SalesTerritoryId column in the DimSalesTerritory table contains values with a different Id for each sales territory.</span></span>  
  
#### <a name="to-create-relationships-between-the-factinternetsales-dimgeography-and-the-dimsalesterritory-table"></a><span data-ttu-id="73ec9-159">Per creare relazioni tra le tabelle FactInternetSales, DimGeography e DimSalesTerritory</span><span class="sxs-lookup"><span data-stu-id="73ec9-159">To create relationships between the FactInternetSales, DimGeography, and the DimSalesTerritory table</span></span>  
  
1.  <span data-ttu-id="73ec9-160">Nella vista diagramma, nella tabella **DimGeography** fare clic sulla colonna **SalesTerritoryId** e tenere premuto, trascinare il cursore sulla colonna **SalesTerritoryId** nella tabella **DimSalesTerritory** e quindi rilasciare.</span><span class="sxs-lookup"><span data-stu-id="73ec9-160">In Diagram View, in the **DimGeography** table, click, and hold on the **SalesTerritoryId** column, then drag the cursor to the **SalesTerritoryId** column in the **DimSalesTerritory** table, and then release.</span></span>  
  
2.  <span data-ttu-id="73ec9-161">Nella tabella **FactInternetSales** fare clic sulla colonna **SalesTerritoryId** e tenere premuto, trascinare il cursore sulla colonna **SalesTerritoryId** nella tabella **DimSalesTerritory** e quindi rilasciare.</span><span class="sxs-lookup"><span data-stu-id="73ec9-161">In the **FactInternetSales** table, click, and hold on the **SalesTerritoryId** column, then drag the cursor to the **SalesTerritoryId** column in the **DimSalesTerritory** table, and then release.</span></span>  
  
    <span data-ttu-id="73ec9-162">Si noti che la proprietà Attiva per questa relazione è False, ovvero è inattiva.</span><span class="sxs-lookup"><span data-stu-id="73ec9-162">Notice the Active property for this relationship is False, meaning it's inactive.</span></span> <span data-ttu-id="73ec9-163">La tabella FactInternetSales, infatti, include già un'altra relazione attiva.</span><span class="sxs-lookup"><span data-stu-id="73ec9-163">The FactInternetSales table already has another active relationship.</span></span>  
  
## <a name="hide-the-employeesecurity-table-from-client-applications"></a><span data-ttu-id="73ec9-164">Nascondere la tabella EmployeeSecurity dalle applicazioni client</span><span class="sxs-lookup"><span data-stu-id="73ec9-164">Hide the EmployeeSecurity Table from client applications</span></span>  
<span data-ttu-id="73ec9-165">In questa attività si nasconderà la tabella EmployeeSecurity, impedendone la visualizzazione nell'elenco dei campi di un'applicazione client.</span><span class="sxs-lookup"><span data-stu-id="73ec9-165">In this task, you hide the EmployeeSecurity table, keeping it from appearing in a client application’s field list.</span></span> <span data-ttu-id="73ec9-166">Tenere presente che nascondere una tabella non significa proteggerla.</span><span class="sxs-lookup"><span data-stu-id="73ec9-166">Keep in mind that hiding a table does not secure it.</span></span> <span data-ttu-id="73ec9-167">Gli utenti possono comunque eseguire query per recuperare dati dalla tabella EmployeeSecurity, se sanno come farlo.</span><span class="sxs-lookup"><span data-stu-id="73ec9-167">Users can still query EmployeeSecurity table data if they know how.</span></span> <span data-ttu-id="73ec9-168">Per proteggere i dati della tabella EmployeeSecurity, impedendo agli utenti di poter eseguire query sui relativi dati, si applicherà un filtro in un'attività successiva.</span><span class="sxs-lookup"><span data-stu-id="73ec9-168">To secure the EmployeeSecurity table data, preventing users from being able to query any of its data, you apply a filter in a later task.</span></span>  
  
#### <a name="to-hide-the-employeesecurity-table-from-client-applications"></a><span data-ttu-id="73ec9-169">Per nascondere la tabella EmployeeSecurity dalle applicazioni client</span><span class="sxs-lookup"><span data-stu-id="73ec9-169">To hide the EmployeeSecurity table from client applications</span></span>  
  
-   <span data-ttu-id="73ec9-170">Nella finestra di progettazione dei modelli, in vista diagramma, fare clic con il pulsante destro del mouse sull'intestazione della tabella **Employee** e quindi scegliere **Nascondi a strumenti client**.</span><span class="sxs-lookup"><span data-stu-id="73ec9-170">In the model designer, in Diagram View, right-click the **Employee** table heading, and then click **Hide from Client Tools**.</span></span>  
  
## <a name="create-a-sales-employees-by-territory-user-role"></a><span data-ttu-id="73ec9-171">Creare un ruolo utente Sales Employees by Territory</span><span class="sxs-lookup"><span data-stu-id="73ec9-171">Create a Sales Employees by Territory user role</span></span>  
<span data-ttu-id="73ec9-172">In questa attività si creerà un ruolo utente.</span><span class="sxs-lookup"><span data-stu-id="73ec9-172">In this task, you create a user role.</span></span> <span data-ttu-id="73ec9-173">Questo ruolo include un filtro di riga che definisce le righe della tabella DimSalesTerritory che sono visibili agli utenti.</span><span class="sxs-lookup"><span data-stu-id="73ec9-173">This role includes a row filter defining which rows of the DimSalesTerritory table are visible to users.</span></span> <span data-ttu-id="73ec9-174">Il filtro viene quindi applicato nella direzione della relazione uno-a-molti a tutte le altre tabelle correlate a DimSalesTerritory.</span><span class="sxs-lookup"><span data-stu-id="73ec9-174">The filter is then applied in the one-to-many relationship direction to all other tables related to DimSalesTerritory.</span></span> <span data-ttu-id="73ec9-175">È anche possibile applicare un filtro che protegge l'intera tabella EmployeeSecurity impedendo l'esecuzione di query a qualsiasi utente membro del ruolo.</span><span class="sxs-lookup"><span data-stu-id="73ec9-175">You also apply a filter that secures the entire EmployeeSecurity table from being queryable by any user that is a member of the role.</span></span>  
  
> [!NOTE]  
> <span data-ttu-id="73ec9-176">Il ruolo Sales Employees by Territory creato in questa lezione limita i membri consentendo loro di visualizzare solo i dati sulle vendite per il territorio a cui appartengono o di eseguire query su tali dati.</span><span class="sxs-lookup"><span data-stu-id="73ec9-176">The Sales Employees by Territory role you create in this lesson restricts members to browse (or query) only sales data for the sales territory to which they belong.</span></span> <span data-ttu-id="73ec9-177">Se si aggiunge un utente come membro al ruolo Sales Employees by Territory e tale utente esiste anche come membro di uno dei ruoli creati nella [Lezione 11: Creare ruoli](../tutorials/aas-lesson-11-create-roles.md), si ottiene una combinazione di autorizzazioni.</span><span class="sxs-lookup"><span data-stu-id="73ec9-177">If you add a user as a member to the Sales Employees by Territory role that also exists as a member in a role created in [Lesson 11: Create Roles](../tutorials/aas-lesson-11-create-roles.md), you get a combination of permissions.</span></span> <span data-ttu-id="73ec9-178">Quando un utente è membro di più ruoli, le autorizzazioni e i filtri di riga definiti per ogni ruolo sono cumulativi.</span><span class="sxs-lookup"><span data-stu-id="73ec9-178">When a user is a member of multiple roles, the permissions, and row filters defined for each role are cumulative.</span></span> <span data-ttu-id="73ec9-179">Questo significa che l'utente dispone delle autorizzazioni maggiori determinate dalla combinazione dei ruoli.</span><span class="sxs-lookup"><span data-stu-id="73ec9-179">That is, the user has the greater permissions determined by the combination of roles.</span></span>  
  
#### <a name="to-create-a-sales-employees-by-territory-user-role"></a><span data-ttu-id="73ec9-180">Per creare un ruolo utente Sales Employees by Territory</span><span class="sxs-lookup"><span data-stu-id="73ec9-180">To create a Sales Employees by Territory user role</span></span>  
  
1.  <span data-ttu-id="73ec9-181">In SSDT fare clic sul menu **Modello** e quindi su **Ruoli**.</span><span class="sxs-lookup"><span data-stu-id="73ec9-181">In SSDT, click the **Model** menu, and then click **Roles**.</span></span>  
  
2.  <span data-ttu-id="73ec9-182">In **Gestione ruoli** fare clic su **Nuovo**.</span><span class="sxs-lookup"><span data-stu-id="73ec9-182">In **Role Manager**, click **New**.</span></span>  
  
    <span data-ttu-id="73ec9-183">Un nuovo ruolo con l'autorizzazione Nessuna verrà aggiunto all'elenco.</span><span class="sxs-lookup"><span data-stu-id="73ec9-183">A new role with the None permission is added to the list.</span></span>  
  
3.  <span data-ttu-id="73ec9-184">Fare clic sul nuovo ruolo e quindi nella colonna **Nome** rinominare il ruolo in **Sales Employees by Territory**.</span><span class="sxs-lookup"><span data-stu-id="73ec9-184">Click the new role, and then in the **Name** column, rename the role to **Sales Employees by Territory**.</span></span>  
  
4.  <span data-ttu-id="73ec9-185">Nella colonna **Autorizzazioni** fare clic nell'elenco a discesa e quindi selezionare l'autorizzazione **Lettura**.</span><span class="sxs-lookup"><span data-stu-id="73ec9-185">In the **Permissions** column, click the dropdown list, and then select the **Read** permission.</span></span>  
  
5.  <span data-ttu-id="73ec9-186">Fare clic sulla scheda **Membri** e quindi fare clic su **Aggiungi**.</span><span class="sxs-lookup"><span data-stu-id="73ec9-186">Click the **Members** tab, and then click **Add**.</span></span>  
  
6.  <span data-ttu-id="73ec9-187">Nella finestra di dialogo **Seleziona utente o gruppo**, in **Immettere il nome dell'oggetto da selezionare**, digitare il primo nome utente di esempio usato durante la creazione della tabella EmployeeSecurity.</span><span class="sxs-lookup"><span data-stu-id="73ec9-187">In the **Select User or Group** dialog box, in **Enter the object named to select**, type the first sample user name you used when creating the EmployeeSecurity table.</span></span> <span data-ttu-id="73ec9-188">Fare clic su **Controlla nomi** per verificare se il nome utente è valido e quindi fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="73ec9-188">Click **Check Names** to verify the user name is valid, and then click **Ok**.</span></span>  
  
    <span data-ttu-id="73ec9-189">Ripetere questo passaggio, aggiungendo gli altri nomi utente di esempio usati durante la creazione della tabella EmployeeSecurity.</span><span class="sxs-lookup"><span data-stu-id="73ec9-189">Repeat this step, adding the other sample user names you used when creating the EmployeeSecurity table.</span></span>  
  
7.  <span data-ttu-id="73ec9-190">Fare clic sulla scheda **Filtri di riga**.</span><span class="sxs-lookup"><span data-stu-id="73ec9-190">Click the **Row Filters** tab.</span></span>  
  
8.  <span data-ttu-id="73ec9-191">Per la tabella **EmployeeSecurity**, nella colonna **Filtro DAX** digitare la formula seguente:</span><span class="sxs-lookup"><span data-stu-id="73ec9-191">For the **EmployeeSecurity** table, in the **DAX Filter** column, type the following formula:</span></span>  
  
    ```
      =FALSE()  
    ```
  
    <span data-ttu-id="73ec9-192">Questa formula specifica che tutte le colonne si risolvono nella condizione booleana False</span><span class="sxs-lookup"><span data-stu-id="73ec9-192">This formula specifies that all columns resolve to the false Boolean condition.</span></span> <span data-ttu-id="73ec9-193">e che nessuna colonna della tabella EmployeeSecurity può essere sottoposta a query da un membro del ruolo utente Sales Employees by Territory.</span><span class="sxs-lookup"><span data-stu-id="73ec9-193">No columns for the EmployeeSecurity table can be queried by a member of the Sales Employees by Territory user role.</span></span>  
  
9. <span data-ttu-id="73ec9-194">Per la tabella **DimSalesTerritory** digitare la formula seguente:</span><span class="sxs-lookup"><span data-stu-id="73ec9-194">For the **DimSalesTerritory** table, type the following formula:</span></span>  

    ```  
    ='Sales Territory'[Sales Territory Id]=LOOKUPVALUE('Employee Security'[Sales Territory Id], 
      'Employee Security'[Login Id], USERNAME(), 
      'Employee Security'[Sales Territory Id], 
      'Sales Territory'[Sales Territory Id]) 
    ```
  
    <span data-ttu-id="73ec9-195">In questa formula la funzione LOOKUPVALUE restituisce tutti i valori per la colonna DimEmployeeSecurity[SalesTerritoryId], in cui EmployeeSecurity[LoginId] corrisponde al nome utente di Windows connesso ed EmployeeSecurity[SalesTerritoryId] è uguale a DimSalesTerritory[SalesTerritoryId].</span><span class="sxs-lookup"><span data-stu-id="73ec9-195">In this formula, the LOOKUPVALUE function returns all values for the DimEmployeeSecurity[SalesTerritoryId] column, where the EmployeeSecurity[LoginId] is the same as the current logged on Windows user name, and EmployeeSecurity[SalesTerritoryId] is the same as the DimSalesTerritory[SalesTerritoryId].</span></span>  
  
    <span data-ttu-id="73ec9-196">Il set di ID di territori di vendita restituiti da LOOKUPVALUE viene quindi usato per limitare le righe visualizzate nella tabella DimSalesTerritory.</span><span class="sxs-lookup"><span data-stu-id="73ec9-196">The set of sales territory IDs returned by LOOKUPVALUE is then used to restrict the rows shown in the DimSalesTerritory table.</span></span> <span data-ttu-id="73ec9-197">Vengono visualizzate solo le righe in cui il valore SalesTerritoryID per la riga è incluso nel set di ID restituito dalla funzione LOOKUPVALUE.</span><span class="sxs-lookup"><span data-stu-id="73ec9-197">Only rows where the SalesTerritoryID for the row is in the set of IDs returned by the LOOKUPVALUE function are displayed.</span></span>  
  
10. <span data-ttu-id="73ec9-198">In Gestione ruoli fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="73ec9-198">In Role Manager, click **Ok**.</span></span>  
  
## <a name="test-the-sales-employees-by-territory-user-role"></a><span data-ttu-id="73ec9-199">Testare il ruolo utente Sales Employees by Territory</span><span class="sxs-lookup"><span data-stu-id="73ec9-199">Test the Sales Employees by Territory User Role</span></span>  
<span data-ttu-id="73ec9-200">In questa attività si userà la funzionalità Analizza in Excel in SSDT per verificare l'efficacia del ruolo utente Sales Employees by Territory.</span><span class="sxs-lookup"><span data-stu-id="73ec9-200">In this task, you use the Analyze in Excel feature in SSDT to test the efficacy of the Sales Employees by Territory user role.</span></span> <span data-ttu-id="73ec9-201">Uno dei nomi utente aggiunti alla tabella EmployeeSecurity verrà specificato come membro del ruolo.</span><span class="sxs-lookup"><span data-stu-id="73ec9-201">You specify one of the user names you added to the EmployeeSecurity table and as a member of the role.</span></span> <span data-ttu-id="73ec9-202">Questo nome utente verrà quindi usato come nome utente effettivo nella connessione creata tra Excel e il modello.</span><span class="sxs-lookup"><span data-stu-id="73ec9-202">This user name is then used as the effective user name in the connection created between Excel and the model.</span></span>  
  
#### <a name="to-test-the-sales-employees-by-territory-user-role"></a><span data-ttu-id="73ec9-203">Per testare il ruolo utente Sales Employees by Territory</span><span class="sxs-lookup"><span data-stu-id="73ec9-203">To test the Sales Employees by Territory user role</span></span>  
  
1.  <span data-ttu-id="73ec9-204">In SSDT fare clic sul menu **Modello** e quindi su **Analizza in Excel**.</span><span class="sxs-lookup"><span data-stu-id="73ec9-204">In SSDT, click the **Model** menu, and then click **Analyze in Excel**.</span></span>  
  
2.  <span data-ttu-id="73ec9-205">Nella finestra di dialogo **Analizza in Excel**, in **Specificare il nome utente o il ruolo da utilizzare per la connessione al modello**, selezionare **Altro utente di Windows** e quindi fare clic su **Sfoglia**.</span><span class="sxs-lookup"><span data-stu-id="73ec9-205">In the **Analyze in Excel** dialog box, in **Specify the user name or role to use to connect to the model**, select **Other Windows User**, and then click **Browse**.</span></span>  
  
3.  <span data-ttu-id="73ec9-206">Nella finestra di dialogo **Seleziona utente o gruppo**, in **Immettere il nome dell'oggetto da selezionare** digitare uno dei nomi utente inclusi nella tabella EmployeeSecurity e quindi fare clic su **Controlla nomi**.</span><span class="sxs-lookup"><span data-stu-id="73ec9-206">In the **Select User or Group** dialog box, in **Enter the object name to select**, type a user name you included in the EmployeeSecurity table, and then click **Check Names**.</span></span>  
  
4.  <span data-ttu-id="73ec9-207">Fare clic su **OK** per chiudere la finestra di dialogo **Seleziona utente o gruppo** e quindi fare clic su **OK** per chiudere la finestra di dialogo **Analizza in Excel**.</span><span class="sxs-lookup"><span data-stu-id="73ec9-207">Click **Ok** to close the **Select User or Group** dialog box, and then click **Ok** to close the **Analyze in Excel** dialog box.</span></span>  
  
    <span data-ttu-id="73ec9-208">Excel verrà aperto con una nuova cartella di lavoro.</span><span class="sxs-lookup"><span data-stu-id="73ec9-208">Excel opens with a new workbook.</span></span> <span data-ttu-id="73ec9-209">Viene creata automaticamente una tabella pivot.</span><span class="sxs-lookup"><span data-stu-id="73ec9-209">A PivotTable is automatically created.</span></span> <span data-ttu-id="73ec9-210">L'elenco dei campi della tabella pivot include la maggior parte dei campi dati disponibili nel nuovo modello.</span><span class="sxs-lookup"><span data-stu-id="73ec9-210">The PivotTable Fields list includes most of the data fields available in your new model.</span></span>  
  
    <span data-ttu-id="73ec9-211">La tabella EmployeeSecurity non è visibile nell'elenco Campi tabella pivot,</span><span class="sxs-lookup"><span data-stu-id="73ec9-211">Notice the EmployeeSecurity table is not visible in the PivotTable Fields list.</span></span> <span data-ttu-id="73ec9-212">perché è stata nascosta dagli strumenti client in un'attività precedente.</span><span class="sxs-lookup"><span data-stu-id="73ec9-212">You hid this table from client tools in a previous task.</span></span>  
  
5.  <span data-ttu-id="73ec9-213">Nell'elenco **Campi**, in **∑ Internet Sales** (misure), selezionare la misura **InternetTotalSales**.</span><span class="sxs-lookup"><span data-stu-id="73ec9-213">In the **Fields** list, in **∑ Internet Sales** (measures), select the **InternetTotalSales** measure.</span></span> <span data-ttu-id="73ec9-214">La misura verrà immessa nei campi **Valori**.</span><span class="sxs-lookup"><span data-stu-id="73ec9-214">The measure is entered into the **Values** fields.</span></span>  
  
6.  <span data-ttu-id="73ec9-215">Selezionare la colonna **SalesTerritoryId** dalla tabella **DimSalesTerritory**.</span><span class="sxs-lookup"><span data-stu-id="73ec9-215">Select the **SalesTerritoryId** column from the **DimSalesTerritory** table.</span></span> <span data-ttu-id="73ec9-216">La colonna verrà immessa nei campi **Etichette di riga**.</span><span class="sxs-lookup"><span data-stu-id="73ec9-216">The column is entered into the **Row Labels** fields.</span></span>  
  
    <span data-ttu-id="73ec9-217">Si noti che i dati relativi alle vendite Internet vengono visualizzati solo per l'unica area a cui appartiene il nome utente effettivo usato.</span><span class="sxs-lookup"><span data-stu-id="73ec9-217">Notice Internet sales figures appear only for the one region to which the effective user name you used belongs.</span></span> <span data-ttu-id="73ec9-218">Se si seleziona un'altra colonna, ad esempio City nella tabella DimGeography come campo etichetta di riga, vengono visualizzate solo le città del territorio di vendita a cui appartiene l'utente effettivo.</span><span class="sxs-lookup"><span data-stu-id="73ec9-218">If you select another column, like City from the DimGeography table as Row Label field, only cities in the sales territory to which the effective user belongs are displayed.</span></span>  
  
    <span data-ttu-id="73ec9-219">Questo utente non può visualizzare o eseguire query sui dati delle vendite Internet per territori diversi da quello che a cui appartiene.</span><span class="sxs-lookup"><span data-stu-id="73ec9-219">This user cannot browse or query any Internet sales data for territories other than the one they belong to.</span></span> <span data-ttu-id="73ec9-220">Questa restrizione dipende dal fatto che il filtro di riga definito per la tabella DimSalesTerritory, nel ruolo utente Sales Employees by Territory, protegge tutti i dati correlati ad altri territori di vendita.</span><span class="sxs-lookup"><span data-stu-id="73ec9-220">This restriction is because the row filter defined for the DimSalesTerritory table, in the Sales Employees by Territory user role, secures data for all data related to other sales territories.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="73ec9-221">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="73ec9-221">See Also</span></span>  
[<span data-ttu-id="73ec9-222">USERNAME Function (DAX) (Funzione DAX USERNAME)</span><span class="sxs-lookup"><span data-stu-id="73ec9-222">USERNAME Function (DAX)</span></span>](https://msdn.microsoft.com/library/hh230954.aspx)  
[<span data-ttu-id="73ec9-223">LOOKUPVALUE Function (DAX) (Funzione DAX LOOKUPVALUE)</span><span class="sxs-lookup"><span data-stu-id="73ec9-223">LOOKUPVALUE Function (DAX)</span></span>](https://msdn.microsoft.com/library/gg492170.aspx)  
[<span data-ttu-id="73ec9-224">CUSTOMDATA Function (DAX) (Funzione DAX CUSTOMDATA)</span><span class="sxs-lookup"><span data-stu-id="73ec9-224">CUSTOMDATA Function (DAX)</span></span>](https://msdn.microsoft.com/library/hh213140.aspx)  