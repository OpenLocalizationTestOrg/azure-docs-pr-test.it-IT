---
title: toocreate filtro di pacchetti di FreeBSD aaaUse un firewall in Azure | Documenti Microsoft
description: Informazioni su come toodeploy NAT firewall utilizzando del FreeBSD PF in Azure.
services: virtual-machines-linux
documentationcenter: 
author: KylieLiang
manager: timlt
editor: 
tags: azure-resource-manager
ms.assetid: 
ms.service: virtual-machines-linux
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: vm-linux
ms.workload: infrastructure-services
ms.date: 02/20/2017
ms.author: kyliel
ms.openlocfilehash: 3d3a5dde2ca03ba6fc384581c786f5eb746e6d92
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/06/2017
---
# <a name="how-toouse-freebsds-packet-filter-toocreate-a-secure-firewall-in-azure"></a><span data-ttu-id="5ccb8-103">Come toocreate filtro di pacchetti di FreeBSD toouse un firewall sicuro in Azure</span><span class="sxs-lookup"><span data-stu-id="5ccb8-103">How toouse FreeBSD's Packet Filter toocreate a secure firewall in Azure</span></span>
<span data-ttu-id="5ccb8-104">Questo articolo descrive come toodeploy firewall NAT con filtro del FreeBSD di chi tramite il modello di gestione risorse di Azure per scenario comune di server web.</span><span class="sxs-lookup"><span data-stu-id="5ccb8-104">This article introduces how toodeploy a NAT firewall using FreeBSD’s Packer Filter through Azure Resource Manager template for common web server scenario.</span></span>

## <a name="what-is-pf"></a><span data-ttu-id="5ccb8-105">Informazioni su PF</span><span class="sxs-lookup"><span data-stu-id="5ccb8-105">What is PF?</span></span>
<span data-ttu-id="5ccb8-106">PF (Packet Filter, chiamato anche pf) è un filtro di pacchetti con stato con licenza BSD, un componente software fondamentale per un firewall.</span><span class="sxs-lookup"><span data-stu-id="5ccb8-106">PF (Packet Filter, also written pf) is a BSD licensed stateful packet filter, a central piece of software for firewalling.</span></span> <span data-ttu-id="5ccb8-107">Dalla sua creazione, PF si è rapidamente evoluto e ora dispone di numerosi vantaggi rispetto ad altri firewall disponibili.</span><span class="sxs-lookup"><span data-stu-id="5ccb8-107">PF has since evolved quickly and now has several advantages over other available firewalls.</span></span> <span data-ttu-id="5ccb8-108">Network Address Translation (NAT) è in PF dopo un giorno, quindi Utilità di pianificazione pacchetti e gestione di coda attiva sono state integrate in PF, grazie all'integrazione hello ALTQ e rendendo configurabili tramite la configurazione di cartelle pubbliche.</span><span class="sxs-lookup"><span data-stu-id="5ccb8-108">Network Address Translation (NAT) is in PF since day one, then packet scheduler and active queue management have been integrated into PF, by integrating hello ALTQ and making it configurable through PF's configuration.</span></span> <span data-ttu-id="5ccb8-109">Le funzionalità, ad esempio pfsync e protocollo CARP per il failover e ridondanza, authpf per la sessione di autenticazione e proxy ftp tooease firewall hello difficile protocollo FTP, sono inoltre esteso PF.</span><span class="sxs-lookup"><span data-stu-id="5ccb8-109">Features such as pfsync and CARP for failover and redundancy, authpf for session authentication, and ftp-proxy tooease firewalling hello difficult FTP protocol, have also extended PF.</span></span> <span data-ttu-id="5ccb8-110">In breve, PF è un firewall potente e ricco di funzionalità.</span><span class="sxs-lookup"><span data-stu-id="5ccb8-110">In short, PF is a powerful and feature-rich firewall.</span></span> 

## <a name="get-started"></a><span data-ttu-id="5ccb8-111">Attività iniziali</span><span class="sxs-lookup"><span data-stu-id="5ccb8-111">Get started</span></span>
<span data-ttu-id="5ccb8-112">Se si desidera configurare un firewall sicuro nel cloud hello per i server web, è possibile iniziare subito.</span><span class="sxs-lookup"><span data-stu-id="5ccb8-112">If you are interested in setting up a secure firewall in hello cloud for your web servers, then let’s get started.</span></span> <span data-ttu-id="5ccb8-113">È inoltre possibile applicare script hello utilizzati in questa tooset del modello di gestione risorse di Azure backup la topologia di rete.</span><span class="sxs-lookup"><span data-stu-id="5ccb8-113">You can also apply hello scripts used in this Azure Resource Manager template tooset up your networking topology.</span></span>
<span data-ttu-id="5ccb8-114">modello di gestione risorse di Azure Hello configurare una macchina virtuale FreeBSD che esegue /redirection NAT PF e due FreeBSD le macchine virtuali con il server web Nginx hello installato e configurato.</span><span class="sxs-lookup"><span data-stu-id="5ccb8-114">hello Azure Resource Manager template set up a FreeBSD virtual machine that performs NAT /redirection using PF and two FreeBSD virtual machines with hello Nginx web server installed and configured.</span></span> <span data-ttu-id="5ccb8-115">Inoltre tooperforming NAT per due server web di hello in uscita del traffico, macchina virtuale di hello NAT/reindirizzamento intercetta le richieste HTTP e reindirizza toohello due server web in modo round robin.</span><span class="sxs-lookup"><span data-stu-id="5ccb8-115">In addition tooperforming NAT for hello two web servers egress traffic, hello NAT/redirection virtual machine intercepts HTTP requests and redirect them toohello two web servers in round-robin fashion.</span></span> <span data-ttu-id="5ccb8-116">Hello rete virtuale utilizza hello privato non instradabile IP indirizzo spazio 10.0.0.2/24 ed è possibile modificare i parametri hello del modello di hello.</span><span class="sxs-lookup"><span data-stu-id="5ccb8-116">hello VNet uses hello private non-routable IP address space 10.0.0.2/24 and you can modify hello parameters of hello template.</span></span> <span data-ttu-id="5ccb8-117">modello di Azure Resource Manager Hello definisce anche una tabella di route per l'intera rete virtuale, che è una raccolta di route singoli utilizzato route predefinito di Azure toooverride basate sull'indirizzo IP di destinazione hello hello.</span><span class="sxs-lookup"><span data-stu-id="5ccb8-117">hello Azure Resource Manager template also defines a route table for hello whole VNet, which is a collection of individual routes used toooverride Azure default routes based on hello destination IP address.</span></span> 

![pf_topology](./media/freebsd-pf-nat/pf_topology.jpg)
    
### <a name="deploy-through-azure-cli"></a><span data-ttu-id="5ccb8-119">Distribuire tramite l'interfaccia della riga di comando di Azure</span><span class="sxs-lookup"><span data-stu-id="5ccb8-119">Deploy through Azure CLI</span></span>
<span data-ttu-id="5ccb8-120">È necessario più recente hello [CLI di Azure 2.0](/cli/azure/install-az-cli2) installato e registrato con un account Azure tooan [accesso az](/cli/azure/#login).</span><span class="sxs-lookup"><span data-stu-id="5ccb8-120">You need hello latest [Azure CLI 2.0](/cli/azure/install-az-cli2) installed and logged in tooan Azure account using [az login](/cli/azure/#login).</span></span> <span data-ttu-id="5ccb8-121">Come prima cosa creare un gruppo di risorse con [az group create](/cli/azure/group#create).</span><span class="sxs-lookup"><span data-stu-id="5ccb8-121">Create a resource group with [az group create](/cli/azure/group#create).</span></span> <span data-ttu-id="5ccb8-122">esempio Hello crea il nome di un gruppo di risorse `myResourceGroup` in hello `West US` percorso.</span><span class="sxs-lookup"><span data-stu-id="5ccb8-122">hello following example creates a resource group name `myResourceGroup` in hello `West US` location.</span></span>

```azurecli
az group create --name myResourceGroup --location westus
```

<span data-ttu-id="5ccb8-123">Successivamente, distribuire il modello di hello [pf-freebsd-setup](https://github.com/Azure/azure-quickstart-templates/tree/master/pf-freebsd-setup) con [distribuzione gruppo az creare](/cli/azure/group/deployment#create).</span><span class="sxs-lookup"><span data-stu-id="5ccb8-123">Next, deploy hello template [pf-freebsd-setup](https://github.com/Azure/azure-quickstart-templates/tree/master/pf-freebsd-setup) with [az group deployment create](/cli/azure/group/deployment#create).</span></span> <span data-ttu-id="5ccb8-124">Scaricare [azuredeploy.parameters.json](https://github.com/Azure/azure-quickstart-templates/blob/master/pf-freebsd-setup/azuredeploy.parameters.json) in hello stesso percorso e definire i valori di risorsa, ad esempio `adminPassword`, `networkPrefix`, e `domainNamePrefix`.</span><span class="sxs-lookup"><span data-stu-id="5ccb8-124">Download [azuredeploy.parameters.json](https://github.com/Azure/azure-quickstart-templates/blob/master/pf-freebsd-setup/azuredeploy.parameters.json) under hello same path and define your own resource values, such as `adminPassword`, `networkPrefix`, and `domainNamePrefix`.</span></span> 

```azurecli
az group deployment create --resource-group myResourceGroup --name myDeploymentName \
    --template-uri https://raw.githubusercontent.com/Azure/azure-quickstart-templates/master/pf-freebsd-setup/azuredeploy.json \
    --parameters '@azuredeploy.parameters.json' --verbose
```

<span data-ttu-id="5ccb8-125">Dopo circa cinque minuti, si riceveranno informazioni hello di `"provisioningState": "Succeeded"`.</span><span class="sxs-lookup"><span data-stu-id="5ccb8-125">After about five minutes, you will get hello information of `"provisioningState": "Succeeded"`.</span></span> <span data-ttu-id="5ccb8-126">È quindi possibile ssh front-end toohello VM (NAT) o accedere ai server web Nginx in un browser utilizzando l'indirizzo IP pubblico hello o FQDN di front-end hello VM (NAT).</span><span class="sxs-lookup"><span data-stu-id="5ccb8-126">Then you can ssh toohello frontend VM (NAT) or access Nginx web server in a browser using hello public IP address or FQDN of hello frontend VM (NAT).</span></span> <span data-ttu-id="5ccb8-127">Hello esempio seguente vengono elencati il nome FQDN e indirizzo IP pubblico assegnato front-end toohello VM (NAT) in hello `myResourceGroup` gruppo di risorse.</span><span class="sxs-lookup"><span data-stu-id="5ccb8-127">hello following example lists FQDN and public IP address that assigned toohello frontend VM (NAT) in hello `myResourceGroup` resource group.</span></span> 

```azurecli
az network public-ip list --resource-group myResourceGroup
```
    
## <a name="next-steps"></a><span data-ttu-id="5ccb8-128">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="5ccb8-128">Next steps</span></span>
<span data-ttu-id="5ccb8-129">Si desidera tooset il proprio protocollo NAT in Azure?</span><span class="sxs-lookup"><span data-stu-id="5ccb8-129">Do you want tooset up your own NAT in Azure?</span></span> <span data-ttu-id="5ccb8-130">Open Source, gratuito ma potente?</span><span class="sxs-lookup"><span data-stu-id="5ccb8-130">Open Source, free but powerful?</span></span> <span data-ttu-id="5ccb8-131">PF è quindi una scelta ottimale.</span><span class="sxs-lookup"><span data-stu-id="5ccb8-131">Then PF is a good choice.</span></span> <span data-ttu-id="5ccb8-132">Tramite il modello di hello [pf-freebsd-setup](https://github.com/Azure/azure-quickstart-templates/tree/master/pf-freebsd-setup), è necessario solo cinque minuti tooset di un firewall NAT con FreeBSD utilizzo di bilanciamento del carico di round robin PF in Azure per scenario comune di server web.</span><span class="sxs-lookup"><span data-stu-id="5ccb8-132">By using hello template [pf-freebsd-setup](https://github.com/Azure/azure-quickstart-templates/tree/master/pf-freebsd-setup), you only need five minutes tooset up a NAT firewall with round-robin load balancing using FreeBSD's PF in Azure for common web server scenario.</span></span> 

<span data-ttu-id="5ccb8-133">Se si desidera offerta hello toolearn di FreeBSD in Azure, fare riferimento troppo[tooFreeBSD introduzione in Azure](freebsd-intro-on-azure.md).</span><span class="sxs-lookup"><span data-stu-id="5ccb8-133">If you want toolearn hello offering of FreeBSD in Azure, refer too[introduction tooFreeBSD on Azure](freebsd-intro-on-azure.md).</span></span>

<span data-ttu-id="5ccb8-134">Se si desidera tooknow ulteriori informazioni sulle cartelle pubbliche, fare riferimento troppo[manuale FreeBSD](https://www.freebsd.org/doc/handbook/firewalls-pf.html) o [manuale dell'utente-PF](https://www.freebsd.org/doc/handbook/firewalls-pf.html).</span><span class="sxs-lookup"><span data-stu-id="5ccb8-134">If you want tooknow more about PF, refer too[FreeBSD handbook](https://www.freebsd.org/doc/handbook/firewalls-pf.html) or [PF-User's Guide](https://www.freebsd.org/doc/handbook/firewalls-pf.html).</span></span>
