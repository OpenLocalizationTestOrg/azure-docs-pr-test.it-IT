---
title: Considerazioni relative alla sicurezza per il proxy applicazione di Azure AD | Microsoft Docs
description: Tratta considerazioni relative alla sicurezza quando si usa il proxy applicazione di Azure AD
services: active-directory
documentationcenter: 
author: kgremban
manager: femila
ms.assetid: 
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 08/03/2017
ms.author: kgremban
ms.reviewer: harshja
ms.custom: it-pro
ms.openlocfilehash: c6ead651133eb17fd55f7567cdb14dc3bcd64245
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/18/2017
---
# <a name="security-considerations-for-accessing-apps-remotely-with-azure-ad-application-proxy"></a><span data-ttu-id="eaad0-103">Considerazioni relative alla sicurezza quando si accede alle app in remoto usando il proxy applicazione di Azure AD</span><span class="sxs-lookup"><span data-stu-id="eaad0-103">Security considerations for accessing apps remotely with Azure AD Application Proxy</span></span>

<span data-ttu-id="eaad0-104">Questo articolo spiega come il proxy di applicazione di Azure Active Directory fornisca un servizio sicuro per la pubblicazione e l'accesso alle applicazioni in remoto.</span><span class="sxs-lookup"><span data-stu-id="eaad0-104">This article explains how Azure Active Directory Application Proxy provides a secure service for publishing and accessing your applications remotely.</span></span>

<span data-ttu-id="eaad0-105">Il diagramma seguente illustra in che modo Azure AD consente l'accesso remoto sicuro alle applicazioni locali.</span><span class="sxs-lookup"><span data-stu-id="eaad0-105">The following diagram shows how Azure AD enables secure remote access to your on-premises applications.</span></span>

 ![Diagramma dell'accesso remoto sicuro con il proxy applicazione di Azure AD](./media/application-proxy-security-considerations/secure-remote-access.png)

## <a name="security-benefits"></a><span data-ttu-id="eaad0-107">Vantaggi di sicurezza</span><span class="sxs-lookup"><span data-stu-id="eaad0-107">Security benefits</span></span>

<span data-ttu-id="eaad0-108">Il proxy applicazione di Azure AD offre i vantaggi di sicurezza seguenti:</span><span class="sxs-lookup"><span data-stu-id="eaad0-108">Azure AD Application Proxy offers the following security benefits:</span></span>

### <a name="authenticated-access"></a><span data-ttu-id="eaad0-109">Accesso autenticato</span><span class="sxs-lookup"><span data-stu-id="eaad0-109">Authenticated access</span></span> 

<span data-ttu-id="eaad0-110">Se si sceglie di usare la preautenticazione di Azure Active Directory, solo le connessioni autenticate possono accedere alla rete.</span><span class="sxs-lookup"><span data-stu-id="eaad0-110">If you choose to use Azure Active Directory preauthentication, then only authenticated connections can access your network.</span></span>

<span data-ttu-id="eaad0-111">Il proxy applicazione di Azure AD fa affidamento sul servizio token di sicurezza di Azure AD per tutta l'autenticazione.</span><span class="sxs-lookup"><span data-stu-id="eaad0-111">Azure AD Application Proxy relies on the Azure AD security token service (STS) for all authentication.</span></span>  <span data-ttu-id="eaad0-112">La preautenticazione, per sua natura, blocca un numero significativo di attacchi anonimi perché solo le identità autenticate possono accedere all'applicazione back-end.</span><span class="sxs-lookup"><span data-stu-id="eaad0-112">Preauthentication, by its very nature, blocks a significant number of anonymous attacks, because only authenticated identities can access the back-end application.</span></span>

<span data-ttu-id="eaad0-113">Se si sceglie Pass-through come metodo di preautenticazione, non si otterrà questo vantaggio.</span><span class="sxs-lookup"><span data-stu-id="eaad0-113">If you choose Passthrough as your preauthentication method, you don't get this benefit.</span></span> 

### <a name="conditional-access"></a><span data-ttu-id="eaad0-114">Accesso condizionale</span><span class="sxs-lookup"><span data-stu-id="eaad0-114">Conditional access</span></span>

<span data-ttu-id="eaad0-115">Applicare controlli dei criteri più completi prima che vengano stabilite connessioni alla rete.</span><span class="sxs-lookup"><span data-stu-id="eaad0-115">Apply richer policy controls before connections to your network are established.</span></span>

<span data-ttu-id="eaad0-116">Con l'[accesso condizionale](active-directory-conditional-access-azuread-connected-apps.md) è possibile definire restrizioni sul tipo di traffico che può accedere alle applicazioni back-end.</span><span class="sxs-lookup"><span data-stu-id="eaad0-116">With [conditional access](active-directory-conditional-access-azuread-connected-apps.md), you can define restrictions on what traffic is allowed to access your back-end applications.</span></span> <span data-ttu-id="eaad0-117">È possibile, ad esempio, creare criteri per definire restrizioni in base alla posizione, al livello di autenticazione e al profilo di rischio.</span><span class="sxs-lookup"><span data-stu-id="eaad0-117">You can create policies that restrict sign-ins based on location, strength of authentication, and user risk profile.</span></span>

<span data-ttu-id="eaad0-118">È possibile usare l'accesso condizionale anche per configurare criteri di autenticazione a più fattori e aggiungere così un altro livello di sicurezza alle autenticazioni utente.</span><span class="sxs-lookup"><span data-stu-id="eaad0-118">You can also use conditional access to configure Multi-Factor Authentication policies, adding another layer of security to your user authentications.</span></span> 

### <a name="traffic-termination"></a><span data-ttu-id="eaad0-119">Terminazione di traffico</span><span class="sxs-lookup"><span data-stu-id="eaad0-119">Traffic termination</span></span>

<span data-ttu-id="eaad0-120">Tutto il traffico viene terminato nel cloud.</span><span class="sxs-lookup"><span data-stu-id="eaad0-120">All traffic is terminated in the cloud.</span></span>

<span data-ttu-id="eaad0-121">Il proxy applicazione di Azure AD è un proxy inverso, quindi tutto il traffico verso le applicazioni back-end viene terminato nel servizio.</span><span class="sxs-lookup"><span data-stu-id="eaad0-121">Because Azure AD Application Proxy is a reverse-proxy, all traffic to back-end applications is terminated at the service.</span></span> <span data-ttu-id="eaad0-122">La sessione può essere ristabilita solo con il server back-end e ciò significa che i server back-end non sono esposti al traffico HTTP diretto.</span><span class="sxs-lookup"><span data-stu-id="eaad0-122">The session can get reestablished only with the back-end server, which means that your back-end servers are not exposed to direct HTTP traffic.</span></span> <span data-ttu-id="eaad0-123">Questa configurazione consente una protezione migliore da attacchi mirati.</span><span class="sxs-lookup"><span data-stu-id="eaad0-123">This configuration means that you are better protected from targeted attacks.</span></span>

### <a name="all-access-is-outbound"></a><span data-ttu-id="eaad0-124">Tutti gli accessi sono in uscita</span><span class="sxs-lookup"><span data-stu-id="eaad0-124">All access is outbound</span></span> 

<span data-ttu-id="eaad0-125">Non è necessario aprire alcuna connessione in ingresso nella rete aziendale.</span><span class="sxs-lookup"><span data-stu-id="eaad0-125">You don't need to open inbound connections to the corporate network.</span></span>

<span data-ttu-id="eaad0-126">I connettori proxy di applicazione usano solo connessioni in uscita per il servizio proxy di applicazione di Azure AD e, pertanto, non è necessario aprire le porte del firewall per le connessioni in ingresso.</span><span class="sxs-lookup"><span data-stu-id="eaad0-126">Application Proxy connectors only use outbound connections to the Azure AD Application Proxy service, which means that there is no need to open firewall ports for incoming connections.</span></span> <span data-ttu-id="eaad0-127">I proxy tradizionali richiedono una ***rete perimetrale***e consentono l'accesso a connessioni non autenticate al perimetro della rete.</span><span class="sxs-lookup"><span data-stu-id="eaad0-127">Traditional proxies required a perimeter network (also known as *DMZ*, *demilitarized zone*, or *screened subnet*) and allowed access to unauthenticated connections at the network edge.</span></span> <span data-ttu-id="eaad0-128">Questo scenario richiedeva molti altri investimenti in prodotti Web Application Firewall per analizzare il traffico e offrire protezione aggiuntiva all'ambiente.</span><span class="sxs-lookup"><span data-stu-id="eaad0-128">This scenario required many additional investments in web application firewall products to analyze traffic and offer addition protections to the environment.</span></span> <span data-ttu-id="eaad0-129">Con il proxy applicazione non è necessario disporre di una rete perimetrale perché tutte le connessioni sono in uscita e su un canale sicuro.</span><span class="sxs-lookup"><span data-stu-id="eaad0-129">With Application Proxy, you don't need a perimeter network because all connections are outbound and take place over a secure channel.</span></span>

<span data-ttu-id="eaad0-130">Per altre informazioni sui connettori, vedere [Understand Azure AD Application Proxy connectors](application-proxy-understand-connectors.md) (Informazioni sui connettori proxy di applicazione di Azure AD).</span><span class="sxs-lookup"><span data-stu-id="eaad0-130">For more information about connectors, see [Understand Azure AD Application Proxy connectors](application-proxy-understand-connectors.md).</span></span>

### <a name="cloud-scale-analytics-and-machine-learning"></a><span data-ttu-id="eaad0-131">Machine Learning e analisi di livello cloud</span><span class="sxs-lookup"><span data-stu-id="eaad0-131">Cloud-scale analytics and machine learning</span></span> 

<span data-ttu-id="eaad0-132">Ottenere una protezione all'avanguardia.</span><span class="sxs-lookup"><span data-stu-id="eaad0-132">Get cutting-edge security protection.</span></span>

<span data-ttu-id="eaad0-133">Facendo parte di Azure Active Directory, il proxy applicazione può sfruttare [Azure AD Identity Protection](active-directory-identityprotection.md) con intelligence basata su Machine Learning e feed di dati provenienti da Microsoft Security Response Center e dalla Digital Crimes Unit.</span><span class="sxs-lookup"><span data-stu-id="eaad0-133">Because it's part of Azure Active Directory, Application Proxy can leverage [Azure AD Identity Protection](active-directory-identityprotection.md), with machine learning-driven intelligence and data from the Microsoft Security Response Center and Digital Crimes Unit.</span></span> <span data-ttu-id="eaad0-134">Insieme identifichiamo in modo proattivo gli account compromessi e offriamo una protezione in tempo reale contro gli accessi ad alto rischio. Vengono presi in considerazione diversi fattori, ad esempio l'accesso da dispositivi infetti e tramite reti anonime, da posizioni atipiche e improbabili.</span><span class="sxs-lookup"><span data-stu-id="eaad0-134">Together we proactively identify compromised accounts and offer real-time protection from high-risk sign-ins. We take into account numerous factors, such as access from infected devices, through anonymizing networks, and from atypical and unlikely locations.</span></span>

<span data-ttu-id="eaad0-135">Molti di questi eventi e segnalazioni sono già disponibili tramite un'API per l'integrazione con i sistemi SIEM (Security Information and Event Management, Sistema di gestione delle informazioni e degli eventi di sicurezza).</span><span class="sxs-lookup"><span data-stu-id="eaad0-135">Many of these reports and events are already available through an API for integration with your security information and event management (SIEM) systems.</span></span>

### <a name="remote-access-as-a-service"></a><span data-ttu-id="eaad0-136">Accesso remoto come servizio</span><span class="sxs-lookup"><span data-stu-id="eaad0-136">Remote access as a service</span></span>

<span data-ttu-id="eaad0-137">Non è necessario preoccuparsi di mantenere e applicare patch ai server locali.</span><span class="sxs-lookup"><span data-stu-id="eaad0-137">You don’t have to worry about maintaining and patching on-premises servers.</span></span>

<span data-ttu-id="eaad0-138">Il software senza patch è tuttora responsabile di un numero elevato di attacchi.</span><span class="sxs-lookup"><span data-stu-id="eaad0-138">Unpatched software still accounts for a large number of attacks.</span></span> <span data-ttu-id="eaad0-139">Il proxy di applicazione di Azure AD è un servizio Internet di Microsoft e, quindi, sarà sempre possibile ottenere le patch di sicurezza e gli aggiornamenti più recenti.</span><span class="sxs-lookup"><span data-stu-id="eaad0-139">Azure AD Application Proxy is an Internet-scale service that Microsoft owns, so you always get the latest security patches and upgrades.</span></span>

<span data-ttu-id="eaad0-140">Per migliorare la sicurezza delle applicazioni pubblicate dal proxy applicazione di Azure AD, vengono bloccate l'indicizzazione e l'archiviazione delle applicazioni da parte dei robot dell'agente di ricerca Web.</span><span class="sxs-lookup"><span data-stu-id="eaad0-140">To improve the security of applications published by Azure AD Application Proxy, we block web crawler robots from indexing and archiving your applications.</span></span> <span data-ttu-id="eaad0-141">Ogni volta che un robot dell'agente di ricerca Web prova a recuperare le impostazioni dei robot per un'app pubblicata, il proxy applicazione risponde con un file robots.txt che include `User-agent: * Disallow: /`.</span><span class="sxs-lookup"><span data-stu-id="eaad0-141">Each time a web crawler robot tries to retrieve the robot's settings for a published app, Application Proxy replies with a robots.txt file that includes `User-agent: * Disallow: /`.</span></span>

## <a name="under-the-hood"></a><span data-ttu-id="eaad0-142">Dietro le quinte</span><span class="sxs-lookup"><span data-stu-id="eaad0-142">Under the hood</span></span>

<span data-ttu-id="eaad0-143">Il proxy applicazione di Azure AD è costituito da due parti:</span><span class="sxs-lookup"><span data-stu-id="eaad0-143">Azure AD Application Proxy consists of two parts:</span></span>

* <span data-ttu-id="eaad0-144">Servizio basato sul cloud: servizio eseguito in Azure in cui vengono stabilite le connessioni esterne client/utente.</span><span class="sxs-lookup"><span data-stu-id="eaad0-144">The cloud-based service: This service runs in Azure, and is where the external client/user connections are made.</span></span>
* <span data-ttu-id="eaad0-145">[Connettore locale](application-proxy-understand-connectors.md): componente locale in ascolto delle richieste provenienti dal servizio proxy di applicazione di Azure AD e in grado di gestire le connessioni alle applicazioni interne.</span><span class="sxs-lookup"><span data-stu-id="eaad0-145">[The on-premises connector](application-proxy-understand-connectors.md): An on-premises component, the connector listens for requests from the Azure AD Application Proxy service and handles connections to the internal applications.</span></span> 

<span data-ttu-id="eaad0-146">Un flusso tra il connettore e il servizio proxy applicazione viene stabilito quando:</span><span class="sxs-lookup"><span data-stu-id="eaad0-146">A flow between the connector and the Application Proxy service is established when:</span></span>

* <span data-ttu-id="eaad0-147">Il connettore viene configurato per la prima volta.</span><span class="sxs-lookup"><span data-stu-id="eaad0-147">The connector is first set up.</span></span>
* <span data-ttu-id="eaad0-148">Il connettore reperisce le informazioni di configurazione dal servizio proxy di applicazione.</span><span class="sxs-lookup"><span data-stu-id="eaad0-148">The connector pulls configuration information from the Application Proxy service.</span></span>
* <span data-ttu-id="eaad0-149">Un utente accede a un'applicazione pubblicata.</span><span class="sxs-lookup"><span data-stu-id="eaad0-149">A user accesses a published application.</span></span>

>[!NOTE]
><span data-ttu-id="eaad0-150">Tutte le comunicazioni si verificano su SSL e hanno sempre origine dal connettore verso il servizio proxy applicazione.</span><span class="sxs-lookup"><span data-stu-id="eaad0-150">All communications occur over SSL, and they always originate at the connector to the Application Proxy service.</span></span> <span data-ttu-id="eaad0-151">Il servizio è solo in uscita.</span><span class="sxs-lookup"><span data-stu-id="eaad0-151">The service is outbound only.</span></span>

<span data-ttu-id="eaad0-152">Il connettore usa un certificato client per l'autenticazione al servizio proxy applicazione per quasi tutte le chiamate.</span><span class="sxs-lookup"><span data-stu-id="eaad0-152">The connector uses a client certificate to authenticate to the Application Proxy service for nearly all calls.</span></span> <span data-ttu-id="eaad0-153">L'unica eccezione a questo processo è il passaggio di configurazione iniziale in cui viene stabilito il certificato client.</span><span class="sxs-lookup"><span data-stu-id="eaad0-153">The only exception to this process is the initial setup step, where the client certificate is established.</span></span>

### <a name="installing-the-connector"></a><span data-ttu-id="eaad0-154">Installazione del connettore</span><span class="sxs-lookup"><span data-stu-id="eaad0-154">Installing the connector</span></span>

<span data-ttu-id="eaad0-155">Quando il connettore viene configurato per la prima volta, si verificano gli eventi di flusso seguenti:</span><span class="sxs-lookup"><span data-stu-id="eaad0-155">When the connector is first set up, the following flow events take place:</span></span>

1. <span data-ttu-id="eaad0-156">La registrazione del connettore al servizio avviene durante l'installazione del connettore.</span><span class="sxs-lookup"><span data-stu-id="eaad0-156">The connector registration to the service happens as part of the installation of the connector.</span></span> <span data-ttu-id="eaad0-157">Agli utenti viene chiesto di immettere le credenziali di amministratore di Azure AD.</span><span class="sxs-lookup"><span data-stu-id="eaad0-157">Users are prompted to enter their Azure AD admin credentials.</span></span> <span data-ttu-id="eaad0-158">Il token acquisito dalla procedura di autenticazione viene quindi presentato al servizio proxy di applicazione di Azure AD.</span><span class="sxs-lookup"><span data-stu-id="eaad0-158">The token acquired from this authentication is then presented to the Azure AD Application Proxy service.</span></span>
2. <span data-ttu-id="eaad0-159">Il servizio proxy di applicazione valuta il token</span><span class="sxs-lookup"><span data-stu-id="eaad0-159">The Application Proxy service evaluates the token.</span></span> <span data-ttu-id="eaad0-160">per verificare che l'utente sia un amministratore aziendale nel tenant per cui è stato rilasciato il token.</span><span class="sxs-lookup"><span data-stu-id="eaad0-160">It ensures that the user is a company administrator within the tenant that the token was issued for.</span></span> <span data-ttu-id="eaad0-161">Se l'utente non è un amministratore, il processo viene terminato.</span><span class="sxs-lookup"><span data-stu-id="eaad0-161">If the user is not an administrator, the process is terminated.</span></span>
3. <span data-ttu-id="eaad0-162">Il connettore genera una richiesta di certificato client e la passa con il token al servizio proxy di applicazione,</span><span class="sxs-lookup"><span data-stu-id="eaad0-162">The connector generates a client certificate request and passes it, along with the token, to the Application Proxy service.</span></span> <span data-ttu-id="eaad0-163">che a sua volta verifica il token e firma la richiesta del certificato client.</span><span class="sxs-lookup"><span data-stu-id="eaad0-163">The service in turn verifies the token and signs the client certificate request.</span></span>
4. <span data-ttu-id="eaad0-164">Il connettore usa questo certificato client per la futura comunicazione con il servizio proxy applicazione.</span><span class="sxs-lookup"><span data-stu-id="eaad0-164">The connector uses the client certificate for future communication with the Application Proxy service.</span></span>
5. <span data-ttu-id="eaad0-165">Il connettore esegue un pull iniziale dei dati di configurazione del sistema dal servizio usando il certificato client ed è quindi pronto ad accettare le richieste.</span><span class="sxs-lookup"><span data-stu-id="eaad0-165">The connector performs an initial pull of the system configuration data from the service using its client certificate, and it is now ready to take requests.</span></span>

### <a name="updating-the-configuration-settings"></a><span data-ttu-id="eaad0-166">Aggiornamento delle impostazioni di configurazione</span><span class="sxs-lookup"><span data-stu-id="eaad0-166">Updating the configuration settings</span></span>

<span data-ttu-id="eaad0-167">Ogni volta che il servizio proxy applicazione aggiorna le impostazioni di configurazione, si verificano gli eventi di flusso seguenti:</span><span class="sxs-lookup"><span data-stu-id="eaad0-167">Whenever the Application Proxy service updates the configuration settings, the following flow events take place:</span></span>

1. <span data-ttu-id="eaad0-168">Il connettore si connette all'endpoint di configurazione all'interno del servizio proxy applicazione usando il suo certificato client.</span><span class="sxs-lookup"><span data-stu-id="eaad0-168">The connector connects to the configuration endpoint within the Application Proxy service by using its client certificate.</span></span>
2. <span data-ttu-id="eaad0-169">Dopo che il certificato client è stato convalidato, il servizio proxy applicazione restituisce i dati di configurazione al connettore, ad esempio il gruppo di connettori di cui il connettore deve far parte.</span><span class="sxs-lookup"><span data-stu-id="eaad0-169">After the client certificate has been validated, the Application Proxy service returns configuration data to the connector (for example, the connector group that the connector should be part of).</span></span>
3. <span data-ttu-id="eaad0-170">Se il certificato corrente ha più di 180 giorni, il connettore genera una nuova richiesta di certificato, aggiornando di fatto il certificato client ogni 180 giorni.</span><span class="sxs-lookup"><span data-stu-id="eaad0-170">If the current certificate is more than 180 days old, the connector generates a new certificate request, which effectively updates the client certificate every 180 days.</span></span>

### <a name="accessing-published-applications"></a><span data-ttu-id="eaad0-171">Accesso alle applicazioni pubblicate</span><span class="sxs-lookup"><span data-stu-id="eaad0-171">Accessing published applications</span></span>

<span data-ttu-id="eaad0-172">Quando gli utenti accedono a un'applicazione pubblicata, tra il servizio proxy di applicazione e il connettore del proxy di applicazione si verificano gli eventi seguenti:</span><span class="sxs-lookup"><span data-stu-id="eaad0-172">When users access a published application, the following events take place between the Application Proxy service and the Application Proxy connector:</span></span>

1. [<span data-ttu-id="eaad0-173">Il servizio autentica l'utente per l'app</span><span class="sxs-lookup"><span data-stu-id="eaad0-173">The service authenticates the user for the app</span></span>](#the-service-checks-the-configuration-settings-for-the-app)
2. [<span data-ttu-id="eaad0-174">Il servizio inserisce la richiesta nella coda del connettore</span><span class="sxs-lookup"><span data-stu-id="eaad0-174">The service places a request in the connector queue</span></span>](#The-service-places-a-request-in-the-connector-queue)
3. [<span data-ttu-id="eaad0-175">Un connettore elabora la richiesta ricevuta dalla coda</span><span class="sxs-lookup"><span data-stu-id="eaad0-175">A connector processes the request from the queue</span></span>](#the-connector-receives-the-request-from-the-queue)
4. [<span data-ttu-id="eaad0-176">Il connettore attende una risposta</span><span class="sxs-lookup"><span data-stu-id="eaad0-176">The connector waits for a response</span></span>](#the-connector-waits-for-a-response)
5. [<span data-ttu-id="eaad0-177">Il servizio invia i dati all'utente</span><span class="sxs-lookup"><span data-stu-id="eaad0-177">The service streams data to the user</span></span>](#the-service-streams-data-to-the-user)

<span data-ttu-id="eaad0-178">Per altre informazioni sugli eventi che si verificano in ognuno di questi passaggi, continuare la lettura.</span><span class="sxs-lookup"><span data-stu-id="eaad0-178">To learn more about what takes place in each of these steps, keep reading.</span></span>


#### <a name="1-the-service-authenticates-the-user-for-the-app"></a><span data-ttu-id="eaad0-179">1. Il servizio autentica l'utente per l'app</span><span class="sxs-lookup"><span data-stu-id="eaad0-179">1. The service authenticates the user for the app</span></span>

<span data-ttu-id="eaad0-180">Se l'app è configurata per l'utilizzo di PassThrough come metodo di autenticazione, gli eventi descritti in questa sezione non si verificano.</span><span class="sxs-lookup"><span data-stu-id="eaad0-180">If you configured the app to use Passthrough as its preauthentication method, the steps in this section are skipped.</span></span>

<span data-ttu-id="eaad0-181">Se l'app è configurata per eseguire la pre-autenticazione con Azure AD, l'utente viene reindirizzato al servizio token di sicurezza di Azure AD per eseguire l'autenticazione e si verificano gli eventi seguenti:</span><span class="sxs-lookup"><span data-stu-id="eaad0-181">If you configured the app to preauthenticate with Azure AD, users are redirected to the Azure AD STS to authenticate, and the following steps take place:</span></span>

1. <span data-ttu-id="eaad0-182">Il proxy applicazione verifica gli eventuali requisiti dei criteri di accesso condizionale per l'applicazione specifica.</span><span class="sxs-lookup"><span data-stu-id="eaad0-182">Application Proxy checks for any conditional access policy requirements for the specific application.</span></span> <span data-ttu-id="eaad0-183">Questo passaggio verifica che l'utente sia stato assegnato all'applicazione.</span><span class="sxs-lookup"><span data-stu-id="eaad0-183">This step ensures that the user has been assigned to the application.</span></span> <span data-ttu-id="eaad0-184">Se è necessaria la verifica in due passaggi, la sequenza di autenticazione richiede all'utente di usare un secondo metodo di autenticazione.</span><span class="sxs-lookup"><span data-stu-id="eaad0-184">If two-step verification is required, the authentication sequence prompts the user for a second authentication method.</span></span>

2. <span data-ttu-id="eaad0-185">Dopo avere superato tutti i controlli, il servizio token di sicurezza di Azure AD rilascia un token firmato per l'applicazione e l'utente viene reindirizzato al servizio proxy applicazione.</span><span class="sxs-lookup"><span data-stu-id="eaad0-185">After all checks have passed, the Azure AD STS issues a signed token for the application and redirects the user back to the Application Proxy service.</span></span>

3. <span data-ttu-id="eaad0-186">Il proxy applicazione verifica che il token sia stato rilasciato per correggere l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="eaad0-186">Application Proxy verifies that the token was issued to correct the application.</span></span> <span data-ttu-id="eaad0-187">Vengono eseguiti anche altri controlli, come verificare che il token sia stato firmato da Azure AD e si trovi ancora nella finestra valida.</span><span class="sxs-lookup"><span data-stu-id="eaad0-187">It performs other checks also, such as ensuring that the token was signed by Azure AD, and that it is still within the valid window.</span></span>

4. <span data-ttu-id="eaad0-188">Il proxy applicazione imposta un cookie di autenticazione crittografato per indicare che l'autenticazione all'applicazione è stata completata.</span><span class="sxs-lookup"><span data-stu-id="eaad0-188">Application Proxy sets an encrypted authentication cookie to indicate that authentication to the application has occurred.</span></span> <span data-ttu-id="eaad0-189">Questo cookie include un timestamp di scadenza basato sul token di Azure AD e su altri dati, ad esempio il nome utente su cui si basa l'autenticazione.</span><span class="sxs-lookup"><span data-stu-id="eaad0-189">The cookie includes an expiration timestamp that's based on the token from Azure AD and other data, such as the user name that the authentication is based on.</span></span> <span data-ttu-id="eaad0-190">Questo cookie viene crittografato con una chiave privata nota solo al servizio proxy applicazione.</span><span class="sxs-lookup"><span data-stu-id="eaad0-190">The cookie is encrypted with a private key known only to the Application Proxy service.</span></span>

5. <span data-ttu-id="eaad0-191">Il proxy applicazione reindirizza l'utente all'URL originariamente richiesto.</span><span class="sxs-lookup"><span data-stu-id="eaad0-191">Application Proxy redirects the user back to the originally requested URL.</span></span>

<span data-ttu-id="eaad0-192">Se qualsiasi parte dei passaggi di preautenticazione non ha esito positivo, la richiesta dell'utente viene negata e viene visualizzato un messaggio che indica l'origine del problema.</span><span class="sxs-lookup"><span data-stu-id="eaad0-192">If any part of the preauthentication steps fails, the user’s request is denied, and the user is shown a message indicating the source of the problem.</span></span>


#### <a name="2-the-service-places-a-request-in-the-connector-queue"></a><span data-ttu-id="eaad0-193">2. Il servizio inserisce la richiesta nella coda del connettore</span><span class="sxs-lookup"><span data-stu-id="eaad0-193">2. The service places a request in the connector queue</span></span>

<span data-ttu-id="eaad0-194">I connettori mantengono aperta una connessione in uscita diretta al servizio proxy di applicazione.</span><span class="sxs-lookup"><span data-stu-id="eaad0-194">Connectors keep an outbound connection open to the Application Proxy service.</span></span> <span data-ttu-id="eaad0-195">Quando viene ricevuta una richiesta, il sevizio la mette in coda su una delle connessioni aperte affinché il connettore la accetti.</span><span class="sxs-lookup"><span data-stu-id="eaad0-195">When a request comes in, the service queues up the request on one of the open connections for the connector to pick up.</span></span>

<span data-ttu-id="eaad0-196">La richiesta include elementi dell'applicazione, come le intestazioni della richiesta e i dati del cookie crittografato, l'utente che effettua la richiesta e l'ID richiesta.</span><span class="sxs-lookup"><span data-stu-id="eaad0-196">The request includes items from the application, such as the request headers, data from the encrypted cookie, the user making the request, and the request ID.</span></span> <span data-ttu-id="eaad0-197">Con la richiesta vengono inviati i dati del cookie crittografato, non il cookie di autenticazione.</span><span class="sxs-lookup"><span data-stu-id="eaad0-197">Although data from the encrypted cookie is sent with the request, the authentication cookie itself is not.</span></span>

#### <a name="3-the-connector-processes-the-request-from-the-queue"></a><span data-ttu-id="eaad0-198">3. Il connettore elabora la richiesta ricevuta dalla coda.</span><span class="sxs-lookup"><span data-stu-id="eaad0-198">3. The connector processes the request from the queue.</span></span> 

<span data-ttu-id="eaad0-199">A seconda della richiesta, il proxy applicazione eseguirà una delle azioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="eaad0-199">Based on the request, Application Proxy performs one of the following actions:</span></span>

* <span data-ttu-id="eaad0-200">Se la richiesta è un'operazione semplice, ad esempio non sono presenti dati all'interno del corpo come avviene in una richiesta RESTful *GET*, il connettore esegue una connessione alla risorsa interna di destinazione e attende una risposta.</span><span class="sxs-lookup"><span data-stu-id="eaad0-200">If the request is a simple operation (for example, there is no data within the body as is with a RESTful *GET* request), the connector makes a connection to the target internal resource and then waits for a response.</span></span>

* <span data-ttu-id="eaad0-201">Se la richiesta contiene dati associati nel corpo, ad esempio un'operazione RESTful *POST*, il connettore esegue una connessione in uscita usando il certificato client verso l'istanza del proxy applicazione.</span><span class="sxs-lookup"><span data-stu-id="eaad0-201">If the request has data associated with it in the body (for example, a RESTful *POST* operation), the connector makes an outbound connection by using the client certificate to the Application Proxy instance.</span></span> <span data-ttu-id="eaad0-202">Esegue questa connessione per richiedere i dati e aprire una connessione alla risorsa interna.</span><span class="sxs-lookup"><span data-stu-id="eaad0-202">It makes this connection to request the data and open a connection to the internal resource.</span></span> <span data-ttu-id="eaad0-203">Dopo la ricezione della richiesta dal connettore, il servizio proxy applicazione inizia ad accettare contenuto dall'utente e inoltra i dati al connettore.</span><span class="sxs-lookup"><span data-stu-id="eaad0-203">After it receives the request from the connector, the Application Proxy service begins accepting content from the user and forwards data to the connector.</span></span> <span data-ttu-id="eaad0-204">Il connettore, a sua volta, inoltra i dati alla risorsa interna.</span><span class="sxs-lookup"><span data-stu-id="eaad0-204">The connector, in turn, forwards the data to the internal resource.</span></span>

#### <a name="4-the-connector-waits-for-a-response"></a><span data-ttu-id="eaad0-205">4. Il connettore attende una risposta.</span><span class="sxs-lookup"><span data-stu-id="eaad0-205">4. The connector waits for a response.</span></span>

<span data-ttu-id="eaad0-206">Dopo aver completato la richiesta e la trasmissione di tutto il contenuto al back-end, il connettore attende una risposta.</span><span class="sxs-lookup"><span data-stu-id="eaad0-206">After the request and transmission of all content to the back end is complete, the connector waits for a response.</span></span>

<span data-ttu-id="eaad0-207">Dopo aver ricevuto la risposta, il connettore esegue una connessione in uscita al servizio proxy applicazione per restituire i dettagli dell'intestazione e avviare il flusso dei dati restituiti.</span><span class="sxs-lookup"><span data-stu-id="eaad0-207">After it receives a response, the connector makes an outbound connection to the Application Proxy service, to return the header details and begin streaming the return data.</span></span>

#### <a name="5-the-service-streams-data-to-the-user"></a><span data-ttu-id="eaad0-208">5. Il servizio invia i dati all'utente.</span><span class="sxs-lookup"><span data-stu-id="eaad0-208">5. The service streams data to the user.</span></span> 

<span data-ttu-id="eaad0-209">In questa fase è possibile che vengano eseguite alcune operazioni di elaborazione dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="eaad0-209">Some processing of the application may occur here.</span></span> <span data-ttu-id="eaad0-210">Se è il proxy di applicazione è stato configurato in modo da convertire le intestazioni o gli URL nell'applicazione, in questa fase vengono eseguite tutte le operazioni di elaborazione necessarie.</span><span class="sxs-lookup"><span data-stu-id="eaad0-210">If you configured Application Proxy to translate headers or URLs in your application, that processing happens as needed during this step.</span></span>


## <a name="next-steps"></a><span data-ttu-id="eaad0-211">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="eaad0-211">Next steps</span></span>

[<span data-ttu-id="eaad0-212">Considerazioni relative alla topologia di rete quando si usa il proxy applicazione di Azure AD</span><span class="sxs-lookup"><span data-stu-id="eaad0-212">Network topology considerations when using Azure AD Application Proxy</span></span>](application-proxy-network-topology-considerations.md)

[<span data-ttu-id="eaad0-213">Comprendere i connettori del proxy applicazione di Azure AD</span><span class="sxs-lookup"><span data-stu-id="eaad0-213">Understand Azure AD Application Proxy connectors</span></span>](application-proxy-understand-connectors.md)
