---
title: sign-on aaaSingle con Proxy dell'applicazione | Documenti Microsoft
description: Descrive come tooprovide single sign-on con Proxy dell'applicazione AD Azure.
services: active-directory
documentationcenter: 
author: kgremban
manager: femila
ms.assetid: ded0d9c9-45f6-47d7-bd0f-3f7fd99ab621
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/25/2017
ms.author: kgremban
ms.reviewer: harshja
ms.custom: H1Hack27Feb2017, it-pro
ms.openlocfilehash: 0047e834cd42e057a75ebc0c5dcf860734464a05
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/06/2017
---
# <a name="kerberos-constrained-delegation-for-single-sign-on-tooyour-apps-with-application-proxy"></a><span data-ttu-id="75f88-103">Delega vincolata Kerberos per le applicazioni single sign-on tooyour con Proxy dell'applicazione</span><span class="sxs-lookup"><span data-stu-id="75f88-103">Kerberos Constrained Delegation for single sign-on tooyour apps with Application Proxy</span></span>

<span data-ttu-id="75f88-104">È possibile fornire l'accesso single sign-on per le applicazioni locali pubblicate mediante il proxy di applicazione che sono protette con l'autenticazione integrata di Windows.</span><span class="sxs-lookup"><span data-stu-id="75f88-104">You can provide single sign-on for on-premises applications published through Application Proxy that are secured with Integrated Windows Authentication.</span></span> <span data-ttu-id="75f88-105">Queste applicazioni richiedono un ticket Kerberos per l'accesso.</span><span class="sxs-lookup"><span data-stu-id="75f88-105">These applications require a Kerberos ticket for access.</span></span> <span data-ttu-id="75f88-106">Proxy dell'applicazione utilizza la delega vincolata Kerberos (KCD) toosupport queste applicazioni.</span><span class="sxs-lookup"><span data-stu-id="75f88-106">Application Proxy uses Kerberos Constrained Delegation (KCD) toosupport these applications.</span></span> 

<span data-ttu-id="75f88-107">È possibile abilitare single sign-on tooyour applicazioni utilizzando l'autenticazione integrata di Windows (IWA) assegnando autorizzazioni di connettori Proxy di applicazione in Active Directory tooimpersonate users.</span><span class="sxs-lookup"><span data-stu-id="75f88-107">You can enable single sign-on tooyour applications using Integrated Windows Authentication (IWA) by giving Application Proxy connectors permission in Active Directory tooimpersonate users.</span></span> <span data-ttu-id="75f88-108">connettori Hello utilizzano toosend questa autorizzazione e ricevano i token per loro conto.</span><span class="sxs-lookup"><span data-stu-id="75f88-108">hello connectors use this permission toosend and receive tokens on their behalf.</span></span>

## <a name="how-single-sign-on-with-kcd-works"></a><span data-ttu-id="75f88-109">Funzionamento di Single Sign-On con KCD</span><span class="sxs-lookup"><span data-stu-id="75f88-109">How single sign-on with KCD works</span></span>
<span data-ttu-id="75f88-110">Questo diagramma illustra il flusso di hello quando un utente tenta di tooaccess un'applicazione locale che utilizza l'autenticazione integrata di Windows.</span><span class="sxs-lookup"><span data-stu-id="75f88-110">This diagram explains hello flow when a user attempts tooaccess an on-prem application that uses IWA.</span></span>

![Diagramma del flusso di autenticazione di Microsoft AAD](./media/active-directory-application-proxy-sso-using-kcd/AuthDiagram.png)

1. <span data-ttu-id="75f88-112">utente Hello entra in un'applicazione hello URL tooaccess hello locale mediante il Proxy di applicazione.</span><span class="sxs-lookup"><span data-stu-id="75f88-112">hello user enters hello URL tooaccess hello on-prem application through Application Proxy.</span></span>
2. <span data-ttu-id="75f88-113">Proxy applicazione reindirizza hello richiesta tooAzure AD autenticazione servizi toopreauthenticate.</span><span class="sxs-lookup"><span data-stu-id="75f88-113">Application Proxy redirects hello request tooAzure AD authentication services toopreauthenticate.</span></span> <span data-ttu-id="75f88-114">A questo punto, Azure AD applica gli eventuali criteri di autenticazione e autorizzazione appropriati, ad esempio l'autenticazione a più fattori.</span><span class="sxs-lookup"><span data-stu-id="75f88-114">At this point, Azure AD applies any applicable authentication and authorization policies, such as multifactor authentication.</span></span> <span data-ttu-id="75f88-115">Se l'utente hello viene convalidata, Azure AD crea un token e lo invia toohello utente.</span><span class="sxs-lookup"><span data-stu-id="75f88-115">If hello user is validated, Azure AD creates a token and sends it toohello user.</span></span>
3. <span data-ttu-id="75f88-116">utente Hello passa hello token tooApplication Proxy.</span><span class="sxs-lookup"><span data-stu-id="75f88-116">hello user passes hello token tooApplication Proxy.</span></span>
4. <span data-ttu-id="75f88-117">Proxy dell'applicazione convalida il token di hello recupera hello del nome dell'entità utente (UPN) da esso e quindi Invia richiesta hello hello UPN e hello del nome dell'entità servizio (SPN) toohello connettore tramite un canale protetto doppiamente autenticato.</span><span class="sxs-lookup"><span data-stu-id="75f88-117">Application Proxy validates hello token and retrieves hello User Principal Name (UPN) from it, and then sends hello request, hello UPN, and hello Service Principal Name (SPN) toohello Connector through a dually authenticated secure channel.</span></span>
5. <span data-ttu-id="75f88-118">Hello connettore esegue la negoziazione di delega vincolata Kerberos (KCD) con hello locale AD, rappresentazione hello utente tooget un'applicazione toohello token Kerberos.</span><span class="sxs-lookup"><span data-stu-id="75f88-118">hello Connector performs Kerberos Constrained Delegation (KCD) negotiation with hello on-prem AD, impersonating hello user tooget a Kerberos token toohello application.</span></span>
6. <span data-ttu-id="75f88-119">Active Directory invia il token Kerberos hello per toohello applicazione hello connettore.</span><span class="sxs-lookup"><span data-stu-id="75f88-119">Active Directory sends hello Kerberos token for hello application toohello Connector.</span></span>
7. <span data-ttu-id="75f88-120">Hello connettore invia hello originale richiesta toohello server applicazioni, utilizzando token Kerberos hello ricevuto da Active Directory.</span><span class="sxs-lookup"><span data-stu-id="75f88-120">hello Connector sends hello original request toohello application server, using hello Kerberos token it received from AD.</span></span>
8. <span data-ttu-id="75f88-121">un'applicazione Hello invia hello risposta toohello connettore, che viene quindi restituito al servizio Proxy applicazione toohello e infine toohello utente.</span><span class="sxs-lookup"><span data-stu-id="75f88-121">hello application sends hello response toohello Connector, which is then returned toohello Application Proxy service and finally toohello user.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="75f88-122">Prerequisiti</span><span class="sxs-lookup"><span data-stu-id="75f88-122">Prerequisites</span></span>
<span data-ttu-id="75f88-123">Prima di iniziare a usare single sign-on per applicazioni di autenticazione integrata di Windows, assicurarsi che l'ambiente è pronto con hello seguenti configurazioni e impostazioni:</span><span class="sxs-lookup"><span data-stu-id="75f88-123">Before you get started with single sign-on for IWA applications, make sure your environment is ready with hello following settings and configurations:</span></span>

* <span data-ttu-id="75f88-124">Le app come App Web di SharePoint, vengono impostate toouse autenticazione integrata di Windows.</span><span class="sxs-lookup"><span data-stu-id="75f88-124">Your apps, like SharePoint Web apps, are set toouse Integrated Windows Authentication.</span></span> <span data-ttu-id="75f88-125">Per altre informazioni, vedere [Attivare il supporto per l'autenticazione Kerberos](https://technet.microsoft.com/library/dd759186.aspx). Per SharePoint, vedere [Pianificare l'autenticazione Kerberos in SharePoint 2013](https://technet.microsoft.com/library/ee806870.aspx).</span><span class="sxs-lookup"><span data-stu-id="75f88-125">For more information, see [Enable Support for Kerberos Authentication](https://technet.microsoft.com/library/dd759186.aspx), or for SharePoint see [Plan for Kerberos authentication in SharePoint 2013](https://technet.microsoft.com/library/ee806870.aspx).</span></span>
* <span data-ttu-id="75f88-126">Tutte le app devono avere [nomi delle entità servizio](https://social.technet.microsoft.com/wiki/contents/articles/717.service-principal-names-spns-setspn-syntax-setspn-exe.aspx).</span><span class="sxs-lookup"><span data-stu-id="75f88-126">All your apps have [Service Principal Names](https://social.technet.microsoft.com/wiki/contents/articles/717.service-principal-names-spns-setspn-syntax-setspn-exe.aspx).</span></span>
* <span data-ttu-id="75f88-127">in esecuzione sul server Hello: hello connettore e server hello esecuzione applicazione hello vengono aggiunti a un dominio e parte di hello stesso dominio o in domini trusting.</span><span class="sxs-lookup"><span data-stu-id="75f88-127">hello server running hello Connector and hello server running hello app are domain joined and part of hello same domain or trusting domains.</span></span> <span data-ttu-id="75f88-128">Per ulteriori informazioni sull'aggiunta a un dominio, vedere [partecipare a un dominio di tooa Computer](https://technet.microsoft.com/library/dd807102.aspx).</span><span class="sxs-lookup"><span data-stu-id="75f88-128">For more information on domain join, see [Join a Computer tooa Domain](https://technet.microsoft.com/library/dd807102.aspx).</span></span>
* <span data-ttu-id="75f88-129">server Hello in esecuzione hello connettore ha attributo hello TokenGroupsGlobalAndUniversal tooread di accesso per gli utenti.</span><span class="sxs-lookup"><span data-stu-id="75f88-129">hello server running hello Connector has access tooread hello TokenGroupsGlobalAndUniversal attribute for users.</span></span> <span data-ttu-id="75f88-130">Questa impostazione potrebbe sono stata influita dall'ambiente hello di protezione.</span><span class="sxs-lookup"><span data-stu-id="75f88-130">This default setting might have been impacted by security hardening hello environment.</span></span>

### <a name="configure-active-directory"></a><span data-ttu-id="75f88-131">Configurare Active Directory</span><span class="sxs-lookup"><span data-stu-id="75f88-131">Configure Active Directory</span></span>
<span data-ttu-id="75f88-132">configurazione di Active Directory Hello varia a seconda che il connettore Proxy dell'applicazione e il server di applicazioni hello vengano hello nello stesso dominio o non.</span><span class="sxs-lookup"><span data-stu-id="75f88-132">hello Active Directory configuration varies, depending on whether your Application Proxy connector and hello application server are in hello same domain or not.</span></span>

#### <a name="connector-and-application-server-in-hello-same-domain"></a><span data-ttu-id="75f88-133">Connettore e server applicazioni in hello nello stesso dominio</span><span class="sxs-lookup"><span data-stu-id="75f88-133">Connector and application server in hello same domain</span></span>
1. <span data-ttu-id="75f88-134">In Active Directory passare troppo**strumenti** > **utenti e computer**.</span><span class="sxs-lookup"><span data-stu-id="75f88-134">In Active Directory, go too**Tools** > **Users and Computers**.</span></span>
2. <span data-ttu-id="75f88-135">Selezionare hello server che esegue il connettore di hello.</span><span class="sxs-lookup"><span data-stu-id="75f88-135">Select hello server running hello connector.</span></span>
3. <span data-ttu-id="75f88-136">Fare clic con il pulsante destro del mouse su **Proprietà** > **Delega**.</span><span class="sxs-lookup"><span data-stu-id="75f88-136">Right-click and select **Properties** > **Delegation**.</span></span>
4. <span data-ttu-id="75f88-137">Selezionare **computer attendibile per i servizi solo di delega toospecified**.</span><span class="sxs-lookup"><span data-stu-id="75f88-137">Select **Trust this computer for delegation toospecified services only**.</span></span> 
5. <span data-ttu-id="75f88-138">In **toowhich servizi questo account può presentare credenziali delegate** aggiungere valore hello per un'identità SPN del server applicazioni hello hello.</span><span class="sxs-lookup"><span data-stu-id="75f88-138">Under **Services toowhich this account can present delegated credentials** add hello value for hello SPN identity of hello application server.</span></span> <span data-ttu-id="75f88-139">Ciò consente agli utenti di tooimpersonate connettore Proxy dell'applicazione di hello in Active Directory in base ad applicazioni hello definite nell'elenco di hello.</span><span class="sxs-lookup"><span data-stu-id="75f88-139">This enables hello Application Proxy Connector tooimpersonate users in AD against hello applications defined in hello list.</span></span>

   ![Schermata della finestra delle proprietà per Connector-SVR](./media/active-directory-application-proxy-sso-using-kcd/Properties.jpg)

#### <a name="connector-and-application-server-in-different-domains"></a><span data-ttu-id="75f88-141">Connettore e server applicazione in domini differenti</span><span class="sxs-lookup"><span data-stu-id="75f88-141">Connector and application server in different domains</span></span>
1. <span data-ttu-id="75f88-142">Per un elenco dei prerequisiti necessari per usare la delega vincolata Kerberos tra domini, vedere [Delega vincolata Kerberos tra domini](https://technet.microsoft.com/library/hh831477.aspx).</span><span class="sxs-lookup"><span data-stu-id="75f88-142">For a list of prerequisites for working with KCD across domains, see [Kerberos Constrained Delegation across domains](https://technet.microsoft.com/library/hh831477.aspx).</span></span>
2. <span data-ttu-id="75f88-143">Hello utilizzare `principalsallowedtodelegateto` proprietà hello connettore server tooenable hello Proxy dell'applicazione toodelegate per i server del connettore hello.</span><span class="sxs-lookup"><span data-stu-id="75f88-143">Use hello `principalsallowedtodelegateto` property on hello Connector server tooenable hello Application Proxy toodelegate for hello Connector server.</span></span> <span data-ttu-id="75f88-144">server applicazioni Hello è `sharepointserviceaccount` e hello delega server `connectormachineaccount`.</span><span class="sxs-lookup"><span data-stu-id="75f88-144">hello application server is `sharepointserviceaccount` and hello delegating server is `connectormachineaccount`.</span></span> <span data-ttu-id="75f88-145">Per Windows 2012 R2, usare questo codice come esempio:</span><span class="sxs-lookup"><span data-stu-id="75f88-145">For Windows 2012 R2, use this code as an example:</span></span>

        $connector= Get-ADComputer -Identity connectormachineaccount -server dc.connectordomain.com

        Set-ADComputer -Identity sharepointserviceaccount -PrincipalsAllowedToDelegateToAccount $connector

        Get-ADComputer sharepointserviceaccount -Properties PrincipalsAllowedToDelegateToAccount

<span data-ttu-id="75f88-146">È possibile Sharepointserviceaccount account di computer SPS hello o un account di servizio quali hello SPS pool di applicazioni per l'esecuzione.</span><span class="sxs-lookup"><span data-stu-id="75f88-146">Sharepointserviceaccount can be hello SPS machine account or a service account under which hello SPS app pool is running.</span></span>

## <a name="configure-single-sign-on"></a><span data-ttu-id="75f88-147">Configura accesso Single Sign-On</span><span class="sxs-lookup"><span data-stu-id="75f88-147">Configure single sign-on</span></span> 
1. <span data-ttu-id="75f88-148">Pubblicare l'applicazione in base a istruzioni toohello [pubblicare applicazioni con Proxy dell'applicazione](application-proxy-publish-azure-portal.md).</span><span class="sxs-lookup"><span data-stu-id="75f88-148">Publish your application according toohello instructions described in [Publish applications with Application Proxy](application-proxy-publish-azure-portal.md).</span></span> <span data-ttu-id="75f88-149">Verificare che tooselect **Azure Active Directory** come hello **metodo di preautenticazione**.</span><span class="sxs-lookup"><span data-stu-id="75f88-149">Make sure tooselect **Azure Active Directory** as hello **Preauthentication Method**.</span></span>
2. <span data-ttu-id="75f88-150">Dopo l'applicazione viene visualizzata nell'elenco di hello di applicazioni aziendali, selezionarla e fare clic su **Single sign-on**.</span><span class="sxs-lookup"><span data-stu-id="75f88-150">After your application appears in hello list of enterprise applications, select it and click **Single sign-on**.</span></span>
3. <span data-ttu-id="75f88-151">Impostare modalità hello single sign-on troppo**autenticazione integrata di Windows**.</span><span class="sxs-lookup"><span data-stu-id="75f88-151">Set hello single sign-on mode too**Integrated Windows Authentication**.</span></span>  
4. <span data-ttu-id="75f88-152">Immettere hello **SPN applicazione interna** hello server delle applicazioni.</span><span class="sxs-lookup"><span data-stu-id="75f88-152">Enter hello **Internal Application SPN** of hello application server.</span></span> <span data-ttu-id="75f88-153">In questo esempio, hello SPN per l'applicazione pubblicata è http/www.contoso.com. Questo toobe esigenze SPN nell'elenco di hello del connettore di servizi toowhich hello può presentare credenziali delegate.</span><span class="sxs-lookup"><span data-stu-id="75f88-153">In this example, hello SPN for our published application is http/www.contoso.com. This SPN needs toobe in hello list of services toowhich hello connector can present delegated credentials.</span></span> 
5. <span data-ttu-id="75f88-154">Scegliere hello **delega di identità di account di accesso** per hello connettore toouse per conto degli utenti.</span><span class="sxs-lookup"><span data-stu-id="75f88-154">Choose hello **Delegated Login Identity** for hello connector toouse on behalf of your users.</span></span> <span data-ttu-id="75f88-155">Per altre informazioni, vedere [Utilizzo dell'accesso Single Sign-On quando le identità cloud e locali non sono identiche](#Working-with-different-on-premises-and-cloud-identities)</span><span class="sxs-lookup"><span data-stu-id="75f88-155">For more information, see [Working with different on-premises and cloud identities](#Working-with-different-on-premises-and-cloud-identities)</span></span>

   ![Configurazione avanzata dell'applicazione](./media/active-directory-application-proxy-sso-using-kcd/cwap_auth2.png)  


## <a name="sso-for-non-windows-apps"></a><span data-ttu-id="75f88-157">Accesso Single Sign-On per app non Windows</span><span class="sxs-lookup"><span data-stu-id="75f88-157">SSO for non-Windows apps</span></span>
<span data-ttu-id="75f88-158">Hello flusso delega Kerberos nel Proxy dell'applicazione Azure Active Directory viene avviata quando Azure AD autentica l'utente hello nel cloud hello.</span><span class="sxs-lookup"><span data-stu-id="75f88-158">hello Kerberos delegation flow in Azure AD Application Proxy starts when Azure AD authenticates hello user in hello cloud.</span></span> <span data-ttu-id="75f88-159">Una volta richiesta hello arriva in locale, hello connector rilascia un ticket Kerberos per conto di utente hello interagendo con un Proxy di applicazione AD Azure hello Active Directory locale.</span><span class="sxs-lookup"><span data-stu-id="75f88-159">Once hello request arrives on-premises, hello Azure AD Application Proxy connector issues a Kerberos ticket on behalf of hello user by interacting with hello local Active Directory.</span></span> <span data-ttu-id="75f88-160">Questo processo è noto tooas delega vincolata Kerberos (KCD).</span><span class="sxs-lookup"><span data-stu-id="75f88-160">This process is referred tooas Kerberos Constrained Delegation (KCD).</span></span> <span data-ttu-id="75f88-161">In hello fase successiva, viene inviata una richiesta applicazione back-end toohello con il ticket Kerberos.</span><span class="sxs-lookup"><span data-stu-id="75f88-161">In hello next phase, a request is sent toohello backend application with this Kerberos ticket.</span></span> <span data-ttu-id="75f88-162">Esistono diversi protocolli che definiscono come toosend tali richieste.</span><span class="sxs-lookup"><span data-stu-id="75f88-162">There are several protocols that define how toosend such requests.</span></span> <span data-ttu-id="75f88-163">La maggior parte dei server non Windows prevede l'uso del protocollo Negotiate/SPNego, al momento supportato nel proxy di applicazione di Azure AD.</span><span class="sxs-lookup"><span data-stu-id="75f88-163">Most non-Windows servers expect Negotiate/SPNego that is now supported on Azure AD Application Proxy.</span></span>

<span data-ttu-id="75f88-164">Per ulteriori informazioni su Kerberos, vedere [si desidera tooknow sulla delega vincolata Kerberos (KCD)](https://blogs.technet.microsoft.com/applicationproxyblog/2015/09/21/all-you-want-to-know-about-kerberos-constrained-delegation-kcd).</span><span class="sxs-lookup"><span data-stu-id="75f88-164">For more information about Kerberos, see [All you want tooknow about Kerberos Constrained Delegation (KCD)](https://blogs.technet.microsoft.com/applicationproxyblog/2015/09/21/all-you-want-to-know-about-kerberos-constrained-delegation-kcd).</span></span>

<span data-ttu-id="75f88-165">Le app non Windows usano generalmente nomi utente o nomi account SAM invece di indirizzi e-mail di dominio.</span><span class="sxs-lookup"><span data-stu-id="75f88-165">Non-Windows apps typically user usernames or SAM account names instead of domain email addresses.</span></span> <span data-ttu-id="75f88-166">Se questa situazione si applica tooyour applicazioni, è necessario tooconfigure hello delegato accesso identità campo tooconnect delle identità di applicazione tooyour identità cloud.</span><span class="sxs-lookup"><span data-stu-id="75f88-166">If that situation applies tooyour applications, you need tooconfigure hello delegated login identity field tooconnect your cloud identities tooyour application identities.</span></span> 

## <a name="working-with-different-on-premises-and-cloud-identities"></a><span data-ttu-id="75f88-167">Utilizzo dell'accesso Single Sign-On quando le identità cloud e locali non sono identiche</span><span class="sxs-lookup"><span data-stu-id="75f88-167">Working with different on-premises and cloud identities</span></span>
<span data-ttu-id="75f88-168">Proxy dell'applicazione si presuppone che gli utenti abbiano esattamente hello stessa identità cloud hello e locale.</span><span class="sxs-lookup"><span data-stu-id="75f88-168">Application Proxy assumes that users have exactly hello same identity in hello cloud and on-premises.</span></span> <span data-ttu-id="75f88-169">Se non è questo caso di hello, può comunque utilizzare la delega vincolata Kerberos per single sign-on.</span><span class="sxs-lookup"><span data-stu-id="75f88-169">If that's not hello case, you can can still use KCD for single sign-on.</span></span> <span data-ttu-id="75f88-170">Configurare un **delega di identità di account di accesso** per ogni applicazione toospecify identità deve essere utilizzato quando si esegue l'accesso single sign-on.</span><span class="sxs-lookup"><span data-stu-id="75f88-170">Configure a **Delegated login identity** for each application toospecify which identity should be used when performing single sign-on.</span></span>  

<span data-ttu-id="75f88-171">Questa funzionalità consente di molte organizzazioni che dispone di diversi in locale e cloud identità toohave SSO da app di hello cloud tooon locale senza richiedere hello utenti tooenter diversi Gestione nomi utente e password.</span><span class="sxs-lookup"><span data-stu-id="75f88-171">This capability allows many organizations that have different on-premises and cloud identities toohave SSO from hello cloud tooon-premises apps without requiring hello users tooenter different usernames and passwords.</span></span> <span data-ttu-id="75f88-172">Sono incluse organizzazioni che:</span><span class="sxs-lookup"><span data-stu-id="75f88-172">This includes organizations that:</span></span>

* <span data-ttu-id="75f88-173">Sono disponibili più domini internamente (joe@us.contoso.com, joe@eu.contoso.com) e un singolo dominio nel cloud hello (joe@contoso.com).</span><span class="sxs-lookup"><span data-stu-id="75f88-173">Have multiple domains internally (joe@us.contoso.com, joe@eu.contoso.com) and a single domain in hello cloud (joe@contoso.com).</span></span>
* <span data-ttu-id="75f88-174">Dispone di nome di dominio non instradabile internamente (joe@contoso.usa) e una persona nel cloud hello.</span><span class="sxs-lookup"><span data-stu-id="75f88-174">Have non-routable domain name internally (joe@contoso.usa) and a legal one in hello cloud.</span></span>
* <span data-ttu-id="75f88-175">Non usano nomi di dominio internamente (joe).</span><span class="sxs-lookup"><span data-stu-id="75f88-175">Do not use domain names internally (joe)</span></span>
* <span data-ttu-id="75f88-176">Utilizzare alias diversi locale e nel cloud hello.</span><span class="sxs-lookup"><span data-stu-id="75f88-176">Use different aliases on-prem and in hello cloud.</span></span> <span data-ttu-id="75f88-177">Ad esempio, joe-johns@contoso.com e joej@contoso.com</span><span class="sxs-lookup"><span data-stu-id="75f88-177">For example, joe-johns@contoso.com vs. joej@contoso.com</span></span>  

<span data-ttu-id="75f88-178">Con Proxy dell'applicazione, è possibile selezionare quali hello tooobtain toouse di identità ticket Kerberos.</span><span class="sxs-lookup"><span data-stu-id="75f88-178">With Application Proxy, you can select which identity toouse tooobtain hello Kerberos ticket.</span></span> <span data-ttu-id="75f88-179">Questa impostazione viene configurata per ogni applicazione.</span><span class="sxs-lookup"><span data-stu-id="75f88-179">This setting is per application.</span></span> <span data-ttu-id="75f88-180">Alcune di queste opzioni sono appropriate per i sistemi che non accettano il formato di indirizzo di posta elettronica, altre sono concepite per l'accesso alternativo.</span><span class="sxs-lookup"><span data-stu-id="75f88-180">Some of these options are suitable for systems that do not accept email address format, others are designed for alternative login.</span></span>

![Schermata del parametro dell'identità di accesso delegata](./media/active-directory-application-proxy-sso-using-kcd/app_proxy_sso_diff_id_upn.png)

<span data-ttu-id="75f88-182">Se viene utilizzata l'identità di accesso delegato, hello valore potrebbe non essere univoco in tutti i domini hello o foreste dell'organizzazione.</span><span class="sxs-lookup"><span data-stu-id="75f88-182">If delegated login identity is used, hello value might not be unique across all hello domains or forests in your organization.</span></span> <span data-ttu-id="75f88-183">Per evitare questo problema, pubblicare queste applicazioni due volte usando due gruppi di connettori diversi.</span><span class="sxs-lookup"><span data-stu-id="75f88-183">You can avoid this issue by publishing these applications twice using two different Connector groups.</span></span> <span data-ttu-id="75f88-184">Poiché ogni applicazione dispone di un gruppo di destinatari di un utente diverso, è possibile aggiungere il dominio di connettori tooa diverso.</span><span class="sxs-lookup"><span data-stu-id="75f88-184">Since each application has a different user audience, you can join its Connectors tooa different domain.</span></span>

### <a name="configure-sso-for-different-identities"></a><span data-ttu-id="75f88-185">Configurare Single Sign-On per diverse identità</span><span class="sxs-lookup"><span data-stu-id="75f88-185">Configure SSO for different identities</span></span>
1. <span data-ttu-id="75f88-186">Configurare le impostazioni di Azure AD Connect in modo identità principale hello è l'indirizzo di posta elettronica hello (posta elettronica).</span><span class="sxs-lookup"><span data-stu-id="75f88-186">Configure Azure AD Connect settings so hello main identity is hello email address (mail).</span></span> <span data-ttu-id="75f88-187">Questa operazione viene eseguita come parte di hello personalizzarlo, modificando hello **nome entità utente** campo nelle impostazioni di sincronizzazione hello.</span><span class="sxs-lookup"><span data-stu-id="75f88-187">This is done as part of hello customize process, by changing hello **User Principal Name** field in hello sync settings.</span></span> <span data-ttu-id="75f88-188">Queste impostazioni determinano inoltre come gli utenti accedono tooOffice365, Windows10 dispositivi e altre applicazioni che usano Azure AD come archivio identità.</span><span class="sxs-lookup"><span data-stu-id="75f88-188">These settings also determine how users log in tooOffice365, Windows10 devices, and other applications that use Azure AD as their identity store.</span></span>  
   <span data-ttu-id="75f88-189">![Schermata di identificazione degli utenti - Elenco a discesa Nome dell'entità utente](./media/active-directory-application-proxy-sso-using-kcd/app_proxy_sso_diff_id_connect_settings.png)</span><span class="sxs-lookup"><span data-stu-id="75f88-189">![Identifying users screenshot - User Principal Name dropdown](./media/active-directory-application-proxy-sso-using-kcd/app_proxy_sso_diff_id_connect_settings.png)</span></span>  
2. <span data-ttu-id="75f88-190">Nelle impostazioni di configurazione dell'applicazione hello per un'applicazione hello desideri toomodify, seleziona hello **delega di identità di account di accesso** toobe utilizzato:</span><span class="sxs-lookup"><span data-stu-id="75f88-190">In hello Application Configuration settings for hello application you would like toomodify, select hello **Delegated Login Identity** toobe used:</span></span>

   * <span data-ttu-id="75f88-191">Nome dell'entità utente (ad esempio joe@contoso.com)</span><span class="sxs-lookup"><span data-stu-id="75f88-191">User Principal Name (for example, joe@contoso.com)</span></span>
   * <span data-ttu-id="75f88-192">Nome alternativo dell'entità utente (ad esempio joed@contoso.local)</span><span class="sxs-lookup"><span data-stu-id="75f88-192">Alternate User Principal Name (for example, joed@contoso.local)</span></span>
   * <span data-ttu-id="75f88-193">Parte del nome utente del nome dell'entità utente (ad esempio joe)</span><span class="sxs-lookup"><span data-stu-id="75f88-193">Username part of User Principal Name (for example, joe)</span></span>
   * <span data-ttu-id="75f88-194">Parte del nome utente del nome alternativo dell'entità utente (ad esempio joe)</span><span class="sxs-lookup"><span data-stu-id="75f88-194">Username part of Alternate User Principal Name (for example, joed)</span></span>
   * <span data-ttu-id="75f88-195">Nome dell'account SAM locale (dipende dalla configurazione del controller di dominio hello)</span><span class="sxs-lookup"><span data-stu-id="75f88-195">On-premises SAM account name (depends on hello domain controller configuration)</span></span>

### <a name="troubleshooting-sso-for-different-identities"></a><span data-ttu-id="75f88-196">Risoluzione dei problemi di accesso Single Sign-On per diverse identità</span><span class="sxs-lookup"><span data-stu-id="75f88-196">Troubleshooting SSO for different identities</span></span>
<span data-ttu-id="75f88-197">Se si verifica un errore nel processo SSO hello, viene visualizzato nel registro eventi di hello connettore macchina come spiegato in [risoluzione dei problemi](application-proxy-back-end-kerberos-constrained-delegation-how-to.md).</span><span class="sxs-lookup"><span data-stu-id="75f88-197">If there is an error in hello SSO process, it appears in hello connector machine event log as explained in [Troubleshooting](application-proxy-back-end-kerberos-constrained-delegation-how-to.md).</span></span>
<span data-ttu-id="75f88-198">Tuttavia, in alcuni casi, hello richiesta viene inviata applicazione back-end toohello mentre l'applicazione risponde in varie altre risposte HTTP.</span><span class="sxs-lookup"><span data-stu-id="75f88-198">But, in some cases, hello request is successfully sent toohello backend application while this application replies in various other HTTP responses.</span></span> <span data-ttu-id="75f88-199">Risoluzione dei problemi di questi casi è consigliabile iniziare esaminando il numero di eventi 24029 computer connettore hello nel registro eventi di sessione Proxy dell'applicazione hello.</span><span class="sxs-lookup"><span data-stu-id="75f88-199">Troubleshooting these cases should start by examining event number 24029 on hello connector machine in hello Application Proxy session event log.</span></span> <span data-ttu-id="75f88-200">identità dell'utente Hello utilizzata per la delega viene visualizzato nel campo "user" hello all'interno di dettagli sull'evento hello.</span><span class="sxs-lookup"><span data-stu-id="75f88-200">hello user identity that was used for delegation appears in hello “user” field within hello event details.</span></span> <span data-ttu-id="75f88-201">tooturn nel log di sessione, selezionare **Mostra analitica e registri di debug** nel menu Visualizza di Visualizzatore eventi hello.</span><span class="sxs-lookup"><span data-stu-id="75f88-201">tooturn on session log, select **Show analytic and debug logs** in hello event viewer view menu.</span></span>

## <a name="next-steps"></a><span data-ttu-id="75f88-202">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="75f88-202">Next steps</span></span>

* [<span data-ttu-id="75f88-203">Come tooconfigure un toouse applicazione Proxy dell'applicazione la delega vincolata Kerberos</span><span class="sxs-lookup"><span data-stu-id="75f88-203">How tooconfigure an Application Proxy application toouse Kerberos Constrained Delegation</span></span>](application-proxy-back-end-kerberos-constrained-delegation-how-to.md)
* [<span data-ttu-id="75f88-204">Risolvere i problemi che si verificano con il proxy di applicazione</span><span class="sxs-lookup"><span data-stu-id="75f88-204">Troubleshoot issues you're having with Application Proxy</span></span>](active-directory-application-proxy-troubleshoot.md)


<span data-ttu-id="75f88-205">Per informazioni più recenti hello e gli aggiornamenti, consultare hello [blog del Proxy dell'applicazione](http://blogs.technet.com/b/applicationproxyblog/)</span><span class="sxs-lookup"><span data-stu-id="75f88-205">For hello latest news and updates, check out hello [Application Proxy blog](http://blogs.technet.com/b/applicationproxyblog/)</span></span>

