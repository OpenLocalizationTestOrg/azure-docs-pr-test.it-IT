---
title: Failover di test in Azure in Site Recovery | Microsoft Docs
description: Informazioni su come eseguire un failover di test da locale ad Azure
services: site-recovery
documentationcenter: 
author: prateek9us
manager: gauravd
editor: 
ms.assetid: 44813a48-c680-4581-a92e-cecc57cc3b1e
ms.service: site-recovery
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: storage-backup-recovery
ms.date: 07/04/2017
ms.author: pratshar
ms.openlocfilehash: 54f62af6abcdd38254fd5379b95baa05656dc90b
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 07/11/2017
---
# <a name="test--failover-to-azure-in-site-recovery"></a><span data-ttu-id="986fc-103">Failover di test in Azure in Site Recovery</span><span class="sxs-lookup"><span data-stu-id="986fc-103">Test  Failover to Azure in Site Recovery</span></span>



<span data-ttu-id="986fc-104">Questo articolo contiene informazioni e istruzioni per eseguire un failover di test o un'esercitazione sul ripristino di emergenza di macchine virtuali e server fisici protetti con Site Recovery, usando Azure come sito di ripristino.</span><span class="sxs-lookup"><span data-stu-id="986fc-104">This article provides information and instructions for doing a test failover or a DR drill of virtual machines and physical servers that are protected with Site Recovery using Azure as the recovery site.</span></span>

<span data-ttu-id="986fc-105">Per inviare commenti o domande, è possibile usare la parte inferiore di questo articolo oppure il [forum sui Servizi di ripristino di Azure](https://social.msdn.microsoft.com/forums/azure/home?forum=hypervrecovmgr).</span><span class="sxs-lookup"><span data-stu-id="986fc-105">Post any comments or questions at the bottom of this article, or on the [Azure Recovery Services Forum](https://social.msdn.microsoft.com/forums/azure/home?forum=hypervrecovmgr).</span></span>

<span data-ttu-id="986fc-106">Il failover di test viene eseguito per convalidare la strategia di replica o eseguire un'esercitazione sul ripristino di emergenza senza perdita di dati o tempi di inattività.</span><span class="sxs-lookup"><span data-stu-id="986fc-106">Test failover is run to validate your replication strategy or perform a disaster recovery drill without any data loss or downtime.</span></span> <span data-ttu-id="986fc-107">Un failover di test non ha alcun impatto sulla replica in corso o sull'ambiente di produzione.</span><span class="sxs-lookup"><span data-stu-id="986fc-107">Doing a test failover doesn't have any impact on the ongoing replication or on your production environment.</span></span> <span data-ttu-id="986fc-108">Il failover di test può essere eseguito su una macchina virtuale o un [piano di ripristino](site-recovery-create-recovery-plans.md).</span><span class="sxs-lookup"><span data-stu-id="986fc-108">Test failover can be done either on a virtual machine or a [recovery plan](site-recovery-create-recovery-plans.md).</span></span> <span data-ttu-id="986fc-109">Quando si attiva un failover di test, è necessario specificare la rete a cui si connetteranno le macchine virtuali di test.</span><span class="sxs-lookup"><span data-stu-id="986fc-109">When triggering a test failover, you need to specify the network to which test virtual machines would connect to.</span></span> <span data-ttu-id="986fc-110">Dopo aver attivato un failover di test, è possibile tenere traccia dello stato di avanzamento nella pagina **Processi**.</span><span class="sxs-lookup"><span data-stu-id="986fc-110">Once a test failover is triggered, you can track progress in the **Jobs** page.</span></span>  


## <a name="supported-scenarios"></a><span data-ttu-id="986fc-111">Scenari supportati</span><span class="sxs-lookup"><span data-stu-id="986fc-111">Supported scenarios</span></span>
<span data-ttu-id="986fc-112">Il failover di test è supportato in tutti gli scenari di distribuzione tranne la [distribuzione legacy da sito VMware in Azure](site-recovery-vmware-to-azure-classic-legacy.md).</span><span class="sxs-lookup"><span data-stu-id="986fc-112">Test failover is supported in all deployment scenarios other than [legacy VMware site to Azure](site-recovery-vmware-to-azure-classic-legacy.md).</span></span> <span data-ttu-id="986fc-113">Il failover di test, inoltre, non è supportato quando la macchina virtuale è stata sottoposta a failover in Azure.</span><span class="sxs-lookup"><span data-stu-id="986fc-113">Test failover is also not supported when virtual machine has been failed over to Azure.</span></span>  


## <a name="run-a-test-failover"></a><span data-ttu-id="986fc-114">Eseguire un failover di test</span><span class="sxs-lookup"><span data-stu-id="986fc-114">Run a test failover</span></span>
<span data-ttu-id="986fc-115">Questa procedura descrive come eseguire un failover di test per un piano di ripristino.</span><span class="sxs-lookup"><span data-stu-id="986fc-115">This procedure describes how to run a test failover for a recovery plan.</span></span> <span data-ttu-id="986fc-116">In alternativa, è anche possibile eseguire il failover di test per un singolo computer usando l'opzione appropriata su di esso.</span><span class="sxs-lookup"><span data-stu-id="986fc-116">Alternatively you can also run test failover for a single machine by using the appropriate option on it.</span></span>

![Failover di test](./media/site-recovery-test-failover-to-azure/TestFailover.png)


1. <span data-ttu-id="986fc-118">Selezionare **Piani di ripristino** > *nome_pianodiripristino*.</span><span class="sxs-lookup"><span data-stu-id="986fc-118">Select **Recovery Plans** > *recoveryplan_name*.</span></span> <span data-ttu-id="986fc-119">Fare clic su **Failover di test**.</span><span class="sxs-lookup"><span data-stu-id="986fc-119">Click **Test Failover**.</span></span>
1. <span data-ttu-id="986fc-120">Selezionare un **punto di ripristino** in cui eseguire il failover.</span><span class="sxs-lookup"><span data-stu-id="986fc-120">Select a **Recovery Point** to failover to.</span></span> <span data-ttu-id="986fc-121">È possibile usare una delle opzioni seguenti.</span><span class="sxs-lookup"><span data-stu-id="986fc-121">You can use one of the following options:</span></span>
    1.  <span data-ttu-id="986fc-122">**Punto di ripristino elaborato più recente**: con questa opzione viene eseguito il failover di tutte le macchine virtuali del piano di ripristino nell'ultimo punto di ripristino elaborato dal servizio Site Recovery.</span><span class="sxs-lookup"><span data-stu-id="986fc-122">**Latest processed**: This option fails over all virtual machines of the recovery plan to the latest recovery point that has already been processed by Site Recovery service.</span></span> <span data-ttu-id="986fc-123">Quando si esegue il failover di test di una macchina virtuale, viene visualizzato anche il timestamp del punto di ripristino elaborato più recente.</span><span class="sxs-lookup"><span data-stu-id="986fc-123">When you are doing test failover of a virtual machine, time stamp of the latest processed recovery point is also shown.</span></span> <span data-ttu-id="986fc-124">Se si esegue il failover di un piano di ripristino, per ottenere tali informazioni è possibile passare alla singola macchina virtuale ed esaminare il riquadro **Latest Recovery Points** (Punti di ripristino più recenti).</span><span class="sxs-lookup"><span data-stu-id="986fc-124">If you are doing failover of a recovery plan, you can go to individual virtual machine and look at **Latest Recovery Points** tile to get this information.</span></span> <span data-ttu-id="986fc-125">Dato che non viene impiegato tempo per elaborare dati non elaborati, questa opzione offre un failover con valore RTO (Recovery Time Objective) basso.</span><span class="sxs-lookup"><span data-stu-id="986fc-125">As no time is spent to process the unprocessed data, this option provides a low RTO (Recovery Time Objective) failover option.</span></span>
    1.  <span data-ttu-id="986fc-126">**Punto di ripristino più recente coerente con l'applicazione**: con questa opzione viene eseguito il failover di tutte le macchine virtuali del piano di ripristino nell'ultimo punto di ripristino coerente con l'applicazione elaborato dal servizio Site Recovery.</span><span class="sxs-lookup"><span data-stu-id="986fc-126">**Latest app-consistent**: This option fails over all virtual machines of the recovery plan to the latest application consistent recovery point that has already been processed by Site Recovery service.</span></span> <span data-ttu-id="986fc-127">Quando si esegue il failover di test di una macchina virtuale, viene visualizzato anche il timestamp del punto di ripristino coerente con l'app più recente.</span><span class="sxs-lookup"><span data-stu-id="986fc-127">When you are doing test failover of a virtual machine, time stamp of the latest app-consistent recovery point is also shown.</span></span> <span data-ttu-id="986fc-128">Se si esegue il failover di un piano di ripristino, per ottenere tali informazioni è possibile passare alla singola macchina virtuale ed esaminare il riquadro **Latest Recovery Points** (Punti di ripristino più recenti).</span><span class="sxs-lookup"><span data-stu-id="986fc-128">If you are doing failover of a recovery plan, you can go to individual virtual machine and look at **Latest Recovery Points** tile to get this information.</span></span>
    1.  <span data-ttu-id="986fc-129">**Più recente**: con questa opzione vengono prima elaborati tutti i dati inviati al servizio Site Recovery per creare un punto di ripristino per ogni macchina virtuale e quindi viene eseguito il failover in tale punto di ripristino.</span><span class="sxs-lookup"><span data-stu-id="986fc-129">**Latest**: This option first processes all the data that has been sent to Site Recovery service to create a recovery point for each virtual machine before failing them over to it.</span></span> <span data-ttu-id="986fc-130">Questa opzione offre il valore RPO (Recovery Point Objective) più basso, perché la macchina virtuale creata dopo il failover avrà tutti i dati che sono stati replicati nel servizio Site Recovery all'attivazione del failover.</span><span class="sxs-lookup"><span data-stu-id="986fc-130">This option provides the lowest RPO (Recovery Point Objective) as the virtual machine created after failover will have all the data that has been replicated to Site Recovery service when the failover was triggered.</span></span>
    1.  <span data-ttu-id="986fc-131">**Latest multi-VM processed** (Più recente coerente tra più VM elaborato): questa opzione è disponibile solo per i piani di ripristino con almeno una macchina virtuale in cui è abilitata la coerenza tra più macchine virtuali.</span><span class="sxs-lookup"><span data-stu-id="986fc-131">**Latest multi-VM processed**: This option is only available for recovery plans that have at least one virtual machine with multi-VM consistency ON.</span></span> <span data-ttu-id="986fc-132">Le macchine virtuali che fanno parte di un gruppo di replica eseguono il failover nel punto di recupero coerente tra più macchine comune più recente.</span><span class="sxs-lookup"><span data-stu-id="986fc-132">Virtual machines that are part of a replication group failover to the latest common multi-VM consistent recovery point.</span></span> <span data-ttu-id="986fc-133">Le altre macchine virtuali eseguono il failover nel relativo punto di recupero più recente elaborato.</span><span class="sxs-lookup"><span data-stu-id="986fc-133">Other virtual machines failover to their latest processed recovery point.</span></span>  
    1.  <span data-ttu-id="986fc-134">**Latest multi-VM app-consistent** (Più recente coerente con l'applicazione tra più VM): questa opzione è disponibile solo per i piani di ripristino con almeno una macchina virtuale in cui è abilitata la coerenza tra più macchine virtuali.</span><span class="sxs-lookup"><span data-stu-id="986fc-134">**Latest multi-VM app-consistent**: This option is only available for recovery plans that have at least one virtual machine with multi-VM consistency ON.</span></span> <span data-ttu-id="986fc-135">Le macchine virtuali che fanno parte di un gruppo di replica eseguono il failover nel punto di recupero coerente a livello applicazione tra più macchine comune più recente.</span><span class="sxs-lookup"><span data-stu-id="986fc-135">Virtual machines that are part of a replication group failover to the latest common multi-VM application-consistent recovery point.</span></span> <span data-ttu-id="986fc-136">Le altre macchine virtuali eseguono il failover nel relativo punto di recupero più recente coerente con l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="986fc-136">Other virtual machines failover to their latest application-consistent recovery point.</span></span> 
    1.  <span data-ttu-id="986fc-137">**Personalizzato**: in caso di failover di test di una macchina virtuale, è possibile usare questa opzione per eseguire il failover in un determinato punto di ripristino.</span><span class="sxs-lookup"><span data-stu-id="986fc-137">**Custom**: If you are doing test failover of a virtual machine, then you can use this option to failover to a particular recovery point.</span></span>
1. <span data-ttu-id="986fc-138">Selezionare una **rete virtuale di Azure**: specificare una rete virtuale di Azure in cui verranno create le macchine virtuali di test.</span><span class="sxs-lookup"><span data-stu-id="986fc-138">Select an **Azure virtual network**: Provide an Azure virtual network where the test virtual machines would be created.</span></span> <span data-ttu-id="986fc-139">Site Recovery tenta di creare le macchine virtuali di test in una subnet con lo stesso nome e con lo stesso IP specificati nelle impostazioni **Calcolo e rete** della macchina virtuale.</span><span class="sxs-lookup"><span data-stu-id="986fc-139">Site Recovery attempts to create test virtual machines in a subnet of same name and using the same IP as that provided in **Compute and Network** settings of the virtual machine.</span></span> <span data-ttu-id="986fc-140">Se nella rete virtuale di Azure specificata per il failover di test non è disponibile una subnet con lo stesso nome, la macchina virtuale di test verrà creata nella prima subnet in ordine alfabetico.</span><span class="sxs-lookup"><span data-stu-id="986fc-140">If subnet of same name is not available in the Azure virtual network provided for test failover, then test virtual machine is created in the first subnet alphabetically.</span></span> <span data-ttu-id="986fc-141">Se nella subnet non è disponibile lo stesso IP, la macchina virtuale ottiene un altro indirizzo IP disponibile nella subnet.</span><span class="sxs-lookup"><span data-stu-id="986fc-141">If same IP is not available in the subnet, then virtual machine gets another IP address available in the subnet.</span></span> <span data-ttu-id="986fc-142">Per altri dettagli, vedere [questa sezione](#creating-a-network-for-test-failover).</span><span class="sxs-lookup"><span data-stu-id="986fc-142">Read this section for [more details](#creating-a-network-for-test-failover)</span></span>
1. <span data-ttu-id="986fc-143">Se si esegue il failover in Azure ed è abilitata la crittografia dei dati, in **Chiave di crittografia** selezionare il certificato rilasciato quando è stata abilitata la crittografia dei dati durante l'installazione del provider.</span><span class="sxs-lookup"><span data-stu-id="986fc-143">If you're failing over to Azure and data encryption is enabled, in **Encryption Key** select the certificate that was issued when you enabled data encryption during Provider installation.</span></span> <span data-ttu-id="986fc-144">Se nella macchina virtuale non è stata abilitata la crittografia, è possibile ignorare questo passaggio.</span><span class="sxs-lookup"><span data-stu-id="986fc-144">You can ignore this step if you have not enabled encryption on the virtual machine.</span></span>
1. <span data-ttu-id="986fc-145">Tenere traccia dello stato di avanzamento del failover nella scheda **Processi** .</span><span class="sxs-lookup"><span data-stu-id="986fc-145">Track failover progress on the **Jobs** tab.</span></span> <span data-ttu-id="986fc-146">Nel portale di Azure dovrebbe anche essere possibile vedere la macchina di replica di test.</span><span class="sxs-lookup"><span data-stu-id="986fc-146">You should be able to see the test replica machine in the Azure portal.</span></span>
1. <span data-ttu-id="986fc-147">Per avviare una connessione RDP nella macchina virtuale, è necessario [aggiungere un indirizzo IP pubblico](site-recovery-monitoring-and-troubleshooting.md#adding-a-public-ip-on-a-resource-manager-virtual-machine) nell'interfaccia di rete della macchina virtuale sottoposta a failover.</span><span class="sxs-lookup"><span data-stu-id="986fc-147">To initiate an RDP connection on the virtual machine, you will need to [add a public ip](site-recovery-monitoring-and-troubleshooting.md#adding-a-public-ip-on-a-resource-manager-virtual-machine) on the network interface of the failed over virtual machine.</span></span> <span data-ttu-id="986fc-148">In caso di failover in una macchina virtuale della versione classica, è necessario [aggiungere un endpoint](../virtual-machines/windows/classic/setup-endpoints.md) sulla porta 3389.</span><span class="sxs-lookup"><span data-stu-id="986fc-148">If you are failing over to a Classic virtual machine, then you need to [add an endpoint](../virtual-machines/windows/classic/setup-endpoints.md) on port 3389</span></span>
1. <span data-ttu-id="986fc-149">Al termine, fare clic su **Cleanup test failover** (Pulizia failover di test) nel piano di ripristino.</span><span class="sxs-lookup"><span data-stu-id="986fc-149">Once you're done, click **Cleanup test failover** on the recovery plan.</span></span> <span data-ttu-id="986fc-150">Fare clic su **Note** per registrare e salvare eventuali osservazioni associate al failover di test.</span><span class="sxs-lookup"><span data-stu-id="986fc-150">In **Notes** record and save any observations associated with the test failover.</span></span> <span data-ttu-id="986fc-151">Verranno eliminate le macchine virtuali create durante il failover di test.</span><span class="sxs-lookup"><span data-stu-id="986fc-151">This deletes the virtual machines that were created during test failover.</span></span>


> [!TIP]
> <span data-ttu-id="986fc-152">Site Recovery tenta di creare le macchine virtuali di test in una subnet con lo stesso nome e con lo stesso IP specificati nelle impostazioni **Calcolo e rete** della macchina virtuale.</span><span class="sxs-lookup"><span data-stu-id="986fc-152">Site Recovery attempts to create test virtual machines in a subnet of same name and using the same IP as that provided in **Compute and Network** settings of the virtual machine.</span></span> <span data-ttu-id="986fc-153">Se nella rete virtuale di Azure specificata per il failover di test non è disponibile una subnet con lo stesso nome, la macchina virtuale di test verrà creata nella prima subnet in ordine alfabetico.</span><span class="sxs-lookup"><span data-stu-id="986fc-153">If subnet of same name is not available in the Azure virtual network provided for test failover, then test virtual machine is created in the first subnet alphabetically.</span></span> <span data-ttu-id="986fc-154">Se l'indirizzo IP di destinazione fa parte della subnet scelta, Site Recovery tenta di creare la macchina virtuale per il failover di test usando l'indirizzo IP di destinazione.</span><span class="sxs-lookup"><span data-stu-id="986fc-154">If the target IP is part of the chosen subnet, then site recovery tries to create the test failover virtual machine using the target IP.</span></span> <span data-ttu-id="986fc-155">Se l'indirizzo IP di destinazione non fa parte della subnet scelta, la macchina virtuale del failover di test viene creata usando qualsiasi indirizzo IP disponibile nella subnet scelta.</span><span class="sxs-lookup"><span data-stu-id="986fc-155">If the target IP is not part of the chosen subnet then test failover virtual machine gets created using any available IP in the chosen subnet.</span></span>
>
>

## <a name="test-failover-job"></a><span data-ttu-id="986fc-156">Processo di failover di test</span><span class="sxs-lookup"><span data-stu-id="986fc-156">Test failover job</span></span>

![Failover di test](./media/site-recovery-test-failover-to-azure/TestFailoverJob.png)

<span data-ttu-id="986fc-158">L'attivazione di un failover di test comporta l'esecuzione dei passaggi riportati di seguito.</span><span class="sxs-lookup"><span data-stu-id="986fc-158">When a test failover is triggered, it involves following steps:</span></span>

1. <span data-ttu-id="986fc-159">Verifica preliminare: questo passaggio garantisce che siano soddisfatte tutte le condizioni necessarie per il failover.</span><span class="sxs-lookup"><span data-stu-id="986fc-159">Prerequisites check: This step ensures that all conditions required for failover are met</span></span>
1. <span data-ttu-id="986fc-160">Failover: questo passaggio elabora i dati preparandoli in modo che possano essere usati per creare una macchina virtuale di Azure.</span><span class="sxs-lookup"><span data-stu-id="986fc-160">Failover: This step processes the data and makes it ready so that an Azure virtual machine can be created out of it.</span></span> <span data-ttu-id="986fc-161">Se si è scelto il punto di ripristino **Più recente**, viene creato un punto di ripristino dai dati che sono stati inviati al servizio.</span><span class="sxs-lookup"><span data-stu-id="986fc-161">If you have chosen **Latest** recovery point, this step creates a recovery point from the data that has been sent to the service.</span></span>
1. <span data-ttu-id="986fc-162">Avvio: questo passaggio crea una macchina virtuale di Azure usando i dati elaborati nel passaggio precedente.</span><span class="sxs-lookup"><span data-stu-id="986fc-162">Start: This step creates an Azure virtual machine using the data processed in the previous step.</span></span>

## <a name="time-taken-for-failover"></a><span data-ttu-id="986fc-163">Tempo impiegato per il failover</span><span class="sxs-lookup"><span data-stu-id="986fc-163">Time taken for failover</span></span>

<span data-ttu-id="986fc-164">Il failover di macchine virtuali richiede in alcuni casi un passaggio aggiuntivo intermedio che in genere viene completato in circa 8-10 minuti.</span><span class="sxs-lookup"><span data-stu-id="986fc-164">In certain cases, failover of virtual machines requires an extra intermediate step that usually takes around 8  to 10 minutes to complete.</span></span> <span data-ttu-id="986fc-165">Questi casi sono i seguenti:</span><span class="sxs-lookup"><span data-stu-id="986fc-165">These cases are as following:</span></span>

* <span data-ttu-id="986fc-166">Macchine virtuali VMware che usano una versione del servizio Mobility precedente alla 9.8</span><span class="sxs-lookup"><span data-stu-id="986fc-166">VMware virtual machines using a version of the Mobility service older than 9.8</span></span>
* <span data-ttu-id="986fc-167">Server fisici</span><span class="sxs-lookup"><span data-stu-id="986fc-167">Physical servers</span></span>
* <span data-ttu-id="986fc-168">Macchine virtuali VMware Linux</span><span class="sxs-lookup"><span data-stu-id="986fc-168">VMware Linux virtual machines</span></span>
* <span data-ttu-id="986fc-169">Macchine virtuali Hyper-V protette come server fisici</span><span class="sxs-lookup"><span data-stu-id="986fc-169">Hyper-V virtual machines protected as physical servers</span></span>
* <span data-ttu-id="986fc-170">Macchine virtuali VMware in cui i driver seguenti non sono presenti come driver di avvio</span><span class="sxs-lookup"><span data-stu-id="986fc-170">VMware virtual machines where following drivers are not present as boot drivers</span></span>
    * <span data-ttu-id="986fc-171">storvsc</span><span class="sxs-lookup"><span data-stu-id="986fc-171">storvsc</span></span>
    * <span data-ttu-id="986fc-172">vmbus</span><span class="sxs-lookup"><span data-stu-id="986fc-172">vmbus</span></span>
    * <span data-ttu-id="986fc-173">storflt</span><span class="sxs-lookup"><span data-stu-id="986fc-173">storflt</span></span>
    * <span data-ttu-id="986fc-174">intelide</span><span class="sxs-lookup"><span data-stu-id="986fc-174">intelide</span></span>
    * <span data-ttu-id="986fc-175">atapi</span><span class="sxs-lookup"><span data-stu-id="986fc-175">atapi</span></span>
* <span data-ttu-id="986fc-176">Macchine virtuali VMware che non dispongono del servizio DHCP abilitato indipendentemente che usino indirizzi IP statici o DHCP.</span><span class="sxs-lookup"><span data-stu-id="986fc-176">VMware virtual machines that don't have DHCP service enabled irrespective of whether they are using DHCP or static IP addresses</span></span>

<span data-ttu-id="986fc-177">In tutti gli altri casi questo passaggio intermedio non è necessario e il tempo impiegato per il failover è notevolmente inferiore.</span><span class="sxs-lookup"><span data-stu-id="986fc-177">In all the other cases this intermediate step is not required and the time taken for the failover is significantly lower.</span></span>


## <a name="creating-a-network-for-test-failover"></a><span data-ttu-id="986fc-178">Creazione di una rete per il failover di test</span><span class="sxs-lookup"><span data-stu-id="986fc-178">Creating a network for test failover</span></span>
<span data-ttu-id="986fc-179">Durante un failover di test, è consigliabile scegliere una rete isolata dalla rete del sito di ripristino di produzione specificata nelle impostazioni **Calcolo e rete** della macchina virtuale.</span><span class="sxs-lookup"><span data-stu-id="986fc-179">It is recommended that when you are doing a test failover you choose a network that is isolated from your production recovery site network that you provided in **Compute and Network** settings for the virtual machine.</span></span> <span data-ttu-id="986fc-180">Quando si crea una rete virtuale di Azure, per impostazione predefinita è isolata dalle altre reti.</span><span class="sxs-lookup"><span data-stu-id="986fc-180">By default when you create an Azure virtual network, it is isolated from other networks.</span></span> <span data-ttu-id="986fc-181">La rete dovrà simulare la rete di produzione:</span><span class="sxs-lookup"><span data-stu-id="986fc-181">This network should mimic your production network:</span></span>

1. <span data-ttu-id="986fc-182">La rete di test dovrà avere lo stesso numero di subnet della rete di produzione, con lo stesso nome delle subnet nella rete di produzione.</span><span class="sxs-lookup"><span data-stu-id="986fc-182">Test network should have same number of subnets as that in your production network and with the same name as those of the subnets in your production network.</span></span>
1. <span data-ttu-id="986fc-183">La rete di test dovrà usare lo stesso intervallo IP della rete di produzione.</span><span class="sxs-lookup"><span data-stu-id="986fc-183">Test network should use the same IP range as that of your production network.</span></span>
1. <span data-ttu-id="986fc-184">Aggiornare il DNS della rete di test con l'IP specificato come IP di destinazione per la macchina virtuale DNS nelle impostazioni **Calcolo e rete**.</span><span class="sxs-lookup"><span data-stu-id="986fc-184">Update the DNS of the Test Network as the IP that you gave as target IP for the DNS virtual machine under **Compute and Network** settings.</span></span> <span data-ttu-id="986fc-185">Per altri dettagli, vedere la sezione [Considerazioni sul failover di test per Active Directory](site-recovery-active-directory.md#test-failover-considerations) .</span><span class="sxs-lookup"><span data-stu-id="986fc-185">Go through [test failover considerations for active directory](site-recovery-active-directory.md#test-failover-considerations) section for more details.</span></span>


## <a name="test-failover-to-a-production-network-on-recovery-site"></a><span data-ttu-id="986fc-186">Failover di test in una rete di produzione nel sito di ripristino</span><span class="sxs-lookup"><span data-stu-id="986fc-186">Test failover to a production network on recovery site</span></span>
<span data-ttu-id="986fc-187">Durante un failover di test, è consigliabile scegliere una rete diversa rispetto alla rete del sito di ripristino di produzione specificata nelle impostazioni **Calcolo e rete** della macchina virtuale.</span><span class="sxs-lookup"><span data-stu-id="986fc-187">It is recommended that when you are doing a test failover you choose a network that is different from your production recovery site network that you provided in **Compute and Network** settings for the virtual machine.</span></span> <span data-ttu-id="986fc-188">Se tuttavia si vuole comunque convalidare la connettività di rete end-to-end in una macchina virtuale sottoposta a failover, tenere presente quanto segue:</span><span class="sxs-lookup"><span data-stu-id="986fc-188">But if you really want to validate end to end network connectivity in a failed over virtual machine, note the following points:</span></span>

1. <span data-ttu-id="986fc-189">Verificare che la macchina virtuale primaria sia arrestata quando si esegue il failover di test.</span><span class="sxs-lookup"><span data-stu-id="986fc-189">Make sure that the primary virtual machine is shutdown when you are doing the test failover.</span></span> <span data-ttu-id="986fc-190">In caso contrario, due macchine virtuali con la stessa identità saranno in esecuzione contemporaneamente nella stessa rete e ciò può causare conseguenze indesiderate.</span><span class="sxs-lookup"><span data-stu-id="986fc-190">If you don't do so, there will be two virtual machines with the same identity running in the same network at the same time and that can lead to undesired consequences.</span></span>
1. <span data-ttu-id="986fc-191">Tutte le modifiche apportate alle macchine virtuali del failover di test andranno perse con la pulizia di tali macchine virtuali.</span><span class="sxs-lookup"><span data-stu-id="986fc-191">Any changes that you make into the test failover virtual machines would be lost when you cleanup the test failover virtual machines.</span></span> <span data-ttu-id="986fc-192">Le modifiche non verranno replicate nella macchina virtuale primaria.</span><span class="sxs-lookup"><span data-stu-id="986fc-192">These changes will not be replicated back to the primary virtual machine.</span></span>
1. <span data-ttu-id="986fc-193">Questa modalità di esecuzione dei test determina un tempo di inattività dell'applicazione di produzione.</span><span class="sxs-lookup"><span data-stu-id="986fc-193">This way of doing testing leads to a downtime of your production application.</span></span> <span data-ttu-id="986fc-194">È consigliabile chiedere agli utenti di non usare l'applicazione mentre è in corso l'esercitazione sul ripristino di emergenza.</span><span class="sxs-lookup"><span data-stu-id="986fc-194">Users of the application should be asked to not use the application when the DR drill is in progress.</span></span>  



## <a name="prepare-active-directory-and-dns"></a><span data-ttu-id="986fc-195">Preparare Active Directory e DNS</span><span class="sxs-lookup"><span data-stu-id="986fc-195">Prepare Active Directory and DNS</span></span>
<span data-ttu-id="986fc-196">Per eseguire un failover di test per testare l'applicazione, è necessaria una copia dell'ambiente Active Directory di produzione nell'ambiente di test.</span><span class="sxs-lookup"><span data-stu-id="986fc-196">To run a test failover for application testing, you need a copy of the production Active Directory environment in your test environment.</span></span> <span data-ttu-id="986fc-197">Per altri dettagli, vedere la sezione [Considerazioni sul failover di test per Active Directory](site-recovery-active-directory.md#test-failover-considerations) .</span><span class="sxs-lookup"><span data-stu-id="986fc-197">Go through [test failover considerations for active directory](site-recovery-active-directory.md#test-failover-considerations) section for more details.</span></span>

## <a name="prepare-to-connect-to-azure-vms-after-failover"></a><span data-ttu-id="986fc-198">Preparare la connessione alle macchine virtuali di Azure dopo il failover</span><span class="sxs-lookup"><span data-stu-id="986fc-198">Prepare to connect to Azure VMs after failover</span></span>

<span data-ttu-id="986fc-199">Per connettersi alle macchine virtuali di Azure con RDP dopo il failover, seguire la procedura riepilogata nella tabella.</span><span class="sxs-lookup"><span data-stu-id="986fc-199">If you want to connect to Azure VMs using RDP after failover, make sure you do the actions summarized in the table.</span></span>

<span data-ttu-id="986fc-200">**Failover**</span><span class="sxs-lookup"><span data-stu-id="986fc-200">**Failover**</span></span> | <span data-ttu-id="986fc-201">**Posizione**</span><span class="sxs-lookup"><span data-stu-id="986fc-201">**Location**</span></span> | <span data-ttu-id="986fc-202">**Actions**</span><span class="sxs-lookup"><span data-stu-id="986fc-202">**Actions**</span></span>
--- | --- | ---
<span data-ttu-id="986fc-203">**VM di Azure che esegue Windows**</span><span class="sxs-lookup"><span data-stu-id="986fc-203">**Azure VM running Windows**</span></span> | <span data-ttu-id="986fc-204">Nel computer locale prima del failover</span><span class="sxs-lookup"><span data-stu-id="986fc-204">On on-premises machine before failover</span></span> | <span data-ttu-id="986fc-205">Per accedere alla VM di Azure tramite Internet, abilitare RDP e assicurarsi che vengano aggiunte regole TCP e UDP per **Pubblico** e che il protocollo RDP sia consentito in **Windows Firewall** > **App consentite** per tutti i profili.</span><span class="sxs-lookup"><span data-stu-id="986fc-205">To access the Azure VM over the internet, enable RDP, make sure TCP, and UDP rules are added for the **Public**, and that RDP is allowed in **Windows Firewall** > **Allowed Apps**, for all profiles.</span></span><br/><br/> <span data-ttu-id="986fc-206">Per l'accesso tramite una connessione da sito a sito, abilitare RDP nel computer e assicurarsi che il protocollo RDP sia consentito in **Windows Firewall** -> **App e funzionalità consentite** per le reti di **dominio e private**.</span><span class="sxs-lookup"><span data-stu-id="986fc-206">To access over a site-to-site connection, enable RDP on the machine, and ensure that RDP is allowed in the **Windows Firewall** -> **Allowed apps and features** for **Domain and Private** networks.</span></span><br/><br/>  <span data-ttu-id="986fc-207">Verificare che il criterio SAN del sistema operativo sia impostato su **OnlineAll**.</span><span class="sxs-lookup"><span data-stu-id="986fc-207">Make sure the operating system's SAN policy is set to **OnlineAll**.</span></span> <span data-ttu-id="986fc-208">[Altre informazioni](https://support.microsoft.com/kb/3031135).</span><span class="sxs-lookup"><span data-stu-id="986fc-208">[Learn more](https://support.microsoft.com/kb/3031135).</span></span><br/><br/> <span data-ttu-id="986fc-209">Quando si attiva un failover, verificare che nella macchina virtuale non siano in sospeso aggiornamenti di Windows.</span><span class="sxs-lookup"><span data-stu-id="986fc-209">Make sure there are no Windows updates pending on the virtual machine when you trigger a failover.</span></span> <span data-ttu-id="986fc-210">L'aggiornamento di Windows potrebbe essere avviato durante il failover e non si potrà accedere alla macchina virtuale finché non sarà completato.</span><span class="sxs-lookup"><span data-stu-id="986fc-210">Windows update might start when you failover and you will not be able to login to the virtual machine until the update completes.</span></span> <br/><br/>
<span data-ttu-id="986fc-211">**VM di Azure che esegue Windows**</span><span class="sxs-lookup"><span data-stu-id="986fc-211">**Azure VM running Windows**</span></span> | <span data-ttu-id="986fc-212">Nella VM di Azure dopo il failover</span><span class="sxs-lookup"><span data-stu-id="986fc-212">On Azure VM after failover</span></span> | <span data-ttu-id="986fc-213">Per una macchina virtuale della versione classica, [aggiungere un endpoint pubblico](../virtual-machines/windows/classic/setup-endpoints.md) per il protocollo RDP (porta 3389)</span><span class="sxs-lookup"><span data-stu-id="986fc-213">For a classic virtual machine, [add a public endpoint](../virtual-machines/windows/classic/setup-endpoints.md) for the RDP protocol (port 3389)</span></span><br/><br/>  <span data-ttu-id="986fc-214">Per una macchina virtuale di Resource Manager, [aggiungere un indirizzo IP pubblico](site-recovery-monitoring-and-troubleshooting.md#adding-a-public-ip-on-a-resource-manager-virtual-machine) nella macchina virtuale.</span><span class="sxs-lookup"><span data-stu-id="986fc-214">For a Resource Manager virtual machine, [add a public IP](site-recovery-monitoring-and-troubleshooting.md#adding-a-public-ip-on-a-resource-manager-virtual-machine) on it.</span></span><br/><br/> <span data-ttu-id="986fc-215">Le regole del gruppo di sicurezza di rete nella VM sottoposta a failover e nella subnet di Azure a cui è connessa devono consentire le connessioni in ingresso alla porta RDP.</span><span class="sxs-lookup"><span data-stu-id="986fc-215">The network security group rules on the failed over VM, and the Azure subnet to which it is connected, need to allow incoming connections to the RDP port.</span></span><br/><br/> <span data-ttu-id="986fc-216">Per una macchina virtuale di Resource Manager, è possibile controllare **Diagnostica di avvio** per visualizzare uno screenshot della macchina virtuale.</span><span class="sxs-lookup"><span data-stu-id="986fc-216">For a Resource Manager virtual machine, you can check **Boot diagnostics** to look at a screenshot of the virtual machine</span></span><br/><br/> <span data-ttu-id="986fc-217">Se non è possibile connettersi, verificare che la VM sia in esecuzione e quindi vedere questi [suggerimenti sulla risoluzione dei problemi](http://social.technet.microsoft.com/wiki/contents/articles/31666.troubleshooting-remote-desktop-connection-after-failover-using-asr.aspx).</span><span class="sxs-lookup"><span data-stu-id="986fc-217">If you can't connect, check that the VM is running and then look at these [troubleshooting tips](http://social.technet.microsoft.com/wiki/contents/articles/31666.troubleshooting-remote-desktop-connection-after-failover-using-asr.aspx).</span></span><br/><br/>
<span data-ttu-id="986fc-218">**VM di Azure che esegue Linux**</span><span class="sxs-lookup"><span data-stu-id="986fc-218">**Azure VM running Linux**</span></span> | <span data-ttu-id="986fc-219">Nel computer locale prima del failover</span><span class="sxs-lookup"><span data-stu-id="986fc-219">On on-premises machine before failover</span></span> | <span data-ttu-id="986fc-220">Assicurarsi che il servizio Secure Shell nella macchina virtuale di Azure sia impostato per l'avvio automatico all'avvio del sistema.</span><span class="sxs-lookup"><span data-stu-id="986fc-220">Ensure that the Secure Shell service on the Azure VM is set to start automatically on system boot.</span></span><br/><br/> <span data-ttu-id="986fc-221">Verificare che le regole firewall accettino la connessione SSH.</span><span class="sxs-lookup"><span data-stu-id="986fc-221">Check that firewall rules allow an SSH connection to it.</span></span>
<span data-ttu-id="986fc-222">**VM di Azure che esegue Linux**</span><span class="sxs-lookup"><span data-stu-id="986fc-222">**Azure VM running Linux**</span></span> | <span data-ttu-id="986fc-223">VM di Azure dopo il failover</span><span class="sxs-lookup"><span data-stu-id="986fc-223">Azure VM after failover</span></span> | <span data-ttu-id="986fc-224">Le regole del gruppo di sicurezza di rete nella macchina virtuale sottoposta a failover e nella subnet di Azure a cui è connessa devono consentire le connessioni in ingresso alla porta SSH.</span><span class="sxs-lookup"><span data-stu-id="986fc-224">The network security group rules on the failed over VM, and the Azure subnet to which it is connected, need to allow incoming connections to the SSH port.</span></span><br/><br/> <span data-ttu-id="986fc-225">Per una macchina virtuale della versione classica, è necessario creare e [aggiungere un endpoint pubblico](../virtual-machines/windows/classic/setup-endpoints.md) per consentire le connessioni in ingresso sulla porta SSH, che per impostazione predefinita è la porta TCP 22.</span><span class="sxs-lookup"><span data-stu-id="986fc-225">For  a classic virtual machine, [add a public endpoint](../virtual-machines/windows/classic/setup-endpoints.md) should be created, to allow incoming connections on the SSH port (TCP port 22 by default).</span></span><br/><br/> <span data-ttu-id="986fc-226">Per una macchina virtuale di Resource Manager, [aggiungere un indirizzo IP pubblico](site-recovery-monitoring-and-troubleshooting.md#adding-a-public-ip-on-a-resource-manager-virtual-machine) nella macchina virtuale.</span><span class="sxs-lookup"><span data-stu-id="986fc-226">For a Resource Manager virtual machine, [add a public IP](site-recovery-monitoring-and-troubleshooting.md#adding-a-public-ip-on-a-resource-manager-virtual-machine) on it.</span></span><br/><br/> <span data-ttu-id="986fc-227">Per una macchina virtuale di Resource Manager, è possibile controllare **Diagnostica di avvio** per visualizzare uno screenshot della macchina virtuale.</span><span class="sxs-lookup"><span data-stu-id="986fc-227">For a Resource Manager virtual machine, you can check **Boot diagnostics** to look at a screenshot of the virtual machine</span></span><br/><br/>



## <a name="next-steps"></a><span data-ttu-id="986fc-228">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="986fc-228">Next steps</span></span>
<span data-ttu-id="986fc-229">Dopo l'esito positivo di un failover di test, si può provare a eseguire un [failover](site-recovery-failover.md).</span><span class="sxs-lookup"><span data-stu-id="986fc-229">Once you have successfully tried a test failover you can try doing a [failover](site-recovery-failover.md).</span></span>
