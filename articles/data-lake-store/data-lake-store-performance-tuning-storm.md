---
title: linee guida sull'ottimizzazione delle prestazioni tempesta di archivio Data Lake di aaaAzure | Documenti Microsoft
description: Linee guida per l'ottimizzazione delle prestazioni di Storm in Azure Data Lake Store
services: data-lake-store
documentationcenter: 
author: stewu
manager: amitkul
editor: stewu
ms.assetid: ebde7b9f-2e51-4d43-b7ab-566417221335
ms.service: data-lake-store
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: big-data
ms.date: 12/19/2016
ms.author: stewu
ms.openlocfilehash: 5412fd46cf2373f5877030913df4fe1fc6f5473a
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/06/2017
---
# <a name="performance-tuning-guidance-for-storm-on-hdinsight-and-azure-data-lake-store"></a><span data-ttu-id="88451-103">Linee guida per l'ottimizzazione delle prestazioni di Storm in HDInsight e di Azure Data Lake Store</span><span class="sxs-lookup"><span data-stu-id="88451-103">Performance tuning guidance for Storm on HDInsight and Azure Data Lake Store</span></span>

<span data-ttu-id="88451-104">Comprendere i fattori da considerare quando si Ottimizza prestazioni hello di una topologia di Storm Azure hello.</span><span class="sxs-lookup"><span data-stu-id="88451-104">Understand hello factors that should be considered when you tune hello performance of an Azure Storm topology.</span></span> <span data-ttu-id="88451-105">Ad esempio, è importante toounderstand caratteristiche di hello del lavoro hello scopo spouts hello e le viti hello (lavoro hello sia con utilizzo intensivo della memoria o dei / o).</span><span class="sxs-lookup"><span data-stu-id="88451-105">For example, it's important toounderstand hello characteristics of hello work done by hello spouts and hello bolts (whether hello work is I/O or memory intensive).</span></span> <span data-ttu-id="88451-106">Questo articolo illustra una serie di linee guida per l'ottimizzazione delle prestazioni, inclusa la risoluzione dei problemi comuni.</span><span class="sxs-lookup"><span data-stu-id="88451-106">This article covers a range of performance tuning guidelines, including troubleshooting common issues.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="88451-107">Prerequisiti</span><span class="sxs-lookup"><span data-stu-id="88451-107">Prerequisites</span></span>

* <span data-ttu-id="88451-108">**Una sottoscrizione di Azure**.</span><span class="sxs-lookup"><span data-stu-id="88451-108">**An Azure subscription**.</span></span> <span data-ttu-id="88451-109">Vedere [Ottenere una versione di valutazione gratuita di Azure](https://azure.microsoft.com/pricing/free-trial/).</span><span class="sxs-lookup"><span data-stu-id="88451-109">See [Get Azure free trial](https://azure.microsoft.com/pricing/free-trial/).</span></span>
* <span data-ttu-id="88451-110">**Un account Azure Data Lake Store**.</span><span class="sxs-lookup"><span data-stu-id="88451-110">**An Azure Data Lake Store account**.</span></span> <span data-ttu-id="88451-111">Per istruzioni su come toocreate uno, vedere [introduzione archivio Azure Data Lake](data-lake-store-get-started-portal.md).</span><span class="sxs-lookup"><span data-stu-id="88451-111">For instructions on how toocreate one, see [Get started with Azure Data Lake Store](data-lake-store-get-started-portal.md).</span></span>
* <span data-ttu-id="88451-112">**Un cluster Azure HDInsight** con accesso tooa account archivio Data Lake.</span><span class="sxs-lookup"><span data-stu-id="88451-112">**An Azure HDInsight cluster** with access tooa Data Lake Store account.</span></span> <span data-ttu-id="88451-113">Vedere [Creare un cluster HDInsight con Data Lake Store tramite il portale di Azure](data-lake-store-hdinsight-hadoop-use-portal.md).</span><span class="sxs-lookup"><span data-stu-id="88451-113">See [Create an HDInsight cluster with Data Lake Store](data-lake-store-hdinsight-hadoop-use-portal.md).</span></span> <span data-ttu-id="88451-114">Assicurarsi di abilitare Desktop remoto per il cluster hello.</span><span class="sxs-lookup"><span data-stu-id="88451-114">Make sure you enable Remote Desktop for hello cluster.</span></span>
* <span data-ttu-id="88451-115">**Esecuzione di un cluster Storm in Data Lake Store**.</span><span class="sxs-lookup"><span data-stu-id="88451-115">**Running a Storm cluster on Data Lake Store**.</span></span> <span data-ttu-id="88451-116">Per altre informazioni, vedere [Storm in HDInsight](https://docs.microsoft.com/en-us/azure/hdinsight/hdinsight-storm-overview).</span><span class="sxs-lookup"><span data-stu-id="88451-116">For more information, see [Storm on HDInsight](https://docs.microsoft.com/en-us/azure/hdinsight/hdinsight-storm-overview).</span></span>
* <span data-ttu-id="88451-117">**Linee guida per l'ottimizzazione delle prestazioni in Data Lake Store**.</span><span class="sxs-lookup"><span data-stu-id="88451-117">**Performance tuning guidelines on Data Lake Store**.</span></span>  <span data-ttu-id="88451-118">Per i concetti generali relativi alle prestazioni, vedere [Linee guida per l'ottimizzazione delle prestazioni in Data Lake Store](https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-performance-tuning-guidance).</span><span class="sxs-lookup"><span data-stu-id="88451-118">For general performance concepts, see [Data Lake Store Performance Tuning Guidance](https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-performance-tuning-guidance).</span></span>  

## <a name="tune-hello-parallelism-of-hello-topology"></a><span data-ttu-id="88451-119">Ottimizzare il parallelismo hello della topologia hello</span><span class="sxs-lookup"><span data-stu-id="88451-119">Tune hello parallelism of hello topology</span></span>

<span data-ttu-id="88451-120">Potrebbe essere in grado di tooimprove prestazioni dalla concorrenza hello crescente di hello tooand dei / o dall'archivio Data Lake.</span><span class="sxs-lookup"><span data-stu-id="88451-120">You might be able tooimprove performance by increasing hello concurrency of hello I/O tooand from Data Lake Store.</span></span> <span data-ttu-id="88451-121">Una topologia di Storm include un set di configurazioni che determinano il parallelismo hello:</span><span class="sxs-lookup"><span data-stu-id="88451-121">A Storm topology has a set of configurations that determine hello parallelism:</span></span>
* <span data-ttu-id="88451-122">Numero di processi di lavoro (lavoratori hello sono distribuiti uniformemente tra le macchine virtuali hello).</span><span class="sxs-lookup"><span data-stu-id="88451-122">Number of worker processes (hello workers are evenly distributed across hello VMs).</span></span>
* <span data-ttu-id="88451-123">Numero di istanze di executor di spout.</span><span class="sxs-lookup"><span data-stu-id="88451-123">Number of spout executor instances.</span></span>
* <span data-ttu-id="88451-124">Numero di istanze di executor di bolt.</span><span class="sxs-lookup"><span data-stu-id="88451-124">Number of bolt executor instances.</span></span>
* <span data-ttu-id="88451-125">Numero di attività spout.</span><span class="sxs-lookup"><span data-stu-id="88451-125">Number of spout tasks.</span></span>
* <span data-ttu-id="88451-126">Numero di attività bolt.</span><span class="sxs-lookup"><span data-stu-id="88451-126">Number of bolt tasks.</span></span>

<span data-ttu-id="88451-127">Ad esempio, in un cluster con 4 macchine virtuali e i processi di lavoro 4, executor beccuccio 32 e 32 beccuccio attività e 256 executor fulmine e attività fulmine 512, considerare i seguenti hello:</span><span class="sxs-lookup"><span data-stu-id="88451-127">For example, on a cluster with 4 VMs and 4 worker processes, 32 spout executors and 32 spout tasks, and 256 bolt executors and 512 bolt tasks, consider hello following:</span></span>

<span data-ttu-id="88451-128">Ogni supervisore, che è un ruolo di lavoro, ha un singolo processo di lavoro JVM (Java Virtual Machine).</span><span class="sxs-lookup"><span data-stu-id="88451-128">Each supervisor, which is a worker node, has a single worker Java virtual machine (JVM) process.</span></span> <span data-ttu-id="88451-129">Questo processo JVM gestisce 4 thread di spout e 64 thread di bolt.</span><span class="sxs-lookup"><span data-stu-id="88451-129">This JVM process manages 4 spout threads and 64 bolt threads.</span></span> <span data-ttu-id="88451-130">In ogni thread le attività vengono eseguite in sequenza.</span><span class="sxs-lookup"><span data-stu-id="88451-130">Within each thread, tasks are run sequentially.</span></span> <span data-ttu-id="88451-131">Con hello configurazione precedente, ogni thread beccuccio dispone di 1 attività e ogni thread fulmine dispone di 2 attività.</span><span class="sxs-lookup"><span data-stu-id="88451-131">With hello preceding configuration, each spout thread has 1 task, and each bolt thread has 2 tasks.</span></span>

<span data-ttu-id="88451-132">In soprannumero, ecco hello vari componenti coinvolti, e gli effetti di livello hello di parallelismo che è:</span><span class="sxs-lookup"><span data-stu-id="88451-132">In Storm, here are hello various components involved, and how they affect hello level of parallelism you have:</span></span>
* <span data-ttu-id="88451-133">nodo head Hello (chiamato Nimbus in Storm) viene utilizzato toosubmit e gestire i processi.</span><span class="sxs-lookup"><span data-stu-id="88451-133">hello head node (called Nimbus in Storm) is used toosubmit and manage jobs.</span></span> <span data-ttu-id="88451-134">Questi nodi avere alcun impatto sul livello hello di parallelismo.</span><span class="sxs-lookup"><span data-stu-id="88451-134">These nodes have no impact on hello degree of parallelism.</span></span>
* <span data-ttu-id="88451-135">nodi Supervisore Hello.</span><span class="sxs-lookup"><span data-stu-id="88451-135">hello supervisor nodes.</span></span> <span data-ttu-id="88451-136">Corrisponde in HDInsight, il nodo di lavoro tooa macchina virtuale di Azure.</span><span class="sxs-lookup"><span data-stu-id="88451-136">In HDInsight, this corresponds tooa worker node Azure VM.</span></span>
* <span data-ttu-id="88451-137">attività di lavoro Hello sono processi Storm in esecuzione in macchine virtuali hello.</span><span class="sxs-lookup"><span data-stu-id="88451-137">hello worker tasks are Storm processes running in hello VMs.</span></span> <span data-ttu-id="88451-138">Ogni attività di lavoro corrispondente istanza JVM tooa.</span><span class="sxs-lookup"><span data-stu-id="88451-138">Each worker task corresponds tooa JVM instance.</span></span> <span data-ttu-id="88451-139">Storm distribuisce numero hello di processi di lavoro è specificare i nodi di lavoro toohello più uniforme possibile.</span><span class="sxs-lookup"><span data-stu-id="88451-139">Storm distributes hello number of worker processes you specify toohello worker nodes as evenly as possible.</span></span>
* <span data-ttu-id="88451-140">Istanze di executor di spout e bolt.</span><span class="sxs-lookup"><span data-stu-id="88451-140">Spout and bolt executor instances.</span></span> <span data-ttu-id="88451-141">Ogni istanza di executor corrisponde tooa thread in esecuzione all'interno di processi di lavoro hello (JVMs).</span><span class="sxs-lookup"><span data-stu-id="88451-141">Each executor instance corresponds tooa thread running within hello workers (JVMs).</span></span>
* <span data-ttu-id="88451-142">Attività di Storm.</span><span class="sxs-lookup"><span data-stu-id="88451-142">Storm tasks.</span></span> <span data-ttu-id="88451-143">Si tratta di attività logiche eseguite da ognuno di questi thread.</span><span class="sxs-lookup"><span data-stu-id="88451-143">These are logical tasks that each of these threads run.</span></span> <span data-ttu-id="88451-144">Ciò non modifica il livello di hello di parallelismo, pertanto è necessario valutare se è necessario disporre di più attività per l'esecutore o non.</span><span class="sxs-lookup"><span data-stu-id="88451-144">This does not change hello level of parallelism, so you should evaluate if you need multiple tasks per executor or not.</span></span>

### <a name="get-hello-best-performance-from-data-lake-store"></a><span data-ttu-id="88451-145">Ottenere prestazioni ottimali hello dall'archivio Data Lake</span><span class="sxs-lookup"><span data-stu-id="88451-145">Get hello best performance from Data Lake Store</span></span>

<span data-ttu-id="88451-146">Quando si utilizza l'archivio Data Lake, ottenere migliori prestazioni di hello se hello seguenti:</span><span class="sxs-lookup"><span data-stu-id="88451-146">When working with Data Lake Store, you get hello best performance if you do hello following:</span></span>
* <span data-ttu-id="88451-147">Unire le piccole aggiunte in dimensioni maggiori (idealmente 4 MB).</span><span class="sxs-lookup"><span data-stu-id="88451-147">Coalesce your small appends into larger sizes (ideally 4 MB).</span></span>
* <span data-ttu-id="88451-148">Eseguire il maggior numero possibile di richieste simultanee.</span><span class="sxs-lookup"><span data-stu-id="88451-148">Do as many concurrent requests as you can.</span></span> <span data-ttu-id="88451-149">Poiché ogni thread fulmine esegue letture blocco, è auspicabile toohave in un punto qualsiasi nell'intervallo di hello di 8-12 thread per core.</span><span class="sxs-lookup"><span data-stu-id="88451-149">Because each bolt thread is doing blocking reads, you want toohave somewhere in hello range of 8-12 threads per core.</span></span> <span data-ttu-id="88451-150">In questo modo hello NIC e hello CPU utilizzata correttamente.</span><span class="sxs-lookup"><span data-stu-id="88451-150">This keeps hello NIC and hello CPU well utilized.</span></span> <span data-ttu-id="88451-151">Una macchina virtuale più grande consente di eseguire un maggior numero di richieste simultanee.</span><span class="sxs-lookup"><span data-stu-id="88451-151">A larger VM enables more concurrent requests.</span></span>  

### <a name="example-topology"></a><span data-ttu-id="88451-152">Topologia di esempio</span><span class="sxs-lookup"><span data-stu-id="88451-152">Example topology</span></span>

<span data-ttu-id="88451-153">Si supponga di avere un cluster con 8 nodi di lavoro e una macchina virtuale di Azure D13v2.</span><span class="sxs-lookup"><span data-stu-id="88451-153">Let’s assume you have an 8 worker node cluster with a D13v2 Azure VM.</span></span> <span data-ttu-id="88451-154">Questa macchina virtuale con 8 core, pertanto tra hello 8 nodi di lavoro, è necessario 64 core totale.</span><span class="sxs-lookup"><span data-stu-id="88451-154">This VM has 8 cores, so among hello 8 worker nodes, you have 64 total cores.</span></span>

<span data-ttu-id="88451-155">Si supponga di eseguire 8 thread bolt per core.</span><span class="sxs-lookup"><span data-stu-id="88451-155">Let’s say we do 8 bolt threads per core.</span></span> <span data-ttu-id="88451-156">Essendo i core 64, si vuole un totale di 512 istanze dell'executor (ovvero di thread) di bolt.</span><span class="sxs-lookup"><span data-stu-id="88451-156">Given 64 cores, that means we want 512 total bolt executor instances (that is, threads).</span></span> <span data-ttu-id="88451-157">In questo caso, ad esempio, è iniziare con una JVM per ogni macchina virtuale, utilizzare principalmente concorrenza di thread hello all'interno di concorrenza di tooachieve JVM hello.</span><span class="sxs-lookup"><span data-stu-id="88451-157">In this case, let’s say we start with one JVM per VM, and mainly use hello thread concurrency within hello JVM tooachieve concurrency.</span></span> <span data-ttu-id="88451-158">Ciò significa che sono necessari 8 attività di lavoro (uno per ogni macchina virtuale di Azure) e 512 executor bolt.</span><span class="sxs-lookup"><span data-stu-id="88451-158">That means we need 8 worker tasks (one per Azure VM), and 512 bolt executors.</span></span> <span data-ttu-id="88451-159">Questa configurazione di Storm tenta toodistribute hello thread di lavoro in modo uniforme tra i nodi di lavoro (noto anche come nodi di supervisore), assegnando a ciascun nodo di lavoro 1 JVM.</span><span class="sxs-lookup"><span data-stu-id="88451-159">Given this configuration, Storm tries toodistribute hello workers evenly across worker nodes (also known as supervisor nodes), giving each worker node 1 JVM.</span></span> <span data-ttu-id="88451-160">Ora in supervisori hello, Storm tenta executor hello toodistribute in modo uniforme tra i supervisori, assegnando ogni Supervisore (vale a dire JVM) 8 thread ognuno.</span><span class="sxs-lookup"><span data-stu-id="88451-160">Now within hello supervisors, Storm tries toodistribute hello executors evenly between supervisors, giving each supervisor (that is, JVM) 8 threads each.</span></span>

## <a name="tune-additional-parameters"></a><span data-ttu-id="88451-161">Ottimizzare i parametri aggiuntivi</span><span class="sxs-lookup"><span data-stu-id="88451-161">Tune additional parameters</span></span>
<span data-ttu-id="88451-162">Dopo aver creato una topologia di base hello, è possibile considerare se si desidera tootweak uno dei parametri di hello:</span><span class="sxs-lookup"><span data-stu-id="88451-162">After you have hello basic topology, you can consider whether you want tootweak any of hello parameters:</span></span>
* <span data-ttu-id="88451-163">**Number of JVMs per worker node** (Numero di JVM per nodo di lavoro).</span><span class="sxs-lookup"><span data-stu-id="88451-163">**Number of JVMs per worker node.**</span></span> <span data-ttu-id="88451-164">Se si ha una struttura dei dati di grandi dimensioni (ad esempio, tabella di ricerca) che si vuole ospitare in memoria, ogni JVM richiede una copia separata.</span><span class="sxs-lookup"><span data-stu-id="88451-164">If you have a large data structure (for example, a lookup table) that you host in memory, each JVM requires a separate copy.</span></span> <span data-ttu-id="88451-165">In alternativa, è possibile utilizzare la struttura di data hello tra molti thread se si dispone di meno JVMs.</span><span class="sxs-lookup"><span data-stu-id="88451-165">Alternatively, you can use hello data structure across many threads if you have fewer JVMs.</span></span> <span data-ttu-id="88451-166">Per i/o del fulmine hello, numero hello di JVMs non consente più di una differenza come numero hello di thread aggiunti tra tali JVMs.</span><span class="sxs-lookup"><span data-stu-id="88451-166">For hello bolt’s I/O, hello number of JVMs does not make as much of a difference as hello number of threads added across those JVMs.</span></span> <span data-ttu-id="88451-167">Per semplicità, è una buona idea toohave uno JVM per lavoro.</span><span class="sxs-lookup"><span data-stu-id="88451-167">For simplicity, it's a good idea toohave one JVM per worker.</span></span> <span data-ttu-id="88451-168">A seconda delle operazioni del fulmine o applicazione di elaborazione è richiedono, tuttavia, potrebbe essere necessario toochange questo numero.</span><span class="sxs-lookup"><span data-stu-id="88451-168">Depending on what your bolt is doing or what application processing you require, though, you may need toochange this number.</span></span>
* <span data-ttu-id="88451-169">**Number of spout executors** (Numero di executor spout).</span><span class="sxs-lookup"><span data-stu-id="88451-169">**Number of spout executors.**</span></span> <span data-ttu-id="88451-170">Poiché hello esempio precedente Usa bulloni per la scrittura di archivio Lake tooData, numero hello di spouts non è prestazioni fulmine toohello direttamente pertinenti.</span><span class="sxs-lookup"><span data-stu-id="88451-170">Because hello preceding example uses bolts for writing tooData Lake Store, hello number of spouts is not directly relevant toohello bolt performance.</span></span> <span data-ttu-id="88451-171">Tuttavia, a seconda della quantità di hello di elaborazione o i/o in corso nel beccuccio hello, è buona norma hello tootune spouts per prestazioni ottimali.</span><span class="sxs-lookup"><span data-stu-id="88451-171">However, depending on hello amount of processing or I/O happening in hello spout, it's a good idea tootune hello spouts for best performance.</span></span> <span data-ttu-id="88451-172">Assicurarsi di disporre di sufficiente occupato bulloni spouts toobe tookeep in grado di hello.</span><span class="sxs-lookup"><span data-stu-id="88451-172">Ensure that you have enough spouts toobe able tookeep hello bolts busy.</span></span> <span data-ttu-id="88451-173">frequenze di output di Hello di hello spouts devono corrispondere a velocità effettiva di hello di bulloni hello.</span><span class="sxs-lookup"><span data-stu-id="88451-173">hello output rates of hello spouts should match hello throughput of hello bolts.</span></span> <span data-ttu-id="88451-174">la configurazione effettiva Hello dipende da beccuccio hello.</span><span class="sxs-lookup"><span data-stu-id="88451-174">hello actual configuration depends on hello spout.</span></span>
* <span data-ttu-id="88451-175">**Number of tasks** (Numero di attività).</span><span class="sxs-lookup"><span data-stu-id="88451-175">**Number of tasks.**</span></span> <span data-ttu-id="88451-176">Ogni bolt viene eseguito come thread singolo.</span><span class="sxs-lookup"><span data-stu-id="88451-176">Each bolt runs as a single thread.</span></span> <span data-ttu-id="88451-177">Attività aggiuntive sui bolt non forniscono concorrenza aggiuntiva.</span><span class="sxs-lookup"><span data-stu-id="88451-177">Additional tasks per bolt don't provide any additional concurrency.</span></span> <span data-ttu-id="88451-178">Hello solo tempo benefit è se il processo di riconoscimento hello tupla accetta gran parte del tempo di esecuzione fulmine.</span><span class="sxs-lookup"><span data-stu-id="88451-178">hello only time they are of benefit is if your process of acknowledging hello tuple takes a large proportion of your bolt execution time.</span></span> <span data-ttu-id="88451-179">È un toogroup buona numero eccessivo di tuple in un maggiore aggiunta prima di inviare un acknowledgement da fulmine hello.</span><span class="sxs-lookup"><span data-stu-id="88451-179">It's a good idea toogroup many tuples into a larger append before you send an acknowledgement from hello bolt.</span></span> <span data-ttu-id="88451-180">Nella maggior parte dei casi quindi più attività non offrono vantaggi aggiuntivi.</span><span class="sxs-lookup"><span data-stu-id="88451-180">So, in most cases, multiple tasks provide no additional benefit.</span></span>
* <span data-ttu-id="88451-181">**Local or shuffle grouping** (Raggruppamento locale o casuale).</span><span class="sxs-lookup"><span data-stu-id="88451-181">**Local or shuffle grouping.**</span></span> <span data-ttu-id="88451-182">Quando questa impostazione è abilitata, le tuple vengono inviate toobolts all'interno di hello stesso processo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="88451-182">When this setting is enabled, tuples are sent toobolts within hello same worker process.</span></span> <span data-ttu-id="88451-183">In questo modo si riduce il numero di comunicazioni tra processi e chiamate di rete.</span><span class="sxs-lookup"><span data-stu-id="88451-183">This reduces inter-process communication and network calls.</span></span> <span data-ttu-id="88451-184">Tale operazione è consigliata per la maggior parte delle topologie.</span><span class="sxs-lookup"><span data-stu-id="88451-184">This is recommended for most topologies.</span></span>

<span data-ttu-id="88451-185">Questo scenario di base è un buon punto di partenza.</span><span class="sxs-lookup"><span data-stu-id="88451-185">This basic scenario is a good starting point.</span></span> <span data-ttu-id="88451-186">Eseguire test con la propria hello tootweak dati prima di ottenere prestazioni ottimali tooachieve parametri.</span><span class="sxs-lookup"><span data-stu-id="88451-186">Test with your own data tootweak hello preceding parameters tooachieve optimal performance.</span></span>

## <a name="tune-hello-spout"></a><span data-ttu-id="88451-187">Ottimizzare beccuccio hello</span><span class="sxs-lookup"><span data-stu-id="88451-187">Tune hello spout</span></span>

<span data-ttu-id="88451-188">È possibile modificare hello impostazioni tootune hello beccuccio seguente.</span><span class="sxs-lookup"><span data-stu-id="88451-188">You can modify hello following settings tootune hello spout.</span></span>

- <span data-ttu-id="88451-189">**Tuple timeout: topology.message.timeout.secs** (Timeout tuple: topology.message.timeout.secs).</span><span class="sxs-lookup"><span data-stu-id="88451-189">**Tuple timeout: topology.message.timeout.secs**.</span></span> <span data-ttu-id="88451-190">Questa impostazione determina hello quantità di tempo un messaggio toocomplete e ricevere acknowledgement, prima di essere considerato non riuscito.</span><span class="sxs-lookup"><span data-stu-id="88451-190">This setting determines hello amount of time a message takes toocomplete, and receive acknowledgement, before it is considered failed.</span></span>

- <span data-ttu-id="88451-191">**Max memory per worker process: worker.childopts** (Memoria massima per processo di lavoro: worker.childopts).</span><span class="sxs-lookup"><span data-stu-id="88451-191">**Max memory per worker process: worker.childopts**.</span></span> <span data-ttu-id="88451-192">Questa impostazione consente di specificare ulteriori parametri della riga di comando toohello Java lavoratori.</span><span class="sxs-lookup"><span data-stu-id="88451-192">This setting lets you specify additional command-line parameters toohello Java workers.</span></span> <span data-ttu-id="88451-193">impostazione più diffuse Hello è XmX, che determina l'heap hello memoria massima allocata tooa JVM.</span><span class="sxs-lookup"><span data-stu-id="88451-193">hello most commonly used setting here is XmX, which determines hello maximum memory allocated tooa JVM’s heap.</span></span>

- <span data-ttu-id="88451-194">**Max spout pending: topology.max.spout.pending** (Spout massimo in sospeso: topology.max.spout.pending).</span><span class="sxs-lookup"><span data-stu-id="88451-194">**Max spout pending: topology.max.spout.pending**.</span></span> <span data-ttu-id="88451-195">Questa impostazione determina il numero di hello di tuple che è possibile in fase di trasferimento (non riconosciuti in tutti i nodi nella topologia hello) per ogni thread beccuccio in qualsiasi momento.</span><span class="sxs-lookup"><span data-stu-id="88451-195">This setting determines hello number of tuples that can in be flight (not yet acknowledged at all nodes in hello topology) per spout thread at any time.</span></span>

 <span data-ttu-id="88451-196">Toodo un buon calcolo è dimensioni hello tooestimate di ogni le tuple.</span><span class="sxs-lookup"><span data-stu-id="88451-196">A good calculation toodo is tooestimate hello size of each of your tuples.</span></span> <span data-ttu-id="88451-197">Quindi capire di quanta memoria dispone un thread spout.</span><span class="sxs-lookup"><span data-stu-id="88451-197">Then figure out how much memory one spout thread has.</span></span> <span data-ttu-id="88451-198">Hello memoria totale allocata thread tooa, diviso per questo valore, viene fornito il limite superiore di hello per beccuccio max di hello in sospeso di parametro.</span><span class="sxs-lookup"><span data-stu-id="88451-198">hello total memory allocated tooa thread, divided by this value, should give you hello upper bound for hello max spout pending parameter.</span></span>

## <a name="tune-hello-bolt"></a><span data-ttu-id="88451-199">Ottimizzare fulmine hello</span><span class="sxs-lookup"><span data-stu-id="88451-199">Tune hello bolt</span></span>
<span data-ttu-id="88451-200">Quando si scrive archivio Lake tooData, impostare un criterio di sincronizzazione (buffer sul lato client hello) di dimensioni too4 MB.</span><span class="sxs-lookup"><span data-stu-id="88451-200">When you're writing tooData Lake Store, set a size sync policy (buffer on hello client side) too4 MB.</span></span> <span data-ttu-id="88451-201">Lo scaricamento di hsync() viene quindi eseguita solo quando sono di dimensioni del buffer hello hello questo valore.</span><span class="sxs-lookup"><span data-stu-id="88451-201">A flushing or hsync() is then performed only when hello buffer size is hello at this value.</span></span> <span data-ttu-id="88451-202">driver di archivio Data Lake Hello in lavoro hello VM effettua automaticamente l'utilizzo del buffer, a meno che non si esegue in modo esplicito un hsync().</span><span class="sxs-lookup"><span data-stu-id="88451-202">hello Data Lake Store driver on hello worker VM automatically does this buffering, unless you explicitly perform an hsync().</span></span>

<span data-ttu-id="88451-203">fulmine tempesta di archivio Data Lake di Hello predefinito ha un parametro di criteri di sincronizzazione di dimensioni (fileBufferSize) che può essere utilizzati tootune questo parametro.</span><span class="sxs-lookup"><span data-stu-id="88451-203">hello default Data Lake Store Storm bolt has a size sync policy parameter (fileBufferSize) that can be used tootune this parameter.</span></span>

<span data-ttu-id="88451-204">Nelle topologie dei / O-con utilizzo intensivo è toohave una buona idea ogni thread di fulmine scrivere file proprio tooits e tooset un criterio di rotazione di file (fileRotationSize).</span><span class="sxs-lookup"><span data-stu-id="88451-204">In I/O-intensive topologies, it's a good idea toohave each bolt thread write tooits own file, and tooset a file rotation policy (fileRotationSize).</span></span> <span data-ttu-id="88451-205">Quando il file hello raggiunge una determinata dimensione, flusso hello viene scaricata automaticamente e viene scritto un nuovo file.</span><span class="sxs-lookup"><span data-stu-id="88451-205">When hello file reaches a certain size, hello stream is automatically flushed and a new file is written to.</span></span> <span data-ttu-id="88451-206">dimensioni file per la rotazione consigliata Hello è 1 GB.</span><span class="sxs-lookup"><span data-stu-id="88451-206">hello recommended file size for rotation is 1 GB.</span></span>

### <a name="handle-tuple-data"></a><span data-ttu-id="88451-207">Gestire i dati delle tuple</span><span class="sxs-lookup"><span data-stu-id="88451-207">Handle tuple data</span></span>

<span data-ttu-id="88451-208">In soprannumero, beccuccio viene mantenuto nella tupla tooa fino a quando non è riconosciuto in modo esplicito da fulmine hello.</span><span class="sxs-lookup"><span data-stu-id="88451-208">In Storm, a spout holds on tooa tuple until it is explicitly acknowledged by hello bolt.</span></span> <span data-ttu-id="88451-209">Se è stato letto dal fulmine hello una tupla, ma non è ancora stata riconosciuta, beccuccio hello potrebbe non sono persistenti nel back-end di archivio Data Lake.</span><span class="sxs-lookup"><span data-stu-id="88451-209">If a tuple has been read by hello bolt but has not been acknowledged yet, hello spout might not have persisted into Data Lake Store back end.</span></span> <span data-ttu-id="88451-210">Dopo una tupla viene riconosciuta, può essere garantita la persistenza dal fulmine hello beccuccio hello e quindi è stato possibile eliminare i dati di origine hello da qualsiasi origine che sta leggendo da.</span><span class="sxs-lookup"><span data-stu-id="88451-210">After a tuple is acknowledged, hello spout can be guaranteed persistence by hello bolt, and can then delete hello source data from whatever source it is reading from.</span></span>  

<span data-ttu-id="88451-211">Per prestazioni ottimali in archivio Data Lake, avere fulmine hello buffer a 4 MB di dati di tupla.</span><span class="sxs-lookup"><span data-stu-id="88451-211">For best performance on Data Lake Store, have hello bolt buffer 4 MB of tuple data.</span></span> <span data-ttu-id="88451-212">Quindi scrivere toohello nuovo archivio Data Lake terminare come un'operazione di scrittura 4 MB.</span><span class="sxs-lookup"><span data-stu-id="88451-212">Then write toohello Data Lake Store back end as one 4-MB write.</span></span> <span data-ttu-id="88451-213">Dopo che i dati hello sono stata scritta correttamente toohello archivio (dal chiamante hflush()), fulmine hello può riguardare hello dati back-toohello beccuccio.</span><span class="sxs-lookup"><span data-stu-id="88451-213">After hello data has been successfully written toohello store (by calling hflush()), hello bolt can acknowledge hello data back toohello spout.</span></span> <span data-ttu-id="88451-214">Si tratta di quali esempio hello bullone non qui.</span><span class="sxs-lookup"><span data-stu-id="88451-214">This is what hello example bolt supplied here does.</span></span> <span data-ttu-id="88451-215">È inoltre accettabile toohold un maggior numero di tuple prima che venga effettuata chiamata hflush() hello e hello tuple riconosciute.</span><span class="sxs-lookup"><span data-stu-id="88451-215">It is also acceptable toohold a larger number of tuples before hello hflush() call is made and hello tuples acknowledged.</span></span> <span data-ttu-id="88451-216">Tuttavia, ciò aumenta il numero di hello di tuple in fase di trasferimento che necessita di beccuccio hello toohold e pertanto aumenta hello quantità di memoria richiesta per JVM.</span><span class="sxs-lookup"><span data-stu-id="88451-216">However, this increases hello number of tuples in flight that hello spout needs toohold, and therefore increases hello amount of memory required per JVM.</span></span>

> [!NOTE]
<span data-ttu-id="88451-217">Applicazioni potrebbe essere presente una tuple tooacknowledge requisito più di frequente (in dimensioni di dati inferiori a 4 MB) per altri motivi di prestazioni non.</span><span class="sxs-lookup"><span data-stu-id="88451-217">Applications might have a requirement tooacknowledge tuples more frequently (at data sizes less than 4 MB) for other non-performance reasons.</span></span> <span data-ttu-id="88451-218">Tuttavia, che potrebbe influenzare hello i/o della velocità effettiva toohello archiviazione back-end.</span><span class="sxs-lookup"><span data-stu-id="88451-218">However, that might affect hello I/O throughput toohello storage back end.</span></span> <span data-ttu-id="88451-219">Valutare con attenzione questo compromesso rispetto alle prestazioni dei / o del fulmine hello.</span><span class="sxs-lookup"><span data-stu-id="88451-219">Carefully weigh this tradeoff against hello bolt’s I/O performance.</span></span>

<span data-ttu-id="88451-220">Se frequenza in ingresso di hello di tuple è non è elevato, pertanto il buffer di 4 MB hello accetta un toofill molto tempo, considerare il problema, riduzione del rischio:</span><span class="sxs-lookup"><span data-stu-id="88451-220">If hello incoming rate of tuples is not high, so hello 4-MB buffer takes a long time toofill, consider mitigating this by:</span></span>
* <span data-ttu-id="88451-221">Ridurre il numero di hello di bulloni, pertanto esistono toofill un minor numero di buffer.</span><span class="sxs-lookup"><span data-stu-id="88451-221">Reducing hello number of bolts, so there are fewer buffers toofill.</span></span>
* <span data-ttu-id="88451-222">Con un criterio basato sul tempo o basate sul conteggio, in cui un hflush() viene attivato ogni x scaricamenti o ogni millisecondi y e tuple hello accumulate finora sono riconosciute back.</span><span class="sxs-lookup"><span data-stu-id="88451-222">Having a time-based or count-based policy, where an hflush() is triggered every x flushes or every y milliseconds, and hello tuples accumulated so far are acknowledged back.</span></span>

<span data-ttu-id="88451-223">Si noti che in questo caso la velocità effettiva hello è inferiore, ma con una frequenza lenta degli eventi, velocità effettiva massima non obiettivo principale di hello comunque.</span><span class="sxs-lookup"><span data-stu-id="88451-223">Note that hello throughput in this case is lower, but with a slow rate of events, maximum throughput is not hello biggest objective anyway.</span></span> <span data-ttu-id="88451-224">Queste soluzioni consentono di ridurre il tempo totale di hello impiegata per un tooflow tupla tramite toohello store.</span><span class="sxs-lookup"><span data-stu-id="88451-224">These mitigations help you reduce hello total time that it takes for a tuple tooflow through toohello store.</span></span> <span data-ttu-id="88451-225">Questo potrebbe essere importante se è necessaria una pipeline in tempo reale anche con una frequenza di eventi bassa.</span><span class="sxs-lookup"><span data-stu-id="88451-225">This might matter if you want a real-time pipeline even with a low event rate.</span></span> <span data-ttu-id="88451-226">Si noti inoltre che, se la frequenza in ingresso di tupla è bassa, è necessario regolare parametro topology.message.timeout_secs hello, in modo hello Tuple non è previsto un timeout mentre ricevono memorizzato nel buffer o elaborato.</span><span class="sxs-lookup"><span data-stu-id="88451-226">Also note that if your incoming tuple rate is low, you should adjust hello topology.message.timeout_secs parameter, so hello tuples don’t time out while they are getting buffered or processed.</span></span>

## <a name="monitor-your-topology-in-storm"></a><span data-ttu-id="88451-227">Monitorare la topologia in Storm</span><span class="sxs-lookup"><span data-stu-id="88451-227">Monitor your topology in Storm</span></span>  
<span data-ttu-id="88451-228">Durante l'esecuzione di una topologia, è possibile monitorare e nell'interfaccia utente di Storm hello.</span><span class="sxs-lookup"><span data-stu-id="88451-228">While your topology is running, you can monitor it in hello Storm user interface.</span></span> <span data-ttu-id="88451-229">Di seguito sono toolook parametri principali hello in:</span><span class="sxs-lookup"><span data-stu-id="88451-229">Here are hello main parameters toolook at:</span></span>

* <span data-ttu-id="88451-230">**Total process execution latency** (Latenza totale di esecuzione del processo).</span><span class="sxs-lookup"><span data-stu-id="88451-230">**Total process execution latency.**</span></span> <span data-ttu-id="88451-231">Questo è il tempo medio di hello una tupla accetta toobe emessa beccuccio hello, elaborati da fulmine hello e riconosciuto.</span><span class="sxs-lookup"><span data-stu-id="88451-231">This is hello average time one tuple takes toobe emitted by hello spout, processed by hello bolt, and acknowledged.</span></span>

* <span data-ttu-id="88451-232">**Total bolt process latency** (Latenza totale del processo dei bolt).</span><span class="sxs-lookup"><span data-stu-id="88451-232">**Total bolt process latency.**</span></span> <span data-ttu-id="88451-233">Si tratta di hello permanenza Media tupla hello in fulmine hello finché non viene ricevuto un acknowledgement.</span><span class="sxs-lookup"><span data-stu-id="88451-233">This is hello average time spent by hello tuple at hello bolt until it receives an acknowledgement.</span></span>

* <span data-ttu-id="88451-234">**Total bolt execute latency** (Latenza totale di esecuzione dei bolt).</span><span class="sxs-lookup"><span data-stu-id="88451-234">**Total bolt execute latency.**</span></span> <span data-ttu-id="88451-235">Si tratta di hello Media tempo fulmine hello in hello utilizzato dal metodo execute.</span><span class="sxs-lookup"><span data-stu-id="88451-235">This is hello average time spent by hello bolt in hello execute method.</span></span>

* <span data-ttu-id="88451-236">**Number of failures** (Numero di errori).</span><span class="sxs-lookup"><span data-stu-id="88451-236">**Number of failures.**</span></span> <span data-ttu-id="88451-237">Si riferisce toohello numero di tuple che non è stato possibile toobe elaborato completamente prima che di timeout.</span><span class="sxs-lookup"><span data-stu-id="88451-237">This refers toohello number of tuples that failed toobe fully processed before they timed out.</span></span>

* <span data-ttu-id="88451-238">**Capacity** (Capacità).</span><span class="sxs-lookup"><span data-stu-id="88451-238">**Capacity.**</span></span> <span data-ttu-id="88451-239">Misura del carico di lavoro del sistema.</span><span class="sxs-lookup"><span data-stu-id="88451-239">This is a measure of how busy your system is.</span></span> <span data-ttu-id="88451-240">Se questo numero è 1, i bolt stanno lavorando al massimo della velocità.</span><span class="sxs-lookup"><span data-stu-id="88451-240">If this number is 1, your bolts are working as fast as they can.</span></span> <span data-ttu-id="88451-241">Se è minore di 1, aumentare il parallelismo hello.</span><span class="sxs-lookup"><span data-stu-id="88451-241">If it is less than 1, increase hello parallelism.</span></span> <span data-ttu-id="88451-242">Se è maggiore di 1, ridurre il parallelismo hello.</span><span class="sxs-lookup"><span data-stu-id="88451-242">If it is greater than 1, reduce hello parallelism.</span></span>

## <a name="troubleshoot-common-problems"></a><span data-ttu-id="88451-243">Risolvere i problemi comuni</span><span class="sxs-lookup"><span data-stu-id="88451-243">Troubleshoot common problems</span></span>
<span data-ttu-id="88451-244">Ecco alcuni scenari comuni per la risoluzione dei problemi.</span><span class="sxs-lookup"><span data-stu-id="88451-244">Here are a few common troubleshooting scenarios.</span></span>
* <span data-ttu-id="88451-245">**È in corso il timeout di diverse tuple.** Esaminare ogni nodo hello topologia toodetermine dove collo di bottiglia hello è.</span><span class="sxs-lookup"><span data-stu-id="88451-245">**Many tuples are timing out.** Look at each node in hello topology toodetermine where hello bottleneck is.</span></span> <span data-ttu-id="88451-246">Hello più comuni questo accade che bulloni hello non sono in grado di tookeep backup con spouts hello.</span><span class="sxs-lookup"><span data-stu-id="88451-246">hello most common reason for this is that hello bolts are not able tookeep up with hello spouts.</span></span> <span data-ttu-id="88451-247">In tal modo tootuples sommersa da buffer interni di hello durante l'attesa toobe elaborati.</span><span class="sxs-lookup"><span data-stu-id="88451-247">This leads tootuples clogging hello internal buffers while waiting toobe processed.</span></span> <span data-ttu-id="88451-248">È consigliabile aumentare il valore di timeout hello o riducendo beccuccio max di hello in sospeso.</span><span class="sxs-lookup"><span data-stu-id="88451-248">Consider increasing hello timeout value or decreasing hello max spout pending.</span></span>

* <span data-ttu-id="88451-249">**La latenza di esecuzione dei processi totale è elevata, ma la latenza dei processi bolt è bassa.**</span><span class="sxs-lookup"><span data-stu-id="88451-249">**There is a high total process execution latency, but a low bolt process latency.**</span></span> <span data-ttu-id="88451-250">In questo caso, è possibile che le tuple hello non sono riconosciute sufficientemente veloce.</span><span class="sxs-lookup"><span data-stu-id="88451-250">In this case, it is possible that hello tuples are not being acknowledged fast enough.</span></span> <span data-ttu-id="88451-251">Verificare che sia presente un numero sufficiente di elementi di acknowledgment.</span><span class="sxs-lookup"><span data-stu-id="88451-251">Check that there are a sufficient number of acknowledgers.</span></span> <span data-ttu-id="88451-252">Un'altra possibilità consiste nel fatto che sono in attesa nella coda di hello per troppo tempo prima di avviare l'elaborazione di bulloni hello.</span><span class="sxs-lookup"><span data-stu-id="88451-252">Another possibility is that they are waiting in hello queue for too long before hello bolts start processing them.</span></span> <span data-ttu-id="88451-253">Ridurre beccuccio max di hello in sospeso.</span><span class="sxs-lookup"><span data-stu-id="88451-253">Decrease hello max spout pending.</span></span>

* <span data-ttu-id="88451-254">**La latenza di esecuzione dei bolt è elevata.**</span><span class="sxs-lookup"><span data-stu-id="88451-254">**There is a high bolt execute latency.**</span></span> <span data-ttu-id="88451-255">Ciò significa che il metodo Execute () hello del fulmine sta richiedendo troppo tempo.</span><span class="sxs-lookup"><span data-stu-id="88451-255">This means that hello execute() method of your bolt is taking too long.</span></span> <span data-ttu-id="88451-256">Ottimizza codice hello, o esaminare le dimensioni di scrittura e il comportamento di scaricamento.</span><span class="sxs-lookup"><span data-stu-id="88451-256">Optimize hello code, or look at write sizes and flush behavior.</span></span>

### <a name="data-lake-store-throttling"></a><span data-ttu-id="88451-257">Limitazione di Data Lake Store</span><span class="sxs-lookup"><span data-stu-id="88451-257">Data Lake Store throttling</span></span>
<span data-ttu-id="88451-258">Se si raggiunge i limiti di hello di larghezza di banda fornita dall'archivio Data Lake, potrebbero verificarsi errori di attività.</span><span class="sxs-lookup"><span data-stu-id="88451-258">If you hit hello limits of bandwidth provided by Data Lake Store, you might see task failures.</span></span> <span data-ttu-id="88451-259">Cercare errori di limitazione nei log delle attività.</span><span class="sxs-lookup"><span data-stu-id="88451-259">Check task logs for throttling errors.</span></span> <span data-ttu-id="88451-260">È possibile ridurre il parallelismo hello mediante l'aumento delle dimensioni del contenitore.</span><span class="sxs-lookup"><span data-stu-id="88451-260">You can decrease hello parallelism by increasing container size.</span></span>    

<span data-ttu-id="88451-261">toocheck se sono recupero limitate, abilitare il debug di hello registrazione sul lato client hello:</span><span class="sxs-lookup"><span data-stu-id="88451-261">toocheck if you are getting throttled, enable hello debug logging on hello client side:</span></span>

1. <span data-ttu-id="88451-262">In **Ambari** > **Storm** > **Config** > **avanzate storm-worker-log4j**, modifica  **&lt;radice livello = "info"&gt;**  troppo**&lt;radice livello = "debug"&gt;**.</span><span class="sxs-lookup"><span data-stu-id="88451-262">In **Ambari** > **Storm** > **Config** > **Advanced storm-worker-log4j**, change **&lt;root level="info"&gt;** too**&lt;root level=”debug”&gt;**.</span></span> <span data-ttu-id="88451-263">Riavviare tutti i nodi di hello/servizio per effetto di tootake configurazione hello.</span><span class="sxs-lookup"><span data-stu-id="88451-263">Restart all hello nodes/service for hello configuration tootake effect.</span></span>
2. <span data-ttu-id="88451-264">Monitoraggio hello Storm topologia accede nodi di lavoro (in /var/log/storm/worker-artifacts /&lt;TopologyName&gt;/&lt;porta&gt;/worker.log) per la limitazione delle richieste di eccezioni da archivio Data Lake.</span><span class="sxs-lookup"><span data-stu-id="88451-264">Monitor hello Storm topology logs on worker nodes (under /var/log/storm/worker-artifacts/&lt;TopologyName&gt;/&lt;port&gt;/worker.log) for Data Lake Store throttling exceptions.</span></span>

## <a name="next-steps"></a><span data-ttu-id="88451-265">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="88451-265">Next steps</span></span>
<span data-ttu-id="88451-266">L'ottimizzazione aggiuntiva delle prestazioni di Storm è reperibile in questo [blog](https://blogs.msdn.microsoft.com/shanyu/2015/05/14/performance-tuning-for-hdinsight-storm-and-microsoft-azure-eventhubs/).</span><span class="sxs-lookup"><span data-stu-id="88451-266">Additional performance tuning for Storm can be referenced in [this blog](https://blogs.msdn.microsoft.com/shanyu/2015/05/14/performance-tuning-for-hdinsight-storm-and-microsoft-azure-eventhubs/).</span></span>

<span data-ttu-id="88451-267">Per un toorun esempi aggiuntivi, vedere [questo su GitHub](https://github.com/hdinsight/storm-performance-automation).</span><span class="sxs-lookup"><span data-stu-id="88451-267">For an additional example toorun, see [this one on GitHub](https://github.com/hdinsight/storm-performance-automation).</span></span>
