---
title: "un'applicazione di SharePoint a più livelli usando Azure Site Recovery aaaReplicate | Documenti Microsoft"
description: "Questo articolo viene descritto come tooreplicate un'applicazione di SharePoint a più livelli con funzionalità di Azure Site Recovery."
services: site-recovery
documentationcenter: 
author: sujayt
manager: rochakm
editor: 
ms.assetid: 
ms.service: site-recovery
ms.workload: storage-backup-recovery
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 05/10/2017
ms.author: sutalasi
ms.openlocfilehash: d856034ac2a3c95b0c1f0cf85e62c4e7a5a3210f
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/06/2017
---
# <a name="replicate-a-multi-tier-sharepoint-application-for-disaster-recovery-using-azure-site-recovery"></a><span data-ttu-id="9090e-103">Eseguire la replica di un'applicazione di SharePoint multilivello per il ripristino di emergenza con Azure Site Recovery</span><span class="sxs-lookup"><span data-stu-id="9090e-103">Replicate a multi-tier SharePoint application for disaster recovery using Azure Site Recovery</span></span>

<span data-ttu-id="9090e-104">In questo articolo descrive in dettaglio come un'applicazione di SharePoint con tooprotect [Azure Site Recovery](site-recovery-overview.md).</span><span class="sxs-lookup"><span data-stu-id="9090e-104">This article describes in detail how tooprotect a SharePoint application using  [Azure Site Recovery](site-recovery-overview.md).</span></span>


## <a name="overview"></a><span data-ttu-id="9090e-105">Panoramica</span><span class="sxs-lookup"><span data-stu-id="9090e-105">Overview</span></span>

<span data-ttu-id="9090e-106">Microsoft SharePoint è una potente applicazione che può aiutare un gruppo o un reparto a organizzare e condividere informazioni collaborando.</span><span class="sxs-lookup"><span data-stu-id="9090e-106">Microsoft SharePoint is a powerful application that can help a group or department organize, collaborate, and share information.</span></span> <span data-ttu-id="9090e-107">SharePoint offre portali Intranet, gestione di documenti e file, collaborazione, social network, reti Extranet, siti Web, ricerca di livello aziendale e business intelligence.</span><span class="sxs-lookup"><span data-stu-id="9090e-107">SharePoint can provide intranet portals, document and file management, collaboration, social networks, extranets, websites, enterprise search, and business intelligence.</span></span> <span data-ttu-id="9090e-108">Include inoltre funzionalità di integrazione dei sistemi, integrazione dei processi e automazione dei flussi di lavoro.</span><span class="sxs-lookup"><span data-stu-id="9090e-108">It also has system integration, process integration, and workflow automation capabilities.</span></span> <span data-ttu-id="9090e-109">In genere, le organizzazioni viene considerano come una livello 1 applicazione riservata toodowntime e perdita di dati.</span><span class="sxs-lookup"><span data-stu-id="9090e-109">Typically, organizations consider it as a Tier-1 application sensitive toodowntime and data loss.</span></span>

<span data-ttu-id="9090e-110">Oggi Microsoft SharePoint non include funzionalità di ripristino di emergenza predefinite.</span><span class="sxs-lookup"><span data-stu-id="9090e-110">Today, Microsoft SharePoint  does not provide any out-of-the-box disaster recovery capabilities.</span></span> <span data-ttu-id="9090e-111">Indipendentemente dal tipo hello e la scala di una situazione di emergenza, ripristino prevede l'uso di hello di un centro dati di standby che è possibile ripristinare la farm hello.</span><span class="sxs-lookup"><span data-stu-id="9090e-111">Regardless of hello type and scale of a disaster, recovery involves hello use of a standby data center that you can recover hello farm to.</span></span> <span data-ttu-id="9090e-112">Standby data center sono necessari per gli scenari in cui i sistemi di archiviazione con ridondanza locali e backup ingestibile interruzione hello in hello data center principale.</span><span class="sxs-lookup"><span data-stu-id="9090e-112">Standby data centers are required for scenarios where local redundant systems and backups cannot recover from hello outage at hello primary data center.</span></span>

<span data-ttu-id="9090e-113">Una soluzione di ripristino di emergenza valida deve consentire la modellazione di piani di ripristino intorno architetture di applicazioni complesse hello, ad esempio SharePoint.</span><span class="sxs-lookup"><span data-stu-id="9090e-113">A good disaster recovery solution should allow modeling of recovery plans around hello  complex application architectures such as SharePoint.</span></span> <span data-ttu-id="9090e-114">Deve inoltre essere hello possibilità tooadd personalizzato passaggi toohandle applicazione mapping tra i vari livelli e fornendo un failover con clic singolo con un RTO inferiore nell'evento hello un'emergenza.</span><span class="sxs-lookup"><span data-stu-id="9090e-114">It should also have hello ability tooadd customized steps toohandle application mappings between various tiers and hence providing a single-click failover with a lower RTO in hello event of a disaster.</span></span>

<span data-ttu-id="9090e-115">In questo articolo descrive in dettaglio come un'applicazione di SharePoint con tooprotect [Azure Site Recovery](site-recovery-overview.md).</span><span class="sxs-lookup"><span data-stu-id="9090e-115">This article describes in detail how tooprotect a SharePoint application using [Azure Site Recovery](site-recovery-overview.md).</span></span> <span data-ttu-id="9090e-116">In questo articolo verrà illustrate le procedure consigliate per la replica di un tooAzure di applicazione di SharePoint a tre livelli, come è possibile eseguire un'analisi di ripristino di emergenza e come è possibile tooAzure applicazione hello di failover.</span><span class="sxs-lookup"><span data-stu-id="9090e-116">This article will cover best practices for replicating a three tier SharePoint application tooAzure, how you can do a disaster recovery drill, and how you can failover hello application tooAzure.</span></span>

<span data-ttu-id="9090e-117">È possibile controllare hello seguito video sul ripristino di un tooAzure di applicazione di livello più.</span><span class="sxs-lookup"><span data-stu-id="9090e-117">You can watch hello below video about recovering a multi tier application tooAzure.</span></span>

> [!VIDEO https://channel9.msdn.com/Series/Azure-Site-Recovery/Disaster-Recovery-of-load-balanced-multi-tier-applications-using-Azure-Site-Recovery/player]


## <a name="prerequisites"></a><span data-ttu-id="9090e-118">Prerequisiti</span><span class="sxs-lookup"><span data-stu-id="9090e-118">Prerequisites</span></span>

<span data-ttu-id="9090e-119">Prima di iniziare, assicurarsi di che aver compreso l'esempio hello:</span><span class="sxs-lookup"><span data-stu-id="9090e-119">Before you start, make sure you understand hello following:</span></span>

1. [<span data-ttu-id="9090e-120">La replica tooAzure una macchina virtuale</span><span class="sxs-lookup"><span data-stu-id="9090e-120">Replicating a virtual machine tooAzure</span></span>](site-recovery-vmware-to-azure.md)
2. <span data-ttu-id="9090e-121">Come troppo[progettare una rete di ripristino](site-recovery-network-design.md)</span><span class="sxs-lookup"><span data-stu-id="9090e-121">How too[design a recovery network](site-recovery-network-design.md)</span></span>
3. [<span data-ttu-id="9090e-122">Esegue un tooAzure di failover di test</span><span class="sxs-lookup"><span data-stu-id="9090e-122">Doing a test failover tooAzure</span></span>](site-recovery-test-failover-to-azure.md)
4. [<span data-ttu-id="9090e-123">Eseguire un failover tooAzure</span><span class="sxs-lookup"><span data-stu-id="9090e-123">Doing a failover tooAzure</span></span>](site-recovery-failover.md)
5. <span data-ttu-id="9090e-124">Come troppo[replicare un controller di dominio](site-recovery-active-directory.md)</span><span class="sxs-lookup"><span data-stu-id="9090e-124">How too[replicate a domain controller](site-recovery-active-directory.md)</span></span>
6. <span data-ttu-id="9090e-125">Come troppo[la replica di SQL Server](site-recovery-sql.md)</span><span class="sxs-lookup"><span data-stu-id="9090e-125">How too[replicate SQL Server](site-recovery-sql.md)</span></span>

## <a name="sharepoint-architecture"></a><span data-ttu-id="9090e-126">Architettura di SharePoint</span><span class="sxs-lookup"><span data-stu-id="9090e-126">SharePoint architecture</span></span>

<span data-ttu-id="9090e-127">SharePoint può essere distribuito in uno o più server usando topologie a livelli e ruoli di server tooimplement una progettazione di farm che soddisfi gli obiettivi e obiettivi specifici.</span><span class="sxs-lookup"><span data-stu-id="9090e-127">SharePoint can be deployed on one or more servers using tiered topologies and server roles tooimplement a farm design that meets specific goals and objectives.</span></span> <span data-ttu-id="9090e-128">Una tipica server farm di SharePoint con esigenze e dimensioni elevate che supporta molti utenti simultanei ed elementi di contenuto usa il raggruppamento dei servizi come parte della strategia di scalabilità.</span><span class="sxs-lookup"><span data-stu-id="9090e-128">A typical large, high-demand SharePoint server farm that supports a high number of concurrent users and a large number of content items use service grouping as part of their scalability strategy.</span></span> <span data-ttu-id="9090e-129">Questo approccio prevede l'esecuzione di servizi su server dedicati, raggruppare questi servizi e la scalabilità orizzontale server hello come gruppo.</span><span class="sxs-lookup"><span data-stu-id="9090e-129">This approach involves running services on dedicated servers, grouping these services together, and then scaling out hello servers as a group.</span></span> <span data-ttu-id="9090e-130">Hello topologia seguente viene illustrato il servizio di hello e server per una server farm di SharePoint a tre livelli di raggruppamento.</span><span class="sxs-lookup"><span data-stu-id="9090e-130">hello following topology illustrates hello service and server grouping for a three tier SharePoint server farm.</span></span> <span data-ttu-id="9090e-131">Per indicazioni dettagliate sulle diverse topologie di SharePoint, vedere tooSharePoint documentazione e le architetture di riga del prodotto.</span><span class="sxs-lookup"><span data-stu-id="9090e-131">Please refer tooSharePoint documentation and product line architectures for detailed guidance on different SharePoint topologies.</span></span> <span data-ttu-id="9090e-132">Altre informazioni sulla distribuzione di SharePoint 2013 sono disponibili in [questo documento](https://technet.microsoft.com/en-us/library/cc303422.aspx).</span><span class="sxs-lookup"><span data-stu-id="9090e-132">You can find more details about SharePoint 2013 deployment in [this document](https://technet.microsoft.com/en-us/library/cc303422.aspx).</span></span>



![Modello di distribuzione 1](./media/site-recovery-sharepoint/sharepointarch.png)


## <a name="site-recovery-support"></a><span data-ttu-id="9090e-134">Supporto di Site Recovery</span><span class="sxs-lookup"><span data-stu-id="9090e-134">Site Recovery support</span></span>

<span data-ttu-id="9090e-135">Ai fini di questo articolo sono state usate macchine virtuali VMware con Windows Server 2012 R2 Enterprise.</span><span class="sxs-lookup"><span data-stu-id="9090e-135">For creating this article, VMware virtual machines with Windows Server 2012 R2 Enterprise were used.</span></span> <span data-ttu-id="9090e-136">Sono stati usati SharePoint 2013 Enterprise Edition e SQL Server 2014 Enterprise Edition.</span><span class="sxs-lookup"><span data-stu-id="9090e-136">SharePoint 2013 Enterprise edition and SQL server 2014 Enterprise edition were used.</span></span> <span data-ttu-id="9090e-137">Replica di Site Recovery è indipendente dall'applicazione, indicazioni hello forniti sono toohold previsto in negli scenari seguenti.</span><span class="sxs-lookup"><span data-stu-id="9090e-137">As Site Recovery replication is application agnostic, hello recommendations provided here are expected toohold on for following scenarios as well.</span></span>

### <a name="source-and-target"></a><span data-ttu-id="9090e-138">Origine e destinazione</span><span class="sxs-lookup"><span data-stu-id="9090e-138">Source and target</span></span>

<span data-ttu-id="9090e-139">**Scenario**</span><span class="sxs-lookup"><span data-stu-id="9090e-139">**Scenario**</span></span> | <span data-ttu-id="9090e-140">**sito secondario tooa**</span><span class="sxs-lookup"><span data-stu-id="9090e-140">**tooa secondary site**</span></span> | <span data-ttu-id="9090e-141">**tooAzure**</span><span class="sxs-lookup"><span data-stu-id="9090e-141">**tooAzure**</span></span>
--- | --- | ---
<span data-ttu-id="9090e-142">**Hyper-V**</span><span class="sxs-lookup"><span data-stu-id="9090e-142">**Hyper-V**</span></span> | <span data-ttu-id="9090e-143">Sì</span><span class="sxs-lookup"><span data-stu-id="9090e-143">Yes</span></span> | <span data-ttu-id="9090e-144">Sì</span><span class="sxs-lookup"><span data-stu-id="9090e-144">Yes</span></span>
<span data-ttu-id="9090e-145">**VMware**</span><span class="sxs-lookup"><span data-stu-id="9090e-145">**VMware**</span></span> | <span data-ttu-id="9090e-146">Sì</span><span class="sxs-lookup"><span data-stu-id="9090e-146">Yes</span></span> | <span data-ttu-id="9090e-147">Sì</span><span class="sxs-lookup"><span data-stu-id="9090e-147">Yes</span></span>
<span data-ttu-id="9090e-148">**Server fisico**</span><span class="sxs-lookup"><span data-stu-id="9090e-148">**Physical server**</span></span> | <span data-ttu-id="9090e-149">Sì</span><span class="sxs-lookup"><span data-stu-id="9090e-149">Yes</span></span> | <span data-ttu-id="9090e-150">Sì</span><span class="sxs-lookup"><span data-stu-id="9090e-150">Yes</span></span>

### <a name="sharepoint-versions"></a><span data-ttu-id="9090e-151">Versioni di SharePoint</span><span class="sxs-lookup"><span data-stu-id="9090e-151">SharePoint Versions</span></span>
<span data-ttu-id="9090e-152">Hello seguenti versioni di SharePoint server è supportata.</span><span class="sxs-lookup"><span data-stu-id="9090e-152">hello following SharePoint server versions are supported.</span></span>

* <span data-ttu-id="9090e-153">SharePoint Server 2013 Standard</span><span class="sxs-lookup"><span data-stu-id="9090e-153">SharePoint server 2013 Standard</span></span>
* <span data-ttu-id="9090e-154">SharePoint Server 2013 Enterprise</span><span class="sxs-lookup"><span data-stu-id="9090e-154">SharePoint server 2013 Enterprise</span></span>
* <span data-ttu-id="9090e-155">SharePoint Server 2016 Standard</span><span class="sxs-lookup"><span data-stu-id="9090e-155">SharePoint server 2016 Standard</span></span>
* <span data-ttu-id="9090e-156">SharePoint Server 2016 Enterprise</span><span class="sxs-lookup"><span data-stu-id="9090e-156">SharePoint server 2016 Enterprise</span></span>

### <a name="things-tookeep-in-mind"></a><span data-ttu-id="9090e-157">Operazioni tookeep presente</span><span class="sxs-lookup"><span data-stu-id="9090e-157">Things tookeep in mind</span></span>

<span data-ttu-id="9090e-158">Se si utilizza un cluster basato su disco condiviso come qualsiasi livello dell'applicazione, non sarà possibile toouse in grado di Site Recovery replica tooreplicate tali macchine virtuali.</span><span class="sxs-lookup"><span data-stu-id="9090e-158">If you are using a shared disk-based cluster as any tier in your application then you will not be able toouse Site Recovery replication tooreplicate those virtual machines.</span></span> <span data-ttu-id="9090e-159">È possibile utilizzare la replica nativa fornita da un'applicazione hello e quindi utilizzare un [piano di ripristino](site-recovery-create-recovery-plans.md) toofailover tutti i livelli.</span><span class="sxs-lookup"><span data-stu-id="9090e-159">You can use native replication provided by hello application and then use a [recovery plan](site-recovery-create-recovery-plans.md) toofailover all tiers.</span></span>

## <a name="replicating-virtual-machines"></a><span data-ttu-id="9090e-160">Replica di macchine virtuali</span><span class="sxs-lookup"><span data-stu-id="9090e-160">Replicating virtual machines</span></span>

<span data-ttu-id="9090e-161">Seguire [questa Guida](site-recovery-vmware-to-azure.md) toostart hello tooAzure di macchina virtuale di replica.</span><span class="sxs-lookup"><span data-stu-id="9090e-161">Follow [this guidance](site-recovery-vmware-to-azure.md) toostart replicating hello virtual machine tooAzure.</span></span>

* <span data-ttu-id="9090e-162">Una volta completata la replica di hello, assicurarsi di passare tooeach di macchina virtuale di ogni livello e selezionare stesso set di disponibilità in ' articolo replicato > Impostazioni > Proprietà > calcolo e rete ".</span><span class="sxs-lookup"><span data-stu-id="9090e-162">Once hello replication is complete, make sure you go tooeach virtual machine of each tier and select same availability set in 'Replicated item > Settings > Properties > Compute and Network'.</span></span> <span data-ttu-id="9090e-163">Ad esempio, se il livello web dispone di 3 macchine virtuali, verificare hello tutte le macchine 3 virtuali sono configurate toobe parte della stesso set di disponibilità in Azure.</span><span class="sxs-lookup"><span data-stu-id="9090e-163">For example, if your web tier has 3 VMs, ensure all hello 3 VMs are configured toobe part of same availability set in Azure.</span></span>

    ![Impostazione del set di disponibilità](./media/site-recovery-sharepoint/select-av-set.png)

* <span data-ttu-id="9090e-165">Per ulteriori informazioni sulla protezione di Active Directory e DNS, fare riferimento troppo[proteggere Active Directory e DNS](site-recovery-active-directory.md) documento.</span><span class="sxs-lookup"><span data-stu-id="9090e-165">For guidance on protecting Active Directory and DNS, refer too[Protect Active Directory and DNS](site-recovery-active-directory.md) document.</span></span>

* <span data-ttu-id="9090e-166">Per ulteriori informazioni sulla protezione a livello di database in esecuzione in SQL server, vedere troppo[proteggere SQL Server](site-recovery-active-directory.md) documento.</span><span class="sxs-lookup"><span data-stu-id="9090e-166">For guidance on protecting database tier running on SQL server, refer too[Protect SQL Server](site-recovery-active-directory.md) document.</span></span>

## <a name="networking-configuration"></a><span data-ttu-id="9090e-167">Configurazione delle impostazioni di rete</span><span class="sxs-lookup"><span data-stu-id="9090e-167">Networking configuration</span></span>

### <a name="network-properties"></a><span data-ttu-id="9090e-168">Proprietà di rete</span><span class="sxs-lookup"><span data-stu-id="9090e-168">Network properties</span></span>

* <span data-ttu-id="9090e-169">Per App hello e livello Web le macchine virtuali, configurare le impostazioni di rete nel portale di Azure in modo che le macchine virtuali hello ottenere toohello collegato corretto ripristino di emergenza rete dopo il failover.</span><span class="sxs-lookup"><span data-stu-id="9090e-169">For hello App and Web tier VMs, configure network settings in Azure portal so that hello VMs get attached toohello right DR network after failover.</span></span>

    ![Selezione della rete](./media/site-recovery-sharepoint/select-network.png)


* <span data-ttu-id="9090e-171">Se si utilizza un indirizzo IP statico, quindi specificare hello IP che si desidera hello tootake macchina virtuale in hello **indirizzo IP di destinazione** campo</span><span class="sxs-lookup"><span data-stu-id="9090e-171">If you are using a static IP, then specify hello IP that you want hello virtual machine tootake in hello **Target IP** field</span></span>

    ![Impostazione dell'IP statico](./media/site-recovery-sharepoint/set-static-ip.png)

### <a name="dns-and-traffic-routing"></a><span data-ttu-id="9090e-173">DNS e routing del traffico</span><span class="sxs-lookup"><span data-stu-id="9090e-173">DNS and Traffic Routing</span></span>

<span data-ttu-id="9090e-174">Per i siti per internet [creare un profilo di gestione traffico di tipo 'Priority'](../traffic-manager/traffic-manager-create-profile.md) in hello sottoscrizione di Azure.</span><span class="sxs-lookup"><span data-stu-id="9090e-174">For internet facing sites, [create a Traffic Manager profile of 'Priority' type](../traffic-manager/traffic-manager-create-profile.md) in hello Azure subscription.</span></span> <span data-ttu-id="9090e-175">E quindi configurare il DNS e gestione traffico il profilo nel seguente modo hello.</span><span class="sxs-lookup"><span data-stu-id="9090e-175">And then configure your DNS and Traffic Manager profile in hello following manner.</span></span>


| <span data-ttu-id="9090e-176">**Where**</span><span class="sxs-lookup"><span data-stu-id="9090e-176">**Where**</span></span> | <span data-ttu-id="9090e-177">**Origine**</span><span class="sxs-lookup"><span data-stu-id="9090e-177">**Source**</span></span> | <span data-ttu-id="9090e-178">**Destinazione**</span><span class="sxs-lookup"><span data-stu-id="9090e-178">**Target**</span></span>|
| --- | --- | --- |
| <span data-ttu-id="9090e-179">DNS pubblico</span><span class="sxs-lookup"><span data-stu-id="9090e-179">Public DNS</span></span> | <span data-ttu-id="9090e-180">DNS pubblico per siti di SharePoint</span><span class="sxs-lookup"><span data-stu-id="9090e-180">Public DNS for SharePoint sites</span></span> <br/><br/> <span data-ttu-id="9090e-181">Esempio: sharepoint.contoso.com</span><span class="sxs-lookup"><span data-stu-id="9090e-181">Ex: sharepoint.contoso.com</span></span> | <span data-ttu-id="9090e-182">Gestione traffico</span><span class="sxs-lookup"><span data-stu-id="9090e-182">Traffic Manager</span></span> <br/><br/> <span data-ttu-id="9090e-183">contososharepoint.trafficmanager.net</span><span class="sxs-lookup"><span data-stu-id="9090e-183">contososharepoint.trafficmanager.net</span></span> |
| <span data-ttu-id="9090e-184">DNS locale</span><span class="sxs-lookup"><span data-stu-id="9090e-184">On-premises DNS</span></span> | <span data-ttu-id="9090e-185">sharepointonprem.contoso.com</span><span class="sxs-lookup"><span data-stu-id="9090e-185">sharepointonprem.contoso.com</span></span> | <span data-ttu-id="9090e-186">Indirizzo IP pubblico nella farm locale hello</span><span class="sxs-lookup"><span data-stu-id="9090e-186">Public IP on hello on-premises farm</span></span> |


<span data-ttu-id="9090e-187">Nel profilo di gestione traffico, hello [creare hello endpoint primario e di ripristino](../traffic-manager/traffic-manager-configure-priority-routing-method.md).</span><span class="sxs-lookup"><span data-stu-id="9090e-187">In hello Traffic Manager profile, [create hello primary and recovery endpoints](../traffic-manager/traffic-manager-configure-priority-routing-method.md).</span></span> <span data-ttu-id="9090e-188">Utilizzare l'endpoint esterno hello per endpoint locale e l'indirizzo IP pubblico per l'endpoint di Azure.</span><span class="sxs-lookup"><span data-stu-id="9090e-188">Use hello external endpoint for on-premises endpoint and public IP for Azure endpoint.</span></span> <span data-ttu-id="9090e-189">Verificare che la priorità hello sia impostata endpoint locale tooon più elevata.</span><span class="sxs-lookup"><span data-stu-id="9090e-189">Ensure that hello priority is set higher tooon-premises endpoint.</span></span>

<span data-ttu-id="9090e-190">Host di una pagina di prova su una porta specifica (ad esempio 800) nel livello web di SharePoint hello affinché tooautomatically Traffic Manager di rilevare disponibilità post failover.</span><span class="sxs-lookup"><span data-stu-id="9090e-190">Host a test page on a specific port (for example, 800) in hello SharePoint web tier in order for Traffic Manager tooautomatically detect availability post failover.</span></span> <span data-ttu-id="9090e-191">Questa è una soluzione alternativa per i casi in cui non è possibile abilitare l'autenticazione anonima in uno dei siti di SharePoint.</span><span class="sxs-lookup"><span data-stu-id="9090e-191">This is a workaround in case you cannot enable anonymous authentication on any of your SharePoint sites.</span></span>

<span data-ttu-id="9090e-192">[Configurare il profilo di gestione traffico hello](../traffic-manager/traffic-manager-configure-priority-routing-method.md) con hello sotto le impostazioni.</span><span class="sxs-lookup"><span data-stu-id="9090e-192">[Configure hello Traffic Manager profile](../traffic-manager/traffic-manager-configure-priority-routing-method.md) with hello below settings.</span></span>

* <span data-ttu-id="9090e-193">Metodo di routing: "Priorità"</span><span class="sxs-lookup"><span data-stu-id="9090e-193">Routing method - 'Priority'</span></span>
* <span data-ttu-id="9090e-194">DNS ora toolive (TTL) - 30 ' secondi'</span><span class="sxs-lookup"><span data-stu-id="9090e-194">DNS time toolive (TTL) - '30 seconds'</span></span>
* <span data-ttu-id="9090e-195">Impostazioni di monitoraggio degli endpoint: se l'autenticazione anonima può essere abilitata, è possibile fornire l'endpoint di un sito Web specifico.</span><span class="sxs-lookup"><span data-stu-id="9090e-195">Endpoint monitor settings - If you can enable anonymous authentication, you can give a specific website endpoint.</span></span> <span data-ttu-id="9090e-196">In alternativa, è possibile usare una pagina di test su una porta specifica, ad esempio la porta 800.</span><span class="sxs-lookup"><span data-stu-id="9090e-196">Or, you can use a test page on a specific port (for example, 800).</span></span>

## <a name="creating-a-recovery-plan"></a><span data-ttu-id="9090e-197">Creazione di un piano di ripristino</span><span class="sxs-lookup"><span data-stu-id="9090e-197">Creating a recovery plan</span></span>

<span data-ttu-id="9090e-198">Un piano di ripristino consente di sequenziazione failover hello di vari livelli di un'applicazione multilivello, di conseguenza, mantenendo la coerenza delle applicazioni.</span><span class="sxs-lookup"><span data-stu-id="9090e-198">A recovery plan allows sequencing hello failover of various tiers in a multi-tier application, hence, maintaining application consistency.</span></span> <span data-ttu-id="9090e-199">Seguire hello passaggi seguenti durante la creazione di un piano di ripristino per un'applicazione web a più livelli.</span><span class="sxs-lookup"><span data-stu-id="9090e-199">Follow hello below steps while creating a recovery plan for a multi-tier web application.</span></span> <span data-ttu-id="9090e-200">[Altre informazioni sulla creazione di un piano di ripristino](site-recovery-runbook-automation.md#customize-the-recovery-plan).</span><span class="sxs-lookup"><span data-stu-id="9090e-200">[Learn more about creating a recovery plan](site-recovery-runbook-automation.md#customize-the-recovery-plan).</span></span>

### <a name="adding-virtual-machines-toofailover-groups"></a><span data-ttu-id="9090e-201">Aggiunta di gruppi toofailover macchine virtuali</span><span class="sxs-lookup"><span data-stu-id="9090e-201">Adding virtual machines toofailover groups</span></span>

1. <span data-ttu-id="9090e-202">Creare un piano di ripristino da hello aggiunta App e il livello Web le macchine virtuali.</span><span class="sxs-lookup"><span data-stu-id="9090e-202">Create a recovery plan by adding hello App and Web tier VMs.</span></span>
2. <span data-ttu-id="9090e-203">Fare clic su 'Personalizza' toogroup hello macchine virtuali.</span><span class="sxs-lookup"><span data-stu-id="9090e-203">Click on 'Customize' toogroup hello VMs.</span></span> <span data-ttu-id="9090e-204">Per impostazione predefinita, tutte le VM fanno parte di "Gruppo 1".</span><span class="sxs-lookup"><span data-stu-id="9090e-204">By default, all VMs are part of 'Group 1'.</span></span>

    ![Personalizzazione del piano di ripristino](./media/site-recovery-sharepoint/rp-groups.png)

3. <span data-ttu-id="9090e-206">Creare un altro gruppo (gruppo 2) e spostare il livello Web hello macchine virtuali nel nuovo gruppo di hello.</span><span class="sxs-lookup"><span data-stu-id="9090e-206">Create another Group (Group 2) and move hello Web tier VMs into hello new group.</span></span> <span data-ttu-id="9090e-207">Le VM di livello app devono fare parte di "Gruppo 1", mentre le VM di livello Web devono fare parte di "Gruppo 2".</span><span class="sxs-lookup"><span data-stu-id="9090e-207">Your App tier VMs should be part of 'Group 1' and Web tier VMs should be part of 'Group 2'.</span></span> <span data-ttu-id="9090e-208">Si tratta di tooensure che hello macchine virtuali di livello avviano prima seguita dalle macchine virtuali di livello Web App.</span><span class="sxs-lookup"><span data-stu-id="9090e-208">This is tooensure that hello App tier VMs boot up first followed by Web tier VMs.</span></span>


### <a name="adding-scripts-toohello-recovery-plan"></a><span data-ttu-id="9090e-209">Aggiunta di script toohello piano di ripristino</span><span class="sxs-lookup"><span data-stu-id="9090e-209">Adding scripts toohello recovery plan</span></span>

<span data-ttu-id="9090e-210">È possibile distribuire script di Azure Site Recovery hello più comunemente usato nell'account di automazione pulsante hello 'Distribuire tooAzure' riportata di seguito.</span><span class="sxs-lookup"><span data-stu-id="9090e-210">You can deploy hello most commonly used Azure Site Recovery scripts into your Automation account clicking hello 'Deploy tooAzure' button below.</span></span> <span data-ttu-id="9090e-211">Quando si utilizza uno script pubblicato, attenersi alle linee guida hello nello script hello.</span><span class="sxs-lookup"><span data-stu-id="9090e-211">When you are using any published script, ensure you follow hello guidance in hello script.</span></span>

<span data-ttu-id="9090e-212">[![Distribuire tooAzure](https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/c4803408-340e-49e3-9a1f-0ed3f689813d.png)](https://aka.ms/asr-automationrunbooks-deploy)</span><span class="sxs-lookup"><span data-stu-id="9090e-212">[![Deploy tooAzure](https://azurecomcdn.azureedge.net/mediahandler/acomblog/media/Default/blog/c4803408-340e-49e3-9a1f-0ed3f689813d.png)](https://aka.ms/asr-automationrunbooks-deploy)</span></span>

1. <span data-ttu-id="9090e-213">Aggiungere un script di pre-azione too'Group 1' toofailover gruppo di disponibilità SQL.</span><span class="sxs-lookup"><span data-stu-id="9090e-213">Add a pre-action script too'Group 1' toofailover SQL Availability group.</span></span> <span data-ttu-id="9090e-214">Utilizzare lo script 'SQL ripristino automatico di sistema-FailoverAG' hello pubblicato negli script di esempio hello.</span><span class="sxs-lookup"><span data-stu-id="9090e-214">Use hello 'ASR-SQL-FailoverAG' script published in hello sample scripts.</span></span> <span data-ttu-id="9090e-215">Assicurarsi di seguire indicazioni hello nello script hello e apportare modifiche hello necessario nello script hello in modo appropriato.</span><span class="sxs-lookup"><span data-stu-id="9090e-215">Ensure you follow hello guidance in hello script and make hello required changes in hello script appropriately.</span></span>

    ![Aggiunta dello script per il gruppo di disponibilità - Passaggio 1](./media/site-recovery-sharepoint/add-ag-script-step1.png)

    ![Aggiunta dello script per il gruppo di disponibilità - Passaggio 2](./media/site-recovery-sharepoint/add-ag-script-step2.png)

2. <span data-ttu-id="9090e-218">Aggiungere un tooattach script azione di post di un servizio di bilanciamento del carico hello failover le macchine virtuali del livello Web (gruppo 2).</span><span class="sxs-lookup"><span data-stu-id="9090e-218">Add a post action script tooattach a load balancer on hello failed over virtual machines of Web tier (Group 2).</span></span> <span data-ttu-id="9090e-219">Utilizzare lo script 'Ripristino automatico di sistema-AddSingleLoadBalancer' hello pubblicato negli script di esempio hello.</span><span class="sxs-lookup"><span data-stu-id="9090e-219">Use hello 'ASR-AddSingleLoadBalancer' script published in hello sample scripts.</span></span> <span data-ttu-id="9090e-220">Assicurarsi di seguire indicazioni hello nello script hello e apportare modifiche hello necessario nello script hello in modo appropriato.</span><span class="sxs-lookup"><span data-stu-id="9090e-220">Ensure you follow hello guidance in hello script and make hello required changes in hello script appropriately.</span></span>

    ![Aggiunta dello script per il bilanciamento del carico - Passaggio 1](./media/site-recovery-sharepoint/add-lb-script-step1.png)

    ![Aggiunta dello script per il bilanciamento del carico - Passaggio 2](./media/site-recovery-sharepoint/add-lb-script-step2.png)

3. <span data-ttu-id="9090e-223">Aggiungere una passaggio manuale tooupdate hello DNS record toopoint toohello nuova farm in Azure.</span><span class="sxs-lookup"><span data-stu-id="9090e-223">Add a manual step tooupdate hello DNS records toopoint toohello new farm in Azure.</span></span>

    * <span data-ttu-id="9090e-224">Per i siti con connessione Internet, non è necessario alcun aggiornamento dei record DNS dopo il failover.</span><span class="sxs-lookup"><span data-stu-id="9090e-224">For internet facing sites, no DNS updates are required post failover.</span></span> <span data-ttu-id="9090e-225">Seguire i passaggi di hello descritti in tooconfigure di sezione 'Informazioni aggiuntive sulla rete' hello Traffic Manager.</span><span class="sxs-lookup"><span data-stu-id="9090e-225">Follow hello steps described in hello 'Networking guidance' section tooconfigure Traffic Manager.</span></span> <span data-ttu-id="9090e-226">Se hello profilo di gestione traffico è stato impostato come descritto nella sezione precedente di hello, aggiungere una porta di script tooopen fittizio (800 nell'esempio hello) in hello macchina virtuale di Azure.</span><span class="sxs-lookup"><span data-stu-id="9090e-226">If hello Traffic Manager profile has been set up as described in hello previous section, add a script tooopen dummy port (800 in hello example) on hello Azure VM.</span></span>

    * <span data-ttu-id="9090e-227">Per siti Web interni, aggiungere l'IP del servizio di bilanciamento carico di un passaggio manuale tooupdate hello DNS record toopoint toohello nuova Web livello della macchina virtuale.</span><span class="sxs-lookup"><span data-stu-id="9090e-227">For internal facing sites, add a manual step tooupdate hello DNS record toopoint toohello new Web tier VM’s load balancer IP.</span></span>

4. <span data-ttu-id="9090e-228">Aggiungere un'applicazione di ricerca toorestore passaggio manuale da un backup oppure avviare un nuovo servizio di ricerca.</span><span class="sxs-lookup"><span data-stu-id="9090e-228">Add a manual step toorestore search application from a backup or start a new search service.</span></span>

5. <span data-ttu-id="9090e-229">Per il ripristino dell'applicazione del servizio di ricerca da un backup, seguire i passaggi seguenti.</span><span class="sxs-lookup"><span data-stu-id="9090e-229">For restoring Search service application from a backup, follow below steps.</span></span>

    * <span data-ttu-id="9090e-230">Questo metodo presuppone che un backup di hello applicazione di servizio di ricerca è stato eseguito prima dell'evento irreversibile hello e tale backup hello è disponibile nel sito di ripristino di emergenza hello.</span><span class="sxs-lookup"><span data-stu-id="9090e-230">This method assumes that a backup of hello Search Service Application was performed before hello catastrophic event and that hello backup is available at hello DR site.</span></span>
    * <span data-ttu-id="9090e-231">Può essere ottenuta facilmente pianificando backup hello (ad esempio, una volta al giorno) e usando un backup di copia procedure tooplace hello nel sito di ripristino di emergenza hello.</span><span class="sxs-lookup"><span data-stu-id="9090e-231">This can easily be achieved by scheduling hello backup (for example, once daily) and using a copy procedure tooplace hello backup at hello DR site.</span></span> <span data-ttu-id="9090e-232">Le procedure di copia possono includere programmi basati su script come AzCopy (Azure Copy) o la configurazione di DFSR (Distributed File Services Replication).</span><span class="sxs-lookup"><span data-stu-id="9090e-232">Copy procedures could include scripted programs such as AzCopy (Azure Copy) or setting up DFSR (Distributed File Services Replication).</span></span>
    * <span data-ttu-id="9090e-233">Ora che hello SharePoint farm è in esecuzione, passare hello Amministrazione centrale, 'Backup e ripristino' e selezionare il ripristino.</span><span class="sxs-lookup"><span data-stu-id="9090e-233">Now that hello SharePoint farm is running, navigate hello Central Administration, 'Backup and Restore' and select Restore.</span></span> <span data-ttu-id="9090e-234">ripristino Hello interroga il percorso di backup hello specificato (valore hello tooupdate potrebbe essere necessario).</span><span class="sxs-lookup"><span data-stu-id="9090e-234">hello restore interrogates hello backup location specified (you may need tooupdate hello value).</span></span> <span data-ttu-id="9090e-235">Selezionare il backup di applicazione di servizio di ricerca hello toorestore desiderato.</span><span class="sxs-lookup"><span data-stu-id="9090e-235">Select hello Search Service Application backup you would like toorestore.</span></span>
    * <span data-ttu-id="9090e-236">La ricerca viene ripristinata.</span><span class="sxs-lookup"><span data-stu-id="9090e-236">Search is restored.</span></span> <span data-ttu-id="9090e-237">Tenere presente che hello ripristino prevede toofind hello stessa topologia (stesso numero di server) e le stesse unità disco rigido lettere assegnate toothose server.</span><span class="sxs-lookup"><span data-stu-id="9090e-237">Keep in mind that hello restore expects toofind hello same topology (same number of servers) and same hard drive letters assigned toothose servers.</span></span> <span data-ttu-id="9090e-238">Per altre informazioni, vedere il documento [Ripristinare le applicazioni del servizio di ricerca in SharePoint 2013](https://technet.microsoft.com/library/ee748654.aspx).</span><span class="sxs-lookup"><span data-stu-id="9090e-238">For more information, see ['Restore Search service application in SharePoint 2013'](https://technet.microsoft.com/library/ee748654.aspx) document.</span></span>


6. <span data-ttu-id="9090e-239">Per avviare il sistema con una nuova applicazione del servizio di ricerca, seguire i passaggi seguenti.</span><span class="sxs-lookup"><span data-stu-id="9090e-239">For starting with a new Search service application, follow below steps.</span></span>

    * <span data-ttu-id="9090e-240">Questo metodo presuppone che nel sito di ripristino di emergenza hello è disponibile un backup del database "Di amministrazione della ricerca" hello.</span><span class="sxs-lookup"><span data-stu-id="9090e-240">This method assumes that a backup of hello “Search Administration” database is available at hello DR site.</span></span>
    * <span data-ttu-id="9090e-241">Poiché hello altri database di applicazione di servizio di ricerca non vengono replicati, è necessario che toobe creato nuovamente.</span><span class="sxs-lookup"><span data-stu-id="9090e-241">Since hello other Search Service Application databases are not replicated, they need toobe re-created.</span></span> <span data-ttu-id="9090e-242">toodo consente pertanto di passare tooCentral amministrazione e di eliminare hello applicazione di servizio di ricerca.</span><span class="sxs-lookup"><span data-stu-id="9090e-242">toodo so, navigate tooCentral Administration and delete hello Search Service Application.</span></span> <span data-ttu-id="9090e-243">In tutti i server cui hello host indice di ricerca, eliminare i file di indice hello.</span><span class="sxs-lookup"><span data-stu-id="9090e-243">On any servers which host hello Search Index, delete hello index files.</span></span>
    * <span data-ttu-id="9090e-244">Ricreare hello applicazione di servizio di ricerca e si ricrea database hello.</span><span class="sxs-lookup"><span data-stu-id="9090e-244">Re-create hello Search Service Application and this re-creates hello databases.</span></span> <span data-ttu-id="9090e-245">È consigliabile toohave uno script preparato che consente di ricreare questa applicazione del servizio perché non è possibile tooperform tutte le azioni tramite hello GUI.</span><span class="sxs-lookup"><span data-stu-id="9090e-245">It is recommended toohave a prepared script that re-creates this service application since it is not possible tooperform all actions via hello GUI.</span></span> <span data-ttu-id="9090e-246">Posizione dell'indice unità hello e configurazione della topologia di ricerca hello sono, ad esempio, possibile solo tramite i cmdlet PowerShell di SharePoint.</span><span class="sxs-lookup"><span data-stu-id="9090e-246">For example, setting hello index drive location and configuring hello search topology are only possible by using SharePoint PowerShell cmdlets.</span></span> <span data-ttu-id="9090e-247">Utilizzare il cmdlet di Windows PowerShell hello SPEnterpriseSearchServiceApplication di ripristino e specificare hello soggetti a log Shipping e replica di database di amministrazione della ricerca, Search_Service__DB.</span><span class="sxs-lookup"><span data-stu-id="9090e-247">Use hello Windows PowerShell cmdlet Restore-SPEnterpriseSearchServiceApplication and specify hello log-shipped and replicated Search Administration database, Search_Service__DB.</span></span> <span data-ttu-id="9090e-248">Questo cmdlet consente la configurazione della ricerca hello, schema, proprietà gestite, regole e le origini e crea un set predefinito di hello altri componenti.</span><span class="sxs-lookup"><span data-stu-id="9090e-248">This cmdlet gives hello search configuration, schema, managed properties, rules, and sources and creates a default set of hello other components.</span></span>
    * <span data-ttu-id="9090e-249">Dopo l'applicazione di servizio di ricerca sia hello creare di nuovo, è necessario avviare una ricerca per indicizzazione completa per ogni hello toorestore di origine di contenuto servizio di ricerca.</span><span class="sxs-lookup"><span data-stu-id="9090e-249">Once hello Search Service Application has be re-created, you must start a full crawl for each content source toorestore hello Search Service.</span></span> <span data-ttu-id="9090e-250">Alcuni dati analitica dalla farm locale hello, ad esempio suggerimenti di ricerca andranno persi.</span><span class="sxs-lookup"><span data-stu-id="9090e-250">You lose some analytics information from hello on-premises farm, such as search recommendations.</span></span>

7. <span data-ttu-id="9090e-251">Una volta completati tutti i passaggi di hello, salvare il piano di ripristino hello e piano di ripristino finale hello avrà un aspetto simile riportato di seguito.</span><span class="sxs-lookup"><span data-stu-id="9090e-251">Once all hello steps are completed, save hello recovery plan and hello final recovery plan will look like following.</span></span>

    ![Piano di ripristino salvato](./media/site-recovery-sharepoint/saved-rp.png)

## <a name="doing-a-test-failover"></a><span data-ttu-id="9090e-253">Esecuzione di un failover di test</span><span class="sxs-lookup"><span data-stu-id="9090e-253">Doing a test failover</span></span>
<span data-ttu-id="9090e-254">Seguire [questa Guida](site-recovery-test-failover-to-azure.md) toodo un failover di test.</span><span class="sxs-lookup"><span data-stu-id="9090e-254">Follow [this guidance](site-recovery-test-failover-to-azure.md) toodo a test failover.</span></span>

1.  <span data-ttu-id="9090e-255">Passare tooAzure portale e selezionare l'insieme di credenziali del servizio di ripristino.</span><span class="sxs-lookup"><span data-stu-id="9090e-255">Go tooAzure portal and select your Recovery Service vault.</span></span>
2.  <span data-ttu-id="9090e-256">Fare clic sul piano di ripristino hello creato per l'applicazione di SharePoint.</span><span class="sxs-lookup"><span data-stu-id="9090e-256">Click on hello recovery plan created for SharePoint application.</span></span>
3.  <span data-ttu-id="9090e-257">Fare clic su 'Failover di test'.</span><span class="sxs-lookup"><span data-stu-id="9090e-257">Click on 'Test Failover'.</span></span>
4.  <span data-ttu-id="9090e-258">Selezionare un punto di ripristino e il processo di failover di test di rete virtuale di Azure toostart hello.</span><span class="sxs-lookup"><span data-stu-id="9090e-258">Select recovery point and Azure virtual network toostart hello test failover process.</span></span>
5.  <span data-ttu-id="9090e-259">Una volta ambiente secondario hello è attivo, è possibile eseguire le convalide.</span><span class="sxs-lookup"><span data-stu-id="9090e-259">Once hello secondary environment is up, you can perform your validations.</span></span>
6.  <span data-ttu-id="9090e-260">Dopo aver complete le convalide hello, è possibile fare clic su 'Failover di test di pulizia' nel piano di ripristino hello e ambiente di failover di test hello verrà eliminate.</span><span class="sxs-lookup"><span data-stu-id="9090e-260">Once hello validations are complete, you can click 'Cleanup test failover' on hello recovery plan and hello test failover environment is cleaned.</span></span>

<span data-ttu-id="9090e-261">Per informazioni aggiuntive sull'esecuzione di test del failover per Active Directory e DNS, fare riferimento troppo[Test considerazioni sul failover per Active Directory e DNS](site-recovery-active-directory.md#test-failover-considerations) documento.</span><span class="sxs-lookup"><span data-stu-id="9090e-261">For guidance on doing test failover for AD and DNS, refer too[Test failover considerations for AD and DNS](site-recovery-active-directory.md#test-failover-considerations) document.</span></span>

<span data-ttu-id="9090e-262">Per informazioni aggiuntive sull'esecuzione di test del failover di SQL nei gruppi di disponibilità, fare riferimento troppo[esegue Test del failover per SQL Server Always On](site-recovery-sql.md#steps-to-do-a-test-failover) documento.</span><span class="sxs-lookup"><span data-stu-id="9090e-262">For guidance on doing test failover for SQL Always ON availability groups, refer too[Doing Test failover for SQL Server Always On](site-recovery-sql.md#steps-to-do-a-test-failover) document.</span></span>

## <a name="doing-a-failover"></a><span data-ttu-id="9090e-263">Esecuzione di un failover</span><span class="sxs-lookup"><span data-stu-id="9090e-263">Doing a failover</span></span>
<span data-ttu-id="9090e-264">Seguire [queste linee guida](site-recovery-failover.md) per eseguire un failover.</span><span class="sxs-lookup"><span data-stu-id="9090e-264">Follow [this guidance](site-recovery-failover.md) for doing a failover.</span></span>

1.  <span data-ttu-id="9090e-265">Passare tooAzure portale e selezionare l'insieme di credenziali di servizi di ripristino.</span><span class="sxs-lookup"><span data-stu-id="9090e-265">Go tooAzure portal and select your Recovery Services vault.</span></span>
2.  <span data-ttu-id="9090e-266">Fare clic sul piano di ripristino hello creato per l'applicazione di SharePoint.</span><span class="sxs-lookup"><span data-stu-id="9090e-266">Click on hello recovery plan created for SharePoint application.</span></span>
3.  <span data-ttu-id="9090e-267">Fare clic su 'Failover'.</span><span class="sxs-lookup"><span data-stu-id="9090e-267">Click on 'Failover'.</span></span>
4.  <span data-ttu-id="9090e-268">Seleziona processo di failover hello toostart punto di ripristino.</span><span class="sxs-lookup"><span data-stu-id="9090e-268">Select recovery point toostart hello failover process.</span></span>

## <a name="next-steps"></a><span data-ttu-id="9090e-269">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="9090e-269">Next steps</span></span>
<span data-ttu-id="9090e-270">Altre informazioni sulla [replica di altre applicazioni](site-recovery-workload.md) con Site Recovery.</span><span class="sxs-lookup"><span data-stu-id="9090e-270">You can learn more about [replicating other applications](site-recovery-workload.md) using Site Recovery.</span></span>
