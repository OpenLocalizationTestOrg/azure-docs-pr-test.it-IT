---
title: Procedure consigliate per la sicurezza della rete di Azure | Documentazione Microsoft
description: "Informazioni su alcune funzionalità chiave disponibili in Azure per creare ambienti di rete sicuri."
services: virtual-network
documentationcenter: na
author: tracsman
manager: rossort
editor: 
ms.assetid: d169387a-1243-4867-a602-01d6f2d8a2a1
ms.service: virtual-network
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 01/03/2017
ms.author: jonor
ms.openlocfilehash: fb5e399d4ab02a7f2805cc280b213bf5b44f6993
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 07/11/2017
---
# <a name="microsoft-cloud-services-and-network-security"></a><span data-ttu-id="8e273-103">Servizi cloud Microsoft e sicurezza di rete</span><span class="sxs-lookup"><span data-stu-id="8e273-103">Microsoft cloud services and network security</span></span>
<span data-ttu-id="8e273-104">I Servizi cloud Microsoft offrono servizi e infrastruttura su scala elevata, capacità di livello aziendale e molte opzioni per la connettività ibrida.</span><span class="sxs-lookup"><span data-stu-id="8e273-104">Microsoft cloud services deliver hyper-scale services and infrastructure, enterprise-grade capabilities, and many choices for hybrid connectivity.</span></span> <span data-ttu-id="8e273-105">I clienti possono scegliere di accedere a questi servizi tramite Internet o con Azure ExpressRoute, che offre connettività di rete privata.</span><span class="sxs-lookup"><span data-stu-id="8e273-105">Customers can choose to access these services either via the Internet or with Azure ExpressRoute, which provides private network connectivity.</span></span> <span data-ttu-id="8e273-106">La piattaforma Microsoft Azure consente ai clienti di estendere con facilità la propria infrastruttura nel cloud e di sviluppare architetture a più livelli.</span><span class="sxs-lookup"><span data-stu-id="8e273-106">The Microsoft Azure platform allows customers to seamlessly extend their infrastructure into the cloud and build multi-tier architectures.</span></span> <span data-ttu-id="8e273-107">Inoltre, le terze parti possono abilitare capacità avanzate offrendo servizi di sicurezza e appliance virtuali.</span><span class="sxs-lookup"><span data-stu-id="8e273-107">Additionally, third parties can enable enhanced capabilities by offering security services and virtual appliances.</span></span> <span data-ttu-id="8e273-108">Questo white paper offre una panoramica dei problemi relativi a sicurezza e architettura che i clienti dovrebbero tenere in considerazione quando usano i Servizi cloud Microsoft con accesso tramite ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="8e273-108">This white paper provides an overview of security and architectural issues that customers should consider when using Microsoft cloud services accessed via ExpressRoute.</span></span> <span data-ttu-id="8e273-109">Il documento illustra anche come creare servizi più sicuri sulle reti virtuali di Azure.</span><span class="sxs-lookup"><span data-stu-id="8e273-109">It also covers creating more secure services in Azure virtual networks.</span></span>

## <a name="fast-start"></a><span data-ttu-id="8e273-110">Avvio veloce</span><span class="sxs-lookup"><span data-stu-id="8e273-110">Fast start</span></span>
<span data-ttu-id="8e273-111">Il grafico logico seguente indirizza a un esempio specifico delle numerose tecniche di sicurezza disponibili con la piattaforma Azure.</span><span class="sxs-lookup"><span data-stu-id="8e273-111">The following logic chart can direct you to a specific example of the many security techniques available with the Azure platform.</span></span> <span data-ttu-id="8e273-112">Per un riferimento rapido, cercare l'esempio più adatto al proprio caso.</span><span class="sxs-lookup"><span data-stu-id="8e273-112">For quick reference, find the example that best fits your case.</span></span> <span data-ttu-id="8e273-113">Per informazioni complete, proseguire con la lettura del documento.</span><span class="sxs-lookup"><span data-stu-id="8e273-113">For expanded explanations, continue reading through the paper.</span></span>
<span data-ttu-id="8e273-114">[![0]][0]</span><span class="sxs-lookup"><span data-stu-id="8e273-114">[![0]][0]</span></span>

[<span data-ttu-id="8e273-115">Esempio 1: Creare una rete perimetrale (anche nota come DMZ) per proteggere le applicazioni con gruppi di sicurezza di rete (NSG).</span><span class="sxs-lookup"><span data-stu-id="8e273-115">Example 1: Build a perimeter network (also known as DMZ, demilitarized zone, or screened subnet) to help protect applications with network security groups (NSGs).</span></span>](#example-1-build-a-perimeter-network-to-help-protect-applications-with-nsgs)</br><span data-ttu-id="8e273-116">
[Esempio 2: Creare una rete perimetrale per proteggere le applicazioni con un firewall e gruppi di sicurezza di rete.](#example-2-build-a-perimeter-network-to-help-protect-applications-with-a-firewall-and-nsgs)</span><span class="sxs-lookup"><span data-stu-id="8e273-116">
[Example 2: Build a perimeter network to help protect applications with a firewall and NSGs.](#example-2-build-a-perimeter-network-to-help-protect-applications-with-a-firewall-and-nsgs)</span></span></br><span data-ttu-id="8e273-117">
[Esempio 3: Creare una rete perimetrale per proteggere le reti con un firewall, route definite dall'utente (UDR) e gruppi di sicurezza di rete.](#example-3-build-a-perimeter-network-to-help-protect-networks-with-a-firewall-and-udr-and-nsg)</span><span class="sxs-lookup"><span data-stu-id="8e273-117">
[Example 3: Build a perimeter network to help protect networks with a firewall, user-defined route (UDR), and NSG.](#example-3-build-a-perimeter-network-to-help-protect-networks-with-a-firewall-and-udr-and-nsg)</span></span></br><span data-ttu-id="8e273-118">
[Esempio 4: Aggiungere una connessione ibrida con un'appliance virtuale da sito a sito e con una rete virtuale privata (VPN).](#example-4-add-a-hybrid-connection-with-a-site-to-site-virtual-appliance-vpn)</span><span class="sxs-lookup"><span data-stu-id="8e273-118">
[Example 4: Add a hybrid connection with a site-to-site, virtual appliance virtual private network (VPN).](#example-4-add-a-hybrid-connection-with-a-site-to-site-virtual-appliance-vpn)</span></span></br><span data-ttu-id="8e273-119">
[Esempio 5: Aggiungere una connessione ibrida con un gateway VPN di Azure da sito a sito.](#example-5-add-a-hybrid-connection-with-a-site-to-site-azure-vpn-gateway)</span><span class="sxs-lookup"><span data-stu-id="8e273-119">
[Example 5: Add a hybrid connection with a site-to-site, Azure VPN gateway.](#example-5-add-a-hybrid-connection-with-a-site-to-site-azure-vpn-gateway)</span></span></br><span data-ttu-id="8e273-120">
[Esempio 6: Aggiungere una connessione ibrida con ExpressRoute.](#example-6-add-a-hybrid-connection-with-expressroute)</span><span class="sxs-lookup"><span data-stu-id="8e273-120">
[Example 6: Add a hybrid connection with ExpressRoute.](#example-6-add-a-hybrid-connection-with-expressroute)</span></span></br>
<span data-ttu-id="8e273-121">Nei prossimi mesi saranno resi disponibili in questo documento esempi per l'aggiunta di connessioni tra reti virtuali, la disponibilità elevata e il concatenamento dei servizi.</span><span class="sxs-lookup"><span data-stu-id="8e273-121">Examples for adding connections between virtual networks, high availability, and service chaining will be added to this document over the next few months.</span></span>

## <a name="microsoft-compliance-and-infrastructure-protection"></a><span data-ttu-id="8e273-122">Conformità Microsoft e protezione dell'infrastruttura</span><span class="sxs-lookup"><span data-stu-id="8e273-122">Microsoft compliance and infrastructure protection</span></span>
<span data-ttu-id="8e273-123">Microsoft offre oltre 40 certificazioni e attestazioni che consentono alle organizzazioni di soddisfare i requisiti nazionali, regionali e specifici del settore che regolano la raccolta e l'uso dei dati degli utenti.</span><span class="sxs-lookup"><span data-stu-id="8e273-123">To help organizations comply with national, regional, and industry-specific requirements governing the collection and use of individuals’ data, Microsoft offers over 40 certifications and attestations.</span></span> <span data-ttu-id="8e273-124">Si tratta del set più completo offerto da qualsiasi provider di servizi cloud.</span><span class="sxs-lookup"><span data-stu-id="8e273-124">The most comprehensive set of any cloud service provider.</span></span>

<span data-ttu-id="8e273-125">Per informazioni dettagliate, vedere le informazioni sulla conformità nel [Centro protezione di Microsoft][TrustCenter].</span><span class="sxs-lookup"><span data-stu-id="8e273-125">For more information, see the compliance information on the [Microsoft Trust Center][TrustCenter].</span></span>

<span data-ttu-id="8e273-126">Microsoft offre un approccio completo per la protezione dell'infrastruttura cloud necessaria per l'esecuzione di servizi globali su scala elevatissima.</span><span class="sxs-lookup"><span data-stu-id="8e273-126">Microsoft has a comprehensive approach to protect cloud infrastructure needed to run hyper-scale global services.</span></span> <span data-ttu-id="8e273-127">Oltre ai data center fisici, l'infrastruttura cloud Microsoft include hardware, software, reti e personale con mansioni amministrative e operative.</span><span class="sxs-lookup"><span data-stu-id="8e273-127">Microsoft cloud infrastructure includes hardware, software, networks, and administrative and operations staff, in addition to the physical data centers.</span></span>

<span data-ttu-id="8e273-128">![2]</span><span class="sxs-lookup"><span data-stu-id="8e273-128">![2]</span></span>

<span data-ttu-id="8e273-129">Questo tipo di approccio offre ai clienti una base più sicura per distribuire i propri servizi nel cloud Microsoft.</span><span class="sxs-lookup"><span data-stu-id="8e273-129">This approach provides a more secure foundation for customers to deploy their services in the Microsoft cloud.</span></span> <span data-ttu-id="8e273-130">Il passaggio successivo consiste nella progettazione e nella creazione di un'architettura di sicurezza da parte del cliente per la protezione dei servizi.</span><span class="sxs-lookup"><span data-stu-id="8e273-130">The next step is for customers to design and create a security architecture to protect these services.</span></span>

## <a name="traditional-security-architectures-and-perimeter-networks"></a><span data-ttu-id="8e273-131">Architetture di sicurezza tradizionali e reti perimetrali</span><span class="sxs-lookup"><span data-stu-id="8e273-131">Traditional security architectures and perimeter networks</span></span>
<span data-ttu-id="8e273-132">Nonostante gli importanti investimenti Microsoft nella protezione dell'infrastruttura cloud, anche i clienti devono proteggere i propri servizi cloud e i gruppi di risorse.</span><span class="sxs-lookup"><span data-stu-id="8e273-132">Although Microsoft invests heavily in protecting the cloud infrastructure, customers must also protect their cloud services and resource groups.</span></span> <span data-ttu-id="8e273-133">Un approccio a più livelli per la sicurezza offre la difesa migliore.</span><span class="sxs-lookup"><span data-stu-id="8e273-133">A multilayered approach to security provides the best defense.</span></span> <span data-ttu-id="8e273-134">Un'area di sicurezza della rete perimetrale protegge le risorse di rete interne da una rete non attendibile.</span><span class="sxs-lookup"><span data-stu-id="8e273-134">A perimeter network security zone protects internal network resources from an untrusted network.</span></span> <span data-ttu-id="8e273-135">Con rete perimetrale si intendono i perimetri o le parti della rete compresa tra Internet e l'infrastruttura IT aziendale protetta.</span><span class="sxs-lookup"><span data-stu-id="8e273-135">A perimeter network refers to the edges or parts of the network that sit between the Internet and the protected enterprise IT infrastructure.</span></span>

<span data-ttu-id="8e273-136">Nelle reti aziendali tipiche l'infrastruttura di base viene protetta in modo rilevante nelle aree perimetrali, con più livelli di dispositivi di sicurezza.</span><span class="sxs-lookup"><span data-stu-id="8e273-136">In typical enterprise networks, the core infrastructure is heavily fortified at the perimeters, with multiple layers of security devices.</span></span> <span data-ttu-id="8e273-137">Il limite di ogni livello è costituito da dispositivi e punti di applicazione dei criteri.</span><span class="sxs-lookup"><span data-stu-id="8e273-137">The boundary of each layer consists of devices and policy enforcement points.</span></span> <span data-ttu-id="8e273-138">Ogni livello può includere una combinazione dei seguenti dispositivi di sicurezza: firewall, prevenzione di attacchi DDoS (Distributed Denial of Service), sistemi di identificazione delle intrusioni o di protezione (IDS/IPS) e dispositivi VPN.</span><span class="sxs-lookup"><span data-stu-id="8e273-138">Each layer can include a combination of the following network security devices: firewalls, Denial of Service (DoS) prevention, Intrusion Detection or Protection Systems (IDS/IPS), and VPN devices.</span></span> <span data-ttu-id="8e273-139">L'applicazione dei criteri può essere effettuata tramite criteri del firewall, elenchi di controllo di accesso (ACL) o routing specifico.</span><span class="sxs-lookup"><span data-stu-id="8e273-139">Policy enforcement can take the form of firewall policies, access control lists (ACLs), or specific routing.</span></span> <span data-ttu-id="8e273-140">La prima linea di difesa della rete, che accetta direttamente traffico in arrivo da Internet, è costituita da una combinazione di questi meccanismi per bloccare gli attacchi e il traffico dannoso, senza impedire al tempo stesso il trasferimento di richieste legittime sulla rete.</span><span class="sxs-lookup"><span data-stu-id="8e273-140">The first line of defense in the network, directly accepting incoming traffic from the Internet, is a combination of these mechanisms to block attacks and harmful traffic while allowing legitimate requests further into the network.</span></span> <span data-ttu-id="8e273-141">Il traffico si instrada direttamente verso le risorse della rete perimetrale.</span><span class="sxs-lookup"><span data-stu-id="8e273-141">This traffic routes directly to resources in the perimeter network.</span></span> <span data-ttu-id="8e273-142">La risorsa interessata potrà quindi "comunicare" con risorse più interne della rete, attraversando prima il limite successivo per la convalida.</span><span class="sxs-lookup"><span data-stu-id="8e273-142">That resource may then “talk” to resources deeper in the network, transiting the next boundary for validation first.</span></span> <span data-ttu-id="8e273-143">Il livello più esterno è definito rete perimetrale perché questa parte della rete è esposta a Internet, in genere con qualche tipo di protezione su entrambi i lati.</span><span class="sxs-lookup"><span data-stu-id="8e273-143">The outermost layer is called the perimeter network because this part of the network is exposed to the Internet, usually with some form of protection on both sides.</span></span> <span data-ttu-id="8e273-144">La figura seguente illustra un esempio di una rete perimetrale con subnet singola all'interno di una rete aziendale e due limiti di sicurezza.</span><span class="sxs-lookup"><span data-stu-id="8e273-144">The following figure shows an example of a single subnet perimeter network in a corporate network, with two security boundaries.</span></span>

<span data-ttu-id="8e273-145">![3]</span><span class="sxs-lookup"><span data-stu-id="8e273-145">![3]</span></span>

<span data-ttu-id="8e273-146">Per implementare una rete perimetrale vengono usate numerose architetture,</span><span class="sxs-lookup"><span data-stu-id="8e273-146">There are many architectures used to implement a perimeter network.</span></span> <span data-ttu-id="8e273-147">che possono variare da un semplice servizio di bilanciamento del carico a una rete perimetrale con più subnet dotate di diversi meccanismi in ogni limite per bloccare il traffico e proteggere i livelli più interni della rete aziendale.</span><span class="sxs-lookup"><span data-stu-id="8e273-147">These architectures can range from a simple load balancer to a multiple-subnet perimeter network with varied mechanisms at each boundary to block traffic and protect the deeper layers of the corporate network.</span></span> <span data-ttu-id="8e273-148">La modalità di costruzione della rete perimetrale dipende dalle esigenze specifiche dell'organizzazione e dalla tolleranza del rischio complessivo ad essa associata.</span><span class="sxs-lookup"><span data-stu-id="8e273-148">How the perimeter network is built depends on the specific needs of the organization and its overall risk tolerance.</span></span>

<span data-ttu-id="8e273-149">Quando i clienti spostano i propri carichi di lavoro nei cloud pubblici, è essenziale supportare capacità analoghe per l'architettura della rete perimetrale in Azure al fine di soddisfare i requisiti di conformità e sicurezza.</span><span class="sxs-lookup"><span data-stu-id="8e273-149">As customers move their workloads to public clouds, it is critical to support similar capabilities for perimeter network architecture in Azure to meet compliance and security requirements.</span></span> <span data-ttu-id="8e273-150">Questo documento offre indicazioni su come creare un ambiente di rete sicuro in Azure.</span><span class="sxs-lookup"><span data-stu-id="8e273-150">This document provides guidelines on how customers can build a secure network environment in Azure.</span></span> <span data-ttu-id="8e273-151">Il documento è incentrato sulla rete perimetrale, ma include anche una discussione approfondita dei numerosi aspetti riguardanti la sicurezza di rete.</span><span class="sxs-lookup"><span data-stu-id="8e273-151">It focuses on the perimeter network, but also includes a comprehensive discussion of many aspects of network security.</span></span> <span data-ttu-id="8e273-152">La discussione risponde alle domande seguenti:</span><span class="sxs-lookup"><span data-stu-id="8e273-152">The following questions inform this discussion:</span></span>

* <span data-ttu-id="8e273-153">Come è possibile creare una rete perimetrale in Azure?</span><span class="sxs-lookup"><span data-stu-id="8e273-153">How can a perimeter network in Azure be built?</span></span>
* <span data-ttu-id="8e273-154">Quali sono alcune delle funzionalità di Azure disponibili per la creazione della rete perimetrale?</span><span class="sxs-lookup"><span data-stu-id="8e273-154">What are some of the Azure features available to build the perimeter network?</span></span>
* <span data-ttu-id="8e273-155">Come è possibile proteggere i carichi di lavoro back-end?</span><span class="sxs-lookup"><span data-stu-id="8e273-155">How can back-end workloads be protected?</span></span>
* <span data-ttu-id="8e273-156">In che modo vengono controllate le comunicazioni Internet per i carichi di lavoro in Azure?</span><span class="sxs-lookup"><span data-stu-id="8e273-156">How are Internet communications controlled to the workloads in Azure?</span></span>
* <span data-ttu-id="8e273-157">In che modo è possibile proteggere le reti locali da distribuzioni in Azure?</span><span class="sxs-lookup"><span data-stu-id="8e273-157">How can the on-premises networks be protected from deployments in Azure?</span></span>
* <span data-ttu-id="8e273-158">Quando è consigliabile usare le funzionalità di sicurezza native di Azure invece di appliance o servizi di terze parti?</span><span class="sxs-lookup"><span data-stu-id="8e273-158">When should native Azure security features be used versus third-party appliances or services?</span></span>

<span data-ttu-id="8e273-159">Il diagramma seguente mostra i vari livelli di sicurezza che Azure offre ai clienti.</span><span class="sxs-lookup"><span data-stu-id="8e273-159">The following diagram shows various layers of security Azure provides to customers.</span></span> <span data-ttu-id="8e273-160">Questi livelli sono costituiti sia da funzionalità native della piattaforma Azure sia da funzionalità definite dal cliente:</span><span class="sxs-lookup"><span data-stu-id="8e273-160">These layers are both native in the Azure platform itself and customer-defined features:</span></span>

<span data-ttu-id="8e273-161">![4]</span><span class="sxs-lookup"><span data-stu-id="8e273-161">![4]</span></span>

<span data-ttu-id="8e273-162">La protezione DDoS protegge il traffico in ingresso da Internet da attacchi su larga scala contro Azure.</span><span class="sxs-lookup"><span data-stu-id="8e273-162">Inbound from the Internet, Azure DDoS helps protect against large-scale attacks against Azure.</span></span> <span data-ttu-id="8e273-163">Il livello successivo è costituito da indirizzi IP pubblici (endpoint) definiti dall'utente, che vengono usati per determinare il traffico che può passare alla rete virtuale attraverso il servizio cloud.</span><span class="sxs-lookup"><span data-stu-id="8e273-163">The next layer is customer-defined public IP addresses (endpoints), which are used to determine which traffic can pass through the cloud service to the virtual network.</span></span> <span data-ttu-id="8e273-164">L'isolamento nativo della rete virtuale di Azure assicura l'isolamento completo da tutte le altre reti; consente anche il passaggio del flusso di traffico solo tramite percorsi e metodi configurati dall'utente.</span><span class="sxs-lookup"><span data-stu-id="8e273-164">Native Azure virtual network isolation ensures complete isolation from all other networks and that traffic only flows through user configured paths and methods.</span></span> <span data-ttu-id="8e273-165">Questi percorsi e metodi costituiscono il livello successivo, in cui è possibile usare NSG, UDR e appliance virtuali di rete per creare limiti di sicurezza e proteggere le distribuzioni delle applicazioni nella rete protetta.</span><span class="sxs-lookup"><span data-stu-id="8e273-165">These paths and methods are the next layer, where NSGs, UDR, and network virtual appliances can be used to create security boundaries to protect the application deployments in the protected network.</span></span>

<span data-ttu-id="8e273-166">La sezione che segue fornisce una panoramica delle reti virtuali di Azure.</span><span class="sxs-lookup"><span data-stu-id="8e273-166">The next section provides an overview of Azure virtual networks.</span></span> <span data-ttu-id="8e273-167">Queste reti virtuali di Azure vengono create dai clienti e i carichi di lavoro distribuiti dei clienti sono collegati ad esse.</span><span class="sxs-lookup"><span data-stu-id="8e273-167">These virtual networks are created by customers, and are what their deployed workloads are connected to.</span></span> <span data-ttu-id="8e273-168">Le reti virtuali sono alla base di tutte le funzionalità di sicurezza di rete necessarie per stabilire una rete perimetrale in grado di proteggere le distribuzioni ai clienti in Azure.</span><span class="sxs-lookup"><span data-stu-id="8e273-168">Virtual networks are the basis of all the network security features required to establish a perimeter network to protect customer deployments in Azure.</span></span>

## <a name="overview-of-azure-virtual-networks"></a><span data-ttu-id="8e273-169">Panoramica delle reti virtuali di Azure</span><span class="sxs-lookup"><span data-stu-id="8e273-169">Overview of Azure virtual networks</span></span>
<span data-ttu-id="8e273-170">Prima che il traffico Internet possa raggiungere le reti virtuali di Azure, sono disponibili due livelli di sicurezza insiti nella piattaforma Azure:</span><span class="sxs-lookup"><span data-stu-id="8e273-170">Before Internet traffic can get to the Azure virtual networks, there are two layers of security inherent to the Azure platform:</span></span>

1.    <span data-ttu-id="8e273-171">**Protezione DDoS**: la protezione DDoS è un livello della rete fisica di Azure che protegge la piattaforma Azure stessa da attacchi su larga scala basati su Internet.</span><span class="sxs-lookup"><span data-stu-id="8e273-171">**DDoS protection**: DDoS protection is a layer of the Azure physical network that protects the Azure platform itself from large-scale Internet-based attacks.</span></span> <span data-ttu-id="8e273-172">Per questi attacchi vengono usati più nodi "bot" nel tentativo di sovraccaricare un servizio Internet.</span><span class="sxs-lookup"><span data-stu-id="8e273-172">These attacks use multiple “bot” nodes in an attempt to overwhelm an Internet service.</span></span> <span data-ttu-id="8e273-173">Azure vanta una solida rete di protezione DDoS su tutta la connettività Internet in ingresso, in uscita e tra le aree di Azure.</span><span class="sxs-lookup"><span data-stu-id="8e273-173">Azure has a robust DDoS protection mesh on all inbound, outbound, and cross-Azure region connectivity.</span></span> <span data-ttu-id="8e273-174">Questo livello di protezione DDoS non dispone di attributi configurabili dall'utente e non è accessibile al cliente.</span><span class="sxs-lookup"><span data-stu-id="8e273-174">This DDoS protection layer has no user configurable attributes and is not accessible to the customer.</span></span> <span data-ttu-id="8e273-175">Il livello di protezione DDoS protegge Azure dagli attacchi su larga scala e monitora il traffico in uscita e tra aree di Azure.</span><span class="sxs-lookup"><span data-stu-id="8e273-175">The DDoS protection layer protects Azure as a platform from large-scale attacks, it also monitors out-bound traffic and cross-Azure region traffic.</span></span> <span data-ttu-id="8e273-176">Usando le appliance di rete virtuali nella rete virtuale, l'utente può configurare livelli di resilienza aggiuntivi per far fronte ad attacchi di scala minore che non attraversano la protezione a livello di piattaforma.</span><span class="sxs-lookup"><span data-stu-id="8e273-176">Using network virtual appliances on the VNet, additional layers of resilience can be configured by the customer against a smaller scale attack that doesn't trip the platform level protection.</span></span> <span data-ttu-id="8e273-177">Un esempio di DDoS in azione: se un indirizzo IP Internet subisce un attacco DDoS su larga scala, Azure rileva le origini degli attacchi ed elimina il traffico problematico prima che raggiunga la destinazione prevista.</span><span class="sxs-lookup"><span data-stu-id="8e273-177">An example of DDoS in action; if an internet facing IP address was attacked by a large-scale DDoS attack, Azure would detect the sources of the attacks and scrub the offending traffic before it reached its intended destination.</span></span> <span data-ttu-id="8e273-178">Nella quasi totalità dei casi, l'attacco non ha conseguenze sull'endpoint attaccato.</span><span class="sxs-lookup"><span data-stu-id="8e273-178">In almost all cases, the attacked endpoint isn't affected by the attack.</span></span> <span data-ttu-id="8e273-179">Nei rari casi in cui un endpoint subisce danni, il traffico diretto agli altri endpoint non viene alterato.</span><span class="sxs-lookup"><span data-stu-id="8e273-179">In the rare cases that an endpoint is affected, no traffic is affected to other endpoints, only the attacked endpoint.</span></span> <span data-ttu-id="8e273-180">Pertanto altri clienti e servizi non subiranno alcun effetto di tale attacco.</span><span class="sxs-lookup"><span data-stu-id="8e273-180">Thus other customers and services would see no impact from that attack.</span></span> <span data-ttu-id="8e273-181">È fondamentale notare che il livello DDoS di Azure monitora solo gli attacchi su larga scala.</span><span class="sxs-lookup"><span data-stu-id="8e273-181">It's critical to note that Azure DDoS is only looking for large-scale attacks.</span></span> <span data-ttu-id="8e273-182">È possibile che il servizio specifico risulti sovraccarico prima che siano superate le soglie di protezione a livello di piattaforma.</span><span class="sxs-lookup"><span data-stu-id="8e273-182">It is possible that your specific service could be overwhelmed before the platform level protection thresholds are exceeded.</span></span> <span data-ttu-id="8e273-183">Ad esempio, un sito Web in un singolo server IIS A0 potrebbe essere danneggiato da un attacco DDoS prima che la protezione DDoS a livello di piattaforma di Azure rilevi la minaccia.</span><span class="sxs-lookup"><span data-stu-id="8e273-183">For example, a web site on a single A0 IIS server, could be taken offline by a DDoS attack before Azure platform level DDoS protection registered a threat.</span></span>

2.  <span data-ttu-id="8e273-184">**Indirizzi IP pubblici**: gli indirizzi IP pubblici (abilitati tramite endpoint del servizio, indirizzi IP pubblici, gateway applicazione e altre funzionalità di Azure che presentano un indirizzo IP pubblico a Internet instradato alla risorsa) consentono ai servizi cloud o ai gruppi di risorse di esporre gli indirizzi IP pubblici e le porte Internet.</span><span class="sxs-lookup"><span data-stu-id="8e273-184">**Public IP Addresses**: Public IP addresses (enabled via service endpoints, Public IP addresses, Application Gateway, and other Azure features that present a public IP address to the internet routed to your resource) allow cloud services or resource groups to have public Internet IP addresses and ports exposed.</span></span> <span data-ttu-id="8e273-185">L'endpoint usa il processo NAT (Network Address Translation) per instradare il traffico fino all'indirizzo e alla porta interni nella rete virtuale di Azure.</span><span class="sxs-lookup"><span data-stu-id="8e273-185">The endpoint uses Network Address Translation (NAT) to route traffic to the internal address and port on the Azure virtual network.</span></span> <span data-ttu-id="8e273-186">È questa la modalità primaria che consente al traffico esterno di passare attraverso la rete virtuale.</span><span class="sxs-lookup"><span data-stu-id="8e273-186">This path is the primary way for external traffic to pass into the virtual network.</span></span> <span data-ttu-id="8e273-187">Gli indirizzi IP pubblici possono essere configurati per determinare il traffico autorizzato a passare e come/dove viene convertito nella rete virtuale.</span><span class="sxs-lookup"><span data-stu-id="8e273-187">The Public IP addresses are configurable to determine which traffic is passed in, and how and where it's translated on to the virtual network.</span></span>

<span data-ttu-id="8e273-188">Quando il traffico raggiunge la rete virtuale, sono disponibili molte funzionalità.</span><span class="sxs-lookup"><span data-stu-id="8e273-188">Once traffic reaches the virtual network, there are many features that come into play.</span></span> <span data-ttu-id="8e273-189">Le reti virtuali di Azure costituiscono la base a cui i clienti collegano i rispettivi carichi di lavoro e a cui si applica la sicurezza a livello di rete di base.</span><span class="sxs-lookup"><span data-stu-id="8e273-189">Azure virtual networks are the foundation for customers to attach their workloads and where basic network-level security applies.</span></span> <span data-ttu-id="8e273-190">Si tratta di una rete privata (un overlay di rete virtuale) in Azure per i clienti, che offre le funzionalità e le caratteristiche seguenti:</span><span class="sxs-lookup"><span data-stu-id="8e273-190">It is a private network (a virtual network overlay) in Azure for customers with the following features and characteristics:</span></span>

* <span data-ttu-id="8e273-191">**Isolamento del traffico**: una rete virtuale è il limite di isolamento del traffico nella piattaforma Azure.</span><span class="sxs-lookup"><span data-stu-id="8e273-191">**Traffic isolation**: A virtual network is the traffic isolation boundary on the Azure platform.</span></span> <span data-ttu-id="8e273-192">Le macchine virtuali (VM) in una rete virtuale non possono comunicare direttamente con le VM in una rete virtuale diversa, anche se entrambe le reti virtuali vengono create dallo stesso cliente.</span><span class="sxs-lookup"><span data-stu-id="8e273-192">Virtual machines (VMs) in one virtual network cannot communicate directly to VMs in a different virtual network, even if both virtual networks are created by the same customer.</span></span> <span data-ttu-id="8e273-193">L'isolamento è una proprietà essenziale che assicura che le macchine virtuali e le comunicazioni dei clienti rimangano private entro una rete virtuale.</span><span class="sxs-lookup"><span data-stu-id="8e273-193">Isolation is a critical property that ensures customer VMs and communication remains private within a virtual network.</span></span>

>[!NOTE]
><span data-ttu-id="8e273-194">L'isolamento del traffico fa riferimento solo al traffico *in ingresso* verso la rete virtuale.</span><span class="sxs-lookup"><span data-stu-id="8e273-194">Traffic isolation refers only to traffic *inbound* to the virtual network.</span></span> <span data-ttu-id="8e273-195">Per impostazione predefinita è consentito il traffico in uscita dalla rete virtuale verso Internet, ma può essere evitato dai gruppi di sicurezza di rete.</span><span class="sxs-lookup"><span data-stu-id="8e273-195">By default outbound traffic from the VNet to the internet is allowed, but can be prevented if desired by NSGs.</span></span>
>
>

* <span data-ttu-id="8e273-196">**Topologia a più livelli**: le reti virtuali consentono ai clienti di definire una topologia a più livelli, allocando subnet e designando spazi di indirizzi separati per diversi elementi o "livelli" dei rispettivi carichi di lavoro.</span><span class="sxs-lookup"><span data-stu-id="8e273-196">**Multi-tier topology**: Virtual networks allow customers to define multi-tier topology by allocating subnets and designating separate address spaces for different elements or “tiers” of their workloads.</span></span> <span data-ttu-id="8e273-197">Questi raggruppamenti logici e queste topologie consentono ai clienti di definire diversi criteri di accesso in base ai tipi di carico di lavoro e anche di controllare i flussi del traffico tra i livelli.</span><span class="sxs-lookup"><span data-stu-id="8e273-197">These logical groupings and topologies enable customers to define different access policy based on the workload types, and also control traffic flows between the tiers.</span></span>
* <span data-ttu-id="8e273-198">**Connettività cross-premise**: i clienti possono stabilire la connettività cross-premise tra una rete virtuale e più siti locali o altre reti virtuali in Azure.</span><span class="sxs-lookup"><span data-stu-id="8e273-198">**Cross-premises connectivity**: Customers can establish cross-premises connectivity between a virtual network and multiple on-premises sites or other virtual networks in Azure.</span></span> <span data-ttu-id="8e273-199">Per creare una connessione, i clienti possono usare il peering reti virtuali, i gateway VPN di Azure, appliance di rete virtuale di terze parti o ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="8e273-199">To construct a connection, customers can use VNet Peering, Azure VPN Gateways, third-party network virtual appliances, or ExpressRoute.</span></span> <span data-ttu-id="8e273-200">Azure supporta VPN da sito a sito (S2S, site-to-site) mediante protocolli IPsec/IKE standard e la connettività privata di ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="8e273-200">Azure supports site-to-site (S2S) VPNs using standard IPsec/IKE protocols and ExpressRoute private connectivity.</span></span>
* <span data-ttu-id="8e273-201">**Gruppo di sicurezza di rete (NSG)** : consente ai clienti di creare regole (ACL) al livello di granularità desiderato, ovvero interfacce di rete, singole VM o subnet virtuali.</span><span class="sxs-lookup"><span data-stu-id="8e273-201">**NSG** allows customers to create rules (ACLs) at the desired level of granularity: network interfaces, individual VMs, or virtual subnets.</span></span> <span data-ttu-id="8e273-202">I clienti possono controllare l'accesso autorizzando o negando la comunicazione tra i carichi di lavoro all'interno di una rete virtuale, da sistemi nelle reti dei clienti tramite la connettività cross-premise oppure la comunicazione Internet diretta.</span><span class="sxs-lookup"><span data-stu-id="8e273-202">Customers can control access by permitting or denying communication between the workloads within a virtual network, from systems on customer’s networks via cross-premises connectivity, or direct Internet communication.</span></span>
* <span data-ttu-id="8e273-203">La **route definite dall'utente** e l'**inoltro IP** consentono ai clienti di definire i percorsi di comunicazione tra livelli diversi all'interno di una rete virtuale.</span><span class="sxs-lookup"><span data-stu-id="8e273-203">**UDR** and **IP Forwarding** allow customers to define the communication paths between different tiers within a virtual network.</span></span> <span data-ttu-id="8e273-204">I clienti possono distribuire un firewall, IDS/IPS e altre appliance virtuali e instradare il traffico di rete attraverso queste appliance di sicurezza per l'applicazione dei criteri relativi ai limiti di sicurezza, il controllo e l'ispezione.</span><span class="sxs-lookup"><span data-stu-id="8e273-204">Customers can deploy a firewall, IDS/IPS, and other virtual appliances, and route network traffic through these security appliances for security boundary policy enforcement, auditing, and inspection.</span></span>
* <span data-ttu-id="8e273-205">**Appliance virtuali di rete** in Azure Marketplace: le appliance di sicurezza, ad esempio firewall, servizi di bilanciamento del carico e IDS/IPS, sono disponibili in Azure Marketplace e nella raccolta di immagini delle VM.</span><span class="sxs-lookup"><span data-stu-id="8e273-205">**Network virtual appliances** in the Azure Marketplace: Security appliances such as firewalls, load balancers, and IDS/IPS are available in the Azure Marketplace and the VM Image Gallery.</span></span> <span data-ttu-id="8e273-206">I clienti possono distribuire queste appliance nelle proprie reti virtuali e, in particolare, nei propri limiti di sicurezza (incluse le subnet della rete perimetrale) per ottenere un ambiente di rete sicuro a più livelli.</span><span class="sxs-lookup"><span data-stu-id="8e273-206">Customers can deploy these appliances into their virtual networks, and specifically, at their security boundaries (including the perimeter network subnets) to complete a multi-tiered secure network environment.</span></span>

<span data-ttu-id="8e273-207">Con queste funzionalità e capacità, ad esempio, è possibile creare in Azure l'architettura di rete perimetrale seguente:</span><span class="sxs-lookup"><span data-stu-id="8e273-207">With these features and capabilities, one example of how a perimeter network architecture could be constructed in Azure is the following diagram:</span></span>

<span data-ttu-id="8e273-208">![5]</span><span class="sxs-lookup"><span data-stu-id="8e273-208">![5]</span></span>

## <a name="perimeter-network-characteristics-and-requirements"></a><span data-ttu-id="8e273-209">Caratteristiche e requisiti della rete perimetrale</span><span class="sxs-lookup"><span data-stu-id="8e273-209">Perimeter network characteristics and requirements</span></span>
<span data-ttu-id="8e273-210">La rete perimetrale è il front-end della rete e si interfaccia direttamente con le comunicazioni provenienti da Internet.</span><span class="sxs-lookup"><span data-stu-id="8e273-210">The perimeter network is the front end of the network, directly interfacing communication from the Internet.</span></span> <span data-ttu-id="8e273-211">I pacchetti in ingresso devono attraversare le appliance di sicurezza, ovvero firewall, IDS e IPS, prima di raggiungere i server back-end.</span><span class="sxs-lookup"><span data-stu-id="8e273-211">The incoming packets should flow through the security appliances, such as the firewall, IDS, and IPS, before reaching the back-end servers.</span></span> <span data-ttu-id="8e273-212">Anche i pacchetti diretti a Internet dai carichi di lavoro possono attraversare le appliance di sicurezza nella rete perimetrale per finalità di applicazione dei criteri, ispezione e controllo, prima di lasciare la rete.</span><span class="sxs-lookup"><span data-stu-id="8e273-212">Internet-bound packets from the workloads can also flow through the security appliances in the perimeter network for policy enforcement, inspection, and auditing purposes, before leaving the network.</span></span> <span data-ttu-id="8e273-213">Inoltre, la rete perimetrale può essere usata per ospitare gateway VPN cross-premise tra reti virtuali del cliente e reti locali.</span><span class="sxs-lookup"><span data-stu-id="8e273-213">Additionally, the perimeter network can host cross-premises VPN gateways between customer virtual networks and on-premises networks.</span></span>

### <a name="perimeter-network-characteristics"></a><span data-ttu-id="8e273-214">Caratteristiche della rete perimetrale</span><span class="sxs-lookup"><span data-stu-id="8e273-214">Perimeter network characteristics</span></span>
<span data-ttu-id="8e273-215">Con riferimento alla figura precedente, di seguito vengono riportate alcune caratteristiche di una rete perimetrale efficiente:</span><span class="sxs-lookup"><span data-stu-id="8e273-215">Referencing the previous figure, some of the characteristics of a good perimeter network are as follows:</span></span>

* <span data-ttu-id="8e273-216">Connessione a Internet:</span><span class="sxs-lookup"><span data-stu-id="8e273-216">Internet-facing:</span></span>
  * <span data-ttu-id="8e273-217">La subnet perimetrale stessa è rivolta a Internet e comunica direttamente con Internet.</span><span class="sxs-lookup"><span data-stu-id="8e273-217">The perimeter network subnet itself is Internet-facing, directly communicating with the Internet.</span></span>
  * <span data-ttu-id="8e273-218">Gli indirizzi IP pubblici, gli indirizzi VIP e/o gli endpoint di servizio attraversano il traffico Internet per raggiungere la rete e i dispositivi front-end.</span><span class="sxs-lookup"><span data-stu-id="8e273-218">Public IP addresses, VIPs, and/or service endpoints pass Internet traffic to the front-end network and devices.</span></span>
  * <span data-ttu-id="8e273-219">Il traffico in ingresso da Internet passa attraverso dispositivi di sicurezza prima di altre risorse sulla rete front-end.</span><span class="sxs-lookup"><span data-stu-id="8e273-219">Inbound traffic from the Internet passes through security devices before other resources on the front-end network.</span></span>
  * <span data-ttu-id="8e273-220">Se la sicurezza in uscita è abilitata, il traffico attraversa i dispositivi di sicurezza, come passaggio finale, prima di passare a Internet.</span><span class="sxs-lookup"><span data-stu-id="8e273-220">If outbound security is enabled, traffic passes through security devices, as the final step, before passing to the Internet.</span></span>
* <span data-ttu-id="8e273-221">Rete protetta:</span><span class="sxs-lookup"><span data-stu-id="8e273-221">Protected network:</span></span>
  * <span data-ttu-id="8e273-222">Non vi sono percorsi diretti da Internet all'infrastruttura di base.</span><span class="sxs-lookup"><span data-stu-id="8e273-222">There is no direct path from the Internet to the core infrastructure.</span></span>
  * <span data-ttu-id="8e273-223">I canali verso l'infrastruttura di base devono attraversare i dispositivi di sicurezza, come ad esempio i gruppi di sicurezza di rete, i firewall o i dispositivi VPN.</span><span class="sxs-lookup"><span data-stu-id="8e273-223">Channels to the core infrastructure must traverse through security devices such as NSGs, firewalls, or VPN devices.</span></span>
  * <span data-ttu-id="8e273-224">Altri dispositivi non devono eseguire il bridging tra Internet e l'infrastruttura di base.</span><span class="sxs-lookup"><span data-stu-id="8e273-224">Other devices must not bridge Internet and the core infrastructure.</span></span>
  * <span data-ttu-id="8e273-225">I dispositivi di sicurezza nella rete rivolta a Internet e nella rete protetta rivolta ai limiti della rete perimetrale (ad esempio le due icone del firewall presenti nella figura precedente) possono in effetti costituire una singola appliance virtuale con regole o interfacce differenziate per ogni limite</span><span class="sxs-lookup"><span data-stu-id="8e273-225">Security devices on both the Internet-facing and the protected network facing boundaries of the perimeter network (for example, the two firewall icons shown in the previous figure) may actually be a single virtual appliance with differentiated rules or interfaces for each boundary.</span></span> <span data-ttu-id="8e273-226">(ovvero, un dispositivo fisico, separato logicamente, che gestisce il carico per entrambi i limiti della rete perimetrale).</span><span class="sxs-lookup"><span data-stu-id="8e273-226">For example, one physical device, logically separated, handling the load for both boundaries of the perimeter network.</span></span>
* <span data-ttu-id="8e273-227">Altri vincoli e procedure comuni:</span><span class="sxs-lookup"><span data-stu-id="8e273-227">Other common practices and constraints:</span></span>
  * <span data-ttu-id="8e273-228">I carichi di lavoro non devono archiviare informazioni essenziali per l'azienda.</span><span class="sxs-lookup"><span data-stu-id="8e273-228">Workloads must not store business critical information.</span></span>
  * <span data-ttu-id="8e273-229">L'accesso e gli aggiornamenti alle configurazioni e alle distribuzioni della rete perimetrale sono limitati solo agli amministratori autorizzati.</span><span class="sxs-lookup"><span data-stu-id="8e273-229">Access and updates to perimeter network configurations and deployments are limited to only authorized administrators.</span></span>

### <a name="perimeter-network-requirements"></a><span data-ttu-id="8e273-230">Requisiti della rete perimetrale</span><span class="sxs-lookup"><span data-stu-id="8e273-230">Perimeter network requirements</span></span>
<span data-ttu-id="8e273-231">Per abilitare queste caratteristiche, seguire le indicazioni riportate di seguito sui requisiti della rete virtuale necessari per implementare una rete perimetrale efficace:</span><span class="sxs-lookup"><span data-stu-id="8e273-231">To enable these characteristics, follow these guidelines on virtual network requirements to implement a successful perimeter network:</span></span>

* <span data-ttu-id="8e273-232">**Architettura della subnet:** specificare la rete virtuale in modo che un'intera subnet sia dedicata come rete perimetrale, separata da altre subnet nella stessa rete virtuale.</span><span class="sxs-lookup"><span data-stu-id="8e273-232">**Subnet architecture:** Specify the virtual network such that an entire subnet is dedicated as the perimeter network, separated from other subnets in the same virtual network.</span></span> <span data-ttu-id="8e273-233">Questa separazione garantisce che il traffico tra la rete perimetrale e altri livelli di subnet interne o private attraversi un firewall o un'appliance virtuale IDS/IPS.</span><span class="sxs-lookup"><span data-stu-id="8e273-233">This separation ensures the traffic between the perimeter network and other internal or private subnet tiers flows through a firewall or IDS/IPS virtual appliance.</span></span>  <span data-ttu-id="8e273-234">Le route definite dall'utente ai limiti delle subnet sono necessarie per inoltrare il traffico all'appliance virtuale.</span><span class="sxs-lookup"><span data-stu-id="8e273-234">User-defined routes on the boundary subnets are required to forward this traffic to the virtual appliance.</span></span>
* <span data-ttu-id="8e273-235">**Gruppo di sicurezza di rete (NSG):** la subnet perimetrale stessa deve essere aperta per consentire le comunicazioni con Internet, ma ciò non significa che i clienti devono ignorare i gruppi di sicurezza di rete.</span><span class="sxs-lookup"><span data-stu-id="8e273-235">**NSG:** The perimeter network subnet itself should be open to allow communication with the Internet, but that does not mean customers should be bypassing NSGs.</span></span> <span data-ttu-id="8e273-236">Osservare le procedure di sicurezza comuni per ridurre al minimo l'esposizione a Internet delle superfici di rete.</span><span class="sxs-lookup"><span data-stu-id="8e273-236">Follow common security practices to minimize the network surfaces exposed to the Internet.</span></span> <span data-ttu-id="8e273-237">Bloccare gli intervalli di indirizzi remoti autorizzati ad accedere alle distribuzioni o i protocolli applicativi specifici e le porte aperte.</span><span class="sxs-lookup"><span data-stu-id="8e273-237">Lock down the remote address ranges allowed to access the deployments or the specific application protocols and ports that are open.</span></span> <span data-ttu-id="8e273-238">In alcuni casi, tuttavia, non è possibile usare questa procedura.</span><span class="sxs-lookup"><span data-stu-id="8e273-238">There may be circumstances, however, in which a complete lock-down is not possible.</span></span> <span data-ttu-id="8e273-239">Ad esempio, se i clienti hanno un sito Web esterno in Azure, la rete perimetrale dovrà consentire le richieste Web in ingresso da qualsiasi indirizzo IP pubblico, ma dovrà aprire solo le porte di applicazione Web TCP 80 e/o 443.</span><span class="sxs-lookup"><span data-stu-id="8e273-239">For example, if customers have an external website in Azure, the perimeter network should allow the incoming web requests from any public IP addresses, but should only open the web application ports: TCP on port 80 and/or TCP on port 443.</span></span>
* <span data-ttu-id="8e273-240">**Tabella di routing** : la subnet perimetrale stessa dovrebbe essere in grado di comunicare direttamente con Internet, ma non deve consentire le comunicazioni dirette verso e da il back-end o dalle reti locali senza attraversare un firewall o un'appliance di sicurezza.</span><span class="sxs-lookup"><span data-stu-id="8e273-240">**Routing table:** The perimeter network subnet itself should be able to communicate to the Internet directly, but should not allow direct communication to and from the back end or on-premises networks without going through a firewall or security appliance.</span></span>
* <span data-ttu-id="8e273-241">**Configurazione delle appliance di sicurezza**: per instradare e ispezionare i pacchetti tra la rete perimetrale e il resto delle reti protette, le appliance di sicurezza, come ad esempio i firewall e i dispositivi IDS e IPS, possono essere multihomed.</span><span class="sxs-lookup"><span data-stu-id="8e273-241">**Security appliance configuration:** To route and inspect packets between the perimeter network and the rest of the protected networks, the security appliances such as firewall, IDS, and IPS devices may be multi-homed.</span></span> <span data-ttu-id="8e273-242">Questi dispositivi potrebbero disporre di schede di interfaccia di rete separate per la rete perimetrale e le subnet back-end.</span><span class="sxs-lookup"><span data-stu-id="8e273-242">They may have separate NICs for the perimeter network and the back-end subnets.</span></span> <span data-ttu-id="8e273-243">Le schede di interfaccia di rete della rete perimetrale comunicano direttamente verso e da Internet, con i gruppi di sicurezza di rete e la tabella di routing della rete perimetrale corrispondenti.</span><span class="sxs-lookup"><span data-stu-id="8e273-243">The NICs in the perimeter network communicate directly to and from the Internet, with the corresponding NSGs and the perimeter network routing table.</span></span> <span data-ttu-id="8e273-244">Le schede di interfaccia di rete che si connettono alle subnet back-end avranno gruppi di sicurezza di rete e tabelle di routing delle subnet back-end corrispondenti con più restrizioni.</span><span class="sxs-lookup"><span data-stu-id="8e273-244">The NICs connecting to the back-end subnets have more restricted NSGs and routing tables of the corresponding back-end subnets.</span></span>
* <span data-ttu-id="8e273-245">**Funzionalità dell'appliance di sicurezza:** le appliance di sicurezza distribuite nella rete perimetrale offrono in genere le funzionalità seguenti:</span><span class="sxs-lookup"><span data-stu-id="8e273-245">**Security appliance functionality:** The security appliances deployed in the perimeter network typically perform the following functionality:</span></span>
  * <span data-ttu-id="8e273-246">Firewall: applicazione delle regole del firewall o dei criteri di controllo di accesso per le richieste in ingresso.</span><span class="sxs-lookup"><span data-stu-id="8e273-246">Firewall: Enforcing firewall rules or access control policies for the incoming requests.</span></span>
  * <span data-ttu-id="8e273-247">Rilevamento e prevenzione delle minacce: rilevamento e mitigazione degli attacchi dannosi provenienti da Internet.</span><span class="sxs-lookup"><span data-stu-id="8e273-247">Threat detection and prevention: Detecting and mitigating malicious attacks from the Internet.</span></span>
  * <span data-ttu-id="8e273-248">Controllo e registrazione: gestione di log dettagliati per il controllo e l'analisi.</span><span class="sxs-lookup"><span data-stu-id="8e273-248">Auditing and logging: Maintaining detailed logs for auditing and analysis.</span></span>
  * <span data-ttu-id="8e273-249">Proxy inverso: reindirizzamento delle richieste in ingresso verso i server back-end corrispondenti.</span><span class="sxs-lookup"><span data-stu-id="8e273-249">Reverse proxy: Redirecting the incoming requests to the corresponding back-end servers.</span></span> <span data-ttu-id="8e273-250">Questo reindirizzamento comporta il mapping e la conversione degli indirizzi di destinazione nei dispositivi front-end, in genere firewall, verso gli indirizzi dei server back-end.</span><span class="sxs-lookup"><span data-stu-id="8e273-250">This redirection involves mapping and translating the destination addresses on the front-end devices, typically firewalls, to the back-end server addresses.</span></span>
  * <span data-ttu-id="8e273-251">Proxy di inoltro: processi NAT ed esecuzione di controlli per le comunicazioni avviate dall'interno della rete virtuale verso Internet.</span><span class="sxs-lookup"><span data-stu-id="8e273-251">Forward proxy: Providing NAT and performing auditing for communication initiated from within the virtual network to the Internet.</span></span>
  * <span data-ttu-id="8e273-252">Router: inoltro del traffico in ingresso e tra le subnet all'interno della rete virtuale.</span><span class="sxs-lookup"><span data-stu-id="8e273-252">Router: Forwarding incoming and cross-subnet traffic inside the virtual network.</span></span>
  * <span data-ttu-id="8e273-253">Dispositivo VPN: funzione di gateway VPN cross-premise per la connettività VPN cross-premise tra le reti locali dei clienti e le reti virtuali di Azure.</span><span class="sxs-lookup"><span data-stu-id="8e273-253">VPN device: Acting as the cross-premises VPN gateways for cross-premises VPN connectivity between customer on-premises networks and Azure virtual networks.</span></span>
  * <span data-ttu-id="8e273-254">Server VPN: accettazione dei client VPN che si connettono alle reti virtuali di Azure.</span><span class="sxs-lookup"><span data-stu-id="8e273-254">VPN server: Accepting VPN clients connecting to Azure virtual networks.</span></span>

> [!TIP]
> <span data-ttu-id="8e273-255">Mantenere i seguenti due gruppi separati: gli individui autorizzati ad accedere ai dispositivi di sicurezza della rete perimetrale e gli individui autorizzati come amministratori per lo sviluppo, la distribuzione e le operazioni sulle applicazioni.</span><span class="sxs-lookup"><span data-stu-id="8e273-255">Keep the following two groups separate: the individuals authorized to access the perimeter network security gear and the individuals authorized as application development, deployment, or operations administrators.</span></span> <span data-ttu-id="8e273-256">Se si mantengono separati questi gruppi, sarà possibile separare nettamente i compiti e impedire a una singola persona di ignorare i controlli di sicurezza delle applicazioni e della rete.</span><span class="sxs-lookup"><span data-stu-id="8e273-256">Keeping these groups separate allows for a segregation of duties and prevents a single person from bypassing both applications security and network security controls.</span></span>
>
>

### <a name="questions-to-be-asked-when-building-network-boundaries"></a><span data-ttu-id="8e273-257">Domande da porre durante la creazione dei limiti della rete</span><span class="sxs-lookup"><span data-stu-id="8e273-257">Questions to be asked when building network boundaries</span></span>
<span data-ttu-id="8e273-258">In questa sezione, se non espressamente specificato, il termine "reti" si riferisce a reti private virtuali di Azure create da un amministratore della sottoscrizione.</span><span class="sxs-lookup"><span data-stu-id="8e273-258">In this section, unless specifically mentioned, the term "networks" refers to private Azure virtual networks created by a subscription administrator.</span></span> <span data-ttu-id="8e273-259">Il termine non fa riferimento a reti fisiche sottostanti all'interno di Azure.</span><span class="sxs-lookup"><span data-stu-id="8e273-259">The term doesn't refer to the underlying physical networks within Azure.</span></span>

<span data-ttu-id="8e273-260">Le reti virtuali di Azure, inoltre, vengono usate spesso per estendere reti locali tradizionali.</span><span class="sxs-lookup"><span data-stu-id="8e273-260">Also, Azure virtual networks are often used to extend traditional on-premises networks.</span></span> <span data-ttu-id="8e273-261">È possibile incorporare soluzioni di rete ibride da sito a sito o ExpressRoute con le architetture della rete perimetrale.</span><span class="sxs-lookup"><span data-stu-id="8e273-261">It is possible to incorporate either site-to-site or ExpressRoute hybrid networking solutions with perimeter network architectures.</span></span> <span data-ttu-id="8e273-262">Questo collegamento ibrido è un fattore da tenere in considerazione durante la creazione dei limiti di sicurezza della rete.</span><span class="sxs-lookup"><span data-stu-id="8e273-262">This hybrid link is an important consideration in building network security boundaries.</span></span>

<span data-ttu-id="8e273-263">Le tre domande che seguono sono fondamentali per la creazione di una rete con una rete perimetrale e numerosi limiti di sicurezza.</span><span class="sxs-lookup"><span data-stu-id="8e273-263">The following three questions are critical to answer when you're building a network with a perimeter network and multiple security boundaries.</span></span>

#### <a name="1-how-many-boundaries-are-needed"></a><span data-ttu-id="8e273-264">1) Quanti limiti servono?</span><span class="sxs-lookup"><span data-stu-id="8e273-264">1) How many boundaries are needed?</span></span>
<span data-ttu-id="8e273-265">Il primo punto di decisione consiste nel decidere il numero di limiti di sicurezza necessari in un determinato scenario:</span><span class="sxs-lookup"><span data-stu-id="8e273-265">The first decision point is to decide how many security boundaries are needed in a given scenario:</span></span>

* <span data-ttu-id="8e273-266">Un singolo limite: un limite nella rete perimetrale front-end tra la rete virtuale e Internet.</span><span class="sxs-lookup"><span data-stu-id="8e273-266">A single boundary: One on the front-end perimeter network, between the virtual network and the Internet.</span></span>
* <span data-ttu-id="8e273-267">Due limiti: uno sul lato Internet della rete perimetrale, un altro tra la subnet perimetrale e le subnet back-end nelle reti virtuali di Azure.</span><span class="sxs-lookup"><span data-stu-id="8e273-267">Two boundaries: One on the Internet side of the perimeter network, and another between the perimeter network subnet and the back-end subnets in the Azure virtual networks.</span></span>
* <span data-ttu-id="8e273-268">Tre limiti: uno sul lato Internet della rete perimetrale, un altro tra la subnet perimetrale e le subnet back-end e l'ultimo tra le subnet back-end e la rete locale.</span><span class="sxs-lookup"><span data-stu-id="8e273-268">Three boundaries: One on the Internet side of the perimeter network, one between the perimeter network and back-end subnets, and one between the back-end subnets and the on-premises network.</span></span>
* <span data-ttu-id="8e273-269">Numero di limiti: variabile.</span><span class="sxs-lookup"><span data-stu-id="8e273-269">N boundaries: A variable number.</span></span> <span data-ttu-id="8e273-270">In base ai requisiti di sicurezza, non è prevista alcuna restrizione al numero di limiti di sicurezza applicabili in una determinata rete.</span><span class="sxs-lookup"><span data-stu-id="8e273-270">Depending on security requirements, there is no limit to the number of security boundaries that can be applied in a given network.</span></span>

<span data-ttu-id="8e273-271">Il numero e il tipo di limiti necessari dipende dalla tolleranza del rischio dell'azienda e dallo scenario specifico da implementare.</span><span class="sxs-lookup"><span data-stu-id="8e273-271">The number and type of boundaries needed vary based on a company’s risk tolerance and the specific scenario being implemented.</span></span> <span data-ttu-id="8e273-272">Si tratta spesso di una decisione comune presa da più gruppi di un'organizzazione, spesso in collaborazione con un team responsabile dei rischi e della conformità, un team responsabile della rete e della piattaforma e un team responsabile dello sviluppo di applicazioni.</span><span class="sxs-lookup"><span data-stu-id="8e273-272">This decision is often made together with multiple groups within an organization, often including a risk and compliance team, a network and platform team, and an application development team.</span></span> <span data-ttu-id="8e273-273">Le persone esperte in ambito di sicurezza, dei dati coinvolti e delle tecnologie da usare dovrebbero poter partecipare a questa decisione, per assicurare la strategia di sicurezza appropriata per ogni implementazione.</span><span class="sxs-lookup"><span data-stu-id="8e273-273">People with knowledge of security, the data involved, and the technologies being used should have a say in this decision to ensure the appropriate security stance for each implementation.</span></span>

> [!TIP]
> <span data-ttu-id="8e273-274">Usare il numero minore possibile di limiti in grado di soddisfare i requisiti di sicurezza per una determinata situazione.</span><span class="sxs-lookup"><span data-stu-id="8e273-274">Use the smallest number of boundaries that satisfy the security requirements for a given situation.</span></span> <span data-ttu-id="8e273-275">Un numero maggiore di limiti può rendere più difficili le operazioni e la risoluzione dei problemi, oltre a incrementare il sovraccarico di gestione correlato alla gestione di più criteri di limite nel tempo.</span><span class="sxs-lookup"><span data-stu-id="8e273-275">With more boundaries, operations and troubleshooting can be more difficult, as well as the management overhead involved with managing the multiple boundary policies over time.</span></span> <span data-ttu-id="8e273-276">Un numero insufficiente di limiti, tuttavia, comporta un aumento del rischio.</span><span class="sxs-lookup"><span data-stu-id="8e273-276">However, insufficient boundaries increase risk.</span></span> <span data-ttu-id="8e273-277">È essenziale trovare il giusto equilibrio.</span><span class="sxs-lookup"><span data-stu-id="8e273-277">Finding the balance is critical.</span></span>
>
>

<span data-ttu-id="8e273-278">![6]</span><span class="sxs-lookup"><span data-stu-id="8e273-278">![6]</span></span>

<span data-ttu-id="8e273-279">La figura precedente mostra una visualizzazione generale di una rete con tre limiti di sicurezza.</span><span class="sxs-lookup"><span data-stu-id="8e273-279">The preceding figure shows a high-level view of a three security boundary network.</span></span> <span data-ttu-id="8e273-280">I limiti sono posizionati tra la rete perimetrale e Internet, tra le subnet private front-end e back-end di Azure e tra la subnet back-end di Azure e la rete aziendale locale.</span><span class="sxs-lookup"><span data-stu-id="8e273-280">The boundaries are between the perimeter network and the Internet, the Azure front-end and back-end private subnets, and the Azure back-end subnet and the on-premises corporate network.</span></span>

#### <a name="2-where-are-the-boundaries-located"></a><span data-ttu-id="8e273-281">2) Dove sono situati i limiti?</span><span class="sxs-lookup"><span data-stu-id="8e273-281">2) Where are the boundaries located?</span></span>
<span data-ttu-id="8e273-282">Dopo avere stabilito il numero di limiti, occorre determinare dove implementarli.</span><span class="sxs-lookup"><span data-stu-id="8e273-282">Once the number of boundaries are decided, where to implement them is the next decision point.</span></span> <span data-ttu-id="8e273-283">In genere, sono disponibili tre opzioni:</span><span class="sxs-lookup"><span data-stu-id="8e273-283">There are generally three choices:</span></span>

* <span data-ttu-id="8e273-284">Usare un servizio intermediario basato su Internet (ad esempio, un Web application firewall basato su cloud, non trattato in questo documento)</span><span class="sxs-lookup"><span data-stu-id="8e273-284">Using an Internet-based intermediary service (for example, a cloud-based Web application firewall, which is not discussed in this document)</span></span>
* <span data-ttu-id="8e273-285">Usare funzionalità native e/o appliance virtuali di rete in Azure</span><span class="sxs-lookup"><span data-stu-id="8e273-285">Using native features and/or network virtual appliances in Azure</span></span>
* <span data-ttu-id="8e273-286">Usare dispositivi fisici nella rete locale</span><span class="sxs-lookup"><span data-stu-id="8e273-286">Using physical devices on the on-premises network</span></span>

<span data-ttu-id="8e273-287">In reti puramente Azure le opzioni disponibili sono le funzionalità di Azure native (ad esempio i servizi di bilanciamento del carico di Azure) oppure le appliance virtuali di rete presenti nel ricco ecosistema di partner di Azure (ad esempio i firewall Check Point).</span><span class="sxs-lookup"><span data-stu-id="8e273-287">On purely Azure networks, the options are native Azure features (for example, Azure Load Balancers) or network virtual appliances from the rich partner ecosystem of Azure (for example, Check Point firewalls).</span></span>

<span data-ttu-id="8e273-288">Se è necessario impostare un limite tra Azure e una rete locale, le appliance di sicurezza possono trovarsi su un qualsiasi lato della connessione (o su entrambi i lati).</span><span class="sxs-lookup"><span data-stu-id="8e273-288">If a boundary is needed between Azure and an on-premises network, the security devices can reside on either side of the connection (or both sides).</span></span> <span data-ttu-id="8e273-289">È quindi necessario stabilire in che posizione inserire i dispositivi di sicurezza.</span><span class="sxs-lookup"><span data-stu-id="8e273-289">Thus a decision must be made on the location to place security gear.</span></span>

<span data-ttu-id="8e273-290">Nella figura precedente i limiti da Internet alla rete perimetrale e dal front-end sono inclusi interamente in Azure e devono essere funzionalità native di Azure o appliance virtuali di rete.</span><span class="sxs-lookup"><span data-stu-id="8e273-290">In the previous figure, the Internet-to-perimeter network and the front-to-back-end boundaries are entirely contained within Azure, and must be either native Azure features or network virtual appliances.</span></span> <span data-ttu-id="8e273-291">Le appliance di sicurezza sul limite tra Azure (subnet back-end) e la rete aziendale possono essere sul lato Azure o sul lato locale oppure è possibile usare una combinazione di appliance su entrambi i lati.</span><span class="sxs-lookup"><span data-stu-id="8e273-291">Security devices on the boundary between Azure (back-end subnet) and the corporate network could be either on the Azure side or the on-premises side, or even a combination of devices on both sides.</span></span> <span data-ttu-id="8e273-292">Occorre valutare con attenzione i vantaggi e gli svantaggi significativi di entrambe le opzioni.</span><span class="sxs-lookup"><span data-stu-id="8e273-292">There can be significant advantages and disadvantages to either option that must be seriously considered.</span></span>

<span data-ttu-id="8e273-293">Ad esempio, l'uso dei dispositivi fisici di sicurezza esistenti sulla rete locale consente di non usare necessariamente nuovi dispositivi.</span><span class="sxs-lookup"><span data-stu-id="8e273-293">For example, using existing physical security gear on the on-premises network side has the advantage that no new gear is needed.</span></span> <span data-ttu-id="8e273-294">È sufficiente la riconfigurazione dei dispositivi esistenti.</span><span class="sxs-lookup"><span data-stu-id="8e273-294">It just needs reconfiguration.</span></span> <span data-ttu-id="8e273-295">Di contro, tutto il traffico deve tornare da Azure alla rete locale per potere essere visualizzato dal dispositivo di sicurezza.</span><span class="sxs-lookup"><span data-stu-id="8e273-295">The disadvantage, however, is that all traffic must come back from Azure to the on-premises network to be seen by the security gear.</span></span> <span data-ttu-id="8e273-296">Il traffico da Azure ad Azure potrebbe quindi subire una latenza significativa e influire sulle prestazioni delle applicazioni e sull'esperienza utente, se ne è stato imposto il ritorno alla rete locale tramite l'applicazione dei criteri di sicurezza.</span><span class="sxs-lookup"><span data-stu-id="8e273-296">Thus Azure-to-Azure traffic could incur significant latency, and affect application performance and user experience, if it was forced back to the on-premises network for security policy enforcement.</span></span>

#### <a name="3-how-are-the-boundaries-implemented"></a><span data-ttu-id="8e273-297">3) In che modo vengono implementati i limiti?</span><span class="sxs-lookup"><span data-stu-id="8e273-297">3) How are the boundaries implemented?</span></span>
<span data-ttu-id="8e273-298">È probabile che per ogni limite di sicurezza siano previsti requisiti di capacità diversi (ad esempio regole per IDS e firewall sul lato Internet della rete perimetrale, ma solo elenchi di controllo di accesso tra la rete perimetrale e la subnet back-end).</span><span class="sxs-lookup"><span data-stu-id="8e273-298">Each security boundary will likely have different capability requirements (for example, IDS and firewall rules on the Internet side of the perimeter network, but only ACLs between the perimeter network and back-end subnet).</span></span> <span data-ttu-id="8e273-299">La decisione relativa a quali o quanti dispositivi usare dipende dallo scenario e dai requisiti di sicurezza.</span><span class="sxs-lookup"><span data-stu-id="8e273-299">Deciding on which device (or how many devices) to use depends on the scenario and security requirements.</span></span> <span data-ttu-id="8e273-300">Nella sezione seguente, gli esempi 1, 2 e 3 illustrano alcune opzioni che possono essere utilizzate.</span><span class="sxs-lookup"><span data-stu-id="8e273-300">In the following section, examples 1, 2, and 3 discuss some options that could be used.</span></span> <span data-ttu-id="8e273-301">La verifica delle funzionalità di rete native di Azure e dei dispositivi disponibili in Azure dall'ecosistema partner mette in luce le numerosissime opzioni disponibili per risolvere quasi tutti gli scenari.</span><span class="sxs-lookup"><span data-stu-id="8e273-301">Reviewing the Azure native network features and the devices available in Azure from the partner ecosystem shows the myriad options available to solve virtually any scenario.</span></span>

<span data-ttu-id="8e273-302">Un altro punto di decisione essenziale per l'implementazione consiste nella modalità di connessione della rete locale con Azure.</span><span class="sxs-lookup"><span data-stu-id="8e273-302">Another key implementation decision point is how to connect the on-premises network with Azure.</span></span> <span data-ttu-id="8e273-303">Sarebbe opportuno usare il gateway virtuale di Azure o un'appliance virtuale di rete?</span><span class="sxs-lookup"><span data-stu-id="8e273-303">Should you use the Azure virtual gateway or a network virtual appliance?</span></span> <span data-ttu-id="8e273-304">Nella seguente sezione vengono illustrate nel dettaglio queste opzioni (esempi 4, 5 e 6).</span><span class="sxs-lookup"><span data-stu-id="8e273-304">These options are discussed in greater detail in the following section (examples 4, 5, and 6).</span></span>

<span data-ttu-id="8e273-305">Inoltre, potrebbe essere necessario consultare informazioni sul traffico tra reti virtuali all'interno di Azure.</span><span class="sxs-lookup"><span data-stu-id="8e273-305">Additionally, traffic between virtual networks within Azure may be needed.</span></span> <span data-ttu-id="8e273-306">Questi scenari verranno aggiunti in futuro.</span><span class="sxs-lookup"><span data-stu-id="8e273-306">These scenarios will be added in the future.</span></span>

<span data-ttu-id="8e273-307">Una volta ricevute le risposte alle domande precedenti, la sezione [Avvio veloce](#fast-start) può semplificare l'identificazione degli esempi più appropriati per un particolare scenario.</span><span class="sxs-lookup"><span data-stu-id="8e273-307">Once you know the answers to the previous questions, the [Fast Start](#fast-start) section can help identify which examples are most appropriate for a given scenario.</span></span>

## <a name="examples-building-security-boundaries-with-azure-virtual-networks"></a><span data-ttu-id="8e273-308">Esempi: Creare limiti di sicurezza con le reti virtuali di Azure</span><span class="sxs-lookup"><span data-stu-id="8e273-308">Examples: Building security boundaries with Azure virtual networks</span></span>
### <a name="example-1-build-a-perimeter-network-to-help-protect-applications-with-nsgs"></a><span data-ttu-id="8e273-309">Esempio 1: Creare una rete perimetrale per proteggere le applicazioni con i gruppi di sicurezza di rete</span><span class="sxs-lookup"><span data-stu-id="8e273-309">Example 1 Build a perimeter network to help protect applications with NSGs</span></span>
<span data-ttu-id="8e273-310">[Torna all'avvio veloce](#fast-start) | [Istruzioni di creazione dettagliate per questo esempio][Example1]</span><span class="sxs-lookup"><span data-stu-id="8e273-310">[Back to Fast start](#fast-start) | [Detailed build instructions for this example][Example1]</span></span>

<span data-ttu-id="8e273-311">[![7]][7]</span><span class="sxs-lookup"><span data-stu-id="8e273-311">[![7]][7]</span></span>

#### <a name="environment-description"></a><span data-ttu-id="8e273-312">Descrizione dell'ambiente</span><span class="sxs-lookup"><span data-stu-id="8e273-312">Environment description</span></span>
<span data-ttu-id="8e273-313">In questo esempio è presente una sottoscrizione che include le risorse seguenti:</span><span class="sxs-lookup"><span data-stu-id="8e273-313">In this example, there is a subscription that contains the following resources:</span></span>

- <span data-ttu-id="8e273-314">Un unico gruppo di risorse</span><span class="sxs-lookup"><span data-stu-id="8e273-314">A single resource group</span></span>
- <span data-ttu-id="8e273-315">Una rete virtuale con due subnet: front-end e back-end</span><span class="sxs-lookup"><span data-stu-id="8e273-315">A virtual network with two subnets: “FrontEnd” and “BackEnd”</span></span>
- <span data-ttu-id="8e273-316">Un gruppo di sicurezza di rete applicato a entrambe le subnet</span><span class="sxs-lookup"><span data-stu-id="8e273-316">A Network Security Group that is applied to both subnets</span></span>
- <span data-ttu-id="8e273-317">Un server Windows che rappresenta un server Web applicazioni ("IIS01")</span><span class="sxs-lookup"><span data-stu-id="8e273-317">A Windows server that represents an application web server (“IIS01”)</span></span>
- <span data-ttu-id="8e273-318">Due server Windows che rappresentano server back-end applicazioni ("AppVM01", "AppVM02")</span><span class="sxs-lookup"><span data-stu-id="8e273-318">Two Windows servers that represent application back-end servers (“AppVM01”, “AppVM02”)</span></span>
- <span data-ttu-id="8e273-319">Un server Windows che rappresenta un server DNS ("DNS01")</span><span class="sxs-lookup"><span data-stu-id="8e273-319">A Windows server that represents a DNS server (“DNS01”)</span></span>
- <span data-ttu-id="8e273-320">Un IP pubblico associato al server Web dell'applicazione</span><span class="sxs-lookup"><span data-stu-id="8e273-320">A public IP associated with the application web server</span></span>

<span data-ttu-id="8e273-321">Per gli script e un modello di Azure Resource Manager, vedere le [istruzioni di creazione dettagliate][Example1].</span><span class="sxs-lookup"><span data-stu-id="8e273-321">For scripts and an Azure Resource Manager template, see the [detailed build instructions][Example1].</span></span>

#### <a name="nsg-description"></a><span data-ttu-id="8e273-322">Descrizione di un gruppo di sicurezza di rete</span><span class="sxs-lookup"><span data-stu-id="8e273-322">NSG description</span></span>
<span data-ttu-id="8e273-323">In questo esempio viene creato un gruppo di sicurezza di rete, in cui vengono poi caricate sei regole.</span><span class="sxs-lookup"><span data-stu-id="8e273-323">In this example, an NSG group is built and then loaded with six rules.</span></span>

> [!TIP]
> <span data-ttu-id="8e273-324">In genere, è consigliabile creare prima di tutto le regole specifiche di tipo "Consenti" e infine le regole di tipo "Nega", più generiche.</span><span class="sxs-lookup"><span data-stu-id="8e273-324">Generally speaking, you should create your specific “Allow” rules first, followed by the more generic “Deny” rules.</span></span> <span data-ttu-id="8e273-325">La priorità assegnata determina quali regole vengono valutate per prime.</span><span class="sxs-lookup"><span data-stu-id="8e273-325">The given priority dictates which rules are evaluated first.</span></span> <span data-ttu-id="8e273-326">Quando si rileva che al traffico è applicabile una determinata regola, non vengono valutate altre regole.</span><span class="sxs-lookup"><span data-stu-id="8e273-326">Once traffic is found to apply to a specific rule, no further rules are evaluated.</span></span> <span data-ttu-id="8e273-327">Le regole del gruppo di sicurezza di rete possono essere applicate nella direzione in ingresso o in uscita (dal punto di vista della subnet).</span><span class="sxs-lookup"><span data-stu-id="8e273-327">NSG rules can apply in either the inbound or outbound direction (from the perspective of the subnet).</span></span>
>
>

<span data-ttu-id="8e273-328">A livello dichiarativo, per il traffico in ingresso vengono create le righe seguenti:</span><span class="sxs-lookup"><span data-stu-id="8e273-328">Declaratively, the following rules are being built for inbound traffic:</span></span>

1. <span data-ttu-id="8e273-329">Il traffico DNS interno (porta 53) è consentito.</span><span class="sxs-lookup"><span data-stu-id="8e273-329">Internal DNS traffic (port 53) is allowed.</span></span>
2. <span data-ttu-id="8e273-330">Il traffico RDP (porta 3389) da Internet a qualsiasi macchina virtuale è consentito.</span><span class="sxs-lookup"><span data-stu-id="8e273-330">RDP traffic (port 3389) from the Internet to any Virtual Machine is allowed.</span></span>
3. <span data-ttu-id="8e273-331">Il traffico HTTP (porta 80) da Internet al server Web (IIS01) è consentito.</span><span class="sxs-lookup"><span data-stu-id="8e273-331">HTTP traffic (port 80) from the Internet to web server (IIS01) is allowed.</span></span>
4. <span data-ttu-id="8e273-332">Tutto il traffico (tutte le porte) da IIS01 ad AppVM1 è consentito.</span><span class="sxs-lookup"><span data-stu-id="8e273-332">Any traffic (all ports) from IIS01 to AppVM1 is allowed.</span></span>
5. <span data-ttu-id="8e273-333">Tutto il traffico (tutte le porte) da Internet all'intera rete virtuale (entrambe le subnet) viene bloccato.</span><span class="sxs-lookup"><span data-stu-id="8e273-333">Any traffic (all ports) from the Internet to the entire virtual network (both subnets) is denied.</span></span>
6. <span data-ttu-id="8e273-334">Tutto il traffico (tutte le porte) dalla subnet front-end alla subnet back-end viene bloccato.</span><span class="sxs-lookup"><span data-stu-id="8e273-334">Any traffic (all ports) from the front-end subnet to the back-end subnet is denied.</span></span>

<span data-ttu-id="8e273-335">Con queste regole associate a ogni subnet, se una richiesta HTTP proviene da Internet verso il server Web,  entrambe le regole 3 (consenti) e 5 (nega) saranno applicabili.</span><span class="sxs-lookup"><span data-stu-id="8e273-335">With these rules bound to each subnet, if an HTTP request was inbound from the Internet to the web server, both rules 3 (allow) and 5 (deny) would apply.</span></span> <span data-ttu-id="8e273-336">Tuttavia, poiché la regola 3 ha una priorità maggiore, verrà applicata solo tale regola e la regola 5 non verrà presa in considerazione.</span><span class="sxs-lookup"><span data-stu-id="8e273-336">But because rule 3 has a higher priority, only it would apply, and rule 5 would not come into play.</span></span> <span data-ttu-id="8e273-337">La richiesta HTTP verrà quindi consentita sul server Web.</span><span class="sxs-lookup"><span data-stu-id="8e273-337">Thus the HTTP request would be allowed to the web server.</span></span> <span data-ttu-id="8e273-338">Se lo stesso traffico prova a raggiungere il server DNS01, la regola 5 (nega) sarà la prima applicabile e il traffico non sarà autorizzato a passare al server.</span><span class="sxs-lookup"><span data-stu-id="8e273-338">If that same traffic was trying to reach the DNS01 server, rule 5 (deny) would be the first to apply, and the traffic would not be allowed to pass to the server.</span></span> <span data-ttu-id="8e273-339">La regola 6 (nega) blocca la comunicazione tra la subnet front-end e la subnet back-end (ad eccezione del traffico consentito nelle regole 1 e 4).</span><span class="sxs-lookup"><span data-stu-id="8e273-339">Rule 6 (deny) blocks the front-end subnet from talking to the back-end subnet (except for allowed traffic in rules 1 and 4).</span></span> <span data-ttu-id="8e273-340">L'insieme di regole consente di proteggere la rete di back-end nel caso in cui un utente malintenzionato comprometta l'applicazione Web sul front-end.</span><span class="sxs-lookup"><span data-stu-id="8e273-340">This rule-set protects the back-end network in case an attacker compromises the web application on the front end.</span></span> <span data-ttu-id="8e273-341">L'utente malintenzionato potrebbe disporre di accesso limitato alla rete di back-end "protetta" (solo verso risorse esposte sul server AppVM01).</span><span class="sxs-lookup"><span data-stu-id="8e273-341">The attacker would have limited access to the back-end “protected” network (only to resources exposed on the AppVM01 server).</span></span>

<span data-ttu-id="8e273-342">Esiste una regola in uscita predefinita che consente il traffico in uscita verso Internet.</span><span class="sxs-lookup"><span data-stu-id="8e273-342">There is a default outbound rule that allows traffic out to the Internet.</span></span> <span data-ttu-id="8e273-343">Per questo esempio si consente il traffico in uscita e non si modificano le regole in uscita.</span><span class="sxs-lookup"><span data-stu-id="8e273-343">For this example, we’re allowing outbound traffic and not modifying any outbound rules.</span></span> <span data-ttu-id="8e273-344">Per bloccare il traffico in entrambe le direzioni, è necessario il routing definito dall'utente (consultare l'esempio 3).</span><span class="sxs-lookup"><span data-stu-id="8e273-344">To lock down traffic in both directions, user-defined routing is required (see example 3).</span></span>

#### <a name="conclusion"></a><span data-ttu-id="8e273-345">Conclusioni</span><span class="sxs-lookup"><span data-stu-id="8e273-345">Conclusion</span></span>
<span data-ttu-id="8e273-346">Questo esempio consente di isolare la subnet back-end dal traffico in ingresso in un modo semplice e diretto.</span><span class="sxs-lookup"><span data-stu-id="8e273-346">This example is a relatively simple and straightforward way of isolating the back-end subnet from inbound traffic.</span></span> <span data-ttu-id="8e273-347">Per altre informazioni, vedere le [istruzioni di creazione dettagliate][Example1].</span><span class="sxs-lookup"><span data-stu-id="8e273-347">For more information, see the [detailed build instructions][Example1].</span></span> <span data-ttu-id="8e273-348">Le istruzioni includono:</span><span class="sxs-lookup"><span data-stu-id="8e273-348">These instructions include:</span></span>

* <span data-ttu-id="8e273-349">Come creare la rete perimetrale con script di PowerShell classico.</span><span class="sxs-lookup"><span data-stu-id="8e273-349">How to build this perimeter network with classic PowerShell scripts.</span></span>
* <span data-ttu-id="8e273-350">Come creare la rete perimetrale con un modello di Azure Resource Manager</span><span class="sxs-lookup"><span data-stu-id="8e273-350">How to build this perimeter network with an Azure Resource Manager template.</span></span>
* <span data-ttu-id="8e273-351">Descrizioni dettagliate di ogni comando del gruppo di sicurezza di rete</span><span class="sxs-lookup"><span data-stu-id="8e273-351">Detailed descriptions of each NSG command.</span></span>
* <span data-ttu-id="8e273-352">Scenari dettagliati del flusso di traffico che illustrano il modo in cui il traffico viene consentito o negato su ogni livello</span><span class="sxs-lookup"><span data-stu-id="8e273-352">Detailed traffic flow scenarios, showing how traffic is allowed or denied in each layer.</span></span>


### <a name="example-2-build-a-perimeter-network-to-help-protect-applications-with-a-firewall-and-nsgs"></a><span data-ttu-id="8e273-353">Esempio 2: Creare una rete perimetrale per proteggere le applicazioni con un firewall e gruppi di sicurezza di rete</span><span class="sxs-lookup"><span data-stu-id="8e273-353">Example 2 Build a perimeter network to help protect applications with a firewall and NSGs</span></span>
<span data-ttu-id="8e273-354">[Torna all'avvio veloce](#fast-start) | [Istruzioni di creazione dettagliate per questo esempio][Example2]</span><span class="sxs-lookup"><span data-stu-id="8e273-354">[Back to Fast start](#fast-start) | [Detailed build instructions for this example][Example2]</span></span>

<span data-ttu-id="8e273-355">[![8]][8]</span><span class="sxs-lookup"><span data-stu-id="8e273-355">[![8]][8]</span></span>

#### <a name="environment-description"></a><span data-ttu-id="8e273-356">Descrizione dell'ambiente</span><span class="sxs-lookup"><span data-stu-id="8e273-356">Environment description</span></span>
<span data-ttu-id="8e273-357">In questo esempio è presente una sottoscrizione che include le risorse seguenti:</span><span class="sxs-lookup"><span data-stu-id="8e273-357">In this example, there is a subscription that contains the following resources:</span></span>

* <span data-ttu-id="8e273-358">Un unico gruppo di risorse</span><span class="sxs-lookup"><span data-stu-id="8e273-358">A single resource group</span></span>
* <span data-ttu-id="8e273-359">Una rete virtuale con due subnet: front-end e back-end</span><span class="sxs-lookup"><span data-stu-id="8e273-359">A virtual network with two subnets: “FrontEnd” and “BackEnd”</span></span>
* <span data-ttu-id="8e273-360">Un gruppo di sicurezza di rete applicato a entrambe le subnet</span><span class="sxs-lookup"><span data-stu-id="8e273-360">A Network Security Group that is applied to both subnets</span></span>
* <span data-ttu-id="8e273-361">Un'appliance virtuale di rete, in questo caso un firewall connesso alla subnet front-end</span><span class="sxs-lookup"><span data-stu-id="8e273-361">A network virtual appliance, in this case a firewall, connected to the front-end subnet</span></span>
* <span data-ttu-id="8e273-362">Un server Windows che rappresenta un server Web applicazioni ("IIS01")</span><span class="sxs-lookup"><span data-stu-id="8e273-362">A Windows server that represents an application web server (“IIS01”)</span></span>
* <span data-ttu-id="8e273-363">Due server Windows che rappresentano server back-end applicazioni ("AppVM01", "AppVM02")</span><span class="sxs-lookup"><span data-stu-id="8e273-363">Two Windows servers that represent application back-end servers (“AppVM01”, “AppVM02”)</span></span>
* <span data-ttu-id="8e273-364">Un server Windows che rappresenta un server DNS ("DNS01")</span><span class="sxs-lookup"><span data-stu-id="8e273-364">A Windows server that represents a DNS server (“DNS01”)</span></span>

<span data-ttu-id="8e273-365">Per gli script e un modello di Azure Resource Manager, vedere le [istruzioni di creazione dettagliate][Example2].</span><span class="sxs-lookup"><span data-stu-id="8e273-365">For scripts and an Azure Resource Manager template, see the [detailed build instructions][Example2].</span></span>

#### <a name="nsg-description"></a><span data-ttu-id="8e273-366">Descrizione di un gruppo di sicurezza di rete</span><span class="sxs-lookup"><span data-stu-id="8e273-366">NSG description</span></span>
<span data-ttu-id="8e273-367">In questo esempio viene creato un gruppo di sicurezza di rete, in cui vengono poi caricate sei regole.</span><span class="sxs-lookup"><span data-stu-id="8e273-367">In this example, an NSG group is built and then loaded with six rules.</span></span>

> [!TIP]
> <span data-ttu-id="8e273-368">In genere, è consigliabile creare prima di tutto le regole specifiche di tipo "Consenti" e infine le regole di tipo "Nega", più generiche.</span><span class="sxs-lookup"><span data-stu-id="8e273-368">Generally speaking, you should create your specific “Allow” rules first, followed by the more generic “Deny” rules.</span></span> <span data-ttu-id="8e273-369">La priorità assegnata determina quali regole vengono valutate per prime.</span><span class="sxs-lookup"><span data-stu-id="8e273-369">The given priority dictates which rules are evaluated first.</span></span> <span data-ttu-id="8e273-370">Quando si rileva che al traffico è applicabile una determinata regola, non vengono valutate altre regole.</span><span class="sxs-lookup"><span data-stu-id="8e273-370">Once traffic is found to apply to a specific rule, no further rules are evaluated.</span></span> <span data-ttu-id="8e273-371">Le regole del gruppo di sicurezza di rete possono essere applicate nella direzione in ingresso o in uscita (dal punto di vista della subnet).</span><span class="sxs-lookup"><span data-stu-id="8e273-371">NSG rules can apply in either the inbound or outbound direction (from the perspective of the subnet).</span></span>
>
>

<span data-ttu-id="8e273-372">A livello dichiarativo, per il traffico in ingresso vengono create le righe seguenti:</span><span class="sxs-lookup"><span data-stu-id="8e273-372">Declaratively, the following rules are being built for inbound traffic:</span></span>

1. <span data-ttu-id="8e273-373">Il traffico DNS interno (porta 53) è consentito.</span><span class="sxs-lookup"><span data-stu-id="8e273-373">Internal DNS traffic (port 53) is allowed.</span></span>
2. <span data-ttu-id="8e273-374">Il traffico RDP (porta 3389) da Internet a qualsiasi macchina virtuale è consentito.</span><span class="sxs-lookup"><span data-stu-id="8e273-374">RDP traffic (port 3389) from the Internet to any Virtual Machine is allowed.</span></span>
3. <span data-ttu-id="8e273-375">Tutto il traffico Internet (tutte le porte) verso l'appliance virtuale di rete (firewall) è consentito.</span><span class="sxs-lookup"><span data-stu-id="8e273-375">Any Internet traffic (all ports) to the network virtual appliance (firewall) is allowed.</span></span>
4. <span data-ttu-id="8e273-376">Tutto il traffico (tutte le porte) da IIS01 ad AppVM1 è consentito.</span><span class="sxs-lookup"><span data-stu-id="8e273-376">Any traffic (all ports) from IIS01 to AppVM1 is allowed.</span></span>
5. <span data-ttu-id="8e273-377">Tutto il traffico (tutte le porte) da Internet all'intera rete virtuale (entrambe le subnet) viene bloccato.</span><span class="sxs-lookup"><span data-stu-id="8e273-377">Any traffic (all ports) from the Internet to the entire virtual network (both subnets) is denied.</span></span>
6. <span data-ttu-id="8e273-378">Tutto il traffico (tutte le porte) dalla subnet front-end alla subnet back-end viene bloccato.</span><span class="sxs-lookup"><span data-stu-id="8e273-378">Any traffic (all ports) from the front-end subnet to the back-end subnet is denied.</span></span>

<span data-ttu-id="8e273-379">Con queste regole associate a ogni subnet, se una richiesta HTTP proviene da Internet verso il firewall, le regole 3 (consenti) e 5 (nega) saranno applicabili,</span><span class="sxs-lookup"><span data-stu-id="8e273-379">With these rules bound to each subnet, if an HTTP request was inbound from the Internet to the firewall, both rules 3 (allow) and 5 (deny) would apply.</span></span> <span data-ttu-id="8e273-380">Tuttavia, poiché la regola 3 ha una priorità maggiore, verrà applicata solo tale regola e la regola 5 non verrà presa in considerazione.</span><span class="sxs-lookup"><span data-stu-id="8e273-380">But because rule 3 has a higher priority, only it would apply, and rule 5 would not come into play.</span></span> <span data-ttu-id="8e273-381">La richiesta HTTP verrà quindi consentita sul firewall.</span><span class="sxs-lookup"><span data-stu-id="8e273-381">Thus the HTTP request would be allowed to the firewall.</span></span> <span data-ttu-id="8e273-382">Se lo stesso traffico prova a raggiungere il server IIS01, anche se si trova sulla subnet front-end, la regola 5 (nega) verrà applicata e il traffico non sarà autorizzato a passare al server.</span><span class="sxs-lookup"><span data-stu-id="8e273-382">If that same traffic was trying to reach the IIS01 server, even though it’s on the front-end subnet, rule 5 (deny) would apply, and the traffic would not be allowed to pass to the server.</span></span> <span data-ttu-id="8e273-383">La regola 6 (nega) blocca la comunicazione tra la subnet front-end e la subnet back-end (ad eccezione del traffico consentito nelle regole 1 e 4).</span><span class="sxs-lookup"><span data-stu-id="8e273-383">Rule 6 (deny) blocks the front-end subnet from talking to the back-end subnet (except for allowed traffic in rules 1 and 4).</span></span> <span data-ttu-id="8e273-384">L'insieme di regole consente di proteggere la rete di back-end nel caso in cui un utente malintenzionato comprometta l'applicazione Web sul front-end.</span><span class="sxs-lookup"><span data-stu-id="8e273-384">This rule-set protects the back-end network in case an attacker compromises the web application on the front end.</span></span> <span data-ttu-id="8e273-385">L'utente malintenzionato potrebbe disporre di accesso limitato alla rete di back-end "protetta" (solo verso risorse esposte sul server AppVM01).</span><span class="sxs-lookup"><span data-stu-id="8e273-385">The attacker would have limited access to the back-end “protected” network (only to resources exposed on the AppVM01 server).</span></span>

<span data-ttu-id="8e273-386">Esiste una regola in uscita predefinita che consente il traffico in uscita verso Internet.</span><span class="sxs-lookup"><span data-stu-id="8e273-386">There is a default outbound rule that allows traffic out to the Internet.</span></span> <span data-ttu-id="8e273-387">Per questo esempio si consente il traffico in uscita e non si modificano le regole in uscita.</span><span class="sxs-lookup"><span data-stu-id="8e273-387">For this example, we’re allowing outbound traffic and not modifying any outbound rules.</span></span> <span data-ttu-id="8e273-388">Per bloccare il traffico in entrambe le direzioni, è necessario il routing definito dall'utente (consultare l'esempio 3).</span><span class="sxs-lookup"><span data-stu-id="8e273-388">To lock down traffic in both directions, user-defined routing is required (see example 3).</span></span>

#### <a name="firewall-rule-description"></a><span data-ttu-id="8e273-389">Descrizione della regola del firewall</span><span class="sxs-lookup"><span data-stu-id="8e273-389">Firewall rule description</span></span>
<span data-ttu-id="8e273-390">Sul firewall è necessario creare regole di inoltro.</span><span class="sxs-lookup"><span data-stu-id="8e273-390">On the firewall, forwarding rules should be created.</span></span> <span data-ttu-id="8e273-391">Poiché questo esempio instrada solo il traffico Internet in ingresso verso il firewall e quindi verso il server Web, sarà necessaria solo una regola del processo NAT (Network Address Translation) di inoltro.</span><span class="sxs-lookup"><span data-stu-id="8e273-391">Since this example only routes Internet traffic in-bound to the firewall and then to the web server, only one forwarding network address translation (NAT) rule is needed.</span></span>

<span data-ttu-id="8e273-392">La regola di inoltro accetterà qualsiasi indirizzo di origine in ingresso che raggiunge il firewall nel tentativo di raggiungere HTTP (porta 80 o 443 per HTTPS).</span><span class="sxs-lookup"><span data-stu-id="8e273-392">The forwarding rule accepts any inbound source address that hits the firewall trying to reach HTTP (port 80 or 443 for HTTPS).</span></span> <span data-ttu-id="8e273-393">Gli indirizzi verranno trasmessi all'interfaccia locale del firewall e reindirizzati al server Web con indirizzo IP 10.0.1.5.</span><span class="sxs-lookup"><span data-stu-id="8e273-393">It's sent out of the firewall’s local interface and redirected to the web server with the IP Address of 10.0.1.5.</span></span>

#### <a name="conclusion"></a><span data-ttu-id="8e273-394">Conclusioni</span><span class="sxs-lookup"><span data-stu-id="8e273-394">Conclusion</span></span>
<span data-ttu-id="8e273-395">Questo esempio rappresenta un metodo relativamente semplice per proteggere l'applicazione con un firewall e isolare la subnet back-end dal traffico in ingresso.</span><span class="sxs-lookup"><span data-stu-id="8e273-395">This example is a relatively straightforward way of protecting your application with a firewall and isolating the back-end subnet from inbound traffic.</span></span> <span data-ttu-id="8e273-396">Per altre informazioni, vedere le [istruzioni di creazione dettagliate][Example2].</span><span class="sxs-lookup"><span data-stu-id="8e273-396">For more information, see the [detailed build instructions][Example2].</span></span> <span data-ttu-id="8e273-397">Le istruzioni includono:</span><span class="sxs-lookup"><span data-stu-id="8e273-397">These instructions include:</span></span>

* <span data-ttu-id="8e273-398">Come creare la rete perimetrale con script di PowerShell classico.</span><span class="sxs-lookup"><span data-stu-id="8e273-398">How to build this perimeter network with classic PowerShell scripts.</span></span>
* <span data-ttu-id="8e273-399">Come creare la rete perimetrale di esempio con un modello di Azure Resource Manager</span><span class="sxs-lookup"><span data-stu-id="8e273-399">How to build this example with an Azure Resource Manager template.</span></span>
* <span data-ttu-id="8e273-400">Descrizioni dettagliate di ogni comando del gruppo di sicurezza di rete e di ogni regola del firewall</span><span class="sxs-lookup"><span data-stu-id="8e273-400">Detailed descriptions of each NSG command and firewall rule.</span></span>
* <span data-ttu-id="8e273-401">Scenari dettagliati del flusso di traffico che illustrano il modo in cui il traffico viene consentito o negato su ogni livello</span><span class="sxs-lookup"><span data-stu-id="8e273-401">Detailed traffic flow scenarios, showing how traffic is allowed or denied in each layer.</span></span>

### <a name="example-3-build-a-perimeter-network-to-help-protect-networks-with-a-firewall-and-udr-and-nsg"></a><span data-ttu-id="8e273-402">Esempio 3: Creare una rete perimetrale per proteggere le reti con un firewall, route definite dall'utente e gruppi di sicurezza di rete</span><span class="sxs-lookup"><span data-stu-id="8e273-402">Example 3 Build a perimeter network to help protect networks with a firewall and UDR and NSG</span></span>
<span data-ttu-id="8e273-403">[Torna all'avvio veloce](#fast-start) | [Istruzioni di creazione dettagliate per questo esempio][Example3]</span><span class="sxs-lookup"><span data-stu-id="8e273-403">[Back to Fast start](#fast-start) | [Detailed build instructions for this example][Example3]</span></span>

<span data-ttu-id="8e273-404">[![9]][9]</span><span class="sxs-lookup"><span data-stu-id="8e273-404">[![9]][9]</span></span>

#### <a name="environment-description"></a><span data-ttu-id="8e273-405">Descrizione dell'ambiente</span><span class="sxs-lookup"><span data-stu-id="8e273-405">Environment description</span></span>
<span data-ttu-id="8e273-406">In questo esempio è presente una sottoscrizione che include le risorse seguenti:</span><span class="sxs-lookup"><span data-stu-id="8e273-406">In this example, there is a subscription that contains the following resources:</span></span>

* <span data-ttu-id="8e273-407">Un unico gruppo di risorse</span><span class="sxs-lookup"><span data-stu-id="8e273-407">A single resource group</span></span>
* <span data-ttu-id="8e273-408">Una rete virtuale con tre subnet: "SecNet", "FrontEnd" e "BackEnd"</span><span class="sxs-lookup"><span data-stu-id="8e273-408">A virtual network with three subnets: “SecNet”, “FrontEnd”, and “BackEnd”</span></span>
* <span data-ttu-id="8e273-409">Un'appliance virtuale di rete, in questo caso un firewall connesso alla subnet "SecNet"</span><span class="sxs-lookup"><span data-stu-id="8e273-409">A network virtual appliance, in this case a firewall, connected to the SecNet subnet</span></span>
* <span data-ttu-id="8e273-410">Un server Windows che rappresenta un server Web applicazioni ("IIS01")</span><span class="sxs-lookup"><span data-stu-id="8e273-410">A Windows server that represents an application web server (“IIS01”)</span></span>
* <span data-ttu-id="8e273-411">Due server Windows che rappresentano server back-end applicazioni ("AppVM01", "AppVM02")</span><span class="sxs-lookup"><span data-stu-id="8e273-411">Two Windows servers that represent application back-end servers (“AppVM01”, “AppVM02”)</span></span>
* <span data-ttu-id="8e273-412">Un server Windows che rappresenta un server DNS ("DNS01")</span><span class="sxs-lookup"><span data-stu-id="8e273-412">A Windows server that represents a DNS server (“DNS01”)</span></span>

<span data-ttu-id="8e273-413">Per gli script e un modello di Azure Resource Manager, vedere le [istruzioni di creazione dettagliate][Example3].</span><span class="sxs-lookup"><span data-stu-id="8e273-413">For scripts and an Azure Resource Manager template, see the [detailed build instructions][Example3].</span></span>

#### <a name="udr-description"></a><span data-ttu-id="8e273-414">Descrizione delle route definite dall'utente (UDR)</span><span class="sxs-lookup"><span data-stu-id="8e273-414">UDR description</span></span>
<span data-ttu-id="8e273-415">Per impostazione predefinita, le route di sistema seguenti sono definite in questo modo:</span><span class="sxs-lookup"><span data-stu-id="8e273-415">By default, the following system routes are defined as:</span></span>

        Effective routes :
         Address Prefix    Next hop type    Next hop IP address Status   Source     
         --------------    -------------    ------------------- ------   ------     
         {10.0.0.0/16}     VNETLocal                            Active   Default    
         {0.0.0.0/0}       Internet                             Active   Default    
         {10.0.0.0/8}      Null                                 Active   Default    
         {100.64.0.0/10}   Null                                 Active   Default    
         {172.16.0.0/12}   Null                                 Active   Default    
         {192.168.0.0/16}  Null                                 Active   Default

<span data-ttu-id="8e273-416">VNETLocal è sempre uno dei prefissi degli indirizzi definiti della rete virtuale per la rete specifica (ovvero, cambia da una rete virtuale all'altra, a seconda della definizione di ogni specifica rete virtuale).</span><span class="sxs-lookup"><span data-stu-id="8e273-416">The VNETLocal is always one or more defined address prefixes that make up the virtual network for that specific network (that is, it changes from virtual network to virtual network, depending on how each specific virtual network is defined).</span></span> <span data-ttu-id="8e273-417">Le route di sistema rimanenti sono statiche e predefinite come indicato nella tabella.</span><span class="sxs-lookup"><span data-stu-id="8e273-417">The remaining system routes are static and default as indicated in the table.</span></span>

<span data-ttu-id="8e273-418">In questo esempio vengono create due tabelle di routing, una per la subnet front-end e una per la subnet back-end.</span><span class="sxs-lookup"><span data-stu-id="8e273-418">In this example, two routing tables are created, one each for the front-end and back-end subnets.</span></span> <span data-ttu-id="8e273-419">In ogni tabella vengono caricate le route statiche appropriate per la subnet specifica.</span><span class="sxs-lookup"><span data-stu-id="8e273-419">Each table is loaded with static routes appropriate for the given subnet.</span></span> <span data-ttu-id="8e273-420">In questo esempio, ogni tabella contiene tre route che indirizzano tutto il traffico (0.0.0.0/0) attraverso il firewall (hop successivo = indirizzo IP dell'appliance virtuale):</span><span class="sxs-lookup"><span data-stu-id="8e273-420">In this example, each table has three routes that direct all traffic (0.0.0.0/0) through the firewall (Next hop = Virtual Appliance IP address):</span></span>

1. <span data-ttu-id="8e273-421">Traffico della subnet locale senza la definizione di un hop successivo per consentire al traffico della subnet locale di ignorare il firewall.</span><span class="sxs-lookup"><span data-stu-id="8e273-421">Local subnet traffic with no Next Hop defined to allow local subnet traffic to bypass the firewall.</span></span>
2. <span data-ttu-id="8e273-422">Traffico della rete virtuale con la definizione di un hop successivo come firewall,</span><span class="sxs-lookup"><span data-stu-id="8e273-422">Virtual network traffic with a Next Hop defined as firewall.</span></span> <span data-ttu-id="8e273-423">in modo da eseguire l'override della regola predefinita che consente l'indirizzamento diretto del traffico della rete virtuale locale.</span><span class="sxs-lookup"><span data-stu-id="8e273-423">This next hop overrides the default rule that allows local virtual network traffic to route directly.</span></span>
3. <span data-ttu-id="8e273-424">Tutto il traffico rimanente (0/0) con un hop successivo definito come firewall.</span><span class="sxs-lookup"><span data-stu-id="8e273-424">All remaining traffic (0/0) with a Next Hop defined as the firewall.</span></span>

> [!TIP]
> <span data-ttu-id="8e273-425">Se la voce della rete locale non è presente nella route definita dall'utente, verranno interrotte le comunicazioni con la subnet locale.</span><span class="sxs-lookup"><span data-stu-id="8e273-425">Not having the local subnet entry in the UDR breaks local subnet communications.</span></span>
>
> * <span data-ttu-id="8e273-426">Nel nostro esempio, è fondamentale che 10.0.1.0/24 punti a VNETLocal.</span><span class="sxs-lookup"><span data-stu-id="8e273-426">In our example, 10.0.1.0/24 pointing to VNETLocal is critical!</span></span> <span data-ttu-id="8e273-427">In caso contrario, il pacchetto in uscita dal server Web (10.0.1.4) e destinato a un altro server locale, ad esempio 10.0.1.25, verrà inviato all'appliance virtuale di rete,</span><span class="sxs-lookup"><span data-stu-id="8e273-427">Without it, packet leaving the Web Server (10.0.1.4) destined to another local server (for example) 10.0.1.25 will fail as they will be sent to the NVA.</span></span> <span data-ttu-id="8e273-428">la quale provvederà a inviarlo alla subnet, che a sua volta lo reinvierà all'appliance virtuale di rete, generando un loop infinito.</span><span class="sxs-lookup"><span data-stu-id="8e273-428">The NVA will send it to the subnet, and the subnet will resend it to the NVA in an infinite loop.</span></span>
> * <span data-ttu-id="8e273-429">Le possibilità di un loop di routing in genere sono maggiori nelle appliance a più NIC direttamente connesse a diverse subnet, come di solito accade per le appliance tradizionali locali.</span><span class="sxs-lookup"><span data-stu-id="8e273-429">The chances of a routing loop are typically higher on appliances with multiple NICs that are connected to separate subnets, which is often of traditional, on-premises appliances.</span></span>
>
>

<span data-ttu-id="8e273-430">Dopo la creazione, le tabelle di routing vengono associate alle rispettive subnet.</span><span class="sxs-lookup"><span data-stu-id="8e273-430">Once the routing tables are created, they must be bound to their subnets.</span></span> <span data-ttu-id="8e273-431">Dopo la creazione e l'associazione alla subnet, la tabella di routing della subnet front-end avrà un aspetto analogo al seguente:</span><span class="sxs-lookup"><span data-stu-id="8e273-431">The front-end subnet routing table, once created and bound to the subnet, would look like this output:</span></span>

        Effective routes :
         Address Prefix    Next hop type    Next hop IP address Status   Source     
         --------------    -------------    ------------------- ------   ------     
         {10.0.1.0/24}     VNETLocal                            Active
         {10.0.0.0/16}     VirtualAppliance 10.0.0.4            Active    
         {0.0.0.0/0}       VirtualAppliance 10.0.0.4            Active

> [!NOTE]
> <span data-ttu-id="8e273-432">La route definita dall'utente ora può essere applicata alla subnet del gateway a cui è connesso il circuito ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="8e273-432">UDR can now be applied to the gateway subnet on which the ExpressRoute circuit is connected.</span></span>
>
> <span data-ttu-id="8e273-433">Negli esempi 3 e 4 sono illustrate le modalità per abilitare la rete perimetrale con la rete da sito a sito o con ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="8e273-433">Examples of how to enable your perimeter network with ExpressRoute or site-to-site networking are shown in examples 3 and 4.</span></span>
>
>

#### <a name="ip-forwarding-description"></a><span data-ttu-id="8e273-434">Descrizione dell'inoltro IP</span><span class="sxs-lookup"><span data-stu-id="8e273-434">IP Forwarding description</span></span>
<span data-ttu-id="8e273-435">L'inoltro IP è una funzionalità complementare delle route definite dall'utente.</span><span class="sxs-lookup"><span data-stu-id="8e273-435">IP Forwarding is a companion feature to UDR.</span></span> <span data-ttu-id="8e273-436">Si tratta di un'impostazione in un'appliance virtuale che consente al dispositivo di ricevere traffico non indirizzato in modo specifico allo stesso e quindi di inoltrare il traffico alla destinazione finale.</span><span class="sxs-lookup"><span data-stu-id="8e273-436">IP Forwarding is a setting on a virtual appliance that allows it to receive traffic not specifically addressed to the appliance, and then forward that traffic to its ultimate destination.</span></span>

<span data-ttu-id="8e273-437">Ad esempio, se il traffico da AppVM01 esegue una richiesta al server DNS01, le route definite dall'utente instraderanno tale richiesta al firewall.</span><span class="sxs-lookup"><span data-stu-id="8e273-437">For example, if AppVM01 makes a request to the DNS01 server, UDR would route this traffic to the firewall.</span></span> <span data-ttu-id="8e273-438">Se l'inoltro IP è abilitato, il traffico per la destinazione DNS01 (10.0.2.4) viene accettato dall'appliance (10.0.0.4) e quindi inoltrato alla destinazione finale (10.0.2.4).</span><span class="sxs-lookup"><span data-stu-id="8e273-438">With IP Forwarding enabled, the traffic for the DNS01 destination (10.0.2.4) is accepted by the appliance (10.0.0.4) and then forwarded to its ultimate destination (10.0.2.4).</span></span> <span data-ttu-id="8e273-439">Se l'inoltro IP non è abilitato sul firewall, il traffico non verrà accettato dall'appliance, anche se la tabella di route specifica il firewall come hop successivo.</span><span class="sxs-lookup"><span data-stu-id="8e273-439">Without IP Forwarding enabled on the firewall, traffic would not be accepted by the appliance even though the route table has the firewall as the next hop.</span></span> <span data-ttu-id="8e273-440">Per usare un'appliance virtuale, è essenziale ricordare di abilitare l'inoltro IP insieme alle route definite dall'utente.</span><span class="sxs-lookup"><span data-stu-id="8e273-440">To use a virtual appliance, it’s critical to remember to enable IP Forwarding along with UDR.</span></span>

#### <a name="nsg-description"></a><span data-ttu-id="8e273-441">Descrizione di un gruppo di sicurezza di rete</span><span class="sxs-lookup"><span data-stu-id="8e273-441">NSG description</span></span>
<span data-ttu-id="8e273-442">In questo esempio viene creato un gruppo di sicurezza di rete, in cui viene poi caricata una singola regola.</span><span class="sxs-lookup"><span data-stu-id="8e273-442">In this example, an NSG group is built and then loaded with a single rule.</span></span> <span data-ttu-id="8e273-443">Questo gruppo viene quindi associato solo alle subnet front-end e back-end (non a SecNet).</span><span class="sxs-lookup"><span data-stu-id="8e273-443">This group is then bound only to the front-end and back-end subnets (not the SecNet).</span></span> <span data-ttu-id="8e273-444">La regola seguente viene creata in modo dichiarativo:</span><span class="sxs-lookup"><span data-stu-id="8e273-444">Declaratively the following rule is being built:</span></span>

* <span data-ttu-id="8e273-445">Tutto il traffico (tutte le porte) da Internet all'intera rete virtuale (tutte le subnet) viene bloccato.</span><span class="sxs-lookup"><span data-stu-id="8e273-445">Any traffic (all ports) from the Internet to the entire virtual network (all subnets) is denied.</span></span>

<span data-ttu-id="8e273-446">Anche se in questo esempio vengono usati i gruppi di sicurezza di rete: lo scopo principale consiste nel creare un secondo livello di difesa contro errori di configurazione manuale.</span><span class="sxs-lookup"><span data-stu-id="8e273-446">Although NSGs are used in this example, its main purpose is as a secondary layer of defense against manual misconfiguration.</span></span> <span data-ttu-id="8e273-447">L'obiettivo è bloccare tutto il traffico in ingresso da Internet verso le subnet front-end o back-end.</span><span class="sxs-lookup"><span data-stu-id="8e273-447">The goal is to block all inbound traffic from the Internet to either the front-end or back-end subnets.</span></span> <span data-ttu-id="8e273-448">Il traffico deve solo attraversare la subnet SecNet verso il firewall (e quindi, se appropriato, deve raggiungere le subnet front-end o back-end).</span><span class="sxs-lookup"><span data-stu-id="8e273-448">Traffic should only flow through the SecNet subnet to the firewall (and then, if appropriate, on to the front-end or back-end subnets).</span></span> <span data-ttu-id="8e273-449">Con l'abilitazione delle regole delle route definite dall'utente, inoltre, tutto il traffico che raggiunge le subnet front-end o back-end verrà indirizzato verso il firewall (grazie alle route definite dall'utente).</span><span class="sxs-lookup"><span data-stu-id="8e273-449">Plus, with the UDR rules in place, any traffic that did make it into the front-end or back-end subnets would be directed out to the firewall (thanks to UDR).</span></span> <span data-ttu-id="8e273-450">Il firewall considera questo traffico come un flusso asimmetrico e rimuove il traffico in uscita.</span><span class="sxs-lookup"><span data-stu-id="8e273-450">The firewall would see this traffic as an asymmetric flow and would drop the outbound traffic.</span></span> <span data-ttu-id="8e273-451">Sono quindi disponibili tre livelli di sicurezza per la protezione delle subnet:</span><span class="sxs-lookup"><span data-stu-id="8e273-451">Thus there are three layers of security protecting the subnets:</span></span>

* <span data-ttu-id="8e273-452">Nessun indirizzo IP pubblico su qualsiasi scheda di interfaccia di rete front-end o back-end.</span><span class="sxs-lookup"><span data-stu-id="8e273-452">No Public IP addresses on any FrontEnd or BackEnd NICs.</span></span>
* <span data-ttu-id="8e273-453">Gruppi di sicurezza di rete che non consentono il traffico da Internet</span><span class="sxs-lookup"><span data-stu-id="8e273-453">NSGs denying traffic from the Internet.</span></span>
* <span data-ttu-id="8e273-454">Rimozione del traffico asimmetrico da parte del firewall</span><span class="sxs-lookup"><span data-stu-id="8e273-454">The firewall dropping asymmetric traffic.</span></span>

<span data-ttu-id="8e273-455">Un aspetto interessante del gruppo di sicurezza di rete di questo esempio consiste nel fatto che include solo una regola, ovvero non consentire il traffico Internet nell'intera rete virtuale, inclusa la subnet di sicurezza.</span><span class="sxs-lookup"><span data-stu-id="8e273-455">One interesting point regarding the NSG in this example is that it contains only one rule, which is to deny Internet traffic to the entire virtual network, including the Security subnet.</span></span> <span data-ttu-id="8e273-456">Poiché, tuttavia, il gruppo di sicurezza di rete è associato solo alle subnet front-end e back-end, la regola non viene elaborata sul traffico in ingresso verso la subnet di sicurezza.</span><span class="sxs-lookup"><span data-stu-id="8e273-456">However, since the NSG is only bound to the front-end and back-end subnets, the rule isn’t processed on traffic inbound to the Security subnet.</span></span> <span data-ttu-id="8e273-457">Di conseguenza, il traffico raggiungerà la subnet di sicurezza.</span><span class="sxs-lookup"><span data-stu-id="8e273-457">As a result, traffic flows to the Security subnet.</span></span>

#### <a name="firewall-rules"></a><span data-ttu-id="8e273-458">Regole del firewall</span><span class="sxs-lookup"><span data-stu-id="8e273-458">Firewall rules</span></span>
<span data-ttu-id="8e273-459">Sul firewall è necessario creare regole di inoltro.</span><span class="sxs-lookup"><span data-stu-id="8e273-459">On the firewall, forwarding rules should be created.</span></span> <span data-ttu-id="8e273-460">Poiché il firewall blocca o inoltra tutto il traffico in ingresso, in uscita e tra le reti virtuali, sono necessarie molte regole del firewall.</span><span class="sxs-lookup"><span data-stu-id="8e273-460">Since the firewall is blocking or forwarding all inbound, outbound, and intra-virtual network traffic, many firewall rules are needed.</span></span> <span data-ttu-id="8e273-461">Tutto il traffico in ingresso, inoltre, raggiungerà l'indirizzo IP pubblico del servizio di sicurezza su porte diverse, per l'elaborazione da parte del firewall.</span><span class="sxs-lookup"><span data-stu-id="8e273-461">Also, all inbound traffic hits the Security Service public IP address (on different ports), to be processed by the firewall.</span></span> <span data-ttu-id="8e273-462">Una procedura consigliata consiste nel creare un diagramma dei flussi logici prima di configurare le regole delle subnet e del firewall, per evitare modifiche successive.</span><span class="sxs-lookup"><span data-stu-id="8e273-462">A best practice is to diagram the logical flows before setting up the subnets and firewall rules, to avoid rework later.</span></span> <span data-ttu-id="8e273-463">La figura seguente è una visualizzazione logica delle regole del firewall per questo esempio:</span><span class="sxs-lookup"><span data-stu-id="8e273-463">The following figure is a logical view of the firewall rules for this example:</span></span>

<span data-ttu-id="8e273-464">![10]</span><span class="sxs-lookup"><span data-stu-id="8e273-464">![10]</span></span>

> [!NOTE]
> <span data-ttu-id="8e273-465">Le porte di gestione dipendono dall'appliance virtuale di rete usata.</span><span class="sxs-lookup"><span data-stu-id="8e273-465">Based on the Network Virtual Appliance used, the management ports vary.</span></span> <span data-ttu-id="8e273-466">In questo esempio si fa riferimento a Barracuda NextGen Firewall, che usa le porte 22, 801 e 807.</span><span class="sxs-lookup"><span data-stu-id="8e273-466">In this example, a Barracuda NextGen Firewall is referenced, which uses ports 22, 801, and 807.</span></span> <span data-ttu-id="8e273-467">Per informazioni precise sulle porte usate per la gestione del dispositivo in uso, consultare la documentazione del fornitore del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="8e273-467">Consult the appliance vendor documentation to find the exact ports used for management of the device being used.</span></span>
>
>

#### <a name="firewall-rules-description"></a><span data-ttu-id="8e273-468">Descrizione delle regole del firewall</span><span class="sxs-lookup"><span data-stu-id="8e273-468">Firewall rules description</span></span>
<span data-ttu-id="8e273-469">Nel diagramma precedente la subnet di sicurezza non viene visualizzata perché il firewall è l'unica risorsa in tale subnet.</span><span class="sxs-lookup"><span data-stu-id="8e273-469">In the preceding logical diagram, the security subnet is not shown because the firewall is the only resource on that subnet.</span></span> <span data-ttu-id="8e273-470">Questo diagramma illustra le regole del firewall e il modo in cui le regole consentono o negano logicamente i flussi di traffico, non il percorso instradato effettivo.</span><span class="sxs-lookup"><span data-stu-id="8e273-470">The diagram is showing the firewall rules and how they logically allow or deny traffic flows, not the actual routed path.</span></span> <span data-ttu-id="8e273-471">Le porte esterne selezionate per il traffico RDP, inoltre, sono le porte incluse negli intervalli più elevati (8014 - 8026) e sono state selezionate per allinearsi almeno in parte con gli ultimi due ottetti dell'indirizzo IP locale al fine di facilitarne la lettura (ad esempio, l'indirizzo del server locale 10.0.1.4 è associato alla porta esterna 8014).</span><span class="sxs-lookup"><span data-stu-id="8e273-471">Also, the external ports selected for the RDP traffic are higher ranged ports (8014 – 8026) and were selected to loosely align with the last two octets of the local IP address for easier readability (for example, local server address 10.0.1.4 is associated with external port 8014).</span></span> <span data-ttu-id="8e273-472">È tuttavia possibile usare qualsiasi porta superiore non in conflitto.</span><span class="sxs-lookup"><span data-stu-id="8e273-472">Any higher non-conflicting ports, however, could be used.</span></span>

<span data-ttu-id="8e273-473">Per questo esempio, sono necessari sette tipi di regole:</span><span class="sxs-lookup"><span data-stu-id="8e273-473">For this example, we need seven types of rules:</span></span>

* <span data-ttu-id="8e273-474">Regole esterne (per il traffico in ingresso):</span><span class="sxs-lookup"><span data-stu-id="8e273-474">External rules (for inbound traffic):</span></span>
  1. <span data-ttu-id="8e273-475">Regola di gestione del firewall: questa regola di reindirizzamento dell'app consente al traffico di raggiungere le porte di gestione dell'appliance virtuale di rete.</span><span class="sxs-lookup"><span data-stu-id="8e273-475">Firewall management rule: This App Redirect rule allows traffic to pass to the management ports of the network virtual appliance.</span></span>
  2. <span data-ttu-id="8e273-476">Regole RDP (per ogni server Windows): queste quattro regole (una per ogni server) consentono la gestione dei singoli server tramite RDP.</span><span class="sxs-lookup"><span data-stu-id="8e273-476">RDP rules (for each Windows server): These four rules (one for each server) allow management of the individual servers via RDP.</span></span> <span data-ttu-id="8e273-477">È anche possibile raggruppare queste quattro regole RDP in una sola regola, in base alle capacità dell'appliance virtuale di rete usata.</span><span class="sxs-lookup"><span data-stu-id="8e273-477">The four RDP rules could also be collapsed into one rule, depending on the capabilities of the network virtual appliance being used.</span></span>
  3. <span data-ttu-id="8e273-478">Regole del traffico dell'applicazione: sono disponibili due regole, la prima per il traffico Web front-end e la seconda per il traffico back-end (ad esempio dal server Web al livello dati).</span><span class="sxs-lookup"><span data-stu-id="8e273-478">Application traffic rules: There are two of these rules, the first for the front-end web traffic, and the second for the back-end traffic (for example, web server to data tier).</span></span> <span data-ttu-id="8e273-479">La configurazione di queste regole dipende dall'architettura di rete (ovvero dove sono posizionati i server) e dai flussi di traffico (ovvero la direzione dei flussi di traffico e le porte usate).</span><span class="sxs-lookup"><span data-stu-id="8e273-479">The configuration of these rules depends on the network architecture (where your servers are placed) and traffic flows (which direction the traffic flows, and which ports are used).</span></span>
     * <span data-ttu-id="8e273-480">La prima regola consente al traffico effettivo dell'applicazione di raggiungere il server applicazioni.</span><span class="sxs-lookup"><span data-stu-id="8e273-480">The first rule allows the actual application traffic to reach the application server.</span></span> <span data-ttu-id="8e273-481">Anche se altre regole consentono la sicurezza e la gestione, le regole del traffico dell'applicazione consentono a utenti o servizi esterni di accedere alle applicazioni.</span><span class="sxs-lookup"><span data-stu-id="8e273-481">While the other rules allow for security and management, application traffic rules are what allow external users or services to access the applications.</span></span> <span data-ttu-id="8e273-482">In questo esempio è presente un singolo server Web sulla porta 80.</span><span class="sxs-lookup"><span data-stu-id="8e273-482">For this example, there is a single web server on port 80.</span></span> <span data-ttu-id="8e273-483">Pertanto, una singola regola delle applicazioni per il firewall reindirizza il traffico in ingresso verso l'indirizzo IP esterno e verso l'indirizzo IP interno dei server Web.</span><span class="sxs-lookup"><span data-stu-id="8e273-483">Thus a single firewall application rule redirects inbound traffic to the external IP, to the web servers internal IP address.</span></span> <span data-ttu-id="8e273-484">La sessione di traffico reindirizzato sarà trasferita tramite il processo NAT verso il server interno.</span><span class="sxs-lookup"><span data-stu-id="8e273-484">The redirected traffic session would be translated via NAT to the internal server.</span></span>
     * <span data-ttu-id="8e273-485">La seconda regola è la regola back-end per consentire al server Web di comunicare con il server AppVM01 (ma non con AppVM02) tramite qualsiasi porta.</span><span class="sxs-lookup"><span data-stu-id="8e273-485">The second rule is the back-end rule to allow the web server to talk to the AppVM01 server (but not AppVM02) via any port.</span></span>
* <span data-ttu-id="8e273-486">Regole interne (per il traffico tra le reti virtuali)</span><span class="sxs-lookup"><span data-stu-id="8e273-486">Internal rules (for intra-virtual network traffic)</span></span>
  1. <span data-ttu-id="8e273-487">Regola in uscita verso Internet: questa regola consente al traffico proveniente da qualsiasi rete di passare alle reti selezionate.</span><span class="sxs-lookup"><span data-stu-id="8e273-487">Outbound to Internet rule: This rule allows traffic from any network to pass to the selected networks.</span></span> <span data-ttu-id="8e273-488">Questa regola è in genere una regola predefinita già disponibile sul firewall, ma con stato disabilitato.</span><span class="sxs-lookup"><span data-stu-id="8e273-488">This rule is usually a default rule already on the firewall, but in a disabled state.</span></span> <span data-ttu-id="8e273-489">È consigliabile abilitarla per questo esempio.</span><span class="sxs-lookup"><span data-stu-id="8e273-489">This rule should be enabled for this example.</span></span>
  2. <span data-ttu-id="8e273-490">Regola DNS: questa regola consente solo al traffico DNS (porta 53) di raggiungere il server DNS.</span><span class="sxs-lookup"><span data-stu-id="8e273-490">DNS rule: This rule allows only DNS (port 53) traffic to pass to the DNS server.</span></span> <span data-ttu-id="8e273-491">Per questo ambiente la maggior parte del traffico dal front-end e dal back-end è bloccato.</span><span class="sxs-lookup"><span data-stu-id="8e273-491">For this environment, most traffic from the front end to the back end is blocked.</span></span> <span data-ttu-id="8e273-492">Questa regola consente in modo specifico il traffico DNS da qualsiasi subnet locale.</span><span class="sxs-lookup"><span data-stu-id="8e273-492">This rule specifically allows DNS from any local subnet.</span></span>
  3. <span data-ttu-id="8e273-493">Regola da subnet a subnet: questa regola consente a qualsiasi server sulla subnet back-end di connettersi a qualsiasi server sulla subnet front-end (ma non viceversa).</span><span class="sxs-lookup"><span data-stu-id="8e273-493">Subnet to subnet rule: This rule is to allow any server on the back-end subnet to connect to any server on the front-end subnet (but not the reverse).</span></span>
* <span data-ttu-id="8e273-494">Regola alternativa (per il traffico che non soddisfa alcuna condizione precedente):</span><span class="sxs-lookup"><span data-stu-id="8e273-494">Fail-safe rule (for traffic that doesn’t meet any of the previous):</span></span>
  1. <span data-ttu-id="8e273-495">Regola per negare tutto il traffico: deve essere sempre la regola finale (a livello di priorità). Se i flussi di traffico non corrispondono ad alcuna regola precedente, verranno eliminati da questa regola.</span><span class="sxs-lookup"><span data-stu-id="8e273-495">Deny all traffic rule: This deny rule should always be the final rule (in terms of priority), and as such if a traffic flow fails to match any of the preceding rules it is dropped by this rule.</span></span> <span data-ttu-id="8e273-496">La regola è predefinita, in genere sul posto e attiva,</span><span class="sxs-lookup"><span data-stu-id="8e273-496">This rule is a default rule and usually in-place and active.</span></span> <span data-ttu-id="8e273-497">e non necessita di modifiche.</span><span class="sxs-lookup"><span data-stu-id="8e273-497">No modifications are usually needed to this rule.</span></span>

> [!TIP]
> <span data-ttu-id="8e273-498">Per semplificare, nella seconda regola del traffico delle applicazioni è consentita qualsiasi porta.</span><span class="sxs-lookup"><span data-stu-id="8e273-498">On the second application traffic rule, to simplify this example, any port is allowed.</span></span> <span data-ttu-id="8e273-499">In uno scenario reale, è consigliabile usare la porta e gli intervalli di indirizzi più specifici per ridurre la superficie di attacco di questa regola.</span><span class="sxs-lookup"><span data-stu-id="8e273-499">In a real scenario, the most specific port and address ranges should be used to reduce the attack surface of this rule.</span></span>
>
>

<span data-ttu-id="8e273-500">Dopo la creazione di tutte le regole precedentemente indicate, è importante esaminare la priorità di ogni regola, per assicurare che il traffico venga consentito o negato in base a quanto previsto.</span><span class="sxs-lookup"><span data-stu-id="8e273-500">Once the previous rules are created, it’s important to review the priority of each rule to ensure traffic is allowed or denied as desired.</span></span> <span data-ttu-id="8e273-501">Per questo esempio le regole sono elencate in ordine di priorità.</span><span class="sxs-lookup"><span data-stu-id="8e273-501">For this example, the rules are in priority order.</span></span>

#### <a name="conclusion"></a><span data-ttu-id="8e273-502">Conclusioni</span><span class="sxs-lookup"><span data-stu-id="8e273-502">Conclusion</span></span>
<span data-ttu-id="8e273-503">Rispetto agli esempi precedenti, questo è un metodo più complesso ma anche più completo per proteggere e isolare la rete</span><span class="sxs-lookup"><span data-stu-id="8e273-503">This example is a more complex but complete way of protecting and isolating the network than the previous examples.</span></span> <span data-ttu-id="8e273-504">(l'esempio 2 protegge solo l'applicazione,mentre l'esempio 1 isola esclusivamente le subnet).</span><span class="sxs-lookup"><span data-stu-id="8e273-504">(Example 2 protects just the application, and Example 1 just isolates subnets).</span></span> <span data-ttu-id="8e273-505">Questa struttura consente di monitorare il traffico in entrambe le direzioni e non protegge solo il server applicazioni in ingresso, ma applica anche i criteri di sicurezza di rete su tutti i server in questa rete.</span><span class="sxs-lookup"><span data-stu-id="8e273-505">This design allows for monitoring traffic in both directions, and protects not just the inbound application server but enforces network security policy for all servers on this network.</span></span> <span data-ttu-id="8e273-506">In base al dispositivo usato, è anche possibile ottenere il controllo e il riconoscimento di tutto il traffico.</span><span class="sxs-lookup"><span data-stu-id="8e273-506">Also, depending on the appliance used, full traffic auditing and awareness can be achieved.</span></span> <span data-ttu-id="8e273-507">Per altre informazioni, vedere le [istruzioni di creazione dettagliate][Example3].</span><span class="sxs-lookup"><span data-stu-id="8e273-507">For more information, see the [detailed build instructions][Example3].</span></span> <span data-ttu-id="8e273-508">Le istruzioni includono:</span><span class="sxs-lookup"><span data-stu-id="8e273-508">These instructions include:</span></span>

* <span data-ttu-id="8e273-509">Come creare la rete perimetrale di esempio con script di PowerShell classico</span><span class="sxs-lookup"><span data-stu-id="8e273-509">How to build this example perimeter network with classic PowerShell scripts.</span></span>
* <span data-ttu-id="8e273-510">Come creare la rete perimetrale di esempio con un modello di Azure Resource Manager</span><span class="sxs-lookup"><span data-stu-id="8e273-510">How to build this example with an Azure Resource Manager template.</span></span>
* <span data-ttu-id="8e273-511">Descrizioni dettagliate di ogni route definita dall'utente, ogni comando del gruppo di sicurezza di rete e ogni regola del firewall</span><span class="sxs-lookup"><span data-stu-id="8e273-511">Detailed descriptions of each UDR, NSG command, and firewall rule.</span></span>
* <span data-ttu-id="8e273-512">Scenari dettagliati del flusso di traffico che illustrano il modo in cui il traffico viene consentito o negato su ogni livello</span><span class="sxs-lookup"><span data-stu-id="8e273-512">Detailed traffic flow scenarios, showing how traffic is allowed or denied in each layer.</span></span>

### <a name="example-4-add-a-hybrid-connection-with-a-site-to-site-virtual-appliance-vpn"></a><span data-ttu-id="8e273-513">Esempio 4: Aggiungere una connessione ibrida con un'appliance virtuale da sito a sito e con una rete virtuale privata (VPN)</span><span class="sxs-lookup"><span data-stu-id="8e273-513">Example 4 Add a hybrid connection with a site-to-site, virtual appliance VPN</span></span>
<span data-ttu-id="8e273-514">[Torna all'avvio veloce](#fast-start) | Le istruzioni di creazione dettagliate saranno presto disponibili</span><span class="sxs-lookup"><span data-stu-id="8e273-514">[Back to Fast start](#fast-start) | Detailed build instructions available soon</span></span>

<span data-ttu-id="8e273-515">[![11]][11]</span><span class="sxs-lookup"><span data-stu-id="8e273-515">[![11]][11]</span></span>

#### <a name="environment-description"></a><span data-ttu-id="8e273-516">Descrizione dell'ambiente</span><span class="sxs-lookup"><span data-stu-id="8e273-516">Environment description</span></span>
<span data-ttu-id="8e273-517">Le reti ibride che usano un'appliance virtuale di rete possono essere aggiunte a qualsiasi tipo di rete perimetrale illustrato negli esempi 1, 2 o 3.</span><span class="sxs-lookup"><span data-stu-id="8e273-517">Hybrid networking using a network virtual appliance (NVA) can be added to any of the perimeter network types described in examples 1, 2, or 3.</span></span>

<span data-ttu-id="8e273-518">Come illustrato nella figura precedente, una connessione VPN su Internet (da sito a sito) viene usata per connettere una rete locale a una rete virtuale di Azure tramite un'appliance virtuale di rete.</span><span class="sxs-lookup"><span data-stu-id="8e273-518">As shown in the previous figure, a VPN connection over the Internet (site-to-site) is used to connect an on-premises network to an Azure virtual network via an NVA.</span></span>

> [!NOTE]
> <span data-ttu-id="8e273-519">Se si usa ExpressRoute attivando l'opzione di peering pubblico di Azure, è necessario creare una route statica,</span><span class="sxs-lookup"><span data-stu-id="8e273-519">If you use ExpressRoute with the Azure Public Peering option enabled, a static route should be created.</span></span> <span data-ttu-id="8e273-520">che deve indirizzare all'indirizzo IP VPN dell'appliance virtuale di rete all'esterno dell'Internet aziendale, senza transitare tramite la connessione di ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="8e273-520">This static route should route to the NVA VPN IP address out your corporate Internet and not via the ExpressRoute connection.</span></span> <span data-ttu-id="8e273-521">Il protocollo NAT necessario per l'opzione di peering pubblico di Azure su ExpressRoute può interrompere la sessione VPN.</span><span class="sxs-lookup"><span data-stu-id="8e273-521">The NAT required on the ExpressRoute Azure Public Peering option can break the VPN session.</span></span>
>
>

<span data-ttu-id="8e273-522">Dopo la configurazione della VPN, l'appliance virtuale di rete diventa l'hub centrale per tutte le reti e le subnet.</span><span class="sxs-lookup"><span data-stu-id="8e273-522">Once the VPN is in place, the NVA becomes the central hub for all networks and subnets.</span></span> <span data-ttu-id="8e273-523">Le regole di inoltro del firewall determinano i flussi di traffico consentiti, sottoposti a NAT, reindirizzati o eliminati (anche per i flussi di traffico tra la rete locale e Azure).</span><span class="sxs-lookup"><span data-stu-id="8e273-523">The firewall forwarding rules determine which traffic flows are allowed, are translated via NAT, are redirected, or are dropped (even for traffic flows between the on-premises network and Azure).</span></span>

<span data-ttu-id="8e273-524">I flussi di traffico devono essere esaminati con attenzione, perché possono essere ottimizzati o danneggiati da questo modello di struttura, in base al caso d'uso specifico.</span><span class="sxs-lookup"><span data-stu-id="8e273-524">Traffic flows should be considered carefully, as they can be optimized or degraded by this design pattern, depending on the specific use case.</span></span>

<span data-ttu-id="8e273-525">Se si usa l'ambiente creato nell'esempio 3, e quindi si aggiunge una connessione di rete ibrida VPN da sito a sito, si otterrà la struttura seguente:</span><span class="sxs-lookup"><span data-stu-id="8e273-525">Using the environment built in example 3, and then adding a site-to-site VPN hybrid network connection, produces the following design:</span></span>

<span data-ttu-id="8e273-526">[![12]][12]</span><span class="sxs-lookup"><span data-stu-id="8e273-526">[![12]][12]</span></span>

<span data-ttu-id="8e273-527">Il client VPN corrisponde al router locale o a eventuali altri dispositivi di rete compatibili con l'appliance virtuale di rete per la VPN.</span><span class="sxs-lookup"><span data-stu-id="8e273-527">The on-premises router, or any other network device that is compatible with your NVA for VPN, would be the VPN client.</span></span> <span data-ttu-id="8e273-528">Questo dispositivo fisico sarà responsabile per l'inizializzazione e la gestione della connessione VPN con l'appliance virtuale di rete.</span><span class="sxs-lookup"><span data-stu-id="8e273-528">This physical device would be responsible for initiating and maintaining the VPN connection with your NVA.</span></span>

<span data-ttu-id="8e273-529">Per l'appliance virtuale di rete, a livello logico, la rete è analoga a quattro "aree di sicurezza" distinte, con le regole dell'appliance virtuale di rete usate come strumento di indirizzamento primario per il traffico tra queste aree:</span><span class="sxs-lookup"><span data-stu-id="8e273-529">Logically to the NVA, the network looks like four separate “security zones” with the rules on the NVA being the primary director of traffic between these zones:</span></span>

<span data-ttu-id="8e273-530">![13]</span><span class="sxs-lookup"><span data-stu-id="8e273-530">![13]</span></span>

#### <a name="conclusion"></a><span data-ttu-id="8e273-531">Conclusioni</span><span class="sxs-lookup"><span data-stu-id="8e273-531">Conclusion</span></span>
<span data-ttu-id="8e273-532">L'aggiunta di una connessione di rete ibrida VPN da sito a sito a una rete virtuale di Azure può estendere la rete locale in Azure in modo sicuro.</span><span class="sxs-lookup"><span data-stu-id="8e273-532">The addition of a site-to-site VPN hybrid network connection to an Azure virtual network can extend the on-premises network into Azure in a secure manner.</span></span> <span data-ttu-id="8e273-533">Se si usa una connessione VPN, il traffico verrà crittografato e instradato tramite Internet.</span><span class="sxs-lookup"><span data-stu-id="8e273-533">In using a VPN connection, your traffic is encrypted and routes via the Internet.</span></span> <span data-ttu-id="8e273-534">L'appliance virtuale di rete in questo esempio fornisce una posizione centrale per l'applicazione e la gestione dei criteri di sicurezza.</span><span class="sxs-lookup"><span data-stu-id="8e273-534">The NVA in this example provides a central location to enforce and manage the security policy.</span></span> <span data-ttu-id="8e273-535">Per altre informazioni, vedere le istruzioni di creazione dettagliate (presto disponibili).</span><span class="sxs-lookup"><span data-stu-id="8e273-535">For more information, see the detailed build instructions (forthcoming).</span></span> <span data-ttu-id="8e273-536">Le istruzioni includono:</span><span class="sxs-lookup"><span data-stu-id="8e273-536">These instructions include:</span></span>

* <span data-ttu-id="8e273-537">Come creare la rete perimetrale di esempio con script di PowerShell</span><span class="sxs-lookup"><span data-stu-id="8e273-537">How to build this example perimeter network with PowerShell scripts.</span></span>
* <span data-ttu-id="8e273-538">Come creare la rete perimetrale di esempio con un modello di Azure Resource Manager</span><span class="sxs-lookup"><span data-stu-id="8e273-538">How to build this example with an Azure Resource Manager template.</span></span>
* <span data-ttu-id="8e273-539">Scenari dettagliati di flussi di traffico che illustrano il modo in cui il traffico scorre nella struttura.</span><span class="sxs-lookup"><span data-stu-id="8e273-539">Detailed traffic flow scenarios, showing how traffic flows through this design.</span></span>

### <a name="example-5-add-a-hybrid-connection-with-a-site-to-site-azure-vpn-gateway"></a><span data-ttu-id="8e273-540">Esempio 5: Aggiungere una connessione ibrida con un gateway VPN di Azure da sito a sito</span><span class="sxs-lookup"><span data-stu-id="8e273-540">Example 5 Add a hybrid connection with a site-to-site, Azure VPN gateway</span></span>
<span data-ttu-id="8e273-541">[Torna all'avvio veloce](#fast-start) | Le istruzioni di creazione dettagliate saranno presto disponibili</span><span class="sxs-lookup"><span data-stu-id="8e273-541">[Back to Fast start](#fast-start) | Detailed build instructions available soon</span></span>

<span data-ttu-id="8e273-542">[![14]][14]</span><span class="sxs-lookup"><span data-stu-id="8e273-542">[![14]][14]</span></span>

#### <a name="environment-description"></a><span data-ttu-id="8e273-543">Descrizione dell'ambiente</span><span class="sxs-lookup"><span data-stu-id="8e273-543">Environment description</span></span>
<span data-ttu-id="8e273-544">È possibile aggiungere reti ibride che usano un gateway VPN di Azure a qualsiasi tipo di rete perimetrale illustrato negli esempi 1 e 2.</span><span class="sxs-lookup"><span data-stu-id="8e273-544">Hybrid networking using an Azure VPN gateway can be added to either perimeter network type described in examples 1 or 2.</span></span>

<span data-ttu-id="8e273-545">Come illustrato nella figura precedente, una connessione VPN su Internet (da sito a sito) viene usata per connettere una rete locale a una rete virtuale di Azure tramite un gateway VPN di Azure.</span><span class="sxs-lookup"><span data-stu-id="8e273-545">As shown in the preceding figure, a VPN connection over the Internet (site-to-site) is used to connect an on-premises network to an Azure virtual network via an Azure VPN gateway.</span></span>

> [!NOTE]
> <span data-ttu-id="8e273-546">Se si usa ExpressRoute attivando l'opzione di peering pubblico di Azure, è necessario creare una route statica,</span><span class="sxs-lookup"><span data-stu-id="8e273-546">If you use ExpressRoute with the Azure Public Peering option enabled, a static route should be created.</span></span> <span data-ttu-id="8e273-547">che deve indirizzare all'indirizzo IP VPN dell'appliance virtuale di rete all'esterno dell'Internet aziendale, senza transitare tramite la WAN di ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="8e273-547">This  static route should route to the NVA VPN IP address out your corporate Internet and not via the ExpressRoute WAN.</span></span> <span data-ttu-id="8e273-548">Il protocollo NAT necessario per l'opzione di peering pubblico di Azure su ExpressRoute può interrompere la sessione VPN.</span><span class="sxs-lookup"><span data-stu-id="8e273-548">The NAT required on the ExpressRoute Azure Public Peering option can break the VPN session.</span></span>
>
>

<span data-ttu-id="8e273-549">La figura seguente mostra i due margini di rete di questa opzione.</span><span class="sxs-lookup"><span data-stu-id="8e273-549">The following figure shows the two network edges in this example.</span></span> <span data-ttu-id="8e273-550">Sul primo margine, l'appliance virtuale di rete e i gruppi di sicurezza di rete controllano i flussi di traffico tra le reti interne ad Azure e tra Azure e Internet.</span><span class="sxs-lookup"><span data-stu-id="8e273-550">On the first edge, the NVA and NSGs control traffic flows for intra-Azure networks and between Azure and the Internet.</span></span> <span data-ttu-id="8e273-551">Il secondo margine è il gateway VPN di Azure, ovvero un margine di rete separato e isolato tra le reti locali e Azure.</span><span class="sxs-lookup"><span data-stu-id="8e273-551">The second edge is the Azure VPN gateway, which is a separate and isolated network edge between on-premises and Azure.</span></span>

<span data-ttu-id="8e273-552">I flussi di traffico devono essere esaminati con attenzione, perché possono essere ottimizzati o danneggiati da questo modello di struttura, in base al caso d'uso specifico.</span><span class="sxs-lookup"><span data-stu-id="8e273-552">Traffic flows should be considered carefully, as they can be optimized or degraded by this design pattern, depending on the specific use case.</span></span>

<span data-ttu-id="8e273-553">Se si usa l'ambiente creato nell'esempio 1, e quindi si aggiunge una connessione di rete ibrida VPN da sito a sito, si otterrà la struttura seguente:</span><span class="sxs-lookup"><span data-stu-id="8e273-553">Using the environment built in example 1, and then adding a site-to-site VPN hybrid network connection, produces the following design:</span></span>

<span data-ttu-id="8e273-554">[![15]][15]</span><span class="sxs-lookup"><span data-stu-id="8e273-554">[![15]][15]</span></span>

#### <a name="conclusion"></a><span data-ttu-id="8e273-555">Conclusioni</span><span class="sxs-lookup"><span data-stu-id="8e273-555">Conclusion</span></span>
<span data-ttu-id="8e273-556">L'aggiunta di una connessione di rete ibrida VPN da sito a sito a una rete virtuale di Azure può estendere la rete locale in Azure in modo sicuro.</span><span class="sxs-lookup"><span data-stu-id="8e273-556">The addition of a site-to-site VPN hybrid network connection to an Azure virtual network can extend the on-premises network into Azure in a secure manner.</span></span> <span data-ttu-id="8e273-557">Se si usa un gateway VPN nativo di Azure, il traffico viene crittografato con IPSec e instradato tramite Internet.</span><span class="sxs-lookup"><span data-stu-id="8e273-557">Using the native Azure VPN gateway, your traffic is IPSec encrypted and routes via the Internet.</span></span> <span data-ttu-id="8e273-558">L'uso del gateway VPN di Azure offre anche un'opzione a costi ridotti (a differenza delle appliance virtuali di rete di terze parti, che comportano costi di licenza aggiuntivi).</span><span class="sxs-lookup"><span data-stu-id="8e273-558">Also, using the Azure VPN gateway can provide a lower-cost option (no additional licensing cost as with third-party NVAs).</span></span> <span data-ttu-id="8e273-559">Questa soluzione risulta estremamente conveniente nell'esempio 1, in cui non vengono usate appliance virtuali di rete.</span><span class="sxs-lookup"><span data-stu-id="8e273-559">This option is most economical in example 1, where no NVA is used.</span></span> <span data-ttu-id="8e273-560">Per altre informazioni, vedere le istruzioni di creazione dettagliate (presto disponibili).</span><span class="sxs-lookup"><span data-stu-id="8e273-560">For more information, see the detailed build instructions (forthcoming).</span></span> <span data-ttu-id="8e273-561">Le istruzioni includono:</span><span class="sxs-lookup"><span data-stu-id="8e273-561">These instructions include:</span></span>

* <span data-ttu-id="8e273-562">Come creare la rete perimetrale di esempio con script di PowerShell</span><span class="sxs-lookup"><span data-stu-id="8e273-562">How to build this example perimeter network with PowerShell scripts.</span></span>
* <span data-ttu-id="8e273-563">Come creare la rete perimetrale di esempio con un modello di Azure Resource Manager</span><span class="sxs-lookup"><span data-stu-id="8e273-563">How to build this example with an Azure Resource Manager template.</span></span>
* <span data-ttu-id="8e273-564">Scenari dettagliati di flussi di traffico che illustrano il modo in cui il traffico scorre nella struttura.</span><span class="sxs-lookup"><span data-stu-id="8e273-564">Detailed traffic flow scenarios, showing how traffic flows through this design.</span></span>

### <a name="example-6-add-a-hybrid-connection-with-expressroute"></a><span data-ttu-id="8e273-565">Esempio 6: Aggiungere una connessione ibrida con ExpressRoute</span><span class="sxs-lookup"><span data-stu-id="8e273-565">Example 6 Add a hybrid connection with ExpressRoute</span></span>
<span data-ttu-id="8e273-566">[Torna all'avvio veloce](#fast-start) | Le istruzioni di creazione dettagliate saranno presto disponibili</span><span class="sxs-lookup"><span data-stu-id="8e273-566">[Back to Fast start](#fast-start) | Detailed build instructions available soon</span></span>

<span data-ttu-id="8e273-567">[![16]][16]</span><span class="sxs-lookup"><span data-stu-id="8e273-567">[![16]][16]</span></span>

#### <a name="environment-description"></a><span data-ttu-id="8e273-568">Descrizione dell'ambiente</span><span class="sxs-lookup"><span data-stu-id="8e273-568">Environment description</span></span>
<span data-ttu-id="8e273-569">È possibile aggiungere reti ibride che usano una connessione con peering privato di ExpressRoute a qualsiasi tipo di rete perimetrale illustrato negli esempi 1 o 2.</span><span class="sxs-lookup"><span data-stu-id="8e273-569">Hybrid networking using an ExpressRoute private peering connection can be added to either perimeter network type described in examples 1 or 2.</span></span>

<span data-ttu-id="8e273-570">Come illustrato nella figura precedente, il peering privato di ExpressRoute fornisce una connessione diretta tra la rete locale e la rete virtuale di Azure.</span><span class="sxs-lookup"><span data-stu-id="8e273-570">As shown in the preceding figure, ExpressRoute private peering provides a direct connection between your on-premises network and the Azure virtual network.</span></span> <span data-ttu-id="8e273-571">Il traffico attraversa solo la rete del provider del servizio e la rete Microsoft Azure, senza contatto con Internet.</span><span class="sxs-lookup"><span data-stu-id="8e273-571">Traffic transits only the service provider network and the Microsoft Azure network, never touching the Internet.</span></span>

> [!TIP]
> <span data-ttu-id="8e273-572">L'utilizzo di ExpressRoute mantiene il traffico di rete aziendale fuori da Internet,</span><span class="sxs-lookup"><span data-stu-id="8e273-572">Using ExpressRoute keeps corporate network traffic off the Internet.</span></span> <span data-ttu-id="8e273-573">agevolando contratti di servizio dal provider ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="8e273-573">It also allows for service level agreements from your ExpressRoute provider.</span></span> <span data-ttu-id="8e273-574">Il gateway di Azure può raggiungere un massimo di 10 Gb/s con ExpressRoute, mentre la velocità massima effettiva con le VPN da sito a sito per il gateway di Azure è di 200 Mb/s.</span><span class="sxs-lookup"><span data-stu-id="8e273-574">The Azure Gateway can pass up to 10 Gbps with ExpressRoute, whereas with site-to-site VPNs, the Azure Gateway maximum throughput is 200 Mbps.</span></span>
>
>

<span data-ttu-id="8e273-575">Come illustrato nel diagramma che segue, con questa opzione l'ambiente include ora due margini di rete.</span><span class="sxs-lookup"><span data-stu-id="8e273-575">As seen in the following diagram, with this option the environment now has two network edges.</span></span> <span data-ttu-id="8e273-576">L'appliance virtuale di rete e i gruppi di sicurezza di rete controllano i flussi di traffico per le reti interne di Azure e tra Azure e Internet, mentre il gateway è un margine di rete separato e isolato tra le reti locali e Azure.</span><span class="sxs-lookup"><span data-stu-id="8e273-576">The NVA and NSG control traffic flows for intra-Azure networks and between Azure and the Internet, while the gateway is a separate and isolated network edge between on-premises and Azure.</span></span>

<span data-ttu-id="8e273-577">I flussi di traffico devono essere esaminati con attenzione, perché possono essere ottimizzati o danneggiati da questo modello di struttura, in base al caso d'uso specifico.</span><span class="sxs-lookup"><span data-stu-id="8e273-577">Traffic flows should be considered carefully, as they can be optimized or degraded by this design pattern, depending on the specific use case.</span></span>

<span data-ttu-id="8e273-578">Se si usa l'ambiente creato nell'esempio 1, e quindi si aggiunge una connessione di rete ibrida di ExpressRoute, si otterrà la struttura seguente:</span><span class="sxs-lookup"><span data-stu-id="8e273-578">Using the environment built in example 1, and then adding an ExpressRoute hybrid network connection, produces the following design:</span></span>

<span data-ttu-id="8e273-579">[![17]][17]</span><span class="sxs-lookup"><span data-stu-id="8e273-579">[![17]][17]</span></span>

#### <a name="conclusion"></a><span data-ttu-id="8e273-580">Conclusioni</span><span class="sxs-lookup"><span data-stu-id="8e273-580">Conclusion</span></span>
<span data-ttu-id="8e273-581">L'aggiunta di una connessione di rete con peering privato di ExpressRoute può estendere la rete locale in Azure in un modo sicuro, con latenza ridotta e prestazioni migliori.</span><span class="sxs-lookup"><span data-stu-id="8e273-581">The addition of an ExpressRoute Private Peering network connection can extend the on-premises network into Azure in a secure, lower latency, higher performing manner.</span></span> <span data-ttu-id="8e273-582">L'uso del gateway nativo di Azure, come illustrato in questo esempio, offre un'opzione a costi ridotti, a differenza delle appliance virtuali di rete che comportano costi di licenza aggiuntivi.</span><span class="sxs-lookup"><span data-stu-id="8e273-582">Also, using the native Azure Gateway, as in this example, provides a lower-cost option (no additional licensing as with third-party NVAs).</span></span> <span data-ttu-id="8e273-583">Per altre informazioni, vedere le istruzioni di creazione dettagliate (presto disponibili).</span><span class="sxs-lookup"><span data-stu-id="8e273-583">For more information, see the detailed build instructions (forthcoming).</span></span> <span data-ttu-id="8e273-584">Le istruzioni includono:</span><span class="sxs-lookup"><span data-stu-id="8e273-584">These instructions include:</span></span>

* <span data-ttu-id="8e273-585">Come creare la rete perimetrale di esempio con script di PowerShell</span><span class="sxs-lookup"><span data-stu-id="8e273-585">How to build this example perimeter network with PowerShell scripts.</span></span>
* <span data-ttu-id="8e273-586">Come creare la rete perimetrale di esempio con un modello di Azure Resource Manager</span><span class="sxs-lookup"><span data-stu-id="8e273-586">How to build this example with an Azure Resource Manager template.</span></span>
* <span data-ttu-id="8e273-587">Scenari dettagliati di flussi di traffico che illustrano il modo in cui il traffico scorre nella struttura.</span><span class="sxs-lookup"><span data-stu-id="8e273-587">Detailed traffic flow scenarios, showing how traffic flows through this design.</span></span>

## <a name="references"></a><span data-ttu-id="8e273-588">Riferimenti</span><span class="sxs-lookup"><span data-stu-id="8e273-588">References</span></span>
### <a name="helpful-websites-and-documentation"></a><span data-ttu-id="8e273-589">Siti Web e documentazione utili</span><span class="sxs-lookup"><span data-stu-id="8e273-589">Helpful websites and documentation</span></span>
* <span data-ttu-id="8e273-590">Accedere ad Azure tramite Azure Resource Manager:</span><span class="sxs-lookup"><span data-stu-id="8e273-590">Access Azure with Azure Resource Manager:</span></span>
* <span data-ttu-id="8e273-591">Accesso ad Azure con PowerShell: [https://docs.microsoft.com/powershell/azureps-cmdlets-docs/](/powershell/azure/overview)</span><span class="sxs-lookup"><span data-stu-id="8e273-591">Accessing Azure with PowerShell: [https://docs.microsoft.com/powershell/azureps-cmdlets-docs/](/powershell/azure/overview)</span></span>
* <span data-ttu-id="8e273-592">Documentazione sulle reti virtuali: [https://docs.microsoft.com/azure/virtual-network/](https://docs.microsoft.com/azure/virtual-network/)</span><span class="sxs-lookup"><span data-stu-id="8e273-592">Virtual networking documentation: [https://docs.microsoft.com/azure/virtual-network/](https://docs.microsoft.com/azure/virtual-network/)</span></span>
* <span data-ttu-id="8e273-593">Documentazione sui gruppi di sicurezza di rete: [https://docs.microsoft.com/azure/virtual-network/virtual-networks-nsg](virtual-network/virtual-networks-nsg.md)</span><span class="sxs-lookup"><span data-stu-id="8e273-593">Network security group documentation: [https://docs.microsoft.com/azure/virtual-network/virtual-networks-nsg](virtual-network/virtual-networks-nsg.md)</span></span>
* <span data-ttu-id="8e273-594">Documentazione sul routing definito dall'utente: [https://docs.microsoft.com/azure/virtual-network/virtual-networks-udr-overview](virtual-network/virtual-networks-udr-overview.md)</span><span class="sxs-lookup"><span data-stu-id="8e273-594">User-defined routing documentation: [https://docs.microsoft.com/azure/virtual-network/virtual-networks-udr-overview](virtual-network/virtual-networks-udr-overview.md)</span></span>
* <span data-ttu-id="8e273-595">Gateway virtuali di Azure: [https://docs.microsoft.com/azure/vpn-gateway/](https://docs.microsoft.com/azure/vpn-gateway/)</span><span class="sxs-lookup"><span data-stu-id="8e273-595">Azure virtual gateways: [https://docs.microsoft.com/azure/vpn-gateway/](https://docs.microsoft.com/azure/vpn-gateway/)</span></span>
* <span data-ttu-id="8e273-596">VPN da sito a sito: [https://docs.microsoft.com/azure/vpn-gateway/vpn-gateway-create-site-to-site-rm-powershell](vpn-gateway/vpn-gateway-create-site-to-site-rm-powershell.md)</span><span class="sxs-lookup"><span data-stu-id="8e273-596">Site-to-Site VPNs: [https://docs.microsoft.com/azure/vpn-gateway/vpn-gateway-create-site-to-site-rm-powershell](vpn-gateway/vpn-gateway-create-site-to-site-rm-powershell.md)</span></span>
* <span data-ttu-id="8e273-597">Documentazione su ExpressRoute (assicurarsi di consultare le sezioni relative all'introduzione e alle procedure): [https://docs.microsoft.com/azure/expressroute/](https://docs.microsoft.com/azure/expressroute/)</span><span class="sxs-lookup"><span data-stu-id="8e273-597">ExpressRoute documentation (be sure to check out the “Getting Started” and “How To” sections): [https://docs.microsoft.com/azure/expressroute/](https://docs.microsoft.com/azure/expressroute/)</span></span>

<!--Image References-->
<span data-ttu-id="8e273-598">[0]: ./media/best-practices-network-security/flowchart.png "Diagramma di flusso sulle opzioni di sicurezza"</span><span class="sxs-lookup"><span data-stu-id="8e273-598">[0]: ./media/best-practices-network-security/flowchart.png "Security Options Flowchart"</span></span>
<span data-ttu-id="8e273-599">[2]: ./media/best-practices-network-security/azuresecurityfeatures.png "Funzionalità di sicurezza di Azure"</span><span class="sxs-lookup"><span data-stu-id="8e273-599">[2]: ./media/best-practices-network-security/azuresecurityfeatures.png "Azure Security Features"</span></span>
<span data-ttu-id="8e273-600">[3]: ./media/best-practices-network-security/dmzcorporate.png "Rete perimetrale in una rete aziendale"</span><span class="sxs-lookup"><span data-stu-id="8e273-600">[3]: ./media/best-practices-network-security/dmzcorporate.png "A DMZ in a Corporate network"</span></span>
<span data-ttu-id="8e273-601">[4]: ./media/best-practices-network-security/azuresecurityarchitecture.png "Architettura di sicurezza di Azure"</span><span class="sxs-lookup"><span data-stu-id="8e273-601">[4]: ./media/best-practices-network-security/azuresecurityarchitecture.png "Azure Security Architecture"</span></span>
<span data-ttu-id="8e273-602">[5]: ./media/best-practices-network-security/dmzazure.png "Rete perimetrale in una rete virtuale di Azure"</span><span class="sxs-lookup"><span data-stu-id="8e273-602">[5]: ./media/best-practices-network-security/dmzazure.png "A DMZ in an Azure Virtual Network"</span></span>
<span data-ttu-id="8e273-603">[6]: ./media/best-practices-network-security/dmzhybrid.png "Rete ibrida con tre limiti di sicurezza"</span><span class="sxs-lookup"><span data-stu-id="8e273-603">[6]: ./media/best-practices-network-security/dmzhybrid.png "Hybrid Network with Three Security Boundaries"</span></span>
<span data-ttu-id="8e273-604">[7]: ./media/best-practices-network-security/example1design.png "Rete perimetrale in ingresso con gruppo di sicurezza di rete"</span><span class="sxs-lookup"><span data-stu-id="8e273-604">[7]: ./media/best-practices-network-security/example1design.png "Inbound DMZ with NSG"</span></span>
<span data-ttu-id="8e273-605">[8]: ./media/best-practices-network-security/example2design.png "Rete perimetrale in ingresso con appliance virtuale di rete e gruppo di sicurezza di rete"</span><span class="sxs-lookup"><span data-stu-id="8e273-605">[8]: ./media/best-practices-network-security/example2design.png "Inbound DMZ with NVA and NSG"</span></span>
<span data-ttu-id="8e273-606">[9]: ./media/best-practices-network-security/example3design.png "Rete perimetrale bidirezionale con appliance virtuale di rete, gruppo di sicurezza di rete e routing definito dall'utente"</span><span class="sxs-lookup"><span data-stu-id="8e273-606">[9]: ./media/best-practices-network-security/example3design.png "Bi-directional DMZ with NVA, NSG, and UDR"</span></span>
<span data-ttu-id="8e273-607">[10]: ./media/best-practices-network-security/example3firewalllogical.png "Visualizzazione logica delle regole del firewall"</span><span class="sxs-lookup"><span data-stu-id="8e273-607">[10]: ./media/best-practices-network-security/example3firewalllogical.png "Logical View of the Firewall Rules"</span></span>
<span data-ttu-id="8e273-608">[11]: ./media/best-practices-network-security/example3designoptions.png "Rete perimetrale con appliance virtuale di rete connesso tramite rete ibrida"</span><span class="sxs-lookup"><span data-stu-id="8e273-608">[11]: ./media/best-practices-network-security/example3designoptions.png "DMZ with NVA Connected Hybrid Network"</span></span>
<span data-ttu-id="8e273-609">[12]: ./media/best-practices-network-security/example4designs2s.png "Rete perimetrale con appliance virtuale di rete connesso tramite VPN da sito a sito"</span><span class="sxs-lookup"><span data-stu-id="8e273-609">[12]: ./media/best-practices-network-security/example4designs2s.png "DMZ with NVA Connected Using a Site-to-Site VPN"</span></span>
<span data-ttu-id="8e273-610">[13]: ./media/best-practices-network-security/example4networklogical.png "Rete logica dal punto di vista dell'appliance virtuale di rete"</span><span class="sxs-lookup"><span data-stu-id="8e273-610">[13]: ./media/best-practices-network-security/example4networklogical.png "Logical Network from NVA Perspective"</span></span>
<span data-ttu-id="8e273-611">[14]: ./media/best-practices-network-security/example5designoptions.png "Rete perimetrale con gateway di Azure connesso tramite rete ibrida da sito a sito"</span><span class="sxs-lookup"><span data-stu-id="8e273-611">[14]: ./media/best-practices-network-security/example5designoptions.png "DMZ with Azure Gateway Connected Site-to-Site Hybrid Network"</span></span>
<span data-ttu-id="8e273-612">[15]: ./media/best-practices-network-security/example5designs2s.png "Rete perimetrale con gateway di Azure che usa la VPN da sito a sito"</span><span class="sxs-lookup"><span data-stu-id="8e273-612">[15]: ./media/best-practices-network-security/example5designs2s.png "DMZ with Azure Gateway Using Site-to-Site VPN"</span></span>
<span data-ttu-id="8e273-613">[16]: ./media/best-practices-network-security/example6designoptions.png "Rete perimetrale con gateway di Azure connesso tramite rete ibrida ExpressRoute"</span><span class="sxs-lookup"><span data-stu-id="8e273-613">[16]: ./media/best-practices-network-security/example6designoptions.png "DMZ with Azure Gateway Connected ExpressRoute Hybrid Network"</span></span>
<span data-ttu-id="8e273-614">[17]: ./media/best-practices-network-security/example6designexpressroute.png "Rete perimetrale con gateway di Azure che usa una connessione ExpressRoute"</span><span class="sxs-lookup"><span data-stu-id="8e273-614">[17]: ./media/best-practices-network-security/example6designexpressroute.png "DMZ with Azure Gateway Using an ExpressRoute Connection"</span></span>

<!--Link References-->
[TrustCenter]: https://azure.microsoft.com/support/trust-center/compliance/
[Example1]: ./virtual-network/virtual-networks-dmz-nsg.md
[Example2]: ./virtual-network/virtual-networks-dmz-nsg-fw-asm.md
[Example3]: ./virtual-network/virtual-networks-dmz-nsg-fw-udr-asm.md
[Example4]: ./virtual-network/virtual-networks-hybrid-s2s-nva-asm.md
[Example5]: ./virtual-network/virtual-networks-hybrid-s2s-agw-asm.md
[Example6]: ./virtual-network/virtual-networks-hybrid-expressroute-asm.md
[Example7]: ./virtual-network/virtual-networks-vnet2vnet-direct-asm.md
[Example8]: ./virtual-network/virtual-networks-vnet2vnet-transit-asm.md
