---
title: Eseguire un failover di test per la replica del server fisico in Azure con Azure Site Recovery | Microsoft Docs
description: Vengono riepilogati i passaggi necessari per eseguire un failover di test per i server fisici di cui viene eseguita la replica in Azure usando il servizio Azure Site Recovery.
services: site-recovery
documentationcenter: 
author: rayne-wiselman
manager: carmonm
editor: 
ms.assetid: a640e139-3a09-4ad8-8283-8fa92544f4c6
ms.service: site-recovery
ms.workload: storage-backup-recovery
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 06/27/2017
ms.author: raynew
ms.openlocfilehash: 94aa3bfc700cad3de9fc5516c0c9a4d86ade3fed
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/29/2017
---
# <a name="step-11-run-a-test-failover-of-physical-servers-to-azure"></a><span data-ttu-id="61f7d-103">Passaggio 11: Eseguire un failover di test dei server fisici in Azure</span><span class="sxs-lookup"><span data-stu-id="61f7d-103">Step 11: Run a test failover of physical servers to Azure</span></span>

<span data-ttu-id="61f7d-104">Questo articolo illustra come eseguire un failover di test da server fisici locali in Azure usando il servizio [Azure Site Recovery](site-recovery-overview.md) nel portale di Azure.</span><span class="sxs-lookup"><span data-stu-id="61f7d-104">This article describes how to run a test failover from on-premises physical servers to Azure, using the [Azure Site Recovery](site-recovery-overview.md) service in the Azure portal.</span></span>

<span data-ttu-id="61f7d-105">Inserire commenti e domande nella parte inferiore di questo articolo oppure nel [forum sui servizi di ripristino di Azure](https://social.msdn.microsoft.com/forums/azure/home?forum=hypervrecovmgr).</span><span class="sxs-lookup"><span data-stu-id="61f7d-105">Post comments and questions at the bottom of this article, or on the [Azure Recovery Services Forum](https://social.msdn.microsoft.com/forums/azure/home?forum=hypervrecovmgr).</span></span>


## <a name="before-you-start"></a><span data-ttu-id="61f7d-106">Prima di iniziare</span><span class="sxs-lookup"><span data-stu-id="61f7d-106">Before you start</span></span>

<span data-ttu-id="61f7d-107">Prima di eseguire un failover di test, è consigliabile verificare le proprietà dei server e apportare eventuali modifiche necessarie.</span><span class="sxs-lookup"><span data-stu-id="61f7d-107">Before you run a test failover we recommend that you verify the server properties, and make any changes you need to.</span></span> <span data-ttu-id="61f7d-108">È possibile accedere alle proprietà delle VM in **Elementi replicati**.</span><span class="sxs-lookup"><span data-stu-id="61f7d-108">you can access the VM properties in **Replicated items**.</span></span> <span data-ttu-id="61f7d-109">Il pannello **Informazioni di base** visualizza informazioni sulle impostazioni e sullo stato dei computer.</span><span class="sxs-lookup"><span data-stu-id="61f7d-109">The **Essentials** blade shows information about machine settings and status.</span></span>

## <a name="managed-disk-considerations"></a><span data-ttu-id="61f7d-110">Considerazioni su Managed Disks</span><span class="sxs-lookup"><span data-stu-id="61f7d-110">Managed disk considerations</span></span>

<span data-ttu-id="61f7d-111">[Managed Disks](../virtual-machines/windows/managed-disks-overview.md) semplifica la gestione dei dischi per le VM di Azure grazie alla gestione degli account di archiviazione associati ai dischi delle VM.</span><span class="sxs-lookup"><span data-stu-id="61f7d-111">[Managed disks](../virtual-machines/windows/managed-disks-overview.md) simplify disk management for Azure VMs, by managing the storage accounts associated with the VM disks.</span></span> 

- <span data-ttu-id="61f7d-112">Abilitando la protezione per un server, i dati della VM vengono replicati in un account di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="61f7d-112">When you enable protection for a server, VM data replicates to a storage account.</span></span> <span data-ttu-id="61f7d-113">I dischi di Managed Disks vengono creati e collegati alla VM solo in caso di failover.</span><span class="sxs-lookup"><span data-stu-id="61f7d-113">Managed disks are created and attached to the VM only when failover occurs.</span></span>
- <span data-ttu-id="61f7d-114">È possibile creare dischi di Managed Disks solo per le VM di Azure distribuite usando il modello di Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="61f7d-114">Managed disks can be created only for Azure VMs deployed using the Resource Manager model.</span></span>  
- <span data-ttu-id="61f7d-115">Quando questa impostazione è abilitata, possono essere selezionati solo i set di disponibilità in gruppi di risorse con l'impostazione **Usa il servizio Managed Disks** abilitata.</span><span class="sxs-lookup"><span data-stu-id="61f7d-115">With this setting enabled, only availability sets in Resource Groups that have **Use managed disks** enabled can be selected.</span></span> <span data-ttu-id="61f7d-116">Le VM con Managed Disks devono trovarsi nei set di disponibilità con l'opzione **Usa il servizio Managed Disks** impostata su **Sì**.</span><span class="sxs-lookup"><span data-stu-id="61f7d-116">VMs with managed disks must be in availability sets with **Use managed disks** set to **Yes**.</span></span> <span data-ttu-id="61f7d-117">Se l'impostazione non è abilitata per le VM, possono essere selezionati solo i set di disponibilità nei gruppi di risorse senza Managed Disks.</span><span class="sxs-lookup"><span data-stu-id="61f7d-117">If the setting isn't enabled for VMs, then only availability sets in Resource Groups without managed disks enabled can be selected.</span></span>
- <span data-ttu-id="61f7d-118">[Altre informazioni](https://docs.microsoft.com/azure/virtual-machines/windows/manage-availability#use-managed-disks-for-vms-in-an-availability-set) su Managed Disks e set di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="61f7d-118">[Learn more](https://docs.microsoft.com/azure/virtual-machines/windows/manage-availability#use-managed-disks-for-vms-in-an-availability-set) about managed disks and availability sets.</span></span>
- <span data-ttu-id="61f7d-119">Se l'account di archiviazione usato per la replica è stato crittografato con Crittografia del servizio di archiviazione, la creazione dei dischi di Managed Disks durante il failover non riuscirà.</span><span class="sxs-lookup"><span data-stu-id="61f7d-119">If the storage account you use for replication has been encrypted with Storage Service Encryption, managed disks can't be created during failover.</span></span> <span data-ttu-id="61f7d-120">In questo caso, non abilitare l'uso del servizio Managed Disks oppure disabilitare la protezione per la VM e riabilitarla per usare un account di archiviazione senza la crittografia abilitata.</span><span class="sxs-lookup"><span data-stu-id="61f7d-120">In this case either don't enable use of managed disks, or disable protection for the VM, and reenable it to use a storage account that doesn't have encryption enabled.</span></span> <span data-ttu-id="61f7d-121">[Altre informazioni](https://docs.microsoft.com/azure/storage/storage-managed-disks-overview#managed-disks-and-encryption).</span><span class="sxs-lookup"><span data-stu-id="61f7d-121">[Learn more](https://docs.microsoft.com/azure/storage/storage-managed-disks-overview#managed-disks-and-encryption).</span></span>


## <a name="network-considerations"></a><span data-ttu-id="61f7d-122">Considerazioni sulla rete</span><span class="sxs-lookup"><span data-stu-id="61f7d-122">Network considerations</span></span>

<span data-ttu-id="61f7d-123">È possibile impostare l'indirizzo IP di destinazione per una VM di Azure creata dopo il failover.</span><span class="sxs-lookup"><span data-stu-id="61f7d-123">You can set the target IP address for an Azure VM created after failover.</span></span>

- <span data-ttu-id="61f7d-124">Se non si specifica un indirizzo, il computer di cui è stato eseguito il failover usa DHCP.</span><span class="sxs-lookup"><span data-stu-id="61f7d-124">If you don't provide an address, the failed over machine will use DHCP.</span></span>
- <span data-ttu-id="61f7d-125">Se si imposta un indirizzo che non è disponibile al momento del failover, il failover non riesce.</span><span class="sxs-lookup"><span data-stu-id="61f7d-125">If you set an address that isn't available at failover, failover won't work.</span></span>
- <span data-ttu-id="61f7d-126">Lo stesso indirizzo IP di destinazione può essere usato per il failover di test, se è disponibile nella rete di failover di test.</span><span class="sxs-lookup"><span data-stu-id="61f7d-126">The same target IP address can be used for test failover, if the address is available in the test failover network.</span></span>
- <span data-ttu-id="61f7d-127">Il numero di schede di rete dipende dalle dimensioni specificate per la macchina virtuale di destinazione:</span><span class="sxs-lookup"><span data-stu-id="61f7d-127">The number of network adapters is dictated by the size you specify for the target virtual machine:</span></span>

     - <span data-ttu-id="61f7d-128">Se il numero di schede di rete nel computer di origine è minore o uguale al numero di schede consentito per le dimensioni del computer di destinazione, la destinazione avrà lo stesso numero di schede dell'origine.</span><span class="sxs-lookup"><span data-stu-id="61f7d-128">If the number of network adapters on the source machine is the same as, or less than, the number of adapters allowed for the target machine size, then the target will have the same number of adapters as the source.</span></span>
     - <span data-ttu-id="61f7d-129">Se il numero di schede della macchina virtuale di origine supera il numero consentito per le dimensioni della destinazione, verranno usate le dimensioni massime della destinazione.</span><span class="sxs-lookup"><span data-stu-id="61f7d-129">If the number of adapters for the source virtual machine exceeds the number allowed for the target size, then the target size maximum will be used.</span></span>
     - <span data-ttu-id="61f7d-130">Ad esempio, se una macchina di origine ha due schede di rete e le dimensioni della macchina di destinazione ne supportano quattro, la macchina di destinazione avrà due schede.</span><span class="sxs-lookup"><span data-stu-id="61f7d-130">For example, if a source machine has two network adapters and the target machine size supports four, the target machine will have two adapters.</span></span> <span data-ttu-id="61f7d-131">Se la macchina di origine dispone di due schede ma le dimensioni di destinazione supportate ne consentono solo una, la macchina di destinazione avrà una sola scheda.</span><span class="sxs-lookup"><span data-stu-id="61f7d-131">If the source machine has two adapters but the supported target size only supports one then the target machine will have only one adapter.</span></span>     
   - <span data-ttu-id="61f7d-132">Se la macchina virtuale ha più schede di rete, si connetteranno tutte alla stessa rete.</span><span class="sxs-lookup"><span data-stu-id="61f7d-132">If the virtual machine has multiple network adapters they will all connect to the same network.</span></span>
   - <span data-ttu-id="61f7d-133">Se la macchina virtuale ha più schede di rete, la prima nell'elenco diventa la scheda di rete *predefinita* nella macchina virtuale di Azure.</span><span class="sxs-lookup"><span data-stu-id="61f7d-133">If the virtual machine has multiple network adapters then the first one shown in the list becomes the *Default* network adapter in the Azure virtual machine.</span></span>
 - <span data-ttu-id="61f7d-134">[Altre informazioni](vmware-walkthrough-network.md) sugli indirizzi IP.</span><span class="sxs-lookup"><span data-stu-id="61f7d-134">[Learn more](vmware-walkthrough-network.md) about IP addressing.</span></span>



## <a name="view-and-modify-vm-settings"></a><span data-ttu-id="61f7d-135">Visualizzare e modificare le impostazioni delle VM</span><span class="sxs-lookup"><span data-stu-id="61f7d-135">View and modify VM settings</span></span>

<span data-ttu-id="61f7d-136">È consigliabile verificare le proprietà del server di origine prima di eseguire un failover.</span><span class="sxs-lookup"><span data-stu-id="61f7d-136">We recommend that you verify the properties of the source server before you run a failover.</span></span>

1. <span data-ttu-id="61f7d-137">In **Elementi protetti** fare clic su **Elementi replicati** e quindi sul computer.</span><span class="sxs-lookup"><span data-stu-id="61f7d-137">In **Protected Items**, click **Replicated Items**, and click the machine.</span></span>
2. <span data-ttu-id="61f7d-138">Nel riquadro **Elemento replicato** è possibile vedere un riepilogo relativo a informazioni sul computer, stato integrità e ultimi punti di recupero disponibili.</span><span class="sxs-lookup"><span data-stu-id="61f7d-138">In the **Replicated item** pane, you can see a summary of machine information, health status, and the latest available recovery points.</span></span> <span data-ttu-id="61f7d-139">Fare clic su **Proprietà** per visualizzare altri dettagli.</span><span class="sxs-lookup"><span data-stu-id="61f7d-139">Click **Properties** to view more details.</span></span>
3. <span data-ttu-id="61f7d-140">In **Calcolo e rete** è possibile:</span><span class="sxs-lookup"><span data-stu-id="61f7d-140">In **Compute and Network**, you can:</span></span>
    - <span data-ttu-id="61f7d-141">Modificare il nome della VM di Azure.</span><span class="sxs-lookup"><span data-stu-id="61f7d-141">Modify the Azure VM name.</span></span> <span data-ttu-id="61f7d-142">Il nome deve soddisfare i [requisiti di Azure](site-recovery-support-matrix-to-azure.md#failed-over-azure-vm-requirements).</span><span class="sxs-lookup"><span data-stu-id="61f7d-142">The name must meet [Azure requirements](site-recovery-support-matrix-to-azure.md#failed-over-azure-vm-requirements).</span></span>
    - <span data-ttu-id="61f7d-143">Specificare un [gruppo di risorse] successivo al failover.</span><span class="sxs-lookup"><span data-stu-id="61f7d-143">Specify a post-failover [resource group].</span></span>
    - <span data-ttu-id="61f7d-144">Specificare le dimensioni di destinazione per la VM di Azure</span><span class="sxs-lookup"><span data-stu-id="61f7d-144">Specify a target size for the Azure VM</span></span>
    - <span data-ttu-id="61f7d-145">Selezionare un [set di disponibilità](../virtual-machines/windows/tutorial-availability-sets.md).</span><span class="sxs-lookup"><span data-stu-id="61f7d-145">Select an [availability set](../virtual-machines/windows/tutorial-availability-sets.md).</span></span>
    - <span data-ttu-id="61f7d-146">Specificare se usare [Managed Disks](#managed-disk-considerations).</span><span class="sxs-lookup"><span data-stu-id="61f7d-146">Specify whether to use [managed disks](#managed-disk-considerations).</span></span> <span data-ttu-id="61f7d-147">Selezionare **Sì** per collegare i dischi di Managed Disks al computer nella migrazione in Azure.</span><span class="sxs-lookup"><span data-stu-id="61f7d-147">Select **Yes**, if you want to attach managed disks to your machine on migration to Azure.</span></span>
    - <span data-ttu-id="61f7d-148">Visualizzare o modificare le impostazioni di rete, inclusi la rete/subnet in cui si troverà la VM di Azure dopo il failover e l'indirizzo IP che verrà assegnato a essa.</span><span class="sxs-lookup"><span data-stu-id="61f7d-148">View or modify network settings, including the network/subnet in which the Azure VM will be located after failover, and the IP address that will be assigned to it.</span></span>
4. <span data-ttu-id="61f7d-149">In **Dischi** è possibile vedere le informazioni sul sistema operativo e sui dischi dati della VM.</span><span class="sxs-lookup"><span data-stu-id="61f7d-149">In **Disks**, you can see information about the operating system and data disks on the VM.</span></span>

## <a name="run-a-test-failover"></a><span data-ttu-id="61f7d-150">Eseguire un failover di test</span><span class="sxs-lookup"><span data-stu-id="61f7d-150">Run a test failover</span></span>

<span data-ttu-id="61f7d-151">Dopo aver completato la configurazione, eseguire un failover di test per verificare che tutti gli elementi funzionino come previsto.</span><span class="sxs-lookup"><span data-stu-id="61f7d-151">After you've set everything up, run a test failover to make sure everything's working as expected.</span></span>

- <span data-ttu-id="61f7d-152">Per connettersi alle VM di Azure con RDP dopo il failover, eseguire la [preparazione alla connessione](site-recovery-test-failover-to-azure.md#prepare-to-connect-to-azure-vms-after-failover).</span><span class="sxs-lookup"><span data-stu-id="61f7d-152">If you want to connect to Azure VMs using RDP after failover, [prepare to connect](site-recovery-test-failover-to-azure.md#prepare-to-connect-to-azure-vms-after-failover).</span></span>
 - <span data-ttu-id="61f7d-153">Per un test completo è necessario copiare Active Directory e DNS nell'ambiente di test.</span><span class="sxs-lookup"><span data-stu-id="61f7d-153">To fully test you need to copy of Active Directory and DNS in your test environment.</span></span> <span data-ttu-id="61f7d-154">[Altre informazioni](site-recovery-active-directory.md#test-failover-considerations).</span><span class="sxs-lookup"><span data-stu-id="61f7d-154">[Learn more](site-recovery-active-directory.md#test-failover-considerations).</span></span>
 - <span data-ttu-id="61f7d-155">Per informazioni complete sul failover di test, leggere [questo articolo](site-recovery-test-failover-to-azure.md).</span><span class="sxs-lookup"><span data-stu-id="61f7d-155">For full information about test failover, read [this article](site-recovery-test-failover-to-azure.md) article.</span></span>
- <span data-ttu-id="61f7d-156">Ottenere una rapida panoramica video prima di iniziare:</span><span class="sxs-lookup"><span data-stu-id="61f7d-156">Get a quick video overview before you start:</span></span>

     
     >[!VIDEO https://channel9.msdn.com/Series/Azure-Site-Recovery/VMware-to-Azure-with-ASR-Video4-Recovery-Plan-DR-Drill-and-Failover/player]

<span data-ttu-id="61f7d-157">Eseguire quindi un failover:</span><span class="sxs-lookup"><span data-stu-id="61f7d-157">Now, run a failover:</span></span>

1. <span data-ttu-id="61f7d-158">Per eseguire il failover di un singolo computer, in **Impostazioni** > **Elementi replicati** fare clic sul computer > icona **+Failover di test**.</span><span class="sxs-lookup"><span data-stu-id="61f7d-158">To fail over a single machine, in **Settings** > **Replicated Items**, click the machine > **+Test Failover** icon.</span></span>

    ![Failover di test](./media/physical-walkthrough-test-failover/test-failover.png)

2. <span data-ttu-id="61f7d-160">Per eseguire il failover di un piano di ripristino, in **Impostazioni** > **Piani di ripristino** fare clic con il pulsante destro del mouse sul piano e quindi scegliere **Failover di test**.</span><span class="sxs-lookup"><span data-stu-id="61f7d-160">To fail over a recovery plan, in **Settings** > **Recovery Plans**, right-click the plan > **Test Failover**.</span></span> <span data-ttu-id="61f7d-161">Per creare un piano di ripristino, [seguire queste istruzioni](site-recovery-create-recovery-plans.md).</span><span class="sxs-lookup"><span data-stu-id="61f7d-161">To create a recovery plan, [follow these instructions](site-recovery-create-recovery-plans.md).</span></span>  

3. <span data-ttu-id="61f7d-162">In **Failover di test** selezionare la rete di Azure a cui dovranno connettersi le VM di Azure dopo il failover.</span><span class="sxs-lookup"><span data-stu-id="61f7d-162">In **Test Failover**, select the Azure network to which Azure VMs will be connected after failover occurs.</span></span>

4. <span data-ttu-id="61f7d-163">Fare clic su **OK** per iniziare il failover.</span><span class="sxs-lookup"><span data-stu-id="61f7d-163">Click **OK** to begin the failover.</span></span> <span data-ttu-id="61f7d-164">Per tenere traccia dello stato del processo, fare clic sul computer per visualizzarne le proprietà oppure fare clic sul processo **Failover di test** nel nome dell'insieme di credenziali > **Impostazioni** > **Processi** > **Processi di Site Recovery**.</span><span class="sxs-lookup"><span data-stu-id="61f7d-164">You can track progress by clicking on the machine to open its properties, or on the **Test Failover** job in vault name > **Settings** > **Jobs** > **Site Recovery jobs**.</span></span>

5. <span data-ttu-id="61f7d-165">Al termine del failover sarà possibile visualizzare la macchina virtuale di Azure di replica in **Macchine virtuali** nel portale di Azure.</span><span class="sxs-lookup"><span data-stu-id="61f7d-165">After the failover completes, you should also be able to see the replica Azure VM appear in the Azure portal > **Virtual Machines**.</span></span> <span data-ttu-id="61f7d-166">Assicurarsi che la macchina virtuale sia delle dimensioni appropriate, che sia connessa alla rete giusta e che sia in esecuzione.</span><span class="sxs-lookup"><span data-stu-id="61f7d-166">You should make sure that the VM is the appropriate size, that it's connected to the appropriate network, and that it's running.</span></span>

6. <span data-ttu-id="61f7d-167">Se sono state preparate le connessioni dopo il failover, sarà possibile connettersi alla VM di Azure.</span><span class="sxs-lookup"><span data-stu-id="61f7d-167">If you prepared for connections after failover, you should be able to connect to the Azure VM.</span></span>

### <a name="delete-test-failover-vms"></a><span data-ttu-id="61f7d-168">Eliminare le VM del failover di test</span><span class="sxs-lookup"><span data-stu-id="61f7d-168">Delete test failover VMs</span></span>

1. <span data-ttu-id="61f7d-169">Al termine, fare clic su **Cleanup test failover** (Pulizia failover di test) nel computer o nel piano di ripristino.</span><span class="sxs-lookup"><span data-stu-id="61f7d-169">After you finish, click on **Cleanup test failover** on the recovery plan or machine.</span></span>
2. <span data-ttu-id="61f7d-170">Fare clic su **Note** per registrare e salvare eventuali osservazioni associate al failover di test.</span><span class="sxs-lookup"><span data-stu-id="61f7d-170">In **Notes**, record and save any observations associated with the test failover.</span></span>
3. <span data-ttu-id="61f7d-171">L'azione di pulizia elimina le VM di Azure create durante il failover di test.</span><span class="sxs-lookup"><span data-stu-id="61f7d-171">The cleanup action deletes Azure VMs that were created during test failover.</span></span>

## <a name="summary"></a><span data-ttu-id="61f7d-172">Riepilogo</span><span class="sxs-lookup"><span data-stu-id="61f7d-172">Summary</span></span>

<span data-ttu-id="61f7d-173">Se il failover di test è stato completato correttamente, viene eseguita la replica dei server fisici che riescono a eseguire il failover in Azure.</span><span class="sxs-lookup"><span data-stu-id="61f7d-173">If you completed the test failover successfully, your physical servers are replicating and you've checked that they can fail over to Azure.</span></span> <span data-ttu-id="61f7d-174">È ora possibile eseguire i failover in base ai requisiti aziendali.</span><span class="sxs-lookup"><span data-stu-id="61f7d-174">Now, you can run failovers in accordance with your organizational requirements.</span></span> 

<span data-ttu-id="61f7d-175">Tenere presente che attualmente non è possibile eseguire il failback da Azure in un server fisico.</span><span class="sxs-lookup"><span data-stu-id="61f7d-175">Remember that you can't currently fail back from Azure to a physical server.</span></span> <span data-ttu-id="61f7d-176">È necessario eseguire il failback in una VM VMware,</span><span class="sxs-lookup"><span data-stu-id="61f7d-176">You have to fail back to a VMware VM.</span></span> <span data-ttu-id="61f7d-177">quindi è necessaria un'infrastruttura VMware locale per eseguire il failback.</span><span class="sxs-lookup"><span data-stu-id="61f7d-177">This means you need an on-premises VMware infrastructure in order to fail back.</span></span> <span data-ttu-id="61f7d-178">[Altre informazioni](site-recovery-failback-azure-to-vmware.md) sul failback delle VM di Azure in VMware.</span><span class="sxs-lookup"><span data-stu-id="61f7d-178">[Learn more](site-recovery-failback-azure-to-vmware.md) about failing back Azure VMs to VMware.</span></span>


## <a name="next-steps"></a><span data-ttu-id="61f7d-179">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="61f7d-179">Next steps</span></span>

- <span data-ttu-id="61f7d-180">[Eseguire i failover](site-recovery-failover.md) in base alle esigenze.</span><span class="sxs-lookup"><span data-stu-id="61f7d-180">[Run failovers](site-recovery-failover.md) as needed.</span></span>
