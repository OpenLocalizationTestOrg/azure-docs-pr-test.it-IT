---
title: Ripristinare un database SQL di Azure in un'app multi-tenant | Microsoft Docs
description: Informazioni su come ripristinare un database SQL a tenant singolo dopo l'eliminazione accidentale di dati
keywords: esercitazione database SQL
services: sql-database
documentationcenter: 
author: stevestein
manager: jhubbard
editor: 
ms.assetid: 
ms.service: sql-database
ms.custom: scale out apps
ms.workload: data-management
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 05/10/2017
ms.author: billgib;sstein
ms.openlocfilehash: 547851972f13ec69a8f65d01290874ad7d07f192
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 07/11/2017
---
# <a name="restore-a-wingtip-saas-tenants-sql-database"></a><span data-ttu-id="f0276-104">Ripristinare un database SQL a tenant Wingtip SaaS</span><span class="sxs-lookup"><span data-stu-id="f0276-104">Restore a Wingtip SaaS tenants SQL database</span></span>

<span data-ttu-id="f0276-105">L'applicazione SaaS Wingtip viene compilata usando un modello database per ogni tenant, in cui ogni tenant dispone di un proprio database.</span><span class="sxs-lookup"><span data-stu-id="f0276-105">The Wingtip SaaS app is built using a database-per-tenant model, where each tenant has their own database.</span></span> <span data-ttu-id="f0276-106">Uno dei vantaggi di questo modello è che è facile ripristinare i dati di un singolo tenant in isolamento senza alcun impatto sugli altri tenant.</span><span class="sxs-lookup"><span data-stu-id="f0276-106">One of the benefits of this model is that it is easy to restore a single tenant’s data in isolation without impacting other tenants.</span></span>

<span data-ttu-id="f0276-107">Questa esercitazione illustra due modelli di ripristino dei dati:</span><span class="sxs-lookup"><span data-stu-id="f0276-107">In this tutorial you learn two data recovery patterns:</span></span>

> [!div class="checklist"]

> * <span data-ttu-id="f0276-108">Ripristinare un database in un database parallelo (side-by-side)</span><span class="sxs-lookup"><span data-stu-id="f0276-108">Restore a database into a parallel database (side-by-side)</span></span>
> * <span data-ttu-id="f0276-109">Ripristinare un database sul posto</span><span class="sxs-lookup"><span data-stu-id="f0276-109">Restore a database in place</span></span>


|||
|:--|:--|
| <span data-ttu-id="f0276-110">**Ripristinare un tenant a un punto precedente nel tempo, in un database parallelo**</span><span class="sxs-lookup"><span data-stu-id="f0276-110">**Restore tenant to a prior point in time, into a parallel database**</span></span> | <span data-ttu-id="f0276-111">Questo modello può essere usato dal tenant per la revisione, il controllo, la conformità e così via. Il database originale rimane online e invariato.</span><span class="sxs-lookup"><span data-stu-id="f0276-111">This pattern can be used by the tenant for review, auditing, compliance, etc. The original database remains online and unchanged.</span></span> |
| <span data-ttu-id="f0276-112">**Ripristinare un tenant sul posto**</span><span class="sxs-lookup"><span data-stu-id="f0276-112">**Restore tenant in-place**</span></span> | <span data-ttu-id="f0276-113">Questo modello viene in genere usato per ripristinare un tenant a un punto precedente nel tempo, dopo che il tenant ha accidentalmente eliminato i dati.</span><span class="sxs-lookup"><span data-stu-id="f0276-113">This pattern is typically used to recover a tenant to a prior point in time, after a tenant accidentally deletes data.</span></span> <span data-ttu-id="f0276-114">Il database originale viene portato offline e sostituito con il database ripristinato.</span><span class="sxs-lookup"><span data-stu-id="f0276-114">The original database is taken offline, and replaced with the restored database.</span></span> |
|||

<span data-ttu-id="f0276-115">Per completare questa esercitazione, verificare che siano soddisfatti i prerequisiti seguenti:</span><span class="sxs-lookup"><span data-stu-id="f0276-115">To complete this tutorial, make sure the following prerequisites are completed:</span></span>

* <span data-ttu-id="f0276-116">L'app SaaS Wingtip viene distribuita.</span><span class="sxs-lookup"><span data-stu-id="f0276-116">The Wingtip SaaS app is deployed.</span></span> <span data-ttu-id="f0276-117">Per distribuire in meno di cinque minuti, vedere [Distribuire ed esplorare l'applicazione SaaS Wingtip](sql-database-saas-tutorial.md)</span><span class="sxs-lookup"><span data-stu-id="f0276-117">To deploy in less than five minutes, see [Deploy and explore the Wingtip SaaS application](sql-database-saas-tutorial.md)</span></span>
* <span data-ttu-id="f0276-118">Azure PowerShell è installato.</span><span class="sxs-lookup"><span data-stu-id="f0276-118">Azure PowerShell is installed.</span></span> <span data-ttu-id="f0276-119">Per informazioni dettagliate, vedere [Introduzione ad Azure PowerShell](https://docs.microsoft.com/powershell/azure/get-started-azureps)</span><span class="sxs-lookup"><span data-stu-id="f0276-119">For details, see [Getting started with Azure PowerShell](https://docs.microsoft.com/powershell/azure/get-started-azureps)</span></span>

## <a name="introduction-to-the-saas-tenant-restore-pattern"></a><span data-ttu-id="f0276-120">Introduzione al modello di ripristino di tenant SaaS</span><span class="sxs-lookup"><span data-stu-id="f0276-120">Introduction to the SaaS tenant restore pattern</span></span>

<span data-ttu-id="f0276-121">Per il modello di ripristino di tenant, sono disponibili due modelli semplici per il ripristino dei dati di un tenant singolo.</span><span class="sxs-lookup"><span data-stu-id="f0276-121">For the tenant restore pattern, there are two simple patterns for restoring an individual tenant's data.</span></span> <span data-ttu-id="f0276-122">Poiché i database dei tenant sono isolati tra loro, il ripristino di un tenant non ha alcun impatto sui dati di qualsiasi altro tenant.</span><span class="sxs-lookup"><span data-stu-id="f0276-122">Because tenant databases are isolated from each other, restoring one tenant has no impact on any other tenant's data.</span></span>

<span data-ttu-id="f0276-123">Nel primo modello i dati vengono ripristinati in un nuovo database.</span><span class="sxs-lookup"><span data-stu-id="f0276-123">In the first pattern, data is restored into a new database.</span></span> <span data-ttu-id="f0276-124">Al tenant viene quindi dato l'accesso al database insieme ai relativi dati di produzione.</span><span class="sxs-lookup"><span data-stu-id="f0276-124">The tenant is then given access to this database alongside their production data.</span></span> <span data-ttu-id="f0276-125">Questo modello consente a un amministratore di tenant di esaminare i dati ripristinati e potenzialmente usarli per sovrascrivere in modo selettivo i valori dei dati correnti.</span><span class="sxs-lookup"><span data-stu-id="f0276-125">This pattern allows a tenant admin to review the restored data and potentially use it to selectively overwrite current data values.</span></span> <span data-ttu-id="f0276-126">Spetta alla progettazione delle app SaaS determinare quanto dovrebbero essere sofisticate le opzioni di ripristino dei dati.</span><span class="sxs-lookup"><span data-stu-id="f0276-126">It's up to the SaaS app designer to determine just how sophisticated the data recovery options should be.</span></span> <span data-ttu-id="f0276-127">In alcuni scenari potrebbe essere necessaria solamente la possibilità di esaminare i dati nello stato in cui si trovavano in un determinato punto nel tempo.</span><span class="sxs-lookup"><span data-stu-id="f0276-127">Simply being able to review data in the state it was in at a given point in time may be all that is required in some scenarios.</span></span> <span data-ttu-id="f0276-128">Se il database usa la [replica geografica](sql-database-geo-replication-overview.md), è consigliabile copiare i dati necessari dalla copia ripristinata nel database originale.</span><span class="sxs-lookup"><span data-stu-id="f0276-128">If the database uses [geo-replication](sql-database-geo-replication-overview.md), we recommend copying the required data from the restored copy into the original database.</span></span> <span data-ttu-id="f0276-129">Se il database originale viene sostituito con il database ripristinato, è necessario riconfigurare e risincronizzare la replica geografica.</span><span class="sxs-lookup"><span data-stu-id="f0276-129">If you replace the original database with the restored database, you need to reconfigure and resynchronize geo-replication.</span></span>

<span data-ttu-id="f0276-130">Nel secondo modello, in cui si presuppone che il tenant abbia subito una perdita o un danneggiamento dei dati, viene ripristinato il database di produzione del tenant a un punto precedente nel tempo.</span><span class="sxs-lookup"><span data-stu-id="f0276-130">In the second pattern, which assumes that the tenant has suffered a loss or corruption of data, the tenant’s production database is restored to a prior point in time.</span></span> <span data-ttu-id="f0276-131">Nel modello di ripristino sul posto il tenant viene portato offline per un breve periodo di tempo, mentre il database viene ripristinato e riportato online.</span><span class="sxs-lookup"><span data-stu-id="f0276-131">In the restore in place pattern, the tenant is taken offline for a brief time while the database is restored and brought back online.</span></span> <span data-ttu-id="f0276-132">Il database originale viene eliminato, ma comunque può essere ripristinato se si desidera tornare anche a un punto precedente nel tempo.</span><span class="sxs-lookup"><span data-stu-id="f0276-132">The original database is deleted, but can still be restored from if you need to go back to an even earlier point in time.</span></span> <span data-ttu-id="f0276-133">Una variante di questo modello consiste nel rinominare il database anziché eliminarlo, anche se la ridenominazione del database non offre alcun vantaggio aggiuntivo in termini di sicurezza dei dati.</span><span class="sxs-lookup"><span data-stu-id="f0276-133">A variation of this pattern could rename the database instead of deleting it, although renaming the database offers no additional advantage in terms of data security.</span></span>

## <a name="get-the-wingtip-application-scripts"></a><span data-ttu-id="f0276-134">Ottenere gli script dell'applicazione Wingtip</span><span class="sxs-lookup"><span data-stu-id="f0276-134">Get the Wingtip application scripts</span></span>

<span data-ttu-id="f0276-135">Gli script dell'app SaaS Wingtip e il codice sorgente dell'applicazione sono disponibili nel repository GitHub [WingtipSaaS](https://github.com/Microsoft/WingtipSaaS).</span><span class="sxs-lookup"><span data-stu-id="f0276-135">The Wingtip SaaS scripts and application source code are available in the [WingtipSaaS](https://github.com/Microsoft/WingtipSaaS) github repo.</span></span> <span data-ttu-id="f0276-136">[Procedura per scaricare gli script dell'app SaaS Wingtip](sql-database-wtp-overview.md#download-and-unblock-the-wingtip-saas-scripts).</span><span class="sxs-lookup"><span data-stu-id="f0276-136">[Steps to download the Wingtip SaaS scripts](sql-database-wtp-overview.md#download-and-unblock-the-wingtip-saas-scripts).</span></span>

## <a name="simulate-a-tenant-accidentally-deleting-data"></a><span data-ttu-id="f0276-137">Simulare un tenant che elimina accidentalmente i dati</span><span class="sxs-lookup"><span data-stu-id="f0276-137">Simulate a tenant accidentally deleting data</span></span>

<span data-ttu-id="f0276-138">Per illustrare gli scenari di ripristino, è necessario eliminare *accidentalmente* alcuni dati in uno dei database tenant.</span><span class="sxs-lookup"><span data-stu-id="f0276-138">To demonstrate these recovery scenarios, we need to *accidentally* delete some data in one of the tenant databases.</span></span> <span data-ttu-id="f0276-139">Mentre è possibile eliminare qualsiasi record, il passaggio successivo consente di impostare la demo in modo da non essere bloccato da violazioni di integrità referenziale.</span><span class="sxs-lookup"><span data-stu-id="f0276-139">While you can delete any record, the next step sets up the demo to not get blocked by referential integrity violations!</span></span> <span data-ttu-id="f0276-140">Aggiunge anche alcuni dati di acquisto dei ticket che è possibile usare successivamente nelle *esercitazioni su Wingtip SaaS Analytics*.</span><span class="sxs-lookup"><span data-stu-id="f0276-140">It also adds some ticket purchase data you can use later in the *Wingtip SaaS Analytics tutorials*.</span></span>

<span data-ttu-id="f0276-141">Eseguire lo script del generatore di ticket e creare dati aggiuntivi.</span><span class="sxs-lookup"><span data-stu-id="f0276-141">Run the ticket generator script and create additional data.</span></span> <span data-ttu-id="f0276-142">Il generatore di ticket intenzionalmente non acquista ticket per l'ultimo evento di ogni tenant.</span><span class="sxs-lookup"><span data-stu-id="f0276-142">The ticket generator intentionally does not purchase tickets for each tenants last event.</span></span>

1. <span data-ttu-id="f0276-143">Aprire... \\Moduli Learning\\Utilità\\*Demo-TicketGenerator.ps1* nel *PowerShell ISE*</span><span class="sxs-lookup"><span data-stu-id="f0276-143">Open ...\\Learning Modules\\Utilities\\*Demo-TicketGenerator.ps1* in the *PowerShell ISE*</span></span>
1. <span data-ttu-id="f0276-144">Premere **F5** per eseguire lo script e generare i clienti e i dati di vendita dei ticket.</span><span class="sxs-lookup"><span data-stu-id="f0276-144">Press **F5** to run the script and generate customers and ticket sales data.</span></span>


### <a name="open-the-events-app-to-review-the-current-events"></a><span data-ttu-id="f0276-145">Aprire l'app Eventi per esaminare gli eventi correnti</span><span class="sxs-lookup"><span data-stu-id="f0276-145">Open the Events app to review the current events</span></span>

1. <span data-ttu-id="f0276-146">Aprire *Hub eventi* (http://events.wtp.&lt;utente&gt;. trafficmanager.net) e fare clic su **Contoso Concert Hall**:</span><span class="sxs-lookup"><span data-stu-id="f0276-146">Open the *Events Hub* (http://events.wtp.&lt;user&gt;.trafficmanager.net) and click **Contoso Concert Hall**:</span></span>

   ![Hub eventi](media/sql-database-saas-tutorial-restore-single-tenant/events-hub.png)

1. <span data-ttu-id="f0276-148">Scorrere l'elenco di eventi e prendere nota dell'ultimo evento nell'elenco:</span><span class="sxs-lookup"><span data-stu-id="f0276-148">Scroll the list of events and make a note of the last event in the list:</span></span>

   ![ultimo evento](media/sql-database-saas-tutorial-restore-single-tenant/last-event.png)


### <a name="run-the-demo-scenario-to-accidentally-delete-the-last-event"></a><span data-ttu-id="f0276-150">Eseguire lo scenario demo per eliminare accidentalmente l'ultimo evento</span><span class="sxs-lookup"><span data-stu-id="f0276-150">Run the demo scenario to accidentally delete the last event</span></span>

1. <span data-ttu-id="f0276-151">Aprire... \\Moduli Learning\\Continuità aziendale e ripristino di emergenza\\RestoreTenant\\*Demo-RestoreTenant.ps1* nel *PowerShell ISE* e impostare il valore seguente:</span><span class="sxs-lookup"><span data-stu-id="f0276-151">Open ...\\Learning Modules\\Business Continuity and Disaster Recovery\\RestoreTenant\\*Demo-RestoreTenant.ps1* in the *PowerShell ISE*, and set the following value:</span></span>
   * <span data-ttu-id="f0276-152">**$DemoScenario** = **1**, impostare su **1** - Eliminare gli eventi senza vendita di ticket.</span><span class="sxs-lookup"><span data-stu-id="f0276-152">**$DemoScenario** = **1**, Set to **1** - Delete events with no ticket sales.</span></span>
1. <span data-ttu-id="f0276-153">Premere **F5** per eseguire lo script ed eliminare l'ultimo evento.</span><span class="sxs-lookup"><span data-stu-id="f0276-153">Press **F5** to run the script and delete the last event.</span></span> <span data-ttu-id="f0276-154">Verrà visualizzato un messaggio di conferma simile al seguente:</span><span class="sxs-lookup"><span data-stu-id="f0276-154">You should see a confirmation message similar to the following:</span></span>

   ```Console
   Deleting unsold events from Contoso Concert Hall ...
   Deleted event 'Seriously Strauss' from Contoso Concert Hall venue.
   ```

1. <span data-ttu-id="f0276-155">Verrà visualizzata la pagina eventi Contoso.</span><span class="sxs-lookup"><span data-stu-id="f0276-155">The Contoso events page opens.</span></span> <span data-ttu-id="f0276-156">Scorrere verso il basso e verificare che l'evento non è più presente.</span><span class="sxs-lookup"><span data-stu-id="f0276-156">Scroll down and verify the event is gone.</span></span> <span data-ttu-id="f0276-157">Se l'evento è ancora presente nell'elenco, fare clic su Aggiorna e verificare che non è più presente.</span><span class="sxs-lookup"><span data-stu-id="f0276-157">If the event is still in the list, click refresh and verify it is gone.</span></span>

   ![ultimo evento](media/sql-database-saas-tutorial-restore-single-tenant/last-event-deleted.png)


## <a name="restore-a-tenant-database-in-parallel-with-the-production-database"></a><span data-ttu-id="f0276-159">Ripristinare un database tenant in parallelo con il database di produzione</span><span class="sxs-lookup"><span data-stu-id="f0276-159">Restore a tenant database in parallel with the production database</span></span>

<span data-ttu-id="f0276-160">Questo esercizio ripristina il database Contoso Concert Hall a un punto nel tempo precedente all'eliminazione dell'evento.</span><span class="sxs-lookup"><span data-stu-id="f0276-160">This exercise restores the Contoso Concert Hall database to a point in time before the event was deleted.</span></span> <span data-ttu-id="f0276-161">Dopo che l'evento è stato eliminato nella procedura precedente, si desidera ripristinare e visualizzare i dati eliminati.</span><span class="sxs-lookup"><span data-stu-id="f0276-161">After the event is deleted in the previous steps, you want to recover and see the deleted data.</span></span> <span data-ttu-id="f0276-162">Non è necessario ripristinare il database di produzione con il record eliminato, ma è necessario ripristinare il precedente database per accedere ai vecchi dati per altri motivi aziendali.</span><span class="sxs-lookup"><span data-stu-id="f0276-162">You don't need to restore your production database with the deleted record, but you need to recover the old database to access the old data for other business reasons.</span></span>

 <span data-ttu-id="f0276-163">Lo script *Restore-TenantInParallel.ps1* crea un database tenant parallelo e una voce di catalogo parallela, entrambi denominati *ContosoConcertHall\_old*.</span><span class="sxs-lookup"><span data-stu-id="f0276-163">The *Restore-TenantInParallel.ps1* script creates a parallel tenant database, and a parallel catalog entry both named *ContosoConcertHall\_old*.</span></span> <span data-ttu-id="f0276-164">Questo modello di ripristino è più adatto per il ripristino da una perdita di dati minore o per la conformità e il controllo di scenari di ripristino.</span><span class="sxs-lookup"><span data-stu-id="f0276-164">This pattern of restore is best suited for recovering from a minor data loss or for compliance and auditing recovery scenarios.</span></span> <span data-ttu-id="f0276-165">È anche l'approccio consigliato quando si usa la [Replica geografica](sql-database-geo-replication-overview.md).</span><span class="sxs-lookup"><span data-stu-id="f0276-165">It is also the recommended approach when you are using [geo-replication](sql-database-geo-replication-overview.md).</span></span>

1. <span data-ttu-id="f0276-166">Completare la sezione [Simulare un tenant che elimina accidentalmente i dati](#simulate-a-tenant-accidentally-deleting-data).</span><span class="sxs-lookup"><span data-stu-id="f0276-166">Complete the [simulate a user accidentally deleting data](#simulate-a-tenant-accidentally-deleting-data) section.</span></span>
1. <span data-ttu-id="f0276-167">Aprire... \\Moduli Learning\\Continuità aziendale e ripristino di emergenza\\RestoreTenant\\_Demo-RestoreTenant.ps1_ nel *PowerShell ISE*.</span><span class="sxs-lookup"><span data-stu-id="f0276-167">Open ...\\Learning Modules\\Business Continuity and Disaster Recovery\\RestoreTenant\\_Demo-RestoreTenant.ps1_ in the *PowerShell ISE*.</span></span>
1. <span data-ttu-id="f0276-168">Impostare **$DemoScenario** = **2**, impostare questa proprietà su **2** per *ripristinare il tenant in parallelo*.</span><span class="sxs-lookup"><span data-stu-id="f0276-168">Set **$DemoScenario** = **2**, Set this to **2** to *Restore tenant in parallel*.</span></span>
1. <span data-ttu-id="f0276-169">Premere **F5** per eseguire lo script.</span><span class="sxs-lookup"><span data-stu-id="f0276-169">Press **F5** to run the script.</span></span>

<span data-ttu-id="f0276-170">Lo script ripristina il database tenant (in un database parallelo) a un punto nel tempo precedente all'eliminazione dell'evento nella sezione precedente.</span><span class="sxs-lookup"><span data-stu-id="f0276-170">The script restores the tenant database (to a parallel database) to a point in time before you deleted the event in the previous section.</span></span> <span data-ttu-id="f0276-171">Crea un secondo database, rimuove i metadati di catalogo esistenti nel database e aggiunge il database al catalogo sotto la voce *ContosoConcertHall\_old*.</span><span class="sxs-lookup"><span data-stu-id="f0276-171">It creates a second database, removes any existing catalog metadata that exists in this database, and adds the database to the catalog under the *ContosoConcertHall\_old* entry.</span></span>

<span data-ttu-id="f0276-172">Lo script della demo apre la pagina eventi nel browser.</span><span class="sxs-lookup"><span data-stu-id="f0276-172">The demo script opens the events page in your browser.</span></span> <span data-ttu-id="f0276-173">Si noti dall'URL: ```http://events.wtp.&lt;user&gt;.trafficmanager.net/contosoconcerthall_old``` che vengono visualizzati i dati dal database ripristinato in cui *_old* è aggiunto al nome.</span><span class="sxs-lookup"><span data-stu-id="f0276-173">Note from the URL: ```http://events.wtp.&lt;user&gt;.trafficmanager.net/contosoconcerthall_old``` that this is showing data from the restored database where *_old* is added to the name.</span></span>

<span data-ttu-id="f0276-174">Scorrere gli eventi elencati nel browser per confermare che l'evento eliminato nella sezione precedente è stato ripristinato.</span><span class="sxs-lookup"><span data-stu-id="f0276-174">Scroll the events listed in the browser to confirm that the event deleted in the previous section has been restored.</span></span>

<span data-ttu-id="f0276-175">Si noti che, se si espone il tenant ripristinato come tenant aggiuntivo, con la propria app Eventi per sfogliare i ticket, è improbabile che venga fornito al tenant l'accesso ai dati ripristinati, ma serve a illustrare facilmente il modello di ripristino.</span><span class="sxs-lookup"><span data-stu-id="f0276-175">Note that exposing the restored tenant as an additional tenant, with its own Events app to browse tickets, is unlikely to be how you would provide a tenant access to restored data, but serves to easily illustrate the restore pattern.</span></span>

<span data-ttu-id="f0276-176">In realtà, è probabile che venga conservato solo il database ripristinato per un periodo definito.</span><span class="sxs-lookup"><span data-stu-id="f0276-176">In reality, you would probably only retain this restored database for a defined period.</span></span> <span data-ttu-id="f0276-177">È possibile eliminare la voce tenant ripristinato dopo aver finito chiamando lo script *Remove-RestoredTenant.ps1*.</span><span class="sxs-lookup"><span data-stu-id="f0276-177">You can delete the restored tenant entry once you are finished by calling the *Remove-RestoredTenant.ps1* script.</span></span>

1. <span data-ttu-id="f0276-178">Impostare **$DemoScenario** su **4** per selezionare lo scenario *rimuovere tenant ripristinato*.</span><span class="sxs-lookup"><span data-stu-id="f0276-178">Set **$DemoScenario** to **4** to select the *remove restored tenant* scenario.</span></span>
1. <span data-ttu-id="f0276-179">**Eseguire** **tramite** **F5**</span><span class="sxs-lookup"><span data-stu-id="f0276-179">**Execute** **using** **F5**</span></span>
1. <span data-ttu-id="f0276-180">La voce *ContosoConcertHall\_old* viene ora eliminata dal catalogo.</span><span class="sxs-lookup"><span data-stu-id="f0276-180">The *ContosoConcertHall\_old* entry is now deleted from the catalog.</span></span> <span data-ttu-id="f0276-181">Proseguire e chiudere la pagina degli eventi per questo tenant nel browser.</span><span class="sxs-lookup"><span data-stu-id="f0276-181">Go ahead and close the events page for this tenant in your browser.</span></span>


## <a name="restore-a-tenant-in-place-replacing-the-existing-tenant-database"></a><span data-ttu-id="f0276-182">Ripristinare un tenant sul posto, sostituendo il database tenant esistente</span><span class="sxs-lookup"><span data-stu-id="f0276-182">Restore a tenant in place, replacing the existing tenant database</span></span>

<span data-ttu-id="f0276-183">Questo esercizio ripristina il tenant Contoso Concert Hall a un punto nel tempo precedente all'eliminazione dell'evento.</span><span class="sxs-lookup"><span data-stu-id="f0276-183">This exercise restores the Contoso Concert Hall tenant to a point in time before the event was deleted.</span></span> <span data-ttu-id="f0276-184">Lo script *Restore-TenantInPlace* ripristina il database tenant corrente in un nuovo database che fa riferimento a un punto precedente nel tempo ed elimina il database originale.</span><span class="sxs-lookup"><span data-stu-id="f0276-184">The *Restore-TenantInPlace* script restores the current tenant database to a new database pointing to a previous point in time, and deletes the original database.</span></span> <span data-ttu-id="f0276-185">Questo modello di ripristino è particolarmente adatto per il ripristino da un grave danneggiamento dei dati come una perdita significativa di dati che il tenant deve gestire.</span><span class="sxs-lookup"><span data-stu-id="f0276-185">This pattern of restore is best suited for recovering from serious data corruption as there may be significant data loss that the tenant would have to accommodate.</span></span>

1. <span data-ttu-id="f0276-186">Aprire il file **Demo-RestoreTenant.ps1** in PowerShell ISE</span><span class="sxs-lookup"><span data-stu-id="f0276-186">Open **Demo-RestoreTenant.ps1** file in PowerShell ISE</span></span>
1. <span data-ttu-id="f0276-187">Impostare **$DemoScenario** su **5** per selezionare lo scenario *ripristinare tenant sul posto*.</span><span class="sxs-lookup"><span data-stu-id="f0276-187">Set **$DemoScenario** to **5** to select the *restore tenant in place scenario*.</span></span>
1. <span data-ttu-id="f0276-188">Eseguire tramite **F5**.</span><span class="sxs-lookup"><span data-stu-id="f0276-188">Execute using **F5**.</span></span>

<span data-ttu-id="f0276-189">Lo script ripristina il database tenant al punto corrispondente a cinque minuti prima dell'eliminazione dell'evento.</span><span class="sxs-lookup"><span data-stu-id="f0276-189">The script restores the tenant database to a point five minutes before the event was deleted.</span></span> <span data-ttu-id="f0276-190">Ciò viene fatto portando prima il tenant Contoso Concert Hall offline in modo che non si verifichino altri aggiornamenti dei dati.</span><span class="sxs-lookup"><span data-stu-id="f0276-190">It does this by first taking the Contoso Concert Hall tenant offline so there are no further updates to the data.</span></span> <span data-ttu-id="f0276-191">Un database parallelo viene quindi creato tramite il ripristino dal punto di ripristino e denominato con un timestamp per garantire che il nome del database non sia in conflitto con il nome del database tenant esistente.</span><span class="sxs-lookup"><span data-stu-id="f0276-191">Then, a parallel database is created by restoring from the restore point and named with a timestamp to ensure the database name does not conflict with the existing tenant database name.</span></span> <span data-ttu-id="f0276-192">Successivamente, il database tenant precedente viene eliminato e il database ripristinato viene rinominato con il nome del database originale.</span><span class="sxs-lookup"><span data-stu-id="f0276-192">Next, the old tenant database is deleted, and the restored database is renamed to the original database name.</span></span> <span data-ttu-id="f0276-193">Infine, Contoso Concert Hall viene portato online per consentire all'applicazione l'accesso al database ripristinato.</span><span class="sxs-lookup"><span data-stu-id="f0276-193">Finally, Contoso Concert Hall is brought online to allow the app access to the restored database.</span></span>

<span data-ttu-id="f0276-194">Il database è stato ripristinato a un punto nel tempo precedente all'eliminazione dell'evento.</span><span class="sxs-lookup"><span data-stu-id="f0276-194">You successfully restored the database to a point in time before the event was deleted.</span></span> <span data-ttu-id="f0276-195">Verrà visualizzata la pagina Eventi, in modo da confermare che l'ultimo evento è stato ripristinato.</span><span class="sxs-lookup"><span data-stu-id="f0276-195">The Events page opens, so confirm the last event has been restored.</span></span>


## <a name="next-steps"></a><span data-ttu-id="f0276-196">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="f0276-196">Next steps</span></span>

<span data-ttu-id="f0276-197">Questa esercitazione illustra come:</span><span class="sxs-lookup"><span data-stu-id="f0276-197">In this tutorial, you learned how to:</span></span>

> [!div class="checklist"]

> * <span data-ttu-id="f0276-198">Ripristinare un database in un database parallelo (side-by-side)</span><span class="sxs-lookup"><span data-stu-id="f0276-198">Restore a database into a parallel database (side-by-side)</span></span>
> * <span data-ttu-id="f0276-199">Ripristinare un database sul posto</span><span class="sxs-lookup"><span data-stu-id="f0276-199">Restore a database in place</span></span>

[<span data-ttu-id="f0276-200">Gestire lo schema del database tenant</span><span class="sxs-lookup"><span data-stu-id="f0276-200">Manage tenant database schema</span></span>](sql-database-saas-tutorial-schema-management.md)

## <a name="additional-resources"></a><span data-ttu-id="f0276-201">Risorse aggiuntive</span><span class="sxs-lookup"><span data-stu-id="f0276-201">Additional resources</span></span>

* <span data-ttu-id="f0276-202">Altre [esercitazioni basate sull'applicazione SaaS Wingtip](sql-database-wtp-overview.md#sql-database-wingtip-saas-tutorials)</span><span class="sxs-lookup"><span data-stu-id="f0276-202">Additional [tutorials that build upon the Wingtip SaaS application](sql-database-wtp-overview.md#sql-database-wingtip-saas-tutorials)</span></span>
* [<span data-ttu-id="f0276-203">Panoramica della continuità aziendale del database SQL di Azure</span><span class="sxs-lookup"><span data-stu-id="f0276-203">Overview of business continuity with Azure SQL Database</span></span>](sql-database-business-continuity.md)
* [<span data-ttu-id="f0276-204">Informazioni sul backup del database SQL</span><span class="sxs-lookup"><span data-stu-id="f0276-204">Learn about SQL Database backups</span></span>](sql-database-automated-backups.md)
