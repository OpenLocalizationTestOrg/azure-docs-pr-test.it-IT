---
title: Introduzione a ruoli, autorizzazioni e sicurezza con Monitoraggio di Azure | Microsoft Docs
description: Informazioni su come usare le autorizzazioni e i ruoli predefiniti di monitoraggio di Azure per limitare l'accesso alle risorse di monitoraggio.
author: johnkemnetz
manager: orenr
editor: 
services: monitoring-and-diagnostics
documentationcenter: monitoring-and-diagnostics
ms.assetid: 2686e53b-72f0-4312-bcd3-3dc1b4a9b912
ms.service: monitoring-and-diagnostics
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 09/26/2016
ms.author: johnkem
ms.openlocfilehash: a28f971ae898ffdd1168550a909f2a48e1b3b652
ms.sourcegitcommit: 50e23e8d3b1148ae2d36dad3167936b4e52c8a23
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/18/2017
---
# <a name="get-started-with-roles-permissions-and-security-with-azure-monitor"></a><span data-ttu-id="28d7f-103">Introduzione a ruoli, autorizzazioni e sicurezza con il monitoraggio di Azure</span><span class="sxs-lookup"><span data-stu-id="28d7f-103">Get started with roles, permissions, and security with Azure Monitor</span></span>
<span data-ttu-id="28d7f-104">Molti team hanno bisogno di regolare rigorosamente l'accesso ai dati e alle impostazioni di monitoraggio.</span><span class="sxs-lookup"><span data-stu-id="28d7f-104">Many teams need to strictly regulate access to monitoring data and settings.</span></span> <span data-ttu-id="28d7f-105">Ad esempio, se si dispone di membri del team che lavorano esclusivamente sul monitoraggio (tecnici del supporto, tecnici DevOps) o si usa un provider di servizi gestiti, si consiglia di concedere loro l'accesso ai dati di monitoraggio solo limitandone la possibilità di creare, modificare o eliminare le risorse.</span><span class="sxs-lookup"><span data-stu-id="28d7f-105">For example, if you have team members who work exclusively on monitoring (support engineers, devops engineers) or if you use a managed service provider, you may want to grant them access to only monitoring data while restricting their ability to create, modify, or delete resources.</span></span> <span data-ttu-id="28d7f-106">In questo articolo viene illustrato come applicare rapidamente un ruolo di monitoraggio predefinito nel Controllo degli accessi in base al ruolo a un utente in Azure o creare il proprio ruolo personalizzato per un utente che ha bisogno di autorizzazioni di monitoraggio limitate.</span><span class="sxs-lookup"><span data-stu-id="28d7f-106">This article shows how to quickly apply a built-in monitoring RBAC role to a user in Azure or build your own custom role for a user who needs limited monitoring permissions.</span></span> <span data-ttu-id="28d7f-107">Vengono poi esposte alcune considerazioni sulla sicurezza per le risorse legate al monitoraggio di Azure e viene illustrato come è possibile limitare l'accesso ai dati che contengono.</span><span class="sxs-lookup"><span data-stu-id="28d7f-107">It then discusses security considerations for your Azure Monitor-related resources and how you can limit access to the data they contain.</span></span>

## <a name="built-in-monitoring-roles"></a><span data-ttu-id="28d7f-108">Ruoli di monitoraggio predefiniti</span><span class="sxs-lookup"><span data-stu-id="28d7f-108">Built-in monitoring roles</span></span>
<span data-ttu-id="28d7f-109">I ruoli predefiniti del monitoraggio di Azure consentono di limitare l'accesso alle risorse in una sottoscrizione e allo stesso tempo consentire ai responsabili del monitoraggio dell'infrastruttura di ottenere e configurare i dati necessari.</span><span class="sxs-lookup"><span data-stu-id="28d7f-109">Azure Monitor’s built-in roles are designed to help limit access to resources in a subscription while still enabling those responsible for monitoring infrastructure to obtain and configure the data they need.</span></span> <span data-ttu-id="28d7f-110">Il monitoraggio di Azure fornisce due ruoli predefiniti: un lettore di monitoraggio e un collaboratore al monitoraggio.</span><span class="sxs-lookup"><span data-stu-id="28d7f-110">Azure Monitor provides two out-of-the-box roles: A Monitoring Reader and a Monitoring Contributor.</span></span>

### <a name="monitoring-reader"></a><span data-ttu-id="28d7f-111">Lettore di monitoraggio</span><span class="sxs-lookup"><span data-stu-id="28d7f-111">Monitoring Reader</span></span>
<span data-ttu-id="28d7f-112">Le persone a cui è assegnato il ruolo di lettore di monitoraggio possono visualizzare tutti i dati di monitoraggio in una sottoscrizione ma non possono modificare alcuna risorsa o impostazione relativa alle risorse di monitoraggio.</span><span class="sxs-lookup"><span data-stu-id="28d7f-112">People assigned the Monitoring Reader role can view all monitoring data in a subscription but cannot modify any resource or edit any settings related to monitoring resources.</span></span> <span data-ttu-id="28d7f-113">Questo ruolo è appropriato per gli utenti di un'organizzazione, ad esempio tecnici del supporto o delle operazioni, che devono essere in grado di:</span><span class="sxs-lookup"><span data-stu-id="28d7f-113">This role is appropriate for users in an organization, such as support or operations engineers, who need to be able to:</span></span>

* <span data-ttu-id="28d7f-114">Visualizzare i dashboard di monitoraggio nel portale e creare dashboard di monitoraggio privati.</span><span class="sxs-lookup"><span data-stu-id="28d7f-114">View monitoring dashboards in the portal and create their own private monitoring dashboards.</span></span>
* <span data-ttu-id="28d7f-115">Eseguire query per le metriche usando l'[API REST di Monitoraggio di Azure](https://msdn.microsoft.com/library/azure/dn931930.aspx), i [cmdlet di PowerShell](insights-powershell-samples.md) o l'[interfaccia della riga di comando multipiattaforma](insights-cli-samples.md).</span><span class="sxs-lookup"><span data-stu-id="28d7f-115">Query for metrics using the [Azure Monitor REST API](https://msdn.microsoft.com/library/azure/dn931930.aspx), [PowerShell cmdlets](insights-powershell-samples.md), or [cross-platform CLI](insights-cli-samples.md).</span></span>
* <span data-ttu-id="28d7f-116">Eseguire query per il registro attività usando il portale, l'API REST di monitoraggio di Azure, i cmdlet di PowerShell o l'interfaccia della riga di comando multipiattaforma.</span><span class="sxs-lookup"><span data-stu-id="28d7f-116">Query the Activity Log using the portal, Azure Monitor REST API, PowerShell cmdlets, or cross-platform CLI.</span></span>
* <span data-ttu-id="28d7f-117">Visualizzare le [impostazioni di diagnostica](monitoring-overview-of-diagnostic-logs.md#resource-diagnostic-settings) per una risorsa.</span><span class="sxs-lookup"><span data-stu-id="28d7f-117">View the [diagnostic settings](monitoring-overview-of-diagnostic-logs.md#resource-diagnostic-settings) for a resource.</span></span>
* <span data-ttu-id="28d7f-118">Visualizzare il [profilo di registro](monitoring-overview-activity-logs.md#export-the-activity-log-with-a-log-profile) per una sottoscrizione.</span><span class="sxs-lookup"><span data-stu-id="28d7f-118">View the [log profile](monitoring-overview-activity-logs.md#export-the-activity-log-with-a-log-profile) for a subscription.</span></span>
* <span data-ttu-id="28d7f-119">Visualizzare le impostazioni di scalabilità automatica.</span><span class="sxs-lookup"><span data-stu-id="28d7f-119">View autoscale settings.</span></span>
* <span data-ttu-id="28d7f-120">Visualizzare impostazioni e attività di avviso.</span><span class="sxs-lookup"><span data-stu-id="28d7f-120">View alert activity and settings.</span></span>
* <span data-ttu-id="28d7f-121">Accedere ai dati di Application Insights e visualizzarli in AI Analytics.</span><span class="sxs-lookup"><span data-stu-id="28d7f-121">Access Application Insights data and view data in AI Analytics.</span></span>
* <span data-ttu-id="28d7f-122">Cercare i dati dell'area di lavoro Log Analytics (OMS), inclusi i dati sull'uso dell'area di lavoro.</span><span class="sxs-lookup"><span data-stu-id="28d7f-122">Search Log Analytics (OMS) workspace data including usage data for the workspace.</span></span>
* <span data-ttu-id="28d7f-123">Visualizzare i gruppi di gestione di Log Analytics (OMS).</span><span class="sxs-lookup"><span data-stu-id="28d7f-123">View Log Analytics (OMS) management groups.</span></span>
* <span data-ttu-id="28d7f-124">Recuperare lo schema di ricerca di Log Analytics (OMS).</span><span class="sxs-lookup"><span data-stu-id="28d7f-124">Retrieve the Log Analytics (OMS) search schema.</span></span>
* <span data-ttu-id="28d7f-125">Elencare gli Intelligence Pack di Log Analytics (OMS).</span><span class="sxs-lookup"><span data-stu-id="28d7f-125">List Log Analytics (OMS) intelligence packs.</span></span>
* <span data-ttu-id="28d7f-126">Recuperare ed eseguire le ricerche salvate di Log Analytics (OMS).</span><span class="sxs-lookup"><span data-stu-id="28d7f-126">Retrieve and execute Log Analytics (OMS) saved searches.</span></span>
* <span data-ttu-id="28d7f-127">Recuperare la configurazione di archiviazione di Log Analytics (OMS).</span><span class="sxs-lookup"><span data-stu-id="28d7f-127">Retrieve the Log Analytics (OMS) storage configuration.</span></span>

> [!NOTE]
> <span data-ttu-id="28d7f-128">Questo ruolo non concede l'accesso in lettura ai dati del registro che sono stati trasmessi a un hub eventi o archiviati in un account di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="28d7f-128">This role does not give read access to log data that has been streamed to an event hub or stored in a storage account.</span></span> <span data-ttu-id="28d7f-129">[vedere di seguito](#security-considerations-for-monitoring-data) .</span><span class="sxs-lookup"><span data-stu-id="28d7f-129">[See below](#security-considerations-for-monitoring-data) for information on configuring access to these resources.</span></span>
> 
> 

### <a name="monitoring-contributor"></a><span data-ttu-id="28d7f-130">Collaboratore al monitoraggio</span><span class="sxs-lookup"><span data-stu-id="28d7f-130">Monitoring Contributor</span></span>
<span data-ttu-id="28d7f-131">Le persone a cui è assegnato il ruolo di collaboratore al monitoraggio possono visualizzare tutti i dati di monitoraggio in una sottoscrizione e creare o modificare le impostazioni, ma non possono modificare altre risorse.</span><span class="sxs-lookup"><span data-stu-id="28d7f-131">People assigned the Monitoring Contributor role can view all monitoring data in a subscription and create or modify monitoring settings, but cannot modify any other resources.</span></span> <span data-ttu-id="28d7f-132">Questo ruolo è un soprainsieme del ruolo di lettore di monitoraggio ed è adatto ai membri del team di monitoraggio di un'organizzazione o ai fornitori di servizi gestiti che, oltre alle autorizzazioni di cui sopra, devono essere in grado di:</span><span class="sxs-lookup"><span data-stu-id="28d7f-132">This role is a superset of the Monitoring Reader role, and is appropriate for members of an organization’s monitoring team or managed service providers who, in addition to the permissions above, also need to be able to:</span></span>

* <span data-ttu-id="28d7f-133">Pubblicare dashboard di monitoraggio come dashboard condivisi.</span><span class="sxs-lookup"><span data-stu-id="28d7f-133">Publish monitoring dashboards as a shared dashboard.</span></span>
* <span data-ttu-id="28d7f-134">Configurare le [impostazioni di diagnostica](monitoring-overview-of-diagnostic-logs.md#resource-diagnostic-settings) per una risorsa.*</span><span class="sxs-lookup"><span data-stu-id="28d7f-134">Set [diagnostic settings](monitoring-overview-of-diagnostic-logs.md#resource-diagnostic-settings) for a resource.*</span></span>
* <span data-ttu-id="28d7f-135">Impostare il [profilo di registro](monitoring-overview-activity-logs.md#export-the-activity-log-with-a-log-profile) per una sottoscrizione.*</span><span class="sxs-lookup"><span data-stu-id="28d7f-135">Set the [log profile](monitoring-overview-activity-logs.md#export-the-activity-log-with-a-log-profile) for a subscription.*</span></span>
* <span data-ttu-id="28d7f-136">Configurare impostazioni e attività di avviso.</span><span class="sxs-lookup"><span data-stu-id="28d7f-136">Set alert activity and settings.</span></span>
* <span data-ttu-id="28d7f-137">Creare componenti e test Web di Application Insights.</span><span class="sxs-lookup"><span data-stu-id="28d7f-137">Create Application Insights web tests and components.</span></span>
* <span data-ttu-id="28d7f-138">Elencare le chiavi condivise dell'area di lavoro di Log Analytics (OMS).</span><span class="sxs-lookup"><span data-stu-id="28d7f-138">List Log Analytics (OMS) workspace shared keys.</span></span>
* <span data-ttu-id="28d7f-139">Abilitare o disabilitare gli Intelligence Pack di Log Analytics (OMS).</span><span class="sxs-lookup"><span data-stu-id="28d7f-139">Enable or disable Log Analytics (OMS) intelligence packs.</span></span>
* <span data-ttu-id="28d7f-140">Creare ed eliminare poi eseguire le ricerche salvate di Log Analytics (OMS).</span><span class="sxs-lookup"><span data-stu-id="28d7f-140">Create and delete and execute Log Analytics (OMS) saved searches.</span></span>
* <span data-ttu-id="28d7f-141">Creare ed eliminare la configurazione di archiviazione di Log Analytics (OMS).</span><span class="sxs-lookup"><span data-stu-id="28d7f-141">Create and delete the Log Analytics (OMS) storage configuration.</span></span>

<span data-ttu-id="28d7f-142">*per configurare un profilo di registro o un'impostazione di diagnostica, è necessario che all'utente sia concessa separatamente anche l'autorizzazione ListKeys nella risorsa di destinazione (account di archiviazione o spazio dei nomi dell'hub eventi).</span><span class="sxs-lookup"><span data-stu-id="28d7f-142">*user must also separately be granted ListKeys permission on the target resource (storage account or event hub namespace) to set a log profile or diagnostic setting.</span></span>

> [!NOTE]
> <span data-ttu-id="28d7f-143">Questo ruolo non concede l'accesso in lettura ai dati del registro che sono stati trasmessi a un hub eventi o archiviati in un account di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="28d7f-143">This role does not give read access to log data that has been streamed to an event hub or stored in a storage account.</span></span> <span data-ttu-id="28d7f-144">[vedere di seguito](#security-considerations-for-monitoring-data) .</span><span class="sxs-lookup"><span data-stu-id="28d7f-144">[See below](#security-considerations-for-monitoring-data) for information on configuring access to these resources.</span></span>
> 
> 

## <a name="monitoring-permissions-and-custom-rbac-roles"></a><span data-ttu-id="28d7f-145">Autorizzazioni per il monitoraggio e ruoli personalizzati nel Controllo degli accessi in base al ruolo</span><span class="sxs-lookup"><span data-stu-id="28d7f-145">Monitoring permissions and custom RBAC roles</span></span>
<span data-ttu-id="28d7f-146">Se i precedenti ruoli predefiniti non soddisfano le esigenze esatte del team, è possibile [creare un ruolo personalizzato nel Controllo degli accessi in base al ruolo](../active-directory/role-based-access-control-custom-roles.md) con autorizzazioni più granulari.</span><span class="sxs-lookup"><span data-stu-id="28d7f-146">If the above built-in roles don’t meet the exact needs of your team, you can [create a custom RBAC role](../active-directory/role-based-access-control-custom-roles.md) with more granular permissions.</span></span> <span data-ttu-id="28d7f-147">Di seguito sono riportate le più comuni operazioni nel Controllo degli accessi in base al ruolo di monitoraggio di Azure con le relative descrizioni.</span><span class="sxs-lookup"><span data-stu-id="28d7f-147">Below are the common Azure Monitor RBAC operations with their descriptions.</span></span>

| <span data-ttu-id="28d7f-148">Operazione</span><span class="sxs-lookup"><span data-stu-id="28d7f-148">Operation</span></span> | <span data-ttu-id="28d7f-149">Descrizione</span><span class="sxs-lookup"><span data-stu-id="28d7f-149">Description</span></span> |
| --- | --- |
| <span data-ttu-id="28d7f-150">Microsoft.Insights/AlertRules/[Read, Write, Delete]</span><span class="sxs-lookup"><span data-stu-id="28d7f-150">Microsoft.Insights/AlertRules/[Read, Write, Delete]</span></span> |<span data-ttu-id="28d7f-151">Regole di avviso di lettura, scrittura ed eliminazione.</span><span class="sxs-lookup"><span data-stu-id="28d7f-151">Read/write/delete alert rules.</span></span> |
| <span data-ttu-id="28d7f-152">Microsoft.Insights/AlertRules/Incidents/Read</span><span class="sxs-lookup"><span data-stu-id="28d7f-152">Microsoft.Insights/AlertRules/Incidents/Read</span></span> |<span data-ttu-id="28d7f-153">Elenco degli eventi imprevisti (cronologia della regola di avviso attivata) per le regole di avviso.</span><span class="sxs-lookup"><span data-stu-id="28d7f-153">List incidents (history of the alert rule being triggered) for alert rules.</span></span> <span data-ttu-id="28d7f-154">Si applica solo al portale.</span><span class="sxs-lookup"><span data-stu-id="28d7f-154">This only applies to the portal.</span></span> |
| <span data-ttu-id="28d7f-155">Microsoft.Insights/AutoscaleSettings/[Read, Write, Delete]</span><span class="sxs-lookup"><span data-stu-id="28d7f-155">Microsoft.Insights/AutoscaleSettings/[Read, Write, Delete]</span></span> |<span data-ttu-id="28d7f-156">Impostazioni di scalabilità automatica di lettura, scrittura ed eliminazione.</span><span class="sxs-lookup"><span data-stu-id="28d7f-156">Read/write/delete autoscale settings.</span></span> |
| <span data-ttu-id="28d7f-157">Microsoft.Insights/DiagnosticSettings/[Read, Write, Delete]</span><span class="sxs-lookup"><span data-stu-id="28d7f-157">Microsoft.Insights/DiagnosticSettings/[Read, Write, Delete]</span></span> |<span data-ttu-id="28d7f-158">Impostazioni di diagnostica di lettura, scrittura ed eliminazione.</span><span class="sxs-lookup"><span data-stu-id="28d7f-158">Read/write/delete diagnostic settings.</span></span> |
| <span data-ttu-id="28d7f-159">Microsoft.Insights/eventtypes/digestevents/Read</span><span class="sxs-lookup"><span data-stu-id="28d7f-159">Microsoft.Insights/eventtypes/digestevents/Read</span></span> |<span data-ttu-id="28d7f-160">Questa autorizzazione è necessaria per gli utenti che hanno bisogno dell'accesso ai registri attività tramite il portale.</span><span class="sxs-lookup"><span data-stu-id="28d7f-160">This permission is necessary for users who need access to Activity Logs via the portal.</span></span> |
| <span data-ttu-id="28d7f-161">Microsoft.Insights/eventtypes/values/Read</span><span class="sxs-lookup"><span data-stu-id="28d7f-161">Microsoft.Insights/eventtypes/values/Read</span></span> |<span data-ttu-id="28d7f-162">Elenco degli eventi dei registri attività (eventi di gestione) in una sottoscrizione.</span><span class="sxs-lookup"><span data-stu-id="28d7f-162">List Activity Log events (management events) in a subscription.</span></span> <span data-ttu-id="28d7f-163">Questa autorizzazione è applicabile sia all'accesso programmatico che all'accesso al portale per il registro attività.</span><span class="sxs-lookup"><span data-stu-id="28d7f-163">This permission is applicable to both programmatic and portal access to the Activity Log.</span></span> |
| <span data-ttu-id="28d7f-164">Microsoft.Insights/LogDefinitions/Read</span><span class="sxs-lookup"><span data-stu-id="28d7f-164">Microsoft.Insights/LogDefinitions/Read</span></span> |<span data-ttu-id="28d7f-165">Questa autorizzazione è necessaria per gli utenti che hanno bisogno dell'accesso ai registri attività tramite il portale.</span><span class="sxs-lookup"><span data-stu-id="28d7f-165">This permission is necessary for users who need access to Activity Logs via the portal.</span></span> |
| <span data-ttu-id="28d7f-166">Microsoft.Insights/MetricDefinitions/Read</span><span class="sxs-lookup"><span data-stu-id="28d7f-166">Microsoft.Insights/MetricDefinitions/Read</span></span> |<span data-ttu-id="28d7f-167">Definizioni delle metriche (elenco dei tipi di metriche disponibili per una risorsa).</span><span class="sxs-lookup"><span data-stu-id="28d7f-167">Read metric definitions (list of available metric types for a resource).</span></span> |
| <span data-ttu-id="28d7f-168">Microsoft.Insights/Metrics/Read</span><span class="sxs-lookup"><span data-stu-id="28d7f-168">Microsoft.Insights/Metrics/Read</span></span> |<span data-ttu-id="28d7f-169">Metriche per una risorsa.</span><span class="sxs-lookup"><span data-stu-id="28d7f-169">Read metrics for a resource.</span></span> |

> [!NOTE]
> <span data-ttu-id="28d7f-170">L'accesso ad avvisi, impostazioni di diagnostica e metriche per una risorsa richiede che l'utente disponga dell'accesso in lettura per il tipo di risorsa e l'ambito di tale risorsa.</span><span class="sxs-lookup"><span data-stu-id="28d7f-170">Access to alerts, diagnostic settings, and metrics for a resource requires that the user has Read access to the resource type and scope of that resource.</span></span> <span data-ttu-id="28d7f-171">La creazione ("scrittura") di un'impostazione di diagnostica o di un profilo di registro che archivia in un account di archiviazione o trasmette a un hub eventi richiede che l'utente disponga anche dell'autorizzazione ListKeys nella risorsa di destinazione.</span><span class="sxs-lookup"><span data-stu-id="28d7f-171">Creating (“write”) a diagnostic setting or log profile that archives to a storage account or streams to event hubs requires the user to also have ListKeys permission on the target resource.</span></span>
> 
> 

<span data-ttu-id="28d7f-172">Ad esempio, usando la tabella sopra è possibile creare un ruolo personalizzato nel Controllo degli accessi in base al ruolo per un "lettore di registro attività" come il seguente:</span><span class="sxs-lookup"><span data-stu-id="28d7f-172">For example, using the above table you could create a custom RBAC role for an “Activity Log Reader” like this:</span></span>

```powershell
$role = Get-AzureRmRoleDefinition "Reader"
$role.Id = $null
$role.Name = "Activity Log Reader"
$role.Description = "Can view activity logs."
$role.Actions.Clear()
$role.Actions.Add("Microsoft.Insights/eventtypes/*")
$role.AssignableScopes.Clear()
$role.AssignableScopes.Add("/subscriptions/mySubscription")
New-AzureRmRoleDefinition -Role $role 
```

## <a name="security-considerations-for-monitoring-data"></a><span data-ttu-id="28d7f-173">Considerazioni sulla sicurezza per i dati sul monitoraggio</span><span class="sxs-lookup"><span data-stu-id="28d7f-173">Security considerations for monitoring data</span></span>
<span data-ttu-id="28d7f-174">I dati sul monitoraggio dei dati, in particolare i file di registro, possono contenere informazioni sensibili, come indirizzi IP o nomi utente.</span><span class="sxs-lookup"><span data-stu-id="28d7f-174">Monitoring data—particularly log files—can contain sensitive information, such as IP addresses or user names.</span></span> <span data-ttu-id="28d7f-175">I dati sul monitoraggio di Azure sono forniti in tre forme base:</span><span class="sxs-lookup"><span data-stu-id="28d7f-175">Monitoring data from Azure comes in three basic forms:</span></span>

1. <span data-ttu-id="28d7f-176">Registro attività, che descrive tutte le azioni del piano di controllo nella sottoscrizione di Azure.</span><span class="sxs-lookup"><span data-stu-id="28d7f-176">The Activity Log, which describes all control-plane actions on your Azure subscription.</span></span>
2. <span data-ttu-id="28d7f-177">Registri di diagnostica, cioè registri generati da una risorsa.</span><span class="sxs-lookup"><span data-stu-id="28d7f-177">Diagnostic Logs, which are logs emitted by a resource.</span></span>
3. <span data-ttu-id="28d7f-178">Metriche, generate dalle risorse.</span><span class="sxs-lookup"><span data-stu-id="28d7f-178">Metrics, which are emitted by resources.</span></span>

<span data-ttu-id="28d7f-179">Tutti e tre questi tipi di dati possono essere archiviati in un account di archiviazione o trasmessi a un hub eventi, che sono entrambi risorse di Azure di scopo generico.</span><span class="sxs-lookup"><span data-stu-id="28d7f-179">All three of these data types can be stored in a storage account or streamed to Event Hub, both of which are general-purpose Azure resources.</span></span> <span data-ttu-id="28d7f-180">Poiché si tratta di risorse di scopo generico, la creazione, l'eliminazione e l'accesso sono operazioni privilegiate e generalmente riservate agli amministratori.</span><span class="sxs-lookup"><span data-stu-id="28d7f-180">Because these are general-purpose resources, creating, deleting, and accessing them is a privileged operation usually reserved for an administrator.</span></span> <span data-ttu-id="28d7f-181">Si consiglia di usare le procedure seguenti con le risorse relative al monitoraggio per evitare un uso improprio:</span><span class="sxs-lookup"><span data-stu-id="28d7f-181">We suggest that you use the following practices for monitoring-related resources to prevent misuse:</span></span>

* <span data-ttu-id="28d7f-182">Usare un account di archiviazione singolo e dedicato per il monitoraggio dei dati.</span><span class="sxs-lookup"><span data-stu-id="28d7f-182">Use a single, dedicated storage account for monitoring data.</span></span> <span data-ttu-id="28d7f-183">Se è necessario separare i dati di monitoraggio in più account di archiviazione, non condividere mai l'uso di un account di archiviazione tra dati relativi al monitoraggio e non relativi al monitoraggio, perché in questo modo si potrebbe inavvertitamente fornire l'accesso ai dati non relativi al monitoraggio a chi ha bisogno solo dei dati di monitoraggio (es.</span><span class="sxs-lookup"><span data-stu-id="28d7f-183">If you need to separate monitoring data into multiple storage accounts, never share usage of a storage account between monitoring and non-monitoring data, as this may inadvertently give those who only need access to monitoring data (eg.</span></span> <span data-ttu-id="28d7f-184">SIEM di terze parti).</span><span class="sxs-lookup"><span data-stu-id="28d7f-184">a third-party SIEM) access to non-monitoring data.</span></span>
* <span data-ttu-id="28d7f-185">Usare un singolo bus di servizio o spazio dei nomi dell'hub eventi dedicato in tutte le impostazioni di diagnostica per lo stesso motivo specificato sopra.</span><span class="sxs-lookup"><span data-stu-id="28d7f-185">Use a single, dedicated Service Bus or Event Hub namespace across all diagnostic settings for the same reason as above.</span></span>
* <span data-ttu-id="28d7f-186">Limitare l'accesso agli hub eventi o agli account di archiviazione relativi al monitoraggio tenendoli in un gruppo di risorse separato e [usare l'ambito](../active-directory/role-based-access-control-what-is.md#basics-of-access-management-in-azure) nei ruoli di monitoraggio per limitare l'accesso solo a tale gruppo di risorse.</span><span class="sxs-lookup"><span data-stu-id="28d7f-186">Limit access to monitoring-related storage accounts or event hubs by keeping them in a separate resource group, and [use scope](../active-directory/role-based-access-control-what-is.md#basics-of-access-management-in-azure) on your monitoring roles to limit access to only that resource group.</span></span>
* <span data-ttu-id="28d7f-187">Non concedere mai l'autorizzazione ListKeys ad account di archiviazione o hub eventi nell'ambito della sottoscrizione quando un utente ha bisogno solo dell'accesso ai dati di monitoraggio.</span><span class="sxs-lookup"><span data-stu-id="28d7f-187">Never grant the ListKeys permission for either storage accounts or event hubs at subscription scope when a user only needs access to monitoring data.</span></span> <span data-ttu-id="28d7f-188">Piuttosto, assegnare queste autorizzazioni all'utente nell'ambito di una risorsa o di un gruppo di risorse (se si dispone di un gruppo di risorse di monitoraggio dedicato).</span><span class="sxs-lookup"><span data-stu-id="28d7f-188">Instead, give these permissions to the user at a resource or resource group (if you have a dedicated monitoring resource group) scope.</span></span>

### <a name="limiting-access-to-monitoring-related-storage-accounts"></a><span data-ttu-id="28d7f-189">Limitare l'accesso agli account di archiviazione relativi al monitoraggio</span><span class="sxs-lookup"><span data-stu-id="28d7f-189">Limiting access to monitoring-related storage accounts</span></span>
<span data-ttu-id="28d7f-190">Quando un utente o un'applicazione richiede l'accesso ai dati di monitoraggio in un account di archiviazione, è necessario [generare una firma di accesso condiviso per l'account](https://msdn.microsoft.com/library/azure/mt584140.aspx) nell'account di archiviazione che contiene i dati di monitoraggio con accesso in sola lettura a livello di servizio all'archivio BLOB.</span><span class="sxs-lookup"><span data-stu-id="28d7f-190">When a user or application needs access to monitoring data in a storage account, you should [generate an Account SAS](https://msdn.microsoft.com/library/azure/mt584140.aspx) on the storage account that contains monitoring data with service-level read-only access to blob storage.</span></span> <span data-ttu-id="28d7f-191">In PowerShell, potrebbe avere un aspetto simile al seguente:</span><span class="sxs-lookup"><span data-stu-id="28d7f-191">In PowerShell, this might look like:</span></span>

```powershell
$context = New-AzureStorageContext -ConnectionString "[connection string for your monitoring Storage Account]"
$token = New-AzureStorageAccountSASToken -ResourceType Service -Service Blob -Permission "rl" -Context $context
```

<span data-ttu-id="28d7f-192">A questo punto è possibile fornire il token all'entità che ha bisogno di leggere da quell'account di archiviazione; tale token può elencare e leggere da tutti i BLOB nell'account di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="28d7f-192">You can then give the token to the entity that needs to read from that storage account, and it can list and read from all blobs in that storage account.</span></span>

<span data-ttu-id="28d7f-193">In alternativa, se è necessario verificare l'autorizzazione con il Controllo degli accessi in base al ruolo, è possibile concedere a tale entità l'autorizzazione Microsoft.Storage/storageAccounts/listkeys/action su quel particolare account di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="28d7f-193">Alternatively, if you need to control this permission with RBAC, you can grant that entity the Microsoft.Storage/storageAccounts/listkeys/action permission on that particular storage account.</span></span> <span data-ttu-id="28d7f-194">Questo è necessario per gli utenti che devono essere in grado di configurare un'impostazione di diagnostica o un profilo di registro per l'archiviazione in un account di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="28d7f-194">This is necessary for users who need to be able to set a diagnostic setting or log profile to archive to a storage account.</span></span> <span data-ttu-id="28d7f-195">Ad esempio, è possibile creare il seguente ruolo personalizzato nel Controllo degli accessi in base al ruolo per un utente o un'applicazione che deve solo leggere da un account di archiviazione:</span><span class="sxs-lookup"><span data-stu-id="28d7f-195">For example, you could create the following custom RBAC role for a user or application that only needs to read from one storage account:</span></span>

```powershell
$role = Get-AzureRmRoleDefinition "Reader"
$role.Id = $null
$role.Name = "Monitoring Storage Account Reader"
$role.Description = "Can get the storage account keys for a monitoring storage account."
$role.Actions.Clear()
$role.Actions.Add("Microsoft.Storage/storageAccounts/listkeys/action")
$role.Actions.Add("Microsoft.Storage/storageAccounts/Read")
$role.AssignableScopes.Clear()
$role.AssignableScopes.Add("/subscriptions/mySubscription/resourceGroups/myResourceGroup/providers/Microsoft.Storage/storageAccounts/myMonitoringStorageAccount")
New-AzureRmRoleDefinition -Role $role 
```

> [!WARNING]
> <span data-ttu-id="28d7f-196">L'autorizzazione ListKeys consente all'utente di elencare le chiavi dell'account di archiviazione primario e secondario.</span><span class="sxs-lookup"><span data-stu-id="28d7f-196">The ListKeys permission enables the user to list the primary and secondary storage account keys.</span></span> <span data-ttu-id="28d7f-197">Queste chiavi concedono all'utente tutte le autorizzazioni accettate (lettura, scrittura, creazione di BLOB, eliminazione di BLOB e così via) in tutti i servizi accettati (BLOB, coda, tabella, file) di tale account di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="28d7f-197">These keys grant the user all signed permissions (read, write, create blobs, delete blobs, etc.) across all signed services (blob, queue, table, file) in that storage account.</span></span> <span data-ttu-id="28d7f-198">Se possibile, si consiglia di usare una firma di accesso condiviso dell'account come descritto sopra.</span><span class="sxs-lookup"><span data-stu-id="28d7f-198">We recommend using an Account SAS described above when possible.</span></span>
> 
> 

### <a name="limiting-access-to-monitoring-related-event-hubs"></a><span data-ttu-id="28d7f-199">Limitare l'accesso agli hub eventi relativi al monitoraggio</span><span class="sxs-lookup"><span data-stu-id="28d7f-199">Limiting access to monitoring-related event hubs</span></span>
<span data-ttu-id="28d7f-200">Un modello simile può essere seguito con gli hub eventi, tuttavia è innanzitutto necessario creare una regola di autorizzazione di ascolto dedicata.</span><span class="sxs-lookup"><span data-stu-id="28d7f-200">A similar pattern can be followed with event hubs, but first you need to create a dedicated Listen authorization rule.</span></span> <span data-ttu-id="28d7f-201">Se si desidera concedere l'accesso a un'applicazione che ha bisogno solo di ascoltare gli hub eventi relativi al monitoraggio, procedere come segue:</span><span class="sxs-lookup"><span data-stu-id="28d7f-201">If you want to grant access to an application that only needs to listen to monitoring-related event hubs, do the following:</span></span>

1. <span data-ttu-id="28d7f-202">Creare un criterio di accesso condiviso negli hub eventi creati per trasmettere i dati di monitoraggio solo con attestazioni di ascolto.</span><span class="sxs-lookup"><span data-stu-id="28d7f-202">Create a shared access policy on the event hub(s) that were created for streaming monitoring data with only Listen claims.</span></span> <span data-ttu-id="28d7f-203">Questa operazione può essere eseguita nel portale.</span><span class="sxs-lookup"><span data-stu-id="28d7f-203">This can be done in the portal.</span></span> <span data-ttu-id="28d7f-204">Ad esempio, è possibile chiamarlo "monitoringReadOnly".</span><span class="sxs-lookup"><span data-stu-id="28d7f-204">For example, you might call it “monitoringReadOnly.”</span></span> <span data-ttu-id="28d7f-205">Se possibile, si dovrà fornire la chiave direttamente al consumatore e ignorare il passaggio successivo.</span><span class="sxs-lookup"><span data-stu-id="28d7f-205">If possible, you will want to give that key directly to the consumer and skip the next step.</span></span>
2. <span data-ttu-id="28d7f-206">Se il consumatore deve essere in grado di ottenere la chiave ad hoc, concedere all'utente l'azione ListKeys per l'hub eventi.</span><span class="sxs-lookup"><span data-stu-id="28d7f-206">If the consumer needs to be able to get the key ad-hoc, grant the user the ListKeys action for that event hub.</span></span> <span data-ttu-id="28d7f-207">Questo è necessario anche per gli utenti che devono essere in grado di configurare un'impostazione di diagnostica o un profilo di registro per trasmettere agli hub eventi.</span><span class="sxs-lookup"><span data-stu-id="28d7f-207">This is also necessary for users who need to be able to set a diagnostic setting or log profile to stream to event hubs.</span></span> <span data-ttu-id="28d7f-208">Ad esempio, è possibile creare una regola nel Controllo degli accessi in base al ruolo:</span><span class="sxs-lookup"><span data-stu-id="28d7f-208">For example, you might create an RBAC rule:</span></span>
   
   ```powershell
   $role = Get-AzureRmRoleDefinition "Reader"
   $role.Id = $null
   $role.Name = "Monitoring Event Hub Listener"
   $role.Description = "Can get the key to listen to an event hub streaming monitoring data."
   $role.Actions.Clear()
   $role.Actions.Add("Microsoft.ServiceBus/namespaces/authorizationrules/listkeys/action")
   $role.Actions.Add("Microsoft.ServiceBus/namespaces/Read")
   $role.AssignableScopes.Clear()
   $role.AssignableScopes.Add("/subscriptions/mySubscription/resourceGroups/myResourceGroup/providers/Microsoft.ServiceBus/namespaces/mySBNameSpace")
   New-AzureRmRoleDefinition -Role $role 
   ```

## <a name="next-steps"></a><span data-ttu-id="28d7f-209">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="28d7f-209">Next steps</span></span>
* [<span data-ttu-id="28d7f-210">Controllo degli accessi in base al ruolo e autorizzazioni in Resource Manager</span><span class="sxs-lookup"><span data-stu-id="28d7f-210">Read about RBAC and permissions in Resource Manager</span></span>](../active-directory/role-based-access-control-what-is.md)
* [<span data-ttu-id="28d7f-211">Panoramica sul monitoraggio in Azure</span><span class="sxs-lookup"><span data-stu-id="28d7f-211">Read the overview of monitoring in Azure</span></span>](monitoring-overview.md)

