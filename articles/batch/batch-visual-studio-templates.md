---
title: compilazione di soluzioni di Batch con modelli di progetto di Visual Studio - Azure aaaStart | Documenti Microsoft
description: Informazioni su come questi modelli di progetto di Visual Studio consentono di implementare ed eseguire carichi di lavoro a elevato utilizzo di calcolo in Azure Batch.
services: batch
documentationcenter: .net
author: fayora
manager: timlt
editor: 
ms.assetid: 5e041ae2-25af-4882-a79e-3aa63c4bfb20
ms.service: batch
ms.devlang: multiple
ms.topic: article
ms.tgt_pltfrm: vm-windows
ms.workload: big-compute
ms.date: 02/27/2017
ms.author: tamram
ms.custom: H1Hack27Feb2017
ms.openlocfilehash: a61c480ddc4dffd66c01220a137a3e852e39c338
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/06/2017
---
# <a name="use-visual-studio-project-templates-toojump-start-batch-solutions"></a><span data-ttu-id="0b773-103">Utilizzare soluzioni di Visual Studio project modelli toojump avvio Batch</span><span class="sxs-lookup"><span data-stu-id="0b773-103">Use Visual Studio project templates toojump-start Batch solutions</span></span>

<span data-ttu-id="0b773-104">Hello **il gestore di processi** e **modelli di Visual Studio di attività del processore** per Batch fornire codice toohelp è tooimplement ed eseguire i carichi di lavoro con utilizzo intensivo di calcolo in Batch con hello meno impegnativo.</span><span class="sxs-lookup"><span data-stu-id="0b773-104">hello **Job Manager** and **Task Processor Visual Studio templates** for Batch provide code toohelp you tooimplement and run your compute-intensive workloads on Batch with hello least amount of effort.</span></span> <span data-ttu-id="0b773-105">Questo documento vengono descritti questi modelli e fornisce indicazioni per il toouse li.</span><span class="sxs-lookup"><span data-stu-id="0b773-105">This document describes these templates and provides guidance for how toouse them.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="0b773-106">In questo articolo vengono illustrati solo i modelli applicabili toothese due informazioni e si presuppone che si ha familiarità con il servizio di Batch hello e concetti chiave correlati tooit: pool, calcolare i nodi, processi e attività, attività di processo di gestione, le variabili di ambiente e altri informazioni rilevanti.</span><span class="sxs-lookup"><span data-stu-id="0b773-106">This article discusses only information applicable toothese two templates, and assumes that you are familiar with hello Batch service and key concepts related tooit: pools, compute nodes, jobs and tasks, job manager tasks, environment variables, and other relevant information.</span></span> <span data-ttu-id="0b773-107">È possibile trovare altre informazioni, vedere [nozioni di base di Azure Batch](batch-technical-overview.md), [Cenni preliminari sulla funzionalità di Batch per gli sviluppatori](batch-api-basics.md), e [Introduzione alla libreria di Azure Batch hello per .NET](batch-dotnet-get-started.md).</span><span class="sxs-lookup"><span data-stu-id="0b773-107">You can find more information in [Basics of Azure Batch](batch-technical-overview.md), [Batch feature overview for developers](batch-api-basics.md), and [Get started with hello Azure Batch library for .NET](batch-dotnet-get-started.md).</span></span>
> 
> 

## <a name="high-level-overview"></a><span data-ttu-id="0b773-108">Panoramica generale</span><span class="sxs-lookup"><span data-stu-id="0b773-108">High-level overview</span></span>
<span data-ttu-id="0b773-109">modelli di gestore di processi e attività processore Hello possono essere utilizzato toocreate due componenti utili:</span><span class="sxs-lookup"><span data-stu-id="0b773-109">hello Job Manager and Task Processor templates can be used toocreate two useful components:</span></span>

* <span data-ttu-id="0b773-110">Un'attività del gestore di processi che implementa un componente di suddivisione dei processi per suddividere un processo in più attività eseguibili in modo indipendente e parallelo.</span><span class="sxs-lookup"><span data-stu-id="0b773-110">A job manager task that implements a job splitter that can break a job down into multiple tasks that can run independently, in parallel.</span></span>
* <span data-ttu-id="0b773-111">Un processore di attività che può essere utilizzati tooperform pre-elaborazione e post-elaborazione intorno a una riga di comando dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="0b773-111">A task processor that can be used tooperform pre-processing and post-processing around an application command line.</span></span>

<span data-ttu-id="0b773-112">Ad esempio, in uno scenario per il rendering di film, barra di divisione processo hello sarebbe trasformare un processo unico filmato in centinaia o migliaia di attività separate che elabora singoli frame separatamente.</span><span class="sxs-lookup"><span data-stu-id="0b773-112">For example, in a movie rendering scenario, hello job splitter would turn a single movie job into hundreds or thousands of separate tasks that would process individual frames separately.</span></span> <span data-ttu-id="0b773-113">Di conseguenza, processore task hello sarebbe richiamare hello il rendering dell'applicazione e tutti i processi di dipendenti che sono necessari toorender ogni frame, nonché eseguire azioni aggiuntive (ad esempio, la copia hello rendering frame tooa percorso di archiviazione).</span><span class="sxs-lookup"><span data-stu-id="0b773-113">Correspondingly, hello task processor would invoke hello rendering application and all dependent processes that are needed toorender each frame, as well as perform any additional actions (for example, copying hello rendered frame tooa storage location).</span></span>

> [!NOTE]
> <span data-ttu-id="0b773-114">modelli di gestore di processi e attività processore Hello sono indipendenti tra loro, quindi è possibile scegliere toouse entrambi o solo uno di essi, a seconda dei requisiti di hello del processo di calcolo e alle preferenze.</span><span class="sxs-lookup"><span data-stu-id="0b773-114">hello Job Manager and Task Processor templates are independent of each other, so you can choose toouse both, or only one of them, depending on hello requirements of your compute job and on your preferences.</span></span>
> 
> 

<span data-ttu-id="0b773-115">Come illustrato nel diagramma hello riportato di seguito, un processo di calcolo che utilizza questi modelli passa attraverso tre fasi:</span><span class="sxs-lookup"><span data-stu-id="0b773-115">As shown in hello diagram below, a compute job that uses these templates will go through three stages:</span></span>

1. <span data-ttu-id="0b773-116">il codice client Hello (ad esempio, applicazione, il servizio web, e così via) Invia toohello un processo del servizio Batch in Azure, che specifica come il programma di gestione processo Gestione attività hello processo.</span><span class="sxs-lookup"><span data-stu-id="0b773-116">hello client code (e.g., application, web service, etc.) submits a job toohello Batch service on Azure, specifying as its job manager task hello job manager program.</span></span>
2. <span data-ttu-id="0b773-117">servizio Batch Hello esegue attività di gestione di processi hello in un nodo di calcolo e hello hello avvia barra di divisione di processo specificato numero di attività del processore di attività, alle molti nodi di calcolo in base alle esigenze, in base alle specifiche nel codice di divisione processo hello e parametri hello.</span><span class="sxs-lookup"><span data-stu-id="0b773-117">hello Batch service runs hello job manager task on a compute node and hello job splitter launches hello specified number of task processor tasks, on as many compute nodes as required, based on hello parameters and specifications in hello job splitter code.</span></span>
3. <span data-ttu-id="0b773-118">attività del processore di Hello attività eseguire in modo indipendente, in parallelo, tooprocess dati di input hello e generare dati di output di hello.</span><span class="sxs-lookup"><span data-stu-id="0b773-118">hello task processor tasks run independently, in parallel, tooprocess hello input data and generate hello output data.</span></span>

![Diagramma che illustra come il codice client interagisce con il servizio Batch hello][diagram01]

## <a name="prerequisites"></a><span data-ttu-id="0b773-120">Prerequisiti</span><span class="sxs-lookup"><span data-stu-id="0b773-120">Prerequisites</span></span>
<span data-ttu-id="0b773-121">modelli di Batch hello toouse, sarà necessario seguente hello:</span><span class="sxs-lookup"><span data-stu-id="0b773-121">toouse hello Batch templates, you will need hello following:</span></span>

* <span data-ttu-id="0b773-122">Un computer in cui è installato Visual Studio 2015.</span><span class="sxs-lookup"><span data-stu-id="0b773-122">A computer with Visual Studio 2015 installed.</span></span> <span data-ttu-id="0b773-123">I modelli di Batch sono attualmente supportati solo per Visual Studio 2015.</span><span class="sxs-lookup"><span data-stu-id="0b773-123">Batch templates are currently only supported for Visual Studio 2015.</span></span>
* <span data-ttu-id="0b773-124">modelli di Batch Hello, che sono disponibili da hello [Visual Studio Gallery] [ vs_gallery] come estensioni di Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="0b773-124">hello Batch templates, which are available from hello [Visual Studio Gallery][vs_gallery] as Visual Studio extensions.</span></span> <span data-ttu-id="0b773-125">Esistono due modi tooget hello modelli:</span><span class="sxs-lookup"><span data-stu-id="0b773-125">There are two ways tooget hello templates:</span></span>
  
  * <span data-ttu-id="0b773-126">Installare i modelli di hello utilizzando hello **estensioni e aggiornamenti** la finestra di dialogo in Visual Studio (per ulteriori informazioni, vedere [ricerca e uso delle estensioni di Visual Studio][vs_find_use_ext]).</span><span class="sxs-lookup"><span data-stu-id="0b773-126">Install hello templates using hello **Extensions and Updates** dialog box in Visual Studio (for more information, see [Finding and Using Visual Studio Extensions][vs_find_use_ext]).</span></span> <span data-ttu-id="0b773-127">In hello **estensioni e aggiornamenti** della finestra di dialogo ricerca e download hello due estensioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="0b773-127">In hello **Extensions and Updates** dialog box, search and download hello following two extensions:</span></span>
    
    * <span data-ttu-id="0b773-128">Azure Batch Job Manager with Job Splitter (Gestore di processi di Azure Batch con componente di suddivisione dei processi)</span><span class="sxs-lookup"><span data-stu-id="0b773-128">Azure Batch Job Manager with Job Splitter</span></span>
    * <span data-ttu-id="0b773-129">Azure Batch Task Processor (Elaboratore di attività di Azure Batch)</span><span class="sxs-lookup"><span data-stu-id="0b773-129">Azure Batch Task Processor</span></span>
  * <span data-ttu-id="0b773-130">Scaricare i modelli di hello dalla raccolta online hello per Visual Studio: [modelli di progetto di Microsoft Azure Batch][vs_gallery_templates]</span><span class="sxs-lookup"><span data-stu-id="0b773-130">Download hello templates from hello online gallery for Visual Studio: [Microsoft Azure Batch Project Templates][vs_gallery_templates]</span></span>
* <span data-ttu-id="0b773-131">Se si prevede di hello toouse [pacchetti di applicazioni](batch-application-packages.md) il gestore di processi hello toodeploy di funzionalità e attività del processore toohello Batch nodi di calcolo, è necessario toolink un tooyour di account di archiviazione account Batch.</span><span class="sxs-lookup"><span data-stu-id="0b773-131">If you plan toouse hello [Application Packages](batch-application-packages.md) feature toodeploy hello job manager and task processor toohello Batch compute nodes, you need toolink a storage account tooyour Batch account.</span></span>

## <a name="preparation"></a><span data-ttu-id="0b773-132">Operazioni preliminari</span><span class="sxs-lookup"><span data-stu-id="0b773-132">Preparation</span></span>
<span data-ttu-id="0b773-133">È consigliabile creare una soluzione destinata a contenga il gestore di processi, nonché il processore di attività, perché ciò può rendere più semplice codice tooshare tra il gestore di processi e i programmi di attività del processore.</span><span class="sxs-lookup"><span data-stu-id="0b773-133">We recommend creating a solution that can contain your job manager as well as your task processor, because this can make it easier tooshare code between your job manager and task processor programs.</span></span> <span data-ttu-id="0b773-134">toocreate questa soluzione, seguire questi passaggi:</span><span class="sxs-lookup"><span data-stu-id="0b773-134">toocreate this solution, follow these steps:</span></span>

1. <span data-ttu-id="0b773-135">Aprire Visual Studio e selezionare **File** > **Nuovo** > **Progetto**.</span><span class="sxs-lookup"><span data-stu-id="0b773-135">Open Visual Studio and select **File** > **New** > **Project**.</span></span>
2. <span data-ttu-id="0b773-136">In **Modelli** espandere **Altri tipi di progetti**, fare clic su **Soluzioni di Visual Studio** e selezionare **Soluzione vuota**.</span><span class="sxs-lookup"><span data-stu-id="0b773-136">Under **Templates**, expand **Other Project Types**, click **Visual Studio Solutions**, and then select **Blank Solution**.</span></span>
3. <span data-ttu-id="0b773-137">Digitare un nome che descriva lo scopo dell'applicazione e hello di questa soluzione (ad esempio, "LitwareBatchTaskPrograms").</span><span class="sxs-lookup"><span data-stu-id="0b773-137">Type a name that describes your application and hello purpose of this solution (e.g., "LitwareBatchTaskPrograms").</span></span>
4. <span data-ttu-id="0b773-138">toocreate hello nuova soluzione, fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="0b773-138">toocreate hello new solution, click **OK**.</span></span>

## <a name="job-manager-template"></a><span data-ttu-id="0b773-139">Modello Job Manager (Gestore di processi)</span><span class="sxs-lookup"><span data-stu-id="0b773-139">Job Manager template</span></span>
<span data-ttu-id="0b773-140">modello di processo Manager Hello consente si tooimplement un'attività di gestione di processo eseguibili hello seguenti azioni:</span><span class="sxs-lookup"><span data-stu-id="0b773-140">hello Job Manager template helps you tooimplement a job manager task that can perform hello following actions:</span></span>

* <span data-ttu-id="0b773-141">Dividere un processo in più attività.</span><span class="sxs-lookup"><span data-stu-id="0b773-141">Split a job into multiple tasks.</span></span>
* <span data-ttu-id="0b773-142">Inviare toorun tali attività nel Batch.</span><span class="sxs-lookup"><span data-stu-id="0b773-142">Submit those tasks toorun on Batch.</span></span>

> [!NOTE]
> <span data-ttu-id="0b773-143">Per altre informazioni sulle attività del gestore di processi, vedere [Panoramica delle funzionalità di Batch per sviluppatori](batch-api-basics.md#job-manager-task).</span><span class="sxs-lookup"><span data-stu-id="0b773-143">For more information about job manager tasks, see [Batch feature overview for developers](batch-api-basics.md#job-manager-task).</span></span>
> 
> 

### <a name="create-a-job-manager-using-hello-template"></a><span data-ttu-id="0b773-144">Creare un gestore di processi utilizzando il modello di hello</span><span class="sxs-lookup"><span data-stu-id="0b773-144">Create a Job Manager using hello template</span></span>
<span data-ttu-id="0b773-145">tooadd una soluzione di toohello manager processo creato in precedenza, seguire questi passaggi:</span><span class="sxs-lookup"><span data-stu-id="0b773-145">tooadd a job manager toohello solution that you created earlier, follow these steps:</span></span>

1. <span data-ttu-id="0b773-146">Aprire la soluzione esistente in Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="0b773-146">Open your existing solution in Visual Studio.</span></span>
2. <span data-ttu-id="0b773-147">In Esplora soluzioni, Esplora hello pulsante destro del mouse, fare clic su **Aggiungi** > **nuovo progetto**.</span><span class="sxs-lookup"><span data-stu-id="0b773-147">In Solution Explorer, right-click hello solution, click **Add** > **New Project**.</span></span>
3. <span data-ttu-id="0b773-148">In **Visual C#** fare clic su **Cloud** e su **Azure Batch Job Manager with Job Splitter** (Gestore di processi di Azure Batch con componente di suddivisione dei processi).</span><span class="sxs-lookup"><span data-stu-id="0b773-148">Under **Visual C#**, click **Cloud**, and then click **Azure Batch Job Manager with Job Splitter**.</span></span>
4. <span data-ttu-id="0b773-149">Digitare un nome che descrive l'applicazione e identifica il progetto come gestore di processi hello (ad esempio "GestoreProcessiLitware".</span><span class="sxs-lookup"><span data-stu-id="0b773-149">Type a name that describes your application and identifies this project as hello job manager (e.g. "LitwareJobManager").</span></span>
5. <span data-ttu-id="0b773-150">progetto hello toocreate, fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="0b773-150">toocreate hello project, click **OK**.</span></span>
6. <span data-ttu-id="0b773-151">Infine, compilazione hello progetto tooforce Visual Studio tooload tutti i pacchetti NuGet a cui viene fatto riferimento e tooverify che hello progetto sia valido prima di iniziare la modifica.</span><span class="sxs-lookup"><span data-stu-id="0b773-151">Finally, build hello project tooforce Visual Studio tooload all referenced NuGet packages and tooverify that hello project is valid before you start modifying it.</span></span>

### <a name="job-manager-template-files-and-their-purpose"></a><span data-ttu-id="0b773-152">File del modello Job Manager (Gestore di processi) e relativo scopo</span><span class="sxs-lookup"><span data-stu-id="0b773-152">Job Manager template files and their purpose</span></span>
<span data-ttu-id="0b773-153">Quando si crea un progetto usando il modello di processo Manager hello, genera tre gruppi di file di codice:</span><span class="sxs-lookup"><span data-stu-id="0b773-153">When you create a project using hello Job Manager template, it generates three groups of code files:</span></span>

* <span data-ttu-id="0b773-154">file di programma principale Hello (Program.cs).</span><span class="sxs-lookup"><span data-stu-id="0b773-154">hello main program file (Program.cs).</span></span> <span data-ttu-id="0b773-155">Che contiene il punto di ingresso programma hello e la gestione delle eccezioni di livello superiore.</span><span class="sxs-lookup"><span data-stu-id="0b773-155">This contains hello program entry point and top-level exception handling.</span></span> <span data-ttu-id="0b773-156">Non deve in genere necessario toomodify.</span><span class="sxs-lookup"><span data-stu-id="0b773-156">You shouldn't normally need toomodify this.</span></span>
* <span data-ttu-id="0b773-157">directory del Framework Hello.</span><span class="sxs-lookup"><span data-stu-id="0b773-157">hello Framework directory.</span></span> <span data-ttu-id="0b773-158">Contiene file hello responsabili di lavoro 'standard' hello eseguita dal programma di gestione processo hello: installazione del pacchetto di parametri, aggiunta di processo Batch toohello di attività e così via. Non deve in genere toomodify i file necessari.</span><span class="sxs-lookup"><span data-stu-id="0b773-158">This contains hello files responsible for hello 'boilerplate' work done by hello job manager program – unpacking parameters, adding tasks toohello Batch job, etc. You shouldn't normally need toomodify these files.</span></span>
* <span data-ttu-id="0b773-159">file di divisione del processo Hello (JobSplitter.cs).</span><span class="sxs-lookup"><span data-stu-id="0b773-159">hello job splitter file (JobSplitter.cs).</span></span> <span data-ttu-id="0b773-160">in cui si inserirà la logica specifica dell'applicazione per suddividere un processo in attività.</span><span class="sxs-lookup"><span data-stu-id="0b773-160">This is where you will put your application-specific logic for splitting a job into tasks.</span></span>

<span data-ttu-id="0b773-161">Naturalmente è possibile aggiungere ulteriori file come obbligatorio toosupport codice processo barra di divisione, a seconda della complessità hello del processo di hello suddivisione logica.</span><span class="sxs-lookup"><span data-stu-id="0b773-161">Of course you can add additional files as required toosupport your job splitter code, depending on hello complexity of hello job splitting logic.</span></span>

<span data-ttu-id="0b773-162">modello di Hello genera anche i file di progetto .NET standard, ad esempio un file con estensione csproj app. config, Packages, e così via.</span><span class="sxs-lookup"><span data-stu-id="0b773-162">hello template also generates standard .NET project files such as a .csproj file, app.config, packages.config, etc.</span></span>

<span data-ttu-id="0b773-163">resto Hello di questa sezione vengono descritti diversi file hello e la relativa struttura di codice e le operazioni eseguite da ogni classe.</span><span class="sxs-lookup"><span data-stu-id="0b773-163">hello rest of this section describes hello different files and their code structure, and explains what each class does.</span></span>

![Esplora soluzioni Visual Studio con una soluzione di modello di processo Manager hello][solution_explorer01]

<span data-ttu-id="0b773-165">**File di Framework**</span><span class="sxs-lookup"><span data-stu-id="0b773-165">**Framework files**</span></span>

* <span data-ttu-id="0b773-166">`Configuration.cs`: Incapsula il caricamento di hello processo dati di configurazione, ad esempio i dettagli dell'account Batch, le credenziali dell'account di archiviazione collegati, informazioni di processo e attività e i parametri del processo.</span><span class="sxs-lookup"><span data-stu-id="0b773-166">`Configuration.cs`: Encapsulates hello loading of job configuration data such as Batch account details, linked storage account credentials, job and task information, and job parameters.</span></span> <span data-ttu-id="0b773-167">Fornisce inoltre l'accesso delle variabili di ambiente definita tooBatch (vedere le impostazioni di ambiente per le attività, nella documentazione di Batch hello) tramite la classe Configuration.EnvironmentVariable hello.</span><span class="sxs-lookup"><span data-stu-id="0b773-167">It also provides access tooBatch-defined environment variables (see Environment settings for tasks, in hello Batch documentation) via hello Configuration.EnvironmentVariable class.</span></span>
* <span data-ttu-id="0b773-168">`IConfiguration.cs`: Riassunto hello implementazione della classe di configurazione di hello, in modo che sia possibile unit test divisione del processo utilizzando un oggetto di configurazione fittizi o.</span><span class="sxs-lookup"><span data-stu-id="0b773-168">`IConfiguration.cs`: Abstracts hello implementation of hello Configuration class, so that you can unit test your job splitter using a fake or mock configuration object.</span></span>
* <span data-ttu-id="0b773-169">`JobManager.cs`: Coordina i componenti del programma di gestione processo di hello hello.</span><span class="sxs-lookup"><span data-stu-id="0b773-169">`JobManager.cs`: Orchestrates hello components of hello job manager program.</span></span> <span data-ttu-id="0b773-170">Ed è responsabile per l'inizializzazione di divisione processo hello, chiamata divisione processo hello, hello e invio attività hello restituito dal mittente dell'attività toohello di hello processo barra di divisione.</span><span class="sxs-lookup"><span data-stu-id="0b773-170">It is responsible for hello initializing hello job splitter, invoking hello job splitter, and dispatching hello tasks returned by hello job splitter toohello task submitter.</span></span>
* <span data-ttu-id="0b773-171">`JobManagerException.cs`: Rappresenta un errore che richiede hello processo manager tooterminate.</span><span class="sxs-lookup"><span data-stu-id="0b773-171">`JobManagerException.cs`: Represents an error that requires hello job manager tooterminate.</span></span> <span data-ttu-id="0b773-172">JobManagerException è usato toowrap 'previsto' errori in cui le informazioni di diagnostica specifiche possono essere fornite come parte della terminazione.</span><span class="sxs-lookup"><span data-stu-id="0b773-172">JobManagerException is used toowrap 'expected' errors where specific diagnostic information can be provided as part of termination.</span></span>
* <span data-ttu-id="0b773-173">`TaskSubmitter.cs`: Questa classe è responsabile tooadding attività restituita dal processo Batch toohello di hello processo barra di divisione.</span><span class="sxs-lookup"><span data-stu-id="0b773-173">`TaskSubmitter.cs`: This class is responsible tooadding tasks returned by hello job splitter toohello Batch job.</span></span> <span data-ttu-id="0b773-174">classe JobManager Hello aggrega sequenza hello delle operazioni in batch per il processo di aggiunta efficiente ma tempestiva toohello, quindi chiama TaskSubmitter.SubmitTasks su un thread in background per ogni batch.</span><span class="sxs-lookup"><span data-stu-id="0b773-174">hello JobManager class aggregates hello sequence of tasks into batches for efficient but timely addition toohello job, then calls TaskSubmitter.SubmitTasks on a background thread for each batch.</span></span>

<span data-ttu-id="0b773-175">**Componente di suddivisione dei processi**</span><span class="sxs-lookup"><span data-stu-id="0b773-175">**Job Splitter**</span></span>

<span data-ttu-id="0b773-176">`JobSplitter.cs`: Questa classe contiene la logica specifica dell'applicazione per suddividere il processo di hello in attività.</span><span class="sxs-lookup"><span data-stu-id="0b773-176">`JobSplitter.cs`: This class contains application-specific logic for splitting hello job into tasks.</span></span> <span data-ttu-id="0b773-177">framework Hello richiama hello JobSplitter.Split metodo tooobtain una sequenza di attività, che viene aggiunto il processo di toohello come metodo hello li restituisce.</span><span class="sxs-lookup"><span data-stu-id="0b773-177">hello framework invokes hello JobSplitter.Split method tooobtain a sequence of tasks, which it adds toohello job as hello method returns them.</span></span> <span data-ttu-id="0b773-178">Si tratta di classe hello in cui si inserirà logica hello del processo.</span><span class="sxs-lookup"><span data-stu-id="0b773-178">This is hello class where you will inject hello logic of your job.</span></span> <span data-ttu-id="0b773-179">Implementare hello Split metodo tooreturn una sequenza di istanze di CloudTask che rappresentano attività hello in cui si desidera che toopartition hello.</span><span class="sxs-lookup"><span data-stu-id="0b773-179">Implement hello Split method tooreturn a sequence of CloudTask instances representing hello tasks into which you want toopartition hello job.</span></span>

<span data-ttu-id="0b773-180">**File di progetto della riga di comando .NET standard**</span><span class="sxs-lookup"><span data-stu-id="0b773-180">**Standard .NET command line project files**</span></span>

* <span data-ttu-id="0b773-181">`App.config`: file di configurazione dell'applicazione .NET standard.</span><span class="sxs-lookup"><span data-stu-id="0b773-181">`App.config`: Standard .NET application configuration file.</span></span>
* <span data-ttu-id="0b773-182">`Packages.config`: file di dipendenza del pacchetto NuGet standard.</span><span class="sxs-lookup"><span data-stu-id="0b773-182">`Packages.config`: Standard NuGet package dependency file.</span></span>
* <span data-ttu-id="0b773-183">`Program.cs`: Contiene il punto di ingresso programma hello e la gestione delle eccezioni di livello superiore.</span><span class="sxs-lookup"><span data-stu-id="0b773-183">`Program.cs`: Contains hello program entry point and top-level exception handling.</span></span>

### <a name="implementing-hello-job-splitter"></a><span data-ttu-id="0b773-184">Implementazione della barra di divisione processo hello</span><span class="sxs-lookup"><span data-stu-id="0b773-184">Implementing hello job splitter</span></span>
<span data-ttu-id="0b773-185">Quando si apre il progetto di modello il gestore di processi di hello, progetto hello avrà file JobSplitter.cs hello aperta per impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="0b773-185">When you open hello Job Manager template project, hello project will have hello JobSplitter.cs file open by default.</span></span> <span data-ttu-id="0b773-186">È possibile implementare hello suddividere la logica per le attività di hello nel carico di lavoro utilizzando Mostra di metodo Split () hello riportato di seguito:</span><span class="sxs-lookup"><span data-stu-id="0b773-186">You can implement hello split logic for hello tasks in your workload by using hello Split() method show below:</span></span>

```csharp
/// <summary>
/// Gets hello tasks into which toosplit hello job. This is where you inject
/// your application-specific logic for decomposing hello job into tasks.
///
/// hello job manager framework invokes hello Split method for you; you need
/// only tooimplement it, not toocall it yourself. Typically, your
/// implementation should return tasks lazily, for example using a C#
/// iterator and hello "yield return" statement; this allows tasks toobe added
/// and toostart running while splitting is still in progress.
/// </summary>
/// <returns>hello tasks toobe added toohello job. Tasks are added automatically
/// by hello job manager framework as they are returned by this method.</returns>
public IEnumerable<CloudTask> Split()
{
    // Your code for hello split logic goes here.
    int startFrame = Convert.ToInt32(_parameters["StartFrame"]);
    int endFrame = Convert.ToInt32(_parameters["EndFrame"]);

    for (int i = startFrame; i <= endFrame; i++)
    {
        yield return new CloudTask("myTask" + i, "cmd /c dir");
    }
}
```

> [!NOTE]
> <span data-ttu-id="0b773-187">Hello annotato sezione hello `Split()` metodo è hello sezione solo hello codice del modello di gestore di processi destinato a si toomodify aggiungendo hello logica toosplit i processi in attività diverse.</span><span class="sxs-lookup"><span data-stu-id="0b773-187">hello annotated section in hello `Split()` method is hello only section of hello Job Manager template code that is intended for you toomodify by adding hello logic toosplit your jobs into different tasks.</span></span> <span data-ttu-id="0b773-188">Se si desidera toomodify un'altra sezione del modello di hello, verificare il funzionamento di Batch, è sono a conoscenza e provare a utilizzare alcune delle hello [Batch esempi di codice][github_samples].</span><span class="sxs-lookup"><span data-stu-id="0b773-188">If you want toomodify a different section of hello template, please ensure you are familiarized with how Batch works, and try out a few of hello [Batch code samples][github_samples].</span></span>
> 
> 

<span data-ttu-id="0b773-189">L'implementazione di Split() ha accesso a:</span><span class="sxs-lookup"><span data-stu-id="0b773-189">Your Split() implementation has access to:</span></span>

* <span data-ttu-id="0b773-190">parametri del processo, tramite hello Hello `_parameters` campo.</span><span class="sxs-lookup"><span data-stu-id="0b773-190">hello job parameters, via hello `_parameters` field.</span></span>
* <span data-ttu-id="0b773-191">Hello CloudJob dell'oggetto che rappresenta i processi di hello, tramite hello `_job` campo.</span><span class="sxs-lookup"><span data-stu-id="0b773-191">hello CloudJob object representing hello job, via hello `_job` field.</span></span>
* <span data-ttu-id="0b773-192">Hello CloudTask dell'oggetto che rappresenta hello manager mansione, tramite hello `_jobManagerTask` campo.</span><span class="sxs-lookup"><span data-stu-id="0b773-192">hello CloudTask object representing hello job manager task, via hello `_jobManagerTask` field.</span></span>

<span data-ttu-id="0b773-193">Il `Split()` non è necessario implementazione processo toohello di attività tooadd direttamente.</span><span class="sxs-lookup"><span data-stu-id="0b773-193">Your `Split()` implementation does not need tooadd tasks toohello job directly.</span></span> <span data-ttu-id="0b773-194">Al contrario, il codice deve restituire una sequenza di oggetti CloudTask e verranno aggiunte toohello processo automaticamente dalle classi framework hello che richiamano la barra di divisione processo hello.</span><span class="sxs-lookup"><span data-stu-id="0b773-194">Instead, your code should return a sequence of CloudTask objects, and these will be added toohello job automatically by hello framework classes that invoke hello job splitter.</span></span> <span data-ttu-id="0b773-195">È comune toouse # iteratore (`yield return`) funzionalità tooimplement separatori di processo, come in questo modo toostart attività hello più breve possibile anziché attendere che tutte le attività toobe calcolato.</span><span class="sxs-lookup"><span data-stu-id="0b773-195">It's common toouse C#'s iterator (`yield return`) feature tooimplement job splitters as this allows hello tasks toostart running as soon as possible rather than waiting for all tasks toobe calculated.</span></span>

<span data-ttu-id="0b773-196">**Errore del componente di suddivisione dei processi**</span><span class="sxs-lookup"><span data-stu-id="0b773-196">**Job splitter failure**</span></span>

<span data-ttu-id="0b773-197">Se il componente di suddivisione dei processi rileva un errore, deve eseguire una di queste due operazioni:</span><span class="sxs-lookup"><span data-stu-id="0b773-197">If your job splitter encounters an error, it should either:</span></span>

* <span data-ttu-id="0b773-198">Terminare hello sequenza utilizzando hello c# `yield break` istruzione, in cui il gestore di processi hello case verrà considerato come esito positivo; o</span><span class="sxs-lookup"><span data-stu-id="0b773-198">Terminate hello sequence using hello C# `yield break` statement, in which case hello job manager will be treated as successful; or</span></span>
* <span data-ttu-id="0b773-199">Genera un'eccezione, in cui il gestore di processi hello case verrà considerato come non riuscita e può essere ripetuto a seconda di come è configurato il client hello).</span><span class="sxs-lookup"><span data-stu-id="0b773-199">Throw an exception, in which case hello job manager will be treated as failed and may be retried depending on how hello client has configured it).</span></span>

<span data-ttu-id="0b773-200">In entrambi i casi, tutte le attività non ha restituito da una barra di divisione processo hello e processo Batch toohello aggiunto saranno toorun idoneo.</span><span class="sxs-lookup"><span data-stu-id="0b773-200">In both cases, any tasks already returned by hello job splitter and added toohello Batch job will be eligible toorun.</span></span> <span data-ttu-id="0b773-201">Se non si desidera questo toohappen, quindi è possibile:</span><span class="sxs-lookup"><span data-stu-id="0b773-201">If you don't want this toohappen, then you could:</span></span>

* <span data-ttu-id="0b773-202">Terminare il processo di hello prima della restituzione da una barra di divisione processo hello</span><span class="sxs-lookup"><span data-stu-id="0b773-202">Terminate hello job before returning from hello job splitter</span></span>
* <span data-ttu-id="0b773-203">Formulare raccolta intera attività hello prima di restituirlo (ovvero viene restituito un `ICollection<CloudTask>` o `IList<CloudTask>` anziché implementare la divisione di processo mediante un iteratore in c#)</span><span class="sxs-lookup"><span data-stu-id="0b773-203">Formulate hello entire task collection before returning it (that is, return an `ICollection<CloudTask>` or `IList<CloudTask>` instead of implementing your job splitter using a C# iterator)</span></span>
* <span data-ttu-id="0b773-204">Utilizzare l'attività dipendenze toomake che tutte le attività dipendono dal completamento hello del gestore di processi hello</span><span class="sxs-lookup"><span data-stu-id="0b773-204">Use task dependencies toomake all tasks depend on hello successful completion of hello job manager</span></span>

<span data-ttu-id="0b773-205">**Tentativi del gestore di processi**</span><span class="sxs-lookup"><span data-stu-id="0b773-205">**Job manager retries**</span></span>

<span data-ttu-id="0b773-206">Se il gestore di processi hello non riesce, può essere ripetuto dal servizio Batch hello a seconda delle impostazioni relative ai tentativi hello client.</span><span class="sxs-lookup"><span data-stu-id="0b773-206">If hello job manager fails, it may be retried by hello Batch service depending on hello client retry settings.</span></span> <span data-ttu-id="0b773-207">In generale, questa operazione è sicura, perché quando il framework di hello aggiunge processo toohello attività, ignora tutte le attività che esistono già.</span><span class="sxs-lookup"><span data-stu-id="0b773-207">In general, this is safe, because when hello framework adds tasks toohello job, it ignores any tasks that already exist.</span></span> <span data-ttu-id="0b773-208">Tuttavia, se il calcolo delle attività è costoso, si può chiamare non costo hello tooincur di calcolo delle attività che sono già stati aggiunti toohello processo. al contrario, se hello esegue di nuovo è toogenerate non garantita hello stesso ID attività, quindi non consente di avviare il comportamento di 'Ignora i duplicati' hello in.</span><span class="sxs-lookup"><span data-stu-id="0b773-208">However, if calculating tasks is expensive, you may not wish tooincur hello cost of recalculating tasks that have already been added toohello job; conversely, if hello re-run is not guaranteed toogenerate hello same task IDs then hello 'ignore duplicates' behavior will not kick in.</span></span> <span data-ttu-id="0b773-209">In questi casi è consigliabile progettare il lavoro processo divisione toodetect hello che sia già stato eseguito e non ripeterla, ad esempio eseguendo un CloudJob.ListTasks prima di avviare attività tooyield.</span><span class="sxs-lookup"><span data-stu-id="0b773-209">In these cases you should design your job splitter toodetect hello work that has already been done and not repeat it, for example by performing a CloudJob.ListTasks before starting tooyield tasks.</span></span>

### <a name="exit-codes-and-exceptions-in-hello-job-manager-template"></a><span data-ttu-id="0b773-210">Uscire da codici e le eccezioni nel modello di processo Manager hello</span><span class="sxs-lookup"><span data-stu-id="0b773-210">Exit codes and exceptions in hello Job Manager template</span></span>
<span data-ttu-id="0b773-211">Codici di uscita e le eccezioni forniscono un meccanismo toodetermine hello risultato esegue un programma e tooidentify possono consentire eventuali problemi con l'esecuzione di hello del programma hello.</span><span class="sxs-lookup"><span data-stu-id="0b773-211">Exit codes and exceptions provide a mechanism toodetermine hello outcome of running a program, and they can help tooidentify any problems with hello execution of hello program.</span></span> <span data-ttu-id="0b773-212">modello di processo Manager Hello implementa i codici di uscita hello e le eccezioni descritte in questa sezione.</span><span class="sxs-lookup"><span data-stu-id="0b773-212">hello Job Manager template implements hello exit codes and exceptions described in this section.</span></span>

<span data-ttu-id="0b773-213">Un'attività di gestione processo che viene implementata con modello di processo Manager hello può restituire tre codici di uscita possibili:</span><span class="sxs-lookup"><span data-stu-id="0b773-213">A job manager task that is implemented with hello Job Manager template can return three possible exit codes:</span></span>

| <span data-ttu-id="0b773-214">Codice</span><span class="sxs-lookup"><span data-stu-id="0b773-214">Code</span></span> | <span data-ttu-id="0b773-215">Descrizione</span><span class="sxs-lookup"><span data-stu-id="0b773-215">Description</span></span> |
| --- | --- |
| <span data-ttu-id="0b773-216">0</span><span class="sxs-lookup"><span data-stu-id="0b773-216">0</span></span> |<span data-ttu-id="0b773-217">gestore di processi Hello completato.</span><span class="sxs-lookup"><span data-stu-id="0b773-217">hello job manager completed successfully.</span></span> <span data-ttu-id="0b773-218">Il codice della barra di divisione processo eseguito toocompletion e tutte le attività sono state aggiunte toohello processo.</span><span class="sxs-lookup"><span data-stu-id="0b773-218">Your job splitter code ran toocompletion, and all tasks were added toohello job.</span></span> |
| <span data-ttu-id="0b773-219">1</span><span class="sxs-lookup"><span data-stu-id="0b773-219">1</span></span> |<span data-ttu-id="0b773-220">attività di gestione di Hello processo non riuscito con un'eccezione in una parte del programma hello 'prevista'.</span><span class="sxs-lookup"><span data-stu-id="0b773-220">hello job manager task failed with an exception in an 'expected' part of hello program.</span></span> <span data-ttu-id="0b773-221">eccezione Hello è stato tradotto tooa JobManagerException con informazioni di diagnostica e, se possibile, suggerimenti per la risoluzione hello errore.</span><span class="sxs-lookup"><span data-stu-id="0b773-221">hello exception was translated tooa JobManagerException with diagnostic information and, where possible, suggestions for resolving hello failure.</span></span> |
| <span data-ttu-id="0b773-222">2</span><span class="sxs-lookup"><span data-stu-id="0b773-222">2</span></span> |<span data-ttu-id="0b773-223">attività del gestore Hello processi non riuscito con eccezione 'imprevista'.</span><span class="sxs-lookup"><span data-stu-id="0b773-223">hello job manager task failed with an 'unexpected' exception.</span></span> <span data-ttu-id="0b773-224">Hello eccezione era registrati toostandard output, ma il gestore di processi hello tooadd Impossibile le informazioni di diagnostica o di monitoraggio e aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="0b773-224">hello exception was logged toostandard output, but hello job manager was unable tooadd any additional diagnostic or remediation information.</span></span> |

<span data-ttu-id="0b773-225">In caso di hello processo manager esito negativo dell'attività, alcune attività possono ancora essere stati aggiunti toohello servizio prima dell'errore di hello.</span><span class="sxs-lookup"><span data-stu-id="0b773-225">In hello case of job manager task failure, some tasks may still have been added toohello service before hello error occurred.</span></span> <span data-ttu-id="0b773-226">Queste attività verranno eseguite normalmente.</span><span class="sxs-lookup"><span data-stu-id="0b773-226">These tasks will run as normal.</span></span> <span data-ttu-id="0b773-227">Per informazioni su questo percorso del codice, vedere sopra "Errore del componente di suddivisione dei processi".</span><span class="sxs-lookup"><span data-stu-id="0b773-227">See "Job Splitter Failure" above for discussion of this code path.</span></span>

<span data-ttu-id="0b773-228">Tutte le informazioni restituite da eccezioni hello vengono scritti nel file stdout.txt e stderr.txt.</span><span class="sxs-lookup"><span data-stu-id="0b773-228">All hello information returned by exceptions is written into stdout.txt and stderr.txt files.</span></span> <span data-ttu-id="0b773-229">Per altre informazioni, vedere [Gestione degli errori](batch-api-basics.md#error-handling).</span><span class="sxs-lookup"><span data-stu-id="0b773-229">For more information, see [Error Handling](batch-api-basics.md#error-handling).</span></span>

### <a name="client-considerations"></a><span data-ttu-id="0b773-230">Considerazioni sul client</span><span class="sxs-lookup"><span data-stu-id="0b773-230">Client considerations</span></span>
<span data-ttu-id="0b773-231">Questa sezione illustra alcuni requisiti dell'implementazione client quando si richiama un gestore di processi basato su questo modello.</span><span class="sxs-lookup"><span data-stu-id="0b773-231">This section describes some client implementation requirements when invoking a job manager based on this template.</span></span> <span data-ttu-id="0b773-232">Vedere [come toopass parametri e variabili di ambiente da hello codice client](#pass-environment-settings) per ulteriori informazioni sul passaggio di parametri e le impostazioni di ambiente.</span><span class="sxs-lookup"><span data-stu-id="0b773-232">See [How toopass parameters and environment variables from hello client code](#pass-environment-settings) for details on passing parameters and environment settings.</span></span>

<span data-ttu-id="0b773-233">**Credenziali obbligatorie**</span><span class="sxs-lookup"><span data-stu-id="0b773-233">**Mandatory credentials**</span></span>

<span data-ttu-id="0b773-234">In tooadd attività toohello Azure batch ordine, attività del gestore processi hello richiede una chiave e l'URL dell'account Azure Batch.</span><span class="sxs-lookup"><span data-stu-id="0b773-234">In order tooadd tasks toohello Azure Batch job, hello job manager task requires your Azure Batch account URL and key.</span></span> <span data-ttu-id="0b773-235">È necessario passarli nelle variabili di ambiente denominate YOUR_BATCH_URL e YOUR_BATCH_KEY.</span><span class="sxs-lookup"><span data-stu-id="0b773-235">You must pass these in environment variables named YOUR_BATCH_URL and YOUR_BATCH_KEY.</span></span> <span data-ttu-id="0b773-236">È possibile impostare nel gestore di processi hello impostazioni ambiente di attività.</span><span class="sxs-lookup"><span data-stu-id="0b773-236">You can set these in hello Job Manager task environment settings.</span></span> <span data-ttu-id="0b773-237">Ad esempio, in un client C#:</span><span class="sxs-lookup"><span data-stu-id="0b773-237">For example, in a C# client:</span></span>

```csharp
job.JobManagerTask.EnvironmentSettings = new [] {
    new EnvironmentSetting("YOUR_BATCH_URL", "https://account.region.batch.azure.com"),
    new EnvironmentSetting("YOUR_BATCH_KEY", "{your_base64_encoded_account_key}"),
};
```
<span data-ttu-id="0b773-238">**Credenziali di archiviazione**</span><span class="sxs-lookup"><span data-stu-id="0b773-238">**Storage credentials**</span></span>

<span data-ttu-id="0b773-239">In genere, hello client non deve tooprovide hello archiviazione collegati account credenziali toohello attività del gestore processi perché (a) la maggior parte dei gestori di processo non è necessario l'account di archiviazione collegato hello accesso tooexplicitly e (b) hello account di archiviazione collegato viene spesso fornita attività tooall come un'impostazione di ambiente comuni per il processo di hello.</span><span class="sxs-lookup"><span data-stu-id="0b773-239">Typically, hello client does not need tooprovide hello linked storage account credentials toohello job manager task because (a) most job managers do not need tooexplicitly access hello linked storage account and (b) hello linked storage account is often provided tooall tasks as a common environment setting for hello job.</span></span> <span data-ttu-id="0b773-240">Se non si desidera fornire hello collegato l'account di archiviazione tramite impostazioni di ambiente hello comuni, il gestore di processi hello richiede accesso toolinked archiviazione, quindi è necessario fornire le credenziali di archiviazione hello collegato come segue:</span><span class="sxs-lookup"><span data-stu-id="0b773-240">If you are not providing hello linked storage account via hello common environment settings, and hello job manager requires access toolinked storage, then you should supply hello linked storage credentials as follows:</span></span>

```csharp
job.JobManagerTask.EnvironmentSettings = new [] {
    /* other environment settings */
    new EnvironmentSetting("LINKED_STORAGE_ACCOUNT", "{storageAccountName}"),
    new EnvironmentSetting("LINKED_STORAGE_KEY", "{storageAccountKey}"),
};
```

<span data-ttu-id="0b773-241">**Impostazioni dell'attività del gestore di processi**</span><span class="sxs-lookup"><span data-stu-id="0b773-241">**Job manager task settings**</span></span>

<span data-ttu-id="0b773-242">client Hello deve impostare il gestore di processi hello *killJobOnCompletion* flag troppo**false**.</span><span class="sxs-lookup"><span data-stu-id="0b773-242">hello client should set hello job manager *killJobOnCompletion* flag too**false**.</span></span>

<span data-ttu-id="0b773-243">È in genere sicura per hello client tooset *runExclusive* troppo**false**.</span><span class="sxs-lookup"><span data-stu-id="0b773-243">It is usually safe for hello client tooset *runExclusive* too**false**.</span></span>

<span data-ttu-id="0b773-244">client di Hello deve utilizzare hello *resourceFiles* o *applicationPackageReferences* raccolta toohave hello il gestore di processi eseguibile (e relativa DLL necessarie) distribuito toohello del nodo di calcolo.</span><span class="sxs-lookup"><span data-stu-id="0b773-244">hello client should use hello *resourceFiles* or *applicationPackageReferences* collection toohave hello job manager executable (and its required DLLs) deployed toohello compute node.</span></span>

<span data-ttu-id="0b773-245">Per impostazione predefinita, il gestore di processi hello non verrà ritentato in caso di errore.</span><span class="sxs-lookup"><span data-stu-id="0b773-245">By default, hello job manager will not be retried if it fails.</span></span> <span data-ttu-id="0b773-246">A seconda la logica di gestione del processo, il client hello può essere tooenable tentativi tramite *vincoli*/*maxTaskRetryCount*.</span><span class="sxs-lookup"><span data-stu-id="0b773-246">Depending on your job manager logic, hello client may want tooenable retries via *constraints*/*maxTaskRetryCount*.</span></span>

<span data-ttu-id="0b773-247">**Impostazioni del processo**</span><span class="sxs-lookup"><span data-stu-id="0b773-247">**Job settings**</span></span>

<span data-ttu-id="0b773-248">Se il separatore di processo hello genera attività con dipendenze, il client di hello deve impostare tootrue usesTaskDependencies del processo di hello.</span><span class="sxs-lookup"><span data-stu-id="0b773-248">If hello job splitter emits tasks with dependencies, hello client must set hello job's usesTaskDependencies tootrue.</span></span>

<span data-ttu-id="0b773-249">Nel modello di divisione hello processo, è insolito per i client toowish tooadd attività toojobs oltre il separatore di processo hello crea.</span><span class="sxs-lookup"><span data-stu-id="0b773-249">In hello job splitter model, it is unusual for clients toowish tooadd tasks toojobs over and above what hello job splitter creates.</span></span> <span data-ttu-id="0b773-250">client Hello dovrebbe pertanto impostato del processo di hello *onAllTasksComplete* troppo**terminatejob**.</span><span class="sxs-lookup"><span data-stu-id="0b773-250">hello client should therefore normally set hello job's *onAllTasksComplete* too**terminatejob**.</span></span>

## <a name="task-processor-template"></a><span data-ttu-id="0b773-251">Modello Task Processor (Elaboratore di attività)</span><span class="sxs-lookup"><span data-stu-id="0b773-251">Task Processor template</span></span>
<span data-ttu-id="0b773-252">Un modello di processore Task consente tooimplement un processore di attività eseguibili hello seguenti azioni:</span><span class="sxs-lookup"><span data-stu-id="0b773-252">A Task Processor template helps you tooimplement a task processor that can perform hello following actions:</span></span>

* <span data-ttu-id="0b773-253">Impostare le informazioni di hello richieste da ogni toorun attività Batch.</span><span class="sxs-lookup"><span data-stu-id="0b773-253">Set up hello information required by each Batch task toorun.</span></span>
* <span data-ttu-id="0b773-254">Eseguire tutte le azioni necessarie per ogni attività batch.</span><span class="sxs-lookup"><span data-stu-id="0b773-254">Run all actions required by each Batch task.</span></span>
* <span data-ttu-id="0b773-255">Salvare l'output di un'attività toopersistent archiviazione.</span><span class="sxs-lookup"><span data-stu-id="0b773-255">Save task outputs toopersistent storage.</span></span>

<span data-ttu-id="0b773-256">Anche se un processore di attività non è necessario toorun attività nel Batch, hello dei principali vantaggi dell'utilizzo di un processore di attività è che fornisce un wrapper tooimplement tutte le azioni di esecuzione di attività in un'unica posizione.</span><span class="sxs-lookup"><span data-stu-id="0b773-256">Although a task processor is not required toorun tasks on Batch, hello key advantage of using a task processor is that it provides a wrapper tooimplement all task execution actions in one location.</span></span> <span data-ttu-id="0b773-257">Ad esempio, se è necessario toorun diverse applicazioni nel contesto di hello di ogni attività o se è necessario toocopy archiviazione toopersistent dei dati dopo il completamento di ogni attività.</span><span class="sxs-lookup"><span data-stu-id="0b773-257">For example, if you need toorun several applications in hello context of each task, or if you need toocopy data toopersistent storage after completing each task.</span></span>

<span data-ttu-id="0b773-258">azioni Hello eseguite dal processore task hello possono essere semplice o complesso e il numero o minor, come richiesto dal carico di lavoro.</span><span class="sxs-lookup"><span data-stu-id="0b773-258">hello actions performed by hello task processor can be as simple or complex, and as many or as few, as required by your workload.</span></span> <span data-ttu-id="0b773-259">Inoltre, implementando tutte le azioni di attività in un processore di attività, è possibile facilmente aggiornare o aggiungere azioni in base ai requisiti di carico di lavoro o tooapplications le modifiche.</span><span class="sxs-lookup"><span data-stu-id="0b773-259">Additionally, by implementing all task actions into one task processor, you can readily update or add actions based on changes tooapplications or workload requirements.</span></span> <span data-ttu-id="0b773-260">Tuttavia, in alcuni casi un processore di attività potrebbe non essere hello ottimale soluzione per l'implementazione come è possibile aggiungere un'inutile complessità, ad esempio quando si esegue i processi che è possibile avviare rapidamente da una semplice riga di comando.</span><span class="sxs-lookup"><span data-stu-id="0b773-260">However, in some cases a task processor might not be hello optimal solution for your implementation as it can add unnecessary complexity, for example when running jobs that can be quickly started from a simple command line.</span></span>

### <a name="create-a-task-processor-using-hello-template"></a><span data-ttu-id="0b773-261">Creare un processore di attività utilizzando il modello di hello</span><span class="sxs-lookup"><span data-stu-id="0b773-261">Create a Task Processor using hello template</span></span>
<span data-ttu-id="0b773-262">tooadd una soluzione di toohello processore attività creata in precedenza, seguire questi passaggi:</span><span class="sxs-lookup"><span data-stu-id="0b773-262">tooadd a task processor toohello solution that you created earlier, follow these steps:</span></span>

1. <span data-ttu-id="0b773-263">Aprire la soluzione esistente in Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="0b773-263">Open your existing solution in Visual Studio.</span></span>
2. <span data-ttu-id="0b773-264">In Esplora soluzioni, Esplora hello pulsante destro del mouse, fare clic su **Aggiungi**, quindi fare clic su **nuovo progetto**.</span><span class="sxs-lookup"><span data-stu-id="0b773-264">In Solution Explorer, right-click hello solution, click **Add**, and then click **New Project**.</span></span>
3. <span data-ttu-id="0b773-265">In **Visual C#** fare clic su **Cloud** e su **Azure Batch Task Processor** (Elaboratore di attività di Azure Batch).</span><span class="sxs-lookup"><span data-stu-id="0b773-265">Under **Visual C#**, click **Cloud**, and then click **Azure Batch Task Processor**.</span></span>
4. <span data-ttu-id="0b773-266">Digitare un nome che descrive l'applicazione e identifica il progetto come hello (ad esempio, il processore di attività "ElaboratoreAttivitàLitware".</span><span class="sxs-lookup"><span data-stu-id="0b773-266">Type a name that describes your application and identifies this project as hello task processor (e.g. "LitwareTaskProcessor").</span></span>
5. <span data-ttu-id="0b773-267">progetto hello toocreate, fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="0b773-267">toocreate hello project, click **OK**.</span></span>
6. <span data-ttu-id="0b773-268">Infine, compilazione hello progetto tooforce Visual Studio tooload tutti i pacchetti NuGet a cui viene fatto riferimento e tooverify che hello progetto sia valido prima di iniziare la modifica.</span><span class="sxs-lookup"><span data-stu-id="0b773-268">Finally, build hello project tooforce Visual Studio tooload all referenced NuGet packages and tooverify that hello project is valid before you start modifying it.</span></span>

### <a name="task-processor-template-files-and-their-purpose"></a><span data-ttu-id="0b773-269">File del modello Task Processor (Elaboratore di attività) e relativo scopo</span><span class="sxs-lookup"><span data-stu-id="0b773-269">Task Processor template files and their purpose</span></span>
<span data-ttu-id="0b773-270">Quando si crea un progetto modello di processore attività hello, genera tre gruppi di file di codice:</span><span class="sxs-lookup"><span data-stu-id="0b773-270">When you create a project using hello task processor template, it generates three groups of code files:</span></span>

* <span data-ttu-id="0b773-271">file di programma principale Hello (Program.cs).</span><span class="sxs-lookup"><span data-stu-id="0b773-271">hello main program file (Program.cs).</span></span> <span data-ttu-id="0b773-272">Che contiene il punto di ingresso programma hello e la gestione delle eccezioni di livello superiore.</span><span class="sxs-lookup"><span data-stu-id="0b773-272">This contains hello program entry point and top-level exception handling.</span></span> <span data-ttu-id="0b773-273">Non deve in genere necessario toomodify.</span><span class="sxs-lookup"><span data-stu-id="0b773-273">You shouldn't normally need toomodify this.</span></span>
* <span data-ttu-id="0b773-274">directory del Framework Hello.</span><span class="sxs-lookup"><span data-stu-id="0b773-274">hello Framework directory.</span></span> <span data-ttu-id="0b773-275">Contiene file hello responsabili di lavoro 'standard' hello eseguita dal programma di gestione processo hello: installazione del pacchetto di parametri, aggiunta di processo Batch toohello di attività e così via. Non deve in genere toomodify i file necessari.</span><span class="sxs-lookup"><span data-stu-id="0b773-275">This contains hello files responsible for hello 'boilerplate' work done by hello job manager program – unpacking parameters, adding tasks toohello Batch job, etc. You shouldn't normally need toomodify these files.</span></span>
* <span data-ttu-id="0b773-276">file del processore Hello attività (TaskProcessor.cs).</span><span class="sxs-lookup"><span data-stu-id="0b773-276">hello task processor file (TaskProcessor.cs).</span></span> <span data-ttu-id="0b773-277">Si tratta in cui si inserirà la logica specifica dell'applicazione per l'esecuzione di un'attività (in genere da una chiamata in uscita eseguibile esistente tooan).</span><span class="sxs-lookup"><span data-stu-id="0b773-277">This is where you will put your application-specific logic for executing a task (typically by calling out tooan existing executable).</span></span> <span data-ttu-id="0b773-278">Anche il codice di pre-elaborazione e post-elaborazione, ad esempio per il download di dati aggiuntivi o il caricamento dei file dei risultati, viene inserito qui.</span><span class="sxs-lookup"><span data-stu-id="0b773-278">Pre- and post-processing code, such as downloading additional data or uploading result files, also goes here.</span></span>

<span data-ttu-id="0b773-279">Naturalmente è possibile aggiungere ulteriori file come toosupport richiesto il codice di attività del processore, a seconda della complessità hello del processo di hello suddivisione logica.</span><span class="sxs-lookup"><span data-stu-id="0b773-279">Of course you can add additional files as required toosupport your task processor code, depending on hello complexity of hello job splitting logic.</span></span>

<span data-ttu-id="0b773-280">modello di Hello genera anche i file di progetto .NET standard, ad esempio un file con estensione csproj app. config, Packages, e così via.</span><span class="sxs-lookup"><span data-stu-id="0b773-280">hello template also generates standard .NET project files such as a .csproj file, app.config, packages.config, etc.</span></span>

<span data-ttu-id="0b773-281">resto Hello di questa sezione vengono descritti diversi file hello e la relativa struttura di codice e le operazioni eseguite da ogni classe.</span><span class="sxs-lookup"><span data-stu-id="0b773-281">hello rest of this section describes hello different files and their code structure, and explains what each class does.</span></span>

![Esplora soluzioni Visual Studio con una soluzione di modello attività processore hello][solution_explorer02]

<span data-ttu-id="0b773-283">**File di Framework**</span><span class="sxs-lookup"><span data-stu-id="0b773-283">**Framework files**</span></span>

* <span data-ttu-id="0b773-284">`Configuration.cs`: Incapsula il caricamento di hello processo dati di configurazione, ad esempio i dettagli dell'account Batch, le credenziali dell'account di archiviazione collegati, informazioni di processo e attività e i parametri del processo.</span><span class="sxs-lookup"><span data-stu-id="0b773-284">`Configuration.cs`: Encapsulates hello loading of job configuration data such as Batch account details, linked storage account credentials, job and task information, and job parameters.</span></span> <span data-ttu-id="0b773-285">Fornisce inoltre l'accesso delle variabili di ambiente definita tooBatch (vedere le impostazioni di ambiente per le attività, nella documentazione di Batch hello) tramite la classe Configuration.EnvironmentVariable hello.</span><span class="sxs-lookup"><span data-stu-id="0b773-285">It also provides access tooBatch-defined environment variables (see Environment settings for tasks, in hello Batch documentation) via hello Configuration.EnvironmentVariable class.</span></span>
* <span data-ttu-id="0b773-286">`IConfiguration.cs`: Riassunto hello implementazione della classe di configurazione di hello, in modo che sia possibile unit test divisione del processo utilizzando un oggetto di configurazione fittizi o.</span><span class="sxs-lookup"><span data-stu-id="0b773-286">`IConfiguration.cs`: Abstracts hello implementation of hello Configuration class, so that you can unit test your job splitter using a fake or mock configuration object.</span></span>
* <span data-ttu-id="0b773-287">`TaskProcessorException.cs`: Rappresenta un errore che richiede hello processo manager tooterminate.</span><span class="sxs-lookup"><span data-stu-id="0b773-287">`TaskProcessorException.cs`: Represents an error that requires hello job manager tooterminate.</span></span> <span data-ttu-id="0b773-288">TaskProcessorException è usato toowrap 'previsto' errori in cui le informazioni di diagnostica specifiche possono essere fornite come parte della terminazione.</span><span class="sxs-lookup"><span data-stu-id="0b773-288">TaskProcessorException is used toowrap 'expected' errors where specific diagnostic information can be provided as part of termination.</span></span>

<span data-ttu-id="0b773-289">**Elaboratore di attività**</span><span class="sxs-lookup"><span data-stu-id="0b773-289">**Task Processor**</span></span>

* <span data-ttu-id="0b773-290">`TaskProcessor.cs`: Esegue l'attività di hello.</span><span class="sxs-lookup"><span data-stu-id="0b773-290">`TaskProcessor.cs`: Runs hello task.</span></span> <span data-ttu-id="0b773-291">framework Hello richiama il metodo TaskProcessor.Run hello.</span><span class="sxs-lookup"><span data-stu-id="0b773-291">hello framework invokes hello TaskProcessor.Run method.</span></span> <span data-ttu-id="0b773-292">Si tratta di classe hello in cui si inserirà logica specifica dell'applicazione hello dell'attività.</span><span class="sxs-lookup"><span data-stu-id="0b773-292">This is hello class where you will inject hello application-specific logic of your task.</span></span> <span data-ttu-id="0b773-293">Implementare il metodo Run hello per:</span><span class="sxs-lookup"><span data-stu-id="0b773-293">Implement hello Run method to:</span></span>
  * <span data-ttu-id="0b773-294">Analizzare e convalidare i parametri delle attività</span><span class="sxs-lookup"><span data-stu-id="0b773-294">Parse and validate any task parameters</span></span>
  * <span data-ttu-id="0b773-295">Comporre hello della riga di comando per qualsiasi programma esterno, si desidera tooinvoke</span><span class="sxs-lookup"><span data-stu-id="0b773-295">Compose hello command line for any external program you want tooinvoke</span></span>
  * <span data-ttu-id="0b773-296">Registrare le informazioni di diagnostica che potrebbero essere necessarie a scopo di debug</span><span class="sxs-lookup"><span data-stu-id="0b773-296">Log any diagnostic information you may require for debugging purposes</span></span>
  * <span data-ttu-id="0b773-297">Avviare un processo usando tale riga di comando</span><span class="sxs-lookup"><span data-stu-id="0b773-297">Start a process using that command line</span></span>
  * <span data-ttu-id="0b773-298">Attendere hello processo tooexit</span><span class="sxs-lookup"><span data-stu-id="0b773-298">Wait for hello process tooexit</span></span>
  * <span data-ttu-id="0b773-299">Acquisire il codice di uscita hello di hello processo toodetermine se ha avuto esito positivo o non è riuscita</span><span class="sxs-lookup"><span data-stu-id="0b773-299">Capture hello exit code of hello process toodetermine if it succeeded or failed</span></span>
  * <span data-ttu-id="0b773-300">Salvare i file di output desiderato tookeep toopersistent archiviazione</span><span class="sxs-lookup"><span data-stu-id="0b773-300">Save any output files you want tookeep toopersistent storage</span></span>

<span data-ttu-id="0b773-301">**File di progetto della riga di comando .NET standard**</span><span class="sxs-lookup"><span data-stu-id="0b773-301">**Standard .NET command line project files**</span></span>

* <span data-ttu-id="0b773-302">`App.config`: file di configurazione dell'applicazione .NET standard.</span><span class="sxs-lookup"><span data-stu-id="0b773-302">`App.config`: Standard .NET application configuration file.</span></span>
* <span data-ttu-id="0b773-303">`Packages.config`: file di dipendenza del pacchetto NuGet standard.</span><span class="sxs-lookup"><span data-stu-id="0b773-303">`Packages.config`: Standard NuGet package dependency file.</span></span>
* <span data-ttu-id="0b773-304">`Program.cs`: Contiene il punto di ingresso programma hello e la gestione delle eccezioni di livello superiore.</span><span class="sxs-lookup"><span data-stu-id="0b773-304">`Program.cs`: Contains hello program entry point and top-level exception handling.</span></span>

## <a name="implementing-hello-task-processor"></a><span data-ttu-id="0b773-305">Implementazione del processore attività hello</span><span class="sxs-lookup"><span data-stu-id="0b773-305">Implementing hello task processor</span></span>
<span data-ttu-id="0b773-306">Quando si apre il progetto di modello di hello processore Task, progetto hello avrà file TaskProcessor.cs hello aperta per impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="0b773-306">When you open hello Task Processor template project, hello project will have hello TaskProcessor.cs file open by default.</span></span> <span data-ttu-id="0b773-307">È possibile implementare la logica di eseguire hello per le attività di hello nel carico di lavoro con metodo Run () hello illustrato di seguito:</span><span class="sxs-lookup"><span data-stu-id="0b773-307">You can implement hello run logic for hello tasks in your workload by using hello Run() method shown below:</span></span>

```csharp
/// <summary>
/// Runs hello task processing logic. This is where you inject
/// your application-specific logic for decomposing hello job into tasks.
///
/// hello task processor framework invokes hello Run method for you; you need
/// only tooimplement it, not toocall it yourself. Typically, your
/// implementation will execute an external program (from resource files or
/// an application package), check hello exit code of that program and
/// save output files toopersistent storage.
/// </summary>
public async Task<int> Run()

{
    try
    {
        //Your code for hello task processor goes here.
        var command = $"compare {_parameters["Frame1"]} {_parameters["Frame2"]} compare.gif";
        using (var process = Process.Start($"cmd /c {command}"))
        {
            process.WaitForExit();
            var taskOutputStorage = new TaskOutputStorage(
            _configuration.StorageAccount,
            _configuration.JobId,
            _configuration.TaskId
            );
            await taskOutputStorage.SaveAsync(
            TaskOutputKind.TaskOutput,
            @"..\stdout.txt",
            @"stdout.txt"
            );
            return process.ExitCode;
        }
    }
    catch (Exception ex)
    {
        throw new TaskProcessorException(
        $"{ex.GetType().Name} exception in run task processor: {ex.Message}",
        ex
        );
    }
}
```
> [!NOTE]
> <span data-ttu-id="0b773-308">Hello annotato nel hello metodo Run () è hello solo sezione di codice del modello attività processore hello destinato si toomodify mediante l'aggiunta di logica eseguire hello per le attività di hello nel carico di lavoro.</span><span class="sxs-lookup"><span data-stu-id="0b773-308">hello annotated section in hello Run() method is hello only section of hello Task Processor template code that is intended for you toomodify by adding hello run logic for hello tasks in your workload.</span></span> <span data-ttu-id="0b773-309">Se si desidera toomodify un'altra sezione del modello di hello,. prima di tutto acquisire familiarità con la modalità Batch funziona esaminare la documentazione di Batch hello e provare alcuni degli esempi di codice hello Batch.</span><span class="sxs-lookup"><span data-stu-id="0b773-309">If you want toomodify a different section of hello template, please first familiarize yourself with how Batch works by reviewing hello Batch documentation and trying out a few of hello Batch code samples.</span></span>
> 
> 

<span data-ttu-id="0b773-310">Hello metodo Run () è responsabile dell'avvio della riga di comando hello, avvio di uno o più processi, in attesa di toocomplete processo tutti, salvataggio dei risultati di hello e infine restituzione con un codice di uscita.</span><span class="sxs-lookup"><span data-stu-id="0b773-310">hello Run() method is responsible for launching hello command line, starting one or more processes, waiting for all process toocomplete, saving hello results, and finally returning with an exit code.</span></span> <span data-ttu-id="0b773-311">Hello metodo Run () è in cui viene implementata hello logica per le attività di elaborazione.</span><span class="sxs-lookup"><span data-stu-id="0b773-311">hello Run() method is where you implement hello processing logic for your tasks.</span></span> <span data-ttu-id="0b773-312">framework processore delle attività Hello Richiama metodo Run () hello. non è necessario toocall è manualmente.</span><span class="sxs-lookup"><span data-stu-id="0b773-312">hello task processor framework invokes hello Run() method for you; you do not need toocall it yourself.</span></span>

<span data-ttu-id="0b773-313">L'implementazione di Run() ha accesso a:</span><span class="sxs-lookup"><span data-stu-id="0b773-313">Your Run() implementation has access to:</span></span>

* <span data-ttu-id="0b773-314">i parametri di attività, tramite hello Hello `_parameters` campo.</span><span class="sxs-lookup"><span data-stu-id="0b773-314">hello task parameters, via hello `_parameters` field.</span></span>
* <span data-ttu-id="0b773-315">ID attività e processi, tramite hello Hello `_jobId` e `_taskId` campi.</span><span class="sxs-lookup"><span data-stu-id="0b773-315">hello job and task ids, via hello `_jobId` and `_taskId` fields.</span></span>
* <span data-ttu-id="0b773-316">configurazione dell'attività Hello, tramite hello `_configuration` campo.</span><span class="sxs-lookup"><span data-stu-id="0b773-316">hello task configuration, via hello `_configuration` field.</span></span>

<span data-ttu-id="0b773-317">**Errore dell'attività**</span><span class="sxs-lookup"><span data-stu-id="0b773-317">**Task failure**</span></span>

<span data-ttu-id="0b773-318">In caso di errore, è possibile uscire dal metodo Run () hello generando un'eccezione, ma in questo modo, il gestore di eccezioni di livello superiore di hello nel controllo del codice di uscita attività hello.</span><span class="sxs-lookup"><span data-stu-id="0b773-318">In case of failure, you can exit hello Run() method by throwing an exception, but this leaves hello top level exception handler in control of hello task exit code.</span></span> <span data-ttu-id="0b773-319">Se è necessario codice di uscita toocontrol hello in modo che sia possibile distinguere i diversi tipi di errore, ad esempio per motivi di diagnostica o perché alcune modalità di errore deve terminare processi hello e altri utenti non dovrebbero, quindi è necessario uscire metodo Run () hello restituendo un codice di uscita diverso da zero.</span><span class="sxs-lookup"><span data-stu-id="0b773-319">If you need toocontrol hello exit code so that you can distinguish different types of failure, for example for diagnostic purposes or because some failure modes should terminate hello job and others should not, then you should exit hello Run() method by returning a non-zero exit code.</span></span> <span data-ttu-id="0b773-320">Questo valore diventa codice di uscita attività hello.</span><span class="sxs-lookup"><span data-stu-id="0b773-320">This becomes hello task exit code.</span></span>

### <a name="exit-codes-and-exceptions-in-hello-task-processor-template"></a><span data-ttu-id="0b773-321">Uscire da codici e le eccezioni nel modello di attività processore hello</span><span class="sxs-lookup"><span data-stu-id="0b773-321">Exit codes and exceptions in hello Task Processor template</span></span>
<span data-ttu-id="0b773-322">Codici di uscita e le eccezioni forniscono un meccanismo toodetermine hello risultato esegue un programma e consentono di identificare eventuali problemi con l'esecuzione di hello del programma hello.</span><span class="sxs-lookup"><span data-stu-id="0b773-322">Exit codes and exceptions provide a mechanism toodetermine hello outcome of running a program, and they can help identify any problems with hello execution of hello program.</span></span> <span data-ttu-id="0b773-323">modello di attività processore Hello implementa i codici di uscita hello e le eccezioni descritte in questa sezione.</span><span class="sxs-lookup"><span data-stu-id="0b773-323">hello Task Processor template implements hello exit codes and exceptions described in this section.</span></span>

<span data-ttu-id="0b773-324">Un'attività del processore attività che viene implementata con modello di attività processore hello può restituire tre codici di uscita possibili:</span><span class="sxs-lookup"><span data-stu-id="0b773-324">A task processor task that is implemented with hello Task Processor template can return three possible exit codes:</span></span>

| <span data-ttu-id="0b773-325">Codice</span><span class="sxs-lookup"><span data-stu-id="0b773-325">Code</span></span> | <span data-ttu-id="0b773-326">Descrizione</span><span class="sxs-lookup"><span data-stu-id="0b773-326">Description</span></span> |
| --- | --- |
| <span data-ttu-id="0b773-327">[Process.ExitCode][process_exitcode]</span><span class="sxs-lookup"><span data-stu-id="0b773-327">[Process.ExitCode][process_exitcode]</span></span> |<span data-ttu-id="0b773-328">processore task Hello eseguito toocompletion.</span><span class="sxs-lookup"><span data-stu-id="0b773-328">hello task processor ran toocompletion.</span></span> <span data-ttu-id="0b773-329">Si noti che ciò non implica tale programma hello che è stata completata, solo hello attività processore ha eseguito correttamente ed eseguita post-elaborazione senza eccezioni.</span><span class="sxs-lookup"><span data-stu-id="0b773-329">Note that this does not imply that hello program you invoked was successful – only that hello task processor invoked it successfully and performed any post-processing without exceptions.</span></span> <span data-ttu-id="0b773-330">Hello significato del codice di uscita hello dipende dal programma richiamato hello – codice di uscita 0 significa in genere programma hello ha avuto esito positivo e qualsiasi altro codice di uscita significa hello programma non è riuscito.</span><span class="sxs-lookup"><span data-stu-id="0b773-330">hello meaning of hello exit code depends on hello invoked program – typically exit code 0 means hello program succeeded and any other exit code means hello program failed.</span></span> |
| <span data-ttu-id="0b773-331">1</span><span class="sxs-lookup"><span data-stu-id="0b773-331">1</span></span> |<span data-ttu-id="0b773-332">processore task Hello non riuscita con un'eccezione in una parte del programma hello 'prevista'.</span><span class="sxs-lookup"><span data-stu-id="0b773-332">hello task processor failed with an exception in an 'expected' part of hello program.</span></span> <span data-ttu-id="0b773-333">Hello eccezione è stata tradotta tooa `TaskProcessorException` con informazioni di diagnostica e, se possibile, suggerimenti per la risoluzione hello errore.</span><span class="sxs-lookup"><span data-stu-id="0b773-333">hello exception was translated tooa `TaskProcessorException` with diagnostic information and, where possible, suggestions for resolving hello failure.</span></span> |
| <span data-ttu-id="0b773-334">2</span><span class="sxs-lookup"><span data-stu-id="0b773-334">2</span></span> |<span data-ttu-id="0b773-335">processore task Hello non riuscito con eccezione 'imprevista'.</span><span class="sxs-lookup"><span data-stu-id="0b773-335">hello task processor failed with an 'unexpected' exception.</span></span> <span data-ttu-id="0b773-336">Hello eccezione era registrati toostandard output, ma processore task hello tooadd Impossibile le informazioni di diagnostica o di monitoraggio e aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="0b773-336">hello exception was logged toostandard output, but hello task processor was unable tooadd any additional diagnostic or remediation information.</span></span> |

> [!NOTE]
> <span data-ttu-id="0b773-337">Se il programma di hello che richiami utilizza modalità di errore specifico di uscita codici 1 e 2 tooindicate, quindi utilizzare i codici di uscita 1 e 2 per gli errori delle attività del processore è ambiguo.</span><span class="sxs-lookup"><span data-stu-id="0b773-337">If hello program you invoke uses exit codes 1 and 2 tooindicate specific failure modes, then using exit codes 1 and 2 for task processor errors is ambiguous.</span></span> <span data-ttu-id="0b773-338">È possibile modificare questi codici di uscita attività processore errore codici toodistinctive modificando i casi di eccezione hello nel file Program.cs hello.</span><span class="sxs-lookup"><span data-stu-id="0b773-338">You can change these task processor error codes toodistinctive exit codes by editing hello exception cases in hello Program.cs file.</span></span>
> 
> 

<span data-ttu-id="0b773-339">Tutte le informazioni restituite da eccezioni hello vengono scritti nel file stdout.txt e stderr.txt.</span><span class="sxs-lookup"><span data-stu-id="0b773-339">All hello information returned by exceptions is written into stdout.txt and stderr.txt files.</span></span> <span data-ttu-id="0b773-340">Per ulteriori informazioni, vedere Gestione di errori, nella documentazione di Batch hello.</span><span class="sxs-lookup"><span data-stu-id="0b773-340">For more information, see Error Handling, in hello Batch documentation.</span></span>

### <a name="client-considerations"></a><span data-ttu-id="0b773-341">Considerazioni sul client</span><span class="sxs-lookup"><span data-stu-id="0b773-341">Client considerations</span></span>
<span data-ttu-id="0b773-342">**Credenziali di archiviazione**</span><span class="sxs-lookup"><span data-stu-id="0b773-342">**Storage credentials**</span></span>

<span data-ttu-id="0b773-343">Se il processore di attività Usa l'output di toopersist archiviazione blob di Azure, ad esempio l'utilizzo della libreria helper di convenzioni file hello, quindi è richiesto l'accesso troppo*entrambi* hello le credenziali dell'account di archiviazione cloud *o* URL del contenitore blob che include una firma di accesso condiviso (SAS).</span><span class="sxs-lookup"><span data-stu-id="0b773-343">If your task processor uses Azure blob storage toopersist outputs, for example using hello file conventions helper library, then it needs access too*either* hello cloud storage account credentials *or* a blob container URL that includes a shared access signature (SAS).</span></span> <span data-ttu-id="0b773-344">modello Hello include il supporto per fornire le credenziali tramite variabili di ambiente comuni.</span><span class="sxs-lookup"><span data-stu-id="0b773-344">hello template includes support for providing credentials via common environment variables.</span></span> <span data-ttu-id="0b773-345">Il client può passare le credenziali di archiviazione hello come indicato di seguito:</span><span class="sxs-lookup"><span data-stu-id="0b773-345">Your client can pass hello storage credentials as follows:</span></span>

```csharp
job.CommonEnvironmentSettings = new [] {
    new EnvironmentSetting("LINKED_STORAGE_ACCOUNT", "{storageAccountName}"),
    new EnvironmentSetting("LINKED_STORAGE_KEY", "{storageAccountKey}"),
};
```

<span data-ttu-id="0b773-346">account di archiviazione Hello diventa quindi disponibile nella classe TaskProcessor tramite hello hello `_configuration.StorageAccount` proprietà.</span><span class="sxs-lookup"><span data-stu-id="0b773-346">hello storage account is then available in hello TaskProcessor class via hello `_configuration.StorageAccount` property.</span></span>

<span data-ttu-id="0b773-347">Se si preferisce toouse un URL del contenitore con firma di accesso condiviso, è anche possibile passare questo tramite un'impostazione di ambiente comuni di processo, ma modello attività hello attualmente non include supporto incorporato per questo.</span><span class="sxs-lookup"><span data-stu-id="0b773-347">If you prefer toouse a container URL with SAS, you can also pass this via an job common environment setting, but hello task processor template does not currently include built-in support for this.</span></span>

<span data-ttu-id="0b773-348">**Configurazione dell'archiviazione**</span><span class="sxs-lookup"><span data-stu-id="0b773-348">**Storage setup**</span></span>

<span data-ttu-id="0b773-349">È consigliabile hello client o del processo di Gestione attività creare tutti i contenitori necessari per le attività prima dell'aggiunta di hello attività toohello processo.</span><span class="sxs-lookup"><span data-stu-id="0b773-349">It is recommended that hello client or job manager task create any containers required by tasks before adding hello tasks toohello job.</span></span> <span data-ttu-id="0b773-350">Questo campo è obbligatorio che se si utilizza un URL del contenitore con firma di accesso condiviso, di conseguenza un URL non include autorizzazioni toocreate hello contenitore.</span><span class="sxs-lookup"><span data-stu-id="0b773-350">This is mandatory if you use a container URL with SAS, as such a URL does not include permission toocreate hello container.</span></span> <span data-ttu-id="0b773-351">Anche se si passa le credenziali dell'account di archiviazione, è consigliabile come Salva tutte le attività con toocall CloudBlobContainer.CreateIfNotExistsAsync nel contenitore hello.</span><span class="sxs-lookup"><span data-stu-id="0b773-351">It is recommended even if you pass storage account credentials, as it saves every task having toocall CloudBlobContainer.CreateIfNotExistsAsync on hello container.</span></span>

## <a name="pass-parameters-and-environment-variables"></a><span data-ttu-id="0b773-352">Passare i parametri e le variabili di ambiente</span><span class="sxs-lookup"><span data-stu-id="0b773-352">Pass parameters and environment variables</span></span>
### <a name="pass-environment-settings"></a><span data-ttu-id="0b773-353">Passare le impostazioni di ambiente</span><span class="sxs-lookup"><span data-stu-id="0b773-353">Pass environment settings</span></span>
<span data-ttu-id="0b773-354">Un client può passare l'attività del gestore processi toohello informazioni sotto forma di hello di impostazioni di ambiente.</span><span class="sxs-lookup"><span data-stu-id="0b773-354">A client can pass information toohello job manager task in hello form of environment settings.</span></span> <span data-ttu-id="0b773-355">Queste informazioni possono quindi utilizzabile da attività del gestore processi hello quando il processo di calcolo di generazione hello processore attività che verrà eseguita come parte di hello.</span><span class="sxs-lookup"><span data-stu-id="0b773-355">This information can then be used by hello job manager task when generating hello task processor tasks that will run as part of hello compute job.</span></span> <span data-ttu-id="0b773-356">Sono esempi di hello informazioni che è possibile passare alle impostazioni di ambiente:</span><span class="sxs-lookup"><span data-stu-id="0b773-356">Examples of hello information that you can pass as environment settings are:</span></span>

* <span data-ttu-id="0b773-357">Nome dell'account di archiviazione e chiavi dell'account</span><span class="sxs-lookup"><span data-stu-id="0b773-357">Storage account name and account keys</span></span>
* <span data-ttu-id="0b773-358">URL dell'account Batch</span><span class="sxs-lookup"><span data-stu-id="0b773-358">Batch account URL</span></span>
* <span data-ttu-id="0b773-359">Chiave dell'account Batch</span><span class="sxs-lookup"><span data-stu-id="0b773-359">Batch account key</span></span>

<span data-ttu-id="0b773-360">Hello servizio Batch è un'attività di gestione di un meccanismo semplice toopass ambiente impostazioni tooa processi utilizzando hello `EnvironmentSettings` proprietà [Microsoft.Azure.Batch.JobManagerTask][net_jobmanagertask].</span><span class="sxs-lookup"><span data-stu-id="0b773-360">hello Batch service has a simple mechanism toopass environment settings tooa job manager task by using hello `EnvironmentSettings` property in [Microsoft.Azure.Batch.JobManagerTask][net_jobmanagertask].</span></span>

<span data-ttu-id="0b773-361">Ad esempio, tooget hello `BatchClient` istanza per un account di Batch, è possibile passare come variabili di ambiente da client hello codice hello URL e credenziali di chiave per l'account Batch hello condivise.</span><span class="sxs-lookup"><span data-stu-id="0b773-361">For example, tooget hello `BatchClient` instance for a Batch account, you can pass as environment variables from hello client code hello URL and shared key credentials for hello Batch account.</span></span> <span data-ttu-id="0b773-362">Analogamente, account di archiviazione di hello tooaccess è collegato l'account Batch toohello, è possibile passare nome account di archiviazione hello e chiave dell'account di archiviazione hello come variabili di ambiente.</span><span class="sxs-lookup"><span data-stu-id="0b773-362">Likewise, tooaccess hello storage account that is linked toohello Batch account, you can pass hello storage account name and hello storage account key as environment variables.</span></span>

### <a name="pass-parameters-toohello-job-manager-template"></a><span data-ttu-id="0b773-363">Passare parametri toohello processo Gestione modello</span><span class="sxs-lookup"><span data-stu-id="0b773-363">Pass parameters toohello Job Manager template</span></span>
<span data-ttu-id="0b773-364">In molti casi, è utile toopass per processo parametri toohello processo Gestione attività, entrambi processo hello toocontrol suddivisione processo o attività hello tooconfigure per hello processo.</span><span class="sxs-lookup"><span data-stu-id="0b773-364">In many cases, it's useful toopass per-job parameters toohello job manager task, either toocontrol hello job splitting process or tooconfigure hello tasks for hello job.</span></span> <span data-ttu-id="0b773-365">È possibile farlo caricando un file JSON denominato parameters.json come file di risorse per attività di gestione di processi hello.</span><span class="sxs-lookup"><span data-stu-id="0b773-365">You can do this by uploading a JSON file named parameters.json as a resource file for hello job manager task.</span></span> <span data-ttu-id="0b773-366">i parametri di Hello possono poi diventare disponibili in hello `JobSplitter._parameters` campo nel modello di processo Manager hello.</span><span class="sxs-lookup"><span data-stu-id="0b773-366">hello parameters can then become available in hello `JobSplitter._parameters` field in hello Job Manager template.</span></span>

> [!NOTE]
> <span data-ttu-id="0b773-367">il gestore di parametri predefiniti di Hello supporta solo i dizionari per stringa-stringa.</span><span class="sxs-lookup"><span data-stu-id="0b773-367">hello built-in parameter handler supports only string-to-string dictionaries.</span></span> <span data-ttu-id="0b773-368">Se si desidera valori JSON complessi toopass come valori di parametro, verrà necessità toopass queste informazioni come stringhe e analizzarli nella barra di divisione processo hello o modifica del framework di hello `Configuration.GetJobParameters` metodo.</span><span class="sxs-lookup"><span data-stu-id="0b773-368">If you want toopass complex JSON values as parameter values, you will need toopass these as strings and parse them in hello job splitter, or modify hello framework's `Configuration.GetJobParameters` method.</span></span>
> 
> 

### <a name="pass-parameters-toohello-task-processor-template"></a><span data-ttu-id="0b773-369">Passare parametri toohello processore attività modello</span><span class="sxs-lookup"><span data-stu-id="0b773-369">Pass parameters toohello Task Processor template</span></span>
<span data-ttu-id="0b773-370">È inoltre possibile passare parametri attività tooindividual implementato utilizzando il modello di attività processore hello.</span><span class="sxs-lookup"><span data-stu-id="0b773-370">You can also pass parameters tooindividual tasks implemented using hello Task Processor template.</span></span> <span data-ttu-id="0b773-371">Proprio come con modello di gestione processo di hello, hello attività processore modello cerca un file di risorse denominato</span><span class="sxs-lookup"><span data-stu-id="0b773-371">Just as with hello job manager template, hello task processor template looks for a resource file named</span></span>

<span data-ttu-id="0b773-372">Parameters.JSON e se lo trova, viene caricato in formato dizionario di parametri hello.</span><span class="sxs-lookup"><span data-stu-id="0b773-372">parameters.json, and if found it loads it as hello parameters dictionary.</span></span> <span data-ttu-id="0b773-373">Sono disponibili due opzioni per la modalità toopass parametri toohello attività attività del processore:</span><span class="sxs-lookup"><span data-stu-id="0b773-373">There are a couple of options for how toopass parameters toohello task processor tasks:</span></span>

* <span data-ttu-id="0b773-374">Riutilizzare i parametri del processo hello JSON.</span><span class="sxs-lookup"><span data-stu-id="0b773-374">Reuse hello job parameters JSON.</span></span> <span data-ttu-id="0b773-375">Ciò funziona perfettamente se hello unici parametri sono quelli a livello di processo (ad esempio, un rendering altezza e larghezza).</span><span class="sxs-lookup"><span data-stu-id="0b773-375">This works well if hello only parameters are job-wide ones (for example, a render height and width).</span></span> <span data-ttu-id="0b773-376">toodo, quando si crea un CloudTask nella barra di divisione processo hello, aggiungere un oggetto file di risorse di riferimento toohello parameters.json da ResourceFiles hello processo Gestione attività (`JobSplitter._jobManagerTask.ResourceFiles`) insieme ResourceFiles del CloudTask toohello.</span><span class="sxs-lookup"><span data-stu-id="0b773-376">toodo this, when creating a CloudTask in hello job splitter, add a reference toohello parameters.json resource file object from hello job manager task's ResourceFiles (`JobSplitter._jobManagerTask.ResourceFiles`) toohello CloudTask's ResourceFiles collection.</span></span>
* <span data-ttu-id="0b773-377">Generare e caricare un documento parameters.json specifici dell'attività come parte dell'esecuzione del processo con separatore, fare riferimento a tale blob nella raccolta di file di risorse dell'attività hello.</span><span class="sxs-lookup"><span data-stu-id="0b773-377">Generate and upload a task-specific parameters.json document as part of job splitter execution, and reference that blob in hello task's resource files collection.</span></span> <span data-ttu-id="0b773-378">Ciò è necessario se i parametri sono diversi per ogni attività.</span><span class="sxs-lookup"><span data-stu-id="0b773-378">This is necessary if different tasks have different parameters.</span></span> <span data-ttu-id="0b773-379">Un esempio potrebbe essere uno scenario di rendering 3D in indice dei fotogrammi hello è toohello attività passata come parametro.</span><span class="sxs-lookup"><span data-stu-id="0b773-379">An example might be a 3D rendering scenario where hello frame index is passed toohello task as a parameter.</span></span>

> [!NOTE]
> <span data-ttu-id="0b773-380">il gestore di parametri predefiniti di Hello supporta solo i dizionari per stringa-stringa.</span><span class="sxs-lookup"><span data-stu-id="0b773-380">hello built-in parameter handler supports only string-to-string dictionaries.</span></span> <span data-ttu-id="0b773-381">Se si desidera valori JSON complessi toopass come valori di parametro, si verrà necessarie toopass come stringhe e analizzarli in processore task hello o modificare del framework hello `Configuration.GetTaskParameters` metodo.</span><span class="sxs-lookup"><span data-stu-id="0b773-381">If you want toopass complex JSON values as parameter values, you will need toopass these as strings and parse them in hello task processor, or modify hello framework's `Configuration.GetTaskParameters` method.</span></span>
> 
> 

## <a name="next-steps"></a><span data-ttu-id="0b773-382">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="0b773-382">Next steps</span></span>
### <a name="persist-job-and-task-output-tooazure-storage"></a><span data-ttu-id="0b773-383">Processo di persistenza e attività output tooAzure archiviazione</span><span class="sxs-lookup"><span data-stu-id="0b773-383">Persist job and task output tooAzure Storage</span></span>
<span data-ttu-id="0b773-384">Un altro strumento utile nello sviluppo di soluzioni Batch è [Azure Batch File Conventions][nuget_package].</span><span class="sxs-lookup"><span data-stu-id="0b773-384">Another helpful tool in Batch solution development is [Azure Batch File Conventions][nuget_package].</span></span> <span data-ttu-id="0b773-385">Utilizzare questa libreria di classi .NET (attualmente in anteprima) nell'archivio tooeasily applicazioni .NET per Batch e recuperare tooand output attività dall'archiviazione di Azure.</span><span class="sxs-lookup"><span data-stu-id="0b773-385">Use this .NET class library (currently in preview) in your Batch .NET applications tooeasily store and retrieve task outputs tooand from Azure Storage.</span></span> <span data-ttu-id="0b773-386">[Output di attività e processi Batch di Azure di mantenere](batch-task-output.md) contiene una descrizione completa della libreria hello e sul relativo utilizzo.</span><span class="sxs-lookup"><span data-stu-id="0b773-386">[Persist Azure Batch job and task output](batch-task-output.md) contains a full discussion of hello library and its usage.</span></span>

### <a name="batch-forum"></a><span data-ttu-id="0b773-387">Forum di Batch</span><span class="sxs-lookup"><span data-stu-id="0b773-387">Batch Forum</span></span>
<span data-ttu-id="0b773-388">Hello [Forum di Azure Batch] [ forum] su MSDN è un ottimo posizionare toodiscuss Batch e porre domande sul servizio hello.</span><span class="sxs-lookup"><span data-stu-id="0b773-388">hello [Azure Batch Forum][forum] on MSDN is a great place toodiscuss Batch and ask questions about hello service.</span></span> <span data-ttu-id="0b773-389">Leggere i post contrassegnati e inviare domande durante le procedure di sviluppo delle soluzioni Batch.</span><span class="sxs-lookup"><span data-stu-id="0b773-389">Head on over for helpful "sticky" posts, and post your questions as they arise while you build your Batch solutions.</span></span>

[forum]: https://social.msdn.microsoft.com/forums/azure/en-US/home?forum=azurebatch
[net_jobmanagertask]: https://msdn.microsoft.com/library/azure/microsoft.azure.batch.jobmanagertask.aspx
[github_samples]: https://github.com/Azure/azure-batch-samples
[nuget_package]: https://www.nuget.org/packages/Microsoft.Azure.Batch.Conventions.Files
[process_exitcode]: https://msdn.microsoft.com/library/system.diagnostics.process.exitcode.aspx
[vs_gallery]: https://visualstudiogallery.msdn.microsoft.com/
[vs_gallery_templates]: https://go.microsoft.com/fwlink/?linkid=820714
[vs_find_use_ext]: https://msdn.microsoft.com/library/dd293638.aspx

[diagram01]: ./media/batch-visual-studio-templates/diagram01.png
[solution_explorer01]: ./media/batch-visual-studio-templates/solution_explorer01.png
[solution_explorer02]: ./media/batch-visual-studio-templates/solution_explorer02.png
