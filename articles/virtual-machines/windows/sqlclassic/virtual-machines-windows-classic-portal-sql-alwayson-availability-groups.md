---
title: "Configurare un gruppo di disponibilità AlwaysOn in macchine virtuali di Azure (distribuzione classica) | Microsoft Docs"
description: "Creare un gruppo di disponibilità AlwaysOn con le macchine virtuali di Azure. Questa esercitazione usa principalmente l'interfaccia utente e gli strumenti invece dello scripting."
services: virtual-machines-windows
documentationcenter: na
author: MikeRayMSFT
manager: jhubbard
editor: 
tags: azure-service-management
ms.assetid: 8d48a3d2-79f8-4ab0-9327-2f30ee0b2ff1
ms.service: virtual-machines-sql
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: vm-windows-sql-server
ms.workload: iaas-sql-server
ms.date: 03/17/2017
ms.author: mikeray
ms.openlocfilehash: b360fe9f28eeb9b10c82fce729165b1b572ac3c6
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 07/11/2017
---
# <a name="configure-always-on-availability-group-in-azure-virtual-machines-classic"></a><span data-ttu-id="bfea1-104">Configurare un gruppo di disponibilità AlwaysOn in macchine virtuali di Azure (distribuzione classica)</span><span class="sxs-lookup"><span data-stu-id="bfea1-104">Configure Always On availability group in Azure Virtual Machines (classic)</span></span>
> [!div class="op_single_selector"]
> * [<span data-ttu-id="bfea1-105">Classica: interfaccia utente</span><span class="sxs-lookup"><span data-stu-id="bfea1-105">Classic: UI</span></span>](../classic/portal-sql-alwayson-availability-groups.md)
> * <span data-ttu-id="bfea1-106">[Classica: PowerShell](../classic/ps-sql-alwayson-availability-groups.md)
</span><span class="sxs-lookup"><span data-stu-id="bfea1-106">[Classic: PowerShell](../classic/ps-sql-alwayson-availability-groups.md)
</span></span><br/>

<span data-ttu-id="bfea1-107">Prima di iniziare, considerare che ora è possibile completare questa attività nel modello Azure Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="bfea1-107">Before you begin, consider that you can now complete this task in Azure Resource Manager model.</span></span> <span data-ttu-id="bfea1-108">Per le nuove distribuzioni è consigliabile usare il modello Azure Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="bfea1-108">We recommend Azure Resource Manager model for new deployments.</span></span> <span data-ttu-id="bfea1-109">Vedere [Panoramica sui gruppi di disponibilità AlwaysOn di SQL Server in macchine virtuali di Azure](../sql/virtual-machines-windows-portal-sql-availability-group-overview.md).</span><span class="sxs-lookup"><span data-stu-id="bfea1-109">See [SQL Server Always On availability groups on Azure virtual machines](../sql/virtual-machines-windows-portal-sql-availability-group-overview.md).</span></span>

> [!IMPORTANT] 
> <span data-ttu-id="bfea1-110">Microsoft consiglia di usare il modello di Gestione risorse per le distribuzioni più recenti.</span><span class="sxs-lookup"><span data-stu-id="bfea1-110">Microsoft recommends that most new deployments use the Resource Manager model.</span></span> <span data-ttu-id="bfea1-111">Azure offre due diversi modelli di distribuzione per creare e usare le risorse, ovvero [Resource Manager e la distribuzione classica](../../../azure-resource-manager/resource-manager-deployment-model.md).</span><span class="sxs-lookup"><span data-stu-id="bfea1-111">Azure has two different deployment models to create and work with resources: [Resource Manager and classic](../../../azure-resource-manager/resource-manager-deployment-model.md).</span></span> <span data-ttu-id="bfea1-112">Questo articolo illustra come usare il modello di distribuzione classico.</span><span class="sxs-lookup"><span data-stu-id="bfea1-112">This article explains how to use the classic deployment model.</span></span> 

<span data-ttu-id="bfea1-113">Per completare questa attività con il modello Azure Resource Manager, vedere [Panoramica sui gruppi di disponibilità AlwaysOn di SQL Server in macchine virtuali di Azure](../sql/virtual-machines-windows-portal-sql-availability-group-overview.md).</span><span class="sxs-lookup"><span data-stu-id="bfea1-113">To complete this task with the Azure Resource Manager model, see [SQL Server Always On availability groups on Azure virtual machines](../sql/virtual-machines-windows-portal-sql-availability-group-overview.md).</span></span>

<span data-ttu-id="bfea1-114">Questa esercitazione end-to-end illustra come implementare i gruppi di disponibilità tramite SQL Server AlwaysOn in esecuzione in macchine virtuali di Azure.</span><span class="sxs-lookup"><span data-stu-id="bfea1-114">This end-to-end tutorial shows you how to implement availability groups by using SQL Server Always On running on Azure Virtual Machines.</span></span>

<span data-ttu-id="bfea1-115">Al termine dell'esercitazione la soluzione SQL Server AlwaysOn in Azure sarà composta dagli elementi seguenti:</span><span class="sxs-lookup"><span data-stu-id="bfea1-115">At the end of the tutorial, your SQL Server Always On solution in Azure will consist of the following elements:</span></span>

* <span data-ttu-id="bfea1-116">Una rete virtuale contenente più subnet, tra cui una subnet front-end e una back-end</span><span class="sxs-lookup"><span data-stu-id="bfea1-116">A virtual network that contains multiple subnets and includes a frontend and a backend subnet</span></span>
* <span data-ttu-id="bfea1-117">Un controller di dominio con un dominio di Active Directory (Azure AD)</span><span class="sxs-lookup"><span data-stu-id="bfea1-117">A domain controller with an Active Directory (Azure AD) domain</span></span>
* <span data-ttu-id="bfea1-118">Due macchine virtuali che eseguono SQL Server e che sono distribuite alla subnet back-end e aggiunte al dominio di Azure AD</span><span class="sxs-lookup"><span data-stu-id="bfea1-118">Two virtual machines that run SQL Server and are deployed to the backend subnet and joined to the Azure AD domain</span></span>
* <span data-ttu-id="bfea1-119">Un cluster di failover a tre nodi con il modello di quorum Maggioranza dei nodi</span><span class="sxs-lookup"><span data-stu-id="bfea1-119">A three-node failover cluster with the Node Majority quorum model</span></span>
* <span data-ttu-id="bfea1-120">Un gruppo di disponibilità che ha due repliche di commit sincrono di un database di disponibilità</span><span class="sxs-lookup"><span data-stu-id="bfea1-120">An availability group that has two synchronous-commit replicas of an availability database</span></span>

<span data-ttu-id="bfea1-121">La figura seguente è una rappresentazione grafica della soluzione.</span><span class="sxs-lookup"><span data-stu-id="bfea1-121">The following illustration is a graphical representation of the solution.</span></span>

![Architettura di lab di test per gruppi di disponibilità in Azure](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC791912.png)

<span data-ttu-id="bfea1-123">Si tratta di una possibile configurazione.</span><span class="sxs-lookup"><span data-stu-id="bfea1-123">Note that this is one possible configuration.</span></span> <span data-ttu-id="bfea1-124">È possibile, ad esempio, ridurre il numero di macchine virtuali per un gruppo di disponibilità con due repliche</span><span class="sxs-lookup"><span data-stu-id="bfea1-124">For example, you can minimize the number of virtual machines for a two-replica availability group.</span></span> <span data-ttu-id="bfea1-125">al fine di risparmiare ore di calcolo in Azure usando il controller di dominio come condivisione file di controllo del quorum in un cluster a 2 nodi.</span><span class="sxs-lookup"><span data-stu-id="bfea1-125">This configuration saves on compute hours in Azure by using the domain controller as the quorum file share witness in a two-node cluster.</span></span> <span data-ttu-id="bfea1-126">Questo metodo consente di ridurre di un'unità il numero di macchine virtuali rispetto alla configurazione precedente.</span><span class="sxs-lookup"><span data-stu-id="bfea1-126">This method reduces the virtual machine count by one from the illustrated configuration.</span></span>

<span data-ttu-id="bfea1-127">Nell’esercitazione si presuppongono le condizioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="bfea1-127">This tutorial assumes the following:</span></span>

* <span data-ttu-id="bfea1-128">Si dispone già di un account Azure.</span><span class="sxs-lookup"><span data-stu-id="bfea1-128">You already have an Azure account.</span></span>
* <span data-ttu-id="bfea1-129">La procedura per il provisioning di una macchina virtuale classica che esegue SQL Server dalla raccolta di macchine virtuali tramite l'interfaccia utente grafica è già nota.</span><span class="sxs-lookup"><span data-stu-id="bfea1-129">You already know how to use the GUI in the virtual machine gallery to provision a classic virtual machine that runs SQL Server.</span></span>
* <span data-ttu-id="bfea1-130">Si dispone già una conoscenza approfondita dei gruppi di disponibilità AlwaysOn.</span><span class="sxs-lookup"><span data-stu-id="bfea1-130">You already have a solid understanding of Always On availability groups.</span></span> <span data-ttu-id="bfea1-131">Per altre informazioni, vedere [Gruppi di disponibilità AlwaysOn (SQL Server)](https://msdn.microsoft.com/library/hh510230.aspx).</span><span class="sxs-lookup"><span data-stu-id="bfea1-131">For more information, see [Always On Availability Groups (SQL Server)](https://msdn.microsoft.com/library/hh510230.aspx).</span></span>

> [!NOTE]
> <span data-ttu-id="bfea1-132">Se si è interessati all'uso di gruppi di disponibilità AlwaysOn con SharePoint, vedere anche [Configurare gruppi di disponibilità AlwaysOn di SQL Server 2012 per SharePoint 2013](https://technet.microsoft.com/library/jj715261.aspx).</span><span class="sxs-lookup"><span data-stu-id="bfea1-132">If you are interested in using Always On availability groups with SharePoint, also see [Configure SQL Server 2012 Always On Availability Groups for SharePoint 2013](https://technet.microsoft.com/library/jj715261.aspx).</span></span>
> 
> 

## <a name="create-the-virtual-network-and-domain-controller-server"></a><span data-ttu-id="bfea1-133">Creare la rete virtuale e il server del controller di dominio</span><span class="sxs-lookup"><span data-stu-id="bfea1-133">Create the virtual network and domain controller server</span></span>
<span data-ttu-id="bfea1-134">Si inizia con un nuovo account di prova di Azure.</span><span class="sxs-lookup"><span data-stu-id="bfea1-134">You begin with a new Azure trial account.</span></span> <span data-ttu-id="bfea1-135">Dopo la configurazione dell'account, viene visualizzata la schermata iniziale del portale di Azure classico.</span><span class="sxs-lookup"><span data-stu-id="bfea1-135">After you set up your account, you should be on the home screen of the Azure classic portal.</span></span>

1. <span data-ttu-id="bfea1-136">Fare clic sul pulsante **Nuovo** pulsante nell'angolo sinistro della parte inferiore della pagina, come illustrato nella schermata seguente.</span><span class="sxs-lookup"><span data-stu-id="bfea1-136">Click the **New** button at the left corner of the bottom of the page, as shown in the following screenshot.</span></span>
   
    ![Fare clic su Nuovo nel portale](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC665511.gif)
2. <span data-ttu-id="bfea1-138">Fare clic su **Servizi di rete** > **Rete virtuale** > **Creazione personalizzata**, come illustrata nella schermata seguente.</span><span class="sxs-lookup"><span data-stu-id="bfea1-138">Click **Network Services** > **Virtual Network** > **Custom Create**, as shown in the following screenshot.</span></span>
   
    ![Crea rete virtuale](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC665512.gif)
3. <span data-ttu-id="bfea1-140">Nella finestra di dialogo **CREA RETE VIRTUALE** creare una nuova rete virtuale avanzando nelle pagine e usando le impostazioni nella tabella seguente.</span><span class="sxs-lookup"><span data-stu-id="bfea1-140">In the **CREATE A VIRTUAL NETWORK** dialog box, create a new virtual network by stepping through the pages and using the settings in the following table.</span></span> 
   
   | <span data-ttu-id="bfea1-141">Page</span><span class="sxs-lookup"><span data-stu-id="bfea1-141">Page</span></span> | <span data-ttu-id="bfea1-142">Impostazioni</span><span class="sxs-lookup"><span data-stu-id="bfea1-142">Settings</span></span> |
   | --- | --- |
   | <span data-ttu-id="bfea1-143">Dettagli della rete virtuale</span><span class="sxs-lookup"><span data-stu-id="bfea1-143">Virtual Network Details</span></span> |<span data-ttu-id="bfea1-144">**NOME = ContosoNET**</span><span class="sxs-lookup"><span data-stu-id="bfea1-144">**NAME = ContosoNET**</span></span><br/><span data-ttu-id="bfea1-145">**AREA = Stati Uniti occidentali**</span><span class="sxs-lookup"><span data-stu-id="bfea1-145">**REGION = West US**</span></span> |
   | <span data-ttu-id="bfea1-146">Server DNS e connettività VPN</span><span class="sxs-lookup"><span data-stu-id="bfea1-146">DNS Servers and VPN Connectivity</span></span> |<span data-ttu-id="bfea1-147">Nessuno</span><span class="sxs-lookup"><span data-stu-id="bfea1-147">None</span></span> |
   | <span data-ttu-id="bfea1-148">Spazi di indirizzi della rete virtuale</span><span class="sxs-lookup"><span data-stu-id="bfea1-148">Virtual Network Address Spaces</span></span> |<span data-ttu-id="bfea1-149">Le impostazioni vengono illustrate nella schermata seguente:</span><span class="sxs-lookup"><span data-stu-id="bfea1-149">Settings are shown in the following screenshot:</span></span> ![Crea rete virtuale](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC784620.png) |
4. <span data-ttu-id="bfea1-151">Creare la macchina virtuale che verrà usata come controller di dominio.</span><span class="sxs-lookup"><span data-stu-id="bfea1-151">Create the virtual machine that you will use as the domain controller (DC).</span></span> <span data-ttu-id="bfea1-152">Fare clic su **Nuovo** > **Calcola** > **Macchina virtuale** > **Da raccolta**, come illustrata nella schermata seguente.</span><span class="sxs-lookup"><span data-stu-id="bfea1-152">Click **New** > **Compute** > **Virtual Machine** > **From Gallery**, as shown in the following screenshot.</span></span>
   
    ![Creare una macchina virtuale](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC784621.png)
5. <span data-ttu-id="bfea1-154">Nella finestra di dialogo **CREA MACCHINA VIRTUALE** configurare una nuova macchina virtuale avanzando nelle pagine con le impostazioni seguenti.</span><span class="sxs-lookup"><span data-stu-id="bfea1-154">In the **CREATE A VIRTUAL MACHINE** dialog box, configure a new virtual machine by stepping through the pages and using the settings in the following table.</span></span> 
   
   | <span data-ttu-id="bfea1-155">Page</span><span class="sxs-lookup"><span data-stu-id="bfea1-155">Page</span></span> | <span data-ttu-id="bfea1-156">Impostazioni</span><span class="sxs-lookup"><span data-stu-id="bfea1-156">Settings</span></span> |
   | --- | --- |
   | <span data-ttu-id="bfea1-157">Selezionare il sistema operativo della macchina virtuale</span><span class="sxs-lookup"><span data-stu-id="bfea1-157">Select the virtual machine operating system</span></span> |<span data-ttu-id="bfea1-158">Windows Server 2012 R2 Datacenter</span><span class="sxs-lookup"><span data-stu-id="bfea1-158">Windows Server 2012 R2 Datacenter</span></span> |
   | <span data-ttu-id="bfea1-159">Configurazione macchina virtuale</span><span class="sxs-lookup"><span data-stu-id="bfea1-159">Virtual machine configuration</span></span> |<span data-ttu-id="bfea1-160">**DATA DI RILASCIO VERSIONE** = (più recente)</span><span class="sxs-lookup"><span data-stu-id="bfea1-160">**VERSION RELEASE DATE** = (latest)</span></span><br/><span data-ttu-id="bfea1-161">**NOME MACCHINA VIRTUALE** = ContosoDC</span><span class="sxs-lookup"><span data-stu-id="bfea1-161">**VIRTUAL MACHINE NAME** = ContosoDC</span></span><br/><span data-ttu-id="bfea1-162">**PIANO** = STANDARD</span><span class="sxs-lookup"><span data-stu-id="bfea1-162">**TIER** = STANDARD</span></span><br/><span data-ttu-id="bfea1-163">**DIMENSIONI** = A2 (2 core)</span><span class="sxs-lookup"><span data-stu-id="bfea1-163">**SIZE** = A2 (2 cores)</span></span><br/><span data-ttu-id="bfea1-164">**NUOVO NOME UTENTE** = AzureAdmin</span><span class="sxs-lookup"><span data-stu-id="bfea1-164">**NEW USER NAME** = AzureAdmin</span></span><br/><span data-ttu-id="bfea1-165">**NUOVA PASSWORD** = Contoso!000</span><span class="sxs-lookup"><span data-stu-id="bfea1-165">**NEW PASSWORD** = Contoso!000</span></span><br/><span data-ttu-id="bfea1-166">**CONFERMA** = Contoso!000</span><span class="sxs-lookup"><span data-stu-id="bfea1-166">**CONFIRM** = Contoso!000</span></span> |
   | <span data-ttu-id="bfea1-167">Configurazione macchina virtuale</span><span class="sxs-lookup"><span data-stu-id="bfea1-167">Virtual machine configuration</span></span> |<span data-ttu-id="bfea1-168">**SERVIZIO CLOUD** = creare un nuovo servizio cloud</span><span class="sxs-lookup"><span data-stu-id="bfea1-168">**CLOUD SERVICE** = Create a new cloud service</span></span><br/><span data-ttu-id="bfea1-169">**NOME DNS DEL SERVIZIO CLOUD** = nome univoco del servizio cloud</span><span class="sxs-lookup"><span data-stu-id="bfea1-169">**CLOUD SERVICE DNS NAME** = A unique cloud service name</span></span><br/><span data-ttu-id="bfea1-170">**NOME DNS** = nome univoco (ad esempio: ContosoDC123)</span><span class="sxs-lookup"><span data-stu-id="bfea1-170">**DNS NAME** = A unique name (ex: ContosoDC123)</span></span><br/><span data-ttu-id="bfea1-171">**AREA/GRUPPO DI AFFINITÀ/RETE VIRTUALE** = ContosoNET</span><span class="sxs-lookup"><span data-stu-id="bfea1-171">**REGION/AFFINITY GROUP/VIRTUAL NETWORK** = ContosoNET</span></span><br/><span data-ttu-id="bfea1-172">**SUNET RETE VIRTUALE** = Back(10.10.2.0/24)</span><span class="sxs-lookup"><span data-stu-id="bfea1-172">**VIRTUAL NETWORK SUBNETS** = Back(10.10.2.0/24)</span></span><br/><span data-ttu-id="bfea1-173">**ACCOUNT DI ARCHIVIAZIONE**: usare un account di archiviazione generato automaticamente</span><span class="sxs-lookup"><span data-stu-id="bfea1-173">**STORAGE ACCOUNT** = Use an automatically generated storage account</span></span><br/><span data-ttu-id="bfea1-174">**SET DI DISPONIBILITÀ** = (Nessuno)</span><span class="sxs-lookup"><span data-stu-id="bfea1-174">**AVAILABILITY SET** = (None)</span></span> |
   | <span data-ttu-id="bfea1-175">Opzioni macchina virtuale</span><span class="sxs-lookup"><span data-stu-id="bfea1-175">Virtual machine options</span></span> |<span data-ttu-id="bfea1-176">Valori predefiniti</span><span class="sxs-lookup"><span data-stu-id="bfea1-176">Use defaults</span></span> |

<span data-ttu-id="bfea1-177">Al termine della configurazione della nuova macchina virtuale, attendere l'esecuzione del relativo provisioning.</span><span class="sxs-lookup"><span data-stu-id="bfea1-177">After you configure the new virtual machine, wait for the virtual machine to be provsioned.</span></span> <span data-ttu-id="bfea1-178">L'esecuzione di questo processo richiede tempo.</span><span class="sxs-lookup"><span data-stu-id="bfea1-178">This process takes some time to finish.</span></span> <span data-ttu-id="bfea1-179">Se si fa clic sulla scheda **Macchina virtuale** nel portale di Azure classico, è possibile visualizzare il passaggio degli stati di ContosoDC da **Starting (Provisioning)** ad **Arrestato**, **Avvio in corso**, **Running (Provisioning)** e infine **In esecuzione**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-179">If you click the **Virtual Machine** tab in the Azure classic portal, you can see ContosoDC cycling states from **Starting (Provisioning)** to **Stopped**, **Starting**, **Running (Provisioning)**, and finally **Running**.</span></span>

<span data-ttu-id="bfea1-180">A questo punto, il provisioning del server del controller di dominio è completato.</span><span class="sxs-lookup"><span data-stu-id="bfea1-180">The DC server is now successfully provisioned.</span></span> <span data-ttu-id="bfea1-181">Si configurerà quindi il dominio di Active Directory nel server del controller di dominio.</span><span class="sxs-lookup"><span data-stu-id="bfea1-181">Next, you will configure the Active Directory domain on this DC server.</span></span>

## <a name="configure-the-domain-controller"></a><span data-ttu-id="bfea1-182">Configurare il controller di dominio</span><span class="sxs-lookup"><span data-stu-id="bfea1-182">Configure the domain controller</span></span>
<span data-ttu-id="bfea1-183">Nei seguenti passaggi viene configurata la macchina virtuale ContosoDC come controller di dominio per corp.contoso.com.</span><span class="sxs-lookup"><span data-stu-id="bfea1-183">In the following steps, you configure the ContosoDC machine as a domain controller for corp.contoso.com.</span></span>

1. <span data-ttu-id="bfea1-184">Nel portale selezionare la macchina **ContosoDC** .</span><span class="sxs-lookup"><span data-stu-id="bfea1-184">In the portal, select the **ContosoDC** machine.</span></span> <span data-ttu-id="bfea1-185">Nella scheda **Dashboard** fare clic su **Connetti** per aprire un file RDP per l'accesso desktop remoto.</span><span class="sxs-lookup"><span data-stu-id="bfea1-185">On the **Dashboard** tab, click **Connect** to open a remote desktop (RDP) file for remote desktop access.</span></span>
   
    ![Connettersi alla macchina virtuale](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC784622.png)
2. <span data-ttu-id="bfea1-187">Accedere con l'account amministratore (**\AzureAdmin**) e la password (**Contoso!000**) configurati.</span><span class="sxs-lookup"><span data-stu-id="bfea1-187">Sign in with your configured administrator account (**\AzureAdmin**) and password (**Contoso!000**).</span></span>
3. <span data-ttu-id="bfea1-188">Per impostazione predefinita, verrà visualizzato il dashboard **Server Manager** .</span><span class="sxs-lookup"><span data-stu-id="bfea1-188">By default, the **Server Manager** dashboard should be displayed.</span></span>
4. <span data-ttu-id="bfea1-189">Fare clic sul collegamento **Aggiungi ruoli e funzionalità** sul dashboard.</span><span class="sxs-lookup"><span data-stu-id="bfea1-189">Click the **Add roles and features** link on the dashboard.</span></span>
   
    ![Aggiunta ruoli Esplora server](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC784623.png)
5. <span data-ttu-id="bfea1-191">Fare clic su **Avanti** fino a visualizzare la sezione **Ruoli server**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-191">Click **Next** until you get to the **Server Roles** section.</span></span>
6. <span data-ttu-id="bfea1-192">Selezionare i ruoli **Active Directory Domain Services** e **Server DNS**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-192">Select the **Active Directory Domain Services** and **DNS Server** roles.</span></span> <span data-ttu-id="bfea1-193">Quando richiesto, aggiungere altre funzionalità richieste da questi ruoli.</span><span class="sxs-lookup"><span data-stu-id="bfea1-193">When prompted, add more features that these roles require.</span></span>
   
   > [!NOTE]
   > <span data-ttu-id="bfea1-194">Verrà visualizzato un avviso di convalida che indica che non esiste alcun indirizzo IP statico.</span><span class="sxs-lookup"><span data-stu-id="bfea1-194">You will get a validation warning that there is no static IP address.</span></span> <span data-ttu-id="bfea1-195">Se si esegue il test della configurazione, fare clic su **Continua**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-195">If you are testing the configuration, click **Continue**.</span></span> <span data-ttu-id="bfea1-196">Per scenari di produzione, [usare PowerShell per impostare l'indirizzo IP statico della macchina virtuale controller di dominio](../../../virtual-network/virtual-networks-reserved-private-ip.md).</span><span class="sxs-lookup"><span data-stu-id="bfea1-196">For production scenarios [use PowerShell to set the static IP address of the domain controller machine](../../../virtual-network/virtual-networks-reserved-private-ip.md).</span></span>
   > 
   > 
   
    ![Finestra di dialogo Aggiungi ruoli](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC784624.png)
7. <span data-ttu-id="bfea1-198">Fare clic su **Avanti** fino a raggiungere la sezione **Conferma**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-198">Click **Next** until you reach the **Confirmation** section.</span></span> <span data-ttu-id="bfea1-199">Selezionare la casella di controllo **Riavvia automaticamente il server di destinazione se necessario**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-199">Select the **Restart the destination server automatically if required** check box.</span></span>
8. <span data-ttu-id="bfea1-200">Fare clic su **Installa**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-200">Click **Install**.</span></span>
9. <span data-ttu-id="bfea1-201">Dopo aver installato le funzionalità, tornare al dashboard **Server Manager**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-201">After the features are installed, return to the **Server Manager** dashboard.</span></span>
10. <span data-ttu-id="bfea1-202">Selezionare la nuova opzione **Servizi di dominio di Active Directory** nel riquadro a sinistra.</span><span class="sxs-lookup"><span data-stu-id="bfea1-202">Select the new **AD DS** option on the left pane.</span></span>
11. <span data-ttu-id="bfea1-203">Fare clic sul collegamento **Altro** sulla barra di avviso gialla.</span><span class="sxs-lookup"><span data-stu-id="bfea1-203">Click the **More** link on the yellow warning bar.</span></span>
    
     ![Finestra di dialogo Servizi di dominio di Active Directory nella macchina virtuale del server DNS](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC784625.png)
12. <span data-ttu-id="bfea1-205">Nella colonna **Azione** della finestra di dialogo **Dettagli attività tutti i server** fare clic su **Alza di livello il server a controller di dominio**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-205">In the **Action** column of the **All Server Task Details** dialog box, click **Promote this server to a domain controller**.</span></span>
13. <span data-ttu-id="bfea1-206">Nella **Configurazione guidata Servizi di dominio di Active Directory**, usare i seguenti valori:</span><span class="sxs-lookup"><span data-stu-id="bfea1-206">In the **Active Directory Domain Services Configuration Wizard**, use the following values:</span></span>
    
    | <span data-ttu-id="bfea1-207">Page</span><span class="sxs-lookup"><span data-stu-id="bfea1-207">Page</span></span> | <span data-ttu-id="bfea1-208">Impostazione</span><span class="sxs-lookup"><span data-stu-id="bfea1-208">Setting</span></span> |
    | --- | --- |
    | <span data-ttu-id="bfea1-209">Configurazione distribuzione</span><span class="sxs-lookup"><span data-stu-id="bfea1-209">Deployment Configuration</span></span> |<span data-ttu-id="bfea1-210">**Aggiungi una nuova foresta** = selezionata</span><span class="sxs-lookup"><span data-stu-id="bfea1-210">**Add a new forest** = Selected</span></span><br/><span data-ttu-id="bfea1-211">**Nome di dominio radice** = corp.contoso.com</span><span class="sxs-lookup"><span data-stu-id="bfea1-211">**Root domain name** = corp.contoso.com</span></span> |
    | <span data-ttu-id="bfea1-212">Opzioni controller di dominio</span><span class="sxs-lookup"><span data-stu-id="bfea1-212">Domain Controller Options</span></span> |<span data-ttu-id="bfea1-213">**Password** = Contoso!000</span><span class="sxs-lookup"><span data-stu-id="bfea1-213">**Password** = Contoso!000</span></span><br/><span data-ttu-id="bfea1-214">**Conferma password** = Contoso!000</span><span class="sxs-lookup"><span data-stu-id="bfea1-214">**Confirm Password** = Contoso!000</span></span> |
14. <span data-ttu-id="bfea1-215">Fare clic su **Avanti** per procedere nelle altre pagine della procedura guidata.</span><span class="sxs-lookup"><span data-stu-id="bfea1-215">Click **Next** to go through the other pages in the wizard.</span></span> <span data-ttu-id="bfea1-216">Nella pagina **Controllo dei prerequisiti** verificare che venga visualizzato il seguente messaggio: **Tutti i controlli dei prerequisiti sono riusciti**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-216">On the **Prerequisites Check** page, verify that you see the following message: **All prerequisite checks passed successfully**.</span></span> <span data-ttu-id="bfea1-217">Si noti che è opportuno leggere tutti i messaggi di avviso applicabili, ma che è possibile continuare con l'installazione.</span><span class="sxs-lookup"><span data-stu-id="bfea1-217">Note that you should review all applicable warning messages, but it is possible to continue with the installation.</span></span>
15. <span data-ttu-id="bfea1-218">Fare clic su **Installa**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-218">Click **Install**.</span></span> <span data-ttu-id="bfea1-219">La macchina virtuale **ContosoDC** si riavvierà automaticamente.</span><span class="sxs-lookup"><span data-stu-id="bfea1-219">The **ContosoDC** virtual machine will automatically reboot.</span></span>

## <a name="configure-domain-accounts"></a><span data-ttu-id="bfea1-220">Configurare gli account di dominio</span><span class="sxs-lookup"><span data-stu-id="bfea1-220">Configure domain accounts</span></span>
<span data-ttu-id="bfea1-221">Nei seguenti passaggi vengono configurati gli account Active Directory per un uso successivo.</span><span class="sxs-lookup"><span data-stu-id="bfea1-221">The next steps configure the Active Directory accounts for later use.</span></span>

1. <span data-ttu-id="bfea1-222">Accedere nuovamente alla macchina **ContosoDC**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-222">Sign back in to the **ContosoDC** machine.</span></span>
2. <span data-ttu-id="bfea1-223">In **Server Manager** fare clic su **Strumenti** > **Centro di amministrazione di Active Directory**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-223">In **Server Manager**, click **Tools** > **Active Directory Administrative Center**.</span></span>
   
    ![Centro di amministrazione di Active Directory](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC784626.png)
3. <span data-ttu-id="bfea1-225">Nel **Centro di amministrazione di Active Directory** selezionare **corp (local)** nel riquadro di sinistra.</span><span class="sxs-lookup"><span data-stu-id="bfea1-225">In the **Active Directory Administrative Center**, select **corp (local)** in the left pane.</span></span>
4. <span data-ttu-id="bfea1-226">Nel riquadro **Attività** a destra fare clic su **Nuovo** > **Utente**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-226">On the right **Tasks** pane, click **New** > **User**.</span></span> <span data-ttu-id="bfea1-227">Usare le seguenti impostazioni:</span><span class="sxs-lookup"><span data-stu-id="bfea1-227">Use the following settings:</span></span>
   
   | <span data-ttu-id="bfea1-228">Impostazione</span><span class="sxs-lookup"><span data-stu-id="bfea1-228">Setting</span></span> | <span data-ttu-id="bfea1-229">Valore</span><span class="sxs-lookup"><span data-stu-id="bfea1-229">Value</span></span> |
   | --- | --- |
   | <span data-ttu-id="bfea1-230">**Nome**</span><span class="sxs-lookup"><span data-stu-id="bfea1-230">**First Name**</span></span> |<span data-ttu-id="bfea1-231">Installa</span><span class="sxs-lookup"><span data-stu-id="bfea1-231">Install</span></span> |
   | <span data-ttu-id="bfea1-232">**Utente SamAccountName**</span><span class="sxs-lookup"><span data-stu-id="bfea1-232">**User SamAccountName**</span></span> |<span data-ttu-id="bfea1-233">Installa</span><span class="sxs-lookup"><span data-stu-id="bfea1-233">Install</span></span> |
   | <span data-ttu-id="bfea1-234">**Password**</span><span class="sxs-lookup"><span data-stu-id="bfea1-234">**Password**</span></span> |<span data-ttu-id="bfea1-235">Contoso!000</span><span class="sxs-lookup"><span data-stu-id="bfea1-235">Contoso!000</span></span> |
   | <span data-ttu-id="bfea1-236">**Conferma password**</span><span class="sxs-lookup"><span data-stu-id="bfea1-236">**Confirm password**</span></span> |<span data-ttu-id="bfea1-237">Contoso!000</span><span class="sxs-lookup"><span data-stu-id="bfea1-237">Contoso!000</span></span> |
   | <span data-ttu-id="bfea1-238">**Altre opzioni password**</span><span class="sxs-lookup"><span data-stu-id="bfea1-238">**Other password options**</span></span> |<span data-ttu-id="bfea1-239">Selezionato</span><span class="sxs-lookup"><span data-stu-id="bfea1-239">Selected</span></span> |
   | <span data-ttu-id="bfea1-240">**Nessuna scadenza password**</span><span class="sxs-lookup"><span data-stu-id="bfea1-240">**Password never expires**</span></span> |<span data-ttu-id="bfea1-241">Selezionato</span><span class="sxs-lookup"><span data-stu-id="bfea1-241">Checked</span></span> |
5. <span data-ttu-id="bfea1-242">Fare clic su **OK** per creare l'utente **Install**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-242">Click **OK** to create the **Install** user.</span></span> <span data-ttu-id="bfea1-243">Questo account verrà usato per configurare il cluster di failover e il gruppo di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="bfea1-243">This account will be used to configure the failover cluster and the availability group.</span></span>
6. <span data-ttu-id="bfea1-244">Creare due utenti aggiuntivi, ovvero **CORP\SQLSvc1** e **CORP\SQLSvc2**, con gli stessi passaggi.</span><span class="sxs-lookup"><span data-stu-id="bfea1-244">Create two additional users, **CORP\SQLSvc1** and **CORP\SQLSvc2**, with the same steps.</span></span> <span data-ttu-id="bfea1-245">Tali account verranno usati per le istanze di SQL Server.</span><span class="sxs-lookup"><span data-stu-id="bfea1-245">These accounts will be used for the SQL Server instances.</span></span> <span data-ttu-id="bfea1-246">A questo punto è necessario assegnare a **CORP\Install** le autorizzazioni necessarie per configurare il clustering di failover di Windows.</span><span class="sxs-lookup"><span data-stu-id="bfea1-246">Next, you need to give **CORP\Install** the necessary permissions to configure Windows failover clustering.</span></span>
7. <span data-ttu-id="bfea1-247">Nel **Centro di amministrazione di Active Directory** fare clic su **corp (local)** nel riquadro a sinistra.</span><span class="sxs-lookup"><span data-stu-id="bfea1-247">In the **Active Directory Administrative Center**, click **corp (local)** in the left pane.</span></span> <span data-ttu-id="bfea1-248">Nel riquadro **Attività** fare clic su **Proprietà**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-248">In the **Tasks** pane, click **Properties**.</span></span>
   
    ![Proprietà utente CORP](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC784627.png)
8. <span data-ttu-id="bfea1-250">Selezionare **Estensioni**, quindi fare clic sul pulsante **Avanzate** nella scheda **Sicurezza**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-250">Select **Extensions**, and then click the **Advanced** button on the **Security** tab.</span></span>
9. <span data-ttu-id="bfea1-251">Nella finestra di dialogo **Impostazioni avanzate di sicurezza per corp** fare clic su **Aggiungi**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-251">In the **Advanced Security Settings for corp** dialog box, click **Add**.</span></span>
10. <span data-ttu-id="bfea1-252">Fare clic su **Seleziona un'entità**, cercare **CORP\Install** e quindi fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-252">Click **Select a principal**, search for **CORP\Install**, and then click **OK**.</span></span>
11. <span data-ttu-id="bfea1-253">Selezionare le autorizzazioni **Leggi tutte le proprietà** e **Create Computer objects** (Crea oggetti computer).</span><span class="sxs-lookup"><span data-stu-id="bfea1-253">Select the **Read all properties** and **Create Computer objects** permissions.</span></span>
    
     ![Autorizzazioni utente Corp](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC784628.png)
12. <span data-ttu-id="bfea1-255">Fare clic su **OK** e quindi di nuovo clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-255">Click **OK**, and then click **OK** again.</span></span> <span data-ttu-id="bfea1-256">Chiudere la finestra delle proprietà di corp.</span><span class="sxs-lookup"><span data-stu-id="bfea1-256">Close the corp properties window.</span></span>

<span data-ttu-id="bfea1-257">Al termine della configurazione di Active Directory e degli oggetti utente, si procederà alla creazione di tre macchine virtuali di SQL Server che verranno aggiunte al dominio.</span><span class="sxs-lookup"><span data-stu-id="bfea1-257">Now that you configured Active Directory and the user objects, you will create three SQL Server virtual machines and join them to this domain.</span></span>

## <a name="create-the-sql-server-virtual-machines"></a><span data-ttu-id="bfea1-258">Creare le macchine virtuali di SQL Server</span><span class="sxs-lookup"><span data-stu-id="bfea1-258">Create the SQL Server virtual machines</span></span>
<span data-ttu-id="bfea1-259">Creare tre macchine virtuali,</span><span class="sxs-lookup"><span data-stu-id="bfea1-259">Create three virtual machines.</span></span> <span data-ttu-id="bfea1-260">una per un nodo del cluster e due per SQL Server.</span><span class="sxs-lookup"><span data-stu-id="bfea1-260">One is for a cluster node and two are for SQL Server.</span></span> <span data-ttu-id="bfea1-261">Per creare ogni macchina virtuale, tornare al portale di Azure classico, fare clic su **Nuovo** > **Calcola** > **Macchina virtuale** > **Da raccolta**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-261">To create each of the virtual machines, go back to the Azure classic portal, click **New** > **Compute** > **Virtual Machine** > **From Gallery**.</span></span> <span data-ttu-id="bfea1-262">Usare quindi i modelli indicati nella tabella seguente tabella per creare le macchine virtuali.</span><span class="sxs-lookup"><span data-stu-id="bfea1-262">Then, use the templates in the following table to help you create the virtual machines.</span></span>

| <span data-ttu-id="bfea1-263">Page</span><span class="sxs-lookup"><span data-stu-id="bfea1-263">Page</span></span> | <span data-ttu-id="bfea1-264">VM1</span><span class="sxs-lookup"><span data-stu-id="bfea1-264">VM1</span></span> | <span data-ttu-id="bfea1-265">VM2</span><span class="sxs-lookup"><span data-stu-id="bfea1-265">VM2</span></span> | <span data-ttu-id="bfea1-266">VM3</span><span class="sxs-lookup"><span data-stu-id="bfea1-266">VM3</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="bfea1-267">Selezionare il sistema operativo della macchina virtuale</span><span class="sxs-lookup"><span data-stu-id="bfea1-267">Select the virtual machine operating system</span></span> |<span data-ttu-id="bfea1-268">**Windows Server 2012 R2 Datacenter**</span><span class="sxs-lookup"><span data-stu-id="bfea1-268">**Windows Server 2012 R2 Datacenter**</span></span> |<span data-ttu-id="bfea1-269">**SQL Server 2014 RTM Enterprise**</span><span class="sxs-lookup"><span data-stu-id="bfea1-269">**SQL Server 2014 RTM Enterprise**</span></span> |<span data-ttu-id="bfea1-270">**SQL Server 2014 RTM Enterprise**</span><span class="sxs-lookup"><span data-stu-id="bfea1-270">**SQL Server 2014 RTM Enterprise**</span></span> |
| <span data-ttu-id="bfea1-271">Configurazione macchina virtuale</span><span class="sxs-lookup"><span data-stu-id="bfea1-271">Virtual machine configuration</span></span> |<span data-ttu-id="bfea1-272">**DATA DI RILASCIO VERSIONE** = (più recente)</span><span class="sxs-lookup"><span data-stu-id="bfea1-272">**VERSION RELEASE DATE** = (latest)</span></span><br/><span data-ttu-id="bfea1-273">**NOME MACCHINA VIRTUALE** = ContosoWSFCNode</span><span class="sxs-lookup"><span data-stu-id="bfea1-273">**VIRTUAL MACHINE NAME** = ContosoWSFCNode</span></span><br/><span data-ttu-id="bfea1-274">**PIANO** = STANDARD</span><span class="sxs-lookup"><span data-stu-id="bfea1-274">**TIER** = STANDARD</span></span><br/><span data-ttu-id="bfea1-275">**DIMENSIONI** = A2 (2 core)</span><span class="sxs-lookup"><span data-stu-id="bfea1-275">**SIZE** = A2 (2 cores)</span></span><br/><span data-ttu-id="bfea1-276">**NUOVO NOME UTENTE** = AzureAdmin</span><span class="sxs-lookup"><span data-stu-id="bfea1-276">**NEW USER NAME** = AzureAdmin</span></span><br/><span data-ttu-id="bfea1-277">**NUOVA PASSWORD** = Contoso!000</span><span class="sxs-lookup"><span data-stu-id="bfea1-277">**NEW PASSWORD** = Contoso!000</span></span><br/><span data-ttu-id="bfea1-278">**CONFERMA** = Contoso!000</span><span class="sxs-lookup"><span data-stu-id="bfea1-278">**CONFIRM** = Contoso!000</span></span> |<span data-ttu-id="bfea1-279">**DATA DI RILASCIO VERSIONE** = (più recente)</span><span class="sxs-lookup"><span data-stu-id="bfea1-279">**VERSION RELEASE DATE** = (latest)</span></span><br/><span data-ttu-id="bfea1-280">**NOME MACCHINA VIRTUALE** = ContosoSQL1</span><span class="sxs-lookup"><span data-stu-id="bfea1-280">**VIRTUAL MACHINE NAME** = ContosoSQL1</span></span><br/><span data-ttu-id="bfea1-281">**PIANO** = STANDARD</span><span class="sxs-lookup"><span data-stu-id="bfea1-281">**TIER** = STANDARD</span></span><br/><span data-ttu-id="bfea1-282">**DIMENSIONI** = A3 (4 core)</span><span class="sxs-lookup"><span data-stu-id="bfea1-282">**SIZE** = A3 (4 cores)</span></span><br/><span data-ttu-id="bfea1-283">**NUOVO NOME UTENTE** = AzureAdmin</span><span class="sxs-lookup"><span data-stu-id="bfea1-283">**NEW USER NAME** = AzureAdmin</span></span><br/><span data-ttu-id="bfea1-284">**NUOVA PASSWORD** = Contoso!000</span><span class="sxs-lookup"><span data-stu-id="bfea1-284">**NEW PASSWORD** = Contoso!000</span></span><br/><span data-ttu-id="bfea1-285">**CONFERMA** = Contoso!000</span><span class="sxs-lookup"><span data-stu-id="bfea1-285">**CONFIRM** = Contoso!000</span></span> |<span data-ttu-id="bfea1-286">**DATA DI RILASCIO VERSIONE** = (più recente)</span><span class="sxs-lookup"><span data-stu-id="bfea1-286">**VERSION RELEASE DATE** = (latest)</span></span><br/><span data-ttu-id="bfea1-287">**NOME MACCHINA VIRTUALE** = ContosoSQL2</span><span class="sxs-lookup"><span data-stu-id="bfea1-287">**VIRTUAL MACHINE NAME** = ContosoSQL2</span></span><br/><span data-ttu-id="bfea1-288">**PIANO** = STANDARD</span><span class="sxs-lookup"><span data-stu-id="bfea1-288">**TIER** = STANDARD</span></span><br/><span data-ttu-id="bfea1-289">**DIMENSIONI** = A3 (4 core)</span><span class="sxs-lookup"><span data-stu-id="bfea1-289">**SIZE** = A3 (4 cores)</span></span><br/><span data-ttu-id="bfea1-290">**NUOVO NOME UTENTE** = AzureAdmin</span><span class="sxs-lookup"><span data-stu-id="bfea1-290">**NEW USER NAME** = AzureAdmin</span></span><br/><span data-ttu-id="bfea1-291">**NUOVA PASSWORD** = Contoso!000</span><span class="sxs-lookup"><span data-stu-id="bfea1-291">**NEW PASSWORD** = Contoso!000</span></span><br/><span data-ttu-id="bfea1-292">**CONFERMA** = Contoso!000</span><span class="sxs-lookup"><span data-stu-id="bfea1-292">**CONFIRM** = Contoso!000</span></span> |
| <span data-ttu-id="bfea1-293">Configurazione macchina virtuale</span><span class="sxs-lookup"><span data-stu-id="bfea1-293">Virtual machine configuration</span></span> |<span data-ttu-id="bfea1-294">**SERVIZIO CLOUD** = nome DNS univoco del servizio cloud creato in precedenza (ad esempio: ContosoDC123)</span><span class="sxs-lookup"><span data-stu-id="bfea1-294">**CLOUD SERVICE** = Previously Created Unique Cloud Service DNS Name (ex: ContosoDC123)</span></span><br/><span data-ttu-id="bfea1-295">**AREA/GRUPPO DI AFFINITÀ/RETE VIRTUALE** = ContosoNET</span><span class="sxs-lookup"><span data-stu-id="bfea1-295">**REGION/AFFINITY GROUP/VIRTUAL NETWORK** = ContosoNET</span></span><br/><span data-ttu-id="bfea1-296">**SUNET RETE VIRTUALE** = Back(10.10.2.0/24)</span><span class="sxs-lookup"><span data-stu-id="bfea1-296">**VIRTUAL NETWORK SUBNETS** = Back(10.10.2.0/24)</span></span><br/><span data-ttu-id="bfea1-297">**ACCOUNT DI ARCHIVIAZIONE**: usare un account di archiviazione generato automaticamente</span><span class="sxs-lookup"><span data-stu-id="bfea1-297">**STORAGE ACCOUNT** = Use an automatically generated storage account</span></span><br/><span data-ttu-id="bfea1-298">**SETDI DISPONIBILITÀ** = creare un set di disponibilità</span><span class="sxs-lookup"><span data-stu-id="bfea1-298">**AVAILABILITY SET** = Create an availability set</span></span><br/><span data-ttu-id="bfea1-299">**NOME SET DI DISPONIBILITÀ** = SQLHADR</span><span class="sxs-lookup"><span data-stu-id="bfea1-299">**AVAILABILITY SET NAME** = SQLHADR</span></span> |<span data-ttu-id="bfea1-300">**SERVIZIO CLOUD** = nome DNS univoco del servizio cloud creato in precedenza (ad esempio: ContosoDC123)</span><span class="sxs-lookup"><span data-stu-id="bfea1-300">**CLOUD SERVICE** = Previously Created Unique Cloud Service DNS Name (ex: ContosoDC123)</span></span><br/><span data-ttu-id="bfea1-301">**AREA/GRUPPO DI AFFINITÀ/RETE VIRTUALE** = ContosoNET</span><span class="sxs-lookup"><span data-stu-id="bfea1-301">**REGION/AFFINITY GROUP/VIRTUAL NETWORK** = ContosoNET</span></span><br/><span data-ttu-id="bfea1-302">**SUNET RETE VIRTUALE** = Back(10.10.2.0/24)</span><span class="sxs-lookup"><span data-stu-id="bfea1-302">**VIRTUAL NETWORK SUBNETS** = Back(10.10.2.0/24)</span></span><br/><span data-ttu-id="bfea1-303">**ACCOUNT DI ARCHIVIAZIONE**: usare un account di archiviazione generato automaticamente</span><span class="sxs-lookup"><span data-stu-id="bfea1-303">**STORAGE ACCOUNT** = Use an automatically generated storage account</span></span><br/><span data-ttu-id="bfea1-304">**SET DI DISPONIBILITÀ** = SQLHADR (è anche possibile configurare il set di disponibilità dopo aver creato la macchina.</span><span class="sxs-lookup"><span data-stu-id="bfea1-304">**AVAILABILITY SET** = SQLHADR (You can also configure the availability set after the machine has been created.</span></span> <span data-ttu-id="bfea1-305">Tutte e tre le macchine virtuali devono essere assegnate al set di disponibilità SQLHADR.</span><span class="sxs-lookup"><span data-stu-id="bfea1-305">All three machines should be assigned to the SQLHADR availability set.)</span></span> |<span data-ttu-id="bfea1-306">**SERVIZIO CLOUD** = nome DNS univoco del servizio cloud creato in precedenza (ad esempio: ContosoDC123)</span><span class="sxs-lookup"><span data-stu-id="bfea1-306">**CLOUD SERVICE** = Previously Created Unique Cloud Service DNS Name (ex: ContosoDC123)</span></span><br/><span data-ttu-id="bfea1-307">**AREA/GRUPPO DI AFFINITÀ/RETE VIRTUALE** = ContosoNET</span><span class="sxs-lookup"><span data-stu-id="bfea1-307">**REGION/AFFINITY GROUP/VIRTUAL NETWORK** = ContosoNET</span></span><br/><span data-ttu-id="bfea1-308">**SUNET RETE VIRTUALE** = Back(10.10.2.0/24)</span><span class="sxs-lookup"><span data-stu-id="bfea1-308">**VIRTUAL NETWORK SUBNETS** = Back(10.10.2.0/24)</span></span><br/><span data-ttu-id="bfea1-309">**ACCOUNT DI ARCHIVIAZIONE**: usare un account di archiviazione generato automaticamente</span><span class="sxs-lookup"><span data-stu-id="bfea1-309">**STORAGE ACCOUNT** = Use an automatically generated storage account</span></span><br/><span data-ttu-id="bfea1-310">**SET DI DISPONIBILITÀ** = SQLHADR (è anche possibile configurare il set di disponibilità dopo aver creato la macchina.</span><span class="sxs-lookup"><span data-stu-id="bfea1-310">**AVAILABILITY SET** = SQLHADR (You can also configure the availability set after the machine has been created.</span></span> <span data-ttu-id="bfea1-311">Tutte e tre le macchine virtuali devono essere assegnate al set di disponibilità SQLHADR.</span><span class="sxs-lookup"><span data-stu-id="bfea1-311">All three machines should be assigned to the SQLHADR availability set.)</span></span> |
| <span data-ttu-id="bfea1-312">Opzioni macchina virtuale</span><span class="sxs-lookup"><span data-stu-id="bfea1-312">Virtual machine options</span></span> |<span data-ttu-id="bfea1-313">Valori predefiniti</span><span class="sxs-lookup"><span data-stu-id="bfea1-313">Use defaults</span></span> |<span data-ttu-id="bfea1-314">Valori predefiniti</span><span class="sxs-lookup"><span data-stu-id="bfea1-314">Use defaults</span></span> |<span data-ttu-id="bfea1-315">Valori predefiniti</span><span class="sxs-lookup"><span data-stu-id="bfea1-315">Use defaults</span></span> |

<br/>

> [!NOTE]
> <span data-ttu-id="bfea1-316">La configurazione precedente suggerisce macchine virtuali di livello STANDARD poiché le macchine di livello BASIC non supportano gli endpoint con carico bilanciato</span><span class="sxs-lookup"><span data-stu-id="bfea1-316">The previous configuration suggests STANDARD tier virtual machines, because BASIC tier machines do not support load-balanced endpoints.</span></span> <span data-ttu-id="bfea1-317">necessari per creare in seguito listener del gruppo di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="bfea1-317">You need load-balanced endpoints later to create an availability group listener.</span></span> <span data-ttu-id="bfea1-318">Le dimensioni delle macchine suggerite sono pensate inoltre per il test dei gruppi di disponibilità all'interno di macchine virtuali di Azure.</span><span class="sxs-lookup"><span data-stu-id="bfea1-318">Also, the machine sizes that are suggested here are meant for testing availability groups in Azure Virtual Machines.</span></span> <span data-ttu-id="bfea1-319">Per ottenere prestazioni ottimali su carichi di lavoro di produzione, vedere le dimensioni e la configurazione consigliate per la macchina SQL Server in [Procedure consigliate per le prestazioni per SQL Server in Macchine virtuali di Azure](../sql/virtual-machines-windows-sql-performance.md).</span><span class="sxs-lookup"><span data-stu-id="bfea1-319">For the best performance on production workloads, see the recommendations for SQL Server machine sizes and configuration in [Performance best practices for SQL Server in Azure Virtual Machines](../sql/virtual-machines-windows-sql-performance.md).</span></span>
> 
> 

<span data-ttu-id="bfea1-320">Dopo aver effettuato il provisioning completo delle tre macchine virtuali, è necessario aggiungerle al dominio **corp.contoso.com** e concedere alle macchine i diritti amministrativi di CORP\Install.</span><span class="sxs-lookup"><span data-stu-id="bfea1-320">After the three virtual machines are fully provisioned, you need to join them to the **corp.contoso.com** domain and grant CORP\Install administrative rights to the machines.</span></span> <span data-ttu-id="bfea1-321">A tale scopo, seguire questa procedura per ognuna delle tre macchine virtuali.</span><span class="sxs-lookup"><span data-stu-id="bfea1-321">To do this, use the following steps for each of the three virtual machines.</span></span>

1. <span data-ttu-id="bfea1-322">In primo luogo, modificare l'indirizzo del server DNS preferito.</span><span class="sxs-lookup"><span data-stu-id="bfea1-322">First, change the preferred DNS server address.</span></span> <span data-ttu-id="bfea1-323">Selezionare la macchina virtuale nell'elenco per scaricare il file RDP relativo e quindi fare clic sul pulsante **Connetti**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-323">Download each virtual machine's RDP file to your local directory by selecting the virtual machine in the list and clicking the **Connect** button.</span></span> <span data-ttu-id="bfea1-324">Per selezionare una macchina virtuale, fare clic su un punto qualsiasi, ma nella prima cella della riga, come illustrato nella figura seguente.</span><span class="sxs-lookup"><span data-stu-id="bfea1-324">To select a virtual machine, click anywhere but the first cell in the row, as shown in the following screenshot.</span></span>
   
    ![Scaricare il file RDP](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC664953.jpg)
2. <span data-ttu-id="bfea1-326">Aprire il file RDP scaricato e accedere alla macchina virtuale con l'account amministratore (**BUILTIN\AzureAdmin**) e la password (**Contoso!000**) configurati.</span><span class="sxs-lookup"><span data-stu-id="bfea1-326">Open the RDP file that you downloaded, and sign in to the virtual machine by using your configured administrator account (**BUILTIN\AzureAdmin**) and password (**Contoso!000**).</span></span>
3. <span data-ttu-id="bfea1-327">Dopo l'accesso, verrà visualizzato il dashboard **Server Manager**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-327">After you sign in, you should see the **Server Manager** dashboard.</span></span> <span data-ttu-id="bfea1-328">Nel riquadro di sinistra fare clic su **Server locale** .</span><span class="sxs-lookup"><span data-stu-id="bfea1-328">Click **Local Server** in the left pane.</span></span>
4. <span data-ttu-id="bfea1-329">Fare clic sul collegamento **Indirizzo IPv4 assegnato da DHCP - Compatibile IPv6** .</span><span class="sxs-lookup"><span data-stu-id="bfea1-329">Click the **IPv4 address assigned by DHCP, IPv6 enabled** link.</span></span>
5. <span data-ttu-id="bfea1-330">Nella finestra di dialogo **Connessioni di rete** fare clic sull'icona della rete.</span><span class="sxs-lookup"><span data-stu-id="bfea1-330">In the **Network Connections** dialog box, click the network icon.</span></span>
   
    ![Modificare il server DNS preferito della macchina virtuale](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC784629.png)
6. <span data-ttu-id="bfea1-332">Sulla barra dei comandi fare clic su **Cambia impostazioni di connessione**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-332">On the command bar, click **Change the settings of this connection**.</span></span> <span data-ttu-id="bfea1-333">A seconda delle dimensioni della finestra, potrebbe essere necessario fare clic sulla doppia freccia destra per visualizzare questo comando.</span><span class="sxs-lookup"><span data-stu-id="bfea1-333">(Depending on the size of your window, you might have to click the double right arrow to see this command).</span></span>
7. <span data-ttu-id="bfea1-334">Selezionare **Protocollo Internet versione 4 (TCP/IPv4)** e quindi fare clic su **Proprietà**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-334">Select **Internet Protocol Version 4 (TCP/IPv4)**, and then click **Properties**.</span></span>
8. <span data-ttu-id="bfea1-335">Selezionare **Utilizza i seguenti indirizzi server DNS** e quindi specificare **10.10.2.4** in **Server DNS preferito**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-335">Select **Use the following DNS server addresses** and then specify **10.10.2.4** in **Preferred DNS server**.</span></span>
9. <span data-ttu-id="bfea1-336">L'indirizzo **10.10.2.4** è quello assegnato a una macchina virtuale nella subnet 10.10.2.0/24 in una rete virtuale di Azure</span><span class="sxs-lookup"><span data-stu-id="bfea1-336">The **10.10.2.4** address is the address that's assigned to a virtual machine in the 10.10.2.0/24 subnet in an Azure virtual network.</span></span> <span data-ttu-id="bfea1-337">e la macchina virtuale è **ContosoDC**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-337">That virtual machine is **ContosoDC**.</span></span> <span data-ttu-id="bfea1-338">Per verificare l'indirizzo IP di **ContosoDC**, digitare **nslookup contosodc** nella finestra del prompt dei comandi, come illustrato nella schermata seguente.</span><span class="sxs-lookup"><span data-stu-id="bfea1-338">To verify **ContosoDC**'s IP address, use **nslookup contosodc** in the command prompt window, as shown in the following screenshot.</span></span>
   
    ![Usare NSLOOKUP per trovare l'indirizzo IP per il controller di dominio](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC664954.jpg)
10. <span data-ttu-id="bfea1-340">Fare clic su **OK** > **Chiudi** per salvare le modifiche.</span><span class="sxs-lookup"><span data-stu-id="bfea1-340">Click **OK** > **Close** to commit the changes.</span></span> <span data-ttu-id="bfea1-341">A questo punto è possibile aggiungere la macchina virtuale a **corp.contoso.com**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-341">You can now join the virtual machine to **corp.contoso.com**.</span></span>
11. <span data-ttu-id="bfea1-342">Tornando alla finestra **Server locale**, fare clic sul collegamento **WORKGROUP**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-342">Back in the **Local Server** window, click the **WORKGROUP** link.</span></span>
12. <span data-ttu-id="bfea1-343">Nella sezione **Nome computer** fare clic su **Cambia**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-343">In the **Computer Name** section, click **Change**.</span></span>
13. <span data-ttu-id="bfea1-344">Selezionare la casella di controllo **Dominio**, digitare **corp.contoso.com** nella casella di testo e quindi fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-344">Select the **Domain** check box, type **corp.contoso.com** in the text box, and then click **OK**.</span></span>
14. <span data-ttu-id="bfea1-345">Nella finestra di dialogo **Sicurezza di Windows** specificare le credenziali per l'account amministratore di dominio predefinito (**CORP\AzureAdmin**) e la password (**Contoso!000**).</span><span class="sxs-lookup"><span data-stu-id="bfea1-345">In the **Windows Security** dialog box, specify the credentials for the default domain administrator account (**CORP\AzureAdmin**) and the password (**Contoso!000**).</span></span>
15. <span data-ttu-id="bfea1-346">uando viene visualizzato il messaggio di benvenuto nel dominio corp.contoso.com, fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-346">When you see the "Welcome to the corp.contoso.com domain" message, click **OK**.</span></span>
16. <span data-ttu-id="bfea1-347">Fare clic su **Chiudi** > **Riavvia ora** nella finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="bfea1-347">Click **Close** > **Restart Now** in the dialog box.</span></span>

### <a name="add-the-corpinstall-user-as-an-administrator-on-each-virtual-machine"></a><span data-ttu-id="bfea1-348">Aggiungere l'utente Corp\Install come amministratore in ogni macchina virtuale</span><span class="sxs-lookup"><span data-stu-id="bfea1-348">Add the Corp\Install user as an administrator on each virtual machine</span></span>
1. <span data-ttu-id="bfea1-349">Attendere fino al riavvio della macchina virtuale e quindi aprire di nuovo il file RDP per accedere alla macchina virtuale con l'account **BUILTIN\AzureAdmin**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-349">Wait until the virtual machine restarts, and then open the RDP file again to sign in to the virtual machine by using the **BUILTIN\AzureAdmin** account.</span></span>
2. <span data-ttu-id="bfea1-350">In **Server Manager** fare clic su **Strumenti** > **Gestione computer**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-350">In **Server Manager** click **Tools** > **Computer Management**.</span></span>
   
    ![Gestione computer](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC784630.png)
3. <span data-ttu-id="bfea1-352">Nella finestra di dialogo **Gestione computer** espandere **Utenti e gruppi locali** e quindi fare clic su **Gruppi**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-352">In the **Computer Management** dialog box, expand **Local Users and Groups**, and then click **Groups**.</span></span>
4. <span data-ttu-id="bfea1-353">Fare doppio clic sul gruppo **Administrators** .</span><span class="sxs-lookup"><span data-stu-id="bfea1-353">Double-click the **Administrators** group.</span></span>
5. <span data-ttu-id="bfea1-354">Nella finestra di dialogo **Proprietà Administrators** fare clic su pulsante **Aggiungi**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-354">In the **Administrators Properties** dialog box, click the **Add** button.</span></span>
6. <span data-ttu-id="bfea1-355">Immettere l'utente **CORP\Install** e quindi fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-355">Enter the user **CORP\Install**, and then click **OK**.</span></span> <span data-ttu-id="bfea1-356">Alla richiesta delle credenziali, usare l'account **AzureAdmin** con la password **Contoso!000**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-356">When prompted for credentials, use the **AzureAdmin** account with the **Contoso!000** password.</span></span>
7. <span data-ttu-id="bfea1-357">Fare clic su **OK** per chiudere la finestra di dialogo **Proprietà Administrators**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-357">Click **OK** to close the **Administrator Properties** dialog box.</span></span>

### <a name="add-the-failover-clustering-feature-to-each-virtual-machine"></a><span data-ttu-id="bfea1-358">Aggiungere la funzionalità Clustering di failover a ogni macchina virtuale</span><span class="sxs-lookup"><span data-stu-id="bfea1-358">Add the Failover Clustering feature to each virtual machine</span></span>
1. <span data-ttu-id="bfea1-359">Nel dashboard **Server Manager** fare clic su **Aggiungi ruoli e funzionalità**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-359">In the **Server Manager** dashboard, click **Add roles and features**.</span></span>
2. <span data-ttu-id="bfea1-360">In **Aggiunta guidata ruoli e funzionalità** fare clic su **Avanti** fino a visualizzare la pagina **Funzionalità**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-360">In the **Add Roles and Features Wizard**, click **Next** until you get to the **Features** page.</span></span>
3. <span data-ttu-id="bfea1-361">Selezionare **Clustering di failover**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-361">Select **Failover Clustering**.</span></span> <span data-ttu-id="bfea1-362">Quando richiesto, aggiungere altre funzionalità dipendenti.</span><span class="sxs-lookup"><span data-stu-id="bfea1-362">When prompted, add other dependent features.</span></span>
   
    ![Aggiungere la funzionalità Clustering di failover alla macchina virtuale](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC784631.png)
4. <span data-ttu-id="bfea1-364">Fare clic su **Avanti**, quindi su **Installa** nella pagina **Conferma**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-364">Click **Next**, and then click **Install** on the **Confirmation** page.</span></span>
5. <span data-ttu-id="bfea1-365">Al termine dell'installazione della funzionalità **Clustering di failover** fare clic su **Chiudi**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-365">When the **Failover Clustering** feature installation is finished, click **Close**.</span></span>
6. <span data-ttu-id="bfea1-366">Disconnettersi dalla macchina virtuale.</span><span class="sxs-lookup"><span data-stu-id="bfea1-366">Sign out of the virtual machine.</span></span>
7. <span data-ttu-id="bfea1-367">Ripetere i passaggi di questa sezione per tutti i tre server, ovvero **ContosoWSFCNode**, **ContosoSQL1** e **ContosoSQL2**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-367">Repeat the steps in this section for all three servers: **ContosoWSFCNode**, **ContosoSQL1**, and **ContosoSQL2**.</span></span>

<span data-ttu-id="bfea1-368">Completato il provisioning, le macchine virtuali di SQL Server sono in esecuzione, ma ognuna è stata installata con le opzioni predefinite di SQL Server.</span><span class="sxs-lookup"><span data-stu-id="bfea1-368">The SQL Server virtual machines are now provisioned and running, but each has the default options for SQL Server.</span></span>

## <a name="create-the-failover-cluster"></a><span data-ttu-id="bfea1-369">Creare il cluster di failover</span><span class="sxs-lookup"><span data-stu-id="bfea1-369">Create the failover cluster</span></span>
<span data-ttu-id="bfea1-370">In questa sezione si crea il cluster di failover che ospiterà il gruppo di disponibilità creato in seguito.</span><span class="sxs-lookup"><span data-stu-id="bfea1-370">In this section, you create the failover cluster that will host the availability group that you will create later.</span></span> <span data-ttu-id="bfea1-371">A questo punto dovrebbero essere state completate le operazioni indicate di seguito per ognuna delle tre macchine virtuali che verranno usate nel cluster di failover:</span><span class="sxs-lookup"><span data-stu-id="bfea1-371">By now, you should have done the following to each of the three virtual machines that you will use in the failover cluster:</span></span>

* <span data-ttu-id="bfea1-372">Provisioning completo in Azure</span><span class="sxs-lookup"><span data-stu-id="bfea1-372">Fully provisioned the virtual machine in Azure</span></span>
* <span data-ttu-id="bfea1-373">Aggiunta della macchina virtuale al dominio</span><span class="sxs-lookup"><span data-stu-id="bfea1-373">Joined the virtual machine to the domain</span></span>
* <span data-ttu-id="bfea1-374">Aggiunta di **CORP\Install** al gruppo Administrators locale</span><span class="sxs-lookup"><span data-stu-id="bfea1-374">Added **CORP\Install** to the local Administrators group</span></span>
* <span data-ttu-id="bfea1-375">Aggiunta della funzionalità Clustering di failover</span><span class="sxs-lookup"><span data-stu-id="bfea1-375">Added the failover clustering feature</span></span>

<span data-ttu-id="bfea1-376">Per ogni macchina virtuale, tutte queste operazioni sono prerequisiti che devono essere soddisfatti prima di aggiungere la macchina virtuale al cluster di failover.</span><span class="sxs-lookup"><span data-stu-id="bfea1-376">All these are prerequisites on each virtual machine before you can join it to the failover cluster.</span></span>

<span data-ttu-id="bfea1-377">Si noti inoltre che la rete virtuale di Azure non si comporta nello stesso modo di una rete locale.</span><span class="sxs-lookup"><span data-stu-id="bfea1-377">Also, note that the Azure virtual network does not behave in the same way as an on-premises network.</span></span> <span data-ttu-id="bfea1-378">È necessario creare il cluster nel seguente ordine:</span><span class="sxs-lookup"><span data-stu-id="bfea1-378">You need to create the cluster in the following order:</span></span>

1. <span data-ttu-id="bfea1-379">Creare un cluster a nodo singolo in uno dei nodi (**ContosoSQL1**).</span><span class="sxs-lookup"><span data-stu-id="bfea1-379">Create a single-node cluster on one node (**ContosoSQL1**).</span></span>
2. <span data-ttu-id="bfea1-380">Modificare l'indirizzo IP del cluster in un indirizzo IP non usato (**10.10.2.101**).</span><span class="sxs-lookup"><span data-stu-id="bfea1-380">Modify the cluster IP address to an unused IP address (**10.10.2.101**).</span></span>
3. <span data-ttu-id="bfea1-381">Portare il nome del cluster online.</span><span class="sxs-lookup"><span data-stu-id="bfea1-381">Bring the cluster name online.</span></span>
4. <span data-ttu-id="bfea1-382">Aggiungere gli altri nodi (**ContosoSQL2** e **ContosoWSFCNode**).</span><span class="sxs-lookup"><span data-stu-id="bfea1-382">Add the other nodes (**ContosoSQL2** and **ContosoWSFCNode**).</span></span>

<span data-ttu-id="bfea1-383">Seguire questa procedura per completare le attività per configurare completamente il cluster.</span><span class="sxs-lookup"><span data-stu-id="bfea1-383">Use the following steps to complete the tasks that fully configure the cluster.</span></span>

1. <span data-ttu-id="bfea1-384">Aprire il file RDP per **ContosoSQL1** e accedere con l'account di dominio **CORP\Install**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-384">Open the RDP file for **ContosoSQL1**, and sign in by using the domain account **CORP\Install**.</span></span>
2. <span data-ttu-id="bfea1-385">Nel dashborad **Server Manager** fare clic su **Strumenti** > **Gestione cluster di failover**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-385">In the **Server Manager** dashboard, click **Tools** > **Failover Cluster Manager**.</span></span>
3. <span data-ttu-id="bfea1-386">Nel riquadro a sinistra fare clic con il pulsante destro del mouse su **Gestione cluster di failover** e quindi scegliere **Crea cluster**, come illustrato nella schermata seguente.</span><span class="sxs-lookup"><span data-stu-id="bfea1-386">In the left pane, right-click **Failover Cluster Manager**, and then click **Create a Cluster**, as shown in the following screenshot.</span></span>
   
    ![Creare cluster](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC784632.png)
4. <span data-ttu-id="bfea1-388">Nella Creazione guidata Cluster creare un cluster a un nodo procedendo nelle pagine con le impostazioni della tabella seguente:</span><span class="sxs-lookup"><span data-stu-id="bfea1-388">In the Create Cluster Wizard, create a one-node cluster by stepping through the pages and using the settings in the following table:</span></span>
   
   | <span data-ttu-id="bfea1-389">Page</span><span class="sxs-lookup"><span data-stu-id="bfea1-389">Page</span></span> | <span data-ttu-id="bfea1-390">Impostazioni</span><span class="sxs-lookup"><span data-stu-id="bfea1-390">Settings</span></span> |
   | --- | --- |
   | <span data-ttu-id="bfea1-391">Prima di iniziare</span><span class="sxs-lookup"><span data-stu-id="bfea1-391">Before You Begin</span></span> |<span data-ttu-id="bfea1-392">Valori predefiniti</span><span class="sxs-lookup"><span data-stu-id="bfea1-392">Use defaults</span></span> |
   | <span data-ttu-id="bfea1-393">Selezione dei server</span><span class="sxs-lookup"><span data-stu-id="bfea1-393">Select Servers</span></span> |<span data-ttu-id="bfea1-394">Digitare **ContosoSQL1** in **Immettere il nome del server** e fare clic su **Aggiungi**</span><span class="sxs-lookup"><span data-stu-id="bfea1-394">Type **ContosoSQL1** in **Enter server name** and click **Add**</span></span> |
   | <span data-ttu-id="bfea1-395">Avviso di convalida</span><span class="sxs-lookup"><span data-stu-id="bfea1-395">Validation Warning</span></span> |<span data-ttu-id="bfea1-396">Selezionare **No. Non è necessario il supporto di Microsoft per il cluster e pertanto non desidero eseguire i test di convalida. Facendo clic su Avanti verrà proseguita la creazione del cluster**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-396">Select **No. I do not require support from Microsoft for this cluster, and therefore do not want to run the validation tests. When I click Next, continue creating the cluster**.</span></span> |
   | <span data-ttu-id="bfea1-397">Punto di accesso per l'amministrazione del cluster</span><span class="sxs-lookup"><span data-stu-id="bfea1-397">Access Point for Administering the Cluster</span></span> |<span data-ttu-id="bfea1-398">Digitare **Cluster1** in **Nome cluster**</span><span class="sxs-lookup"><span data-stu-id="bfea1-398">Type **Cluster1** in **Cluster Name**</span></span> |
   | <span data-ttu-id="bfea1-399">Conferma</span><span class="sxs-lookup"><span data-stu-id="bfea1-399">Confirmation</span></span> |<span data-ttu-id="bfea1-400">Usare le impostazioni predefinite a meno a meno che non si usino spazi di archiviazione.</span><span class="sxs-lookup"><span data-stu-id="bfea1-400">Use defaults unless you are using Storage Spaces.</span></span> <span data-ttu-id="bfea1-401">Vedere l'avviso successivo alla tabella.</span><span class="sxs-lookup"><span data-stu-id="bfea1-401">See the warning following this table.</span></span> |
   
   > [!WARNING]
   > <span data-ttu-id="bfea1-402">Se si usa la funzionalità [Spazi di archiviazione](https://technet.microsoft.com/library/hh831739), che raggruppa più dischi in pool di archiviazione, è necessario deselezionare la casella di controllo **Aggiungi tutte le risorse di archiviazione idonee al cluster** nella pagina **Conferma**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-402">If you are using [Storage Spaces](https://technet.microsoft.com/library/hh831739), which groups multiple disks into storage pools, you must clear the **Add all eligible storage to the cluster** check box on the **Confirmation** page.</span></span> <span data-ttu-id="bfea1-403">Se non si deseleziona questa opzione, i dischi virtuali vengono disconnessi durante il processo di clustering</span><span class="sxs-lookup"><span data-stu-id="bfea1-403">If you do not clear this option, the virtual disks will be detached during the clustering process.</span></span> <span data-ttu-id="bfea1-404">e di conseguenza non vengono visualizzati in Gestione disco o in Esplora risorse fino a quando gli spazi di archiviazione non vengono rimossi dal cluster e ricollegati tramite PowerShell.</span><span class="sxs-lookup"><span data-stu-id="bfea1-404">As a result, they will also not appear in Disk Manager or Explorer until the storage spaces are removed from the cluster and reattached by using PowerShell.</span></span>
   > 
   > 
5. <span data-ttu-id="bfea1-405">Nel riquadro a sinistra espandere **Gestione cluster di failover** e quindi fare clic su **Cluster1.corp.contoso.com**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-405">In the left pane, expand **Failover Cluster Manager**, and then click **Cluster1.corp.contoso.com**.</span></span>
6. <span data-ttu-id="bfea1-406">Nel riquadro centrale scorrere verso il basso fino alla sezione **Risorse principali del cluster** ed espandere i dettagli **Nome: Cluster1**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-406">In the center pane, scroll down to the **Cluster Core Resources** section, and expand the **Name: Clutser1** details.</span></span> <span data-ttu-id="bfea1-407">Lo stato visualizzato di entrambe le risorse **Nome** e **Indirizzo IP** deve essere **Operazione non riuscita**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-407">You should see both the **Name** and the **IP Address** resources in the **Failed** state.</span></span> <span data-ttu-id="bfea1-408">La risorsa Indirizzo IP non può essere portata online poiché al cluster è assegnato lo stesso indirizzo IP della macchina, ovvero si tratta di un indirizzo duplicato.</span><span class="sxs-lookup"><span data-stu-id="bfea1-408">The IP address resource cannot be brought online because the cluster is assigned the same IP address as the machine itself, which is a duplicate address.</span></span>
7. <span data-ttu-id="bfea1-409">Fare clic con il pulsante destro del mouse sulla risorsa **Indirizzo IP** non riuscita, quindi scegliere **Proprietà**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-409">Right-click the failed **IP Address** resource, and then click **Properties**.</span></span>
   
    ![Proprietà del cluster](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC784633.png)
8. <span data-ttu-id="bfea1-411">Selezionare **Indirizzo IP statico**, specificare **10.10.2.101** nella casella di testo **Indirizzo** e quindi fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-411">Select **Static IP Address**, specify **10.10.2.101** in the **Address** text box, and then click **OK**.</span></span>
9. <span data-ttu-id="bfea1-412">Nella sezione **Risorse principali del cluster** fare clic con il pulsante destro del mouse su **Nome: Cluster1** e quindi scegliere **Porta online**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-412">In the **Cluster Core Resources** section, right-click **Name: Cluster1**, and then click **Bring Online**.</span></span> <span data-ttu-id="bfea1-413">Attendere finché entrambe le risorse non siano online.</span><span class="sxs-lookup"><span data-stu-id="bfea1-413">Wait until both resources are online.</span></span> <span data-ttu-id="bfea1-414">Quando la risorsa del nome cluster torna online, il server del controller di dominio viene aggiornato con un nuovo account del computer Active Directory.</span><span class="sxs-lookup"><span data-stu-id="bfea1-414">When the cluster name resource comes online, the DC server is updated with a new Active Directory computer account.</span></span> <span data-ttu-id="bfea1-415">Tale account verrà usato per eseguire il servizio del cluster del gruppo di disponibilità in un secondo momento.</span><span class="sxs-lookup"><span data-stu-id="bfea1-415">This Active Directory account will be used to run the availability group clustered service later.</span></span>
10. <span data-ttu-id="bfea1-416">Aggiungere i rimanenti nodi al cluster.</span><span class="sxs-lookup"><span data-stu-id="bfea1-416">Add the remaining nodes to the cluster.</span></span> <span data-ttu-id="bfea1-417">Nella struttura del browser fare clic con il pulsante destro del mouse su **Cluster1.corp.contoso.com** e quindi scegliere **Aggiungi nodo** come illustrato nella schermata seguente.</span><span class="sxs-lookup"><span data-stu-id="bfea1-417">In the browser tree, right-click **Cluster1.corp.contoso.com**, and then click **Add Node**, as shown in the following screenshot.</span></span>
    
     ![Aggiungere un nodo al cluster](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC784634.png)
11. <span data-ttu-id="bfea1-419">In **Aggiunta guidata nodi** fare clic su **Avanti**. Nella pagina **Selezione dei server** aggiungere **ContosoSQL2** e **ContosoWSFCNode** all'elenco digitando il nome del server in **Immettere il nome del server** e quindi facendo clic su **Aggiungi**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-419">In the **Add Node Wizard**, click **Next** on the **Select Servers** page, add **ContosoSQL2** and **ContosoWSFCNode** to the list by typing the server name in **Enter server name** and then clicking **Add**.</span></span> <span data-ttu-id="bfea1-420">Al termine dell'operazione, scegliere **Avanti**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-420">When you are done, click **Next**.</span></span>
12. <span data-ttu-id="bfea1-421">Nella pagina **Avviso di convalida** fare clic su **No**. In uno scenario di produzione è necessario tuttavia eseguire i test di convalida.</span><span class="sxs-lookup"><span data-stu-id="bfea1-421">On the **Validation Warning** page, click **No**, although in a production scenario, you should perform the validation tests.</span></span> <span data-ttu-id="bfea1-422">Quindi fare clic su **Next**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-422">Then, click **Next**.</span></span>
13. <span data-ttu-id="bfea1-423">Nella pagina **Conferma** fare clic su **Avanti** per aggiungere i nodi.</span><span class="sxs-lookup"><span data-stu-id="bfea1-423">On the **Confirmation** page, click **Next** to add the nodes.</span></span>
    
    > [!WARNING]
    > <span data-ttu-id="bfea1-424">Se si usa la funzionalità [Spazi di archiviazione](https://technet.microsoft.com/library/hh831739), che raggruppa più dischi in pool di archiviazione, è necessario deselezionare la casella di controllo **Aggiungi tutte le risorse di archiviazione idonee al cluster** .</span><span class="sxs-lookup"><span data-stu-id="bfea1-424">If you are using [Storage Spaces](https://technet.microsoft.com/library/hh831739), which groups multiple disks into storage pools, you must clear the **Add all eligible storage to the cluster** check box.</span></span> <span data-ttu-id="bfea1-425">Se non si deseleziona questa opzione, i dischi virtuali vengono disconnessi durante il processo di clustering</span><span class="sxs-lookup"><span data-stu-id="bfea1-425">If you do not clear this option, the virtual disks will be detached during the clustering process.</span></span> <span data-ttu-id="bfea1-426">Di conseguenza, non vengono visualizzati in Gestione disco o in Esplora risorse fino a quando gli spazi di archiviazione non vengono rimossi dal cluster e ricollegati tramite PowerShell.</span><span class="sxs-lookup"><span data-stu-id="bfea1-426">As a result, they will also not appear in Disk Manager or Explorer until the storage spaces are removed from cluster and reattached using PowerShell.</span></span>
    > 
    > 
14. <span data-ttu-id="bfea1-427">Dopo aver aggiunto i nodi al cluster, fare clic su **Fine**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-427">After the nodes are added to the cluster, click **Finish**.</span></span> <span data-ttu-id="bfea1-428">A questo punto, Gestione cluster di failover visualizza il cluster con i tre nodi elencati nel contenitore **Nodi** .</span><span class="sxs-lookup"><span data-stu-id="bfea1-428">Failover Cluster Manager should now show that your cluster has three nodes and list them in the **Nodes** container.</span></span>
15. <span data-ttu-id="bfea1-429">Disconnettersi dalla sessione desktop remoto.</span><span class="sxs-lookup"><span data-stu-id="bfea1-429">Sign out of the remote desktop session.</span></span>

## <a name="prepare-the-sql-server-instances-for-availability-groups"></a><span data-ttu-id="bfea1-430">Preparare le istanze di SQL Server per i gruppi di disponibilità</span><span class="sxs-lookup"><span data-stu-id="bfea1-430">Prepare the SQL Server instances for availability groups</span></span>
<span data-ttu-id="bfea1-431">In questa sezione verranno effettuate le azioni seguenti sia in **ContosoSQL1** che in **contosoSQL2**:</span><span class="sxs-lookup"><span data-stu-id="bfea1-431">In this section, you will do the following on both **ContosoSQL1** and **contosoSQL2**:</span></span>

* <span data-ttu-id="bfea1-432">Aggiungere un account di accesso per **NT AUTHORITY\System** con le autorizzazioni necessarie impostate all'istanza predefinita di SQL Server.</span><span class="sxs-lookup"><span data-stu-id="bfea1-432">Add a login for **NT AUTHORITY\System** with necessary permissions set to the default SQL Server instance.</span></span>
* <span data-ttu-id="bfea1-433">Aggiungere **CORP\Install** come ruolo sysadmin all'istanza predefinita di SQL Server.</span><span class="sxs-lookup"><span data-stu-id="bfea1-433">Add **CORP\Install** as a sysadmin role to the default SQL Server instance.</span></span>
* <span data-ttu-id="bfea1-434">Aprire il firewall per l'accesso remoto di SQL Server.</span><span class="sxs-lookup"><span data-stu-id="bfea1-434">Open the firewall for remote access of SQL Server.</span></span>
* <span data-ttu-id="bfea1-435">Abilitare la funzionalità Gruppi di disponibilità AlwaysOn.</span><span class="sxs-lookup"><span data-stu-id="bfea1-435">Enable the Always On availability groups feature.</span></span>
* <span data-ttu-id="bfea1-436">Impostare l'account del servizio SQL Server su **CORP\SQLSvc1** e **CORP\SQLSvc2** rispettivamente.</span><span class="sxs-lookup"><span data-stu-id="bfea1-436">Change the SQL Server service account to **CORP\SQLSvc1** and **CORP\SQLSvc2**, respectively.</span></span>

<span data-ttu-id="bfea1-437">Queste azioni possono essere eseguite in qualsiasi ordine.</span><span class="sxs-lookup"><span data-stu-id="bfea1-437">These actions can be performed in any order.</span></span> <span data-ttu-id="bfea1-438">I passaggi seguenti vengono tuttavia presentati in ordine.</span><span class="sxs-lookup"><span data-stu-id="bfea1-438">Nevertheless, the following steps will walk through them in order.</span></span> <span data-ttu-id="bfea1-439">Seguire questa procedura sia per **ContosoSQL1**, sia per **ContosoSQL2**:</span><span class="sxs-lookup"><span data-stu-id="bfea1-439">Follow the steps for both **ContosoSQL1** and **ContosoSQL2**:</span></span>

1. <span data-ttu-id="bfea1-440">Disconnettersi dalla sessione desktop remoto, se non è ancora stata eseguita questa operazione.</span><span class="sxs-lookup"><span data-stu-id="bfea1-440">If you have not signed out of the remote desktop session for the virtual machine, do so now.</span></span>
2. <span data-ttu-id="bfea1-441">Aprire i file RDP per **ContosoSQL1** e **ContosoSQL2** e accedere come **BUILTIN\AzureAdmin**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-441">Open the RDP files for **ContosoSQL1** and **ContosoSQL2**, and sign in as **BUILTIN\AzureAdmin**.</span></span>
3. <span data-ttu-id="bfea1-442">Aggiungere prima **NT AUTHORITY\System** agli account di accesso di SQL Server con le autorizzazioni necessarie.</span><span class="sxs-lookup"><span data-stu-id="bfea1-442">Add **NT AUTHORITY\System** to the SQL Server logins with necessary permissions.</span></span> <span data-ttu-id="bfea1-443">Aprire **SQL Server Management Studio**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-443">Open **SQL Server Management Studio**.</span></span>
4. <span data-ttu-id="bfea1-444">Fare clic su **Connetti** per connettersi all'istanza predefinita di SQL Server.</span><span class="sxs-lookup"><span data-stu-id="bfea1-444">Click **Connect** to connect to the default SQL Server instance.</span></span>
5. <span data-ttu-id="bfea1-445">In **Esplora oggetti**, espandere **Sicurezza**, quindi espandere **Account di accesso**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-445">In **Object Explorer**, expand **Security**, and then expand **Logins**.</span></span>
6. <span data-ttu-id="bfea1-446">Fare clic con il pulsante destro del mouse sull'account di accesso **NT AUTHORITY\System** e quindi scegliere **Proprietà**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-446">Right-click the **NT AUTHORITY\System** login, and then click **Properties**.</span></span>
7. <span data-ttu-id="bfea1-447">Nella pagina **Entità a protezione diretta** per il server locale selezionare **Concedi** per le autorizzazioni seguenti e quindi fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-447">On the **Securables** page, for the local server, select **Grant** for the following permissions, and then click **OK**.</span></span>
   
   * <span data-ttu-id="bfea1-448">Alterare eventuali gruppi di disponibilità</span><span class="sxs-lookup"><span data-stu-id="bfea1-448">Alter any availability group</span></span>
   * <span data-ttu-id="bfea1-449">Connettersi a SQL</span><span class="sxs-lookup"><span data-stu-id="bfea1-449">Connect SQL</span></span>
   * <span data-ttu-id="bfea1-450">Visualizzare lo stato del server</span><span class="sxs-lookup"><span data-stu-id="bfea1-450">View server state</span></span>
8. <span data-ttu-id="bfea1-451">Aggiungere **CORP\Install** come ruolo **sysadmin** all'istanza di SQL Server predefinita.</span><span class="sxs-lookup"><span data-stu-id="bfea1-451">Add **CORP\Install** as a **sysadmin** role to the default SQL Server instance.</span></span> <span data-ttu-id="bfea1-452">In **Esplora oggetti** fare clic con il pulsante destro del mouse su **Account di accesso** e quindi scegliere **Nuovo account di accesso**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-452">In **Object Explorer**, right-click **Logins**, and then click **New Login**.</span></span>
9. <span data-ttu-id="bfea1-453">Digitare **CORP\Install** in **Nome account di accesso**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-453">Type **CORP\Install** in **Login name**.</span></span>
10. <span data-ttu-id="bfea1-454">Nella pagina **Ruoli server** fare clic su **sysadmin** e quindi fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-454">On the **Server Roles** page, select **sysadmin**, and then click **OK**.</span></span> <span data-ttu-id="bfea1-455">Dopo aver creato l'account di accesso, è possibile visualizzarlo espandendo **Account di accesso** in **Esplora oggetti**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-455">After you create the login, you can see it by expanding **Logins** in **Object Explorer**.</span></span>
11. <span data-ttu-id="bfea1-456">Per creare una regola del firewall per SQL Server, nella schermata **Start** aprire **Windows Firewall con sicurezza avanzata**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-456">To create a firewall rule for SQL Server, on the **Start** screen, open **Windows Firewall with Advanced Security**.</span></span>
12. <span data-ttu-id="bfea1-457">Nel riquadro sinistro selezionare **Regole connessioni in entrata**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-457">In the left pane, select **Inbound Rules**.</span></span> <span data-ttu-id="bfea1-458">Nel riquadro a destra fare clic su **Nuova regola**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-458">In the right pane, click **New Rule**.</span></span>
13. <span data-ttu-id="bfea1-459">Nella pagina **Tipo di regola** fare clic su **Programma** > **Avanti**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-459">On the **Rule Type** page, click **Program** > **Next**.</span></span>
14. <span data-ttu-id="bfea1-460">Nella pagina **Programmi** selezionare **Percorso programma**, digitare **%ProgramFiles%\Microsoft SQL Server\MSSQL12.MSSQLSERVER\MSSQL\Binn\sqlservr.exe** nella casella di testo e quindi fare clic su **Avanti**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-460">On the **Program** page, select **This program path**, type **%ProgramFiles%\Microsoft SQL Server\MSSQL12.MSSQLSERVER\MSSQL\Binn\sqlservr.exe** in the text box, and then click **Next**.</span></span> <span data-ttu-id="bfea1-461">Se si seguono queste istruzioni, ma si usa SQL Server 2012, la directory di SQL Server è **MSSQL11. MSSQLSERVER**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-461">If you are following these directions but using SQL Server 2012, the SQL Server directory is **MSSQL11.MSSQLSERVER**.</span></span>
15. <span data-ttu-id="bfea1-462">Nella pagina **Azione** mantenere selezionata l'opzione **Consenti la connessione** e quindi fare clic su **Avanti**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-462">On the **Action** page, keep **Allow the connection** selected, and then click **Next**.</span></span>
16. <span data-ttu-id="bfea1-463">Nella pagina **Profilo** accettare le impostazioni predefinite e quindi fare clic su **Avanti**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-463">On the **Profile** page, accept the default settings, and then click **Next**.</span></span>
17. <span data-ttu-id="bfea1-464">Nella pagina **Nome** specificare un nome per la regola, ad esempio **SQL Server (Regola di programma)** nella casella di testo **Nome** e quindi fare clic su **Fine**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-464">On the **Name** page, specify a rule name, such as **SQL Server (Program Rule)**, in the **Name** text box, then click **Finish**.</span></span>
18. <span data-ttu-id="bfea1-465">Per abilitare la funzionalità **Gruppi di disponibilità AlwaysOn**, nella schermata **Start** aprire **Gestione configurazione SQL Server**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-465">To enable the **Always On Availability Groups** feature, on the **Start** screen, open **SQL Server Configuration Manager**.</span></span>
19. <span data-ttu-id="bfea1-466">Nella struttura del browser fare clic su **Servizi di SQL Server**, fare clic con il pulsante destro del mouse sul servizio **SQL Server (MSSQLSERVER)** e quindi scegliere **Proprietà**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-466">In the browser tree, click **SQL Server Services**, right-click the **SQL Server (MSSQLSERVER)** service, and then click **Properties**.</span></span>
20. <span data-ttu-id="bfea1-467">Fare clic sulla scheda **Disponibilità elevata AlwaysOn**, selezionare **Abilita gruppi di disponibilità AlwaysOn**, come illustrato nella schermata seguente, e quindi fare clic su **Applica**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-467">Click the **Always On High Availability** tab, select **Enable Always On Availability Groups**, as shown in the following screenshot, and then click **Apply**.</span></span> <span data-ttu-id="bfea1-468">Fare clic su **OK** nella finestra di dialogo e non chiudere la finestra di dialogo **Proprietà**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-468">Click **OK** in the dialog box, and do not close the **Properties** dialog box yet.</span></span> <span data-ttu-id="bfea1-469">Verrà riavviato il servizio SQL Server dopo la modifica dell'account del servizio.</span><span class="sxs-lookup"><span data-stu-id="bfea1-469">You will restart the SQL Server service after you change the service account.</span></span>
    
     ![Abilita gruppi di disponibilità AlwaysOn](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC665520.gif)
21. <span data-ttu-id="bfea1-471">Per modificare l'account del servizio SQL Server, fare clic sulla scheda **Accesso**, digitare **CORP\SQLSvc1** (per **ContosoSQL1**) o **CORP\SQLSvc2** (per **ContosoSQL2**) in **Nome account**, inserire e confermare la password e quindi fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-471">To change the SQL Server service account, click the **Log On** tab, type **CORP\SQLSvc1** (for **ContosoSQL1**) or **CORP\SQLSvc2** (for **ContosoSQL2**) in **Account Name**, fill in and confirm the password, and then click **OK**.</span></span>
22. <span data-ttu-id="bfea1-472">Nella finestra di dialogo visualizzata fare clic su **Sì** per riavviare il servizio SQL Server.</span><span class="sxs-lookup"><span data-stu-id="bfea1-472">In the dialog box that opens, click **Yes** to restart the SQL Server service.</span></span> <span data-ttu-id="bfea1-473">Dopo il riavvio del servizio SQL Server, vengono applicate le modifiche apportate nella finestra di dialogo **Proprietà**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-473">After the SQL Server service restarts, changes that you made in the **Properties** dialog box are effective.</span></span>
23. <span data-ttu-id="bfea1-474">Disconnettersi dalle macchine virtuali.</span><span class="sxs-lookup"><span data-stu-id="bfea1-474">Sign out of the virtual machines.</span></span>

## <a name="create-the-availability-group"></a><span data-ttu-id="bfea1-475">Creare il gruppo di disponibilità</span><span class="sxs-lookup"><span data-stu-id="bfea1-475">Create the availability group</span></span>
<span data-ttu-id="bfea1-476">A questo punto, è possibile procedere con la configurazione di un gruppo di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="bfea1-476">You are now ready to configure an availability group.</span></span> <span data-ttu-id="bfea1-477">Di seguito è riportata una descrizione delle azioni da eseguire:</span><span class="sxs-lookup"><span data-stu-id="bfea1-477">Below is an outline of what you will do:</span></span>

* <span data-ttu-id="bfea1-478">Creare un nuovo database (**MyDB1**) in **ContosoSQL1**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-478">Create a new database (**MyDB1**) on **ContosoSQL1**.</span></span>
* <span data-ttu-id="bfea1-479">Eseguire un backup completo e un backup del log delle transazioni del database.</span><span class="sxs-lookup"><span data-stu-id="bfea1-479">Take both a full backup and a transaction log backup of the database.</span></span>
* <span data-ttu-id="bfea1-480">Ripristinare i backup completi e del log in **ContosoSQL2** con l'opzione **NORECOVERY**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-480">Restore the full and log backups to **ContosoSQL2** with the **NORECOVERY** option.</span></span>
* <span data-ttu-id="bfea1-481">Creare il gruppo di disponibilità (**AG1**) con commit sincrono, failover automatico e repliche secondarie leggibili.</span><span class="sxs-lookup"><span data-stu-id="bfea1-481">Create the availability group (**AG1**) with synchronous commit, automatic failover, and readable secondary replicas.</span></span>

### <a name="create-the-mydb1-database-on-contososql1"></a><span data-ttu-id="bfea1-482">Creare il database MyDB1 in ContosoSQL1</span><span class="sxs-lookup"><span data-stu-id="bfea1-482">Create the MyDB1 database on ContosoSQL1</span></span>
1. <span data-ttu-id="bfea1-483">Disconnettersi dalle sessioni desktop remoto per **ContosoSQL1** e **ContosoSQL2**, se questa operazione non è ancora stata eseguita.</span><span class="sxs-lookup"><span data-stu-id="bfea1-483">If you have not already signed out of the remote desktop sessions for **ContosoSQL1** and **ContosoSQL2**, do so now.</span></span>
2. <span data-ttu-id="bfea1-484">Aprire il file RDP per **ContosoSQL1** e accedere come **CORP\Install**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-484">Open the RDP file for **ContosoSQL1**, and sign in as **CORP\Install**.</span></span>
3. <span data-ttu-id="bfea1-485">In **Esplora file** creare in **C:\\** una directory denominata **backup**</span><span class="sxs-lookup"><span data-stu-id="bfea1-485">In **File Explorer**, under **C:\\**, create a directory named **backup**.</span></span> <span data-ttu-id="bfea1-486">che verrà usata per eseguire il backup e il ripristino del database.</span><span class="sxs-lookup"><span data-stu-id="bfea1-486">You will use this directory to back up and restore your database.</span></span>
4. <span data-ttu-id="bfea1-487">Fare clic con il pulsante destro del mouse sulla nuova directory, scegliere **Condividi con** e quindi fare clic su **Utenti specifici** come illustrato nella schermata seguente.</span><span class="sxs-lookup"><span data-stu-id="bfea1-487">Right-click the new directory, point to **Share with**, and then click **Specific people**, as shown in the following screenshot.</span></span>
   
    ![Creare una cartella di backup](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC665521.gif)
5. <span data-ttu-id="bfea1-489">Aggiungere **CORP\SQLSvc1** e assegnarvi l'autorizzazione **Lettura/Scrittura**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-489">Add **CORP\SQLSvc1**, and then give it the **Read/Write** permission.</span></span> <span data-ttu-id="bfea1-490">Aggiungere **CORP\SQLSvc2**, assegnarvi l'autorizzazione **Lettura**, come illustrato nella schermata seguente e quindi fare clic su **Condividi**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-490">Add **CORP\SQLSvc2**, and then give it the **Read** permission, as shown in the following screenshot, and then click **Share**.</span></span> <span data-ttu-id="bfea1-491">Al termine del processo di condivisione file, fare clic su **Fatto**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-491">After the file-sharing process is finished, click **Done**.</span></span>
   
    ![Concedere le autorizzazioni per la cartella di backup](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC665522.gif)
6. <span data-ttu-id="bfea1-493">Per creare il database, dal menu **Start** aprire **SQL Server Management Studio** e quindi fare clic su **Connetti** per connettersi all'istanza di SQL Server predefinita.</span><span class="sxs-lookup"><span data-stu-id="bfea1-493">To create the database, from the **Start** menu, open **SQL Server Management Studio**, and then click **Connect** to connect to the default SQL Server instance.</span></span>
7. <span data-ttu-id="bfea1-494">In **Esplora oggetti** fare clic con il pulsante destro del mouse su **Database** e quindi fare clic su **Nuovo database**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-494">In **Object Explorer**, right-click **Databases**, and then click **New Database**.</span></span>
8. <span data-ttu-id="bfea1-495">In **Nome database** digitare **MyDB1** e quindi fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-495">In **Database name**, type **MyDB1**, and then click **OK**.</span></span>

### <a name="make-a-full-backup-of-mydb1-and-restore-it-on-contososql2"></a><span data-ttu-id="bfea1-496">Eseguire un backup completo di MyDB1 e ripristinarlo in ContosoSQL2</span><span class="sxs-lookup"><span data-stu-id="bfea1-496">Make a full backup of MyDB1 and restore it on ContosoSQL2</span></span>
1. <span data-ttu-id="bfea1-497">Per eseguire un backup completo del database, in **Esplora oggetti** espandere **Database**, fare clic con il pulsante destro del mouse su **MyDB1**, scegliere **Attività** e quindi fare clic su **Backup**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-497">To make a full backup of the database, in **Object Explorer**, expand **Databases**, right-click **MyDB1**, point to **Tasks**, and then click **Back Up**.</span></span>
2. <span data-ttu-id="bfea1-498">Nella sezione **Origine** mantenere **Tipo backup** impostato su **Completo**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-498">In the **Source** section, keep **Backup type** set to **Full**.</span></span> <span data-ttu-id="bfea1-499">Nella sezione **Destinazione** fare clic su **Rimuovi** per rimuovere il percorso predefinito del file di backup.</span><span class="sxs-lookup"><span data-stu-id="bfea1-499">In the **Destination** section, click **Remove** to remove the default file path for the backup file.</span></span>
3. <span data-ttu-id="bfea1-500">Nella sezione **Destinazione** fare clic su **Aggiungi**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-500">In the **Destination** section, click **Add**.</span></span>
4. <span data-ttu-id="bfea1-501">Nella casella di testo **Nome file** digitare **\\ContosoSQL1\backup\MyDB1.bak**, fare clic su **OK** e quindi fare clic di nuovo su **OK** per eseguire il backup del database.</span><span class="sxs-lookup"><span data-stu-id="bfea1-501">In the **File name** text box, type **\\ContosoSQL1\backup\MyDB1.bak**, click **OK**, and then click **OK** again to back up the database.</span></span> <span data-ttu-id="bfea1-502">Al termine dell'operazione di backup, fare clic di nuovo su **OK** per chiudere la finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="bfea1-502">When the backup operation finishes, click **OK** again to close the dialog box.</span></span>
5. <span data-ttu-id="bfea1-503">Per eseguire un backup del log delle transazioni, in **Esplora oggetti** espandere **Database**, fare clic con il pulsante destro del mouse su **MyDB1**, scegliere **Attività** e quindi fare clic su **Backup**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-503">To make a transaction log backup of the database, in **Object Explorer**, expand **Databases**, right-click **MyDB1**, point to **Tasks**, and then click **Back Up**.</span></span>
6. <span data-ttu-id="bfea1-504">In **Tipo backup** selezionare **Log delle transazioni**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-504">In **Backup type**, select **Transaction Log**.</span></span> <span data-ttu-id="bfea1-505">In **Destinazione** lasciare il percorso file impostato su quello specificato in precedenza e quindi fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-505">Keep the **Destination** file path set to the one you specified earlier, and then click **OK**.</span></span> <span data-ttu-id="bfea1-506">Al termine dell'operazione di backup, fare clic di nuovo su **OK**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-506">After the backup operation finishes, click **OK** again.</span></span>
7. <span data-ttu-id="bfea1-507">Per ripristinare i backup completo e del log delle transazioni in **ContosoSQL2**, aprire il file RDP per **ContosoSQL2** e accedere come **CORP\Install**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-507">To restore the full and transaction log backups on **ContosoSQL2**, open the RDP file for **ContosoSQL2**, and sign in as **CORP\Install**.</span></span> <span data-ttu-id="bfea1-508">Lasciare aperta la sessione desktop remoto per **ContosoSQL1** .</span><span class="sxs-lookup"><span data-stu-id="bfea1-508">Leave the remote desktop session for **ContosoSQL1** open.</span></span>
8. <span data-ttu-id="bfea1-509">Dal menu **Start** aprire **SQL Server Management Studio** e quindi fare clic su **Connetti** per connettersi all'istanza di SQL Server predefinita.</span><span class="sxs-lookup"><span data-stu-id="bfea1-509">From the **Start** menu, open **SQL Server Management Studio**, and then click **Connect** to connect to the default SQL Server instance.</span></span>
9. <span data-ttu-id="bfea1-510">In **Esplora oggetti** fare clic con il pulsante destro del mouse su **Database** e quindi scegliere **Ripristina database**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-510">In **Object Explorer**, right-click **Databases**, and then click **Restore Database**.</span></span>
10. <span data-ttu-id="bfea1-511">Nella sezione **Origine** selezionare **Dispositivo** e fare clic sul pulsante con i puntini di sospensione **…**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-511">In the **Source** section, select **Device**, and click the ellipsis **…**</span></span> <span data-ttu-id="bfea1-512">.</span><span class="sxs-lookup"><span data-stu-id="bfea1-512">button.</span></span>
11. <span data-ttu-id="bfea1-513">In **Seleziona dispositivi di backup**, fare clic su **Aggiungi**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-513">In **Select backup devices**, click **Add**.</span></span>
12. <span data-ttu-id="bfea1-514">In **Percorso file di backup** digitare **\\ContosoSQL1\backup**, fare clic su **Aggiorna**, selezionare **MyDB1.bak**, fare clic su **OK** e quindi fare clic di nuovo su **OK**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-514">In **Backup file location**, type **\\ContosoSQL1\backup**, click **Refresh**, select **MyDB1.bak**, click **OK**, and then click **OK** again.</span></span> <span data-ttu-id="bfea1-515">A questo punto vengono visualizzati il backup completo e il backup del log nel riquadro **Set di backup da ripristinare**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-515">You should now see the full backup and the log backup in the **Backup sets to restore** pane.</span></span>
13. <span data-ttu-id="bfea1-516">Andare alla pagina **Opzioni**, selezionare **RIPRISTINO CON NORECOVERY** in **Stato di ripristino** e quindi fare clic su **OK** per ripristinare il database.</span><span class="sxs-lookup"><span data-stu-id="bfea1-516">Go to the **Options** page, select **RESTORE WITH NORECOVERY** in **Recovery state**, and then click **OK** to restore the database.</span></span> <span data-ttu-id="bfea1-517">Al termine dell'operazione di ripristino, fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-517">After the restore operation finishes, click **OK**.</span></span>

### <a name="create-the-availability-group"></a><span data-ttu-id="bfea1-518">Creare il gruppo di disponibilità</span><span class="sxs-lookup"><span data-stu-id="bfea1-518">Create the availability group</span></span>
1. <span data-ttu-id="bfea1-519">Tornare alla sessione desktop remoto per **ContosoSQL1**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-519">Go back to the remote desktop session for **ContosoSQL1**.</span></span> <span data-ttu-id="bfea1-520">In **Esplora oggetti** in SQL Server Management Studio fare doppio clic su **Disponibilità elevata AlwaysOn** e quindi fare clic su **Creazione guidata gruppo di disponibilità**, come illustrato nella schermata seguente.</span><span class="sxs-lookup"><span data-stu-id="bfea1-520">In **Object Explorer** in SQL Server Management Studio, right-click **Always On High Availability**, and then click **New Availability Group Wizard**, as shown in the following screenshot.</span></span>
   
    ![Avviare la Creazione guidata del nuovo gruppo di disponibilità](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC665523.gif)
2. <span data-ttu-id="bfea1-522">Nella pagina **Introduzione** fare clic su **Avanti**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-522">On the **Introduction** page, click **Next**.</span></span> <span data-ttu-id="bfea1-523">Nella pagina **Specifica nome del gruppo di disponibilità** digitare **AG1** in **Nome gruppo di disponibilità** e quindi fare di nuovo clic su **Avanti**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-523">On the **Specify Availability Group Name** page, type **AG1** in **Availability group name**, then click **Next** again.</span></span>
   
    ![Creazione guidata del nuovo gruppo di disponibilità: specifica del nome del gruppo di disponibilità](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC665524.gif)
3. <span data-ttu-id="bfea1-525">Nella pagina **Seleziona database** selezionare **MyDB1** e quindi fare clic su **Avanti**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-525">On the **Select Databases** page, select **MyDB1**, and then click **Next**.</span></span> <span data-ttu-id="bfea1-526">Il database soddisfa i prerequisiti per un gruppo di disponibilità in quanto è stato eseguito almeno un backup completo sulla replica primaria usata.</span><span class="sxs-lookup"><span data-stu-id="bfea1-526">The database meets the prerequisites for an availability group because you have taken at least one full backup on the intended primary replica.</span></span>
   
    ![Creazione guidata del nuovo gruppo di disponibilità: selezione dei database](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC665525.gif)
4. <span data-ttu-id="bfea1-528">Nella pagina **Specifica repliche** fare clic su **Aggiungi replica**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-528">on the **Specify Replicas** page, click **Add Replica**.</span></span>
   
    ![Creazione guidata del nuovo gruppo di disponibilità: specifica delle repliche](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC665526.gif)
5. <span data-ttu-id="bfea1-530">Nelle finestra di dialogo **Connetti al server** digitare **ContosoSQL2** in **Nome server** e quindi fare clic su **Connetti**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-530">In the **Connect to Server** dialog box, type **ContosoSQL2** in **Server name**, and then click **Connect**.</span></span>
   
    ![Creazione guidata del nuovo gruppo di disponibilità: connessione al server](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC665527.gif)
6. <span data-ttu-id="bfea1-532">Nella pagina **Specifica repliche** viene visualizzato **ContosoSQL2** nell'elenco **Repliche disponibili**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-532">Back on the **Specify Replicas** page, you should now see **ContosoSQL2** listed in **Available Replicas**.</span></span> <span data-ttu-id="bfea1-533">Configurare le repliche come illustrato nella schermata seguente.</span><span class="sxs-lookup"><span data-stu-id="bfea1-533">Configure the replicas as shown in the following screenshot.</span></span> <span data-ttu-id="bfea1-534">Al termine dell'operazione, scegliere **Avanti**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-534">When you are finished, click **Next**.</span></span>
   
    ![Creazione guidata del nuovo gruppo di disponibilità: specifica delle repliche (completata)](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC665528.gif)
7. <span data-ttu-id="bfea1-536">Nella pagina **Seleziona sincronizzazione dati iniziale** selezionare **Solo join** e quindi fare clic su **Avanti**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-536">On the **Select Initial Data Synchronization** page, select **Join only**, and then click **Next**.</span></span> <span data-ttu-id="bfea1-537">La sincronizzazione dei dati è già stata eseguita manualmente al momento dell'esecuzione dei backup completi e di transazione in **ContosoSQL1** e del ripristino dei dati in **ContosoSQL2**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-537">You already performed data synchronization manually when you made the full and transaction backups on **ContosoSQL1** and restored them on **ContosoSQL2**.</span></span> <span data-ttu-id="bfea1-538">È possibile scegliere di non eseguire le operazioni di backup e ripristino nel database in uso e selezionare **Completo** per consentire l'esecuzione automatica della sincronizzazione dati tramite la Creazione guidata gruppo di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="bfea1-538">You can choose not to perform the backup and restore operations on your database and instead select **Full** to let the New Availability Group Wizard perform data synchronization for you.</span></span> <span data-ttu-id="bfea1-539">Questa opzione, tuttavia, non è consigliata per i database di dimensioni molto grandi presenti in alcune organizzazioni.</span><span class="sxs-lookup"><span data-stu-id="bfea1-539">However, we do not recommend this option for very large databases that are found in some enterprises.</span></span>
   
    ![Creazione guidata del nuovo gruppo di disponibilità: selezione della sincronizzazione dei dati iniziale](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC665529.gif)
8. <span data-ttu-id="bfea1-541">Nella pagina **Convalida** fare clic su **Avanti**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-541">On the **Validation** page, click **Next**.</span></span> <span data-ttu-id="bfea1-542">La pagina dovrebbe essere simile alla schermata seguente.</span><span class="sxs-lookup"><span data-stu-id="bfea1-542">This page should look similar to the following screenshot.</span></span> <span data-ttu-id="bfea1-543">È presente un avviso per la configurazione del listener in quanto non è stato configurato un listener del gruppo di disponibilità.</span><span class="sxs-lookup"><span data-stu-id="bfea1-543">There is a warning for the listener configuration because you have not configured an availability group listener.</span></span> <span data-ttu-id="bfea1-544">È possibile ignorare questo avviso, poiché l'esercitazione non configura alcun listener.</span><span class="sxs-lookup"><span data-stu-id="bfea1-544">You can ignore this warning, because this tutorial does not configure a listener.</span></span> <span data-ttu-id="bfea1-545">Per configurare il listener dopo il completamento dell'esercitazione, vedere [Configurare un listener ILB per gruppi di disponibilità AlwaysOn in Azure](../classic/ps-sql-int-listener.md).</span><span class="sxs-lookup"><span data-stu-id="bfea1-545">To configure the listener after you complete this tutorial, see [Configure an ILB listener for Always On Availability Groups in Azure](../classic/ps-sql-int-listener.md).</span></span>
   
    ![Creazione guidata del nuovo gruppo di disponibilità: convalida](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC665530.gif)
9. <span data-ttu-id="bfea1-547">Nella pagina **Riepilogo** fare clic su **Fine** e quindi attendere il completamento della configurazione del nuovo gruppo di disponibilità tramite la procedura guidata.</span><span class="sxs-lookup"><span data-stu-id="bfea1-547">On the **Summary** page, click **Finish**, and then wait while the wizard configures the new availability group.</span></span> <span data-ttu-id="bfea1-548">Per visualizzare lo stato di avanzamento dettagliato, fare clic su **Altri dettagli** nella pagina **Stato**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-548">On the **Progress** page, you can click **More details** to view the detailed progress.</span></span> <span data-ttu-id="bfea1-549">Al termine della procedura guidata, controllare la pagina **Risultati** per verificare la corretta creazione del gruppo di disponibilità, come illustrato nella schermata seguente, e quindi fare clic su **Chiudi** per uscire dalla procedura guidata.</span><span class="sxs-lookup"><span data-stu-id="bfea1-549">After the wizard finishes, inspect the **Results** page to verify that the availability group is successfully created, as shown in the following screenshot, and then click **Close** to exit the wizard.</span></span>
   
    ![Creazione guidata del nuovo gruppo di disponibilità: risultati](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC665531.gif)
10. <span data-ttu-id="bfea1-551">In **Esplora oggetti** espandere **Disponibilità elevata AlwaysOn** e quindi espandere **Gruppi di disponibilità**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-551">In **Object Explorer**, expand **Always On High Availability**, and then expand **Availability Groups**.</span></span> <span data-ttu-id="bfea1-552">A questo punto viene visualizzato il nuovo gruppo di disponibilità in questo contenitore.</span><span class="sxs-lookup"><span data-stu-id="bfea1-552">You should now see the new availability group in this container.</span></span> <span data-ttu-id="bfea1-553">Fare clic con il pulsante destro del mouse su **AG1 (Primary)** (AG1 (Primario)) e selezionare **Show Dashboard** (Mostra dashboard).</span><span class="sxs-lookup"><span data-stu-id="bfea1-553">Right-click **AG1 (Primary)**, and then click **Show Dashboard**.</span></span>
    
     ![Visualizzare il dashboard del gruppo di disponibilità](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC665532.gif)
11. <span data-ttu-id="bfea1-555">L'aspetto di **Dashboard** deve essere analogo a quello illustrato nella schermata seguente.</span><span class="sxs-lookup"><span data-stu-id="bfea1-555">Your **Always On Dashboard** should look similar to the one in the following screenshot.</span></span> <span data-ttu-id="bfea1-556">È possibile visualizzare le repliche, la modalità di failover di ogni replica e lo stato di sincronizzazione.</span><span class="sxs-lookup"><span data-stu-id="bfea1-556">You can see the replicas, the failover mode of each replica, and the synchronization state.</span></span>
    
     ![Dashboard del gruppo di disponibilità](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC665533.gif)
12. <span data-ttu-id="bfea1-558">Tornare a **Server Manager**, fare clic su **Strumenti** e quindi aprire **Gestione cluster di failover**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-558">Return to **Server Manager**, click **Tools**, and then open **Failover Cluster Manager**.</span></span>
13. <span data-ttu-id="bfea1-559">Espandere **Cluster1.corp.contoso.com**, quindi espandere **Servizi e applicazioni**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-559">Expand **Cluster1.corp.contoso.com**, and then expand **Services and applications**.</span></span> <span data-ttu-id="bfea1-560">Selezionare **Ruoli**. Si noti che è stato creato il ruolo del gruppo di disponibilità **AG1**.</span><span class="sxs-lookup"><span data-stu-id="bfea1-560">Select **Roles** and note that the **AG1** availability group role has been created.</span></span> <span data-ttu-id="bfea1-561">Si noti che AG1 non dispone di alcun indirizzo IP da cui i client del database possono connettersi al gruppo di disponibilità poiché non è stato configurato un listener.</span><span class="sxs-lookup"><span data-stu-id="bfea1-561">Note that AG1 does not have an IP address by which database clients can connect to the availability group, because you did not configure a listener.</span></span> <span data-ttu-id="bfea1-562">È possibile connettersi direttamente al nodo primario per le operazioni di lettura/scrittura e al nodo secondario per le query di sola lettura.</span><span class="sxs-lookup"><span data-stu-id="bfea1-562">You can connect directly to the primary node for read-write operations and the secondary node for read-only queries.</span></span>
    
     ![Gruppo di disponibilità in Gestione cluster di failover](./media/virtual-machines-windows-classic-portal-sql-alwayson-availability-groups/IC665534.gif)

> [!WARNING]
> <span data-ttu-id="bfea1-564">Non tentare di eseguire il failover del gruppo di disponibilità da Gestione cluster di failover.</span><span class="sxs-lookup"><span data-stu-id="bfea1-564">Do not try to fail over the availability group from the Failover Cluster Manager.</span></span> <span data-ttu-id="bfea1-565">Tutte le operazioni di failover devono essere eseguite in **Dashboard AlwaysOn** in SQL Server Management Studio.</span><span class="sxs-lookup"><span data-stu-id="bfea1-565">All failover operations should be performed from within **Always On Dashboard** in SQL Server Management Studio.</span></span> <span data-ttu-id="bfea1-566">Per altre informazioni, vedere [Restrictions on Using The Failover Cluster Manager with Availability Groups](https://msdn.microsoft.com/library/ff929171.aspx) (Limitazioni sull'uso di Gestione cluster di failover con i gruppi di disponibilità).</span><span class="sxs-lookup"><span data-stu-id="bfea1-566">For more information, see [Restrictions on Using The Failover Cluster Manager with Availability Groups](https://msdn.microsoft.com/library/ff929171.aspx).</span></span>
> 
> 

## <a name="next-steps"></a><span data-ttu-id="bfea1-567">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="bfea1-567">Next steps</span></span>
<span data-ttu-id="bfea1-568">SQL Server AlwaysOn è stato correttamente implementato mediante la creazione di un gruppo di disponibilità in Azure.</span><span class="sxs-lookup"><span data-stu-id="bfea1-568">You have now successfully implemented SQL Server Always On by creating an availability group in Azure.</span></span> <span data-ttu-id="bfea1-569">Per configurare un listener per questo gruppo di disponibilità, vedere [Configurare un listener ILB per gruppi di disponibilità Always On in Azure](../classic/ps-sql-int-listener.md).</span><span class="sxs-lookup"><span data-stu-id="bfea1-569">To configure a listener for this availability group, see [Configure an ILB listener for Always On availability groups in Azure](../classic/ps-sql-int-listener.md).</span></span>

<span data-ttu-id="bfea1-570">Per altre informazioni sull'uso di SQL Server in Azure, vedere [SQL Server in Macchine virtuali di Azure](../sql/virtual-machines-windows-sql-server-iaas-overview.md).</span><span class="sxs-lookup"><span data-stu-id="bfea1-570">For other information about using SQL Server in Azure, see [SQL Server on Azure Virtual Machines](../sql/virtual-machines-windows-sql-server-iaas-overview.md).</span></span>

