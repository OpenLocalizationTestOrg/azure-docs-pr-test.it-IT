---
title: hello aaaConfigure estensione dei criteri di rete di Azure MFA | Documenti Microsoft
description: "Dopo aver installato l'estensione dei criteri di rete hello, è possibile usare questi passaggi per la configurazione avanzata come whitelist IP e la sostituzione di UPN."
services: multi-factor-authentication
documentationcenter: 
author: kgremban
manager: femila
ms.assetid: 
ms.service: multi-factor-authentication
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/14/2017
ms.author: kgremban
ms.reviewer: yossib
ms.custom: it-pro
ms.openlocfilehash: c3aed077b23c95f874861eb00c8e6dca668329c1
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/06/2017
---
# <a name="advanced-configuration-options-for-hello-nps-extension-for-multi-factor-authentication"></a><span data-ttu-id="9c231-103">Configurazione opzioni avanzate per hello estensione dei criteri di rete multi-Factor Authentication</span><span class="sxs-lookup"><span data-stu-id="9c231-103">Advanced configuration options for hello NPS extension for Multi-Factor Authentication</span></span>

<span data-ttu-id="9c231-104">Hello estensione dei criteri di rete Server () estende le funzionalità di Azure multi-Factor Authentication basato sul cloud nell'infrastruttura locale.</span><span class="sxs-lookup"><span data-stu-id="9c231-104">hello Network Policy Server (NPS) extension extends your cloud-based Azure Multi-Factor Authentication features into your on-premises infrastructure.</span></span> <span data-ttu-id="9c231-105">Questo articolo si presuppone che si dispone già di estensione hello installato e si decide tooknow come estensione hello toocustomize è necessario.</span><span class="sxs-lookup"><span data-stu-id="9c231-105">This article assumes that you already have hello extension installed, and now want tooknow how toocustomize hello extension for you needs.</span></span> 

## <a name="alternate-login-id"></a><span data-ttu-id="9c231-106">ID di accesso alternativo</span><span class="sxs-lookup"><span data-stu-id="9c231-106">Alternate login ID</span></span>

<span data-ttu-id="9c231-107">Poiché l'estensione dei criteri di rete hello collega tooboth locale e cloud directory, si potrebbe riscontrare un problema in cui i nomi dell'entità utente locale (UPN) non corrispondono nomi hello nel cloud hello.</span><span class="sxs-lookup"><span data-stu-id="9c231-107">Since hello NPS extension connects tooboth your on-premises and cloud directories, you might encounter an issue where your on-premises user principal names (UPNs) don't match hello names in hello cloud.</span></span> <span data-ttu-id="9c231-108">toosolve questo problema, l'uso ID di accesso alternativo.</span><span class="sxs-lookup"><span data-stu-id="9c231-108">toosolve this problem, use alternate login IDs.</span></span> 

<span data-ttu-id="9c231-109">All'interno di hello estensione dei criteri di rete, è possibile designare un toobe di attributi di Active Directory utilizzato al posto di hello UPN per Azure multi-Factor Authentication.</span><span class="sxs-lookup"><span data-stu-id="9c231-109">Within hello NPS extension, you can designate an Active Directory attribute toobe used in place of hello UPN for Azure Multi-Factor Authentication.</span></span> <span data-ttu-id="9c231-110">In questo modo si tooprotect le risorse locali con la verifica senza modificare i nomi UPN locale.</span><span class="sxs-lookup"><span data-stu-id="9c231-110">This enables you tooprotect your on-premises resources with two-step verification without modifying your on-premises UPNs.</span></span> 

<span data-ttu-id="9c231-111">account di accesso alternativo tooconfigure ID, andare troppo`HKLM\SOFTWARE\Microsoft\AzureMfa` e modificare hello valori del Registro di sistema seguente:</span><span class="sxs-lookup"><span data-stu-id="9c231-111">tooconfigure alternate login IDs, go too`HKLM\SOFTWARE\Microsoft\AzureMfa` and edit hello following registry values:</span></span>

| <span data-ttu-id="9c231-112">Nome</span><span class="sxs-lookup"><span data-stu-id="9c231-112">Name</span></span> | <span data-ttu-id="9c231-113">Tipo</span><span class="sxs-lookup"><span data-stu-id="9c231-113">Type</span></span> | <span data-ttu-id="9c231-114">Valore predefinito</span><span class="sxs-lookup"><span data-stu-id="9c231-114">Default value</span></span> | <span data-ttu-id="9c231-115">Descrizione</span><span class="sxs-lookup"><span data-stu-id="9c231-115">Description</span></span> |
| ---- | ---- | ------------- | ----------- |
| <span data-ttu-id="9c231-116">LDAP_ALTERNATE_LOGINID_ATTRIBUTE</span><span class="sxs-lookup"><span data-stu-id="9c231-116">LDAP_ALTERNATE_LOGINID_ATTRIBUTE</span></span> | <span data-ttu-id="9c231-117">string</span><span class="sxs-lookup"><span data-stu-id="9c231-117">string</span></span> | <span data-ttu-id="9c231-118">Empty</span><span class="sxs-lookup"><span data-stu-id="9c231-118">Empty</span></span> | <span data-ttu-id="9c231-119">Definire nome hello dell'attributo di Active Directory che si desidera toouse anziché hello UPN.</span><span class="sxs-lookup"><span data-stu-id="9c231-119">Designate hello name of Active Directory attribute that you want toouse instead of hello UPN.</span></span> <span data-ttu-id="9c231-120">Questo attributo viene utilizzato come attributo AlternateLoginId hello.</span><span class="sxs-lookup"><span data-stu-id="9c231-120">This attribute is used as hello AlternateLoginId attribute.</span></span> <span data-ttu-id="9c231-121">Se questo valore del Registro di sistema è impostato tooa [attributo di Active Directory valido](https://msdn.microsoft.com/library/ms675090.aspx) (ad esempio, posta elettronica o displayName), quindi hello valore dell'attributo è usato al posto UPN dell'utente hello per l'autenticazione.</span><span class="sxs-lookup"><span data-stu-id="9c231-121">If this registry value is set tooa [valid Active Directory attribute](https://msdn.microsoft.com/library/ms675090.aspx) (for example, mail or displayName), then hello attribute's value is used in place of hello user's UPN for authentication.</span></span> <span data-ttu-id="9c231-122">Se questo valore del Registro di sistema è vuoto o non configurato, quindi AlternateLoginId è disabilitata e UPN dell'utente hello viene utilizzato per l'autenticazione.</span><span class="sxs-lookup"><span data-stu-id="9c231-122">If this registry value is empty or not configured, then AlternateLoginId is disabled and hello user's UPN is used for authentication.</span></span> |
| <span data-ttu-id="9c231-123">LDAP_FORCE_GLOBAL_CATALOG</span><span class="sxs-lookup"><span data-stu-id="9c231-123">LDAP_FORCE_GLOBAL_CATALOG</span></span> | <span data-ttu-id="9c231-124">boolean</span><span class="sxs-lookup"><span data-stu-id="9c231-124">boolean</span></span> | <span data-ttu-id="9c231-125">False</span><span class="sxs-lookup"><span data-stu-id="9c231-125">False</span></span> | <span data-ttu-id="9c231-126">Utilizzare questo flag tooforce hello di catalogo globale per le ricerche LDAP per la ricerca di AlternateLoginId.</span><span class="sxs-lookup"><span data-stu-id="9c231-126">Use this flag tooforce hello use of Global Catalog for LDAP searches when looking up AlternateLoginId.</span></span> <span data-ttu-id="9c231-127">Configurare un controller di dominio come catalogo globale, aggiungere hello AlternateLoginId attributo toohello catalogo globale e quindi abilitare questo flag.</span><span class="sxs-lookup"><span data-stu-id="9c231-127">Configure a domain controller as a Global Catalog, add hello AlternateLoginId attribute toohello Global Catalog, and then enable this flag.</span></span> <br><br> <span data-ttu-id="9c231-128">Se è stato configurato (non vuoto), LDAP_LOOKUP_FORESTS **questo flag viene applicato come true**, indipendentemente dal valore di hello dell'impostazione del Registro di sistema di hello.</span><span class="sxs-lookup"><span data-stu-id="9c231-128">If LDAP_LOOKUP_FORESTS is configured (not empty), **this flag is enforced as true**, regardless of hello value of hello registry setting.</span></span> <span data-ttu-id="9c231-129">In questo caso, hello estensione dei criteri di rete richiede toobe di catalogo globale hello configurato con l'attributo AlternateLoginId hello per ogni foresta.</span><span class="sxs-lookup"><span data-stu-id="9c231-129">In this case, hello NPS extension requires hello Global Catalog toobe configured with hello AlternateLoginId attribute for each forest.</span></span> |
| <span data-ttu-id="9c231-130">LDAP_LOOKUP_FORESTS</span><span class="sxs-lookup"><span data-stu-id="9c231-130">LDAP_LOOKUP_FORESTS</span></span> | <span data-ttu-id="9c231-131">string</span><span class="sxs-lookup"><span data-stu-id="9c231-131">string</span></span> | <span data-ttu-id="9c231-132">Empty</span><span class="sxs-lookup"><span data-stu-id="9c231-132">Empty</span></span> | <span data-ttu-id="9c231-133">Specificare un elenco separato da punto e virgola di foreste toosearch.</span><span class="sxs-lookup"><span data-stu-id="9c231-133">Provide a semi-colon separated list of forests toosearch.</span></span> <span data-ttu-id="9c231-134">Ad esempio, *contoso.com;foobar.com*. Se questo valore del Registro di sistema è configurato, hello estensione dei criteri di rete in modo iterativo Cerca tutte le foreste hello in ordine di hello in cui sono elencate e restituisce il valore di AlternateLoginId di hello primo ha esito positivo.</span><span class="sxs-lookup"><span data-stu-id="9c231-134">For example, *contoso.com;foobar.com*. If this registry value is configured, hello NPS extension iteratively searches all hello forests in hello order in which they were listed, and returns hello first successful AlternateLoginId value.</span></span> <span data-ttu-id="9c231-135">Se questo valore del Registro di sistema non è configurato, ricerca AlternateLoginId hello è toohello ristretto di dominio corrente.</span><span class="sxs-lookup"><span data-stu-id="9c231-135">If this registry value is not configured, hello AlternateLoginId lookup is confined toohello current domain.</span></span>|

<span data-ttu-id="9c231-136">tootroubleshoot problemi con l'account di accesso alternativo ID, utilizzare hello indicata le procedure per [errori di ID di accesso alternativo](multi-factor-authentication-nps-errors.md#alternate-login-id-errors).</span><span class="sxs-lookup"><span data-stu-id="9c231-136">tootroubleshoot problems with alternate login IDs, use hello recommended steps for [Alternate login ID errors](multi-factor-authentication-nps-errors.md#alternate-login-id-errors).</span></span>

## <a name="ip-exceptions"></a><span data-ttu-id="9c231-137">Eccezioni IP</span><span class="sxs-lookup"><span data-stu-id="9c231-137">IP exceptions</span></span>

<span data-ttu-id="9c231-138">Se è necessario toomonitor disponibilità del server, ad esempio se i servizi di bilanciamento del carico verificare quali server sono in esecuzione prima di inviare i carichi di lavoro, non si desidera toobe questi controlli bloccata da richieste di verifica.</span><span class="sxs-lookup"><span data-stu-id="9c231-138">If you need toomonitor server availability, like if load balancers verify which servers are running before sending workloads, you don't want these checks toobe blocked by verification requests.</span></span> <span data-ttu-id="9c231-139">Creare quindi un elenco di indirizzi IP sicuramente usati dagli account del servizio e disattivare i requisiti di Multi-Factor Authentication per tale elenco.</span><span class="sxs-lookup"><span data-stu-id="9c231-139">Instead, create a list of IP addresses that you know are used by service accounts, and disable Multi-Factor Authentication requirements for that list.</span></span> 

<span data-ttu-id="9c231-140">tooconfigure una whitelist IP, andare troppo`HKLM\SOFTWARE\Microsoft\AzureMfa` e configurare hello il valore del Registro di sistema seguente:</span><span class="sxs-lookup"><span data-stu-id="9c231-140">tooconfigure an IP whitelist, go too`HKLM\SOFTWARE\Microsoft\AzureMfa` and configure hello following registry value:</span></span> 

| <span data-ttu-id="9c231-141">Nome</span><span class="sxs-lookup"><span data-stu-id="9c231-141">Name</span></span> | <span data-ttu-id="9c231-142">Tipo</span><span class="sxs-lookup"><span data-stu-id="9c231-142">Type</span></span> | <span data-ttu-id="9c231-143">Valore predefinito</span><span class="sxs-lookup"><span data-stu-id="9c231-143">Default value</span></span> | <span data-ttu-id="9c231-144">Descrizione</span><span class="sxs-lookup"><span data-stu-id="9c231-144">Description</span></span> |
| ---- | ---- | ------------- | ----------- |
| <span data-ttu-id="9c231-145">IP_WHITELIST</span><span class="sxs-lookup"><span data-stu-id="9c231-145">IP_WHITELIST</span></span> | <span data-ttu-id="9c231-146">string</span><span class="sxs-lookup"><span data-stu-id="9c231-146">string</span></span> | <span data-ttu-id="9c231-147">Empty</span><span class="sxs-lookup"><span data-stu-id="9c231-147">Empty</span></span> | <span data-ttu-id="9c231-148">Specificare un elenco separato da punti e virgola degli indirizzi IP.</span><span class="sxs-lookup"><span data-stu-id="9c231-148">Provide a semi-colon separated list of IP addresses.</span></span> <span data-ttu-id="9c231-149">Includere gli indirizzi IP hello dei computer in cui hanno origine le richieste di servizio, ad esempio hello server NAS/VPN.</span><span class="sxs-lookup"><span data-stu-id="9c231-149">Include hello IP addresses of machines where service requests originate, like hello NAS/VPN server.</span></span> <span data-ttu-id="9c231-150">Gli intervalli IP di subnet non sono supportati.</span><span class="sxs-lookup"><span data-stu-id="9c231-150">IP ranges are subnets are not supported.</span></span> <br><br> <span data-ttu-id="9c231-151">Ad esempio: *10.0.0.1;10.0.0.2;10.0.0.3*.</span><span class="sxs-lookup"><span data-stu-id="9c231-151">For example, *10.0.0.1;10.0.0.2;10.0.0.3*.</span></span>

<span data-ttu-id="9c231-152">Quando arriva una richiesta da un indirizzo IP presente nell'elenco elementi consentiti hello, verifica in due passaggi viene ignorata.</span><span class="sxs-lookup"><span data-stu-id="9c231-152">When a request comes in from an IP address that exists in hello whitelist, two-step verification is skipped.</span></span> <span data-ttu-id="9c231-153">whitelist IP Hello è indirizzo IP toohello confrontati fornito in hello *ratNASIPAddress* attributi della richiesta RADIUS hello.</span><span class="sxs-lookup"><span data-stu-id="9c231-153">hello IP whitelist is compared toohello IP address that is provided in hello *ratNASIPAddress* attribute of hello RADIUS request.</span></span> <span data-ttu-id="9c231-154">Se arriva una richiesta RADIUS senza attributo ratNASIPAddress hello, viene registrato hello seguente avviso: "Whitelist P_WHITE_LIST_WARNING::IP verrà ignorato perché non è presente nella richiesta RADIUS nell'attributo NasIpAddress IP di origine."</span><span class="sxs-lookup"><span data-stu-id="9c231-154">If a RADIUS request comes in without hello ratNASIPAddress attribute, hello following warning is logged: "P_WHITE_LIST_WARNING::IP Whitelist is being ignored as source IP is missing in RADIUS request in NasIpAddress attribute."</span></span>

## <a name="next-steps"></a><span data-ttu-id="9c231-155">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="9c231-155">Next steps</span></span>

[<span data-ttu-id="9c231-156">Risolvere i messaggi di errore di hello estensione dei criteri di rete per Azure multi-Factor Authentication</span><span class="sxs-lookup"><span data-stu-id="9c231-156">Resolve error messages from hello NPS extension for Azure Multi-Factor Authentication</span></span>](multi-factor-authentication-nps-errors.md)
