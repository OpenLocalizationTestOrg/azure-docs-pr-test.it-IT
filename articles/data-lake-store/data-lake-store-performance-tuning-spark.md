---
title: aaaAzure Data Lake archivio Spark ottimizzazione linee guida | Documenti Microsoft
description: Linee guida per l'ottimizzazione delle prestazioni di Spark in Azure Data Lake Store
services: data-lake-store
documentationcenter: 
author: stewu
manager: amitkul
editor: stewu
ms.assetid: ebde7b9f-2e51-4d43-b7ab-566417221335
ms.service: data-lake-store
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: big-data
ms.date: 12/19/2016
ms.author: stewu
ms.openlocfilehash: da1d172e9cb1199ad95605ea1718e78559f79650
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/06/2017
---
# <a name="performance-tuning-guidance-for-spark-on-hdinsight-and-azure-data-lake-store"></a><span data-ttu-id="633b0-103">Linee guida per l'ottimizzazione delle prestazioni di Spark in HDInsight e di Azure Data Lake Store</span><span class="sxs-lookup"><span data-stu-id="633b0-103">Performance tuning guidance for Spark on HDInsight and Azure Data Lake Store</span></span>

<span data-ttu-id="633b0-104">Quando l'ottimizzazione delle prestazioni in Spark, è necessario numero hello tooconsider di App che verranno eseguiti nel cluster.</span><span class="sxs-lookup"><span data-stu-id="633b0-104">When tuning performance on Spark, you need tooconsider hello number of apps that will be running on your cluster.</span></span>  <span data-ttu-id="633b0-105">Per impostazione predefinita, è possibile eseguire 4 App contemporaneamente nel cluster HDI (Nota: hello impostazione predefinita è soggetto toochange).</span><span class="sxs-lookup"><span data-stu-id="633b0-105">By default, you can run 4 apps concurrently on your HDI cluster (Note: hello default setting is subject toochange).</span></span>  <span data-ttu-id="633b0-106">È possibile decidere toouse meno App in modo è possibile eseguire l'override delle impostazioni predefinite di hello e utilizzare altri cluster hello per le app.</span><span class="sxs-lookup"><span data-stu-id="633b0-106">You may decide toouse fewer apps so you can override hello default settings and use more of hello cluster for those apps.</span></span>  

## <a name="prerequisites"></a><span data-ttu-id="633b0-107">Prerequisiti</span><span class="sxs-lookup"><span data-stu-id="633b0-107">Prerequisites</span></span>

* <span data-ttu-id="633b0-108">**Una sottoscrizione di Azure**.</span><span class="sxs-lookup"><span data-stu-id="633b0-108">**An Azure subscription**.</span></span> <span data-ttu-id="633b0-109">Vedere [Ottenere una versione di valutazione gratuita di Azure](https://azure.microsoft.com/pricing/free-trial/).</span><span class="sxs-lookup"><span data-stu-id="633b0-109">See [Get Azure free trial](https://azure.microsoft.com/pricing/free-trial/).</span></span>
* <span data-ttu-id="633b0-110">**Un account Azure Data Lake Store**.</span><span class="sxs-lookup"><span data-stu-id="633b0-110">**An Azure Data Lake Store account**.</span></span> <span data-ttu-id="633b0-111">Per istruzioni su come toocreate uno, vedere [introduzione archivio Azure Data Lake](data-lake-store-get-started-portal.md)</span><span class="sxs-lookup"><span data-stu-id="633b0-111">For instructions on how toocreate one, see [Get started with Azure Data Lake Store](data-lake-store-get-started-portal.md)</span></span>
* <span data-ttu-id="633b0-112">**Cluster di Azure HDInsight** con accesso tooa account archivio Data Lake.</span><span class="sxs-lookup"><span data-stu-id="633b0-112">**Azure HDInsight cluster** with access tooa Data Lake Store account.</span></span> <span data-ttu-id="633b0-113">Vedere [Creare un cluster HDInsight con Data Lake Store tramite il portale di Azure](data-lake-store-hdinsight-hadoop-use-portal.md).</span><span class="sxs-lookup"><span data-stu-id="633b0-113">See [Create an HDInsight cluster with Data Lake Store](data-lake-store-hdinsight-hadoop-use-portal.md).</span></span> <span data-ttu-id="633b0-114">Assicurarsi di abilitare Desktop remoto per il cluster hello.</span><span class="sxs-lookup"><span data-stu-id="633b0-114">Make sure you enable Remote Desktop for hello cluster.</span></span>
* <span data-ttu-id="633b0-115">**Esecuzione di cluster Spark in Azure Data Lake Store**.</span><span class="sxs-lookup"><span data-stu-id="633b0-115">**Running Spark cluster on Azure Data Lake Store**.</span></span>  <span data-ttu-id="633b0-116">Per ulteriori informazioni, vedere [usare HDInsight Spark cluster tooanalyze dati archivio Data Lake](https://docs.microsoft.com/en-us/azure/hdinsight/hdinsight-apache-spark-use-with-data-lake-store)</span><span class="sxs-lookup"><span data-stu-id="633b0-116">For more information, see [Use HDInsight Spark cluster tooanalyze data in Data Lake Store](https://docs.microsoft.com/en-us/azure/hdinsight/hdinsight-apache-spark-use-with-data-lake-store)</span></span>
* <span data-ttu-id="633b0-117">**Linee guida per l'ottimizzazione delle prestazioni in ADLS**.</span><span class="sxs-lookup"><span data-stu-id="633b0-117">**Performance tuning guidelines on ADLS**.</span></span>  <span data-ttu-id="633b0-118">Per i concetti generali relativi alle prestazioni, vedere [Linee guida per l'ottimizzazione delle prestazioni in Data Lake Store](https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-performance-tuning-guidance)</span><span class="sxs-lookup"><span data-stu-id="633b0-118">For general performance concepts, see [Data Lake Store Performance Tuning Guidance](https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-performance-tuning-guidance)</span></span> 

## <a name="parameters"></a><span data-ttu-id="633b0-119">parameters</span><span class="sxs-lookup"><span data-stu-id="633b0-119">Parameters</span></span>

<span data-ttu-id="633b0-120">Quando si eseguono Spark processi, ecco le impostazioni più importanti hello che possono essere le prestazioni ottimizzate tooincrease ADLS:</span><span class="sxs-lookup"><span data-stu-id="633b0-120">When running Spark jobs, here are hello most important settings that can be tuned tooincrease performance on ADLS:</span></span>

* <span data-ttu-id="633b0-121">**Num executor** -hello numero di attività simultanee che possono essere eseguite.</span><span class="sxs-lookup"><span data-stu-id="633b0-121">**Num-executors** - hello number of concurrent tasks that can be executed.</span></span>

* <span data-ttu-id="633b0-122">**Memoria esecutore** -quantità hello di memoria allocata dell'executor tooeach.</span><span class="sxs-lookup"><span data-stu-id="633b0-122">**Executor-memory** - hello amount of memory allocated tooeach executor.</span></span>

* <span data-ttu-id="633b0-123">**Executor core** -numero hello di core allocati tooeach executor.</span><span class="sxs-lookup"><span data-stu-id="633b0-123">**Executor-cores** - hello number of cores allocated tooeach executor.</span></span>                     

<span data-ttu-id="633b0-124">**Num executor** Num executor imposta il numero massimo di hello delle attività eseguibili in parallelo.</span><span class="sxs-lookup"><span data-stu-id="633b0-124">**Num-executors** Num-executors will set hello maximum number of tasks that can run in parallel.</span></span>  <span data-ttu-id="633b0-125">numero effettivo di Hello di attività che possono eseguire in parallelo è vincolata dalla memoria hello e le risorse di CPU disponibili nel cluster.</span><span class="sxs-lookup"><span data-stu-id="633b0-125">hello actual number of tasks that can run in parallel is bounded by hello memory and CPU resources available in your cluster.</span></span>

<span data-ttu-id="633b0-126">**Memoria esecutore** è hello quantità di memoria allocata dell'executor tooeach.</span><span class="sxs-lookup"><span data-stu-id="633b0-126">**Executor-memory** This is hello amount of memory that is being allocated tooeach executor.</span></span>  <span data-ttu-id="633b0-127">memoria Hello necessaria per ogni esecutore dipende dal processo hello.</span><span class="sxs-lookup"><span data-stu-id="633b0-127">hello memory needed for each executor is dependent on hello job.</span></span>  <span data-ttu-id="633b0-128">Per operazioni complesse, della memoria hello deve toobe superiore.</span><span class="sxs-lookup"><span data-stu-id="633b0-128">For complex operations, hello memory needs toobe higher.</span></span>  <span data-ttu-id="633b0-129">Per operazioni semplici come la lettura e la scrittura, la quantità di memoria richiesta è inferiore.</span><span class="sxs-lookup"><span data-stu-id="633b0-129">For simple operations like read and write, memory requirements will be lower.</span></span>  <span data-ttu-id="633b0-130">Hello quantità di memoria per ogni esecutore possono essere visualizzati in Ambari.</span><span class="sxs-lookup"><span data-stu-id="633b0-130">hello amount of memory for each executor can be viewed in Ambari.</span></span>  <span data-ttu-id="633b0-131">In Ambari, passare tooSpark e visualizzarle scheda configurazioni hello.</span><span class="sxs-lookup"><span data-stu-id="633b0-131">In Ambari, navigate tooSpark and view hello Configs tab.</span></span>  

<span data-ttu-id="633b0-132">**Executor core** Imposta quantità hello di core utilizzati per l'esecutore, che determina il numero di hello di thread paralleli che può essere eseguita ogni executor.</span><span class="sxs-lookup"><span data-stu-id="633b0-132">**Executor-cores** This sets hello amount of cores used per executor, which determines hello number of parallel threads that can be run per executor.</span></span>  <span data-ttu-id="633b0-133">Ad esempio, se executor Core = 2, quindi ogni esecutore è possibile eseguire attività in parallelo 2 in executor hello.</span><span class="sxs-lookup"><span data-stu-id="633b0-133">For example, if executor-cores = 2, then each executor can run 2 parallel tasks in hello executor.</span></span>  <span data-ttu-id="633b0-134">executor Hello-core necessarie saranno dipende dal processo hello.</span><span class="sxs-lookup"><span data-stu-id="633b0-134">hello executor-cores needed will be dependent on hello job.</span></span>  <span data-ttu-id="633b0-135">I processi I/O intensivi non richiedono una grande quantità di memoria per ogni attività. In questo modo, ogni executor può gestire più attività in parallelo.</span><span class="sxs-lookup"><span data-stu-id="633b0-135">I/O heavy jobs do not require a large amount of memory per task so each executor can handle more parallel tasks.</span></span>

<span data-ttu-id="633b0-136">Per impostazione predefinita, durante l'esecuzione di Spark in HDInsight, vengono definiti due core YARN virtuali per ogni core fisico.</span><span class="sxs-lookup"><span data-stu-id="633b0-136">By default, two virtual YARN cores are defined for each physical core when running Spark on HDInsight.</span></span>  <span data-ttu-id="633b0-137">Questo numero fornisce un buon bilanciamento tra concorrenza e quantità di contesto nel passaggio tra più thread.</span><span class="sxs-lookup"><span data-stu-id="633b0-137">This number provides a good balance of concurrecy and amount of context switching from multiple threads.</span></span>  

## <a name="guidance"></a><span data-ttu-id="633b0-138">Indicazioni</span><span class="sxs-lookup"><span data-stu-id="633b0-138">Guidance</span></span>

<span data-ttu-id="633b0-139">Durante l'esecuzione di carichi di lavoro analitici toowork Spark con i dati in archivio Data Lake, è consigliabile utilizzare hello più recente HDInsight versione tooget hello migliori prestazioni con archivio Data Lake.</span><span class="sxs-lookup"><span data-stu-id="633b0-139">While running Spark analytic workloads toowork with data in Data Lake Store, we recommend that you use hello most recent HDInsight version tooget hello best performance with Data Lake Store.</span></span> <span data-ttu-id="633b0-140">Quando il processo è più elevato utilizzo dei / o, determinati parametri possono essere configurato tooimprove prestazioni.</span><span class="sxs-lookup"><span data-stu-id="633b0-140">When your job is more I/O intensive, then certain parameters can be configured tooimprove performance.</span></span>  <span data-ttu-id="633b0-141">Azure Data Lake Store è una piattaforma di archiviazione altamente scalabile in grado di gestire un'elevata velocità effettiva.</span><span class="sxs-lookup"><span data-stu-id="633b0-141">Azure Data Lake Store is a highly scalable storage platform that can handle high throughput.</span></span>  <span data-ttu-id="633b0-142">Se il processo di hello è principalmente costituito da lettura o scrittura, quindi aumentare la concorrenza per tooand dei / o dall'archivio Azure Data Lake di migliorare le prestazioni.</span><span class="sxs-lookup"><span data-stu-id="633b0-142">If hello job mainly consists of read or writes, then increasing concurrency for I/O tooand from Azure Data Lake Store could increase performance.</span></span>

<span data-ttu-id="633b0-143">Esistono alcuni concorrenza di tooincrease metodi generali per i processi con utilizzo intensivo dei / o.</span><span class="sxs-lookup"><span data-stu-id="633b0-143">There are a few general ways tooincrease concurrency for I/O intensive jobs.</span></span>

<span data-ttu-id="633b0-144">**Passaggio 1: Determinare quante applicazioni sono in esecuzione nel cluster** : È necessario conoscere il numero di applicazioni sono in esecuzione nel cluster di hello inclusi hello corrente.</span><span class="sxs-lookup"><span data-stu-id="633b0-144">**Step 1: Determine how many apps are running on your cluster** – You should know how many apps are running on hello cluster including hello current one.</span></span>  <span data-ttu-id="633b0-145">valori predefiniti Hello per ogni Spark impostazione dà per scontato che sono presenti 4 App in esecuzione contemporaneamente.</span><span class="sxs-lookup"><span data-stu-id="633b0-145">hello default values for each Spark setting assumes that there are 4 apps running concurrently.</span></span>  <span data-ttu-id="633b0-146">Pertanto, sarà necessario solo il 25% del cluster di hello disponibili per ogni app.</span><span class="sxs-lookup"><span data-stu-id="633b0-146">Therefore, you will only have 25% of hello cluster available for each app.</span></span>  <span data-ttu-id="633b0-147">tooget ottenere prestazioni migliori, è possibile sostituire i valori predefiniti di hello modificando il numero di hello di executor.</span><span class="sxs-lookup"><span data-stu-id="633b0-147">tooget better performance, you can override hello defaults by changing hello number of executors.</span></span>  

<span data-ttu-id="633b0-148">**Passaggio 2: Impostare l'executor memoria** : hello in primo luogo tooset è hello executor di memoria.</span><span class="sxs-lookup"><span data-stu-id="633b0-148">**Step 2: Set executor-memory** – hello first thing tooset is hello executor-memory.</span></span>  <span data-ttu-id="633b0-149">memoria Hello sarà dipende dal processo hello siano toorun continua.</span><span class="sxs-lookup"><span data-stu-id="633b0-149">hello memory will be dependent on hello job that you are going toorun.</span></span>  <span data-ttu-id="633b0-150">È possibile aumentare la concorrenza allocando una quantità inferiore di memoria per ogni executor.</span><span class="sxs-lookup"><span data-stu-id="633b0-150">You can increase concurrency by allocating less memory per executor.</span></span>  <span data-ttu-id="633b0-151">Se viene visualizzato eccezioni di memoria insufficiente quando si esegue il processo, è necessario aumentare il valore di hello per questo parametro.</span><span class="sxs-lookup"><span data-stu-id="633b0-151">If you see out of memory exceptions when you run your job, then you should increase hello value for this parameter.</span></span>  <span data-ttu-id="633b0-152">Uno alternativo è tooget maggiore quantità di memoria utilizzando un cluster con una maggiore quantità di memoria o aumento delle dimensioni di hello del cluster.</span><span class="sxs-lookup"><span data-stu-id="633b0-152">One alternative is tooget more memory by using a cluster that has higher amounts of memory or increasing hello size of your cluster.</span></span>  <span data-ttu-id="633b0-153">Quantità di memoria consentirà toobe executor più utilizzato, il che significa maggiore concorrenza.</span><span class="sxs-lookup"><span data-stu-id="633b0-153">More memory will enable more executors toobe used, which means more concurrency.</span></span>

<span data-ttu-id="633b0-154">**Passaggio 3: Impostare l'executor core** : i/o intensivo carichi di lavoro che non dispongono di operazioni complesse, è buona toostart con un numero elevato di core di executor tooincrease hello svariate attività in parallelo per ogni executor.</span><span class="sxs-lookup"><span data-stu-id="633b0-154">**Step 3: Set executor-cores** – For I/O intensive workloads that do not have complex operations, it’s good toostart with a high number of executor-cores tooincrease hello number of parallel tasks per executor.</span></span>  <span data-ttu-id="633b0-155">L'impostazione too4 esecutore core è un buon inizio.</span><span class="sxs-lookup"><span data-stu-id="633b0-155">Setting executor-cores too4 is a good start.</span></span>   

    executor-cores = 4
<span data-ttu-id="633b0-156">Aumentare il numero di hello executor core offrirà parallelismo in modo è possibile sperimentare diversi executor-Core.</span><span class="sxs-lookup"><span data-stu-id="633b0-156">Increasing hello number of executor-cores will give you more parallelism so you can experiment with different executor-cores.</span></span>  <span data-ttu-id="633b0-157">Per i processi che includono operazioni più complesse, è necessario ridurre il numero di hello di core per l'esecutore.</span><span class="sxs-lookup"><span data-stu-id="633b0-157">For jobs that have more complex operations, you should reduce hello number of cores per executor.</span></span>  <span data-ttu-id="633b0-158">Se executor-cores viene impostato su un valore superiore a 4, la Garbage Collection può diventare inefficiente e incidere negativamente sulle prestazioni.</span><span class="sxs-lookup"><span data-stu-id="633b0-158">If executor-cores is set higher than 4, then garbage collection may become inefficient and degrade performance.</span></span>

<span data-ttu-id="633b0-159">**Passaggio 4: Determinare la quantità di memoria YARN nel cluster**. Queste informazioni sono disponibili in Ambari.</span><span class="sxs-lookup"><span data-stu-id="633b0-159">**Step 4: Determine amount of YARN memory in cluster** – This information is available in Ambari.</span></span>  <span data-ttu-id="633b0-160">Passare tooYARN e visualizzare scheda configurazioni hello.  memoria YARN Hello viene visualizzato in questa finestra.</span><span class="sxs-lookup"><span data-stu-id="633b0-160">Navigate tooYARN and view hello Configs tab.  hello YARN memory is displayed in this window.</span></span>  
<span data-ttu-id="633b0-161">Nota: quando si è nella finestra di hello, è possibile visualizzare anche dimensioni predefinite del contenitore YARN hello.</span><span class="sxs-lookup"><span data-stu-id="633b0-161">Note: while you are in hello window, you can also see hello default YARN container size.</span></span>  <span data-ttu-id="633b0-162">dimensione del contenitore YARN Hello è hello stesso come memoria per ogni parametro dell'executor.</span><span class="sxs-lookup"><span data-stu-id="633b0-162">hello YARN container size is hello same as memory per executor paramter.</span></span>

    Total YARN memory = nodes * YARN memory per node
<span data-ttu-id="633b0-163">**Passaggio 5: Calcolare num-executors**</span><span class="sxs-lookup"><span data-stu-id="633b0-163">**Step 5: Calculate num-executors**</span></span>

<span data-ttu-id="633b0-164">**Calcolare il vincolo di memoria** -parametro num executor hello è vincolato dalla memoria o CPU.</span><span class="sxs-lookup"><span data-stu-id="633b0-164">**Calculate memory constraint** - hello num-executors parameter is constrained either by memory or by CPU.</span></span>  <span data-ttu-id="633b0-165">limitazione della memoria Hello è determinato dalla quantità di hello di memoria YARN disponibile per l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="633b0-165">hello memory constraint is determined by hello amount of available YARN memory for your application.</span></span>  <span data-ttu-id="633b0-166">Prendere il valore della memoria totale di YARN e dividerlo per il valore executor-memory.</span><span class="sxs-lookup"><span data-stu-id="633b0-166">You should take total YARN memory and divide that by executor-memory.</span></span>  <span data-ttu-id="633b0-167">vincolo Hello deve toobe deallocare dimensionate per numero hello di App in modo che verrà diviso per il numero di hello di App.</span><span class="sxs-lookup"><span data-stu-id="633b0-167">hello constraint needs toobe de-scaled for hello number of apps so we divide by hello number of apps.</span></span>

    Memory constraint = (total YARN memory / executor memory) / # of apps   
<span data-ttu-id="633b0-168">**Calcolare il vincolo di CPU** -hello vincolo relativo alla CPU viene calcolato come totale core virtuali divisi hello numero di core per l'esecutore di hello.</span><span class="sxs-lookup"><span data-stu-id="633b0-168">**Calculate CPU constraint** - hello CPU constraint is calculated as hello total virtual cores divided by hello number of cores per executor.</span></span>  <span data-ttu-id="633b0-169">Per ogni core fisico sono presenti 2 core virtuali.</span><span class="sxs-lookup"><span data-stu-id="633b0-169">There are 2 virtual cores for each physical core.</span></span>  <span data-ttu-id="633b0-170">Limitazione della memoria toohello simile, abbiamo divisione dal numero di hello di App.</span><span class="sxs-lookup"><span data-stu-id="633b0-170">Similar toohello memory constraint, we have divide by hello number of apps.</span></span>

    virtual cores = (nodes in cluster * # of physical cores in node * 2)
    CPU constraint = (total virtual cores / # of cores per executor) / # of apps
<span data-ttu-id="633b0-171">**Impostare l'executor di num** – parametro num executor hello è determinato tenendo hello minimo hello vincoli di memoria e CPU hello.</span><span class="sxs-lookup"><span data-stu-id="633b0-171">**Set num-executors** – hello num-executors parameter is determined by taking hello minimum of hello memory constraint and hello CPU constraint.</span></span> 

    num-executors = Min (total virtual Cores / # of cores per executor, available YARN memory / executor-memory)   
<span data-ttu-id="633b0-172">Impostare un numero maggiore di num-executors non si traduce necessariamente in un miglioramento delle prestazioni.</span><span class="sxs-lookup"><span data-stu-id="633b0-172">Setting a higher number of num-executors does not necessarily increase performance.</span></span>  <span data-ttu-id="633b0-173">Si noti che l'aggiunta di esecutori può comportare un carico extra per ciascuno di questi ultimi, con una potenziale diminuzione delle prestazioni.</span><span class="sxs-lookup"><span data-stu-id="633b0-173">You should consider that adding more executors will add extra overhead for each additional executor, which can potentially degrade performance.</span></span>  <span data-ttu-id="633b0-174">Num executor è limitato da risorse cluster hello.</span><span class="sxs-lookup"><span data-stu-id="633b0-174">Num-executors is bounded by hello cluster resources.</span></span>    

## <a name="example-calculation"></a><span data-ttu-id="633b0-175">Calcolo di esempio</span><span class="sxs-lookup"><span data-stu-id="633b0-175">Example Calculation</span></span>

<span data-ttu-id="633b0-176">Si supponga che si dispone di un cluster costituito da 8 nodi D4v2 2 in esecuzione le applicazioni inclusi hello quello che si sta toorun.</span><span class="sxs-lookup"><span data-stu-id="633b0-176">Let’s say you currently have a cluster composed of 8 D4v2 nodes that is running 2 apps including hello one you are going toorun.</span></span>  

<span data-ttu-id="633b0-177">**Passaggio 1: Determinare quante applicazioni sono in esecuzione nel cluster** : è possibile sapere che si dispone di 2 app nel cluster, inclusi hello uno sarà toorun.</span><span class="sxs-lookup"><span data-stu-id="633b0-177">**Step 1: Determine how many apps are running on your cluster** – you know that you have 2 apps on your cluster, including hello one you are going toorun.</span></span>  

<span data-ttu-id="633b0-178">**Passaggio 2: Impostare executor-memory**. Per questo esempio, si stabilisce che 6 GB di memoria per executor saranno sufficienti per il processo I/O intensivo.</span><span class="sxs-lookup"><span data-stu-id="633b0-178">**Step 2: Set executor-memory** – for this example, we determine that 6GB of executor-memory will be sufficient for I/O intensive job.</span></span>  

    executor-memory = 6GB
<span data-ttu-id="633b0-179">**Passaggio 3: Impostare l'executor core** : poiché si tratta di un processo con utilizzo intensivo dei / o, è possibile impostare il numero di hello di core per ogni too4 executor.</span><span class="sxs-lookup"><span data-stu-id="633b0-179">**Step 3: Set executor-cores** – Since this is an I/O intensive job, we can set hello number of cores for each executor too4.</span></span>  <span data-ttu-id="633b0-180">L'impostazione di core per toolarger executor di 4 può causare problemi di garbage collection.</span><span class="sxs-lookup"><span data-stu-id="633b0-180">Setting cores per executor toolarger than 4 may cause garbage collection problems.</span></span>  

    executor-cores = 4
<span data-ttu-id="633b0-181">**Passaggio 4: Determinare le quantità di memoria YARN cluster** : esplorazione toofind tooAmbari out che ogni D4v2 è 25 GB di memoria YARN.</span><span class="sxs-lookup"><span data-stu-id="633b0-181">**Step 4: Determine amount of YARN memory in cluster** – We navigate tooAmbari toofind out that each D4v2 has 25GB of YARN memory.</span></span>  <span data-ttu-id="633b0-182">Poiché sono presenti 8 nodi, memoria YARN hello viene moltiplicata per 8.</span><span class="sxs-lookup"><span data-stu-id="633b0-182">Since there are 8 nodes, hello available YARN memory is multiplied by 8.</span></span>

    Total YARN memory = nodes * YARN memory* per node
    Total YARN memory = 8 nodes * 25GB = 200GB
<span data-ttu-id="633b0-183">**Passaggio 5: Calcolare num executor** – parametro num executor hello è determinato tenendo hello minima di memoria hello e il vincolo di CPU hello diviso hello n. di App in esecuzione su Spark.</span><span class="sxs-lookup"><span data-stu-id="633b0-183">**Step 5: Calculate num-executors** – hello num-executors parameter is determined by taking hello minimum of hello memory constraint and hello CPU constraint divided by hello # of apps running on Spark.</span></span>    

<span data-ttu-id="633b0-184">**Calcolare il vincolo di memoria** : vincolo memoria hello viene calcolato come memoria YARN totale hello divisa per la memoria hello per executor.</span><span class="sxs-lookup"><span data-stu-id="633b0-184">**Calculate memory constraint** – hello memory constraint is calculated as hello total YARN memory divided by hello memory per executor.</span></span>

    Memory constraint = (total YARN memory / executor memory) / # of apps   
    Memory constraint = (200GB / 6GB) / 2   
    Memory constraint = 16 (rounded)
<span data-ttu-id="633b0-185">**Calcolare il vincolo di CPU** -hello vincolo relativo alla CPU viene calcolato come hello core yarn totale divisi hello numero di core per l'esecutore.</span><span class="sxs-lookup"><span data-stu-id="633b0-185">**Calculate CPU constraint** - hello CPU constraint is calculated as hello total yarn cores divided by hello number of cores per executor.</span></span>
    
    YARN cores = nodes in cluster * # of cores per node * 2   
    YARN cores = 8 nodes * 8 cores per D14 * 2 = 128
    CPU constraint = (total YARN cores / # of cores per executor) / # of apps
    CPU constraint = (128 / 4) / 2
    CPU constraint = 16
<span data-ttu-id="633b0-186">**Impostare num-executors**</span><span class="sxs-lookup"><span data-stu-id="633b0-186">**Set num-executors**</span></span>

    num-executors = Min (memory constraint, CPU constraint)
    num-executors = Min (16, 16)
    num-executors = 16    

