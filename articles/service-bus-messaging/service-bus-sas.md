---
title: Autenticazione del bus di servizio di Azure con firme di accesso condiviso | Documentazione Microsoft
description: Panoramica dell'autenticazione del bus di servizio con firme di accesso condiviso, dettagli dell'autenticazione con firme di accesso condiviso con il bus di servizio.
services: service-bus-messaging
documentationcenter: na
author: sethmanheim
manager: timlt
editor: 
ms.assetid: 
ms.service: service-bus-messaging
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 08/23/2017
ms.author: sethm
ms.openlocfilehash: a2760072acb7c62204759f3ec0d3cb9899460f2d
ms.sourcegitcommit: 18ad9bc049589c8e44ed277f8f43dcaa483f3339
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/29/2017
---
# <a name="service-bus-authentication-with-shared-access-signatures"></a><span data-ttu-id="497e0-103">Autenticazione del bus di servizio con firme di accesso condiviso</span><span class="sxs-lookup"><span data-stu-id="497e0-103">Service Bus authentication with Shared Access Signatures</span></span>

<span data-ttu-id="497e0-104">Le *firme di accesso condiviso* sono il meccanismo di sicurezza principale per la messaggistica del bus di servizio.</span><span class="sxs-lookup"><span data-stu-id="497e0-104">*Shared Access Signatures* (SAS) are the primary security mechanism for Service Bus messaging.</span></span> <span data-ttu-id="497e0-105">Questo articolo illustra le firme di accesso condiviso, il loro funzionamento e come usarle in modo indipendente dalla piattaforma.</span><span class="sxs-lookup"><span data-stu-id="497e0-105">This article discusses SAS, how they work, and how to use them in a platform-agnostic way.</span></span>

<span data-ttu-id="497e0-106">L'autenticazione con firma di accesso condiviso consente alle applicazioni di eseguire l'autenticazione al bus di servizio usando una chiave di accesso configurata nello spazio dei nomi o nell'entità di messaggistica, ad esempio coda o argomento, a cui sono associati diritti specifici.</span><span class="sxs-lookup"><span data-stu-id="497e0-106">SAS authentication enables applications to authenticate to Service Bus using an access key configured on the namespace, or on the messaging entity (queue or topic) with which specific rights are associated.</span></span> <span data-ttu-id="497e0-107">È quindi possibile usare questa chiave per generare un token di firma di accesso condiviso di cui possono avvalersi i client per eseguire l'autenticazione al bus di servizio.</span><span class="sxs-lookup"><span data-stu-id="497e0-107">You can then use this key to generate a SAS token that clients can in turn use to authenticate to Service Bus.</span></span>

<span data-ttu-id="497e0-108">Il supporto per l'autenticazione della firma di accesso condiviso è inclusa in Azure SDK 2.0 e versioni successive.</span><span class="sxs-lookup"><span data-stu-id="497e0-108">SAS authentication support is included in the Azure SDK version 2.0 and later.</span></span>

## <a name="overview-of-sas"></a><span data-ttu-id="497e0-109">Panoramica di SAS</span><span class="sxs-lookup"><span data-stu-id="497e0-109">Overview of SAS</span></span>

<span data-ttu-id="497e0-110">Le firme di accesso condiviso sono un meccanismo di autenticazione basato su hash sicuri SHA-256 o URI.</span><span class="sxs-lookup"><span data-stu-id="497e0-110">Shared Access Signatures are an authentication mechanism based on SHA-256 secure hashes or URIs.</span></span> <span data-ttu-id="497e0-111">SAS è un meccanismo estremamente efficace utilizzato da tutti i servizi del bus di servizio.</span><span class="sxs-lookup"><span data-stu-id="497e0-111">SAS is an extremely powerful mechanism that is used by all Service Bus services.</span></span> <span data-ttu-id="497e0-112">Nell'uso effettivo, SAS presenta due componenti: i *criteri di accesso condiviso* e una *firma di accesso condiviso* che viene spesso chiamata *token*.</span><span class="sxs-lookup"><span data-stu-id="497e0-112">In actual use, SAS has two components: a *shared access policy* and a *Shared Access Signature* (often called a *token*).</span></span>

<span data-ttu-id="497e0-113">Nel bus di servizio, l'autenticazione della firma di accesso condiviso implica la configurazione di una chiave di crittografia con i relativi diritti in una risorsa del bus di servizio.</span><span class="sxs-lookup"><span data-stu-id="497e0-113">SAS authentication in Service Bus involves the configuration of a cryptographic key with associated rights on a Service Bus resource.</span></span> <span data-ttu-id="497e0-114">I client richiedono l'accesso alle risorse del bus di servizio presentando un token di firma di accesso condiviso.</span><span class="sxs-lookup"><span data-stu-id="497e0-114">Clients claim access to Service Bus resources by presenting a SAS token.</span></span> <span data-ttu-id="497e0-115">Questo token è costituito dall'URI della risorsa a cui si accede e da una scadenza firmata con la chiave configurata.</span><span class="sxs-lookup"><span data-stu-id="497e0-115">This token consists of the resource URI being accessed, and an expiry signed with the configured key.</span></span>

<span data-ttu-id="497e0-116">È possibile configurare le regole di autorizzazione della firma di accesso condiviso in [inoltri](service-bus-fundamentals-hybrid-solutions.md#relays), [code](service-bus-fundamentals-hybrid-solutions.md#queues) e [argomenti](service-bus-fundamentals-hybrid-solutions.md#topics) del bus di servizio.</span><span class="sxs-lookup"><span data-stu-id="497e0-116">You can configure Shared Access Signature authorization rules on Service Bus [relays](service-bus-fundamentals-hybrid-solutions.md#relays), [queues](service-bus-fundamentals-hybrid-solutions.md#queues), and [topics](service-bus-fundamentals-hybrid-solutions.md#topics).</span></span>

<span data-ttu-id="497e0-117">L'autenticazione della firma di accesso condiviso usa gli elementi seguenti:</span><span class="sxs-lookup"><span data-stu-id="497e0-117">SAS authentication uses the following elements:</span></span>

* <span data-ttu-id="497e0-118">[Regola di autorizzazione per l'accesso condiviso](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule): una chiave di crittografia primaria a 256 bit in formato Base 64, una chiave secondaria facoltativa e un nome di chiave e i diritti associati (una raccolta di diritti di tipo *Listen*, *Send* o *Manage*).</span><span class="sxs-lookup"><span data-stu-id="497e0-118">[Shared Access authorization rule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule): A 256-bit primary cryptographic key in Base64 representation, an optional secondary key, and a key name and associated rights (a collection of *Listen*, *Send*, or *Manage* rights).</span></span>
* <span data-ttu-id="497e0-119">[firma di accesso condiviso](/dotnet/api/microsoft.servicebus.sharedaccesssignaturetokenprovider) : generato usando l'algoritmo HMAC-SHA256 di una stringa di risorsa, costituito dall'URI della risorsa a cui si accede e da una scadenza, con la chiave di crittografia.</span><span class="sxs-lookup"><span data-stu-id="497e0-119">[Shared Access Signature](/dotnet/api/microsoft.servicebus.sharedaccesssignaturetokenprovider) token: Generated using the HMAC-SHA256 of a resource string, consisting of the URI of the resource that is accessed and an expiry, with the cryptographic key.</span></span> <span data-ttu-id="497e0-120">La firma e gli altri elementi descritti nelle sezioni seguenti vengono formattati in una stringa per formare un token di firma di accesso condiviso.</span><span class="sxs-lookup"><span data-stu-id="497e0-120">The signature and other elements described in the following sections are formatted into a string to form the SAS token.</span></span>

## <a name="shared-access-policy"></a><span data-ttu-id="497e0-121">Criteri di accesso condiviso</span><span class="sxs-lookup"><span data-stu-id="497e0-121">Shared access policy</span></span>

<span data-ttu-id="497e0-122">Un elemento importante da comprendere rispetto alle firme di accesso condiviso è che iniziano con un criterio.</span><span class="sxs-lookup"><span data-stu-id="497e0-122">An important thing to understand about SAS is that it starts with a policy.</span></span> <span data-ttu-id="497e0-123">Per ogni criterio si stabiliscono tre informazioni: **nome**, **ambito** e **autorizzazioni**.</span><span class="sxs-lookup"><span data-stu-id="497e0-123">For each policy, you decide on three pieces of information: **name**, **scope**, and **permissions**.</span></span> <span data-ttu-id="497e0-124">Il **nome** è un nome univoco all'interno dell’ambito.</span><span class="sxs-lookup"><span data-stu-id="497e0-124">The **name** is just that; a unique name within that scope.</span></span> <span data-ttu-id="497e0-125">L'ambito è abbastanza semplice: è l'URI della risorsa in questione.</span><span class="sxs-lookup"><span data-stu-id="497e0-125">The scope is easy enough: it's the URI of the resource in question.</span></span> <span data-ttu-id="497e0-126">Per uno spazio dei nomi del bus di servizio, l'ambito è il nome di dominio completo (FQDN), ad esempio `https://<yournamespace>.servicebus.windows.net/`.</span><span class="sxs-lookup"><span data-stu-id="497e0-126">For a Service Bus namespace, the scope is the fully qualified domain name (FQDN), such as `https://<yournamespace>.servicebus.windows.net/`.</span></span>

<span data-ttu-id="497e0-127">Le autorizzazioni disponibili per un criterio sono in gran parte autoesplicative:</span><span class="sxs-lookup"><span data-stu-id="497e0-127">The available permissions for a policy are largely self-explanatory:</span></span>

* <span data-ttu-id="497e0-128">Invio</span><span class="sxs-lookup"><span data-stu-id="497e0-128">Send</span></span>
* <span data-ttu-id="497e0-129">Attesa</span><span class="sxs-lookup"><span data-stu-id="497e0-129">Listen</span></span>
* <span data-ttu-id="497e0-130">Gestire</span><span class="sxs-lookup"><span data-stu-id="497e0-130">Manage</span></span>

<span data-ttu-id="497e0-131">Dopo aver creato il criterio, gli vengono assegnate una *chiave primaria* e una *chiave secondaria*.</span><span class="sxs-lookup"><span data-stu-id="497e0-131">After you create the policy, it is assigned a *Primary Key* and a *Secondary Key*.</span></span> <span data-ttu-id="497e0-132">Si tratta di chiavi di crittografia complesse.</span><span class="sxs-lookup"><span data-stu-id="497e0-132">These are cryptographically strong keys.</span></span> <span data-ttu-id="497e0-133">Queste chiavi non possono essere perse perché sono sempre disponibili nel [portale di Azure][Azure portal].</span><span class="sxs-lookup"><span data-stu-id="497e0-133">Don't lose them or leak them - they'll always be available in the [Azure portal][Azure portal].</span></span> <span data-ttu-id="497e0-134">È possibile utilizzare una delle chiavi generate ed è possibile rigenerarle in qualsiasi momento.</span><span class="sxs-lookup"><span data-stu-id="497e0-134">You can use either of the generated keys, and you can regenerate them at any time.</span></span> <span data-ttu-id="497e0-135">Tuttavia, se si rigenera o si modifica la chiave primaria nel criterio, le firme di accesso condiviso create da tale chiave verranno invalidate.</span><span class="sxs-lookup"><span data-stu-id="497e0-135">However, if you regenerate or change the primary key in the policy, any Shared Access Signatures created from it will be invalidated.</span></span>

<span data-ttu-id="497e0-136">Quando si crea uno spazio dei nomi del bus di servizio, per l'intero spazio dei nomi viene creato automaticamente un criterio con tutte le autorizzazioni denominato **RootManageSharedAccessKey**.</span><span class="sxs-lookup"><span data-stu-id="497e0-136">When you create a Service Bus namespace, a policy is automatically created for the entire namespace called **RootManageSharedAccessKey**, and this policy has all permissions.</span></span> <span data-ttu-id="497e0-137">Non accedere come **radice** e non usare questo criterio a meno che non esista un motivo molto valido.</span><span class="sxs-lookup"><span data-stu-id="497e0-137">You don't log on as **root**, so don't use this policy unless there's a really good reason.</span></span> <span data-ttu-id="497e0-138">È possibile creare criteri aggiuntivi nella scheda **Configura** per lo spazio dei nomi nel portale.</span><span class="sxs-lookup"><span data-stu-id="497e0-138">You can create additional policies in the **Configure** tab for the namespace in the portal.</span></span> <span data-ttu-id="497e0-139">È importante notare che a un singolo livello della struttura ad albero nel bus di servizio (spazio dei nomi, coda e così via) può essere associato un massimo di 12 criteri.</span><span class="sxs-lookup"><span data-stu-id="497e0-139">It's important to note that a single tree level in Service Bus (namespace, queue, etc.) can only have up to 12 policies attached to it.</span></span>

## <a name="configuration-for-shared-access-signature-authentication"></a><span data-ttu-id="497e0-140">Configurazione dell'autenticazione della firma di accesso condiviso</span><span class="sxs-lookup"><span data-stu-id="497e0-140">Configuration for Shared Access Signature authentication</span></span>
<span data-ttu-id="497e0-141">È possibile configurare la regola [SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule) in spazi dei nomi, code, argomenti del bus di servizio.</span><span class="sxs-lookup"><span data-stu-id="497e0-141">You can configure the [SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule) rule on Service Bus namespaces, queues, or topics.</span></span> <span data-ttu-id="497e0-142">La configurazione di una regola [SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule) in una sottoscrizione del bus di servizio non è attualmente supportata, ma è possibile usare le regole configurate in uno spazio dei nomi o in un argomento per proteggere l'accesso alle sottoscrizioni.</span><span class="sxs-lookup"><span data-stu-id="497e0-142">Configuring a [SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule) on a Service Bus subscription is currently not supported, but you can use rules configured on a namespace or topic to secure access to subscriptions.</span></span> <span data-ttu-id="497e0-143">Per un esempio pratico di questa procedura, vedere l'articolo relativo all' [uso dell'autenticazione della firma di accesso condiviso con le sottoscrizioni del bus di servizio](http://code.msdn.microsoft.com/Using-Shared-Access-e605b37c) .</span><span class="sxs-lookup"><span data-stu-id="497e0-143">For a working sample that illustrates this procedure, see the [Using Shared Access Signature (SAS) authentication with Service Bus Subscriptions](http://code.msdn.microsoft.com/Using-Shared-Access-e605b37c) sample.</span></span>

<span data-ttu-id="497e0-144">In uno spazio dei nomi, una coda o un argomento del bus di servizio è possibile configurare fino 12 regole di questo tipo.</span><span class="sxs-lookup"><span data-stu-id="497e0-144">A maximum of 12 such rules can be configured on a Service Bus namespace, queue, or topic.</span></span> <span data-ttu-id="497e0-145">Le regole configurate in uno spazio dei nomi del bus di servizio si applicano a tutte le entità incluse nello spazio dei nomi.</span><span class="sxs-lookup"><span data-stu-id="497e0-145">Rules that are configured on a Service Bus namespace apply to all entities in that namespace.</span></span>

![SAS](./media/service-bus-sas/service-bus-namespace.png)

<span data-ttu-id="497e0-147">In questa figura le regole di autorizzazione *manageRuleNS*, *sendRuleNS* e *listenRuleNS* si applicano sia alla coda Q1 che all'argomento T1, mentre *listenRuleQ* e *sendRuleQ* si applicano solo alla coda Q1 e *sendRuleT* si applica solo all'argomento T1.</span><span class="sxs-lookup"><span data-stu-id="497e0-147">In this figure, the *manageRuleNS*, *sendRuleNS*, and *listenRuleNS* authorization rules apply to both queue Q1 and topic T1, while *listenRuleQ* and *sendRuleQ* apply only to queue Q1 and *sendRuleT* applies only to topic T1.</span></span>

<span data-ttu-id="497e0-148">I parametri principali di [SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule) sono i seguenti:</span><span class="sxs-lookup"><span data-stu-id="497e0-148">The key parameters of a [SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule) are as follows:</span></span>

| <span data-ttu-id="497e0-149">Parametro</span><span class="sxs-lookup"><span data-stu-id="497e0-149">Parameter</span></span> | <span data-ttu-id="497e0-150">Descrizione</span><span class="sxs-lookup"><span data-stu-id="497e0-150">Description</span></span> |
| --- | --- |
| <span data-ttu-id="497e0-151">*KeyName*</span><span class="sxs-lookup"><span data-stu-id="497e0-151">*KeyName*</span></span> |<span data-ttu-id="497e0-152">Stringa che descrive la regola di autorizzazione.</span><span class="sxs-lookup"><span data-stu-id="497e0-152">A string that describes the authorization rule.</span></span> |
| <span data-ttu-id="497e0-153">*PrimaryKey*</span><span class="sxs-lookup"><span data-stu-id="497e0-153">*PrimaryKey*</span></span> |<span data-ttu-id="497e0-154">Chiave primaria a 256 bit con codifica Base 64 per la firma e la convalida del token di firma di accesso condiviso.</span><span class="sxs-lookup"><span data-stu-id="497e0-154">A base64-encoded 256-bit primary key for signing and validating the SAS token.</span></span> |
| <span data-ttu-id="497e0-155">*SecondaryKey*</span><span class="sxs-lookup"><span data-stu-id="497e0-155">*SecondaryKey*</span></span> |<span data-ttu-id="497e0-156">Chiave secondaria a 256 bit con codifica Base 64 per la firma e la convalida del token di firma di accesso condiviso.</span><span class="sxs-lookup"><span data-stu-id="497e0-156">A base64-encoded 256-bit secondary key for signing and validating the SAS token.</span></span> |
| <span data-ttu-id="497e0-157">*AccessRights*</span><span class="sxs-lookup"><span data-stu-id="497e0-157">*AccessRights*</span></span> |<span data-ttu-id="497e0-158">Elenco di diritti di accesso concessi dalla regola di autorizzazione.</span><span class="sxs-lookup"><span data-stu-id="497e0-158">A list of access rights granted by the authorization rule.</span></span> <span data-ttu-id="497e0-159">Questi diritti possono essere qualsiasi raccolta di diritti di ascolto, invio e gestione.</span><span class="sxs-lookup"><span data-stu-id="497e0-159">These rights can be any collection of Listen, Send, and Manage rights.</span></span> |

<span data-ttu-id="497e0-160">Quando viene eseguito il provisioning di uno spazio dei nomi del bus di servizio, per impostazione predefinita viene creata una regola [SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule), con [KeyName](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule#Microsoft_ServiceBus_Messaging_SharedAccessAuthorizationRule_KeyName) impostato su **RootManageSharedAccessKey**.</span><span class="sxs-lookup"><span data-stu-id="497e0-160">When a Service Bus namespace is provisioned, a [SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule), with [KeyName](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule#Microsoft_ServiceBus_Messaging_SharedAccessAuthorizationRule_KeyName) set to **RootManageSharedAccessKey**, is created by default.</span></span>

## <a name="generate-a-shared-access-signature-token"></a><span data-ttu-id="497e0-161">Generare una firma di accesso condiviso (token)</span><span class="sxs-lookup"><span data-stu-id="497e0-161">Generate a Shared Access Signature (token)</span></span>

<span data-ttu-id="497e0-162">Il criterio non è il token di accesso del bus di servizio.</span><span class="sxs-lookup"><span data-stu-id="497e0-162">The policy itself is not the access token for Service Bus.</span></span> <span data-ttu-id="497e0-163">È l'oggetto da cui viene generato il token di accesso, utilizzando la chiave primaria o secondaria.</span><span class="sxs-lookup"><span data-stu-id="497e0-163">It is the object from which the access token is generated - using either the primary or secondary key.</span></span> <span data-ttu-id="497e0-164">Qualsiasi client che abbia accesso alle chiavi di firma specificate nella regola di autorizzazione di accesso condiviso può generare il token di firma di accesso condiviso.</span><span class="sxs-lookup"><span data-stu-id="497e0-164">Any client that has access to the signing keys specified in the shared access authorization rule can generate the SAS token.</span></span> <span data-ttu-id="497e0-165">Il token viene generato creando attentamente una stringa nel formato seguente:</span><span class="sxs-lookup"><span data-stu-id="497e0-165">The token is generated by carefully crafting a string in the following format:</span></span>

```
SharedAccessSignature sig=<signature-string>&se=<expiry>&skn=<keyName>&sr=<URL-encoded-resourceURI>
```

<span data-ttu-id="497e0-166">Dove `signature-string` è l'hash SHA-256 dell'ambito del token (**ambito** come descritto nella sezione precedente) con un CRLF accodato e una scadenza (in secondi dal periodo: `00:00:00 UTC` l'1 gennaio 1970).</span><span class="sxs-lookup"><span data-stu-id="497e0-166">Where `signature-string` is the SHA-256 hash of the scope of the token (**scope** as described in the previous section) with a CRLF appended and an expiry time (in seconds since the epoch: `00:00:00 UTC` on 1 January 1970).</span></span> 

> [!NOTE]
> <span data-ttu-id="497e0-167">Per evitare che i token scadano rapidamente è consigliabile codificare il valore della scadenza come almeno un numero intero senza segno a 32 bit o preferibilmente un numero intero lungo a 64 bit.</span><span class="sxs-lookup"><span data-stu-id="497e0-167">To avoid a short token expiry time, it is recommended that you encode the expiry time value as at least a 32-bit unsigned integer, or preferably a long (64-bit) integer.</span></span>  
> 
> 

<span data-ttu-id="497e0-168">L'hash è simile al seguente pseudocodice e restituisce 32 byte.</span><span class="sxs-lookup"><span data-stu-id="497e0-168">The hash looks similar to the following pseudo code and returns 32 bytes.</span></span>

```
SHA-256('https://<yournamespace>.servicebus.windows.net/'+'\n'+ 1438205742)
```

<span data-ttu-id="497e0-169">I valori non hash si trovano nella stringa **SharedAccessSignature** per cui il destinatario può calcolare l'hash con gli stessi parametri, per essere certo che restituisca lo stesso risultato.</span><span class="sxs-lookup"><span data-stu-id="497e0-169">The non-hashed values are in the **SharedAccessSignature** string so that the recipient can compute the hash with the same parameters, to be sure that it returns the same result.</span></span> <span data-ttu-id="497e0-170">L'URI specifica l'ambito e il nome della chiave identifica i criteri da utilizzare per calcolare l'hash.</span><span class="sxs-lookup"><span data-stu-id="497e0-170">The URI specifies the scope, and the key name identifies the policy to be used to compute the hash.</span></span> <span data-ttu-id="497e0-171">Questo è importante dal punto di vista della sicurezza.</span><span class="sxs-lookup"><span data-stu-id="497e0-171">This is important from a security standpoint.</span></span> <span data-ttu-id="497e0-172">Se la firma non corrisponde a quella calcolata dal destinatario (bus di servizio), l'accesso viene negato.</span><span class="sxs-lookup"><span data-stu-id="497e0-172">If the signature doesn't match that which the recipient (Service Bus) calculates, then access is denied.</span></span> <span data-ttu-id="497e0-173">A questo punto si può essere certi che il mittente abbia accesso alla chiave e che disponga dei diritti specificati nei criteri.</span><span class="sxs-lookup"><span data-stu-id="497e0-173">At this point you can be sure that the sender had access to the key and should be granted the rights specified in the policy.</span></span>

<span data-ttu-id="497e0-174">Si noti che è necessario usare l'URI di risorsa codificato per questa operazione.</span><span class="sxs-lookup"><span data-stu-id="497e0-174">Note that you should use the encoded resource URI for this operation.</span></span> <span data-ttu-id="497e0-175">L'URI di risorsa è l'URI completo della risorsa del bus di servizio a cui si richiede l'accesso.</span><span class="sxs-lookup"><span data-stu-id="497e0-175">The resource URI is the full URI of the Service Bus resource to which access is claimed.</span></span> <span data-ttu-id="497e0-176">Ad esempio `http://<namespace>.servicebus.windows.net/<entityPath>` o `sb://<namespace>.servicebus.windows.net/<entityPath>`, ovvero `http://contoso.servicebus.windows.net/contosoTopics/T1/Subscriptions/S3`.</span><span class="sxs-lookup"><span data-stu-id="497e0-176">For example, `http://<namespace>.servicebus.windows.net/<entityPath>` or `sb://<namespace>.servicebus.windows.net/<entityPath>`; that is, `http://contoso.servicebus.windows.net/contosoTopics/T1/Subscriptions/S3`.</span></span>

<span data-ttu-id="497e0-177">La regola di autorizzazione di accesso condiviso usata per la firma deve essere configurata nell'entità specificata da questo URI o in un elemento padre nella gerarchia.</span><span class="sxs-lookup"><span data-stu-id="497e0-177">The shared access authorization rule used for signing must be configured on the entity specified by this URI, or by one of its hierarchical parents.</span></span> <span data-ttu-id="497e0-178">Ad esempio `http://contoso.servicebus.windows.net/contosoTopics/T1` o `http://contoso.servicebus.windows.net` nell'esempio precedente.</span><span class="sxs-lookup"><span data-stu-id="497e0-178">For example, `http://contoso.servicebus.windows.net/contosoTopics/T1` or `http://contoso.servicebus.windows.net` in the previous example.</span></span>

<span data-ttu-id="497e0-179">Un token di firma di accesso condiviso è valido per tutte le risorse nell'elemento `<resourceURI>` usato in `signature-string`.</span><span class="sxs-lookup"><span data-stu-id="497e0-179">A SAS token is valid for all resources under the `<resourceURI>` used in the `signature-string`.</span></span>

<span data-ttu-id="497e0-180">L'oggetto [KeyName](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule#Microsoft_ServiceBus_Messaging_SharedAccessAuthorizationRule_KeyName) nel token di firma di accesso condiviso fa riferimento all'oggetto **keyName** della regola di autorizzazione di accesso condiviso usata per generare il token.</span><span class="sxs-lookup"><span data-stu-id="497e0-180">The [KeyName](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule#Microsoft_ServiceBus_Messaging_SharedAccessAuthorizationRule_KeyName) in the SAS token refers to the **keyName** of the shared access authorization rule used to generate the token.</span></span>

<span data-ttu-id="497e0-181">L'elemento *URL-encoded-resourceURI* deve corrispondere all'URI usato nella stringa da firmare durante il calcolo della firma.</span><span class="sxs-lookup"><span data-stu-id="497e0-181">The *URL-encoded-resourceURI* must be the same as the URI used in the string-to-sign during the computation of the signature.</span></span> <span data-ttu-id="497e0-182">Il valore deve essere [codificato in percentuale](https://msdn.microsoft.com/library/4fkewx0t.aspx).</span><span class="sxs-lookup"><span data-stu-id="497e0-182">It should be [percent-encoded](https://msdn.microsoft.com/library/4fkewx0t.aspx).</span></span>

<span data-ttu-id="497e0-183">È consigliabile rigenerare periodicamente le chiavi usate nella regola [SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule) .</span><span class="sxs-lookup"><span data-stu-id="497e0-183">It is recommended that you periodically regenerate the keys used in the [SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule) object.</span></span> <span data-ttu-id="497e0-184">In genere le applicazioni usano il parametro [PrimaryKey](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule#Microsoft_ServiceBus_Messaging_SharedAccessAuthorizationRule_PrimaryKey) per generare un token di firma di accesso condiviso.</span><span class="sxs-lookup"><span data-stu-id="497e0-184">Applications should generally use the [PrimaryKey](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule#Microsoft_ServiceBus_Messaging_SharedAccessAuthorizationRule_PrimaryKey) to generate a SAS token.</span></span> <span data-ttu-id="497e0-185">Quando si rigenerano le chiavi, sostituire [SecondaryKey](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule#Microsoft_ServiceBus_Messaging_SharedAccessAuthorizationRule_SecondaryKey) con la chiave primaria precedente e generare una nuova chiave come nuova chiave primaria.</span><span class="sxs-lookup"><span data-stu-id="497e0-185">When regenerating the keys, you should replace the [SecondaryKey](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule#Microsoft_ServiceBus_Messaging_SharedAccessAuthorizationRule_SecondaryKey) with the old primary key, and generate a new key as the new primary key.</span></span> <span data-ttu-id="497e0-186">In questo modo, è possibile continuare a usare i token per l'autorizzazione rilasciati con la chiave primaria precedente e non ancora scaduti.</span><span class="sxs-lookup"><span data-stu-id="497e0-186">This enables you to continue using tokens for authorization that were issued with the old primary key, and that have not yet expired.</span></span>

<span data-ttu-id="497e0-187">Se una chiave viene compromessa ed è necessario revocare le chiavi, è possibile rigenerare entrambi gli oggetti [PrimaryKey](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule#Microsoft_ServiceBus_Messaging_SharedAccessAuthorizationRule_PrimaryKey) e [SecondaryKey](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule#Microsoft_ServiceBus_Messaging_SharedAccessAuthorizationRule_SecondaryKey) per una regola [SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule), sostituendo le chiavi precedenti con quelle nuove.</span><span class="sxs-lookup"><span data-stu-id="497e0-187">If a key is compromised and you have to revoke the keys, you can regenerate both the [PrimaryKey](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule#Microsoft_ServiceBus_Messaging_SharedAccessAuthorizationRule_PrimaryKey) and the [SecondaryKey](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule#Microsoft_ServiceBus_Messaging_SharedAccessAuthorizationRule_SecondaryKey) of a [SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule), replacing them with new keys.</span></span> <span data-ttu-id="497e0-188">Se viene eseguita questa procedura, tutti i token firmati con le chiavi precedenti non sono più validi.</span><span class="sxs-lookup"><span data-stu-id="497e0-188">This procedure invalidates all tokens signed with the old keys.</span></span>

## <a name="how-to-use-shared-access-signature-authentication-with-service-bus"></a><span data-ttu-id="497e0-189">Come usare l'autenticazione della firma di accesso condiviso con il bus di servizio</span><span class="sxs-lookup"><span data-stu-id="497e0-189">How to use Shared Access Signature authentication with Service Bus</span></span>

<span data-ttu-id="497e0-190">Gli scenari illustrati di seguito includono la configurazione delle regole di autorizzazione, la generazione di token di firma di accesso condiviso e l'autorizzazione dei client.</span><span class="sxs-lookup"><span data-stu-id="497e0-190">The following scenarios include configuration of authorization rules, generation of SAS tokens, and client authorization.</span></span>

<span data-ttu-id="497e0-191">Per un esempio pratico completo di un'applicazione del bus di servizio che illustra la configurazione e usa l'autorizzazione con firma di accesso condiviso, vedere [Autenticazione della firma di accesso condiviso con il bus di servizio](http://code.msdn.microsoft.com/Shared-Access-Signature-0a88adf8).</span><span class="sxs-lookup"><span data-stu-id="497e0-191">For a full working sample of a Service Bus application that illustrates the configuration and uses SAS authorization, see [Shared Access Signature authentication with Service Bus](http://code.msdn.microsoft.com/Shared-Access-Signature-0a88adf8).</span></span> <span data-ttu-id="497e0-192">Un esempio correlato che illustra l'uso delle regole di autorizzazione con firma di accesso condiviso configurate negli spazi dei nomi o negli argomenti per proteggere le sottoscrizioni del bus di servizio è disponibile nella pagina relativa all' [uso dell'autenticazione con firma di accesso condiviso con le sottoscrizioni del bus di servizio](http://code.msdn.microsoft.com/Using-Shared-Access-e605b37c).</span><span class="sxs-lookup"><span data-stu-id="497e0-192">A related sample that illustrates the use of SAS authorization rules configured on namespaces or topics to secure Service Bus subscriptions is available here: [Using Shared Access Signature (SAS) authentication with Service Bus Subscriptions](http://code.msdn.microsoft.com/Using-Shared-Access-e605b37c).</span></span>

## <a name="access-shared-access-authorization-rules-on-a-namespace"></a><span data-ttu-id="497e0-193">Accesso alle regole di autorizzazione per l'accesso condiviso in uno spazio dei nomi</span><span class="sxs-lookup"><span data-stu-id="497e0-193">Access Shared Access Authorization rules on a namespace</span></span>

<span data-ttu-id="497e0-194">Per le operazioni nella radice dello spazio dei nomi del bus di servizio è necessaria l'autenticazione tramite certificati.</span><span class="sxs-lookup"><span data-stu-id="497e0-194">Operations on the Service Bus namespace root require certificate authentication.</span></span> <span data-ttu-id="497e0-195">È necessario caricare un certificato di gestione per la sottoscrizione di Azure.</span><span class="sxs-lookup"><span data-stu-id="497e0-195">You must upload a management certificate for your Azure subscription.</span></span> <span data-ttu-id="497e0-196">Per caricare un certificato di gestione, seguire [questi passaggi](../cloud-services/cloud-services-configure-ssl-certificate-portal.md#step-3-upload-a-certificate) usando il [portale di Azure][Azure portal].</span><span class="sxs-lookup"><span data-stu-id="497e0-196">To upload a management certificate, follow the steps [here](../cloud-services/cloud-services-configure-ssl-certificate-portal.md#step-3-upload-a-certificate), using the [Azure portal][Azure portal].</span></span> <span data-ttu-id="497e0-197">Per altre informazioni sui certificati di gestione di Azure, vedere la [Panoramica sui certificati di Azure](../cloud-services/cloud-services-certs-create.md#what-are-management-certificates).</span><span class="sxs-lookup"><span data-stu-id="497e0-197">For more information about Azure management certificates, see the [Azure certificates overview](../cloud-services/cloud-services-certs-create.md#what-are-management-certificates).</span></span>

<span data-ttu-id="497e0-198">L'endpoint per l'accesso alle regole di autorizzazione per l'accesso condiviso in uno spazio dei nomi del bus di servizio è il seguente:</span><span class="sxs-lookup"><span data-stu-id="497e0-198">The endpoint for accessing shared access authorization rules on a Service Bus namespace is as follows:</span></span>

```http
https://management.core.windows.net/{subscriptionId}/services/ServiceBus/namespaces/{namespace}/AuthorizationRules/
```

<span data-ttu-id="497e0-199">Per creare un oggetto [SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule) in uno spazio dei nomi del bus di servizio, eseguire un'operazione POST in questo endpoint con le informazioni sulle regole serializzate come JSON o XML.</span><span class="sxs-lookup"><span data-stu-id="497e0-199">To create a [SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule) object on a Service Bus namespace, execute a POST operation on this endpoint with the rule information serialized as JSON or XML.</span></span> <span data-ttu-id="497e0-200">Ad esempio:</span><span class="sxs-lookup"><span data-stu-id="497e0-200">For example:</span></span>

```csharp
// Base address for accessing authorization rules on a namespace
string baseAddress = @"https://management.core.windows.net/<subscriptionId>/services/ServiceBus/namespaces/<namespace>/AuthorizationRules/";

// Configure authorization rule with base64-encoded 256-bit key and Send rights
var sendRule = new SharedAccessAuthorizationRule("contosoSendAll",
    SharedAccessAuthorizationRule.GenerateRandomKey(),
    new[] { AccessRights.Send });

// Operations on the Service Bus namespace root require certificate authentication.
WebRequestHandler handler = new WebRequestHandler
{
    ClientCertificateOptions = ClientCertificateOption.Manual
};
// Access the management certificate by subject name
handler.ClientCertificates.Add(GetCertificate(<certificateSN>));

HttpClient httpClient = new HttpClient(handler)
{
    BaseAddress = new Uri(baseAddress)
};
httpClient.DefaultRequestHeaders.Accept.Add(
    new MediaTypeWithQualityHeaderValue("application/json"));
httpClient.DefaultRequestHeaders.Add("x-ms-version", "2015-01-01");

// Execute a POST operation on the baseAddress above to create an auth rule
var postResult = httpClient.PostAsJsonAsync("", sendRule).Result;
```

<span data-ttu-id="497e0-201">In modo analogo, usare un'operazione GET sull'endpoint per leggere le regole di autorizzazione configurate nello spazio dei nomi.</span><span class="sxs-lookup"><span data-stu-id="497e0-201">Similarly, use a GET operation on the endpoint to read the authorization rules configured on the namespace.</span></span>

<span data-ttu-id="497e0-202">Per aggiornare o eliminare una regola di autorizzazione specifica, usare l'endpoint seguente:</span><span class="sxs-lookup"><span data-stu-id="497e0-202">To update or delete a specific authorization rule, use the following endpoint:</span></span>

```http
https://management.core.windows.net/{subscriptionId}/services/ServiceBus/namespaces/{namespace}/AuthorizationRules/{KeyName}
```

## <a name="access-shared-access-authorization-rules-on-an-entity"></a><span data-ttu-id="497e0-203">Accedere alle regole di autorizzazione per l'accesso condiviso in un'entità</span><span class="sxs-lookup"><span data-stu-id="497e0-203">Access Shared Access Authorization rules on an entity</span></span>

<span data-ttu-id="497e0-204">È possibile accedere a un oggetto [Microsoft.ServiceBus.Messaging.SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule) configurato in una coda o in un argomento del bus di servizio tramite la raccolta [AuthorizationRules](/dotnet/api/microsoft.servicebus.messaging.authorizationrules) negli oggetti [QueueDescription](/dotnet/api/microsoft.servicebus.messaging.queuedescription) o [TopicDescription](/dotnet/api/microsoft.servicebus.messaging.topicdescription) corrispondenti.</span><span class="sxs-lookup"><span data-stu-id="497e0-204">You can access a [Microsoft.ServiceBus.Messaging.SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule) object configured on a Service Bus queue or topic through the [AuthorizationRules](/dotnet/api/microsoft.servicebus.messaging.authorizationrules) collection in the corresponding [QueueDescription](/dotnet/api/microsoft.servicebus.messaging.queuedescription) or [TopicDescription](/dotnet/api/microsoft.servicebus.messaging.topicdescription).</span></span>

<span data-ttu-id="497e0-205">Il codice seguente illustra come aggiungere regole di autorizzazione per una coda.</span><span class="sxs-lookup"><span data-stu-id="497e0-205">The following code shows how to add authorization rules for a queue.</span></span>

```csharp
// Create an instance of NamespaceManager for the operation
NamespaceManager nsm = NamespaceManager.CreateFromConnectionString(
    <connectionString> );
QueueDescription qd = new QueueDescription( <qPath> );

// Create a rule with send rights with keyName as "contosoQSendKey"
// and add it to the queue description.
qd.Authorization.Add(new SharedAccessAuthorizationRule("contosoSendKey",
    SharedAccessAuthorizationRule.GenerateRandomKey(),
    new[] { AccessRights.Send }));

// Create a rule with listen rights with keyName as "contosoQListenKey"
// and add it to the queue description.
qd.Authorization.Add(new SharedAccessAuthorizationRule("contosoQListenKey",
    SharedAccessAuthorizationRule.GenerateRandomKey(),
    new[] { AccessRights.Listen }));

// Create a rule with manage rights with keyName as "contosoQManageKey"
// and add it to the queue description.
// A rule with manage rights must also have send and receive rights.
qd.Authorization.Add(new SharedAccessAuthorizationRule("contosoQManageKey",
    SharedAccessAuthorizationRule.GenerateRandomKey(),
    new[] {AccessRights.Manage, AccessRights.Listen, AccessRights.Send }));

// Create the queue.
nsm.CreateQueue(qd);
```

## <a name="use-shared-access-signature-authorization"></a><span data-ttu-id="497e0-206">Usare l'autorizzazione con firma di accesso condiviso</span><span class="sxs-lookup"><span data-stu-id="497e0-206">Use Shared Access Signature authorization</span></span>

<span data-ttu-id="497e0-207">Le applicazioni che usano Azure .NET SDK con le librerie .NET del bus di servizio possono usare l'autorizzazione con firma di accesso condiviso nella classe [SharedAccessSignatureTokenProvider](/dotnet/api/microsoft.servicebus.sharedaccesssignaturetokenprovider) .</span><span class="sxs-lookup"><span data-stu-id="497e0-207">Applications using the Azure .NET SDK with the Service Bus .NET libraries can use SAS authorization through the [SharedAccessSignatureTokenProvider](/dotnet/api/microsoft.servicebus.sharedaccesssignaturetokenprovider) class.</span></span> <span data-ttu-id="497e0-208">Il codice seguente illustra l'uso del provider di token per inviare messaggi a una coda del bus di servizio.</span><span class="sxs-lookup"><span data-stu-id="497e0-208">The following code illustrates the use of the token provider to send messages to a Service Bus queue.</span></span>

```csharp
Uri runtimeUri = ServiceBusEnvironment.CreateServiceUri("sb",
    <yourServiceNamespace>, string.Empty);
MessagingFactory mf = MessagingFactory.Create(runtimeUri,
    TokenProvider.CreateSharedAccessSignatureTokenProvider(keyName, key));
QueueClient sendClient = mf.CreateQueueClient(qPath);

//Sending hello message to queue.
BrokeredMessage helloMessage = new BrokeredMessage("Hello, Service Bus!");
helloMessage.MessageId = "SAS-Sample-Message";
sendClient.Send(helloMessage);
```

<span data-ttu-id="497e0-209">Le applicazioni possono anche usare la firma di accesso condiviso per l'autenticazione usando una stringa di connessione della firma di accesso condiviso nei metodi che accettano stringhe di connessione.</span><span class="sxs-lookup"><span data-stu-id="497e0-209">Applications can also use SAS for authentication by using a SAS connection string in methods that accept connection strings.</span></span>

<span data-ttu-id="497e0-210">Si noti che per usare l'autorizzazione con firma di accesso condiviso con gli inoltri del bus di servizio è possibile usare le chiavi della firma di accesso condiviso configurate nello spazio dei nomi del bus di servizio.</span><span class="sxs-lookup"><span data-stu-id="497e0-210">Note that to use SAS authorization with Service Bus relays, you can use SAS keys configured on the Service Bus namespace.</span></span> <span data-ttu-id="497e0-211">Se si crea in modo esplicito un inoltro per lo spazio dei nomi ([NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager) con un oggetto [RelayDescription](/dotnet/api/microsoft.servicebus.messaging.relaydescription)), è possibile impostare le regole della firma di accesso condiviso solo per tale inoltro.</span><span class="sxs-lookup"><span data-stu-id="497e0-211">If you explicitly create a relay on the namespace ([NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager) with a [RelayDescription](/dotnet/api/microsoft.servicebus.messaging.relaydescription)) object, you can set the SAS rules just for that relay.</span></span> <span data-ttu-id="497e0-212">Per usare l'autorizzazione con firma di accesso condiviso con le sottoscrizioni del bus di servizio è possibile usare le chiavi della firma di accesso condiviso configurate in uno spazio dei nomi o in un argomento del bus di servizio.</span><span class="sxs-lookup"><span data-stu-id="497e0-212">To use SAS authorization with Service Bus subscriptions, you can use SAS keys configured on a Service Bus namespace or on a topic.</span></span>

## <a name="use-the-shared-access-signature-at-http-level"></a><span data-ttu-id="497e0-213">Usare la firma di accesso condiviso (a livello HTTP)</span><span class="sxs-lookup"><span data-stu-id="497e0-213">Use the Shared Access Signature (at HTTP level)</span></span>

<span data-ttu-id="497e0-214">Dopo aver creato firme di accesso condiviso per tutte le entità nel bus di servizio, si è pronti a eseguire una richiesta HTTP POST:</span><span class="sxs-lookup"><span data-stu-id="497e0-214">Now that you know how to create Shared Access Signatures for any entities in Service Bus, you are ready to perform an HTTP POST:</span></span>

```http
POST https://<yournamespace>.servicebus.windows.net/<yourentity>/messages
Content-Type: application/json
Authorization: SharedAccessSignature sr=https%3A%2F%2F<yournamespace>.servicebus.windows.net%2F<yourentity>&sig=<yoursignature from code above>&se=1438205742&skn=KeyName
ContentType: application/atom+xml;type=entry;charset=utf-8
``` 

<span data-ttu-id="497e0-215">Questa procedura funziona per ogni elemento.</span><span class="sxs-lookup"><span data-stu-id="497e0-215">Remember, this works for everything.</span></span> <span data-ttu-id="497e0-216">È possibile creare una firma di accesso condiviso per una coda, un argomento o una sottoscrizione.</span><span class="sxs-lookup"><span data-stu-id="497e0-216">You can create SAS for a queue, topic, or subscription.</span></span> 

<span data-ttu-id="497e0-217">Se un token SAS viene assegnato a un mittente o ad un client, questi ultimi non dispongono della chiave direttamente e non possono invertire l'hash per ottenerla.</span><span class="sxs-lookup"><span data-stu-id="497e0-217">If you give a sender or client a SAS token, they don't have the key directly, and they cannot reverse the hash to obtain it.</span></span> <span data-ttu-id="497e0-218">Di conseguenza, è necessario controllare a cosa possono accedere e per quanto tempo.</span><span class="sxs-lookup"><span data-stu-id="497e0-218">As such, you have control over what they can access, and for how long.</span></span> <span data-ttu-id="497e0-219">Se si modifica la chiave primaria nel criterio, le firme di accesso condiviso create da tale chiave verranno invalidate.</span><span class="sxs-lookup"><span data-stu-id="497e0-219">An important thing to remember is that if you change the primary key in the policy, any Shared Access Signatures created from it will be invalidated.</span></span>

## <a name="use-the-shared-access-signature-at-amqp-level"></a><span data-ttu-id="497e0-220">Usare la firma di accesso condiviso (a livello AMQP)</span><span class="sxs-lookup"><span data-stu-id="497e0-220">Use the Shared Access Signature (at AMQP level)</span></span>

<span data-ttu-id="497e0-221">Nella sezione precedente, è stato illustrato come utilizzare il token SAS con una richiesta HTTP POST per l'invio di dati per il Bus di servizio.</span><span class="sxs-lookup"><span data-stu-id="497e0-221">In the previous section, you saw how to use the SAS token with an HTTP POST request for sending data to the Service Bus.</span></span> <span data-ttu-id="497e0-222">Com'è noto, è possibile accedere al bus di servizio usando il protocollo AMQP (Advanced Message Queuing Protocol), ovvero il protocollo preferito da usare per motivi di prestazioni in molti scenari.</span><span class="sxs-lookup"><span data-stu-id="497e0-222">As you know, you can access Service Bus using the Advanced Message Queuing Protocol (AMQP) that is the preferred protocol to use for performance reasons, in many scenarios.</span></span> <span data-ttu-id="497e0-223">L'uso del token SAS con AMQP viene descritto nel documento dedicato ad [AMQP Claim-Based Security versione 1.0](https://www.oasis-open.org/committees/download.php/50506/amqp-cbs-v1%200-wd02%202013-08-12.doc) , in fase di bozza dal 2013 ma attualmente supportato da Azure.</span><span class="sxs-lookup"><span data-stu-id="497e0-223">The SAS token usage with AMQP is described in the document [AMQP Claim-Based Security Version 1.0](https://www.oasis-open.org/committees/download.php/50506/amqp-cbs-v1%200-wd02%202013-08-12.doc) that is in working draft since 2013 but well-supported by Azure today.</span></span>

<span data-ttu-id="497e0-224">Prima di iniziare a inviare i dati al bus di servizio, il server di pubblicazione deve inviare il token di firma di accesso condiviso all'interno di un messaggio AMQP a un nodo AMQP ben definito denominato **"$cbs"**. Può essere visualizzato come una coda "speciale" usata dal servizio per acquisire e convalidare tutti i token di firma di accesso condiviso.</span><span class="sxs-lookup"><span data-stu-id="497e0-224">Before starting to send data to Service Bus, the publisher must send the SAS token inside an AMQP message to a well-defined AMQP node named **$cbs** (you can see it as a "special" queue used by the service to acquire and validate all the SAS tokens).</span></span> <span data-ttu-id="497e0-225">Il server di pubblicazione deve specificare il campo **ReplyTo** all'interno del messaggio AMQP. Si tratta del nodo in cui il servizio invia una risposta al server di pubblicazione con il risultato della convalida del token. È un modello di richiesta/risposta semplice tra il server di pubblicazione e il servizio.</span><span class="sxs-lookup"><span data-stu-id="497e0-225">The publisher must specify the **ReplyTo** field inside the AMQP message; this is the node in which the service replies to the publisher with the result of the token validation (a simple request/reply pattern between publisher and service).</span></span> <span data-ttu-id="497e0-226">Questo nodo risposta viene creato al momento in quanto "creazione dinamica di nodo remoto" come descritto nella specifica di AMQP 1.0.</span><span class="sxs-lookup"><span data-stu-id="497e0-226">This reply node is created "on the fly," speaking about "dynamic creation of remote node" as described by the AMQP 1.0 specification.</span></span> <span data-ttu-id="497e0-227">Dopo avere verificato che il token di firma di accesso condiviso è valido, il server di pubblicazione può andare avanti e iniziare a inviare dati al servizio.</span><span class="sxs-lookup"><span data-stu-id="497e0-227">After checking that the SAS token is valid, the publisher can go forward and start to send data to the service.</span></span>

<span data-ttu-id="497e0-228">La procedura seguente illustra come inviare il token SAS con il protocollo AMQP usando la libreria [AMQP.Net Lite](https://github.com/Azure/amqpnetlite) .</span><span class="sxs-lookup"><span data-stu-id="497e0-228">The following steps show how to send the SAS token with AMQP protocol using the [AMQP.Net Lite](https://github.com/Azure/amqpnetlite) library.</span></span> <span data-ttu-id="497e0-229">È utile se non è possibile usare la versione ufficiale di Service Bus SDK (ad esempio su WinRT, .Net Compact Framework, .Net Micro Framework e Mono) che si sviluppa in C\#.</span><span class="sxs-lookup"><span data-stu-id="497e0-229">This is useful if you can't use the official Service Bus SDK (for example on WinRT, .Net Compact Framework, .Net Micro Framework and Mono) developing in C\#.</span></span> <span data-ttu-id="497e0-230">Naturalmente, questa libreria è utile per comprendere il funzionamento della sicurezza basata sulle attestazioni a livello AMQP, dopo aver visto il funzionamento a livello HTTP (con una richiesta HTTP POST e il token SAS inviati all'interno dell'intestazione "Authorization").</span><span class="sxs-lookup"><span data-stu-id="497e0-230">Of course, this library is useful to help understand how claims-based security works at the AMQP level, as you saw how it works at the HTTP level (with an HTTP POST request and the SAS token sent inside the "Authorization" header).</span></span> <span data-ttu-id="497e0-231">Se non sono necessarie tali informazioni approfondite su AMQP, è possibile usare l'SDK ufficiale del bus di servizio con le applicazioni .Net Framework che eseguiranno l'operazione in modo automatico.</span><span class="sxs-lookup"><span data-stu-id="497e0-231">If you don't need such deep knowledge about AMQP, you can use the official Service Bus SDK with .Net Framework applications, which will do it for you.</span></span>

### <a name="c35"></a><span data-ttu-id="497e0-232">C&#35;</span><span class="sxs-lookup"><span data-stu-id="497e0-232">C&#35;</span></span>

```csharp
/// <summary>
/// Send claim-based security (CBS) token
/// </summary>
/// <param name="shareAccessSignature">Shared access signature (token) to send</param>
private bool PutCbsToken(Connection connection, string sasToken)
{
    bool result = true;
    Session session = new Session(connection);

    string cbsClientAddress = "cbs-client-reply-to";
    var cbsSender = new SenderLink(session, "cbs-sender", "$cbs");
    var cbsReceiver = new ReceiverLink(session, cbsClientAddress, "$cbs");

    // construct the put-token message
    var request = new Message(sasToken);
    request.Properties = new Properties();
    request.Properties.MessageId = Guid.NewGuid().ToString();
    request.Properties.ReplyTo = cbsClientAddress;
    request.ApplicationProperties = new ApplicationProperties();
    request.ApplicationProperties["operation"] = "put-token";
    request.ApplicationProperties["type"] = "servicebus.windows.net:sastoken";
    request.ApplicationProperties["name"] = Fx.Format("amqp://{0}/{1}", sbNamespace, entity);
    cbsSender.Send(request);

    // receive the response
    var response = cbsReceiver.Receive();
    if (response == null || response.Properties == null || response.ApplicationProperties == null)
    {
        result = false;
    }
    else
    {
        int statusCode = (int)response.ApplicationProperties["status-code"];
        if (statusCode != (int)HttpStatusCode.Accepted && statusCode != (int)HttpStatusCode.OK)
        {
            result = false;
        }
    }

    // the sender/receiver may be kept open for refreshing tokens
    cbsSender.Close();
    cbsReceiver.Close();
    session.Close();

    return result;
}
```

<span data-ttu-id="497e0-233">Il metodo `PutCbsToken()` riceve la *connessione*, vale a dire l'istanza della classe di connessione AMQP indicata dalla [libreria AMQP .NET Lite](https://github.com/Azure/amqpnetlite), che rappresenta la connessione TCP al servizio e il parametro *sasToken*, ovvero il token di firma di accesso condiviso da inviare.</span><span class="sxs-lookup"><span data-stu-id="497e0-233">The `PutCbsToken()` method receives the *connection* (AMQP connection class instance as provided by the [AMQP .NET Lite library](https://github.com/Azure/amqpnetlite)) that represents the TCP connection to the service and the *sasToken* parameter that is the SAS token to send.</span></span> 

> [!NOTE]
> <span data-ttu-id="497e0-234">È importante che la connessione venga creata con il **meccanismo di autenticazione SASL impostato su EXTERNAL** (e non il PLAIN predefinito con nome utente e password usato quando non è necessario inviare il token SAS).</span><span class="sxs-lookup"><span data-stu-id="497e0-234">It's important that the connection is created with **SASL authentication mechanism set to EXTERNAL** (and not the default PLAIN with username and password used when you don't need to send the SAS token).</span></span>
> 
> 

<span data-ttu-id="497e0-235">Successivamente, il server di pubblicazione crea due collegamenti AMQP per inviare il token SAS e ricevere la risposta (il risultato di convalida del token) dal servizio.</span><span class="sxs-lookup"><span data-stu-id="497e0-235">Next, the publisher creates two AMQP links for sending the SAS token and receiving the reply (the token validation result) from the service.</span></span>

<span data-ttu-id="497e0-236">Il messaggio AMQP contiene un insieme di proprietà e altre informazioni rispetto a un semplice messaggio.</span><span class="sxs-lookup"><span data-stu-id="497e0-236">The AMQP message contains a set of properties, and more information than a simple message.</span></span> <span data-ttu-id="497e0-237">Il token SAS rappresenta il corpo del messaggio (tramite il relativo costruttore).</span><span class="sxs-lookup"><span data-stu-id="497e0-237">The SAS token is the body of the message (using its constructor).</span></span> <span data-ttu-id="497e0-238">La proprietà **"ReplyTo"** è impostata sul nome del nodo per la ricezione del risultato di convalida sul collegamento ricevitore (se si desidera modificare il nome, è possibile farlo e verrà creato in modo dinamico dal servizio).</span><span class="sxs-lookup"><span data-stu-id="497e0-238">The **"ReplyTo"** property is set to the node name for receiving the validation result on the receiver link (you can change its name if you want, and it will be created dynamically by the service).</span></span> <span data-ttu-id="497e0-239">Le ultime tre proprietà personalizzate/relative all'applicazione vengono usate dal servizio per indicare quale tipologia di operazione è necessario eseguire.</span><span class="sxs-lookup"><span data-stu-id="497e0-239">The last three application/custom properties are used by the service to indicate what kind of operation it has to execute.</span></span> <span data-ttu-id="497e0-240">Come descritto nella bozza di specifica CBS, devono essere il **nome dell'operazione** ("put-token"), il **tipo di token** (in questo caso, "servicebus.windows.net:sastoken") e il **"nome" del gruppo di destinatari** a cui viene applicato il token (l'intera entità).</span><span class="sxs-lookup"><span data-stu-id="497e0-240">As described by the CBS draft specification, they must be the **operation name** ("put-token"), the **type of token** (in this case, a "servicebus.windows.net:sastoken"), and the **"name" of the audience** to which the token applies (the entire entity).</span></span>

<span data-ttu-id="497e0-241">Dopo aver inviato il token SAS sul collegamento mittente, il server di pubblicazione deve leggere la risposta sul collegamento ricevitore.</span><span class="sxs-lookup"><span data-stu-id="497e0-241">After sending the SAS token on the sender link, the publisher must read the reply on the receiver link.</span></span> <span data-ttu-id="497e0-242">La risposta è un semplice messaggio AMQP con una proprietà dell'applicazione denominata **"status-code"** che può contenere gli stessi valori di un codice di stato HTTP.</span><span class="sxs-lookup"><span data-stu-id="497e0-242">The reply is a simple AMQP message with an application property named **"status-code"** that can contain the same values as an HTTP status code.</span></span>

## <a name="rights-required-for-service-bus-operations"></a><span data-ttu-id="497e0-243">Diritti necessari per le operazioni del bus di servizio</span><span class="sxs-lookup"><span data-stu-id="497e0-243">Rights required for Service Bus operations</span></span>

<span data-ttu-id="497e0-244">La tabella seguente illustra i diritti di accesso necessari per l'esecuzione di operazioni relative alle risorse del bus di servizio.</span><span class="sxs-lookup"><span data-stu-id="497e0-244">The following table shows the access rights required for various operations on Service Bus resources.</span></span>

| <span data-ttu-id="497e0-245">Operazione</span><span class="sxs-lookup"><span data-stu-id="497e0-245">Operation</span></span> | <span data-ttu-id="497e0-246">Attestazione necessaria</span><span class="sxs-lookup"><span data-stu-id="497e0-246">Claim Required</span></span> | <span data-ttu-id="497e0-247">Ambito attestazione</span><span class="sxs-lookup"><span data-stu-id="497e0-247">Claim Scope</span></span> |
| --- | --- | --- |
| <span data-ttu-id="497e0-248">**Spazio dei nomi**</span><span class="sxs-lookup"><span data-stu-id="497e0-248">**Namespace**</span></span> | | |
| <span data-ttu-id="497e0-249">Configurare le regole di autorizzazione relative a uno spazio dei nomi</span><span class="sxs-lookup"><span data-stu-id="497e0-249">Configure authorization rule on a namespace</span></span> |<span data-ttu-id="497e0-250">Manage</span><span class="sxs-lookup"><span data-stu-id="497e0-250">Manage</span></span> |<span data-ttu-id="497e0-251">Qualsiasi indirizzo dello spazio dei nomi</span><span class="sxs-lookup"><span data-stu-id="497e0-251">Any namespace address</span></span> |
| <span data-ttu-id="497e0-252">**Registro di sistema del servizio**</span><span class="sxs-lookup"><span data-stu-id="497e0-252">**Service Registry**</span></span> | | |
| <span data-ttu-id="497e0-253">Enumerare i criteri privati</span><span class="sxs-lookup"><span data-stu-id="497e0-253">Enumerate Private Policies</span></span> |<span data-ttu-id="497e0-254">Manage</span><span class="sxs-lookup"><span data-stu-id="497e0-254">Manage</span></span> |<span data-ttu-id="497e0-255">Qualsiasi indirizzo dello spazio dei nomi</span><span class="sxs-lookup"><span data-stu-id="497e0-255">Any namespace address</span></span> |
| <span data-ttu-id="497e0-256">Iniziare l'attesa su uno spazio dei nomi del servizio</span><span class="sxs-lookup"><span data-stu-id="497e0-256">Begin listening on a namespace</span></span> |<span data-ttu-id="497e0-257">Attesa</span><span class="sxs-lookup"><span data-stu-id="497e0-257">Listen</span></span> |<span data-ttu-id="497e0-258">Qualsiasi indirizzo dello spazio dei nomi</span><span class="sxs-lookup"><span data-stu-id="497e0-258">Any namespace address</span></span> |
| <span data-ttu-id="497e0-259">Inviare messaggi a un listener in uno spazio dei nomi</span><span class="sxs-lookup"><span data-stu-id="497e0-259">Send messages to a listener at a namespace</span></span> |<span data-ttu-id="497e0-260">Invio</span><span class="sxs-lookup"><span data-stu-id="497e0-260">Send</span></span> |<span data-ttu-id="497e0-261">Qualsiasi indirizzo dello spazio dei nomi</span><span class="sxs-lookup"><span data-stu-id="497e0-261">Any namespace address</span></span> |
| <span data-ttu-id="497e0-262">**Coda**</span><span class="sxs-lookup"><span data-stu-id="497e0-262">**Queue**</span></span> | | |
| <span data-ttu-id="497e0-263">Creare una coda</span><span class="sxs-lookup"><span data-stu-id="497e0-263">Create a queue</span></span> |<span data-ttu-id="497e0-264">Manage</span><span class="sxs-lookup"><span data-stu-id="497e0-264">Manage</span></span> |<span data-ttu-id="497e0-265">Qualsiasi indirizzo dello spazio dei nomi</span><span class="sxs-lookup"><span data-stu-id="497e0-265">Any namespace address</span></span> |
| <span data-ttu-id="497e0-266">Eliminare una coda</span><span class="sxs-lookup"><span data-stu-id="497e0-266">Delete a queue</span></span> |<span data-ttu-id="497e0-267">Manage</span><span class="sxs-lookup"><span data-stu-id="497e0-267">Manage</span></span> |<span data-ttu-id="497e0-268">Qualsiasi indirizzo valido della coda</span><span class="sxs-lookup"><span data-stu-id="497e0-268">Any valid queue address</span></span> |
| <span data-ttu-id="497e0-269">Enumerare le code</span><span class="sxs-lookup"><span data-stu-id="497e0-269">Enumerate queues</span></span> |<span data-ttu-id="497e0-270">Manage</span><span class="sxs-lookup"><span data-stu-id="497e0-270">Manage</span></span> |<span data-ttu-id="497e0-271">/$Resources/Queues</span><span class="sxs-lookup"><span data-stu-id="497e0-271">/$Resources/Queues</span></span> |
| <span data-ttu-id="497e0-272">Ottenere la descrizione di una coda</span><span class="sxs-lookup"><span data-stu-id="497e0-272">Get the queue description</span></span> |<span data-ttu-id="497e0-273">Gestire</span><span class="sxs-lookup"><span data-stu-id="497e0-273">Manage</span></span> |<span data-ttu-id="497e0-274">Qualsiasi indirizzo valido della coda</span><span class="sxs-lookup"><span data-stu-id="497e0-274">Any valid queue address</span></span> |
| <span data-ttu-id="497e0-275">Configurare le regole di autorizzazione per una coda</span><span class="sxs-lookup"><span data-stu-id="497e0-275">Configure authorization rule for a queue</span></span> |<span data-ttu-id="497e0-276">Manage</span><span class="sxs-lookup"><span data-stu-id="497e0-276">Manage</span></span> |<span data-ttu-id="497e0-277">Qualsiasi indirizzo valido della coda</span><span class="sxs-lookup"><span data-stu-id="497e0-277">Any valid queue address</span></span> |
| <span data-ttu-id="497e0-278">Effettuare un invio alla coda</span><span class="sxs-lookup"><span data-stu-id="497e0-278">Send into to the queue</span></span> |<span data-ttu-id="497e0-279">Invio</span><span class="sxs-lookup"><span data-stu-id="497e0-279">Send</span></span> |<span data-ttu-id="497e0-280">Qualsiasi indirizzo valido della coda</span><span class="sxs-lookup"><span data-stu-id="497e0-280">Any valid queue address</span></span> |
| <span data-ttu-id="497e0-281">Ricevere messaggi da una coda</span><span class="sxs-lookup"><span data-stu-id="497e0-281">Receive messages from a queue</span></span> |<span data-ttu-id="497e0-282">Attesa</span><span class="sxs-lookup"><span data-stu-id="497e0-282">Listen</span></span> |<span data-ttu-id="497e0-283">Qualsiasi indirizzo valido della coda</span><span class="sxs-lookup"><span data-stu-id="497e0-283">Any valid queue address</span></span> |
| <span data-ttu-id="497e0-284">Abbandonare o completare messaggi dopo la ricezione del messaggio in modalità PeekLock (blocco di visualizzazione)</span><span class="sxs-lookup"><span data-stu-id="497e0-284">Abandon or complete messages after receiving the message in peek-lock mode</span></span> |<span data-ttu-id="497e0-285">Attesa</span><span class="sxs-lookup"><span data-stu-id="497e0-285">Listen</span></span> |<span data-ttu-id="497e0-286">Qualsiasi indirizzo valido della coda</span><span class="sxs-lookup"><span data-stu-id="497e0-286">Any valid queue address</span></span> |
| <span data-ttu-id="497e0-287">Rinviare un messaggio per il successivo recupero</span><span class="sxs-lookup"><span data-stu-id="497e0-287">Defer a message for later retrieval</span></span> |<span data-ttu-id="497e0-288">Attesa</span><span class="sxs-lookup"><span data-stu-id="497e0-288">Listen</span></span> |<span data-ttu-id="497e0-289">Qualsiasi indirizzo valido della coda</span><span class="sxs-lookup"><span data-stu-id="497e0-289">Any valid queue address</span></span> |
| <span data-ttu-id="497e0-290">Spostare un messaggio nella coda dei messaggi non recapitabili</span><span class="sxs-lookup"><span data-stu-id="497e0-290">Deadletter a message</span></span> |<span data-ttu-id="497e0-291">Attesa</span><span class="sxs-lookup"><span data-stu-id="497e0-291">Listen</span></span> |<span data-ttu-id="497e0-292">Qualsiasi indirizzo valido della coda</span><span class="sxs-lookup"><span data-stu-id="497e0-292">Any valid queue address</span></span> |
| <span data-ttu-id="497e0-293">Ottenere lo stato associato a una sessione della coda dei messaggi</span><span class="sxs-lookup"><span data-stu-id="497e0-293">Get the state associated with a message queue session</span></span> |<span data-ttu-id="497e0-294">Attesa</span><span class="sxs-lookup"><span data-stu-id="497e0-294">Listen</span></span> |<span data-ttu-id="497e0-295">Qualsiasi indirizzo valido della coda</span><span class="sxs-lookup"><span data-stu-id="497e0-295">Any valid queue address</span></span> |
| <span data-ttu-id="497e0-296">Impostare lo stato associato a una sessione della coda dei messaggi</span><span class="sxs-lookup"><span data-stu-id="497e0-296">Set the state associated with a message queue session</span></span> |<span data-ttu-id="497e0-297">Attesa</span><span class="sxs-lookup"><span data-stu-id="497e0-297">Listen</span></span> |<span data-ttu-id="497e0-298">Qualsiasi indirizzo valido della coda</span><span class="sxs-lookup"><span data-stu-id="497e0-298">Any valid queue address</span></span> |
| <span data-ttu-id="497e0-299">**Argomento**</span><span class="sxs-lookup"><span data-stu-id="497e0-299">**Topic**</span></span> | | |
| <span data-ttu-id="497e0-300">Creare un argomento</span><span class="sxs-lookup"><span data-stu-id="497e0-300">Create a topic</span></span> |<span data-ttu-id="497e0-301">Manage</span><span class="sxs-lookup"><span data-stu-id="497e0-301">Manage</span></span> |<span data-ttu-id="497e0-302">Qualsiasi indirizzo dello spazio dei nomi</span><span class="sxs-lookup"><span data-stu-id="497e0-302">Any namespace address</span></span> |
| <span data-ttu-id="497e0-303">Eliminare un argomento</span><span class="sxs-lookup"><span data-stu-id="497e0-303">Delete a topic</span></span> |<span data-ttu-id="497e0-304">Manage</span><span class="sxs-lookup"><span data-stu-id="497e0-304">Manage</span></span> |<span data-ttu-id="497e0-305">Qualsiasi indirizzo valido dell'argomento</span><span class="sxs-lookup"><span data-stu-id="497e0-305">Any valid topic address</span></span> |
| <span data-ttu-id="497e0-306">Enumerare gli argomenti</span><span class="sxs-lookup"><span data-stu-id="497e0-306">Enumerate topics</span></span> |<span data-ttu-id="497e0-307">Manage</span><span class="sxs-lookup"><span data-stu-id="497e0-307">Manage</span></span> |<span data-ttu-id="497e0-308">/$Resources/Topics</span><span class="sxs-lookup"><span data-stu-id="497e0-308">/$Resources/Topics</span></span> |
| <span data-ttu-id="497e0-309">Ottenere la descrizione di un argomento</span><span class="sxs-lookup"><span data-stu-id="497e0-309">Get the topic description</span></span> |<span data-ttu-id="497e0-310">Gestire</span><span class="sxs-lookup"><span data-stu-id="497e0-310">Manage</span></span> |<span data-ttu-id="497e0-311">Qualsiasi indirizzo valido dell'argomento</span><span class="sxs-lookup"><span data-stu-id="497e0-311">Any valid topic address</span></span> |
| <span data-ttu-id="497e0-312">Configurare le regole di autorizzazione per un argomento</span><span class="sxs-lookup"><span data-stu-id="497e0-312">Configure authorization rule for a topic</span></span> |<span data-ttu-id="497e0-313">Manage</span><span class="sxs-lookup"><span data-stu-id="497e0-313">Manage</span></span> |<span data-ttu-id="497e0-314">Qualsiasi indirizzo valido dell'argomento</span><span class="sxs-lookup"><span data-stu-id="497e0-314">Any valid topic address</span></span> |
| <span data-ttu-id="497e0-315">Effettuare un invio all'argomento</span><span class="sxs-lookup"><span data-stu-id="497e0-315">Send to the topic</span></span> |<span data-ttu-id="497e0-316">Invio</span><span class="sxs-lookup"><span data-stu-id="497e0-316">Send</span></span> |<span data-ttu-id="497e0-317">Qualsiasi indirizzo valido dell'argomento</span><span class="sxs-lookup"><span data-stu-id="497e0-317">Any valid topic address</span></span> |
| <span data-ttu-id="497e0-318">**Sottoscrizione**</span><span class="sxs-lookup"><span data-stu-id="497e0-318">**Subscription**</span></span> | | |
| <span data-ttu-id="497e0-319">Creare una sottoscrizione</span><span class="sxs-lookup"><span data-stu-id="497e0-319">Create a subscription</span></span> |<span data-ttu-id="497e0-320">Manage</span><span class="sxs-lookup"><span data-stu-id="497e0-320">Manage</span></span> |<span data-ttu-id="497e0-321">Qualsiasi indirizzo dello spazio dei nomi</span><span class="sxs-lookup"><span data-stu-id="497e0-321">Any namespace address</span></span> |
| <span data-ttu-id="497e0-322">Eliminare una sottoscrizione</span><span class="sxs-lookup"><span data-stu-id="497e0-322">Delete subscription</span></span> |<span data-ttu-id="497e0-323">Manage</span><span class="sxs-lookup"><span data-stu-id="497e0-323">Manage</span></span> |<span data-ttu-id="497e0-324">../myTopic/Subscriptions/mySubscription</span><span class="sxs-lookup"><span data-stu-id="497e0-324">../myTopic/Subscriptions/mySubscription</span></span> |
| <span data-ttu-id="497e0-325">Enumerare le sottoscrizioni</span><span class="sxs-lookup"><span data-stu-id="497e0-325">Enumerate subscriptions</span></span> |<span data-ttu-id="497e0-326">Manage</span><span class="sxs-lookup"><span data-stu-id="497e0-326">Manage</span></span> |<span data-ttu-id="497e0-327">../myTopic/Subscriptions</span><span class="sxs-lookup"><span data-stu-id="497e0-327">../myTopic/Subscriptions</span></span> |
| <span data-ttu-id="497e0-328">Ottenere la descrizione di una sottoscrizione</span><span class="sxs-lookup"><span data-stu-id="497e0-328">Get subscription description</span></span> |<span data-ttu-id="497e0-329">Gestire</span><span class="sxs-lookup"><span data-stu-id="497e0-329">Manage</span></span> |<span data-ttu-id="497e0-330">../myTopic/Subscriptions/mySubscription</span><span class="sxs-lookup"><span data-stu-id="497e0-330">../myTopic/Subscriptions/mySubscription</span></span> |
| <span data-ttu-id="497e0-331">Abbandonare o completare messaggi dopo la ricezione del messaggio in modalità PeekLock (blocco di visualizzazione)</span><span class="sxs-lookup"><span data-stu-id="497e0-331">Abandon or complete messages after receiving the message in peek-lock mode</span></span> |<span data-ttu-id="497e0-332">Attesa</span><span class="sxs-lookup"><span data-stu-id="497e0-332">Listen</span></span> |<span data-ttu-id="497e0-333">../myTopic/Subscriptions/mySubscription</span><span class="sxs-lookup"><span data-stu-id="497e0-333">../myTopic/Subscriptions/mySubscription</span></span> |
| <span data-ttu-id="497e0-334">Rinviare un messaggio per il successivo recupero</span><span class="sxs-lookup"><span data-stu-id="497e0-334">Defer a message for later retrieval</span></span> |<span data-ttu-id="497e0-335">Attesa</span><span class="sxs-lookup"><span data-stu-id="497e0-335">Listen</span></span> |<span data-ttu-id="497e0-336">../myTopic/Subscriptions/mySubscription</span><span class="sxs-lookup"><span data-stu-id="497e0-336">../myTopic/Subscriptions/mySubscription</span></span> |
| <span data-ttu-id="497e0-337">Spostare un messaggio nella coda dei messaggi non recapitabili</span><span class="sxs-lookup"><span data-stu-id="497e0-337">Deadletter a message</span></span> |<span data-ttu-id="497e0-338">Attesa</span><span class="sxs-lookup"><span data-stu-id="497e0-338">Listen</span></span> |<span data-ttu-id="497e0-339">../myTopic/Subscriptions/mySubscription</span><span class="sxs-lookup"><span data-stu-id="497e0-339">../myTopic/Subscriptions/mySubscription</span></span> |
| <span data-ttu-id="497e0-340">Ottenere lo stato associato a una sessione dell'argomento</span><span class="sxs-lookup"><span data-stu-id="497e0-340">Get the state associated with a topic session</span></span> |<span data-ttu-id="497e0-341">Attesa</span><span class="sxs-lookup"><span data-stu-id="497e0-341">Listen</span></span> |<span data-ttu-id="497e0-342">../myTopic/Subscriptions/mySubscription</span><span class="sxs-lookup"><span data-stu-id="497e0-342">../myTopic/Subscriptions/mySubscription</span></span> |
| <span data-ttu-id="497e0-343">Impostare lo stato associato a una sessione dell'argomento</span><span class="sxs-lookup"><span data-stu-id="497e0-343">Set the state associated with a topic session</span></span> |<span data-ttu-id="497e0-344">Attesa</span><span class="sxs-lookup"><span data-stu-id="497e0-344">Listen</span></span> |<span data-ttu-id="497e0-345">../myTopic/Subscriptions/mySubscription</span><span class="sxs-lookup"><span data-stu-id="497e0-345">../myTopic/Subscriptions/mySubscription</span></span> |
| <span data-ttu-id="497e0-346">**Regole**</span><span class="sxs-lookup"><span data-stu-id="497e0-346">**Rules**</span></span> | | |
| <span data-ttu-id="497e0-347">Creare una regola</span><span class="sxs-lookup"><span data-stu-id="497e0-347">Create a rule</span></span> |<span data-ttu-id="497e0-348">Manage</span><span class="sxs-lookup"><span data-stu-id="497e0-348">Manage</span></span> |<span data-ttu-id="497e0-349">../myTopic/Subscriptions/mySubscription</span><span class="sxs-lookup"><span data-stu-id="497e0-349">../myTopic/Subscriptions/mySubscription</span></span> |
| <span data-ttu-id="497e0-350">Eliminare una regola</span><span class="sxs-lookup"><span data-stu-id="497e0-350">Delete a rule</span></span> |<span data-ttu-id="497e0-351">Manage</span><span class="sxs-lookup"><span data-stu-id="497e0-351">Manage</span></span> |<span data-ttu-id="497e0-352">../myTopic/Subscriptions/mySubscription</span><span class="sxs-lookup"><span data-stu-id="497e0-352">../myTopic/Subscriptions/mySubscription</span></span> |
| <span data-ttu-id="497e0-353">Enumerare le regole</span><span class="sxs-lookup"><span data-stu-id="497e0-353">Enumerate rules</span></span> |<span data-ttu-id="497e0-354">Manage o Listen</span><span class="sxs-lookup"><span data-stu-id="497e0-354">Manage or Listen</span></span> |<span data-ttu-id="497e0-355">../myTopic/Subscriptions/mySubscription/Rules</span><span class="sxs-lookup"><span data-stu-id="497e0-355">../myTopic/Subscriptions/mySubscription/Rules</span></span> 

## <a name="next-steps"></a><span data-ttu-id="497e0-356">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="497e0-356">Next steps</span></span>

<span data-ttu-id="497e0-357">Per altre informazioni sulla messaggistica del bus di servizio, vedere gli argomenti seguenti.</span><span class="sxs-lookup"><span data-stu-id="497e0-357">To learn more about Service Bus messaging, see the following topics.</span></span>

* [<span data-ttu-id="497e0-358">Dati fondamentali del bus di servizio</span><span class="sxs-lookup"><span data-stu-id="497e0-358">Service Bus fundamentals</span></span>](service-bus-fundamentals-hybrid-solutions.md)
* [<span data-ttu-id="497e0-359">Code, argomenti e sottoscrizioni del bus di servizio</span><span class="sxs-lookup"><span data-stu-id="497e0-359">Service Bus queues, topics, and subscriptions</span></span>](service-bus-queues-topics-subscriptions.md)
* [<span data-ttu-id="497e0-360">Come usare le code del bus di servizio</span><span class="sxs-lookup"><span data-stu-id="497e0-360">How to use Service Bus queues</span></span>](service-bus-dotnet-get-started-with-queues.md)
* [<span data-ttu-id="497e0-361">Come usare gli argomenti e le sottoscrizioni del bus di servizio</span><span class="sxs-lookup"><span data-stu-id="497e0-361">How to use Service Bus topics and subscriptions</span></span>](service-bus-dotnet-how-to-use-topics-subscriptions.md)

[Azure portal]: https://portal.azure.com