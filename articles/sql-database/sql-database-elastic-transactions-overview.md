---
title: aaaDistributed transazioni tra database cloud
description: Panoramica delle transazioni di database elastico con il database SQL di Azure
services: sql-database
documentationcenter: 
author: torsteng
manager: jhubbard
editor: torsteng
ms.assetid: e14df7a3-7788-4cfb-bcd1-7ad6433ef1f9
ms.service: sql-database
ms.custom: scale out apps
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: sql-database
ms.date: 05/27/2016
ms.author: torsteng
ms.openlocfilehash: 9a18f2749108d337bf115b3dc21dd0c7828dd9c2
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/06/2017
---
# <a name="distributed-transactions-across-cloud-databases"></a><span data-ttu-id="b2e02-103">Transazioni distribuite in database cloud</span><span class="sxs-lookup"><span data-stu-id="b2e02-103">Distributed transactions across cloud databases</span></span>
<span data-ttu-id="b2e02-104">Le transazioni di database elastico per il Database SQL di Azure (database SQL) consentono toorun transazioni che si estendono su più database nel database di SQL Server.</span><span class="sxs-lookup"><span data-stu-id="b2e02-104">Elastic database transactions for Azure SQL Database (SQL DB) allow you toorun transactions that span several databases in SQL DB.</span></span> <span data-ttu-id="b2e02-105">Le transazioni di database elastico per il database SQL sono disponibili per le applicazioni .NET tramite ADO .NET e integrate con hello familiarità esperienza di programmazione utilizzando hello [System. Transaction](https://msdn.microsoft.com/library/system.transactions.aspx) classi.</span><span class="sxs-lookup"><span data-stu-id="b2e02-105">Elastic database transactions for SQL DB are available for .NET applications using ADO .NET and integrate with hello familiar programming experience using hello [System.Transaction](https://msdn.microsoft.com/library/system.transactions.aspx) classes.</span></span> <span data-ttu-id="b2e02-106">libreria di hello tooget, vedere [.NET Framework 4.6.1 (Web Installer)](https://www.microsoft.com/download/details.aspx?id=49981).</span><span class="sxs-lookup"><span data-stu-id="b2e02-106">tooget hello library, see [.NET Framework 4.6.1 (Web Installer)](https://www.microsoft.com/download/details.aspx?id=49981).</span></span>

<span data-ttu-id="b2e02-107">In locale questo scenario richiede in genere l'esecuzione di Microsoft Distributed Transaction Coordinator (MSDTC).</span><span class="sxs-lookup"><span data-stu-id="b2e02-107">On premises, such a scenario usually required running Microsoft Distributed Transaction Coordinator (MSDTC).</span></span> <span data-ttu-id="b2e02-108">Poiché MSDTC non è disponibile per l'applicazione Platform-as-a-Service in Azure, transazioni toocoordinate distributed possibilità di hello è ora stato integrato direttamente nel database di SQL Server.</span><span class="sxs-lookup"><span data-stu-id="b2e02-108">Since MSDTC is not available for Platform-as-a-Service application in Azure, hello ability toocoordinate distributed transactions has now been directly integrated into SQL DB.</span></span> <span data-ttu-id="b2e02-109">Le applicazioni possono connettersi le transazioni toolaunch distribuita di Database SQL tooany e uno dei database hello verrà coordinare in modo trasparente la transazione distribuita hello, come illustrato nella seguente illustrazione hello.</span><span class="sxs-lookup"><span data-stu-id="b2e02-109">Applications can connect tooany SQL Database toolaunch distributed transactions, and one of hello databases will transparently coordinate hello distributed transaction, as shown in hello following figure.</span></span> 

  ![<span data-ttu-id="b2e02-110">Transazioni distribuite con il database SQL di Azure tramite transazioni di database elastico</span><span class="sxs-lookup"><span data-stu-id="b2e02-110">Distributed transactions with Azure SQL Database using elastic database transactions</span></span> ][1]

## <a name="common-scenarios"></a><span data-ttu-id="b2e02-111">Scenari comuni</span><span class="sxs-lookup"><span data-stu-id="b2e02-111">Common scenarios</span></span>
<span data-ttu-id="b2e02-112">Le transazioni di database elastico per il database SQL di abilitare applicazioni toomake modifiche specifiche toodata archiviato in diversi database SQL.</span><span class="sxs-lookup"><span data-stu-id="b2e02-112">Elastic database transactions for SQL DB enable applications toomake atomic changes toodata stored in several different SQL Databases.</span></span> <span data-ttu-id="b2e02-113">Anteprima di Hello è incentrata sul lato client di sviluppo in c# e .NET.</span><span class="sxs-lookup"><span data-stu-id="b2e02-113">hello preview focuses on client-side development experiences in C# and .NET.</span></span> <span data-ttu-id="b2e02-114">Un'esperienza sul lato server con T-SQL è prevista per un momento successivo.</span><span class="sxs-lookup"><span data-stu-id="b2e02-114">A server-side experience using T-SQL is planned for a later time.</span></span>  
<span data-ttu-id="b2e02-115">Hello di database elastico transazioni destinazioni seguenti scenari:</span><span class="sxs-lookup"><span data-stu-id="b2e02-115">Elastic database transactions targets hello following scenarios:</span></span>

* <span data-ttu-id="b2e02-116">Applicazioni con più database in Azure: con questo scenario i dati sono partizionati verticalmente in più database nel database SQL, in modo che diversi tipi di dati risiedano in database diversi.</span><span class="sxs-lookup"><span data-stu-id="b2e02-116">Multi-database applications in Azure: With this scenario, data is vertically partitioned across several databases in SQL DB such that different kinds of data reside on different databases.</span></span> <span data-ttu-id="b2e02-117">Alcune operazioni sono necessarie modifiche toodata che viene mantenuto in due o più database.</span><span class="sxs-lookup"><span data-stu-id="b2e02-117">Some operations require changes toodata which is kept in two or more databases.</span></span> <span data-ttu-id="b2e02-118">un'applicazione Hello utilizza le modifiche di database elastico transazioni toocoordinate hello tra database e garantire l'atomicità.</span><span class="sxs-lookup"><span data-stu-id="b2e02-118">hello application uses elastic database transactions toocoordinate hello changes across databases and ensure atomicity.</span></span>
* <span data-ttu-id="b2e02-119">Applicazioni di database partizionato in Azure: con questo scenario, il livello di dati hello utilizza hello [libreria client di Database elastico](sql-database-elastic-database-client-library.md) o partizionamento orizzontale automatico toohorizontally partizionare i dati hello tra molti database nel database di SQL Server.</span><span class="sxs-lookup"><span data-stu-id="b2e02-119">Sharded database applications in Azure: With this scenario, hello data tier uses hello [Elastic Database client library](sql-database-elastic-database-client-library.md) or self-sharding toohorizontally partition hello data across many databases in SQL DB.</span></span> <span data-ttu-id="b2e02-120">Un caso di utilizzo principali è hello necessità tooperform atomica delle modifiche per un'applicazione multi-tenant partizionata quando le modifiche span tenant.</span><span class="sxs-lookup"><span data-stu-id="b2e02-120">One prominent use case is hello need tooperform atomic changes for a sharded multi-tenant application when changes span tenants.</span></span> <span data-ttu-id="b2e02-121">Si pensi ad esempio un trasferimento da un unico tenant tooanother, sia che si trovano in database diversi.</span><span class="sxs-lookup"><span data-stu-id="b2e02-121">Think for instance of a transfer from one tenant tooanother, both residing on different databases.</span></span> <span data-ttu-id="b2e02-122">Un secondo caso è partizionamento orizzontale granulari per le esigenze di capacità tooaccommodate per un tenant di grandi dimensioni che a sua volta in genere implica che alcune toostretch esigenze di operazioni atomiche su più database utilizzati per hello stesso tenant.</span><span class="sxs-lookup"><span data-stu-id="b2e02-122">A second case is fine-grained sharding tooaccommodate capacity needs for a large tenant which in turn typically implies that some atomic operations needs toostretch across several databases used for hello same tenant.</span></span> <span data-ttu-id="b2e02-123">Un terzo caso è dati tooreference aggiornamenti atomici che vengono replicati tra database.</span><span class="sxs-lookup"><span data-stu-id="b2e02-123">A third case is atomic updates tooreference data that are replicated across databases.</span></span> <span data-ttu-id="b2e02-124">Operazioni atomiche, transazionali, falsariga possono ora essere coordinate tra diversi database utilizzando anteprima hello.</span><span class="sxs-lookup"><span data-stu-id="b2e02-124">Atomic, transacted, operations along these lines can now be coordinated across several databases using hello preview.</span></span>
  <span data-ttu-id="b2e02-125">Le transazioni di database elastico utilizzano atomicità transazione di commit in due fasi tooensure tra database.</span><span class="sxs-lookup"><span data-stu-id="b2e02-125">Elastic database transactions use two-phase commit tooensure transaction atomicity across databases.</span></span> <span data-ttu-id="b2e02-126">È una scelta ideale per le transazioni che coinvolgono meno di 100 database alla volta in una singola transazione.</span><span class="sxs-lookup"><span data-stu-id="b2e02-126">It is a good fit for transactions that involve less than 100 databases at a time within a single transaction.</span></span> <span data-ttu-id="b2e02-127">Questi limiti non vengono applicati, ma uno aspettarsi prestazioni e le percentuali di successo per toosuffer le transazioni di database elastico quando supera questi limiti.</span><span class="sxs-lookup"><span data-stu-id="b2e02-127">These limits are not enforced, but one should expect performance and success rates for elastic database transactions toosuffer when exceeding these limits.</span></span>

## <a name="installation-and-migration"></a><span data-ttu-id="b2e02-128">Installazione e migrazione</span><span class="sxs-lookup"><span data-stu-id="b2e02-128">Installation and migration</span></span>
<span data-ttu-id="b2e02-129">funzionalità di Hello per le transazioni di database elastico in database di SQL Server sono fornite tramite le librerie .NET toohello aggiornamenti System.Data.dll e System.Transactions.dll.</span><span class="sxs-lookup"><span data-stu-id="b2e02-129">hello capabilities for elastic database transactions in SQL DB are provided through updates toohello .NET libraries System.Data.dll and System.Transactions.dll.</span></span> <span data-ttu-id="b2e02-130">Hello DLL assicurarsi che il protocollo 2PC viene utilizzato laddove necessario tooensure atomicità.</span><span class="sxs-lookup"><span data-stu-id="b2e02-130">hello DLLs ensure that two-phase commit is used where necessary tooensure atomicity.</span></span> <span data-ttu-id="b2e02-131">installare toostart lo sviluppo di applicazioni utilizzando le transazioni di database elastici, [.NET Framework 4.6.1](https://www.microsoft.com/download/details.aspx?id=49981) o versione successiva.</span><span class="sxs-lookup"><span data-stu-id="b2e02-131">toostart developing applications using elastic database transactions, install [.NET Framework 4.6.1](https://www.microsoft.com/download/details.aspx?id=49981) or a later version.</span></span> <span data-ttu-id="b2e02-132">Quando si esegue in una versione precedente di .NET framework di hello, transazioni non riusciranno toopromote tooa distribuita transaction e verrà generata un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="b2e02-132">When running on an earlier version of hello .NET framework, transactions will fail toopromote tooa distributed transaction and an exception will be raised.</span></span>

<span data-ttu-id="b2e02-133">Dopo l'installazione, è possibile utilizzare la transazione distribuita hello API in System. Transactions con connessioni tooSQL DB.</span><span class="sxs-lookup"><span data-stu-id="b2e02-133">After installation, you can use hello distributed transaction APIs in System.Transactions with connections tooSQL DB.</span></span> <span data-ttu-id="b2e02-134">Se si dispone di applicazioni di MSDTC utilizzano queste API, semplicemente ricompilare le applicazioni esistenti in .NET 4.6 dopo l'installazione di hello 4.6.1 Framework.</span><span class="sxs-lookup"><span data-stu-id="b2e02-134">If you have existing MSDTC applications using these APIs, simply rebuild your existing applications for .NET 4.6 after installing hello 4.6.1 Framework.</span></span> <span data-ttu-id="b2e02-135">Se i progetti destinati a .NET 4.6, verrà utilizzato automaticamente DLL hello aggiornato dalla nuova versione del Framework hello e chiamate API di transazione distribuita in combinazione con le connessioni tooSQL che DB avranno ora esito positivo.</span><span class="sxs-lookup"><span data-stu-id="b2e02-135">If your projects target .NET 4.6, they will automatically use hello updated DLLs from hello new Framework version and distributed transaction API calls in combination with connections tooSQL DB will now succeed.</span></span>

<span data-ttu-id="b2e02-136">Tenere presente che le transazioni di database elastico non richiedono l'installazione di MSDTC.</span><span class="sxs-lookup"><span data-stu-id="b2e02-136">Remember that elastic database transactions do not require installing MSDTC.</span></span> <span data-ttu-id="b2e02-137">Al contrario, le transazioni di database elastico sono gestite direttamente e internamente dal database SQL.</span><span class="sxs-lookup"><span data-stu-id="b2e02-137">Instead, elastic database transactions are directly managed by and within SQL DB.</span></span> <span data-ttu-id="b2e02-138">Ciò semplifica notevolmente scenari cloud poiché una distribuzione di MSDTC non è necessario toouse distribuita transazioni con database di SQL Server.</span><span class="sxs-lookup"><span data-stu-id="b2e02-138">This significantly simplifies cloud scenarios since a deployment of MSDTC is not necessary toouse distributed transactions with SQL DB.</span></span> <span data-ttu-id="b2e02-139">Sezione 4 viene illustrato in dettaglio come hello e le transazioni di database elastico toodeploy richiesto .NET framework con il tooAzure applicazioni cloud.</span><span class="sxs-lookup"><span data-stu-id="b2e02-139">Section 4 explains in more detail how toodeploy elastic database transactions and hello required .NET framework together with your cloud applications tooAzure.</span></span>

## <a name="development-experience"></a><span data-ttu-id="b2e02-140">Esperienza di sviluppo</span><span class="sxs-lookup"><span data-stu-id="b2e02-140">Development experience</span></span>
### <a name="multi-database-applications"></a><span data-ttu-id="b2e02-141">Applicazioni con più database</span><span class="sxs-lookup"><span data-stu-id="b2e02-141">Multi-database applications</span></span>
<span data-ttu-id="b2e02-142">Hello codice di esempio seguente usa esperienza di programmazione familiare hello con .NET System. Transactions.</span><span class="sxs-lookup"><span data-stu-id="b2e02-142">hello following sample code uses hello familiar programming experience with .NET System.Transactions.</span></span> <span data-ttu-id="b2e02-143">classe TransactionScope Hello stabilisce una transazione di ambiente in .NET.</span><span class="sxs-lookup"><span data-stu-id="b2e02-143">hello TransactionScope class establishes an ambient transaction in .NET.</span></span> <span data-ttu-id="b2e02-144">(Una "transazione di ambiente" è quello che si trova nel thread corrente hello.) Tutte le connessioni aperte all'interno di hello TransactionScope partecipano a transazioni hello.</span><span class="sxs-lookup"><span data-stu-id="b2e02-144">(An “ambient transaction” is one that lives in hello current thread.) All connections opened within hello TransactionScope participate in hello transaction.</span></span> <span data-ttu-id="b2e02-145">Se fa parte di un database diverso, transazione hello è automaticamente con privilegi elevati tooa distribuita transaction.</span><span class="sxs-lookup"><span data-stu-id="b2e02-145">If different databases participate, hello transaction is automatically elevated tooa distributed transaction.</span></span> <span data-ttu-id="b2e02-146">risultato di Hello della transazione hello è controllata dall'impostazione hello ambito toocomplete tooindicate un commit.</span><span class="sxs-lookup"><span data-stu-id="b2e02-146">hello outcome of hello transaction is controlled by setting hello scope toocomplete tooindicate a commit.</span></span>

    using (var scope = new TransactionScope())
    {
        using (var conn1 = new SqlConnection(connStrDb1))
        {
            conn1.Open();
            SqlCommand cmd1 = conn1.CreateCommand();
            cmd1.CommandText = string.Format("insert into T1 values(1)");
            cmd1.ExecuteNonQuery();
        }

        using (var conn2 = new SqlConnection(connStrDb2))
        {
            conn2.Open();
            var cmd2 = conn2.CreateCommand();
            cmd2.CommandText = string.Format("insert into T2 values(2)");
            cmd2.ExecuteNonQuery();
        }

        scope.Complete();
    }

### <a name="sharded-database-applications"></a><span data-ttu-id="b2e02-147">Applicazioni di database partizionato</span><span class="sxs-lookup"><span data-stu-id="b2e02-147">Sharded database applications</span></span>
<span data-ttu-id="b2e02-148">Le transazioni di database elastico per il database SQL supportano inoltre coordinare le transazioni distribuite in cui utilizzare hello OpenConnectionForKey metodo hello elastico client libreria tooopen di connessioni di database per i dati di scalabilità livello.</span><span class="sxs-lookup"><span data-stu-id="b2e02-148">Elastic database transactions for SQL DB also support coordinating distributed transactions where you use hello OpenConnectionForKey method of hello elastic database client library tooopen connections for a scaled out data tier.</span></span> <span data-ttu-id="b2e02-149">Considerare i casi in cui è necessario tooguarantee la consistenza delle transazioni per le modifiche tra i diversi valori di chiave di partizionamento orizzontale diverso.</span><span class="sxs-lookup"><span data-stu-id="b2e02-149">Consider cases where you need tooguarantee transactional consistency for changes across several different sharding key values.</span></span> <span data-ttu-id="b2e02-150">Partizioni toohello connessioni hosting valori di chiave di partizionamento orizzontale diversi hello sono negoziate utilizzando OpenConnectionForKey.</span><span class="sxs-lookup"><span data-stu-id="b2e02-150">Connections toohello shards hosting hello different sharding key values are brokered using OpenConnectionForKey.</span></span> <span data-ttu-id="b2e02-151">Nel caso generale hello, connessioni hello possono essere toodifferent partizioni in modo che garantire garanzie transazionale richiede una transazione distribuita.</span><span class="sxs-lookup"><span data-stu-id="b2e02-151">In hello general case, hello connections can be toodifferent shards such that ensuring transactional guarantees requires a distributed transaction.</span></span> <span data-ttu-id="b2e02-152">Questo approccio viene illustrato nell'esempio di codice seguente Hello.</span><span class="sxs-lookup"><span data-stu-id="b2e02-152">hello following code sample illustrates this approach.</span></span> <span data-ttu-id="b2e02-153">Si presuppone che una variabile denominata shardmap toorepresent usato dalla libreria client di database elastico hello eseguire il mapping di una partizione:</span><span class="sxs-lookup"><span data-stu-id="b2e02-153">It assumes that a variable called shardmap is used toorepresent a shard map from hello elastic database client library:</span></span>

    using (var scope = new TransactionScope())
    {
        using (var conn1 = shardmap.OpenConnectionForKey(tenantId1, credentialsStr))
        {
            conn1.Open();
            SqlCommand cmd1 = conn1.CreateCommand();
            cmd1.CommandText = string.Format("insert into T1 values(1)");
            cmd1.ExecuteNonQuery();
        }

        using (var conn2 = shardmap.OpenConnectionForKey(tenantId2, credentialsStr))
        {
            conn2.Open();
            var cmd2 = conn2.CreateCommand();
            cmd2.CommandText = string.Format("insert into T1 values(2)");
            cmd2.ExecuteNonQuery();
        }

        scope.Complete();
    }


## <a name="net-installation-for-azure-cloud-services"></a><span data-ttu-id="b2e02-154">Installazione di .NET per i servizi cloud di Azure</span><span class="sxs-lookup"><span data-stu-id="b2e02-154">.NET installation for Azure Cloud Services</span></span>
<span data-ttu-id="b2e02-155">Azure offre diverse offerte di applicazioni .NET toohost.</span><span class="sxs-lookup"><span data-stu-id="b2e02-155">Azure provides several offerings toohost .NET applications.</span></span> <span data-ttu-id="b2e02-156">È disponibile in un confronto delle diverse offerte hello [servizio App di Azure, servizi Cloud e macchine virtuali confronto](../app-service-web/choose-web-site-cloud-service-vm.md).</span><span class="sxs-lookup"><span data-stu-id="b2e02-156">A comparison of hello different offerings is available in [Azure App Service, Cloud Services, and Virtual Machines comparison](../app-service-web/choose-web-site-cloud-service-vm.md).</span></span> <span data-ttu-id="b2e02-157">Se hello sistema operativo guest dell'offerta hello è inferiore a .NET 4.6.1 richiesto per le transazioni elastiche, è necessario too4.6.1 del sistema operativo guest di tooupgrade hello.</span><span class="sxs-lookup"><span data-stu-id="b2e02-157">If hello guest OS of hello offering is smaller than .NET 4.6.1 required for elastic transactions, you need tooupgrade hello guest OS too4.6.1.</span></span> 

<span data-ttu-id="b2e02-158">Per i servizi di App di Azure, Aggiorna guest toohello che sistema operativo non è attualmente supportato.</span><span class="sxs-lookup"><span data-stu-id="b2e02-158">For Azure App Services, upgrades toohello guest OS are currently not supported.</span></span> <span data-ttu-id="b2e02-159">Macchine virtuali di Azure, è sufficiente accedere hello VM ed eseguire hello programma di installazione per .NET framework più recente di hello.</span><span class="sxs-lookup"><span data-stu-id="b2e02-159">For Azure Virtual Machines, simply log into hello VM and run hello installer for hello latest .NET framework.</span></span> <span data-ttu-id="b2e02-160">Servizi Cloud di Azure, è necessario installazione di hello tooinclude di una versione più recente di .NET in attività di avvio hello della distribuzione.</span><span class="sxs-lookup"><span data-stu-id="b2e02-160">For Azure Cloud Services, you need tooinclude hello installation of a newer .NET version into hello startup tasks of your deployment.</span></span> <span data-ttu-id="b2e02-161">Hello concetti e le procedure sono documentate in [installare .NET su un ruolo del servizio Cloud](../cloud-services/cloud-services-dotnet-install-dotnet.md).</span><span class="sxs-lookup"><span data-stu-id="b2e02-161">hello concepts and steps are documented in [Install .NET on a Cloud Service Role](../cloud-services/cloud-services-dotnet-install-dotnet.md).</span></span>  

<span data-ttu-id="b2e02-162">Si noti che hello programma di installazione per .NET 4.6.1 potrebbe richiedere più spazio di archiviazione temporaneo durante l'avvio di processo nei servizi cloud Azure del programma di installazione per .NET 4.6 hello hello.</span><span class="sxs-lookup"><span data-stu-id="b2e02-162">Note that hello installer for .NET 4.6.1 may require more temporary storage during hello bootstrapping process on Azure cloud services than hello installer for .NET 4.6.</span></span> <span data-ttu-id="b2e02-163">tooensure una corretta installazione, è necessario tooincrease di archiviazione temporanea per il servizio cloud di Azure nel file servicedefinition. Csdef sezione LocalResources hello e le impostazioni di ambiente hello dell'attività di avvio, come illustrato nell'esempio hello esempio:</span><span class="sxs-lookup"><span data-stu-id="b2e02-163">tooensure a successful installation, you need tooincrease temporary storage for your Azure cloud service in your ServiceDefinition.csdef file in hello LocalResources section and hello environment settings of your startup task, as shown in hello following sample:</span></span>

    <LocalResources>
    ...
        <LocalStorage name="TEMP" sizeInMB="5000" cleanOnRoleRecycle="false" />
        <LocalStorage name="TMP" sizeInMB="5000" cleanOnRoleRecycle="false" />
    </LocalResources>
    <Startup>
        <Task commandLine="install.cmd" executionContext="elevated" taskType="simple">
            <Environment>
        ...
                <Variable name="TEMP">
                    <RoleInstanceValue xpath="/RoleEnvironment/CurrentInstance/LocalResources/LocalResource[@name='TEMP']/@path" />
                </Variable>
                <Variable name="TMP">
                    <RoleInstanceValue xpath="/RoleEnvironment/CurrentInstance/LocalResources/LocalResource[@name='TMP']/@path" />
                </Variable>
            </Environment>
        </Task>
    </Startup>

## <a name="transactions-across-multiple-servers"></a><span data-ttu-id="b2e02-164">Transazioni tra più server</span><span class="sxs-lookup"><span data-stu-id="b2e02-164">Transactions across multiple servers</span></span>
<span data-ttu-id="b2e02-165">Le transazioni di database elastici sono supportate in diversi server logici del database SQL di Azure.</span><span class="sxs-lookup"><span data-stu-id="b2e02-165">Elastic database transactions are supported across different logical servers in Azure SQL Database.</span></span> <span data-ttu-id="b2e02-166">Quando le transazioni superano i limiti di server logico, i server che partecipa hello è innanzitutto necessario toobe immessi in una relazione di comunicazione reciproca.</span><span class="sxs-lookup"><span data-stu-id="b2e02-166">When transactions cross logical server boundaries, hello participating servers first need toobe entered into a mutual communication relationship.</span></span> <span data-ttu-id="b2e02-167">Una volta stabilita la relazione di comunicazione hello, qualsiasi database in uno dei due server può partecipare alle transazioni elastiche di database da hello hello altri server.</span><span class="sxs-lookup"><span data-stu-id="b2e02-167">Once hello communication relationship has been established, any database in any of hello two servers can participate in elastic transactions with databases from hello other server.</span></span> <span data-ttu-id="b2e02-168">Con le transazioni che si estende su più di due server logici, una relazione di comunicazione deve toobe sul posto per qualsiasi coppia di server logici.</span><span class="sxs-lookup"><span data-stu-id="b2e02-168">With transactions spanning more than two logical servers, a communication relationship needs toobe in place for any pair of logical servers.</span></span>

<span data-ttu-id="b2e02-169">Utilizzare hello relazioni di comunicazione tra server toomanage cmdlet PowerShell per le transazioni di database elastici seguenti:</span><span class="sxs-lookup"><span data-stu-id="b2e02-169">Use hello following PowerShell cmdlets toomanage cross-server communication relationships for elastic database transactions:</span></span>

* <span data-ttu-id="b2e02-170">**Nuovo AzureRmSqlServerCommunicationLink**: utilizzare questo toocreate cmdlet una nuova relazione di comunicazione tra due server logico nel database di SQL Azure.</span><span class="sxs-lookup"><span data-stu-id="b2e02-170">**New-AzureRmSqlServerCommunicationLink**: Use this cmdlet toocreate a new communication relationship between two logical servers in Azure SQL DB.</span></span> <span data-ttu-id="b2e02-171">relazione Hello è simmetrica, ovvero che entrambi i server possono avviare le transazioni con hello altri server.</span><span class="sxs-lookup"><span data-stu-id="b2e02-171">hello relationship is symmetric which means both servers can initiate transactions with hello other server.</span></span>
* <span data-ttu-id="b2e02-172">**Get-AzureRmSqlServerCommunicationLink**: utilizzare questo cmdlet tooretrieve la comunicazione esistente relazioni e le relative proprietà.</span><span class="sxs-lookup"><span data-stu-id="b2e02-172">**Get-AzureRmSqlServerCommunicationLink**: Use this cmdlet tooretrieve existing communication relationships and their properties.</span></span>
* <span data-ttu-id="b2e02-173">**Remove-AzureRmSqlServerCommunicationLink**: utilizzare questo tooremove cmdlet una relazione di comunicazione.</span><span class="sxs-lookup"><span data-stu-id="b2e02-173">**Remove-AzureRmSqlServerCommunicationLink**: Use this cmdlet tooremove an existing communication relationship.</span></span> 

## <a name="monitoring-transaction-status"></a><span data-ttu-id="b2e02-174">Monitoraggio dello stato delle transazioni</span><span class="sxs-lookup"><span data-stu-id="b2e02-174">Monitoring transaction status</span></span>
<span data-ttu-id="b2e02-175">Utilizzare viste a gestione dinamica (DMV) nel database di SQL Server toomonitor stato e l'avanzamento delle operazioni di database elastico in corso.</span><span class="sxs-lookup"><span data-stu-id="b2e02-175">Use Dynamic Management Views (DMVs) in SQL DB toomonitor status and progress of your ongoing elastic database transactions.</span></span> <span data-ttu-id="b2e02-176">Tootransactions correlati di tutte le viste a gestione dinamica sono rilevanti per le transazioni distribuite nel database di SQL Server.</span><span class="sxs-lookup"><span data-stu-id="b2e02-176">All DMVs related tootransactions are relevant for distributed transactions in SQL DB.</span></span> <span data-ttu-id="b2e02-177">È possibile trovare hello corrispondente elenco di viste a gestione dinamica: [transazione correlati viste a gestione dinamica e funzioni (Transact-SQL)](https://msdn.microsoft.com/library/ms178621.aspx).</span><span class="sxs-lookup"><span data-stu-id="b2e02-177">You can find hello corresponding list of DMVs here: [Transaction Related Dynamic Management Views and Functions (Transact-SQL)](https://msdn.microsoft.com/library/ms178621.aspx).</span></span>

<span data-ttu-id="b2e02-178">Queste viste a gestione dinamica sono particolarmente utili:</span><span class="sxs-lookup"><span data-stu-id="b2e02-178">These DMVs are particularly useful:</span></span>

* <span data-ttu-id="b2e02-179">**sys.dm\_tran\_active\_transactions**: elenca le transazioni attualmente attive e il relativo stato.</span><span class="sxs-lookup"><span data-stu-id="b2e02-179">**sys.dm\_tran\_active\_transactions**: Lists currently active transactions and their status.</span></span> <span data-ttu-id="b2e02-180">Hello colonna UOW (Unit Of Work) consente di identificare hello figlio diverse transazioni appartenenti toohello stessa transazione distribuita.</span><span class="sxs-lookup"><span data-stu-id="b2e02-180">hello UOW (Unit Of Work) column can identify hello different child transactions that belong toohello same distributed transaction.</span></span> <span data-ttu-id="b2e02-181">Tutte le transazioni all'interno di hello stessa transazione distribuita eseguire hello stesso valore UOW.</span><span class="sxs-lookup"><span data-stu-id="b2e02-181">All transactions within hello same distributed transaction carry hello same UOW value.</span></span> <span data-ttu-id="b2e02-182">Vedere hello [documentazione DMV](https://msdn.microsoft.com/library/ms174302.aspx) per altri dettagli.</span><span class="sxs-lookup"><span data-stu-id="b2e02-182">See hello [DMV documentation](https://msdn.microsoft.com/library/ms174302.aspx) for more details.</span></span>
* <span data-ttu-id="b2e02-183">**Sys.dm\_tran\_database\_transazioni**: fornisce informazioni aggiuntive sulle transazioni, ad esempio la selezione della transazione hello log hello.</span><span class="sxs-lookup"><span data-stu-id="b2e02-183">**sys.dm\_tran\_database\_transactions**: Provides additional information about transactions, such as placement of hello transaction in hello log.</span></span> <span data-ttu-id="b2e02-184">Vedere hello [documentazione DMV](https://msdn.microsoft.com/library/ms186957.aspx) per altri dettagli.</span><span class="sxs-lookup"><span data-stu-id="b2e02-184">See hello [DMV documentation](https://msdn.microsoft.com/library/ms186957.aspx) for more details.</span></span>
* <span data-ttu-id="b2e02-185">**Sys.dm\_tran\_blocchi**: fornisce informazioni sui blocchi hello che sono correntemente utilizzati dalle transazioni in corso.</span><span class="sxs-lookup"><span data-stu-id="b2e02-185">**sys.dm\_tran\_locks**: Provides information about hello locks that are currently held by ongoing transactions.</span></span> <span data-ttu-id="b2e02-186">Vedere hello [documentazione DMV](https://msdn.microsoft.com/library/ms190345.aspx) per altri dettagli.</span><span class="sxs-lookup"><span data-stu-id="b2e02-186">See hello [DMV documentation](https://msdn.microsoft.com/library/ms190345.aspx) for more details.</span></span>

## <a name="limitations"></a><span data-ttu-id="b2e02-187">Limitazioni</span><span class="sxs-lookup"><span data-stu-id="b2e02-187">Limitations</span></span>
<span data-ttu-id="b2e02-188">Hello limitazioni seguenti attualmente si applica le transazioni di database tooelastic nel database di SQL Server:</span><span class="sxs-lookup"><span data-stu-id="b2e02-188">hello following limitations currently apply tooelastic database transactions in SQL DB:</span></span>

* <span data-ttu-id="b2e02-189">Sono supportate solo le transazioni tra database nel database SQL.</span><span class="sxs-lookup"><span data-stu-id="b2e02-189">Only transactions across databases in SQL DB are supported.</span></span> <span data-ttu-id="b2e02-190">Altri provider di risorse [X/Open XA](https://en.wikipedia.org/wiki/X/Open_XA) e database al di fuori del database SQL non possono partecipare alle transazioni di database elastico.</span><span class="sxs-lookup"><span data-stu-id="b2e02-190">Other [X/Open XA](https://en.wikipedia.org/wiki/X/Open_XA) resource providers and databases outside of SQL DB cannot participate in elastic database transactions.</span></span> <span data-ttu-id="b2e02-191">Ciò significa che le transazioni di database elastico non possono estendersi in locale al database SQL Server e al database SQL di Azure.</span><span class="sxs-lookup"><span data-stu-id="b2e02-191">That means that elastic database transactions cannot stretch across on premises SQL Server and Azure SQL Databases.</span></span> <span data-ttu-id="b2e02-192">Per le transazioni distribuite in locale, continuare toouse MSDTC.</span><span class="sxs-lookup"><span data-stu-id="b2e02-192">For distributed transactions on premises, continue toouse MSDTC.</span></span> 
* <span data-ttu-id="b2e02-193">Sono supportate solo le transazioni coordinate tramite client da un'applicazione .NET.</span><span class="sxs-lookup"><span data-stu-id="b2e02-193">Only client-coordinated transactions from a .NET application are supported.</span></span> <span data-ttu-id="b2e02-194">Il supporto sul lato server per T-SQL, ad esempio BEGIN DISTRIBUTED TRANSACTION, è pianificato, ma non ancora disponibile.</span><span class="sxs-lookup"><span data-stu-id="b2e02-194">Server-side support for T-SQL such as BEGIN DISTRIBUTED TRANSACTION is planned, but not yet available.</span></span> 
* <span data-ttu-id="b2e02-195">Le transazioni tra i servizi WCF non sono supportate.</span><span class="sxs-lookup"><span data-stu-id="b2e02-195">Transactions across WCF services are not supported.</span></span> <span data-ttu-id="b2e02-196">Ad esempio, si dispone di un metodo del servizio WCF che esegue una transazione.</span><span class="sxs-lookup"><span data-stu-id="b2e02-196">For example, you have a WCF service method that executes a transaction.</span></span> <span data-ttu-id="b2e02-197">Inclusione hello chiamata all'interno di un ambito di transazione avrà esito negativo come una [ProtocolException](https://msdn.microsoft.com/library/system.servicemodel.protocolexception).</span><span class="sxs-lookup"><span data-stu-id="b2e02-197">Enclosing hello call within a transaction scope will fail as a [System.ServiceModel.ProtocolException](https://msdn.microsoft.com/library/system.servicemodel.protocolexception).</span></span>

## <a name="next-steps"></a><span data-ttu-id="b2e02-198">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="b2e02-198">Next steps</span></span>
<span data-ttu-id="b2e02-199">Per domande, rivolgersi toous su hello [forum di Database SQL](http://social.msdn.microsoft.com/forums/azure/home?forum=ssdsgetstarted) e per le richieste di funzionalità, aggiungerli toohello [forum sul feedback su Database SQL](https://feedback.azure.com/forums/217321-sql-database/).</span><span class="sxs-lookup"><span data-stu-id="b2e02-199">For questions, please reach out toous on hello [SQL Database forum](http://social.msdn.microsoft.com/forums/azure/home?forum=ssdsgetstarted) and for feature requests, please add them toohello [SQL Database feedback forum](https://feedback.azure.com/forums/217321-sql-database/).</span></span>

<!--Image references-->
[1]: ./media/sql-database-elastic-transactions-overview/distributed-transactions.png



