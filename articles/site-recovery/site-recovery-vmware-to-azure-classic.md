---
title: Eseguire la replica di macchine virtuali VMware e server fisici in Azure nel portale classico| Documentazione Microsoft
description: Questo articolo illustra come distribuire Azure Site Recovery per orchestrare la replica, il failover e il ripristino di macchine virtuali VMware locali e server fisici Windows/Linux in Azure.
services: site-recovery
documentationcenter: 
author: rayne-wiselman
manager: jwhit
editor: 
ms.assetid: a9022c1f-43c1-4d38-841f-52540025fb46
ms.service: site-recovery
ms.workload: storage-backup-recovery
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 06/23/2017
ms.author: raynew
ROBOTS: NOINDEX, NOFOLLOW
redirect_url: site-recovery-vmware-to-azure
ms.openlocfilehash: 73c3fb5cf4056ddb9554f598ec7f173d81802f17
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 07/11/2017
---
# <a name="replicate-vmware-virtual-machines-and-physical-servers-to-azure-with-azure-site-recovery"></a><span data-ttu-id="39e5c-103">Eseguire la replica di macchine virtuali VMware e server fisici in Azure con Azure Site Recovery</span><span class="sxs-lookup"><span data-stu-id="39e5c-103">Replicate VMware virtual machines and physical servers to Azure with Azure Site Recovery</span></span>
> [!div class="op_single_selector"]
> * [<span data-ttu-id="39e5c-104">Il portale di Azure</span><span class="sxs-lookup"><span data-stu-id="39e5c-104">The Azure portal</span></span>](site-recovery-vmware-to-azure.md)
> * [<span data-ttu-id="39e5c-105">Il portale classico</span><span class="sxs-lookup"><span data-stu-id="39e5c-105">The classic portal</span></span>](site-recovery-vmware-to-azure-classic.md)
> * [<span data-ttu-id="39e5c-106">Il portale classico (legacy)</span><span class="sxs-lookup"><span data-stu-id="39e5c-106">The classic portal (legacy)</span></span>](site-recovery-vmware-to-azure-classic-legacy.md)
>
>

<span data-ttu-id="39e5c-107">Il servizio Azure Site Recovery favorisce l'attuazione della strategia di continuità aziendale e ripristino di emergenza (BCDR) orchestrando le operazioni di replica, failover e ripristino delle macchine virtuali e dei server fisici.</span><span class="sxs-lookup"><span data-stu-id="39e5c-107">The Azure Site Recovery service contributes to your business continuity and disaster recovery (BCDR) strategy by orchestrating replication, failover, and recovery of virtual machines and physical servers.</span></span> <span data-ttu-id="39e5c-108">È possibile replicare le macchine in Azure o in un data center locale secondario.</span><span class="sxs-lookup"><span data-stu-id="39e5c-108">Machines can be replicated to Azure or to a secondary on-premises data center.</span></span> <span data-ttu-id="39e5c-109">Per una panoramica rapida, vedere [Che cos'è Azure Site Recovery?](site-recovery-overview.md)</span><span class="sxs-lookup"><span data-stu-id="39e5c-109">For a quick overview, see [What is Azure Site Recovery?](site-recovery-overview.md).</span></span>

## <a name="overview"></a><span data-ttu-id="39e5c-110">Panoramica</span><span class="sxs-lookup"><span data-stu-id="39e5c-110">Overview</span></span>
<span data-ttu-id="39e5c-111">Questo articolo illustra come:</span><span class="sxs-lookup"><span data-stu-id="39e5c-111">This article describes how to:</span></span>

* <span data-ttu-id="39e5c-112">**Eseguire la replica di macchine virtuali VMware in Azure**: distribuire Site Recovery per coordinare la replica, il failover e il ripristino di macchine virtuali VMware locali nell'archiviazione di Azure.</span><span class="sxs-lookup"><span data-stu-id="39e5c-112">**Replicate VMware virtual machines to Azure**: Deploy Site Recovery to coordinate replication, failover, and recovery of on-premises VMware virtual machines to Azure storage.</span></span>
* <span data-ttu-id="39e5c-113">**Eseguire la replica di server fisici in Azure**: distribuire Azure Site Recovery per coordinare la replica, il failover e il ripristino di server fisici Windows e Linux locali in Azure.</span><span class="sxs-lookup"><span data-stu-id="39e5c-113">**Replicate physical servers to Azure**: Deploy Azure Site Recovery to coordinate replication, failover, and recovery of on-premises physical Windows and Linux servers to Azure.</span></span>

> [!NOTE]
> <span data-ttu-id="39e5c-114">Questo articolo illustra come eseguire la replica in Azure.</span><span class="sxs-lookup"><span data-stu-id="39e5c-114">This article describes how to replicate to Azure.</span></span> <span data-ttu-id="39e5c-115">Per eseguire la replica di VM VMware o di server fisici Windows/Linux in un data center secondario, vedere [Site Recovery: da VMware a VMware](site-recovery-vmware-to-vmware.md).</span><span class="sxs-lookup"><span data-stu-id="39e5c-115">If you want to replicate VMware VMs or Windows/Linux physical servers to a secondary datacenter, see [Site Recovery VMware to VMware](site-recovery-vmware-to-vmware.md).</span></span>
>
>

<span data-ttu-id="39e5c-116">Per inviare commenti o domande è possibile usare la parte inferiore di questo articolo oppure il [forum sui Servizi di ripristino di Azure](https://social.msdn.microsoft.com/forums/azure/home?forum=hypervrecovmgr).</span><span class="sxs-lookup"><span data-stu-id="39e5c-116">Post any comments or questions at the bottom of this article or on the [Azure Recovery Services Forum](https://social.msdn.microsoft.com/forums/azure/home?forum=hypervrecovmgr).</span></span>

## <a name="enhanced-deployment"></a><span data-ttu-id="39e5c-117">Distribuzione avanzata</span><span class="sxs-lookup"><span data-stu-id="39e5c-117">Enhanced deployment</span></span>
<span data-ttu-id="39e5c-118">Questo articolo comprende istruzioni per la distribuzione avanzata nel portale di Azure classico.</span><span class="sxs-lookup"><span data-stu-id="39e5c-118">This article includes instructions for an enhanced deployment in the Azure classic portal.</span></span> <span data-ttu-id="39e5c-119">È consigliabile usare questa versione per tutte le nuove distribuzioni.</span><span class="sxs-lookup"><span data-stu-id="39e5c-119">We recommend that you use this version for all new deployments.</span></span> <span data-ttu-id="39e5c-120">Se è già stata eseguita la distribuzione con la versione legacy precedente è consigliabile eseguire la migrazione alla nuova versione.</span><span class="sxs-lookup"><span data-stu-id="39e5c-120">If you've already deployed by using the earlier legacy version, we recommend that you migrate to the new version.</span></span> <span data-ttu-id="39e5c-121">Per altre informazioni sulla migrazione, vedere [Site Recovery: migrazione da VMware ad Azure classico legacy](site-recovery-vmware-to-azure-classic-legacy.md#migrate-to-the-enhanced-deployment).</span><span class="sxs-lookup"><span data-stu-id="39e5c-121">For more about migration, see [Site Recovery VMware to Azure classic legacy](site-recovery-vmware-to-azure-classic-legacy.md#migrate-to-the-enhanced-deployment).</span></span>

<span data-ttu-id="39e5c-122">La distribuzione avanzata è un aggiornamento importante.</span><span class="sxs-lookup"><span data-stu-id="39e5c-122">The enhanced deployment is a major update.</span></span> <span data-ttu-id="39e5c-123">Di seguito è riportato un riepilogo dei miglioramenti apportati:</span><span class="sxs-lookup"><span data-stu-id="39e5c-123">Here's a summary of the improvements we've made:</span></span>

* <span data-ttu-id="39e5c-124">**Nessuna VM dell'infrastruttura in Azure**: i dati vengono replicati direttamente in un account di archiviazione di Azure.</span><span class="sxs-lookup"><span data-stu-id="39e5c-124">**No infrastructure VMs in Azure**: Data replicates directly to an Azure storage account.</span></span> <span data-ttu-id="39e5c-125">A differenza della distribuzione legacy non è necessario configurare VM dell'infrastruttura, come server di configurazione o server di destinazione master.</span><span class="sxs-lookup"><span data-stu-id="39e5c-125">In addition, there's no need to set up any infrastructure VMs (like configuration server or master target server) for replication and failover as was needed in the legacy deployment.</span></span>  
* <span data-ttu-id="39e5c-126">**Installazione unificata**: un'unica installazione garantisce la scalabilità per i componenti locali e ne semplifica la configurazione.</span><span class="sxs-lookup"><span data-stu-id="39e5c-126">**Unified installation**: A single installation provides simple setup and scalability for on-premises components.</span></span>
* <span data-ttu-id="39e5c-127">**Distribuzione sicura**: tutto il traffico viene crittografato e le comunicazioni relative alla gestione della replica vengono inviate tramite HTTPS 443.</span><span class="sxs-lookup"><span data-stu-id="39e5c-127">**Secure deployment**: All traffic is encrypted, and replication management communications are sent over HTTPS 443.</span></span>
* <span data-ttu-id="39e5c-128">**Punti di ripristino**: supporto per punti di ripristino per l'arresto anomalo del sistema e coerenti con l'applicazione per ambienti Windows e Linux. Sono supportate configurazioni coerenti con VM singole e multiple.</span><span class="sxs-lookup"><span data-stu-id="39e5c-128">**Recovery points**: Support for crash and application-consistent recovery points for Windows and Linux environments, and support for both single VM and multi-VM consistent configurations.</span></span>
* <span data-ttu-id="39e5c-129">**Failover di test**: supporto per il failover di test senza interruzione del servizio in Azure, senza incidere sulla produzione o sospendere la replica.</span><span class="sxs-lookup"><span data-stu-id="39e5c-129">**Test failover**: Support for non-disruptive test failover to Azure without affecting production or pausing replication.</span></span>
* <span data-ttu-id="39e5c-130">**Failover non pianificato**: supporto per il failover non pianificato in Azure con un'opzione avanzata che consente di arrestare automaticamente le VM prima del failover.</span><span class="sxs-lookup"><span data-stu-id="39e5c-130">**Unplanned failover**: Support for unplanned failover to Azure with an enhanced option to automatically shut down VMs before failover.</span></span>
* <span data-ttu-id="39e5c-131">**Failback**: failback integrato che consente di replicare solo le modifiche differenziali al sito locale.</span><span class="sxs-lookup"><span data-stu-id="39e5c-131">**Failback**: Integrated failback that replicates only delta changes back to the on-premises site.</span></span>
* <span data-ttu-id="39e5c-132">**vSphere 6.0**: supporto limitato per le distribuzioni di VMware vSphere 6.0.</span><span class="sxs-lookup"><span data-stu-id="39e5c-132">**vSphere 6.0**: Limited support for VMware vSphere 6.0 deployments.</span></span>

## <a name="how-does-site-recovery-help-protect-virtual-machines-and-physical-servers"></a><span data-ttu-id="39e5c-133">Azure Site Recovery contribuisce alla protezione di macchine virtuali e server fisici</span><span class="sxs-lookup"><span data-stu-id="39e5c-133">How does Site Recovery help protect virtual machines and physical servers?</span></span>
* <span data-ttu-id="39e5c-134">Gli amministratori VMware possono configurare misure di sicurezza in remoto per proteggere Azure da carichi di lavoro aziendali e applicazioni in esecuzione su macchine virtuali VMware.</span><span class="sxs-lookup"><span data-stu-id="39e5c-134">VMware administrators can configure off-site safeguards to protect Azure from business workloads and applications running on VMware virtual machines.</span></span> <span data-ttu-id="39e5c-135">I responsabili della gestione dei server possono replicare i server fisici Windows e Linux locali in Azure.</span><span class="sxs-lookup"><span data-stu-id="39e5c-135">Server managers can replicate physical on-premises Windows and Linux servers to Azure.</span></span>
* <span data-ttu-id="39e5c-136">La console Azure Site Recovery riunisce in un'unica posizione e semplifica le operazioni di configurazione e gestione dei processi di replica, failover e ripristino.</span><span class="sxs-lookup"><span data-stu-id="39e5c-136">The Azure Site Recovery console provides a single location for simple setup and management of replication, failover, and recovery processes.</span></span>
* <span data-ttu-id="39e5c-137">Se si esegue la replica di macchine virtuali VMware gestite da un server vCenter, Site Recovery può rilevare automaticamente le macchine virtuali.</span><span class="sxs-lookup"><span data-stu-id="39e5c-137">If you replicate VMware virtual machines that are managed by a vCenter server, Site Recovery can discover those VMs automatically.</span></span> <span data-ttu-id="39e5c-138">Se le macchine si trovano in un host ESXi, Site Recovery rileva le VM nell'host.</span><span class="sxs-lookup"><span data-stu-id="39e5c-138">If machines are on a ESXi host, Site Recovery discovers VMs on the host.</span></span>
* <span data-ttu-id="39e5c-139">Se si eseguono failover dall'infrastruttura locale ad Azure è possibile eseguire il failback (ripristino) da Azure ai server delle macchine virtuali VMware nel sito locale.</span><span class="sxs-lookup"><span data-stu-id="39e5c-139">If you run easy failovers from your on-premises infrastructure to Azure, you can fail back (restore) from Azure to VMware VM servers in the on-premises site.</span></span>
* <span data-ttu-id="39e5c-140">È possibile configurare piani di ripristino che raggruppano i carichi di lavoro delle applicazioni a più livelli su più macchine.</span><span class="sxs-lookup"><span data-stu-id="39e5c-140">You can configure recovery plans that group application workloads that are tiered across multiple machines.</span></span> <span data-ttu-id="39e5c-141">Se si esegue il failover di questi piani, Site Recovery assicura la coerenza di più macchine virtuali, in modo che le macchine virtuali che eseguono gli stessi carichi di lavoro possano essere ripristinate insieme in un punto dati coerente.</span><span class="sxs-lookup"><span data-stu-id="39e5c-141">If you fail over those plans, Site Recovery provides multi-VM consistency so that machines running the same workloads can be recovered together to a consistent data point.</span></span>

## <a name="supported-operating-systems"></a><span data-ttu-id="39e5c-142">Sistemi operativi supportati</span><span class="sxs-lookup"><span data-stu-id="39e5c-142">Supported operating systems</span></span>
### <a name="windows-64-bit-only"></a><span data-ttu-id="39e5c-143">Windows (solo 64 bit)</span><span class="sxs-lookup"><span data-stu-id="39e5c-143">Windows (64 bit only)</span></span>
* <span data-ttu-id="39e5c-144">Windows Server 2008 R2 SP1+</span><span class="sxs-lookup"><span data-stu-id="39e5c-144">Windows Server 2008 R2 SP1+</span></span>
* <span data-ttu-id="39e5c-145">Windows Server 2012</span><span class="sxs-lookup"><span data-stu-id="39e5c-145">Windows Server 2012</span></span>
* <span data-ttu-id="39e5c-146">Windows Server 2012 R2</span><span class="sxs-lookup"><span data-stu-id="39e5c-146">Windows Server 2012 R2</span></span>

### <a name="linux-64-bit-only"></a><span data-ttu-id="39e5c-147">Linux (solo versione a 64 bit)</span><span class="sxs-lookup"><span data-stu-id="39e5c-147">Linux (64 bit only)</span></span>
* <span data-ttu-id="39e5c-148">Red Hat Enterprise Linux 6.7, 7.1 e 7.2</span><span class="sxs-lookup"><span data-stu-id="39e5c-148">Red Hat Enterprise Linux 6.7, 7.1, and 7.2</span></span>
* <span data-ttu-id="39e5c-149">CentOS 6.5, 6.6, 6.7, 7.0, 7.1 e 7.2</span><span class="sxs-lookup"><span data-stu-id="39e5c-149">CentOS 6.5, 6.6, 6.7, 7.0, 7.1, and 7.2</span></span>
* <span data-ttu-id="39e5c-150">Oracle Enterprise Linux 6.4 e 6.5 che esegue il kernel compatibile Red Hat o Unbreakable Enterprise Kernel Release 3 (UEK3)</span><span class="sxs-lookup"><span data-stu-id="39e5c-150">Oracle Enterprise Linux 6.4 and 6.5 running either the Red Hat compatible kernel or Unbreakable Enterprise Kernel Release 3 (UEK3)</span></span>
* <span data-ttu-id="39e5c-151">SUSE Linux Enterprise Server 11 SP3</span><span class="sxs-lookup"><span data-stu-id="39e5c-151">SUSE Linux Enterprise Server 11 SP3</span></span>

## <a name="scenario-architecture"></a><span data-ttu-id="39e5c-152">Architettura dello scenario</span><span class="sxs-lookup"><span data-stu-id="39e5c-152">Scenario architecture</span></span>
<span data-ttu-id="39e5c-153">Componenti dello scenario:</span><span class="sxs-lookup"><span data-stu-id="39e5c-153">Scenario components:</span></span>

* <span data-ttu-id="39e5c-154">**Server di gestione locale**: il server di gestione esegue i componenti di Site Recovery seguenti.</span><span class="sxs-lookup"><span data-stu-id="39e5c-154">**An on-premises management server**: The management server runs Site Recovery components:</span></span>
  * <span data-ttu-id="39e5c-155">**Server di configurazione**: coordina le comunicazioni e gestisce i processi di ripristino e replica dei dati.</span><span class="sxs-lookup"><span data-stu-id="39e5c-155">**Configuration server**:  Coordinates communication and manages data replication and recovery processes.</span></span>
  * <span data-ttu-id="39e5c-156">**Server di elaborazione**: agisce come un gateway di replica.</span><span class="sxs-lookup"><span data-stu-id="39e5c-156">**Process server**:  Acts as a replication gateway.</span></span> <span data-ttu-id="39e5c-157">Riceve i dati da macchine di origine protette, li ottimizza attraverso il caching, la compressione e la crittografia e invia i dati di replica all'archiviazione di Azure.</span><span class="sxs-lookup"><span data-stu-id="39e5c-157">It receives data from protected source machines; optimizes it with caching, compression, and encryption; and sends replication data to Azure storage.</span></span> <span data-ttu-id="39e5c-158">Gestisce anche l'installazione push del servizio Mobility nei computer protetti ed esegue l'individuazione automatica delle macchine virtuali VMware.</span><span class="sxs-lookup"><span data-stu-id="39e5c-158">It also handles push installation of Mobility service to protected machines and performs automatic discovery of VMware VMs.</span></span>
  * <span data-ttu-id="39e5c-159">**Server di destinazione master**: gestisce i dati di replica durante il failback da Azure.</span><span class="sxs-lookup"><span data-stu-id="39e5c-159">**Master target server**: Handles replication data during failback from Azure.</span></span>
    <span data-ttu-id="39e5c-160">È anche possibile distribuire un server di gestione che agisce solamente come server di elaborazione per ridimensionare la distribuzione.</span><span class="sxs-lookup"><span data-stu-id="39e5c-160">You can also deploy a management server that acts only as a process server to scale your deployment.</span></span>
* <span data-ttu-id="39e5c-161">**Servizio Mobility**: questo componente viene distribuito in ogni computer, ovvero VM VMware o server fisico, di cui si vuole eseguire la replica in Azure.</span><span class="sxs-lookup"><span data-stu-id="39e5c-161">**The Mobility service**: This component is deployed on each machine (VMware VM or physical server) that you want to replicate to Azure.</span></span> <span data-ttu-id="39e5c-162">Acquisisce le scritture di dati nel computer e le inoltra al server di elaborazione.</span><span class="sxs-lookup"><span data-stu-id="39e5c-162">It captures data writes on the machine and forwards them to the process server.</span></span>
* <span data-ttu-id="39e5c-163">**Azure**: non è necessario creare VM di Azure per gestire la replica e il failover.</span><span class="sxs-lookup"><span data-stu-id="39e5c-163">**Azure**: You don't need to create any Azure VMs to handle replication and failover.</span></span> <span data-ttu-id="39e5c-164">Il servizio Azure Site Recovery si occupa della gestione dati, che vengono replicati direttamente nell'archiviazione di Azure.</span><span class="sxs-lookup"><span data-stu-id="39e5c-164">The Site Recovery service handles data management, and data replicates directly to Azure storage.</span></span> <span data-ttu-id="39e5c-165">Le macchine virtuali di Azure replicate vengono riattivate automaticamente solo quando si verifica il failover in Azure.</span><span class="sxs-lookup"><span data-stu-id="39e5c-165">Replicated Azure VMs are spun up automatically only when failover to Azure occurs.</span></span> <span data-ttu-id="39e5c-166">Per eseguire il failback da Azure al sito locale è tuttavia necessario configurare una macchina virtuale di Azure che agisca come server di elaborazione.</span><span class="sxs-lookup"><span data-stu-id="39e5c-166">However, if you want to fail back from Azure to the on-premises site, you will need to set up an Azure VM to act as a process server.</span></span>

<span data-ttu-id="39e5c-167">Lo schema seguente, creato da Henry Robalino, illustra l'interazione di questi componenti:</span><span class="sxs-lookup"><span data-stu-id="39e5c-167">The following graphic (created by Henry Robalino) shows how these components interact:</span></span>

![Architettura dei componenti](./media/site-recovery-vmware-to-azure/v2a-architecture-henry.png)

## <a name="capacity-planning"></a><span data-ttu-id="39e5c-169">Pianificazione della capacità</span><span class="sxs-lookup"><span data-stu-id="39e5c-169">Capacity planning</span></span>
<span data-ttu-id="39e5c-170">Quando si pianifica la capacità, è necessario considerare quanto segue:</span><span class="sxs-lookup"><span data-stu-id="39e5c-170">When you’re planning capacity, here's what you need to think about:</span></span>

* <span data-ttu-id="39e5c-171">**Ambiente di origine**: pianificazione della capacità o requisiti della macchina di origine e dell'infrastruttura VMware.</span><span class="sxs-lookup"><span data-stu-id="39e5c-171">**The source environment**: Capacity planning or the VMware infrastructure and source machine requirements.</span></span>
* <span data-ttu-id="39e5c-172">**Server di gestione**: pianificazione dei server di gestione locali che eseguono i componenti di Site Recovery.</span><span class="sxs-lookup"><span data-stu-id="39e5c-172">**The management server**: Planning for the on-premises management servers that run Site Recovery components.</span></span>
* <span data-ttu-id="39e5c-173">**Larghezza di banda di rete dall'origine alla destinazione**: pianificazione della larghezza di banda di rete necessaria per la replica tra l'origine e Azure.</span><span class="sxs-lookup"><span data-stu-id="39e5c-173">**Network bandwidth from source to target**: Planning for network bandwidth required for replication between the source and Azure.</span></span>

### <a name="source-environment-considerations"></a><span data-ttu-id="39e5c-174">Considerazioni relative all'ambiente di origine</span><span class="sxs-lookup"><span data-stu-id="39e5c-174">Source environment considerations</span></span>
* <span data-ttu-id="39e5c-175">**Frequenza di modifica giornaliera massima**: una macchina protetta può usare un solo server di elaborazione.</span><span class="sxs-lookup"><span data-stu-id="39e5c-175">**Maximum daily change rate**: A protected machine can use only one process server.</span></span> <span data-ttu-id="39e5c-176">Un singolo server di elaborazione può gestire fino a 2 TB di frequenza di modifica giornaliera.</span><span class="sxs-lookup"><span data-stu-id="39e5c-176">A single process server can handle up to 2 TB of data change per day.</span></span> <span data-ttu-id="39e5c-177">La massima frequenza di modifica dei dati giornaliera supportata per una macchina protetta è quindi di 2 TB.</span><span class="sxs-lookup"><span data-stu-id="39e5c-177">Thus, 2 TB is the maximum daily data change rate that’s supported for a protected machine.</span></span>
* <span data-ttu-id="39e5c-178">**Velocità effettiva massima**: una macchina replicata può appartenere a un account di archiviazione in Azure.</span><span class="sxs-lookup"><span data-stu-id="39e5c-178">**Maximum throughput**: A replicated machine can belong to one storage account in Azure.</span></span> <span data-ttu-id="39e5c-179">Un account di archiviazione standard può gestire fino a 20.000 richieste al secondo ed è consigliabile fare in modo che il numero di IOPS in una macchina di origine rimanga 20.000.</span><span class="sxs-lookup"><span data-stu-id="39e5c-179">A standard storage account can handle a maximum of 20,000 requests per second, and we recommend that you keep the number of IOPS across a source machine to 20,000.</span></span> <span data-ttu-id="39e5c-180">Se ad esempio è presente una macchina di origine con 5 dischi e ogni disco genera 120 IOPS (dimensione pari a 8 K) nell'origine, la macchina rientra nel limite di Azure pari a 500 IOPS per disco.</span><span class="sxs-lookup"><span data-stu-id="39e5c-180">For example, if you have a source machine with 5 disks and each disk generates 120 IOPS (8 KB size) on the source, it will be within the Azure per disk IOPS limit of 500.</span></span> <span data-ttu-id="39e5c-181">Numero di account di archiviazione necessario = IOPS di origine totali/20.000.</span><span class="sxs-lookup"><span data-stu-id="39e5c-181">The number of storage accounts required = total source IOPs/20,000.</span></span>

### <a name="management-server-considerations"></a><span data-ttu-id="39e5c-182">Considerazioni relative al server di elaborazione</span><span class="sxs-lookup"><span data-stu-id="39e5c-182">Management server considerations</span></span>
<span data-ttu-id="39e5c-183">Il server di gestione esegue i componenti di Site Recovery che gestiscono l'ottimizzazione, la replica e la gestione dati.</span><span class="sxs-lookup"><span data-stu-id="39e5c-183">The management server runs Site Recovery components that handle data optimization, replication, and management.</span></span> <span data-ttu-id="39e5c-184">Deve poter gestire la capacità della frequenza di modifica giornaliera in tutti i carichi di lavoro in esecuzione nelle macchine protette e avere a disposizione una larghezza di banda sufficiente per eseguire la replica continua dei dati nell'archiviazione di Azure.</span><span class="sxs-lookup"><span data-stu-id="39e5c-184">It should be able to handle the daily change rate capacity across all workloads running on protected machines, and it has sufficient bandwidth to continuously replicate data to Azure storage.</span></span> <span data-ttu-id="39e5c-185">In particolare:</span><span class="sxs-lookup"><span data-stu-id="39e5c-185">Specifically:</span></span>

* <span data-ttu-id="39e5c-186">Il server di elaborazione riceve i dati di replica dalle macchine protette e li ottimizza attraverso il caching, la compressione e la crittografia prima di inviarli ad Azure.</span><span class="sxs-lookup"><span data-stu-id="39e5c-186">The process server receives replication data from protected machines and optimizes it with caching, compression, and encryption before sending it to Azure.</span></span> <span data-ttu-id="39e5c-187">Il server di gestione deve avere risorse sufficienti per eseguire queste attività.</span><span class="sxs-lookup"><span data-stu-id="39e5c-187">The management server should have sufficient resources to perform these tasks.</span></span>
* <span data-ttu-id="39e5c-188">Il server di elaborazione usa una cache basata su disco.</span><span class="sxs-lookup"><span data-stu-id="39e5c-188">The process server uses disk-based cache.</span></span> <span data-ttu-id="39e5c-189">È consigliabile usare un disco a parte per la cache di almeno 600 GB per gestire le modifiche ai dati archiviate in caso di colli di bottiglia o interruzioni della rete.</span><span class="sxs-lookup"><span data-stu-id="39e5c-189">We recommend a separate cache disk of 600 GB or more to handle data changes stored in the event of network bottleneck or outage.</span></span> <span data-ttu-id="39e5c-190">Durante la distribuzione è possibile configurare la cache in qualsiasi unità che abbia almeno 5 GB di spazio di archiviazione disponibile ma 600 GB è il minimo consigliato.</span><span class="sxs-lookup"><span data-stu-id="39e5c-190">During deployment, you can configure the cache on any drive that has at least 5 GB of storage available, but 600 GB is the minimum recommendation.</span></span>
* <span data-ttu-id="39e5c-191">Come procedura consigliata, il server di gestione dovrebbe trovarsi nella stessa rete e nello stesso segmento LAN delle macchine da proteggere.</span><span class="sxs-lookup"><span data-stu-id="39e5c-191">As a best practice, we recommend that the management server is located on the same network and LAN segment as the machines you want to protect.</span></span> <span data-ttu-id="39e5c-192">Può trovarsi in una rete diversa, ma le macchine da proteggere devono avere la visibilità di rete L3 per il server.</span><span class="sxs-lookup"><span data-stu-id="39e5c-192">It can be located on a different network, but machines you want to protect should have L3 network visibility to it.</span></span>

<span data-ttu-id="39e5c-193">Le dimensioni consigliate per il server di gestione sono riepilogate nella tabella seguente:</span><span class="sxs-lookup"><span data-stu-id="39e5c-193">Size recommendations for the management server are summarized in the following table:</span></span>

| <span data-ttu-id="39e5c-194">**CPU del server di gestione**</span><span class="sxs-lookup"><span data-stu-id="39e5c-194">**Management server CPU**</span></span> | <span data-ttu-id="39e5c-195">**Memoria**</span><span class="sxs-lookup"><span data-stu-id="39e5c-195">**Memory**</span></span> | <span data-ttu-id="39e5c-196">**Dimensione disco cache**</span><span class="sxs-lookup"><span data-stu-id="39e5c-196">**Cache disk size**</span></span> | <span data-ttu-id="39e5c-197">**Frequenza di modifica dei dati**</span><span class="sxs-lookup"><span data-stu-id="39e5c-197">**Data change rate**</span></span> | <span data-ttu-id="39e5c-198">**Computer protetti**</span><span class="sxs-lookup"><span data-stu-id="39e5c-198">**Protected machines**</span></span> |
| --- | --- | --- | --- | --- |
| <span data-ttu-id="39e5c-199">8 vCPU (2 socket * 4 core a 2,5 GHz)</span><span class="sxs-lookup"><span data-stu-id="39e5c-199">8 vCPUs (2 sockets * 4 cores @ 2.5 GHz)</span></span> |<span data-ttu-id="39e5c-200">16 GB</span><span class="sxs-lookup"><span data-stu-id="39e5c-200">16 GB</span></span> |<span data-ttu-id="39e5c-201">300 GB</span><span class="sxs-lookup"><span data-stu-id="39e5c-201">300 GB</span></span> |<span data-ttu-id="39e5c-202">500 GB o inferiore</span><span class="sxs-lookup"><span data-stu-id="39e5c-202">500 GB or less</span></span> |<span data-ttu-id="39e5c-203">Distribuire un server di gestione con queste impostazioni per eseguire la replica di meno di 100 macchine.</span><span class="sxs-lookup"><span data-stu-id="39e5c-203">Deploy a management server with these settings to replicate fewer than 100 machines.</span></span> |
| <span data-ttu-id="39e5c-204">12 vCPU (2 socket * 6 core a 2,5 GHz)</span><span class="sxs-lookup"><span data-stu-id="39e5c-204">12 vCPUs (2 sockets * 6 cores @ 2.5 GHz)</span></span> |<span data-ttu-id="39e5c-205">18 GB</span><span class="sxs-lookup"><span data-stu-id="39e5c-205">18 GB</span></span> |<span data-ttu-id="39e5c-206">600 GB</span><span class="sxs-lookup"><span data-stu-id="39e5c-206">600 GB</span></span> |<span data-ttu-id="39e5c-207">Da 500 GB a 1 TB</span><span class="sxs-lookup"><span data-stu-id="39e5c-207">500 GB to 1 TB</span></span> |<span data-ttu-id="39e5c-208">Distribuire un server di gestione con queste impostazioni per eseguire la replica di 100-150 macchine.</span><span class="sxs-lookup"><span data-stu-id="39e5c-208">Deploy a management server with these settings to replicate 100-150 machines.</span></span> |
| <span data-ttu-id="39e5c-209">16 vCPU (2 socket * 8 core a 2,5 GHz)</span><span class="sxs-lookup"><span data-stu-id="39e5c-209">16 vCPUs (2 sockets * 8 cores @ 2.5 GHz)</span></span> |<span data-ttu-id="39e5c-210">32 GB</span><span class="sxs-lookup"><span data-stu-id="39e5c-210">32 GB</span></span> |<span data-ttu-id="39e5c-211">1 TB</span><span class="sxs-lookup"><span data-stu-id="39e5c-211">1 TB</span></span> |<span data-ttu-id="39e5c-212">Da 1 TB a 2 TB</span><span class="sxs-lookup"><span data-stu-id="39e5c-212">1 TB to 2 TB</span></span> |<span data-ttu-id="39e5c-213">Distribuire un server di gestione con queste impostazioni per eseguire la replica di 150-200 macchine.</span><span class="sxs-lookup"><span data-stu-id="39e5c-213">Deploy a management server with these settings to replicate 150-200 machines.</span></span> |
| <span data-ttu-id="39e5c-214">Distribuire un altro server di elaborazione</span><span class="sxs-lookup"><span data-stu-id="39e5c-214">Deploy another process server</span></span> | | |<span data-ttu-id="39e5c-215">Superiore a 2 TB</span><span class="sxs-lookup"><span data-stu-id="39e5c-215">> 2 TB</span></span> |<span data-ttu-id="39e5c-216">Distribuire server di elaborazione aggiuntivi se si esegue la replica di più di 200 computer o la frequenza di modifica dei dati giornaliera è superiore a 2 TB.</span><span class="sxs-lookup"><span data-stu-id="39e5c-216">Deploy additional process servers if you're replicating more than 200 machines, or if the daily data change rate exceeds 2 TB.</span></span> |

<span data-ttu-id="39e5c-217">Dove:</span><span class="sxs-lookup"><span data-stu-id="39e5c-217">Where:</span></span>

* <span data-ttu-id="39e5c-218">Ogni computer di origine è configurato con 3 dischi da 100 GB.</span><span class="sxs-lookup"><span data-stu-id="39e5c-218">Each source machine is configured with 3 disks of 100 GB each.</span></span>
* <span data-ttu-id="39e5c-219">La risorsa di archiviazione di benchmarking usata per le misurazioni del disco della cache è di 8 unità SAS a 10.000 RPM con RAID 10.</span><span class="sxs-lookup"><span data-stu-id="39e5c-219">We used benchmarking storage of 8 SAS drives of 10,000 RPM with RAID 10 for cache disk measurements.</span></span>

### <a name="network-bandwidth-from-source-to-target"></a><span data-ttu-id="39e5c-220">Larghezza di banda di rete dall'origine alla destinazione</span><span class="sxs-lookup"><span data-stu-id="39e5c-220">Network bandwidth from source to target</span></span>
<span data-ttu-id="39e5c-221">Assicurarsi di calcolare la larghezza di banda necessaria per la replica iniziale e la replica differenziale usando lo [strumento Capacity Planner](site-recovery-capacity-planner.md).</span><span class="sxs-lookup"><span data-stu-id="39e5c-221">Make sure you calculate the bandwidth that would be required for initial replication and delta replication by using the [capacity planner tool](site-recovery-capacity-planner.md).</span></span>

#### <a name="throttling-bandwidth-used-for-replication"></a><span data-ttu-id="39e5c-222">Limitazione della larghezza di banda usata per la replica</span><span class="sxs-lookup"><span data-stu-id="39e5c-222">Throttling bandwidth used for replication</span></span>
<span data-ttu-id="39e5c-223">Il traffico VMware replicato in Azure passa per un server di elaborazione specifico.</span><span class="sxs-lookup"><span data-stu-id="39e5c-223">VMware traffic replicated to Azure goes through a specific process server.</span></span> <span data-ttu-id="39e5c-224">Per limitare la larghezza di banda disponibile per la replica di Site Recovery in tale server, è possibile procedere come indicato di seguito:</span><span class="sxs-lookup"><span data-stu-id="39e5c-224">You can throttle the bandwidth that's available for Site Recovery replication on that server as follows:</span></span>

1. <span data-ttu-id="39e5c-225">Aprire lo snap-in di MMC di Backup di Microsoft Azure nel server di gestione principale o in un server di gestione che esegue server di elaborazione aggiuntivi di cui è stato eseguito il provisioning.</span><span class="sxs-lookup"><span data-stu-id="39e5c-225">Open the Microsoft Azure Backup MMC snap-in on the main management server or on a management server running additional provisioned process servers.</span></span> <span data-ttu-id="39e5c-226">Per impostazione predefinita viene creato un collegamento di Backup di Microsoft Azure sul desktop.</span><span class="sxs-lookup"><span data-stu-id="39e5c-226">By default, a shortcut for Microsoft Azure Backup is created on the desktop.</span></span> <span data-ttu-id="39e5c-227">In alternativa passare a C:\Program Files\Microsoft Azure Recovery Services Agent\bin\wabadmin.</span><span class="sxs-lookup"><span data-stu-id="39e5c-227">Or, you can find it in C:\Program Files\Microsoft Azure Recovery Services Agent\bin\wabadmin.</span></span>
2. <span data-ttu-id="39e5c-228">Nello snap-in fare clic su **Modifica proprietà**.</span><span class="sxs-lookup"><span data-stu-id="39e5c-228">In the snap-in, click **Change Properties**.</span></span>

    ![Modificare le proprietà della limitazione della larghezza di banda](./media/site-recovery-vmware-to-azure-classic/throttle1.png)
3. <span data-ttu-id="39e5c-230">Nella scheda **Limitazione** specificare la larghezza di banda che può essere usata per la replica di Site Recovery e la pianificazione applicabile.</span><span class="sxs-lookup"><span data-stu-id="39e5c-230">On the **Throttling** tab, specify the bandwidth that can be used for Site Recovery replication and the applicable scheduling.</span></span>

    ![Limitare la larghezza di banda per la replica](./media/site-recovery-vmware-to-azure-classic/throttle2.png)

<span data-ttu-id="39e5c-232">È possibile impostare la limitazione usando PowerShell.</span><span class="sxs-lookup"><span data-stu-id="39e5c-232">You can also set throttling by using PowerShell.</span></span> <span data-ttu-id="39e5c-233">Ad esempio:</span><span class="sxs-lookup"><span data-stu-id="39e5c-233">Here's an example:</span></span>

    Set-OBMachineSetting -WorkDay $mon, $tue -StartWorkHour "9:00:00" -EndWorkHour "18:00:00" -WorkHourBandwidth (512*1024) -NonWorkHourBandwidth (2048*1024)

#### <a name="maximizing-bandwidth-usage"></a><span data-ttu-id="39e5c-234">Ottimizzazione dell'utilizzo della larghezza di banda</span><span class="sxs-lookup"><span data-stu-id="39e5c-234">Maximizing bandwidth usage</span></span>
<span data-ttu-id="39e5c-235">Per aumentare la larghezza di banda usata per la replica da Azure Site Recovery è necessario modificare una chiave del Registro di sistema.</span><span class="sxs-lookup"><span data-stu-id="39e5c-235">To increase the bandwidth utilized for replication by Azure Site Recovery, you need to change a registry key.</span></span>

<span data-ttu-id="39e5c-236">La chiave seguente controlla il numero di thread per disco di replica usati durante la replica:</span><span class="sxs-lookup"><span data-stu-id="39e5c-236">The following key controls the number of threads per replicating disk that are used when replicating:</span></span>

    HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows Azure Backup\Replication\UploadThreadsPerVM

 <span data-ttu-id="39e5c-237">In una rete con provisioning eccessivo è necessario modificare i valori predefiniti di questa chiave del Registro di sistema.</span><span class="sxs-lookup"><span data-stu-id="39e5c-237">In an overprovisioned network, this registry key needs to be changed from its default values.</span></span> <span data-ttu-id="39e5c-238">Il numero massimo supportato è 32.</span><span class="sxs-lookup"><span data-stu-id="39e5c-238">We support a maximum of 32.</span></span>  

<span data-ttu-id="39e5c-239">Per altre informazioni sulla pianificazione dettagliata della capacità, vedere [Site Recovery Capacity Planner](site-recovery-capacity-planner.md).</span><span class="sxs-lookup"><span data-stu-id="39e5c-239">For more about detailed capacity planning, see [Site Recovery capacity planner](site-recovery-capacity-planner.md).</span></span>

### <a name="additional-process-servers"></a><span data-ttu-id="39e5c-240">Server di elaborazione aggiuntivi</span><span class="sxs-lookup"><span data-stu-id="39e5c-240">Additional process servers</span></span>
<span data-ttu-id="39e5c-241">Se è necessario proteggere più di 200 macchine o la frequenza di modifica giornaliera è superiore a 2 TB è possibile aggiungere altri server per gestire il carico.</span><span class="sxs-lookup"><span data-stu-id="39e5c-241">If you need to protect more than 200 machines or your daily change rate is greater that 2 TB, you can add additional servers to handle the load.</span></span> <span data-ttu-id="39e5c-242">Per la scalabilità orizzontale è possibile:</span><span class="sxs-lookup"><span data-stu-id="39e5c-242">To scale out, you can:</span></span>

* <span data-ttu-id="39e5c-243">Aumentare il numero di server di gestione.</span><span class="sxs-lookup"><span data-stu-id="39e5c-243">Increase the number of management servers.</span></span> <span data-ttu-id="39e5c-244">È ad esempio possibile proteggere fino a 400 macchine con due server di gestione.</span><span class="sxs-lookup"><span data-stu-id="39e5c-244">For example, you can protect up to 400 machines with two management servers.</span></span>
* <span data-ttu-id="39e5c-245">Aggiungere altri server di elaborazione e usarli per gestire il traffico al posto del server di gestione o in aggiunta a tale server.</span><span class="sxs-lookup"><span data-stu-id="39e5c-245">Add additional process servers and use these to handle traffic instead of (or in addition to) the management server.</span></span>

<span data-ttu-id="39e5c-246">Questa tabella descrive uno scenario in cui:</span><span class="sxs-lookup"><span data-stu-id="39e5c-246">This table describes a scenario in which:</span></span>

* <span data-ttu-id="39e5c-247">Il server di gestione originario viene configurato per l'uso esclusivo come server di configurazione.</span><span class="sxs-lookup"><span data-stu-id="39e5c-247">You set up the original management server to use as a configuration server only.</span></span>
* <span data-ttu-id="39e5c-248">Viene configurato un server di elaborazione aggiuntivo.</span><span class="sxs-lookup"><span data-stu-id="39e5c-248">You set up an additional process server.</span></span>
* <span data-ttu-id="39e5c-249">Le macchine virtuali protette vengono configurate per l'uso del server di elaborazione aggiuntivo.</span><span class="sxs-lookup"><span data-stu-id="39e5c-249">You configure protected virtual machines to use the additional process server.</span></span>
* <span data-ttu-id="39e5c-250">Ogni computer di origine protetto è configurato con tre dischi da 100 GB.</span><span class="sxs-lookup"><span data-stu-id="39e5c-250">Each protected source machine is configured with three disks of 100 GB each.</span></span>

| <span data-ttu-id="39e5c-251">**Server di gestione originale**</span><span class="sxs-lookup"><span data-stu-id="39e5c-251">**Original management server**</span></span><br/><br/><span data-ttu-id="39e5c-252">(server di configurazione)</span><span class="sxs-lookup"><span data-stu-id="39e5c-252">(configuration server)</span></span> | <span data-ttu-id="39e5c-253">**Server di elaborazione aggiuntivo**</span><span class="sxs-lookup"><span data-stu-id="39e5c-253">**Additional process server**</span></span> | <span data-ttu-id="39e5c-254">**Dimensione disco cache**</span><span class="sxs-lookup"><span data-stu-id="39e5c-254">**Cache disk size**</span></span> | <span data-ttu-id="39e5c-255">**Frequenza di modifica dei dati**</span><span class="sxs-lookup"><span data-stu-id="39e5c-255">**Data change rate**</span></span> | <span data-ttu-id="39e5c-256">**Computer protetti**</span><span class="sxs-lookup"><span data-stu-id="39e5c-256">**Protected machines**</span></span> |
| --- | --- | --- | --- | --- |
| <span data-ttu-id="39e5c-257">8 vCPU (2 socket * 4 core a 2,5 GHz), 16 GB di RAM</span><span class="sxs-lookup"><span data-stu-id="39e5c-257">8 vCPUs (2 sockets * 4 cores @ 2.5 GHz), 16 GB RAM</span></span> |<span data-ttu-id="39e5c-258">4 vCPU (2 socket * 2 core a 2,5 GHz), 8 GB di RAM</span><span class="sxs-lookup"><span data-stu-id="39e5c-258">4 vCPUs (2 sockets * 2 cores @ 2.5 GHz), 8 GB RAM</span></span> |<span data-ttu-id="39e5c-259">300 GB</span><span class="sxs-lookup"><span data-stu-id="39e5c-259">300 GB</span></span> |<span data-ttu-id="39e5c-260">250 GB o inferiore</span><span class="sxs-lookup"><span data-stu-id="39e5c-260">250 GB or less</span></span> |<span data-ttu-id="39e5c-261">È possibile eseguire la replica di un massimo di 85 macchine.</span><span class="sxs-lookup"><span data-stu-id="39e5c-261">You can replicate 85 or fewer machines.</span></span> |
| <span data-ttu-id="39e5c-262">8 vCPU (2 socket * 4 core a 2,5 GHz), 16 GB di RAM</span><span class="sxs-lookup"><span data-stu-id="39e5c-262">8 vCPUs (2 sockets * 4 cores @ 2.5 GHz), 16 GB RAM</span></span> |<span data-ttu-id="39e5c-263">8 vCPU (2 socket * 4 core a 2,5 GHz), 12 GB di RAM</span><span class="sxs-lookup"><span data-stu-id="39e5c-263">8 vCPUs (2 sockets * 4 cores @ 2.5 GHz), 12 GB RAM</span></span> |<span data-ttu-id="39e5c-264">600 GB</span><span class="sxs-lookup"><span data-stu-id="39e5c-264">600 GB</span></span> |<span data-ttu-id="39e5c-265">Da 250 GB a 1 TB</span><span class="sxs-lookup"><span data-stu-id="39e5c-265">250 GB to 1 TB</span></span> |<span data-ttu-id="39e5c-266">È possibile eseguire la replica di 85-150 macchine.</span><span class="sxs-lookup"><span data-stu-id="39e5c-266">You can replicate 85-150 machines.</span></span> |
| <span data-ttu-id="39e5c-267">12 vCPU (2 socket * 6 core a 2,5 GHz), 18 GB di RAM</span><span class="sxs-lookup"><span data-stu-id="39e5c-267">12 vCPUs (2 sockets * 6 cores @ 2.5 GHz), 18 GB RAM</span></span> |<span data-ttu-id="39e5c-268">12 vCPU (2 socket * 6 core a 2,5 GHz), 24 GB di RAM</span><span class="sxs-lookup"><span data-stu-id="39e5c-268">12 vCPUs (2 sockets * 6 cores @ 2.5 GHz) 24 GB RAM</span></span> |<span data-ttu-id="39e5c-269">1 TB</span><span class="sxs-lookup"><span data-stu-id="39e5c-269">1 TB</span></span> |<span data-ttu-id="39e5c-270">Da 1 TB a 2 TB</span><span class="sxs-lookup"><span data-stu-id="39e5c-270">1 TB to 2 TB</span></span> |<span data-ttu-id="39e5c-271">È possibile eseguire la replica di 150-225 macchine.</span><span class="sxs-lookup"><span data-stu-id="39e5c-271">You can replicate 150-225 machines.</span></span> |

<span data-ttu-id="39e5c-272">Il modo in cui i server vengono ridimensionati dipende dalle preferenze per il modello di aumento delle prestazioni o di aumento del numero di istanze.</span><span class="sxs-lookup"><span data-stu-id="39e5c-272">How you scale your servers depends on your preference for a scale-up or scale-out model.</span></span> <span data-ttu-id="39e5c-273">È possibile aumentare le prestazioni distribuendo alcuni server di gestione e di elaborazione avanzati. È possibile aumentare il numero di istanze distribuendo più server con minori risorse.</span><span class="sxs-lookup"><span data-stu-id="39e5c-273">You scale up by deploying a few high-end management and process servers, or scale out by deploying more servers with fewer resources.</span></span> <span data-ttu-id="39e5c-274">Ad esempio, per proteggere 220 macchine è possibile eseguire una di queste operazioni:</span><span class="sxs-lookup"><span data-stu-id="39e5c-274">For example: if you need to protect 220 machines, you can do either of the following:</span></span>

* <span data-ttu-id="39e5c-275">Configurare il server di gestione originale con 12 vCPU e 18 GB di RAM.</span><span class="sxs-lookup"><span data-stu-id="39e5c-275">Configure the original management server with 12 vCPUs and 18 GB of RAM.</span></span> <span data-ttu-id="39e5c-276">Configurare un server di elaborazione aggiuntivo con 12 vCPU e 24 GB di RAM.</span><span class="sxs-lookup"><span data-stu-id="39e5c-276">Configure an additional process server with 12 vCPUs and 24 GB of RAM.</span></span> <span data-ttu-id="39e5c-277">Configurare le macchine protette per l'uso del solo server di elaborazione aggiuntivo.</span><span class="sxs-lookup"><span data-stu-id="39e5c-277">Configure protected machines to use only the additional process server.</span></span>
* <span data-ttu-id="39e5c-278">Configurare due server di gestione (2 x 8 vCPU, 16 GB di RAM) e due server di elaborazione aggiuntivi (1 x 8 vCPU e 4 vCPU x 1 per gestire 135 + 85 (220) macchine).</span><span class="sxs-lookup"><span data-stu-id="39e5c-278">Configure two management servers (2 x 8 vCPUs, 16 GB RAM) and two additional process servers (1 x 8 vCPUs and 4vCPUs x 1 to handle 135 + 85 (220) machines).</span></span> <span data-ttu-id="39e5c-279">Configurare le macchine protette per l'uso dei soli server di elaborazione aggiuntivi.</span><span class="sxs-lookup"><span data-stu-id="39e5c-279">Configure protected machines to use only the additional process servers.</span></span>

<span data-ttu-id="39e5c-280">Seguire le istruzioni illustrate in [Distribuire server di elaborazione aggiuntivi](#deploy-additional-process-servers) per configurare un server di elaborazione aggiuntivo.</span><span class="sxs-lookup"><span data-stu-id="39e5c-280">Follow the instructions in [Deploy additional process servers](#deploy-additional-process-servers) to set up an additional process server.</span></span>

## <a name="before-you-start-deployment"></a><span data-ttu-id="39e5c-281">Prima di iniziare la distribuzione</span><span class="sxs-lookup"><span data-stu-id="39e5c-281">Before you start deployment</span></span>
<span data-ttu-id="39e5c-282">Le tabelle seguenti indicano i prerequisiti per la distribuzione di questo scenario.</span><span class="sxs-lookup"><span data-stu-id="39e5c-282">The following tables summarize the prerequisites for deploying this scenario.</span></span>

### <a name="azure-prerequisites"></a><span data-ttu-id="39e5c-283">Prerequisiti di Azure</span><span class="sxs-lookup"><span data-stu-id="39e5c-283">Azure prerequisites</span></span>
| <span data-ttu-id="39e5c-284">**Prerequisito**</span><span class="sxs-lookup"><span data-stu-id="39e5c-284">**Prerequisite**</span></span> | <span data-ttu-id="39e5c-285">**Dettagli**</span><span class="sxs-lookup"><span data-stu-id="39e5c-285">**Details**</span></span> |
| --- | --- |
| <span data-ttu-id="39e5c-286">**Account di Azure**</span><span class="sxs-lookup"><span data-stu-id="39e5c-286">**Azure account**</span></span> |<span data-ttu-id="39e5c-287">È necessario un account [Microsoft Azure](https://azure.microsoft.com/) .</span><span class="sxs-lookup"><span data-stu-id="39e5c-287">You need a [Microsoft Azure](https://azure.microsoft.com/) account.</span></span> <span data-ttu-id="39e5c-288">È possibile iniziare con una [versione di valutazione gratuita](https://azure.microsoft.com/pricing/free-trial/).</span><span class="sxs-lookup"><span data-stu-id="39e5c-288">You can start with a [free trial](https://azure.microsoft.com/pricing/free-trial/).</span></span> <span data-ttu-id="39e5c-289">Per altre informazioni sui prezzi di Site Recovery, vedere [Site Recovery](https://azure.microsoft.com/pricing/details/site-recovery/).</span><span class="sxs-lookup"><span data-stu-id="39e5c-289">For more information about Site Recovery pricing, see [Site Recovery](https://azure.microsoft.com/pricing/details/site-recovery/).</span></span> |
| <span data-ttu-id="39e5c-290">**Archiviazione di Azure**</span><span class="sxs-lookup"><span data-stu-id="39e5c-290">**Azure storage**</span></span> |<span data-ttu-id="39e5c-291">Per archiviare i dati replicati è necessario un account di archiviazione di Azure.</span><span class="sxs-lookup"><span data-stu-id="39e5c-291">You need an Azure storage account to store replicated data.</span></span> <span data-ttu-id="39e5c-292">I dati replicati vengono memorizzati nell'archiviazione di Azure e le macchine virtuali di Azure vengono attivate quando si verifica il failover.</span><span class="sxs-lookup"><span data-stu-id="39e5c-292">Replicated data is stored in Azure storage, and Azure VMs are spun up when failover occurs.</span></span> <br/><br/><span data-ttu-id="39e5c-293">È necessario un [account di archiviazione con ridondanza geografica Standard](../storage/storage-redundancy.md#geo-redundant-storage).</span><span class="sxs-lookup"><span data-stu-id="39e5c-293">You need a [standard geo-redundant storage account](../storage/storage-redundancy.md#geo-redundant-storage).</span></span> <span data-ttu-id="39e5c-294">L'account deve trovarsi nella stessa area del servizio Site Recovery ed essere associato alla stessa sottoscrizione.</span><span class="sxs-lookup"><span data-stu-id="39e5c-294">The account must be in the same region as the Site Recovery service and be associated with the same subscription.</span></span> <span data-ttu-id="39e5c-295">La replica in account di archiviazione Premium non è attualmente supportata e non deve essere usata.</span><span class="sxs-lookup"><span data-stu-id="39e5c-295">Replication to premium storage accounts isn't currently supported and shouldn't be used.</span></span><br/><br/><span data-ttu-id="39e5c-296">Lo spostamento degli account di archiviazione creati con il [portale di Azure](../storage/storage-create-storage-account.md) tra gruppi di risorse non è supportato.</span><span class="sxs-lookup"><span data-stu-id="39e5c-296">We do not support moving storage accounts created by using the [Azure portal](../storage/storage-create-storage-account.md) across resource groups.</span></span> <span data-ttu-id="39e5c-297">Per altre informazioni, vedere [Introduzione ad Archiviazione di Microsoft Azure](../storage/storage-introduction.md).</span><span class="sxs-lookup"><span data-stu-id="39e5c-297">For more information, see [Introduction to Microsoft Azure Storage](../storage/storage-introduction.md).</span></span><br/><br/> |
| <span data-ttu-id="39e5c-298">**Rete di Azure**</span><span class="sxs-lookup"><span data-stu-id="39e5c-298">**Azure network**</span></span> |<span data-ttu-id="39e5c-299">È necessaria una rete virtuale di Azure a cui le macchine virtuali di Azure si connetteranno quando si verifica il failover.</span><span class="sxs-lookup"><span data-stu-id="39e5c-299">You need an Azure virtual network that Azure VMs will connect to when failover occurs.</span></span> <span data-ttu-id="39e5c-300">La rete virtuale di Azure deve trovarsi nella stessa area dell'insieme di credenziali di Site Recovery.</span><span class="sxs-lookup"><span data-stu-id="39e5c-300">The Azure virtual network must be in the same region as the Site Recovery vault.</span></span><br/><br/><span data-ttu-id="39e5c-301">Per eseguire il failback dopo il failover in Azure è necessaria una connessione VPN o Azure ExpressRoute configurata dalla rete di Azure al sito locale.</span><span class="sxs-lookup"><span data-stu-id="39e5c-301">To fail back after failover to Azure, you need a VPN connection (or Azure ExpressRoute) set up from the Azure network to the on-premises site.</span></span> |

### <a name="on-premises-prerequisites"></a><span data-ttu-id="39e5c-302">Prerequisiti locali</span><span class="sxs-lookup"><span data-stu-id="39e5c-302">On-premises prerequisites</span></span>
| <span data-ttu-id="39e5c-303">**Prerequisito**</span><span class="sxs-lookup"><span data-stu-id="39e5c-303">**Prerequisite**</span></span> | <span data-ttu-id="39e5c-304">**Dettagli**</span><span class="sxs-lookup"><span data-stu-id="39e5c-304">**Details**</span></span> |
| --- | --- |
| <span data-ttu-id="39e5c-305">**Server di gestione**</span><span class="sxs-lookup"><span data-stu-id="39e5c-305">**Management server**</span></span> |<span data-ttu-id="39e5c-306">È necessario un server Windows 2012 R2 locale in esecuzione in una macchina virtuale o un server fisico.</span><span class="sxs-lookup"><span data-stu-id="39e5c-306">You need an on-premises Windows 2012 R2 server running on a virtual machine or physical server.</span></span> <span data-ttu-id="39e5c-307">Tutti i componenti locali di Site Recovery vengono installati in questo server di gestione.</span><span class="sxs-lookup"><span data-stu-id="39e5c-307">All of the on-premises Site Recovery components are installed on this management server.</span></span><br/><br/> <span data-ttu-id="39e5c-308">È consigliabile distribuire il server come una VM VMware a disponibilità elevata.</span><span class="sxs-lookup"><span data-stu-id="39e5c-308">We recommend you deploy the server as a highly available VMware VM.</span></span> <span data-ttu-id="39e5c-309">Il failback da Azure al sito locale viene sempre eseguito in macchine virtuali VMware indipendentemente dal fatto che il failover sia stato eseguito in macchine virtuali o in server fisici.</span><span class="sxs-lookup"><span data-stu-id="39e5c-309">Failback to the on-premises site from Azure is always to VMware VMs regardless of whether you failed over VMs or physical servers.</span></span> <span data-ttu-id="39e5c-310">Se non si configura il server di gestione come una VM VMware, è necessario configurare un server di destinazione master distinto come VM VMware perché possa ricevere il traffico di failback.</span><span class="sxs-lookup"><span data-stu-id="39e5c-310">If you don't configure the management server as a VMware VM, you need to set up a separate master target server as a VMware VM to receive failback traffic.</span></span><br/><br/><span data-ttu-id="39e5c-311">Il server non deve essere un controller di dominio.</span><span class="sxs-lookup"><span data-stu-id="39e5c-311">The server should not be a domain controller.</span></span><br/><br/><span data-ttu-id="39e5c-312">Il server deve disporre di un indirizzo IP statico.</span><span class="sxs-lookup"><span data-stu-id="39e5c-312">The server should have a static IP address.</span></span><br/><br/><span data-ttu-id="39e5c-313">Il nome host del server deve avere una lunghezza massima di 15 caratteri.</span><span class="sxs-lookup"><span data-stu-id="39e5c-313">The host name of the server should be 15 characters or less.</span></span><br/><br/><span data-ttu-id="39e5c-314">Le impostazioni locali del sistema operativo devono essere solo in lingua inglese.</span><span class="sxs-lookup"><span data-stu-id="39e5c-314">The operating system locale should be English only.</span></span><br/><br/><span data-ttu-id="39e5c-315">Il server di gestione richiede l'accesso a Internet.</span><span class="sxs-lookup"><span data-stu-id="39e5c-315">The management server requires Internet access.</span></span><br/><br/><span data-ttu-id="39e5c-316">È necessario l'accesso in uscita dal server come indicato di seguito: accesso temporaneo sulla porta HTTP 80 durante l'installazione dei componenti di Site Recovery per scaricare MySQL; accesso in uscita continuo sulla porta HTTPS 443 per la gestione delle repliche; accesso in uscita continuo sulla porta HTTPS 9443 per il traffico di replica. Questa porta può essere modificata.</span><span class="sxs-lookup"><span data-stu-id="39e5c-316">You need outbound access from the server as follows: Temporary access on HTTP 80 during setup of the Site Recovery components (to download MySQL); ongoing outbound access on HTTPS 443 for replication management; ongoing outbound access on HTTPS 9443 for replication traffic (this port can be modified).</span></span><br/><br/> <span data-ttu-id="39e5c-317">Assicurarsi che questi URL siano accessibili dal server di gestione:</span><span class="sxs-lookup"><span data-stu-id="39e5c-317">Make sure these URLs are accessible from the management server:</span></span> <br/><span data-ttu-id="39e5c-318">- \*.hypervrecoverymanager.windowsazure.com</span><span class="sxs-lookup"><span data-stu-id="39e5c-318">- \*.hypervrecoverymanager.windowsazure.com</span></span><br/><span data-ttu-id="39e5c-319">- \*.accesscontrol.windows.net</span><span class="sxs-lookup"><span data-stu-id="39e5c-319">- \*.accesscontrol.windows.net</span></span><br/><span data-ttu-id="39e5c-320">- \*.backup.windowsazure.com</span><span class="sxs-lookup"><span data-stu-id="39e5c-320">- \*.backup.windowsazure.com</span></span><br/><span data-ttu-id="39e5c-321">- \*.blob.core.windows.net</span><span class="sxs-lookup"><span data-stu-id="39e5c-321">- \*.blob.core.windows.net</span></span><br/><span data-ttu-id="39e5c-322">- \*.store.core.windows.net</span><span class="sxs-lookup"><span data-stu-id="39e5c-322">- \*.store.core.windows.net</span></span><br/><span data-ttu-id="39e5c-323">- https://www.msftncsi.com/ncsi.txt</span><span class="sxs-lookup"><span data-stu-id="39e5c-323">- https://www.msftncsi.com/ncsi.txt</span></span><br/><span data-ttu-id="39e5c-324">- [ https://dev.mysql.com/get/archives/mysql-5.5/mysql-5.5.37-win32.msi](https://dev.mysql.com/get/archives/mysql-5.5/mysql-5.5.37-win32.msi " https://dev.mysql.com/get/archives/mysql-5.5/mysql-5.5.37-win32.msi")</span><span class="sxs-lookup"><span data-stu-id="39e5c-324">- [ https://dev.mysql.com/get/archives/mysql-5.5/mysql-5.5.37-win32.msi](https://dev.mysql.com/get/archives/mysql-5.5/mysql-5.5.37-win32.msi " https://dev.mysql.com/get/archives/mysql-5.5/mysql-5.5.37-win32.msi")</span></span><br/><br/><span data-ttu-id="39e5c-325">Se nel server sono disponibili regole firewall basate sull'indirizzo IP, verificare che le regole consentano la comunicazione con Azure.</span><span class="sxs-lookup"><span data-stu-id="39e5c-325">If you have IP address-based firewall rules on the server, check that the rules allow communication to Azure.</span></span> <span data-ttu-id="39e5c-326">È necessario consentire gli [intervalli IP del data center di Azure](https://www.microsoft.com/download/details.aspx?id=41653) e la porta HTTPS (443).</span><span class="sxs-lookup"><span data-stu-id="39e5c-326">You need to allow the [Azure Datacenter IP Ranges](https://www.microsoft.com/download/details.aspx?id=41653) and the HTTPS (443) port.</span></span> <span data-ttu-id="39e5c-327">È anche necessario aggiungere all'elenco elementi consentiti gli intervalli di indirizzi IP per l'area di Azure della sottoscrizione e per gli Stati Uniti occidentali.</span><span class="sxs-lookup"><span data-stu-id="39e5c-327">You also need to whitelist IP address ranges for the Azure region of your subscription, and for West US.</span></span> <span data-ttu-id="39e5c-328">Il download di MySQL è disponibile all'URL [https://dev.mysql.com/get/archives/mysql-5.5/mysql-5.5.37-win32.msi](https://dev.mysql.com/get/archives/mysql-5.5/mysql-5.5.37-win32.msi " https://dev.mysql.com/get/archives/mysql-5.5/mysql-5.5.37-win32.msi").</span><span class="sxs-lookup"><span data-stu-id="39e5c-328">The URL [https://dev.mysql.com/get/archives/mysql-5.5/mysql-5.5.37-win32.msi](https://dev.mysql.com/get/archives/mysql-5.5/mysql-5.5.37-win32.msi " https://dev.mysql.com/get/archives/mysql-5.5/mysql-5.5.37-win32.msi") is for downloading MySQL.</span></span> |
| <span data-ttu-id="39e5c-329">**VMware vCenter e host ESXi**</span><span class="sxs-lookup"><span data-stu-id="39e5c-329">**VMware vCenter/ESXi host**</span></span> |<span data-ttu-id="39e5c-330">Sono necessari uno o più hypervisor VMware vSphere ESX/ESXi che gestiscono le macchine virtuali VMware ed eseguono ESX/ESXi versione 6.0, 5.5 o 5.1 con gli aggiornamenti più recenti.</span><span class="sxs-lookup"><span data-stu-id="39e5c-330">You need one or more VMware vSphere ESX/ESXi hypervisors managing your VMware virtual machines, running ESX/ESXi version 6.0, 5.5, or 5.1 with the latest updates.</span></span><br/><br/> <span data-ttu-id="39e5c-331">È consigliabile distribuire un server VMware vCenter per gestire gli host ESXi.</span><span class="sxs-lookup"><span data-stu-id="39e5c-331">We recommend that you deploy a VMware vCenter server to manage your ESXi hosts.</span></span> <span data-ttu-id="39e5c-332">Il server deve eseguire vCenter versione 6.0 o 5.5 con gli aggiornamenti più recenti.</span><span class="sxs-lookup"><span data-stu-id="39e5c-332">It should be running vCenter version 6.0 or 5.5 with the latest updates.</span></span><br/><br/><span data-ttu-id="39e5c-333">Si noti che Site Recovery non supporta le nuove funzionalità di vCenter e vSphere 6.0 come cross-vCenter vMotion, Virtual Volumes e Storage DRS.</span><span class="sxs-lookup"><span data-stu-id="39e5c-333">Note that Site Recovery doesn't support new vCenter and vSphere 6.0 features such as cross vCenter vMotion, virtual volumes, and storage DRS.</span></span> <span data-ttu-id="39e5c-334">Site Recovery supporta unicamente le funzionalità disponibili anche nella versione 5.5.</span><span class="sxs-lookup"><span data-stu-id="39e5c-334">Site Recovery support is limited to features that were also available in version 5.5.</span></span> |
| <span data-ttu-id="39e5c-335">**Computer protetti**</span><span class="sxs-lookup"><span data-stu-id="39e5c-335">**Protected machines**</span></span> |<span data-ttu-id="39e5c-336">**Azzurro**</span><span class="sxs-lookup"><span data-stu-id="39e5c-336">**Azure**</span></span><br/><br/><span data-ttu-id="39e5c-337">Le macchine da proteggere devono essere conformi ai [prerequisiti di Azure](site-recovery-prereq.md) per la creazione di VM di Azure.</span><span class="sxs-lookup"><span data-stu-id="39e5c-337">Machines that you want to protect should conform with [Azure prerequisites](site-recovery-prereq.md) for creating Azure VMs.</span></span><br><br/><span data-ttu-id="39e5c-338">Per connettersi alle VM di Azure dopo il failover è necessario abilitare le connessioni Desktop remoto nel firewall locale.</span><span class="sxs-lookup"><span data-stu-id="39e5c-338">If you want to connect to the Azure VMs after failover, you need to enable Remote Desktop connections on the local firewall.</span></span><br/><br/><span data-ttu-id="39e5c-339">La capacità dei singoli dischi nei computer protetti non deve superare 1023 GB.</span><span class="sxs-lookup"><span data-stu-id="39e5c-339">Individual disk capacity on protected machines shouldn’t be more than 1023 GB.</span></span> <span data-ttu-id="39e5c-340">Una macchina virtuale può avere fino a 64 dischi (quindi fino a 64 TB).</span><span class="sxs-lookup"><span data-stu-id="39e5c-340">A VM can have up to 64 disks (thus up to 64 TB).</span></span> <span data-ttu-id="39e5c-341">Se si hanno dischi di dimensioni superiori a 1 TB è consigliabile usare la replica di database, ad esempio SQL Server Always On oppure Oracle Data Guard.</span><span class="sxs-lookup"><span data-stu-id="39e5c-341">If you have disks larger than 1 TB, consider using database replication such as SQL Server Always On or Oracle Data Guard.</span></span><br/><br/><span data-ttu-id="39e5c-342">Minimo 2 GB di spazio disponibile sull'unità di installazione per l'installazione del componente.</span><span class="sxs-lookup"><span data-stu-id="39e5c-342">Minimum 2 GB of available space on the installation drive for component installation.</span></span><br/><br/><span data-ttu-id="39e5c-343">I cluster guest in dischi condivisi non sono supportati.</span><span class="sxs-lookup"><span data-stu-id="39e5c-343">Shared disk guest clusters aren't supported.</span></span> <span data-ttu-id="39e5c-344">Se si ha una distribuzione in cluster è consigliabile usare la replica di database, ad esempio SQL Server Always On oppure Oracle Data Guard.</span><span class="sxs-lookup"><span data-stu-id="39e5c-344">If you have a clustered deployment, consider using database replication such as SQL Server Always On or Oracle Data Guard.</span></span><br/><br/><span data-ttu-id="39e5c-345">L'avvio UEFI (Unified Extensible Firmware Interface)/EFI (Extensible Firmware Interface) non è supportato.</span><span class="sxs-lookup"><span data-stu-id="39e5c-345">Unified Extensible Firmware Interface(UEFI)/Extensible Firmware Interface(EFI) boot isn't supported.</span></span><br/><br/><span data-ttu-id="39e5c-346">I nomi delle macchine devono contenere da 1 a 63 caratteri, ovvero lettere, numeri e trattini.</span><span class="sxs-lookup"><span data-stu-id="39e5c-346">Machine names should contain between 1 and 63 characters (letters, numbers, and hyphens).</span></span> <span data-ttu-id="39e5c-347">Il nome deve iniziare e terminare con una lettera o un numero.</span><span class="sxs-lookup"><span data-stu-id="39e5c-347">The name must start with a letter or number and end with a letter or number.</span></span> <span data-ttu-id="39e5c-348">Dopo aver protetto una macchina è possibile modificare il nome di Azure.</span><span class="sxs-lookup"><span data-stu-id="39e5c-348">After a machine is protected, you can modify the Azure name.</span></span><br/><br/><span data-ttu-id="39e5c-349">**VM VMware**</span><span class="sxs-lookup"><span data-stu-id="39e5c-349">**VMware VMs**</span></span><br/><br><span data-ttu-id="39e5c-350">È necessario installare VMware vSphere PowerCLI 6.0.</span><span class="sxs-lookup"><span data-stu-id="39e5c-350">You need to install VMware vSphere PowerCLI  6.0.</span></span> <span data-ttu-id="39e5c-351">nel server di gestione (server di configurazione).</span><span class="sxs-lookup"><span data-stu-id="39e5c-351">on the management server (configuration server).</span></span><br/><br/><span data-ttu-id="39e5c-352">Nelle macchine virtuali VMware da proteggere devono essere installati e in esecuzione gli strumenti VMware.</span><span class="sxs-lookup"><span data-stu-id="39e5c-352">VMware VMs you want to protect should have VMware tools installed and running.</span></span><br/><br/><span data-ttu-id="39e5c-353">Se nella VM di origine è presente un gruppo NIC, questo viene convertito in una singola scheda di interfaccia di rete dopo il failover in Azure.</span><span class="sxs-lookup"><span data-stu-id="39e5c-353">If the source VM has NIC teaming, it’s converted to a single NIC after failover to Azure.</span></span><br/><br/><span data-ttu-id="39e5c-354">Se nelle macchine virtuali protette è presente un disco iSCSI, Site Recovery lo converte in un file VHD quando viene eseguito il failover della macchina virtuale in Azure.</span><span class="sxs-lookup"><span data-stu-id="39e5c-354">If protected VMs have an iSCSI disk, Site Recovery converts the protected VM iSCSI disk into a VHD file when the VM fails over to Azure.</span></span> <span data-ttu-id="39e5c-355">Se la destinazione iSCSI può essere raggiunta dalla macchina virtuale di Azure, questa si connetterà alla destinazione iSCSI e vedrà essenzialmente due dischi: il disco rigido virtuale nella macchina virtuale di Azure e il disco iSCSI di origine.</span><span class="sxs-lookup"><span data-stu-id="39e5c-355">If iSCSI target can be reached by the Azure VM, it will connect to iSCSI target and essentially see two disks: the VHD disk on the Azure VM and the source iSCSI disk.</span></span> <span data-ttu-id="39e5c-356">In questo caso è necessario disconnettere la destinazione iSCSI visualizzata nella VM di Azure di cui è stato eseguito il failover.</span><span class="sxs-lookup"><span data-stu-id="39e5c-356">In this case, you need to disconnect the iSCSI target that appears on the failed-over Azure VM.</span></span><br/><br/><span data-ttu-id="39e5c-357">Per altre informazioni sulle autorizzazioni utente VMware necessarie per Site Recovery, vedere [Autorizzazioni di VMware per l'accesso a vCenter](#vmware-permissions-for-vcenter-access).</span><span class="sxs-lookup"><span data-stu-id="39e5c-357">For more information about the VMware user permissions that Site Recovery needs, see [VMware permissions for vCenter access](#vmware-permissions-for-vcenter-access).</span></span><br/><br/> <span data-ttu-id="39e5c-358">**Macchine Windows Server (su VM VMware o server fisico)**</span><span class="sxs-lookup"><span data-stu-id="39e5c-358">**Windows Server machines (on VMware VM or physical server)**</span></span><br/><br/><span data-ttu-id="39e5c-359">Nel server deve essere in esecuzione un sistema operativo a 64 bit supportato: Windows Server 2012 R2, Windows Server 2012 o Windows Server 2008 R2 con SP1 o versioni successive.</span><span class="sxs-lookup"><span data-stu-id="39e5c-359">The server should be running a supported 64-bit operating system: Windows Server 2012 R2, Windows Server 2012, or Windows Server 2008 R2 with at least SP1.</span></span><br/><br/><span data-ttu-id="39e5c-360">Il sistema operativo deve essere installato nell'unità C e il disco del sistema operativo deve essere un disco di base di Windows.</span><span class="sxs-lookup"><span data-stu-id="39e5c-360">The operating system should be installed on drive C, and the OS disk should be a Windows basic disk.</span></span> <span data-ttu-id="39e5c-361">Il sistema operativo non deve essere installato in un disco dinamico di Windows.</span><span class="sxs-lookup"><span data-stu-id="39e5c-361">(The OS shouldn’t be installed on a Windows dynamic disk.)</span></span><br/><br/><span data-ttu-id="39e5c-362">Per le macchine Windows Server 2008 R2 è necessario che sia installato .NET Framework 3.5.1.</span><span class="sxs-lookup"><span data-stu-id="39e5c-362">For Windows Server 2008 R2 machines, you need to have .NET Framework 3.5.1 installed.</span></span><br/><br/><span data-ttu-id="39e5c-363">È necessario specificare un account amministratore, che deve essere un amministratore locale nella macchina Windows, per l'installazione push del servizio Mobility nei server Windows.</span><span class="sxs-lookup"><span data-stu-id="39e5c-363">You need to provide an administrator account (must be a local administrator on the Windows machine) for the push installation the Mobility Service on Windows servers.</span></span> <span data-ttu-id="39e5c-364">Se l'account specificato non è un account di dominio, si dovrà disabilitare il Controllo dell'accesso utente remoto nella macchina locale.</span><span class="sxs-lookup"><span data-stu-id="39e5c-364">If the provided account is a non-domain account, you need to disable Remote User Access control on the local machine.</span></span> <span data-ttu-id="39e5c-365">Per altre informazioni, vedere [Installare il servizio Mobility con l'installazione push](#install-the-mobility-service-with-push-installation).</span><span class="sxs-lookup"><span data-stu-id="39e5c-365">For more information, see [Install the mobility service with push installation](#install-the-mobility-service-with-push-installation).</span></span><br/><br/><span data-ttu-id="39e5c-366">Site Recovery supporta VM con un disco RDM.</span><span class="sxs-lookup"><span data-stu-id="39e5c-366">Site Recovery supports VMs with an RDM disk.</span></span> <span data-ttu-id="39e5c-367">Se la macchina virtuale di origine e il disco RDM sono disponibili, durante il failback Site Recovery riusa il disco RDM.</span><span class="sxs-lookup"><span data-stu-id="39e5c-367">During failback, Site Recovery will reuse the RDM disk if the original source VM and RDM disk are available.</span></span> <span data-ttu-id="39e5c-368">Se non sono disponibili, durante il failback Site Recovery crea un nuovo file VMDK per ogni disco.</span><span class="sxs-lookup"><span data-stu-id="39e5c-368">If they aren’t available, during failback, Site Recovery will create a new VMDK file for each disk.</span></span><br/><br/><span data-ttu-id="39e5c-369">**Computer Linux**</span><span class="sxs-lookup"><span data-stu-id="39e5c-369">**Linux machines**</span></span><br/><br/><span data-ttu-id="39e5c-370">È necessario un sistema operativo a 64 bit supportato: Red Hat Enterprise Linux 6.7; Centos 6.5, 6.6 o 6.7; Oracle Enterprise Linux 6.4 o 6.5 che esegue il kernel compatibile Red Hat o Unbreakable Enterprise Kernel Release 3 (UEK3), SUSE Linux Enterprise Server 11 SP3.</span><span class="sxs-lookup"><span data-stu-id="39e5c-370">You need a supported 64-bit operating system: Red Hat Enterprise Linux 6.7; Centos 6.5, 6.6, or 6.7; Oracle Enterprise Linux 6.4 or 6.5 running either the Red Hat compatible kernel or Unbreakable Enterprise Kernel Release 3 (UEK3); SUSE Linux Enterprise Server 11 SP3.</span></span><br/><br/><span data-ttu-id="39e5c-371">I file /etc/hosts nei computer protetti devono contenere le voci che eseguono il mapping del nome host locale agli indirizzi IP associati a tutte le schede di rete.</span><span class="sxs-lookup"><span data-stu-id="39e5c-371">/etc/hosts files on protected machines should contain entries that map the local host name to IP addresses associated with all network adapters.</span></span> <br/><br/><span data-ttu-id="39e5c-372">Per connettersi a una macchina virtuale di Azure che esegue Linux dopo il failover usando un client Secure Shell (SSH), accertarsi che il servizio Secure Shell nella macchina protetta sia impostato per l'avvio automatico all'avvio del sistema e che le regole del firewall consentano una connessione SSH a tale macchina.</span><span class="sxs-lookup"><span data-stu-id="39e5c-372">If you want to connect to an Azure virtual machine running Linux after failover by using a Secure Shell client (ssh), ensure that the Secure Shell service on the protected machine is set to start automatically on system boot, and that firewall rules allow an ssh connection to it.</span></span><br/><br/><span data-ttu-id="39e5c-373">La protezione può essere abilitata solo per le macchine Linux con le risorse di archiviazione seguenti: file system (EXT3, ETX4, ReiserFS e XFS); software per percorsi multipli - Device Mapper (Multipath) e gestore dei volumi LVM2.</span><span class="sxs-lookup"><span data-stu-id="39e5c-373">Protection can only be enabled for Linux machines with the following storage: File system (EXT3, ETX4, ReiserFS, XFS); Multipath software-Device Mapper (multipath); Volume manager (LVM2).</span></span> <span data-ttu-id="39e5c-374">I server fisici con archiviazione del controller HP CCISS non sono supportati.</span><span class="sxs-lookup"><span data-stu-id="39e5c-374">Physical servers with HP CCISS controller storage are not supported.</span></span> <span data-ttu-id="39e5c-375">Il file system ReiserFS è supportato solo su SUSE Linux Enterprise Server 11 SP3.</span><span class="sxs-lookup"><span data-stu-id="39e5c-375">The ReiserFS file system is supported only on SUSE Linux Enterprise Server 11 SP3.</span></span><br/><br/><span data-ttu-id="39e5c-376">Site Recovery supporta VM con un disco RDM.</span><span class="sxs-lookup"><span data-stu-id="39e5c-376">Site Recovery supports VMs with an RDM disk.</span></span> <span data-ttu-id="39e5c-377">Durante il failback per Linux, Site Recovery non riutilizza il disco RDM,</span><span class="sxs-lookup"><span data-stu-id="39e5c-377">During failback for Linux, Site Recovery doesn’t reuse the RDM disk.</span></span> <span data-ttu-id="39e5c-378">ma crea un nuovo file VMDK per ogni disco RDM corrispondente.</span><span class="sxs-lookup"><span data-stu-id="39e5c-378">Instead, it creates a new VMDK file for each corresponding RDM disk.</span></span> |

<span data-ttu-id="39e5c-379">Solo per VM Linux: assicurarsi di applicare l'impostazione disk.enableUUID=true nei parametri di configurazione della VM in VMware.</span><span class="sxs-lookup"><span data-stu-id="39e5c-379">Only for a Linux VM: ensure that you set the disk.enableUUID=true setting in the configuration parameters of the VM in VMware.</span></span> <span data-ttu-id="39e5c-380">Se questa riga non esiste, aggiungerla</span><span class="sxs-lookup"><span data-stu-id="39e5c-380">If this row does not exist, add it.</span></span> <span data-ttu-id="39e5c-381">perché è necessaria per fornire un valore UUID coerente al file VMDK in modo che venga installato correttamente.</span><span class="sxs-lookup"><span data-stu-id="39e5c-381">This is required to provide a consistent UUID to the VMDK so that it mounts correctly.</span></span> <span data-ttu-id="39e5c-382">Senza questa impostazione, il failback provocherà un download completo anche se la VM è disponibile in locale.</span><span class="sxs-lookup"><span data-stu-id="39e5c-382">Without this setting, failback will cause a full download even if the VM is available on-premises.</span></span> <span data-ttu-id="39e5c-383">L'aggiunta di questa impostazione assicura che solo le modifiche differenziali vengano trasferite durante il failback.</span><span class="sxs-lookup"><span data-stu-id="39e5c-383">Adding this setting ensures that only delta changes are transferred back during failback.</span></span>

## <a name="step-1-create-a-vault"></a><span data-ttu-id="39e5c-384">Passaggio 1: Creare un insieme di credenziali</span><span class="sxs-lookup"><span data-stu-id="39e5c-384">Step 1: Create a vault</span></span>
1. <span data-ttu-id="39e5c-385">Accedere al [portale di Azure](https://manage.windowsazure.com/).</span><span class="sxs-lookup"><span data-stu-id="39e5c-385">Sign in to the [Azure portal](https://manage.windowsazure.com/).</span></span>
2. <span data-ttu-id="39e5c-386">Espandere **Servizi dati** > **Servizi di ripristino** e fare clic su **Insieme di credenziali di Site Recovery**.</span><span class="sxs-lookup"><span data-stu-id="39e5c-386">Expand **Data Services** > **Recovery Services** and click **Site Recovery Vault**.</span></span>
3. <span data-ttu-id="39e5c-387">Fare clic su **Creare nuovo** > **Creazione rapida**.</span><span class="sxs-lookup"><span data-stu-id="39e5c-387">Click **Create New** > **Quick Create**.</span></span>
4. <span data-ttu-id="39e5c-388">In **Nome**immettere un nome descrittivo per identificare l'insieme di credenziali.</span><span class="sxs-lookup"><span data-stu-id="39e5c-388">In **Name**, enter a friendly name to identify the vault.</span></span>
5. <span data-ttu-id="39e5c-389">In **Region**selezionare l'area geografica per l'insieme di credenziali.</span><span class="sxs-lookup"><span data-stu-id="39e5c-389">In **Region**, select the geographic region for the vault.</span></span> <span data-ttu-id="39e5c-390">Per verificare le aree supportate, vedere i [prezzi di Azure Site Recovery](https://azure.microsoft.com/pricing/details/site-recovery/).</span><span class="sxs-lookup"><span data-stu-id="39e5c-390">To check supported regions, see [Azure Site Recovery pricing details](https://azure.microsoft.com/pricing/details/site-recovery/).</span></span>
6. <span data-ttu-id="39e5c-391">Fare clic su **Create vault**.</span><span class="sxs-lookup"><span data-stu-id="39e5c-391">Click **Create vault**.</span></span>
    <span data-ttu-id="39e5c-392">![Crea insieme di credenziali](./media/site-recovery-vmware-to-azure-classic/quick-start-create-vault.png)</span><span class="sxs-lookup"><span data-stu-id="39e5c-392">![Create vault](./media/site-recovery-vmware-to-azure-classic/quick-start-create-vault.png)</span></span>

<span data-ttu-id="39e5c-393">Controllare la barra di stato per verificare che l'insieme di credenziali sia stato creato correttamente.</span><span class="sxs-lookup"><span data-stu-id="39e5c-393">Check the status bar to confirm that the vault was successfully created.</span></span> <span data-ttu-id="39e5c-394">L'insieme di credenziali verrà elencato come **Attivo** nella pagina principale di **Servizi di ripristino**.</span><span class="sxs-lookup"><span data-stu-id="39e5c-394">The vault will be listed as **Active** on the main **Recovery Services** page.</span></span>

## <a name="step-2-set-up-an-azure-network"></a><span data-ttu-id="39e5c-395">Passaggio 2: Configurare una rete di Azure</span><span class="sxs-lookup"><span data-stu-id="39e5c-395">Step 2: Set up an Azure network</span></span>
<span data-ttu-id="39e5c-396">Configurare una rete di Azure in modo che le macchine virtuali di Azure siano connesse a una rete dopo il failover e in modo che il failback al sito locale possa funzionare come previsto.</span><span class="sxs-lookup"><span data-stu-id="39e5c-396">Set up an Azure network so that Azure VMs will be connected to a network after failover, and so that failback to the on-premises site can work as expected.</span></span>

1. <span data-ttu-id="39e5c-397">Nel portale di Azure selezionare **Crea rete virtuale** e specificare il nome della rete, l'intervallo di indirizzi IP e il nome subnet.</span><span class="sxs-lookup"><span data-stu-id="39e5c-397">In the Azure portal, select **Create virtual network** and specify the network name, IP address range, and subnet name.</span></span>
2. <span data-ttu-id="39e5c-398">Per eseguire il failback aggiungere una VPN o ExpressRoute alla rete.</span><span class="sxs-lookup"><span data-stu-id="39e5c-398">If you need to do failback, add VPN/ExpressRoute to the network.</span></span> <span data-ttu-id="39e5c-399">La VPN ed ExpressRoute possono essere aggiunti alla rete anche dopo il failover.</span><span class="sxs-lookup"><span data-stu-id="39e5c-399">VPN/ExpressRoute can be added to the network even after failover.</span></span>

<span data-ttu-id="39e5c-400">Per altre informazioni sulle reti di Azure, vedere la [panoramica sulle reti virtuali](../virtual-network/virtual-networks-overview.md).</span><span class="sxs-lookup"><span data-stu-id="39e5c-400">For more information about Azure networks, see [Virtual networks overview](../virtual-network/virtual-networks-overview.md).</span></span>

> [!NOTE]
> <span data-ttu-id="39e5c-401">La [migrazione di reti](../azure-resource-manager/resource-group-move-resources.md) all'interno dei gruppi di risorse con la stessa sottoscrizione o all'interno delle sottoscrizioni non è supportata per le reti usate per la distribuzione di Site Recovery.</span><span class="sxs-lookup"><span data-stu-id="39e5c-401">[Migration of networks](../azure-resource-manager/resource-group-move-resources.md) across resource groups within the same subscription or across subscriptions is not supported for networks used for deploying Site Recovery.</span></span>
>
>

## <a name="step-3-install-the-vmware-components"></a><span data-ttu-id="39e5c-402">Passaggio 3: Installare i componenti VMware</span><span class="sxs-lookup"><span data-stu-id="39e5c-402">Step 3: Install the VMware components</span></span>
<span data-ttu-id="39e5c-403">Per eseguire la replica di macchine virtuali VMware, eseguire questa procedura nel server di gestione:</span><span class="sxs-lookup"><span data-stu-id="39e5c-403">If you want to replicate VMware virtual machines, follow these steps on the management server:</span></span>

1. <span data-ttu-id="39e5c-404">[Scaricare](https://my.vmware.com/web/vmware/details?productId=491&downloadGroup=PCLI600R1) e installare VMware vSphere PowerCLI 6.0.</span><span class="sxs-lookup"><span data-stu-id="39e5c-404">[Download](https://my.vmware.com/web/vmware/details?productId=491&downloadGroup=PCLI600R1) and install VMware vSphere PowerCLI 6.0.</span></span>
2. <span data-ttu-id="39e5c-405">Riavviare il server.</span><span class="sxs-lookup"><span data-stu-id="39e5c-405">Restart the server.</span></span>

## <a name="step-4-download-a-vault-registration-key"></a><span data-ttu-id="39e5c-406">Passaggio 4: Scaricare una chiave di registrazione dell'insieme di credenziali</span><span class="sxs-lookup"><span data-stu-id="39e5c-406">Step 4: Download a vault registration key</span></span>
1. <span data-ttu-id="39e5c-407">Dal server di gestione aprire la console di Site Recovery in Azure.</span><span class="sxs-lookup"><span data-stu-id="39e5c-407">From the management server, open the Site Recovery console in Azure.</span></span> <span data-ttu-id="39e5c-408">Nella pagina **Servizi di ripristino** fare clic sull'insieme di credenziali per aprire la pagina **Avvio rapido**.</span><span class="sxs-lookup"><span data-stu-id="39e5c-408">On the **Recovery Services** page, click the vault to open the **Quick Start** page.</span></span> <span data-ttu-id="39e5c-409">La pagina **Avvio rapido** può essere aperta in qualsiasi momento anche tramite l'icona.</span><span class="sxs-lookup"><span data-stu-id="39e5c-409">You can also open the **Quick Start** page at any time by clicking the icon.</span></span>

    ![Icona Avvio rapido](./media/site-recovery-vmware-to-azure-classic/quick-start-icon.png)
2. <span data-ttu-id="39e5c-411">Nella pagina **Avvio rapido** fare clic su **Preparare le risorse (Azure) di destinazione** > **Scaricare una chiave di registrazione**.</span><span class="sxs-lookup"><span data-stu-id="39e5c-411">On the **Quick Start** page, click **Prepare Target Resources** > **Download a registration key**.</span></span> <span data-ttu-id="39e5c-412">Il file di registrazione viene generato automaticamente.</span><span class="sxs-lookup"><span data-stu-id="39e5c-412">The registration file is generated automatically.</span></span> <span data-ttu-id="39e5c-413">È valido cinque giorni dopo essere stato generato.</span><span class="sxs-lookup"><span data-stu-id="39e5c-413">It's valid for five days after it's generated.</span></span>

## <a name="step-5-install-the-management-server"></a><span data-ttu-id="39e5c-414">Passaggio 5: Installare il server di gestione</span><span class="sxs-lookup"><span data-stu-id="39e5c-414">Step 5: Install the management server</span></span>
> [!TIP]
> <span data-ttu-id="39e5c-415">Assicurarsi che questi URL siano accessibili dal server di gestione:</span><span class="sxs-lookup"><span data-stu-id="39e5c-415">Make sure these URLs are accessible from the management server:</span></span>
>
> * <span data-ttu-id="39e5c-416">*.hypervrecoverymanager.windowsazure.com</span><span class="sxs-lookup"><span data-stu-id="39e5c-416">*.hypervrecoverymanager.windowsazure.com</span></span>
> * <span data-ttu-id="39e5c-417">*.accesscontrol.windows.net</span><span class="sxs-lookup"><span data-stu-id="39e5c-417">*.accesscontrol.windows.net</span></span>
> * <span data-ttu-id="39e5c-418">*.backup.windowsazure.com</span><span class="sxs-lookup"><span data-stu-id="39e5c-418">*.backup.windowsazure.com</span></span>
> * <span data-ttu-id="39e5c-419">*.blob.core.windows.net</span><span class="sxs-lookup"><span data-stu-id="39e5c-419">*.blob.core.windows.net</span></span>
> * <span data-ttu-id="39e5c-420">*.store.core.windows.net</span><span class="sxs-lookup"><span data-stu-id="39e5c-420">*.store.core.windows.net</span></span>
> * <span data-ttu-id="39e5c-421">https://dev.mysql.com/get/archives/mysql-5.5/mysql-5.5.37-win32.msi</span><span class="sxs-lookup"><span data-stu-id="39e5c-421">https://dev.mysql.com/get/archives/mysql-5.5/mysql-5.5.37-win32.msi</span></span>
> * <span data-ttu-id="39e5c-422">https://www.msftncsi.com/ncsi.txt</span><span class="sxs-lookup"><span data-stu-id="39e5c-422">https://www.msftncsi.com/ncsi.txt</span></span>
>
>



>[!VIDEO https://channel9.msdn.com/Blogs/Azure/Enhanced-VMware-to-Azure-Setup-Registration/player]



1. <span data-ttu-id="39e5c-423">Dalla pagina **Avvio rapido** scaricare nel server il file di installazione unificata.</span><span class="sxs-lookup"><span data-stu-id="39e5c-423">On the **Quick Start** page, download the unified installation file to the server.</span></span>
2. <span data-ttu-id="39e5c-424">Eseguire il file di installazione per avviare l'**installazione guidata unificata di Site Recovery**.</span><span class="sxs-lookup"><span data-stu-id="39e5c-424">Run the installation file to start setup in the **Site Recovery Unified Setup** wizard.</span></span>
3. <span data-ttu-id="39e5c-425">In **Prima di iniziare** selezionare l'opzione **Installare il server di configurazione e il server di elaborazione**.</span><span class="sxs-lookup"><span data-stu-id="39e5c-425">In **Before you begin**, select **Install the configuration server and process server**.</span></span>

   ![Prima di iniziare](./media/site-recovery-vmware-to-azure-classic/combined-wiz1.png)
4. <span data-ttu-id="39e5c-427">In **Licenza software di terze parti** fare clic su **Accetto** per scaricare e installare MySQL.</span><span class="sxs-lookup"><span data-stu-id="39e5c-427">In **Third-Party Software License**, click **I Accept** to download and install MySQL.</span></span>

    ![Software di terze parti](./media/site-recovery-vmware-to-azure-classic/combined-wiz105.PNG)
5. <span data-ttu-id="39e5c-429">In **Registrazione** cercare e selezionare la chiave di registrazione scaricata dall'insieme di credenziali.</span><span class="sxs-lookup"><span data-stu-id="39e5c-429">In **Registration**, browse and select the registration key that you downloaded from the vault.</span></span>

    ![Registrazione](./media/site-recovery-vmware-to-azure-classic/combined-wiz3.png)
6. <span data-ttu-id="39e5c-431">In **Impostazioni Internet** specificare in che modo il provider in esecuzione nel server di configurazione si connetterà ad Azure Site Recovery tramite Internet.</span><span class="sxs-lookup"><span data-stu-id="39e5c-431">In **Internet Settings**, specify how the provider running on the configuration server will connect to Azure Site Recovery over the Internet.</span></span>

   * <span data-ttu-id="39e5c-432">Per connettersi al proxy attualmente configurato nel computer, selezionare **Connetti con le impostazioni proxy esistenti**.</span><span class="sxs-lookup"><span data-stu-id="39e5c-432">If you want to connect with the proxy that's currently set up on the machine, select **Connect with existing proxy settings**.</span></span>
   * <span data-ttu-id="39e5c-433">Per fare in modo che il provider si connetta direttamente, selezionare **Connect directly without a proxy** (Connetti direttamente senza un proxy).</span><span class="sxs-lookup"><span data-stu-id="39e5c-433">If you want the provider to connect directly, select **Connect directly without a proxy**.</span></span>
   * <span data-ttu-id="39e5c-434">Se per il proxy esistente è necessaria l'autenticazione o si vuole usare un proxy personalizzato per la connessione del provider, selezionare **Connect with custom proxy settings** (Connetti con le impostazioni proxy personalizzate).</span><span class="sxs-lookup"><span data-stu-id="39e5c-434">If the existing proxy requires authentication, or if you want to use a custom proxy for the provider connection, select **Connect with custom proxy settings**.</span></span>
     * <span data-ttu-id="39e5c-435">Se si usa un proxy personalizzato è necessario specificare l'indirizzo, la porta e le credenziali.</span><span class="sxs-lookup"><span data-stu-id="39e5c-435">If you use a custom proxy, you'll need to specify the address, port, and credentials.</span></span>
     * <span data-ttu-id="39e5c-436">Se si usa un proxy, è necessario che gli URL seguenti siano già autorizzati:</span><span class="sxs-lookup"><span data-stu-id="39e5c-436">If you're using a proxy, you should have already allowed the following URLs:</span></span>
       * <span data-ttu-id="39e5c-437">*.hypervrecoverymanager.windowsazure.com</span><span class="sxs-lookup"><span data-stu-id="39e5c-437">*.hypervrecoverymanager.windowsazure.com</span></span>    
       * <span data-ttu-id="39e5c-438">*.accesscontrol.windows.net</span><span class="sxs-lookup"><span data-stu-id="39e5c-438">*.accesscontrol.windows.net</span></span>
       * <span data-ttu-id="39e5c-439">*.backup.windowsazure.com</span><span class="sxs-lookup"><span data-stu-id="39e5c-439">*.backup.windowsazure.com</span></span>
       * <span data-ttu-id="39e5c-440">*.blob.core.windows.net</span><span class="sxs-lookup"><span data-stu-id="39e5c-440">*.blob.core.windows.net</span></span>
       * <span data-ttu-id="39e5c-441">*. store.core.windows.net</span><span class="sxs-lookup"><span data-stu-id="39e5c-441">*.store.core.windows.net</span></span>

    ![Firewall](./media/site-recovery-vmware-to-azure-classic/combined-wiz4.png)

1. <span data-ttu-id="39e5c-443">In **Controllo dei prerequisiti** il programma di installazione esegue un controllo per assicurarsi che sia possibile eseguire l'installazione.</span><span class="sxs-lookup"><span data-stu-id="39e5c-443">In **Prerequisites Check**, Setup runs a check to make sure that the installation can run.</span></span>

    ![Prerequisiti](./media/site-recovery-vmware-to-azure-classic/combined-wiz5.png)

     <span data-ttu-id="39e5c-445">Se viene visualizzato un avviso relativo al **Global time sync check** (Controllo della sincronizzazione ora globale), verificare che l'ora del clock di sistema, nelle impostazioni di **Data e ora**, corrisponda al fuso orario.</span><span class="sxs-lookup"><span data-stu-id="39e5c-445">If a warning appears about the **Global time sync check**, verify that the time on the system clock (**Date and Time** settings) is the same as the time zone.</span></span>

     ![Problema di sincronizzazione dell'ora](./media/site-recovery-vmware-to-azure-classic/time-sync-issue.png)

1. <span data-ttu-id="39e5c-447">In **MySQL Configuration** (Configurazione MySQL) creare le credenziali per l'accesso all'istanza del server MySQL che verrà installata.</span><span class="sxs-lookup"><span data-stu-id="39e5c-447">In **MySQL Configuration**, create credentials for signing in to the MySQL server instance that will be installed.</span></span>

    ![MySQL](./media/site-recovery-vmware-to-azure-classic/combined-wiz6.png)
2. <span data-ttu-id="39e5c-449">In **Dettagli ambiente** specificare se si vuole eseguire la replica di VM VMware.</span><span class="sxs-lookup"><span data-stu-id="39e5c-449">In **Environment Details**, select whether you're going to replicate VMware VMs.</span></span> <span data-ttu-id="39e5c-450">In caso affermativo, il programma di installazione verifica se è installato PowerCLI 6.0.</span><span class="sxs-lookup"><span data-stu-id="39e5c-450">If you are, Setup checks that PowerCLI 6.0 is installed.</span></span>

    ![MySQL](./media/site-recovery-vmware-to-azure-classic/combined-wiz7.png)
3. <span data-ttu-id="39e5c-452">In **Percorso di installazione** specificare il percorso di installazione dei file binari e di archiviazione della cache.</span><span class="sxs-lookup"><span data-stu-id="39e5c-452">In **Install Location**, select where you want to install the binaries and store the cache.</span></span> <span data-ttu-id="39e5c-453">È possibile selezionare un'unità con almeno 5 GB di spazio su disco disponibile, ma è consigliabile usare un'unità cache con almeno 600 GB di spazio disponibile.</span><span class="sxs-lookup"><span data-stu-id="39e5c-453">You can select a drive that has at least 5 GB of available disk space, but we recommend a cache drive with at least 600 GB of available disk space.</span></span>

   ![Percorso di installazione](./media/site-recovery-vmware-to-azure-classic/combined-wiz8.png)
4. <span data-ttu-id="39e5c-455">In **Selezione rete** specificare il listener, ovvero la scheda di rete e la porta SSL, in cui il server di configurazione dovrà inviare e ricevere i dati di replica.</span><span class="sxs-lookup"><span data-stu-id="39e5c-455">In **Network Selection**, specify the listener (network adapter and SSL port) on which the configuration server will send and receive replication data.</span></span> <span data-ttu-id="39e5c-456">È possibile modificare la porta predefinita (9443).</span><span class="sxs-lookup"><span data-stu-id="39e5c-456">You can modify the default port (9443).</span></span> <span data-ttu-id="39e5c-457">Oltre a questa porta, un server web che orchestra le operazioni di replica userà la porta 443.</span><span class="sxs-lookup"><span data-stu-id="39e5c-457">In addition to this port, port 443 will be used by a web server that orchestrates replication operations.</span></span> <span data-ttu-id="39e5c-458">Non usare la porta 443 per ricevere il traffico di replica.</span><span class="sxs-lookup"><span data-stu-id="39e5c-458">Do not use 443 for receiving replication traffic.</span></span>

    ![Selezione rete](./media/site-recovery-vmware-to-azure-classic/combined-wiz9.png)



1. <span data-ttu-id="39e5c-460">Esaminare le informazioni nella pagina **Riepilogo** e fare clic su **Installa**.</span><span class="sxs-lookup"><span data-stu-id="39e5c-460">In **Summary**, review the information and click **Install**.</span></span> <span data-ttu-id="39e5c-461">Al termine dell'installazione verrà generata una passphrase.</span><span class="sxs-lookup"><span data-stu-id="39e5c-461">When installation finishes, a passphrase is generated.</span></span> <span data-ttu-id="39e5c-462">Sarà necessaria quando si abilita la replica, quindi copiarla e conservarla in un luogo sicuro.</span><span class="sxs-lookup"><span data-stu-id="39e5c-462">You'll need this when you enable replication, so copy it and keep it in a secure location.</span></span>

   ![Riepilogo](./media/site-recovery-vmware-to-azure-classic/combined-wiz10.png)


> [!WARNING]
> <span data-ttu-id="39e5c-464">È necessario configurare il proxy dell'agente di Servizi di ripristino di Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="39e5c-464">The Microsoft Azure Recovery Service Agent proxy must be set up.</span></span>
> <span data-ttu-id="39e5c-465">Dopo aver completato l'installazione, avviare la shell di Servizi di ripristino di Microsoft Azure dal menu di avvio di Windows.</span><span class="sxs-lookup"><span data-stu-id="39e5c-465">After the installation is finished, start the Microsoft Azure Recovery Services Shell from the Windows Start menu.</span></span> <span data-ttu-id="39e5c-466">Nella finestra di comando visualizzata eseguire questo set di comandi per configurare le impostazioni del server proxy.</span><span class="sxs-lookup"><span data-stu-id="39e5c-466">In the command window that opens, run the following set of commands to set up the proxy server settings.</span></span>
>
>
    $pwd = ConvertTo-SecureString -String ProxyUserPassword
    Set-OBMachineSetting -ProxyServer http://myproxyserver.domain.com -ProxyPort PortNumb – ProxyUserName domain\username -ProxyPassword $pwd
    net stop obengine
    net start obengine
>


### <a name="run-setup-from-the-command-line"></a><span data-ttu-id="39e5c-467">Eseguire l'installazione dalla riga di comando</span><span class="sxs-lookup"><span data-stu-id="39e5c-467">Run setup from the command line</span></span>
<span data-ttu-id="39e5c-468">È anche possibile eseguire l'installazione guidata unificata dalla riga di comando, come indicato di seguito:</span><span class="sxs-lookup"><span data-stu-id="39e5c-468">You can also run the unified wizard from the command line, as follows:</span></span>

    UnifiedSetup.exe [/ServerMode <CS/PS>] [/InstallDrive <DriveLetter>] [/MySQLCredsFilePath <MySQL credentials file path>] [/VaultCredsFilePath <Vault credentials file path>] [/EnvType <VMWare/NonVMWare>] [/PSIP <IP address to be used for data transfer] [/CSIP <IP address of CS to be registered with>] [/PassphraseFilePath <Passphrase file path>]

<span data-ttu-id="39e5c-469">Dove:</span><span class="sxs-lookup"><span data-stu-id="39e5c-469">Where:</span></span>

* <span data-ttu-id="39e5c-470">/ServerMode: obbligatorio.</span><span class="sxs-lookup"><span data-stu-id="39e5c-470">/ServerMode: Mandatory.</span></span> <span data-ttu-id="39e5c-471">Indica al programma di installazione se installare il server di configurazione e il server di elaborazione o solo il server di elaborazione, usato per installare i server di elaborazione aggiuntivi.</span><span class="sxs-lookup"><span data-stu-id="39e5c-471">Specifies whether the installation should install the configuration and process servers or the process server only (used to install additional process servers).</span></span> <span data-ttu-id="39e5c-472">Valori di input: CS, PS.</span><span class="sxs-lookup"><span data-stu-id="39e5c-472">Input values: CS, PS.</span></span>
* <span data-ttu-id="39e5c-473">InstallDrive. Obbligatorio.</span><span class="sxs-lookup"><span data-stu-id="39e5c-473">InstallDrive: Mandatory.</span></span> <span data-ttu-id="39e5c-474">Specifica la cartella in cui sono installati i componenti.</span><span class="sxs-lookup"><span data-stu-id="39e5c-474">Specifies the folder where the components are installed.</span></span>
* <span data-ttu-id="39e5c-475">/MySQLCredFilePath.</span><span class="sxs-lookup"><span data-stu-id="39e5c-475">/MySQLCredFilePath.</span></span> <span data-ttu-id="39e5c-476">obbligatorio.</span><span class="sxs-lookup"><span data-stu-id="39e5c-476">Mandatory.</span></span> <span data-ttu-id="39e5c-477">Specifica il percorso di un file in cui sono archiviate le credenziali del server MySQL.</span><span class="sxs-lookup"><span data-stu-id="39e5c-477">Specifies the path to a file where the MySQL server credentials are stored.</span></span> <span data-ttu-id="39e5c-478">È disponibile un modello per la creazione del file.</span><span class="sxs-lookup"><span data-stu-id="39e5c-478">Get the template to create the file.</span></span>
* <span data-ttu-id="39e5c-479">/VaultCredFilePath.</span><span class="sxs-lookup"><span data-stu-id="39e5c-479">/VaultCredFilePath.</span></span> <span data-ttu-id="39e5c-480">obbligatorio.</span><span class="sxs-lookup"><span data-stu-id="39e5c-480">Mandatory.</span></span> <span data-ttu-id="39e5c-481">Percorso del file di credenziali dell'insieme di credenziali.</span><span class="sxs-lookup"><span data-stu-id="39e5c-481">Location of the vault credentials file.</span></span>
* <span data-ttu-id="39e5c-482">/EnvType:</span><span class="sxs-lookup"><span data-stu-id="39e5c-482">/EnvType.</span></span> <span data-ttu-id="39e5c-483">Obbligatorio.</span><span class="sxs-lookup"><span data-stu-id="39e5c-483">Mandatory.</span></span> <span data-ttu-id="39e5c-484">Tipo di installazione.</span><span class="sxs-lookup"><span data-stu-id="39e5c-484">Type of installation.</span></span> <span data-ttu-id="39e5c-485">Valori: VMware, NonVMware.</span><span class="sxs-lookup"><span data-stu-id="39e5c-485">Values: VMware, NonVMware.</span></span>
* <span data-ttu-id="39e5c-486">/PSIP e /CSIP.</span><span class="sxs-lookup"><span data-stu-id="39e5c-486">/PSIP and /CSIP.</span></span> <span data-ttu-id="39e5c-487">Obbligatorio.</span><span class="sxs-lookup"><span data-stu-id="39e5c-487">Mandatory.</span></span> <span data-ttu-id="39e5c-488">Indirizzo IP del server di elaborazione e del server di configurazione.</span><span class="sxs-lookup"><span data-stu-id="39e5c-488">IP address of the process server and configuration server.</span></span>
* <span data-ttu-id="39e5c-489">/PassphraseFilePath.</span><span class="sxs-lookup"><span data-stu-id="39e5c-489">/PassphraseFilePath.</span></span> <span data-ttu-id="39e5c-490">Obbligatorio.</span><span class="sxs-lookup"><span data-stu-id="39e5c-490">Mandatory.</span></span> <span data-ttu-id="39e5c-491">Percorso del file della passphrase.</span><span class="sxs-lookup"><span data-stu-id="39e5c-491">Location of the passphrase file.</span></span>
* <span data-ttu-id="39e5c-492">/ByPassProxy.</span><span class="sxs-lookup"><span data-stu-id="39e5c-492">/ByPassProxy.</span></span> <span data-ttu-id="39e5c-493">Facoltativo.</span><span class="sxs-lookup"><span data-stu-id="39e5c-493">Optional.</span></span> <span data-ttu-id="39e5c-494">Specifica il server di gestione che si connette ad Azure senza un proxy.</span><span class="sxs-lookup"><span data-stu-id="39e5c-494">Specifies the management server that connects to Azure without a proxy.</span></span>
* <span data-ttu-id="39e5c-495">/ProxySettingsFilePath:</span><span class="sxs-lookup"><span data-stu-id="39e5c-495">/ProxySettingsFilePath.</span></span> <span data-ttu-id="39e5c-496">Facoltativo.</span><span class="sxs-lookup"><span data-stu-id="39e5c-496">Optional.</span></span> <span data-ttu-id="39e5c-497">Specifica le impostazioni per un proxy personalizzato, ovvero un proxy predefinito nel server che richiede l'autenticazione o un proxy personalizzato.</span><span class="sxs-lookup"><span data-stu-id="39e5c-497">Specifies settings for a custom proxy (either default proxy on the server that requires authentication, or custom proxy).</span></span>

## <a name="step-6-set-up-credentials-for-the-vcenter-server"></a><span data-ttu-id="39e5c-498">Passaggio 6: Impostare le credenziali per il server vCenter</span><span class="sxs-lookup"><span data-stu-id="39e5c-498">Step 6: Set up credentials for the vCenter server</span></span>
> [!VIDEO https://channel9.msdn.com/Blogs/Azure/Enhanced-VMware-to-Azure-Discovery/player]
>
>

<span data-ttu-id="39e5c-499">Il server di elaborazione può rilevare automaticamente le macchine virtuali VMware gestite da un server vCenter.</span><span class="sxs-lookup"><span data-stu-id="39e5c-499">The process server can automatically discover VMware VMs that are managed by a vCenter server.</span></span> <span data-ttu-id="39e5c-500">Per l'individuazione automatica con Site Recovery sono necessari un account e credenziali di accesso al server vCenter.</span><span class="sxs-lookup"><span data-stu-id="39e5c-500">For automatic discovery, Site Recovery needs an account and credentials that can access the vCenter server.</span></span> <span data-ttu-id="39e5c-501">Questa istruzione non si applica se si esegue solo la replica di server fisici.</span><span class="sxs-lookup"><span data-stu-id="39e5c-501">This isn't relevant if you're replicating only physical servers.</span></span>

<span data-ttu-id="39e5c-502">Per impostare l'account e le credenziali:</span><span class="sxs-lookup"><span data-stu-id="39e5c-502">To set the account and credentials:</span></span>

1. <span data-ttu-id="39e5c-503">Nel server vCenter creare un ruolo, **Azure_Site_Recovery**, a livello di vCenter con le [autorizzazioni necessarie](#vmware-permissions-for-vcenter-access).</span><span class="sxs-lookup"><span data-stu-id="39e5c-503">On the vCenter server, create a role (**Azure_Site_Recovery**) at the vCenter level with the [required permissions](#vmware-permissions-for-vcenter-access).</span></span>
2. <span data-ttu-id="39e5c-504">Assegnare il ruolo **Azure_Site_Recovery** a un utente di vCenter.</span><span class="sxs-lookup"><span data-stu-id="39e5c-504">Assign the **Azure_Site_Recovery** role to a vCenter user.</span></span>

   > [!NOTE]
   > <span data-ttu-id="39e5c-505">Un account utente di vCenter con un ruolo di sola lettura può eseguire il failover senza arrestare le macchine di origine protette.</span><span class="sxs-lookup"><span data-stu-id="39e5c-505">A vCenter user account that has the read-only role can run failover without shutting down protected source machines.</span></span> <span data-ttu-id="39e5c-506">Per arrestare tali macchine è necessario il ruolo Azure_Site_Recovery.</span><span class="sxs-lookup"><span data-stu-id="39e5c-506">If you want to shut down those machines, you'll need the Azure_Site_Recovery role.</span></span> <span data-ttu-id="39e5c-507">Se si sta eseguendo solo la migrazione delle macchine virtuali da VMware ad Azure e non è necessario il failback, il ruolo di sola lettura è sufficiente.</span><span class="sxs-lookup"><span data-stu-id="39e5c-507">If you're only migrating VMs from VMware to Azure and don't need to fail back, the read-only role is sufficient.</span></span>
   >
   >
3. <span data-ttu-id="39e5c-508">Per aggiungere l'account aprire **cspsconfigtool**.</span><span class="sxs-lookup"><span data-stu-id="39e5c-508">To add the account, open **cspsconfigtool**.</span></span> <span data-ttu-id="39e5c-509">È disponibile come collegamento sul desktop e si trova nella cartella [PERCORSO DI INSTALLAZIONE]\home\svsystems\bin.</span><span class="sxs-lookup"><span data-stu-id="39e5c-509">It's available as a shortcut on the desktop and located in the [INSTALL LOCATION]\home\svsystems\bin folder.</span></span>
4. <span data-ttu-id="39e5c-510">Nella scheda **Gestisci account** fare clic su **Aggiungi account**.</span><span class="sxs-lookup"><span data-stu-id="39e5c-510">On the **Manage Accounts** tab, click **Add Account**.</span></span>

    ![Aggiungi account](./media/site-recovery-vmware-to-azure-classic/credentials1.png)
5. <span data-ttu-id="39e5c-512">In **Dettagli account** aggiungere le credenziali da usare per accedere al server vCenter.</span><span class="sxs-lookup"><span data-stu-id="39e5c-512">In **Account Details**, add credentials that can be used to access the vCenter server.</span></span> <span data-ttu-id="39e5c-513">Potrebbero trascorrere più di 15 minuti prima che il nome dell'account venga visualizzato nel portale.</span><span class="sxs-lookup"><span data-stu-id="39e5c-513">It can take more than 15 minutes for the account name to appear in the portal.</span></span> <span data-ttu-id="39e5c-514">Per aggiornarlo immediatamente, fare clic su **Aggiorna** nella scheda **Server di configurazione**.</span><span class="sxs-lookup"><span data-stu-id="39e5c-514">To update immediately, click **Refresh** on the **Configuration Servers** tab.</span></span>

    ![Dettagli](./media/site-recovery-vmware-to-azure-classic/credentials2.png)

## <a name="step-7-add-vcenter-servers-and-esxi-hosts"></a><span data-ttu-id="39e5c-516">Passaggio 7: Aggiungere server vCenter e host ESXi</span><span class="sxs-lookup"><span data-stu-id="39e5c-516">Step 7: Add vCenter servers and ESXi hosts</span></span>
<span data-ttu-id="39e5c-517">Se si esegue la replica di macchine virtuali VMware è necessario aggiungere un server vCenter o un host ESXi.</span><span class="sxs-lookup"><span data-stu-id="39e5c-517">If you're replicating VMware VMs, you need to add a vCenter server (or ESXi host).</span></span>

1. <span data-ttu-id="39e5c-518">Nella scheda **Server** > **Server di configurazione** selezionare **Aggiungi server vCenter**.</span><span class="sxs-lookup"><span data-stu-id="39e5c-518">On the **Servers** > **Configuration Servers** tab, select **Add vCenter server**.</span></span>

    ![vCenter](./media/site-recovery-vmware-to-azure-classic/add-vcenter1.png)
2. <span data-ttu-id="39e5c-520">Aggiungere i dettagli del server vCenter o dell'host ESXi, il nome dell'account specificato per accedere al server vCenter nel passaggio precedente e il server di elaborazione da usare per trovare le macchine virtuali VMware gestite dal server vCenter.</span><span class="sxs-lookup"><span data-stu-id="39e5c-520">Add the vCenter server or ESXi host details, the name of the account that you specified to access the vCenter server in the previous step, and the process server that will be used to discover VMware VMs that are managed by the vCenter server.</span></span> <span data-ttu-id="39e5c-521">Il server vCenter e l'host ESXi devono trovarsi nella stessa rete del server in cui è installato il server di elaborazione.</span><span class="sxs-lookup"><span data-stu-id="39e5c-521">The vCenter server or ESXi host should be located in the same network as the server on which the process server is installed.</span></span>

   > [!NOTE]
   > <span data-ttu-id="39e5c-522">Se si aggiunge il server vCenter o l'host ESXi con un account che non ha privilegi di amministratore per il server vCenter o il server host, assicurarsi che questi privilegi siano abilitati per gli account vCenter o ESXi: Datacenter (Data center), Datastore (Archivio dati), Folder (Cartella), Host, Network (Rete), Resource (Risorsa), Virtual machine (Macchina virtuale) e vSphere Distributed Switch (Switch distribuito vSphere).</span><span class="sxs-lookup"><span data-stu-id="39e5c-522">If you're adding the vCenter server or ESXi host with an account that doesn't have administrator privileges on the vCenter or host server, make sure the vCenter or ESXi accounts have these privileges enabled: Datacenter, Datastore, Folder, Jost, Network, Resource, Virtual Machine, and vSphere Distributed Switch.</span></span> <span data-ttu-id="39e5c-523">Per il server vCenter è necessario abilitare il privilegio Storage views (Viste archiviazione).</span><span class="sxs-lookup"><span data-stu-id="39e5c-523">The vCenter server needs the Storage Views privilege enabled.</span></span>
   >
   >

    ![Aggiungere il server vCenter](./media/site-recovery-vmware-to-azure-classic/add-vcenter2.png)
3. <span data-ttu-id="39e5c-525">Al termine dell'individuazione, il server vCenter sarà elencato nella scheda **Server di configurazione**.</span><span class="sxs-lookup"><span data-stu-id="39e5c-525">After discovery is finished, the vCenter server will be listed on the **Configuration Servers** tab.</span></span>

    ![vCenter](./media/site-recovery-vmware-to-azure-classic/add-vcenter3.png)

## <a name="step-8-create-a-protection-group"></a><span data-ttu-id="39e5c-527">Passaggio 8: Creare un gruppo di protezione</span><span class="sxs-lookup"><span data-stu-id="39e5c-527">Step 8: Create a protection group</span></span>
> [!VIDEO https://channel9.msdn.com/Blogs/Azure/Enhanced-VMware-to-Azure-Protection/player]
>
>

<span data-ttu-id="39e5c-528">I gruppi di protezione sono raggruppamenti logici di macchine virtuali o server fisici da proteggere usando le stesse impostazioni di protezione.</span><span class="sxs-lookup"><span data-stu-id="39e5c-528">Protection groups are logical groupings of virtual machines or physical servers that you want to protect by using the same protection settings.</span></span> <span data-ttu-id="39e5c-529">Se si applicano specifiche impostazioni di protezione a un gruppo, queste vengono automaticamente applicate a tutte le macchine (virtuali o fisiche) aggiunte al gruppo.</span><span class="sxs-lookup"><span data-stu-id="39e5c-529">You apply protection settings to a protection group, and those settings are applied to all machines (virtual or physical) that you add to the group.</span></span>

1. <span data-ttu-id="39e5c-530">Passare a **Elementi protetti** > **Gruppo di protezione** e fare clic sull'icona per aggiungere un gruppo di protezione.</span><span class="sxs-lookup"><span data-stu-id="39e5c-530">Go to **Protected Items** > **Protection Group** and click the icon to add a protection group.</span></span>

    ![Crea gruppo di protezione](./media/site-recovery-vmware-to-azure-classic/protection-groups1.png)
2. <span data-ttu-id="39e5c-532">Nella pagina **Specificare le impostazioni del gruppo di protezione** immettere un nome per il gruppo.</span><span class="sxs-lookup"><span data-stu-id="39e5c-532">On the **Specify Protection Group Settings** page, specify a name for the group.</span></span> <span data-ttu-id="39e5c-533">Nell'elenco a discesa **Da** selezionare il server di configurazione in cui creare il gruppo.</span><span class="sxs-lookup"><span data-stu-id="39e5c-533">In the **From** drop-down list, select the configuration server on which you want to create the group.</span></span> <span data-ttu-id="39e5c-534">**Destinazione** è Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="39e5c-534">**Target** is Microsoft Azure.</span></span>

    ![Impostazioni del gruppo di protezione](./media/site-recovery-vmware-to-azure-classic/protection-groups2.png)
3. <span data-ttu-id="39e5c-536">Nella pagina **Specifica le impostazioni di replica** configurare le impostazioni di replica da usare per tutte le macchine nel gruppo.</span><span class="sxs-lookup"><span data-stu-id="39e5c-536">On the **Specify Replication Settings** page, configure the replication settings that will be used for all the machines in the group.</span></span>

    ![Replica del gruppo di protezione](./media/site-recovery-vmware-to-azure-classic/protection-groups3.png)

   * <span data-ttu-id="39e5c-538">**Coerenza di più macchine virtuali**: se si attiva questa opzione, vengono creati punti di ripristino coerenti con l'applicazione condivisi tra le macchine nel gruppo di protezione.</span><span class="sxs-lookup"><span data-stu-id="39e5c-538">**Multi VM consistency**: If you turn this on, it creates shared application-consistent recovery points across the machines in the protection group.</span></span> <span data-ttu-id="39e5c-539">Questa impostazione è importante soprattutto quando tutte le macchine nel gruppo di protezione eseguono lo stesso carico di lavoro.</span><span class="sxs-lookup"><span data-stu-id="39e5c-539">This setting is most relevant when all machines in the protection group are running the same workload.</span></span> <span data-ttu-id="39e5c-540">Tutti i computer saranno ripristinati nello stesso punto dati.</span><span class="sxs-lookup"><span data-stu-id="39e5c-540">All machines will be recovered to the same data point.</span></span> <span data-ttu-id="39e5c-541">Questa opzione è disponibile sia per la replica di macchine virtuali VMware che per la replica di server fisici Windows o Linux.</span><span class="sxs-lookup"><span data-stu-id="39e5c-541">This is available whether you're replicating VMware VMs or physical servers (Windows or Linux).</span></span>
   * <span data-ttu-id="39e5c-542">**Soglia RPO**: imposta un valore RPO.</span><span class="sxs-lookup"><span data-stu-id="39e5c-542">**RPO threshold**: Sets the RPO.</span></span> <span data-ttu-id="39e5c-543">Se la replica della protezione dati continua supera la soglia RPO configurata, vengono generati avvisi.</span><span class="sxs-lookup"><span data-stu-id="39e5c-543">Alerts are generated when the continuous data protection replication exceeds the configured RPO threshold value.</span></span>
   * <span data-ttu-id="39e5c-544">**Conservazione del punto di ripristino**: specifica l'intervallo di conservazione.</span><span class="sxs-lookup"><span data-stu-id="39e5c-544">**Recovery point retention**: Specifies the retention window.</span></span> <span data-ttu-id="39e5c-545">I computer protetti possono essere ripristinati in qualsiasi punto all'interno di questo intervallo.</span><span class="sxs-lookup"><span data-stu-id="39e5c-545">Protected machines can be recovered to any point within this window.</span></span>
   * <span data-ttu-id="39e5c-546">**Frequenza snapshot coerenti con l'applicazione**: specifica con quale frequenza verranno creati i punti di ripristino contenenti snapshot coerenti con l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="39e5c-546">**Application-consistent snapshot frequency**: Specifies how frequently recovery points that contain application-consistent snapshots will be created.</span></span>

<span data-ttu-id="39e5c-547">Facendo clic sul segno di spunta viene creato un gruppo di protezione con il nome specificato.</span><span class="sxs-lookup"><span data-stu-id="39e5c-547">When you select the check mark, a protection group is created with the name you specified.</span></span> <span data-ttu-id="39e5c-548">Viene anche creato un secondo gruppo di protezione denominato *nome-gruppo-protezione*-Failback.</span><span class="sxs-lookup"><span data-stu-id="39e5c-548">In addition, a second protection group is created with the name *protection-group-name*-Failback.</span></span> <span data-ttu-id="39e5c-549">Questo gruppo di protezione viene usato se si esegue il failback nel sito locale dopo il failover in Azure.</span><span class="sxs-lookup"><span data-stu-id="39e5c-549">This protection group is used if you fail back to the on-premises site after failover to Azure.</span></span> <span data-ttu-id="39e5c-550">È possibile monitorare i gruppi di protezione man mano che vengono creati nella pagina **Elementi protetti** .</span><span class="sxs-lookup"><span data-stu-id="39e5c-550">You can monitor the protection groups as they're created on the **Protected Items** page.</span></span>

## <a name="step-9-install-the-mobility-service"></a><span data-ttu-id="39e5c-551">Passaggio 9: Installare il servizio Mobility</span><span class="sxs-lookup"><span data-stu-id="39e5c-551">Step 9: Install the Mobility service</span></span>
<span data-ttu-id="39e5c-552">Per abilitare la protezione per le macchine virtuali e i server fisici è necessario prima di tutto installare il servizio Mobility.</span><span class="sxs-lookup"><span data-stu-id="39e5c-552">The first step in enabling protection for virtual machines and physical servers is to install the Mobility service.</span></span> <span data-ttu-id="39e5c-553">Questa operazione può essere eseguita in due modi:</span><span class="sxs-lookup"><span data-stu-id="39e5c-553">You can do this in two ways:</span></span>

* <span data-ttu-id="39e5c-554">Eseguire il push e installare automaticamente il servizio in ogni computer dal server di elaborazione.</span><span class="sxs-lookup"><span data-stu-id="39e5c-554">Automatically push and install the service on each machine from the process server.</span></span> <span data-ttu-id="39e5c-555">Quando si aggiungono a un gruppo di protezione macchine in cui è già in esecuzione una versione appropriata del servizio Mobility, l'installazione push non viene eseguita.</span><span class="sxs-lookup"><span data-stu-id="39e5c-555">When you add machines to a protection group and they're already running an appropriate version of the Mobility service, push installation won't occur.</span></span> <span data-ttu-id="39e5c-556">È anche possibile installare automaticamente il servizio usando il metodo push dell'organizzazione, ad esempio WSUS o System Center Configuration Manager.</span><span class="sxs-lookup"><span data-stu-id="39e5c-556">You can also automatically install the service by using your enterprise push method, like WSUS or System Center Configuration Manager.</span></span> <span data-ttu-id="39e5c-557">Assicurarsi di aver configurato il server di gestione prima di procedere.</span><span class="sxs-lookup"><span data-stu-id="39e5c-557">Make sure you've set up the management server before you do this.</span></span>
* <span data-ttu-id="39e5c-558">Installare manualmente il servizio in ogni macchina da proteggere.</span><span class="sxs-lookup"><span data-stu-id="39e5c-558">Install the service manually on each machine that you want to protect.</span></span> <span data-ttu-id="39e5c-559">Assicurarsi di aver configurato il server di gestione prima di procedere.</span><span class="sxs-lookup"><span data-stu-id="39e5c-559">Make sure you've set up the management server before you do this.</span></span>

### <a name="install-the-mobility-service-with-push-installation"></a><span data-ttu-id="39e5c-560">Installare il servizio Mobility con l'installazione push</span><span class="sxs-lookup"><span data-stu-id="39e5c-560">Install the Mobility service with push installation</span></span>
<span data-ttu-id="39e5c-561">Quando si aggiungono macchine a un gruppo di protezione, il server di elaborazione effettua automaticamente il push e l'installazione del servizio Mobility in ogni macchina.</span><span class="sxs-lookup"><span data-stu-id="39e5c-561">When you add machines to a protection group, the Mobility service is automatically pushed and installed on each machine by the process server.</span></span>

#### <a name="prepare-for-automatic-push-on-windows-machines"></a><span data-ttu-id="39e5c-562">Preparare il push automatico nei computer Windows</span><span class="sxs-lookup"><span data-stu-id="39e5c-562">Prepare for automatic push on Windows machines</span></span>
<span data-ttu-id="39e5c-563">Di seguito viene illustrato come preparare le macchine Windows in modo che il servizio Mobility possa essere installato automaticamente dal server di elaborazione:</span><span class="sxs-lookup"><span data-stu-id="39e5c-563">To prepare Windows machines so that the Mobility service can be automatically installed by the process server:</span></span>

1. <span data-ttu-id="39e5c-564">Creare un account utilizzabile dal server di elaborazione per accedere alla macchina.</span><span class="sxs-lookup"><span data-stu-id="39e5c-564">Create an account that the process server can use to access the machine.</span></span> <span data-ttu-id="39e5c-565">L'account deve avere privilegi di amministratore (locale o di dominio).</span><span class="sxs-lookup"><span data-stu-id="39e5c-565">The account should have administrator privileges (local or domain).</span></span> <span data-ttu-id="39e5c-566">Queste credenziali vengono usate solo per l'installazione push del servizio Mobility.</span><span class="sxs-lookup"><span data-stu-id="39e5c-566">These credentials are used only for push installation of the Mobility service.</span></span>

   > [!NOTE]
   > <span data-ttu-id="39e5c-567">Se non si usa un account di dominio, è necessario disabilitare il Controllo dell'accesso utente remoto nella macchina locale.</span><span class="sxs-lookup"><span data-stu-id="39e5c-567">If you're not using a domain account, you'll need to disable Remote User Access control on the local machine.</span></span> <span data-ttu-id="39e5c-568">A tale scopo, aggiungere la voce DWORD LocalAccountTokenFilterPolicy con un valore di 1 nel Registro di sistema in HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System.</span><span class="sxs-lookup"><span data-stu-id="39e5c-568">To do this, in the registry under HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System, add the DWORD entry LocalAccountTokenFilterPolicy with a value of 1 under.</span></span> <span data-ttu-id="39e5c-569">Per aggiungere la voce del Registro di sistema da un'interfaccia della riga di comando o PowerShell immettere **`REG ADD HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System /v LocalAccountTokenFilterPolicy /t REG_DWORD /d 1`**.</span><span class="sxs-lookup"><span data-stu-id="39e5c-569">To add the registry entry from a CLI open command or by using PowerShell, enter **`REG ADD HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System /v LocalAccountTokenFilterPolicy /t REG_DWORD /d 1`**.</span></span>
   >
   >
2. <span data-ttu-id="39e5c-570">Nell'istanza di Windows Firewall della macchina da proteggere selezionare **Consenti app o funzionalità attraverso Windows Firewall** e abilitare **Condivisione file e stampanti** e **Strumentazione gestione Windows**.</span><span class="sxs-lookup"><span data-stu-id="39e5c-570">For Windows Firewall on the machine that you want to protect, select **Allow an app or feature through Firewall**, and enable **File and Printer Sharing** and **Windows Management Instrumentation**.</span></span> <span data-ttu-id="39e5c-571">Per le macchine appartenenti a un dominio è possibile configurare i criteri del firewall con un oggetto Criteri di gruppo.</span><span class="sxs-lookup"><span data-stu-id="39e5c-571">For machines that belong to a domain, you can configure the firewall policy with a GPO.</span></span>

   ![Impostazioni del firewall](./media/site-recovery-vmware-to-azure-classic/mobility1.png)
3. <span data-ttu-id="39e5c-573">Aggiungere l'account creato:</span><span class="sxs-lookup"><span data-stu-id="39e5c-573">Add the account that you created:</span></span>

   * <span data-ttu-id="39e5c-574">Aprire **cspsconfigtool**.</span><span class="sxs-lookup"><span data-stu-id="39e5c-574">Open **cspsconfigtool**.</span></span> <span data-ttu-id="39e5c-575">È disponibile come collegamento sul desktop e si trova nella cartella [PERCORSO DI INSTALLAZIONE]\home\svsystems\bin.</span><span class="sxs-lookup"><span data-stu-id="39e5c-575">It's available as a shortcut on the desktop and located in the [INSTALL LOCATION]\home\svsystems\bin folder.</span></span>
   * <span data-ttu-id="39e5c-576">Nella scheda **Gestisci account** fare clic su **Aggiungi account**.</span><span class="sxs-lookup"><span data-stu-id="39e5c-576">On the **Manage Accounts** tab, click **Add Account**.</span></span>
   * <span data-ttu-id="39e5c-577">Aggiungere l'account creato.</span><span class="sxs-lookup"><span data-stu-id="39e5c-577">Add the account that you created.</span></span> <span data-ttu-id="39e5c-578">Dopo aver aggiunto l'account, per l'aggiunta di una macchina al gruppo di protezione sarà necessario fornire le credenziali.</span><span class="sxs-lookup"><span data-stu-id="39e5c-578">After you add the account, you'll need to provide the credentials when you add a machine to a protection group.</span></span>

#### <a name="prepare-for-automatic-push-on-linux-servers"></a><span data-ttu-id="39e5c-579">Preparare il push automatico nei server Linux</span><span class="sxs-lookup"><span data-stu-id="39e5c-579">Prepare for automatic push on Linux servers</span></span>
1. <span data-ttu-id="39e5c-580">Verificare che il computer Linux da proteggere sia supportato come descritto in [Prerequisiti locali](#on-premises-prerequisites).</span><span class="sxs-lookup"><span data-stu-id="39e5c-580">Make sure that the Linux machine you want to protect is supported as described in [On-premises prerequisites](#on-premises-prerequisites).</span></span> <span data-ttu-id="39e5c-581">Verificare la disponibilità della connettività di rete tra la macchina da proteggere e il server di gestione che esegue il server di elaborazione.</span><span class="sxs-lookup"><span data-stu-id="39e5c-581">Ensure that there’s network connectivity between the machine you want to protect and the management server that runs the process server.</span></span>
2. <span data-ttu-id="39e5c-582">Creare un account utilizzabile dal server di elaborazione per accedere alla macchina.</span><span class="sxs-lookup"><span data-stu-id="39e5c-582">Create an account that the process server can use to access the machine.</span></span> <span data-ttu-id="39e5c-583">L'account deve essere un utente ROOT nel server Linux di origine.</span><span class="sxs-lookup"><span data-stu-id="39e5c-583">The account should be a root user on the source Linux server.</span></span> <span data-ttu-id="39e5c-584">Queste credenziali vengono usate solo per l'installazione push del servizio Mobility.</span><span class="sxs-lookup"><span data-stu-id="39e5c-584">These credentials are used only for push installation of the Mobility service.</span></span>

   * <span data-ttu-id="39e5c-585">Aprire **cspsconfigtool**.</span><span class="sxs-lookup"><span data-stu-id="39e5c-585">Open **cspsconfigtool**.</span></span> <span data-ttu-id="39e5c-586">È disponibile come collegamento sul desktop e si trova nella cartella [PERCORSO DI INSTALLAZIONE]\home\svsystems\bin.</span><span class="sxs-lookup"><span data-stu-id="39e5c-586">It's available as a shortcut on the desktop and located in the [INSTALL LOCATION]\home\svsystems\bin folder.</span></span>
   * <span data-ttu-id="39e5c-587">Nella scheda **Gestisci account** fare clic su **Aggiungi account**.</span><span class="sxs-lookup"><span data-stu-id="39e5c-587">On the **Manage Accounts** tab, click **Add Account**.</span></span>
   * <span data-ttu-id="39e5c-588">Aggiungere l'account creato.</span><span class="sxs-lookup"><span data-stu-id="39e5c-588">Add the account that you created.</span></span> <span data-ttu-id="39e5c-589">Dopo aver aggiunto l'account, per l'aggiunta di una macchina al gruppo di protezione sarà necessario fornire le credenziali.</span><span class="sxs-lookup"><span data-stu-id="39e5c-589">After you add the account, you'll need to provide the credentials when you add a machine to a protection group.</span></span>
3. <span data-ttu-id="39e5c-590">Assicurarsi che il file /etc/hosts nel server Linux di origine contenga le voci che eseguono il mapping del nome host locale agli indirizzi IP associati a tutte le schede di rete.</span><span class="sxs-lookup"><span data-stu-id="39e5c-590">Check that the /etc/hosts file on the source Linux server contains entries that map the local hostname to IP addresses associated with all network adapters.</span></span>
4. <span data-ttu-id="39e5c-591">Installare i pacchetti openssh, openssh-server, openssl più recenti nella macchina da proteggere.</span><span class="sxs-lookup"><span data-stu-id="39e5c-591">Install the latest openssh, openssh-server, and openssl packages on the machine that you want to protect.</span></span>
5. <span data-ttu-id="39e5c-592">Assicurarsi che SSH sia abilitato e in esecuzione sulla porta 22.</span><span class="sxs-lookup"><span data-stu-id="39e5c-592">Ensure that SSH is enabled and running on port 22.</span></span>
6. <span data-ttu-id="39e5c-593">Abilitare il sottosistema SFTP e l'autenticazione della password nel file sshd_config, come segue:</span><span class="sxs-lookup"><span data-stu-id="39e5c-593">Enable SFTP subsystem and password authentication in the sshd_config file as follows:</span></span>

   * <span data-ttu-id="39e5c-594">Accedere come utente ROOT.</span><span class="sxs-lookup"><span data-stu-id="39e5c-594">Sign in as root.</span></span>
   * <span data-ttu-id="39e5c-595">Nel file /etc/ssh/sshd_config trovare la riga che inizia con PasswordAuthentication.</span><span class="sxs-lookup"><span data-stu-id="39e5c-595">In the /etc/ssh/sshd_config file, find the line that begins with PasswordAuthentication.</span></span>
   * <span data-ttu-id="39e5c-596">Rimuovere il commento dalla riga e modificare il valore da **no** a **yes**.</span><span class="sxs-lookup"><span data-stu-id="39e5c-596">Uncomment the line and change the value from **no** to **yes**.</span></span>
   * <span data-ttu-id="39e5c-597">Trovare la riga che inizia con **Subsystem** e rimuovere il commento.</span><span class="sxs-lookup"><span data-stu-id="39e5c-597">Find the line that begins with **Subsystem** and uncomment the line.</span></span>

     ![override default of no subsystems in Linux](./media/site-recovery-vmware-to-azure-classic/mobility2.png)

### <a name="install-the-mobility-service-manually"></a><span data-ttu-id="39e5c-599">Installare manualmente il servizio Mobility</span><span class="sxs-lookup"><span data-stu-id="39e5c-599">Install the Mobility service manually</span></span>
<span data-ttu-id="39e5c-600">I programmi di installazione sono disponibili in C:\Programmi (x86)\Microsoft Azure Site Recovery\home\svsystems\pushinstallsvc\repository.</span><span class="sxs-lookup"><span data-stu-id="39e5c-600">The installers are available in C:\Program Files (x86)\Microsoft Azure Site Recovery\home\svsystems\pushinstallsvc\repository.</span></span>

| <span data-ttu-id="39e5c-601">Sistema operativo di origine</span><span class="sxs-lookup"><span data-stu-id="39e5c-601">Source operating system</span></span> | <span data-ttu-id="39e5c-602">File di installazione del servizio Mobility</span><span class="sxs-lookup"><span data-stu-id="39e5c-602">Mobility service installation file</span></span> |
| --- | --- |
| <span data-ttu-id="39e5c-603">Windows Server (solo 64 bit)</span><span class="sxs-lookup"><span data-stu-id="39e5c-603">Windows Server (64 bit only)</span></span> |<span data-ttu-id="39e5c-604">Microsoft-ASR_UA_9.*.0.0_Windows_* release.exe</span><span class="sxs-lookup"><span data-stu-id="39e5c-604">Microsoft-ASR_UA_9.*.0.0_Windows_* release.exe</span></span> |
| <span data-ttu-id="39e5c-605">CentOS 6.4, 6.5, 6.6 (solo 64 bit)</span><span class="sxs-lookup"><span data-stu-id="39e5c-605">CentOS 6.4, 6.5, 6.6 (64 bit only)</span></span> |<span data-ttu-id="39e5c-606">Microsoft-ASR_UA_9.*.0.0_RHEL6-64_*release.tar.gz</span><span class="sxs-lookup"><span data-stu-id="39e5c-606">Microsoft-ASR_UA_9.*.0.0_RHEL6-64_*release.tar.gz</span></span> |
| <span data-ttu-id="39e5c-607">SUSE Linux Enterprise Server 11 SP3 (solo 64 bit)</span><span class="sxs-lookup"><span data-stu-id="39e5c-607">SUSE Linux Enterprise Server 11 SP3 (64 bit only)</span></span> |<span data-ttu-id="39e5c-608">Microsoft-ASR_UA_9.*.0.0_SLES11-SP3-64_*release.tar.gz</span><span class="sxs-lookup"><span data-stu-id="39e5c-608">Microsoft-ASR_UA_9.*.0.0_SLES11-SP3-64_*release.tar.gz</span></span> |
| <span data-ttu-id="39e5c-609">Oracle Enterprise Linux 6.4, 6.5 (solo 64 bit)</span><span class="sxs-lookup"><span data-stu-id="39e5c-609">Oracle Enterprise Linux 6.4, 6.5 (64 bit only)</span></span> |<span data-ttu-id="39e5c-610">Microsoft-ASR_UA_9.*.0.0_OL6-64_*release.tar.gz</span><span class="sxs-lookup"><span data-stu-id="39e5c-610">Microsoft-ASR_UA_9.*.0.0_OL6-64_*release.tar.gz</span></span> |

#### <a name="install-the-mobility-service-manually-on-a-windows-server"></a><span data-ttu-id="39e5c-611">Installare manualmente il servizio Mobility in un server Windows</span><span class="sxs-lookup"><span data-stu-id="39e5c-611">Install the Mobility service manually on a Windows server</span></span>
1. <span data-ttu-id="39e5c-612">Scaricare ed eseguire il relativo programma di installazione.</span><span class="sxs-lookup"><span data-stu-id="39e5c-612">Download and run the relevant installer.</span></span>
2. <span data-ttu-id="39e5c-613">In **Prima di iniziare** selezionare **Servizio Mobility**.</span><span class="sxs-lookup"><span data-stu-id="39e5c-613">In **Before you begin**, select **Mobility service**.</span></span>

    ![Installazione del servizio Mobility](./media/site-recovery-vmware-to-azure-classic/mobility3.png)
3. <span data-ttu-id="39e5c-615">In **Configuration Server Details** (Dettagli del server di configurazione) specificare l'indirizzo IP del server di gestione e la passphrase generata durante l'installazione dei componenti del server di gestione.</span><span class="sxs-lookup"><span data-stu-id="39e5c-615">In **Configuration Server Details**, specify the IP address of the management server and the passphrase that was generated when you installed the management server components.</span></span> <span data-ttu-id="39e5c-616">Per recuperare la passphrase eseguire **<SiteRecoveryInstallationFolder>\home\sysystems\bin\genpassphrase.exe –n** nel server di gestione.</span><span class="sxs-lookup"><span data-stu-id="39e5c-616">You can retrieve the passphrase by running **<SiteRecoveryInstallationFolder>\home\sysystems\bin\genpassphrase.exe –n** on the management server.</span></span>

    ![Servizio Mobility](./media/site-recovery-vmware-to-azure-classic/mobility6.png)
4. <span data-ttu-id="39e5c-618">In **Percorso di installazione** lasciare il percorso predefinito e fare clic su **Avanti** per avviare l'installazione.</span><span class="sxs-lookup"><span data-stu-id="39e5c-618">In **Install Location**, keep the default location and click **Next** to begin installation.</span></span>
5. <span data-ttu-id="39e5c-619">Monitorare lo stato dell'installazione in **Stato dell'installazione** e, se richiesto, riavviare la macchina.</span><span class="sxs-lookup"><span data-stu-id="39e5c-619">In **Installation Progress**, check installation and restart the machine if prompted.</span></span>

<span data-ttu-id="39e5c-620">È anche possibile eseguire l'installazione immettendo il testo seguente nella riga di comando:</span><span class="sxs-lookup"><span data-stu-id="39e5c-620">You can also install by entering the following text the command line:</span></span>

    UnifiedAgent.exe [/Role <Agent/MasterTarget>] [/InstallLocation <Installation Directory>] [/CSIP <IP address of CS to be registered with>] [/PassphraseFilePath <Passphrase file path>] [/LogFilePath <Log File Path>]

<span data-ttu-id="39e5c-621">Nel comando precedente:</span><span class="sxs-lookup"><span data-stu-id="39e5c-621">In the preceding command:</span></span>

* <span data-ttu-id="39e5c-622">/Role. Obbligatorio.</span><span class="sxs-lookup"><span data-stu-id="39e5c-622">/Role: Mandatory.</span></span> <span data-ttu-id="39e5c-623">Specifica se deve essere installato il servizio Mobility.</span><span class="sxs-lookup"><span data-stu-id="39e5c-623">Specifies whether the Mobility service should be installed.</span></span>
* <span data-ttu-id="39e5c-624">/InstallLocation. Obbligatorio.</span><span class="sxs-lookup"><span data-stu-id="39e5c-624">/InstallLocation: Mandatory.</span></span> <span data-ttu-id="39e5c-625">Specifica dove installare il servizio.</span><span class="sxs-lookup"><span data-stu-id="39e5c-625">Specifies where to install the service.</span></span>
* <span data-ttu-id="39e5c-626">/PassphraseFilePath. Obbligatorio.</span><span class="sxs-lookup"><span data-stu-id="39e5c-626">/PassphraseFilePath: Mandatory.</span></span> <span data-ttu-id="39e5c-627">Specifica la passphrase del server di configurazione.</span><span class="sxs-lookup"><span data-stu-id="39e5c-627">Specifies the configuration server passphrase.</span></span>
* <span data-ttu-id="39e5c-628">/LogFilePath. Obbligatorio.</span><span class="sxs-lookup"><span data-stu-id="39e5c-628">/LogFilePath: Mandatory.</span></span> <span data-ttu-id="39e5c-629">Specifica il percorso dei file di installazione dei log.</span><span class="sxs-lookup"><span data-stu-id="39e5c-629">Specifies the log setup file location.</span></span>

#### <a name="uninstall-the-mobility-service-manually"></a><span data-ttu-id="39e5c-630">Disinstallare manualmente il servizio Mobility</span><span class="sxs-lookup"><span data-stu-id="39e5c-630">Uninstall the Mobility service manually</span></span>
<span data-ttu-id="39e5c-631">È possibile disinstallare il servizio Mobility tramite **Disinstalla o modifica programma** nel Pannello di controllo o tramite la riga di comando.</span><span class="sxs-lookup"><span data-stu-id="39e5c-631">You can uninstall the Mobility service by using **Uninstall or change a program** in Control Panel, or by using the command line.</span></span>

<span data-ttu-id="39e5c-632">Il comando per disinstallare il servizio Mobility tramite la riga di comando è il seguente:</span><span class="sxs-lookup"><span data-stu-id="39e5c-632">The command to uninstall Mobility service by using the command line is:</span></span>

    MsiExec.exe /qn /x {275197FC-14FD-4560-A5EB-38217F80CBD1}

#### <a name="change-the-ip-address-of-the-management-server"></a><span data-ttu-id="39e5c-633">Modificare l'indirizzo IP del server di gestione</span><span class="sxs-lookup"><span data-stu-id="39e5c-633">Change the IP address of the management server</span></span>
<span data-ttu-id="39e5c-634">Dopo aver eseguito la procedura guidata è possibile modificare l'indirizzo IP del server di gestione, come indicato di seguito:</span><span class="sxs-lookup"><span data-stu-id="39e5c-634">After you run the wizard, you can change the IP address of the management server as follows:</span></span>

1. <span data-ttu-id="39e5c-635">Aprire il file hostconfig.exe (disponibile sul desktop).</span><span class="sxs-lookup"><span data-stu-id="39e5c-635">Open the file hostconfig.exe (located on the desktop).</span></span>
2. <span data-ttu-id="39e5c-636">Nella scheda **Globale** modificare l'indirizzo IP del server di gestione.</span><span class="sxs-lookup"><span data-stu-id="39e5c-636">On the **Global** tab, change the IP address of the management server.</span></span>

   > [!NOTE]
   > <span data-ttu-id="39e5c-637">Modificare solo l'indirizzo IP del server di gestione.</span><span class="sxs-lookup"><span data-stu-id="39e5c-637">Change only the IP address of the management server.</span></span> <span data-ttu-id="39e5c-638">Per le comunicazioni del server di gestione è necessario usare la porta 443 e l'opzione **Usa HTTPS** deve essere abilitata.</span><span class="sxs-lookup"><span data-stu-id="39e5c-638">The port number for management server communications must be 443, and **Use HTTPS** must be left enabled.</span></span> <span data-ttu-id="39e5c-639">Non modificare la passphrase.</span><span class="sxs-lookup"><span data-stu-id="39e5c-639">Do not change the passphrase.</span></span>
   >
   >

    ![Indirizzo IP del server di gestione](./media/site-recovery-vmware-to-azure-classic/host-config.png)

#### <a name="install-the-mobility-service-manually-on-a-linux-server"></a><span data-ttu-id="39e5c-641">Installare manualmente il servizio Mobility in un server Linux</span><span class="sxs-lookup"><span data-stu-id="39e5c-641">Install the Mobility service manually on a Linux server</span></span>
1. <span data-ttu-id="39e5c-642">Copiare l'archivio TAR appropriato nella macchina Linux da proteggere.</span><span class="sxs-lookup"><span data-stu-id="39e5c-642">Copy the appropriate tar archive to the Linux machine that you want to protect.</span></span> <span data-ttu-id="39e5c-643">Vedere la tabella in [Installare manualmente il servizio Mobility](#install-the-mobility-service-manually) per determinare l'archivio TAR da usare.</span><span class="sxs-lookup"><span data-stu-id="39e5c-643">See the table under [Install the Mobility service manually](#install-the-mobility-service-manually) to determine which tar archive you should use.</span></span>
2. <span data-ttu-id="39e5c-644">Aprire un programma shell ed estrarre l'archivio TAR compresso in un percorso locale eseguendo: `tar -xvzf Microsoft-ASR_UA_8.5.0.0*`</span><span class="sxs-lookup"><span data-stu-id="39e5c-644">Open a shell program and extract the zipped tar archive to a local path by running: `tar -xvzf Microsoft-ASR_UA_8.5.0.0*`</span></span>
3. <span data-ttu-id="39e5c-645">Creare un file denominato passphrase.txt nella directory locale in cui è stato estratto il contenuto dell'archivio TAR.</span><span class="sxs-lookup"><span data-stu-id="39e5c-645">Create a file named passphrase.txt in the local directory to which you extracted the contents of the tar archive.</span></span> <span data-ttu-id="39e5c-646">A tale scopo, copiare la passphrase da C:\ProgramData\Microsoft Azure Site Recovery\private\connection.passphrase nel server di gestione e salvarla nel file passphrase.txt eseguendo *`echo <passphrase> >passphrase.txt`* nella shell.</span><span class="sxs-lookup"><span data-stu-id="39e5c-646">To do this, copy the passphrase from C:\ProgramData\Microsoft Azure Site Recovery\private\connection.passphrase on the management server, and save it in passphrase.txt by running *`echo <passphrase> >passphrase.txt`* in the shell.</span></span>
4. <span data-ttu-id="39e5c-647">Installare il servizio Mobility immettendo il comando seguente: *`sudo ./install -t both -a host -R Agent -d /usr/local/ASR -i <IP address> -p <port> -s y -c https -P passphrase.txt`*</span><span class="sxs-lookup"><span data-stu-id="39e5c-647">Install the Mobility service by entering the following command: *`sudo ./install -t both -a host -R Agent -d /usr/local/ASR -i <IP address> -p <port> -s y -c https -P passphrase.txt`*</span></span>
5. <span data-ttu-id="39e5c-648">Specificare l'indirizzo IP interno del server di gestione e assicurarsi che la porta 443 sia selezionata.</span><span class="sxs-lookup"><span data-stu-id="39e5c-648">Specify the internal IP address of the management server, and make sure port 443 is selected.</span></span>

#### <a name="install-the-mobility-service-from-the-command-line"></a><span data-ttu-id="39e5c-649">Installare il servizio Mobility dalla riga di comando</span><span class="sxs-lookup"><span data-stu-id="39e5c-649">Install the Mobility service from the command line</span></span>

<span data-ttu-id="39e5c-650">Copiare la passphrase da C:\Program Files (x86)\InMage Systems\private\connection nel server di gestione e salvarla come "passphrase.txt" nel server di gestione.</span><span class="sxs-lookup"><span data-stu-id="39e5c-650">Copy the passphrase from C:\Program Files (x86)\InMage Systems\private\connection on the management server and save it as "passphrase.txt" on the management server.</span></span> <span data-ttu-id="39e5c-651">Quindi, eseguire i comandi seguenti:</span><span class="sxs-lookup"><span data-stu-id="39e5c-651">Then run the following commands.</span></span> <span data-ttu-id="39e5c-652">In questo esempio, l'indirizzo IP del server di gestione è 104.40.75.37 e la porta HTTPS è 443:</span><span class="sxs-lookup"><span data-stu-id="39e5c-652">In our example, the management server IP address is 104.40.75.37 and the HTTPS port is 443:</span></span>

<span data-ttu-id="39e5c-653">Per eseguire l'installazione in un server di produzione:</span><span class="sxs-lookup"><span data-stu-id="39e5c-653">To install on a production server:</span></span>

    ./install -t both -a host -R Agent -d /usr/local/ASR -i 104.40.75.37 -p 443 -s y -c https -P passphrase.txt

<span data-ttu-id="39e5c-654">Per eseguire l'installazione nel server di destinazione master:</span><span class="sxs-lookup"><span data-stu-id="39e5c-654">To install on the master target server:</span></span>

    ./install -t both -a host -R MasterTarget -d /usr/local/ASR -i 104.40.75.37 -p 443 -s y -c https -P passphrase.txt


## <a name="step-10-enable-protection-for-a-machine"></a><span data-ttu-id="39e5c-655">Passaggio 10: Abilitare la protezione per un computer</span><span class="sxs-lookup"><span data-stu-id="39e5c-655">Step 10: Enable protection for a machine</span></span>
<span data-ttu-id="39e5c-656">Per abilitare la protezione, aggiungere macchine virtuali e server fisici a un gruppo di protezione.</span><span class="sxs-lookup"><span data-stu-id="39e5c-656">To enable protection, add virtual machines and physical servers to a protection group.</span></span> <span data-ttu-id="39e5c-657">Prima di iniziare, tenere presente quanto segue per la protezione di macchine virtuali VMware:</span><span class="sxs-lookup"><span data-stu-id="39e5c-657">Before you start, note the following if you're protecting VMware virtual machines:</span></span>

* <span data-ttu-id="39e5c-658">Le macchine virtuali VMware vengono rilevate ogni 15 minuti e possono essere necessari più di 15 minuti perché vengano visualizzate nel portale di Site Recovery dopo l'individuazione.</span><span class="sxs-lookup"><span data-stu-id="39e5c-658">VMware VMs are discovered every 15 minutes, and it might take more than 15 minutes for them to appear in the Site Recovery portal after discovery.</span></span>
* <span data-ttu-id="39e5c-659">Anche per le modifiche dell'ambiente nella macchina virtuale (ad esempio, l'installazione degli strumenti VMware) possono essere necessari oltre 15 minuti per l'aggiornamento in Site Recovery.</span><span class="sxs-lookup"><span data-stu-id="39e5c-659">Environment changes on the virtual machine (such as VMware tools installation) might also take more than 15 minutes to be updated in Site Recovery.</span></span>
* <span data-ttu-id="39e5c-660">È possibile controllare l'ora dell'ultima individuazione di VM VMware nel campo **Ora ultimo contatto** per il server vCenter o l'host ESXi nella scheda **Server di configurazione**.</span><span class="sxs-lookup"><span data-stu-id="39e5c-660">You can check the last discovered time for VMware VMs in the **Last Contact At** field for the vCenter server/ESXi host on the **Configuration Servers** tab.</span></span>
* <span data-ttu-id="39e5c-661">Se si aggiunge un server vCenter o un host ESXi dopo aver creato un gruppo di protezione, possono essere necessari oltre 15 minuti per l'aggiornamento del portale di Azure Site Recovery e per la visualizzazione delle macchine virtuali nella finestra di dialogo per l'**aggiunta di macchine a un gruppo di protezione**.</span><span class="sxs-lookup"><span data-stu-id="39e5c-661">If you add a vCenter Server or ESXi host after creating a protection group, it might take more than 15 minutes for the Azure Site Recovery portal to refresh and for virtual machines to be listed in the **Add machines to a protection group** dialog box.</span></span>
* <span data-ttu-id="39e5c-662">Se si vuole procedere immediatamente con l'aggiunta di macchine al gruppo di protezione senza attendere l'individuazione pianificata, evidenziare il server di configurazione (senza fare clic su di esso) e fare clic sul pulsante **Aggiorna**.</span><span class="sxs-lookup"><span data-stu-id="39e5c-662">If you want to proceed immediately and add machines to a protection group without waiting for the scheduled discovery, highlight the configuration server (don’t click it) and click **Refresh**.</span></span>

<span data-ttu-id="39e5c-663">Eseguire anche queste operazioni:</span><span class="sxs-lookup"><span data-stu-id="39e5c-663">In addition:</span></span>

* <span data-ttu-id="39e5c-664">È consigliabile progettare i gruppi di protezione in modo che rispecchino i carichi di lavoro.</span><span class="sxs-lookup"><span data-stu-id="39e5c-664">We recommend that you architect your protection groups so that they mirror your workloads.</span></span> <span data-ttu-id="39e5c-665">Aggiungere ad esempio macchine che eseguono un'applicazione specifica nello stesso gruppo.</span><span class="sxs-lookup"><span data-stu-id="39e5c-665">For example, add machines that run a specific application to the same group.</span></span>
* <span data-ttu-id="39e5c-666">Quando si aggiungono computer a un gruppo di protezione, il server di elaborazione esegue automaticamente il push e l'installazione del servizio Mobility, se non è già installato.</span><span class="sxs-lookup"><span data-stu-id="39e5c-666">When you add machines to a protection group, the process server automatically pushes and installs the Mobility service if it isn't already installed.</span></span> <span data-ttu-id="39e5c-667">È necessario preparare il meccanismo di push come descritto nel passaggio precedente.</span><span class="sxs-lookup"><span data-stu-id="39e5c-667">You'll need to have the push mechanism prepared as described in the previous step.</span></span>

### <a name="add-machines-to-a-protection-group"></a><span data-ttu-id="39e5c-668">Aggiungere computer a un gruppo di protezione</span><span class="sxs-lookup"><span data-stu-id="39e5c-668">Add machines to a protection group</span></span>

1. <span data-ttu-id="39e5c-669">Passare a **Elementi protetti** > **Gruppo di protezione** > **Computer** > **Aggiungi computer**.</span><span class="sxs-lookup"><span data-stu-id="39e5c-669">Go to **Protected Items** > **Protection Group** > **Machines** > **Add Machines**.</span></span>
2. <span data-ttu-id="39e5c-670">Se si proteggono macchine virtuali VMware, in **Seleziona macchine virtuali** selezionare il server vCenter che gestisce le macchine virtuali (o l'host EXSi in cui sono in esecuzione) e quindi selezionare le macchine.</span><span class="sxs-lookup"><span data-stu-id="39e5c-670">If you're protecting VMware virtual machines, in **Select Virtual Machines**, select a vCenter server that's managing your virtual machines (or the EXSi host on which they're running), and then select the machines.</span></span>

    ![Abilitare la protezione per le macchine virtuali](./media/site-recovery-vmware-to-azure-classic/enable-protection2.png)
3. <span data-ttu-id="39e5c-672">Se si proteggono server fisici, in **Seleziona macchine virtuali** avviare la procedura guidata **Aggiungi computer fisici**, quindi specificare l'indirizzo IP e il nome descrittivo.</span><span class="sxs-lookup"><span data-stu-id="39e5c-672">If you're protecting physical servers, in **Select Virtual Machines**, open the **Add Physical Machines** wizard and provide the IP address and friendly name.</span></span> <span data-ttu-id="39e5c-673">Selezionare quindi la famiglia di sistemi operativi.</span><span class="sxs-lookup"><span data-stu-id="39e5c-673">Then select the operating system family.</span></span>

   ![Abilitare la protezione dei server fisici](./media/site-recovery-vmware-to-azure-classic/enable-protection1.png)
4. <span data-ttu-id="39e5c-675">In **Specificare le risorse di destinazione** selezionare l'account di archiviazione da usare per la replica e indicare se le impostazioni devono essere usate per tutti i carichi di lavoro.</span><span class="sxs-lookup"><span data-stu-id="39e5c-675">In **Specify Target Resources**, select the storage account that you're using for replication and select whether the settings should be used for all workloads.</span></span> <span data-ttu-id="39e5c-676">Gli account di archiviazione Premium non sono attualmente supportati.</span><span class="sxs-lookup"><span data-stu-id="39e5c-676">Premium storage accounts aren't currently supported.</span></span>

   > [!NOTE]
   > <span data-ttu-id="39e5c-677">Lo spostamento degli account di archiviazione creati con il [portale di Azure](../storage/storage-create-storage-account.md) tra gruppi di risorse non è supportato.</span><span class="sxs-lookup"><span data-stu-id="39e5c-677">We do not support moving storage accounts created by using the [Azure portal](../storage/storage-create-storage-account.md) across resource groups.</span></span>                           
   > <span data-ttu-id="39e5c-678">[La migrazione degli account di archiviazione](../azure-resource-manager/resource-group-move-resources.md) all'interno dei gruppi di risorse con la stessa sottoscrizione o all'interno delle sottoscrizioni non è supportata per gli account di archiviazione usati per la distribuzione di Site Recovery.</span><span class="sxs-lookup"><span data-stu-id="39e5c-678">[Migration of storage accounts](../azure-resource-manager/resource-group-move-resources.md) across resource groups within the same subscription or across subscriptions is not supported for storage accounts used for deploying Site Recovery.</span></span>
   >
   >

    ![Configurare le impostazioni di destinazione](./media/site-recovery-vmware-to-azure-classic/enable-protection3.png)
5. <span data-ttu-id="39e5c-680">In **Specificare gli account** selezionare l'account [configurato](#install-the-mobility-service-with-push-installation) per l'installazione automatica del servizio Mobility.</span><span class="sxs-lookup"><span data-stu-id="39e5c-680">In **Specify Accounts**, select the account that you [set up](#install-the-mobility-service-with-push-installation) to use for automatic installation of the Mobility service.</span></span>

    ![Specificare gli account](./media/site-recovery-vmware-to-azure-classic/enable-protection4.png)
6. <span data-ttu-id="39e5c-682">Fare clic sul segno di spunta per completare l'aggiunta dei computer al gruppo di protezione e avviare la replica iniziale per ogni computer.</span><span class="sxs-lookup"><span data-stu-id="39e5c-682">Click the check mark to finish adding machines to the protection group and to start initial replication for each machine.</span></span>

   > [!NOTE]
   > <span data-ttu-id="39e5c-683">Se l'installazione push è stata preparata, il servizio Mobility viene installato automaticamente nelle macchine in cui non è presente man mano che questi vengono aggiunti al gruppo di protezione.</span><span class="sxs-lookup"><span data-stu-id="39e5c-683">If push installation has been prepared, the Mobility service is automatically installed on machines that don't have it as they're added to the protection group.</span></span> <span data-ttu-id="39e5c-684">Dopo l'installazione del servizio viene avviato un processo di protezione che avrà esito negativo.</span><span class="sxs-lookup"><span data-stu-id="39e5c-684">After the service is installed, a protection job starts and fails.</span></span> <span data-ttu-id="39e5c-685">Dopo l'errore è necessario riavviare manualmente ogni macchina in cui è stato installato il servizio Mobility.</span><span class="sxs-lookup"><span data-stu-id="39e5c-685">After the failure, you'll need to manually restart each machine that's had the Mobility service installed.</span></span> <span data-ttu-id="39e5c-686">Dopo il riavvio, il processo di protezione viene avviato nuovamente e viene eseguita la replica iniziale.</span><span class="sxs-lookup"><span data-stu-id="39e5c-686">After the restart, the protection job begins again and initial replication occurs.</span></span>
   >
   >

<span data-ttu-id="39e5c-687">Lo stato può essere monitorato nella pagina **Processi** .</span><span class="sxs-lookup"><span data-stu-id="39e5c-687">You can monitor status on the **Jobs** page.</span></span>

![Monitorare lo stato nella pagina Processi](./media/site-recovery-vmware-to-azure-classic/enable-protection5.png)

<span data-ttu-id="39e5c-689">È possibile monitorare lo stato di protezione anche in **Elementi protetti** > *nome gruppo di protezione* > **Macchine virtuali**.</span><span class="sxs-lookup"><span data-stu-id="39e5c-689">Protection status can also be monitored in **Protected Items** > *protection group name* > **Virtual Machines**.</span></span> <span data-ttu-id="39e5c-690">Al termine della replica iniziale, quando i dati sono sincronizzati, lo stato della macchina passa a  **Protetto**.</span><span class="sxs-lookup"><span data-stu-id="39e5c-690">After initial replication finishes and data is synchronized, machine status changes to **Protected**.</span></span>

![Monitorare lo stato in Elementi protetti](./media/site-recovery-vmware-to-azure-classic/enable-protection6.png)

## <a name="step-11-set-protected-machine-properties"></a><span data-ttu-id="39e5c-692">Passaggio 11: Impostare le proprietà dei computer protetti</span><span class="sxs-lookup"><span data-stu-id="39e5c-692">Step 11: Set protected machine properties</span></span>
1. <span data-ttu-id="39e5c-693">Quando lo stato della macchina è **Protetto**, è possibile configurarne le proprietà di failover.</span><span class="sxs-lookup"><span data-stu-id="39e5c-693">After a machine has a **Protected** status, you can configure its failover properties.</span></span> <span data-ttu-id="39e5c-694">Nei dettagli del gruppo di protezione selezionare la macchina e aprire la scheda **Configura**.</span><span class="sxs-lookup"><span data-stu-id="39e5c-694">In the protection group details, select the machine and open the **Configure** tab.</span></span>
2. <span data-ttu-id="39e5c-695">Site Recovery suggerisce automaticamente le proprietà per la macchina virtuale di Azure e rileva le impostazioni della rete locale.</span><span class="sxs-lookup"><span data-stu-id="39e5c-695">Site Recovery automatically suggests properties for the Azure VM and detects the on-premises network settings.</span></span>

    ![Impostare le proprietà di una macchina virtuale](./media/site-recovery-vmware-to-azure-classic/vm-properties1.png)
3. <span data-ttu-id="39e5c-697">È possibile modificare queste impostazioni:</span><span class="sxs-lookup"><span data-stu-id="39e5c-697">You can change these settings:</span></span>

   * <span data-ttu-id="39e5c-698">**Nome della VM di Azure**: il nome assegnato al computer in Azure dopo il failover.</span><span class="sxs-lookup"><span data-stu-id="39e5c-698">**Azure VM name**: This is the name that will be given to the machine in Azure after failover.</span></span> <span data-ttu-id="39e5c-699">Il nome deve essere conforme ai requisiti di Azure.</span><span class="sxs-lookup"><span data-stu-id="39e5c-699">The name must comply with Azure requirements.</span></span>
   * <span data-ttu-id="39e5c-700">**Dimensioni della VM di Azure**: il numero di schede di rete dipende dalle dimensioni specificate per la macchina virtuale di destinazione.</span><span class="sxs-lookup"><span data-stu-id="39e5c-700">**Azure VM size**: The number of network adapters is dictated by the size that you specify for the target virtual machine.</span></span> <span data-ttu-id="39e5c-701">Per altre informazioni sulle dimensioni, vedere le [tabelle delle dimensioni](../virtual-machines/linux/sizes.md).</span><span class="sxs-lookup"><span data-stu-id="39e5c-701">For more information about sizes and adapters, see the [size tables](../virtual-machines/linux/sizes.md).</span></span> <span data-ttu-id="39e5c-702">Si noti che:</span><span class="sxs-lookup"><span data-stu-id="39e5c-702">Note that:</span></span>

     * <span data-ttu-id="39e5c-703">Quando si modificano le dimensioni di una macchina virtuale e si salvano le impostazioni, il numero di schede di rete cambia alla successiva apertura della scheda **Configura**.</span><span class="sxs-lookup"><span data-stu-id="39e5c-703">When you modify the size of a virtual machine and save the settings, the number of network adapters will change when you open the **Configure** tab the next time.</span></span> <span data-ttu-id="39e5c-704">Il numero minimo di schede di rete nelle macchine virtuali di destinazione è uguale al numero minimo di schede di rete in una macchina virtuale di origine.</span><span class="sxs-lookup"><span data-stu-id="39e5c-704">The minimum number of network adapters on target virtual machines is equal to the minimum number of network adapters on a source virtual machine.</span></span> <span data-ttu-id="39e5c-705">Il numero massimo di schede di rete dipende dalle dimensioni della macchina virtuale.</span><span class="sxs-lookup"><span data-stu-id="39e5c-705">The maximum number of network adapters is determined by the size of the virtual machine.</span></span>
       * <span data-ttu-id="39e5c-706">Se il numero di schede di rete nella macchina di origine è minore o uguale al numero di schede consentite per le dimensioni della macchina di destinazione, la destinazione avrà lo stesso numero di schede dell'origine.</span><span class="sxs-lookup"><span data-stu-id="39e5c-706">If the number of network adapters on the source machine is less than or equal to the number of adapters allowed for the target machine size, the target will have the same number of adapters as the source.</span></span>
       * <span data-ttu-id="39e5c-707">Se il numero di schede per la macchina virtuale di origine supera il numero consentito per le dimensioni di destinazione, verrà usata la dimensione di destinazione massima.</span><span class="sxs-lookup"><span data-stu-id="39e5c-707">If the number of adapters for the source virtual machine exceeds the number allowed for the target size, the target size maximum will be used.</span></span>
        <span data-ttu-id="39e5c-708">Ad esempio, se una macchina di origine ha due schede di rete e le dimensioni della macchina di destinazione ne supportano quattro, la macchina di destinazione avrà due schede.</span><span class="sxs-lookup"><span data-stu-id="39e5c-708">For example, if a source machine has two network adapters and the target machine size supports four, the target machine will have two adapters.</span></span> <span data-ttu-id="39e5c-709">Se la macchina di origine ha due schede, ma le dimensioni di destinazione supportate ne consentono solo una, la macchina di destinazione avrà una sola scheda.</span><span class="sxs-lookup"><span data-stu-id="39e5c-709">If the source machine has two adapters but the supported target size supports only one, the target machine will have only one adapter.</span></span>
     * <span data-ttu-id="39e5c-710">Se la macchina virtuale ha più schede di rete, tutte le schede devono essere connesse alla stessa rete di Azure.</span><span class="sxs-lookup"><span data-stu-id="39e5c-710">If the virtual machine has multiple network adapters, all adapters should be connected to the same Azure network.</span></span>
   * <span data-ttu-id="39e5c-711">**Rete di Azure**: è necessario specificare una rete di Azure a cui le VM di Azure verranno connesse dopo il failover.</span><span class="sxs-lookup"><span data-stu-id="39e5c-711">**Azure network**: You must specify an Azure network that Azure VMs will be connected to after failover.</span></span> <span data-ttu-id="39e5c-712">In caso contrario, le macchine virtuali di Azure non verranno connesse ad alcuna rete.</span><span class="sxs-lookup"><span data-stu-id="39e5c-712">If you don't specify one, the Azure VMs won't be connected to any network.</span></span> <span data-ttu-id="39e5c-713">È anche necessario specificare una rete di Azure per eseguire il failback da Azure al sito locale.</span><span class="sxs-lookup"><span data-stu-id="39e5c-713">In addition, you need to specify an Azure network if you want to failback from Azure to the on-premises site.</span></span> <span data-ttu-id="39e5c-714">Il failback richiede una connessione VPN tra una rete di Azure e una rete locale.</span><span class="sxs-lookup"><span data-stu-id="39e5c-714">Failback requires a VPN connection between an Azure network and an on-premises network.</span></span>
   * <span data-ttu-id="39e5c-715">**Indirizzo IP/subnet di Azure**: per ogni scheda di rete selezionare la subnet a cui deve connettersi la VM di Azure.</span><span class="sxs-lookup"><span data-stu-id="39e5c-715">**Azure IP address/subnet**: For each network adapter, select the subnet to which the Azure VM should connect.</span></span> <span data-ttu-id="39e5c-716">Si noti che se la scheda di rete della macchina di origine è configurata per l'uso di un indirizzo IP statico, è possibile specificare un indirizzo IP statico per la macchina virtuale di Azure.</span><span class="sxs-lookup"><span data-stu-id="39e5c-716">Note that if the network adapter of the source machine is configured to use a static IP address, you can specify a static IP address for the Azure VM.</span></span> <span data-ttu-id="39e5c-717">Se non si specifica un indirizzo IP statico verrà allocato un indirizzo IP disponibile.</span><span class="sxs-lookup"><span data-stu-id="39e5c-717">If you don't provide a static IP address, then any available IP address will be allocated.</span></span> <span data-ttu-id="39e5c-718">Se viene specificato un indirizzo IP di destinazione già usato da un'altra macchina virtuale in Azure, il failover avrà esito negativo.</span><span class="sxs-lookup"><span data-stu-id="39e5c-718">If the target IP address is specified but it's already in use by another VM in Azure, failover will fail.</span></span> <span data-ttu-id="39e5c-719">Se la scheda di rete della macchina di origine è configurata per l'uso del protocollo DHCP, l'impostazione per Azure sarà DHCP.</span><span class="sxs-lookup"><span data-stu-id="39e5c-719">If the network adapter of the source machine is configured to use DHCP, you'll have DHCP as the setting for Azure.</span></span>      

## <a name="step-12-create-a-recovery-plan-and-run-a-failover"></a><span data-ttu-id="39e5c-720">Passaggio 12: Creare un piano di ripristino ed eseguire un failover</span><span class="sxs-lookup"><span data-stu-id="39e5c-720">Step 12: Create a recovery plan and run a failover</span></span>
> [!VIDEO https://channel9.msdn.com/Blogs/Azure/Enhanced-VMware-to-Azure-Failover/player]
>
>

<span data-ttu-id="39e5c-721">È possibile eseguire il failover per una singola macchina o il failover di più macchine virtuali che eseguono la stessa attività o lo stesso carico di lavoro.</span><span class="sxs-lookup"><span data-stu-id="39e5c-721">You can run a failover for a single machine, or you can fail over multiple virtual machines that perform the same task or run the same workload.</span></span> <span data-ttu-id="39e5c-722">Per eseguire il failover di più macchine contemporaneamente è necessario aggiungerle a un piano di ripristino.</span><span class="sxs-lookup"><span data-stu-id="39e5c-722">To fail over multiple machines at the same time, you add them to a recovery plan.</span></span>

<span data-ttu-id="39e5c-723">Per creare un piano di ripristino:</span><span class="sxs-lookup"><span data-stu-id="39e5c-723">To create a recovery plan:</span></span>

1. <span data-ttu-id="39e5c-724">Nella pagina **Piani di ripristino** fare clic su **Crea piano di ripristino** per aggiungere un piano di ripristino.</span><span class="sxs-lookup"><span data-stu-id="39e5c-724">On the **Recovery Plans** page, click **Add Recovery Plan** and add a recovery plan.</span></span> <span data-ttu-id="39e5c-725">Specificare i dettagli per il piano e selezionare **Azure** come destinazione.</span><span class="sxs-lookup"><span data-stu-id="39e5c-725">Specify details for the plan and select **Azure** as the target.</span></span>

 ![Configurare un piano di ripristino](./media/site-recovery-vmware-to-azure-classic/recovery-plan1.png)
2. <span data-ttu-id="39e5c-727">In **Seleziona macchine virtuali** selezionare un gruppo di protezione e quindi le macchine nel gruppo da aggiungere al piano di ripristino.</span><span class="sxs-lookup"><span data-stu-id="39e5c-727">In **Select Virtual Machine**, select a protection group, and then select machines in the group to add to the recovery plan.</span></span>

 ![Aggiungi macchine virtuali.](./media/site-recovery-vmware-to-azure-classic/recovery-plan2.png)

<span data-ttu-id="39e5c-729">È possibile personalizzare il piano per creare gruppi e una sequenza dell'ordine in cui verrà eseguito il failover dei computer nel piano di ripristino.</span><span class="sxs-lookup"><span data-stu-id="39e5c-729">You can customize the plan to create groups and sequence the order in which machines in the recovery plan are failed over.</span></span> <span data-ttu-id="39e5c-730">È anche possibile aggiungere script e istruzioni per azioni manuali.</span><span class="sxs-lookup"><span data-stu-id="39e5c-730">You can also add scripts and prompts for manual actions.</span></span> <span data-ttu-id="39e5c-731">Gli script possono essere creati manualmente o usando i [runbook di Automazione di Azure](site-recovery-runbook-automation.md).</span><span class="sxs-lookup"><span data-stu-id="39e5c-731">Scripts can be created manually or by using [Azure Automation Runbooks](site-recovery-runbook-automation.md).</span></span> <span data-ttu-id="39e5c-732">Per altre informazioni sulla personalizzazione dei piani di ripristino, vedere [Creare piani di ripristino](site-recovery-create-recovery-plans.md).</span><span class="sxs-lookup"><span data-stu-id="39e5c-732">For more information about customizing recovery plans, see [Create recovery plans](site-recovery-create-recovery-plans.md).</span></span>

## <a name="run-a-failover"></a><span data-ttu-id="39e5c-733">Eseguire un failover</span><span class="sxs-lookup"><span data-stu-id="39e5c-733">Run a failover</span></span>
<span data-ttu-id="39e5c-734">Prima di eseguire un failover:</span><span class="sxs-lookup"><span data-stu-id="39e5c-734">Before you run a failover:</span></span>

* <span data-ttu-id="39e5c-735">Assicurarsi che il server di gestione sia in esecuzione e disponibile.</span><span class="sxs-lookup"><span data-stu-id="39e5c-735">Make sure that the management server is running and available.</span></span> <span data-ttu-id="39e5c-736">In caso contrario, il failover avrà esito negativo.</span><span class="sxs-lookup"><span data-stu-id="39e5c-736">If it is not, failover will fail.</span></span>
* <span data-ttu-id="39e5c-737">Se si esegue un failover non pianificato:</span><span class="sxs-lookup"><span data-stu-id="39e5c-737">If you run an unplanned failover:</span></span>

  * <span data-ttu-id="39e5c-738">È consigliabile arrestare le macchine primarie prima di eseguire un failover non pianificato.</span><span class="sxs-lookup"><span data-stu-id="39e5c-738">If possible, you should shut down primary machines before you run an unplanned failover.</span></span> <span data-ttu-id="39e5c-739">Questo permette di evitare che il computer di origine e quello di replica siano in esecuzione nello stesso momento.</span><span class="sxs-lookup"><span data-stu-id="39e5c-739">This ensures that you don't have both the source and replica machines running at the same time.</span></span> <span data-ttu-id="39e5c-740">Se si esegue la replica di macchine virtuali VMware, quando si esegue un failover non pianificato è possibile specificare che Site Recovery debba provare ad arrestare le macchine di origine.</span><span class="sxs-lookup"><span data-stu-id="39e5c-740">If you're replicating VMware VMs when you run an unplanned failover, you can specify that Site Recovery should try to shut down the source machines.</span></span> <span data-ttu-id="39e5c-741">L'esito positivo di questa operazione dipende dallo stato del sito primario.</span><span class="sxs-lookup"><span data-stu-id="39e5c-741">Depending on the state of the primary site, this might or might not work.</span></span> <span data-ttu-id="39e5c-742">Per la replica di server fisici questa opzione non è disponibile.</span><span class="sxs-lookup"><span data-stu-id="39e5c-742">If you're replicating physical servers, Site Recovery doesn't offer this option.</span></span>
  * <span data-ttu-id="39e5c-743">Un failover non pianificato arresta la replica dei dati dalle macchine primarie per evitare il trasferimento di dati differenziali a failover iniziato.</span><span class="sxs-lookup"><span data-stu-id="39e5c-743">An unplanned failover stops data replication from primary machines so that any data delta won't be transferred after an unplanned failover begins.</span></span>
  * <span data-ttu-id="39e5c-744">Per connettersi alla macchina virtuale di replica in Azure dopo il failover, abilitare Connessione Desktop remoto nella macchina di origine prima di eseguire il failover.</span><span class="sxs-lookup"><span data-stu-id="39e5c-744">If you want to connect to the replica virtual machine in Azure after failover, enable Remote Desktop Connection on the source machine before you run the failover.</span></span> <span data-ttu-id="39e5c-745">Consentire quindi la connessione RDP attraverso il firewall.</span><span class="sxs-lookup"><span data-stu-id="39e5c-745">Then allow RDP connection through the firewall.</span></span> <span data-ttu-id="39e5c-746">È anche necessario consentire il protocollo RDP nell'endpoint pubblico della macchina virtuale di Azure dopo il failover.</span><span class="sxs-lookup"><span data-stu-id="39e5c-746">You'll also need to allow RDP on the public endpoint of the Azure virtual machine after failover.</span></span> <span data-ttu-id="39e5c-747">Per garantire il funzionamento del protocollo RDP dopo un failover, seguire le [procedure consigliate](http://social.technet.microsoft.com/wiki/contents/articles/31666.troubleshooting-remote-desktop-connection-after-failover-using-asr.aspx).</span><span class="sxs-lookup"><span data-stu-id="39e5c-747">Follow [best practices](http://social.technet.microsoft.com/wiki/contents/articles/31666.troubleshooting-remote-desktop-connection-after-failover-using-asr.aspx) to ensure that RDP works after a failover.</span></span>

> [!NOTE]
> <span data-ttu-id="39e5c-748">Per ottenere prestazioni ottimali quando si esegue un failover in Azure, assicurarsi di aver installato l'agente di Azure nella macchina protetta.</span><span class="sxs-lookup"><span data-stu-id="39e5c-748">To get the best performance when you do a failover to Azure, ensure that you have installed the Azure Agent on the protected machine.</span></span> <span data-ttu-id="39e5c-749">Ciò consente l'avvio più rapido della macchina e contribuisce a diagnosticare i problemi.</span><span class="sxs-lookup"><span data-stu-id="39e5c-749">This helps the machine boot faster and helps diagnose issues.</span></span> <span data-ttu-id="39e5c-750">L'agente di Azure è disponibile per [Linux](https://github.com/Azure/WALinuxAgent) e [Windows](http://go.microsoft.com/fwlink/?LinkID=394789).</span><span class="sxs-lookup"><span data-stu-id="39e5c-750">The Azure Agent is available for [Linux](https://github.com/Azure/WALinuxAgent) and [Windows](http://go.microsoft.com/fwlink/?LinkID=394789).</span></span>
>
>

### <a name="run-a-test-failover"></a><span data-ttu-id="39e5c-751">Eseguire un failover di test</span><span class="sxs-lookup"><span data-stu-id="39e5c-751">Run a test failover</span></span>
<span data-ttu-id="39e5c-752">Eseguire un failover di test per simulare i processi di failover e ripristino in una rete isolata che non influisce sull'ambiente di produzione, in modo che la replica continui normalmente.</span><span class="sxs-lookup"><span data-stu-id="39e5c-752">Run a test failover to simulate your failover and recovery processes in an isolated network that doesn't affect your production environment and lets regular replication continue as normal.</span></span> <span data-ttu-id="39e5c-753">Il failover di test viene avviato nell'origine e può essere eseguito in due modi:</span><span class="sxs-lookup"><span data-stu-id="39e5c-753">Test failover is initiatd on the source, and you can run it in a couple of ways:</span></span>

* <span data-ttu-id="39e5c-754">**Senza una rete di Azure**: se si esegue un failover di test senza specificare una rete, il test verifica l'avvio e la corretta visualizzazione delle macchine virtuali in Azure.</span><span class="sxs-lookup"><span data-stu-id="39e5c-754">**Don't specify an Azure network**: If you run a test failover without a network, the test will check that virtual machines start and appear correctly in Azure.</span></span> <span data-ttu-id="39e5c-755">Le macchine virtuali non vengono connesse a una rete di Azure dopo il failover.</span><span class="sxs-lookup"><span data-stu-id="39e5c-755">Virtual machines won’t be connected to an Azure network after failover.</span></span>
* <span data-ttu-id="39e5c-756">**Con una rete di Azure**: questo tipo di failover verifica che l'intero ambiente di replica venga rilevato come previsto e che le macchine virtuali di Azure siano connesse alla rete specificata.</span><span class="sxs-lookup"><span data-stu-id="39e5c-756">**Specify an Azure network**: This type of failover checks that the entire replication environment comes up as expected and that Azure virtual machines are connected to the specified network.</span></span>

<span data-ttu-id="39e5c-757">Per eseguire un failover di test:</span><span class="sxs-lookup"><span data-stu-id="39e5c-757">To run a test failover:</span></span>

1. <span data-ttu-id="39e5c-758">Nella pagina **Piani di ripristino** selezionare il piano e fare clic su **Failover di test**.</span><span class="sxs-lookup"><span data-stu-id="39e5c-758">On the **Recovery Plans** page, select the plan and click **Test Failover**.</span></span>

 ![Selezionare il piano](./media/site-recovery-vmware-to-azure-classic/test-failover1.png)
2. <span data-ttu-id="39e5c-760">In **Conferma failover di test** selezionare **Nessuna** per scegliere di non usare una rete di Azure per il failover di test oppure selezionare la rete a cui connettere le VM di test dopo il failover.</span><span class="sxs-lookup"><span data-stu-id="39e5c-760">In **Confirm Test Failover**, select **None** to indicate that you don't want to use an Azure network for the test failover, or select the network to which the test VMs will be connected after failover.</span></span> <span data-ttu-id="39e5c-761">Fare clic sul segno di spunta per avviare il failover.</span><span class="sxs-lookup"><span data-stu-id="39e5c-761">Click the check mark to start the failover.</span></span>

 ![Effettuare una selezione](./media/site-recovery-vmware-to-azure-classic/test-failover2.png)
3. <span data-ttu-id="39e5c-763">Monitorare lo stato di avanzamento del failover nella scheda **Processi** .</span><span class="sxs-lookup"><span data-stu-id="39e5c-763">Monitor failover progress on the **Jobs** tab.</span></span>

 ![Monitorare lo stato](./media/site-recovery-vmware-to-azure-classic/test-failover3.png)
4. <span data-ttu-id="39e5c-765">Al termine del failover sarà anche possibile visualizzare la macchina virtuale di Azure di replica in **Macchine virtuali** nel portale di Azure.</span><span class="sxs-lookup"><span data-stu-id="39e5c-765">After the failover finishes, you should also be able to see the replica Azure machine appear in **Virtual Machines** in the Azure portal.</span></span> <span data-ttu-id="39e5c-766">Per avviare una connessione RDP alla macchina virtuale di Azure è necessario aprire la porta 3389 nell'endpoint della macchina virtuale.</span><span class="sxs-lookup"><span data-stu-id="39e5c-766">If you want to initiate an RDP connection to the Azure VM, you’ll need to open port 3389 on the VM endpoint.</span></span>
5. <span data-ttu-id="39e5c-767">Quando il processo di failover raggiunge la fase **conclusiva** del test, fare clic su **Completa test** per terminare il test.</span><span class="sxs-lookup"><span data-stu-id="39e5c-767">After you’ve finished, when failover reaches the **Complete** testing phase, click **Complete Test** to finish.</span></span> <span data-ttu-id="39e5c-768">Fare clic su **Note** per registrare e salvare eventuali osservazioni associate al failover di test.</span><span class="sxs-lookup"><span data-stu-id="39e5c-768">In **Notes**, record and save any observations associated with the test failover.</span></span>
6. <span data-ttu-id="39e5c-769">Fare clic su **Failover di test completato** per pulire automaticamente l'ambiente di test.</span><span class="sxs-lookup"><span data-stu-id="39e5c-769">Click **The test failover is complete** to automatically clean up the test environment.</span></span> <span data-ttu-id="39e5c-770">Al termine, lo stato del failover di test indicherà che l'operazione è **completata**.</span><span class="sxs-lookup"><span data-stu-id="39e5c-770">After this is done, the test failover will show a **Complete** status.</span></span> <span data-ttu-id="39e5c-771">Eventuali elementi o macchine virtuali create automaticamente durante il failover di test verranno eliminate.</span><span class="sxs-lookup"><span data-stu-id="39e5c-771">Any elements or VMs created automatically during the test failover are deleted.</span></span> <span data-ttu-id="39e5c-772">Se un failover di test continua per più di due settimane, ne viene forzato il completamento.</span><span class="sxs-lookup"><span data-stu-id="39e5c-772">If a test failover continues longer than two weeks, it’s forced to finish.</span></span>

### <a name="run-an-unplanned-failover"></a><span data-ttu-id="39e5c-773">Eseguire un failover non pianificato</span><span class="sxs-lookup"><span data-stu-id="39e5c-773">Run an unplanned failover</span></span>
<span data-ttu-id="39e5c-774">Il failover non pianificato viene avviato da Azure e può essere eseguito anche se il sito primario non è disponibile.</span><span class="sxs-lookup"><span data-stu-id="39e5c-774">Unplanned failover is initiated from Azure and can be performed even if the primary site isn't available.</span></span>

1. <span data-ttu-id="39e5c-775">Nella pagina **Piani di ripristino** selezionare il piano e fare clic su **Failover** > **Failover non pianificato**.</span><span class="sxs-lookup"><span data-stu-id="39e5c-775">On the **Recovery Plans** page, select the plan and click **Failover** > **Unplanned Failover**.</span></span>

 ![Selezionare il piano](./media/site-recovery-vmware-to-azure-classic/unplanned-failover1.png)
2. <span data-ttu-id="39e5c-777">Se si esegue la replica di macchine virtuali VMware è possibile provare ad arrestare le macchine virtuali locali.</span><span class="sxs-lookup"><span data-stu-id="39e5c-777">If you're replicating VMware virtual machines, you can try to shut down on-premises VMs.</span></span> <span data-ttu-id="39e5c-778">Il failover continua indipendentemente dall'esito di questo tentativo.</span><span class="sxs-lookup"><span data-stu-id="39e5c-778">This is a best-effort action, and failover continues whether the effort succeeds or not.</span></span> <span data-ttu-id="39e5c-779">In caso di esito negativo, i dettagli dell'errore vengono visualizzati nella scheda **Processi** in **Unplanned Failover Jobs** (Processi di failover non pianificati).</span><span class="sxs-lookup"><span data-stu-id="39e5c-779">If it doesn't succeed, error details will appear on the **Jobs** tab under **Unplanned Failover Jobs**.</span></span>

 ![Opzione per l'arresto delle macchine virtuali in locale](./media/site-recovery-vmware-to-azure-classic/unplanned-failover2.png)

 > [!NOTE]
 > <span data-ttu-id="39e5c-781">Questa opzione non è disponibile se si esegue la replica di server fisici.</span><span class="sxs-lookup"><span data-stu-id="39e5c-781">This option isn't available if you're replicating physical servers.</span></span> <span data-ttu-id="39e5c-782">Se possibile, è necessario provare ad arrestare le macchine manualmente.</span><span class="sxs-lookup"><span data-stu-id="39e5c-782">You'll need to try to shut those down manually if possible.</span></span>
 >
 >

3. <span data-ttu-id="39e5c-783">In **Conferma failover** verificare la direzione del failover in Azure e selezionare il punto di ripristino da usare per il failover.</span><span class="sxs-lookup"><span data-stu-id="39e5c-783">In **Confirm Failover**, verify the failover direction (to Azure) and select the recovery point that you want to use for the failover.</span></span> <span data-ttu-id="39e5c-784">Se nella configurazione delle proprietà di replica sono state abilitate più macchine virtuali, è possibile ripristinare fino all'ultimo punto di ripristino dell'applicazione o coerente con l'arresto anomalo del sistema.</span><span class="sxs-lookup"><span data-stu-id="39e5c-784">If you enabled multi-VM when you configured replication properties, you can recover to the latest application or crash-consistent recovery point.</span></span> <span data-ttu-id="39e5c-785">È anche possibile selezionare **Punto di ripristino personalizzato** per eseguire il ripristino a un punto precedente nel tempo.</span><span class="sxs-lookup"><span data-stu-id="39e5c-785">You can also select **Custom recovery point** to recover to an earlier point in time.</span></span> <span data-ttu-id="39e5c-786">Fare clic sul segno di spunta per avviare il failover.</span><span class="sxs-lookup"><span data-stu-id="39e5c-786">Click the check mark to start the failover.</span></span>

 ![Confermare la direzione del failover](./media/site-recovery-vmware-to-azure-classic/unplanned-failover3.png)
4. <span data-ttu-id="39e5c-788">Attendere il completamento del processo di failover non pianificato.</span><span class="sxs-lookup"><span data-stu-id="39e5c-788">Wait for the unplanned failover job to finish.</span></span> <span data-ttu-id="39e5c-789">È possibile monitorare lo stato di avanzamento del failover nella scheda **Processi** .</span><span class="sxs-lookup"><span data-stu-id="39e5c-789">You can monitor failover progress on the **Jobs** tab.</span></span> <span data-ttu-id="39e5c-790">Anche se si verificano errori durante un failover non pianificato, il piano di ripristino viene eseguito fino al completamento.</span><span class="sxs-lookup"><span data-stu-id="39e5c-790">Even if errors occur during unplanned failover, the recovery plan runs until it's complete.</span></span> <span data-ttu-id="39e5c-791">Al termine del failover sarà possibile visualizzare la macchina di Azure di replica in **Macchine virtuali** nel portale di Azure.</span><span class="sxs-lookup"><span data-stu-id="39e5c-791">You should also be able to see the replica Azure machine appear in **Virtual Machines** in the Azure portal.</span></span>

### <a name="connect-to-replicated-azure-virtual-machines-after-failover"></a><span data-ttu-id="39e5c-792">Connettersi a macchine virtuali di Azure replicate dopo il failover</span><span class="sxs-lookup"><span data-stu-id="39e5c-792">Connect to replicated Azure virtual machines after failover</span></span>
<span data-ttu-id="39e5c-793">Per connettersi alle macchine virtuali replicate in Azure dopo il failover, è necessario quanto segue:</span><span class="sxs-lookup"><span data-stu-id="39e5c-793">To connect to replicated virtual machines in Azure after failover, you need:</span></span>

- <span data-ttu-id="39e5c-794">Una connessione Desktop remoto abilitata nella macchina primaria.</span><span class="sxs-lookup"><span data-stu-id="39e5c-794">A Remote Desktop connection enabled on the primary machine.</span></span>
- <span data-ttu-id="39e5c-795">Windows Firewall nella macchina primaria impostato in modo da consentire il protocollo RDP.</span><span class="sxs-lookup"><span data-stu-id="39e5c-795">Windows Firewall on the primary machine set to allow RDP.</span></span>
- <span data-ttu-id="39e5c-796">Protocollo RDP aggiunto all'endpoint pubblico per la macchina virtuale di Azure.</span><span class="sxs-lookup"><span data-stu-id="39e5c-796">RDP added to the public endpoint for the Azure virtual machine.</span></span>

<span data-ttu-id="39e5c-797">Per altre informazioni su questa impostazione, vedere [Troubleshooting remote desktop connection after failover using ASR](http://social.technet.microsoft.com/wiki/contents/articles/31666.troubleshooting-remote-desktop-connection-after-failover-using-asr.aspx) (Risoluzione dei problemi di Connessione Desktop remoto dopo il failover tramite ASR).</span><span class="sxs-lookup"><span data-stu-id="39e5c-797">For more about setting this up, see [Troubleshooting remote desktop connection after failover using ASR](http://social.technet.microsoft.com/wiki/contents/articles/31666.troubleshooting-remote-desktop-connection-after-failover-using-asr.aspx).</span></span>

## <a name="deploy-additional-process-servers"></a><span data-ttu-id="39e5c-798">Distribuire server di elaborazione aggiuntivi</span><span class="sxs-lookup"><span data-stu-id="39e5c-798">Deploy additional process servers</span></span>
<span data-ttu-id="39e5c-799">Se è necessario aumentare la distribuzione oltre le 200 macchine di origine oppure la varianza totale giornaliera è superiore a 2 TB, sono necessari server di elaborazione aggiuntivi per gestire il volume di traffico.</span><span class="sxs-lookup"><span data-stu-id="39e5c-799">If you must scale out your deployment beyond 200 source machines, or if your total daily churn rate exceeds 2 TB, you’ll need additional process servers to handle the traffic volume.</span></span> <span data-ttu-id="39e5c-800">Per configurare un server di elaborazione aggiuntivo, verificare i requisiti in [Server di elaborazione aggiuntivi](#additional-process-servers) e seguire queste istruzioni per configurare il server di elaborazione.</span><span class="sxs-lookup"><span data-stu-id="39e5c-800">To set up an additional process server, check the requirements in [Additional process servers](#additional-process-servers), and then set up the process server according to the following instructions.</span></span> <span data-ttu-id="39e5c-801">Dopo aver configurato il server è possibile configurarne l'uso da parte delle macchine di origine.</span><span class="sxs-lookup"><span data-stu-id="39e5c-801">After you set up the server, you can configure source machines to use it.</span></span>

### <a name="set-up-an-additional-process-server"></a><span data-ttu-id="39e5c-802">Configurare un server di elaborazione aggiuntivo</span><span class="sxs-lookup"><span data-stu-id="39e5c-802">Set up an additional process server</span></span>
<span data-ttu-id="39e5c-803">Per configurare un server di elaborazione aggiuntivo, procedere come segue:</span><span class="sxs-lookup"><span data-stu-id="39e5c-803">Set up an additional process server as follows:</span></span>

* <span data-ttu-id="39e5c-804">Eseguire l'installazione guidata unificata per configurare un server di gestione solo come server di elaborazione.</span><span class="sxs-lookup"><span data-stu-id="39e5c-804">Run the unified wizard to configure a management server as a process server only.</span></span>
* <span data-ttu-id="39e5c-805">Per gestire la replica dei dati usando solo il nuovo server di elaborazione è necessario eseguire la migrazione delle macchine protette.</span><span class="sxs-lookup"><span data-stu-id="39e5c-805">If you want to manage data replication by using only the new process server, you need to migrate your protected machines.</span></span>

### <a name="install-the-process-server"></a><span data-ttu-id="39e5c-806">Installare il server di elaborazione</span><span class="sxs-lookup"><span data-stu-id="39e5c-806">Install the process server</span></span>
1. <span data-ttu-id="39e5c-807">Nella pagina **Avvio rapido** scaricare il file di installazione unificata per l'installazione del componente di Site Recovery.</span><span class="sxs-lookup"><span data-stu-id="39e5c-807">On the **Quick Start** page, download the unified installation file for the Site Recovery component installation.</span></span> <span data-ttu-id="39e5c-808">Eseguire l'installazione.</span><span class="sxs-lookup"><span data-stu-id="39e5c-808">Run Setup.</span></span>
2. <span data-ttu-id="39e5c-809">In **Prima di iniziare** selezionare **Add additional process servers to scale out deployment** (Aggiungere server di elaborazione per aumentare le istanze di distribuzione).</span><span class="sxs-lookup"><span data-stu-id="39e5c-809">In **Before you begin**, select **Add additional process servers to scale out deployment**.</span></span>

 ![Aggiungere il server di elaborazione](./media/site-recovery-vmware-to-azure-classic/add-ps1.png)
3. <span data-ttu-id="39e5c-811">Completare la procedura guidata come per la [configurazione](#step-5-install-the-management-server) del primo server di gestione.</span><span class="sxs-lookup"><span data-stu-id="39e5c-811">Complete the wizard as you did when you [set up](#step-5-install-the-management-server) the first management server.</span></span>
4. <span data-ttu-id="39e5c-812">In **Dettagli del server di configurazione** (Dettagli del server di configurazione) specificare l'indirizzo IP del server di gestione originario in cui è stato installato il server di configurazione e quindi immettere la passphrase.</span><span class="sxs-lookup"><span data-stu-id="39e5c-812">In **Configuration Server Details**, enter the IP address of the original management server on which you installed the configuration server, and then enter the passphrase.</span></span> <span data-ttu-id="39e5c-813">Se la passphrase non è disponibile, eseguire **<SiteRecoveryInstallationFolder>\home\sysystems\bin\genpassphrase.exe –n** nel server di gestione originario per recuperarla.</span><span class="sxs-lookup"><span data-stu-id="39e5c-813">If you do not have the passphrase, run **<SiteRecoveryInstallationFolder>\home\sysystems\bin\genpassphrase.exe –n** on the original management server to retrieve it.</span></span>

 ![Dettagli del server di configurazione](./media/site-recovery-vmware-to-azure-classic/add-ps2.png)

### <a name="migrate-machines-to-use-the-new-process-server"></a><span data-ttu-id="39e5c-815">Eseguire la migrazione dei computer per usare il nuovo server di elaborazione</span><span class="sxs-lookup"><span data-stu-id="39e5c-815">Migrate machines to use the new process server</span></span>
1. <span data-ttu-id="39e5c-816">Aprire **Server di configurazione** > **Server** > *nome del server di gestione originario* > **Dettagli server**.</span><span class="sxs-lookup"><span data-stu-id="39e5c-816">Open **Configuration Servers** > **Server** > *name of the original management server* > **Server Details**.</span></span>

 ![Dettagli del server](./media/site-recovery-vmware-to-azure-classic/update-process-server1.png)
2. <span data-ttu-id="39e5c-818">Nell'elenco **Server di elaborazione** selezionare **Cambia server di elaborazione** accanto al server da cambiare.</span><span class="sxs-lookup"><span data-stu-id="39e5c-818">In the **Process Servers** list, select **Change Process Server** next to the server that you want to change.</span></span>

 ![Aggiornare il server di elaborazione](./media/site-recovery-vmware-to-azure-classic/update-process-server2.png)
3. <span data-ttu-id="39e5c-820">Selezionare **Cambia server di elaborazione**, **Server di elaborazione di destinazione** e quindi selezionare il nuovo server di gestione.</span><span class="sxs-lookup"><span data-stu-id="39e5c-820">Select **Change Process Server**, select **Target Process Server**, and then select the new management server.</span></span> <span data-ttu-id="39e5c-821">Selezionare quindi le macchine virtuali che verranno gestite dal nuovo server di elaborazione.</span><span class="sxs-lookup"><span data-stu-id="39e5c-821">Then select the virtual machines that the new process server will handle.</span></span> <span data-ttu-id="39e5c-822">Fare clic sull'icona informazioni per ottenere informazioni sul server.</span><span class="sxs-lookup"><span data-stu-id="39e5c-822">Click the information icon to get information about the server.</span></span> <span data-ttu-id="39e5c-823">Per consentire di prendere le decisioni relative al carico, viene visualizzato lo spazio medio necessario per replicare ogni macchina virtuale selezionata nel nuovo server di elaborazione.</span><span class="sxs-lookup"><span data-stu-id="39e5c-823">The average space that's needed to replicate each selected virtual machine to the new process server is displayed to help you make load decisions.</span></span> <span data-ttu-id="39e5c-824">Fare clic sul segno di spunta per avviare la replica nel nuovo server di elaborazione.</span><span class="sxs-lookup"><span data-stu-id="39e5c-824">Click the check mark to start replicating to the new process server.</span></span>

 ![Cambiare il server di elaborazione](./media/site-recovery-vmware-to-azure-classic/update-process-server3.png)

## <a name="vmware-permissions-for-vcenter-access"></a><span data-ttu-id="39e5c-826">Autorizzazioni di VMware per l'accesso a vCenter</span><span class="sxs-lookup"><span data-stu-id="39e5c-826">VMware permissions for vCenter access</span></span>
<span data-ttu-id="39e5c-827">Il server di elaborazione può rilevare automaticamente le macchine virtuali in un server vCenter.</span><span class="sxs-lookup"><span data-stu-id="39e5c-827">The process server can automatically discover VMs on a vCenter server.</span></span> <span data-ttu-id="39e5c-828">Per eseguire l'individuazione automatica è necessario definire un ruolo (Azure_Site_Recovery) a livello di vCenter per consentire a Site Recovery di accedere al server vCenter.</span><span class="sxs-lookup"><span data-stu-id="39e5c-828">To perform automatic discovery, you need to define a role (Azure_Site_Recovery) at the vCenter level to allow Site Recovery to access the vCenter server.</span></span> <span data-ttu-id="39e5c-829">Per eseguire la sola migrazione di macchine VMware in Azure, senza eseguire il failback da Azure, è sufficiente definire un ruolo di sola lettura.</span><span class="sxs-lookup"><span data-stu-id="39e5c-829">If you only need to migrate VMware machines to Azure and don't need to failback from Azure, you can define a read-only role that's sufficient.</span></span> <span data-ttu-id="39e5c-830">Configurare le autorizzazioni come descritto in [Passaggio 6: Impostare le credenziali per il server vCenter](#step-6-set-up-credentials-for-the-vcenter-server).</span><span class="sxs-lookup"><span data-stu-id="39e5c-830">Set up the permissions as described in [Step 6: Set up credentials for the vCenter server](#step-6-set-up-credentials-for-the-vcenter-server).</span></span> <span data-ttu-id="39e5c-831">Le autorizzazioni relative ai ruoli sono riepilogate nella tabella seguente:</span><span class="sxs-lookup"><span data-stu-id="39e5c-831">The role permissions are summarized in the following table:</span></span>

| <span data-ttu-id="39e5c-832">**Ruolo**</span><span class="sxs-lookup"><span data-stu-id="39e5c-832">**Role**</span></span> | <span data-ttu-id="39e5c-833">**Dettagli**</span><span class="sxs-lookup"><span data-stu-id="39e5c-833">**Details**</span></span> | <span data-ttu-id="39e5c-834">**Autorizzazioni**</span><span class="sxs-lookup"><span data-stu-id="39e5c-834">**Permissions**</span></span> |
| --- | --- | --- |
| <span data-ttu-id="39e5c-835">Ruolo Azure_Site_Recovery</span><span class="sxs-lookup"><span data-stu-id="39e5c-835">Azure_Site_Recovery role</span></span> |<span data-ttu-id="39e5c-836">Individuazione di macchine virtuali VMware</span><span class="sxs-lookup"><span data-stu-id="39e5c-836">VMware VM discovery</span></span> |<span data-ttu-id="39e5c-837">Assegnare i privilegi seguenti per il server vCenter:</span><span class="sxs-lookup"><span data-stu-id="39e5c-837">Assign these privileges for the v-Center server:</span></span><br/><br/><span data-ttu-id="39e5c-838">Datastore (Archivio dati): Allocate space (Alloca spazio), Browse datastore (Sfoglia archivio dati), Low level file operations (Operazioni file di livello basso), Remove file (Rimuovi file), Update virtual machine files (Aggiorna file macchina virtuale)</span><span class="sxs-lookup"><span data-stu-id="39e5c-838">Datastore: Allocate space, Browse datastore, Low-level file operations, Remove file, Update virtual machine files</span></span><br/><br/><span data-ttu-id="39e5c-839">Network (Rete): Network assign (Assegnazione rete)</span><span class="sxs-lookup"><span data-stu-id="39e5c-839">Network: Network assign</span></span><br/><br/><span data-ttu-id="39e5c-840">Resource (Risorsa): Assign virtual machine to resource pool (Assegna macchina virtuale a pool di risorse), Migrate powered off virtual machine (Esegui migrazione macchina virtuale spenta), Migrate powered on virtual machine (Esegui migrazione macchina virtuale accesa)</span><span class="sxs-lookup"><span data-stu-id="39e5c-840">Resource: Assign virtual machine to resource pool, Migrate powered-off virtual machine, Migrate powered-on virtual machine</span></span><br/><br/><span data-ttu-id="39e5c-841">Tasks (Attività): Create task (Crea attività), Update task (Aggiorna attività)</span><span class="sxs-lookup"><span data-stu-id="39e5c-841">Tasks: Create task, Update task</span></span><br/><br/><span data-ttu-id="39e5c-842">Virtual machine (Macchina virtuale) > Configuration (Configurazione)</span><span class="sxs-lookup"><span data-stu-id="39e5c-842">Virtual machine >  Configuration</span></span><br/><br/><span data-ttu-id="39e5c-843">Virtual machine (Macchina virtuale) > Interact (Interagisci) > Answer question (Rispondi alla domanda), Device connection (Connessione dispositivo), Configure CD media (Configura supporto CD), Configure floppy media (Configura supporto floppy), Power off (Spegni), Power on (Accendi), VMware tools install (Installazione strumenti VMware)</span><span class="sxs-lookup"><span data-stu-id="39e5c-843">Virtual machine > Interact > Answer question, Device connection, Configure CD media, Configure floppy media, Power off, Power on, VMware tools install</span></span><br/><br/><span data-ttu-id="39e5c-844">Virtual machine (Macchina virtuale) > Inventory (Inventario) > Create (Crea), Register (Registra), Unregister (Annulla registrazione)</span><span class="sxs-lookup"><span data-stu-id="39e5c-844">Virtual machine > Inventory > Create, Register, Unregister</span></span><br/><br/><span data-ttu-id="39e5c-845">Virtual machine (Macchina virtuale) > Provisioning > Allow virtual machine download (Consenti download macchina virtuale), Allow virtual machine files upload (Consenti upload file macchina virtuale)</span><span class="sxs-lookup"><span data-stu-id="39e5c-845">Virtual machine > Provisioning > Allow virtual machine download, Allow virtual machine files upload</span></span><br/><br/><span data-ttu-id="39e5c-846">Virtual machine (Macchina virtuale) > Snapshots > Remove snapshots (Rimuovi snapshot)</span><span class="sxs-lookup"><span data-stu-id="39e5c-846">Virtual machine > Snapshots > Remove snapshots</span></span> |
| <span data-ttu-id="39e5c-847">Ruolo vCenter User</span><span class="sxs-lookup"><span data-stu-id="39e5c-847">vCenter user role</span></span> |<span data-ttu-id="39e5c-848">Individuazione della macchina virtuale VMware/Failover senza arresto della macchina virtuale di origine</span><span class="sxs-lookup"><span data-stu-id="39e5c-848">VMware VM discovery/Failover without shutdown of source VM</span></span> |<span data-ttu-id="39e5c-849">Assegnare i privilegi seguenti per il server vCenter:</span><span class="sxs-lookup"><span data-stu-id="39e5c-849">Assign these privileges for the v-Center server:</span></span><br/><br/><span data-ttu-id="39e5c-850">Data Center object (Oggetto data center) > Propagate to Child Object (Propaga a oggetto figlio), role=Read-only (ruolo=Sola lettura)</span><span class="sxs-lookup"><span data-stu-id="39e5c-850">Data Center object > Propagate to Child Object, role=Read-only</span></span> <br/><br/><span data-ttu-id="39e5c-851">L'utente viene assegnato a livello di data center e ha quindi accesso a tutti gli oggetti nel data center.</span><span class="sxs-lookup"><span data-stu-id="39e5c-851">The user is assigned at the datacenter level and thus has access to all the objects in the datacenter.</span></span> <span data-ttu-id="39e5c-852">Se si vuole limitare l'accesso, assegnare il ruolo **No access** con l'oggetto **Propagate to child object** agli oggetti figlio: host ESX, archivi dati, VM e reti.</span><span class="sxs-lookup"><span data-stu-id="39e5c-852">If you want to restrict the access, assign the **No access** role with the **Propagate to child** object to the child objects (ESX hosts, datastores, VMs, and networks).</span></span> |
| <span data-ttu-id="39e5c-853">Ruolo vCenter User</span><span class="sxs-lookup"><span data-stu-id="39e5c-853">vCenter user role</span></span> |<span data-ttu-id="39e5c-854">Failover e failback</span><span class="sxs-lookup"><span data-stu-id="39e5c-854">Failover and failback</span></span> |<span data-ttu-id="39e5c-855">Assegnare i privilegi seguenti per il server vCenter:</span><span class="sxs-lookup"><span data-stu-id="39e5c-855">Assign these privileges for the v-Center server:</span></span><br/><br/><span data-ttu-id="39e5c-856">Data Center object (Oggetto data center) - Propagate to Child Object (Propaga a oggetto figlio), role=Azure_Site_Recovery (ruolo=Azure_Site_Recovery)</span><span class="sxs-lookup"><span data-stu-id="39e5c-856">Datacenter object – Propagate to child object, role=Azure_Site_Recovery</span></span><br/><br/><span data-ttu-id="39e5c-857">L'utente viene assegnato a livello di data center e ha quindi accesso a tutti gli oggetti nel data center.</span><span class="sxs-lookup"><span data-stu-id="39e5c-857">The user is assigned at datacenter level and thus has access to all the objects in the datacenter.</span></span>  <span data-ttu-id="39e5c-858">Per limitare l'accesso, assegnare il ruolo **Nessun accesso** con **Propagate to child object** (Propaga a oggetto figlio) all'oggetto figlio (host ESX, archivi dati, VM e reti).</span><span class="sxs-lookup"><span data-stu-id="39e5c-858">If you want to restrict the access, assign the **No access **role with the **Propagate to child object** to the child object (ESX hosts, datastores, VMs, and networks).</span></span> |

## <a name="third-party-software-notices-and-information"></a><span data-ttu-id="39e5c-859">Informazioni e comunicazioni sul software di terze parti</span><span class="sxs-lookup"><span data-stu-id="39e5c-859">Third-party software notices and information</span></span>
<!--Do Not Translate or Localize-->

<span data-ttu-id="39e5c-860">The software and firmware running in the Microsoft product or service is based on or incorporates material from the projects listed below (collectively, “Third Party Code”).</span><span class="sxs-lookup"><span data-stu-id="39e5c-860">The software and firmware running in the Microsoft product or service is based on or incorporates material from the projects listed below (collectively, “Third Party Code”).</span></span>  <span data-ttu-id="39e5c-861">Microsoft is the not original author of the Third Party Code.</span><span class="sxs-lookup"><span data-stu-id="39e5c-861">Microsoft is the not original author of the Third Party Code.</span></span>  <span data-ttu-id="39e5c-862">The original copyright notice and license, under which Microsoft received such Third Party Code, are set forth below.</span><span class="sxs-lookup"><span data-stu-id="39e5c-862">The original copyright notice and license, under which Microsoft received such Third Party Code, are set forth below.</span></span>

<span data-ttu-id="39e5c-863">The information in Section A is regarding Third Party Code components from the projects listed below.</span><span class="sxs-lookup"><span data-stu-id="39e5c-863">The information in Section A is regarding Third Party Code components from the projects listed below.</span></span> <span data-ttu-id="39e5c-864">Such licenses and information are provided for informational purposes only.</span><span class="sxs-lookup"><span data-stu-id="39e5c-864">Such licenses and information are provided for informational purposes only.</span></span>  <span data-ttu-id="39e5c-865">This Third Party Code is being relicensed to you by Microsoft under Microsoft's software licensing terms for the Microsoft product or service.</span><span class="sxs-lookup"><span data-stu-id="39e5c-865">This Third Party Code is being relicensed to you by Microsoft under Microsoft's software licensing terms for the Microsoft product or service.</span></span>  

<span data-ttu-id="39e5c-866">The information in Section B is regarding Third Party Code components that are being made available to you by Microsoft under the original licensing terms.</span><span class="sxs-lookup"><span data-stu-id="39e5c-866">The information in Section B is regarding Third Party Code components that are being made available to you by Microsoft under the original licensing terms.</span></span>

<span data-ttu-id="39e5c-867">The complete file may be found on the [Microsoft Download Center](http://go.microsoft.com/fwlink/?LinkId=529428).</span><span class="sxs-lookup"><span data-stu-id="39e5c-867">The complete file may be found on the [Microsoft Download Center](http://go.microsoft.com/fwlink/?LinkId=529428).</span></span> <span data-ttu-id="39e5c-868">Microsoft reserves all rights not expressly granted herein, whether by implication, estoppel or otherwise.</span><span class="sxs-lookup"><span data-stu-id="39e5c-868">Microsoft reserves all rights not expressly granted herein, whether by implication, estoppel or otherwise.</span></span>

## <a name="next-steps"></a><span data-ttu-id="39e5c-869">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="39e5c-869">Next steps</span></span>
<span data-ttu-id="39e5c-870">[Altre informazioni sul failback](site-recovery-failback-azure-to-vmware-classic.md) per rendere nuovamente disponibili nell'ambiente locale le macchine sottoposte a failover in esecuzione in Azure.</span><span class="sxs-lookup"><span data-stu-id="39e5c-870">[Learn more about failback](site-recovery-failback-azure-to-vmware-classic.md) to bring your failed-over machines running in Azure back to your on-premises environment.</span></span>
