---
title: aaaProvision nuovi tenant in un'applicazione multi-tenant che utilizza Database SQL di Azure | Documenti Microsoft
description: Informazioni su come tooprovision e nuovo catalogo i tenant nell'hello app SaaS Wingtip
keywords: esercitazione database SQL
services: sql-database
documentationcenter: 
author: stevestein
manager: craigg
editor: 
ms.assetid: 
ms.service: sql-database
ms.custom: scale out apps
ms.workload: data-management
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 08/11/2017
ms.author: sstein
ms.openlocfilehash: eb26f523305650c2124e36707d187dfcdad06fcc
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/06/2017
---
# <a name="provision-new-tenants-and-register-them-in-hello-catalog"></a><span data-ttu-id="37cfd-104">Eseguire il provisioning di nuovi tenant e registrarli nel catalogo di hello</span><span class="sxs-lookup"><span data-stu-id="37cfd-104">Provision new tenants and register them in hello catalog</span></span>

<span data-ttu-id="37cfd-105">In questa esercitazione, conoscere il provisioning di hello e modelli SaaS catalogo e come vengono implementati in applicazione SaaS Wingtip hello.</span><span class="sxs-lookup"><span data-stu-id="37cfd-105">In this tutorial, you learn about hello provision and catalog SaaS patterns, and how they are implemented in hello Wingtip SaaS application.</span></span> <span data-ttu-id="37cfd-106">Creare e inizializzare nuovi database tenant e registrarli nel catalogo di tenant dell'applicazione hello.</span><span class="sxs-lookup"><span data-stu-id="37cfd-106">You create and initialize new tenant databases, and register them in hello application’s tenant catalog.</span></span> <span data-ttu-id="37cfd-107">catalogo Hello è un database che gestisce il mapping di hello tra molti tenant dell'applicazione SaaS hello e i relativi dati.</span><span class="sxs-lookup"><span data-stu-id="37cfd-107">hello catalog is a database that maintains hello mapping between hello SaaS application's many tenants and their data.</span></span> <span data-ttu-id="37cfd-108">catalogo Hello svolge un ruolo importante indirizzare il database corretto toohello le richieste dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="37cfd-108">hello catalog plays an important role directing application requests toohello correct database.</span></span>  

<span data-ttu-id="37cfd-109">In questa esercitazione si apprenderà come:</span><span class="sxs-lookup"><span data-stu-id="37cfd-109">In this tutorial, you learn how to:</span></span>

> [!div class="checklist"]

> * <span data-ttu-id="37cfd-110">Eseguire il provisioning di un nuovo tenant singolo, con i passaggi dettagliati della relativa implementazione</span><span class="sxs-lookup"><span data-stu-id="37cfd-110">Provision a single new tenant, including stepping through how this is implemented</span></span>
> * <span data-ttu-id="37cfd-111">Effettuare il provisioning di un batch di altri tenant</span><span class="sxs-lookup"><span data-stu-id="37cfd-111">Provision a batch of additional tenants</span></span>


<span data-ttu-id="37cfd-112">toocomplete completamento di questa esercitazione, assicurarsi che i hello seguenti prerequisiti:</span><span class="sxs-lookup"><span data-stu-id="37cfd-112">toocomplete this tutorial, make sure hello following prerequisites are completed:</span></span>

* <span data-ttu-id="37cfd-113">app SaaS Wingtip Hello viene distribuita.</span><span class="sxs-lookup"><span data-stu-id="37cfd-113">hello Wingtip SaaS app is deployed.</span></span> <span data-ttu-id="37cfd-114">toodeploy in meno di cinque minuti, vedere [Distribuisci ed esplorare l'applicazione SaaS Wingtip hello](sql-database-saas-tutorial.md)</span><span class="sxs-lookup"><span data-stu-id="37cfd-114">toodeploy in less than five minutes, see [Deploy and explore hello Wingtip SaaS application](sql-database-saas-tutorial.md)</span></span>
* <span data-ttu-id="37cfd-115">Azure PowerShell è installato.</span><span class="sxs-lookup"><span data-stu-id="37cfd-115">Azure PowerShell is installed.</span></span> <span data-ttu-id="37cfd-116">Per informazioni dettagliate, vedere [Introduzione ad Azure PowerShell](https://docs.microsoft.com/powershell/azure/get-started-azureps)</span><span class="sxs-lookup"><span data-stu-id="37cfd-116">For details, see [Getting started with Azure PowerShell](https://docs.microsoft.com/powershell/azure/get-started-azureps)</span></span>

## <a name="introduction-toohello-saas-catalog-pattern"></a><span data-ttu-id="37cfd-117">Introduzione toohello modello SaaS catalogo</span><span class="sxs-lookup"><span data-stu-id="37cfd-117">Introduction toohello SaaS Catalog pattern</span></span>

<span data-ttu-id="37cfd-118">In un'applicazione SaaS multi-tenant di backup del database, è importante tooknow memorizzazione informazioni per ogni tenant.</span><span class="sxs-lookup"><span data-stu-id="37cfd-118">In a database-backed multi-tenant SaaS application, it's important tooknow where information for each tenant is stored.</span></span> <span data-ttu-id="37cfd-119">Nel modello di catalogo hello SaaS, un database del catalogo è hello toohold usato il mapping tra ogni tenant e in cui sono archiviati i dati.</span><span class="sxs-lookup"><span data-stu-id="37cfd-119">In hello SaaS catalog pattern, a catalog database is used toohold hello mapping between each tenant and where their data is stored.</span></span> <span data-ttu-id="37cfd-120">app SaaS Wingtip Hello Usa un single-tenant per ogni architettura del database, ma si applica modello di base hello di archiviare i mapping di tenant al database in un catalogo se viene utilizzato un database multi-tenant o single-tenant.</span><span class="sxs-lookup"><span data-stu-id="37cfd-120">hello Wingtip SaaS app uses a single-tenant per database architecture, but hello basic pattern of storing tenant-to-database mapping in a catalog applies whether a multi-tenant or single-tenant database is used.</span></span>

<span data-ttu-id="37cfd-121">Ogni tenant viene assegnato a una chiave che identifica le nel catalogo di hello e che viene eseguito il mapping di percorso toohello del database appropriato hello.</span><span class="sxs-lookup"><span data-stu-id="37cfd-121">Each tenant is assigned a key that identifies them in hello catalog and which is mapped toohello location of hello appropriate database.</span></span> <span data-ttu-id="37cfd-122">Nell'applicazione SaaS Wingtip hello chiave hello è formata da un hash del nome del tenant hello.</span><span class="sxs-lookup"><span data-stu-id="37cfd-122">In hello Wingtip SaaS app, hello key is formed from a hash of hello tenant’s name.</span></span> <span data-ttu-id="37cfd-123">Questo consente di parte del nome tenant hello di hello applicazione URL toobe usati chiave hello tooconstruct.</span><span class="sxs-lookup"><span data-stu-id="37cfd-123">This allows hello tenant name portion of hello application URL toobe used tooconstruct hello key.</span></span> <span data-ttu-id="37cfd-124">Per la chiave del tenant è possibile usare anche altri schemi.</span><span class="sxs-lookup"><span data-stu-id="37cfd-124">Other tenant key schemes could be used.</span></span>  

<span data-ttu-id="37cfd-125">catalogo Hello consente nome hello o un percorso di hello database toobe modificato con un impatto minimo sull'applicazione hello.</span><span class="sxs-lookup"><span data-stu-id="37cfd-125">hello catalog allows hello name or location of hello database toobe changed with minimal impact on hello application.</span></span>  <span data-ttu-id="37cfd-126">In un modello di database multi-tenant, ciò consente anche di "spostare" un tenant da un database a un altro.</span><span class="sxs-lookup"><span data-stu-id="37cfd-126">In a multi-tenant database model, this also accommodates ‘moving’ a tenant between databases.</span></span>  <span data-ttu-id="37cfd-127">catalogo Hello può essere utilizzato tooindicate anche se un tenant o il database è offline per manutenzione o altre azioni.</span><span class="sxs-lookup"><span data-stu-id="37cfd-127">hello catalog can also be used tooindicate whether a tenant or database is offline for maintenance or other actions.</span></span> <span data-ttu-id="37cfd-128">Ciò viene esaminata in hello [ripristinare esercitazione single-tenant](sql-database-saas-tutorial-restore-single-tenant.md).</span><span class="sxs-lookup"><span data-stu-id="37cfd-128">This is explored in hello [restore single tenant tutorial](sql-database-saas-tutorial-restore-single-tenant.md).</span></span>

<span data-ttu-id="37cfd-129">Inoltre, catalogo hello, che è in effetti un database di gestione per un'applicazione SaaS, è possibile archiviare metadati aggiuntivi tenant o un database, ad esempio hello livello o edizione di un database, la versione dello schema, il piano di servizio o i contratti di servizio offerti tootenants e altre informazioni che consente la gestione delle applicazioni, il supporto tecnico o processi devops.</span><span class="sxs-lookup"><span data-stu-id="37cfd-129">In addition, hello catalog, which is in effect a management database for a SaaS application, can store additional tenant or database metadata, such as hello tier or edition of a database, schema version, service plan, or SLAs offered tootenants, and other info that enables application management, customer support, or devops processes.</span></span>  

<span data-ttu-id="37cfd-130">Oltre a hello applicazione SaaS, catalogo hello possibile abilitare gli strumenti di database.</span><span class="sxs-lookup"><span data-stu-id="37cfd-130">Beyond hello SaaS application, hello catalog can enable database tools.</span></span>  <span data-ttu-id="37cfd-131">Nell'esempio Wingtip SaaS hello catalogo hello è query tra tenant tooenable usato, esplorata in hello [esercitazione analitica ad hoc](sql-database-saas-tutorial-adhoc-analytics.md).</span><span class="sxs-lookup"><span data-stu-id="37cfd-131">In hello Wingtip SaaS sample, hello catalog is used tooenable cross-tenant query, explored in hello [ad hoc analytics tutorial](sql-database-saas-tutorial-adhoc-analytics.md).</span></span> <span data-ttu-id="37cfd-132">Gestione dei processi tra database viene esaminato in hello [la gestione dello schema](sql-database-saas-tutorial-schema-management.md) e [tenant analitica](sql-database-saas-tutorial-tenant-analytics.md) esercitazioni.</span><span class="sxs-lookup"><span data-stu-id="37cfd-132">Cross-database job management is explored in hello [schema management](sql-database-saas-tutorial-schema-management.md) and [tenant analytics](sql-database-saas-tutorial-tenant-analytics.md) tutorials.</span></span> 

<span data-ttu-id="37cfd-133">Nell'applicazione SaaS Wingtip hello catalogo hello viene implementata utilizzando le funzionalità di gestione di partizioni hello di hello [elastico Database Client libreria (EDCL)](sql-database-elastic-database-client-library.md).</span><span class="sxs-lookup"><span data-stu-id="37cfd-133">In hello Wingtip SaaS app, hello catalog is implemented using hello Shard Management features of hello [Elastic Database Client Library (EDCL)](sql-database-elastic-database-client-library.md).</span></span> <span data-ttu-id="37cfd-134">Consente di Hello EDCL toocreate un'applicazione, gestire e utilizzare una mappa partizioni di database di backup.</span><span class="sxs-lookup"><span data-stu-id="37cfd-134">hello EDCL enables an application toocreate, manage, and use a database-backed shard map.</span></span> <span data-ttu-id="37cfd-135">Una mappa partizioni contiene un elenco di partizioni (database) e il mapping di hello tra database e le chiavi (tenant).</span><span class="sxs-lookup"><span data-stu-id="37cfd-135">A shard map contains a list of shards (databases) and hello mapping between keys (tenants) and databases.</span></span>  <span data-ttu-id="37cfd-136">EDCL funzioni possono essere usate da applicazioni o script di PowerShell durante le voci di hello toocreate nella mappa partizioni hello di provisioning del tenant e da applicazioni tooefficiently connettersi toohello database corretto.</span><span class="sxs-lookup"><span data-stu-id="37cfd-136">EDCL functions can be used from applications or PowerShell scripts during tenant provisioning toocreate hello entries in hello shard map, and from applications tooefficiently connect toohello correct database.</span></span> <span data-ttu-id="37cfd-137">EDCL memorizza nella cache database del catalogo connessione informazioni toominimize hello traffico toohello e velocizzare l'applicazione hello.</span><span class="sxs-lookup"><span data-stu-id="37cfd-137">EDCL caches connection information toominimize hello traffic toohello catalog database and speed up hello application.</span></span>  

> [!IMPORTANT]
> <span data-ttu-id="37cfd-138">i dati di mapping Hello sono accessibili nel database di catalogo hello, ma *non modificarlo*!</span><span class="sxs-lookup"><span data-stu-id="37cfd-138">hello mapping data is accessible in hello catalog database, but *don't edit it*!</span></span> <span data-ttu-id="37cfd-139">Modificare i dati di mapping solo tramite le API della libreria client dei database elastici.</span><span class="sxs-lookup"><span data-stu-id="37cfd-139">Edit mapping data using Elastic Database Client Library APIs only.</span></span> <span data-ttu-id="37cfd-140">La modifica diretta dei dati di mapping hello rischi di danneggiamento hello del catalogo e non sono supportati.</span><span class="sxs-lookup"><span data-stu-id="37cfd-140">Directly manipulating hello mapping data risks corrupting hello catalog and is not supported.</span></span>


## <a name="introduction-toohello-saas-provisioning-pattern"></a><span data-ttu-id="37cfd-141">Modello di Provisioning SaaS toohello introduzione</span><span class="sxs-lookup"><span data-stu-id="37cfd-141">Introduction toohello SaaS Provisioning pattern</span></span>

<span data-ttu-id="37cfd-142">Al momento del caricamento di un nuovo tenant in un'applicazione SaaS che usa un modello di database a tenant singolo, è necessario eseguire il provisioning di un nuovo database tenant.</span><span class="sxs-lookup"><span data-stu-id="37cfd-142">When onboarding a new tenant in a SaaS application that uses a single-tenant database model a new tenant database must be provisioned.</span></span>  <span data-ttu-id="37cfd-143">Deve essere creato nella posizione appropriata hello e il livello di servizio, inizializzato con appropriati dello schema e dati di riferimento e quindi registrati nel catalogo di hello nella chiave del tenant appropriato hello.</span><span class="sxs-lookup"><span data-stu-id="37cfd-143">It must be created in hello appropriate location and service tier, initialized with appropriate schema and reference data, and then registered in hello catalog under hello appropriate tenant key.</span></span>  

<span data-ttu-id="37cfd-144">Diversi approcci possono essere utilizzato toodatabase provisioning, che potrebbe includere l'esecuzione di script SQL, la distribuzione di un file bacpac o copia di un database modello 'finale'.</span><span class="sxs-lookup"><span data-stu-id="37cfd-144">Different approaches can be used toodatabase provisioning, which could include executing SQL scripts, deploying a bacpac, or copying a 'golden' template database.</span></span>  

<span data-ttu-id="37cfd-145">la strategia di gestione generale dello schema, che devono garantire che vengono effettuato il provisioning di nuovi database con schema più recente di hello è necessario comprendere Hello provisioning approccio adottato.</span><span class="sxs-lookup"><span data-stu-id="37cfd-145">hello provisioning approach you use must be comprehended in your overall schema management strategy, which must ensure that new databases are provisioned with hello latest schema.</span></span>  <span data-ttu-id="37cfd-146">Ciò viene esaminata in hello [esercitazione Gestione schema](sql-database-saas-tutorial-schema-management.md).</span><span class="sxs-lookup"><span data-stu-id="37cfd-146">This is explored in hello [schema management tutorial](sql-database-saas-tutorial-schema-management.md).</span></span>  

<span data-ttu-id="37cfd-147">Hello Wingtip SaaS app disposizioni nuovi tenant copiando un database finale denominato basetenantdb, distribuito nel server di catalogo hello.</span><span class="sxs-lookup"><span data-stu-id="37cfd-147">hello Wingtip SaaS app provisions new tenants by copying a golden database named basetenantdb, deployed on hello catalog server.</span></span>  <span data-ttu-id="37cfd-148">Provisioning può essere integrato in un'applicazione hello come parte di un'esperienza di iscrizione e/o supportato in modalità offline mediante script.</span><span class="sxs-lookup"><span data-stu-id="37cfd-148">Provisioning could be integrated into hello application as part of a sign-up experience, and/or supported offline using scripts.</span></span> <span data-ttu-id="37cfd-149">Questa esercitazione illustra il provisioning tramite PowerShell.</span><span class="sxs-lookup"><span data-stu-id="37cfd-149">This tutorial will explore provisioning using PowerShell.</span></span> <span data-ttu-id="37cfd-150">gli script di provisioning Hello copiare hello basetenantdb toocreate un nuovo database tenant in un pool elastico, quindi inizializzano con informazioni specifici del tenant e registrarlo nella mappa partizioni di hello catalogo.</span><span class="sxs-lookup"><span data-stu-id="37cfd-150">hello provisioning scripts copy hello basetenantdb toocreate a new tenant database in an elastic pool, then initialize it with tenant-specific info and register it in hello catalog shard map.</span></span>  <span data-ttu-id="37cfd-151">Nell'applicazione di esempio hello, i database vengono assegnati nomi in base al nome di tenant hello, ma non si tratta di una parte essenziale del modello di hello: hello catalogo hello consente qualsiasi database di nome toobe assegnato toohello. +</span><span class="sxs-lookup"><span data-stu-id="37cfd-151">In hello sample app, databases are given names based on hello tenant name, but this is not a critical part of hello pattern – hello use of hello catalog allows any name toobe assigned toohello database.+</span></span> 


## <a name="get-hello-wingtip-application-scripts"></a><span data-ttu-id="37cfd-152">Ottenere script per l'applicazione hello Wingtip</span><span class="sxs-lookup"><span data-stu-id="37cfd-152">Get hello Wingtip application scripts</span></span>

<span data-ttu-id="37cfd-153">Hello Wingtip SaaS script e codice sorgente dell'applicazione sono disponibili in hello [WingtipSaaS](https://github.com/Microsoft/WingtipSaaS) repository github.</span><span class="sxs-lookup"><span data-stu-id="37cfd-153">hello Wingtip SaaS scripts and application source code are available in hello [WingtipSaaS](https://github.com/Microsoft/WingtipSaaS) github repo.</span></span> <span data-ttu-id="37cfd-154">[I passaggi di script di SaaS Wingtip hello toodownload](sql-database-wtp-overview.md#download-and-unblock-the-wingtip-saas-scripts).</span><span class="sxs-lookup"><span data-stu-id="37cfd-154">[Steps toodownload hello Wingtip SaaS scripts](sql-database-wtp-overview.md#download-and-unblock-the-wingtip-saas-scripts).</span></span>


## <a name="provision-and-catalog-detailed-walkthrough"></a><span data-ttu-id="37cfd-155">Procedura dettagliata per il provisioning e la catalogazione</span><span class="sxs-lookup"><span data-stu-id="37cfd-155">Provision and catalog detailed walkthrough</span></span>

<span data-ttu-id="37cfd-156">toounderstand come hello Wingtip applicazione implementa nuovo provisioning del tenant, aggiungere un punto di interruzione e passaggio tramite flusso di lavoro hello durante il provisioning di un tenant:</span><span class="sxs-lookup"><span data-stu-id="37cfd-156">toounderstand how hello Wingtip application implements new tenant provisioning, add a breakpoint and step through hello workflow while provisioning a tenant:</span></span>

1. <span data-ttu-id="37cfd-157">Apri... \\Moduli learning\\ProvisionAndCatalog\\_Demo ProvisionAndCatalog.ps1_ e hello set seguenti parametri:</span><span class="sxs-lookup"><span data-stu-id="37cfd-157">Open ...\\Learning Modules\\ProvisionAndCatalog\\_Demo-ProvisionAndCatalog.ps1_ and set hello following parameters:</span></span>
   * <span data-ttu-id="37cfd-158">**$TenantName** = nome hello del nuovo aspetto hello (ad esempio, *Bushwillow blu*).</span><span class="sxs-lookup"><span data-stu-id="37cfd-158">**$TenantName** = hello name of hello new venue (for example, *Bushwillow Blues*).</span></span>
   * <span data-ttu-id="37cfd-159">**$VenueType** = uno dei tipi di eventi predefiniti hello: *blu*, classicalmusic, danza, jazz, judo, motorracing, con più finalità, opera, rockmusic, calcio.</span><span class="sxs-lookup"><span data-stu-id="37cfd-159">**$VenueType** = one of hello pre-defined venue types: *blues*, classicalmusic, dance, jazz, judo, motorracing, multipurpose, opera, rockmusic, soccer.</span></span>
   * <span data-ttu-id="37cfd-160">**$DemoScenario** = **1**, impostare troppo**1** troppo*il provisioning di un singolo tenant*.</span><span class="sxs-lookup"><span data-stu-id="37cfd-160">**$DemoScenario** = **1**, Set too**1** too*Provision a single tenant*.</span></span>

1. <span data-ttu-id="37cfd-161">Aggiungere un punto di interruzione posizionando il cursore in qualsiasi punto in 48, hello una riga che afferma: *nuovo Tenant '*e premere **F9**.</span><span class="sxs-lookup"><span data-stu-id="37cfd-161">Add a breakpoint by putting your cursor anywhere on line 48, hello line that says: *New-Tenant \`*, and press **F9**.</span></span>

   ![punto di interruzione](media/sql-database-saas-tutorial-provision-and-catalog/breakpoint.png)

1. <span data-ttu-id="37cfd-163">Premere di script hello toorun **F5**.</span><span class="sxs-lookup"><span data-stu-id="37cfd-163">toorun hello script press **F5**.</span></span>

1. <span data-ttu-id="37cfd-164">Dopo l'esecuzione dello script hello si interrompe al punto di interruzione hello, premere **F11** toostep codice hello.</span><span class="sxs-lookup"><span data-stu-id="37cfd-164">After hello script execution stops at hello breakpoint, press **F11** toostep into hello code.</span></span>

   ![punto di interruzione](media/sql-database-saas-tutorial-provision-and-catalog/debug.png)



<span data-ttu-id="37cfd-166">Tracciare l'esecuzione dello script hello utilizzando hello **Debug** opzioni di menu - **F10** e **F11** toostep su o in funzioni chiamate hello.</span><span class="sxs-lookup"><span data-stu-id="37cfd-166">Trace hello script's execution using hello **Debug** menu options - **F10** and **F11** toostep over or into hello called functions.</span></span> <span data-ttu-id="37cfd-167">Per altre informazioni sul debug degli script di PowerShell, vedere [Suggerimenti per l'utilizzo e il debug degli script di PowerShell](https://msdn.microsoft.com/powershell/scripting/core-powershell/ise/how-to-debug-scripts-in-windows-powershell-ise).</span><span class="sxs-lookup"><span data-stu-id="37cfd-167">For more information about debugging PowerShell scripts, see [Tips on working with and debugging PowerShell scripts](https://msdn.microsoft.com/powershell/scripting/core-powershell/ise/how-to-debug-scripts-in-windows-powershell-ise).</span></span>


<span data-ttu-id="37cfd-168">di seguito Hello non sono tooexplicitly attenersi alla procedura, ma una spiegazione del flusso di lavoro hello che scorrere durante il debug di script hello:</span><span class="sxs-lookup"><span data-stu-id="37cfd-168">hello following are not steps tooexplicitly follow, but an explanation of hello workflow you step through while debugging hello script:</span></span>

1. <span data-ttu-id="37cfd-169">**Hello importazione SubscriptionManagement.psm1** modulo che contiene funzioni per la firma in tooAzure e selezionando hello sottoscrizione di Azure in uso.</span><span class="sxs-lookup"><span data-stu-id="37cfd-169">**Import hello SubscriptionManagement.psm1** module that contains functions for signing in tooAzure and selecting hello Azure subscription you are working with.</span></span>
1. <span data-ttu-id="37cfd-170">**Hello importazione CatalogAndDatabaseManagement.psm1** modulo che fornisce un catalogo e un tenant a livello di astrazione su hello [gestione di partizioni](sql-database-elastic-scale-shard-map-management.md) funzioni.</span><span class="sxs-lookup"><span data-stu-id="37cfd-170">**Import hello CatalogAndDatabaseManagement.psm1** module that provides a catalog and tenant-level abstraction over hello [Shard Management](sql-database-elastic-scale-shard-map-management.md) functions.</span></span> <span data-ttu-id="37cfd-171">Si tratta di un modulo importante incapsula gran parte del modello di catalogo hello, che vale la pena considerare.</span><span class="sxs-lookup"><span data-stu-id="37cfd-171">This is an important module that encapsulates much of hello catalog pattern and is worth exploring.</span></span>
1. <span data-ttu-id="37cfd-172">**Recupero dei dettagli di configurazione**.</span><span class="sxs-lookup"><span data-stu-id="37cfd-172">**Get configuration details**.</span></span> <span data-ttu-id="37cfd-173">Eseguire Get-configurazione (F11) e la configurazione dell'applicazione hello è specificato.</span><span class="sxs-lookup"><span data-stu-id="37cfd-173">Step into Get-Configuration (with F11) and see how hello app config is specified.</span></span> <span data-ttu-id="37cfd-174">I nomi delle risorse e altri valori specifici dell'app vengono definite qui, ma non modificare questi valori fino a quando non si ha familiarità con gli script hello.</span><span class="sxs-lookup"><span data-stu-id="37cfd-174">Resource names and other app-specific values are defined here, but do not change any of these values until you are familiar with hello scripts.</span></span>
1. <span data-ttu-id="37cfd-175">**Ottenere l'oggetto catalogo hello**.</span><span class="sxs-lookup"><span data-stu-id="37cfd-175">**Get hello catalog object**.</span></span> <span data-ttu-id="37cfd-176">Eseguire Get-catalogo che compone e restituisce l'oggetto catalogo utilizzato nello script di livello superiore di hello.</span><span class="sxs-lookup"><span data-stu-id="37cfd-176">Step into Get-Catalog which composes and returns a catalog object that is used in hello higher-level script.</span></span>  <span data-ttu-id="37cfd-177">Questa funzione usa funzioni di gestione di partizioni importate da **AzureShardManagement.psm1**.</span><span class="sxs-lookup"><span data-stu-id="37cfd-177">This function uses Shard Management functions that are imported from **AzureShardManagement.psm1**.</span></span> <span data-ttu-id="37cfd-178">oggetto catalogo Hello è costituito dai seguenti hello:</span><span class="sxs-lookup"><span data-stu-id="37cfd-178">hello catalog object is composed of hello following:</span></span>
   * <span data-ttu-id="37cfd-179">$catalogServerFullyQualifiedName viene costruita utilizzando stem standard hello e il nome utente: _catalogo -\<utente\>. database.windows.net_.</span><span class="sxs-lookup"><span data-stu-id="37cfd-179">$catalogServerFullyQualifiedName is constructed using hello standard stem plus your User name: _catalog-\<user\>.database.windows.net_.</span></span>
   * <span data-ttu-id="37cfd-180">$catalogDatabaseName viene recuperato dalla configurazione hello: *tenantcatalog*.</span><span class="sxs-lookup"><span data-stu-id="37cfd-180">$catalogDatabaseName is retrieved from hello config: *tenantcatalog*.</span></span>
   * <span data-ttu-id="37cfd-181">oggetto $shardMapManager viene inizializzato dai database del catalogo hello.</span><span class="sxs-lookup"><span data-stu-id="37cfd-181">$shardMapManager object is initialized from hello catalog database.</span></span>
   * <span data-ttu-id="37cfd-182">oggetto $shardMap viene inizializzato da hello *tenantcatalog* mappa partizioni nel database di catalogo hello.</span><span class="sxs-lookup"><span data-stu-id="37cfd-182">$shardMap object is initialized from hello *tenantcatalog* shard map in hello catalog database.</span></span>
   <span data-ttu-id="37cfd-183">Un oggetto del catalogo è composta da restituito e usato nello script di livello superiore di hello.</span><span class="sxs-lookup"><span data-stu-id="37cfd-183">A catalog object is composed and returned, and used in hello higher-level script.</span></span>
1. <span data-ttu-id="37cfd-184">**Calcolare la nuova chiave tenant di hello**.</span><span class="sxs-lookup"><span data-stu-id="37cfd-184">**Calculate hello new tenant key**.</span></span> <span data-ttu-id="37cfd-185">Una funzione hash è una chiave del tenant hello toocreate utilizzato dal nome di tenant hello.</span><span class="sxs-lookup"><span data-stu-id="37cfd-185">A hash function is used toocreate hello tenant key from hello tenant name.</span></span>
1. <span data-ttu-id="37cfd-186">**Verifica se esiste già una chiave del tenant hello**.</span><span class="sxs-lookup"><span data-stu-id="37cfd-186">**Check if hello tenant key already exists**.</span></span> <span data-ttu-id="37cfd-187">catalogo Hello viene verificata tooensure hello chiave è disponibile.</span><span class="sxs-lookup"><span data-stu-id="37cfd-187">hello catalog is checked tooensure hello key is available.</span></span>
1. <span data-ttu-id="37cfd-188">**viene eseguito il provisioning di database tenant Hello con New-TenantDatabase.**</span><span class="sxs-lookup"><span data-stu-id="37cfd-188">**hello tenant database is provisioned with New-TenantDatabase.**</span></span> <span data-ttu-id="37cfd-189">Utilizzare **F11** toostep in e vedere come database hello viene eseguito il provisioning con un [modello di Azure Resource Manager](../azure-resource-manager/resource-manager-template-walkthrough.md).</span><span class="sxs-lookup"><span data-stu-id="37cfd-189">Use **F11** toostep in and see how hello database is provisioned using an [Azure Resource Manager template](../azure-resource-manager/resource-manager-template-walkthrough.md).</span></span>

<span data-ttu-id="37cfd-190">nome del database Hello viene costruito da hello tenant nome toomake sia cancellare quale partizione appartiene toowhich tenant.</span><span class="sxs-lookup"><span data-stu-id="37cfd-190">hello database name is constructed from hello tenant name toomake it clear which shard belongs toowhich tenant.</span></span> <span data-ttu-id="37cfd-191">(Altre strategie per la denominazione dei database può essere facilmente utilizzati.) + Un modello di gestione risorse è toocreate utilizzato un database tenant copiando un database finale (baseTenantDB) nel server di catalogo hello.</span><span class="sxs-lookup"><span data-stu-id="37cfd-191">(Other strategies for database naming could easily be used.)+ A Resource Manager template is used toocreate a tenant database by copying a golden database (baseTenantDB) on hello catalog server.</span></span> <span data-ttu-id="37cfd-192">Un approccio alternativo potrebbe essere toocreate un database vuoto e quindi inizializzarlo importando un file bacpac o tooexecute uno script di inizializzazione da un percorso noto.</span><span class="sxs-lookup"><span data-stu-id="37cfd-192">An alternative approach could be toocreate an empty database and then initialize it by importing a bacpac, or tooexecute an initialization script from a well-known location.</span></span>  

<span data-ttu-id="37cfd-193">il modello di gestione risorse di Hello si trova nella cartella di Modules\Common\ ...\Learning hello: *tenantdatabasecopytemplate.json*</span><span class="sxs-lookup"><span data-stu-id="37cfd-193">hello Resource Manager template is in hello …\Learning Modules\Common\ folder: *tenantdatabasecopytemplate.json*</span></span>

<span data-ttu-id="37cfd-194">Dopo aver creato il database di tenant hello, è quindi ulteriore **inizializzato con il nome di evento (tenant) hello e il tipo di evento hello**.</span><span class="sxs-lookup"><span data-stu-id="37cfd-194">After hello tenant database is created, it is then further **initialized with hello venue (tenant) name and hello venue type**.</span></span> <span data-ttu-id="37cfd-195">In questa posizione è possibile eseguire anche altre inizializzazioni.</span><span class="sxs-lookup"><span data-stu-id="37cfd-195">Other initialization could also be done here.</span></span>

<span data-ttu-id="37cfd-196">Hello **database tenant è registrato nel catalogo di hello** con *Aggiungi TenantDatabaseToCatalog* con chiave del tenant hello.</span><span class="sxs-lookup"><span data-stu-id="37cfd-196">hello **tenant database is registered in hello catalog** with *Add-TenantDatabaseToCatalog* using hello tenant key.</span></span> <span data-ttu-id="37cfd-197">Utilizzare **F11** toostep i dettagli di hello:</span><span class="sxs-lookup"><span data-stu-id="37cfd-197">Use **F11** toostep into hello details:</span></span>

* <span data-ttu-id="37cfd-198">database del catalogo Hello viene aggiunta una mappa partizioni toohello (hello elenco database noti).</span><span class="sxs-lookup"><span data-stu-id="37cfd-198">hello catalog database is added toohello shard map (hello list of known databases).</span></span>
* <span data-ttu-id="37cfd-199">viene creato il mapping di tale partizionamento toohello valore della chiave di collegamenti hello Hello.</span><span class="sxs-lookup"><span data-stu-id="37cfd-199">hello mapping that links hello key value toohello shard is created.</span></span>
* <span data-ttu-id="37cfd-200">Metadati aggiuntivi (nome della struttura hello) sul tenant hello viene aggiunto tabella tenant toohello nel catalogo di hello.</span><span class="sxs-lookup"><span data-stu-id="37cfd-200">Additional meta data (hello venue's name) about hello tenant is added toohello Tenants table in hello catalog.</span></span>  <span data-ttu-id="37cfd-201">tabella tenant Hello non fa parte dello schema ShardManagement hello e non è installata per hello EDCL.</span><span class="sxs-lookup"><span data-stu-id="37cfd-201">hello Tenants table is not part of hello ShardManagement schema and is not installed by hello EDCL.</span></span>  <span data-ttu-id="37cfd-202">Questa tabella viene illustrato come database di catalogo hello può essere esteso toosupport di ulteriori dati specifici dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="37cfd-202">This table illustrates how hello Catalog database can be extended toosupport additional application-specific data.</span></span>   


<span data-ttu-id="37cfd-203">Una volta al termine del provisioning, esecuzione restituisce toohello originale *Demo ProvisionAndCatalog* script, che consente di aprire hello **eventi** pagina per il tenant di nuovo hello nel browser hello:</span><span class="sxs-lookup"><span data-stu-id="37cfd-203">After provisioning completes, execution returns toohello original *Demo-ProvisionAndCatalog* script, which opens hello **Events** page for hello new tenant in hello browser:</span></span>

   ![eventi](media/sql-database-saas-tutorial-provision-and-catalog/new-tenant.png)


## <a name="provision-a-batch-of-tenants"></a><span data-ttu-id="37cfd-205">Eseguire il provisioning di un batch di tenant</span><span class="sxs-lookup"><span data-stu-id="37cfd-205">Provision a batch of tenants</span></span>

<span data-ttu-id="37cfd-206">Questo esercizio descrive come effettuare il provisioning di un batch di 17 tenant.</span><span class="sxs-lookup"><span data-stu-id="37cfd-206">This exercise provisions a batch of 17 tenants.</span></span> <span data-ttu-id="37cfd-207">Si consiglia che effettuare il provisioning di questo batch di tenant prima di avviare altre esercitazioni Wingtip SaaS, pertanto non esiste più di pochi toowork database con.</span><span class="sxs-lookup"><span data-stu-id="37cfd-207">It’s recommended you provision this batch of tenants before starting other Wingtip SaaS tutorials, so there's more than just a few databases toowork with.</span></span>

1. <span data-ttu-id="37cfd-208">Apri... \\Moduli learning\\ProvisionAndCatalog\\*Demo ProvisionAndCatalog.ps1* in hello *PowerShell ISE* e modificare hello *$ DemoScenario* too3 parametro:</span><span class="sxs-lookup"><span data-stu-id="37cfd-208">Open ...\\Learning Modules\\ProvisionAndCatalog\\*Demo-ProvisionAndCatalog.ps1* in hello *PowerShell ISE* and change hello *$DemoScenario* parameter too3:</span></span>
   * <span data-ttu-id="37cfd-209">**$DemoScenario** = **3**, modificare anche**3** troppo*il provisioning di un batch di tenant*.</span><span class="sxs-lookup"><span data-stu-id="37cfd-209">**$DemoScenario** = **3**, change too**3** too*Provision a batch of tenants*.</span></span>
1. <span data-ttu-id="37cfd-210">Premere **F5** ed eseguire script hello.</span><span class="sxs-lookup"><span data-stu-id="37cfd-210">Press **F5** and run hello script.</span></span>

<span data-ttu-id="37cfd-211">script Hello distribuisce un batch di altri tenant.</span><span class="sxs-lookup"><span data-stu-id="37cfd-211">hello script deploys a batch of additional tenants.</span></span> <span data-ttu-id="37cfd-212">Usa un [modello di Azure Resource Manager](../azure-resource-manager/resource-manager-template-walkthrough.md) che controlla il batch hello e delega quindi il provisioning di ogni modello di database tooa collegato.</span><span class="sxs-lookup"><span data-stu-id="37cfd-212">It uses an [Azure Resource Manager template](../azure-resource-manager/resource-manager-template-walkthrough.md) that controls hello batch and then delegates provisioning of each database tooa linked template.</span></span> <span data-ttu-id="37cfd-213">L'utilizzo di modelli in questo modo consente Azure Resource Manager toobroker hello processo per lo script di provisioning.</span><span class="sxs-lookup"><span data-stu-id="37cfd-213">Using templates in this way allows Azure Resource Manager toobroker hello provisioning process for your script.</span></span> <span data-ttu-id="37cfd-214">Modelli di eseguire il provisioning di database in parallelo in cui è possibile e gestisce i tentativi, se necessario, hello processo generale di ottimizzazione.</span><span class="sxs-lookup"><span data-stu-id="37cfd-214">Templates provision databases in parallel where it can, and handles retries if needed, optimizing hello overall process.</span></span> <span data-ttu-id="37cfd-215">script Hello è idempotente pertanto, se non riesce o si interrompe per qualsiasi motivo, eseguirlo nuovamente.</span><span class="sxs-lookup"><span data-stu-id="37cfd-215">hello script is idempotent so if it fails or stops for any reason, run it again.</span></span>

### <a name="verify-hello-batch-of-tenants-successfully-deployed"></a><span data-ttu-id="37cfd-216">Verificare i batch di hello di tenant distribuito correttamente</span><span class="sxs-lookup"><span data-stu-id="37cfd-216">Verify hello batch of tenants successfully deployed</span></span>

* <span data-ttu-id="37cfd-217">Aprire hello *tenants1* server selezionando tooyour elenco dei server hello [portale di Azure](https://portal.azure.com), fare clic su **database SQL**e verificare batch hello di 17 database aggiuntivi sono ora Nell'elenco di hello:</span><span class="sxs-lookup"><span data-stu-id="37cfd-217">Open hello *tenants1* server by browsing tooyour list of servers in hello [Azure portal](https://portal.azure.com), click **SQL databases**, and verify hello batch of 17 additional databases are now in hello list:</span></span>

   ![elenco di database](media/sql-database-saas-tutorial-provision-and-catalog/database-list.png)



## <a name="other-provisioning-patterns"></a><span data-ttu-id="37cfd-219">Altri modelli di provisioning</span><span class="sxs-lookup"><span data-stu-id="37cfd-219">Other provisioning patterns</span></span>

<span data-ttu-id="37cfd-220">Gli altri modelli di provisioning non inclusi in questa esercitazione includono:</span><span class="sxs-lookup"><span data-stu-id="37cfd-220">Other provisioning patterns not included in this tutorial include:</span></span>

<span data-ttu-id="37cfd-221">**Pre-provisioning di database.**</span><span class="sxs-lookup"><span data-stu-id="37cfd-221">**Pre-provisioning databases.**</span></span> <span data-ttu-id="37cfd-222">Hello pre-provisioning modello sfrutta il fatto hello che non si aggiungono i database in un pool elastico di costi aggiuntivi.</span><span class="sxs-lookup"><span data-stu-id="37cfd-222">hello pre-provisioning pattern exploits hello fact that databases in an elastic pool do not add extra cost.</span></span> <span data-ttu-id="37cfd-223">Fatturazione per il pool elastico hello, hello non database, così i database inattivi senza risorse.</span><span class="sxs-lookup"><span data-stu-id="37cfd-223">Billing is for hello elastic pool, not hello databases, and idle databases consume no resources.</span></span> <span data-ttu-id="37cfd-224">Effettuando il pre-provisioning dei database in un pool e allocandoli poi all'occorrenza, il tempo di caricamento dei tenant può essere ridotto significativamente.</span><span class="sxs-lookup"><span data-stu-id="37cfd-224">By pre-provisioning databases in a pool and allocating them when needed, tenant onboarding time can be reduced significantly.</span></span> <span data-ttu-id="37cfd-225">numero di Hello di pre-provisioning di database potrebbe modificato come tookeep necessari un buffer adatto per hello anticipato velocità di provisioning.</span><span class="sxs-lookup"><span data-stu-id="37cfd-225">hello number of databases pre-provisioned could be adjusted as needed tookeep a buffer suitable for hello anticipated provisioning rate.</span></span>

<span data-ttu-id="37cfd-226">**Provisioning automatico.**</span><span class="sxs-lookup"><span data-stu-id="37cfd-226">**Auto-provisioning.**</span></span> <span data-ttu-id="37cfd-227">Nel modello di provisioning automatico hello, un servizio di provisioning dedicato è server tooprovision utilizzati e i pool database automaticamente in base alle esigenze, inclusi i database di pre-provisioning nel pool elastico, se lo si desidera.</span><span class="sxs-lookup"><span data-stu-id="37cfd-227">In hello auto-provisioning pattern, a dedicated provisioning service is used tooprovision servers, pools, and databases automatically as needed – including pre-provisioning databases in elastic pools if desired.</span></span> <span data-ttu-id="37cfd-228">E se i database vengono incaricati di deprovisioning ed eliminati, i gap nel pool elastico può essere compilato da hello provisioning del servizio in base alle esigenze.</span><span class="sxs-lookup"><span data-stu-id="37cfd-228">And if databases are de-commissioned and deleted, gaps in elastic pools can be filled by hello provisioning service as desired.</span></span> <span data-ttu-id="37cfd-229">Un servizio di questo tipo può essere semplice o complesso, come nel caso della gestione del provisioning in più aree geografiche, e può includere la configurazione automatica della replica geografica se si usa tale strategia per il ripristino di emergenza.</span><span class="sxs-lookup"><span data-stu-id="37cfd-229">Such a service could be simple or complex – for example, handling provisioning across multiple geographies, and could set up geo-replication automatically if that strategy is being used for disaster recovery.</span></span> <span data-ttu-id="37cfd-230">Con modello di provisioning automatico hello, un'applicazione client o script deve inviare un provisioning toobe coda tooa richiesta elaborata hello provisioning del servizio e potrebbe quindi eseguire il polling completamento toodetermine del servizio hello.</span><span class="sxs-lookup"><span data-stu-id="37cfd-230">With hello auto-provisioning pattern, a client application or script would submit a provisioning request tooa queue toobe processed by hello provisioning service, and would then poll hello service toodetermine completion.</span></span> <span data-ttu-id="37cfd-231">Se viene utilizzato pre-provisioning, le richieste verrebbero gestite rapidamente con servizio di hello gestiscono il provisioning di un database di sostituzione in esecuzione in background hello.</span><span class="sxs-lookup"><span data-stu-id="37cfd-231">If pre-provisioning is used, requests would be handled quickly with hello service managing provisioning of a replacement database running in hello background.</span></span>



## <a name="next-steps"></a><span data-ttu-id="37cfd-232">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="37cfd-232">Next steps</span></span>

<span data-ttu-id="37cfd-233">In questa esercitazione si è appreso come:</span><span class="sxs-lookup"><span data-stu-id="37cfd-233">In this tutorial you learned how to:</span></span>

> [!div class="checklist"]

> * <span data-ttu-id="37cfd-234">Effettuare il provisioning di un nuovo tenant singolo</span><span class="sxs-lookup"><span data-stu-id="37cfd-234">Provision a single new tenant</span></span>
> * <span data-ttu-id="37cfd-235">Effettuare il provisioning di un batch di altri tenant</span><span class="sxs-lookup"><span data-stu-id="37cfd-235">Provision a batch of additional tenants</span></span>
> * <span data-ttu-id="37cfd-236">Esegui istruzione dettagli hello del tenant di provisioning e registrarli nel catalogo di hello</span><span class="sxs-lookup"><span data-stu-id="37cfd-236">Step into hello details of provisioning tenants, and registering them into hello catalog</span></span>

<span data-ttu-id="37cfd-237">Provare a hello [esercitazione di monitoraggio delle prestazioni](sql-database-saas-tutorial-performance-monitoring.md).</span><span class="sxs-lookup"><span data-stu-id="37cfd-237">Try hello [Performance monitoring tutorial](sql-database-saas-tutorial-performance-monitoring.md).</span></span>

## <a name="additional-resources"></a><span data-ttu-id="37cfd-238">Risorse aggiuntive</span><span class="sxs-lookup"><span data-stu-id="37cfd-238">Additional Resources</span></span>

* <span data-ttu-id="37cfd-239">Ulteriori [esercitazioni in cui si basano su hello applicazione SaaS Wingtip](sql-database-wtp-overview.md#sql-database-wingtip-saas-tutorials)</span><span class="sxs-lookup"><span data-stu-id="37cfd-239">Additional [tutorials that build upon hello Wingtip SaaS application](sql-database-wtp-overview.md#sql-database-wingtip-saas-tutorials)</span></span>
* [<span data-ttu-id="37cfd-240">Libreria client dei database elastici</span><span class="sxs-lookup"><span data-stu-id="37cfd-240">Elastic database client library</span></span>](https://docs.microsoft.com/azure/sql-database/sql-database-elastic-database-client-library)
* [<span data-ttu-id="37cfd-241">Come tooDebug gli script in Windows PowerShell ISE</span><span class="sxs-lookup"><span data-stu-id="37cfd-241">How tooDebug Scripts in Windows PowerShell ISE</span></span>](https://msdn.microsoft.com/powershell/scripting/core-powershell/ise/how-to-debug-scripts-in-windows-powershell-ise)
