---
title: "scalabilità con funzioni Analitica di flusso di Azure e Azure ml aaaJob | Documenti Microsoft"
description: "Informazioni su come tooproperly ridimensionare i processi di flusso Analitica (partizionamento, SU quantità e altro ancora) quando si utilizzano funzioni di Azure Machine Learning."
keywords: 
documentationcenter: 
services: stream-analytics
author: jeffstokes72
manager: jhubbard
editor: cgronlun
ms.assetid: 47ce7c5e-1de1-41ca-9a26-b5ecce814743
ms.service: stream-analytics
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: data-services
ms.date: 03/28/2017
ms.author: jeffstok
ms.openlocfilehash: 3fbdfaf7e8e86896c56f1d18bbde3a10bd3dca04
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/06/2017
---
# <a name="scale-your-stream-analytics-job-with-azure-machine-learning-functions"></a><span data-ttu-id="58dec-103">Ridimensionare il processo di Analisi di flusso con funzioni di Azure Machine Learning</span><span class="sxs-lookup"><span data-stu-id="58dec-103">Scale your Stream Analytics job with Azure Machine Learning functions</span></span>
<span data-ttu-id="58dec-104">È spesso molto semplice tooset backup di un processo di flusso Analitica e attraversare alcuni dati di esempio.</span><span class="sxs-lookup"><span data-stu-id="58dec-104">It is often quite easy tooset up an Stream Analytics job and run some sample data through it.</span></span> <span data-ttu-id="58dec-105">Cosa è necessario creare quando è necessario toorun hello stesso processo con volume di dati maggiore?</span><span class="sxs-lookup"><span data-stu-id="58dec-105">What should we do when we need toorun hello same job with higher data volume?</span></span> <span data-ttu-id="58dec-106">Richiede Microsoft toounderstand come tooconfigure hello Analitica di flusso del processo in modo che consente di scalare.</span><span class="sxs-lookup"><span data-stu-id="58dec-106">It requires us toounderstand how tooconfigure hello Stream Analytics job so that it will scale.</span></span> <span data-ttu-id="58dec-107">In questo documento, esamineremo hello speciali aspetti ridimensionamento Analitica flusso i processi con funzioni di Machine Learning.</span><span class="sxs-lookup"><span data-stu-id="58dec-107">In this document, we will focus on hello special aspects of scaling Stream Analytics jobs with Machine Learning functions.</span></span> <span data-ttu-id="58dec-108">Per informazioni su come i processi di flusso Analitica tooscale in genere vedere l'articolo di hello [scalabilità dei processi](stream-analytics-scale-jobs.md).</span><span class="sxs-lookup"><span data-stu-id="58dec-108">For information on how tooscale Stream Analytics jobs in general see hello article [Scaling jobs](stream-analytics-scale-jobs.md).</span></span>

## <a name="what-is-an-azure-machine-learning-function-in-stream-analytics"></a><span data-ttu-id="58dec-109">Che cos'è una funzione di Azure Machine Learning in Analisi di flusso?</span><span class="sxs-lookup"><span data-stu-id="58dec-109">What is an Azure Machine Learning function in Stream Analytics?</span></span>
<span data-ttu-id="58dec-110">Una funzione di Machine Learning in flusso Analitica può essere utilizzata come una normale chiamata di funzione nel linguaggio di query flusso Analitica hello.</span><span class="sxs-lookup"><span data-stu-id="58dec-110">A Machine Learning function in Stream Analytics can be used like a regular function call in hello Stream Analytics query language.</span></span> <span data-ttu-id="58dec-111">Dietro la scena hello, tuttavia, le chiamate di funzione hello sono effettivamente le richieste di servizio Web di Azure Machine Learning.</span><span class="sxs-lookup"><span data-stu-id="58dec-111">However, behind hello scene, hello function calls are actually Azure Machine Learning Web Service requests.</span></span> <span data-ttu-id="58dec-112">Machine Learning ai servizi web "batch", più righe, che viene chiamato batch minima, in hello stesso web chiamata API al servizio, tooimprove velocità effettiva complessiva.</span><span class="sxs-lookup"><span data-stu-id="58dec-112">Machine Learning web services support “batching” multiple rows, which is called mini-batch, in hello same web service API call, tooimprove overall throughput.</span></span> <span data-ttu-id="58dec-113">Vedere i seguenti articoli per altri dettagli; hello [Le funzioni di azure Machine Learning in flusso Analitica](https://blogs.technet.microsoft.com/machinelearning/2015/12/10/azure-ml-now-available-as-a-function-in-azure-stream-analytics/) e [servizi Web di Azure Machine Learning](../machine-learning/machine-learning-consume-web-services.md).</span><span class="sxs-lookup"><span data-stu-id="58dec-113">Please see hello following articles for more details; [Azure Machine Learning functions in Stream Analytics](https://blogs.technet.microsoft.com/machinelearning/2015/12/10/azure-ml-now-available-as-a-function-in-azure-stream-analytics/) and [Azure Machine Learning Web Services](../machine-learning/machine-learning-consume-web-services.md).</span></span>

## <a name="configure-a-stream-analytics-job-with-machine-learning-functions"></a><span data-ttu-id="58dec-114">Configurare un processo di Analisi di flusso con funzioni di Machine Learning</span><span class="sxs-lookup"><span data-stu-id="58dec-114">Configure a Stream Analytics job with Machine Learning functions</span></span>
<span data-ttu-id="58dec-115">Quando si configura una funzione di Machine Learning per il processo di flusso Analitica, esistono due parametri tooconsider, dimensioni dei batch hello di chiamate di funzione di Machine Learning hello hello unità (SUs), il provisioning per il processo di flusso Analitica hello di streaming.</span><span class="sxs-lookup"><span data-stu-id="58dec-115">When configuring a Machine Learning function for Stream Analytics job, there are two parameters tooconsider, hello batch size of hello Machine Learning function calls, and hello streaming units (SUs) provisioned for hello Stream Analytics job.</span></span> <span data-ttu-id="58dec-116">toodetermine hello i valori appropriati per questi, prima di tutto un occorre tra la latenza e velocità effettiva, vale a dire, latenza del processo di flusso Analitica hello e la velocità effettiva di ogni SU.</span><span class="sxs-lookup"><span data-stu-id="58dec-116">toodetermine hello appropriate values for these, first a decision must be made between latency and throughput, that is, latency of hello Stream Analytics job, and throughput of each SU.</span></span> <span data-ttu-id="58dec-117">SUs possono essere aggiunti sempre velocità effettiva di tooincrease processo tooa di una query con partizionamento efficiente flusso Analitica, sebbene SUs aggiuntive aumento del costo di hello di processo hello in esecuzione.</span><span class="sxs-lookup"><span data-stu-id="58dec-117">SUs may always be added tooa job tooincrease throughput of a well partitioned Stream Analytics query, although additional SUs increases hello cost of running hello job.</span></span>

<span data-ttu-id="58dec-118">È pertanto importante toodetermine hello *tolleranza* di latenza in esecuzione un processo di flusso Analitica.</span><span class="sxs-lookup"><span data-stu-id="58dec-118">Therefore it is important toodetermine hello *tolerance* of latency in running a Stream Analytics job.</span></span> <span data-ttu-id="58dec-119">Latenza aggiuntiva dall'esecuzione di richieste di servizio di Azure Machine Learning naturalmente aumenterà con dimensioni di batch, che verranno composto latenza hello del processo di flusso Analitica hello.</span><span class="sxs-lookup"><span data-stu-id="58dec-119">Additional latency from running Azure Machine Learning service requests will naturally increase with batch size, which will compound hello latency of hello Stream Analytics job.</span></span> <span data-ttu-id="58dec-120">Invece, l'aumento delle dimensioni del batch hello consente hello Analitica flusso processo tooprocess * più eventi con hello *stesso numero* di Machine Learning richieste di servizio web.</span><span class="sxs-lookup"><span data-stu-id="58dec-120">On hello other hand, increasing batch size allows hello Stream Analytics job tooprocess *more events with hello *same number* of Machine Learning web service requests.</span></span> <span data-ttu-id="58dec-121">Spesso il hello aumento della latenza di servizio web Machine Learning è Sub lineare toohello aumento delle dimensioni di batch, pertanto è importante tooconsider hello più dimensioni del batch per un servizio web Machine Learning in qualsiasi situazione specificata.</span><span class="sxs-lookup"><span data-stu-id="58dec-121">Often hello increase of Machine Learning web service latency is sub-linear toohello increase of batch size so it is important tooconsider hello most cost-efficient batch size for a Machine Learning web service in any given situation.</span></span> <span data-ttu-id="58dec-122">dimensioni di batch Hello predefinite per il servizio web hello richieste è 1000 e può essere modificato tramite l'utilizzo di hello [API REST di flusso Analitica](https://msdn.microsoft.com/library/mt653706.aspx "API REST di flusso Analitica") o hello [PowerShell client per flusso Analitica](stream-analytics-monitor-and-manage-jobs-use-powershell.md "client di PowerShell per Analitica flusso").</span><span class="sxs-lookup"><span data-stu-id="58dec-122">hello default batch size for hello web service requests is 1000 and may be modified either by using hello [Stream Analytics REST API](https://msdn.microsoft.com/library/mt653706.aspx "Stream Analytics REST API") or hello [PowerShell client for Stream Analytics](stream-analytics-monitor-and-manage-jobs-use-powershell.md "PowerShell client for Stream Analytics").</span></span>

<span data-ttu-id="58dec-123">Dopo aver determinato un batch di dimensioni, quantità hello di streaming unità (SUs) può essere determinata, in base hello numero di eventi che la funzione hello deve tooprocess al secondo.</span><span class="sxs-lookup"><span data-stu-id="58dec-123">Once a batch size has been determined, hello amount of streaming units (SUs) can be determined, based on hello number of events that hello function needs tooprocess per second.</span></span> <span data-ttu-id="58dec-124">Per altre informazioni sulle unità di streaming, vedere [Processi di scalabilità di Analisi di flusso](stream-analytics-scale-jobs.md).</span><span class="sxs-lookup"><span data-stu-id="58dec-124">For more information about streaming units, see [Stream Analytics scale jobs](stream-analytics-scale-jobs.md).</span></span>

<span data-ttu-id="58dec-125">In generale, vi sono 20 connessioni simultanee servizio web di Machine Learning toohello per ogni 6 SUs, ad eccezione del fatto che i processi di SU 1 e 3 SU verrà visualizzato anche 20 connessioni simultanee.</span><span class="sxs-lookup"><span data-stu-id="58dec-125">In general, there are 20 concurrent connections toohello Machine Learning web service for every 6 SUs, except that 1 SU jobs and 3 SU jobs will get 20 concurrent connections also.</span></span>  <span data-ttu-id="58dec-126">Se, ad esempio, velocità di dati di input hello è 200.000 eventi al secondo e dimensioni del batch hello viene lasciata toohello predefinito è 1000 hello risultante web servizio latenza con mini-batch di 1000 eventi è 200 ms.</span><span class="sxs-lookup"><span data-stu-id="58dec-126">For example, if hello input data rate is 200,000 events per second and hello batch size is left toohello default of 1000 hello resulting web service latency with 1000 events mini-batch is 200ms.</span></span> <span data-ttu-id="58dec-127">Ciò significa che ogni connessione può effettuare 5 richieste toohello servizio web di Machine Learning in un secondo.</span><span class="sxs-lookup"><span data-stu-id="58dec-127">This means every connection can make 5 requests toohello Machine Learning web service in a second.</span></span> <span data-ttu-id="58dec-128">Con 20 connessioni, il processo di flusso Analitica hello può elaborare 20.000 eventi in 200 ms e pertanto a 100.000 eventi in un secondo.</span><span class="sxs-lookup"><span data-stu-id="58dec-128">With 20 connections, hello Stream Analytics job can process 20,000 events in 200ms  and therefore 100,000 events in a second.</span></span> <span data-ttu-id="58dec-129">Pertanto tooprocess 200.000 eventi al secondo, il processo di flusso Analitica hello deve 40 connessioni simultanee, ossia too12 SUs.</span><span class="sxs-lookup"><span data-stu-id="58dec-129">So tooprocess 200,000 events per second, hello Stream Analytics job needs 40 concurrent connections, which comes out too12 SUs.</span></span> <span data-ttu-id="58dec-130">diagramma di Hello seguente illustra le richieste di hello hello Analitica flusso processo toohello Machine Learning endpoint di servizio web: ogni 6 SUs include servizio web di Learning tooMachine di 20 connessioni simultanee a max.</span><span class="sxs-lookup"><span data-stu-id="58dec-130">hello diagram below illustrates hello requests from hello Stream Analytics job toohello Machine Learning web service endpoint – Every 6 SUs has 20 concurrent connections tooMachine Learning web service at max.</span></span>

<span data-ttu-id="58dec-131">![Esempio di processo per ridimensionare Analisi di flusso con funzioni di Machine Learning 2](./media/stream-analytics-scale-with-ml-functions/stream-analytics-scale-with-ml-functions-00.png "Esempio di processo per ridimensionare Analisi di flusso con funzioni di Machine Learning 2")</span><span class="sxs-lookup"><span data-stu-id="58dec-131">![Scale Stream Analytics with Machine Learning Functions 2 job example](./media/stream-analytics-scale-with-ml-functions/stream-analytics-scale-with-ml-functions-00.png "Scale Stream Analytics with Machine Learning Functions 2 job example")</span></span>

<span data-ttu-id="58dec-132">In generale, ***B*** per le dimensioni del batch, ***L*** per la latenza di servizio web hello dimensioni batch B in millisecondi, hello velocità effettiva di un processo di flusso Analitica con ***N*** SUs è:</span><span class="sxs-lookup"><span data-stu-id="58dec-132">In general, ***B*** for batch size, ***L*** for hello web service latency at batch size B in milliseconds, hello throughput of an Stream Analytics job with ***N*** SUs is:</span></span>

<span data-ttu-id="58dec-133">![Formula per ridimensionare Analisi di flusso con funzioni di Machine Learning](./media/stream-analytics-scale-with-ml-functions/stream-analytics-scale-with-ml-functions-02.png "Formula per ridimensionare Analisi di flusso con funzioni di Machine Learning")</span><span class="sxs-lookup"><span data-stu-id="58dec-133">![Scale Stream Analytics with Machine Learning Functions Formula](./media/stream-analytics-scale-with-ml-functions/stream-analytics-scale-with-ml-functions-02.png "Scale Stream Analytics with Machine Learning Functions Formula")</span></span>

<span data-ttu-id="58dec-134">Un'ulteriore considerazione potrebbe essere hello 'max concurrent calls' sul lato servizio web di Machine Learning hello, si consiglia di tooset questo valore massimo toohello (attualmente 200).</span><span class="sxs-lookup"><span data-stu-id="58dec-134">An additional consideration may be hello 'max concurrent calls' on hello Machine Learning web service side, it’s recommended tooset this toohello maximum value (200 currently).</span></span>

<span data-ttu-id="58dec-135">Per ulteriori informazioni su questa impostazione Controlla hello [articolo Scaling per servizi Web di Machine Learning](../machine-learning/machine-learning-scaling-webservice.md).</span><span class="sxs-lookup"><span data-stu-id="58dec-135">For more information on this setting please review hello [Scaling article for Machine Learning Web Services](../machine-learning/machine-learning-scaling-webservice.md).</span></span>

## <a name="example--sentiment-analysis"></a><span data-ttu-id="58dec-136">Esempio: Analisi di valutazione</span><span class="sxs-lookup"><span data-stu-id="58dec-136">Example – Sentiment Analysis</span></span>
<span data-ttu-id="58dec-137">Hello esempio seguente include un processo di flusso Analitica con l'analisi del sentiment hello funzione Machine Learning, come descritto in hello [esercitazione integrazione flusso Analitica Machine Learning](stream-analytics-machine-learning-integration-tutorial.md).</span><span class="sxs-lookup"><span data-stu-id="58dec-137">hello following example includes a Stream Analytics job with hello sentiment analysis Machine Learning function, as described in hello [Stream Analytics Machine Learning integration tutorial](stream-analytics-machine-learning-integration-tutorial.md).</span></span>

<span data-ttu-id="58dec-138">query Hello è una semplice query completamente partizionata seguita da hello **sentiment** funzione, come illustrato di seguito:</span><span class="sxs-lookup"><span data-stu-id="58dec-138">hello query is a simple fully partitioned query followed by hello **sentiment** function, as shown below:</span></span>

    WITH subquery AS (
        SELECT text, sentiment(text) as result from input
    )

    Select text, result.[Score]
    Into output
    From subquery

<span data-ttu-id="58dec-139">Prendere in considerazione hello seguente scenario. con una velocità effettiva di 10.000 TWEET al secondo un processo di flusso Analitica è necessario creare analisi del sentiment tooperform di tweet hello (eventi).</span><span class="sxs-lookup"><span data-stu-id="58dec-139">Consider hello following scenario; with a throughput of 10,000 tweets per second a Stream Analytics job must be created tooperform sentiment analysis of hello tweets (events).</span></span> <span data-ttu-id="58dec-140">Utilizzando 1 SU, il processo di flusso Analitica possibile toohandle in grado di traffico di hello?</span><span class="sxs-lookup"><span data-stu-id="58dec-140">Using 1 SU, could this Stream Analytics job be able toohandle hello traffic?</span></span> <span data-ttu-id="58dec-141">Utilizzando dimensioni batch predefinito di hello del processo di hello 1000 dovrebbe essere in grado di tookeep backup con input hello.</span><span class="sxs-lookup"><span data-stu-id="58dec-141">Using hello default batch size of 1000 hello job should be able tookeep up with hello input.</span></span> <span data-ttu-id="58dec-142">Ulteriore hello aggiunto funzione Machine Learning deve generare non più di un secondo di latenza, ovvero la latenza hello predefinita generale di analisi del sentiment hello servizio web Machine Learning (con una dimensione di batch predefinito di 1000).</span><span class="sxs-lookup"><span data-stu-id="58dec-142">Further hello added Machine Learning function should generate no more than a second of latency, which is hello general default latency of hello sentiment analysis Machine Learning web service (with a default batch size of 1000).</span></span> <span data-ttu-id="58dec-143">processo di Hello Analitica flusso **complessivo** o latenza end-to-end in genere pochi secondi.</span><span class="sxs-lookup"><span data-stu-id="58dec-143">hello Stream Analytics job’s **overall** or end-to-end latency would typically be a few seconds.</span></span> <span data-ttu-id="58dec-144">Eseguire un'analisi più approfondita in questo processo di flusso Analitica, *particolarmente* hello chiamate di funzione di Machine Learning.</span><span class="sxs-lookup"><span data-stu-id="58dec-144">Take a more detailed look into this Stream Analytics job, *especially* hello Machine Learning function calls.</span></span> <span data-ttu-id="58dec-145">Con dimensioni di batch hello 1000, una velocità effettiva di 10.000 eventi richiederà circa 10 richieste tooweb servizio.</span><span class="sxs-lookup"><span data-stu-id="58dec-145">Having hello batch size as 1000, a throughput of 10,000 events will take about 10 requests tooweb service.</span></span> <span data-ttu-id="58dec-146">Anche con 1 SU, sono disponibili sufficienti tooaccommodate connessioni simultanee del traffico di input.</span><span class="sxs-lookup"><span data-stu-id="58dec-146">Even with 1 SU, there are enough concurrent connections tooaccommodate this input traffic.</span></span>

<span data-ttu-id="58dec-147">Ma cosa accade se aumenta la frequenza di eventi di input hello x 100 e ora il processo di flusso Analitica hello deve tooprocess 1.000.000 TWEET al secondo?</span><span class="sxs-lookup"><span data-stu-id="58dec-147">But what if hello input event rate increases by 100x and now hello Stream Analytics job needs tooprocess 1,000,000 tweets per second?</span></span> <span data-ttu-id="58dec-148">Sono disponibili due opzioni:</span><span class="sxs-lookup"><span data-stu-id="58dec-148">There are two options:</span></span>

1. <span data-ttu-id="58dec-149">Aumentare la dimensione di batch hello, o</span><span class="sxs-lookup"><span data-stu-id="58dec-149">Increase hello batch size, or</span></span>
2. <span data-ttu-id="58dec-150">Eventi partizione hello flusso di input tooprocess hello in parallelo</span><span class="sxs-lookup"><span data-stu-id="58dec-150">Partition hello input stream tooprocess hello events in parallel</span></span>

<span data-ttu-id="58dec-151">Con l'opzione prima di hello, hello processo **latenza** aumenterà.</span><span class="sxs-lookup"><span data-stu-id="58dec-151">With hello first option, hello job **latency** will increase.</span></span>

<span data-ttu-id="58dec-152">Con l'opzione secondo hello, SUs ulteriori sarebbe necessario toobe il provisioning e pertanto genera simultanea di più richieste di servizio web Machine Learning.</span><span class="sxs-lookup"><span data-stu-id="58dec-152">With hello second option, more SUs would need toobe provisioned and therefore generate more concurrent Machine Learning web service requests.</span></span> <span data-ttu-id="58dec-153">Ciò significa che il processo di hello **costo** aumenterà.</span><span class="sxs-lookup"><span data-stu-id="58dec-153">This means hello job **cost** will increase.</span></span>

<span data-ttu-id="58dec-154">Si supponga di latenza hello di analisi del sentiment hello servizio web Machine Learning è 200 ms per i batch di 1000 eventi o di sotto, 250ms per i batch 5.000 eventi 300 MS di batch di eventi di 10.000 o 500ms per i batch di eventi di 25.000.</span><span class="sxs-lookup"><span data-stu-id="58dec-154">Assume hello latency of hello sentiment analysis Machine Learning web service is 200ms for 1000-event batches or below, 250ms for 5,000-event batches, 300ms for 10,000-event batches or 500ms for 25,000-event batches.</span></span>

1. <span data-ttu-id="58dec-155">Opzione hello prima, (**non** provisioning più SUs), potrebbero aumentare le dimensioni di batch hello troppo**25.000**.</span><span class="sxs-lookup"><span data-stu-id="58dec-155">Using hello first option, (**not** provisioning more SUs), hello batch size could be increased too**25,000**.</span></span> <span data-ttu-id="58dec-156">Ciò a sua volta consente hello processo tooprocess 1.000.000 eventi con 20 connessioni simultanee toohello servizio web Machine Learning (con una latenza di 500 ms per ogni chiamata).</span><span class="sxs-lookup"><span data-stu-id="58dec-156">This in turn would allow hello job tooprocess 1,000,000 events with 20 concurrent connections toohello Machine Learning web service (with a latency of 500ms per call).</span></span> <span data-ttu-id="58dec-157">Pertanto hello latenza aggiuntiva del processo di flusso Analitica hello a causa di richieste di funzione sentiment toohello contro hello aumenterebbe da richieste di servizio web di Machine Learning **200 ms** troppo**500ms**.</span><span class="sxs-lookup"><span data-stu-id="58dec-157">So hello additional latency of hello Stream Analytics job due toohello sentiment function requests against hello Machine Learning web service requests would be increased from **200ms** too**500ms**.</span></span> <span data-ttu-id="58dec-158">Si noti, tuttavia, tali dimensioni di batch **Impossibile** aumentato all'infinito come servizi web Machine Learning hello richiede hello payload dimensioni di una richiesta di 4 MB o più piccolo web timeout delle richieste di servizio dopo 100 secondi dell'operazione.</span><span class="sxs-lookup"><span data-stu-id="58dec-158">However, note that batch size **cannot** be increased infinitely as hello Machine Learning web services requires hello payload size of a request be 4MB or smaller web service requests timeout after 100 seconds of operation.</span></span>
2. <span data-ttu-id="58dec-159">Opzione hello secondo, dimensioni del batch hello viene lasciata 1000, con una latenza di servizio web di 200 ms, tutti i servizi web toohello 20 connessioni simultanee sarebbe in grado di tooprocess 1000 * 20 * 5 eventi = 100.000 al secondo.</span><span class="sxs-lookup"><span data-stu-id="58dec-159">Using hello second option, hello batch size is left at 1000, with 200ms web service latency, every 20 concurrent connections toohello web service would be able tooprocess 1000 * 20 * 5 events = 100,000 per second.</span></span> <span data-ttu-id="58dec-160">Pertanto gli eventi di 1.000.000 tooprocess per processo hello secondo, sarebbe necessario 60 SUs.</span><span class="sxs-lookup"><span data-stu-id="58dec-160">So tooprocess 1,000,000 events per second, hello job would need 60 SUs.</span></span> <span data-ttu-id="58dec-161">Toohello confrontati prima opzione Analitica flusso processo renderebbe più web evadere le richieste batch, a sua volta la generazione di un aumento dei costi.</span><span class="sxs-lookup"><span data-stu-id="58dec-161">Compared toohello first option, Stream Analytics job would make more web service batch requests, in turn generating an increased cost.</span></span>

<span data-ttu-id="58dec-162">Di seguito è una tabella per la velocità effettiva di hello del processo di flusso Analitica hello per SUs diverso e le dimensioni di batch (in numero di eventi al secondo).</span><span class="sxs-lookup"><span data-stu-id="58dec-162">Below is a table for hello throughput of hello Stream Analytics job for different SUs and batch sizes (in number of events per second).</span></span>

| <span data-ttu-id="58dec-163">Dimensioni batch (latenza ML)</span><span class="sxs-lookup"><span data-stu-id="58dec-163">batch size (ML latency)</span></span> | <span data-ttu-id="58dec-164">500 (200 ms)</span><span class="sxs-lookup"><span data-stu-id="58dec-164">500 (200ms)</span></span> | <span data-ttu-id="58dec-165">1.000 (200 ms)</span><span class="sxs-lookup"><span data-stu-id="58dec-165">1,000 (200ms)</span></span> | <span data-ttu-id="58dec-166">5.000 (250 ms)</span><span class="sxs-lookup"><span data-stu-id="58dec-166">5,000 (250ms)</span></span> | <span data-ttu-id="58dec-167">10.000 (300 ms)</span><span class="sxs-lookup"><span data-stu-id="58dec-167">10,000 (300ms)</span></span> | <span data-ttu-id="58dec-168">25.000 (500 ms)</span><span class="sxs-lookup"><span data-stu-id="58dec-168">25,000 (500ms)</span></span> |
| --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="58dec-169">**1 unità di archiviazione**</span><span class="sxs-lookup"><span data-stu-id="58dec-169">**1 SU**</span></span> |<span data-ttu-id="58dec-170">2.500</span><span class="sxs-lookup"><span data-stu-id="58dec-170">2,500</span></span> |<span data-ttu-id="58dec-171">5.000</span><span class="sxs-lookup"><span data-stu-id="58dec-171">5,000</span></span> |<span data-ttu-id="58dec-172">20.000</span><span class="sxs-lookup"><span data-stu-id="58dec-172">20,000</span></span> |<span data-ttu-id="58dec-173">30.000</span><span class="sxs-lookup"><span data-stu-id="58dec-173">30,000</span></span> |<span data-ttu-id="58dec-174">50.000</span><span class="sxs-lookup"><span data-stu-id="58dec-174">50,000</span></span> |
| <span data-ttu-id="58dec-175">**3 unità di archiviazione**</span><span class="sxs-lookup"><span data-stu-id="58dec-175">**3 SUs**</span></span> |<span data-ttu-id="58dec-176">2.500</span><span class="sxs-lookup"><span data-stu-id="58dec-176">2,500</span></span> |<span data-ttu-id="58dec-177">5.000</span><span class="sxs-lookup"><span data-stu-id="58dec-177">5,000</span></span> |<span data-ttu-id="58dec-178">20.000</span><span class="sxs-lookup"><span data-stu-id="58dec-178">20,000</span></span> |<span data-ttu-id="58dec-179">30.000</span><span class="sxs-lookup"><span data-stu-id="58dec-179">30,000</span></span> |<span data-ttu-id="58dec-180">50.000</span><span class="sxs-lookup"><span data-stu-id="58dec-180">50,000</span></span> |
| <span data-ttu-id="58dec-181">**6 unità di archiviazione**</span><span class="sxs-lookup"><span data-stu-id="58dec-181">**6 SUs**</span></span> |<span data-ttu-id="58dec-182">2.500</span><span class="sxs-lookup"><span data-stu-id="58dec-182">2,500</span></span> |<span data-ttu-id="58dec-183">5.000</span><span class="sxs-lookup"><span data-stu-id="58dec-183">5,000</span></span> |<span data-ttu-id="58dec-184">20.000</span><span class="sxs-lookup"><span data-stu-id="58dec-184">20,000</span></span> |<span data-ttu-id="58dec-185">30.000</span><span class="sxs-lookup"><span data-stu-id="58dec-185">30,000</span></span> |<span data-ttu-id="58dec-186">50.000</span><span class="sxs-lookup"><span data-stu-id="58dec-186">50,000</span></span> |
| <span data-ttu-id="58dec-187">**12 unità di archiviazione**</span><span class="sxs-lookup"><span data-stu-id="58dec-187">**12 SUs**</span></span> |<span data-ttu-id="58dec-188">5.000</span><span class="sxs-lookup"><span data-stu-id="58dec-188">5,000</span></span> |<span data-ttu-id="58dec-189">10.000</span><span class="sxs-lookup"><span data-stu-id="58dec-189">10,000</span></span> |<span data-ttu-id="58dec-190">40.000</span><span class="sxs-lookup"><span data-stu-id="58dec-190">40,000</span></span> |<span data-ttu-id="58dec-191">60.000</span><span class="sxs-lookup"><span data-stu-id="58dec-191">60,000</span></span> |<span data-ttu-id="58dec-192">100.000</span><span class="sxs-lookup"><span data-stu-id="58dec-192">100,000</span></span> |
| <span data-ttu-id="58dec-193">**18 unità di archiviazione**</span><span class="sxs-lookup"><span data-stu-id="58dec-193">**18 SUs**</span></span> |<span data-ttu-id="58dec-194">7.500</span><span class="sxs-lookup"><span data-stu-id="58dec-194">7,500</span></span> |<span data-ttu-id="58dec-195">15.000</span><span class="sxs-lookup"><span data-stu-id="58dec-195">15,000</span></span> |<span data-ttu-id="58dec-196">60.000</span><span class="sxs-lookup"><span data-stu-id="58dec-196">60,000</span></span> |<span data-ttu-id="58dec-197">90.000</span><span class="sxs-lookup"><span data-stu-id="58dec-197">90,000</span></span> |<span data-ttu-id="58dec-198">150.000</span><span class="sxs-lookup"><span data-stu-id="58dec-198">150,000</span></span> |
| <span data-ttu-id="58dec-199">**24 unità di archiviazione**</span><span class="sxs-lookup"><span data-stu-id="58dec-199">**24 SUs**</span></span> |<span data-ttu-id="58dec-200">10.000</span><span class="sxs-lookup"><span data-stu-id="58dec-200">10,000</span></span> |<span data-ttu-id="58dec-201">20.000</span><span class="sxs-lookup"><span data-stu-id="58dec-201">20,000</span></span> |<span data-ttu-id="58dec-202">80.000</span><span class="sxs-lookup"><span data-stu-id="58dec-202">80,000</span></span> |<span data-ttu-id="58dec-203">120.000</span><span class="sxs-lookup"><span data-stu-id="58dec-203">120,000</span></span> |<span data-ttu-id="58dec-204">200.000</span><span class="sxs-lookup"><span data-stu-id="58dec-204">200,000</span></span> |
| <span data-ttu-id="58dec-205">**…**</span><span class="sxs-lookup"><span data-stu-id="58dec-205">**…**</span></span> |<span data-ttu-id="58dec-206">…</span><span class="sxs-lookup"><span data-stu-id="58dec-206">…</span></span> |<span data-ttu-id="58dec-207">…</span><span class="sxs-lookup"><span data-stu-id="58dec-207">…</span></span> |<span data-ttu-id="58dec-208">…</span><span class="sxs-lookup"><span data-stu-id="58dec-208">…</span></span> |<span data-ttu-id="58dec-209">…</span><span class="sxs-lookup"><span data-stu-id="58dec-209">…</span></span> |<span data-ttu-id="58dec-210">…</span><span class="sxs-lookup"><span data-stu-id="58dec-210">…</span></span> |
| <span data-ttu-id="58dec-211">**60 unità di archiviazione**</span><span class="sxs-lookup"><span data-stu-id="58dec-211">**60 SUs**</span></span> |<span data-ttu-id="58dec-212">25.000</span><span class="sxs-lookup"><span data-stu-id="58dec-212">25,000</span></span> |<span data-ttu-id="58dec-213">50.000</span><span class="sxs-lookup"><span data-stu-id="58dec-213">50,000</span></span> |<span data-ttu-id="58dec-214">200.000</span><span class="sxs-lookup"><span data-stu-id="58dec-214">200,000</span></span> |<span data-ttu-id="58dec-215">300.000</span><span class="sxs-lookup"><span data-stu-id="58dec-215">300,000</span></span> |<span data-ttu-id="58dec-216">500.000</span><span class="sxs-lookup"><span data-stu-id="58dec-216">500,000</span></span> |

<span data-ttu-id="58dec-217">A questo punto dovrebbe essere chiaro il funzionamento delle funzioni di Machine Learning in Analisi di flusso.</span><span class="sxs-lookup"><span data-stu-id="58dec-217">By now, you should already have a good understanding of how Machine Learning functions in Stream Analytics work.</span></span> <span data-ttu-id="58dec-218">È probabile che anche comprendere che "pull" di dati da origini dati e ogni "pull" restituisce un batch di eventi per i processi di flusso Analitica hello tooprocess processo flusso Analitica.</span><span class="sxs-lookup"><span data-stu-id="58dec-218">You likely also understand that Stream Analytics jobs “pull” data from data sources and each “pull” returns a batch of events for hello Stream Analytics job tooprocess.</span></span> <span data-ttu-id="58dec-219">Impatto di richieste del servizio web Machine Learning hello modello pull</span><span class="sxs-lookup"><span data-stu-id="58dec-219">How does this pull model impact hello Machine Learning web service requests?</span></span>

<span data-ttu-id="58dec-220">In genere, le dimensioni di batch hello che è impostati per le funzioni di Machine Learning sarà esattamente divisibile per hello numero di eventi restituiti da ogni processo di flusso Analitica "pull".</span><span class="sxs-lookup"><span data-stu-id="58dec-220">Normally, hello batch size we set for Machine Learning functions won’t exactly be divisible by hello number of events returned by each Stream Analytics job “pull”.</span></span> <span data-ttu-id="58dec-221">Quando ciò si verifica con batch "parziale" verrà chiamato il servizio web Machine Learning hello.</span><span class="sxs-lookup"><span data-stu-id="58dec-221">When this occurs hello Machine Learning web service will be called with “partial” batches.</span></span> <span data-ttu-id="58dec-222">Questa operazione viene eseguita toonot comportano la latenza di processi aggiuntivi overhead negli eventi coalescing da toopull pull.</span><span class="sxs-lookup"><span data-stu-id="58dec-222">This is done toonot incur additional job latency overhead in coalescing events from pull toopull.</span></span>

## <a name="new-function-related-monitoring-metrics"></a><span data-ttu-id="58dec-223">Nuove metriche di monitoraggio correlate alle funzioni</span><span class="sxs-lookup"><span data-stu-id="58dec-223">New function-related monitoring metrics</span></span>
<span data-ttu-id="58dec-224">Nell'area di monitoraggio di un processo di flusso Analitica hello, sono state aggiunte tre altre metriche correlate alla funzione.</span><span class="sxs-lookup"><span data-stu-id="58dec-224">In hello Monitor area of a Stream Analytics job, three additional function-related metrics have been added.</span></span> <span data-ttu-id="58dec-225">Sono le richieste di funzioni, gli eventi di funzione e richieste non riuscite di funzione, come illustrato nella figura hello riportato di seguito.</span><span class="sxs-lookup"><span data-stu-id="58dec-225">They are FUNCTION REQUESTS, FUNCTION EVENTS and FAILED FUNCTION REQUESTS, as shown in hello graphic below.</span></span>

<span data-ttu-id="58dec-226">![Metriche per ridimensionare Analisi di flusso con funzioni di Machine Learning](./media/stream-analytics-scale-with-ml-functions/stream-analytics-scale-with-ml-functions-01.png "Metriche per ridimensionare Analisi di flusso con funzioni di Machine Learning")</span><span class="sxs-lookup"><span data-stu-id="58dec-226">![Scale Stream Analytics with Machine Learning Functions Metrics](./media/stream-analytics-scale-with-ml-functions/stream-analytics-scale-with-ml-functions-01.png "Scale Stream Analytics with Machine Learning Functions Metrics")</span></span>

<span data-ttu-id="58dec-227">Hello sono definiti come segue:</span><span class="sxs-lookup"><span data-stu-id="58dec-227">hello are defined as follows:</span></span>

<span data-ttu-id="58dec-228">**Le richieste di funzioni**: hello numero di richieste di funzione.</span><span class="sxs-lookup"><span data-stu-id="58dec-228">**FUNCTION REQUESTS**: hello number of function requests.</span></span>

<span data-ttu-id="58dec-229">**Eventi relativi a funzioni**: numero di eventi hello in hello funzioni richieste.</span><span class="sxs-lookup"><span data-stu-id="58dec-229">**FUNCTION EVENTS**: hello number events in hello function requests.</span></span>

<span data-ttu-id="58dec-230">**RICHIESTE non riuscite di funzione**: hello numero di richieste di funzione non riuscita.</span><span class="sxs-lookup"><span data-stu-id="58dec-230">**FAILED FUNCTION REQUESTS**: hello number of failed function requests.</span></span>

## <a name="key-takeaways"></a><span data-ttu-id="58dec-231">Risultati principali</span><span class="sxs-lookup"><span data-stu-id="58dec-231">Key Takeaways</span></span>
<span data-ttu-id="58dec-232">toosummarize punti principali hello, in ordine tooscale un processo di flusso Analitica con funzioni di Machine Learning, hello seguenti elementi da considerare:</span><span class="sxs-lookup"><span data-stu-id="58dec-232">toosummarize hello main points, in order tooscale an Stream Analytics job with Machine Learning functions, hello following items must be considered:</span></span>

1. <span data-ttu-id="58dec-233">frequenza degli eventi di input Hello</span><span class="sxs-lookup"><span data-stu-id="58dec-233">hello input event rate</span></span>
2. <span data-ttu-id="58dec-234">Hello tollerata latenza per l'esecuzione del processo di flusso Analitica hello (e pertanto le dimensioni di batch hello del servizio web di Machine Learning hello richieste)</span><span class="sxs-lookup"><span data-stu-id="58dec-234">hello tolerated latency for hello running Stream Analytics job (and thus hello batch size of hello Machine Learning web service requests)</span></span>
3. <span data-ttu-id="58dec-235">il provisioning di Hello flusso Analitica SUs e il numero di hello delle richieste di servizio web Machine Learning (hello correlati alla funzione costi aggiuntivi)</span><span class="sxs-lookup"><span data-stu-id="58dec-235">hello provisioned Stream Analytics SUs and hello number of Machine Learning web service requests (hello additional function-related costs)</span></span>

<span data-ttu-id="58dec-236">È stata usata come esempio una query di Analisi di flusso completamente partizionata.</span><span class="sxs-lookup"><span data-stu-id="58dec-236">A fully partitioned Stream Analytics query was used as an example.</span></span> <span data-ttu-id="58dec-237">Se è necessaria una query più complessa hello [forum di Azure flusso Analitica](https://social.msdn.microsoft.com/Forums/en-US/home?forum=AzureStreamAnalytics) è un'ottima risorsa per ottenere ulteriori informazioni dal team di flusso Analitica hello.</span><span class="sxs-lookup"><span data-stu-id="58dec-237">If a more complex query is needed hello [Azure Stream Analytics forum](https://social.msdn.microsoft.com/Forums/en-US/home?forum=AzureStreamAnalytics) is a great resource for getting additional help from hello Stream Analytics team.</span></span>

## <a name="next-steps"></a><span data-ttu-id="58dec-238">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="58dec-238">Next steps</span></span>
<span data-ttu-id="58dec-239">toolearn ulteriori informazioni su Analitica di flusso, vedere:</span><span class="sxs-lookup"><span data-stu-id="58dec-239">toolearn more about Stream Analytics, see:</span></span>

* [<span data-ttu-id="58dec-240">Introduzione all'uso di Analisi dei flussi di Azure</span><span class="sxs-lookup"><span data-stu-id="58dec-240">Get started using Azure Stream Analytics</span></span>](stream-analytics-real-time-fraud-detection.md)
* [<span data-ttu-id="58dec-241">Ridimensionare i processi di Analisi dei flussi di Azure</span><span class="sxs-lookup"><span data-stu-id="58dec-241">Scale Azure Stream Analytics jobs</span></span>](stream-analytics-scale-jobs.md)
* [<span data-ttu-id="58dec-242">Informazioni di riferimento sul linguaggio di query di Analisi dei flussi di Azure</span><span class="sxs-lookup"><span data-stu-id="58dec-242">Azure Stream Analytics Query Language Reference</span></span>](https://msdn.microsoft.com/library/azure/dn834998.aspx)
* [<span data-ttu-id="58dec-243">Informazioni di riferimento sulle API REST di gestione di Analisi di flusso di Azure</span><span class="sxs-lookup"><span data-stu-id="58dec-243">Azure Stream Analytics Management REST API Reference</span></span>](https://msdn.microsoft.com/library/azure/dn835031.aspx)
