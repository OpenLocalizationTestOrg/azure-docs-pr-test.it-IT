---
title: "aaaHow toobuild un'applicazione che può accedere qualsiasi utente di Azure AD | Documenti Microsoft"
description: Istruzioni dettagliate per la creazione di un'applicazione che consenta a un utente di accedere da qualsiasi tenant Azure Active Directory, nota anche come applicazione multi-tenant.
services: active-directory
documentationcenter: 
author: dstrockis
manager: mbaldwin
editor: 
ms.assetid: 35af95cb-ced3-46ad-b01d-5d2f6fd064a3
ms.service: active-directory
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: identity
ms.date: 04/26/2017
ms.author: dastrock
ms.custom: aaddev
ms.openlocfilehash: 123ea8125fa3c308ce0f124cc58e85ec28d476d5
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/06/2017
---
# <a name="how-toosign-in-any-azure-active-directory-ad-user-using-hello-multi-tenant-application-pattern"></a><span data-ttu-id="f921f-103">Come toosign in qualsiasi utente di Azure Active Directory (AD) usando hello modello di applicazione multi-tenant</span><span class="sxs-lookup"><span data-stu-id="f921f-103">How toosign in any Azure Active Directory (AD) user using hello multi-tenant application pattern</span></span>
<span data-ttu-id="f921f-104">Se si offrono un Software come un toomany di applicazione di servizio organizzazioni, è possibile configurare l'applicazione tooaccept accessi da un tenant di Azure AD.</span><span class="sxs-lookup"><span data-stu-id="f921f-104">If you offer a Software as a Service application toomany organizations, you can configure your application tooaccept sign-ins from any Azure AD tenant.</span></span>  <span data-ttu-id="f921f-105">In Azure AD questa operazione viene definita impostazione dell'applicazione multi-tenant.</span><span class="sxs-lookup"><span data-stu-id="f921f-105">In Azure AD this is called making your application multi-tenant.</span></span>  <span data-ttu-id="f921f-106">Gli utenti in un tenant di Azure AD saranno in grado di toosign tooyour applicazione dopo il consenso toouse il proprio account con l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="f921f-106">Users in any Azure AD tenant will be able toosign in tooyour application after consenting toouse their account with your application.</span></span>  

<span data-ttu-id="f921f-107">Se si dispone di un'applicazione esistente che ha un proprio sistema di account, o supporta altri tipi di accesso da altri provider di cloud, l'aggiunta dell'accesso di Azure AD da un qualsiasi tenant è semplice.</span><span class="sxs-lookup"><span data-stu-id="f921f-107">If you have an existing application that has its own account system, or supports other kinds of sign-in from other cloud providers, adding Azure AD sign-in from any tenant is simple.</span></span> <span data-ttu-id="f921f-108">Registrare l'app, aggiungere il codice di accesso tramite OAuth2, OpenID Connect o SAML e inserire un pulsante "Accedi con Microsoft" all'applicazione.</span><span class="sxs-lookup"><span data-stu-id="f921f-108">Just register your app, add sign-in code via OAuth2, OpenID Connect, or SAML, and put a "Sign In with Microsoft" button on your application.</span></span> <span data-ttu-id="f921f-109">Fare clic su hello seguente pulsante toolearn ulteriori informazioni sulla personalizzazione dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="f921f-109">Click hello following button toolearn more about branding your application.</span></span>

<span data-ttu-id="f921f-110">[![Pulsante di accesso][AAD-Sign-In]][AAD-App-Branding]</span><span class="sxs-lookup"><span data-stu-id="f921f-110">[![Sign in button][AAD-Sign-In]][AAD-App-Branding]</span></span>

<span data-ttu-id="f921f-111">Questo articolo presuppone che l'utente abbia già familiarità con la creazione di un'applicazione single-tenant per Azure AD.</span><span class="sxs-lookup"><span data-stu-id="f921f-111">This article assumes you’re already familiar with building a single tenant application for Azure AD.</span></span>  <span data-ttu-id="f921f-112">Se non si testa il backup toohello [home page di Guida per sviluppatori] [ AAD-Dev-Guide] e provare a uno dei nostri introduttive!</span><span class="sxs-lookup"><span data-stu-id="f921f-112">If you’re not, head back up toohello [developer guide homepage][AAD-Dev-Guide] and try one of our quick starts!</span></span>

<span data-ttu-id="f921f-113">Esistono quattro semplici passaggi tooconvert l'applicazione in un'app multi-tenant di Azure AD:</span><span class="sxs-lookup"><span data-stu-id="f921f-113">There are four simple steps tooconvert your application into an Azure AD multi-tenant app:</span></span>

1. <span data-ttu-id="f921f-114">Aggiornare applicazione registrazione toobe multi-tenant</span><span class="sxs-lookup"><span data-stu-id="f921f-114">Update your application registration toobe multi-tenant</span></span>
2. <span data-ttu-id="f921f-115">Aggiornare il toohello /common di codice toosend richieste endpoint</span><span class="sxs-lookup"><span data-stu-id="f921f-115">Update your code toosend requests toohello /common endpoint</span></span> 
3. <span data-ttu-id="f921f-116">Aggiornare il codice toohandle più valori dell'autorità di certificazione</span><span class="sxs-lookup"><span data-stu-id="f921f-116">Update your code toohandle multiple issuer values</span></span>
4. <span data-ttu-id="f921f-117">Informarsi sul consenso dell'utente e dell'amministratore e apportare le modifiche appropriate al codice</span><span class="sxs-lookup"><span data-stu-id="f921f-117">Understand user and admin consent and make appropriate code changes</span></span>

<span data-ttu-id="f921f-118">Esaminiamo in dettaglio ogni passaggio.</span><span class="sxs-lookup"><span data-stu-id="f921f-118">Let’s look at each step in detail.</span></span> <span data-ttu-id="f921f-119">È inoltre possibile passare direttamente troppo[questo elenco di esempi di multi-tenant][AAD-Samples-MT].</span><span class="sxs-lookup"><span data-stu-id="f921f-119">You can also jump straight too[this list of multi-tenant samples][AAD-Samples-MT].</span></span>

## <a name="update-registration-toobe-multi-tenant"></a><span data-ttu-id="f921f-120">Aggiornare il registrazione toobe multi-tenant</span><span class="sxs-lookup"><span data-stu-id="f921f-120">Update registration toobe multi-tenant</span></span>
<span data-ttu-id="f921f-121">Per impostazione predefinita, le registrazioni di API o app Web in Azure AD sono single-tenant.</span><span class="sxs-lookup"><span data-stu-id="f921f-121">By default, web app/API registrations in Azure AD are single tenant.</span></span>  <span data-ttu-id="f921f-122">È possibile apportare la registrazione multi-tenant individuando passare hello "multi-tenant" nella pagina delle proprietà hello della registrazione dell'applicazione in hello [portale di Azure] [ AZURE-portal] e l'impostazione troppo "Yes".</span><span class="sxs-lookup"><span data-stu-id="f921f-122">You can make your registration multi-tenant by finding hello “Multi-Tenanted” switch on hello properties page of your application registration in hello [Azure portal][AZURE-portal] and setting it too“Yes”.</span></span>

<span data-ttu-id="f921f-123">Si noti inoltre, prima di effettuare un'applicazione multi-tenant, Azure AD richiede hello URI ID App toobe applicazione hello globalmente univoco.</span><span class="sxs-lookup"><span data-stu-id="f921f-123">Also note, before an application can be made multi-tenant, Azure AD requires hello App ID URI of hello application toobe globally unique.</span></span> <span data-ttu-id="f921f-124">URI ID App Hello è uno dei modi hello che un'applicazione viene identificata nei messaggi di protocollo.</span><span class="sxs-lookup"><span data-stu-id="f921f-124">hello App ID URI is one of hello ways an application is identified in protocol messages.</span></span>  <span data-ttu-id="f921f-125">Per un'applicazione single-tenant, è sufficiente per hello URI ID App toobe univoco all'interno di tale tenant.</span><span class="sxs-lookup"><span data-stu-id="f921f-125">For a single tenant application, it is sufficient for hello App ID URI toobe unique within that tenant.</span></span>  <span data-ttu-id="f921f-126">Per un'applicazione multi-tenant, deve essere globalmente univoco in modo da Azure AD è possibile trovare un'applicazione hello tra tutti i tenant.</span><span class="sxs-lookup"><span data-stu-id="f921f-126">For a multi-tenant application, it must be globally unique so Azure AD can find hello application across all tenants.</span></span>  <span data-ttu-id="f921f-127">Richiedendo hello URI ID App toohave un nome host che corrisponde a un dominio verificato del tenant di Azure AD hello, viene applicata l'univocità globale.</span><span class="sxs-lookup"><span data-stu-id="f921f-127">Global uniqueness is enforced by requiring hello App ID URI toohave a host name that matches a verified domain of hello Azure AD tenant.</span></span>  <span data-ttu-id="f921f-128">Ad esempio, se il nome di hello del tenant stato contoso.onmicrosoft.com valido URI ID App sarà `https://contoso.onmicrosoft.com/myapp`.</span><span class="sxs-lookup"><span data-stu-id="f921f-128">For example, if hello name of your tenant was contoso.onmicrosoft.com then a valid App ID URI would be `https://contoso.onmicrosoft.com/myapp`.</span></span>  <span data-ttu-id="f921f-129">Se il tenant ha un dominio verificato `contoso.com`, l'URI ID app valido sarà `https://contoso.com/myapp`.</span><span class="sxs-lookup"><span data-stu-id="f921f-129">If your tenant had a verified domain of `contoso.com`, then a valid App ID URI would also be `https://contoso.com/myapp`.</span></span>  <span data-ttu-id="f921f-130">L'impostazione di un'applicazione come multi-tenant avrà esito negativo se hello URI ID App non segue questo modello.</span><span class="sxs-lookup"><span data-stu-id="f921f-130">Setting an application as multi-tenant will fail if hello App ID URI doesn’t follow this pattern.</span></span>

<span data-ttu-id="f921f-131">Per impostazione predefinita, le registrazioni client native sono multi-tenant.</span><span class="sxs-lookup"><span data-stu-id="f921f-131">Native client registrations are multi-tenant by default.</span></span>  <span data-ttu-id="f921f-132">Non è necessario tootake qualsiasi toomake azione native client applicazione registrazione multi-tenant.</span><span class="sxs-lookup"><span data-stu-id="f921f-132">You don’t need tootake any action toomake a native client application registration multi-tenant.</span></span>

## <a name="update-your-code-toosend-requests-toocommon"></a><span data-ttu-id="f921f-133">Aggiornare il codice toosend richieste troppo comuni</span><span class="sxs-lookup"><span data-stu-id="f921f-133">Update your code toosend requests too/common</span></span>
<span data-ttu-id="f921f-134">In un'applicazione single-tenant, le richieste di accesso vengono inviate a endpoint di accesso toohello del tenant.</span><span class="sxs-lookup"><span data-stu-id="f921f-134">In a single tenant application, sign-in requests are sent toohello tenant’s sign-in endpoint.</span></span> <span data-ttu-id="f921f-135">Ad esempio, contoso.onmicrosoft.com potrebbe essere endpoint hello:</span><span class="sxs-lookup"><span data-stu-id="f921f-135">For example, for contoso.onmicrosoft.com hello endpoint would be:</span></span>

    https://login.microsoftonline.com/contoso.onmicrosoft.com

<span data-ttu-id="f921f-136">Le richieste inviate endpoint tooa del tenant possono accedere gli utenti (o Guest) in tale tooapplications tenant nel tenant.</span><span class="sxs-lookup"><span data-stu-id="f921f-136">Requests sent tooa tenant’s endpoint can sign in users (or guests) in that tenant tooapplications in that tenant.</span></span>  <span data-ttu-id="f921f-137">Con un'applicazione multi-tenant, un'applicazione hello non conosce in anticipo quale utente hello tenant è, pertanto non è possibile inviare richieste endpoint tooa del tenant.</span><span class="sxs-lookup"><span data-stu-id="f921f-137">With a multi-tenant application, hello application doesn’t know up front what tenant hello user is from, so you can’t send requests tooa tenant’s endpoint.</span></span>  <span data-ttu-id="f921f-138">Al contrario, le richieste vengono inviate tooan endpoint che il demultiplexing tra tenant tutti Azure Active Directory:</span><span class="sxs-lookup"><span data-stu-id="f921f-138">Instead, requests are sent tooan endpoint that multiplexes across all Azure AD tenants:</span></span>

    https://login.microsoftonline.com/common

<span data-ttu-id="f921f-139">Quando Azure AD riceve una richiesta in hello/endpoint comune, effettua l'accesso utente hello e come una conseguenza consente di individuare quale utente hello tenant si trova.</span><span class="sxs-lookup"><span data-stu-id="f921f-139">When Azure AD receives a request on hello /common endpoint, it signs hello user in and as a consequence discovers which tenant hello user is from.</span></span>  <span data-ttu-id="f921f-140">Hello/endpoint comune funziona con tutti i protocolli di autenticazione hello è supportati da Azure AD: OpenID Connect, OAuth 2.0, SAML 2.0 e WS-Federation.</span><span class="sxs-lookup"><span data-stu-id="f921f-140">hello /common endpoint works with all of hello authentication protocols supported by Azure AD:  OpenID Connect, OAuth 2.0, SAML 2.0, and WS-Federation.</span></span>

<span data-ttu-id="f921f-141">risposta di accesso toohello un'applicazione Hello quindi contiene un token che rappresenta utente hello.</span><span class="sxs-lookup"><span data-stu-id="f921f-141">hello sign-in response toohello application then contains a token representing hello user.</span></span>  <span data-ttu-id="f921f-142">valore dell'autorità emittente Hello nel token hello indica un'applicazione quale utente hello tenant da.</span><span class="sxs-lookup"><span data-stu-id="f921f-142">hello issuer value in hello token tells an application what tenant hello user is from.</span></span>  <span data-ttu-id="f921f-143">Quando restituisce una risposta da hello/endpoint comuni, il valore dell'autorità emittente hello nel token hello corrisponderà tenant toohello dell'utente.</span><span class="sxs-lookup"><span data-stu-id="f921f-143">When a response returns from hello /common endpoint, hello issuer value in hello token will correspond toohello user’s tenant.</span></span>  <span data-ttu-id="f921f-144">È importante toonote hello/endpoint comune non è un tenant e non è un'autorità di certificazione, è semplicemente un multiplexer.</span><span class="sxs-lookup"><span data-stu-id="f921f-144">It’s important toonote hello /common endpoint is not a tenant and is not an issuer, it’s just a multiplexer.</span></span>  <span data-ttu-id="f921f-145">Quando si usa /common, logica hello in token toovalidate applicazione deve tootake toobe aggiornare questo conto.</span><span class="sxs-lookup"><span data-stu-id="f921f-145">When using /common, hello logic in your application toovalidate tokens needs toobe updated tootake this into account.</span></span> 

<span data-ttu-id="f921f-146">Come indicato in precedenza applicazioni multi-tenant devono anche fornire un'esperienza di accesso coerente per gli utenti, seguente hello linee guida del marchio dell'applicazione di Azure AD.</span><span class="sxs-lookup"><span data-stu-id="f921f-146">As mentioned earlier, multi-tenant applications should also provide a consistent sign-in experience for users, following hello Azure AD application branding guidelines.</span></span> <span data-ttu-id="f921f-147">Fare clic su hello seguente pulsante toolearn ulteriori informazioni sulla personalizzazione dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="f921f-147">Click hello following button toolearn more about branding your application.</span></span>

<span data-ttu-id="f921f-148">[![Pulsante di accesso][AAD-Sign-In]][AAD-App-Branding]</span><span class="sxs-lookup"><span data-stu-id="f921f-148">[![Sign in button][AAD-Sign-In]][AAD-App-Branding]</span></span>

<span data-ttu-id="f921f-149">Esaminiamo ora utilizzare hello di hello /common endpoint e l'implementazione del codice in modo più dettagliato.</span><span class="sxs-lookup"><span data-stu-id="f921f-149">Let’s take a look at hello use of hello /common endpoint and your code implementation in more detail.</span></span>

## <a name="update-your-code-toohandle-multiple-issuer-values"></a><span data-ttu-id="f921f-150">Aggiornare il codice toohandle più valori dell'autorità di certificazione</span><span class="sxs-lookup"><span data-stu-id="f921f-150">Update your code toohandle multiple issuer values</span></span>
<span data-ttu-id="f921f-151">Le applicazioni Web e le API Web ricevono e convalidano i token da Azure AD.</span><span class="sxs-lookup"><span data-stu-id="f921f-151">Web applications and web APIs receive and validate tokens from Azure AD.</span></span>  

> [!NOTE]
> <span data-ttu-id="f921f-152">Mentre le applicazioni client native richiedere e ricevano token da Azure AD, vengono in tal caso toosend li tooAPIs, in cui vengono convalidate.</span><span class="sxs-lookup"><span data-stu-id="f921f-152">While native client applications request and receive tokens from Azure AD, they do so toosend them tooAPIs, where they are validated.</span></span>  <span data-ttu-id="f921f-153">Le applicazioni native non convalidano i token e devono gestirli come opachi.</span><span class="sxs-lookup"><span data-stu-id="f921f-153">Native applications do not validate tokens and must treat them as opaque.</span></span>
> 
> 

<span data-ttu-id="f921f-154">Passiamo ora al modo in cui un'applicazione convalida i token ricevuti da Azure AD.</span><span class="sxs-lookup"><span data-stu-id="f921f-154">Let’s look at how an application validates tokens it receives from Azure AD.</span></span>  <span data-ttu-id="f921f-155">Un'applicazione single-tenant prende in genere un valore dell'endpoint come:</span><span class="sxs-lookup"><span data-stu-id="f921f-155">A single tenant application will normally take an endpoint value like:</span></span>

    https://login.microsoftonline.com/contoso.onmicrosoft.com

<span data-ttu-id="f921f-156">e utilizzarla tooconstruct come un URL di metadati (in questo caso, OpenID Connect):</span><span class="sxs-lookup"><span data-stu-id="f921f-156">and use it tooconstruct a metadata URL (in this case, OpenID Connect) like:</span></span>

    https://login.microsoftonline.com/contoso.onmicrosoft.com/.well-known/openid-configuration

<span data-ttu-id="f921f-157">toodownload due importanti parti di informazioni e i token utilizzati toovalidate: firma del tenant hello chiavi e il valore dell'autorità di certificazione.</span><span class="sxs-lookup"><span data-stu-id="f921f-157">toodownload two critical pieces of information that are used toovalidate tokens:  hello tenant’s signing keys and issuer value.</span></span>  <span data-ttu-id="f921f-158">Ogni tenant di Azure AD ha un valore univoco dell'autorità di certificazione del modulo hello:</span><span class="sxs-lookup"><span data-stu-id="f921f-158">Each Azure AD tenant has a unique issuer value of hello form:</span></span>

    https://sts.windows.net/31537af4-6d77-4bb9-a681-d2394888ea26/

<span data-ttu-id="f921f-159">valore GUID hello dove è hello rename-versione dell'ID tenant hello del tenant hello.</span><span class="sxs-lookup"><span data-stu-id="f921f-159">where hello GUID value is hello rename-safe version of hello tenant ID of hello tenant.</span></span>  <span data-ttu-id="f921f-160">Se si fa clic sul precedente collegamento di metadati per hello `contoso.onmicrosoft.com`, è possibile visualizzare il valore dell'autorità di certificazione nel documento hello.</span><span class="sxs-lookup"><span data-stu-id="f921f-160">If you click on hello preceding metadata link for `contoso.onmicrosoft.com`, you can see this issuer value in hello document.</span></span>

<span data-ttu-id="f921f-161">Quando un'applicazione single-tenant convalida un token, controlla firma hello del token di hello contro hello chiavi dal documento di metadati hello di firma.</span><span class="sxs-lookup"><span data-stu-id="f921f-161">When a single tenant application validates a token, it checks hello signature of hello token against hello signing keys from hello metadata document.</span></span> <span data-ttu-id="f921f-162">In questo modo si toomake del valore di autorità emittente che hello hello corrispondenze token hello uno che è stato trovato nel documento di metadati hello.</span><span class="sxs-lookup"><span data-stu-id="f921f-162">This allows it toomake sure hello issuer value in hello token matches hello one that was found in hello metadata document.</span></span>

<span data-ttu-id="f921f-163">Poiché hello/comuni endpoint non corrisponde a tooa tenant e non è un'autorità di certificazione, quando si esamina il valore dell'autorità emittente hello nei metadati hello comune è un URL basato su modelli anziché un valore effettivo:</span><span class="sxs-lookup"><span data-stu-id="f921f-163">Since hello /common endpoint doesn’t correspond tooa tenant and isn’t an issuer, when you examine hello issuer value in hello metadata for /common it has a templated URL instead of an actual value:</span></span>

    https://sts.windows.net/{tenantid}/

<span data-ttu-id="f921f-164">Pertanto, un'applicazione multi-tenant non è possibile convalidare i token solo confrontando il valore dell'autorità emittente hello nei metadati hello con hello `issuer` valore nel token hello.</span><span class="sxs-lookup"><span data-stu-id="f921f-164">Therefore, a multi-tenant application can’t validate tokens just by matching hello issuer value in hello metadata with hello `issuer` value in hello token.</span></span>  <span data-ttu-id="f921f-165">Un'applicazione multi-tenant deve logica toodecide i valori dell'autorità di certificazione non sono validi e che non, basata su tenant hello parte ID del valore dell'autorità emittente hello.</span><span class="sxs-lookup"><span data-stu-id="f921f-165">A multi-tenant application needs logic toodecide which issuer values are valid and which are not, based on hello tenant ID portion of hello issuer value.</span></span>  

<span data-ttu-id="f921f-166">Ad esempio, se un'applicazione multi-tenant consente solo accesso da un tenant specifico che hanno effettuato l'iscrizione ai servizi, quindi deve verificare il valore di autorità emittente hello o hello `tid` valore in hello token toomake tenant sia nel proprio elenco di attestazione sottoscrittori.</span><span class="sxs-lookup"><span data-stu-id="f921f-166">For example, if a multi-tenant application only allows sign-in from specific tenants who have signed up for their service, then it must check either hello issuer value or hello `tid` claim value in hello token toomake sure that tenant is in their list of subscribers.</span></span>  <span data-ttu-id="f921f-167">Se un'applicazione multi-tenant solo occupa utenti singoli e non decisioni qualsiasi accesso in base ai tenant, è possibile ignorare il valore di autorità emittente hello completamente.</span><span class="sxs-lookup"><span data-stu-id="f921f-167">If a multi-tenant application only deals with individuals and doesn’t make any access decisions based on tenants, then it can ignore hello issuer value altogether.</span></span>

<span data-ttu-id="f921f-168">Negli esempi di multi-tenant hello in hello [contenuto correlato](#related-content) sezione alla fine di hello di questo articolo, la convalida dell'autorità di certificazione è disabilitato tooenable qualsiasi toosign tenant di Azure AD in.</span><span class="sxs-lookup"><span data-stu-id="f921f-168">In hello multi-tenant samples in hello [Related Content](#related-content) section at hello end of this article, issuer validation is disabled tooenable any Azure AD tenant toosign in.</span></span>

<span data-ttu-id="f921f-169">Ora esaminiamo esperienza utente hello per gli utenti che accedono applicazioni toomulti tenant.</span><span class="sxs-lookup"><span data-stu-id="f921f-169">Now let’s look at hello user experience for users that are signing in toomulti-tenant applications.</span></span>

## <a name="understanding-user-and-admin-consent"></a><span data-ttu-id="f921f-170">Informazioni sul consenso dell'utente e dell'amministratore</span><span class="sxs-lookup"><span data-stu-id="f921f-170">Understanding user and admin consent</span></span>
<span data-ttu-id="f921f-171">Per un utente toosign tooan applicazione in Azure AD, l'applicazione hello deve essere rappresentata nel tenant dell'utente hello.</span><span class="sxs-lookup"><span data-stu-id="f921f-171">For a user toosign in tooan application in Azure AD, hello application must be represented in hello user’s tenant.</span></span>  <span data-ttu-id="f921f-172">Ciò consente l'organizzazione hello toodo operazioni quali applicare i criteri univoci quando gli utenti dal tenant l'accesso toohello applicazione.</span><span class="sxs-lookup"><span data-stu-id="f921f-172">This allows hello organization toodo things like apply unique policies when users from their tenant sign in toohello application.</span></span>  <span data-ttu-id="f921f-173">Per un'applicazione single-tenant, la registrazione è semplice. è hello che si verifica quando si registra un'applicazione hello in hello [portale di Azure][AZURE-portal].</span><span class="sxs-lookup"><span data-stu-id="f921f-173">For a single tenant application, this registration is simple; it’s hello one that happens when you register hello application in hello [Azure portal][AZURE-portal].</span></span>

<span data-ttu-id="f921f-174">Per un'applicazione multi-tenant, la registrazione iniziale per un'applicazione hello hello risiede nel tenant di Azure AD hello usato dallo sviluppatore hello.</span><span class="sxs-lookup"><span data-stu-id="f921f-174">For a multi-tenant application, hello initial registration for hello application lives in hello Azure AD tenant used by hello developer.</span></span>  <span data-ttu-id="f921f-175">Quando un utente da un tenant diverso accede toohello applicazione hello per la prima volta, Azure AD richiede le autorizzazioni toohello tooconsent richieste dall'applicazione hello.</span><span class="sxs-lookup"><span data-stu-id="f921f-175">When a user from a different tenant signs in toohello application for hello first time, Azure AD asks them tooconsent toohello permissions requested by hello application.</span></span>  <span data-ttu-id="f921f-176">Se si acconsente, quindi una rappresentazione di un'applicazione hello chiamato un *dell'entità servizio* viene creato in hello tenant dell'utente e di accesso può continuare.</span><span class="sxs-lookup"><span data-stu-id="f921f-176">If they consent, then a representation of hello application called a *service principal* is created in hello user’s tenant, and sign-in can continue.</span></span> <span data-ttu-id="f921f-177">Viene inoltre creata una delega nella directory hello che registra l'applicazione toohello di consenso dell'utente hello.</span><span class="sxs-lookup"><span data-stu-id="f921f-177">A delegation is also created in hello directory that records hello user’s consent toohello application.</span></span> <span data-ttu-id="f921f-178">Vedere [oggetti applicazione e oggetti entità servizio] [ AAD-App-SP-Objects] per informazioni dettagliate su oggetti applicazione ed entità servizio dell'applicazione hello e come interagiscono tooeach altri.</span><span class="sxs-lookup"><span data-stu-id="f921f-178">See [Application Objects and Service Principal Objects][AAD-App-SP-Objects] for details on hello application's Application and ServicePrincipal objects, and how they relate tooeach other.</span></span>

![Applicazione toosingle a livello di consenso][Consent-Single-Tier] 

<span data-ttu-id="f921f-180">Questa esperienza di consenso è indipendente dalle autorizzazioni hello richieste dall'applicazione hello.</span><span class="sxs-lookup"><span data-stu-id="f921f-180">This consent experience is affected by hello permissions requested by hello application.</span></span>  <span data-ttu-id="f921f-181">Azure AD supporta due tipi di autorizzazioni, delegate e solo app:</span><span class="sxs-lookup"><span data-stu-id="f921f-181">Azure AD supports two kinds of permissions, app-only and delegated:</span></span>

* <span data-ttu-id="f921f-182">Un'autorizzazione delegata concede un tooact possibilità di applicazione hello come utente connesso per un sottoinsieme di utenti di hello hello operazioni eseguibili.</span><span class="sxs-lookup"><span data-stu-id="f921f-182">A delegated permission grants an application hello ability tooact as a signed in user for a subset of hello things hello user can do.</span></span>  <span data-ttu-id="f921f-183">Ad esempio, è possibile concedere un hello tooread di applicazione hello autorizzazione delegata firmato nel calendario dell'utente.</span><span class="sxs-lookup"><span data-stu-id="f921f-183">For example, you can grant an application hello delegated permission tooread hello signed in user’s calendar.</span></span>
* <span data-ttu-id="f921f-184">Un'autorizzazione solo app viene concessa direttamente toohello identità dell'applicazione hello.</span><span class="sxs-lookup"><span data-stu-id="f921f-184">An app-only permission is granted directly toohello identity of hello application.</span></span>  <span data-ttu-id="f921f-185">Ad esempio, è possibile concedere un applicazione hello autorizzazione solo app tooread hello elenco di utenti in un tenant, indipendentemente dal fatto che ha effettuato l'accesso dell'applicazione toohello.</span><span class="sxs-lookup"><span data-stu-id="f921f-185">For example, you can grant an application hello app-only permission tooread hello list of users in a tenant, regardless of who is signed in toohello application.</span></span>

<span data-ttu-id="f921f-186">Alcune autorizzazioni possono essere stato fornito il consenso tooby un utente normale, mentre altri richiedono il consenso dell'amministratore tenant.</span><span class="sxs-lookup"><span data-stu-id="f921f-186">Some permissions can be consented tooby a regular user, while others require a tenant administrator’s consent.</span></span> 

### <a name="admin-consent"></a><span data-ttu-id="f921f-187">Consenso dell'amministratore</span><span class="sxs-lookup"><span data-stu-id="f921f-187">Admin consent</span></span>
<span data-ttu-id="f921f-188">Le autorizzazioni solo app richiedono il consenso dell'amministratore tenant.</span><span class="sxs-lookup"><span data-stu-id="f921f-188">App-only permissions always require a tenant administrator’s consent.</span></span>  <span data-ttu-id="f921f-189">Se l'applicazione richiede un'autorizzazione solo app e un utente tenta di toosign toohello applicazione, verrà visualizzato un messaggio di errore indicante che l'utente di hello non è in grado di tooconsent.</span><span class="sxs-lookup"><span data-stu-id="f921f-189">If your application requests an app-only permission and a user tries toosign in toohello application, an error message will be displayed saying hello user isn’t able tooconsent.</span></span>

<span data-ttu-id="f921f-190">Alcune autorizzazioni delegate richiedono anche il consenso dell'amministratore tenant.</span><span class="sxs-lookup"><span data-stu-id="f921f-190">Certain delegated permissions also require a tenant administrator’s consent.</span></span>  <span data-ttu-id="f921f-191">Hello possibilità toowrite indietro tooAzure Active Directory come hello effettuato l'accesso utente, ad esempio, è necessario il consenso dell'amministratore tenant.</span><span class="sxs-lookup"><span data-stu-id="f921f-191">For example, hello ability toowrite back tooAzure AD as hello signed in user requires a tenant administrator’s consent.</span></span>  <span data-ttu-id="f921f-192">Ad esempio le autorizzazioni solo app, se un utente ordinario tenta toosign tooan applicazione che richiede un'autorizzazione delegata che richiede il consenso dell'amministratore, l'applicazione riceverà un errore.</span><span class="sxs-lookup"><span data-stu-id="f921f-192">Like app-only permissions, if an ordinary user tries toosign in tooan application that requests a delegated permission that requires administrator consent, your application will receive an error.</span></span>  <span data-ttu-id="f921f-193">Richiede un'autorizzazione o meno consenso dell'amministratore è determinata dallo sviluppatore hello pubblicati risorse hello e può essere disponibili nella documentazione di hello per risorsa hello.</span><span class="sxs-lookup"><span data-stu-id="f921f-193">Whether or not a permission requires admin consent is determined by hello developer that published hello resource, and can be found in hello documentation for hello resource.</span></span>  <span data-ttu-id="f921f-194">I collegamenti che descrive le autorizzazioni disponibili hello hello API Azure AD Graph e Microsoft Graph API da cui hello tootopics [contenuto correlato](#related-content) sezione di questo articolo.</span><span class="sxs-lookup"><span data-stu-id="f921f-194">Links tootopics describing hello available permissions for hello Azure AD Graph API and Microsoft Graph API are in hello [Related Content](#related-content) section of this article.</span></span>

<span data-ttu-id="f921f-195">Se l'applicazione utilizza le autorizzazioni che richiedono di consenso dell'amministratore, è necessario un movimento, ad esempio un pulsante o collegamento cui salve possibile avviare l'azione di hello toohave.</span><span class="sxs-lookup"><span data-stu-id="f921f-195">If your application uses permissions that require admin consent, you need toohave a gesture such as a button or link where hello admin can initiate hello action.</span></span>  <span data-ttu-id="f921f-196">richiesta di Hello inviato dall'applicazione per questa azione è una richiesta di autorizzazione OAuth2/OpenID Connect normale, ma che include anche hello `prompt=admin_consent` parametro della stringa di query.</span><span class="sxs-lookup"><span data-stu-id="f921f-196">hello request your application sends for this action is a usual OAuth2/OpenID Connect authorization request, but that also includes hello `prompt=admin_consent` query string parameter.</span></span>  <span data-ttu-id="f921f-197">Una volta salve ha accettato le condizioni e dell'entità servizio hello viene creato nel tenant del cliente hello, le successive richieste di accesso non è necessario hello `prompt=admin_consent` parametro.</span><span class="sxs-lookup"><span data-stu-id="f921f-197">Once hello admin has consented and hello service principal is created in hello customer’s tenant, subsequent sign-in requests do not need hello `prompt=admin_consent` parameter.</span></span> <span data-ttu-id="f921f-198">Poiché il messaggio per l'amministratore ha deciso di hello richieste le autorizzazioni sono accettabili, nessun altro utente nel tenant di hello verranno richiesto il consenso da tale punto in avanti.</span><span class="sxs-lookup"><span data-stu-id="f921f-198">Since hello administrator has decided hello requested permissions are acceptable, no other users in hello tenant will be prompted for consent from that point forward.</span></span>

<span data-ttu-id="f921f-199">Hello `prompt=admin_consent` parametro può essere utilizzato anche dalle applicazioni che richiedono le autorizzazioni che non necessitano di consenso dell'amministratore.</span><span class="sxs-lookup"><span data-stu-id="f921f-199">hello `prompt=admin_consent` parameter can also be used by applications that request permissions that do not require admin consent.</span></span> <span data-ttu-id="f921f-200">Questa operazione viene eseguita quando l'applicazione hello richiede un'esperienza in tenant salve "effettua l'iscrizione" una volta e nessun agli utenti verrà chiesto il consenso da tale punto in.</span><span class="sxs-lookup"><span data-stu-id="f921f-200">This is done when hello applicaton requires an experience where hello tenant admin “signs up” one time, and no other users are prompted for consent from that point on.</span></span>

<span data-ttu-id="f921f-201">Se un'applicazione richiede autorizzazioni di amministratore e un amministratore accede nel ma hello `prompt=admin_consent` parametro non viene inviato, salve verrà correttamente consenso all'applicazione toohello **solo per l'account utente**.</span><span class="sxs-lookup"><span data-stu-id="f921f-201">If an application requires admin consent, and an admin signs in but hello `prompt=admin_consent` parameter is not sent, hello admin will successfully consent toohello application **only for their user account**.</span></span>  <span data-ttu-id="f921f-202">Gli utenti standard non sarà ancora in grado di toosign in e applicazione toohello consenso.</span><span class="sxs-lookup"><span data-stu-id="f921f-202">Regular users will still not be able toosign in and consent toohello application.</span></span>  <span data-ttu-id="f921f-203">Ciò è utile se si desidera toogive hello tenant amministratore hello possibilità tooexplore l'applicazione prima di consentire l'accesso ad altri utenti.</span><span class="sxs-lookup"><span data-stu-id="f921f-203">This is useful if you want toogive hello tenant administrator hello ability tooexplore your application before allowing other users access.</span></span>

<span data-ttu-id="f921f-204">Un amministratore tenant è possibile disabilitare il possibilità hello per tooapplications tooconsent degli utenti normali.</span><span class="sxs-lookup"><span data-stu-id="f921f-204">A tenant administrator can disable hello ability for regular users tooconsent tooapplications.</span></span>  <span data-ttu-id="f921f-205">Se questa funzionalità è disabilitata, è sempre necessaria per toobe applicazione hello impostare nel tenant di hello consenso dell'amministratore.</span><span class="sxs-lookup"><span data-stu-id="f921f-205">If this capability is disabled, admin consent is always required for hello application toobe set up in hello tenant.</span></span>  <span data-ttu-id="f921f-206">Se si desidera tootest l'applicazione con il consenso utente normale disabilitato, è possibile trovare hello opzione di configurazione nel tenant di Azure AD hello sezione di configurazione di hello [portale di Azure][AZURE-portal].</span><span class="sxs-lookup"><span data-stu-id="f921f-206">If you want tootest your application with regular user consent disabled, you can find hello configuration switch in hello Azure AD tenant configuration section of hello [Azure portal][AZURE-portal].</span></span>

> [!NOTE]
> <span data-ttu-id="f921f-207">Alcune applicazioni desidera un'esperienza in cui gli utenti normali sono in grado di tooconsent inizialmente e può implicare la successiva applicazione hello amministratore hello e richiedere le autorizzazioni che richiedono di consenso dell'amministratore.</span><span class="sxs-lookup"><span data-stu-id="f921f-207">Some applications want an experience where regular users are able tooconsent initially, and later hello application can involve hello administrator and request permissions that require admin consent.</span></span>  <span data-ttu-id="f921f-208">Non è toodo alcun modo ciò con la registrazione di una singola applicazione in Azure AD oggi.</span><span class="sxs-lookup"><span data-stu-id="f921f-208">There is no way toodo this with a single application registration in Azure AD today.</span></span>  <span data-ttu-id="f921f-209">endpoint v2 Hello future Azure AD consente applicazioni toorequest autorizzazioni in fase di esecuzione, invece che al momento della registrazione, in modo da consentire questo scenario.</span><span class="sxs-lookup"><span data-stu-id="f921f-209">hello upcoming Azure AD v2 endpoint will allow applications toorequest permissions at runtime, instead of at registration time, which will enable this scenario.</span></span>  <span data-ttu-id="f921f-210">Per ulteriori informazioni, vedere hello [Guida per sviluppatori di Azure AD App modello v2][AAD-V2-Dev-Guide].</span><span class="sxs-lookup"><span data-stu-id="f921f-210">For more information, see hello [Azure AD App Model v2 Developer Guide][AAD-V2-Dev-Guide].</span></span>
> 
> 

### <a name="consent-and-multi-tier-applications"></a><span data-ttu-id="f921f-211">Consenso e applicazioni multilivello</span><span class="sxs-lookup"><span data-stu-id="f921f-211">Consent and multi-tier applications</span></span>
<span data-ttu-id="f921f-212">L'applicazione può avere più livelli, ognuno rappresentato dalla propria registrazione in Azure AD.</span><span class="sxs-lookup"><span data-stu-id="f921f-212">Your application may have multiple tiers, each represented by its own registration in Azure AD.</span></span>  <span data-ttu-id="f921f-213">Un esempio è un'applicazione nativa che esegue una chiamata a un'API Web o un'applicazione Web che esegue una chiamata a un'API Web.</span><span class="sxs-lookup"><span data-stu-id="f921f-213">For example, a native application that calls a web API, or a web application that calls a web API.</span></span>  <span data-ttu-id="f921f-214">In entrambi i casi, hello client (app native o web) richiede autorizzazioni toocall hello risorsa (API web).</span><span class="sxs-lookup"><span data-stu-id="f921f-214">In both of these cases, hello client (native app or web app) requests permissions toocall hello resource (web API).</span></span>  <span data-ttu-id="f921f-215">Per hello client toobe autorizzato correttamente nel tenant del cliente, tutte le risorse toowhich, richiede autorizzazioni deve esistere già nel tenant del cliente hello.</span><span class="sxs-lookup"><span data-stu-id="f921f-215">For hello client toobe successfully consented into a customer’s tenant, all resources toowhich it requests permissions must already exist in hello customer’s tenant.</span></span>  <span data-ttu-id="f921f-216">Se questa condizione non viene soddisfatta, Azure AD verrà restituito un errore che hello risorsa deve essere aggiunto per primo.</span><span class="sxs-lookup"><span data-stu-id="f921f-216">If this condition isn’t met, Azure AD will return an error that hello resource must be added first.</span></span>

<span data-ttu-id="f921f-217">**Più livelli in un tenant singolo**</span><span class="sxs-lookup"><span data-stu-id="f921f-217">**Multiple tiers in a single tenant**</span></span>

<span data-ttu-id="f921f-218">Può trattarsi di un problema se l'applicazione logica è costituita da due o più registrazioni di applicazioni, ad esempio un client e una risorsa separati.</span><span class="sxs-lookup"><span data-stu-id="f921f-218">This can be a problem if your logical application consists of two or more application registrations, for example a separate client and resource.</span></span>  <span data-ttu-id="f921f-219">Come ottenere risorse hello nel tenant del cliente hello prima?</span><span class="sxs-lookup"><span data-stu-id="f921f-219">How do you get hello resource into hello customer tenant first?</span></span>  <span data-ttu-id="f921f-220">Azure AD sono inclusi in questo caso abilitando client e acconsentito toobe risorse in un unico passaggio.</span><span class="sxs-lookup"><span data-stu-id="f921f-220">Azure AD covers this case by enabling client and resource toobe consented in a single step.</span></span> <span data-ttu-id="f921f-221">utente Hello vede hello somma totale della autorizzazioni hello richiesto dal client hello e risorsa nella pagina di consenso hello.</span><span class="sxs-lookup"><span data-stu-id="f921f-221">hello user sees hello sum total of hello permissions requested by both hello client and resource on hello consent page.</span></span>  <span data-ttu-id="f921f-222">tooenable questo comportamento, registrazione dell'applicazione della risorsa hello deve includere l'ID App del client hello come un `knownClientApplications` nel manifesto dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="f921f-222">tooenable this behavior, hello resource’s application registration must include hello client’s App ID as a `knownClientApplications` in its application manifest.</span></span>  <span data-ttu-id="f921f-223">ad esempio:</span><span class="sxs-lookup"><span data-stu-id="f921f-223">For example:</span></span>

    knownClientApplications": ["94da0930-763f-45c7-8d26-04d5938baab2"]

<span data-ttu-id="f921f-224">Questa proprietà può essere aggiornata tramite risorsa hello [manifesto dell'applicazione][AAD-App-Manifest].</span><span class="sxs-lookup"><span data-stu-id="f921f-224">This property can be updated via hello resource [application’s manifest][AAD-App-Manifest].</span></span> <span data-ttu-id="f921f-225">Come illustrato in un client nativo multilivello chiamata di esempio di API web in hello [contenuto correlato](#related-content) sezione alla fine di hello di questo articolo.</span><span class="sxs-lookup"><span data-stu-id="f921f-225">This is demonstrated in a multi-tier native client calling web API sample in hello [Related Content](#related-content) section at hello end of this article.</span></span> <span data-ttu-id="f921f-226">Hello diagramma seguente viene fornita una panoramica dell'autorizzazione per un'applicazione multilivello registrata in un singolo tenant:</span><span class="sxs-lookup"><span data-stu-id="f921f-226">hello following diagram provides an overview of consent for a multi-tier app registered in a single tenant :</span></span>

![App client note toomulti a livello di consenso][Consent-Multi-Tier-Known-Client] 

<span data-ttu-id="f921f-228">**Più livelli in tenant multipli**</span><span class="sxs-lookup"><span data-stu-id="f921f-228">**Multiple tiers in multiple tenants**</span></span>

<span data-ttu-id="f921f-229">Un caso simile si verifica se livelli diversi di hello di un'applicazione vengono registrati nel tenant diversi.</span><span class="sxs-lookup"><span data-stu-id="f921f-229">A similar case happens if hello different tiers of an application are registered in different tenants.</span></span>  <span data-ttu-id="f921f-230">Ad esempio, si consideri il caso hello di compilazione di un'applicazione client nativa che chiama hello API di Office 365 Exchange Online.</span><span class="sxs-lookup"><span data-stu-id="f921f-230">For example, consider hello case of building a native client application that calls hello Office 365 Exchange Online API.</span></span>  <span data-ttu-id="f921f-231">toodevelop hello nativi dell'applicazione e versioni successive per hello applicazione nativa toorun nel tenant del cliente, l'entità servizio Exchange Online hello deve essere presente.</span><span class="sxs-lookup"><span data-stu-id="f921f-231">toodevelop hello native application, and later for hello native application toorun in a customer’s tenant, hello Exchange Online service principal must be present.</span></span>  <span data-ttu-id="f921f-232">In questo caso, hello developer e cliente deve acquistare Exchange Online per toobe dell'entità servizio hello creato nei relativi tenant.</span><span class="sxs-lookup"><span data-stu-id="f921f-232">In this case, hello developer and customer must purchase Exchange Online for hello service principal toobe created in their tenants.</span></span>  

<span data-ttu-id="f921f-233">Nel caso di hello di un'API compilata da un'organizzazione diversa da Microsoft, hello di hello API sviluppatore tooprovide un modo per la propria applicazione hello tooconsent di clienti in tenant dei clienti.</span><span class="sxs-lookup"><span data-stu-id="f921f-233">In hello case of an API built by an organization other than Microsoft, hello developer of hello API needs tooprovide a way for their customers tooconsent hello application into their customers' tenants.</span></span> <span data-ttu-id="f921f-234">Hello consiglia di progettazione per hello 3rd party developer toobuild hello API in modo che può inoltre fungere da un client web per tooimplement iscrizione:</span><span class="sxs-lookup"><span data-stu-id="f921f-234">hello recommended design is for hello 3rd party developer toobuild hello API such that it can also function as a web client tooimplement sign-up :</span></span>

1. <span data-ttu-id="f921f-235">Seguire hello hello di tooensure nelle sezioni precedenti API implementa i requisiti di registrazione o codice hello applicazione multi-tenant</span><span class="sxs-lookup"><span data-stu-id="f921f-235">Follow hello earlier sections tooensure hello API implements hello multi-tenant application registration/code requirements</span></span>
2. <span data-ttu-id="f921f-236">Garantisce inoltre tooexposing hello API ambiti/ruoli, registrazione di hello include hello "Accedi e Leggi il profilo utente" autorizzazione di Azure AD (fornito per impostazione predefinita)</span><span class="sxs-lookup"><span data-stu-id="f921f-236">In addition tooexposing hello API's scopes/roles, ensure hello registration includes hello "Sign in and read user profile" Azure AD permission (provided by default)</span></span>
3. <span data-ttu-id="f921f-237">Implementare una pagina di accesso-in/iscrizione nel client web hello seguente hello [consenso dell'amministratore](#admin-consent) linee guida descritte in precedenza</span><span class="sxs-lookup"><span data-stu-id="f921f-237">Implement a sign-in/sign-up page in hello web client, following hello [admin consent](#admin-consent) guidance discussed earlier</span></span> 
4. <span data-ttu-id="f921f-238">Una volta toohello applicazione di consenso dell'utente di hello, hello servizio principale e il consenso delega vengono creati collegamenti al proprio tenant e un'applicazione nativa hello è possibile ottenere i token per hello API</span><span class="sxs-lookup"><span data-stu-id="f921f-238">Once hello user consents toohello application, hello service principal and consent delegation links are created in their tenant, and hello native application can get tokens for hello API</span></span>

<span data-ttu-id="f921f-239">Hello seguente diagramma viene fornita una panoramica dell'autorizzazione per un'applicazione multilivello registrata nel tenant diversi:</span><span class="sxs-lookup"><span data-stu-id="f921f-239">hello following diagram provides an overview of consent for a multi-tier app registered in different tenants:</span></span>

![Applicazione di più parti toomulti a livello di consenso][Consent-Multi-Tier-Multi-Party] 

### <a name="revoking-consent"></a><span data-ttu-id="f921f-241">Revoca del consenso</span><span class="sxs-lookup"><span data-stu-id="f921f-241">Revoking Consent</span></span>
<span data-ttu-id="f921f-242">Utenti e amministratori possono revocare consenso tooyour applicazione in qualsiasi momento:</span><span class="sxs-lookup"><span data-stu-id="f921f-242">Users and administrators can revoke consent tooyour application at any time:</span></span>

* <span data-ttu-id="f921f-243">Gli utenti revoke accesso tooindividual applicazioni rimuovendole dal loro [applicazioni del Pannello di accesso] [ AAD-Access-Panel] elenco.</span><span class="sxs-lookup"><span data-stu-id="f921f-243">Users revoke access tooindividual applications by removing them from their [Access Panel Applications][AAD-Access-Panel] list.</span></span>
* <span data-ttu-id="f921f-244">Gli amministratori revocare l'accesso tooapplications rimuovendole da Azure AD usando la sezione relativa alla gestione hello Azure AD di hello [portale di Azure][AZURE-portal].</span><span class="sxs-lookup"><span data-stu-id="f921f-244">Administrators revoke access tooapplications by removing them from Azure AD using hello Azure AD management section of hello [Azure portal][AZURE-portal].</span></span>

<span data-ttu-id="f921f-245">Se un amministratore acconsente tooan applicazione per tutti gli utenti in un tenant, gli utenti non è possibile revocare singolarmente l'accesso.</span><span class="sxs-lookup"><span data-stu-id="f921f-245">If an administrator consents tooan application for all users in a tenant, users cannot revoke access individually.</span></span>  <span data-ttu-id="f921f-246">Solo amministratore hello possibile revocare l'accesso e solo per l'intera applicazione hello.</span><span class="sxs-lookup"><span data-stu-id="f921f-246">Only hello administrator can revoke access, and only for hello whole application.</span></span>

### <a name="consent-and-protocol-support"></a><span data-ttu-id="f921f-247">Supporto del consenso e dei protocolli</span><span class="sxs-lookup"><span data-stu-id="f921f-247">Consent and Protocol Support</span></span>
<span data-ttu-id="f921f-248">Consenso è supportato in Azure AD tramite hello OAuth, OpenID Connect, WS-Federation e protocolli SAML.</span><span class="sxs-lookup"><span data-stu-id="f921f-248">Consent is supported in Azure AD via hello OAuth, OpenID Connect, WS-Federation, and SAML protocols.</span></span>  <span data-ttu-id="f921f-249">Hello protocolli SAML e WS-Federation non supportano hello `prompt=admin_consent` parametro, pertanto il consenso dell'amministratore è possibile solo tramite OAuth e OpenID Connect.</span><span class="sxs-lookup"><span data-stu-id="f921f-249">hello SAML and WS-Federation protocols do not support hello `prompt=admin_consent` parameter, so admin consent is only possible via OAuth and OpenID Connect.</span></span>

## <a name="multi-tenant-applications-and-caching-access-tokens"></a><span data-ttu-id="f921f-250">Applicazioni multi-tenant e memorizzazione nella cache dei token di accesso</span><span class="sxs-lookup"><span data-stu-id="f921f-250">Multi-Tenant Applications and Caching Access Tokens</span></span>
<span data-ttu-id="f921f-251">Applicazioni multi-tenant è anche possono ottenere i token di accesso toocall API che sono protetti da Azure AD.</span><span class="sxs-lookup"><span data-stu-id="f921f-251">Multi-tenant applications can also get access tokens toocall APIs that are protected by Azure AD.</span></span>  <span data-ttu-id="f921f-252">Un errore comune quando si utilizza hello Active Directory Authentication Library (ADAL) con un'applicazione multi-tenant, è richiesta tooinitially un token per un utente tramite /common, ricevere una risposta, quindi richiedere un token per l'utente stesso anch'esso tramite /common successive.</span><span class="sxs-lookup"><span data-stu-id="f921f-252">A common error when using hello Active Directory Authentication Library (ADAL) with a multi-tenant application, is tooinitially request a token for a user using /common, receive a response, then request a subsequent token for that same user also using /common.</span></span>  <span data-ttu-id="f921f-253">Poiché viene hello risposta da Azure AD da un tenant, non/comune, ADAL memorizza nella cache il token hello come proveniente da tenant hello.</span><span class="sxs-lookup"><span data-stu-id="f921f-253">Since hello response from Azure AD comes from a tenant, not /common, ADAL caches hello token as being from hello tenant.</span></span> <span data-ttu-id="f921f-254">Hello successive chiamare tooget troppo comune o un token di accesso per la voce della cache di hello utente mancati riscontri hello e utente hello è richiesta toosign in nuovamente.</span><span class="sxs-lookup"><span data-stu-id="f921f-254">hello subsequent call too/common tooget an access token for hello user misses hello cache entry, and hello user is prompted toosign in again.</span></span>  <span data-ttu-id="f921f-255">cache di hello tooavoid mancante, verificare che le successive chiamate per un utente già connesso vengono effettuate endpoint toohello del tenant.</span><span class="sxs-lookup"><span data-stu-id="f921f-255">tooavoid missing hello cache, make sure subsequent calls for an already signed in user are made toohello tenant’s endpoint.</span></span>

## <a name="next-steps"></a><span data-ttu-id="f921f-256">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="f921f-256">Next steps</span></span>
<span data-ttu-id="f921f-257">In questo articolo, si è appreso come toobuild un'applicazione che può accedere un utente di qualsiasi tenant di Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="f921f-257">In this article, you learned how toobuild an application that can sign in a user from any Azure Active Directory tenant.</span></span> <span data-ttu-id="f921f-258">Dopo l'abilitazione di Single Sign-On tra l'applicazione e Azure Active Directory, è inoltre possibile aggiornare il tooaccess applicazione API esposte dalle risorse di Microsoft, come Office 365.</span><span class="sxs-lookup"><span data-stu-id="f921f-258">After enabling Single Sign-On between your app and Azure Active Directory, you can also update your application tooaccess APIs exposed by Microsoft resources, like Office 365.</span></span> <span data-ttu-id="f921f-259">Pertanto è possibile offrire un'esperienza personalizzata nell'applicazione, ad esempio che mostra le informazioni contestuali toohello utenti, ad esempio le immagine del profilo o loro successivo appuntamento del calendario.</span><span class="sxs-lookup"><span data-stu-id="f921f-259">So you can offer a personalized experience in your application, for example showing contextual information toohello users, like their profile picture or their next calendar appointment.</span></span> <span data-ttu-id="f921f-260">toolearn più su come rendere API chiama tooAzure Active Directory e servizi Office 365 come Exchange, SharePoint, OneDrive, OneNote, Planner, Excel e altre informazioni, visitare: [Microsoft Graph API][MSFT-Graph-overview].</span><span class="sxs-lookup"><span data-stu-id="f921f-260">toolearn more about making API calls tooAzure Active Directory and Office 365 services like Exchange, SharePoint, OneDrive, OneNote, Planner, Excel and more, visit: [Microsoft Graph API][MSFT-Graph-overview].</span></span>


## <a name="related-content"></a><span data-ttu-id="f921f-261">Contenuti correlati</span><span class="sxs-lookup"><span data-stu-id="f921f-261">Related content</span></span>
* <span data-ttu-id="f921f-262">[Esempi di applicazioni multi-tenant][AAD-Samples-MT]</span><span class="sxs-lookup"><span data-stu-id="f921f-262">[Multi-tenant application samples][AAD-Samples-MT]</span></span>
* <span data-ttu-id="f921f-263">[Linee guida sulla personalizzazione per le applicazioni][AAD-App-Branding]</span><span class="sxs-lookup"><span data-stu-id="f921f-263">[Branding Guidelines for Applications][AAD-App-Branding]</span></span>
* <span data-ttu-id="f921f-264">[Guida per sviluppatori di Azure AD][AAD-Dev-Guide]</span><span class="sxs-lookup"><span data-stu-id="f921f-264">[Azure AD Developer's Guide][AAD-Dev-Guide]</span></span>
* <span data-ttu-id="f921f-265">[Oggetti applicazione e oggetti entità servizio][AAD-App-SP-Objects]</span><span class="sxs-lookup"><span data-stu-id="f921f-265">[Application Objects and Service Principal Objects][AAD-App-SP-Objects]</span></span>
* <span data-ttu-id="f921f-266">[Integrazione di applicazioni con Azure Active Directory][AAD-Integrating-Apps]</span><span class="sxs-lookup"><span data-stu-id="f921f-266">[Integrating Applications with Azure Active Directory][AAD-Integrating-Apps]</span></span>
* <span data-ttu-id="f921f-267">[Panoramica di hello il Framework di consenso][AAD-Consent-Overview]</span><span class="sxs-lookup"><span data-stu-id="f921f-267">[Overview of hello Consent Framework][AAD-Consent-Overview]</span></span>
* <span data-ttu-id="f921f-268">[Ambiti di autorizzazione di Microsoft API Graph][MSFT-Graph-permision-scopes]</span><span class="sxs-lookup"><span data-stu-id="f921f-268">[Microsoft Graph API Permission Scopes][MSFT-Graph-permision-scopes]</span></span>
* <span data-ttu-id="f921f-269">[Ambiti di autorizzazione di Azure AD API Graph][AAD-Graph-Perm-Scopes]</span><span class="sxs-lookup"><span data-stu-id="f921f-269">[Azure AD Graph API Permission Scopes][AAD-Graph-Perm-Scopes]</span></span>

<span data-ttu-id="f921f-270">Utilizzare hello seguendo i commenti e suggerimenti tooprovide di sezione commenti e consentono di ridefinire e definire il contenuto.</span><span class="sxs-lookup"><span data-stu-id="f921f-270">Please use hello following comments section tooprovide feedback and help us refine and shape our content.</span></span>

<!--Reference style links IN USE -->
[AAD-Access-Panel]:  https://myapps.microsoft.com
[AAD-App-Branding]: ./active-directory-branding-guidelines.md
[AAD-App-Manifest]: ./active-directory-application-manifest.md
[AAD-App-SP-Objects]: ./active-directory-application-objects.md
[AAD-Auth-Scenarios]: ./active-directory-authentication-scenarios.md
[AAD-Consent-Overview]: ./active-directory-integrating-applications.md#overview-of-the-consent-framework
[AAD-Dev-Guide]: ./active-directory-developers-guide.md
[AAD-Graph-Overview]: https://azure.microsoft.com/en-us/documentation/articles/active-directory-graph-api/
[AAD-Graph-Perm-Scopes]: https://msdn.microsoft.com/library/azure/ad/graph/howto/azure-ad-graph-api-permission-scopes
[AAD-Integrating-Apps]: ./active-directory-integrating-applications.md
[AAD-Samples-MT]: https://azure.microsoft.com/documentation/samples/?service=active-directory&term=multitenant
[AAD-Why-To-Integrate]: ./active-directory-how-to-integrate.md
[AZURE-portal]: https://portal.azure.com
[MSFT-Graph-overview]: https://graph.microsoft.io/en-us/docs/overview/overview
[MSFT-Graph-permision-scopes]: https://graph.microsoft.io/en-us/docs/authorization/permission_scopes

<!--Image references-->
[AAD-Sign-In]: ./media/active-directory-devhowto-multi-tenant-overview/sign-in-with-microsoft-light.png
[Consent-Single-Tier]: ./media/active-directory-devhowto-multi-tenant-overview/consent-flow-single-tier.png
[Consent-Multi-Tier-Known-Client]: ./media/active-directory-devhowto-multi-tenant-overview/consent-flow-multi-tier-known-clients.png
[Consent-Multi-Tier-Multi-Party]: ./media/active-directory-devhowto-multi-tenant-overview/consent-flow-multi-tier-multi-party.png

<!--Reference style links -->
[AAD-App-Manifest]: ./active-directory-application-manifest.md
[AAD-App-SP-Objects]: ./active-directory-application-objects.md
[AAD-Auth-Scenarios]: ./active-directory-authentication-scenarios.md
[AAD-Integrating-Apps]: ./active-directory-integrating-applications.md
[AAD-Dev-Guide]: ./active-directory-developers-guide.md
[AAD-Graph-Perm-Scopes]: https://msdn.microsoft.com/library/azure/ad/graph/howto/azure-ad-graph-api-permission-scopes
[AAD-Graph-App-Entity]: https://msdn.microsoft.com/Library/Azure/Ad/Graph/api/entity-and-complex-type-reference#application-entity
[AAD-Graph-Sp-Entity]: https://msdn.microsoft.com/Library/Azure/Ad/Graph/api/entity-and-complex-type-reference#serviceprincipal-entity
[AAD-Graph-User-Entity]: https://msdn.microsoft.com/Library/Azure/Ad/Graph/api/entity-and-complex-type-reference#user-entity
[AAD-How-To-Integrate]: ./active-directory-how-to-integrate.md
[AAD-Security-Token-Claims]: ./active-directory-authentication-scenarios/#claims-in-azure-ad-security-tokens
[AAD-Tokens-Claims]: ./active-directory-token-and-claims.md
[AAD-V2-Dev-Guide]: ../active-directory-appmodel-v2-overview.md
[AZURE-portal]: https://portal.azure.com
[Duyshant-Role-Blog]: http://www.dushyantgill.com/blog/2014/12/10/roles-based-access-control-in-cloud-applications-using-azure-ad/
[JWT]: https://tools.ietf.org/html/draft-ietf-oauth-json-web-token-32
[O365-Perm-Ref]: https://msdn.microsoft.com/en-us/office/office365/howto/application-manifest
[OAuth2-Access-Token-Scopes]: https://tools.ietf.org/html/rfc6749#section-3.3
[OAuth2-AuthZ-Code-Grant-Flow]: https://msdn.microsoft.com/library/azure/dn645542.aspx
[OAuth2-AuthZ-Grant-Types]: https://tools.ietf.org/html/rfc6749#section-1.3 
[OAuth2-Client-Types]: https://tools.ietf.org/html/rfc6749#section-2.1
[OAuth2-Role-Def]: https://tools.ietf.org/html/rfc6749#page-6
[OpenIDConnect]: http://openid.net/specs/openid-connect-core-1_0.html
[OpenIDConnect-ID-Token]: http://openid.net/specs/openid-connect-core-1_0.html#IDToken














