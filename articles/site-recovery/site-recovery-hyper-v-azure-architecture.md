---
title: aaaHow funziona Hyper-V replica tooAzure in Site Recovery? | Microsoft Docs
description: Questo articolo offre una panoramica del funzionamento della replica Hyper-V in Azure Site Recovery.
services: site-recovery
documentationcenter: 
author: rayne-wiselman
manager: jwhit
editor: 
ms.assetid: c413efcd-d750-4b22-b34b-15bcaa03934a
ms.service: site-recovery
ms.workload: storage-backup-recovery
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: get-started-article
ms.date: 06/14/2017
ms.author: raynew
ROBOTS: NOINDEX, NOFOLLOW
redirect_url: site-recovery-architecture-hyper-v-to-azure
ms.openlocfilehash: e982806b4d6cdec2f71f82d8c73c17cc50ad3c33
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/06/2017
---
# <a name="how-does-hyper-v-replication-tooazure-work"></a><span data-ttu-id="b9b49-104">Come funziona tooAzure replica Hyper-V?</span><span class="sxs-lookup"><span data-stu-id="b9b49-104">How does Hyper-V replication tooAzure work?</span></span>

<span data-ttu-id="b9b49-105">Leggere questa architettura di articolo toounderstand hello e flussi di lavoro per Hyper-V replica tooAzure utilizzando hello [Azure Site Recovery](site-recovery-overview.md) servizio.</span><span class="sxs-lookup"><span data-stu-id="b9b49-105">Read this article toounderstand hello architecture and workflows for Hyper-V replication tooAzure using hello [Azure Site Recovery](site-recovery-overview.md) service.</span></span>

<span data-ttu-id="b9b49-106">Inviare eventuali commenti nella parte inferiore di hello di questo articolo, o in hello [forum sui servizi di ripristino di Azure](https://social.msdn.microsoft.com/forums/azure/home?forum=hypervrecovmgr).</span><span class="sxs-lookup"><span data-stu-id="b9b49-106">Post any comments at hello bottom of this article, or in hello [Azure Recovery Services Forum](https://social.msdn.microsoft.com/forums/azure/home?forum=hypervrecovmgr).</span></span>

<span data-ttu-id="b9b49-107">È possibile replicare hello tooAzure seguenti:</span><span class="sxs-lookup"><span data-stu-id="b9b49-107">You can replicate hello following tooAzure:</span></span>
- <span data-ttu-id="b9b49-108">**Hyper-V con VMM**: macchine virtuali presenti negli host Hyper-V locali gestiti nei cloud System Center Virtual Machine Manager (VMM).</span><span class="sxs-lookup"><span data-stu-id="b9b49-108">**Hyper-V with VMM**: VMs located on on-premises Hyper-V hosts managed in  System Center Virtual MAchine Manager (VMM) clouds.</span></span> <span data-ttu-id="b9b49-109">Gli host possono eseguire qualsiasi [sistema operativo supportato](site-recovery-support-matrix-to-azure.md#support-for-datacenter-management-servers).</span><span class="sxs-lookup"><span data-stu-id="b9b49-109">Hosts can be running any [supported operating system](site-recovery-support-matrix-to-azure.md#support-for-datacenter-management-servers).</span></span> <span data-ttu-id="b9b49-110">È possibile replicare macchine virtuali Hyper-V che eseguono qualsiasi sistema operativo guest [supportato da Hyper-V e Azure](https://technet.microsoft.com/en-us/windows-server-docs/compute/hyper-v/supported-windows-guest-operating-systems-for-hyper-v-on-windows).</span><span class="sxs-lookup"><span data-stu-id="b9b49-110">You can replicate Hyper-V VMs running any guest operating system [supported by Hyper-V and Azure](https://technet.microsoft.com/en-us/windows-server-docs/compute/hyper-v/supported-windows-guest-operating-systems-for-hyper-v-on-windows).</span></span>
- <span data-ttu-id="b9b49-111">**Hyper-V senza VMM**: macchine virtuali locali presenti negli host Hyper-V che non sono gestiti nei cloud VMM.</span><span class="sxs-lookup"><span data-stu-id="b9b49-111">**Hyper-V without VMM**: On-premises VMs located on Hyper-V hosts that aren't managed in VMM clouds.</span></span> <span data-ttu-id="b9b49-112">Gli host possono eseguire qualsiasi di hello [i sistemi operativi supportati](site-recovery-support-matrix-to-azure.md#support-for-replicated-machine-os-versions).</span><span class="sxs-lookup"><span data-stu-id="b9b49-112">Hosts can run any of hello [supported operating systems](site-recovery-support-matrix-to-azure.md#support-for-replicated-machine-os-versions).</span></span> <span data-ttu-id="b9b49-113">È possibile replicare macchine virtuali Hyper-V che eseguono qualsiasi sistema operativo guest [supportato da Hyper-V e Azure](https://technet.microsoft.com/en-us/windows-server-docs/compute/hyper-v/supported-windows-guest-operating-systems-for-hyper-v-on-windows).</span><span class="sxs-lookup"><span data-stu-id="b9b49-113">You can replicate Hyper-V VMs running any guest operating system [supported by Hyper-V and Azure](https://technet.microsoft.com/en-us/windows-server-docs/compute/hyper-v/supported-windows-guest-operating-systems-for-hyper-v-on-windows).</span></span>


## <a name="architectural-components"></a><span data-ttu-id="b9b49-114">Componenti dell'architettura</span><span class="sxs-lookup"><span data-stu-id="b9b49-114">Architectural components</span></span>

<span data-ttu-id="b9b49-115">**Area**</span><span class="sxs-lookup"><span data-stu-id="b9b49-115">**Area**</span></span> | <span data-ttu-id="b9b49-116">**Componente**</span><span class="sxs-lookup"><span data-stu-id="b9b49-116">**Component**</span></span> | <span data-ttu-id="b9b49-117">**Dettagli**</span><span class="sxs-lookup"><span data-stu-id="b9b49-117">**Details**</span></span>
--- | --- | ---
<span data-ttu-id="b9b49-118">**Azzurro**</span><span class="sxs-lookup"><span data-stu-id="b9b49-118">**Azure**</span></span> | <span data-ttu-id="b9b49-119">In Azure sono necessari un account Microsoft Azure, un account di archiviazione di Azure e una rete di Azure.</span><span class="sxs-lookup"><span data-stu-id="b9b49-119">In Azure you need a Microsoft Azure account, an Azure storage account, and a Azure network.</span></span> | <span data-ttu-id="b9b49-120">La risorsa di archiviazione e la rete possono essere account basati su Resource Manager o classici.</span><span class="sxs-lookup"><span data-stu-id="b9b49-120">Storage and network can be Resource Manager-based, or classic accounts.</span></span><br/><br/> <span data-ttu-id="b9b49-121">Dati replicati vengono archiviati nell'account di archiviazione hello e macchine virtuali di Azure vengono create con i dati replicato hello quando si verifica il failover da sito locale.</span><span class="sxs-lookup"><span data-stu-id="b9b49-121">Replicated data is stored in hello storage account, and Azure VMs are created with hello replicated data when failover from your on-premises site occurs.</span></span><br/><br/> <span data-ttu-id="b9b49-122">Hello macchine virtuali di Azure connettersi toohello rete virtuale di Azure quando vengono creati.</span><span class="sxs-lookup"><span data-stu-id="b9b49-122">hello Azure VMs connect toohello Azure virtual network when they're created.</span></span>
<span data-ttu-id="b9b49-123">**Server VMM**</span><span class="sxs-lookup"><span data-stu-id="b9b49-123">**VMM server**</span></span> | <span data-ttu-id="b9b49-124">Host Hyper-V situati in cloud VMM</span><span class="sxs-lookup"><span data-stu-id="b9b49-124">Hyper-V hosts located in VMM clouds</span></span> | <span data-ttu-id="b9b49-125">Se l'host Hyper-V vengono gestite nei cloud VMM, si registra il server VMM hello in hello che insieme di credenziali di servizi di ripristino.</span><span class="sxs-lookup"><span data-stu-id="b9b49-125">If Hyper-V hosts are managed in VMM clouds, you register hello VMM server in hello Recovery Services vault.</span></span><br/><br/> <span data-ttu-id="b9b49-126">Nel server VMM hello installare replica tooorchestrate di Provider di Site Recovery hello con Azure.</span><span class="sxs-lookup"><span data-stu-id="b9b49-126">On hello VMM server you install hello Site Recovery Provider tooorchestrate replication with Azure.</span></span><br/><br/> <span data-ttu-id="b9b49-127">È necessario logico e le reti VM configurate tooconfigure il mapping di rete.</span><span class="sxs-lookup"><span data-stu-id="b9b49-127">You need logical and VM networks set up tooconfigure network mapping.</span></span> <span data-ttu-id="b9b49-128">Una rete VM deve essere collegato tooa la rete logica associata a cloud hello.</span><span class="sxs-lookup"><span data-stu-id="b9b49-128">A VM network should be linked tooa logical network that's associated with hello cloud.</span></span>
<span data-ttu-id="b9b49-129">**Host Hyper-V**</span><span class="sxs-lookup"><span data-stu-id="b9b49-129">**Hyper-V host**</span></span> | <span data-ttu-id="b9b49-130">I server Hyper-V possono essere distribuiti con o senza server VMM.</span><span class="sxs-lookup"><span data-stu-id="b9b49-130">Hyper-V servers can be deployed with or without VMM server.</span></span> | <span data-ttu-id="b9b49-131">Se non è presente alcun server VMM, hello Provider di Site Recovery è installato sulla replica di tooorchestrate hello host con il ripristino del sito su hello internet.</span><span class="sxs-lookup"><span data-stu-id="b9b49-131">If there's no VMM server, hello Site Recovery Provider is installed on hello host tooorchestrate replication with Site Recovery over hello internet.</span></span> <span data-ttu-id="b9b49-132">Se è presente un server VMM, hello Provider sia installato su di esso e non nell'host di hello.</span><span class="sxs-lookup"><span data-stu-id="b9b49-132">If there's a VMM server, hello Provider is installed on it, and not on hello host.</span></span><br/><br/> <span data-ttu-id="b9b49-133">agente di servizi di ripristino Hello viene installato nella replica dei dati toohandle hello host.</span><span class="sxs-lookup"><span data-stu-id="b9b49-133">hello Recovery Services agent is installed on hello host toohandle data replication.</span></span><br/><br/> <span data-ttu-id="b9b49-134">Le comunicazioni da hello Provider e agente hello sono protetto e crittografato.</span><span class="sxs-lookup"><span data-stu-id="b9b49-134">Communications from both hello Provider and hello agent are secure and encrypted.</span></span> <span data-ttu-id="b9b49-135">I dati replicati nell'archiviazione di Azure vengono anche crittografati.</span><span class="sxs-lookup"><span data-stu-id="b9b49-135">Replicated data in Azure storage is also encrypted.</span></span>
<span data-ttu-id="b9b49-136">**VM Hyper-V**</span><span class="sxs-lookup"><span data-stu-id="b9b49-136">**Hyper-V VMs**</span></span> | <span data-ttu-id="b9b49-137">È necessario uno o più macchine virtuali nel server host Hyper-V di hello.</span><span class="sxs-lookup"><span data-stu-id="b9b49-137">You need one or more VMs on hello Hyper-V host server.</span></span> | <span data-ttu-id="b9b49-138">Non è necessario tooexplicitly installati nelle macchine virtuali</span><span class="sxs-lookup"><span data-stu-id="b9b49-138">Nothing needs tooexplicitly installed on VMs</span></span>

## <a name="deployment-steps"></a><span data-ttu-id="b9b49-139">Passaggi di distribuzione</span><span class="sxs-lookup"><span data-stu-id="b9b49-139">Deployment steps</span></span>

1. <span data-ttu-id="b9b49-140">**Azure**: impostare hello componenti di Azure.</span><span class="sxs-lookup"><span data-stu-id="b9b49-140">**Azure**: You set up hello Azure components.</span></span> <span data-ttu-id="b9b49-141">È consigliabile configurare gli account di archiviazione e di rete prima di iniziare la distribuzione di Site Recovery.</span><span class="sxs-lookup"><span data-stu-id="b9b49-141">We recommend you set up storage and network accounts before you begin Site Recovery deployment.</span></span>
2. <span data-ttu-id="b9b49-142">**Insieme di credenziali**: si crea un insieme di credenziali di Servizi di ripristino per Site Recovery e si configurano le impostazioni dell'insieme di credenziali, incluse la configurazione delle impostazioni di origine e di destinazione, l'impostazione di un criterio di replica e l'abilitazione della replica.</span><span class="sxs-lookup"><span data-stu-id="b9b49-142">**Vault**: You create a Recovery Services vault for Site Recovery, and configure vault settings, including configuring source and target settings, setting up a replication policy, and enabling replication.</span></span>
3. <span data-ttu-id="b9b49-143">**Origine e destinazione**:</span><span class="sxs-lookup"><span data-stu-id="b9b49-143">**Source and target**:</span></span>
    - <span data-ttu-id="b9b49-144">**Host Hyper-V nei cloud VMM**: come parte della definizione delle impostazioni di origine, scaricare e installare hello Provider di Azure Site Recovery nel server VMM hello e agente di servizi di ripristino di Azure hello in ogni host Hyper-V.</span><span class="sxs-lookup"><span data-stu-id="b9b49-144">**Hyper-V hosts in VMM clouds**: As part of specifying source settings, you download and install hello Azure Site Recovery Provider on hello VMM server, and hello Azure Recovery Services agent on each Hyper-V host.</span></span> <span data-ttu-id="b9b49-145">origine Hello è hello VMM server.</span><span class="sxs-lookup"><span data-stu-id="b9b49-145">hello source will be hello VMM server.</span></span> <span data-ttu-id="b9b49-146">destinazione Hello è Azure.</span><span class="sxs-lookup"><span data-stu-id="b9b49-146">hello target is Azure.</span></span>
    - <span data-ttu-id="b9b49-147">Host Hyper-V senza VMM: quando si specificano le impostazioni di origine, scaricare e installare hello Provider e agente in ogni host Hyper-V.</span><span class="sxs-lookup"><span data-stu-id="b9b49-147">Hyper-V hosts without VMM: When you specify source settings, you download and install hello Provider and agent on each Hyper-V host.</span></span> <span data-ttu-id="b9b49-148">Durante la distribuzione raccogliere host hello in un sito Hyper-V e specificare il sito come origine di hello.</span><span class="sxs-lookup"><span data-stu-id="b9b49-148">During deployment you gather hello hosts into a Hyper-V site, and specify this site as hello source.</span></span> <span data-ttu-id="b9b49-149">destinazione Hello è Azure.</span><span class="sxs-lookup"><span data-stu-id="b9b49-149">hello target is Azure.</span></span>

    <span data-ttu-id="b9b49-150">![VMM/Hyper-V replica tooAzure](./media/site-recovery-components/arch-onprem-onprem-azure-vmm.png) ![tooAzure di replica Hyper-V del sito](./media/site-recovery-components/arch-onprem-azure-hypervsite.png)</span><span class="sxs-lookup"><span data-stu-id="b9b49-150">![Hyper-V/VMM replication tooAzure](./media/site-recovery-components/arch-onprem-onprem-azure-vmm.png) ![Hyper-V site replication tooAzure](./media/site-recovery-components/arch-onprem-azure-hypervsite.png)</span></span>


4. <span data-ttu-id="b9b49-151">**Criteri di replica**: si crea un criterio di replica per il sito Hyper-V hello o cloud VMM.</span><span class="sxs-lookup"><span data-stu-id="b9b49-151">**Replication policy**: You create a replication policy for hello Hyper-V site or VMM cloud.</span></span> <span data-ttu-id="b9b49-152">criteri di Hello sono macchine virtuali tooall applicato presenti negli host nel sito di hello o cloud.</span><span class="sxs-lookup"><span data-stu-id="b9b49-152">hello policy is applied tooall VMs located on hosts in hello site or cloud.</span></span>
5. <span data-ttu-id="b9b49-153">**Abilitazione della replica**: si abilita la replica per le macchine virtuali Hyper-V.</span><span class="sxs-lookup"><span data-stu-id="b9b49-153">**Enable replication**: You enable replication for Hyper-V VMs.</span></span> <span data-ttu-id="b9b49-154">Viene eseguita la replica iniziale in base alle impostazioni di criteri di replica hello.</span><span class="sxs-lookup"><span data-stu-id="b9b49-154">Initial replication occurs in accordance with hello replication policy settings.</span></span> <span data-ttu-id="b9b49-155">Vengono rilevate le modifiche ai dati e la replica di tooAzure le modifiche delta inizia dopo il completamento della replica iniziale hello.</span><span class="sxs-lookup"><span data-stu-id="b9b49-155">Data changes are tracked, and replication of delta changes tooAzure begins after hello initial replication finishes.</span></span> <span data-ttu-id="b9b49-156">Le modifiche rilevate per un elemento vengono salvate in un file HRL.</span><span class="sxs-lookup"><span data-stu-id="b9b49-156">Tracked changes for an item are held in a .hrl file.</span></span>
6. <span data-ttu-id="b9b49-157">**Failover di test**: eseguire un toomake di failover di test che tutto funzioni come previsto.</span><span class="sxs-lookup"><span data-stu-id="b9b49-157">**Test failover**:  You run a test failover toomake sure everything's working as expected.</span></span>

<span data-ttu-id="b9b49-158">Altre informazioni sulla distribuzione:</span><span class="sxs-lookup"><span data-stu-id="b9b49-158">Learn more about deployment:</span></span>
- [<span data-ttu-id="b9b49-159">Introduzione a macchina virtuale Hyper-V replica tooAzure - con VMM</span><span class="sxs-lookup"><span data-stu-id="b9b49-159">Get started with Hyper-V VM replication tooAzure - with VMM</span></span>](site-recovery-vmm-to-azure.md)
- [<span data-ttu-id="b9b49-160">Introduzione a macchina virtuale Hyper-V replica tooAzure - senza VMM</span><span class="sxs-lookup"><span data-stu-id="b9b49-160">Get started with Hyper-V VM replication tooAzure - without VMM</span></span>](site-recovery-hyper-v-site-to-azure.md)

## <a name="hyper-v-replication-workflow"></a><span data-ttu-id="b9b49-161">Flusso di lavoro di replica Hyper-V</span><span class="sxs-lookup"><span data-stu-id="b9b49-161">Hyper-V replication workflow</span></span>

### <a name="enable-protection"></a><span data-ttu-id="b9b49-162">Abilitare la protezione</span><span class="sxs-lookup"><span data-stu-id="b9b49-162">Enable protection</span></span>

1. <span data-ttu-id="b9b49-163">Dopo aver abilitato la protezione per una macchina virtuale Hyper-V, in hello portale di Azure o in locale, hello **abilitare la protezione** viene avviato.</span><span class="sxs-lookup"><span data-stu-id="b9b49-163">After you enable protection for a Hyper-V VM, in hello Azure portal or on-premises, hello **Enable protection** starts.</span></span>
2. <span data-ttu-id="b9b49-164">Hello processo controlla tale macchina hello è conforme ai prerequisiti, prima di richiamare hello [CreateReplicationRelationship](https://msdn.microsoft.com/library/hh850036.aspx), tooset la replica con le impostazioni di hello configurati.</span><span class="sxs-lookup"><span data-stu-id="b9b49-164">hello job checks that hello machine complies with prerequisites, before invoking hello [CreateReplicationRelationship](https://msdn.microsoft.com/library/hh850036.aspx), tooset up replication with hello settings you've configured.</span></span>
3. <span data-ttu-id="b9b49-165">Hello in cui inizia la replica iniziale richiamando hello [StartReplication](https://msdn.microsoft.com/library/hh850303.aspx) metodo tooinitialize una replica completa di macchina virtuale e tooAzure dischi virtuali della macchina virtuale di trasmissione hello.</span><span class="sxs-lookup"><span data-stu-id="b9b49-165">hello job starts initial replication by invoking hello [StartReplication](https://msdn.microsoft.com/library/hh850303.aspx) method, tooinitialize a full VM replication, and send hello VM's virtual disks tooAzure.</span></span>
4. <span data-ttu-id="b9b49-166">È possibile monitorare il processo di hello in hello **processi** scheda.      ![Elenco dei processi](media/site-recovery-hyper-v-azure-architecture/image1.png)![Abilitare protezione in dettaglio](media/site-recovery-hyper-v-azure-architecture/image2.png)</span><span class="sxs-lookup"><span data-stu-id="b9b49-166">You can monitor hello job in hello **Jobs** tab.      ![Jobs list](media/site-recovery-hyper-v-azure-architecture/image1.png) ![Enable protection drill down](media/site-recovery-hyper-v-azure-architecture/image2.png)</span></span>

### <a name="initial-replication"></a><span data-ttu-id="b9b49-167">Replica iniziale</span><span class="sxs-lookup"><span data-stu-id="b9b49-167">Initial replication</span></span>

1. <span data-ttu-id="b9b49-168">Quando viene attivata la replica iniziale, viene acquisito uno [snapshot della VM Hyper-V](https://technet.microsoft.com/library/dd560637.aspx).</span><span class="sxs-lookup"><span data-stu-id="b9b49-168">A [Hyper-V VM snapshot](https://technet.microsoft.com/library/dd560637.aspx) snapshot is taken when initial replication is triggered.</span></span>
2. <span data-ttu-id="b9b49-169">I dischi rigidi virtuali vengono replicate uno alla volta fino a quando non si tooAzure copiati tutti.</span><span class="sxs-lookup"><span data-stu-id="b9b49-169">Virtual hard disks are replicated one by one until they're all copied tooAzure.</span></span> <span data-ttu-id="b9b49-170">Potrebbe richiedere alcuni minuti, a seconda delle dimensioni delle macchine Virtuali, hello e larghezza di banda di rete.</span><span class="sxs-lookup"><span data-stu-id="b9b49-170">It could take a while, depending on hello VM size, and network bandwidth.</span></span> <span data-ttu-id="b9b49-171">toooptimize l'utilizzo della rete, vedere [come toomanage locale dell'utilizzo della larghezza di banda di rete protezione tooAzure](https://support.microsoft.com/kb/3056159).</span><span class="sxs-lookup"><span data-stu-id="b9b49-171">toooptimize your network usage, see [How toomanage on-premises tooAzure protection network bandwidth usage](https://support.microsoft.com/kb/3056159).</span></span>
3. <span data-ttu-id="b9b49-172">Se le modifiche si verificano durante la replica iniziale è in corso, hello Tracker di replica Hyper-V Replica tiene traccia delle modifiche come i log di replica Hyper-V (hrl).</span><span class="sxs-lookup"><span data-stu-id="b9b49-172">If disk changes occur while initial replication is in progress, hello Hyper-V Replica Replication Tracker tracks those changes as Hyper-V Replication Logs (.hrl).</span></span> <span data-ttu-id="b9b49-173">Questi file si trovano in hello stessa cartella dei dischi hello.</span><span class="sxs-lookup"><span data-stu-id="b9b49-173">These files are located in hello same folder as hello disks.</span></span> <span data-ttu-id="b9b49-174">Ogni disco è un file di hrl associata che verrà inviato toosecondary archiviazione.</span><span class="sxs-lookup"><span data-stu-id="b9b49-174">Each disk has an associated .hrl file that will be sent toosecondary storage.</span></span>
4. <span data-ttu-id="b9b49-175">file di snapshot e di log Hello risorse disco mentre la replica iniziale è in corso.</span><span class="sxs-lookup"><span data-stu-id="b9b49-175">hello snapshot and log files consume disk resources while initial replication is in progress.</span></span>
5. <span data-ttu-id="b9b49-176">Al termine, la replica iniziale hello snapshot di macchina virtuale hello viene eliminato.</span><span class="sxs-lookup"><span data-stu-id="b9b49-176">When hello initial replication finishes, hello VM snapshot is deleted.</span></span> <span data-ttu-id="b9b49-177">Le modifiche delta dei dischi nel registro hello sono disco padre toohello sincronizzato e sottoposto a merge.</span><span class="sxs-lookup"><span data-stu-id="b9b49-177">Delta disk changes in hello log are synchronized and merged toohello parent disk.</span></span>


### <a name="finalize-protection"></a><span data-ttu-id="b9b49-178">Finalizzare la protezione</span><span class="sxs-lookup"><span data-stu-id="b9b49-178">Finalize protection</span></span>

1. <span data-ttu-id="b9b49-179">Al termine della replica iniziale di hello, hello **Finalizza la protezione nella macchina virtuale hello** processo Configura rete e altre impostazioni di post-replica, in modo da macchina virtuale hello è protetta.</span><span class="sxs-lookup"><span data-stu-id="b9b49-179">After hello initial replication finishes, hello **Finalize protection on hello virtual machine** job configures network and other post-replication settings, so that hello virtual machine is protected.</span></span>
    <span data-ttu-id="b9b49-180">![Processo Finalizza la protezione](media/site-recovery-hyper-v-azure-architecture/image3.png)</span><span class="sxs-lookup"><span data-stu-id="b9b49-180">![Finalize protection job](media/site-recovery-hyper-v-azure-architecture/image3.png)</span></span>
2. <span data-ttu-id="b9b49-181">Se si esegue la replica tooAzure, si potrebbe essere necessario impostazioni hello tootweak per la macchina virtuale hello in modo che sia pronta per il failover.</span><span class="sxs-lookup"><span data-stu-id="b9b49-181">If you're replicating tooAzure, you might need tootweak hello settings for hello virtual machine so that it's ready for failover.</span></span> <span data-ttu-id="b9b49-182">A questo punto è possibile eseguire un toocheck di failover di test che funzionino come previsto.</span><span class="sxs-lookup"><span data-stu-id="b9b49-182">At this point you can run a test failover toocheck everything is working as expected.</span></span>

### <a name="delta-replication"></a><span data-ttu-id="b9b49-183">Replica dei dati</span><span class="sxs-lookup"><span data-stu-id="b9b49-183">Delta replication</span></span>

1. <span data-ttu-id="b9b49-184">Dopo la replica iniziale hello, delta inizia la sincronizzazione, in base alle impostazioni di replica.</span><span class="sxs-lookup"><span data-stu-id="b9b49-184">After hello initial replication, delta synchronization begins, in accordance with replication settings.</span></span>
2. <span data-ttu-id="b9b49-185">Individuazione di replica Hyper-V Replica Hello tiene traccia il disco rigido virtuale di hello modifiche tooa come file hrl.</span><span class="sxs-lookup"><span data-stu-id="b9b49-185">hello Hyper-V Replica Replication Tracker tracks hello changes tooa virtual hard disk as .hrl files.</span></span> <span data-ttu-id="b9b49-186">A ogni disco configurato per la replica è associato un file con estensione hrl.</span><span class="sxs-lookup"><span data-stu-id="b9b49-186">Each disk that's configured for replication has an associated .hrl file.</span></span> <span data-ttu-id="b9b49-187">Questo log viene inviato l'account di archiviazione del cliente toohello dopo il completamento della replica iniziale.</span><span class="sxs-lookup"><span data-stu-id="b9b49-187">This log is sent toohello customer's storage account after initial replication is complete.</span></span> <span data-ttu-id="b9b49-188">Quando un log è in transito tooAzure, le modifiche di hello nel disco primario hello vengono rilevate in un altro file di log, in hello stessa directory.</span><span class="sxs-lookup"><span data-stu-id="b9b49-188">When a log is in transit tooAzure, hello changes in hello primary disk are tracked in another log file, in hello same directory.</span></span>
3. <span data-ttu-id="b9b49-189">Durante la replica iniziale e differenziali, è possibile monitorare Ciao VM hello visualizzazione della macchina virtuale.</span><span class="sxs-lookup"><span data-stu-id="b9b49-189">During initial and delta replication, you can monitor hello VM in hello VM view.</span></span> <span data-ttu-id="b9b49-190">[Altre informazioni](site-recovery-monitoring-and-troubleshooting.md#monitor-replication-health-for-virtual-machines)</span><span class="sxs-lookup"><span data-stu-id="b9b49-190">[Learn more](site-recovery-monitoring-and-troubleshooting.md#monitor-replication-health-for-virtual-machines).</span></span>  

### <a name="replication-synchronization"></a><span data-ttu-id="b9b49-191">Sincronizzazione della replica</span><span class="sxs-lookup"><span data-stu-id="b9b49-191">Replication synchronization</span></span>

1. <span data-ttu-id="b9b49-192">Se la replica differenziale non riesce e una replica completa risulta costosa a livello di larghezza di banda o di tempo richiesto, la macchina virtuale verrà contrassegnata per la risincronizzazione.</span><span class="sxs-lookup"><span data-stu-id="b9b49-192">If delta replication fails, and a full replication would be costly in terms of bandwidth or time, then a VM is marked for resynchronization.</span></span> <span data-ttu-id="b9b49-193">Ad esempio, se i file hrl hello raggiungono 50% delle dimensioni del disco hello, quindi hello VM verrà contrassegnata per la risincronizzazione.</span><span class="sxs-lookup"><span data-stu-id="b9b49-193">For example, if hello .hrl files reach 50% of hello disk size, then hello VM will be marked for resynchronization.</span></span>
2.  <span data-ttu-id="b9b49-194">La risincronizzazione riduce la quantità di hello dei dati inviati dal calcolo i checksum di macchine virtuali di origine e destinazione di hello e l'invio solo i dati delta hello.</span><span class="sxs-lookup"><span data-stu-id="b9b49-194">Resynchronization minimizes hello amount of data sent by computing checksums of hello source and target virtual machines, and sending only hello delta data.</span></span> <span data-ttu-id="b9b49-195">La risincronizzazione usa un algoritmo di suddivisione in blocchi a blocchi fissi che suddivide appunto i file di origine e di destinazione in blocchi fissi.</span><span class="sxs-lookup"><span data-stu-id="b9b49-195">Resynchronization uses a fixed-block chunking algorithm where source and target files are divided into fixed chunks.</span></span> <span data-ttu-id="b9b49-196">I valori di checksum per ogni blocco vengono generati e quindi confrontata toodetermine che si blocca dalla destinazione di hello origine necessario toobe toohello applicato.</span><span class="sxs-lookup"><span data-stu-id="b9b49-196">Checksums for each chunk are generated and then compared toodetermine which blocks from hello source need toobe applied toohello target.</span></span>
3. <span data-ttu-id="b9b49-197">Al termine della risincronizzazione, dovrebbe riprendere la normale replica differenziale.</span><span class="sxs-lookup"><span data-stu-id="b9b49-197">After resynchronization finishes, normal delta replication should resume.</span></span> <span data-ttu-id="b9b49-198">Per impostazione predefinita la risincronizzazione viene pianificata toorun automaticamente fuori dall'orario di ufficio, ma è possibile risincronizzare una macchina virtuale manualmente.</span><span class="sxs-lookup"><span data-stu-id="b9b49-198">By default resynchronization is scheduled toorun automatically outside office hours, but you can resynchronize a virtual machine manually.</span></span> <span data-ttu-id="b9b49-199">Ad esempio, se si verifica un'interruzione di rete o un'altra interruzione, è possibile riprendere la risincronizzazione.</span><span class="sxs-lookup"><span data-stu-id="b9b49-199">For example, you can resume resynchronization if a network outage or another outage occurs.</span></span> <span data-ttu-id="b9b49-200">toodo, hello seleziona macchina virtuale nel portale di hello > **risincronizzare**.</span><span class="sxs-lookup"><span data-stu-id="b9b49-200">toodo this, select hello VM in hello portal > **Resynchronize**.</span></span>

    ![Risincronizzazione manuale](media/site-recovery-hyper-v-azure-architecture/image4.png)


### <a name="retries"></a><span data-ttu-id="b9b49-202">Tentativi</span><span class="sxs-lookup"><span data-stu-id="b9b49-202">Retries</span></span>

<span data-ttu-id="b9b49-203">Se si verifica un errore di replica, per impostazione predefinita viene effettuato un nuovo tentativo.</span><span class="sxs-lookup"><span data-stu-id="b9b49-203">If a replication error occurs, there's a built-in retry.</span></span> <span data-ttu-id="b9b49-204">Tale logica può essere classificata nelle due categorie seguenti:</span><span class="sxs-lookup"><span data-stu-id="b9b49-204">This logic can be classified into two categories:</span></span>

<span data-ttu-id="b9b49-205">**Categoria**</span><span class="sxs-lookup"><span data-stu-id="b9b49-205">**Category**</span></span> | <span data-ttu-id="b9b49-206">**Dettagli**</span><span class="sxs-lookup"><span data-stu-id="b9b49-206">**Details**</span></span>
--- | ---
<span data-ttu-id="b9b49-207">**Errori irreversibili**</span><span class="sxs-lookup"><span data-stu-id="b9b49-207">**Non-recoverable errors**</span></span> | <span data-ttu-id="b9b49-208">Non viene eseguito alcun nuovo tentativo.</span><span class="sxs-lookup"><span data-stu-id="b9b49-208">No retry is attempted.</span></span> <span data-ttu-id="b9b49-209">Lo stato della macchina virtuale sarà **Critico** e sarà necessario l'intervento di un amministratore.</span><span class="sxs-lookup"><span data-stu-id="b9b49-209">VM status will be **Critical**, and administrator intervention is required.</span></span> <span data-ttu-id="b9b49-210">Esempi di questi errori: interrotta la catena di disco rigido virtuale. Stato non valido per la replica hello VM; Errori di autenticazione di rete: errori di autorizzazione. Macchina virtuale non trovati errori (per i server Hyper-V autonomi)</span><span class="sxs-lookup"><span data-stu-id="b9b49-210">Examples of these errors include: broken VHD chain; Invalid state for hello replica VM; Network authentication errors: authorization errors; VM not found errors (for standalone Hyper-V servers)</span></span>
<span data-ttu-id="b9b49-211">**Errori reversibili**</span><span class="sxs-lookup"><span data-stu-id="b9b49-211">**Recoverable errors**</span></span> | <span data-ttu-id="b9b49-212">Tentativi vengono eseguiti ogni intervallo di replica, utilizzando un backoff esponenziale che aumenta l'intervallo tra tentativi hello dall'inizio di hello del primo tentativo di hello da 1, 2, 4, 8 e 10 minuti.</span><span class="sxs-lookup"><span data-stu-id="b9b49-212">Retries occur every replication interval, using an exponential back-off that increases hello retry interval from hello start of hello first attempt by 1, 2, 4, 8, and 10 minutes.</span></span> <span data-ttu-id="b9b49-213">Se l'errore persiste, viene eseguito un nuovo tentativo ogni 30 minuti.</span><span class="sxs-lookup"><span data-stu-id="b9b49-213">If an error persists, retry every 30 minutes.</span></span> <span data-ttu-id="b9b49-214">Alcuni esempi: errori di rete, errori di spazio su disco insufficiente, condizioni di memoria insufficiente.</span><span class="sxs-lookup"><span data-stu-id="b9b49-214">Examples include: network errors; low disk  errors; low memory conditions</span></span> |

## <a name="protection-and-recovery-lifecycle"></a><span data-ttu-id="b9b49-215">Ciclo di vita di protezione e ripristino</span><span class="sxs-lookup"><span data-stu-id="b9b49-215">Protection and recovery lifecycle</span></span>

![flusso di lavoro](./media/site-recovery-components/arch-hyperv-azure-workflow.png)

## <a name="next-steps"></a><span data-ttu-id="b9b49-217">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="b9b49-217">Next steps</span></span>

- [<span data-ttu-id="b9b49-218">Verificare i prerequisiti di distribuzione</span><span class="sxs-lookup"><span data-stu-id="b9b49-218">Check deployment prerequisites</span></span>](site-recovery-prereq.md)
- <span data-ttu-id="b9b49-219">Risolvere gli eventuali problemi tramite:</span><span class="sxs-lookup"><span data-stu-id="b9b49-219">Troubleshoot with:</span></span>
    - [<span data-ttu-id="b9b49-220">Monitorare e risolvere i problemi di protezione</span><span class="sxs-lookup"><span data-stu-id="b9b49-220">Monitor and troubleshoot protection</span></span>](site-recovery-monitoring-and-troubleshooting.md)
    - [<span data-ttu-id="b9b49-221">Contattare il supporto Microsoft</span><span class="sxs-lookup"><span data-stu-id="b9b49-221">Help from Microsoft support</span></span>](site-recovery-monitoring-and-troubleshooting.md#reach-out-for-microsoft-support)
    - [<span data-ttu-id="b9b49-222">Errori comuni e soluzioni</span><span class="sxs-lookup"><span data-stu-id="b9b49-222">Common errors and resolutions</span></span>](site-recovery-monitoring-and-troubleshooting.md#common-azure-site-recovery-errors-and-their-resolutions)
