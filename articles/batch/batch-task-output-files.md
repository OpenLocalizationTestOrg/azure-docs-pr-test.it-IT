---
title: "attività e processi aaaPersist output tooAzure archiviazione con hello API del servizio Azure Batch | Documenti Microsoft"
description: "Informazioni su come processo e attività di Batch toopersist toouse API del servizio Batch output tooAzure archiviazione."
services: batch
author: tamram
manager: timlt
editor: 
ms.service: batch
ms.devlang: multiple
ms.topic: article
ms.tgt_pltfrm: vm-windows
ms.workload: big-compute
ms.date: 06/16/2017
ms.author: tamram
ms.openlocfilehash: 71b3f7c0dda2d2a9d8eb3eef83229873c70ca22c
ms.sourcegitcommit: 523283cc1b3c37c428e77850964dc1c33742c5f0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/06/2017
---
# <a name="persist-task-data-tooazure-storage-with-hello-batch-service-api"></a><span data-ttu-id="800d5-103">Mantenere i dati di attività tooAzure archiviazione con hello API del servizio Batch</span><span class="sxs-lookup"><span data-stu-id="800d5-103">Persist task data tooAzure Storage with hello Batch service API</span></span>

[!INCLUDE [batch-task-output-include](../../includes/batch-task-output-include.md)]

<span data-ttu-id="800d5-104">A partire dalla versione 2017-05-01, hello API del servizio Batch supporta persistenti output dati tooAzure archiviazione per le attività e attività di processo di gestione eseguite in pool con la configurazione della macchina virtuale hello.</span><span class="sxs-lookup"><span data-stu-id="800d5-104">Starting with version 2017-05-01, hello Batch service API supports persisting output data tooAzure Storage for tasks and job manager tasks that run on pools with hello virtual machine configuration.</span></span> <span data-ttu-id="800d5-105">Quando si aggiunge un'attività, è possibile specificare un contenitore di archiviazione di Azure come destinazione di hello per l'output dell'attività hello.</span><span class="sxs-lookup"><span data-stu-id="800d5-105">When you add a task, you can specify a container in Azure Storage as hello destination for hello task's output.</span></span> <span data-ttu-id="800d5-106">servizio Batch Hello scrive quindi qualsiasi contenitore toothat dati di output quando hello attività è stata completata.</span><span class="sxs-lookup"><span data-stu-id="800d5-106">hello Batch service then writes any output data toothat container when hello task is complete.</span></span>

<span data-ttu-id="800d5-107">Un hello toousing vantaggio Batch output attività toopersist API del servizio è che non è necessaria un'applicazione hello toomodify che hello attività è in esecuzione.</span><span class="sxs-lookup"><span data-stu-id="800d5-107">An advantage toousing hello Batch service API toopersist task output is that you do not need toomodify hello application that hello task is running.</span></span> <span data-ttu-id="800d5-108">Al contrario, con alcune semplici modifiche tooyour applicazione client è possibile mantenere l'output dell'attività hello all'interno del codice hello Crea attività hello.</span><span class="sxs-lookup"><span data-stu-id="800d5-108">Instead, with a few simple modifications tooyour client application, you can persist hello task's output from within hello code that creates hello task.</span></span>   

## <a name="when-do-i-use-hello-batch-service-api-toopersist-task-output"></a><span data-ttu-id="800d5-109">Utilizzo di output dell'attività toopersist hello API del servizio Batch</span><span class="sxs-lookup"><span data-stu-id="800d5-109">When do I use hello Batch service API toopersist task output?</span></span>

<span data-ttu-id="800d5-110">Azure Batch offre più di un metodo toopersist l'output dell'attività.</span><span class="sxs-lookup"><span data-stu-id="800d5-110">Azure Batch provides more than one way toopersist task output.</span></span> <span data-ttu-id="800d5-111">Utilizzo di hello API del servizio Batch è un approccio pratico scenari adatti toothese migliori:</span><span class="sxs-lookup"><span data-stu-id="800d5-111">Using hello Batch service API is a convenient approach that's best suited toothese scenarios:</span></span>

- <span data-ttu-id="800d5-112">Si desidera toowrite codice toopersist attività output all'interno dell'applicazione client, senza modificare l'applicazione hello che l'attività è in esecuzione.</span><span class="sxs-lookup"><span data-stu-id="800d5-112">You want toowrite code toopersist task output from within your client application, without modifying hello application that your task is running.</span></span>
- <span data-ttu-id="800d5-113">Si desidera toopersist output dalle attività di Batch e attività di processo di gestione nel pool creati con la configurazione della macchina virtuale hello.</span><span class="sxs-lookup"><span data-stu-id="800d5-113">You want toopersist output from Batch tasks and job manager tasks in pools created with hello virtual machine configuration.</span></span>
- <span data-ttu-id="800d5-114">Si desidera toopersist contenitore di archiviazione di Azure tooan dell'output con un nome arbitrario.</span><span class="sxs-lookup"><span data-stu-id="800d5-114">You want toopersist output tooan Azure Storage container with an arbitrary name.</span></span>
- <span data-ttu-id="800d5-115">Che si desidera toopersist output tooan di archiviazione di Azure contenitore denominato in base toohello [standard convenzioni dei File Batch](https://github.com/Azure/azure-sdk-for-net/tree/vs17Dev/src/SDKs/Batch/Support/FileConventions#conventions).</span><span class="sxs-lookup"><span data-stu-id="800d5-115">You want toopersist output tooan Azure Storage container named according toohello [Batch File Conventions standard](https://github.com/Azure/azure-sdk-for-net/tree/vs17Dev/src/SDKs/Batch/Support/FileConventions#conventions).</span></span> 

<span data-ttu-id="800d5-116">Se lo scenario è diverso da quelli elencati in precedenza, potrebbe essere tooconsider un approccio diverso.</span><span class="sxs-lookup"><span data-stu-id="800d5-116">If your scenario differs from those listed above, you may need tooconsider a different approach.</span></span> <span data-ttu-id="800d5-117">Ad esempio, API del servizio Batch hello non attualmente supporta streaming output tooAzure archiviazione durante l'esecuzione di attività hello.</span><span class="sxs-lookup"><span data-stu-id="800d5-117">For example, hello Batch service API does not currently support streaming output tooAzure Storage while hello task is running.</span></span> <span data-ttu-id="800d5-118">toostream output, utilizzare la libreria hello convenzioni dei File Batch, disponibile per .NET.</span><span class="sxs-lookup"><span data-stu-id="800d5-118">toostream output, consider using hello Batch File Conventions library, available for .NET.</span></span> <span data-ttu-id="800d5-119">Per altre lingue, è necessario tooimplement la propria soluzione.</span><span class="sxs-lookup"><span data-stu-id="800d5-119">For other languages, you'll need tooimplement your own solution.</span></span> <span data-ttu-id="800d5-120">Per ulteriori informazioni sulle altre opzioni per salvare in modo permanente l'output dell'attività, vedere [Persist processi e delle attività di output tooAzure archiviazione](batch-task-output.md).</span><span class="sxs-lookup"><span data-stu-id="800d5-120">For more information on other options for persisting task output, see [Persist job and task output tooAzure Storage](batch-task-output.md).</span></span> 

## <a name="create-a-container-in-azure-storage"></a><span data-ttu-id="800d5-121">Creare un contenitore in Archiviazione di Azure</span><span class="sxs-lookup"><span data-stu-id="800d5-121">Create a container in Azure Storage</span></span>

<span data-ttu-id="800d5-122">output dell'attività di toopersist tooAzure archiviazione, sarà necessario toocreate un contenitore che funge da destinazione hello per i file di output.</span><span class="sxs-lookup"><span data-stu-id="800d5-122">toopersist task output tooAzure Storage, you'll need toocreate a container that serves as hello destination for your output files.</span></span> <span data-ttu-id="800d5-123">Creare il contenitore di hello prima di eseguire l'attività, preferibilmente prima di inviare il processo.</span><span class="sxs-lookup"><span data-stu-id="800d5-123">Create hello container before you run your task, preferably before you submit your job.</span></span> <span data-ttu-id="800d5-124">contenitore hello toocreate o utilizzare hello appropriata libreria client di archiviazione di Azure SDK.</span><span class="sxs-lookup"><span data-stu-id="800d5-124">toocreate hello container, use hello appropriate Azure Storage client library or SDK.</span></span> <span data-ttu-id="800d5-125">Per ulteriori informazioni sulle API di archiviazione di Azure, vedere hello [documentazione di archiviazione di Azure](https://docs.microsoft.com/azure/storage/).</span><span class="sxs-lookup"><span data-stu-id="800d5-125">For more information about Azure Storage APIs, see hello [Azure Storage documentation](https://docs.microsoft.com/azure/storage/).</span></span>

<span data-ttu-id="800d5-126">Ad esempio, se si scrive l'applicazione in c#, utilizzare hello [libreria client di archiviazione di Azure per .NET](https://www.nuget.org/packages/WindowsAzure.Storage/).</span><span class="sxs-lookup"><span data-stu-id="800d5-126">For example, if you are writing your application in C#, use hello [Azure Storage client library for .NET](https://www.nuget.org/packages/WindowsAzure.Storage/).</span></span> <span data-ttu-id="800d5-127">Hello seguente esempio viene illustrato come un contenitore toocreate:</span><span class="sxs-lookup"><span data-stu-id="800d5-127">hello following example shows how toocreate a container:</span></span>

```csharp
CloudBlobContainer container = storageAccount.CreateCloudBlobClient().GetContainerReference(containerName);
await conainer.CreateIfNotExists();
```

## <a name="get-a-shared-access-signature-for-hello-container"></a><span data-ttu-id="800d5-128">Ottenere una firma di accesso condiviso per il contenitore di hello</span><span class="sxs-lookup"><span data-stu-id="800d5-128">Get a shared access signature for hello container</span></span>

<span data-ttu-id="800d5-129">Dopo aver creato il contenitore di hello, ottenere una firma di accesso condiviso (SAS) con accesso in scrittura toohello contenitore.</span><span class="sxs-lookup"><span data-stu-id="800d5-129">After you create hello container, get a shared access signature (SAS) with write access toohello container.</span></span> <span data-ttu-id="800d5-130">Una firma di accesso condiviso fornisce contenitore toohello accesso delegato.</span><span class="sxs-lookup"><span data-stu-id="800d5-130">A SAS provides delegated access toohello container.</span></span> <span data-ttu-id="800d5-131">Hello firma di accesso condiviso concede l'accesso con un set specificato di autorizzazioni e in un intervallo di tempo specificato.</span><span class="sxs-lookup"><span data-stu-id="800d5-131">hello SAS grants access with a specified set of permissions and over a specified time interval.</span></span> <span data-ttu-id="800d5-132">Hello servizio Batch deve una firma di accesso condiviso con il contenitore toohello output attività di scrittura autorizzazioni toowrite.</span><span class="sxs-lookup"><span data-stu-id="800d5-132">hello Batch service needs a SAS with write permissions toowrite task output toohello container.</span></span> <span data-ttu-id="800d5-133">Per altre informazioni sulle firme di accesso condiviso, vedere [Uso delle firme di \(accesso condiviso\) in Archiviazione di Azure](../storage/common/storage-dotnet-shared-access-signature-part-1.md).</span><span class="sxs-lookup"><span data-stu-id="800d5-133">For more information about SAS, see [Using shared access signatures \(SAS\) in Azure Storage](../storage/common/storage-dotnet-shared-access-signature-part-1.md).</span></span>

<span data-ttu-id="800d5-134">Quando si otterrà una firma di accesso condiviso utilizzando le API di archiviazione di Azure hello, hello API restituisce una stringa di token di firma di accesso condiviso.</span><span class="sxs-lookup"><span data-stu-id="800d5-134">When you get a SAS using hello Azure Storage APIs, hello API returns a SAS token string.</span></span> <span data-ttu-id="800d5-135">Questa stringa di token include tutti i parametri di hello SAS, tra cui autorizzazioni hello e intervallo di hello in cui hello firma di accesso condiviso è valida.</span><span class="sxs-lookup"><span data-stu-id="800d5-135">This token string includes all parameters of hello SAS, including hello permissions and hello interval over which hello SAS is valid.</span></span> <span data-ttu-id="800d5-136">toouse hello SAS tooaccess un contenitore di archiviazione di Azure, è necessario tooappend hello SAS stringa token toohello URI della risorsa.</span><span class="sxs-lookup"><span data-stu-id="800d5-136">toouse hello SAS tooaccess a container in Azure Storage, you need tooappend hello SAS token string toohello resource URI.</span></span> <span data-ttu-id="800d5-137">Hello URI risorsa, insieme a hello aggiunto token SAS, fornisce l'accesso autenticato tooAzure archiviazione.</span><span class="sxs-lookup"><span data-stu-id="800d5-137">hello resource URI, together with hello appended SAS token, provides authenticated access tooAzure Storage.</span></span>

<span data-ttu-id="800d5-138">Hello esempio seguente viene illustrato come la stringa per il contenitore di hello del token tooget una SAS di sola scrittura, quindi aggiunge l'URI del contenitore toohello hello SAS:</span><span class="sxs-lookup"><span data-stu-id="800d5-138">hello following example shows how tooget a write-only SAS token string for hello container, then appends hello SAS toohello container URI:</span></span>

```csharp
string containerSasToken = container.GetSharedAccessSignature(new SharedAccessBlobPolicy()
{
    SharedAccessExpiryTime = DateTimeOffset.UtcNow.AddDays(1),
    Permissions = SharedAccessBlobPermissions.Write
});

string containerSasUrl = container.Uri.AbsoluteUri + containerSasToken; 
```

## <a name="specify-output-files-for-task-output"></a><span data-ttu-id="800d5-139">Specificare i file di output per l'output dell'attività</span><span class="sxs-lookup"><span data-stu-id="800d5-139">Specify output files for task output</span></span>

<span data-ttu-id="800d5-140">file di output toospecify per un'attività, creare una raccolta di [OutputFile](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.outputfile) oggetti e assegnarla toohello [CloudTask.OutputFiles](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudtask.outputfiles#Microsoft_Azure_Batch_CloudTask_OutputFiles) proprietà quando si crea l'attività hello.</span><span class="sxs-lookup"><span data-stu-id="800d5-140">toospecify output files for a task, create a collection of [OutputFile](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.outputfile) objects and assign it toohello [CloudTask.OutputFiles](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.cloudtask.outputfiles#Microsoft_Azure_Batch_CloudTask_OutputFiles) property when you create hello task.</span></span> 

<span data-ttu-id="800d5-141">esempio di codice .NET Hello crea un'attività che scrive file di numeri casuali tooa denominato `output.txt`.</span><span class="sxs-lookup"><span data-stu-id="800d5-141">hello following .NET code example creates a task that writes random numbers tooa file named `output.txt`.</span></span> <span data-ttu-id="800d5-142">esempio Hello crea un file di output per `output.txt` toobe scritto toohello contenitore.</span><span class="sxs-lookup"><span data-stu-id="800d5-142">hello example creates an output file for `output.txt` toobe written toohello container.</span></span> <span data-ttu-id="800d5-143">esempio Hello crea anche i file di output per tutti i file di log che corrispondono a criterio file hello `std*.txt` (_ad esempio_, `stdout.txt` e `stderr.txt`).</span><span class="sxs-lookup"><span data-stu-id="800d5-143">hello example also creates output files for any log files that match hello file pattern `std*.txt` (_e.g._, `stdout.txt` and `stderr.txt`).</span></span> <span data-ttu-id="800d5-144">URL del contenitore Hello richiede hello associazioni di sicurezza che è stato creato in precedenza per il contenitore di hello.</span><span class="sxs-lookup"><span data-stu-id="800d5-144">hello container URL requires hello SAS that was created previously for hello container.</span></span> <span data-ttu-id="800d5-145">Hello servizio Batch Usa contenitore toohello di hello SAS tooauthenticate accesso:</span><span class="sxs-lookup"><span data-stu-id="800d5-145">hello Batch service uses hello SAS tooauthenticate access toohello container:</span></span> 

```csharp
new CloudTask(taskId, "cmd /v:ON /c \"echo off && set && (FOR /L %i IN (1,1,100000) DO (ECHO !RANDOM!)) > output.txt\"")
{
    OutputFiles = new List<OutputFile>
    {
        new OutputFile(
            filePattern: @"..\std*.txt",
            destination: new OutputFileDestination(
         new OutputFileBlobContainerDestination(
                    containerUrl: containerSasUrl,
                    path: taskId)),
            uploadOptions: new OutputFileUploadOptions(
            uploadCondition: OutputFileUploadCondition.TaskCompletion)),
        new OutputFile(
            filePattern: @"output.txt",
            destination: 
         new OutputFileDestination(new OutputFileBlobContainerDestination(
                    containerUrl: containerSasUrl,
                    path: taskId + @"\output.txt")),
            uploadOptions: new OutputFileUploadOptions(
            uploadCondition: OutputFileUploadCondition.TaskCompletion)),
}
```

### <a name="specify-a-file-pattern-for-matching"></a><span data-ttu-id="800d5-146">Specificare un modello di file per la corrispondenza</span><span class="sxs-lookup"><span data-stu-id="800d5-146">Specify a file pattern for matching</span></span>

<span data-ttu-id="800d5-147">Quando si specifica un file di output, è possibile utilizzare hello [OutputFile.FilePattern](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.outputfile.filepattern#Microsoft_Azure_Batch_OutputFile_FilePattern) toospecify proprietà un modello di file per la corrispondenza.</span><span class="sxs-lookup"><span data-stu-id="800d5-147">When you specify an output file, you can use hello [OutputFile.FilePattern](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.outputfile.filepattern#Microsoft_Azure_Batch_OutputFile_FilePattern) property toospecify a file pattern for matching.</span></span> <span data-ttu-id="800d5-148">modello di file Hello potrebbe corrispondere a zero file, un singolo file o un set di file creati da attività hello.</span><span class="sxs-lookup"><span data-stu-id="800d5-148">hello file pattern may match zero files, a single file, or a set of files that are created by hello task.</span></span>

<span data-ttu-id="800d5-149">Hello **FilePattern** proprietà supporta i caratteri jolly standard del file System, ad esempio `*` (per non ricorsivo corrisponde) e `**` (per ricorsiva corrisponde).</span><span class="sxs-lookup"><span data-stu-id="800d5-149">hello **FilePattern** property supports standard filesystem wildcards such as `*` (for non-recursive matches) and `**` (for recursive matches).</span></span> <span data-ttu-id="800d5-150">Ad esempio, nell'esempio di codice hello precedente specifica hello file modello toomatch `std*.txt` non in modo ricorsivo:</span><span class="sxs-lookup"><span data-stu-id="800d5-150">For example, hello code sample above specifies hello file pattern toomatch `std*.txt` non-recursively:</span></span> 

`filePattern: @"..\std*.txt"`

<span data-ttu-id="800d5-151">tooupload un singolo file, specificare un modello di file senza caratteri jolly.</span><span class="sxs-lookup"><span data-stu-id="800d5-151">tooupload a single file, specify a file pattern with no wildcards.</span></span> <span data-ttu-id="800d5-152">Ad esempio, nell'esempio di codice hello precedente specifica hello file modello toomatch `output.txt`:</span><span class="sxs-lookup"><span data-stu-id="800d5-152">For example, hello code sample above specifies hello file pattern toomatch `output.txt`:</span></span>

`filePattern: @"output.txt"`

### <a name="specify-an-upload-condition"></a><span data-ttu-id="800d5-153">Specificare una condizione di caricamento</span><span class="sxs-lookup"><span data-stu-id="800d5-153">Specify an upload condition</span></span>

<span data-ttu-id="800d5-154">Hello [OutputFileUploadOptions.UploadCondition](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.outputfileuploadoptions.uploadcondition#Microsoft_Azure_Batch_OutputFileUploadOptions_UploadCondition) proprietà consente di caricare condizionale dei file di output.</span><span class="sxs-lookup"><span data-stu-id="800d5-154">hello [OutputFileUploadOptions.UploadCondition](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.outputfileuploadoptions.uploadcondition#Microsoft_Azure_Batch_OutputFileUploadOptions_UploadCondition) property permits conditional uploading of output files.</span></span> <span data-ttu-id="800d5-155">Uno scenario comune è tooupload un insieme di file se hello attività ha esito positivo e un set di file diverso, in caso di errore.</span><span class="sxs-lookup"><span data-stu-id="800d5-155">A common scenario is tooupload one set of files if hello task succeeds, and a different set of files if it fails.</span></span> <span data-ttu-id="800d5-156">È consigliabile, ad esempio, il file di log dettagliati tooupload solo quando l'attività hello non riesce e viene terminato con un codice di uscita diverso da zero.</span><span class="sxs-lookup"><span data-stu-id="800d5-156">For example, you may want tooupload verbose log files only when hello task fails and exits with a nonzero exit code.</span></span> <span data-ttu-id="800d5-157">Analogamente, è opportuno file dei risultati tooupload solo se l'attività hello ha esito positivo, come tali file potrebbero essere mancanti o incomplete se hello attività ha esito negativo.</span><span class="sxs-lookup"><span data-stu-id="800d5-157">Similarly, you may want tooupload result files only if hello task succeeds, as those files may be missing or incomplete if hello task fails.</span></span>

<span data-ttu-id="800d5-158">Nell'esempio di codice sopra Hello imposta hello **UploadCondition** proprietà troppo**TaskCompletion**.</span><span class="sxs-lookup"><span data-stu-id="800d5-158">hello code sample above sets hello **UploadCondition** property too**TaskCompletion**.</span></span> <span data-ttu-id="800d5-159">Questa impostazione specifica che se il file hello è toobe caricati dopo aver completato le attività di hello, indipendentemente dal valore hello hello codice di uscita.</span><span class="sxs-lookup"><span data-stu-id="800d5-159">This setting specifies that hello file is toobe uploaded after hello tasks completes, regardless of hello value of hello exit code.</span></span> 

`uploadCondition: OutputFileUploadCondition.TaskCompletion`

<span data-ttu-id="800d5-160">Per altre impostazioni, vedere hello [OutputFileUploadCondition](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.common.outputfileuploadcondition) enum.</span><span class="sxs-lookup"><span data-stu-id="800d5-160">For other settings, see hello [OutputFileUploadCondition](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.common.outputfileuploadcondition) enum.</span></span>

### <a name="disambiguate-files-with-hello-same-name"></a><span data-ttu-id="800d5-161">Risolvere le ambiguità nei file con hello stesso nome</span><span class="sxs-lookup"><span data-stu-id="800d5-161">Disambiguate files with hello same name</span></span>

<span data-ttu-id="800d5-162">attività Hello in un processo può produrre file hello con stesso nome.</span><span class="sxs-lookup"><span data-stu-id="800d5-162">hello tasks in a job may produce files that have hello same name.</span></span> <span data-ttu-id="800d5-163">Ad esempio, i file `stdout.txt` e `stderr.txt` vengono creati per ogni attività eseguita in un processo.</span><span class="sxs-lookup"><span data-stu-id="800d5-163">For example, `stdout.txt` and `stderr.txt` are created for every task that runs in a job.</span></span> <span data-ttu-id="800d5-164">Poiché ogni attività viene eseguita in un contesto specifico, questi file non siano in conflitto nel file system di hello nodo.</span><span class="sxs-lookup"><span data-stu-id="800d5-164">Because each task runs in its own context, these files don't conflict on hello node's file system.</span></span> <span data-ttu-id="800d5-165">Tuttavia, quando si caricano file dal contenitore di condivisi di più attività tooa, è necessario il file toodisambiguate con hello stesso nome.</span><span class="sxs-lookup"><span data-stu-id="800d5-165">However, when you upload files from multiple tasks tooa shared container, you'll need toodisambiguate files with hello same name.</span></span>

<span data-ttu-id="800d5-166">Hello [OutputFileBlobContainerDestination.Path](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.outputfileblobcontainerdestination.path#Microsoft_Azure_Batch_OutputFileBlobContainerDestination_Path) proprietà specifica il blob di destinazione hello o la directory virtuale per file di output.</span><span class="sxs-lookup"><span data-stu-id="800d5-166">hello [OutputFileBlobContainerDestination.Path](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.outputfileblobcontainerdestination.path#Microsoft_Azure_Batch_OutputFileBlobContainerDestination_Path) property specifies hello destination blob or virtual directory for output files.</span></span> <span data-ttu-id="800d5-167">È possibile utilizzare hello **percorso** blob hello tooname di proprietà o la directory virtuale in modo che i file di output con hello stesso nome sono denominati in modo univoco in archiviazione di Azure.</span><span class="sxs-lookup"><span data-stu-id="800d5-167">You can use hello **Path** property tooname hello blob or virtual directory in such a way that output files with hello same name are uniquely named in Azure Storage.</span></span> <span data-ttu-id="800d5-168">Usando un ID di attività hello in percorso hello è un nome univoco di tooensure efficace e identificare facilmente i file.</span><span class="sxs-lookup"><span data-stu-id="800d5-168">Using hello task ID in hello path is a good way tooensure unique names and easily identify files.</span></span>

<span data-ttu-id="800d5-169">Se hello **FilePattern** tooa espressione con caratteri jolly è impostata, quindi tutti i file che corrispondono a hello criterio sono caricati toohello directory virtuale specificata da hello **percorso** proprietà.</span><span class="sxs-lookup"><span data-stu-id="800d5-169">If hello **FilePattern** property is set tooa wildcard expression, then all files that match hello pattern are uploaded toohello virtual directory specified by hello **Path** property.</span></span> <span data-ttu-id="800d5-170">Ad esempio, se hello contenitore è `mycontainer`, attività hello ID `mytask`, e il modello di file hello è `..\std*.txt`, quindi hello assoluto URI toohello di file di output in archiviazione di Azure sarà simile a:</span><span class="sxs-lookup"><span data-stu-id="800d5-170">For example, if hello container is `mycontainer`, hello task ID is `mytask`, and hello file pattern is `..\std*.txt`, then hello absolute URIs toohello output files in Azure Storage will be similar to:</span></span>

```
https://myaccount.blob.core.windows.net/mycontainer/mytask/stderr.txt
https://myaccount.blob.core.windows.net/mycontainer/mytask/stdout.txt
```

<span data-ttu-id="800d5-171">Se hello **FilePattern** proprietà set toomatch un singolo nome file, quindi non contiene caratteri jolly, ovvero hello valore hello **percorso** proprietà specifica il nome di blob completo hello .</span><span class="sxs-lookup"><span data-stu-id="800d5-171">If hello **FilePattern** property is set toomatch a single file name, meaning it does not contain any wildcard characters, then hello value of hello **Path** property specifies hello fully qualified blob name.</span></span> <span data-ttu-id="800d5-172">Se si prevede di conflitto con un singolo file da più attività, quindi includere hello nome della directory virtuale hello come parte di toodisambiguate di nome file hello tali file.</span><span class="sxs-lookup"><span data-stu-id="800d5-172">If you anticipate naming conflicts with a single file from multiple tasks, then include hello name of hello virtual directory as part of hello file name toodisambiguate those files.</span></span> <span data-ttu-id="800d5-173">Ad esempio, set hello **percorso** ID attività hello tooinclude di proprietà, il carattere delimitatore hello (in genere una barra rovesciata) e nome del file hello:</span><span class="sxs-lookup"><span data-stu-id="800d5-173">For example, set hello **Path** property tooinclude hello task ID, hello delimiter character (typically a forward slash), and hello file name:</span></span>

`path: taskId + @"/output.txt"`

<span data-ttu-id="800d5-174">Hello assoluto URI toohello i file di output per un set di attività sarà simili a:</span><span class="sxs-lookup"><span data-stu-id="800d5-174">hello absolute URIs toohello output files for a set of tasks will be similar to:</span></span>

```
https://myaccount.blob.core.windows.net/mycontainer/task1/output.txt
https://myaccount.blob.core.windows.net/mycontainer/task2/output.txt
```

<span data-ttu-id="800d5-175">Per ulteriori informazioni sulle directory virtuali in archiviazione di Azure, vedere [elencare i BLOB hello in un contenitore](../storage/blobs/storage-dotnet-how-to-use-blobs.md#list-the-blobs-in-a-container).</span><span class="sxs-lookup"><span data-stu-id="800d5-175">For more information about virtual directories in Azure Storage, see [List hello blobs in a container](../storage/blobs/storage-dotnet-how-to-use-blobs.md#list-the-blobs-in-a-container).</span></span>


## <a name="diagnose-file-upload-errors"></a><span data-ttu-id="800d5-176">Diagnosticare gli errori di caricamento file</span><span class="sxs-lookup"><span data-stu-id="800d5-176">Diagnose file upload errors</span></span>

<span data-ttu-id="800d5-177">Se l'output di caricamento file ha esito negativo archiviazione tooAzure, quindi attività hello Sposta toohello **completato** lo stato e hello [TaskExecutionInformation.FailureInformation](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.taskexecutioninformation.failureinformation#Microsoft_Azure_Batch_TaskExecutionInformation_FailureInformation) proprietà è impostata.</span><span class="sxs-lookup"><span data-stu-id="800d5-177">If uploading output files tooAzure Storage fails, then hello task moves toohello **Completed** state and hello [TaskExecutionInformation.FailureInformation](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.taskexecutioninformation.failureinformation#Microsoft_Azure_Batch_TaskExecutionInformation_FailureInformation) property is set.</span></span> <span data-ttu-id="800d5-178">Esaminare hello **FailureInformation** toodetermine proprietà sul tipo di errore.</span><span class="sxs-lookup"><span data-stu-id="800d5-178">Examine hello **FailureInformation** property toodetermine what error occurred.</span></span> <span data-ttu-id="800d5-179">Di seguito è ad esempio, un errore che si verifica al momento del caricamento di file non è possibile trovare il contenitore di hello:</span><span class="sxs-lookup"><span data-stu-id="800d5-179">For example, here is an error that occurs on file upload if hello container cannot be found:</span></span> 

```
Category: UserError
Code: FileUploadContainerNotFound
Message: One of hello specified Azure container(s) was not found while attempting tooupload an output file
```

<span data-ttu-id="800d5-180">In ogni caricamento di file, scrive due log del nodo di calcolo toohello file, Batch `fileuploadout.txt` e `fileuploaderr.txt`.</span><span class="sxs-lookup"><span data-stu-id="800d5-180">On every file upload, Batch writes two log files toohello compute node, `fileuploadout.txt` and `fileuploaderr.txt`.</span></span> <span data-ttu-id="800d5-181">È possibile esaminare questi toolearn i file di log altre informazioni sull'errore specifico.</span><span class="sxs-lookup"><span data-stu-id="800d5-181">You can examine these log files toolearn more about a specific failure.</span></span> <span data-ttu-id="800d5-182">Nei casi in cui il caricamento di file hello mai tentativo, ad esempio perché non è stato possibile eseguire l'attività hello stessa, quindi questi file di log non esiste.</span><span class="sxs-lookup"><span data-stu-id="800d5-182">In cases where hello file upload was never attempted, for example because hello task itself couldn’t run, then these log files will not exist.</span></span>

## <a name="diagnose-file-upload-performance"></a><span data-ttu-id="800d5-183">Diagnosticare le prestazioni di caricamento file</span><span class="sxs-lookup"><span data-stu-id="800d5-183">Diagnose file upload performance</span></span>

<span data-ttu-id="800d5-184">Hello `fileuploadout.txt` file registra lo stato di caricamento.</span><span class="sxs-lookup"><span data-stu-id="800d5-184">hello `fileuploadout.txt` file logs upload progress.</span></span> <span data-ttu-id="800d5-185">È possibile esaminare questo toolearn file richiede ulteriori informazioni su quanto tempo consente di caricare il file.</span><span class="sxs-lookup"><span data-stu-id="800d5-185">You can examine this file toolearn more about how long your file uploads are taking.</span></span> <span data-ttu-id="800d5-186">Tenere presente che esistono molti fattori delle prestazioni tooupload, comprese le dimensioni di hello del nodo di hello, altre attività nel nodo hello in fase di hello di caricamento di hello, se un contenitore di destinazione hello in hello pool Batch hello stessa area, il numero di nodi è caricamento account di archiviazione toohello in hello stesso tempo e così via.</span><span class="sxs-lookup"><span data-stu-id="800d5-186">Keep in mind that there are many contributing factors tooupload performance, including hello size of hello node, other activity on hello node at hello time of hello upload, whether hello target container is in hello same region as hello Batch pool, how many nodes are uploading toohello storage account at hello same time, and so on.</span></span>

## <a name="use-hello-batch-service-api-with-hello-batch-file-conventions-standard"></a><span data-ttu-id="800d5-187">Utilizzare l'API del servizio Batch hello con hello convenzioni dei File Batch standard</span><span class="sxs-lookup"><span data-stu-id="800d5-187">Use hello Batch service API with hello Batch File Conventions standard</span></span>

<span data-ttu-id="800d5-188">Quando si mantiene fissa l'output dell'attività con hello API del servizio Batch, è possibile assegnare un nome del contenitore di destinazione e tuttavia si desidera che i BLOB.</span><span class="sxs-lookup"><span data-stu-id="800d5-188">When you persist task output with hello Batch service API, you can name your destination container and blobs however you like.</span></span> <span data-ttu-id="800d5-189">È anche possibile scegliere tooname loro in base toohello [standard convenzioni dei File Batch](https://github.com/Azure/azure-sdk-for-net/tree/vs17Dev/src/SDKs/Batch/Support/FileConventions#conventions).</span><span class="sxs-lookup"><span data-stu-id="800d5-189">You can also choose tooname them according toohello [Batch File Conventions standard](https://github.com/Azure/azure-sdk-for-net/tree/vs17Dev/src/SDKs/Batch/Support/FileConventions#conventions).</span></span> <span data-ttu-id="800d5-190">standard convenzioni File Hello determina i nomi di hello del contenitore di destinazione hello e blob in archiviazione di Azure per un file di output specificata in base ai nomi di hello del processo di hello e attività.</span><span class="sxs-lookup"><span data-stu-id="800d5-190">hello File Conventions standard determines hello names of hello destination container and blob in Azure Storage for a given output file based on hello names of hello job and task.</span></span> <span data-ttu-id="800d5-191">Se si utilizza hello convenzioni dei File standard per la denominazione dei file di output, quindi i file di output sono disponibili per la visualizzazione in hello [portale di Azure](https://portal.azure.com).</span><span class="sxs-lookup"><span data-stu-id="800d5-191">If you do use hello File Conventions standard for naming output files, then your output files are available for viewing in hello [Azure portal](https://portal.azure.com).</span></span>

<span data-ttu-id="800d5-192">Se si sviluppa in c#, è possibile utilizzare i metodi di hello incorporati hello [libreria convenzioni dei File Batch per .NET](https://www.nuget.org/packages/Microsoft.Azure.Batch.Conventions.Files).</span><span class="sxs-lookup"><span data-stu-id="800d5-192">If you are developing in C#, you can use hello methods built into hello [Batch File Conventions library for .NET](https://www.nuget.org/packages/Microsoft.Azure.Batch.Conventions.Files).</span></span> <span data-ttu-id="800d5-193">Questa libreria crea hello denominate in modo corretto i contenitori e percorsi blob per l'utente.</span><span class="sxs-lookup"><span data-stu-id="800d5-193">This library creates hello properly named containers and blob paths for you.</span></span> <span data-ttu-id="800d5-194">Ad esempio, è possibile chiamare API hello tooget hello il nome corretto per il contenitore di hello, in base al nome di processo hello:</span><span class="sxs-lookup"><span data-stu-id="800d5-194">For example, you can call hello API tooget hello correct name for hello container, based on hello job name:</span></span>

```csharp
string containerName = job.OutputStorageContainerName();
```

<span data-ttu-id="800d5-195">È possibile utilizzare hello [CloudJobExtensions.GetOutputStorageContainerUrl](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.conventions.files.cloudjobextensions.getoutputstoragecontainerurl) metodo tooreturn un URL di accesso condiviso (firma) utilizzati toowrite toohello contenitore.</span><span class="sxs-lookup"><span data-stu-id="800d5-195">You can use hello [CloudJobExtensions.GetOutputStorageContainerUrl](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.conventions.files.cloudjobextensions.getoutputstoragecontainerurl) method tooreturn a shared access signature (SAS) URL that is used toowrite toohello container.</span></span> <span data-ttu-id="800d5-196">È quindi possibile passare questo toohello SAS [OutputFileBlobContainerDestination](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.outputfileblobcontainerdestination) costruttore.</span><span class="sxs-lookup"><span data-stu-id="800d5-196">You can then pass this SAS toohello [OutputFileBlobContainerDestination](https://docs.microsoft.com/dotnet/api/microsoft.azure.batch.outputfileblobcontainerdestination) constructor.</span></span>

<span data-ttu-id="800d5-197">Se si sviluppa in un linguaggio diverso da c#, si sarà necessario standard di tooimplement hello convenzioni dei File.</span><span class="sxs-lookup"><span data-stu-id="800d5-197">If you are developing in a language other than C#, you will need tooimplement hello File Conventions standard yourself.</span></span>

## <a name="code-sample"></a><span data-ttu-id="800d5-198">Esempio di codice</span><span class="sxs-lookup"><span data-stu-id="800d5-198">Code sample</span></span>

<span data-ttu-id="800d5-199">Hello [PersistOutputs] [ github_persistoutputs] progetto di esempio è uno dei hello [esempi di codice di Azure Batch] [ github_samples] su GitHub.</span><span class="sxs-lookup"><span data-stu-id="800d5-199">hello [PersistOutputs][github_persistoutputs] sample project is one of hello [Azure Batch code samples][github_samples] on GitHub.</span></span> <span data-ttu-id="800d5-200">Questa soluzione di Visual Studio viene illustrato come libreria client di toouse hello Batch per attività toopersist .NET output toodurable archiviazione.</span><span class="sxs-lookup"><span data-stu-id="800d5-200">This Visual Studio solution demonstrates how toouse hello Batch client library for .NET toopersist task output toodurable storage.</span></span> <span data-ttu-id="800d5-201">hello toorun di esempio, seguire questi passaggi:</span><span class="sxs-lookup"><span data-stu-id="800d5-201">toorun hello sample, follow these steps:</span></span>

1. <span data-ttu-id="800d5-202">Progetto aperto hello in **Visual Studio 2015 o versione successiva**.</span><span class="sxs-lookup"><span data-stu-id="800d5-202">Open hello project in **Visual Studio 2015 or newer**.</span></span>
2. <span data-ttu-id="800d5-203">Aggiungere il Batch e l'archiviazione **delle credenziali dell'account** troppo**AccountSettings.settings** nel progetto Microsoft.Azure.Batch.Samples.Common hello.</span><span class="sxs-lookup"><span data-stu-id="800d5-203">Add your Batch and Storage **account credentials** too**AccountSettings.settings** in hello Microsoft.Azure.Batch.Samples.Common project.</span></span>
3. <span data-ttu-id="800d5-204">**Compilare** (ma non le eseguono) hello soluzione.</span><span class="sxs-lookup"><span data-stu-id="800d5-204">**Build** (but do not run) hello solution.</span></span> <span data-ttu-id="800d5-205">Se richiesto, ripristinare tutti i pacchetti NuGet.</span><span class="sxs-lookup"><span data-stu-id="800d5-205">Restore any NuGet packages if prompted.</span></span>
4. <span data-ttu-id="800d5-206">Hello utilizzare tooupload portale Azure un [pacchetto di applicazione](batch-application-packages.md) per **PersistOutputsTask**.</span><span class="sxs-lookup"><span data-stu-id="800d5-206">Use hello Azure portal tooupload an [application package](batch-application-packages.md) for **PersistOutputsTask**.</span></span> <span data-ttu-id="800d5-207">Includere hello `PersistOutputsTask.exe` e i relativi assembly dipendenti nel pacchetto ZIP hello, set di ID dell'applicazione hello troppo "PersistOutputsTask" e un'applicazione hello pacchetto versione troppo "1.0".</span><span class="sxs-lookup"><span data-stu-id="800d5-207">Include hello `PersistOutputsTask.exe` and its dependent assemblies in hello .zip package, set hello application ID too"PersistOutputsTask", and hello application package version too"1.0".</span></span>
5. <span data-ttu-id="800d5-208">**Avviare** hello (esecuzione) **PersistOutputs** progetto.</span><span class="sxs-lookup"><span data-stu-id="800d5-208">**Start** (run) hello **PersistOutputs** project.</span></span>
6. <span data-ttu-id="800d5-209">Quando richiesto toochoose hello persistenza tecnologia toouse per esempio hello in esecuzione, immettere **2** toorun: esempio hello usando l'output dell'attività toopersist hello API del servizio Batch.</span><span class="sxs-lookup"><span data-stu-id="800d5-209">When prompted toochoose hello persistence technology toouse for running hello sample, enter **2** toorun hello sample using hello Batch service API toopersist task output.</span></span>
7. <span data-ttu-id="800d5-210">Se si desidera, eseguire: esempio hello nuovamente, immettendo **3** toopersist output con l'API del servizio Batch hello e tooname hello blob e contenitore percorso di destinazione in base toohello convenzioni dei File standard.</span><span class="sxs-lookup"><span data-stu-id="800d5-210">If desired, run hello sample again, entering **3** toopersist output with hello Batch service API, and also tooname hello destination container and blob path according toohello File Conventions standard.</span></span>

## <a name="next-steps"></a><span data-ttu-id="800d5-211">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="800d5-211">Next steps</span></span>

- <span data-ttu-id="800d5-212">Per ulteriori informazioni sul salvataggio in modo permanente l'output dell'attività con libreria convenzioni File hello per .NET, vedere [mantenere job e task tooAzure archiviazione dati con libreria di hello convenzioni dei File Batch per .NET toopersist ](batch-task-output-file-conventions.md).</span><span class="sxs-lookup"><span data-stu-id="800d5-212">For more information on persisting task output with hello File Conventions library for .NET, see [Persist job and task data tooAzure Storage with hello Batch File Conventions library for .NET toopersist ](batch-task-output-file-conventions.md).</span></span>
- <span data-ttu-id="800d5-213">Per informazioni su altri approcci per rendere persistenti i dati di output in Batch di Azure, vedere [Persist processi e delle attività di output tooAzure archiviazione](batch-task-output.md).</span><span class="sxs-lookup"><span data-stu-id="800d5-213">For information on other approaches for persisting output data in Azure Batch, see [Persist job and task output tooAzure Storage](batch-task-output.md).</span></span>

[github_persistoutputs]: https://github.com/Azure/azure-batch-samples/tree/master/CSharp/ArticleProjects/PersistOutputs
[github_samples]: https://github.com/Azure/azure-batch-samples
