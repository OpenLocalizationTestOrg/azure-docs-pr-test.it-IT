---
title: 'Eseguire la migrazione ExpressRoute e delle reti virtuali associate dal modello di distribuzione classica a Resource Manager: Azure: PowerShell | Microsoft Docs'
description: Questa pagina illustra come eseguire la migrazione delle reti virtuali associate in Resource Manager dopo lo spostamento del circuito.
documentationcenter: na
services: expressroute
author: ganesr
manager: timlt
editor: 
tags: azure-resource-manager
ms.assetid: 
ms.service: expressroute
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 07/06/2017
ms.author: ganesr;cherylmc
ms.openlocfilehash: 964ea38569062a7127f60dd6309b328db263bf6f
ms.sourcegitcommit: 02e69c4a9d17645633357fe3d46677c2ff22c85a
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/03/2017
---
# <a name="migrate-expressroute-associated-virtual-networks-from-classic-to-resource-manager"></a><span data-ttu-id="39829-103">Eseguire la migrazione di reti virtuali associate ExpressRoute dal modello di distribuzione classica a Resource Manager</span><span class="sxs-lookup"><span data-stu-id="39829-103">Migrate ExpressRoute associated virtual networks from classic to Resource Manager</span></span>

<span data-ttu-id="39829-104">Questo articolo illustra come eseguire la migrazione delle reti virtuali associate di Azure ExpressRoute dal modello di distribuzione classica al modello di distribuzione Azure Resource Manager dopo lo spostamento del circuito ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="39829-104">This article explains how to migrate Azure ExpressRoute associated virtual networks from the classic deployment model to the Azure Resource Manager deployment model after moving your ExpressRoute circuit.</span></span> 


## <a name="before-you-begin"></a><span data-ttu-id="39829-105">Prima di iniziare</span><span class="sxs-lookup"><span data-stu-id="39829-105">Before you begin</span></span>
* <span data-ttu-id="39829-106">Verificare di avere la versione più recente dei moduli di Azure PowerShell.</span><span class="sxs-lookup"><span data-stu-id="39829-106">Verify that you have the latest version of the Azure PowerShell modules.</span></span> <span data-ttu-id="39829-107">Per altre informazioni, vedere [Come installare e configurare Azure PowerShell](/powershell/azure/overview).</span><span class="sxs-lookup"><span data-stu-id="39829-107">For more information, see [How to install and configure Azure PowerShell](/powershell/azure/overview).</span></span>
* <span data-ttu-id="39829-108">Prima di procedere con la configurazione, assicurarsi di avere verificato i [prerequisiti](expressroute-prerequisites.md), i [requisiti di routing](expressroute-routing.md) e i [flussi di lavoro](expressroute-workflows.md).</span><span class="sxs-lookup"><span data-stu-id="39829-108">Make sure that you have reviewed the [prerequisites](expressroute-prerequisites.md), [routing requirements](expressroute-routing.md), and [workflows](expressroute-workflows.md) before you begin configuration.</span></span>
* <span data-ttu-id="39829-109">Rivedere le informazioni disponibili in [Spostamento dei circuiti ExpressRoute dal modello di distribuzione classica al modello di distribuzione Resource Manager](expressroute-move.md).</span><span class="sxs-lookup"><span data-stu-id="39829-109">Review the information that is provided under [Moving an ExpressRoute circuit from classic to Resource Manager](expressroute-move.md).</span></span> <span data-ttu-id="39829-110">Assicurarsi di aver compreso pienamente i limiti e le limitazioni.</span><span class="sxs-lookup"><span data-stu-id="39829-110">Make sure that you fully understand the limits and limitations.</span></span>
* <span data-ttu-id="39829-111">Verificare che il circuito sia completamente operativo nel modello di distribuzione classica.</span><span class="sxs-lookup"><span data-stu-id="39829-111">Verify that the circuit is fully operational in the classic deployment model.</span></span>
* <span data-ttu-id="39829-112">Assicurarsi che sia disponibile un gruppo di risorse creato nel modello di distribuzione Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="39829-112">Ensure that you have a resource group that was created in the Resource Manager deployment model.</span></span>
* <span data-ttu-id="39829-113">Vedere la documentazione seguente sulla migrazione delle risorse:</span><span class="sxs-lookup"><span data-stu-id="39829-113">Review the following resource-migration documentation:</span></span>

    * [<span data-ttu-id="39829-114">Migrazione supportata dalla piattaforma di risorse IaaS dal modello di distribuzione classica ad Azure Resource Manager</span><span class="sxs-lookup"><span data-stu-id="39829-114">Platform-supported migration of IaaS resources from classic to Azure Resource Manager</span></span>](../virtual-machines/virtual-machines-windows-migration-classic-resource-manager.md)
    * [<span data-ttu-id="39829-115">Approfondimento tecnico sulla migrazione supportata dalla piattaforma dal modello di distribuzione classica ad Azure Resource Manager</span><span class="sxs-lookup"><span data-stu-id="39829-115">Technical deep dive on platform-supported migration from classic to Azure Resource Manager</span></span>](../virtual-machines/virtual-machines-windows-migration-classic-resource-manager-deep-dive.md)
    * <span data-ttu-id="39829-116">[FAQs: Platform-supported migration of IaaS resources from classic to Azure Resource Manager](../virtual-machines/virtual-machines-windows-migration-classic-resource-manager.md) (Domande frequenti: Migrazione supportata dalla piattaforma per risorse IaaS dalla distribuzione classica ad Azure Resource Manager)</span><span class="sxs-lookup"><span data-stu-id="39829-116">[FAQs: Platform-supported migration of IaaS resources from classic to Azure Resource Manager](../virtual-machines/virtual-machines-windows-migration-classic-resource-manager.md)</span></span>
    * [<span data-ttu-id="39829-117">Rivedere gli errori di migrazione più comuni e le soluzioni</span><span class="sxs-lookup"><span data-stu-id="39829-117">Review most common migration errors and mitigations</span></span>](../virtual-machines/windows/migration-classic-resource-manager-errors.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json)

## <a name="supported-and-unsupported-scenarios"></a><span data-ttu-id="39829-118">Scenari supportati e non supportati</span><span class="sxs-lookup"><span data-stu-id="39829-118">Supported and unsupported scenarios</span></span>

* <span data-ttu-id="39829-119">È possibile spostare un circuito ExpressRoute dal modello di distribuzione classica all'ambiente Resource Manager senza tempi di inattività.</span><span class="sxs-lookup"><span data-stu-id="39829-119">An ExpressRoute circuit can be moved from the classic to the Resource Manager environment without any downtime.</span></span> <span data-ttu-id="39829-120">È possibile spostare qualsiasi circuito ExpressRoute dal modello di distribuzione classica all'ambiente Resource Manager senza tempi di inattività.</span><span class="sxs-lookup"><span data-stu-id="39829-120">You can move any ExpressRoute circuit from the classic to the Resource Manager environment with no downtime.</span></span> <span data-ttu-id="39829-121">Seguire le istruzioni disponibili in [Moving ExpressRoute circuits from the classic to the Resource Manager deployment model using PowerShell](expressroute-howto-move-arm.md) (Spostare i circuiti ExpressRoute dal modello di distribuzione classica a quello Resource Manager usando PowerShell).</span><span class="sxs-lookup"><span data-stu-id="39829-121">Follow the instructions in [moving ExpressRoute circuits from the classic to the Resource Manager deployment model using PowerShell](expressroute-howto-move-arm.md).</span></span> <span data-ttu-id="39829-122">Questo è un prerequisito per lo spostamento di risorse connesse alla rete virtuale.</span><span class="sxs-lookup"><span data-stu-id="39829-122">This is a prerequisite to move resources connected to the virtual network.</span></span>
* <span data-ttu-id="39829-123">È possibile eseguire la migrazione nell'ambiente Resource Manager di reti virtuali, gateway e distribuzioni associate che si trovano nella rete virtuale e sono associati al circuito ExpressRoute nella stessa sottoscrizione, senza tempi di inattività.</span><span class="sxs-lookup"><span data-stu-id="39829-123">Virtual networks, gateways, and associated deployments within the virtual network that are attached to an ExpressRoute circuit in the same subscription can be migrated to the Resource Manager environment without any downtime.</span></span> <span data-ttu-id="39829-124">È possibile seguire la procedura illustrata più avanti per eseguire la migrazione di risorse come reti virtuali, gateway e macchine virtuali distribuiti nella rete virtuale.</span><span class="sxs-lookup"><span data-stu-id="39829-124">You can follow the steps described later to migrate resources such as virtual networks, gateways, and virtual machines deployed within the virtual network.</span></span> <span data-ttu-id="39829-125">È necessario assicurare che le reti virtuali siano configurate correttamente prima della migrazione.</span><span class="sxs-lookup"><span data-stu-id="39829-125">You must ensure that the virtual networks are configured correctly before they are migrated.</span></span> 
* <span data-ttu-id="39829-126">Le reti virtuali, i gateway e le distribuzioni associate che si trovano nella rete virtuale ma non sono inclusi nella stessa sottoscrizione del circuito ExpressRoute richiedono del tempo di inattività per il completamento della migrazione.</span><span class="sxs-lookup"><span data-stu-id="39829-126">Virtual networks, gateways, and associated deployments within the virtual network that are not in the same subscription as the ExpressRoute circuit require some downtime to complete the migration.</span></span> <span data-ttu-id="39829-127">L'ultima sezione del documento illustra la procedura da seguire per eseguire la migrazione delle risorse.</span><span class="sxs-lookup"><span data-stu-id="39829-127">The last section of the document describes the steps to be followed to migrate resources.</span></span>
* <span data-ttu-id="39829-128">Non è possibile eseguire la migrazione di una rete virtuale con Gateway ExpressRoute e Gateway VPN.</span><span class="sxs-lookup"><span data-stu-id="39829-128">A virtual network with both ExpressRoute Gateway and VPN Gateway can't be migrated.</span></span>

## <a name="move-an-expressroute-circuit-from-classic-to-resource-manager"></a><span data-ttu-id="39829-129">Spostare un circuito ExpressRoute dal modello di distribuzione classica a Resource Manager</span><span class="sxs-lookup"><span data-stu-id="39829-129">Move an ExpressRoute circuit from classic to Resource Manager</span></span>
<span data-ttu-id="39829-130">È necessario spostare un circuito ExpressRoute da una distribuzione classica a un ambiente Resource Manager prima di provare a eseguire la migrazione delle risorse associate al circuito ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="39829-130">You must move an ExpressRoute circuit from the classic to the Resource Manager environment before you try to migrate resources that are attached to the ExpressRoute circuit.</span></span> <span data-ttu-id="39829-131">Per ottenere questo risultato, vedere gli articoli seguenti:</span><span class="sxs-lookup"><span data-stu-id="39829-131">To accomplish this task, see the following articles:</span></span>

* <span data-ttu-id="39829-132">Rivedere le informazioni disponibili in [Spostamento dei circuiti ExpressRoute dal modello di distribuzione classica al modello di distribuzione Resource Manager](expressroute-move.md).</span><span class="sxs-lookup"><span data-stu-id="39829-132">Review the information that is provided under [Moving an ExpressRoute circuit from classic to Resource Manager](expressroute-move.md).</span></span>
* <span data-ttu-id="39829-133">[Spostare un circuito dal modello di distribuzione classica a quello Resource Manager usando Azure PowerShell](expressroute-howto-move-arm.md).</span><span class="sxs-lookup"><span data-stu-id="39829-133">[Move a circuit from classic to Resource Manager using Azure PowerShell](expressroute-howto-move-arm.md).</span></span>
* <span data-ttu-id="39829-134">Usare il portale di gestione dei servizi di Azure.</span><span class="sxs-lookup"><span data-stu-id="39829-134">Use the Azure Service Management portal.</span></span> <span data-ttu-id="39829-135">È possibile seguire il flusso di lavoro per [creare un nuovo circuito ExpressRoute](expressroute-howto-circuit-portal-resource-manager.md) e selezionare l'opzione di importazione.</span><span class="sxs-lookup"><span data-stu-id="39829-135">You can follow the workflow to [create a new ExpressRoute circuit](expressroute-howto-circuit-portal-resource-manager.md) and select the import option.</span></span> 

<span data-ttu-id="39829-136">Questa operazione non comporta tempi di inattività.</span><span class="sxs-lookup"><span data-stu-id="39829-136">This operation does not involve downtime.</span></span> <span data-ttu-id="39829-137">È possibile continuare a trasferire dati tra l'istanza locale e Microsoft durante la migrazione.</span><span class="sxs-lookup"><span data-stu-id="39829-137">You can continue to transfer data between your premises and Microsoft while the migration is in progress.</span></span>

## <a name="migrate-virtual-networks-gateways-and-associated-deployments"></a><span data-ttu-id="39829-138">Eseguire la migrazione di reti virtuali, i gateway e distribuzioni associate</span><span class="sxs-lookup"><span data-stu-id="39829-138">Migrate virtual networks, gateways, and associated deployments</span></span>

<span data-ttu-id="39829-139">I passaggi necessari per eseguire la migrazione variano a seconda che le risorse siano nella stessa sottoscrizione, in diverse sottoscrizioni o in presenza di entrambi i casi.</span><span class="sxs-lookup"><span data-stu-id="39829-139">The steps you follow to migrate depend on whether your resources are in the same subscription, different subscriptions, or both.</span></span>

### <a name="migrate-virtual-networks-gateways-and-associated-deployments-in-the-same-subscription-as-the-expressroute-circuit"></a><span data-ttu-id="39829-140">Eseguire la migrazione di reti virtuali, gateway e distribuzioni associate nella stessa sottoscrizione del circuito ExpressRoute</span><span class="sxs-lookup"><span data-stu-id="39829-140">Migrate virtual networks, gateways, and associated deployments in the same subscription as the ExpressRoute circuit</span></span>
<span data-ttu-id="39829-141">Questa sezione illustra la procedura da seguire per eseguire la migrazione di una rete virtuale, un gateway e le distribuzioni associate nella stessa sottoscrizione del circuito ExpressRoute.</span><span class="sxs-lookup"><span data-stu-id="39829-141">This section describes the steps to be followed to migrate a virtual network, gateway, and associated deployments in the same subscription as the ExpressRoute circuit.</span></span> <span data-ttu-id="39829-142">Questa migrazione non comporta tempi di inattività.</span><span class="sxs-lookup"><span data-stu-id="39829-142">No downtime is associated with this migration.</span></span> <span data-ttu-id="39829-143">È possibile continuare a usare tutte le risorse durante il processo di migrazione.</span><span class="sxs-lookup"><span data-stu-id="39829-143">You can continue to use all resources through the migration process.</span></span> <span data-ttu-id="39829-144">Il piano di gestione è bloccato durante la migrazione.</span><span class="sxs-lookup"><span data-stu-id="39829-144">The management plane is locked while the migration is in progress.</span></span> 

1. <span data-ttu-id="39829-145">Assicurarsi che il circuito ExpressRoute sia stato spostato dalla distribuzione classica all'ambiente Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="39829-145">Ensure that the ExpressRoute circuit has been moved from the classic to the Resource Manager environment.</span></span>
2. <span data-ttu-id="39829-146">Assicurarsi che la rete virtuale sia stata preparata in modo appropriato per la migrazione.</span><span class="sxs-lookup"><span data-stu-id="39829-146">Ensure that the virtual network has been prepared appropriately for the migration.</span></span>
3. <span data-ttu-id="39829-147">Registrare la sottoscrizione per la migrazione delle risorse.</span><span class="sxs-lookup"><span data-stu-id="39829-147">Register your subscription for resource migration.</span></span> <span data-ttu-id="39829-148">Per registrare la sottoscrizione per la migrazione delle risorse, usare il frammento di codice di PowerShell seguente:</span><span class="sxs-lookup"><span data-stu-id="39829-148">To register your subscription for resource migration, use the following PowerShell snippet:</span></span>

  ```powershell 
  Select-AzureRmSubscription -SubscriptionName <Your Subscription Name>
  Register-AzureRmResourceProvider -ProviderNamespace Microsoft.ClassicInfrastructureMigrate
  Get-AzureRmResourceProvider -ProviderNamespace Microsoft.ClassicInfrastructureMigrate
  ```
4. <span data-ttu-id="39829-149">Convalidare, preparare ed eseguire la migrazione.</span><span class="sxs-lookup"><span data-stu-id="39829-149">Validate, prepare, and migrate.</span></span> <span data-ttu-id="39829-150">Per spostare la rete virtuale, usare il frammento di codice di PowerShell seguente:</span><span class="sxs-lookup"><span data-stu-id="39829-150">To move the virtual network, use the following PowerShell snippet:</span></span>

  ```powershell
  Move-AzureVirtualNetwork -Prepare $vnetName  
  Move-AzureVirtualNetwork -Commit $vnetName
  ```

  <span data-ttu-id="39829-151">È anche possibile interrompere la migrazione eseguendo il cmdlet di PowerShell seguente:</span><span class="sxs-lookup"><span data-stu-id="39829-151">You can also abort migration by running the following PowerShell cmdlet:</span></span>

  ```powershell
  Move-AzureVirtualNetwork -Abort $vnetName
  ```

## <a name="next-steps"></a><span data-ttu-id="39829-152">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="39829-152">Next steps</span></span>
* [<span data-ttu-id="39829-153">Migrazione supportata dalla piattaforma di risorse IaaS dal modello di distribuzione classica ad Azure Resource Manager</span><span class="sxs-lookup"><span data-stu-id="39829-153">Platform-supported migration of IaaS resources from classic to Azure Resource Manager</span></span>](../virtual-machines/virtual-machines-windows-migration-classic-resource-manager.md)
* [<span data-ttu-id="39829-154">Approfondimento tecnico sulla migrazione supportata dalla piattaforma dal modello di distribuzione classica ad Azure Resource Manager</span><span class="sxs-lookup"><span data-stu-id="39829-154">Technical deep dive on platform-supported migration from classic to Azure Resource Manager</span></span>](../virtual-machines/virtual-machines-windows-migration-classic-resource-manager-deep-dive.md)
* <span data-ttu-id="39829-155">[FAQs: Platform-supported migration of IaaS resources from classic to Azure Resource Manager](../virtual-machines/virtual-machines-windows-migration-classic-resource-manager.md) (Domande frequenti: Migrazione supportata dalla piattaforma per risorse IaaS dalla distribuzione classica ad Azure Resource Manager)</span><span class="sxs-lookup"><span data-stu-id="39829-155">[FAQs: Platform-supported migration of IaaS resources from classic to Azure Resource Manager](../virtual-machines/virtual-machines-windows-migration-classic-resource-manager.md)</span></span>
* [<span data-ttu-id="39829-156">Rivedere gli errori di migrazione più comuni e le soluzioni</span><span class="sxs-lookup"><span data-stu-id="39829-156">Review most common migration errors and mitigations</span></span>](../virtual-machines/windows/migration-classic-resource-manager-errors.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json)
