---
title: Runbook figlio in Automazione di Azure | Documentazione Microsoft
description: Descrive i diversi metodi per avviare un runbook in automazione di Azure da un altro runbook e condividere informazioni tra di essi.
services: automation
documentationcenter: 
author: mgoedtel
manager: jwhit
editor: tysonn
ms.assetid: 919887b9-43e2-4c16-883c-f81807fe37db
ms.service: automation
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 02/02/2017
ms.author: magoedte;bwren
ms.openlocfilehash: a605d278dbbda9613b91007ea6a7042403a7a6ff
ms.sourcegitcommit: f537befafb079256fba0529ee554c034d73f36b0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 07/11/2017
---
# <a name="child-runbooks-in-azure-automation"></a><span data-ttu-id="77314-103">Runbook figlio in Automazione di Azure</span><span class="sxs-lookup"><span data-stu-id="77314-103">Child runbooks in Azure Automation</span></span>
<span data-ttu-id="77314-104">È buona norma in automazione di Azure scrivere runbook riutilizzabili e modulari con una funzione discreta che può essere utilizzata da altri runbook.</span><span class="sxs-lookup"><span data-stu-id="77314-104">It is a best practice in Azure Automation to write reusable, modular runbooks with a discrete function that can be used by other runbooks.</span></span> <span data-ttu-id="77314-105">Un runbook padre chiama spesso uno o più runbook figlio per eseguire la funzionalità richiesta.</span><span class="sxs-lookup"><span data-stu-id="77314-105">A parent runbook will often call one or more child runbooks to perform required functionality.</span></span> <span data-ttu-id="77314-106">Esistono due modi per chiamare un runbook figlio e ognuno presenta differenze che è necessario comprendere in modo che sia possibile determinare quale sarà migliore per i diversi scenari.</span><span class="sxs-lookup"><span data-stu-id="77314-106">There are two ways to call a child runbook, and each has distinct differences that you should understand so that you can determine which will be best for your different scenarios.</span></span>

## <a name="invoking-a-child-runbook-using-inline-execution"></a><span data-ttu-id="77314-107">Richiamare un runbook figlio con esecuzione inline</span><span class="sxs-lookup"><span data-stu-id="77314-107">Invoking a child runbook using inline execution</span></span>
<span data-ttu-id="77314-108">Per richiamare un runbook inline da un altro runbook, utilizzare il nome del runbook e fornire valori per i relativi parametri, esattamente come si farebbe per un'attività o un cmdlet.</span><span class="sxs-lookup"><span data-stu-id="77314-108">To invoke a runbook inline from another runbook, you use the name of the runbook and provide values for its parameters exactly like you would use an activity or cmdlet.</span></span>  <span data-ttu-id="77314-109">Tutti i runbook nello stesso account di automazione sono disponibili a tutti gli altri per essere utilizzati come quanto segue.</span><span class="sxs-lookup"><span data-stu-id="77314-109">All runbooks in the same Automation account are available to all others to be used in this manner.</span></span> <span data-ttu-id="77314-110">Il runbook padre attenderà il completamento del runbook figlio prima di passare alla riga successiva e gli output vengono restituiti direttamente all'elemento padre.</span><span class="sxs-lookup"><span data-stu-id="77314-110">The parent runbook will wait for the child runbook to complete before moving to the next line, and any output is returned directly to the parent.</span></span>

<span data-ttu-id="77314-111">Quando si richiama un runbook inline, esso viene eseguito nello stesso processo del runbook padre.</span><span class="sxs-lookup"><span data-stu-id="77314-111">When you invoke a runbook inline, it runs in the same job as the parent runbook.</span></span> <span data-ttu-id="77314-112">Nella cronologia del processo non verrà indicato il runbook figlio eseguito.</span><span class="sxs-lookup"><span data-stu-id="77314-112">There will be no indication in the job history of the child runbook that it ran.</span></span> <span data-ttu-id="77314-113">Eventuali eccezioni e flussi di output dal runbook figlio verranno associati all'elemento padre.</span><span class="sxs-lookup"><span data-stu-id="77314-113">Any exceptions and any stream output from the child runbook will be associated with the parent.</span></span> <span data-ttu-id="77314-114">Ciò comporta un minor numero di processi e li rende più semplici per rilevare e risolvere poiché le eccezioni generate dal runbook figlio e i relativi output del flusso sono associati al processo padre.</span><span class="sxs-lookup"><span data-stu-id="77314-114">This results in fewer jobs and makes them easier to track and to troubleshoot since any exceptions thrown by the child runbook and any of its stream output are associated with the parent job.</span></span>

<span data-ttu-id="77314-115">Quando viene pubblicato un runbook, tutti i runbook figlio chiamati devono già essere pubblicati.</span><span class="sxs-lookup"><span data-stu-id="77314-115">When a runbook is published, any child runbooks that it calls must already be published.</span></span> <span data-ttu-id="77314-116">Questo avviene perché l'automazione di Azure crea un'associazione con i runbook figlio quando viene compilato un runbook.</span><span class="sxs-lookup"><span data-stu-id="77314-116">This is because Azure Automation builds an association with any child runbooks when a runbook is compiled.</span></span> <span data-ttu-id="77314-117">In caso contrario, il runbook padre sembrerà pubblicato correttamente ma al suo avvio verrà generata un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="77314-117">If they aren’t, the parent runbook will appear to publish properly, but will generate an exception when it’s started.</span></span> <span data-ttu-id="77314-118">In questo caso, è possibile ripubblicare il runbook padre per fare riferimento in modo corretto ai runbook figlio.</span><span class="sxs-lookup"><span data-stu-id="77314-118">If this happens, you can republish the parent runbook in order to properly reference the child runbooks.</span></span> <span data-ttu-id="77314-119">Non è necessario ripubblicare il runbook padre se alcuni runbook figlio sono stati modificati in quanto l'associazione sarà già stata creata.</span><span class="sxs-lookup"><span data-stu-id="77314-119">You do not need to republish the parent runbook if any of the child runbooks are changed because the association will have already been created.</span></span>

<span data-ttu-id="77314-120">I parametri di un runbook figlio chiamato inline possono essere costituiti da qualsiasi tipo di dati, inclusi gli oggetti complessi, e non esiste alcuna [serializzazione JSON](automation-starting-a-runbook.md#runbook-parameters) come quando si avvia il runbook usando il portale di gestione di Azure o il cmdlet Start-AzureAutomationRunbook.</span><span class="sxs-lookup"><span data-stu-id="77314-120">The parameters of a child runbook called inline can be any data type including complex objects, and there is no [JSON serialization](automation-starting-a-runbook.md#runbook-parameters) as there is when you start the runbook using the Azure Management Portal or with the Start-AzureRmAutomationRunbook cmdlet.</span></span>

### <a name="runbook-types"></a><span data-ttu-id="77314-121">Tipi di runbook</span><span class="sxs-lookup"><span data-stu-id="77314-121">Runbook types</span></span>
<span data-ttu-id="77314-122">Tipi che possono richiamarsi a vicenda:</span><span class="sxs-lookup"><span data-stu-id="77314-122">Which types can call each other:</span></span>

* <span data-ttu-id="77314-123">Un [runbook di PowerShell](automation-runbook-types.md#powershell-runbooks) e i [runbook grafici](automation-runbook-types.md#graphical-runbooks) possono chiamarsi reciprocamente inline (entrambi i tipi sono basati su PowerShell).</span><span class="sxs-lookup"><span data-stu-id="77314-123">A [PowerShell runbook](automation-runbook-types.md#powershell-runbooks) and [Graphical runbooks](automation-runbook-types.md#graphical-runbooks) can call each other inline (both are PowerShell based).</span></span>
* <span data-ttu-id="77314-124">Un [runbook del flusso di lavoro PowerShell](automation-runbook-types.md#powershell-workflow-runbooks) e i runbook grafici del flusso di lavoro PowerShell possono richiamarsi a vicenda inline (entrambi i tipi si basano su PowerShell).</span><span class="sxs-lookup"><span data-stu-id="77314-124">A [PowerShell Workflow runbook](automation-runbook-types.md#powershell-workflow-runbooks) and Graphical PowerShell Workflow runbooks can call each other inline (both are PowerShell Workflow based)</span></span>
* <span data-ttu-id="77314-125">I tipi PowerShell e i tipi di flusso di lavoro PowerShell non possono richiamarsi a vicenda online e devono utilizzare Start-AzureRmAutomationRunbook.</span><span class="sxs-lookup"><span data-stu-id="77314-125">The PowerShell types and the PowerShell Workflow types can’t call each other inline, and must use Start-AzureRmAutomationRunbook.</span></span>

<span data-ttu-id="77314-126">Quando è importante l’ordine di pubblicazione:</span><span class="sxs-lookup"><span data-stu-id="77314-126">When does publish order matter:</span></span>

* <span data-ttu-id="77314-127">L'ordine di pubblicazione dei runbook è rilevante solo per i runbook del flusso di lavoro PowerShell e i runbook grafici del flusso di lavoro PowerShell.</span><span class="sxs-lookup"><span data-stu-id="77314-127">The publish order of runbooks only matters for PowerShell Workflow and Graphical PowerShell Workflow runbooks.</span></span>

<span data-ttu-id="77314-128">Quando si richiama un runbook figlio grafico o del flusso di lavoro PowerShell tramite l’esecuzione inline, è sufficiente utilizzare il nome del runbook.</span><span class="sxs-lookup"><span data-stu-id="77314-128">When you call a Graphical or PowerShell Workflow child runbook using inline execution, you just use the name of the runbook.</span></span>  <span data-ttu-id="77314-129">Quando si chiama un runbook figlio di PowerShell, è necessario preceduto il proprio nome con *.\\*  per specificare che lo script si trova nella directory locale.</span><span class="sxs-lookup"><span data-stu-id="77314-129">When you call a PowerShell child runbook, you must preceded its name with *.\\* to specify that the script is located in the local directory.</span></span> 

### <a name="example"></a><span data-ttu-id="77314-130">Esempio</span><span class="sxs-lookup"><span data-stu-id="77314-130">Example</span></span>
<span data-ttu-id="77314-131">Nell'esempio seguente viene richiamato un runbook figlio di test che accetta tre parametri, un oggetto complesso, un numero intero e un valore booleano.</span><span class="sxs-lookup"><span data-stu-id="77314-131">The following example invokes a test child runbook that accepts three parameters, a complex object, an integer, and a boolean.</span></span> <span data-ttu-id="77314-132">L'output del runbook figlio viene assegnato a una variabile.</span><span class="sxs-lookup"><span data-stu-id="77314-132">The output of the child runbook is assigned to a variable.</span></span>  <span data-ttu-id="77314-133">In questo caso, il runbook figlio è un runbook del flusso di lavoro PowerShell</span><span class="sxs-lookup"><span data-stu-id="77314-133">In this case, the child runbook is a PowerShell Workflow runbook</span></span>

    $vm = Get-AzureRmVM –ResourceGroupName "LabRG" –Name "MyVM"
    $output = PSWF-ChildRunbook –VM $vm –RepeatCount 2 –Restart $true

<span data-ttu-id="77314-134">Di seguito si trova lo stesso esempio con un runbook di PowerShell come elemento figlio.</span><span class="sxs-lookup"><span data-stu-id="77314-134">Following is the same example using a PowerShell runbook as the child.</span></span>

    $vm = Get-AzureRmVM –ResourceGroupName "LabRG" –Name "MyVM"
    $output = .\PS-ChildRunbook.ps1 –VM $vm –RepeatCount 2 –Restart $true


## <a name="starting-a-child-runbook-using-cmdlet"></a><span data-ttu-id="77314-135">Avvio di un runbook figlio utilizzando cmdlet</span><span class="sxs-lookup"><span data-stu-id="77314-135">Starting a child runbook using cmdlet</span></span>
<span data-ttu-id="77314-136">È possibile usare il cmdlet [Start-AzureRmAutomationRunbook](https://msdn.microsoft.com/library/mt603661.aspx) per avviare un runbook come descritto nella sezione relativa all'[avvio di un runbook con Windows PowerShell](automation-starting-a-runbook.md#starting-a-runbook-with-windows-powershell).</span><span class="sxs-lookup"><span data-stu-id="77314-136">You can use the [Start-AzureRmAutomationRunbook](https://msdn.microsoft.com/library/mt603661.aspx) cmdlet to start a runbook as described in [To start a runbook with Windows PowerShell](automation-starting-a-runbook.md#starting-a-runbook-with-windows-powershell).</span></span> <span data-ttu-id="77314-137">Sono disponibili due modalità di utilizzo di questo cmdlet.</span><span class="sxs-lookup"><span data-stu-id="77314-137">There are two modes of use for this cmdlet.</span></span>  <span data-ttu-id="77314-138">In una modalità, il cmdlet restituisce l'ID del processo non appena viene creato il processo figlio per il runbook figlio.</span><span class="sxs-lookup"><span data-stu-id="77314-138">In one mode, the cmdlet returns the job id as soon as the child job is created for the child runbook.</span></span>  <span data-ttu-id="77314-139">Nell'altra modalità, che consente di specificare il parametro **-wait** , il cmdlet attende che l'elemento figlio finisca il processo e restituisce l'output dal runbook figlio.</span><span class="sxs-lookup"><span data-stu-id="77314-139">In the other mode, which you enable by specifying the **-wait** parameter, the cmdlet will wait until the child job finishes and will return the output from the child runbook.</span></span>

<span data-ttu-id="77314-140">Verrà eseguito il processo da un runbook figlio avviato con un cmdlet in un processo separato dal runbook padre.</span><span class="sxs-lookup"><span data-stu-id="77314-140">The job from a child runbook started with a cmdlet will run in a separate job from the parent runbook.</span></span> <span data-ttu-id="77314-141">Questo comporta più processi rispetto al richiamo del runbook inline e li rende più difficili da rilevare.</span><span class="sxs-lookup"><span data-stu-id="77314-141">This results in more jobs than invoking the runbook inline and makes them more difficult to track.</span></span> <span data-ttu-id="77314-142">L'elemento padre può avviare diversi runbook figli in modo asincrono senza attendere che ognuno di essi sia terminato.</span><span class="sxs-lookup"><span data-stu-id="77314-142">The parent can start multiple child runbooks asynchronously without waiting for each to complete.</span></span> <span data-ttu-id="77314-143">Per questa stessa tipologia di esecuzione parallela che chiama l’inline del runbook figlio, il runbook padre dovrà usare la [parola chiave parallela](automation-powershell-workflow.md#parallel-processing).</span><span class="sxs-lookup"><span data-stu-id="77314-143">For that same kind of parallel execution calling the child runbooks inline, the parent runbook would need to use the [parallel keyword](automation-powershell-workflow.md#parallel-processing).</span></span>

<span data-ttu-id="77314-144">I parametri per un runbook figlio avviato con un cmdlet vengono forniti come una tabella hash, come descritto in [Parametri di Runbook](automation-starting-a-runbook.md#runbook-parameters).</span><span class="sxs-lookup"><span data-stu-id="77314-144">Parameters for a child runbook started with a cmdlet are provided as a hashtable as described in [Runbook Parameters](automation-starting-a-runbook.md#runbook-parameters).</span></span> <span data-ttu-id="77314-145">Possono essere utilizzati solo tipi di dati semplici.</span><span class="sxs-lookup"><span data-stu-id="77314-145">Only simple data types can be used.</span></span> <span data-ttu-id="77314-146">Se il runbook dispone di un parametro con un tipo di dati complessi, deve essere chiamato inline.</span><span class="sxs-lookup"><span data-stu-id="77314-146">If the runbook has a parameter with a complex data type, then it must be called inline.</span></span>

### <a name="example"></a><span data-ttu-id="77314-147">Esempio</span><span class="sxs-lookup"><span data-stu-id="77314-147">Example</span></span>
<span data-ttu-id="77314-148">Nell'esempio seguente viene avviato un runbook figlio con parametri e si attende il suo completamento con il parametro Start-AzureRmAutomationRunbook -wait.</span><span class="sxs-lookup"><span data-stu-id="77314-148">The following example starts a child runbook with parameters and then waits for it to complete using the Start-AzureRmAutomationRunbook -wait parameter.</span></span> <span data-ttu-id="77314-149">Una volta completato, l'output viene raccolto dal runbook figlio.</span><span class="sxs-lookup"><span data-stu-id="77314-149">Once completed, its output is collected from the child runbook.</span></span>

    $params = @{"VMName"="MyVM";"RepeatCount"=2;"Restart"=$true} 
    $joboutput = Start-AzureRmAutomationRunbook –AutomationAccountName "MyAutomationAccount" –Name "Test-ChildRunbook" -ResourceGroupName "LabRG" –Parameters $params –wait


## <a name="comparison-of-methods-for-calling-a-child-runbook"></a><span data-ttu-id="77314-150">Confronto di metodi per chiamare un runbook figlio</span><span class="sxs-lookup"><span data-stu-id="77314-150">Comparison of methods for calling a child runbook</span></span>
<span data-ttu-id="77314-151">Nella tabella seguente vengono riepilogate le differenze tra i due metodi per chiamare un runbook da un altro runbook.</span><span class="sxs-lookup"><span data-stu-id="77314-151">The following table summarizes the differences between the two methods for calling a runbook from another runbook.</span></span>

|  | <span data-ttu-id="77314-152">Inline</span><span class="sxs-lookup"><span data-stu-id="77314-152">Inline</span></span> | <span data-ttu-id="77314-153">Cmdlet</span><span class="sxs-lookup"><span data-stu-id="77314-153">Cmdlet</span></span> |
|:--- |:--- |:--- |
| <span data-ttu-id="77314-154">Job</span><span class="sxs-lookup"><span data-stu-id="77314-154">Job</span></span> |<span data-ttu-id="77314-155">I runbook figlio vengono eseguiti nello stesso processo dell’elemento padre.</span><span class="sxs-lookup"><span data-stu-id="77314-155">Child runbooks run in the same job as the parent.</span></span> |<span data-ttu-id="77314-156">Viene creato un processo separato per il runbook figlio.</span><span class="sxs-lookup"><span data-stu-id="77314-156">A separate job is created for the child runbook.</span></span> |
| <span data-ttu-id="77314-157">Esecuzione</span><span class="sxs-lookup"><span data-stu-id="77314-157">Execution</span></span> |<span data-ttu-id="77314-158">Il runbook padre attende il completamento del runbook figlio prima di continuare.</span><span class="sxs-lookup"><span data-stu-id="77314-158">Parent runbook waits for the child runbook to complete before continuing.</span></span> |<span data-ttu-id="77314-159">Il runbook padre continua subito dopo l'avvio del runbook figlio *o* attende il completamento del processo figlio.</span><span class="sxs-lookup"><span data-stu-id="77314-159">Parent runbook continues immediately after child runbook is started *or* parent runbook waits for the child job to finish.</span></span> |
| <span data-ttu-id="77314-160">Output</span><span class="sxs-lookup"><span data-stu-id="77314-160">Output</span></span> |<span data-ttu-id="77314-161">Il runbook padre può ottenere output direttamente dal runbook figlio.</span><span class="sxs-lookup"><span data-stu-id="77314-161">Parent runbook can directly get output from child runbook.</span></span> |<span data-ttu-id="77314-162">Il runbook padre deve recuperare l'output dal processo del runbook figlio *o* può ottenere direttamente l'output dal runbook figlio.</span><span class="sxs-lookup"><span data-stu-id="77314-162">Parent runbook must retrieve output from child runbook job *or* parent runbook can directly get output from child runbook.</span></span> |
| <span data-ttu-id="77314-163">Parametri</span><span class="sxs-lookup"><span data-stu-id="77314-163">Parameters</span></span> |<span data-ttu-id="77314-164">I valori per i parametri di runbook figlio vengono specificati separatamente e possono utilizzare qualsiasi tipo di dati.</span><span class="sxs-lookup"><span data-stu-id="77314-164">Values for the child runbook parameters are specified separately and can use any data type.</span></span> |<span data-ttu-id="77314-165">I valori per i parametri di runbook figlio devono essere combinati in una singola tabella di hash e possono includere solo tipi di dati semplici, matrice e oggetto che sfruttano la serializzazione JSON.</span><span class="sxs-lookup"><span data-stu-id="77314-165">Values for the child runbook parameters must be combined into a single hashtable and can only include simple, array, and object data types that leverage JSON serialization.</span></span> |
| <span data-ttu-id="77314-166">Account di automazione</span><span class="sxs-lookup"><span data-stu-id="77314-166">Automation Account</span></span> |<span data-ttu-id="77314-167">Il runbook padre può utilizzare solo runbook figlio nello stesso account di automazione.</span><span class="sxs-lookup"><span data-stu-id="77314-167">Parent runbook can only use child runbook in the same automation account.</span></span> |<span data-ttu-id="77314-168">Il runbook padre può usare runbook figlio di qualsiasi account di automazione della stessa sottoscrizione di Azure e anche di una sottoscrizione diversa a cui si ha una connessione.</span><span class="sxs-lookup"><span data-stu-id="77314-168">Parent runbook can use child runbook from any automation account from the same Azure subscription and even a different subscription if you have a connection to it.</span></span> |
| <span data-ttu-id="77314-169">Pubblicazione</span><span class="sxs-lookup"><span data-stu-id="77314-169">Publishing</span></span> |<span data-ttu-id="77314-170">Il runbook figlio deve essere pubblicato prima della pubblicazione del runbook padre.</span><span class="sxs-lookup"><span data-stu-id="77314-170">Child runbook must be published before parent runbook is published.</span></span> |<span data-ttu-id="77314-171">Il runbook figlio deve essere pubblicato prima che il runbook padre venga avviato.</span><span class="sxs-lookup"><span data-stu-id="77314-171">Child runbook must be published any time before parent runbook is started.</span></span> |

## <a name="next-steps"></a><span data-ttu-id="77314-172">Passaggi successivi</span><span class="sxs-lookup"><span data-stu-id="77314-172">Next steps</span></span>
* [<span data-ttu-id="77314-173">Avvio di un runbook in Automazione di Azure</span><span class="sxs-lookup"><span data-stu-id="77314-173">Starting a runbook in Azure Automation</span></span>](automation-starting-a-runbook.md)
* [<span data-ttu-id="77314-174">Output di runbook e messaggi in automazione di Azure</span><span class="sxs-lookup"><span data-stu-id="77314-174">Runbook output and messages in Azure Automation</span></span>](automation-runbook-output-and-messages.md)

